(function(){const K=document.createElement("link").relList;if(K&&K.supports&&K.supports("modulepreload"))return;for(const re of document.querySelectorAll('link[rel="modulepreload"]'))ne(re);new MutationObserver(re=>{for(const le of re)if(le.type==="childList")for(const Q of le.addedNodes)Q.tagName==="LINK"&&Q.rel==="modulepreload"&&ne(Q)}).observe(document,{childList:!0,subtree:!0});function ee(re){const le={};return re.integrity&&(le.integrity=re.integrity),re.referrerPolicy&&(le.referrerPolicy=re.referrerPolicy),re.crossOrigin==="use-credentials"?le.credentials="include":re.crossOrigin==="anonymous"?le.credentials="omit":le.credentials="same-origin",le}function ne(re){if(re.ep)return;re.ep=!0;const le=ee(re);fetch(re.href,le)}})();var n,l,u$1,i,r,o,e,f$1,c,s,a,p={},v=[],y=/acit|ex(?:s|g|n|p|$)|rph|grid|ows|mnc|ntw|ine[ch]|zoo|^ord|itera/i,w=Array.isArray;function d(Y,K){for(var ee in K)Y[ee]=K[ee];return Y}function g(Y){Y&&Y.parentNode&&Y.parentNode.removeChild(Y)}function _(Y,K,ee){var ne,re,le,Q={};for(le in K)le=="key"?ne=K[le]:le=="ref"?re=K[le]:Q[le]=K[le];if(arguments.length>2&&(Q.children=arguments.length>3?n.call(arguments,2):ee),typeof Y=="function"&&Y.defaultProps!=null)for(le in Y.defaultProps)Q[le]===void 0&&(Q[le]=Y.defaultProps[le]);return m(Y,Q,ne,re,null)}function m(Y,K,ee,ne,re){var le={type:Y,props:K,key:ee,ref:ne,__k:null,__:null,__b:0,__e:null,__c:null,constructor:void 0,__v:re??++u$1,__i:-1,__u:0};return re==null&&l.vnode!=null&&l.vnode(le),le}function b(){return{current:null}}function k(Y){return Y.children}function x(Y,K){this.props=Y,this.context=K}function S(Y,K){if(K==null)return Y.__?S(Y.__,Y.__i+1):null;for(var ee;K<Y.__k.length;K++)if((ee=Y.__k[K])!=null&&ee.__e!=null)return ee.__e;return typeof Y.type=="function"?S(Y):null}function C(Y){var K,ee;if((Y=Y.__)!=null&&Y.__c!=null){for(Y.__e=Y.__c.base=null,K=0;K<Y.__k.length;K++)if((ee=Y.__k[K])!=null&&ee.__e!=null){Y.__e=Y.__c.base=ee.__e;break}return C(Y)}}function M(Y){(!Y.__d&&(Y.__d=!0)&&i.push(Y)&&!$.__r++||r!=l.debounceRendering)&&((r=l.debounceRendering)||o)($)}function $(){for(var Y,K,ee,ne,re,le,Q,R=1;i.length;)i.length>R&&i.sort(e),Y=i.shift(),R=i.length,Y.__d&&(ee=void 0,re=(ne=(K=Y).__v).__e,le=[],Q=[],K.__P&&((ee=d({},ne)).__v=ne.__v+1,l.vnode&&l.vnode(ee),O(K.__P,ee,ne,K.__n,K.__P.namespaceURI,32&ne.__u?[re]:null,le,re??S(ne),!!(32&ne.__u),Q),ee.__v=ne.__v,ee.__.__k[ee.__i]=ee,z(le,ee,Q),ee.__e!=re&&C(ee)));$.__r=0}function I(Y,K,ee,ne,re,le,Q,R,U,Z,ae){var he,pe,me,ve,Re,Me,Te=ne&&ne.__k||v,Ce=K.length;for(U=P(ee,K,Te,U,Ce),he=0;he<Ce;he++)(me=ee.__k[he])!=null&&(pe=me.__i==-1?p:Te[me.__i]||p,me.__i=he,Me=O(Y,me,pe,re,le,Q,R,U,Z,ae),ve=me.__e,me.ref&&pe.ref!=me.ref&&(pe.ref&&q(pe.ref,null,me),ae.push(me.ref,me.__c||ve,me)),Re==null&&ve!=null&&(Re=ve),4&me.__u||pe.__k===me.__k?U=A(me,U,Y):typeof me.type=="function"&&Me!==void 0?U=Me:ve&&(U=ve.nextSibling),me.__u&=-7);return ee.__e=Re,U}function P(Y,K,ee,ne,re){var le,Q,R,U,Z,ae=ee.length,he=ae,pe=0;for(Y.__k=new Array(re),le=0;le<re;le++)(Q=K[le])!=null&&typeof Q!="boolean"&&typeof Q!="function"?(U=le+pe,(Q=Y.__k[le]=typeof Q=="string"||typeof Q=="number"||typeof Q=="bigint"||Q.constructor==String?m(null,Q,null,null,null):w(Q)?m(k,{children:Q},null,null,null):Q.constructor==null&&Q.__b>0?m(Q.type,Q.props,Q.key,Q.ref?Q.ref:null,Q.__v):Q).__=Y,Q.__b=Y.__b+1,R=null,(Z=Q.__i=L(Q,ee,U,he))!=-1&&(he--,(R=ee[Z])&&(R.__u|=2)),R==null||R.__v==null?(Z==-1&&(re>ae?pe--:re<ae&&pe++),typeof Q.type!="function"&&(Q.__u|=4)):Z!=U&&(Z==U-1?pe--:Z==U+1?pe++:(Z>U?pe--:pe++,Q.__u|=4))):Y.__k[le]=null;if(he)for(le=0;le<ae;le++)(R=ee[le])!=null&&(2&R.__u)==0&&(R.__e==ne&&(ne=S(R)),B(R,R));return ne}function A(Y,K,ee){var ne,re;if(typeof Y.type=="function"){for(ne=Y.__k,re=0;ne&&re<ne.length;re++)ne[re]&&(ne[re].__=Y,K=A(ne[re],K,ee));return K}Y.__e!=K&&(K&&Y.type&&!ee.contains(K)&&(K=S(Y)),ee.insertBefore(Y.__e,K||null),K=Y.__e);do K=K&&K.nextSibling;while(K!=null&&K.nodeType==8);return K}function L(Y,K,ee,ne){var re,le,Q=Y.key,R=Y.type,U=K[ee];if(U===null&&Y.key==null||U&&Q==U.key&&R==U.type&&(2&U.__u)==0)return ee;if(ne>(U!=null&&(2&U.__u)==0?1:0))for(re=ee-1,le=ee+1;re>=0||le<K.length;){if(re>=0){if((U=K[re])&&(2&U.__u)==0&&Q==U.key&&R==U.type)return re;re--}if(le<K.length){if((U=K[le])&&(2&U.__u)==0&&Q==U.key&&R==U.type)return le;le++}}return-1}function T(Y,K,ee){K[0]=="-"?Y.setProperty(K,ee??""):Y[K]=ee==null?"":typeof ee!="number"||y.test(K)?ee:ee+"px"}function j(Y,K,ee,ne,re){var le,Q;e:if(K=="style")if(typeof ee=="string")Y.style.cssText=ee;else{if(typeof ne=="string"&&(Y.style.cssText=ne=""),ne)for(K in ne)ee&&K in ee||T(Y.style,K,"");if(ee)for(K in ee)ne&&ee[K]==ne[K]||T(Y.style,K,ee[K])}else if(K[0]=="o"&&K[1]=="n")le=K!=(K=K.replace(f$1,"$1")),Q=K.toLowerCase(),K=Q in Y||K=="onFocusOut"||K=="onFocusIn"?Q.slice(2):K.slice(2),Y.l||(Y.l={}),Y.l[K+le]=ee,ee?ne?ee.u=ne.u:(ee.u=c,Y.addEventListener(K,le?a:s,le)):Y.removeEventListener(K,le?a:s,le);else{if(re=="http://www.w3.org/2000/svg")K=K.replace(/xlink(H|:h)/,"h").replace(/sName$/,"s");else if(K!="width"&&K!="height"&&K!="href"&&K!="list"&&K!="form"&&K!="tabIndex"&&K!="download"&&K!="rowSpan"&&K!="colSpan"&&K!="role"&&K!="popover"&&K in Y)try{Y[K]=ee??"";break e}catch{}typeof ee=="function"||(ee==null||ee===!1&&K[4]!="-"?Y.removeAttribute(K):Y.setAttribute(K,K=="popover"&&ee==1?"":ee))}}function F(Y){return function(K){if(this.l){var ee=this.l[K.type+Y];if(K.t==null)K.t=c++;else if(K.t<ee.u)return;return ee(l.event?l.event(K):K)}}}function O(Y,K,ee,ne,re,le,Q,R,U,Z){var ae,he,pe,me,ve,Re,Me,Te,Ce,We,Fe,ke,Ze,Je,Qe,it,lt,dt=K.type;if(K.constructor!=null)return null;128&ee.__u&&(U=!!(32&ee.__u),le=[R=K.__e=ee.__e]),(ae=l.__b)&&ae(K);e:if(typeof dt=="function")try{if(Te=K.props,Ce="prototype"in dt&&dt.prototype.render,We=(ae=dt.contextType)&&ne[ae.__c],Fe=ae?We?We.props.value:ae.__:ne,ee.__c?Me=(he=K.__c=ee.__c).__=he.__E:(Ce?K.__c=he=new dt(Te,Fe):(K.__c=he=new x(Te,Fe),he.constructor=dt,he.render=D),We&&We.sub(he),he.props=Te,he.state||(he.state={}),he.context=Fe,he.__n=ne,pe=he.__d=!0,he.__h=[],he._sb=[]),Ce&&he.__s==null&&(he.__s=he.state),Ce&&dt.getDerivedStateFromProps!=null&&(he.__s==he.state&&(he.__s=d({},he.__s)),d(he.__s,dt.getDerivedStateFromProps(Te,he.__s))),me=he.props,ve=he.state,he.__v=K,pe)Ce&&dt.getDerivedStateFromProps==null&&he.componentWillMount!=null&&he.componentWillMount(),Ce&&he.componentDidMount!=null&&he.__h.push(he.componentDidMount);else{if(Ce&&dt.getDerivedStateFromProps==null&&Te!==me&&he.componentWillReceiveProps!=null&&he.componentWillReceiveProps(Te,Fe),!he.__e&&he.shouldComponentUpdate!=null&&he.shouldComponentUpdate(Te,he.__s,Fe)===!1||K.__v==ee.__v){for(K.__v!=ee.__v&&(he.props=Te,he.state=he.__s,he.__d=!1),K.__e=ee.__e,K.__k=ee.__k,K.__k.some(function(yt){yt&&(yt.__=K)}),ke=0;ke<he._sb.length;ke++)he.__h.push(he._sb[ke]);he._sb=[],he.__h.length&&Q.push(he);break e}he.componentWillUpdate!=null&&he.componentWillUpdate(Te,he.__s,Fe),Ce&&he.componentDidUpdate!=null&&he.__h.push(function(){he.componentDidUpdate(me,ve,Re)})}if(he.context=Fe,he.props=Te,he.__P=Y,he.__e=!1,Ze=l.__r,Je=0,Ce){for(he.state=he.__s,he.__d=!1,Ze&&Ze(K),ae=he.render(he.props,he.state,he.context),Qe=0;Qe<he._sb.length;Qe++)he.__h.push(he._sb[Qe]);he._sb=[]}else do he.__d=!1,Ze&&Ze(K),ae=he.render(he.props,he.state,he.context),he.state=he.__s;while(he.__d&&++Je<25);he.state=he.__s,he.getChildContext!=null&&(ne=d(d({},ne),he.getChildContext())),Ce&&!pe&&he.getSnapshotBeforeUpdate!=null&&(Re=he.getSnapshotBeforeUpdate(me,ve)),it=ae,ae!=null&&ae.type===k&&ae.key==null&&(it=N(ae.props.children)),R=I(Y,w(it)?it:[it],K,ee,ne,re,le,Q,R,U,Z),he.base=K.__e,K.__u&=-161,he.__h.length&&Q.push(he),Me&&(he.__E=he.__=null)}catch(yt){if(K.__v=null,U||le!=null)if(yt.then){for(K.__u|=U?160:128;R&&R.nodeType==8&&R.nextSibling;)R=R.nextSibling;le[le.indexOf(R)]=null,K.__e=R}else for(lt=le.length;lt--;)g(le[lt]);else K.__e=ee.__e,K.__k=ee.__k;l.__e(yt,K,ee)}else le==null&&K.__v==ee.__v?(K.__k=ee.__k,K.__e=ee.__e):R=K.__e=V(ee.__e,K,ee,ne,re,le,Q,U,Z);return(ae=l.diffed)&&ae(K),128&K.__u?void 0:R}function z(Y,K,ee){for(var ne=0;ne<ee.length;ne++)q(ee[ne],ee[++ne],ee[++ne]);l.__c&&l.__c(K,Y),Y.some(function(re){try{Y=re.__h,re.__h=[],Y.some(function(le){le.call(re)})}catch(le){l.__e(le,re.__v)}})}function N(Y){return typeof Y!="object"||Y==null||Y.__b&&Y.__b>0?Y:w(Y)?Y.map(N):d({},Y)}function V(Y,K,ee,ne,re,le,Q,R,U){var Z,ae,he,pe,me,ve,Re,Me=ee.props,Te=K.props,Ce=K.type;if(Ce=="svg"?re="http://www.w3.org/2000/svg":Ce=="math"?re="http://www.w3.org/1998/Math/MathML":re||(re="http://www.w3.org/1999/xhtml"),le!=null){for(Z=0;Z<le.length;Z++)if((me=le[Z])&&"setAttribute"in me==!!Ce&&(Ce?me.localName==Ce:me.nodeType==3)){Y=me,le[Z]=null;break}}if(Y==null){if(Ce==null)return document.createTextNode(Te);Y=document.createElementNS(re,Ce,Te.is&&Te),R&&(l.__m&&l.__m(K,le),R=!1),le=null}if(Ce==null)Me===Te||R&&Y.data==Te||(Y.data=Te);else{if(le=le&&n.call(Y.childNodes),Me=ee.props||p,!R&&le!=null)for(Me={},Z=0;Z<Y.attributes.length;Z++)Me[(me=Y.attributes[Z]).name]=me.value;for(Z in Me)if(me=Me[Z],Z!="children"){if(Z=="dangerouslySetInnerHTML")he=me;else if(!(Z in Te)){if(Z=="value"&&"defaultValue"in Te||Z=="checked"&&"defaultChecked"in Te)continue;j(Y,Z,null,me,re)}}for(Z in Te)me=Te[Z],Z=="children"?pe=me:Z=="dangerouslySetInnerHTML"?ae=me:Z=="value"?ve=me:Z=="checked"?Re=me:R&&typeof me!="function"||Me[Z]===me||j(Y,Z,me,Me[Z],re);if(ae)R||he&&(ae.__html==he.__html||ae.__html==Y.innerHTML)||(Y.innerHTML=ae.__html),K.__k=[];else if(he&&(Y.innerHTML=""),I(K.type=="template"?Y.content:Y,w(pe)?pe:[pe],K,ee,ne,Ce=="foreignObject"?"http://www.w3.org/1999/xhtml":re,le,Q,le?le[0]:ee.__k&&S(ee,0),R,U),le!=null)for(Z=le.length;Z--;)g(le[Z]);R||(Z="value",Ce=="progress"&&ve==null?Y.removeAttribute("value"):ve!=null&&(ve!==Y[Z]||Ce=="progress"&&!ve||Ce=="option"&&ve!=Me[Z])&&j(Y,Z,ve,Me[Z],re),Z="checked",Re!=null&&Re!=Y[Z]&&j(Y,Z,Re,Me[Z],re))}return Y}function q(Y,K,ee){try{if(typeof Y=="function"){var ne=typeof Y.__u=="function";ne&&Y.__u(),ne&&K==null||(Y.__u=Y(K))}else Y.current=K}catch(re){l.__e(re,ee)}}function B(Y,K,ee){var ne,re;if(l.unmount&&l.unmount(Y),(ne=Y.ref)&&(ne.current&&ne.current!=Y.__e||q(ne,null,K)),(ne=Y.__c)!=null){if(ne.componentWillUnmount)try{ne.componentWillUnmount()}catch(le){l.__e(le,K)}ne.base=ne.__P=null}if(ne=Y.__k)for(re=0;re<ne.length;re++)ne[re]&&B(ne[re],K,ee||typeof Y.type!="function");ee||g(Y.__e),Y.__c=Y.__=Y.__e=void 0}function D(Y,K,ee){return this.constructor(Y,ee)}function E(Y,K,ee){var ne,re,le,Q;K==document&&(K=document.documentElement),l.__&&l.__(Y,K),re=(ne=!1)?null:K.__k,le=[],Q=[],O(K,Y=K.__k=_(k,null,[Y]),re||p,p,K.namespaceURI,re?null:K.firstChild?n.call(K.childNodes):null,le,re?re.__e:K.firstChild,ne,Q),z(le,Y,Q)}n=v.slice,l={__e:function(Y,K,ee,ne){for(var re,le,Q;K=K.__;)if((re=K.__c)&&!re.__)try{if((le=re.constructor)&&le.getDerivedStateFromError!=null&&(re.setState(le.getDerivedStateFromError(Y)),Q=re.__d),re.componentDidCatch!=null&&(re.componentDidCatch(Y,ne||{}),Q=re.__d),Q)return re.__E=re}catch(R){Y=R}throw Y}},u$1=0,x.prototype.setState=function(Y,K){var ee;ee=this.__s!=null&&this.__s!=this.state?this.__s:this.__s=d({},this.state),typeof Y=="function"&&(Y=Y(d({},ee),this.props)),Y&&d(ee,Y),Y!=null&&this.__v&&(K&&this._sb.push(K),M(this))},x.prototype.forceUpdate=function(Y){this.__v&&(this.__e=!0,Y&&this.__h.push(Y),M(this))},x.prototype.render=k,i=[],o=typeof Promise=="function"?Promise.prototype.then.bind(Promise.resolve()):setTimeout,e=function(Y,K){return Y.__v.__b-K.__v.__b},$.__r=0,f$1=/(PointerCapture)$|Capture$/i,c=0,s=F(!1),a=F(!0);var f=0;function u(Y,K,ee,ne,re,le){K||(K={});var Q,R,U=K;if("ref"in U)for(R in U={},K)R=="ref"?Q=K[R]:U[R]=K[R];var Z={type:Y,props:U,key:ee,ref:Q,__k:null,__:null,__b:0,__e:null,__c:null,constructor:void 0,__v:--f,__i:-1,__u:0,__source:re,__self:le};if(typeof Y=="function"&&(Q=Y.defaultProps))for(R in Q)U[R]===void 0&&(U[R]=Q[R]);return l.vnode&&l.vnode(Z),Z}var commonjsGlobal=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};function getDefaultExportFromCjs(Y){return Y&&Y.__esModule&&Object.prototype.hasOwnProperty.call(Y,"default")?Y.default:Y}function getAugmentedNamespace(Y){if(Object.prototype.hasOwnProperty.call(Y,"__esModule"))return Y;var K=Y.default;if(typeof K=="function"){var ee=function ne(){return this instanceof ne?Reflect.construct(K,arguments,this.constructor):K.apply(this,arguments)};ee.prototype=K.prototype}else ee={};return Object.defineProperty(ee,"__esModule",{value:!0}),Object.keys(Y).forEach(function(ne){var re=Object.getOwnPropertyDescriptor(Y,ne);Object.defineProperty(ee,ne,re.get?re:{enumerable:!0,get:function(){return Y[ne]}})}),ee}var es_symbol={},es_symbol_constructor={},globalThis_1,hasRequiredGlobalThis;function requireGlobalThis(){if(hasRequiredGlobalThis)return globalThis_1;hasRequiredGlobalThis=1;var Y=function(K){return K&&K.Math===Math&&K};return globalThis_1=Y(typeof globalThis=="object"&&globalThis)||Y(typeof window=="object"&&window)||Y(typeof self=="object"&&self)||Y(typeof commonjsGlobal=="object"&&commonjsGlobal)||Y(typeof globalThis_1=="object"&&globalThis_1)||function(){return this}()||Function("return this")(),globalThis_1}var objectGetOwnPropertyDescriptor={},fails,hasRequiredFails;function requireFails(){return hasRequiredFails||(hasRequiredFails=1,fails=function(Y){try{return!!Y()}catch{return!0}}),fails}var descriptors,hasRequiredDescriptors;function requireDescriptors(){if(hasRequiredDescriptors)return descriptors;hasRequiredDescriptors=1;var Y=requireFails();return descriptors=!Y(function(){return Object.defineProperty({},1,{get:function(){return 7}})[1]!==7}),descriptors}var functionBindNative,hasRequiredFunctionBindNative;function requireFunctionBindNative(){if(hasRequiredFunctionBindNative)return functionBindNative;hasRequiredFunctionBindNative=1;var Y=requireFails();return functionBindNative=!Y(function(){var K=(function(){}).bind();return typeof K!="function"||K.hasOwnProperty("prototype")}),functionBindNative}var functionCall,hasRequiredFunctionCall;function requireFunctionCall(){if(hasRequiredFunctionCall)return functionCall;hasRequiredFunctionCall=1;var Y=requireFunctionBindNative(),K=Function.prototype.call;return functionCall=Y?K.bind(K):function(){return K.apply(K,arguments)},functionCall}var objectPropertyIsEnumerable={},hasRequiredObjectPropertyIsEnumerable;function requireObjectPropertyIsEnumerable(){if(hasRequiredObjectPropertyIsEnumerable)return objectPropertyIsEnumerable;hasRequiredObjectPropertyIsEnumerable=1;var Y={}.propertyIsEnumerable,K=Object.getOwnPropertyDescriptor,ee=K&&!Y.call({1:2},1);return objectPropertyIsEnumerable.f=ee?function(re){var le=K(this,re);return!!le&&le.enumerable}:Y,objectPropertyIsEnumerable}var createPropertyDescriptor,hasRequiredCreatePropertyDescriptor;function requireCreatePropertyDescriptor(){return hasRequiredCreatePropertyDescriptor||(hasRequiredCreatePropertyDescriptor=1,createPropertyDescriptor=function(Y,K){return{enumerable:!(Y&1),configurable:!(Y&2),writable:!(Y&4),value:K}}),createPropertyDescriptor}var functionUncurryThis,hasRequiredFunctionUncurryThis;function requireFunctionUncurryThis(){if(hasRequiredFunctionUncurryThis)return functionUncurryThis;hasRequiredFunctionUncurryThis=1;var Y=requireFunctionBindNative(),K=Function.prototype,ee=K.call,ne=Y&&K.bind.bind(ee,ee);return functionUncurryThis=Y?ne:function(re){return function(){return ee.apply(re,arguments)}},functionUncurryThis}var classofRaw,hasRequiredClassofRaw;function requireClassofRaw(){if(hasRequiredClassofRaw)return classofRaw;hasRequiredClassofRaw=1;var Y=requireFunctionUncurryThis(),K=Y({}.toString),ee=Y("".slice);return classofRaw=function(ne){return ee(K(ne),8,-1)},classofRaw}var indexedObject,hasRequiredIndexedObject;function requireIndexedObject(){if(hasRequiredIndexedObject)return indexedObject;hasRequiredIndexedObject=1;var Y=requireFunctionUncurryThis(),K=requireFails(),ee=requireClassofRaw(),ne=Object,re=Y("".split);return indexedObject=K(function(){return!ne("z").propertyIsEnumerable(0)})?function(le){return ee(le)==="String"?re(le,""):ne(le)}:ne,indexedObject}var isNullOrUndefined$1,hasRequiredIsNullOrUndefined;function requireIsNullOrUndefined(){return hasRequiredIsNullOrUndefined||(hasRequiredIsNullOrUndefined=1,isNullOrUndefined$1=function(Y){return Y==null}),isNullOrUndefined$1}var requireObjectCoercible,hasRequiredRequireObjectCoercible;function requireRequireObjectCoercible(){if(hasRequiredRequireObjectCoercible)return requireObjectCoercible;hasRequiredRequireObjectCoercible=1;var Y=requireIsNullOrUndefined(),K=TypeError;return requireObjectCoercible=function(ee){if(Y(ee))throw new K("Can't call method on "+ee);return ee},requireObjectCoercible}var toIndexedObject,hasRequiredToIndexedObject;function requireToIndexedObject(){if(hasRequiredToIndexedObject)return toIndexedObject;hasRequiredToIndexedObject=1;var Y=requireIndexedObject(),K=requireRequireObjectCoercible();return toIndexedObject=function(ee){return Y(K(ee))},toIndexedObject}var isCallable,hasRequiredIsCallable;function requireIsCallable(){if(hasRequiredIsCallable)return isCallable;hasRequiredIsCallable=1;var Y=typeof document=="object"&&document.all;return isCallable=typeof Y>"u"&&Y!==void 0?function(K){return typeof K=="function"||K===Y}:function(K){return typeof K=="function"},isCallable}var isObject,hasRequiredIsObject$1;function requireIsObject$1(){if(hasRequiredIsObject$1)return isObject;hasRequiredIsObject$1=1;var Y=requireIsCallable();return isObject=function(K){return typeof K=="object"?K!==null:Y(K)},isObject}var getBuiltIn,hasRequiredGetBuiltIn;function requireGetBuiltIn(){if(hasRequiredGetBuiltIn)return getBuiltIn;hasRequiredGetBuiltIn=1;var Y=requireGlobalThis(),K=requireIsCallable(),ee=function(ne){return K(ne)?ne:void 0};return getBuiltIn=function(ne,re){return arguments.length<2?ee(Y[ne]):Y[ne]&&Y[ne][re]},getBuiltIn}var objectIsPrototypeOf,hasRequiredObjectIsPrototypeOf;function requireObjectIsPrototypeOf(){if(hasRequiredObjectIsPrototypeOf)return objectIsPrototypeOf;hasRequiredObjectIsPrototypeOf=1;var Y=requireFunctionUncurryThis();return objectIsPrototypeOf=Y({}.isPrototypeOf),objectIsPrototypeOf}var environmentUserAgent,hasRequiredEnvironmentUserAgent;function requireEnvironmentUserAgent(){if(hasRequiredEnvironmentUserAgent)return environmentUserAgent;hasRequiredEnvironmentUserAgent=1;var Y=requireGlobalThis(),K=Y.navigator,ee=K&&K.userAgent;return environmentUserAgent=ee?String(ee):"",environmentUserAgent}var environmentV8Version,hasRequiredEnvironmentV8Version;function requireEnvironmentV8Version(){if(hasRequiredEnvironmentV8Version)return environmentV8Version;hasRequiredEnvironmentV8Version=1;var Y=requireGlobalThis(),K=requireEnvironmentUserAgent(),ee=Y.process,ne=Y.Deno,re=ee&&ee.versions||ne&&ne.version,le=re&&re.v8,Q,R;return le&&(Q=le.split("."),R=Q[0]>0&&Q[0]<4?1:+(Q[0]+Q[1])),!R&&K&&(Q=K.match(/Edge\/(\d+)/),(!Q||Q[1]>=74)&&(Q=K.match(/Chrome\/(\d+)/),Q&&(R=+Q[1]))),environmentV8Version=R,environmentV8Version}var symbolConstructorDetection,hasRequiredSymbolConstructorDetection;function requireSymbolConstructorDetection(){if(hasRequiredSymbolConstructorDetection)return symbolConstructorDetection;hasRequiredSymbolConstructorDetection=1;var Y=requireEnvironmentV8Version(),K=requireFails(),ee=requireGlobalThis(),ne=ee.String;return symbolConstructorDetection=!!Object.getOwnPropertySymbols&&!K(function(){var re=Symbol("symbol detection");return!ne(re)||!(Object(re)instanceof Symbol)||!Symbol.sham&&Y&&Y<41}),symbolConstructorDetection}var useSymbolAsUid,hasRequiredUseSymbolAsUid;function requireUseSymbolAsUid(){if(hasRequiredUseSymbolAsUid)return useSymbolAsUid;hasRequiredUseSymbolAsUid=1;var Y=requireSymbolConstructorDetection();return useSymbolAsUid=Y&&!Symbol.sham&&typeof Symbol.iterator=="symbol",useSymbolAsUid}var isSymbol,hasRequiredIsSymbol$1;function requireIsSymbol$1(){if(hasRequiredIsSymbol$1)return isSymbol;hasRequiredIsSymbol$1=1;var Y=requireGetBuiltIn(),K=requireIsCallable(),ee=requireObjectIsPrototypeOf(),ne=requireUseSymbolAsUid(),re=Object;return isSymbol=ne?function(le){return typeof le=="symbol"}:function(le){var Q=Y("Symbol");return K(Q)&&ee(Q.prototype,re(le))},isSymbol}var tryToString,hasRequiredTryToString;function requireTryToString(){if(hasRequiredTryToString)return tryToString;hasRequiredTryToString=1;var Y=String;return tryToString=function(K){try{return Y(K)}catch{return"Object"}},tryToString}var aCallable,hasRequiredACallable;function requireACallable(){if(hasRequiredACallable)return aCallable;hasRequiredACallable=1;var Y=requireIsCallable(),K=requireTryToString(),ee=TypeError;return aCallable=function(ne){if(Y(ne))return ne;throw new ee(K(ne)+" is not a function")},aCallable}var getMethod,hasRequiredGetMethod;function requireGetMethod(){if(hasRequiredGetMethod)return getMethod;hasRequiredGetMethod=1;var Y=requireACallable(),K=requireIsNullOrUndefined();return getMethod=function(ee,ne){var re=ee[ne];return K(re)?void 0:Y(re)},getMethod}var ordinaryToPrimitive,hasRequiredOrdinaryToPrimitive;function requireOrdinaryToPrimitive(){if(hasRequiredOrdinaryToPrimitive)return ordinaryToPrimitive;hasRequiredOrdinaryToPrimitive=1;var Y=requireFunctionCall(),K=requireIsCallable(),ee=requireIsObject$1(),ne=TypeError;return ordinaryToPrimitive=function(re,le){var Q,R;if(le==="string"&&K(Q=re.toString)&&!ee(R=Y(Q,re))||K(Q=re.valueOf)&&!ee(R=Y(Q,re))||le!=="string"&&K(Q=re.toString)&&!ee(R=Y(Q,re)))return R;throw new ne("Can't convert object to primitive value")},ordinaryToPrimitive}var sharedStore={exports:{}},isPure,hasRequiredIsPure;function requireIsPure(){return hasRequiredIsPure||(hasRequiredIsPure=1,isPure=!1),isPure}var defineGlobalProperty,hasRequiredDefineGlobalProperty;function requireDefineGlobalProperty(){if(hasRequiredDefineGlobalProperty)return defineGlobalProperty;hasRequiredDefineGlobalProperty=1;var Y=requireGlobalThis(),K=Object.defineProperty;return defineGlobalProperty=function(ee,ne){try{K(Y,ee,{value:ne,configurable:!0,writable:!0})}catch{Y[ee]=ne}return ne},defineGlobalProperty}var hasRequiredSharedStore;function requireSharedStore(){if(hasRequiredSharedStore)return sharedStore.exports;hasRequiredSharedStore=1;var Y=requireIsPure(),K=requireGlobalThis(),ee=requireDefineGlobalProperty(),ne="__core-js_shared__",re=sharedStore.exports=K[ne]||ee(ne,{});return(re.versions||(re.versions=[])).push({version:"3.44.0",mode:Y?"pure":"global",copyright:"© 2014-2025 Denis Pushkarev (zloirock.ru)",license:"https://github.com/zloirock/core-js/blob/v3.44.0/LICENSE",source:"https://github.com/zloirock/core-js"}),sharedStore.exports}var shared,hasRequiredShared;function requireShared(){if(hasRequiredShared)return shared;hasRequiredShared=1;var Y=requireSharedStore();return shared=function(K,ee){return Y[K]||(Y[K]=ee||{})},shared}var toObject,hasRequiredToObject;function requireToObject(){if(hasRequiredToObject)return toObject;hasRequiredToObject=1;var Y=requireRequireObjectCoercible(),K=Object;return toObject=function(ee){return K(Y(ee))},toObject}var hasOwnProperty_1,hasRequiredHasOwnProperty;function requireHasOwnProperty(){if(hasRequiredHasOwnProperty)return hasOwnProperty_1;hasRequiredHasOwnProperty=1;var Y=requireFunctionUncurryThis(),K=requireToObject(),ee=Y({}.hasOwnProperty);return hasOwnProperty_1=Object.hasOwn||function(re,le){return ee(K(re),le)},hasOwnProperty_1}var uid,hasRequiredUid;function requireUid(){if(hasRequiredUid)return uid;hasRequiredUid=1;var Y=requireFunctionUncurryThis(),K=0,ee=Math.random(),ne=Y(1.1.toString);return uid=function(re){return"Symbol("+(re===void 0?"":re)+")_"+ne(++K+ee,36)},uid}var wellKnownSymbol,hasRequiredWellKnownSymbol;function requireWellKnownSymbol(){if(hasRequiredWellKnownSymbol)return wellKnownSymbol;hasRequiredWellKnownSymbol=1;var Y=requireGlobalThis(),K=requireShared(),ee=requireHasOwnProperty(),ne=requireUid(),re=requireSymbolConstructorDetection(),le=requireUseSymbolAsUid(),Q=Y.Symbol,R=K("wks"),U=le?Q.for||Q:Q&&Q.withoutSetter||ne;return wellKnownSymbol=function(Z){return ee(R,Z)||(R[Z]=re&&ee(Q,Z)?Q[Z]:U("Symbol."+Z)),R[Z]},wellKnownSymbol}var toPrimitive,hasRequiredToPrimitive;function requireToPrimitive(){if(hasRequiredToPrimitive)return toPrimitive;hasRequiredToPrimitive=1;var Y=requireFunctionCall(),K=requireIsObject$1(),ee=requireIsSymbol$1(),ne=requireGetMethod(),re=requireOrdinaryToPrimitive(),le=requireWellKnownSymbol(),Q=TypeError,R=le("toPrimitive");return toPrimitive=function(U,Z){if(!K(U)||ee(U))return U;var ae=ne(U,R),he;if(ae){if(Z===void 0&&(Z="default"),he=Y(ae,U,Z),!K(he)||ee(he))return he;throw new Q("Can't convert object to primitive value")}return Z===void 0&&(Z="number"),re(U,Z)},toPrimitive}var toPropertyKey,hasRequiredToPropertyKey;function requireToPropertyKey(){if(hasRequiredToPropertyKey)return toPropertyKey;hasRequiredToPropertyKey=1;var Y=requireToPrimitive(),K=requireIsSymbol$1();return toPropertyKey=function(ee){var ne=Y(ee,"string");return K(ne)?ne:ne+""},toPropertyKey}var documentCreateElement,hasRequiredDocumentCreateElement;function requireDocumentCreateElement(){if(hasRequiredDocumentCreateElement)return documentCreateElement;hasRequiredDocumentCreateElement=1;var Y=requireGlobalThis(),K=requireIsObject$1(),ee=Y.document,ne=K(ee)&&K(ee.createElement);return documentCreateElement=function(re){return ne?ee.createElement(re):{}},documentCreateElement}var ie8DomDefine,hasRequiredIe8DomDefine;function requireIe8DomDefine(){if(hasRequiredIe8DomDefine)return ie8DomDefine;hasRequiredIe8DomDefine=1;var Y=requireDescriptors(),K=requireFails(),ee=requireDocumentCreateElement();return ie8DomDefine=!Y&&!K(function(){return Object.defineProperty(ee("div"),"a",{get:function(){return 7}}).a!==7}),ie8DomDefine}var hasRequiredObjectGetOwnPropertyDescriptor;function requireObjectGetOwnPropertyDescriptor(){if(hasRequiredObjectGetOwnPropertyDescriptor)return objectGetOwnPropertyDescriptor;hasRequiredObjectGetOwnPropertyDescriptor=1;var Y=requireDescriptors(),K=requireFunctionCall(),ee=requireObjectPropertyIsEnumerable(),ne=requireCreatePropertyDescriptor(),re=requireToIndexedObject(),le=requireToPropertyKey(),Q=requireHasOwnProperty(),R=requireIe8DomDefine(),U=Object.getOwnPropertyDescriptor;return objectGetOwnPropertyDescriptor.f=Y?U:function(ae,he){if(ae=re(ae),he=le(he),R)try{return U(ae,he)}catch{}if(Q(ae,he))return ne(!K(ee.f,ae,he),ae[he])},objectGetOwnPropertyDescriptor}var objectDefineProperty={},v8PrototypeDefineBug,hasRequiredV8PrototypeDefineBug;function requireV8PrototypeDefineBug(){if(hasRequiredV8PrototypeDefineBug)return v8PrototypeDefineBug;hasRequiredV8PrototypeDefineBug=1;var Y=requireDescriptors(),K=requireFails();return v8PrototypeDefineBug=Y&&K(function(){return Object.defineProperty(function(){},"prototype",{value:42,writable:!1}).prototype!==42}),v8PrototypeDefineBug}var anObject,hasRequiredAnObject;function requireAnObject(){if(hasRequiredAnObject)return anObject;hasRequiredAnObject=1;var Y=requireIsObject$1(),K=String,ee=TypeError;return anObject=function(ne){if(Y(ne))return ne;throw new ee(K(ne)+" is not an object")},anObject}var hasRequiredObjectDefineProperty;function requireObjectDefineProperty(){if(hasRequiredObjectDefineProperty)return objectDefineProperty;hasRequiredObjectDefineProperty=1;var Y=requireDescriptors(),K=requireIe8DomDefine(),ee=requireV8PrototypeDefineBug(),ne=requireAnObject(),re=requireToPropertyKey(),le=TypeError,Q=Object.defineProperty,R=Object.getOwnPropertyDescriptor,U="enumerable",Z="configurable",ae="writable";return objectDefineProperty.f=Y?ee?function(pe,me,ve){if(ne(pe),me=re(me),ne(ve),typeof pe=="function"&&me==="prototype"&&"value"in ve&&ae in ve&&!ve[ae]){var Re=R(pe,me);Re&&Re[ae]&&(pe[me]=ve.value,ve={configurable:Z in ve?ve[Z]:Re[Z],enumerable:U in ve?ve[U]:Re[U],writable:!1})}return Q(pe,me,ve)}:Q:function(pe,me,ve){if(ne(pe),me=re(me),ne(ve),K)try{return Q(pe,me,ve)}catch{}if("get"in ve||"set"in ve)throw new le("Accessors not supported");return"value"in ve&&(pe[me]=ve.value),pe},objectDefineProperty}var createNonEnumerableProperty,hasRequiredCreateNonEnumerableProperty;function requireCreateNonEnumerableProperty(){if(hasRequiredCreateNonEnumerableProperty)return createNonEnumerableProperty;hasRequiredCreateNonEnumerableProperty=1;var Y=requireDescriptors(),K=requireObjectDefineProperty(),ee=requireCreatePropertyDescriptor();return createNonEnumerableProperty=Y?function(ne,re,le){return K.f(ne,re,ee(1,le))}:function(ne,re,le){return ne[re]=le,ne},createNonEnumerableProperty}var makeBuiltIn={exports:{}},functionName,hasRequiredFunctionName;function requireFunctionName(){if(hasRequiredFunctionName)return functionName;hasRequiredFunctionName=1;var Y=requireDescriptors(),K=requireHasOwnProperty(),ee=Function.prototype,ne=Y&&Object.getOwnPropertyDescriptor,re=K(ee,"name"),le=re&&(function(){}).name==="something",Q=re&&(!Y||Y&&ne(ee,"name").configurable);return functionName={EXISTS:re,PROPER:le,CONFIGURABLE:Q},functionName}var inspectSource,hasRequiredInspectSource;function requireInspectSource(){if(hasRequiredInspectSource)return inspectSource;hasRequiredInspectSource=1;var Y=requireFunctionUncurryThis(),K=requireIsCallable(),ee=requireSharedStore(),ne=Y(Function.toString);return K(ee.inspectSource)||(ee.inspectSource=function(re){return ne(re)}),inspectSource=ee.inspectSource,inspectSource}var weakMapBasicDetection,hasRequiredWeakMapBasicDetection;function requireWeakMapBasicDetection(){if(hasRequiredWeakMapBasicDetection)return weakMapBasicDetection;hasRequiredWeakMapBasicDetection=1;var Y=requireGlobalThis(),K=requireIsCallable(),ee=Y.WeakMap;return weakMapBasicDetection=K(ee)&&/native code/.test(String(ee)),weakMapBasicDetection}var sharedKey,hasRequiredSharedKey;function requireSharedKey(){if(hasRequiredSharedKey)return sharedKey;hasRequiredSharedKey=1;var Y=requireShared(),K=requireUid(),ee=Y("keys");return sharedKey=function(ne){return ee[ne]||(ee[ne]=K(ne))},sharedKey}var hiddenKeys,hasRequiredHiddenKeys;function requireHiddenKeys(){return hasRequiredHiddenKeys||(hasRequiredHiddenKeys=1,hiddenKeys={}),hiddenKeys}var internalState,hasRequiredInternalState;function requireInternalState(){if(hasRequiredInternalState)return internalState;hasRequiredInternalState=1;var Y=requireWeakMapBasicDetection(),K=requireGlobalThis(),ee=requireIsObject$1(),ne=requireCreateNonEnumerableProperty(),re=requireHasOwnProperty(),le=requireSharedStore(),Q=requireSharedKey(),R=requireHiddenKeys(),U="Object already initialized",Z=K.TypeError,ae=K.WeakMap,he,pe,me,ve=function(Ce){return me(Ce)?pe(Ce):he(Ce,{})},Re=function(Ce){return function(We){var Fe;if(!ee(We)||(Fe=pe(We)).type!==Ce)throw new Z("Incompatible receiver, "+Ce+" required");return Fe}};if(Y||le.state){var Me=le.state||(le.state=new ae);Me.get=Me.get,Me.has=Me.has,Me.set=Me.set,he=function(Ce,We){if(Me.has(Ce))throw new Z(U);return We.facade=Ce,Me.set(Ce,We),We},pe=function(Ce){return Me.get(Ce)||{}},me=function(Ce){return Me.has(Ce)}}else{var Te=Q("state");R[Te]=!0,he=function(Ce,We){if(re(Ce,Te))throw new Z(U);return We.facade=Ce,ne(Ce,Te,We),We},pe=function(Ce){return re(Ce,Te)?Ce[Te]:{}},me=function(Ce){return re(Ce,Te)}}return internalState={set:he,get:pe,has:me,enforce:ve,getterFor:Re},internalState}var hasRequiredMakeBuiltIn;function requireMakeBuiltIn(){if(hasRequiredMakeBuiltIn)return makeBuiltIn.exports;hasRequiredMakeBuiltIn=1;var Y=requireFunctionUncurryThis(),K=requireFails(),ee=requireIsCallable(),ne=requireHasOwnProperty(),re=requireDescriptors(),le=requireFunctionName().CONFIGURABLE,Q=requireInspectSource(),R=requireInternalState(),U=R.enforce,Z=R.get,ae=String,he=Object.defineProperty,pe=Y("".slice),me=Y("".replace),ve=Y([].join),Re=re&&!K(function(){return he(function(){},"length",{value:8}).length!==8}),Me=String(String).split("String"),Te=makeBuiltIn.exports=function(Ce,We,Fe){pe(ae(We),0,7)==="Symbol("&&(We="["+me(ae(We),/^Symbol\(([^)]*)\).*$/,"$1")+"]"),Fe&&Fe.getter&&(We="get "+We),Fe&&Fe.setter&&(We="set "+We),(!ne(Ce,"name")||le&&Ce.name!==We)&&(re?he(Ce,"name",{value:We,configurable:!0}):Ce.name=We),Re&&Fe&&ne(Fe,"arity")&&Ce.length!==Fe.arity&&he(Ce,"length",{value:Fe.arity});try{Fe&&ne(Fe,"constructor")&&Fe.constructor?re&&he(Ce,"prototype",{writable:!1}):Ce.prototype&&(Ce.prototype=void 0)}catch{}var ke=U(Ce);return ne(ke,"source")||(ke.source=ve(Me,typeof We=="string"?We:"")),Ce};return Function.prototype.toString=Te(function(){return ee(this)&&Z(this).source||Q(this)},"toString"),makeBuiltIn.exports}var defineBuiltIn,hasRequiredDefineBuiltIn;function requireDefineBuiltIn(){if(hasRequiredDefineBuiltIn)return defineBuiltIn;hasRequiredDefineBuiltIn=1;var Y=requireIsCallable(),K=requireObjectDefineProperty(),ee=requireMakeBuiltIn(),ne=requireDefineGlobalProperty();return defineBuiltIn=function(re,le,Q,R){R||(R={});var U=R.enumerable,Z=R.name!==void 0?R.name:le;if(Y(Q)&&ee(Q,Z,R),R.global)U?re[le]=Q:ne(le,Q);else{try{R.unsafe?re[le]&&(U=!0):delete re[le]}catch{}U?re[le]=Q:K.f(re,le,{value:Q,enumerable:!1,configurable:!R.nonConfigurable,writable:!R.nonWritable})}return re},defineBuiltIn}var objectGetOwnPropertyNames={},mathTrunc,hasRequiredMathTrunc;function requireMathTrunc(){if(hasRequiredMathTrunc)return mathTrunc;hasRequiredMathTrunc=1;var Y=Math.ceil,K=Math.floor;return mathTrunc=Math.trunc||function(ne){var re=+ne;return(re>0?K:Y)(re)},mathTrunc}var toIntegerOrInfinity,hasRequiredToIntegerOrInfinity;function requireToIntegerOrInfinity(){if(hasRequiredToIntegerOrInfinity)return toIntegerOrInfinity;hasRequiredToIntegerOrInfinity=1;var Y=requireMathTrunc();return toIntegerOrInfinity=function(K){var ee=+K;return ee!==ee||ee===0?0:Y(ee)},toIntegerOrInfinity}var toAbsoluteIndex,hasRequiredToAbsoluteIndex;function requireToAbsoluteIndex(){if(hasRequiredToAbsoluteIndex)return toAbsoluteIndex;hasRequiredToAbsoluteIndex=1;var Y=requireToIntegerOrInfinity(),K=Math.max,ee=Math.min;return toAbsoluteIndex=function(ne,re){var le=Y(ne);return le<0?K(le+re,0):ee(le,re)},toAbsoluteIndex}var toLength,hasRequiredToLength;function requireToLength(){if(hasRequiredToLength)return toLength;hasRequiredToLength=1;var Y=requireToIntegerOrInfinity(),K=Math.min;return toLength=function(ee){var ne=Y(ee);return ne>0?K(ne,9007199254740991):0},toLength}var lengthOfArrayLike,hasRequiredLengthOfArrayLike;function requireLengthOfArrayLike(){if(hasRequiredLengthOfArrayLike)return lengthOfArrayLike;hasRequiredLengthOfArrayLike=1;var Y=requireToLength();return lengthOfArrayLike=function(K){return Y(K.length)},lengthOfArrayLike}var arrayIncludes,hasRequiredArrayIncludes;function requireArrayIncludes(){if(hasRequiredArrayIncludes)return arrayIncludes;hasRequiredArrayIncludes=1;var Y=requireToIndexedObject(),K=requireToAbsoluteIndex(),ee=requireLengthOfArrayLike(),ne=function(re){return function(le,Q,R){var U=Y(le),Z=ee(U);if(Z===0)return!re&&-1;var ae=K(R,Z),he;if(re&&Q!==Q){for(;Z>ae;)if(he=U[ae++],he!==he)return!0}else for(;Z>ae;ae++)if((re||ae in U)&&U[ae]===Q)return re||ae||0;return!re&&-1}};return arrayIncludes={includes:ne(!0),indexOf:ne(!1)},arrayIncludes}var objectKeysInternal,hasRequiredObjectKeysInternal;function requireObjectKeysInternal(){if(hasRequiredObjectKeysInternal)return objectKeysInternal;hasRequiredObjectKeysInternal=1;var Y=requireFunctionUncurryThis(),K=requireHasOwnProperty(),ee=requireToIndexedObject(),ne=requireArrayIncludes().indexOf,re=requireHiddenKeys(),le=Y([].push);return objectKeysInternal=function(Q,R){var U=ee(Q),Z=0,ae=[],he;for(he in U)!K(re,he)&&K(U,he)&&le(ae,he);for(;R.length>Z;)K(U,he=R[Z++])&&(~ne(ae,he)||le(ae,he));return ae},objectKeysInternal}var enumBugKeys,hasRequiredEnumBugKeys;function requireEnumBugKeys(){return hasRequiredEnumBugKeys||(hasRequiredEnumBugKeys=1,enumBugKeys=["constructor","hasOwnProperty","isPrototypeOf","propertyIsEnumerable","toLocaleString","toString","valueOf"]),enumBugKeys}var hasRequiredObjectGetOwnPropertyNames;function requireObjectGetOwnPropertyNames(){if(hasRequiredObjectGetOwnPropertyNames)return objectGetOwnPropertyNames;hasRequiredObjectGetOwnPropertyNames=1;var Y=requireObjectKeysInternal(),K=requireEnumBugKeys(),ee=K.concat("length","prototype");return objectGetOwnPropertyNames.f=Object.getOwnPropertyNames||function(re){return Y(re,ee)},objectGetOwnPropertyNames}var objectGetOwnPropertySymbols={},hasRequiredObjectGetOwnPropertySymbols;function requireObjectGetOwnPropertySymbols(){return hasRequiredObjectGetOwnPropertySymbols||(hasRequiredObjectGetOwnPropertySymbols=1,objectGetOwnPropertySymbols.f=Object.getOwnPropertySymbols),objectGetOwnPropertySymbols}var ownKeys,hasRequiredOwnKeys;function requireOwnKeys(){if(hasRequiredOwnKeys)return ownKeys;hasRequiredOwnKeys=1;var Y=requireGetBuiltIn(),K=requireFunctionUncurryThis(),ee=requireObjectGetOwnPropertyNames(),ne=requireObjectGetOwnPropertySymbols(),re=requireAnObject(),le=K([].concat);return ownKeys=Y("Reflect","ownKeys")||function(R){var U=ee.f(re(R)),Z=ne.f;return Z?le(U,Z(R)):U},ownKeys}var copyConstructorProperties,hasRequiredCopyConstructorProperties;function requireCopyConstructorProperties(){if(hasRequiredCopyConstructorProperties)return copyConstructorProperties;hasRequiredCopyConstructorProperties=1;var Y=requireHasOwnProperty(),K=requireOwnKeys(),ee=requireObjectGetOwnPropertyDescriptor(),ne=requireObjectDefineProperty();return copyConstructorProperties=function(re,le,Q){for(var R=K(le),U=ne.f,Z=ee.f,ae=0;ae<R.length;ae++){var he=R[ae];!Y(re,he)&&!(Q&&Y(Q,he))&&U(re,he,Z(le,he))}},copyConstructorProperties}var isForced_1,hasRequiredIsForced;function requireIsForced(){if(hasRequiredIsForced)return isForced_1;hasRequiredIsForced=1;var Y=requireFails(),K=requireIsCallable(),ee=/#|\.prototype\./,ne=function(U,Z){var ae=le[re(U)];return ae===R?!0:ae===Q?!1:K(Z)?Y(Z):!!Z},re=ne.normalize=function(U){return String(U).replace(ee,".").toLowerCase()},le=ne.data={},Q=ne.NATIVE="N",R=ne.POLYFILL="P";return isForced_1=ne,isForced_1}var _export,hasRequired_export;function require_export(){if(hasRequired_export)return _export;hasRequired_export=1;var Y=requireGlobalThis(),K=requireObjectGetOwnPropertyDescriptor().f,ee=requireCreateNonEnumerableProperty(),ne=requireDefineBuiltIn(),re=requireDefineGlobalProperty(),le=requireCopyConstructorProperties(),Q=requireIsForced();return _export=function(R,U){var Z=R.target,ae=R.global,he=R.stat,pe,me,ve,Re,Me,Te;if(ae?me=Y:he?me=Y[Z]||re(Z,{}):me=Y[Z]&&Y[Z].prototype,me)for(ve in U){if(Me=U[ve],R.dontCallGetSet?(Te=K(me,ve),Re=Te&&Te.value):Re=me[ve],pe=Q(ae?ve:Z+(he?".":"#")+ve,R.forced),!pe&&Re!==void 0){if(typeof Me==typeof Re)continue;le(Me,Re)}(R.sham||Re&&Re.sham)&&ee(Me,"sham",!0),ne(me,ve,Me,R)}},_export}var toStringTagSupport,hasRequiredToStringTagSupport;function requireToStringTagSupport(){if(hasRequiredToStringTagSupport)return toStringTagSupport;hasRequiredToStringTagSupport=1;var Y=requireWellKnownSymbol(),K=Y("toStringTag"),ee={};return ee[K]="z",toStringTagSupport=String(ee)==="[object z]",toStringTagSupport}var classof,hasRequiredClassof;function requireClassof(){if(hasRequiredClassof)return classof;hasRequiredClassof=1;var Y=requireToStringTagSupport(),K=requireIsCallable(),ee=requireClassofRaw(),ne=requireWellKnownSymbol(),re=ne("toStringTag"),le=Object,Q=ee(function(){return arguments}())==="Arguments",R=function(U,Z){try{return U[Z]}catch{}};return classof=Y?ee:function(U){var Z,ae,he;return U===void 0?"Undefined":U===null?"Null":typeof(ae=R(Z=le(U),re))=="string"?ae:Q?ee(Z):(he=ee(Z))==="Object"&&K(Z.callee)?"Arguments":he},classof}var toString,hasRequiredToString$1;function requireToString$1(){if(hasRequiredToString$1)return toString;hasRequiredToString$1=1;var Y=requireClassof(),K=String;return toString=function(ee){if(Y(ee)==="Symbol")throw new TypeError("Cannot convert a Symbol value to a string");return K(ee)},toString}var objectDefineProperties={},objectKeys,hasRequiredObjectKeys;function requireObjectKeys(){if(hasRequiredObjectKeys)return objectKeys;hasRequiredObjectKeys=1;var Y=requireObjectKeysInternal(),K=requireEnumBugKeys();return objectKeys=Object.keys||function(ne){return Y(ne,K)},objectKeys}var hasRequiredObjectDefineProperties;function requireObjectDefineProperties(){if(hasRequiredObjectDefineProperties)return objectDefineProperties;hasRequiredObjectDefineProperties=1;var Y=requireDescriptors(),K=requireV8PrototypeDefineBug(),ee=requireObjectDefineProperty(),ne=requireAnObject(),re=requireToIndexedObject(),le=requireObjectKeys();return objectDefineProperties.f=Y&&!K?Object.defineProperties:function(R,U){ne(R);for(var Z=re(U),ae=le(U),he=ae.length,pe=0,me;he>pe;)ee.f(R,me=ae[pe++],Z[me]);return R},objectDefineProperties}var html,hasRequiredHtml;function requireHtml(){if(hasRequiredHtml)return html;hasRequiredHtml=1;var Y=requireGetBuiltIn();return html=Y("document","documentElement"),html}var objectCreate,hasRequiredObjectCreate;function requireObjectCreate(){if(hasRequiredObjectCreate)return objectCreate;hasRequiredObjectCreate=1;var Y=requireAnObject(),K=requireObjectDefineProperties(),ee=requireEnumBugKeys(),ne=requireHiddenKeys(),re=requireHtml(),le=requireDocumentCreateElement(),Q=requireSharedKey(),R=">",U="<",Z="prototype",ae="script",he=Q("IE_PROTO"),pe=function(){},me=function(Ce){return U+ae+R+Ce+U+"/"+ae+R},ve=function(Ce){Ce.write(me("")),Ce.close();var We=Ce.parentWindow.Object;return Ce=null,We},Re=function(){var Ce=le("iframe"),We="java"+ae+":",Fe;return Ce.style.display="none",re.appendChild(Ce),Ce.src=String(We),Fe=Ce.contentWindow.document,Fe.open(),Fe.write(me("document.F=Object")),Fe.close(),Fe.F},Me,Te=function(){try{Me=new ActiveXObject("htmlfile")}catch{}Te=typeof document<"u"?document.domain&&Me?ve(Me):Re():ve(Me);for(var Ce=ee.length;Ce--;)delete Te[Z][ee[Ce]];return Te()};return ne[he]=!0,objectCreate=Object.create||function(We,Fe){var ke;return We!==null?(pe[Z]=Y(We),ke=new pe,pe[Z]=null,ke[he]=We):ke=Te(),Fe===void 0?ke:K.f(ke,Fe)},objectCreate}var objectGetOwnPropertyNamesExternal={},arraySlice,hasRequiredArraySlice;function requireArraySlice(){if(hasRequiredArraySlice)return arraySlice;hasRequiredArraySlice=1;var Y=requireFunctionUncurryThis();return arraySlice=Y([].slice),arraySlice}var hasRequiredObjectGetOwnPropertyNamesExternal;function requireObjectGetOwnPropertyNamesExternal(){if(hasRequiredObjectGetOwnPropertyNamesExternal)return objectGetOwnPropertyNamesExternal;hasRequiredObjectGetOwnPropertyNamesExternal=1;var Y=requireClassofRaw(),K=requireToIndexedObject(),ee=requireObjectGetOwnPropertyNames().f,ne=requireArraySlice(),re=typeof window=="object"&&window&&Object.getOwnPropertyNames?Object.getOwnPropertyNames(window):[],le=function(Q){try{return ee(Q)}catch{return ne(re)}};return objectGetOwnPropertyNamesExternal.f=function(R){return re&&Y(R)==="Window"?le(R):ee(K(R))},objectGetOwnPropertyNamesExternal}var defineBuiltInAccessor,hasRequiredDefineBuiltInAccessor;function requireDefineBuiltInAccessor(){if(hasRequiredDefineBuiltInAccessor)return defineBuiltInAccessor;hasRequiredDefineBuiltInAccessor=1;var Y=requireMakeBuiltIn(),K=requireObjectDefineProperty();return defineBuiltInAccessor=function(ee,ne,re){return re.get&&Y(re.get,ne,{getter:!0}),re.set&&Y(re.set,ne,{setter:!0}),K.f(ee,ne,re)},defineBuiltInAccessor}var wellKnownSymbolWrapped={},hasRequiredWellKnownSymbolWrapped;function requireWellKnownSymbolWrapped(){if(hasRequiredWellKnownSymbolWrapped)return wellKnownSymbolWrapped;hasRequiredWellKnownSymbolWrapped=1;var Y=requireWellKnownSymbol();return wellKnownSymbolWrapped.f=Y,wellKnownSymbolWrapped}var path,hasRequiredPath;function requirePath(){if(hasRequiredPath)return path;hasRequiredPath=1;var Y=requireGlobalThis();return path=Y,path}var wellKnownSymbolDefine,hasRequiredWellKnownSymbolDefine;function requireWellKnownSymbolDefine(){if(hasRequiredWellKnownSymbolDefine)return wellKnownSymbolDefine;hasRequiredWellKnownSymbolDefine=1;var Y=requirePath(),K=requireHasOwnProperty(),ee=requireWellKnownSymbolWrapped(),ne=requireObjectDefineProperty().f;return wellKnownSymbolDefine=function(re){var le=Y.Symbol||(Y.Symbol={});K(le,re)||ne(le,re,{value:ee.f(re)})},wellKnownSymbolDefine}var symbolDefineToPrimitive,hasRequiredSymbolDefineToPrimitive;function requireSymbolDefineToPrimitive(){if(hasRequiredSymbolDefineToPrimitive)return symbolDefineToPrimitive;hasRequiredSymbolDefineToPrimitive=1;var Y=requireFunctionCall(),K=requireGetBuiltIn(),ee=requireWellKnownSymbol(),ne=requireDefineBuiltIn();return symbolDefineToPrimitive=function(){var re=K("Symbol"),le=re&&re.prototype,Q=le&&le.valueOf,R=ee("toPrimitive");le&&!le[R]&&ne(le,R,function(U){return Y(Q,this)},{arity:1})},symbolDefineToPrimitive}var setToStringTag,hasRequiredSetToStringTag;function requireSetToStringTag(){if(hasRequiredSetToStringTag)return setToStringTag;hasRequiredSetToStringTag=1;var Y=requireObjectDefineProperty().f,K=requireHasOwnProperty(),ee=requireWellKnownSymbol(),ne=ee("toStringTag");return setToStringTag=function(re,le,Q){re&&!Q&&(re=re.prototype),re&&!K(re,ne)&&Y(re,ne,{configurable:!0,value:le})},setToStringTag}var functionUncurryThisClause,hasRequiredFunctionUncurryThisClause;function requireFunctionUncurryThisClause(){if(hasRequiredFunctionUncurryThisClause)return functionUncurryThisClause;hasRequiredFunctionUncurryThisClause=1;var Y=requireClassofRaw(),K=requireFunctionUncurryThis();return functionUncurryThisClause=function(ee){if(Y(ee)==="Function")return K(ee)},functionUncurryThisClause}var functionBindContext,hasRequiredFunctionBindContext;function requireFunctionBindContext(){if(hasRequiredFunctionBindContext)return functionBindContext;hasRequiredFunctionBindContext=1;var Y=requireFunctionUncurryThisClause(),K=requireACallable(),ee=requireFunctionBindNative(),ne=Y(Y.bind);return functionBindContext=function(re,le){return K(re),le===void 0?re:ee?ne(re,le):function(){return re.apply(le,arguments)}},functionBindContext}var isArray,hasRequiredIsArray$1;function requireIsArray$1(){if(hasRequiredIsArray$1)return isArray;hasRequiredIsArray$1=1;var Y=requireClassofRaw();return isArray=Array.isArray||function(ee){return Y(ee)==="Array"},isArray}var isConstructor,hasRequiredIsConstructor;function requireIsConstructor(){if(hasRequiredIsConstructor)return isConstructor;hasRequiredIsConstructor=1;var Y=requireFunctionUncurryThis(),K=requireFails(),ee=requireIsCallable(),ne=requireClassof(),re=requireGetBuiltIn(),le=requireInspectSource(),Q=function(){},R=re("Reflect","construct"),U=/^\s*(?:class|function)\b/,Z=Y(U.exec),ae=!U.test(Q),he=function(ve){if(!ee(ve))return!1;try{return R(Q,[],ve),!0}catch{return!1}},pe=function(ve){if(!ee(ve))return!1;switch(ne(ve)){case"AsyncFunction":case"GeneratorFunction":case"AsyncGeneratorFunction":return!1}try{return ae||!!Z(U,le(ve))}catch{return!0}};return pe.sham=!0,isConstructor=!R||K(function(){var me;return he(he.call)||!he(Object)||!he(function(){me=!0})||me})?pe:he,isConstructor}var arraySpeciesConstructor,hasRequiredArraySpeciesConstructor;function requireArraySpeciesConstructor(){if(hasRequiredArraySpeciesConstructor)return arraySpeciesConstructor;hasRequiredArraySpeciesConstructor=1;var Y=requireIsArray$1(),K=requireIsConstructor(),ee=requireIsObject$1(),ne=requireWellKnownSymbol(),re=ne("species"),le=Array;return arraySpeciesConstructor=function(Q){var R;return Y(Q)&&(R=Q.constructor,K(R)&&(R===le||Y(R.prototype))?R=void 0:ee(R)&&(R=R[re],R===null&&(R=void 0))),R===void 0?le:R},arraySpeciesConstructor}var arraySpeciesCreate,hasRequiredArraySpeciesCreate;function requireArraySpeciesCreate(){if(hasRequiredArraySpeciesCreate)return arraySpeciesCreate;hasRequiredArraySpeciesCreate=1;var Y=requireArraySpeciesConstructor();return arraySpeciesCreate=function(K,ee){return new(Y(K))(ee===0?0:ee)},arraySpeciesCreate}var arrayIteration,hasRequiredArrayIteration;function requireArrayIteration(){if(hasRequiredArrayIteration)return arrayIteration;hasRequiredArrayIteration=1;var Y=requireFunctionBindContext(),K=requireFunctionUncurryThis(),ee=requireIndexedObject(),ne=requireToObject(),re=requireLengthOfArrayLike(),le=requireArraySpeciesCreate(),Q=K([].push),R=function(U){var Z=U===1,ae=U===2,he=U===3,pe=U===4,me=U===6,ve=U===7,Re=U===5||me;return function(Me,Te,Ce,We){for(var Fe=ne(Me),ke=ee(Fe),Ze=re(ke),Je=Y(Te,Ce),Qe=0,it=We||le,lt=Z?it(Me,Ze):ae||ve?it(Me,0):void 0,dt,yt;Ze>Qe;Qe++)if((Re||Qe in ke)&&(dt=ke[Qe],yt=Je(dt,Qe,Fe),U))if(Z)lt[Qe]=yt;else if(yt)switch(U){case 3:return!0;case 5:return dt;case 6:return Qe;case 2:Q(lt,dt)}else switch(U){case 4:return!1;case 7:Q(lt,dt)}return me?-1:he||pe?pe:lt}};return arrayIteration={forEach:R(0),map:R(1),filter:R(2),some:R(3),every:R(4),find:R(5),findIndex:R(6),filterReject:R(7)},arrayIteration}var hasRequiredEs_symbol_constructor;function requireEs_symbol_constructor(){if(hasRequiredEs_symbol_constructor)return es_symbol_constructor;hasRequiredEs_symbol_constructor=1;var Y=require_export(),K=requireGlobalThis(),ee=requireFunctionCall(),ne=requireFunctionUncurryThis(),re=requireIsPure(),le=requireDescriptors(),Q=requireSymbolConstructorDetection(),R=requireFails(),U=requireHasOwnProperty(),Z=requireObjectIsPrototypeOf(),ae=requireAnObject(),he=requireToIndexedObject(),pe=requireToPropertyKey(),me=requireToString$1(),ve=requireCreatePropertyDescriptor(),Re=requireObjectCreate(),Me=requireObjectKeys(),Te=requireObjectGetOwnPropertyNames(),Ce=requireObjectGetOwnPropertyNamesExternal(),We=requireObjectGetOwnPropertySymbols(),Fe=requireObjectGetOwnPropertyDescriptor(),ke=requireObjectDefineProperty(),Ze=requireObjectDefineProperties(),Je=requireObjectPropertyIsEnumerable(),Qe=requireDefineBuiltIn(),it=requireDefineBuiltInAccessor(),lt=requireShared(),dt=requireSharedKey(),yt=requireHiddenKeys(),gt=requireUid(),qt=requireWellKnownSymbol(),Ft=requireWellKnownSymbolWrapped(),Gt=requireWellKnownSymbolDefine(),ft=requireSymbolDefineToPrimitive(),Rt=requireSetToStringTag(),pt=requireInternalState(),At=requireArrayIteration().forEach,It=dt("hidden"),Dt="Symbol",Zt="prototype",nr=pt.set,Er=pt.getterFor(Dt),vr=Object[Zt],Sr=K.Symbol,Qt=Sr&&Sr[Zt],or=K.RangeError,Ir=K.TypeError,Rr=K.QObject,Cr=Fe.f,wr=ke.f,Wr=Ce.f,Kr=Je.f,Hr=ne([].push),br=lt("symbols"),Lr=lt("op-symbols"),Br=lt("wks"),zr=!Rr||!Rr[Zt]||!Rr[Zt].findChild,rr=function(ut,Ve,qe){var De=Cr(vr,Ve);De&&delete vr[Ve],wr(ut,Ve,qe),De&&ut!==vr&&wr(vr,Ve,De)},sr=le&&R(function(){return Re(wr({},"a",{get:function(){return wr(this,"a",{value:7}).a}})).a!==7})?rr:wr,Dr=function(ut,Ve){var qe=br[ut]=Re(Qt);return nr(qe,{type:Dt,tag:ut,description:Ve}),le||(qe.description=Ve),qe},lr=function(Ve,qe,De){Ve===vr&&lr(Lr,qe,De),ae(Ve);var ze=pe(qe);return ae(De),U(br,ze)?(De.enumerable?(U(Ve,It)&&Ve[It][ze]&&(Ve[It][ze]=!1),De=Re(De,{enumerable:ve(0,!1)})):(U(Ve,It)||wr(Ve,It,ve(1,Re(null))),Ve[It][ze]=!0),sr(Ve,ze,De)):wr(Ve,ze,De)},yr=function(Ve,qe){ae(Ve);var De=he(qe),ze=Me(De).concat(He(De));return At(ze,function(Le){(!le||ee(Ge,De,Le))&&lr(Ve,Le,De[Le])}),Ve},xr=function(Ve,qe){return qe===void 0?Re(Ve):yr(Re(Ve),qe)},Ge=function(Ve){var qe=pe(Ve),De=ee(Kr,this,qe);return this===vr&&U(br,qe)&&!U(Lr,qe)?!1:De||!U(this,qe)||!U(br,qe)||U(this,It)&&this[It][qe]?De:!0},Ee=function(Ve,qe){var De=he(Ve),ze=pe(qe);if(!(De===vr&&U(br,ze)&&!U(Lr,ze))){var Le=Cr(De,ze);return Le&&U(br,ze)&&!(U(De,It)&&De[It][ze])&&(Le.enumerable=!0),Le}},Pe=function(Ve){var qe=Wr(he(Ve)),De=[];return At(qe,function(ze){!U(br,ze)&&!U(yt,ze)&&Hr(De,ze)}),De},He=function(ut){var Ve=ut===vr,qe=Wr(Ve?Lr:he(ut)),De=[];return At(qe,function(ze){U(br,ze)&&(!Ve||U(vr,ze))&&Hr(De,br[ze])}),De};return Q||(Sr=function(){if(Z(Qt,this))throw new Ir("Symbol is not a constructor");var Ve=!arguments.length||arguments[0]===void 0?void 0:me(arguments[0]),qe=gt(Ve),De=function(ze){var Le=this===void 0?K:this;Le===vr&&ee(De,Lr,ze),U(Le,It)&&U(Le[It],qe)&&(Le[It][qe]=!1);var Ke=ve(1,ze);try{sr(Le,qe,Ke)}catch(et){if(!(et instanceof or))throw et;rr(Le,qe,Ke)}};return le&&zr&&sr(vr,qe,{configurable:!0,set:De}),Dr(qe,Ve)},Qt=Sr[Zt],Qe(Qt,"toString",function(){return Er(this).tag}),Qe(Sr,"withoutSetter",function(ut){return Dr(gt(ut),ut)}),Je.f=Ge,ke.f=lr,Ze.f=yr,Fe.f=Ee,Te.f=Ce.f=Pe,We.f=He,Ft.f=function(ut){return Dr(qt(ut),ut)},le&&(it(Qt,"description",{configurable:!0,get:function(){return Er(this).description}}),re||Qe(vr,"propertyIsEnumerable",Ge,{unsafe:!0}))),Y({global:!0,constructor:!0,wrap:!0,forced:!Q,sham:!Q},{Symbol:Sr}),At(Me(Br),function(ut){Gt(ut)}),Y({target:Dt,stat:!0,forced:!Q},{useSetter:function(){zr=!0},useSimple:function(){zr=!1}}),Y({target:"Object",stat:!0,forced:!Q,sham:!le},{create:xr,defineProperty:lr,defineProperties:yr,getOwnPropertyDescriptor:Ee}),Y({target:"Object",stat:!0,forced:!Q},{getOwnPropertyNames:Pe}),ft(),Rt(Sr,Dt),yt[It]=!0,es_symbol_constructor}var es_symbol_for={},symbolRegistryDetection,hasRequiredSymbolRegistryDetection;function requireSymbolRegistryDetection(){if(hasRequiredSymbolRegistryDetection)return symbolRegistryDetection;hasRequiredSymbolRegistryDetection=1;var Y=requireSymbolConstructorDetection();return symbolRegistryDetection=Y&&!!Symbol.for&&!!Symbol.keyFor,symbolRegistryDetection}var hasRequiredEs_symbol_for;function requireEs_symbol_for(){if(hasRequiredEs_symbol_for)return es_symbol_for;hasRequiredEs_symbol_for=1;var Y=require_export(),K=requireGetBuiltIn(),ee=requireHasOwnProperty(),ne=requireToString$1(),re=requireShared(),le=requireSymbolRegistryDetection(),Q=re("string-to-symbol-registry"),R=re("symbol-to-string-registry");return Y({target:"Symbol",stat:!0,forced:!le},{for:function(U){var Z=ne(U);if(ee(Q,Z))return Q[Z];var ae=K("Symbol")(Z);return Q[Z]=ae,R[ae]=Z,ae}}),es_symbol_for}var es_symbol_keyFor={},hasRequiredEs_symbol_keyFor;function requireEs_symbol_keyFor(){if(hasRequiredEs_symbol_keyFor)return es_symbol_keyFor;hasRequiredEs_symbol_keyFor=1;var Y=require_export(),K=requireHasOwnProperty(),ee=requireIsSymbol$1(),ne=requireTryToString(),re=requireShared(),le=requireSymbolRegistryDetection(),Q=re("symbol-to-string-registry");return Y({target:"Symbol",stat:!0,forced:!le},{keyFor:function(U){if(!ee(U))throw new TypeError(ne(U)+" is not a symbol");if(K(Q,U))return Q[U]}}),es_symbol_keyFor}var es_json_stringify={},functionApply,hasRequiredFunctionApply;function requireFunctionApply(){if(hasRequiredFunctionApply)return functionApply;hasRequiredFunctionApply=1;var Y=requireFunctionBindNative(),K=Function.prototype,ee=K.apply,ne=K.call;return functionApply=typeof Reflect=="object"&&Reflect.apply||(Y?ne.bind(ee):function(){return ne.apply(ee,arguments)}),functionApply}var getJsonReplacerFunction,hasRequiredGetJsonReplacerFunction;function requireGetJsonReplacerFunction(){if(hasRequiredGetJsonReplacerFunction)return getJsonReplacerFunction;hasRequiredGetJsonReplacerFunction=1;var Y=requireFunctionUncurryThis(),K=requireIsArray$1(),ee=requireIsCallable(),ne=requireClassofRaw(),re=requireToString$1(),le=Y([].push);return getJsonReplacerFunction=function(Q){if(ee(Q))return Q;if(K(Q)){for(var R=Q.length,U=[],Z=0;Z<R;Z++){var ae=Q[Z];typeof ae=="string"?le(U,ae):(typeof ae=="number"||ne(ae)==="Number"||ne(ae)==="String")&&le(U,re(ae))}var he=U.length,pe=!0;return function(me,ve){if(pe)return pe=!1,ve;if(K(this))return ve;for(var Re=0;Re<he;Re++)if(U[Re]===me)return ve}}},getJsonReplacerFunction}var hasRequiredEs_json_stringify;function requireEs_json_stringify(){if(hasRequiredEs_json_stringify)return es_json_stringify;hasRequiredEs_json_stringify=1;var Y=require_export(),K=requireGetBuiltIn(),ee=requireFunctionApply(),ne=requireFunctionCall(),re=requireFunctionUncurryThis(),le=requireFails(),Q=requireIsCallable(),R=requireIsSymbol$1(),U=requireArraySlice(),Z=requireGetJsonReplacerFunction(),ae=requireSymbolConstructorDetection(),he=String,pe=K("JSON","stringify"),me=re(/./.exec),ve=re("".charAt),Re=re("".charCodeAt),Me=re("".replace),Te=re(1.1.toString),Ce=/[\uD800-\uDFFF]/g,We=/^[\uD800-\uDBFF]$/,Fe=/^[\uDC00-\uDFFF]$/,ke=!ae||le(function(){var it=K("Symbol")("stringify detection");return pe([it])!=="[null]"||pe({a:it})!=="{}"||pe(Object(it))!=="{}"}),Ze=le(function(){return pe("\uDF06\uD834")!=='"\\udf06\\ud834"'||pe("\uDEAD")!=='"\\udead"'}),Je=function(it,lt){var dt=U(arguments),yt=Z(lt);if(!(!Q(yt)&&(it===void 0||R(it))))return dt[1]=function(gt,qt){if(Q(yt)&&(qt=ne(yt,this,he(gt),qt)),!R(qt))return qt},ee(pe,null,dt)},Qe=function(it,lt,dt){var yt=ve(dt,lt-1),gt=ve(dt,lt+1);return me(We,it)&&!me(Fe,gt)||me(Fe,it)&&!me(We,yt)?"\\u"+Te(Re(it,0),16):it};return pe&&Y({target:"JSON",stat:!0,arity:3,forced:ke||Ze},{stringify:function(lt,dt,yt){var gt=U(arguments),qt=ee(ke?Je:pe,null,gt);return Ze&&typeof qt=="string"?Me(qt,Ce,Qe):qt}}),es_json_stringify}var es_object_getOwnPropertySymbols={},hasRequiredEs_object_getOwnPropertySymbols;function requireEs_object_getOwnPropertySymbols(){if(hasRequiredEs_object_getOwnPropertySymbols)return es_object_getOwnPropertySymbols;hasRequiredEs_object_getOwnPropertySymbols=1;var Y=require_export(),K=requireSymbolConstructorDetection(),ee=requireFails(),ne=requireObjectGetOwnPropertySymbols(),re=requireToObject(),le=!K||ee(function(){ne.f(1)});return Y({target:"Object",stat:!0,forced:le},{getOwnPropertySymbols:function(R){var U=ne.f;return U?U(re(R)):[]}}),es_object_getOwnPropertySymbols}var hasRequiredEs_symbol;function requireEs_symbol(){return hasRequiredEs_symbol||(hasRequiredEs_symbol=1,requireEs_symbol_constructor(),requireEs_symbol_for(),requireEs_symbol_keyFor(),requireEs_json_stringify(),requireEs_object_getOwnPropertySymbols()),es_symbol}var es_symbol_description={},hasRequiredEs_symbol_description;function requireEs_symbol_description(){if(hasRequiredEs_symbol_description)return es_symbol_description;hasRequiredEs_symbol_description=1;var Y=require_export(),K=requireDescriptors(),ee=requireGlobalThis(),ne=requireFunctionUncurryThis(),re=requireHasOwnProperty(),le=requireIsCallable(),Q=requireObjectIsPrototypeOf(),R=requireToString$1(),U=requireDefineBuiltInAccessor(),Z=requireCopyConstructorProperties(),ae=ee.Symbol,he=ae&&ae.prototype;if(K&&le(ae)&&(!("description"in he)||ae().description!==void 0)){var pe={},me=function(){var ke=arguments.length<1||arguments[0]===void 0?void 0:R(arguments[0]),Ze=Q(he,this)?new ae(ke):ke===void 0?ae():ae(ke);return ke===""&&(pe[Ze]=!0),Ze};Z(me,ae),me.prototype=he,he.constructor=me;var ve=String(ae("description detection"))==="Symbol(description detection)",Re=ne(he.valueOf),Me=ne(he.toString),Te=/^Symbol\((.*)\)[^)]+$/,Ce=ne("".replace),We=ne("".slice);U(he,"description",{configurable:!0,get:function(){var ke=Re(this);if(re(pe,ke))return"";var Ze=Me(ke),Je=ve?We(Ze,7,-1):Ce(Ze,Te,"$1");return Je===""?void 0:Je}}),Y({global:!0,constructor:!0,forced:!0},{Symbol:me})}return es_symbol_description}var es_symbol_asyncDispose={},hasRequiredEs_symbol_asyncDispose;function requireEs_symbol_asyncDispose(){if(hasRequiredEs_symbol_asyncDispose)return es_symbol_asyncDispose;hasRequiredEs_symbol_asyncDispose=1;var Y=requireGlobalThis(),K=requireWellKnownSymbolDefine(),ee=requireObjectDefineProperty().f,ne=requireObjectGetOwnPropertyDescriptor().f,re=Y.Symbol;if(K("asyncDispose"),re){var le=ne(re,"asyncDispose");le.enumerable&&le.configurable&&le.writable&&ee(re,"asyncDispose",{value:le.value,enumerable:!1,configurable:!1,writable:!1})}return es_symbol_asyncDispose}var es_symbol_asyncIterator={},hasRequiredEs_symbol_asyncIterator;function requireEs_symbol_asyncIterator(){if(hasRequiredEs_symbol_asyncIterator)return es_symbol_asyncIterator;hasRequiredEs_symbol_asyncIterator=1;var Y=requireWellKnownSymbolDefine();return Y("asyncIterator"),es_symbol_asyncIterator}var es_symbol_dispose={},hasRequiredEs_symbol_dispose;function requireEs_symbol_dispose(){if(hasRequiredEs_symbol_dispose)return es_symbol_dispose;hasRequiredEs_symbol_dispose=1;var Y=requireGlobalThis(),K=requireWellKnownSymbolDefine(),ee=requireObjectDefineProperty().f,ne=requireObjectGetOwnPropertyDescriptor().f,re=Y.Symbol;if(K("dispose"),re){var le=ne(re,"dispose");le.enumerable&&le.configurable&&le.writable&&ee(re,"dispose",{value:le.value,enumerable:!1,configurable:!1,writable:!1})}return es_symbol_dispose}var es_symbol_hasInstance={},hasRequiredEs_symbol_hasInstance;function requireEs_symbol_hasInstance(){if(hasRequiredEs_symbol_hasInstance)return es_symbol_hasInstance;hasRequiredEs_symbol_hasInstance=1;var Y=requireWellKnownSymbolDefine();return Y("hasInstance"),es_symbol_hasInstance}var es_symbol_isConcatSpreadable={},hasRequiredEs_symbol_isConcatSpreadable;function requireEs_symbol_isConcatSpreadable(){if(hasRequiredEs_symbol_isConcatSpreadable)return es_symbol_isConcatSpreadable;hasRequiredEs_symbol_isConcatSpreadable=1;var Y=requireWellKnownSymbolDefine();return Y("isConcatSpreadable"),es_symbol_isConcatSpreadable}var es_symbol_iterator={},hasRequiredEs_symbol_iterator;function requireEs_symbol_iterator(){if(hasRequiredEs_symbol_iterator)return es_symbol_iterator;hasRequiredEs_symbol_iterator=1;var Y=requireWellKnownSymbolDefine();return Y("iterator"),es_symbol_iterator}var es_symbol_match={},hasRequiredEs_symbol_match;function requireEs_symbol_match(){if(hasRequiredEs_symbol_match)return es_symbol_match;hasRequiredEs_symbol_match=1;var Y=requireWellKnownSymbolDefine();return Y("match"),es_symbol_match}var es_symbol_matchAll={},hasRequiredEs_symbol_matchAll;function requireEs_symbol_matchAll(){if(hasRequiredEs_symbol_matchAll)return es_symbol_matchAll;hasRequiredEs_symbol_matchAll=1;var Y=requireWellKnownSymbolDefine();return Y("matchAll"),es_symbol_matchAll}var es_symbol_replace={},hasRequiredEs_symbol_replace;function requireEs_symbol_replace(){if(hasRequiredEs_symbol_replace)return es_symbol_replace;hasRequiredEs_symbol_replace=1;var Y=requireWellKnownSymbolDefine();return Y("replace"),es_symbol_replace}var es_symbol_search={},hasRequiredEs_symbol_search;function requireEs_symbol_search(){if(hasRequiredEs_symbol_search)return es_symbol_search;hasRequiredEs_symbol_search=1;var Y=requireWellKnownSymbolDefine();return Y("search"),es_symbol_search}var es_symbol_species={},hasRequiredEs_symbol_species;function requireEs_symbol_species(){if(hasRequiredEs_symbol_species)return es_symbol_species;hasRequiredEs_symbol_species=1;var Y=requireWellKnownSymbolDefine();return Y("species"),es_symbol_species}var es_symbol_split={},hasRequiredEs_symbol_split;function requireEs_symbol_split(){if(hasRequiredEs_symbol_split)return es_symbol_split;hasRequiredEs_symbol_split=1;var Y=requireWellKnownSymbolDefine();return Y("split"),es_symbol_split}var es_symbol_toPrimitive={},hasRequiredEs_symbol_toPrimitive;function requireEs_symbol_toPrimitive(){if(hasRequiredEs_symbol_toPrimitive)return es_symbol_toPrimitive;hasRequiredEs_symbol_toPrimitive=1;var Y=requireWellKnownSymbolDefine(),K=requireSymbolDefineToPrimitive();return Y("toPrimitive"),K(),es_symbol_toPrimitive}var es_symbol_toStringTag={},hasRequiredEs_symbol_toStringTag;function requireEs_symbol_toStringTag(){if(hasRequiredEs_symbol_toStringTag)return es_symbol_toStringTag;hasRequiredEs_symbol_toStringTag=1;var Y=requireGetBuiltIn(),K=requireWellKnownSymbolDefine(),ee=requireSetToStringTag();return K("toStringTag"),ee(Y("Symbol"),"Symbol"),es_symbol_toStringTag}var es_symbol_unscopables={},hasRequiredEs_symbol_unscopables;function requireEs_symbol_unscopables(){if(hasRequiredEs_symbol_unscopables)return es_symbol_unscopables;hasRequiredEs_symbol_unscopables=1;var Y=requireWellKnownSymbolDefine();return Y("unscopables"),es_symbol_unscopables}var es_error_cause={},functionUncurryThisAccessor,hasRequiredFunctionUncurryThisAccessor;function requireFunctionUncurryThisAccessor(){if(hasRequiredFunctionUncurryThisAccessor)return functionUncurryThisAccessor;hasRequiredFunctionUncurryThisAccessor=1;var Y=requireFunctionUncurryThis(),K=requireACallable();return functionUncurryThisAccessor=function(ee,ne,re){try{return Y(K(Object.getOwnPropertyDescriptor(ee,ne)[re]))}catch{}},functionUncurryThisAccessor}var isPossiblePrototype,hasRequiredIsPossiblePrototype;function requireIsPossiblePrototype(){if(hasRequiredIsPossiblePrototype)return isPossiblePrototype;hasRequiredIsPossiblePrototype=1;var Y=requireIsObject$1();return isPossiblePrototype=function(K){return Y(K)||K===null},isPossiblePrototype}var aPossiblePrototype,hasRequiredAPossiblePrototype;function requireAPossiblePrototype(){if(hasRequiredAPossiblePrototype)return aPossiblePrototype;hasRequiredAPossiblePrototype=1;var Y=requireIsPossiblePrototype(),K=String,ee=TypeError;return aPossiblePrototype=function(ne){if(Y(ne))return ne;throw new ee("Can't set "+K(ne)+" as a prototype")},aPossiblePrototype}var objectSetPrototypeOf,hasRequiredObjectSetPrototypeOf;function requireObjectSetPrototypeOf(){if(hasRequiredObjectSetPrototypeOf)return objectSetPrototypeOf;hasRequiredObjectSetPrototypeOf=1;var Y=requireFunctionUncurryThisAccessor(),K=requireIsObject$1(),ee=requireRequireObjectCoercible(),ne=requireAPossiblePrototype();return objectSetPrototypeOf=Object.setPrototypeOf||("__proto__"in{}?function(){var re=!1,le={},Q;try{Q=Y(Object.prototype,"__proto__","set"),Q(le,[]),re=le instanceof Array}catch{}return function(U,Z){return ee(U),ne(Z),K(U)&&(re?Q(U,Z):U.__proto__=Z),U}}():void 0),objectSetPrototypeOf}var proxyAccessor,hasRequiredProxyAccessor;function requireProxyAccessor(){if(hasRequiredProxyAccessor)return proxyAccessor;hasRequiredProxyAccessor=1;var Y=requireObjectDefineProperty().f;return proxyAccessor=function(K,ee,ne){ne in K||Y(K,ne,{configurable:!0,get:function(){return ee[ne]},set:function(re){ee[ne]=re}})},proxyAccessor}var inheritIfRequired,hasRequiredInheritIfRequired;function requireInheritIfRequired(){if(hasRequiredInheritIfRequired)return inheritIfRequired;hasRequiredInheritIfRequired=1;var Y=requireIsCallable(),K=requireIsObject$1(),ee=requireObjectSetPrototypeOf();return inheritIfRequired=function(ne,re,le){var Q,R;return ee&&Y(Q=re.constructor)&&Q!==le&&K(R=Q.prototype)&&R!==le.prototype&&ee(ne,R),ne},inheritIfRequired}var normalizeStringArgument,hasRequiredNormalizeStringArgument;function requireNormalizeStringArgument(){if(hasRequiredNormalizeStringArgument)return normalizeStringArgument;hasRequiredNormalizeStringArgument=1;var Y=requireToString$1();return normalizeStringArgument=function(K,ee){return K===void 0?arguments.length<2?"":ee:Y(K)},normalizeStringArgument}var installErrorCause,hasRequiredInstallErrorCause;function requireInstallErrorCause(){if(hasRequiredInstallErrorCause)return installErrorCause;hasRequiredInstallErrorCause=1;var Y=requireIsObject$1(),K=requireCreateNonEnumerableProperty();return installErrorCause=function(ee,ne){Y(ne)&&"cause"in ne&&K(ee,"cause",ne.cause)},installErrorCause}var errorStackClear,hasRequiredErrorStackClear;function requireErrorStackClear(){if(hasRequiredErrorStackClear)return errorStackClear;hasRequiredErrorStackClear=1;var Y=requireFunctionUncurryThis(),K=Error,ee=Y("".replace),ne=function(Q){return String(new K(Q).stack)}("zxcasd"),re=/\n\s*at [^:]*:[^\n]*/,le=re.test(ne);return errorStackClear=function(Q,R){if(le&&typeof Q=="string"&&!K.prepareStackTrace)for(;R--;)Q=ee(Q,re,"");return Q},errorStackClear}var errorStackInstallable,hasRequiredErrorStackInstallable;function requireErrorStackInstallable(){if(hasRequiredErrorStackInstallable)return errorStackInstallable;hasRequiredErrorStackInstallable=1;var Y=requireFails(),K=requireCreatePropertyDescriptor();return errorStackInstallable=!Y(function(){var ee=new Error("a");return"stack"in ee?(Object.defineProperty(ee,"stack",K(1,7)),ee.stack!==7):!0}),errorStackInstallable}var errorStackInstall,hasRequiredErrorStackInstall;function requireErrorStackInstall(){if(hasRequiredErrorStackInstall)return errorStackInstall;hasRequiredErrorStackInstall=1;var Y=requireCreateNonEnumerableProperty(),K=requireErrorStackClear(),ee=requireErrorStackInstallable(),ne=Error.captureStackTrace;return errorStackInstall=function(re,le,Q,R){ee&&(ne?ne(re,le):Y(re,"stack",K(Q,R)))},errorStackInstall}var wrapErrorConstructorWithCause,hasRequiredWrapErrorConstructorWithCause;function requireWrapErrorConstructorWithCause(){if(hasRequiredWrapErrorConstructorWithCause)return wrapErrorConstructorWithCause;hasRequiredWrapErrorConstructorWithCause=1;var Y=requireGetBuiltIn(),K=requireHasOwnProperty(),ee=requireCreateNonEnumerableProperty(),ne=requireObjectIsPrototypeOf(),re=requireObjectSetPrototypeOf(),le=requireCopyConstructorProperties(),Q=requireProxyAccessor(),R=requireInheritIfRequired(),U=requireNormalizeStringArgument(),Z=requireInstallErrorCause(),ae=requireErrorStackInstall(),he=requireDescriptors(),pe=requireIsPure();return wrapErrorConstructorWithCause=function(me,ve,Re,Me){var Te="stackTraceLimit",Ce=Me?2:1,We=me.split("."),Fe=We[We.length-1],ke=Y.apply(null,We);if(ke){var Ze=ke.prototype;if(!pe&&K(Ze,"cause")&&delete Ze.cause,!Re)return ke;var Je=Y("Error"),Qe=ve(function(it,lt){var dt=U(Me?lt:it,void 0),yt=Me?new ke(it):new ke;return dt!==void 0&&ee(yt,"message",dt),ae(yt,Qe,yt.stack,2),this&&ne(Ze,this)&&R(yt,this,Qe),arguments.length>Ce&&Z(yt,arguments[Ce]),yt});if(Qe.prototype=Ze,Fe!=="Error"?re?re(Qe,Je):le(Qe,Je,{name:!0}):he&&Te in ke&&(Q(Qe,ke,Te),Q(Qe,ke,"prepareStackTrace")),le(Qe,ke),!pe)try{Ze.name!==Fe&&ee(Ze,"name",Fe),Ze.constructor=Qe}catch{}return Qe}},wrapErrorConstructorWithCause}var hasRequiredEs_error_cause;function requireEs_error_cause(){if(hasRequiredEs_error_cause)return es_error_cause;hasRequiredEs_error_cause=1;var Y=require_export(),K=requireGlobalThis(),ee=requireFunctionApply(),ne=requireWrapErrorConstructorWithCause(),re="WebAssembly",le=K[re],Q=new Error("e",{cause:7}).cause!==7,R=function(Z,ae){var he={};he[Z]=ne(Z,ae,Q),Y({global:!0,constructor:!0,arity:1,forced:Q},he)},U=function(Z,ae){if(le&&le[Z]){var he={};he[Z]=ne(re+"."+Z,ae,Q),Y({target:re,stat:!0,constructor:!0,arity:1,forced:Q},he)}};return R("Error",function(Z){return function(he){return ee(Z,this,arguments)}}),R("EvalError",function(Z){return function(he){return ee(Z,this,arguments)}}),R("RangeError",function(Z){return function(he){return ee(Z,this,arguments)}}),R("ReferenceError",function(Z){return function(he){return ee(Z,this,arguments)}}),R("SyntaxError",function(Z){return function(he){return ee(Z,this,arguments)}}),R("TypeError",function(Z){return function(he){return ee(Z,this,arguments)}}),R("URIError",function(Z){return function(he){return ee(Z,this,arguments)}}),U("CompileError",function(Z){return function(he){return ee(Z,this,arguments)}}),U("LinkError",function(Z){return function(he){return ee(Z,this,arguments)}}),U("RuntimeError",function(Z){return function(he){return ee(Z,this,arguments)}}),es_error_cause}var es_error_isError={},hasRequiredEs_error_isError;function requireEs_error_isError(){if(hasRequiredEs_error_isError)return es_error_isError;hasRequiredEs_error_isError=1;var Y=require_export(),K=requireGetBuiltIn(),ee=requireIsObject$1(),ne=requireClassof(),re=requireFails(),le="Error",Q="DOMException",R=Object.setPrototypeOf||{}.__proto__,U=K(Q),Z=Error,ae=Z.isError,he=!ae||!R||re(function(){return U&&!ae(new U(Q))||!ae(new Z(le,{cause:function(){}}))||ae(K("Object","create")(Z.prototype))});return Y({target:"Error",stat:!0,sham:!0,forced:he},{isError:function(me){if(!ee(me))return!1;var ve=ne(me);return ve===le||ve===Q}}),es_error_isError}var es_error_toString={},errorToString,hasRequiredErrorToString;function requireErrorToString(){if(hasRequiredErrorToString)return errorToString;hasRequiredErrorToString=1;var Y=requireDescriptors(),K=requireFails(),ee=requireAnObject(),ne=requireNormalizeStringArgument(),re=Error.prototype.toString,le=K(function(){if(Y){var Q=Object.create(Object.defineProperty({},"name",{get:function(){return this===Q}}));if(re.call(Q)!=="true")return!0}return re.call({message:1,name:2})!=="2: 1"||re.call({})!=="Error"});return errorToString=le?function(){var R=ee(this),U=ne(R.name,"Error"),Z=ne(R.message);return U?Z?U+": "+Z:U:Z}:re,errorToString}var hasRequiredEs_error_toString;function requireEs_error_toString(){if(hasRequiredEs_error_toString)return es_error_toString;hasRequiredEs_error_toString=1;var Y=requireDefineBuiltIn(),K=requireErrorToString(),ee=Error.prototype;return ee.toString!==K&&Y(ee,"toString",K),es_error_toString}var es_aggregateError={},es_aggregateError_constructor={},correctPrototypeGetter,hasRequiredCorrectPrototypeGetter;function requireCorrectPrototypeGetter(){if(hasRequiredCorrectPrototypeGetter)return correctPrototypeGetter;hasRequiredCorrectPrototypeGetter=1;var Y=requireFails();return correctPrototypeGetter=!Y(function(){function K(){}return K.prototype.constructor=null,Object.getPrototypeOf(new K)!==K.prototype}),correctPrototypeGetter}var objectGetPrototypeOf,hasRequiredObjectGetPrototypeOf;function requireObjectGetPrototypeOf(){if(hasRequiredObjectGetPrototypeOf)return objectGetPrototypeOf;hasRequiredObjectGetPrototypeOf=1;var Y=requireHasOwnProperty(),K=requireIsCallable(),ee=requireToObject(),ne=requireSharedKey(),re=requireCorrectPrototypeGetter(),le=ne("IE_PROTO"),Q=Object,R=Q.prototype;return objectGetPrototypeOf=re?Q.getPrototypeOf:function(U){var Z=ee(U);if(Y(Z,le))return Z[le];var ae=Z.constructor;return K(ae)&&Z instanceof ae?ae.prototype:Z instanceof Q?R:null},objectGetPrototypeOf}var iterators,hasRequiredIterators;function requireIterators(){return hasRequiredIterators||(hasRequiredIterators=1,iterators={}),iterators}var isArrayIteratorMethod,hasRequiredIsArrayIteratorMethod;function requireIsArrayIteratorMethod(){if(hasRequiredIsArrayIteratorMethod)return isArrayIteratorMethod;hasRequiredIsArrayIteratorMethod=1;var Y=requireWellKnownSymbol(),K=requireIterators(),ee=Y("iterator"),ne=Array.prototype;return isArrayIteratorMethod=function(re){return re!==void 0&&(K.Array===re||ne[ee]===re)},isArrayIteratorMethod}var getIteratorMethod,hasRequiredGetIteratorMethod;function requireGetIteratorMethod(){if(hasRequiredGetIteratorMethod)return getIteratorMethod;hasRequiredGetIteratorMethod=1;var Y=requireClassof(),K=requireGetMethod(),ee=requireIsNullOrUndefined(),ne=requireIterators(),re=requireWellKnownSymbol(),le=re("iterator");return getIteratorMethod=function(Q){if(!ee(Q))return K(Q,le)||K(Q,"@@iterator")||ne[Y(Q)]},getIteratorMethod}var getIterator,hasRequiredGetIterator;function requireGetIterator(){if(hasRequiredGetIterator)return getIterator;hasRequiredGetIterator=1;var Y=requireFunctionCall(),K=requireACallable(),ee=requireAnObject(),ne=requireTryToString(),re=requireGetIteratorMethod(),le=TypeError;return getIterator=function(Q,R){var U=arguments.length<2?re(Q):R;if(K(U))return ee(Y(U,Q));throw new le(ne(Q)+" is not iterable")},getIterator}var iteratorClose,hasRequiredIteratorClose;function requireIteratorClose(){if(hasRequiredIteratorClose)return iteratorClose;hasRequiredIteratorClose=1;var Y=requireFunctionCall(),K=requireAnObject(),ee=requireGetMethod();return iteratorClose=function(ne,re,le){var Q,R;K(ne);try{if(Q=ee(ne,"return"),!Q){if(re==="throw")throw le;return le}Q=Y(Q,ne)}catch(U){R=!0,Q=U}if(re==="throw")throw le;if(R)throw Q;return K(Q),le},iteratorClose}var iterate,hasRequiredIterate;function requireIterate(){if(hasRequiredIterate)return iterate;hasRequiredIterate=1;var Y=requireFunctionBindContext(),K=requireFunctionCall(),ee=requireAnObject(),ne=requireTryToString(),re=requireIsArrayIteratorMethod(),le=requireLengthOfArrayLike(),Q=requireObjectIsPrototypeOf(),R=requireGetIterator(),U=requireGetIteratorMethod(),Z=requireIteratorClose(),ae=TypeError,he=function(me,ve){this.stopped=me,this.result=ve},pe=he.prototype;return iterate=function(me,ve,Re){var Me=Re&&Re.that,Te=!!(Re&&Re.AS_ENTRIES),Ce=!!(Re&&Re.IS_RECORD),We=!!(Re&&Re.IS_ITERATOR),Fe=!!(Re&&Re.INTERRUPTED),ke=Y(ve,Me),Ze,Je,Qe,it,lt,dt,yt,gt=function(Ft){return Ze&&Z(Ze,"normal"),new he(!0,Ft)},qt=function(Ft){return Te?(ee(Ft),Fe?ke(Ft[0],Ft[1],gt):ke(Ft[0],Ft[1])):Fe?ke(Ft,gt):ke(Ft)};if(Ce)Ze=me.iterator;else if(We)Ze=me;else{if(Je=U(me),!Je)throw new ae(ne(me)+" is not iterable");if(re(Je)){for(Qe=0,it=le(me);it>Qe;Qe++)if(lt=qt(me[Qe]),lt&&Q(pe,lt))return lt;return new he(!1)}Ze=R(me,Je)}for(dt=Ce?me.next:Ze.next;!(yt=K(dt,Ze)).done;){try{lt=qt(yt.value)}catch(Ft){Z(Ze,"throw",Ft)}if(typeof lt=="object"&&lt&&Q(pe,lt))return lt}return new he(!1)},iterate}var hasRequiredEs_aggregateError_constructor;function requireEs_aggregateError_constructor(){if(hasRequiredEs_aggregateError_constructor)return es_aggregateError_constructor;hasRequiredEs_aggregateError_constructor=1;var Y=require_export(),K=requireObjectIsPrototypeOf(),ee=requireObjectGetPrototypeOf(),ne=requireObjectSetPrototypeOf(),re=requireCopyConstructorProperties(),le=requireObjectCreate(),Q=requireCreateNonEnumerableProperty(),R=requireCreatePropertyDescriptor(),U=requireInstallErrorCause(),Z=requireErrorStackInstall(),ae=requireIterate(),he=requireNormalizeStringArgument(),pe=requireWellKnownSymbol(),me=pe("toStringTag"),ve=Error,Re=[].push,Me=function(We,Fe){var ke=K(Te,this),Ze;ne?Ze=ne(new ve,ke?ee(this):Te):(Ze=ke?this:le(Te),Q(Ze,me,"Error")),Fe!==void 0&&Q(Ze,"message",he(Fe)),Z(Ze,Me,Ze.stack,1),arguments.length>2&&U(Ze,arguments[2]);var Je=[];return ae(We,Re,{that:Je}),Q(Ze,"errors",Je),Ze};ne?ne(Me,ve):re(Me,ve,{name:!0});var Te=Me.prototype=le(ve.prototype,{constructor:R(1,Me),message:R(1,""),name:R(1,"AggregateError")});return Y({global:!0,constructor:!0,arity:2},{AggregateError:Me}),es_aggregateError_constructor}var hasRequiredEs_aggregateError;function requireEs_aggregateError(){return hasRequiredEs_aggregateError||(hasRequiredEs_aggregateError=1,requireEs_aggregateError_constructor()),es_aggregateError}var es_aggregateError_cause={},hasRequiredEs_aggregateError_cause;function requireEs_aggregateError_cause(){if(hasRequiredEs_aggregateError_cause)return es_aggregateError_cause;hasRequiredEs_aggregateError_cause=1;var Y=require_export(),K=requireGetBuiltIn(),ee=requireFunctionApply(),ne=requireFails(),re=requireWrapErrorConstructorWithCause(),le="AggregateError",Q=K(le),R=!ne(function(){return Q([1]).errors[0]!==1})&&ne(function(){return Q([1],le,{cause:7}).cause!==7});return Y({global:!0,constructor:!0,arity:2,forced:R},{AggregateError:re(le,function(U){return function(ae,he){return ee(U,this,arguments)}},R,!0)}),es_aggregateError_cause}var es_suppressedError_constructor={},hasRequiredEs_suppressedError_constructor;function requireEs_suppressedError_constructor(){if(hasRequiredEs_suppressedError_constructor)return es_suppressedError_constructor;hasRequiredEs_suppressedError_constructor=1;var Y=require_export(),K=requireGlobalThis(),ee=requireObjectIsPrototypeOf(),ne=requireObjectGetPrototypeOf(),re=requireObjectSetPrototypeOf(),le=requireCopyConstructorProperties(),Q=requireObjectCreate(),R=requireCreateNonEnumerableProperty(),U=requireCreatePropertyDescriptor(),Z=requireErrorStackInstall(),ae=requireNormalizeStringArgument(),he=requireWellKnownSymbol(),pe=requireFails(),me=requireIsPure(),ve=K.SuppressedError,Re=he("toStringTag"),Me=Error,Te=!!ve&&ve.length!==3,Ce=!!ve&&pe(function(){return new ve(1,2,3,{cause:4}).cause===4}),We=Te||Ce,Fe=function(Je,Qe,it){var lt=ee(ke,this),dt;return re?dt=We&&(!lt||ne(this)===ke)?new ve:re(new Me,lt?ne(this):ke):(dt=lt?this:Q(ke),R(dt,Re,"Error")),it!==void 0&&R(dt,"message",ae(it)),Z(dt,Fe,dt.stack,1),R(dt,"error",Je),R(dt,"suppressed",Qe),dt};re?re(Fe,Me):le(Fe,Me,{name:!0});var ke=Fe.prototype=We?ve.prototype:Q(Me.prototype,{constructor:U(1,Fe),message:U(1,""),name:U(1,"SuppressedError")});return We&&!me&&(ke.constructor=Fe),Y({global:!0,constructor:!0,arity:3,forced:We},{SuppressedError:Fe}),es_suppressedError_constructor}var es_array_at={},addToUnscopables,hasRequiredAddToUnscopables;function requireAddToUnscopables(){if(hasRequiredAddToUnscopables)return addToUnscopables;hasRequiredAddToUnscopables=1;var Y=requireWellKnownSymbol(),K=requireObjectCreate(),ee=requireObjectDefineProperty().f,ne=Y("unscopables"),re=Array.prototype;return re[ne]===void 0&&ee(re,ne,{configurable:!0,value:K(null)}),addToUnscopables=function(le){re[ne][le]=!0},addToUnscopables}var hasRequiredEs_array_at;function requireEs_array_at(){if(hasRequiredEs_array_at)return es_array_at;hasRequiredEs_array_at=1;var Y=require_export(),K=requireToObject(),ee=requireLengthOfArrayLike(),ne=requireToIntegerOrInfinity(),re=requireAddToUnscopables();return Y({target:"Array",proto:!0},{at:function(Q){var R=K(this),U=ee(R),Z=ne(Q),ae=Z>=0?Z:U+Z;return ae<0||ae>=U?void 0:R[ae]}}),re("at"),es_array_at}var es_array_concat={},doesNotExceedSafeInteger,hasRequiredDoesNotExceedSafeInteger;function requireDoesNotExceedSafeInteger(){if(hasRequiredDoesNotExceedSafeInteger)return doesNotExceedSafeInteger;hasRequiredDoesNotExceedSafeInteger=1;var Y=TypeError,K=9007199254740991;return doesNotExceedSafeInteger=function(ee){if(ee>K)throw Y("Maximum allowed index exceeded");return ee},doesNotExceedSafeInteger}var createProperty,hasRequiredCreateProperty;function requireCreateProperty(){if(hasRequiredCreateProperty)return createProperty;hasRequiredCreateProperty=1;var Y=requireDescriptors(),K=requireObjectDefineProperty(),ee=requireCreatePropertyDescriptor();return createProperty=function(ne,re,le){Y?K.f(ne,re,ee(0,le)):ne[re]=le},createProperty}var arrayMethodHasSpeciesSupport,hasRequiredArrayMethodHasSpeciesSupport;function requireArrayMethodHasSpeciesSupport(){if(hasRequiredArrayMethodHasSpeciesSupport)return arrayMethodHasSpeciesSupport;hasRequiredArrayMethodHasSpeciesSupport=1;var Y=requireFails(),K=requireWellKnownSymbol(),ee=requireEnvironmentV8Version(),ne=K("species");return arrayMethodHasSpeciesSupport=function(re){return ee>=51||!Y(function(){var le=[],Q=le.constructor={};return Q[ne]=function(){return{foo:1}},le[re](Boolean).foo!==1})},arrayMethodHasSpeciesSupport}var hasRequiredEs_array_concat;function requireEs_array_concat(){if(hasRequiredEs_array_concat)return es_array_concat;hasRequiredEs_array_concat=1;var Y=require_export(),K=requireFails(),ee=requireIsArray$1(),ne=requireIsObject$1(),re=requireToObject(),le=requireLengthOfArrayLike(),Q=requireDoesNotExceedSafeInteger(),R=requireCreateProperty(),U=requireArraySpeciesCreate(),Z=requireArrayMethodHasSpeciesSupport(),ae=requireWellKnownSymbol(),he=requireEnvironmentV8Version(),pe=ae("isConcatSpreadable"),me=he>=51||!K(function(){var Me=[];return Me[pe]=!1,Me.concat()[0]!==Me}),ve=function(Me){if(!ne(Me))return!1;var Te=Me[pe];return Te!==void 0?!!Te:ee(Me)},Re=!me||!Z("concat");return Y({target:"Array",proto:!0,arity:1,forced:Re},{concat:function(Te){var Ce=re(this),We=U(Ce,0),Fe=0,ke,Ze,Je,Qe,it;for(ke=-1,Je=arguments.length;ke<Je;ke++)if(it=ke===-1?Ce:arguments[ke],ve(it))for(Qe=le(it),Q(Fe+Qe),Ze=0;Ze<Qe;Ze++,Fe++)Ze in it&&R(We,Fe,it[Ze]);else Q(Fe+1),R(We,Fe++,it);return We.length=Fe,We}}),es_array_concat}var es_array_copyWithin={},deletePropertyOrThrow,hasRequiredDeletePropertyOrThrow;function requireDeletePropertyOrThrow(){if(hasRequiredDeletePropertyOrThrow)return deletePropertyOrThrow;hasRequiredDeletePropertyOrThrow=1;var Y=requireTryToString(),K=TypeError;return deletePropertyOrThrow=function(ee,ne){if(!delete ee[ne])throw new K("Cannot delete property "+Y(ne)+" of "+Y(ee))},deletePropertyOrThrow}var arrayCopyWithin,hasRequiredArrayCopyWithin;function requireArrayCopyWithin(){if(hasRequiredArrayCopyWithin)return arrayCopyWithin;hasRequiredArrayCopyWithin=1;var Y=requireToObject(),K=requireToAbsoluteIndex(),ee=requireLengthOfArrayLike(),ne=requireDeletePropertyOrThrow(),re=Math.min;return arrayCopyWithin=[].copyWithin||function(Q,R){var U=Y(this),Z=ee(U),ae=K(Q,Z),he=K(R,Z),pe=arguments.length>2?arguments[2]:void 0,me=re((pe===void 0?Z:K(pe,Z))-he,Z-ae),ve=1;for(he<ae&&ae<he+me&&(ve=-1,he+=me-1,ae+=me-1);me-- >0;)he in U?U[ae]=U[he]:ne(U,ae),ae+=ve,he+=ve;return U},arrayCopyWithin}var hasRequiredEs_array_copyWithin;function requireEs_array_copyWithin(){if(hasRequiredEs_array_copyWithin)return es_array_copyWithin;hasRequiredEs_array_copyWithin=1;var Y=require_export(),K=requireArrayCopyWithin(),ee=requireAddToUnscopables();return Y({target:"Array",proto:!0},{copyWithin:K}),ee("copyWithin"),es_array_copyWithin}var es_array_every={},arrayMethodIsStrict,hasRequiredArrayMethodIsStrict;function requireArrayMethodIsStrict(){if(hasRequiredArrayMethodIsStrict)return arrayMethodIsStrict;hasRequiredArrayMethodIsStrict=1;var Y=requireFails();return arrayMethodIsStrict=function(K,ee){var ne=[][K];return!!ne&&Y(function(){ne.call(null,ee||function(){return 1},1)})},arrayMethodIsStrict}var hasRequiredEs_array_every;function requireEs_array_every(){if(hasRequiredEs_array_every)return es_array_every;hasRequiredEs_array_every=1;var Y=require_export(),K=requireArrayIteration().every,ee=requireArrayMethodIsStrict(),ne=ee("every");return Y({target:"Array",proto:!0,forced:!ne},{every:function(le){return K(this,le,arguments.length>1?arguments[1]:void 0)}}),es_array_every}var es_array_fill={},arrayFill,hasRequiredArrayFill;function requireArrayFill(){if(hasRequiredArrayFill)return arrayFill;hasRequiredArrayFill=1;var Y=requireToObject(),K=requireToAbsoluteIndex(),ee=requireLengthOfArrayLike();return arrayFill=function(re){for(var le=Y(this),Q=ee(le),R=arguments.length,U=K(R>1?arguments[1]:void 0,Q),Z=R>2?arguments[2]:void 0,ae=Z===void 0?Q:K(Z,Q);ae>U;)le[U++]=re;return le},arrayFill}var hasRequiredEs_array_fill;function requireEs_array_fill(){if(hasRequiredEs_array_fill)return es_array_fill;hasRequiredEs_array_fill=1;var Y=require_export(),K=requireArrayFill(),ee=requireAddToUnscopables();return Y({target:"Array",proto:!0},{fill:K}),ee("fill"),es_array_fill}var es_array_filter={},hasRequiredEs_array_filter;function requireEs_array_filter(){if(hasRequiredEs_array_filter)return es_array_filter;hasRequiredEs_array_filter=1;var Y=require_export(),K=requireArrayIteration().filter,ee=requireArrayMethodHasSpeciesSupport(),ne=ee("filter");return Y({target:"Array",proto:!0,forced:!ne},{filter:function(le){return K(this,le,arguments.length>1?arguments[1]:void 0)}}),es_array_filter}var es_array_find={},hasRequiredEs_array_find;function requireEs_array_find(){if(hasRequiredEs_array_find)return es_array_find;hasRequiredEs_array_find=1;var Y=require_export(),K=requireArrayIteration().find,ee=requireAddToUnscopables(),ne="find",re=!0;return ne in[]&&Array(1)[ne](function(){re=!1}),Y({target:"Array",proto:!0,forced:re},{find:function(Q){return K(this,Q,arguments.length>1?arguments[1]:void 0)}}),ee(ne),es_array_find}var es_array_findIndex={},hasRequiredEs_array_findIndex;function requireEs_array_findIndex(){if(hasRequiredEs_array_findIndex)return es_array_findIndex;hasRequiredEs_array_findIndex=1;var Y=require_export(),K=requireArrayIteration().findIndex,ee=requireAddToUnscopables(),ne="findIndex",re=!0;return ne in[]&&Array(1)[ne](function(){re=!1}),Y({target:"Array",proto:!0,forced:re},{findIndex:function(Q){return K(this,Q,arguments.length>1?arguments[1]:void 0)}}),ee(ne),es_array_findIndex}var es_array_findLast={},arrayIterationFromLast,hasRequiredArrayIterationFromLast;function requireArrayIterationFromLast(){if(hasRequiredArrayIterationFromLast)return arrayIterationFromLast;hasRequiredArrayIterationFromLast=1;var Y=requireFunctionBindContext(),K=requireIndexedObject(),ee=requireToObject(),ne=requireLengthOfArrayLike(),re=function(le){var Q=le===1;return function(R,U,Z){for(var ae=ee(R),he=K(ae),pe=ne(he),me=Y(U,Z),ve,Re;pe-- >0;)if(ve=he[pe],Re=me(ve,pe,ae),Re)switch(le){case 0:return ve;case 1:return pe}return Q?-1:void 0}};return arrayIterationFromLast={findLast:re(0),findLastIndex:re(1)},arrayIterationFromLast}var hasRequiredEs_array_findLast;function requireEs_array_findLast(){if(hasRequiredEs_array_findLast)return es_array_findLast;hasRequiredEs_array_findLast=1;var Y=require_export(),K=requireArrayIterationFromLast().findLast,ee=requireAddToUnscopables();return Y({target:"Array",proto:!0},{findLast:function(re){return K(this,re,arguments.length>1?arguments[1]:void 0)}}),ee("findLast"),es_array_findLast}var es_array_findLastIndex={},hasRequiredEs_array_findLastIndex;function requireEs_array_findLastIndex(){if(hasRequiredEs_array_findLastIndex)return es_array_findLastIndex;hasRequiredEs_array_findLastIndex=1;var Y=require_export(),K=requireArrayIterationFromLast().findLastIndex,ee=requireAddToUnscopables();return Y({target:"Array",proto:!0},{findLastIndex:function(re){return K(this,re,arguments.length>1?arguments[1]:void 0)}}),ee("findLastIndex"),es_array_findLastIndex}var es_array_flat={},flattenIntoArray_1,hasRequiredFlattenIntoArray;function requireFlattenIntoArray(){if(hasRequiredFlattenIntoArray)return flattenIntoArray_1;hasRequiredFlattenIntoArray=1;var Y=requireIsArray$1(),K=requireLengthOfArrayLike(),ee=requireDoesNotExceedSafeInteger(),ne=requireFunctionBindContext(),re=function(le,Q,R,U,Z,ae,he,pe){for(var me=Z,ve=0,Re=he?ne(he,pe):!1,Me,Te;ve<U;)ve in R&&(Me=Re?Re(R[ve],ve,Q):R[ve],ae>0&&Y(Me)?(Te=K(Me),me=re(le,Q,Me,Te,me,ae-1)-1):(ee(me+1),le[me]=Me),me++),ve++;return me};return flattenIntoArray_1=re,flattenIntoArray_1}var hasRequiredEs_array_flat;function requireEs_array_flat(){if(hasRequiredEs_array_flat)return es_array_flat;hasRequiredEs_array_flat=1;var Y=require_export(),K=requireFlattenIntoArray(),ee=requireToObject(),ne=requireLengthOfArrayLike(),re=requireToIntegerOrInfinity(),le=requireArraySpeciesCreate();return Y({target:"Array",proto:!0},{flat:function(){var R=arguments.length?arguments[0]:void 0,U=ee(this),Z=ne(U),ae=le(U,0);return ae.length=K(ae,U,U,Z,0,R===void 0?1:re(R)),ae}}),es_array_flat}var es_array_flatMap={},hasRequiredEs_array_flatMap;function requireEs_array_flatMap(){if(hasRequiredEs_array_flatMap)return es_array_flatMap;hasRequiredEs_array_flatMap=1;var Y=require_export(),K=requireFlattenIntoArray(),ee=requireACallable(),ne=requireToObject(),re=requireLengthOfArrayLike(),le=requireArraySpeciesCreate();return Y({target:"Array",proto:!0},{flatMap:function(R){var U=ne(this),Z=re(U),ae;return ee(R),ae=le(U,0),ae.length=K(ae,U,U,Z,0,1,R,arguments.length>1?arguments[1]:void 0),ae}}),es_array_flatMap}var es_array_forEach={},arrayForEach,hasRequiredArrayForEach;function requireArrayForEach(){if(hasRequiredArrayForEach)return arrayForEach;hasRequiredArrayForEach=1;var Y=requireArrayIteration().forEach,K=requireArrayMethodIsStrict(),ee=K("forEach");return arrayForEach=ee?[].forEach:function(re){return Y(this,re,arguments.length>1?arguments[1]:void 0)},arrayForEach}var hasRequiredEs_array_forEach;function requireEs_array_forEach(){if(hasRequiredEs_array_forEach)return es_array_forEach;hasRequiredEs_array_forEach=1;var Y=require_export(),K=requireArrayForEach();return Y({target:"Array",proto:!0,forced:[].forEach!==K},{forEach:K}),es_array_forEach}var es_array_from={},callWithSafeIterationClosing,hasRequiredCallWithSafeIterationClosing;function requireCallWithSafeIterationClosing(){if(hasRequiredCallWithSafeIterationClosing)return callWithSafeIterationClosing;hasRequiredCallWithSafeIterationClosing=1;var Y=requireAnObject(),K=requireIteratorClose();return callWithSafeIterationClosing=function(ee,ne,re,le){try{return le?ne(Y(re)[0],re[1]):ne(re)}catch(Q){K(ee,"throw",Q)}},callWithSafeIterationClosing}var arrayFrom,hasRequiredArrayFrom;function requireArrayFrom(){if(hasRequiredArrayFrom)return arrayFrom;hasRequiredArrayFrom=1;var Y=requireFunctionBindContext(),K=requireFunctionCall(),ee=requireToObject(),ne=requireCallWithSafeIterationClosing(),re=requireIsArrayIteratorMethod(),le=requireIsConstructor(),Q=requireLengthOfArrayLike(),R=requireCreateProperty(),U=requireGetIterator(),Z=requireGetIteratorMethod(),ae=Array;return arrayFrom=function(pe){var me=ee(pe),ve=le(this),Re=arguments.length,Me=Re>1?arguments[1]:void 0,Te=Me!==void 0;Te&&(Me=Y(Me,Re>2?arguments[2]:void 0));var Ce=Z(me),We=0,Fe,ke,Ze,Je,Qe,it;if(Ce&&!(this===ae&&re(Ce)))for(ke=ve?new this:[],Je=U(me,Ce),Qe=Je.next;!(Ze=K(Qe,Je)).done;We++)it=Te?ne(Je,Me,[Ze.value,We],!0):Ze.value,R(ke,We,it);else for(Fe=Q(me),ke=ve?new this(Fe):ae(Fe);Fe>We;We++)it=Te?Me(me[We],We):me[We],R(ke,We,it);return ke.length=We,ke},arrayFrom}var checkCorrectnessOfIteration,hasRequiredCheckCorrectnessOfIteration;function requireCheckCorrectnessOfIteration(){if(hasRequiredCheckCorrectnessOfIteration)return checkCorrectnessOfIteration;hasRequiredCheckCorrectnessOfIteration=1;var Y=requireWellKnownSymbol(),K=Y("iterator"),ee=!1;try{var ne=0,re={next:function(){return{done:!!ne++}},return:function(){ee=!0}};re[K]=function(){return this},Array.from(re,function(){throw 2})}catch{}return checkCorrectnessOfIteration=function(le,Q){try{if(!Q&&!ee)return!1}catch{return!1}var R=!1;try{var U={};U[K]=function(){return{next:function(){return{done:R=!0}}}},le(U)}catch{}return R},checkCorrectnessOfIteration}var hasRequiredEs_array_from;function requireEs_array_from(){if(hasRequiredEs_array_from)return es_array_from;hasRequiredEs_array_from=1;var Y=require_export(),K=requireArrayFrom(),ee=requireCheckCorrectnessOfIteration(),ne=!ee(function(re){Array.from(re)});return Y({target:"Array",stat:!0,forced:ne},{from:K}),es_array_from}var es_array_includes={},hasRequiredEs_array_includes;function requireEs_array_includes(){if(hasRequiredEs_array_includes)return es_array_includes;hasRequiredEs_array_includes=1;var Y=require_export(),K=requireArrayIncludes().includes,ee=requireFails(),ne=requireAddToUnscopables(),re=ee(function(){return!Array(1).includes()});return Y({target:"Array",proto:!0,forced:re},{includes:function(Q){return K(this,Q,arguments.length>1?arguments[1]:void 0)}}),ne("includes"),es_array_includes}var es_array_indexOf={},hasRequiredEs_array_indexOf;function requireEs_array_indexOf(){if(hasRequiredEs_array_indexOf)return es_array_indexOf;hasRequiredEs_array_indexOf=1;var Y=require_export(),K=requireFunctionUncurryThisClause(),ee=requireArrayIncludes().indexOf,ne=requireArrayMethodIsStrict(),re=K([].indexOf),le=!!re&&1/re([1],1,-0)<0,Q=le||!ne("indexOf");return Y({target:"Array",proto:!0,forced:Q},{indexOf:function(U){var Z=arguments.length>1?arguments[1]:void 0;return le?re(this,U,Z)||0:ee(this,U,Z)}}),es_array_indexOf}var es_array_isArray={},hasRequiredEs_array_isArray;function requireEs_array_isArray(){if(hasRequiredEs_array_isArray)return es_array_isArray;hasRequiredEs_array_isArray=1;var Y=require_export(),K=requireIsArray$1();return Y({target:"Array",stat:!0},{isArray:K}),es_array_isArray}var iteratorsCore,hasRequiredIteratorsCore;function requireIteratorsCore(){if(hasRequiredIteratorsCore)return iteratorsCore;hasRequiredIteratorsCore=1;var Y=requireFails(),K=requireIsCallable(),ee=requireIsObject$1(),ne=requireObjectCreate(),re=requireObjectGetPrototypeOf(),le=requireDefineBuiltIn(),Q=requireWellKnownSymbol(),R=requireIsPure(),U=Q("iterator"),Z=!1,ae,he,pe;[].keys&&(pe=[].keys(),"next"in pe?(he=re(re(pe)),he!==Object.prototype&&(ae=he)):Z=!0);var me=!ee(ae)||Y(function(){var ve={};return ae[U].call(ve)!==ve});return me?ae={}:R&&(ae=ne(ae)),K(ae[U])||le(ae,U,function(){return this}),iteratorsCore={IteratorPrototype:ae,BUGGY_SAFARI_ITERATORS:Z},iteratorsCore}var iteratorCreateConstructor,hasRequiredIteratorCreateConstructor;function requireIteratorCreateConstructor(){if(hasRequiredIteratorCreateConstructor)return iteratorCreateConstructor;hasRequiredIteratorCreateConstructor=1;var Y=requireIteratorsCore().IteratorPrototype,K=requireObjectCreate(),ee=requireCreatePropertyDescriptor(),ne=requireSetToStringTag(),re=requireIterators(),le=function(){return this};return iteratorCreateConstructor=function(Q,R,U,Z){var ae=R+" Iterator";return Q.prototype=K(Y,{next:ee(+!Z,U)}),ne(Q,ae,!1,!0),re[ae]=le,Q},iteratorCreateConstructor}var iteratorDefine,hasRequiredIteratorDefine;function requireIteratorDefine(){if(hasRequiredIteratorDefine)return iteratorDefine;hasRequiredIteratorDefine=1;var Y=require_export(),K=requireFunctionCall(),ee=requireIsPure(),ne=requireFunctionName(),re=requireIsCallable(),le=requireIteratorCreateConstructor(),Q=requireObjectGetPrototypeOf(),R=requireObjectSetPrototypeOf(),U=requireSetToStringTag(),Z=requireCreateNonEnumerableProperty(),ae=requireDefineBuiltIn(),he=requireWellKnownSymbol(),pe=requireIterators(),me=requireIteratorsCore(),ve=ne.PROPER,Re=ne.CONFIGURABLE,Me=me.IteratorPrototype,Te=me.BUGGY_SAFARI_ITERATORS,Ce=he("iterator"),We="keys",Fe="values",ke="entries",Ze=function(){return this};return iteratorDefine=function(Je,Qe,it,lt,dt,yt,gt){le(it,Qe,lt);var qt=function(nr){if(nr===dt&&pt)return pt;if(!Te&&nr&&nr in ft)return ft[nr];switch(nr){case We:return function(){return new it(this,nr)};case Fe:return function(){return new it(this,nr)};case ke:return function(){return new it(this,nr)}}return function(){return new it(this)}},Ft=Qe+" Iterator",Gt=!1,ft=Je.prototype,Rt=ft[Ce]||ft["@@iterator"]||dt&&ft[dt],pt=!Te&&Rt||qt(dt),At=Qe==="Array"&&ft.entries||Rt,It,Dt,Zt;if(At&&(It=Q(At.call(new Je)),It!==Object.prototype&&It.next&&(!ee&&Q(It)!==Me&&(R?R(It,Me):re(It[Ce])||ae(It,Ce,Ze)),U(It,Ft,!0,!0),ee&&(pe[Ft]=Ze))),ve&&dt===Fe&&Rt&&Rt.name!==Fe&&(!ee&&Re?Z(ft,"name",Fe):(Gt=!0,pt=function(){return K(Rt,this)})),dt)if(Dt={values:qt(Fe),keys:yt?pt:qt(We),entries:qt(ke)},gt)for(Zt in Dt)(Te||Gt||!(Zt in ft))&&ae(ft,Zt,Dt[Zt]);else Y({target:Qe,proto:!0,forced:Te||Gt},Dt);return(!ee||gt)&&ft[Ce]!==pt&&ae(ft,Ce,pt,{name:dt}),pe[Qe]=pt,Dt},iteratorDefine}var createIterResultObject,hasRequiredCreateIterResultObject;function requireCreateIterResultObject(){return hasRequiredCreateIterResultObject||(hasRequiredCreateIterResultObject=1,createIterResultObject=function(Y,K){return{value:Y,done:K}}),createIterResultObject}var es_array_iterator,hasRequiredEs_array_iterator;function requireEs_array_iterator(){if(hasRequiredEs_array_iterator)return es_array_iterator;hasRequiredEs_array_iterator=1;var Y=requireToIndexedObject(),K=requireAddToUnscopables(),ee=requireIterators(),ne=requireInternalState(),re=requireObjectDefineProperty().f,le=requireIteratorDefine(),Q=requireCreateIterResultObject(),R=requireIsPure(),U=requireDescriptors(),Z="Array Iterator",ae=ne.set,he=ne.getterFor(Z);es_array_iterator=le(Array,"Array",function(me,ve){ae(this,{type:Z,target:Y(me),index:0,kind:ve})},function(){var me=he(this),ve=me.target,Re=me.index++;if(!ve||Re>=ve.length)return me.target=null,Q(void 0,!0);switch(me.kind){case"keys":return Q(Re,!1);case"values":return Q(ve[Re],!1)}return Q([Re,ve[Re]],!1)},"values");var pe=ee.Arguments=ee.Array;if(K("keys"),K("values"),K("entries"),!R&&U&&pe.name!=="values")try{re(pe,"name",{value:"values"})}catch{}return es_array_iterator}var es_array_join={},hasRequiredEs_array_join;function requireEs_array_join(){if(hasRequiredEs_array_join)return es_array_join;hasRequiredEs_array_join=1;var Y=require_export(),K=requireFunctionUncurryThis(),ee=requireIndexedObject(),ne=requireToIndexedObject(),re=requireArrayMethodIsStrict(),le=K([].join),Q=ee!==Object,R=Q||!re("join",",");return Y({target:"Array",proto:!0,forced:R},{join:function(Z){return le(ne(this),Z===void 0?",":Z)}}),es_array_join}var es_array_lastIndexOf={},arrayLastIndexOf,hasRequiredArrayLastIndexOf;function requireArrayLastIndexOf(){if(hasRequiredArrayLastIndexOf)return arrayLastIndexOf;hasRequiredArrayLastIndexOf=1;var Y=requireFunctionApply(),K=requireToIndexedObject(),ee=requireToIntegerOrInfinity(),ne=requireLengthOfArrayLike(),re=requireArrayMethodIsStrict(),le=Math.min,Q=[].lastIndexOf,R=!!Q&&1/[1].lastIndexOf(1,-0)<0,U=re("lastIndexOf"),Z=R||!U;return arrayLastIndexOf=Z?function(he){if(R)return Y(Q,this,arguments)||0;var pe=K(this),me=ne(pe);if(me===0)return-1;var ve=me-1;for(arguments.length>1&&(ve=le(ve,ee(arguments[1]))),ve<0&&(ve=me+ve);ve>=0;ve--)if(ve in pe&&pe[ve]===he)return ve||0;return-1}:Q,arrayLastIndexOf}var hasRequiredEs_array_lastIndexOf;function requireEs_array_lastIndexOf(){if(hasRequiredEs_array_lastIndexOf)return es_array_lastIndexOf;hasRequiredEs_array_lastIndexOf=1;var Y=require_export(),K=requireArrayLastIndexOf();return Y({target:"Array",proto:!0,forced:K!==[].lastIndexOf},{lastIndexOf:K}),es_array_lastIndexOf}var es_array_map={},hasRequiredEs_array_map;function requireEs_array_map(){if(hasRequiredEs_array_map)return es_array_map;hasRequiredEs_array_map=1;var Y=require_export(),K=requireArrayIteration().map,ee=requireArrayMethodHasSpeciesSupport(),ne=ee("map");return Y({target:"Array",proto:!0,forced:!ne},{map:function(le){return K(this,le,arguments.length>1?arguments[1]:void 0)}}),es_array_map}var es_array_of={},hasRequiredEs_array_of;function requireEs_array_of(){if(hasRequiredEs_array_of)return es_array_of;hasRequiredEs_array_of=1;var Y=require_export(),K=requireFails(),ee=requireIsConstructor(),ne=requireCreateProperty(),re=Array,le=K(function(){function Q(){}return!(re.of.call(Q)instanceof Q)});return Y({target:"Array",stat:!0,forced:le},{of:function(){for(var R=0,U=arguments.length,Z=new(ee(this)?this:re)(U);U>R;)ne(Z,R,arguments[R++]);return Z.length=U,Z}}),es_array_of}var es_array_push={},arraySetLength,hasRequiredArraySetLength;function requireArraySetLength(){if(hasRequiredArraySetLength)return arraySetLength;hasRequiredArraySetLength=1;var Y=requireDescriptors(),K=requireIsArray$1(),ee=TypeError,ne=Object.getOwnPropertyDescriptor,re=Y&&!function(){if(this!==void 0)return!0;try{Object.defineProperty([],"length",{writable:!1}).length=1}catch(le){return le instanceof TypeError}}();return arraySetLength=re?function(le,Q){if(K(le)&&!ne(le,"length").writable)throw new ee("Cannot set read only .length");return le.length=Q}:function(le,Q){return le.length=Q},arraySetLength}var hasRequiredEs_array_push;function requireEs_array_push(){if(hasRequiredEs_array_push)return es_array_push;hasRequiredEs_array_push=1;var Y=require_export(),K=requireToObject(),ee=requireLengthOfArrayLike(),ne=requireArraySetLength(),re=requireDoesNotExceedSafeInteger(),le=requireFails(),Q=le(function(){return[].push.call({length:4294967296},1)!==4294967297}),R=function(){try{Object.defineProperty([],"length",{writable:!1}).push()}catch(Z){return Z instanceof TypeError}},U=Q||!R();return Y({target:"Array",proto:!0,arity:1,forced:U},{push:function(ae){var he=K(this),pe=ee(he),me=arguments.length;re(pe+me);for(var ve=0;ve<me;ve++)he[pe]=arguments[ve],pe++;return ne(he,pe),pe}}),es_array_push}var es_array_reduce={},arrayReduce,hasRequiredArrayReduce;function requireArrayReduce(){if(hasRequiredArrayReduce)return arrayReduce;hasRequiredArrayReduce=1;var Y=requireACallable(),K=requireToObject(),ee=requireIndexedObject(),ne=requireLengthOfArrayLike(),re=TypeError,le="Reduce of empty array with no initial value",Q=function(R){return function(U,Z,ae,he){var pe=K(U),me=ee(pe),ve=ne(pe);if(Y(Z),ve===0&&ae<2)throw new re(le);var Re=R?ve-1:0,Me=R?-1:1;if(ae<2)for(;;){if(Re in me){he=me[Re],Re+=Me;break}if(Re+=Me,R?Re<0:ve<=Re)throw new re(le)}for(;R?Re>=0:ve>Re;Re+=Me)Re in me&&(he=Z(he,me[Re],Re,pe));return he}};return arrayReduce={left:Q(!1),right:Q(!0)},arrayReduce}var environment,hasRequiredEnvironment;function requireEnvironment(){if(hasRequiredEnvironment)return environment;hasRequiredEnvironment=1;var Y=requireGlobalThis(),K=requireEnvironmentUserAgent(),ee=requireClassofRaw(),ne=function(re){return K.slice(0,re.length)===re};return environment=function(){return ne("Bun/")?"BUN":ne("Cloudflare-Workers")?"CLOUDFLARE":ne("Deno/")?"DENO":ne("Node.js/")?"NODE":Y.Bun&&typeof Bun.version=="string"?"BUN":Y.Deno&&typeof Deno.version=="object"?"DENO":ee(Y.process)==="process"?"NODE":Y.window&&Y.document?"BROWSER":"REST"}(),environment}var environmentIsNode,hasRequiredEnvironmentIsNode;function requireEnvironmentIsNode(){if(hasRequiredEnvironmentIsNode)return environmentIsNode;hasRequiredEnvironmentIsNode=1;var Y=requireEnvironment();return environmentIsNode=Y==="NODE",environmentIsNode}var hasRequiredEs_array_reduce;function requireEs_array_reduce(){if(hasRequiredEs_array_reduce)return es_array_reduce;hasRequiredEs_array_reduce=1;var Y=require_export(),K=requireArrayReduce().left,ee=requireArrayMethodIsStrict(),ne=requireEnvironmentV8Version(),re=requireEnvironmentIsNode(),le=!re&&ne>79&&ne<83,Q=le||!ee("reduce");return Y({target:"Array",proto:!0,forced:Q},{reduce:function(U){var Z=arguments.length;return K(this,U,Z,Z>1?arguments[1]:void 0)}}),es_array_reduce}var es_array_reduceRight={},hasRequiredEs_array_reduceRight;function requireEs_array_reduceRight(){if(hasRequiredEs_array_reduceRight)return es_array_reduceRight;hasRequiredEs_array_reduceRight=1;var Y=require_export(),K=requireArrayReduce().right,ee=requireArrayMethodIsStrict(),ne=requireEnvironmentV8Version(),re=requireEnvironmentIsNode(),le=!re&&ne>79&&ne<83,Q=le||!ee("reduceRight");return Y({target:"Array",proto:!0,forced:Q},{reduceRight:function(U){return K(this,U,arguments.length,arguments.length>1?arguments[1]:void 0)}}),es_array_reduceRight}var es_array_reverse={},hasRequiredEs_array_reverse;function requireEs_array_reverse(){if(hasRequiredEs_array_reverse)return es_array_reverse;hasRequiredEs_array_reverse=1;var Y=require_export(),K=requireFunctionUncurryThis(),ee=requireIsArray$1(),ne=K([].reverse),re=[1,2];return Y({target:"Array",proto:!0,forced:String(re)===String(re.reverse())},{reverse:function(){return ee(this)&&(this.length=this.length),ne(this)}}),es_array_reverse}var es_array_slice={},hasRequiredEs_array_slice;function requireEs_array_slice(){if(hasRequiredEs_array_slice)return es_array_slice;hasRequiredEs_array_slice=1;var Y=require_export(),K=requireIsArray$1(),ee=requireIsConstructor(),ne=requireIsObject$1(),re=requireToAbsoluteIndex(),le=requireLengthOfArrayLike(),Q=requireToIndexedObject(),R=requireCreateProperty(),U=requireWellKnownSymbol(),Z=requireArrayMethodHasSpeciesSupport(),ae=requireArraySlice(),he=Z("slice"),pe=U("species"),me=Array,ve=Math.max;return Y({target:"Array",proto:!0,forced:!he},{slice:function(Me,Te){var Ce=Q(this),We=le(Ce),Fe=re(Me,We),ke=re(Te===void 0?We:Te,We),Ze,Je,Qe;if(K(Ce)&&(Ze=Ce.constructor,ee(Ze)&&(Ze===me||K(Ze.prototype))?Ze=void 0:ne(Ze)&&(Ze=Ze[pe],Ze===null&&(Ze=void 0)),Ze===me||Ze===void 0))return ae(Ce,Fe,ke);for(Je=new(Ze===void 0?me:Ze)(ve(ke-Fe,0)),Qe=0;Fe<ke;Fe++,Qe++)Fe in Ce&&R(Je,Qe,Ce[Fe]);return Je.length=Qe,Je}}),es_array_slice}var es_array_some={},hasRequiredEs_array_some;function requireEs_array_some(){if(hasRequiredEs_array_some)return es_array_some;hasRequiredEs_array_some=1;var Y=require_export(),K=requireArrayIteration().some,ee=requireArrayMethodIsStrict(),ne=ee("some");return Y({target:"Array",proto:!0,forced:!ne},{some:function(le){return K(this,le,arguments.length>1?arguments[1]:void 0)}}),es_array_some}var es_array_sort={},arraySort,hasRequiredArraySort;function requireArraySort(){if(hasRequiredArraySort)return arraySort;hasRequiredArraySort=1;var Y=requireArraySlice(),K=Math.floor,ee=function(ne,re){var le=ne.length;if(le<8)for(var Q=1,R,U;Q<le;){for(U=Q,R=ne[Q];U&&re(ne[U-1],R)>0;)ne[U]=ne[--U];U!==Q++&&(ne[U]=R)}else for(var Z=K(le/2),ae=ee(Y(ne,0,Z),re),he=ee(Y(ne,Z),re),pe=ae.length,me=he.length,ve=0,Re=0;ve<pe||Re<me;)ne[ve+Re]=ve<pe&&Re<me?re(ae[ve],he[Re])<=0?ae[ve++]:he[Re++]:ve<pe?ae[ve++]:he[Re++];return ne};return arraySort=ee,arraySort}var environmentFfVersion,hasRequiredEnvironmentFfVersion;function requireEnvironmentFfVersion(){if(hasRequiredEnvironmentFfVersion)return environmentFfVersion;hasRequiredEnvironmentFfVersion=1;var Y=requireEnvironmentUserAgent(),K=Y.match(/firefox\/(\d+)/i);return environmentFfVersion=!!K&&+K[1],environmentFfVersion}var environmentIsIeOrEdge,hasRequiredEnvironmentIsIeOrEdge;function requireEnvironmentIsIeOrEdge(){if(hasRequiredEnvironmentIsIeOrEdge)return environmentIsIeOrEdge;hasRequiredEnvironmentIsIeOrEdge=1;var Y=requireEnvironmentUserAgent();return environmentIsIeOrEdge=/MSIE|Trident/.test(Y),environmentIsIeOrEdge}var environmentWebkitVersion,hasRequiredEnvironmentWebkitVersion;function requireEnvironmentWebkitVersion(){if(hasRequiredEnvironmentWebkitVersion)return environmentWebkitVersion;hasRequiredEnvironmentWebkitVersion=1;var Y=requireEnvironmentUserAgent(),K=Y.match(/AppleWebKit\/(\d+)\./);return environmentWebkitVersion=!!K&&+K[1],environmentWebkitVersion}var hasRequiredEs_array_sort;function requireEs_array_sort(){if(hasRequiredEs_array_sort)return es_array_sort;hasRequiredEs_array_sort=1;var Y=require_export(),K=requireFunctionUncurryThis(),ee=requireACallable(),ne=requireToObject(),re=requireLengthOfArrayLike(),le=requireDeletePropertyOrThrow(),Q=requireToString$1(),R=requireFails(),U=requireArraySort(),Z=requireArrayMethodIsStrict(),ae=requireEnvironmentFfVersion(),he=requireEnvironmentIsIeOrEdge(),pe=requireEnvironmentV8Version(),me=requireEnvironmentWebkitVersion(),ve=[],Re=K(ve.sort),Me=K(ve.push),Te=R(function(){ve.sort(void 0)}),Ce=R(function(){ve.sort(null)}),We=Z("sort"),Fe=!R(function(){if(pe)return pe<70;if(!(ae&&ae>3)){if(he)return!0;if(me)return me<603;var Je="",Qe,it,lt,dt;for(Qe=65;Qe<76;Qe++){switch(it=String.fromCharCode(Qe),Qe){case 66:case 69:case 70:case 72:lt=3;break;case 68:case 71:lt=4;break;default:lt=2}for(dt=0;dt<47;dt++)ve.push({k:it+dt,v:lt})}for(ve.sort(function(yt,gt){return gt.v-yt.v}),dt=0;dt<ve.length;dt++)it=ve[dt].k.charAt(0),Je.charAt(Je.length-1)!==it&&(Je+=it);return Je!=="DGBEFHACIJK"}}),ke=Te||!Ce||!We||!Fe,Ze=function(Je){return function(Qe,it){return it===void 0?-1:Qe===void 0?1:Je!==void 0?+Je(Qe,it)||0:Q(Qe)>Q(it)?1:-1}};return Y({target:"Array",proto:!0,forced:ke},{sort:function(Qe){Qe!==void 0&&ee(Qe);var it=ne(this);if(Fe)return Qe===void 0?Re(it):Re(it,Qe);var lt=[],dt=re(it),yt,gt;for(gt=0;gt<dt;gt++)gt in it&&Me(lt,it[gt]);for(U(lt,Ze(Qe)),yt=re(lt),gt=0;gt<yt;)it[gt]=lt[gt++];for(;gt<dt;)le(it,gt++);return it}}),es_array_sort}var es_array_species={},setSpecies,hasRequiredSetSpecies;function requireSetSpecies(){if(hasRequiredSetSpecies)return setSpecies;hasRequiredSetSpecies=1;var Y=requireGetBuiltIn(),K=requireDefineBuiltInAccessor(),ee=requireWellKnownSymbol(),ne=requireDescriptors(),re=ee("species");return setSpecies=function(le){var Q=Y(le);ne&&Q&&!Q[re]&&K(Q,re,{configurable:!0,get:function(){return this}})},setSpecies}var hasRequiredEs_array_species;function requireEs_array_species(){if(hasRequiredEs_array_species)return es_array_species;hasRequiredEs_array_species=1;var Y=requireSetSpecies();return Y("Array"),es_array_species}var es_array_splice={},hasRequiredEs_array_splice;function requireEs_array_splice(){if(hasRequiredEs_array_splice)return es_array_splice;hasRequiredEs_array_splice=1;var Y=require_export(),K=requireToObject(),ee=requireToAbsoluteIndex(),ne=requireToIntegerOrInfinity(),re=requireLengthOfArrayLike(),le=requireArraySetLength(),Q=requireDoesNotExceedSafeInteger(),R=requireArraySpeciesCreate(),U=requireCreateProperty(),Z=requireDeletePropertyOrThrow(),ae=requireArrayMethodHasSpeciesSupport(),he=ae("splice"),pe=Math.max,me=Math.min;return Y({target:"Array",proto:!0,forced:!he},{splice:function(Re,Me){var Te=K(this),Ce=re(Te),We=ee(Re,Ce),Fe=arguments.length,ke,Ze,Je,Qe,it,lt;for(Fe===0?ke=Ze=0:Fe===1?(ke=0,Ze=Ce-We):(ke=Fe-2,Ze=me(pe(ne(Me),0),Ce-We)),Q(Ce+ke-Ze),Je=R(Te,Ze),Qe=0;Qe<Ze;Qe++)it=We+Qe,it in Te&&U(Je,Qe,Te[it]);if(Je.length=Ze,ke<Ze){for(Qe=We;Qe<Ce-Ze;Qe++)it=Qe+Ze,lt=Qe+ke,it in Te?Te[lt]=Te[it]:Z(Te,lt);for(Qe=Ce;Qe>Ce-Ze+ke;Qe--)Z(Te,Qe-1)}else if(ke>Ze)for(Qe=Ce-Ze;Qe>We;Qe--)it=Qe+Ze-1,lt=Qe+ke-1,it in Te?Te[lt]=Te[it]:Z(Te,lt);for(Qe=0;Qe<ke;Qe++)Te[Qe+We]=arguments[Qe+2];return le(Te,Ce-Ze+ke),Je}}),es_array_splice}var es_array_toReversed={},arrayToReversed,hasRequiredArrayToReversed;function requireArrayToReversed(){if(hasRequiredArrayToReversed)return arrayToReversed;hasRequiredArrayToReversed=1;var Y=requireLengthOfArrayLike();return arrayToReversed=function(K,ee){for(var ne=Y(K),re=new ee(ne),le=0;le<ne;le++)re[le]=K[ne-le-1];return re},arrayToReversed}var hasRequiredEs_array_toReversed;function requireEs_array_toReversed(){if(hasRequiredEs_array_toReversed)return es_array_toReversed;hasRequiredEs_array_toReversed=1;var Y=require_export(),K=requireArrayToReversed(),ee=requireToIndexedObject(),ne=requireAddToUnscopables(),re=Array;return Y({target:"Array",proto:!0},{toReversed:function(){return K(ee(this),re)}}),ne("toReversed"),es_array_toReversed}var es_array_toSorted={},arrayFromConstructorAndList,hasRequiredArrayFromConstructorAndList;function requireArrayFromConstructorAndList(){if(hasRequiredArrayFromConstructorAndList)return arrayFromConstructorAndList;hasRequiredArrayFromConstructorAndList=1;var Y=requireLengthOfArrayLike();return arrayFromConstructorAndList=function(K,ee,ne){for(var re=0,le=arguments.length>2?ne:Y(ee),Q=new K(le);le>re;)Q[re]=ee[re++];return Q},arrayFromConstructorAndList}var getBuiltInPrototypeMethod,hasRequiredGetBuiltInPrototypeMethod;function requireGetBuiltInPrototypeMethod(){if(hasRequiredGetBuiltInPrototypeMethod)return getBuiltInPrototypeMethod;hasRequiredGetBuiltInPrototypeMethod=1;var Y=requireGlobalThis();return getBuiltInPrototypeMethod=function(K,ee){var ne=Y[K],re=ne&&ne.prototype;return re&&re[ee]},getBuiltInPrototypeMethod}var hasRequiredEs_array_toSorted;function requireEs_array_toSorted(){if(hasRequiredEs_array_toSorted)return es_array_toSorted;hasRequiredEs_array_toSorted=1;var Y=require_export(),K=requireFunctionUncurryThis(),ee=requireACallable(),ne=requireToIndexedObject(),re=requireArrayFromConstructorAndList(),le=requireGetBuiltInPrototypeMethod(),Q=requireAddToUnscopables(),R=Array,U=K(le("Array","sort"));return Y({target:"Array",proto:!0},{toSorted:function(ae){ae!==void 0&&ee(ae);var he=ne(this),pe=re(R,he);return U(pe,ae)}}),Q("toSorted"),es_array_toSorted}var es_array_toSpliced={},hasRequiredEs_array_toSpliced;function requireEs_array_toSpliced(){if(hasRequiredEs_array_toSpliced)return es_array_toSpliced;hasRequiredEs_array_toSpliced=1;var Y=require_export(),K=requireAddToUnscopables(),ee=requireDoesNotExceedSafeInteger(),ne=requireLengthOfArrayLike(),re=requireToAbsoluteIndex(),le=requireToIndexedObject(),Q=requireToIntegerOrInfinity(),R=Array,U=Math.max,Z=Math.min;return Y({target:"Array",proto:!0},{toSpliced:function(he,pe){var me=le(this),ve=ne(me),Re=re(he,ve),Me=arguments.length,Te=0,Ce,We,Fe,ke;for(Me===0?Ce=We=0:Me===1?(Ce=0,We=ve-Re):(Ce=Me-2,We=Z(U(Q(pe),0),ve-Re)),Fe=ee(ve+Ce-We),ke=R(Fe);Te<Re;Te++)ke[Te]=me[Te];for(;Te<Re+Ce;Te++)ke[Te]=arguments[Te-Re+2];for(;Te<Fe;Te++)ke[Te]=me[Te+We-Ce];return ke}}),K("toSpliced"),es_array_toSpliced}var es_array_unscopables_flat={},hasRequiredEs_array_unscopables_flat;function requireEs_array_unscopables_flat(){if(hasRequiredEs_array_unscopables_flat)return es_array_unscopables_flat;hasRequiredEs_array_unscopables_flat=1;var Y=requireAddToUnscopables();return Y("flat"),es_array_unscopables_flat}var es_array_unscopables_flatMap={},hasRequiredEs_array_unscopables_flatMap;function requireEs_array_unscopables_flatMap(){if(hasRequiredEs_array_unscopables_flatMap)return es_array_unscopables_flatMap;hasRequiredEs_array_unscopables_flatMap=1;var Y=requireAddToUnscopables();return Y("flatMap"),es_array_unscopables_flatMap}var es_array_unshift={},hasRequiredEs_array_unshift;function requireEs_array_unshift(){if(hasRequiredEs_array_unshift)return es_array_unshift;hasRequiredEs_array_unshift=1;var Y=require_export(),K=requireToObject(),ee=requireLengthOfArrayLike(),ne=requireArraySetLength(),re=requireDeletePropertyOrThrow(),le=requireDoesNotExceedSafeInteger(),Q=[].unshift(0)!==1,R=function(){try{Object.defineProperty([],"length",{writable:!1}).unshift()}catch(Z){return Z instanceof TypeError}},U=Q||!R();return Y({target:"Array",proto:!0,arity:1,forced:U},{unshift:function(ae){var he=K(this),pe=ee(he),me=arguments.length;if(me){le(pe+me);for(var ve=pe;ve--;){var Re=ve+me;ve in he?he[Re]=he[ve]:re(he,Re)}for(var Me=0;Me<me;Me++)he[Me]=arguments[Me]}return ne(he,pe+me)}}),es_array_unshift}var es_array_with={},arrayWith,hasRequiredArrayWith;function requireArrayWith(){if(hasRequiredArrayWith)return arrayWith;hasRequiredArrayWith=1;var Y=requireLengthOfArrayLike(),K=requireToIntegerOrInfinity(),ee=RangeError;return arrayWith=function(ne,re,le,Q){var R=Y(ne),U=K(le),Z=U<0?R+U:U;if(Z>=R||Z<0)throw new ee("Incorrect index");for(var ae=new re(R),he=0;he<R;he++)ae[he]=he===Z?Q:ne[he];return ae},arrayWith}var hasRequiredEs_array_with;function requireEs_array_with(){if(hasRequiredEs_array_with)return es_array_with;hasRequiredEs_array_with=1;var Y=require_export(),K=requireArrayWith(),ee=requireToIndexedObject(),ne=Array,re=function(){try{[].with({valueOf:function(){throw 4}},null)}catch(le){return le!==4}}();return Y({target:"Array",proto:!0,forced:re},{with:function(le,Q){return K(ee(this),ne,le,Q)}}),es_array_with}var es_arrayBuffer_constructor={},arrayBufferBasicDetection,hasRequiredArrayBufferBasicDetection;function requireArrayBufferBasicDetection(){return hasRequiredArrayBufferBasicDetection||(hasRequiredArrayBufferBasicDetection=1,arrayBufferBasicDetection=typeof ArrayBuffer<"u"&&typeof DataView<"u"),arrayBufferBasicDetection}var defineBuiltIns,hasRequiredDefineBuiltIns;function requireDefineBuiltIns(){if(hasRequiredDefineBuiltIns)return defineBuiltIns;hasRequiredDefineBuiltIns=1;var Y=requireDefineBuiltIn();return defineBuiltIns=function(K,ee,ne){for(var re in ee)Y(K,re,ee[re],ne);return K},defineBuiltIns}var anInstance,hasRequiredAnInstance;function requireAnInstance(){if(hasRequiredAnInstance)return anInstance;hasRequiredAnInstance=1;var Y=requireObjectIsPrototypeOf(),K=TypeError;return anInstance=function(ee,ne){if(Y(ne,ee))return ee;throw new K("Incorrect invocation")},anInstance}var toIndex,hasRequiredToIndex;function requireToIndex(){if(hasRequiredToIndex)return toIndex;hasRequiredToIndex=1;var Y=requireToIntegerOrInfinity(),K=requireToLength(),ee=RangeError;return toIndex=function(ne){if(ne===void 0)return 0;var re=Y(ne),le=K(re);if(re!==le)throw new ee("Wrong length or index");return le},toIndex}var mathSign,hasRequiredMathSign;function requireMathSign(){return hasRequiredMathSign||(hasRequiredMathSign=1,mathSign=Math.sign||function(K){var ee=+K;return ee===0||ee!==ee?ee:ee<0?-1:1}),mathSign}var mathRoundTiesToEven,hasRequiredMathRoundTiesToEven;function requireMathRoundTiesToEven(){if(hasRequiredMathRoundTiesToEven)return mathRoundTiesToEven;hasRequiredMathRoundTiesToEven=1;var Y=2220446049250313e-31,K=1/Y;return mathRoundTiesToEven=function(ee){return ee+K-K},mathRoundTiesToEven}var mathFloatRound,hasRequiredMathFloatRound;function requireMathFloatRound(){if(hasRequiredMathFloatRound)return mathFloatRound;hasRequiredMathFloatRound=1;var Y=requireMathSign(),K=requireMathRoundTiesToEven(),ee=Math.abs,ne=2220446049250313e-31;return mathFloatRound=function(re,le,Q,R){var U=+re,Z=ee(U),ae=Y(U);if(Z<R)return ae*K(Z/R/le)*R*le;var he=(1+le/ne)*Z,pe=he-(he-Z);return pe>Q||pe!==pe?ae*(1/0):ae*pe},mathFloatRound}var mathFround,hasRequiredMathFround;function requireMathFround(){if(hasRequiredMathFround)return mathFround;hasRequiredMathFround=1;var Y=requireMathFloatRound(),K=11920928955078125e-23,ee=34028234663852886e22,ne=11754943508222875e-54;return mathFround=Math.fround||function(le){return Y(le,K,ee,ne)},mathFround}var ieee754$1,hasRequiredIeee754$1;function requireIeee754$1(){if(hasRequiredIeee754$1)return ieee754$1;hasRequiredIeee754$1=1;var Y=Array,K=Math.abs,ee=Math.pow,ne=Math.floor,re=Math.log,le=Math.LN2,Q=function(U,Z,ae){var he=Y(ae),pe=ae*8-Z-1,me=(1<<pe)-1,ve=me>>1,Re=Z===23?ee(2,-24)-ee(2,-77):0,Me=U<0||U===0&&1/U<0?1:0,Te=0,Ce,We,Fe;for(U=K(U),U!==U||U===1/0?(We=U!==U?1:0,Ce=me):(Ce=ne(re(U)/le),Fe=ee(2,-Ce),U*Fe<1&&(Ce--,Fe*=2),Ce+ve>=1?U+=Re/Fe:U+=Re*ee(2,1-ve),U*Fe>=2&&(Ce++,Fe/=2),Ce+ve>=me?(We=0,Ce=me):Ce+ve>=1?(We=(U*Fe-1)*ee(2,Z),Ce+=ve):(We=U*ee(2,ve-1)*ee(2,Z),Ce=0));Z>=8;)he[Te++]=We&255,We/=256,Z-=8;for(Ce=Ce<<Z|We,pe+=Z;pe>0;)he[Te++]=Ce&255,Ce/=256,pe-=8;return he[Te-1]|=Me*128,he},R=function(U,Z){var ae=U.length,he=ae*8-Z-1,pe=(1<<he)-1,me=pe>>1,ve=he-7,Re=ae-1,Me=U[Re--],Te=Me&127,Ce;for(Me>>=7;ve>0;)Te=Te*256+U[Re--],ve-=8;for(Ce=Te&(1<<-ve)-1,Te>>=-ve,ve+=Z;ve>0;)Ce=Ce*256+U[Re--],ve-=8;if(Te===0)Te=1-me;else{if(Te===pe)return Ce?NaN:Me?-1/0:1/0;Ce+=ee(2,Z),Te-=me}return(Me?-1:1)*Ce*ee(2,Te-Z)};return ieee754$1={pack:Q,unpack:R},ieee754$1}var arrayBuffer,hasRequiredArrayBuffer;function requireArrayBuffer(){if(hasRequiredArrayBuffer)return arrayBuffer;hasRequiredArrayBuffer=1;var Y=requireGlobalThis(),K=requireFunctionUncurryThis(),ee=requireDescriptors(),ne=requireArrayBufferBasicDetection(),re=requireFunctionName(),le=requireCreateNonEnumerableProperty(),Q=requireDefineBuiltInAccessor(),R=requireDefineBuiltIns(),U=requireFails(),Z=requireAnInstance(),ae=requireToIntegerOrInfinity(),he=requireToLength(),pe=requireToIndex(),me=requireMathFround(),ve=requireIeee754$1(),Re=requireObjectGetPrototypeOf(),Me=requireObjectSetPrototypeOf(),Te=requireArrayFill(),Ce=requireArraySlice(),We=requireInheritIfRequired(),Fe=requireCopyConstructorProperties(),ke=requireSetToStringTag(),Ze=requireInternalState(),Je=re.PROPER,Qe=re.CONFIGURABLE,it="ArrayBuffer",lt="DataView",dt="prototype",yt="Wrong length",gt="Wrong index",qt=Ze.getterFor(it),Ft=Ze.getterFor(lt),Gt=Ze.set,ft=Y[it],Rt=ft,pt=Rt&&Rt[dt],At=Y[lt],It=At&&At[dt],Dt=Object.prototype,Zt=Y.Array,nr=Y.RangeError,Er=K(Te),vr=K([].reverse),Sr=ve.pack,Qt=ve.unpack,or=function(rr){return[rr&255]},Ir=function(rr){return[rr&255,rr>>8&255]},Rr=function(rr){return[rr&255,rr>>8&255,rr>>16&255,rr>>24&255]},Cr=function(rr){return rr[3]<<24|rr[2]<<16|rr[1]<<8|rr[0]},wr=function(rr){return Sr(me(rr),23,4)},Wr=function(rr){return Sr(rr,52,8)},Kr=function(rr,sr,Dr){Q(rr[dt],sr,{configurable:!0,get:function(){return Dr(this)[sr]}})},Hr=function(rr,sr,Dr,lr){var yr=Ft(rr),xr=pe(Dr),Ge=!!lr;if(xr+sr>yr.byteLength)throw new nr(gt);var Ee=yr.bytes,Pe=xr+yr.byteOffset,He=Ce(Ee,Pe,Pe+sr);return Ge?He:vr(He)},br=function(rr,sr,Dr,lr,yr,xr){var Ge=Ft(rr),Ee=pe(Dr),Pe=lr(+yr),He=!!xr;if(Ee+sr>Ge.byteLength)throw new nr(gt);for(var ut=Ge.bytes,Ve=Ee+Ge.byteOffset,qe=0;qe<sr;qe++)ut[Ve+qe]=Pe[He?qe:sr-qe-1]};if(!ne)Rt=function(sr){Z(this,pt);var Dr=pe(sr);Gt(this,{type:it,bytes:Er(Zt(Dr),0),byteLength:Dr}),ee||(this.byteLength=Dr,this.detached=!1)},pt=Rt[dt],At=function(sr,Dr,lr){Z(this,It),Z(sr,pt);var yr=qt(sr),xr=yr.byteLength,Ge=ae(Dr);if(Ge<0||Ge>xr)throw new nr("Wrong offset");if(lr=lr===void 0?xr-Ge:he(lr),Ge+lr>xr)throw new nr(yt);Gt(this,{type:lt,buffer:sr,byteLength:lr,byteOffset:Ge,bytes:yr.bytes}),ee||(this.buffer=sr,this.byteLength=lr,this.byteOffset=Ge)},It=At[dt],ee&&(Kr(Rt,"byteLength",qt),Kr(At,"buffer",Ft),Kr(At,"byteLength",Ft),Kr(At,"byteOffset",Ft)),R(It,{getInt8:function(sr){return Hr(this,1,sr)[0]<<24>>24},getUint8:function(sr){return Hr(this,1,sr)[0]},getInt16:function(sr){var Dr=Hr(this,2,sr,arguments.length>1?arguments[1]:!1);return(Dr[1]<<8|Dr[0])<<16>>16},getUint16:function(sr){var Dr=Hr(this,2,sr,arguments.length>1?arguments[1]:!1);return Dr[1]<<8|Dr[0]},getInt32:function(sr){return Cr(Hr(this,4,sr,arguments.length>1?arguments[1]:!1))},getUint32:function(sr){return Cr(Hr(this,4,sr,arguments.length>1?arguments[1]:!1))>>>0},getFloat32:function(sr){return Qt(Hr(this,4,sr,arguments.length>1?arguments[1]:!1),23)},getFloat64:function(sr){return Qt(Hr(this,8,sr,arguments.length>1?arguments[1]:!1),52)},setInt8:function(sr,Dr){br(this,1,sr,or,Dr)},setUint8:function(sr,Dr){br(this,1,sr,or,Dr)},setInt16:function(sr,Dr){br(this,2,sr,Ir,Dr,arguments.length>2?arguments[2]:!1)},setUint16:function(sr,Dr){br(this,2,sr,Ir,Dr,arguments.length>2?arguments[2]:!1)},setInt32:function(sr,Dr){br(this,4,sr,Rr,Dr,arguments.length>2?arguments[2]:!1)},setUint32:function(sr,Dr){br(this,4,sr,Rr,Dr,arguments.length>2?arguments[2]:!1)},setFloat32:function(sr,Dr){br(this,4,sr,wr,Dr,arguments.length>2?arguments[2]:!1)},setFloat64:function(sr,Dr){br(this,8,sr,Wr,Dr,arguments.length>2?arguments[2]:!1)}});else{var Lr=Je&&ft.name!==it;!U(function(){ft(1)})||!U(function(){new ft(-1)})||U(function(){return new ft,new ft(1.5),new ft(NaN),ft.length!==1||Lr&&!Qe})?(Rt=function(sr){return Z(this,pt),We(new ft(pe(sr)),this,Rt)},Rt[dt]=pt,pt.constructor=Rt,Fe(Rt,ft)):Lr&&Qe&&le(ft,"name",it),Me&&Re(It)!==Dt&&Me(It,Dt);var Br=new At(new Rt(2)),zr=K(It.setInt8);Br.setInt8(0,2147483648),Br.setInt8(1,2147483649),(Br.getInt8(0)||!Br.getInt8(1))&&R(It,{setInt8:function(sr,Dr){zr(this,sr,Dr<<24>>24)},setUint8:function(sr,Dr){zr(this,sr,Dr<<24>>24)}},{unsafe:!0})}return ke(Rt,it),ke(At,lt),arrayBuffer={ArrayBuffer:Rt,DataView:At},arrayBuffer}var hasRequiredEs_arrayBuffer_constructor;function requireEs_arrayBuffer_constructor(){if(hasRequiredEs_arrayBuffer_constructor)return es_arrayBuffer_constructor;hasRequiredEs_arrayBuffer_constructor=1;var Y=require_export(),K=requireGlobalThis(),ee=requireArrayBuffer(),ne=requireSetSpecies(),re="ArrayBuffer",le=ee[re],Q=K[re];return Y({global:!0,constructor:!0,forced:Q!==le},{ArrayBuffer:le}),ne(re),es_arrayBuffer_constructor}var es_arrayBuffer_isView={},arrayBufferViewCore,hasRequiredArrayBufferViewCore;function requireArrayBufferViewCore(){if(hasRequiredArrayBufferViewCore)return arrayBufferViewCore;hasRequiredArrayBufferViewCore=1;var Y=requireArrayBufferBasicDetection(),K=requireDescriptors(),ee=requireGlobalThis(),ne=requireIsCallable(),re=requireIsObject$1(),le=requireHasOwnProperty(),Q=requireClassof(),R=requireTryToString(),U=requireCreateNonEnumerableProperty(),Z=requireDefineBuiltIn(),ae=requireDefineBuiltInAccessor(),he=requireObjectIsPrototypeOf(),pe=requireObjectGetPrototypeOf(),me=requireObjectSetPrototypeOf(),ve=requireWellKnownSymbol(),Re=requireUid(),Me=requireInternalState(),Te=Me.enforce,Ce=Me.get,We=ee.Int8Array,Fe=We&&We.prototype,ke=ee.Uint8ClampedArray,Ze=ke&&ke.prototype,Je=We&&pe(We),Qe=Fe&&pe(Fe),it=Object.prototype,lt=ee.TypeError,dt=ve("toStringTag"),yt=Re("TYPED_ARRAY_TAG"),gt="TypedArrayConstructor",qt=Y&&!!me&&Q(ee.opera)!=="Opera",Ft=!1,Gt,ft,Rt,pt={Int8Array:1,Uint8Array:1,Uint8ClampedArray:1,Int16Array:2,Uint16Array:2,Int32Array:4,Uint32Array:4,Float32Array:4,Float64Array:8},At={BigInt64Array:8,BigUint64Array:8},It=function(or){if(!re(or))return!1;var Ir=Q(or);return Ir==="DataView"||le(pt,Ir)||le(At,Ir)},Dt=function(Qt){var or=pe(Qt);if(re(or)){var Ir=Ce(or);return Ir&&le(Ir,gt)?Ir[gt]:Dt(or)}},Zt=function(Qt){if(!re(Qt))return!1;var or=Q(Qt);return le(pt,or)||le(At,or)},nr=function(Qt){if(Zt(Qt))return Qt;throw new lt("Target is not a typed array")},Er=function(Qt){if(ne(Qt)&&(!me||he(Je,Qt)))return Qt;throw new lt(R(Qt)+" is not a typed array constructor")},vr=function(Qt,or,Ir,Rr){if(K){if(Ir)for(var Cr in pt){var wr=ee[Cr];if(wr&&le(wr.prototype,Qt))try{delete wr.prototype[Qt]}catch{try{wr.prototype[Qt]=or}catch{}}}(!Qe[Qt]||Ir)&&Z(Qe,Qt,Ir?or:qt&&Fe[Qt]||or,Rr)}},Sr=function(Qt,or,Ir){var Rr,Cr;if(K){if(me){if(Ir){for(Rr in pt)if(Cr=ee[Rr],Cr&&le(Cr,Qt))try{delete Cr[Qt]}catch{}}if(!Je[Qt]||Ir)try{return Z(Je,Qt,Ir?or:qt&&Je[Qt]||or)}catch{}else return}for(Rr in pt)Cr=ee[Rr],Cr&&(!Cr[Qt]||Ir)&&Z(Cr,Qt,or)}};for(Gt in pt)ft=ee[Gt],Rt=ft&&ft.prototype,Rt?Te(Rt)[gt]=ft:qt=!1;for(Gt in At)ft=ee[Gt],Rt=ft&&ft.prototype,Rt&&(Te(Rt)[gt]=ft);if((!qt||!ne(Je)||Je===Function.prototype)&&(Je=function(){throw new lt("Incorrect invocation")},qt))for(Gt in pt)ee[Gt]&&me(ee[Gt],Je);if((!qt||!Qe||Qe===it)&&(Qe=Je.prototype,qt))for(Gt in pt)ee[Gt]&&me(ee[Gt].prototype,Qe);if(qt&&pe(Ze)!==Qe&&me(Ze,Qe),K&&!le(Qe,dt)){Ft=!0,ae(Qe,dt,{configurable:!0,get:function(){return re(this)?this[yt]:void 0}});for(Gt in pt)ee[Gt]&&U(ee[Gt],yt,Gt)}return arrayBufferViewCore={NATIVE_ARRAY_BUFFER_VIEWS:qt,TYPED_ARRAY_TAG:Ft&&yt,aTypedArray:nr,aTypedArrayConstructor:Er,exportTypedArrayMethod:vr,exportTypedArrayStaticMethod:Sr,getTypedArrayConstructor:Dt,isView:It,isTypedArray:Zt,TypedArray:Je,TypedArrayPrototype:Qe},arrayBufferViewCore}var hasRequiredEs_arrayBuffer_isView;function requireEs_arrayBuffer_isView(){if(hasRequiredEs_arrayBuffer_isView)return es_arrayBuffer_isView;hasRequiredEs_arrayBuffer_isView=1;var Y=require_export(),K=requireArrayBufferViewCore(),ee=K.NATIVE_ARRAY_BUFFER_VIEWS;return Y({target:"ArrayBuffer",stat:!0,forced:!ee},{isView:K.isView}),es_arrayBuffer_isView}var es_arrayBuffer_slice={},hasRequiredEs_arrayBuffer_slice;function requireEs_arrayBuffer_slice(){if(hasRequiredEs_arrayBuffer_slice)return es_arrayBuffer_slice;hasRequiredEs_arrayBuffer_slice=1;var Y=require_export(),K=requireFunctionUncurryThisClause(),ee=requireFails(),ne=requireArrayBuffer(),re=requireAnObject(),le=requireToAbsoluteIndex(),Q=requireToLength(),R=ne.ArrayBuffer,U=ne.DataView,Z=U.prototype,ae=K(R.prototype.slice),he=K(Z.getUint8),pe=K(Z.setUint8),me=ee(function(){return!new R(2).slice(1,void 0).byteLength});return Y({target:"ArrayBuffer",proto:!0,unsafe:!0,forced:me},{slice:function(Re,Me){if(ae&&Me===void 0)return ae(re(this),Re);for(var Te=re(this).byteLength,Ce=le(Re,Te),We=le(Me===void 0?Te:Me,Te),Fe=new R(Q(We-Ce)),ke=new U(this),Ze=new U(Fe),Je=0;Ce<We;)pe(Ze,Je++,he(ke,Ce++));return Fe}}),es_arrayBuffer_slice}var es_dataView={},es_dataView_constructor={},hasRequiredEs_dataView_constructor;function requireEs_dataView_constructor(){if(hasRequiredEs_dataView_constructor)return es_dataView_constructor;hasRequiredEs_dataView_constructor=1;var Y=require_export(),K=requireArrayBuffer(),ee=requireArrayBufferBasicDetection();return Y({global:!0,constructor:!0,forced:!ee},{DataView:K.DataView}),es_dataView_constructor}var hasRequiredEs_dataView;function requireEs_dataView(){return hasRequiredEs_dataView||(hasRequiredEs_dataView=1,requireEs_dataView_constructor()),es_dataView}var es_dataView_getFloat16={},hasRequiredEs_dataView_getFloat16;function requireEs_dataView_getFloat16(){if(hasRequiredEs_dataView_getFloat16)return es_dataView_getFloat16;hasRequiredEs_dataView_getFloat16=1;var Y=require_export(),K=requireFunctionUncurryThis(),ee=Math.pow,ne=31,re=1023,le=ee(2,-24),Q=.0009765625,R=function(Z){var ae=Z>>>15,he=Z>>>10&ne,pe=Z&re;return he===ne?pe===0?ae===0?1/0:-1/0:NaN:he===0?pe*(ae===0?le:-le):ee(2,he-15)*(ae===0?1+pe*Q:-1-pe*Q)},U=K(DataView.prototype.getUint16);return Y({target:"DataView",proto:!0},{getFloat16:function(ae){return R(U(this,ae,arguments.length>1?arguments[1]:!1))}}),es_dataView_getFloat16}var es_dataView_setFloat16={},aDataView,hasRequiredADataView;function requireADataView(){if(hasRequiredADataView)return aDataView;hasRequiredADataView=1;var Y=requireClassof(),K=TypeError;return aDataView=function(ee){if(Y(ee)==="DataView")return ee;throw new K("Argument is not a DataView")},aDataView}var mathLog2,hasRequiredMathLog2;function requireMathLog2(){if(hasRequiredMathLog2)return mathLog2;hasRequiredMathLog2=1;var Y=Math.log,K=Math.LN2;return mathLog2=Math.log2||function(ne){return Y(ne)/K},mathLog2}var hasRequiredEs_dataView_setFloat16;function requireEs_dataView_setFloat16(){if(hasRequiredEs_dataView_setFloat16)return es_dataView_setFloat16;hasRequiredEs_dataView_setFloat16=1;var Y=require_export(),K=requireFunctionUncurryThis(),ee=requireADataView(),ne=requireToIndex(),re=requireMathLog2(),le=requireMathRoundTiesToEven(),Q=Math.pow,R=65520,U=61005353927612305e-21,Z=16777216,ae=1024,he=function(me){if(me!==me)return 32256;if(me===0)return(1/me===-1/0)<<15;var ve=me<0;if(ve&&(me=-me),me>=R)return ve<<15|31744;if(me<U)return ve<<15|le(me*Z);var Re=re(me)|0;if(Re===-15)return ve<<15|ae;var Me=le((me*Q(2,-Re)-1)*ae);return Me===ae?ve<<15|Re+16<<10:ve<<15|Re+15<<10|Me},pe=K(DataView.prototype.setUint16);return Y({target:"DataView",proto:!0},{setFloat16:function(ve,Re){pe(ee(this),ne(ve),he(+Re),arguments.length>2?arguments[2]:!1)}}),es_dataView_setFloat16}var es_arrayBuffer_detached={},arrayBufferByteLength,hasRequiredArrayBufferByteLength;function requireArrayBufferByteLength(){if(hasRequiredArrayBufferByteLength)return arrayBufferByteLength;hasRequiredArrayBufferByteLength=1;var Y=requireGlobalThis(),K=requireFunctionUncurryThisAccessor(),ee=requireClassofRaw(),ne=Y.ArrayBuffer,re=Y.TypeError;return arrayBufferByteLength=ne&&K(ne.prototype,"byteLength","get")||function(le){if(ee(le)!=="ArrayBuffer")throw new re("ArrayBuffer expected");return le.byteLength},arrayBufferByteLength}var arrayBufferIsDetached,hasRequiredArrayBufferIsDetached;function requireArrayBufferIsDetached(){if(hasRequiredArrayBufferIsDetached)return arrayBufferIsDetached;hasRequiredArrayBufferIsDetached=1;var Y=requireGlobalThis(),K=requireArrayBufferBasicDetection(),ee=requireArrayBufferByteLength(),ne=Y.DataView;return arrayBufferIsDetached=function(re){if(!K||ee(re)!==0)return!1;try{return new ne(re),!1}catch{return!0}},arrayBufferIsDetached}var hasRequiredEs_arrayBuffer_detached;function requireEs_arrayBuffer_detached(){if(hasRequiredEs_arrayBuffer_detached)return es_arrayBuffer_detached;hasRequiredEs_arrayBuffer_detached=1;var Y=requireDescriptors(),K=requireDefineBuiltInAccessor(),ee=requireArrayBufferIsDetached(),ne=ArrayBuffer.prototype;return Y&&!("detached"in ne)&&K(ne,"detached",{configurable:!0,get:function(){return ee(this)}}),es_arrayBuffer_detached}var es_arrayBuffer_transfer={},arrayBufferNotDetached,hasRequiredArrayBufferNotDetached;function requireArrayBufferNotDetached(){if(hasRequiredArrayBufferNotDetached)return arrayBufferNotDetached;hasRequiredArrayBufferNotDetached=1;var Y=requireArrayBufferIsDetached(),K=TypeError;return arrayBufferNotDetached=function(ee){if(Y(ee))throw new K("ArrayBuffer is detached");return ee},arrayBufferNotDetached}var getBuiltInNodeModule,hasRequiredGetBuiltInNodeModule;function requireGetBuiltInNodeModule(){if(hasRequiredGetBuiltInNodeModule)return getBuiltInNodeModule;hasRequiredGetBuiltInNodeModule=1;var Y=requireGlobalThis(),K=requireEnvironmentIsNode();return getBuiltInNodeModule=function(ee){if(K){try{return Y.process.getBuiltinModule(ee)}catch{}try{return Function('return require("'+ee+'")')()}catch{}}},getBuiltInNodeModule}var structuredCloneProperTransfer,hasRequiredStructuredCloneProperTransfer;function requireStructuredCloneProperTransfer(){if(hasRequiredStructuredCloneProperTransfer)return structuredCloneProperTransfer;hasRequiredStructuredCloneProperTransfer=1;var Y=requireGlobalThis(),K=requireFails(),ee=requireEnvironmentV8Version(),ne=requireEnvironment(),re=Y.structuredClone;return structuredCloneProperTransfer=!!re&&!K(function(){if(ne==="DENO"&&ee>92||ne==="NODE"&&ee>94||ne==="BROWSER"&&ee>97)return!1;var le=new ArrayBuffer(8),Q=re(le,{transfer:[le]});return le.byteLength!==0||Q.byteLength!==8}),structuredCloneProperTransfer}var detachTransferable,hasRequiredDetachTransferable;function requireDetachTransferable(){if(hasRequiredDetachTransferable)return detachTransferable;hasRequiredDetachTransferable=1;var Y=requireGlobalThis(),K=requireGetBuiltInNodeModule(),ee=requireStructuredCloneProperTransfer(),ne=Y.structuredClone,re=Y.ArrayBuffer,le=Y.MessageChannel,Q=!1,R,U,Z,ae;if(ee)Q=function(he){ne(he,{transfer:[he]})};else if(re)try{le||(R=K("worker_threads"),R&&(le=R.MessageChannel)),le&&(U=new le,Z=new re(2),ae=function(he){U.port1.postMessage(null,[he])},Z.byteLength===2&&(ae(Z),Z.byteLength===0&&(Q=ae)))}catch{}return detachTransferable=Q,detachTransferable}var arrayBufferTransfer,hasRequiredArrayBufferTransfer;function requireArrayBufferTransfer(){if(hasRequiredArrayBufferTransfer)return arrayBufferTransfer;hasRequiredArrayBufferTransfer=1;var Y=requireGlobalThis(),K=requireFunctionUncurryThis(),ee=requireFunctionUncurryThisAccessor(),ne=requireToIndex(),re=requireArrayBufferNotDetached(),le=requireArrayBufferByteLength(),Q=requireDetachTransferable(),R=requireStructuredCloneProperTransfer(),U=Y.structuredClone,Z=Y.ArrayBuffer,ae=Y.DataView,he=Math.min,pe=Z.prototype,me=ae.prototype,ve=K(pe.slice),Re=ee(pe,"resizable","get"),Me=ee(pe,"maxByteLength","get"),Te=K(me.getInt8),Ce=K(me.setInt8);return arrayBufferTransfer=(R||Q)&&function(We,Fe,ke){var Ze=le(We),Je=Fe===void 0?Ze:ne(Fe),Qe=!Re||!Re(We),it;if(re(We),R&&(We=U(We,{transfer:[We]}),Ze===Je&&(ke||Qe)))return We;if(Ze>=Je&&(!ke||Qe))it=ve(We,0,Je);else{var lt=ke&&!Qe&&Me?{maxByteLength:Me(We)}:void 0;it=new Z(Je,lt);for(var dt=new ae(We),yt=new ae(it),gt=he(Je,Ze),qt=0;qt<gt;qt++)Ce(yt,qt,Te(dt,qt))}return R||Q(We),it},arrayBufferTransfer}var hasRequiredEs_arrayBuffer_transfer;function requireEs_arrayBuffer_transfer(){if(hasRequiredEs_arrayBuffer_transfer)return es_arrayBuffer_transfer;hasRequiredEs_arrayBuffer_transfer=1;var Y=require_export(),K=requireArrayBufferTransfer();return K&&Y({target:"ArrayBuffer",proto:!0},{transfer:function(){return K(this,arguments.length?arguments[0]:void 0,!0)}}),es_arrayBuffer_transfer}var es_arrayBuffer_transferToFixedLength={},hasRequiredEs_arrayBuffer_transferToFixedLength;function requireEs_arrayBuffer_transferToFixedLength(){if(hasRequiredEs_arrayBuffer_transferToFixedLength)return es_arrayBuffer_transferToFixedLength;hasRequiredEs_arrayBuffer_transferToFixedLength=1;var Y=require_export(),K=requireArrayBufferTransfer();return K&&Y({target:"ArrayBuffer",proto:!0},{transferToFixedLength:function(){return K(this,arguments.length?arguments[0]:void 0,!1)}}),es_arrayBuffer_transferToFixedLength}var es_date_getYear={},hasRequiredEs_date_getYear;function requireEs_date_getYear(){if(hasRequiredEs_date_getYear)return es_date_getYear;hasRequiredEs_date_getYear=1;var Y=require_export(),K=requireFunctionUncurryThis(),ee=requireFails(),ne=ee(function(){return new Date(16e11).getYear()!==120}),re=K(Date.prototype.getFullYear);return Y({target:"Date",proto:!0,forced:ne},{getYear:function(){return re(this)-1900}}),es_date_getYear}var es_date_now={},hasRequiredEs_date_now;function requireEs_date_now(){if(hasRequiredEs_date_now)return es_date_now;hasRequiredEs_date_now=1;var Y=require_export(),K=requireFunctionUncurryThis(),ee=Date,ne=K(ee.prototype.getTime);return Y({target:"Date",stat:!0},{now:function(){return ne(new ee)}}),es_date_now}var es_date_setYear={},hasRequiredEs_date_setYear;function requireEs_date_setYear(){if(hasRequiredEs_date_setYear)return es_date_setYear;hasRequiredEs_date_setYear=1;var Y=require_export(),K=requireFunctionUncurryThis(),ee=requireToIntegerOrInfinity(),ne=Date.prototype,re=K(ne.getTime),le=K(ne.setFullYear);return Y({target:"Date",proto:!0},{setYear:function(R){re(this);var U=ee(R),Z=U>=0&&U<=99?U+1900:U;return le(this,Z)}}),es_date_setYear}var es_date_toGmtString={},hasRequiredEs_date_toGmtString;function requireEs_date_toGmtString(){if(hasRequiredEs_date_toGmtString)return es_date_toGmtString;hasRequiredEs_date_toGmtString=1;var Y=require_export();return Y({target:"Date",proto:!0},{toGMTString:Date.prototype.toUTCString}),es_date_toGmtString}var es_date_toIsoString={},stringRepeat,hasRequiredStringRepeat;function requireStringRepeat(){if(hasRequiredStringRepeat)return stringRepeat;hasRequiredStringRepeat=1;var Y=requireToIntegerOrInfinity(),K=requireToString$1(),ee=requireRequireObjectCoercible(),ne=RangeError;return stringRepeat=function(le){var Q=K(ee(this)),R="",U=Y(le);if(U<0||U===1/0)throw new ne("Wrong number of repetitions");for(;U>0;(U>>>=1)&&(Q+=Q))U&1&&(R+=Q);return R},stringRepeat}var stringPad,hasRequiredStringPad;function requireStringPad(){if(hasRequiredStringPad)return stringPad;hasRequiredStringPad=1;var Y=requireFunctionUncurryThis(),K=requireToLength(),ee=requireToString$1(),ne=requireStringRepeat(),re=requireRequireObjectCoercible(),le=Y(ne),Q=Y("".slice),R=Math.ceil,U=function(Z){return function(ae,he,pe){var me=ee(re(ae)),ve=K(he),Re=me.length,Me=pe===void 0?" ":ee(pe),Te,Ce;return ve<=Re||Me===""?me:(Te=ve-Re,Ce=le(Me,R(Te/Me.length)),Ce.length>Te&&(Ce=Q(Ce,0,Te)),Z?me+Ce:Ce+me)}};return stringPad={start:U(!1),end:U(!0)},stringPad}var dateToIsoString,hasRequiredDateToIsoString;function requireDateToIsoString(){if(hasRequiredDateToIsoString)return dateToIsoString;hasRequiredDateToIsoString=1;var Y=requireFunctionUncurryThis(),K=requireFails(),ee=requireStringPad().start,ne=RangeError,re=isFinite,le=Math.abs,Q=Date.prototype,R=Q.toISOString,U=Y(Q.getTime),Z=Y(Q.getUTCDate),ae=Y(Q.getUTCFullYear),he=Y(Q.getUTCHours),pe=Y(Q.getUTCMilliseconds),me=Y(Q.getUTCMinutes),ve=Y(Q.getUTCMonth),Re=Y(Q.getUTCSeconds);return dateToIsoString=K(function(){return R.call(new Date(-5e13-1))!=="0385-07-25T07:06:39.999Z"})||!K(function(){R.call(new Date(NaN))})?function(){if(!re(U(this)))throw new ne("Invalid time value");var Te=this,Ce=ae(Te),We=pe(Te),Fe=Ce<0?"-":Ce>9999?"+":"";return Fe+ee(le(Ce),Fe?6:4,0)+"-"+ee(ve(Te)+1,2,0)+"-"+ee(Z(Te),2,0)+"T"+ee(he(Te),2,0)+":"+ee(me(Te),2,0)+":"+ee(Re(Te),2,0)+"."+ee(We,3,0)+"Z"}:R,dateToIsoString}var hasRequiredEs_date_toIsoString;function requireEs_date_toIsoString(){if(hasRequiredEs_date_toIsoString)return es_date_toIsoString;hasRequiredEs_date_toIsoString=1;var Y=require_export(),K=requireDateToIsoString();return Y({target:"Date",proto:!0,forced:Date.prototype.toISOString!==K},{toISOString:K}),es_date_toIsoString}var es_date_toJson={},hasRequiredEs_date_toJson;function requireEs_date_toJson(){if(hasRequiredEs_date_toJson)return es_date_toJson;hasRequiredEs_date_toJson=1;var Y=require_export(),K=requireFails(),ee=requireToObject(),ne=requireToPrimitive(),re=K(function(){return new Date(NaN).toJSON()!==null||Date.prototype.toJSON.call({toISOString:function(){return 1}})!==1});return Y({target:"Date",proto:!0,arity:1,forced:re},{toJSON:function(Q){var R=ee(this),U=ne(R,"number");return typeof U=="number"&&!isFinite(U)?null:R.toISOString()}}),es_date_toJson}var es_date_toPrimitive={},dateToPrimitive,hasRequiredDateToPrimitive;function requireDateToPrimitive(){if(hasRequiredDateToPrimitive)return dateToPrimitive;hasRequiredDateToPrimitive=1;var Y=requireAnObject(),K=requireOrdinaryToPrimitive(),ee=TypeError;return dateToPrimitive=function(ne){if(Y(this),ne==="string"||ne==="default")ne="string";else if(ne!=="number")throw new ee("Incorrect hint");return K(this,ne)},dateToPrimitive}var hasRequiredEs_date_toPrimitive;function requireEs_date_toPrimitive(){if(hasRequiredEs_date_toPrimitive)return es_date_toPrimitive;hasRequiredEs_date_toPrimitive=1;var Y=requireHasOwnProperty(),K=requireDefineBuiltIn(),ee=requireDateToPrimitive(),ne=requireWellKnownSymbol(),re=ne("toPrimitive"),le=Date.prototype;return Y(le,re)||K(le,re,ee),es_date_toPrimitive}var es_date_toString={},hasRequiredEs_date_toString;function requireEs_date_toString(){if(hasRequiredEs_date_toString)return es_date_toString;hasRequiredEs_date_toString=1;var Y=requireFunctionUncurryThis(),K=requireDefineBuiltIn(),ee=Date.prototype,ne="Invalid Date",re="toString",le=Y(ee[re]),Q=Y(ee.getTime);return String(new Date(NaN))!==ne&&K(ee,re,function(){var U=Q(this);return U===U?le(this):ne}),es_date_toString}var es_disposableStack_constructor={},addDisposableResource,hasRequiredAddDisposableResource;function requireAddDisposableResource(){if(hasRequiredAddDisposableResource)return addDisposableResource;hasRequiredAddDisposableResource=1;var Y=requireGetBuiltIn(),K=requireFunctionCall(),ee=requireFunctionUncurryThis(),ne=requireFunctionBindContext(),re=requireAnObject(),le=requireACallable(),Q=requireIsNullOrUndefined(),R=requireGetMethod(),U=requireWellKnownSymbol(),Z=U("asyncDispose"),ae=U("dispose"),he=ee([].push),pe=function(ve,Re){if(Re==="async-dispose"){var Me=R(ve,Z);return Me!==void 0||(Me=R(ve,ae),Me===void 0)?Me:function(){var Te=this,Ce=Y("Promise");return new Ce(function(We){K(Me,Te),We(void 0)})}}return R(ve,ae)},me=function(ve,Re,Me){return arguments.length<3&&!Q(ve)&&(Me=le(pe(re(ve),Re))),Me===void 0?function(){}:ne(Me,ve)};return addDisposableResource=function(ve,Re,Me,Te){var Ce;if(arguments.length<4){if(Q(Re)&&Me==="sync-dispose")return;Ce=me(Re,Me)}else Ce=me(void 0,Me,Te);he(ve.stack,Ce)},addDisposableResource}var hasRequiredEs_disposableStack_constructor;function requireEs_disposableStack_constructor(){if(hasRequiredEs_disposableStack_constructor)return es_disposableStack_constructor;hasRequiredEs_disposableStack_constructor=1;var Y=require_export(),K=requireDescriptors(),ee=requireGetBuiltIn(),ne=requireACallable(),re=requireAnInstance(),le=requireDefineBuiltIn(),Q=requireDefineBuiltIns(),R=requireDefineBuiltInAccessor(),U=requireWellKnownSymbol(),Z=requireInternalState(),ae=requireAddDisposableResource(),he=ee("SuppressedError"),pe=ReferenceError,me=U("dispose"),ve=U("toStringTag"),Re="DisposableStack",Me=Z.set,Te=Z.getterFor(Re),Ce="sync-dispose",We="disposed",Fe="pending",ke=function(Qe){var it=Te(Qe);if(it.state===We)throw new pe(Re+" already disposed");return it},Ze=function(){Me(re(this,Je),{type:Re,state:Fe,stack:[]}),K||(this.disposed=!1)},Je=Ze.prototype;return Q(Je,{dispose:function(){var it=Te(this);if(it.state!==We){it.state=We,K||(this.disposed=!0);for(var lt=it.stack,dt=lt.length,yt=!1,gt;dt;){var qt=lt[--dt];lt[dt]=null;try{qt()}catch(Ft){yt?gt=new he(Ft,gt):(yt=!0,gt=Ft)}}if(it.stack=null,yt)throw gt}},use:function(it){return ae(ke(this),it,Ce),it},adopt:function(it,lt){var dt=ke(this);return ne(lt),ae(dt,void 0,Ce,function(){lt(it)}),it},defer:function(it){var lt=ke(this);ne(it),ae(lt,void 0,Ce,it)},move:function(){var it=ke(this),lt=new Ze;return Te(lt).stack=it.stack,it.stack=[],it.state=We,K||(this.disposed=!0),lt}}),K&&R(Je,"disposed",{configurable:!0,get:function(){return Te(this).state===We}}),le(Je,me,Je.dispose,{name:"dispose"}),le(Je,ve,Re,{nonWritable:!0}),Y({global:!0,constructor:!0},{DisposableStack:Ze}),es_disposableStack_constructor}var es_escape={},hasRequiredEs_escape;function requireEs_escape(){if(hasRequiredEs_escape)return es_escape;hasRequiredEs_escape=1;var Y=require_export(),K=requireFunctionUncurryThis(),ee=requireToString$1(),ne=K("".charAt),re=K("".charCodeAt),le=K(/./.exec),Q=K(1.1.toString),R=K("".toUpperCase),U=/[\w*+\-./@]/,Z=function(ae,he){for(var pe=Q(ae,16);pe.length<he;)pe="0"+pe;return pe};return Y({global:!0},{escape:function(he){for(var pe=ee(he),me="",ve=pe.length,Re=0,Me,Te;Re<ve;)Me=ne(pe,Re++),le(U,Me)?me+=Me:(Te=re(Me,0),Te<256?me+="%"+Z(Te,2):me+="%u"+R(Z(Te,4)));return me}}),es_escape}var es_function_bind={},functionBind,hasRequiredFunctionBind;function requireFunctionBind(){if(hasRequiredFunctionBind)return functionBind;hasRequiredFunctionBind=1;var Y=requireFunctionUncurryThis(),K=requireACallable(),ee=requireIsObject$1(),ne=requireHasOwnProperty(),re=requireArraySlice(),le=requireFunctionBindNative(),Q=Function,R=Y([].concat),U=Y([].join),Z={},ae=function(he,pe,me){if(!ne(Z,pe)){for(var ve=[],Re=0;Re<pe;Re++)ve[Re]="a["+Re+"]";Z[pe]=Q("C,a","return new C("+U(ve,",")+")")}return Z[pe](he,me)};return functionBind=le?Q.bind:function(pe){var me=K(this),ve=me.prototype,Re=re(arguments,1),Me=function(){var Ce=R(Re,re(arguments));return this instanceof Me?ae(me,Ce.length,Ce):me.apply(pe,Ce)};return ee(ve)&&(Me.prototype=ve),Me},functionBind}var hasRequiredEs_function_bind;function requireEs_function_bind(){if(hasRequiredEs_function_bind)return es_function_bind;hasRequiredEs_function_bind=1;var Y=require_export(),K=requireFunctionBind();return Y({target:"Function",proto:!0,forced:Function.bind!==K},{bind:K}),es_function_bind}var es_function_hasInstance={},hasRequiredEs_function_hasInstance;function requireEs_function_hasInstance(){if(hasRequiredEs_function_hasInstance)return es_function_hasInstance;hasRequiredEs_function_hasInstance=1;var Y=requireIsCallable(),K=requireIsObject$1(),ee=requireObjectDefineProperty(),ne=requireObjectIsPrototypeOf(),re=requireWellKnownSymbol(),le=requireMakeBuiltIn(),Q=re("hasInstance"),R=Function.prototype;return Q in R||ee.f(R,Q,{value:le(function(U){if(!Y(this)||!K(U))return!1;var Z=this.prototype;return K(Z)?ne(Z,U):U instanceof this},Q)}),es_function_hasInstance}var es_function_name={},hasRequiredEs_function_name;function requireEs_function_name(){if(hasRequiredEs_function_name)return es_function_name;hasRequiredEs_function_name=1;var Y=requireDescriptors(),K=requireFunctionName().EXISTS,ee=requireFunctionUncurryThis(),ne=requireDefineBuiltInAccessor(),re=Function.prototype,le=ee(re.toString),Q=/function\b(?:\s|\/\*[\S\s]*?\*\/|\/\/[^\n\r]*[\n\r]+)*([^\s(/]*)/,R=ee(Q.exec),U="name";return Y&&!K&&ne(re,U,{configurable:!0,get:function(){try{return R(Q,le(this))[1]}catch{return""}}}),es_function_name}var es_globalThis={},hasRequiredEs_globalThis;function requireEs_globalThis(){if(hasRequiredEs_globalThis)return es_globalThis;hasRequiredEs_globalThis=1;var Y=require_export(),K=requireGlobalThis();return Y({global:!0,forced:K.globalThis!==K},{globalThis:K}),es_globalThis}var es_iterator_constructor={},hasRequiredEs_iterator_constructor;function requireEs_iterator_constructor(){if(hasRequiredEs_iterator_constructor)return es_iterator_constructor;hasRequiredEs_iterator_constructor=1;var Y=require_export(),K=requireGlobalThis(),ee=requireAnInstance(),ne=requireAnObject(),re=requireIsCallable(),le=requireObjectGetPrototypeOf(),Q=requireDefineBuiltInAccessor(),R=requireCreateProperty(),U=requireFails(),Z=requireHasOwnProperty(),ae=requireWellKnownSymbol(),he=requireIteratorsCore().IteratorPrototype,pe=requireDescriptors(),me=requireIsPure(),ve="constructor",Re="Iterator",Me=ae("toStringTag"),Te=TypeError,Ce=K[Re],We=me||!re(Ce)||Ce.prototype!==he||!U(function(){Ce({})}),Fe=function(){if(ee(this,he),le(this)===he)throw new Te("Abstract class Iterator not directly constructable")},ke=function(Ze,Je){pe?Q(he,Ze,{configurable:!0,get:function(){return Je},set:function(Qe){if(ne(this),this===he)throw new Te("You can't redefine this property");Z(this,Ze)?this[Ze]=Qe:R(this,Ze,Qe)}}):he[Ze]=Je};return Z(he,Me)||ke(Me,Re),(We||!Z(he,ve)||he[ve]===Object)&&ke(ve,Fe),Fe.prototype=he,Y({global:!0,constructor:!0,forced:We},{Iterator:Fe}),es_iterator_constructor}var es_iterator_dispose={},hasRequiredEs_iterator_dispose;function requireEs_iterator_dispose(){if(hasRequiredEs_iterator_dispose)return es_iterator_dispose;hasRequiredEs_iterator_dispose=1;var Y=requireFunctionCall(),K=requireDefineBuiltIn(),ee=requireGetMethod(),ne=requireHasOwnProperty(),re=requireWellKnownSymbol(),le=requireIteratorsCore().IteratorPrototype,Q=re("dispose");return ne(le,Q)||K(le,Q,function(){var R=ee(this,"return");R&&Y(R,this)}),es_iterator_dispose}var es_iterator_drop={},getIteratorDirect,hasRequiredGetIteratorDirect;function requireGetIteratorDirect(){return hasRequiredGetIteratorDirect||(hasRequiredGetIteratorDirect=1,getIteratorDirect=function(Y){return{iterator:Y,next:Y.next,done:!1}}),getIteratorDirect}var notANan,hasRequiredNotANan;function requireNotANan(){if(hasRequiredNotANan)return notANan;hasRequiredNotANan=1;var Y=RangeError;return notANan=function(K){if(K===K)return K;throw new Y("NaN is not allowed")},notANan}var toPositiveInteger,hasRequiredToPositiveInteger;function requireToPositiveInteger(){if(hasRequiredToPositiveInteger)return toPositiveInteger;hasRequiredToPositiveInteger=1;var Y=requireToIntegerOrInfinity(),K=RangeError;return toPositiveInteger=function(ee){var ne=Y(ee);if(ne<0)throw new K("The argument can't be less than 0");return ne},toPositiveInteger}var iteratorCloseAll,hasRequiredIteratorCloseAll;function requireIteratorCloseAll(){if(hasRequiredIteratorCloseAll)return iteratorCloseAll;hasRequiredIteratorCloseAll=1;var Y=requireIteratorClose();return iteratorCloseAll=function(K,ee,ne){for(var re=K.length-1;re>=0;re--)if(K[re]!==void 0)try{ne=Y(K[re].iterator,ee,ne)}catch(le){ee="throw",ne=le}if(ee==="throw")throw ne;return ne},iteratorCloseAll}var iteratorCreateProxy,hasRequiredIteratorCreateProxy;function requireIteratorCreateProxy(){if(hasRequiredIteratorCreateProxy)return iteratorCreateProxy;hasRequiredIteratorCreateProxy=1;var Y=requireFunctionCall(),K=requireObjectCreate(),ee=requireCreateNonEnumerableProperty(),ne=requireDefineBuiltIns(),re=requireWellKnownSymbol(),le=requireInternalState(),Q=requireGetMethod(),R=requireIteratorsCore().IteratorPrototype,U=requireCreateIterResultObject(),Z=requireIteratorClose(),ae=requireIteratorCloseAll(),he=re("toStringTag"),pe="IteratorHelper",me="WrapForValidIterator",ve="normal",Re="throw",Me=le.set,Te=function(Fe){var ke=le.getterFor(Fe?me:pe);return ne(K(R),{next:function(){var Je=ke(this);if(Fe)return Je.nextHandler();if(Je.done)return U(void 0,!0);try{var Qe=Je.nextHandler();return Je.returnHandlerResult?Qe:U(Qe,Je.done)}catch(it){throw Je.done=!0,it}},return:function(){var Ze=ke(this),Je=Ze.iterator;if(Ze.done=!0,Fe){var Qe=Q(Je,"return");return Qe?Y(Qe,Je):U(void 0,!0)}if(Ze.inner)try{Z(Ze.inner.iterator,ve)}catch(it){return Z(Je,Re,it)}if(Ze.openIters)try{ae(Ze.openIters,ve)}catch(it){return Z(Je,Re,it)}return Je&&Z(Je,ve),U(void 0,!0)}})},Ce=Te(!0),We=Te(!1);return ee(We,he,"Iterator Helper"),iteratorCreateProxy=function(Fe,ke,Ze){var Je=function(it,lt){lt?(lt.iterator=it.iterator,lt.next=it.next):lt=it,lt.type=ke?me:pe,lt.returnHandlerResult=!!Ze,lt.nextHandler=Fe,lt.counter=0,lt.done=!1,Me(this,lt)};return Je.prototype=ke?Ce:We,Je},iteratorCreateProxy}var iteratorHelperThrowsOnInvalidIterator,hasRequiredIteratorHelperThrowsOnInvalidIterator;function requireIteratorHelperThrowsOnInvalidIterator(){return hasRequiredIteratorHelperThrowsOnInvalidIterator||(hasRequiredIteratorHelperThrowsOnInvalidIterator=1,iteratorHelperThrowsOnInvalidIterator=function(Y,K){var ee=typeof Iterator=="function"&&Iterator.prototype[Y];if(ee)try{ee.call({next:null},K).next()}catch{return!0}}),iteratorHelperThrowsOnInvalidIterator}var iteratorHelperWithoutClosingOnEarlyError,hasRequiredIteratorHelperWithoutClosingOnEarlyError;function requireIteratorHelperWithoutClosingOnEarlyError(){if(hasRequiredIteratorHelperWithoutClosingOnEarlyError)return iteratorHelperWithoutClosingOnEarlyError;hasRequiredIteratorHelperWithoutClosingOnEarlyError=1;var Y=requireGlobalThis();return iteratorHelperWithoutClosingOnEarlyError=function(K,ee){var ne=Y.Iterator,re=ne&&ne.prototype,le=re&&re[K],Q=!1;if(le)try{le.call({next:function(){return{done:!0}},return:function(){Q=!0}},-1)}catch(R){R instanceof ee||(Q=!1)}if(!Q)return le},iteratorHelperWithoutClosingOnEarlyError}var hasRequiredEs_iterator_drop;function requireEs_iterator_drop(){if(hasRequiredEs_iterator_drop)return es_iterator_drop;hasRequiredEs_iterator_drop=1;var Y=require_export(),K=requireFunctionCall(),ee=requireAnObject(),ne=requireGetIteratorDirect(),re=requireNotANan(),le=requireToPositiveInteger(),Q=requireIteratorClose(),R=requireIteratorCreateProxy(),U=requireIteratorHelperThrowsOnInvalidIterator(),Z=requireIteratorHelperWithoutClosingOnEarlyError(),ae=requireIsPure(),he=!ae&&!U("drop",0),pe=!ae&&!he&&Z("drop",RangeError),me=ae||he||pe,ve=R(function(){for(var Re=this.iterator,Me=this.next,Te,Ce;this.remaining;)if(this.remaining--,Te=ee(K(Me,Re)),Ce=this.done=!!Te.done,Ce)return;if(Te=ee(K(Me,Re)),Ce=this.done=!!Te.done,!Ce)return Te.value});return Y({target:"Iterator",proto:!0,real:!0,forced:me},{drop:function(Me){ee(this);var Te;try{Te=le(re(+Me))}catch(Ce){Q(this,"throw",Ce)}return pe?K(pe,this,Te):new ve(ne(this),{remaining:Te})}}),es_iterator_drop}var es_iterator_every={},hasRequiredEs_iterator_every;function requireEs_iterator_every(){if(hasRequiredEs_iterator_every)return es_iterator_every;hasRequiredEs_iterator_every=1;var Y=require_export(),K=requireFunctionCall(),ee=requireIterate(),ne=requireACallable(),re=requireAnObject(),le=requireGetIteratorDirect(),Q=requireIteratorClose(),R=requireIteratorHelperWithoutClosingOnEarlyError(),U=R("every",TypeError);return Y({target:"Iterator",proto:!0,real:!0,forced:U},{every:function(ae){re(this);try{ne(ae)}catch(me){Q(this,"throw",me)}if(U)return K(U,this,ae);var he=le(this),pe=0;return!ee(he,function(me,ve){if(!ae(me,pe++))return ve()},{IS_RECORD:!0,INTERRUPTED:!0}).stopped}}),es_iterator_every}var es_iterator_filter={},hasRequiredEs_iterator_filter;function requireEs_iterator_filter(){if(hasRequiredEs_iterator_filter)return es_iterator_filter;hasRequiredEs_iterator_filter=1;var Y=require_export(),K=requireFunctionCall(),ee=requireACallable(),ne=requireAnObject(),re=requireGetIteratorDirect(),le=requireIteratorCreateProxy(),Q=requireCallWithSafeIterationClosing(),R=requireIsPure(),U=requireIteratorClose(),Z=requireIteratorHelperThrowsOnInvalidIterator(),ae=requireIteratorHelperWithoutClosingOnEarlyError(),he=!R&&!Z("filter",function(){}),pe=!R&&!he&&ae("filter",TypeError),me=R||he||pe,ve=le(function(){for(var Re=this.iterator,Me=this.predicate,Te=this.next,Ce,We,Fe;;){if(Ce=ne(K(Te,Re)),We=this.done=!!Ce.done,We)return;if(Fe=Ce.value,Q(Re,Me,[Fe,this.counter++],!0))return Fe}});return Y({target:"Iterator",proto:!0,real:!0,forced:me},{filter:function(Me){ne(this);try{ee(Me)}catch(Te){U(this,"throw",Te)}return pe?K(pe,this,Me):new ve(re(this),{predicate:Me})}}),es_iterator_filter}var es_iterator_find={},hasRequiredEs_iterator_find;function requireEs_iterator_find(){if(hasRequiredEs_iterator_find)return es_iterator_find;hasRequiredEs_iterator_find=1;var Y=require_export(),K=requireFunctionCall(),ee=requireIterate(),ne=requireACallable(),re=requireAnObject(),le=requireGetIteratorDirect(),Q=requireIteratorClose(),R=requireIteratorHelperWithoutClosingOnEarlyError(),U=R("find",TypeError);return Y({target:"Iterator",proto:!0,real:!0,forced:U},{find:function(ae){re(this);try{ne(ae)}catch(me){Q(this,"throw",me)}if(U)return K(U,this,ae);var he=le(this),pe=0;return ee(he,function(me,ve){if(ae(me,pe++))return ve(me)},{IS_RECORD:!0,INTERRUPTED:!0}).result}}),es_iterator_find}var es_iterator_flatMap={},getIteratorFlattenable,hasRequiredGetIteratorFlattenable;function requireGetIteratorFlattenable(){if(hasRequiredGetIteratorFlattenable)return getIteratorFlattenable;hasRequiredGetIteratorFlattenable=1;var Y=requireFunctionCall(),K=requireAnObject(),ee=requireGetIteratorDirect(),ne=requireGetIteratorMethod();return getIteratorFlattenable=function(re,le){(!le||typeof re!="string")&&K(re);var Q=ne(re);return ee(K(Q!==void 0?Y(Q,re):re))},getIteratorFlattenable}var hasRequiredEs_iterator_flatMap;function requireEs_iterator_flatMap(){if(hasRequiredEs_iterator_flatMap)return es_iterator_flatMap;hasRequiredEs_iterator_flatMap=1;var Y=require_export(),K=requireFunctionCall(),ee=requireACallable(),ne=requireAnObject(),re=requireGetIteratorDirect(),le=requireGetIteratorFlattenable(),Q=requireIteratorCreateProxy(),R=requireIteratorClose(),U=requireIsPure(),Z=requireIteratorHelperThrowsOnInvalidIterator(),ae=requireIteratorHelperWithoutClosingOnEarlyError(),he=!U&&!Z("flatMap",function(){}),pe=!U&&!he&&ae("flatMap",TypeError),me=U||he||pe,ve=Q(function(){for(var Re=this.iterator,Me=this.mapper,Te,Ce;;){if(Ce=this.inner)try{if(Te=ne(K(Ce.next,Ce.iterator)),!Te.done)return Te.value;this.inner=null}catch(We){R(Re,"throw",We)}if(Te=ne(K(this.next,Re)),this.done=!!Te.done)return;try{this.inner=le(Me(Te.value,this.counter++),!1)}catch(We){R(Re,"throw",We)}}});return Y({target:"Iterator",proto:!0,real:!0,forced:me},{flatMap:function(Me){ne(this);try{ee(Me)}catch(Te){R(this,"throw",Te)}return pe?K(pe,this,Me):new ve(re(this),{mapper:Me,inner:null})}}),es_iterator_flatMap}var es_iterator_forEach={},hasRequiredEs_iterator_forEach;function requireEs_iterator_forEach(){if(hasRequiredEs_iterator_forEach)return es_iterator_forEach;hasRequiredEs_iterator_forEach=1;var Y=require_export(),K=requireFunctionCall(),ee=requireIterate(),ne=requireACallable(),re=requireAnObject(),le=requireGetIteratorDirect(),Q=requireIteratorClose(),R=requireIteratorHelperWithoutClosingOnEarlyError(),U=R("forEach",TypeError);return Y({target:"Iterator",proto:!0,real:!0,forced:U},{forEach:function(ae){re(this);try{ne(ae)}catch(me){Q(this,"throw",me)}if(U)return K(U,this,ae);var he=le(this),pe=0;ee(he,function(me){ae(me,pe++)},{IS_RECORD:!0})}}),es_iterator_forEach}var es_iterator_from={},hasRequiredEs_iterator_from;function requireEs_iterator_from(){if(hasRequiredEs_iterator_from)return es_iterator_from;hasRequiredEs_iterator_from=1;var Y=require_export(),K=requireFunctionCall(),ee=requireToObject(),ne=requireObjectIsPrototypeOf(),re=requireIteratorsCore().IteratorPrototype,le=requireIteratorCreateProxy(),Q=requireGetIteratorFlattenable(),R=requireIsPure(),U=R||function(){try{Iterator.from({return:null}).return()}catch{return!0}}(),Z=le(function(){return K(this.next,this.iterator)},!0);return Y({target:"Iterator",stat:!0,forced:U},{from:function(he){var pe=Q(typeof he=="string"?ee(he):he,!0);return ne(re,pe.iterator)?pe.iterator:new Z(pe)}}),es_iterator_from}var es_iterator_map={},hasRequiredEs_iterator_map;function requireEs_iterator_map(){if(hasRequiredEs_iterator_map)return es_iterator_map;hasRequiredEs_iterator_map=1;var Y=require_export(),K=requireFunctionCall(),ee=requireACallable(),ne=requireAnObject(),re=requireGetIteratorDirect(),le=requireIteratorCreateProxy(),Q=requireCallWithSafeIterationClosing(),R=requireIteratorClose(),U=requireIteratorHelperThrowsOnInvalidIterator(),Z=requireIteratorHelperWithoutClosingOnEarlyError(),ae=requireIsPure(),he=!ae&&!U("map",function(){}),pe=!ae&&!he&&Z("map",TypeError),me=ae||he||pe,ve=le(function(){var Re=this.iterator,Me=ne(K(this.next,Re)),Te=this.done=!!Me.done;if(!Te)return Q(Re,this.mapper,[Me.value,this.counter++],!0)});return Y({target:"Iterator",proto:!0,real:!0,forced:me},{map:function(Me){ne(this);try{ee(Me)}catch(Te){R(this,"throw",Te)}return pe?K(pe,this,Me):new ve(re(this),{mapper:Me})}}),es_iterator_map}var es_iterator_reduce={},hasRequiredEs_iterator_reduce;function requireEs_iterator_reduce(){if(hasRequiredEs_iterator_reduce)return es_iterator_reduce;hasRequiredEs_iterator_reduce=1;var Y=require_export(),K=requireIterate(),ee=requireACallable(),ne=requireAnObject(),re=requireGetIteratorDirect(),le=requireIteratorClose(),Q=requireIteratorHelperWithoutClosingOnEarlyError(),R=requireFunctionApply(),U=requireFails(),Z=TypeError,ae=U(function(){[].keys().reduce(function(){},void 0)}),he=!ae&&Q("reduce",Z);return Y({target:"Iterator",proto:!0,real:!0,forced:ae||he},{reduce:function(me){ne(this);try{ee(me)}catch(Ce){le(this,"throw",Ce)}var ve=arguments.length<2,Re=ve?void 0:arguments[1];if(he)return R(he,this,ve?[me]:[me,Re]);var Me=re(this),Te=0;if(K(Me,function(Ce){ve?(ve=!1,Re=Ce):Re=me(Re,Ce,Te),Te++},{IS_RECORD:!0}),ve)throw new Z("Reduce of empty iterator with no initial value");return Re}}),es_iterator_reduce}var es_iterator_some={},hasRequiredEs_iterator_some;function requireEs_iterator_some(){if(hasRequiredEs_iterator_some)return es_iterator_some;hasRequiredEs_iterator_some=1;var Y=require_export(),K=requireFunctionCall(),ee=requireIterate(),ne=requireACallable(),re=requireAnObject(),le=requireGetIteratorDirect(),Q=requireIteratorClose(),R=requireIteratorHelperWithoutClosingOnEarlyError(),U=R("some",TypeError);return Y({target:"Iterator",proto:!0,real:!0,forced:U},{some:function(ae){re(this);try{ne(ae)}catch(me){Q(this,"throw",me)}if(U)return K(U,this,ae);var he=le(this),pe=0;return ee(he,function(me,ve){if(ae(me,pe++))return ve()},{IS_RECORD:!0,INTERRUPTED:!0}).stopped}}),es_iterator_some}var es_iterator_take={},hasRequiredEs_iterator_take;function requireEs_iterator_take(){if(hasRequiredEs_iterator_take)return es_iterator_take;hasRequiredEs_iterator_take=1;var Y=require_export(),K=requireFunctionCall(),ee=requireAnObject(),ne=requireGetIteratorDirect(),re=requireNotANan(),le=requireToPositiveInteger(),Q=requireIteratorCreateProxy(),R=requireIteratorClose(),U=requireIteratorHelperWithoutClosingOnEarlyError(),Z=requireIsPure(),ae=!Z&&U("take",RangeError),he=Q(function(){var pe=this.iterator;if(!this.remaining--)return this.done=!0,R(pe,"normal",void 0);var me=ee(K(this.next,pe)),ve=this.done=!!me.done;if(!ve)return me.value});return Y({target:"Iterator",proto:!0,real:!0,forced:Z||ae},{take:function(me){ee(this);var ve;try{ve=le(re(+me))}catch(Re){R(this,"throw",Re)}return ae?K(ae,this,ve):new he(ne(this),{remaining:ve})}}),es_iterator_take}var es_iterator_toArray={},hasRequiredEs_iterator_toArray;function requireEs_iterator_toArray(){if(hasRequiredEs_iterator_toArray)return es_iterator_toArray;hasRequiredEs_iterator_toArray=1;var Y=require_export(),K=requireAnObject(),ee=requireIterate(),ne=requireGetIteratorDirect(),re=[].push;return Y({target:"Iterator",proto:!0,real:!0},{toArray:function(){var Q=[];return ee(ne(K(this)),re,{that:Q,IS_RECORD:!0}),Q}}),es_iterator_toArray}var es_json_toStringTag={},hasRequiredEs_json_toStringTag;function requireEs_json_toStringTag(){if(hasRequiredEs_json_toStringTag)return es_json_toStringTag;hasRequiredEs_json_toStringTag=1;var Y=requireGlobalThis(),K=requireSetToStringTag();return K(Y.JSON,"JSON",!0),es_json_toStringTag}var es_map={},es_map_constructor={},internalMetadata={exports:{}},arrayBufferNonExtensible,hasRequiredArrayBufferNonExtensible;function requireArrayBufferNonExtensible(){if(hasRequiredArrayBufferNonExtensible)return arrayBufferNonExtensible;hasRequiredArrayBufferNonExtensible=1;var Y=requireFails();return arrayBufferNonExtensible=Y(function(){if(typeof ArrayBuffer=="function"){var K=new ArrayBuffer(8);Object.isExtensible(K)&&Object.defineProperty(K,"a",{value:8})}}),arrayBufferNonExtensible}var objectIsExtensible,hasRequiredObjectIsExtensible;function requireObjectIsExtensible(){if(hasRequiredObjectIsExtensible)return objectIsExtensible;hasRequiredObjectIsExtensible=1;var Y=requireFails(),K=requireIsObject$1(),ee=requireClassofRaw(),ne=requireArrayBufferNonExtensible(),re=Object.isExtensible,le=Y(function(){});return objectIsExtensible=le||ne?function(R){return!K(R)||ne&&ee(R)==="ArrayBuffer"?!1:re?re(R):!0}:re,objectIsExtensible}var freezing,hasRequiredFreezing;function requireFreezing(){if(hasRequiredFreezing)return freezing;hasRequiredFreezing=1;var Y=requireFails();return freezing=!Y(function(){return Object.isExtensible(Object.preventExtensions({}))}),freezing}var hasRequiredInternalMetadata;function requireInternalMetadata(){if(hasRequiredInternalMetadata)return internalMetadata.exports;hasRequiredInternalMetadata=1;var Y=require_export(),K=requireFunctionUncurryThis(),ee=requireHiddenKeys(),ne=requireIsObject$1(),re=requireHasOwnProperty(),le=requireObjectDefineProperty().f,Q=requireObjectGetOwnPropertyNames(),R=requireObjectGetOwnPropertyNamesExternal(),U=requireObjectIsExtensible(),Z=requireUid(),ae=requireFreezing(),he=!1,pe=Z("meta"),me=0,ve=function(Fe){le(Fe,pe,{value:{objectID:"O"+me++,weakData:{}}})},Re=function(Fe,ke){if(!ne(Fe))return typeof Fe=="symbol"?Fe:(typeof Fe=="string"?"S":"P")+Fe;if(!re(Fe,pe)){if(!U(Fe))return"F";if(!ke)return"E";ve(Fe)}return Fe[pe].objectID},Me=function(Fe,ke){if(!re(Fe,pe)){if(!U(Fe))return!0;if(!ke)return!1;ve(Fe)}return Fe[pe].weakData},Te=function(Fe){return ae&&he&&U(Fe)&&!re(Fe,pe)&&ve(Fe),Fe},Ce=function(){We.enable=function(){},he=!0;var Fe=Q.f,ke=K([].splice),Ze={};Ze[pe]=1,Fe(Ze).length&&(Q.f=function(Je){for(var Qe=Fe(Je),it=0,lt=Qe.length;it<lt;it++)if(Qe[it]===pe){ke(Qe,it,1);break}return Qe},Y({target:"Object",stat:!0,forced:!0},{getOwnPropertyNames:R.f}))},We=internalMetadata.exports={enable:Ce,fastKey:Re,getWeakData:Me,onFreeze:Te};return ee[pe]=!0,internalMetadata.exports}var collection,hasRequiredCollection;function requireCollection(){if(hasRequiredCollection)return collection;hasRequiredCollection=1;var Y=require_export(),K=requireGlobalThis(),ee=requireFunctionUncurryThis(),ne=requireIsForced(),re=requireDefineBuiltIn(),le=requireInternalMetadata(),Q=requireIterate(),R=requireAnInstance(),U=requireIsCallable(),Z=requireIsNullOrUndefined(),ae=requireIsObject$1(),he=requireFails(),pe=requireCheckCorrectnessOfIteration(),me=requireSetToStringTag(),ve=requireInheritIfRequired();return collection=function(Re,Me,Te){var Ce=Re.indexOf("Map")!==-1,We=Re.indexOf("Weak")!==-1,Fe=Ce?"set":"add",ke=K[Re],Ze=ke&&ke.prototype,Je=ke,Qe={},it=function(Gt){var ft=ee(Ze[Gt]);re(Ze,Gt,Gt==="add"?function(pt){return ft(this,pt===0?0:pt),this}:Gt==="delete"?function(Rt){return We&&!ae(Rt)?!1:ft(this,Rt===0?0:Rt)}:Gt==="get"?function(pt){return We&&!ae(pt)?void 0:ft(this,pt===0?0:pt)}:Gt==="has"?function(pt){return We&&!ae(pt)?!1:ft(this,pt===0?0:pt)}:function(pt,At){return ft(this,pt===0?0:pt,At),this})},lt=ne(Re,!U(ke)||!(We||Ze.forEach&&!he(function(){new ke().entries().next()})));if(lt)Je=Te.getConstructor(Me,Re,Ce,Fe),le.enable();else if(ne(Re,!0)){var dt=new Je,yt=dt[Fe](We?{}:-0,1)!==dt,gt=he(function(){dt.has(1)}),qt=pe(function(Gt){new ke(Gt)}),Ft=!We&&he(function(){for(var Gt=new ke,ft=5;ft--;)Gt[Fe](ft,ft);return!Gt.has(-0)});qt||(Je=Me(function(Gt,ft){R(Gt,Ze);var Rt=ve(new ke,Gt,Je);return Z(ft)||Q(ft,Rt[Fe],{that:Rt,AS_ENTRIES:Ce}),Rt}),Je.prototype=Ze,Ze.constructor=Je),(gt||Ft)&&(it("delete"),it("has"),Ce&&it("get")),(Ft||yt)&&it(Fe),We&&Ze.clear&&delete Ze.clear}return Qe[Re]=Je,Y({global:!0,constructor:!0,forced:Je!==ke},Qe),me(Je,Re),We||Te.setStrong(Je,Re,Ce),Je},collection}var collectionStrong,hasRequiredCollectionStrong;function requireCollectionStrong(){if(hasRequiredCollectionStrong)return collectionStrong;hasRequiredCollectionStrong=1;var Y=requireObjectCreate(),K=requireDefineBuiltInAccessor(),ee=requireDefineBuiltIns(),ne=requireFunctionBindContext(),re=requireAnInstance(),le=requireIsNullOrUndefined(),Q=requireIterate(),R=requireIteratorDefine(),U=requireCreateIterResultObject(),Z=requireSetSpecies(),ae=requireDescriptors(),he=requireInternalMetadata().fastKey,pe=requireInternalState(),me=pe.set,ve=pe.getterFor;return collectionStrong={getConstructor:function(Re,Me,Te,Ce){var We=Re(function(Qe,it){re(Qe,Fe),me(Qe,{type:Me,index:Y(null),first:null,last:null,size:0}),ae||(Qe.size=0),le(it)||Q(it,Qe[Ce],{that:Qe,AS_ENTRIES:Te})}),Fe=We.prototype,ke=ve(Me),Ze=function(Qe,it,lt){var dt=ke(Qe),yt=Je(Qe,it),gt,qt;return yt?yt.value=lt:(dt.last=yt={index:qt=he(it,!0),key:it,value:lt,previous:gt=dt.last,next:null,removed:!1},dt.first||(dt.first=yt),gt&&(gt.next=yt),ae?dt.size++:Qe.size++,qt!=="F"&&(dt.index[qt]=yt)),Qe},Je=function(Qe,it){var lt=ke(Qe),dt=he(it),yt;if(dt!=="F")return lt.index[dt];for(yt=lt.first;yt;yt=yt.next)if(yt.key===it)return yt};return ee(Fe,{clear:function(){for(var it=this,lt=ke(it),dt=lt.first;dt;)dt.removed=!0,dt.previous&&(dt.previous=dt.previous.next=null),dt=dt.next;lt.first=lt.last=null,lt.index=Y(null),ae?lt.size=0:it.size=0},delete:function(Qe){var it=this,lt=ke(it),dt=Je(it,Qe);if(dt){var yt=dt.next,gt=dt.previous;delete lt.index[dt.index],dt.removed=!0,gt&&(gt.next=yt),yt&&(yt.previous=gt),lt.first===dt&&(lt.first=yt),lt.last===dt&&(lt.last=gt),ae?lt.size--:it.size--}return!!dt},forEach:function(it){for(var lt=ke(this),dt=ne(it,arguments.length>1?arguments[1]:void 0),yt;yt=yt?yt.next:lt.first;)for(dt(yt.value,yt.key,this);yt&&yt.removed;)yt=yt.previous},has:function(it){return!!Je(this,it)}}),ee(Fe,Te?{get:function(it){var lt=Je(this,it);return lt&&lt.value},set:function(it,lt){return Ze(this,it===0?0:it,lt)}}:{add:function(it){return Ze(this,it=it===0?0:it,it)}}),ae&&K(Fe,"size",{configurable:!0,get:function(){return ke(this).size}}),We},setStrong:function(Re,Me,Te){var Ce=Me+" Iterator",We=ve(Me),Fe=ve(Ce);R(Re,Me,function(ke,Ze){me(this,{type:Ce,target:ke,state:We(ke),kind:Ze,last:null})},function(){for(var ke=Fe(this),Ze=ke.kind,Je=ke.last;Je&&Je.removed;)Je=Je.previous;return!ke.target||!(ke.last=Je=Je?Je.next:ke.state.first)?(ke.target=null,U(void 0,!0)):U(Ze==="keys"?Je.key:Ze==="values"?Je.value:[Je.key,Je.value],!1)},Te?"entries":"values",!Te,!0),Z(Me)}},collectionStrong}var hasRequiredEs_map_constructor;function requireEs_map_constructor(){if(hasRequiredEs_map_constructor)return es_map_constructor;hasRequiredEs_map_constructor=1;var Y=requireCollection(),K=requireCollectionStrong();return Y("Map",function(ee){return function(){return ee(this,arguments.length?arguments[0]:void 0)}},K),es_map_constructor}var hasRequiredEs_map;function requireEs_map(){return hasRequiredEs_map||(hasRequiredEs_map=1,requireEs_map_constructor()),es_map}var es_map_groupBy={},mapHelpers,hasRequiredMapHelpers;function requireMapHelpers(){if(hasRequiredMapHelpers)return mapHelpers;hasRequiredMapHelpers=1;var Y=requireFunctionUncurryThis(),K=Map.prototype;return mapHelpers={Map,set:Y(K.set),get:Y(K.get),has:Y(K.has),remove:Y(K.delete),proto:K},mapHelpers}var hasRequiredEs_map_groupBy;function requireEs_map_groupBy(){if(hasRequiredEs_map_groupBy)return es_map_groupBy;hasRequiredEs_map_groupBy=1;var Y=require_export(),K=requireFunctionUncurryThis(),ee=requireACallable(),ne=requireRequireObjectCoercible(),re=requireIterate(),le=requireMapHelpers(),Q=requireIsPure(),R=requireFails(),U=le.Map,Z=le.has,ae=le.get,he=le.set,pe=K([].push),me=Q||R(function(){return U.groupBy("ab",function(ve){return ve}).get("a").length!==1});return Y({target:"Map",stat:!0,forced:Q||me},{groupBy:function(Re,Me){ne(Re),ee(Me);var Te=new U,Ce=0;return re(Re,function(We){var Fe=Me(We,Ce++);Z(Te,Fe)?pe(ae(Te,Fe),We):he(Te,Fe,[We])}),Te}}),es_map_groupBy}var es_math_acosh={},mathLog1p,hasRequiredMathLog1p;function requireMathLog1p(){if(hasRequiredMathLog1p)return mathLog1p;hasRequiredMathLog1p=1;var Y=Math.log;return mathLog1p=Math.log1p||function(ee){var ne=+ee;return ne>-1e-8&&ne<1e-8?ne-ne*ne/2:Y(1+ne)},mathLog1p}var hasRequiredEs_math_acosh;function requireEs_math_acosh(){if(hasRequiredEs_math_acosh)return es_math_acosh;hasRequiredEs_math_acosh=1;var Y=require_export(),K=requireMathLog1p(),ee=Math.acosh,ne=Math.log,re=Math.sqrt,le=Math.LN2,Q=!ee||Math.floor(ee(Number.MAX_VALUE))!==710||ee(1/0)!==1/0;return Y({target:"Math",stat:!0,forced:Q},{acosh:function(U){var Z=+U;return Z<1?NaN:Z>9490626562425156e-8?ne(Z)+le:K(Z-1+re(Z-1)*re(Z+1))}}),es_math_acosh}var es_math_asinh={},hasRequiredEs_math_asinh;function requireEs_math_asinh(){if(hasRequiredEs_math_asinh)return es_math_asinh;hasRequiredEs_math_asinh=1;var Y=require_export(),K=Math.asinh,ee=Math.log,ne=Math.sqrt;function re(Q){var R=+Q;return!isFinite(R)||R===0?R:R<0?-re(-R):ee(R+ne(R*R+1))}var le=!(K&&1/K(0)>0);return Y({target:"Math",stat:!0,forced:le},{asinh:re}),es_math_asinh}var es_math_atanh={},hasRequiredEs_math_atanh;function requireEs_math_atanh(){if(hasRequiredEs_math_atanh)return es_math_atanh;hasRequiredEs_math_atanh=1;var Y=require_export(),K=Math.atanh,ee=Math.log,ne=!(K&&1/K(-0)<0);return Y({target:"Math",stat:!0,forced:ne},{atanh:function(le){var Q=+le;return Q===0?Q:ee((1+Q)/(1-Q))/2}}),es_math_atanh}var es_math_cbrt={},hasRequiredEs_math_cbrt;function requireEs_math_cbrt(){if(hasRequiredEs_math_cbrt)return es_math_cbrt;hasRequiredEs_math_cbrt=1;var Y=require_export(),K=requireMathSign(),ee=Math.abs,ne=Math.pow;return Y({target:"Math",stat:!0},{cbrt:function(le){var Q=+le;return K(Q)*ne(ee(Q),1/3)}}),es_math_cbrt}var es_math_clz32={},hasRequiredEs_math_clz32;function requireEs_math_clz32(){if(hasRequiredEs_math_clz32)return es_math_clz32;hasRequiredEs_math_clz32=1;var Y=require_export(),K=Math.floor,ee=Math.log,ne=Math.LOG2E;return Y({target:"Math",stat:!0},{clz32:function(le){var Q=le>>>0;return Q?31-K(ee(Q+.5)*ne):32}}),es_math_clz32}var es_math_cosh={},mathExpm1,hasRequiredMathExpm1;function requireMathExpm1(){if(hasRequiredMathExpm1)return mathExpm1;hasRequiredMathExpm1=1;var Y=Math.expm1,K=Math.exp;return mathExpm1=!Y||Y(10)>22025.465794806718||Y(10)<22025.465794806718||Y(-2e-17)!==-2e-17?function(ne){var re=+ne;return re===0?re:re>-1e-6&&re<1e-6?re+re*re/2:K(re)-1}:Y,mathExpm1}var hasRequiredEs_math_cosh;function requireEs_math_cosh(){if(hasRequiredEs_math_cosh)return es_math_cosh;hasRequiredEs_math_cosh=1;var Y=require_export(),K=requireMathExpm1(),ee=Math.cosh,ne=Math.abs,re=Math.E,le=!ee||ee(710)===1/0;return Y({target:"Math",stat:!0,forced:le},{cosh:function(R){var U=K(ne(R)-1)+1;return(U+1/(U*re*re))*(re/2)}}),es_math_cosh}var es_math_expm1={},hasRequiredEs_math_expm1;function requireEs_math_expm1(){if(hasRequiredEs_math_expm1)return es_math_expm1;hasRequiredEs_math_expm1=1;var Y=require_export(),K=requireMathExpm1();return Y({target:"Math",stat:!0,forced:K!==Math.expm1},{expm1:K}),es_math_expm1}var es_math_fround={},hasRequiredEs_math_fround;function requireEs_math_fround(){if(hasRequiredEs_math_fround)return es_math_fround;hasRequiredEs_math_fround=1;var Y=require_export(),K=requireMathFround();return Y({target:"Math",stat:!0},{fround:K}),es_math_fround}var es_math_f16round={},hasRequiredEs_math_f16round;function requireEs_math_f16round(){if(hasRequiredEs_math_f16round)return es_math_f16round;hasRequiredEs_math_f16round=1;var Y=require_export(),K=requireMathFloatRound(),ee=.0009765625,ne=65504,re=6103515625e-14;return Y({target:"Math",stat:!0},{f16round:function(Q){return K(Q,ee,ne,re)}}),es_math_f16round}var es_math_hypot={},hasRequiredEs_math_hypot;function requireEs_math_hypot(){if(hasRequiredEs_math_hypot)return es_math_hypot;hasRequiredEs_math_hypot=1;var Y=require_export(),K=Math.hypot,ee=Math.abs,ne=Math.sqrt,re=!!K&&K(1/0,NaN)!==1/0;return Y({target:"Math",stat:!0,arity:2,forced:re},{hypot:function(Q,R){for(var U=0,Z=0,ae=arguments.length,he=0,pe,me;Z<ae;)pe=ee(arguments[Z++]),he<pe?(me=he/pe,U=U*me*me+1,he=pe):pe>0?(me=pe/he,U+=me*me):U+=pe;return he===1/0?1/0:he*ne(U)}}),es_math_hypot}var es_math_imul={},hasRequiredEs_math_imul;function requireEs_math_imul(){if(hasRequiredEs_math_imul)return es_math_imul;hasRequiredEs_math_imul=1;var Y=require_export(),K=requireFails(),ee=Math.imul,ne=K(function(){return ee(4294967295,5)!==-5||ee.length!==2});return Y({target:"Math",stat:!0,forced:ne},{imul:function(le,Q){var R=65535,U=+le,Z=+Q,ae=R&U,he=R&Z;return 0|ae*he+((R&U>>>16)*he+ae*(R&Z>>>16)<<16>>>0)}}),es_math_imul}var es_math_log10={},mathLog10,hasRequiredMathLog10;function requireMathLog10(){if(hasRequiredMathLog10)return mathLog10;hasRequiredMathLog10=1;var Y=Math.log,K=Math.LOG10E;return mathLog10=Math.log10||function(ne){return Y(ne)*K},mathLog10}var hasRequiredEs_math_log10;function requireEs_math_log10(){if(hasRequiredEs_math_log10)return es_math_log10;hasRequiredEs_math_log10=1;var Y=require_export(),K=requireMathLog10();return Y({target:"Math",stat:!0},{log10:K}),es_math_log10}var es_math_log1p={},hasRequiredEs_math_log1p;function requireEs_math_log1p(){if(hasRequiredEs_math_log1p)return es_math_log1p;hasRequiredEs_math_log1p=1;var Y=require_export(),K=requireMathLog1p();return Y({target:"Math",stat:!0},{log1p:K}),es_math_log1p}var es_math_log2={},hasRequiredEs_math_log2;function requireEs_math_log2(){if(hasRequiredEs_math_log2)return es_math_log2;hasRequiredEs_math_log2=1;var Y=require_export(),K=requireMathLog2();return Y({target:"Math",stat:!0},{log2:K}),es_math_log2}var es_math_sign={},hasRequiredEs_math_sign;function requireEs_math_sign(){if(hasRequiredEs_math_sign)return es_math_sign;hasRequiredEs_math_sign=1;var Y=require_export(),K=requireMathSign();return Y({target:"Math",stat:!0},{sign:K}),es_math_sign}var es_math_sinh={},hasRequiredEs_math_sinh;function requireEs_math_sinh(){if(hasRequiredEs_math_sinh)return es_math_sinh;hasRequiredEs_math_sinh=1;var Y=require_export(),K=requireFails(),ee=requireMathExpm1(),ne=Math.abs,re=Math.exp,le=Math.E,Q=K(function(){return Math.sinh(-2e-17)!==-2e-17});return Y({target:"Math",stat:!0,forced:Q},{sinh:function(U){var Z=+U;return ne(Z)<1?(ee(Z)-ee(-Z))/2:(re(Z-1)-re(-Z-1))*(le/2)}}),es_math_sinh}var es_math_tanh={},hasRequiredEs_math_tanh;function requireEs_math_tanh(){if(hasRequiredEs_math_tanh)return es_math_tanh;hasRequiredEs_math_tanh=1;var Y=require_export(),K=requireMathExpm1(),ee=Math.exp;return Y({target:"Math",stat:!0},{tanh:function(re){var le=+re,Q=K(le),R=K(-le);return Q===1/0?1:R===1/0?-1:(Q-R)/(ee(le)+ee(-le))}}),es_math_tanh}var es_math_toStringTag={},hasRequiredEs_math_toStringTag;function requireEs_math_toStringTag(){if(hasRequiredEs_math_toStringTag)return es_math_toStringTag;hasRequiredEs_math_toStringTag=1;var Y=requireSetToStringTag();return Y(Math,"Math",!0),es_math_toStringTag}var es_math_trunc={},hasRequiredEs_math_trunc;function requireEs_math_trunc(){if(hasRequiredEs_math_trunc)return es_math_trunc;hasRequiredEs_math_trunc=1;var Y=require_export(),K=requireMathTrunc();return Y({target:"Math",stat:!0},{trunc:K}),es_math_trunc}var es_number_constructor={},thisNumberValue,hasRequiredThisNumberValue;function requireThisNumberValue(){if(hasRequiredThisNumberValue)return thisNumberValue;hasRequiredThisNumberValue=1;var Y=requireFunctionUncurryThis();return thisNumberValue=Y(1.1.valueOf),thisNumberValue}var whitespaces,hasRequiredWhitespaces;function requireWhitespaces(){return hasRequiredWhitespaces||(hasRequiredWhitespaces=1,whitespaces=`	
\v\f\r                　\u2028\u2029\uFEFF`),whitespaces}var stringTrim,hasRequiredStringTrim;function requireStringTrim(){if(hasRequiredStringTrim)return stringTrim;hasRequiredStringTrim=1;var Y=requireFunctionUncurryThis(),K=requireRequireObjectCoercible(),ee=requireToString$1(),ne=requireWhitespaces(),re=Y("".replace),le=RegExp("^["+ne+"]+"),Q=RegExp("(^|[^"+ne+"])["+ne+"]+$"),R=function(U){return function(Z){var ae=ee(K(Z));return U&1&&(ae=re(ae,le,"")),U&2&&(ae=re(ae,Q,"$1")),ae}};return stringTrim={start:R(1),end:R(2),trim:R(3)},stringTrim}var hasRequiredEs_number_constructor;function requireEs_number_constructor(){if(hasRequiredEs_number_constructor)return es_number_constructor;hasRequiredEs_number_constructor=1;var Y=require_export(),K=requireIsPure(),ee=requireDescriptors(),ne=requireGlobalThis(),re=requirePath(),le=requireFunctionUncurryThis(),Q=requireIsForced(),R=requireHasOwnProperty(),U=requireInheritIfRequired(),Z=requireObjectIsPrototypeOf(),ae=requireIsSymbol$1(),he=requireToPrimitive(),pe=requireFails(),me=requireObjectGetOwnPropertyNames().f,ve=requireObjectGetOwnPropertyDescriptor().f,Re=requireObjectDefineProperty().f,Me=requireThisNumberValue(),Te=requireStringTrim().trim,Ce="Number",We=ne[Ce],Fe=re[Ce],ke=We.prototype,Ze=ne.TypeError,Je=le("".slice),Qe=le("".charCodeAt),it=function(Ft){var Gt=he(Ft,"number");return typeof Gt=="bigint"?Gt:lt(Gt)},lt=function(Ft){var Gt=he(Ft,"number"),ft,Rt,pt,At,It,Dt,Zt,nr;if(ae(Gt))throw new Ze("Cannot convert a Symbol value to a number");if(typeof Gt=="string"&&Gt.length>2){if(Gt=Te(Gt),ft=Qe(Gt,0),ft===43||ft===45){if(Rt=Qe(Gt,2),Rt===88||Rt===120)return NaN}else if(ft===48){switch(Qe(Gt,1)){case 66:case 98:pt=2,At=49;break;case 79:case 111:pt=8,At=55;break;default:return+Gt}for(It=Je(Gt,2),Dt=It.length,Zt=0;Zt<Dt;Zt++)if(nr=Qe(It,Zt),nr<48||nr>At)return NaN;return parseInt(It,pt)}}return+Gt},dt=Q(Ce,!We(" 0o1")||!We("0b1")||We("+0x1")),yt=function(Ft){return Z(ke,Ft)&&pe(function(){Me(Ft)})},gt=function(Gt){var ft=arguments.length<1?0:We(it(Gt));return yt(this)?U(Object(ft),this,gt):ft};gt.prototype=ke,dt&&!K&&(ke.constructor=gt),Y({global:!0,constructor:!0,wrap:!0,forced:dt},{Number:gt});var qt=function(Ft,Gt){for(var ft=ee?me(Gt):"MAX_VALUE,MIN_VALUE,NaN,NEGATIVE_INFINITY,POSITIVE_INFINITY,EPSILON,MAX_SAFE_INTEGER,MIN_SAFE_INTEGER,isFinite,isInteger,isNaN,isSafeInteger,parseFloat,parseInt,fromString,range".split(","),Rt=0,pt;ft.length>Rt;Rt++)R(Gt,pt=ft[Rt])&&!R(Ft,pt)&&Re(Ft,pt,ve(Gt,pt))};return K&&Fe&&qt(re[Ce],Fe),(dt||K)&&qt(re[Ce],We),es_number_constructor}var es_number_epsilon={},hasRequiredEs_number_epsilon;function requireEs_number_epsilon(){if(hasRequiredEs_number_epsilon)return es_number_epsilon;hasRequiredEs_number_epsilon=1;var Y=require_export();return Y({target:"Number",stat:!0,nonConfigurable:!0,nonWritable:!0},{EPSILON:Math.pow(2,-52)}),es_number_epsilon}var es_number_isFinite={},numberIsFinite,hasRequiredNumberIsFinite;function requireNumberIsFinite(){if(hasRequiredNumberIsFinite)return numberIsFinite;hasRequiredNumberIsFinite=1;var Y=requireGlobalThis(),K=Y.isFinite;return numberIsFinite=Number.isFinite||function(ne){return typeof ne=="number"&&K(ne)},numberIsFinite}var hasRequiredEs_number_isFinite;function requireEs_number_isFinite(){if(hasRequiredEs_number_isFinite)return es_number_isFinite;hasRequiredEs_number_isFinite=1;var Y=require_export(),K=requireNumberIsFinite();return Y({target:"Number",stat:!0},{isFinite:K}),es_number_isFinite}var es_number_isInteger={},isIntegralNumber,hasRequiredIsIntegralNumber;function requireIsIntegralNumber(){if(hasRequiredIsIntegralNumber)return isIntegralNumber;hasRequiredIsIntegralNumber=1;var Y=requireIsObject$1(),K=Math.floor;return isIntegralNumber=Number.isInteger||function(ne){return!Y(ne)&&isFinite(ne)&&K(ne)===ne},isIntegralNumber}var hasRequiredEs_number_isInteger;function requireEs_number_isInteger(){if(hasRequiredEs_number_isInteger)return es_number_isInteger;hasRequiredEs_number_isInteger=1;var Y=require_export(),K=requireIsIntegralNumber();return Y({target:"Number",stat:!0},{isInteger:K}),es_number_isInteger}var es_number_isNan={},hasRequiredEs_number_isNan;function requireEs_number_isNan(){if(hasRequiredEs_number_isNan)return es_number_isNan;hasRequiredEs_number_isNan=1;var Y=require_export();return Y({target:"Number",stat:!0},{isNaN:function(ee){return ee!==ee}}),es_number_isNan}var es_number_isSafeInteger={},hasRequiredEs_number_isSafeInteger;function requireEs_number_isSafeInteger(){if(hasRequiredEs_number_isSafeInteger)return es_number_isSafeInteger;hasRequiredEs_number_isSafeInteger=1;var Y=require_export(),K=requireIsIntegralNumber(),ee=Math.abs;return Y({target:"Number",stat:!0},{isSafeInteger:function(re){return K(re)&&ee(re)<=9007199254740991}}),es_number_isSafeInteger}var es_number_maxSafeInteger={},hasRequiredEs_number_maxSafeInteger;function requireEs_number_maxSafeInteger(){if(hasRequiredEs_number_maxSafeInteger)return es_number_maxSafeInteger;hasRequiredEs_number_maxSafeInteger=1;var Y=require_export();return Y({target:"Number",stat:!0,nonConfigurable:!0,nonWritable:!0},{MAX_SAFE_INTEGER:9007199254740991}),es_number_maxSafeInteger}var es_number_minSafeInteger={},hasRequiredEs_number_minSafeInteger;function requireEs_number_minSafeInteger(){if(hasRequiredEs_number_minSafeInteger)return es_number_minSafeInteger;hasRequiredEs_number_minSafeInteger=1;var Y=require_export();return Y({target:"Number",stat:!0,nonConfigurable:!0,nonWritable:!0},{MIN_SAFE_INTEGER:-9007199254740991}),es_number_minSafeInteger}var es_number_parseFloat={},numberParseFloat,hasRequiredNumberParseFloat;function requireNumberParseFloat(){if(hasRequiredNumberParseFloat)return numberParseFloat;hasRequiredNumberParseFloat=1;var Y=requireGlobalThis(),K=requireFails(),ee=requireFunctionUncurryThis(),ne=requireToString$1(),re=requireStringTrim().trim,le=requireWhitespaces(),Q=ee("".charAt),R=Y.parseFloat,U=Y.Symbol,Z=U&&U.iterator,ae=1/R(le+"-0")!==-1/0||Z&&!K(function(){R(Object(Z))});return numberParseFloat=ae?function(pe){var me=re(ne(pe)),ve=R(me);return ve===0&&Q(me,0)==="-"?-0:ve}:R,numberParseFloat}var hasRequiredEs_number_parseFloat;function requireEs_number_parseFloat(){if(hasRequiredEs_number_parseFloat)return es_number_parseFloat;hasRequiredEs_number_parseFloat=1;var Y=require_export(),K=requireNumberParseFloat();return Y({target:"Number",stat:!0,forced:Number.parseFloat!==K},{parseFloat:K}),es_number_parseFloat}var es_number_parseInt={},numberParseInt,hasRequiredNumberParseInt;function requireNumberParseInt(){if(hasRequiredNumberParseInt)return numberParseInt;hasRequiredNumberParseInt=1;var Y=requireGlobalThis(),K=requireFails(),ee=requireFunctionUncurryThis(),ne=requireToString$1(),re=requireStringTrim().trim,le=requireWhitespaces(),Q=Y.parseInt,R=Y.Symbol,U=R&&R.iterator,Z=/^[+-]?0x/i,ae=ee(Z.exec),he=Q(le+"08")!==8||Q(le+"0x16")!==22||U&&!K(function(){Q(Object(U))});return numberParseInt=he?function(me,ve){var Re=re(ne(me));return Q(Re,ve>>>0||(ae(Z,Re)?16:10))}:Q,numberParseInt}var hasRequiredEs_number_parseInt;function requireEs_number_parseInt(){if(hasRequiredEs_number_parseInt)return es_number_parseInt;hasRequiredEs_number_parseInt=1;var Y=require_export(),K=requireNumberParseInt();return Y({target:"Number",stat:!0,forced:Number.parseInt!==K},{parseInt:K}),es_number_parseInt}var es_number_toExponential={},hasRequiredEs_number_toExponential;function requireEs_number_toExponential(){if(hasRequiredEs_number_toExponential)return es_number_toExponential;hasRequiredEs_number_toExponential=1;var Y=require_export(),K=requireFunctionUncurryThis(),ee=requireToIntegerOrInfinity(),ne=requireThisNumberValue(),re=requireStringRepeat(),le=requireMathLog10(),Q=requireFails(),R=RangeError,U=String,Z=isFinite,ae=Math.abs,he=Math.floor,pe=Math.pow,me=Math.round,ve=K(1.1.toExponential),Re=K(re),Me=K("".slice),Te=ve(-69e-12,4)==="-6.9000e-11"&&ve(1.255,2)==="1.25e+0"&&ve(12345,3)==="1.235e+4"&&ve(25,0)==="3e+1",Ce=function(){return Q(function(){ve(1,1/0)})&&Q(function(){ve(1,-1/0)})},We=function(){return!Q(function(){ve(1/0,1/0),ve(NaN,1/0)})},Fe=!Te||!Ce()||!We();return Y({target:"Number",proto:!0,forced:Fe},{toExponential:function(Ze){var Je=ne(this);if(Ze===void 0)return ve(Je);var Qe=ee(Ze);if(!Z(Je))return String(Je);if(Qe<0||Qe>20)throw new R("Incorrect fraction digits");if(Te)return ve(Je,Qe);var it="",lt,dt,yt,gt;if(Je<0&&(it="-",Je=-Je),Je===0)dt=0,lt=Re("0",Qe+1);else{var qt=le(Je);dt=he(qt);var Ft=pe(10,dt-Qe),Gt=me(Je/Ft);2*Je>=(2*Gt+1)*Ft&&(Gt+=1),Gt>=pe(10,Qe+1)&&(Gt/=10,dt+=1),lt=U(Gt)}return Qe!==0&&(lt=Me(lt,0,1)+"."+Me(lt,1)),dt===0?(yt="+",gt="0"):(yt=dt>0?"+":"-",gt=U(ae(dt))),lt+="e"+yt+gt,it+lt}}),es_number_toExponential}var es_number_toFixed={},hasRequiredEs_number_toFixed;function requireEs_number_toFixed(){if(hasRequiredEs_number_toFixed)return es_number_toFixed;hasRequiredEs_number_toFixed=1;var Y=require_export(),K=requireFunctionUncurryThis(),ee=requireToIntegerOrInfinity(),ne=requireThisNumberValue(),re=requireStringRepeat(),le=requireFails(),Q=RangeError,R=String,U=Math.floor,Z=K(re),ae=K("".slice),he=K(1.1.toFixed),pe=function(Ce,We,Fe){return We===0?Fe:We%2===1?pe(Ce,We-1,Fe*Ce):pe(Ce*Ce,We/2,Fe)},me=function(Ce){for(var We=0,Fe=Ce;Fe>=4096;)We+=12,Fe/=4096;for(;Fe>=2;)We+=1,Fe/=2;return We},ve=function(Ce,We,Fe){for(var ke=-1,Ze=Fe;++ke<6;)Ze+=We*Ce[ke],Ce[ke]=Ze%1e7,Ze=U(Ze/1e7)},Re=function(Ce,We){for(var Fe=6,ke=0;--Fe>=0;)ke+=Ce[Fe],Ce[Fe]=U(ke/We),ke=ke%We*1e7},Me=function(Ce){for(var We=6,Fe="";--We>=0;)if(Fe!==""||We===0||Ce[We]!==0){var ke=R(Ce[We]);Fe=Fe===""?ke:Fe+Z("0",7-ke.length)+ke}return Fe},Te=le(function(){return he(8e-5,3)!=="0.000"||he(.9,0)!=="1"||he(1.255,2)!=="1.25"||he(0xde0b6b3a7640080,0)!=="1000000000000000128"})||!le(function(){he({})});return Y({target:"Number",proto:!0,forced:Te},{toFixed:function(We){var Fe=ne(this),ke=ee(We),Ze=[0,0,0,0,0,0],Je="",Qe="0",it,lt,dt,yt;if(ke<0||ke>20)throw new Q("Incorrect fraction digits");if(Fe!==Fe)return"NaN";if(Fe<=-1e21||Fe>=1e21)return R(Fe);if(Fe<0&&(Je="-",Fe=-Fe),Fe>1e-21)if(it=me(Fe*pe(2,69,1))-69,lt=it<0?Fe*pe(2,-it,1):Fe/pe(2,it,1),lt*=4503599627370496,it=52-it,it>0){for(ve(Ze,0,lt),dt=ke;dt>=7;)ve(Ze,1e7,0),dt-=7;for(ve(Ze,pe(10,dt,1),0),dt=it-1;dt>=23;)Re(Ze,1<<23),dt-=23;Re(Ze,1<<dt),ve(Ze,1,1),Re(Ze,2),Qe=Me(Ze)}else ve(Ze,0,lt),ve(Ze,1<<-it,0),Qe=Me(Ze)+Z("0",ke);return ke>0?(yt=Qe.length,Qe=Je+(yt<=ke?"0."+Z("0",ke-yt)+Qe:ae(Qe,0,yt-ke)+"."+ae(Qe,yt-ke))):Qe=Je+Qe,Qe}}),es_number_toFixed}var es_number_toPrecision={},hasRequiredEs_number_toPrecision;function requireEs_number_toPrecision(){if(hasRequiredEs_number_toPrecision)return es_number_toPrecision;hasRequiredEs_number_toPrecision=1;var Y=require_export(),K=requireFunctionUncurryThis(),ee=requireFails(),ne=requireThisNumberValue(),re=K(1.1.toPrecision),le=ee(function(){return re(1,void 0)!=="1"})||!ee(function(){re({})});return Y({target:"Number",proto:!0,forced:le},{toPrecision:function(R){return R===void 0?re(ne(this)):re(ne(this),R)}}),es_number_toPrecision}var es_object_assign={},objectAssign,hasRequiredObjectAssign;function requireObjectAssign(){if(hasRequiredObjectAssign)return objectAssign;hasRequiredObjectAssign=1;var Y=requireDescriptors(),K=requireFunctionUncurryThis(),ee=requireFunctionCall(),ne=requireFails(),re=requireObjectKeys(),le=requireObjectGetOwnPropertySymbols(),Q=requireObjectPropertyIsEnumerable(),R=requireToObject(),U=requireIndexedObject(),Z=Object.assign,ae=Object.defineProperty,he=K([].concat);return objectAssign=!Z||ne(function(){if(Y&&Z({b:1},Z(ae({},"a",{enumerable:!0,get:function(){ae(this,"b",{value:3,enumerable:!1})}}),{b:2})).b!==1)return!0;var pe={},me={},ve=Symbol("assign detection"),Re="abcdefghijklmnopqrst";return pe[ve]=7,Re.split("").forEach(function(Me){me[Me]=Me}),Z({},pe)[ve]!==7||re(Z({},me)).join("")!==Re})?function(me,ve){for(var Re=R(me),Me=arguments.length,Te=1,Ce=le.f,We=Q.f;Me>Te;)for(var Fe=U(arguments[Te++]),ke=Ce?he(re(Fe),Ce(Fe)):re(Fe),Ze=ke.length,Je=0,Qe;Ze>Je;)Qe=ke[Je++],(!Y||ee(We,Fe,Qe))&&(Re[Qe]=Fe[Qe]);return Re}:Z,objectAssign}var hasRequiredEs_object_assign;function requireEs_object_assign(){if(hasRequiredEs_object_assign)return es_object_assign;hasRequiredEs_object_assign=1;var Y=require_export(),K=requireObjectAssign();return Y({target:"Object",stat:!0,arity:2,forced:Object.assign!==K},{assign:K}),es_object_assign}var es_object_create={},hasRequiredEs_object_create;function requireEs_object_create(){if(hasRequiredEs_object_create)return es_object_create;hasRequiredEs_object_create=1;var Y=require_export(),K=requireDescriptors(),ee=requireObjectCreate();return Y({target:"Object",stat:!0,sham:!K},{create:ee}),es_object_create}var es_object_defineGetter={},objectPrototypeAccessorsForced,hasRequiredObjectPrototypeAccessorsForced;function requireObjectPrototypeAccessorsForced(){if(hasRequiredObjectPrototypeAccessorsForced)return objectPrototypeAccessorsForced;hasRequiredObjectPrototypeAccessorsForced=1;var Y=requireIsPure(),K=requireGlobalThis(),ee=requireFails(),ne=requireEnvironmentWebkitVersion();return objectPrototypeAccessorsForced=Y||!ee(function(){if(!(ne&&ne<535)){var re=Math.random();__defineSetter__.call(null,re,function(){}),delete K[re]}}),objectPrototypeAccessorsForced}var hasRequiredEs_object_defineGetter;function requireEs_object_defineGetter(){if(hasRequiredEs_object_defineGetter)return es_object_defineGetter;hasRequiredEs_object_defineGetter=1;var Y=require_export(),K=requireDescriptors(),ee=requireObjectPrototypeAccessorsForced(),ne=requireACallable(),re=requireToObject(),le=requireObjectDefineProperty();return K&&Y({target:"Object",proto:!0,forced:ee},{__defineGetter__:function(R,U){le.f(re(this),R,{get:ne(U),enumerable:!0,configurable:!0})}}),es_object_defineGetter}var es_object_defineProperties={},hasRequiredEs_object_defineProperties;function requireEs_object_defineProperties(){if(hasRequiredEs_object_defineProperties)return es_object_defineProperties;hasRequiredEs_object_defineProperties=1;var Y=require_export(),K=requireDescriptors(),ee=requireObjectDefineProperties().f;return Y({target:"Object",stat:!0,forced:Object.defineProperties!==ee,sham:!K},{defineProperties:ee}),es_object_defineProperties}var es_object_defineProperty={},hasRequiredEs_object_defineProperty;function requireEs_object_defineProperty(){if(hasRequiredEs_object_defineProperty)return es_object_defineProperty;hasRequiredEs_object_defineProperty=1;var Y=require_export(),K=requireDescriptors(),ee=requireObjectDefineProperty().f;return Y({target:"Object",stat:!0,forced:Object.defineProperty!==ee,sham:!K},{defineProperty:ee}),es_object_defineProperty}var es_object_defineSetter={},hasRequiredEs_object_defineSetter;function requireEs_object_defineSetter(){if(hasRequiredEs_object_defineSetter)return es_object_defineSetter;hasRequiredEs_object_defineSetter=1;var Y=require_export(),K=requireDescriptors(),ee=requireObjectPrototypeAccessorsForced(),ne=requireACallable(),re=requireToObject(),le=requireObjectDefineProperty();return K&&Y({target:"Object",proto:!0,forced:ee},{__defineSetter__:function(R,U){le.f(re(this),R,{set:ne(U),enumerable:!0,configurable:!0})}}),es_object_defineSetter}var es_object_entries={},objectToArray,hasRequiredObjectToArray;function requireObjectToArray(){if(hasRequiredObjectToArray)return objectToArray;hasRequiredObjectToArray=1;var Y=requireDescriptors(),K=requireFails(),ee=requireFunctionUncurryThis(),ne=requireObjectGetPrototypeOf(),re=requireObjectKeys(),le=requireToIndexedObject(),Q=requireObjectPropertyIsEnumerable().f,R=ee(Q),U=ee([].push),Z=Y&&K(function(){var he=Object.create(null);return he[2]=2,!R(he,2)}),ae=function(he){return function(pe){for(var me=le(pe),ve=re(me),Re=Z&&ne(me)===null,Me=ve.length,Te=0,Ce=[],We;Me>Te;)We=ve[Te++],(!Y||(Re?We in me:R(me,We)))&&U(Ce,he?[We,me[We]]:me[We]);return Ce}};return objectToArray={entries:ae(!0),values:ae(!1)},objectToArray}var hasRequiredEs_object_entries;function requireEs_object_entries(){if(hasRequiredEs_object_entries)return es_object_entries;hasRequiredEs_object_entries=1;var Y=require_export(),K=requireObjectToArray().entries;return Y({target:"Object",stat:!0},{entries:function(ne){return K(ne)}}),es_object_entries}var es_object_freeze={},hasRequiredEs_object_freeze;function requireEs_object_freeze(){if(hasRequiredEs_object_freeze)return es_object_freeze;hasRequiredEs_object_freeze=1;var Y=require_export(),K=requireFreezing(),ee=requireFails(),ne=requireIsObject$1(),re=requireInternalMetadata().onFreeze,le=Object.freeze,Q=ee(function(){le(1)});return Y({target:"Object",stat:!0,forced:Q,sham:!K},{freeze:function(U){return le&&ne(U)?le(re(U)):U}}),es_object_freeze}var es_object_fromEntries={},hasRequiredEs_object_fromEntries;function requireEs_object_fromEntries(){if(hasRequiredEs_object_fromEntries)return es_object_fromEntries;hasRequiredEs_object_fromEntries=1;var Y=require_export(),K=requireIterate(),ee=requireCreateProperty();return Y({target:"Object",stat:!0},{fromEntries:function(re){var le={};return K(re,function(Q,R){ee(le,Q,R)},{AS_ENTRIES:!0}),le}}),es_object_fromEntries}var es_object_getOwnPropertyDescriptor={},hasRequiredEs_object_getOwnPropertyDescriptor;function requireEs_object_getOwnPropertyDescriptor(){if(hasRequiredEs_object_getOwnPropertyDescriptor)return es_object_getOwnPropertyDescriptor;hasRequiredEs_object_getOwnPropertyDescriptor=1;var Y=require_export(),K=requireFails(),ee=requireToIndexedObject(),ne=requireObjectGetOwnPropertyDescriptor().f,re=requireDescriptors(),le=!re||K(function(){ne(1)});return Y({target:"Object",stat:!0,forced:le,sham:!re},{getOwnPropertyDescriptor:function(R,U){return ne(ee(R),U)}}),es_object_getOwnPropertyDescriptor}var es_object_getOwnPropertyDescriptors={},hasRequiredEs_object_getOwnPropertyDescriptors;function requireEs_object_getOwnPropertyDescriptors(){if(hasRequiredEs_object_getOwnPropertyDescriptors)return es_object_getOwnPropertyDescriptors;hasRequiredEs_object_getOwnPropertyDescriptors=1;var Y=require_export(),K=requireDescriptors(),ee=requireOwnKeys(),ne=requireToIndexedObject(),re=requireObjectGetOwnPropertyDescriptor(),le=requireCreateProperty();return Y({target:"Object",stat:!0,sham:!K},{getOwnPropertyDescriptors:function(R){for(var U=ne(R),Z=re.f,ae=ee(U),he={},pe=0,me,ve;ae.length>pe;)ve=Z(U,me=ae[pe++]),ve!==void 0&&le(he,me,ve);return he}}),es_object_getOwnPropertyDescriptors}var es_object_getOwnPropertyNames={},hasRequiredEs_object_getOwnPropertyNames;function requireEs_object_getOwnPropertyNames(){if(hasRequiredEs_object_getOwnPropertyNames)return es_object_getOwnPropertyNames;hasRequiredEs_object_getOwnPropertyNames=1;var Y=require_export(),K=requireFails(),ee=requireObjectGetOwnPropertyNamesExternal().f,ne=K(function(){return!Object.getOwnPropertyNames(1)});return Y({target:"Object",stat:!0,forced:ne},{getOwnPropertyNames:ee}),es_object_getOwnPropertyNames}var es_object_getPrototypeOf={},hasRequiredEs_object_getPrototypeOf;function requireEs_object_getPrototypeOf(){if(hasRequiredEs_object_getPrototypeOf)return es_object_getPrototypeOf;hasRequiredEs_object_getPrototypeOf=1;var Y=require_export(),K=requireFails(),ee=requireToObject(),ne=requireObjectGetPrototypeOf(),re=requireCorrectPrototypeGetter(),le=K(function(){ne(1)});return Y({target:"Object",stat:!0,forced:le,sham:!re},{getPrototypeOf:function(R){return ne(ee(R))}}),es_object_getPrototypeOf}var es_object_groupBy={},hasRequiredEs_object_groupBy;function requireEs_object_groupBy(){if(hasRequiredEs_object_groupBy)return es_object_groupBy;hasRequiredEs_object_groupBy=1;var Y=require_export(),K=requireGetBuiltIn(),ee=requireFunctionUncurryThis(),ne=requireACallable(),re=requireRequireObjectCoercible(),le=requireToPropertyKey(),Q=requireIterate(),R=requireFails(),U=Object.groupBy,Z=K("Object","create"),ae=ee([].push),he=!U||R(function(){return U("ab",function(pe){return pe}).a.length!==1});return Y({target:"Object",stat:!0,forced:he},{groupBy:function(me,ve){re(me),ne(ve);var Re=Z(null),Me=0;return Q(me,function(Te){var Ce=le(ve(Te,Me++));Ce in Re?ae(Re[Ce],Te):Re[Ce]=[Te]}),Re}}),es_object_groupBy}var es_object_hasOwn={},hasRequiredEs_object_hasOwn;function requireEs_object_hasOwn(){if(hasRequiredEs_object_hasOwn)return es_object_hasOwn;hasRequiredEs_object_hasOwn=1;var Y=require_export(),K=requireHasOwnProperty();return Y({target:"Object",stat:!0},{hasOwn:K}),es_object_hasOwn}var es_object_is={},sameValue,hasRequiredSameValue;function requireSameValue(){return hasRequiredSameValue||(hasRequiredSameValue=1,sameValue=Object.is||function(K,ee){return K===ee?K!==0||1/K===1/ee:K!==K&&ee!==ee}),sameValue}var hasRequiredEs_object_is;function requireEs_object_is(){if(hasRequiredEs_object_is)return es_object_is;hasRequiredEs_object_is=1;var Y=require_export(),K=requireSameValue();return Y({target:"Object",stat:!0},{is:K}),es_object_is}var es_object_isExtensible={},hasRequiredEs_object_isExtensible;function requireEs_object_isExtensible(){if(hasRequiredEs_object_isExtensible)return es_object_isExtensible;hasRequiredEs_object_isExtensible=1;var Y=require_export(),K=requireObjectIsExtensible();return Y({target:"Object",stat:!0,forced:Object.isExtensible!==K},{isExtensible:K}),es_object_isExtensible}var es_object_isFrozen={},hasRequiredEs_object_isFrozen;function requireEs_object_isFrozen(){if(hasRequiredEs_object_isFrozen)return es_object_isFrozen;hasRequiredEs_object_isFrozen=1;var Y=require_export(),K=requireFails(),ee=requireIsObject$1(),ne=requireClassofRaw(),re=requireArrayBufferNonExtensible(),le=Object.isFrozen,Q=re||K(function(){});return Y({target:"Object",stat:!0,forced:Q},{isFrozen:function(U){return!ee(U)||re&&ne(U)==="ArrayBuffer"?!0:le?le(U):!1}}),es_object_isFrozen}var es_object_isSealed={},hasRequiredEs_object_isSealed;function requireEs_object_isSealed(){if(hasRequiredEs_object_isSealed)return es_object_isSealed;hasRequiredEs_object_isSealed=1;var Y=require_export(),K=requireFails(),ee=requireIsObject$1(),ne=requireClassofRaw(),re=requireArrayBufferNonExtensible(),le=Object.isSealed,Q=re||K(function(){});return Y({target:"Object",stat:!0,forced:Q},{isSealed:function(U){return!ee(U)||re&&ne(U)==="ArrayBuffer"?!0:le?le(U):!1}}),es_object_isSealed}var es_object_keys={},hasRequiredEs_object_keys;function requireEs_object_keys(){if(hasRequiredEs_object_keys)return es_object_keys;hasRequiredEs_object_keys=1;var Y=require_export(),K=requireToObject(),ee=requireObjectKeys(),ne=requireFails(),re=ne(function(){ee(1)});return Y({target:"Object",stat:!0,forced:re},{keys:function(Q){return ee(K(Q))}}),es_object_keys}var es_object_lookupGetter={},hasRequiredEs_object_lookupGetter;function requireEs_object_lookupGetter(){if(hasRequiredEs_object_lookupGetter)return es_object_lookupGetter;hasRequiredEs_object_lookupGetter=1;var Y=require_export(),K=requireDescriptors(),ee=requireObjectPrototypeAccessorsForced(),ne=requireToObject(),re=requireToPropertyKey(),le=requireObjectGetPrototypeOf(),Q=requireObjectGetOwnPropertyDescriptor().f;return K&&Y({target:"Object",proto:!0,forced:ee},{__lookupGetter__:function(U){var Z=ne(this),ae=re(U),he;do if(he=Q(Z,ae))return he.get;while(Z=le(Z))}}),es_object_lookupGetter}var es_object_lookupSetter={},hasRequiredEs_object_lookupSetter;function requireEs_object_lookupSetter(){if(hasRequiredEs_object_lookupSetter)return es_object_lookupSetter;hasRequiredEs_object_lookupSetter=1;var Y=require_export(),K=requireDescriptors(),ee=requireObjectPrototypeAccessorsForced(),ne=requireToObject(),re=requireToPropertyKey(),le=requireObjectGetPrototypeOf(),Q=requireObjectGetOwnPropertyDescriptor().f;return K&&Y({target:"Object",proto:!0,forced:ee},{__lookupSetter__:function(U){var Z=ne(this),ae=re(U),he;do if(he=Q(Z,ae))return he.set;while(Z=le(Z))}}),es_object_lookupSetter}var es_object_preventExtensions={},hasRequiredEs_object_preventExtensions;function requireEs_object_preventExtensions(){if(hasRequiredEs_object_preventExtensions)return es_object_preventExtensions;hasRequiredEs_object_preventExtensions=1;var Y=require_export(),K=requireIsObject$1(),ee=requireInternalMetadata().onFreeze,ne=requireFreezing(),re=requireFails(),le=Object.preventExtensions,Q=re(function(){le(1)});return Y({target:"Object",stat:!0,forced:Q,sham:!ne},{preventExtensions:function(U){return le&&K(U)?le(ee(U)):U}}),es_object_preventExtensions}var es_object_proto={},hasRequiredEs_object_proto;function requireEs_object_proto(){if(hasRequiredEs_object_proto)return es_object_proto;hasRequiredEs_object_proto=1;var Y=requireDescriptors(),K=requireDefineBuiltInAccessor(),ee=requireIsObject$1(),ne=requireIsPossiblePrototype(),re=requireToObject(),le=requireRequireObjectCoercible(),Q=Object.getPrototypeOf,R=Object.setPrototypeOf,U=Object.prototype,Z="__proto__";if(Y&&Q&&R&&!(Z in U))try{K(U,Z,{configurable:!0,get:function(){return Q(re(this))},set:function(he){var pe=le(this);ne(he)&&ee(pe)&&R(pe,he)}})}catch{}return es_object_proto}var es_object_seal={},hasRequiredEs_object_seal;function requireEs_object_seal(){if(hasRequiredEs_object_seal)return es_object_seal;hasRequiredEs_object_seal=1;var Y=require_export(),K=requireIsObject$1(),ee=requireInternalMetadata().onFreeze,ne=requireFreezing(),re=requireFails(),le=Object.seal,Q=re(function(){le(1)});return Y({target:"Object",stat:!0,forced:Q,sham:!ne},{seal:function(U){return le&&K(U)?le(ee(U)):U}}),es_object_seal}var es_object_setPrototypeOf={},hasRequiredEs_object_setPrototypeOf;function requireEs_object_setPrototypeOf(){if(hasRequiredEs_object_setPrototypeOf)return es_object_setPrototypeOf;hasRequiredEs_object_setPrototypeOf=1;var Y=require_export(),K=requireObjectSetPrototypeOf();return Y({target:"Object",stat:!0},{setPrototypeOf:K}),es_object_setPrototypeOf}var es_object_toString={},objectToString,hasRequiredObjectToString;function requireObjectToString(){if(hasRequiredObjectToString)return objectToString;hasRequiredObjectToString=1;var Y=requireToStringTagSupport(),K=requireClassof();return objectToString=Y?{}.toString:function(){return"[object "+K(this)+"]"},objectToString}var hasRequiredEs_object_toString;function requireEs_object_toString(){if(hasRequiredEs_object_toString)return es_object_toString;hasRequiredEs_object_toString=1;var Y=requireToStringTagSupport(),K=requireDefineBuiltIn(),ee=requireObjectToString();return Y||K(Object.prototype,"toString",ee,{unsafe:!0}),es_object_toString}var es_object_values={},hasRequiredEs_object_values;function requireEs_object_values(){if(hasRequiredEs_object_values)return es_object_values;hasRequiredEs_object_values=1;var Y=require_export(),K=requireObjectToArray().values;return Y({target:"Object",stat:!0},{values:function(ne){return K(ne)}}),es_object_values}var es_parseFloat={},hasRequiredEs_parseFloat;function requireEs_parseFloat(){if(hasRequiredEs_parseFloat)return es_parseFloat;hasRequiredEs_parseFloat=1;var Y=require_export(),K=requireNumberParseFloat();return Y({global:!0,forced:parseFloat!==K},{parseFloat:K}),es_parseFloat}var es_parseInt={},hasRequiredEs_parseInt;function requireEs_parseInt(){if(hasRequiredEs_parseInt)return es_parseInt;hasRequiredEs_parseInt=1;var Y=require_export(),K=requireNumberParseInt();return Y({global:!0,forced:parseInt!==K},{parseInt:K}),es_parseInt}var es_promise={},es_promise_constructor={},aConstructor,hasRequiredAConstructor;function requireAConstructor(){if(hasRequiredAConstructor)return aConstructor;hasRequiredAConstructor=1;var Y=requireIsConstructor(),K=requireTryToString(),ee=TypeError;return aConstructor=function(ne){if(Y(ne))return ne;throw new ee(K(ne)+" is not a constructor")},aConstructor}var speciesConstructor,hasRequiredSpeciesConstructor;function requireSpeciesConstructor(){if(hasRequiredSpeciesConstructor)return speciesConstructor;hasRequiredSpeciesConstructor=1;var Y=requireAnObject(),K=requireAConstructor(),ee=requireIsNullOrUndefined(),ne=requireWellKnownSymbol(),re=ne("species");return speciesConstructor=function(le,Q){var R=Y(le).constructor,U;return R===void 0||ee(U=Y(R)[re])?Q:K(U)},speciesConstructor}var validateArgumentsLength,hasRequiredValidateArgumentsLength;function requireValidateArgumentsLength(){if(hasRequiredValidateArgumentsLength)return validateArgumentsLength;hasRequiredValidateArgumentsLength=1;var Y=TypeError;return validateArgumentsLength=function(K,ee){if(K<ee)throw new Y("Not enough arguments");return K},validateArgumentsLength}var environmentIsIos,hasRequiredEnvironmentIsIos;function requireEnvironmentIsIos(){if(hasRequiredEnvironmentIsIos)return environmentIsIos;hasRequiredEnvironmentIsIos=1;var Y=requireEnvironmentUserAgent();return environmentIsIos=/(?:ipad|iphone|ipod).*applewebkit/i.test(Y),environmentIsIos}var task,hasRequiredTask;function requireTask(){if(hasRequiredTask)return task;hasRequiredTask=1;var Y=requireGlobalThis(),K=requireFunctionApply(),ee=requireFunctionBindContext(),ne=requireIsCallable(),re=requireHasOwnProperty(),le=requireFails(),Q=requireHtml(),R=requireArraySlice(),U=requireDocumentCreateElement(),Z=requireValidateArgumentsLength(),ae=requireEnvironmentIsIos(),he=requireEnvironmentIsNode(),pe=Y.setImmediate,me=Y.clearImmediate,ve=Y.process,Re=Y.Dispatch,Me=Y.Function,Te=Y.MessageChannel,Ce=Y.String,We=0,Fe={},ke="onreadystatechange",Ze,Je,Qe,it;le(function(){Ze=Y.location});var lt=function(qt){if(re(Fe,qt)){var Ft=Fe[qt];delete Fe[qt],Ft()}},dt=function(qt){return function(){lt(qt)}},yt=function(qt){lt(qt.data)},gt=function(qt){Y.postMessage(Ce(qt),Ze.protocol+"//"+Ze.host)};return(!pe||!me)&&(pe=function(Ft){Z(arguments.length,1);var Gt=ne(Ft)?Ft:Me(Ft),ft=R(arguments,1);return Fe[++We]=function(){K(Gt,void 0,ft)},Je(We),We},me=function(Ft){delete Fe[Ft]},he?Je=function(qt){ve.nextTick(dt(qt))}:Re&&Re.now?Je=function(qt){Re.now(dt(qt))}:Te&&!ae?(Qe=new Te,it=Qe.port2,Qe.port1.onmessage=yt,Je=ee(it.postMessage,it)):Y.addEventListener&&ne(Y.postMessage)&&!Y.importScripts&&Ze&&Ze.protocol!=="file:"&&!le(gt)?(Je=gt,Y.addEventListener("message",yt,!1)):ke in U("script")?Je=function(qt){Q.appendChild(U("script"))[ke]=function(){Q.removeChild(this),lt(qt)}}:Je=function(qt){setTimeout(dt(qt),0)}),task={set:pe,clear:me},task}var safeGetBuiltIn,hasRequiredSafeGetBuiltIn;function requireSafeGetBuiltIn(){if(hasRequiredSafeGetBuiltIn)return safeGetBuiltIn;hasRequiredSafeGetBuiltIn=1;var Y=requireGlobalThis(),K=requireDescriptors(),ee=Object.getOwnPropertyDescriptor;return safeGetBuiltIn=function(ne){if(!K)return Y[ne];var re=ee(Y,ne);return re&&re.value},safeGetBuiltIn}var queue,hasRequiredQueue;function requireQueue(){if(hasRequiredQueue)return queue;hasRequiredQueue=1;var Y=function(){this.head=null,this.tail=null};return Y.prototype={add:function(K){var ee={item:K,next:null},ne=this.tail;ne?ne.next=ee:this.head=ee,this.tail=ee},get:function(){var K=this.head;if(K){var ee=this.head=K.next;return ee===null&&(this.tail=null),K.item}}},queue=Y,queue}var environmentIsIosPebble,hasRequiredEnvironmentIsIosPebble;function requireEnvironmentIsIosPebble(){if(hasRequiredEnvironmentIsIosPebble)return environmentIsIosPebble;hasRequiredEnvironmentIsIosPebble=1;var Y=requireEnvironmentUserAgent();return environmentIsIosPebble=/ipad|iphone|ipod/i.test(Y)&&typeof Pebble<"u",environmentIsIosPebble}var environmentIsWebosWebkit,hasRequiredEnvironmentIsWebosWebkit;function requireEnvironmentIsWebosWebkit(){if(hasRequiredEnvironmentIsWebosWebkit)return environmentIsWebosWebkit;hasRequiredEnvironmentIsWebosWebkit=1;var Y=requireEnvironmentUserAgent();return environmentIsWebosWebkit=/web0s(?!.*chrome)/i.test(Y),environmentIsWebosWebkit}var microtask_1,hasRequiredMicrotask;function requireMicrotask(){if(hasRequiredMicrotask)return microtask_1;hasRequiredMicrotask=1;var Y=requireGlobalThis(),K=requireSafeGetBuiltIn(),ee=requireFunctionBindContext(),ne=requireTask().set,re=requireQueue(),le=requireEnvironmentIsIos(),Q=requireEnvironmentIsIosPebble(),R=requireEnvironmentIsWebosWebkit(),U=requireEnvironmentIsNode(),Z=Y.MutationObserver||Y.WebKitMutationObserver,ae=Y.document,he=Y.process,pe=Y.Promise,me=K("queueMicrotask"),ve,Re,Me,Te,Ce;if(!me){var We=new re,Fe=function(){var ke,Ze;for(U&&(ke=he.domain)&&ke.exit();Ze=We.get();)try{Ze()}catch(Je){throw We.head&&ve(),Je}ke&&ke.enter()};!le&&!U&&!R&&Z&&ae?(Re=!0,Me=ae.createTextNode(""),new Z(Fe).observe(Me,{characterData:!0}),ve=function(){Me.data=Re=!Re}):!Q&&pe&&pe.resolve?(Te=pe.resolve(void 0),Te.constructor=pe,Ce=ee(Te.then,Te),ve=function(){Ce(Fe)}):U?ve=function(){he.nextTick(Fe)}:(ne=ee(ne,Y),ve=function(){ne(Fe)}),me=function(ke){We.head||ve(),We.add(ke)}}return microtask_1=me,microtask_1}var hostReportErrors,hasRequiredHostReportErrors;function requireHostReportErrors(){return hasRequiredHostReportErrors||(hasRequiredHostReportErrors=1,hostReportErrors=function(Y,K){try{arguments.length===1?console.error(Y):console.error(Y,K)}catch{}}),hostReportErrors}var perform,hasRequiredPerform;function requirePerform(){return hasRequiredPerform||(hasRequiredPerform=1,perform=function(Y){try{return{error:!1,value:Y()}}catch(K){return{error:!0,value:K}}}),perform}var promiseNativeConstructor,hasRequiredPromiseNativeConstructor;function requirePromiseNativeConstructor(){if(hasRequiredPromiseNativeConstructor)return promiseNativeConstructor;hasRequiredPromiseNativeConstructor=1;var Y=requireGlobalThis();return promiseNativeConstructor=Y.Promise,promiseNativeConstructor}var promiseConstructorDetection,hasRequiredPromiseConstructorDetection;function requirePromiseConstructorDetection(){if(hasRequiredPromiseConstructorDetection)return promiseConstructorDetection;hasRequiredPromiseConstructorDetection=1;var Y=requireGlobalThis(),K=requirePromiseNativeConstructor(),ee=requireIsCallable(),ne=requireIsForced(),re=requireInspectSource(),le=requireWellKnownSymbol(),Q=requireEnvironment(),R=requireIsPure(),U=requireEnvironmentV8Version(),Z=K&&K.prototype,ae=le("species"),he=!1,pe=ee(Y.PromiseRejectionEvent),me=ne("Promise",function(){var ve=re(K),Re=ve!==String(K);if(!Re&&U===66||R&&!(Z.catch&&Z.finally))return!0;if(!U||U<51||!/native code/.test(ve)){var Me=new K(function(We){We(1)}),Te=function(We){We(function(){},function(){})},Ce=Me.constructor={};if(Ce[ae]=Te,he=Me.then(function(){})instanceof Te,!he)return!0}return!Re&&(Q==="BROWSER"||Q==="DENO")&&!pe});return promiseConstructorDetection={CONSTRUCTOR:me,REJECTION_EVENT:pe,SUBCLASSING:he},promiseConstructorDetection}var newPromiseCapability={},hasRequiredNewPromiseCapability;function requireNewPromiseCapability(){if(hasRequiredNewPromiseCapability)return newPromiseCapability;hasRequiredNewPromiseCapability=1;var Y=requireACallable(),K=TypeError,ee=function(ne){var re,le;this.promise=new ne(function(Q,R){if(re!==void 0||le!==void 0)throw new K("Bad Promise constructor");re=Q,le=R}),this.resolve=Y(re),this.reject=Y(le)};return newPromiseCapability.f=function(ne){return new ee(ne)},newPromiseCapability}var hasRequiredEs_promise_constructor;function requireEs_promise_constructor(){if(hasRequiredEs_promise_constructor)return es_promise_constructor;hasRequiredEs_promise_constructor=1;var Y=require_export(),K=requireIsPure(),ee=requireEnvironmentIsNode(),ne=requireGlobalThis(),re=requirePath(),le=requireFunctionCall(),Q=requireDefineBuiltIn(),R=requireObjectSetPrototypeOf(),U=requireSetToStringTag(),Z=requireSetSpecies(),ae=requireACallable(),he=requireIsCallable(),pe=requireIsObject$1(),me=requireAnInstance(),ve=requireSpeciesConstructor(),Re=requireTask().set,Me=requireMicrotask(),Te=requireHostReportErrors(),Ce=requirePerform(),We=requireQueue(),Fe=requireInternalState(),ke=requirePromiseNativeConstructor(),Ze=requirePromiseConstructorDetection(),Je=requireNewPromiseCapability(),Qe="Promise",it=Ze.CONSTRUCTOR,lt=Ze.REJECTION_EVENT,dt=Ze.SUBCLASSING,yt=Fe.getterFor(Qe),gt=Fe.set,qt=ke&&ke.prototype,Ft=ke,Gt=qt,ft=ne.TypeError,Rt=ne.document,pt=ne.process,At=Je.f,It=At,Dt=!!(Rt&&Rt.createEvent&&ne.dispatchEvent),Zt="unhandledrejection",nr="rejectionhandled",Er=0,vr=1,Sr=2,Qt=1,or=2,Ir,Rr,Cr,wr,Wr=function(lr){var yr;return pe(lr)&&he(yr=lr.then)?yr:!1},Kr=function(lr,yr){var xr=yr.value,Ge=yr.state===vr,Ee=Ge?lr.ok:lr.fail,Pe=lr.resolve,He=lr.reject,ut=lr.domain,Ve,qe,De;try{Ee?(Ge||(yr.rejection===or&&zr(yr),yr.rejection=Qt),Ee===!0?Ve=xr:(ut&&ut.enter(),Ve=Ee(xr),ut&&(ut.exit(),De=!0)),Ve===lr.promise?He(new ft("Promise-chain cycle")):(qe=Wr(Ve))?le(qe,Ve,Pe,He):Pe(Ve)):He(xr)}catch(ze){ut&&!De&&ut.exit(),He(ze)}},Hr=function(lr,yr){lr.notified||(lr.notified=!0,Me(function(){for(var xr=lr.reactions,Ge;Ge=xr.get();)Kr(Ge,lr);lr.notified=!1,yr&&!lr.rejection&&Lr(lr)}))},br=function(lr,yr,xr){var Ge,Ee;Dt?(Ge=Rt.createEvent("Event"),Ge.promise=yr,Ge.reason=xr,Ge.initEvent(lr,!1,!0),ne.dispatchEvent(Ge)):Ge={promise:yr,reason:xr},!lt&&(Ee=ne["on"+lr])?Ee(Ge):lr===Zt&&Te("Unhandled promise rejection",xr)},Lr=function(lr){le(Re,ne,function(){var yr=lr.facade,xr=lr.value,Ge=Br(lr),Ee;if(Ge&&(Ee=Ce(function(){ee?pt.emit("unhandledRejection",xr,yr):br(Zt,yr,xr)}),lr.rejection=ee||Br(lr)?or:Qt,Ee.error))throw Ee.value})},Br=function(lr){return lr.rejection!==Qt&&!lr.parent},zr=function(lr){le(Re,ne,function(){var yr=lr.facade;ee?pt.emit("rejectionHandled",yr):br(nr,yr,lr.value)})},rr=function(lr,yr,xr){return function(Ge){lr(yr,Ge,xr)}},sr=function(lr,yr,xr){lr.done||(lr.done=!0,xr&&(lr=xr),lr.value=yr,lr.state=Sr,Hr(lr,!0))},Dr=function(lr,yr,xr){if(!lr.done){lr.done=!0,xr&&(lr=xr);try{if(lr.facade===yr)throw new ft("Promise can't be resolved itself");var Ge=Wr(yr);Ge?Me(function(){var Ee={done:!1};try{le(Ge,yr,rr(Dr,Ee,lr),rr(sr,Ee,lr))}catch(Pe){sr(Ee,Pe,lr)}}):(lr.value=yr,lr.state=vr,Hr(lr,!1))}catch(Ee){sr({done:!1},Ee,lr)}}};if(it&&(Ft=function(yr){me(this,Gt),ae(yr),le(Ir,this);var xr=yt(this);try{yr(rr(Dr,xr),rr(sr,xr))}catch(Ge){sr(xr,Ge)}},Gt=Ft.prototype,Ir=function(yr){gt(this,{type:Qe,done:!1,notified:!1,parent:!1,reactions:new We,rejection:!1,state:Er,value:null})},Ir.prototype=Q(Gt,"then",function(yr,xr){var Ge=yt(this),Ee=At(ve(this,Ft));return Ge.parent=!0,Ee.ok=he(yr)?yr:!0,Ee.fail=he(xr)&&xr,Ee.domain=ee?pt.domain:void 0,Ge.state===Er?Ge.reactions.add(Ee):Me(function(){Kr(Ee,Ge)}),Ee.promise}),Rr=function(){var lr=new Ir,yr=yt(lr);this.promise=lr,this.resolve=rr(Dr,yr),this.reject=rr(sr,yr)},Je.f=At=function(lr){return lr===Ft||lr===Cr?new Rr(lr):It(lr)},!K&&he(ke)&&qt!==Object.prototype)){wr=qt.then,dt||Q(qt,"then",function(yr,xr){var Ge=this;return new Ft(function(Ee,Pe){le(wr,Ge,Ee,Pe)}).then(yr,xr)},{unsafe:!0});try{delete qt.constructor}catch{}R&&R(qt,Gt)}return Y({global:!0,constructor:!0,wrap:!0,forced:it},{Promise:Ft}),Cr=re.Promise,U(Ft,Qe,!1,!0),Z(Qe),es_promise_constructor}var es_promise_all={},promiseStaticsIncorrectIteration,hasRequiredPromiseStaticsIncorrectIteration;function requirePromiseStaticsIncorrectIteration(){if(hasRequiredPromiseStaticsIncorrectIteration)return promiseStaticsIncorrectIteration;hasRequiredPromiseStaticsIncorrectIteration=1;var Y=requirePromiseNativeConstructor(),K=requireCheckCorrectnessOfIteration(),ee=requirePromiseConstructorDetection().CONSTRUCTOR;return promiseStaticsIncorrectIteration=ee||!K(function(ne){Y.all(ne).then(void 0,function(){})}),promiseStaticsIncorrectIteration}var hasRequiredEs_promise_all;function requireEs_promise_all(){if(hasRequiredEs_promise_all)return es_promise_all;hasRequiredEs_promise_all=1;var Y=require_export(),K=requireFunctionCall(),ee=requireACallable(),ne=requireNewPromiseCapability(),re=requirePerform(),le=requireIterate(),Q=requirePromiseStaticsIncorrectIteration();return Y({target:"Promise",stat:!0,forced:Q},{all:function(U){var Z=this,ae=ne.f(Z),he=ae.resolve,pe=ae.reject,me=re(function(){var ve=ee(Z.resolve),Re=[],Me=0,Te=1;le(U,function(Ce){var We=Me++,Fe=!1;Te++,K(ve,Z,Ce).then(function(ke){Fe||(Fe=!0,Re[We]=ke,--Te||he(Re))},pe)}),--Te||he(Re)});return me.error&&pe(me.value),ae.promise}}),es_promise_all}var es_promise_catch={},hasRequiredEs_promise_catch;function requireEs_promise_catch(){if(hasRequiredEs_promise_catch)return es_promise_catch;hasRequiredEs_promise_catch=1;var Y=require_export(),K=requireIsPure(),ee=requirePromiseConstructorDetection().CONSTRUCTOR,ne=requirePromiseNativeConstructor(),re=requireGetBuiltIn(),le=requireIsCallable(),Q=requireDefineBuiltIn(),R=ne&&ne.prototype;if(Y({target:"Promise",proto:!0,forced:ee,real:!0},{catch:function(Z){return this.then(void 0,Z)}}),!K&&le(ne)){var U=re("Promise").prototype.catch;R.catch!==U&&Q(R,"catch",U,{unsafe:!0})}return es_promise_catch}var es_promise_race={},hasRequiredEs_promise_race;function requireEs_promise_race(){if(hasRequiredEs_promise_race)return es_promise_race;hasRequiredEs_promise_race=1;var Y=require_export(),K=requireFunctionCall(),ee=requireACallable(),ne=requireNewPromiseCapability(),re=requirePerform(),le=requireIterate(),Q=requirePromiseStaticsIncorrectIteration();return Y({target:"Promise",stat:!0,forced:Q},{race:function(U){var Z=this,ae=ne.f(Z),he=ae.reject,pe=re(function(){var me=ee(Z.resolve);le(U,function(ve){K(me,Z,ve).then(ae.resolve,he)})});return pe.error&&he(pe.value),ae.promise}}),es_promise_race}var es_promise_reject={},hasRequiredEs_promise_reject;function requireEs_promise_reject(){if(hasRequiredEs_promise_reject)return es_promise_reject;hasRequiredEs_promise_reject=1;var Y=require_export(),K=requireNewPromiseCapability(),ee=requirePromiseConstructorDetection().CONSTRUCTOR;return Y({target:"Promise",stat:!0,forced:ee},{reject:function(re){var le=K.f(this),Q=le.reject;return Q(re),le.promise}}),es_promise_reject}var es_promise_resolve={},promiseResolve,hasRequiredPromiseResolve;function requirePromiseResolve(){if(hasRequiredPromiseResolve)return promiseResolve;hasRequiredPromiseResolve=1;var Y=requireAnObject(),K=requireIsObject$1(),ee=requireNewPromiseCapability();return promiseResolve=function(ne,re){if(Y(ne),K(re)&&re.constructor===ne)return re;var le=ee.f(ne),Q=le.resolve;return Q(re),le.promise},promiseResolve}var hasRequiredEs_promise_resolve;function requireEs_promise_resolve(){if(hasRequiredEs_promise_resolve)return es_promise_resolve;hasRequiredEs_promise_resolve=1;var Y=require_export(),K=requireGetBuiltIn(),ee=requireIsPure(),ne=requirePromiseNativeConstructor(),re=requirePromiseConstructorDetection().CONSTRUCTOR,le=requirePromiseResolve(),Q=K("Promise"),R=ee&&!re;return Y({target:"Promise",stat:!0,forced:ee||re},{resolve:function(Z){return le(R&&this===Q?ne:this,Z)}}),es_promise_resolve}var hasRequiredEs_promise;function requireEs_promise(){return hasRequiredEs_promise||(hasRequiredEs_promise=1,requireEs_promise_constructor(),requireEs_promise_all(),requireEs_promise_catch(),requireEs_promise_race(),requireEs_promise_reject(),requireEs_promise_resolve()),es_promise}var es_promise_allSettled={},hasRequiredEs_promise_allSettled;function requireEs_promise_allSettled(){if(hasRequiredEs_promise_allSettled)return es_promise_allSettled;hasRequiredEs_promise_allSettled=1;var Y=require_export(),K=requireFunctionCall(),ee=requireACallable(),ne=requireNewPromiseCapability(),re=requirePerform(),le=requireIterate(),Q=requirePromiseStaticsIncorrectIteration();return Y({target:"Promise",stat:!0,forced:Q},{allSettled:function(U){var Z=this,ae=ne.f(Z),he=ae.resolve,pe=ae.reject,me=re(function(){var ve=ee(Z.resolve),Re=[],Me=0,Te=1;le(U,function(Ce){var We=Me++,Fe=!1;Te++,K(ve,Z,Ce).then(function(ke){Fe||(Fe=!0,Re[We]={status:"fulfilled",value:ke},--Te||he(Re))},function(ke){Fe||(Fe=!0,Re[We]={status:"rejected",reason:ke},--Te||he(Re))})}),--Te||he(Re)});return me.error&&pe(me.value),ae.promise}}),es_promise_allSettled}var es_promise_any={},hasRequiredEs_promise_any;function requireEs_promise_any(){if(hasRequiredEs_promise_any)return es_promise_any;hasRequiredEs_promise_any=1;var Y=require_export(),K=requireFunctionCall(),ee=requireACallable(),ne=requireGetBuiltIn(),re=requireNewPromiseCapability(),le=requirePerform(),Q=requireIterate(),R=requirePromiseStaticsIncorrectIteration(),U="No one promise resolved";return Y({target:"Promise",stat:!0,forced:R},{any:function(ae){var he=this,pe=ne("AggregateError"),me=re.f(he),ve=me.resolve,Re=me.reject,Me=le(function(){var Te=ee(he.resolve),Ce=[],We=0,Fe=1,ke=!1;Q(ae,function(Ze){var Je=We++,Qe=!1;Fe++,K(Te,he,Ze).then(function(it){Qe||ke||(ke=!0,ve(it))},function(it){Qe||ke||(Qe=!0,Ce[Je]=it,--Fe||Re(new pe(Ce,U)))})}),--Fe||Re(new pe(Ce,U))});return Me.error&&Re(Me.value),me.promise}}),es_promise_any}var es_promise_finally={},hasRequiredEs_promise_finally;function requireEs_promise_finally(){if(hasRequiredEs_promise_finally)return es_promise_finally;hasRequiredEs_promise_finally=1;var Y=require_export(),K=requireIsPure(),ee=requirePromiseNativeConstructor(),ne=requireFails(),re=requireGetBuiltIn(),le=requireIsCallable(),Q=requireSpeciesConstructor(),R=requirePromiseResolve(),U=requireDefineBuiltIn(),Z=ee&&ee.prototype,ae=!!ee&&ne(function(){Z.finally.call({then:function(){}},function(){})});if(Y({target:"Promise",proto:!0,real:!0,forced:ae},{finally:function(pe){var me=Q(this,re("Promise")),ve=le(pe);return this.then(ve?function(Re){return R(me,pe()).then(function(){return Re})}:pe,ve?function(Re){return R(me,pe()).then(function(){throw Re})}:pe)}}),!K&&le(ee)){var he=re("Promise").prototype.finally;Z.finally!==he&&U(Z,"finally",he,{unsafe:!0})}return es_promise_finally}var es_promise_try={},hasRequiredEs_promise_try;function requireEs_promise_try(){if(hasRequiredEs_promise_try)return es_promise_try;hasRequiredEs_promise_try=1;var Y=require_export(),K=requireGlobalThis(),ee=requireFunctionApply(),ne=requireArraySlice(),re=requireNewPromiseCapability(),le=requireACallable(),Q=requirePerform(),R=K.Promise,U=!1,Z=!R||!R.try||Q(function(){R.try(function(ae){U=ae===8},8)}).error||!U;return Y({target:"Promise",stat:!0,forced:Z},{try:function(ae){var he=arguments.length>1?ne(arguments,1):[],pe=re.f(this),me=Q(function(){return ee(le(ae),void 0,he)});return(me.error?pe.reject:pe.resolve)(me.value),pe.promise}}),es_promise_try}var es_promise_withResolvers={},hasRequiredEs_promise_withResolvers;function requireEs_promise_withResolvers(){if(hasRequiredEs_promise_withResolvers)return es_promise_withResolvers;hasRequiredEs_promise_withResolvers=1;var Y=require_export(),K=requireNewPromiseCapability();return Y({target:"Promise",stat:!0},{withResolvers:function(){var ne=K.f(this);return{promise:ne.promise,resolve:ne.resolve,reject:ne.reject}}}),es_promise_withResolvers}var es_array_fromAsync={},asyncIteratorPrototype,hasRequiredAsyncIteratorPrototype;function requireAsyncIteratorPrototype(){if(hasRequiredAsyncIteratorPrototype)return asyncIteratorPrototype;hasRequiredAsyncIteratorPrototype=1;var Y=requireGlobalThis(),K=requireSharedStore(),ee=requireIsCallable(),ne=requireObjectCreate(),re=requireObjectGetPrototypeOf(),le=requireDefineBuiltIn(),Q=requireWellKnownSymbol(),R=requireIsPure(),U="USE_FUNCTION_CONSTRUCTOR",Z=Q("asyncIterator"),ae=Y.AsyncIterator,he=K.AsyncIteratorPrototype,pe,me;if(he)pe=he;else if(ee(ae))pe=ae.prototype;else if(K[U]||Y[U])try{me=re(re(re(Function("return async function*(){}()")()))),re(me)===Object.prototype&&(pe=me)}catch{}return pe?R&&(pe=ne(pe)):pe={},ee(pe[Z])||le(pe,Z,function(){return this}),asyncIteratorPrototype=pe,asyncIteratorPrototype}var asyncFromSyncIterator,hasRequiredAsyncFromSyncIterator;function requireAsyncFromSyncIterator(){if(hasRequiredAsyncFromSyncIterator)return asyncFromSyncIterator;hasRequiredAsyncFromSyncIterator=1;var Y=requireFunctionCall(),K=requireAnObject(),ee=requireObjectCreate(),ne=requireGetMethod(),re=requireDefineBuiltIns(),le=requireInternalState(),Q=requireIteratorClose(),R=requireGetBuiltIn(),U=requireAsyncIteratorPrototype(),Z=requireCreateIterResultObject(),ae=R("Promise"),he="AsyncFromSyncIterator",pe=le.set,me=le.getterFor(he),ve=function(Me,Te,Ce,We,Fe){var ke=Me.done;ae.resolve(Me.value).then(function(Ze){Te(Z(Ze,ke))},function(Ze){if(!ke&&Fe)try{Q(We,"throw",Ze)}catch(Je){Ze=Je}Ce(Ze)})},Re=function(Te){Te.type=he,pe(this,Te)};return Re.prototype=re(ee(U),{next:function(){var Te=me(this);return new ae(function(Ce,We){var Fe=K(Y(Te.next,Te.iterator));ve(Fe,Ce,We,Te.iterator,!0)})},return:function(){var Me=me(this).iterator;return new ae(function(Te,Ce){var We=ne(Me,"return");if(We===void 0)return Te(Z(void 0,!0));var Fe=K(Y(We,Me));ve(Fe,Te,Ce,Me)})}}),asyncFromSyncIterator=Re,asyncFromSyncIterator}var getAsyncIterator,hasRequiredGetAsyncIterator;function requireGetAsyncIterator(){if(hasRequiredGetAsyncIterator)return getAsyncIterator;hasRequiredGetAsyncIterator=1;var Y=requireFunctionCall(),K=requireAsyncFromSyncIterator(),ee=requireAnObject(),ne=requireGetIterator(),re=requireGetIteratorDirect(),le=requireGetMethod(),Q=requireWellKnownSymbol(),R=Q("asyncIterator");return getAsyncIterator=function(U,Z){var ae=arguments.length<2?le(U,R):Z;return ae?ee(Y(ae,U)):new K(re(ne(U)))},getAsyncIterator}var asyncIteratorClose,hasRequiredAsyncIteratorClose;function requireAsyncIteratorClose(){if(hasRequiredAsyncIteratorClose)return asyncIteratorClose;hasRequiredAsyncIteratorClose=1;var Y=requireFunctionCall(),K=requireGetBuiltIn(),ee=requireGetMethod();return asyncIteratorClose=function(ne,re,le,Q){try{var R=ee(ne,"return");if(R)return K("Promise").resolve(Y(R,ne)).then(function(){re(le)},function(U){Q(U)})}catch(U){return Q(U)}re(le)},asyncIteratorClose}var asyncIteratorIteration,hasRequiredAsyncIteratorIteration;function requireAsyncIteratorIteration(){if(hasRequiredAsyncIteratorIteration)return asyncIteratorIteration;hasRequiredAsyncIteratorIteration=1;var Y=requireFunctionCall(),K=requireACallable(),ee=requireAnObject(),ne=requireIsObject$1(),re=requireDoesNotExceedSafeInteger(),le=requireGetBuiltIn(),Q=requireGetIteratorDirect(),R=requireAsyncIteratorClose(),U=function(Z){var ae=Z===0,he=Z===1,pe=Z===2,me=Z===3;return function(ve,Re,Me){ee(ve);var Te=Re!==void 0;(Te||!ae)&&K(Re);var Ce=Q(ve),We=le("Promise"),Fe=Ce.iterator,ke=Ce.next,Ze=0;return new We(function(Je,Qe){var it=function(dt){R(Fe,Qe,dt,Qe)},lt=function(){try{if(Te)try{re(Ze)}catch(dt){it(dt)}We.resolve(ee(Y(ke,Fe))).then(function(dt){try{if(ee(dt).done)ae?(Me.length=Ze,Je(Me)):Je(me?!1:pe||void 0);else{var yt=dt.value;try{if(Te){var gt=Re(yt,Ze),qt=function(Ft){if(he)lt();else if(pe)Ft?lt():R(Fe,Je,!1,Qe);else if(ae)try{Me[Ze++]=Ft,lt()}catch(Gt){it(Gt)}else Ft?R(Fe,Je,me||yt,Qe):lt()};ne(gt)?We.resolve(gt).then(qt,it):qt(gt)}else Me[Ze++]=yt,lt()}catch(Ft){it(Ft)}}}catch(Ft){Qe(Ft)}},Qe)}catch(dt){Qe(dt)}};lt()})}};return asyncIteratorIteration={toArray:U(0),forEach:U(1),every:U(2),some:U(3),find:U(4)},asyncIteratorIteration}var arrayFromAsync,hasRequiredArrayFromAsync;function requireArrayFromAsync(){if(hasRequiredArrayFromAsync)return arrayFromAsync;hasRequiredArrayFromAsync=1;var Y=requireFunctionBindContext(),K=requireFunctionUncurryThis(),ee=requireToObject(),ne=requireIsConstructor(),re=requireGetAsyncIterator(),le=requireGetIterator(),Q=requireGetIteratorDirect(),R=requireGetIteratorMethod(),U=requireGetMethod(),Z=requireGetBuiltIn(),ae=requireGetBuiltInPrototypeMethod(),he=requireWellKnownSymbol(),pe=requireAsyncFromSyncIterator(),me=requireAsyncIteratorIteration().toArray,ve=he("asyncIterator"),Re=K(ae("Array","values")),Me=K(Re([]).next),Te=function(){return new Ce(this)},Ce=function(We){this.iterator=Re(We)};return Ce.prototype.next=function(){return Me(this.iterator)},arrayFromAsync=function(Fe){var ke=this,Ze=arguments.length,Je=Ze>1?arguments[1]:void 0,Qe=Ze>2?arguments[2]:void 0;return new(Z("Promise"))(function(it){var lt=ee(Fe);Je!==void 0&&(Je=Y(Je,Qe));var dt=U(lt,ve),yt=dt?void 0:R(lt)||Te,gt=ne(ke)?new ke:[],qt=dt?re(lt,dt):new pe(Q(le(lt,yt)));it(me(qt,Je,gt))})},arrayFromAsync}var hasRequiredEs_array_fromAsync;function requireEs_array_fromAsync(){if(hasRequiredEs_array_fromAsync)return es_array_fromAsync;hasRequiredEs_array_fromAsync=1;var Y=require_export(),K=requireArrayFromAsync(),ee=requireFails(),ne=Array.fromAsync,re=!ne||ee(function(){var le=0;return ne.call(function(){return le++,[]},{length:0}),le!==1});return Y({target:"Array",stat:!0,forced:re},{fromAsync:K}),es_array_fromAsync}var es_asyncDisposableStack_constructor={},hasRequiredEs_asyncDisposableStack_constructor;function requireEs_asyncDisposableStack_constructor(){if(hasRequiredEs_asyncDisposableStack_constructor)return es_asyncDisposableStack_constructor;hasRequiredEs_asyncDisposableStack_constructor=1;var Y=require_export(),K=requireDescriptors(),ee=requireGetBuiltIn(),ne=requireACallable(),re=requireAnInstance(),le=requireDefineBuiltIn(),Q=requireDefineBuiltIns(),R=requireDefineBuiltInAccessor(),U=requireWellKnownSymbol(),Z=requireInternalState(),ae=requireAddDisposableResource(),he=requireEnvironmentV8Version(),pe=ee("Promise"),me=ee("SuppressedError"),ve=ReferenceError,Re=U("asyncDispose"),Me=U("toStringTag"),Te="AsyncDisposableStack",Ce=Z.set,We=Z.getterFor(Te),Fe="async-dispose",ke="disposed",Ze="pending",Je=function(dt){var yt=We(dt);if(yt.state===ke)throw new ve(Te+" already disposed");return yt},Qe=function(){Ce(re(this,it),{type:Te,state:Ze,stack:[]}),K||(this.disposed=!1)},it=Qe.prototype;Q(it,{disposeAsync:function(){var yt=this;return new pe(function(gt,qt){var Ft=We(yt);if(Ft.state===ke)return gt(void 0);Ft.state=ke,K||(yt.disposed=!0);var Gt=Ft.stack,ft=Gt.length,Rt=!1,pt,At=function(Dt){Rt?pt=new me(Dt,pt):(Rt=!0,pt=Dt),It()},It=function(){if(ft){var Dt=Gt[--ft];Gt[ft]=null;try{pe.resolve(Dt()).then(It,At)}catch(Zt){At(Zt)}}else Ft.stack=null,Rt?qt(pt):gt(void 0)};It()})},use:function(yt){return ae(Je(this),yt,Fe),yt},adopt:function(yt,gt){var qt=Je(this);return ne(gt),ae(qt,void 0,Fe,function(){return gt(yt)}),yt},defer:function(yt){var gt=Je(this);ne(yt),ae(gt,void 0,Fe,yt)},move:function(){var yt=Je(this),gt=new Qe;return We(gt).stack=yt.stack,yt.stack=[],yt.state=ke,K||(this.disposed=!0),gt}}),K&&R(it,"disposed",{configurable:!0,get:function(){return We(this).state===ke}}),le(it,Re,it.disposeAsync,{name:"disposeAsync"}),le(it,Me,Te,{nonWritable:!0});var lt=he&&he<136;return Y({global:!0,constructor:!0,forced:lt},{AsyncDisposableStack:Qe}),es_asyncDisposableStack_constructor}var es_asyncIterator_asyncDispose={},hasRequiredEs_asyncIterator_asyncDispose;function requireEs_asyncIterator_asyncDispose(){if(hasRequiredEs_asyncIterator_asyncDispose)return es_asyncIterator_asyncDispose;hasRequiredEs_asyncIterator_asyncDispose=1;var Y=requireFunctionCall(),K=requireDefineBuiltIn(),ee=requireGetBuiltIn(),ne=requireGetMethod(),re=requireHasOwnProperty(),le=requireWellKnownSymbol(),Q=requireAsyncIteratorPrototype(),R=le("asyncDispose"),U=ee("Promise");return re(Q,R)||K(Q,R,function(){var Z=this;return new U(function(ae,he){var pe=ne(Z,"return");pe?U.resolve(Y(pe,Z)).then(function(){ae(void 0)},he):ae(void 0)})}),es_asyncIterator_asyncDispose}var es_reflect_apply={},hasRequiredEs_reflect_apply;function requireEs_reflect_apply(){if(hasRequiredEs_reflect_apply)return es_reflect_apply;hasRequiredEs_reflect_apply=1;var Y=require_export(),K=requireFunctionApply(),ee=requireACallable(),ne=requireAnObject(),re=requireFails(),le=!re(function(){Reflect.apply(function(){})});return Y({target:"Reflect",stat:!0,forced:le},{apply:function(R,U,Z){return K(ee(R),U,ne(Z))}}),es_reflect_apply}var es_reflect_construct={},hasRequiredEs_reflect_construct;function requireEs_reflect_construct(){if(hasRequiredEs_reflect_construct)return es_reflect_construct;hasRequiredEs_reflect_construct=1;var Y=require_export(),K=requireGetBuiltIn(),ee=requireFunctionApply(),ne=requireFunctionBind(),re=requireAConstructor(),le=requireAnObject(),Q=requireIsObject$1(),R=requireObjectCreate(),U=requireFails(),Z=K("Reflect","construct"),ae=Object.prototype,he=[].push,pe=U(function(){function Re(){}return!(Z(function(){},[],Re)instanceof Re)}),me=!U(function(){Z(function(){})}),ve=pe||me;return Y({target:"Reflect",stat:!0,forced:ve,sham:ve},{construct:function(Me,Te){re(Me),le(Te);var Ce=arguments.length<3?Me:re(arguments[2]);if(me&&!pe)return Z(Me,Te,Ce);if(Me===Ce){switch(Te.length){case 0:return new Me;case 1:return new Me(Te[0]);case 2:return new Me(Te[0],Te[1]);case 3:return new Me(Te[0],Te[1],Te[2]);case 4:return new Me(Te[0],Te[1],Te[2],Te[3])}var We=[null];return ee(he,We,Te),new(ee(ne,Me,We))}var Fe=Ce.prototype,ke=R(Q(Fe)?Fe:ae),Ze=ee(Me,ke,Te);return Q(Ze)?Ze:ke}}),es_reflect_construct}var es_reflect_defineProperty={},hasRequiredEs_reflect_defineProperty;function requireEs_reflect_defineProperty(){if(hasRequiredEs_reflect_defineProperty)return es_reflect_defineProperty;hasRequiredEs_reflect_defineProperty=1;var Y=require_export(),K=requireDescriptors(),ee=requireAnObject(),ne=requireToPropertyKey(),re=requireObjectDefineProperty(),le=requireFails(),Q=le(function(){Reflect.defineProperty(re.f({},1,{value:1}),1,{value:2})});return Y({target:"Reflect",stat:!0,forced:Q,sham:!K},{defineProperty:function(U,Z,ae){ee(U);var he=ne(Z);ee(ae);try{return re.f(U,he,ae),!0}catch{return!1}}}),es_reflect_defineProperty}var es_reflect_deleteProperty={},hasRequiredEs_reflect_deleteProperty;function requireEs_reflect_deleteProperty(){if(hasRequiredEs_reflect_deleteProperty)return es_reflect_deleteProperty;hasRequiredEs_reflect_deleteProperty=1;var Y=require_export(),K=requireAnObject(),ee=requireObjectGetOwnPropertyDescriptor().f;return Y({target:"Reflect",stat:!0},{deleteProperty:function(re,le){var Q=ee(K(re),le);return Q&&!Q.configurable?!1:delete re[le]}}),es_reflect_deleteProperty}var es_reflect_get={},isDataDescriptor,hasRequiredIsDataDescriptor;function requireIsDataDescriptor(){if(hasRequiredIsDataDescriptor)return isDataDescriptor;hasRequiredIsDataDescriptor=1;var Y=requireHasOwnProperty();return isDataDescriptor=function(K){return K!==void 0&&(Y(K,"value")||Y(K,"writable"))},isDataDescriptor}var hasRequiredEs_reflect_get;function requireEs_reflect_get(){if(hasRequiredEs_reflect_get)return es_reflect_get;hasRequiredEs_reflect_get=1;var Y=require_export(),K=requireFunctionCall(),ee=requireIsObject$1(),ne=requireAnObject(),re=requireIsDataDescriptor(),le=requireObjectGetOwnPropertyDescriptor(),Q=requireObjectGetPrototypeOf();function R(U,Z){var ae=arguments.length<3?U:arguments[2],he,pe;if(ne(U)===ae)return U[Z];if(he=le.f(U,Z),he)return re(he)?he.value:he.get===void 0?void 0:K(he.get,ae);if(ee(pe=Q(U)))return R(pe,Z,ae)}return Y({target:"Reflect",stat:!0},{get:R}),es_reflect_get}var es_reflect_getOwnPropertyDescriptor={},hasRequiredEs_reflect_getOwnPropertyDescriptor;function requireEs_reflect_getOwnPropertyDescriptor(){if(hasRequiredEs_reflect_getOwnPropertyDescriptor)return es_reflect_getOwnPropertyDescriptor;hasRequiredEs_reflect_getOwnPropertyDescriptor=1;var Y=require_export(),K=requireDescriptors(),ee=requireAnObject(),ne=requireObjectGetOwnPropertyDescriptor();return Y({target:"Reflect",stat:!0,sham:!K},{getOwnPropertyDescriptor:function(le,Q){return ne.f(ee(le),Q)}}),es_reflect_getOwnPropertyDescriptor}var es_reflect_getPrototypeOf={},hasRequiredEs_reflect_getPrototypeOf;function requireEs_reflect_getPrototypeOf(){if(hasRequiredEs_reflect_getPrototypeOf)return es_reflect_getPrototypeOf;hasRequiredEs_reflect_getPrototypeOf=1;var Y=require_export(),K=requireAnObject(),ee=requireObjectGetPrototypeOf(),ne=requireCorrectPrototypeGetter();return Y({target:"Reflect",stat:!0,sham:!ne},{getPrototypeOf:function(le){return ee(K(le))}}),es_reflect_getPrototypeOf}var es_reflect_has={},hasRequiredEs_reflect_has;function requireEs_reflect_has(){if(hasRequiredEs_reflect_has)return es_reflect_has;hasRequiredEs_reflect_has=1;var Y=require_export();return Y({target:"Reflect",stat:!0},{has:function(ee,ne){return ne in ee}}),es_reflect_has}var es_reflect_isExtensible={},hasRequiredEs_reflect_isExtensible;function requireEs_reflect_isExtensible(){if(hasRequiredEs_reflect_isExtensible)return es_reflect_isExtensible;hasRequiredEs_reflect_isExtensible=1;var Y=require_export(),K=requireAnObject(),ee=requireObjectIsExtensible();return Y({target:"Reflect",stat:!0},{isExtensible:function(re){return K(re),ee(re)}}),es_reflect_isExtensible}var es_reflect_ownKeys={},hasRequiredEs_reflect_ownKeys;function requireEs_reflect_ownKeys(){if(hasRequiredEs_reflect_ownKeys)return es_reflect_ownKeys;hasRequiredEs_reflect_ownKeys=1;var Y=require_export(),K=requireOwnKeys();return Y({target:"Reflect",stat:!0},{ownKeys:K}),es_reflect_ownKeys}var es_reflect_preventExtensions={},hasRequiredEs_reflect_preventExtensions;function requireEs_reflect_preventExtensions(){if(hasRequiredEs_reflect_preventExtensions)return es_reflect_preventExtensions;hasRequiredEs_reflect_preventExtensions=1;var Y=require_export(),K=requireGetBuiltIn(),ee=requireAnObject(),ne=requireFreezing();return Y({target:"Reflect",stat:!0,sham:!ne},{preventExtensions:function(le){ee(le);try{var Q=K("Object","preventExtensions");return Q&&Q(le),!0}catch{return!1}}}),es_reflect_preventExtensions}var es_reflect_set={},hasRequiredEs_reflect_set;function requireEs_reflect_set(){if(hasRequiredEs_reflect_set)return es_reflect_set;hasRequiredEs_reflect_set=1;var Y=require_export(),K=requireFunctionCall(),ee=requireAnObject(),ne=requireIsObject$1(),re=requireIsDataDescriptor(),le=requireFails(),Q=requireObjectDefineProperty(),R=requireObjectGetOwnPropertyDescriptor(),U=requireObjectGetPrototypeOf(),Z=requireCreatePropertyDescriptor();function ae(pe,me,ve){var Re=arguments.length<4?pe:arguments[3],Me=R.f(ee(pe),me),Te,Ce,We;if(!Me){if(ne(Ce=U(pe)))return ae(Ce,me,ve,Re);Me=Z(0)}if(re(Me)){if(Me.writable===!1||!ne(Re))return!1;if(Te=R.f(Re,me)){if(Te.get||Te.set||Te.writable===!1)return!1;Te.value=ve,Q.f(Re,me,Te)}else Q.f(Re,me,Z(0,ve))}else{if(We=Me.set,We===void 0)return!1;K(We,Re,ve)}return!0}var he=le(function(){var pe=function(){},me=Q.f(new pe,"a",{configurable:!0});return Reflect.set(pe.prototype,"a",1,me)!==!1});return Y({target:"Reflect",stat:!0,forced:he},{set:ae}),es_reflect_set}var es_reflect_setPrototypeOf={},hasRequiredEs_reflect_setPrototypeOf;function requireEs_reflect_setPrototypeOf(){if(hasRequiredEs_reflect_setPrototypeOf)return es_reflect_setPrototypeOf;hasRequiredEs_reflect_setPrototypeOf=1;var Y=require_export(),K=requireAnObject(),ee=requireAPossiblePrototype(),ne=requireObjectSetPrototypeOf();return ne&&Y({target:"Reflect",stat:!0},{setPrototypeOf:function(le,Q){K(le),ee(Q);try{return ne(le,Q),!0}catch{return!1}}}),es_reflect_setPrototypeOf}var es_reflect_toStringTag={},hasRequiredEs_reflect_toStringTag;function requireEs_reflect_toStringTag(){if(hasRequiredEs_reflect_toStringTag)return es_reflect_toStringTag;hasRequiredEs_reflect_toStringTag=1;var Y=require_export(),K=requireGlobalThis(),ee=requireSetToStringTag();return Y({global:!0},{Reflect:{}}),ee(K.Reflect,"Reflect",!0),es_reflect_toStringTag}var es_regexp_constructor={},isRegexp,hasRequiredIsRegexp;function requireIsRegexp(){if(hasRequiredIsRegexp)return isRegexp;hasRequiredIsRegexp=1;var Y=requireIsObject$1(),K=requireClassofRaw(),ee=requireWellKnownSymbol(),ne=ee("match");return isRegexp=function(re){var le;return Y(re)&&((le=re[ne])!==void 0?!!le:K(re)==="RegExp")},isRegexp}var regexpFlagsDetection,hasRequiredRegexpFlagsDetection;function requireRegexpFlagsDetection(){if(hasRequiredRegexpFlagsDetection)return regexpFlagsDetection;hasRequiredRegexpFlagsDetection=1;var Y=requireGlobalThis(),K=requireFails(),ee=Y.RegExp,ne=!K(function(){var re=!0;try{ee(".","d")}catch{re=!1}var le={},Q="",R=re?"dgimsy":"gimsy",U=function(pe,me){Object.defineProperty(le,pe,{get:function(){return Q+=me,!0}})},Z={dotAll:"s",global:"g",ignoreCase:"i",multiline:"m",sticky:"y"};re&&(Z.hasIndices="d");for(var ae in Z)U(ae,Z[ae]);var he=Object.getOwnPropertyDescriptor(ee.prototype,"flags").get.call(le);return he!==R||Q!==R});return regexpFlagsDetection={correct:ne},regexpFlagsDetection}var regexpFlags,hasRequiredRegexpFlags;function requireRegexpFlags(){if(hasRequiredRegexpFlags)return regexpFlags;hasRequiredRegexpFlags=1;var Y=requireAnObject();return regexpFlags=function(){var K=Y(this),ee="";return K.hasIndices&&(ee+="d"),K.global&&(ee+="g"),K.ignoreCase&&(ee+="i"),K.multiline&&(ee+="m"),K.dotAll&&(ee+="s"),K.unicode&&(ee+="u"),K.unicodeSets&&(ee+="v"),K.sticky&&(ee+="y"),ee},regexpFlags}var regexpGetFlags,hasRequiredRegexpGetFlags;function requireRegexpGetFlags(){if(hasRequiredRegexpGetFlags)return regexpGetFlags;hasRequiredRegexpGetFlags=1;var Y=requireFunctionCall(),K=requireHasOwnProperty(),ee=requireObjectIsPrototypeOf(),ne=requireRegexpFlagsDetection(),re=requireRegexpFlags(),le=RegExp.prototype;return regexpGetFlags=ne.correct?function(Q){return Q.flags}:function(Q){return!ne.correct&&ee(le,Q)&&!K(Q,"flags")?Y(re,Q):Q.flags},regexpGetFlags}var regexpStickyHelpers,hasRequiredRegexpStickyHelpers;function requireRegexpStickyHelpers(){if(hasRequiredRegexpStickyHelpers)return regexpStickyHelpers;hasRequiredRegexpStickyHelpers=1;var Y=requireFails(),K=requireGlobalThis(),ee=K.RegExp,ne=Y(function(){var Q=ee("a","y");return Q.lastIndex=2,Q.exec("abcd")!==null}),re=ne||Y(function(){return!ee("a","y").sticky}),le=ne||Y(function(){var Q=ee("^r","gy");return Q.lastIndex=2,Q.exec("str")!==null});return regexpStickyHelpers={BROKEN_CARET:le,MISSED_STICKY:re,UNSUPPORTED_Y:ne},regexpStickyHelpers}var regexpUnsupportedDotAll,hasRequiredRegexpUnsupportedDotAll;function requireRegexpUnsupportedDotAll(){if(hasRequiredRegexpUnsupportedDotAll)return regexpUnsupportedDotAll;hasRequiredRegexpUnsupportedDotAll=1;var Y=requireFails(),K=requireGlobalThis(),ee=K.RegExp;return regexpUnsupportedDotAll=Y(function(){var ne=ee(".","s");return!(ne.dotAll&&ne.test(`
`)&&ne.flags==="s")}),regexpUnsupportedDotAll}var regexpUnsupportedNcg,hasRequiredRegexpUnsupportedNcg;function requireRegexpUnsupportedNcg(){if(hasRequiredRegexpUnsupportedNcg)return regexpUnsupportedNcg;hasRequiredRegexpUnsupportedNcg=1;var Y=requireFails(),K=requireGlobalThis(),ee=K.RegExp;return regexpUnsupportedNcg=Y(function(){var ne=ee("(?<a>b)","g");return ne.exec("b").groups.a!=="b"||"b".replace(ne,"$<a>c")!=="bc"}),regexpUnsupportedNcg}var hasRequiredEs_regexp_constructor;function requireEs_regexp_constructor(){if(hasRequiredEs_regexp_constructor)return es_regexp_constructor;hasRequiredEs_regexp_constructor=1;var Y=requireDescriptors(),K=requireGlobalThis(),ee=requireFunctionUncurryThis(),ne=requireIsForced(),re=requireInheritIfRequired(),le=requireCreateNonEnumerableProperty(),Q=requireObjectCreate(),R=requireObjectGetOwnPropertyNames().f,U=requireObjectIsPrototypeOf(),Z=requireIsRegexp(),ae=requireToString$1(),he=requireRegexpGetFlags(),pe=requireRegexpStickyHelpers(),me=requireProxyAccessor(),ve=requireDefineBuiltIn(),Re=requireFails(),Me=requireHasOwnProperty(),Te=requireInternalState().enforce,Ce=requireSetSpecies(),We=requireWellKnownSymbol(),Fe=requireRegexpUnsupportedDotAll(),ke=requireRegexpUnsupportedNcg(),Ze=We("match"),Je=K.RegExp,Qe=Je.prototype,it=K.SyntaxError,lt=ee(Qe.exec),dt=ee("".charAt),yt=ee("".replace),gt=ee("".indexOf),qt=ee("".slice),Ft=/^\?<[^\s\d!#%&*+<=>@^][^\s!#%&*+<=>@^]*>/,Gt=/a/g,ft=/a/g,Rt=new Je(Gt)!==Gt,pt=pe.MISSED_STICKY,At=pe.UNSUPPORTED_Y,It=Y&&(!Rt||pt||Fe||ke||Re(function(){return ft[Ze]=!1,Je(Gt)!==Gt||Je(ft)===ft||String(Je(Gt,"i"))!=="/a/i"})),Dt=function(Sr){for(var Qt=Sr.length,or=0,Ir="",Rr=!1,Cr;or<=Qt;or++){if(Cr=dt(Sr,or),Cr==="\\"){Ir+=Cr+dt(Sr,++or);continue}!Rr&&Cr==="."?Ir+="[\\s\\S]":(Cr==="["?Rr=!0:Cr==="]"&&(Rr=!1),Ir+=Cr)}return Ir},Zt=function(Sr){for(var Qt=Sr.length,or=0,Ir="",Rr=[],Cr=Q(null),wr=!1,Wr=!1,Kr=0,Hr="",br;or<=Qt;or++){if(br=dt(Sr,or),br==="\\")br+=dt(Sr,++or);else if(br==="]")wr=!1;else if(!wr)switch(!0){case br==="[":wr=!0;break;case br==="(":if(Ir+=br,qt(Sr,or+1,or+3)==="?:")continue;lt(Ft,qt(Sr,or+1))&&(or+=2,Wr=!0),Kr++;continue;case(br===">"&&Wr):if(Hr===""||Me(Cr,Hr))throw new it("Invalid capture group name");Cr[Hr]=!0,Rr[Rr.length]=[Hr,Kr],Wr=!1,Hr="";continue}Wr?Hr+=br:Ir+=br}return[Ir,Rr]};if(ne("RegExp",It)){for(var nr=function(Qt,or){var Ir=U(Qe,this),Rr=Z(Qt),Cr=or===void 0,wr=[],Wr=Qt,Kr,Hr,br,Lr,Br,zr;if(!Ir&&Rr&&Cr&&Qt.constructor===nr)return Qt;if((Rr||U(Qe,Qt))&&(Qt=Qt.source,Cr&&(or=he(Wr))),Qt=Qt===void 0?"":ae(Qt),or=or===void 0?"":ae(or),Wr=Qt,Fe&&"dotAll"in Gt&&(Hr=!!or&&gt(or,"s")>-1,Hr&&(or=yt(or,/s/g,""))),Kr=or,pt&&"sticky"in Gt&&(br=!!or&&gt(or,"y")>-1,br&&At&&(or=yt(or,/y/g,""))),ke&&(Lr=Zt(Qt),Qt=Lr[0],wr=Lr[1]),Br=re(Je(Qt,or),Ir?this:Qe,nr),(Hr||br||wr.length)&&(zr=Te(Br),Hr&&(zr.dotAll=!0,zr.raw=nr(Dt(Qt),Kr)),br&&(zr.sticky=!0),wr.length&&(zr.groups=wr)),Qt!==Wr)try{le(Br,"source",Wr===""?"(?:)":Wr)}catch{}return Br},Er=R(Je),vr=0;Er.length>vr;)me(nr,Je,Er[vr++]);Qe.constructor=nr,nr.prototype=Qe,ve(K,"RegExp",nr,{constructor:!0})}return Ce("RegExp"),es_regexp_constructor}var es_regexp_escape={},aString,hasRequiredAString;function requireAString(){if(hasRequiredAString)return aString;hasRequiredAString=1;var Y=TypeError;return aString=function(K){if(typeof K=="string")return K;throw new Y("Argument is not a string")},aString}var hasRequiredEs_regexp_escape;function requireEs_regexp_escape(){if(hasRequiredEs_regexp_escape)return es_regexp_escape;hasRequiredEs_regexp_escape=1;var Y=require_export(),K=requireFunctionUncurryThis(),ee=requireAString(),ne=requireHasOwnProperty(),re=requireStringPad().start,le=requireWhitespaces(),Q=Array,R=RegExp.escape,U=K("".charAt),Z=K("".charCodeAt),ae=K(1.1.toString),he=K([].join),pe=/^[0-9a-z]/i,me=/^[$()*+./?[\\\]^{|}]/,ve=RegExp("^[!\"#%&',\\-:;<=>@`~"+le+"]"),Re=K(pe.exec),Me={"	":"t","\n":"n","\v":"v","\f":"f","\r":"r"},Te=function(We){var Fe=ae(Z(We,0),16);return Fe.length<3?"\\x"+re(Fe,2,"0"):"\\u"+re(Fe,4,"0")},Ce=!R||R("ab")!=="\\x61b";return Y({target:"RegExp",stat:!0,forced:Ce},{escape:function(Fe){ee(Fe);for(var ke=Fe.length,Ze=Q(ke),Je=0;Je<ke;Je++){var Qe=U(Fe,Je);if(Je===0&&Re(pe,Qe))Ze[Je]=Te(Qe);else if(ne(Me,Qe))Ze[Je]="\\"+Me[Qe];else if(Re(me,Qe))Ze[Je]="\\"+Qe;else if(Re(ve,Qe))Ze[Je]=Te(Qe);else{var it=Z(Qe,0);(it&63488)!==55296?Ze[Je]=Qe:it>=56320||Je+1>=ke||(Z(Fe,Je+1)&64512)!==56320?Ze[Je]=Te(Qe):(Ze[Je]=Qe,Ze[++Je]=U(Fe,Je))}}return he(Ze,"")}}),es_regexp_escape}var es_regexp_dotAll={},hasRequiredEs_regexp_dotAll;function requireEs_regexp_dotAll(){if(hasRequiredEs_regexp_dotAll)return es_regexp_dotAll;hasRequiredEs_regexp_dotAll=1;var Y=requireDescriptors(),K=requireRegexpUnsupportedDotAll(),ee=requireClassofRaw(),ne=requireDefineBuiltInAccessor(),re=requireInternalState().get,le=RegExp.prototype,Q=TypeError;return Y&&K&&ne(le,"dotAll",{configurable:!0,get:function(){if(this!==le){if(ee(this)==="RegExp")return!!re(this).dotAll;throw new Q("Incompatible receiver, RegExp required")}}}),es_regexp_dotAll}var es_regexp_exec={},regexpExec,hasRequiredRegexpExec;function requireRegexpExec(){if(hasRequiredRegexpExec)return regexpExec;hasRequiredRegexpExec=1;var Y=requireFunctionCall(),K=requireFunctionUncurryThis(),ee=requireToString$1(),ne=requireRegexpFlags(),re=requireRegexpStickyHelpers(),le=requireShared(),Q=requireObjectCreate(),R=requireInternalState().get,U=requireRegexpUnsupportedDotAll(),Z=requireRegexpUnsupportedNcg(),ae=le("native-string-replace",String.prototype.replace),he=RegExp.prototype.exec,pe=he,me=K("".charAt),ve=K("".indexOf),Re=K("".replace),Me=K("".slice),Te=function(){var ke=/a/,Ze=/b*/g;return Y(he,ke,"a"),Y(he,Ze,"a"),ke.lastIndex!==0||Ze.lastIndex!==0}(),Ce=re.BROKEN_CARET,We=/()??/.exec("")[1]!==void 0,Fe=Te||We||Ce||U||Z;return Fe&&(pe=function(Ze){var Je=this,Qe=R(Je),it=ee(Ze),lt=Qe.raw,dt,yt,gt,qt,Ft,Gt,ft;if(lt)return lt.lastIndex=Je.lastIndex,dt=Y(pe,lt,it),Je.lastIndex=lt.lastIndex,dt;var Rt=Qe.groups,pt=Ce&&Je.sticky,At=Y(ne,Je),It=Je.source,Dt=0,Zt=it;if(pt&&(At=Re(At,"y",""),ve(At,"g")===-1&&(At+="g"),Zt=Me(it,Je.lastIndex),Je.lastIndex>0&&(!Je.multiline||Je.multiline&&me(it,Je.lastIndex-1)!==`
`)&&(It="(?: "+It+")",Zt=" "+Zt,Dt++),yt=new RegExp("^(?:"+It+")",At)),We&&(yt=new RegExp("^"+It+"$(?!\\s)",At)),Te&&(gt=Je.lastIndex),qt=Y(he,pt?yt:Je,Zt),pt?qt?(qt.input=Me(qt.input,Dt),qt[0]=Me(qt[0],Dt),qt.index=Je.lastIndex,Je.lastIndex+=qt[0].length):Je.lastIndex=0:Te&&qt&&(Je.lastIndex=Je.global?qt.index+qt[0].length:gt),We&&qt&&qt.length>1&&Y(ae,qt[0],yt,function(){for(Ft=1;Ft<arguments.length-2;Ft++)arguments[Ft]===void 0&&(qt[Ft]=void 0)}),qt&&Rt)for(qt.groups=Gt=Q(null),Ft=0;Ft<Rt.length;Ft++)ft=Rt[Ft],Gt[ft[0]]=qt[ft[1]];return qt}),regexpExec=pe,regexpExec}var hasRequiredEs_regexp_exec;function requireEs_regexp_exec(){if(hasRequiredEs_regexp_exec)return es_regexp_exec;hasRequiredEs_regexp_exec=1;var Y=require_export(),K=requireRegexpExec();return Y({target:"RegExp",proto:!0,forced:/./.exec!==K},{exec:K}),es_regexp_exec}var es_regexp_flags={},hasRequiredEs_regexp_flags;function requireEs_regexp_flags(){if(hasRequiredEs_regexp_flags)return es_regexp_flags;hasRequiredEs_regexp_flags=1;var Y=requireDescriptors(),K=requireDefineBuiltInAccessor(),ee=requireRegexpFlagsDetection(),ne=requireRegexpFlags();return Y&&!ee.correct&&(K(RegExp.prototype,"flags",{configurable:!0,get:ne}),ee.correct=!0),es_regexp_flags}var es_regexp_sticky={},hasRequiredEs_regexp_sticky;function requireEs_regexp_sticky(){if(hasRequiredEs_regexp_sticky)return es_regexp_sticky;hasRequiredEs_regexp_sticky=1;var Y=requireDescriptors(),K=requireRegexpStickyHelpers().MISSED_STICKY,ee=requireClassofRaw(),ne=requireDefineBuiltInAccessor(),re=requireInternalState().get,le=RegExp.prototype,Q=TypeError;return Y&&K&&ne(le,"sticky",{configurable:!0,get:function(){if(this!==le){if(ee(this)==="RegExp")return!!re(this).sticky;throw new Q("Incompatible receiver, RegExp required")}}}),es_regexp_sticky}var es_regexp_test={},hasRequiredEs_regexp_test;function requireEs_regexp_test(){if(hasRequiredEs_regexp_test)return es_regexp_test;hasRequiredEs_regexp_test=1,requireEs_regexp_exec();var Y=require_export(),K=requireFunctionCall(),ee=requireIsCallable(),ne=requireAnObject(),re=requireToString$1(),le=function(){var R=!1,U=/[ac]/;return U.exec=function(){return R=!0,/./.exec.apply(this,arguments)},U.test("abc")===!0&&R}(),Q=/./.test;return Y({target:"RegExp",proto:!0,forced:!le},{test:function(R){var U=ne(this),Z=re(R),ae=U.exec;if(!ee(ae))return K(Q,U,Z);var he=K(ae,U,Z);return he===null?!1:(ne(he),!0)}}),es_regexp_test}var es_regexp_toString={},hasRequiredEs_regexp_toString;function requireEs_regexp_toString(){if(hasRequiredEs_regexp_toString)return es_regexp_toString;hasRequiredEs_regexp_toString=1;var Y=requireFunctionName().PROPER,K=requireDefineBuiltIn(),ee=requireAnObject(),ne=requireToString$1(),re=requireFails(),le=requireRegexpGetFlags(),Q="toString",R=RegExp.prototype,U=R[Q],Z=re(function(){return U.call({source:"a",flags:"b"})!=="/a/b"}),ae=Y&&U.name!==Q;return(Z||ae)&&K(R,Q,function(){var pe=ee(this),me=ne(pe.source),ve=ne(le(pe));return"/"+me+"/"+ve},{unsafe:!0}),es_regexp_toString}var es_set={},es_set_constructor={},hasRequiredEs_set_constructor;function requireEs_set_constructor(){if(hasRequiredEs_set_constructor)return es_set_constructor;hasRequiredEs_set_constructor=1;var Y=requireCollection(),K=requireCollectionStrong();return Y("Set",function(ee){return function(){return ee(this,arguments.length?arguments[0]:void 0)}},K),es_set_constructor}var hasRequiredEs_set;function requireEs_set(){return hasRequiredEs_set||(hasRequiredEs_set=1,requireEs_set_constructor()),es_set}var es_set_difference_v2={},setHelpers,hasRequiredSetHelpers;function requireSetHelpers(){if(hasRequiredSetHelpers)return setHelpers;hasRequiredSetHelpers=1;var Y=requireFunctionUncurryThis(),K=Set.prototype;return setHelpers={Set,add:Y(K.add),has:Y(K.has),remove:Y(K.delete),proto:K},setHelpers}var aSet,hasRequiredASet;function requireASet(){if(hasRequiredASet)return aSet;hasRequiredASet=1;var Y=requireSetHelpers().has;return aSet=function(K){return Y(K),K},aSet}var iterateSimple,hasRequiredIterateSimple;function requireIterateSimple(){if(hasRequiredIterateSimple)return iterateSimple;hasRequiredIterateSimple=1;var Y=requireFunctionCall();return iterateSimple=function(K,ee,ne){for(var re=ne?K:K.iterator,le=K.next,Q,R;!(Q=Y(le,re)).done;)if(R=ee(Q.value),R!==void 0)return R},iterateSimple}var setIterate,hasRequiredSetIterate;function requireSetIterate(){if(hasRequiredSetIterate)return setIterate;hasRequiredSetIterate=1;var Y=requireFunctionUncurryThis(),K=requireIterateSimple(),ee=requireSetHelpers(),ne=ee.Set,re=ee.proto,le=Y(re.forEach),Q=Y(re.keys),R=Q(new ne).next;return setIterate=function(U,Z,ae){return ae?K({iterator:Q(U),next:R},Z):le(U,Z)},setIterate}var setClone,hasRequiredSetClone;function requireSetClone(){if(hasRequiredSetClone)return setClone;hasRequiredSetClone=1;var Y=requireSetHelpers(),K=requireSetIterate(),ee=Y.Set,ne=Y.add;return setClone=function(re){var le=new ee;return K(re,function(Q){ne(le,Q)}),le},setClone}var setSize,hasRequiredSetSize;function requireSetSize(){if(hasRequiredSetSize)return setSize;hasRequiredSetSize=1;var Y=requireFunctionUncurryThisAccessor(),K=requireSetHelpers();return setSize=Y(K.proto,"size","get")||function(ee){return ee.size},setSize}var getSetRecord,hasRequiredGetSetRecord;function requireGetSetRecord(){if(hasRequiredGetSetRecord)return getSetRecord;hasRequiredGetSetRecord=1;var Y=requireACallable(),K=requireAnObject(),ee=requireFunctionCall(),ne=requireToIntegerOrInfinity(),re=requireGetIteratorDirect(),le="Invalid size",Q=RangeError,R=TypeError,U=Math.max,Z=function(ae,he){this.set=ae,this.size=U(he,0),this.has=Y(ae.has),this.keys=Y(ae.keys)};return Z.prototype={getIterator:function(){return re(K(ee(this.keys,this.set)))},includes:function(ae){return ee(this.has,this.set,ae)}},getSetRecord=function(ae){K(ae);var he=+ae.size;if(he!==he)throw new R(le);var pe=ne(he);if(pe<0)throw new Q(le);return new Z(ae,pe)},getSetRecord}var setDifference,hasRequiredSetDifference;function requireSetDifference(){if(hasRequiredSetDifference)return setDifference;hasRequiredSetDifference=1;var Y=requireASet(),K=requireSetHelpers(),ee=requireSetClone(),ne=requireSetSize(),re=requireGetSetRecord(),le=requireSetIterate(),Q=requireIterateSimple(),R=K.has,U=K.remove;return setDifference=function(ae){var he=Y(this),pe=re(ae),me=ee(he);return ne(he)<=pe.size?le(he,function(ve){pe.includes(ve)&&U(me,ve)}):Q(pe.getIterator(),function(ve){R(me,ve)&&U(me,ve)}),me},setDifference}var setMethodAcceptSetLike,hasRequiredSetMethodAcceptSetLike;function requireSetMethodAcceptSetLike(){if(hasRequiredSetMethodAcceptSetLike)return setMethodAcceptSetLike;hasRequiredSetMethodAcceptSetLike=1;var Y=requireGetBuiltIn(),K=function(ne){return{size:ne,has:function(){return!1},keys:function(){return{next:function(){return{done:!0}}}}}},ee=function(ne){return{size:ne,has:function(){return!0},keys:function(){throw new Error("e")}}};return setMethodAcceptSetLike=function(ne,re){var le=Y("Set");try{new le()[ne](K(0));try{return new le()[ne](K(-1)),!1}catch{if(!re)return!0;try{return new le()[ne](ee(-1/0)),!1}catch{var Q=new le;return Q.add(1),Q.add(2),re(Q[ne](ee(1/0)))}}}catch{return!1}},setMethodAcceptSetLike}var hasRequiredEs_set_difference_v2;function requireEs_set_difference_v2(){if(hasRequiredEs_set_difference_v2)return es_set_difference_v2;hasRequiredEs_set_difference_v2=1;var Y=require_export(),K=requireSetDifference(),ee=requireFails(),ne=requireSetMethodAcceptSetLike(),re=!ne("difference",function(Q){return Q.size===0}),le=re||ee(function(){var Q={size:1,has:function(){return!0},keys:function(){var U=0;return{next:function(){var Z=U++>1;return R.has(1)&&R.clear(),{done:Z,value:2}}}}},R=new Set([1,2,3,4]);return R.difference(Q).size!==3});return Y({target:"Set",proto:!0,real:!0,forced:le},{difference:K}),es_set_difference_v2}var es_set_intersection_v2={},setIntersection,hasRequiredSetIntersection;function requireSetIntersection(){if(hasRequiredSetIntersection)return setIntersection;hasRequiredSetIntersection=1;var Y=requireASet(),K=requireSetHelpers(),ee=requireSetSize(),ne=requireGetSetRecord(),re=requireSetIterate(),le=requireIterateSimple(),Q=K.Set,R=K.add,U=K.has;return setIntersection=function(ae){var he=Y(this),pe=ne(ae),me=new Q;return ee(he)>pe.size?le(pe.getIterator(),function(ve){U(he,ve)&&R(me,ve)}):re(he,function(ve){pe.includes(ve)&&R(me,ve)}),me},setIntersection}var hasRequiredEs_set_intersection_v2;function requireEs_set_intersection_v2(){if(hasRequiredEs_set_intersection_v2)return es_set_intersection_v2;hasRequiredEs_set_intersection_v2=1;var Y=require_export(),K=requireFails(),ee=requireSetIntersection(),ne=requireSetMethodAcceptSetLike(),re=!ne("intersection",function(le){return le.size===2&&le.has(1)&&le.has(2)})||K(function(){return String(Array.from(new Set([1,2,3]).intersection(new Set([3,2]))))!=="3,2"});return Y({target:"Set",proto:!0,real:!0,forced:re},{intersection:ee}),es_set_intersection_v2}var es_set_isDisjointFrom_v2={},setIsDisjointFrom,hasRequiredSetIsDisjointFrom;function requireSetIsDisjointFrom(){if(hasRequiredSetIsDisjointFrom)return setIsDisjointFrom;hasRequiredSetIsDisjointFrom=1;var Y=requireASet(),K=requireSetHelpers().has,ee=requireSetSize(),ne=requireGetSetRecord(),re=requireSetIterate(),le=requireIterateSimple(),Q=requireIteratorClose();return setIsDisjointFrom=function(U){var Z=Y(this),ae=ne(U);if(ee(Z)<=ae.size)return re(Z,function(pe){if(ae.includes(pe))return!1},!0)!==!1;var he=ae.getIterator();return le(he,function(pe){if(K(Z,pe))return Q(he,"normal",!1)})!==!1},setIsDisjointFrom}var hasRequiredEs_set_isDisjointFrom_v2;function requireEs_set_isDisjointFrom_v2(){if(hasRequiredEs_set_isDisjointFrom_v2)return es_set_isDisjointFrom_v2;hasRequiredEs_set_isDisjointFrom_v2=1;var Y=require_export(),K=requireSetIsDisjointFrom(),ee=requireSetMethodAcceptSetLike(),ne=!ee("isDisjointFrom",function(re){return!re});return Y({target:"Set",proto:!0,real:!0,forced:ne},{isDisjointFrom:K}),es_set_isDisjointFrom_v2}var es_set_isSubsetOf_v2={},setIsSubsetOf,hasRequiredSetIsSubsetOf;function requireSetIsSubsetOf(){if(hasRequiredSetIsSubsetOf)return setIsSubsetOf;hasRequiredSetIsSubsetOf=1;var Y=requireASet(),K=requireSetSize(),ee=requireSetIterate(),ne=requireGetSetRecord();return setIsSubsetOf=function(le){var Q=Y(this),R=ne(le);return K(Q)>R.size?!1:ee(Q,function(U){if(!R.includes(U))return!1},!0)!==!1},setIsSubsetOf}var hasRequiredEs_set_isSubsetOf_v2;function requireEs_set_isSubsetOf_v2(){if(hasRequiredEs_set_isSubsetOf_v2)return es_set_isSubsetOf_v2;hasRequiredEs_set_isSubsetOf_v2=1;var Y=require_export(),K=requireSetIsSubsetOf(),ee=requireSetMethodAcceptSetLike(),ne=!ee("isSubsetOf",function(re){return re});return Y({target:"Set",proto:!0,real:!0,forced:ne},{isSubsetOf:K}),es_set_isSubsetOf_v2}var es_set_isSupersetOf_v2={},setIsSupersetOf,hasRequiredSetIsSupersetOf;function requireSetIsSupersetOf(){if(hasRequiredSetIsSupersetOf)return setIsSupersetOf;hasRequiredSetIsSupersetOf=1;var Y=requireASet(),K=requireSetHelpers().has,ee=requireSetSize(),ne=requireGetSetRecord(),re=requireIterateSimple(),le=requireIteratorClose();return setIsSupersetOf=function(R){var U=Y(this),Z=ne(R);if(ee(U)<Z.size)return!1;var ae=Z.getIterator();return re(ae,function(he){if(!K(U,he))return le(ae,"normal",!1)})!==!1},setIsSupersetOf}var hasRequiredEs_set_isSupersetOf_v2;function requireEs_set_isSupersetOf_v2(){if(hasRequiredEs_set_isSupersetOf_v2)return es_set_isSupersetOf_v2;hasRequiredEs_set_isSupersetOf_v2=1;var Y=require_export(),K=requireSetIsSupersetOf(),ee=requireSetMethodAcceptSetLike(),ne=!ee("isSupersetOf",function(re){return!re});return Y({target:"Set",proto:!0,real:!0,forced:ne},{isSupersetOf:K}),es_set_isSupersetOf_v2}var es_set_symmetricDifference_v2={},setSymmetricDifference,hasRequiredSetSymmetricDifference;function requireSetSymmetricDifference(){if(hasRequiredSetSymmetricDifference)return setSymmetricDifference;hasRequiredSetSymmetricDifference=1;var Y=requireASet(),K=requireSetHelpers(),ee=requireSetClone(),ne=requireGetSetRecord(),re=requireIterateSimple(),le=K.add,Q=K.has,R=K.remove;return setSymmetricDifference=function(Z){var ae=Y(this),he=ne(Z).getIterator(),pe=ee(ae);return re(he,function(me){Q(ae,me)?R(pe,me):le(pe,me)}),pe},setSymmetricDifference}var setMethodGetKeysBeforeCloningDetection,hasRequiredSetMethodGetKeysBeforeCloningDetection;function requireSetMethodGetKeysBeforeCloningDetection(){return hasRequiredSetMethodGetKeysBeforeCloningDetection||(hasRequiredSetMethodGetKeysBeforeCloningDetection=1,setMethodGetKeysBeforeCloningDetection=function(Y){try{var K=new Set,ee={size:0,has:function(){return!0},keys:function(){return Object.defineProperty({},"next",{get:function(){return K.clear(),K.add(4),function(){return{done:!0}}}})}},ne=K[Y](ee);return ne.size===1&&ne.values().next().value===4}catch{return!1}}),setMethodGetKeysBeforeCloningDetection}var hasRequiredEs_set_symmetricDifference_v2;function requireEs_set_symmetricDifference_v2(){if(hasRequiredEs_set_symmetricDifference_v2)return es_set_symmetricDifference_v2;hasRequiredEs_set_symmetricDifference_v2=1;var Y=require_export(),K=requireSetSymmetricDifference(),ee=requireSetMethodGetKeysBeforeCloningDetection(),ne=requireSetMethodAcceptSetLike(),re=!ne("symmetricDifference")||!ee("symmetricDifference");return Y({target:"Set",proto:!0,real:!0,forced:re},{symmetricDifference:K}),es_set_symmetricDifference_v2}var es_set_union_v2={},setUnion,hasRequiredSetUnion;function requireSetUnion(){if(hasRequiredSetUnion)return setUnion;hasRequiredSetUnion=1;var Y=requireASet(),K=requireSetHelpers().add,ee=requireSetClone(),ne=requireGetSetRecord(),re=requireIterateSimple();return setUnion=function(Q){var R=Y(this),U=ne(Q).getIterator(),Z=ee(R);return re(U,function(ae){K(Z,ae)}),Z},setUnion}var hasRequiredEs_set_union_v2;function requireEs_set_union_v2(){if(hasRequiredEs_set_union_v2)return es_set_union_v2;hasRequiredEs_set_union_v2=1;var Y=require_export(),K=requireSetUnion(),ee=requireSetMethodGetKeysBeforeCloningDetection(),ne=requireSetMethodAcceptSetLike(),re=!ne("union")||!ee("union");return Y({target:"Set",proto:!0,real:!0,forced:re},{union:K}),es_set_union_v2}var es_string_atAlternative={},hasRequiredEs_string_atAlternative;function requireEs_string_atAlternative(){if(hasRequiredEs_string_atAlternative)return es_string_atAlternative;hasRequiredEs_string_atAlternative=1;var Y=require_export(),K=requireFunctionUncurryThis(),ee=requireRequireObjectCoercible(),ne=requireToIntegerOrInfinity(),re=requireToString$1(),le=requireFails(),Q=K("".charAt),R=le(function(){return"𠮷".at(-2)!=="\uD842"});return Y({target:"String",proto:!0,forced:R},{at:function(Z){var ae=re(ee(this)),he=ae.length,pe=ne(Z),me=pe>=0?pe:he+pe;return me<0||me>=he?void 0:Q(ae,me)}}),es_string_atAlternative}var es_string_codePointAt={},stringMultibyte,hasRequiredStringMultibyte;function requireStringMultibyte(){if(hasRequiredStringMultibyte)return stringMultibyte;hasRequiredStringMultibyte=1;var Y=requireFunctionUncurryThis(),K=requireToIntegerOrInfinity(),ee=requireToString$1(),ne=requireRequireObjectCoercible(),re=Y("".charAt),le=Y("".charCodeAt),Q=Y("".slice),R=function(U){return function(Z,ae){var he=ee(ne(Z)),pe=K(ae),me=he.length,ve,Re;return pe<0||pe>=me?U?"":void 0:(ve=le(he,pe),ve<55296||ve>56319||pe+1===me||(Re=le(he,pe+1))<56320||Re>57343?U?re(he,pe):ve:U?Q(he,pe,pe+2):(ve-55296<<10)+(Re-56320)+65536)}};return stringMultibyte={codeAt:R(!1),charAt:R(!0)},stringMultibyte}var hasRequiredEs_string_codePointAt;function requireEs_string_codePointAt(){if(hasRequiredEs_string_codePointAt)return es_string_codePointAt;hasRequiredEs_string_codePointAt=1;var Y=require_export(),K=requireStringMultibyte().codeAt;return Y({target:"String",proto:!0},{codePointAt:function(ne){return K(this,ne)}}),es_string_codePointAt}var es_string_endsWith={},notARegexp,hasRequiredNotARegexp;function requireNotARegexp(){if(hasRequiredNotARegexp)return notARegexp;hasRequiredNotARegexp=1;var Y=requireIsRegexp(),K=TypeError;return notARegexp=function(ee){if(Y(ee))throw new K("The method doesn't accept regular expressions");return ee},notARegexp}var correctIsRegexpLogic,hasRequiredCorrectIsRegexpLogic;function requireCorrectIsRegexpLogic(){if(hasRequiredCorrectIsRegexpLogic)return correctIsRegexpLogic;hasRequiredCorrectIsRegexpLogic=1;var Y=requireWellKnownSymbol(),K=Y("match");return correctIsRegexpLogic=function(ee){var ne=/./;try{"/./"[ee](ne)}catch{try{return ne[K]=!1,"/./"[ee](ne)}catch{}}return!1},correctIsRegexpLogic}var hasRequiredEs_string_endsWith;function requireEs_string_endsWith(){if(hasRequiredEs_string_endsWith)return es_string_endsWith;hasRequiredEs_string_endsWith=1;var Y=require_export(),K=requireFunctionUncurryThisClause(),ee=requireObjectGetOwnPropertyDescriptor().f,ne=requireToLength(),re=requireToString$1(),le=requireNotARegexp(),Q=requireRequireObjectCoercible(),R=requireCorrectIsRegexpLogic(),U=requireIsPure(),Z=K("".slice),ae=Math.min,he=R("endsWith"),pe=!U&&!he&&!!function(){var me=ee(String.prototype,"endsWith");return me&&!me.writable}();return Y({target:"String",proto:!0,forced:!pe&&!he},{endsWith:function(ve){var Re=re(Q(this));le(ve);var Me=arguments.length>1?arguments[1]:void 0,Te=Re.length,Ce=Me===void 0?Te:ae(ne(Me),Te),We=re(ve);return Z(Re,Ce-We.length,Ce)===We}}),es_string_endsWith}var es_string_fromCodePoint={},hasRequiredEs_string_fromCodePoint;function requireEs_string_fromCodePoint(){if(hasRequiredEs_string_fromCodePoint)return es_string_fromCodePoint;hasRequiredEs_string_fromCodePoint=1;var Y=require_export(),K=requireFunctionUncurryThis(),ee=requireToAbsoluteIndex(),ne=RangeError,re=String.fromCharCode,le=String.fromCodePoint,Q=K([].join),R=!!le&&le.length!==1;return Y({target:"String",stat:!0,arity:1,forced:R},{fromCodePoint:function(Z){for(var ae=[],he=arguments.length,pe=0,me;he>pe;){if(me=+arguments[pe++],ee(me,1114111)!==me)throw new ne(me+" is not a valid code point");ae[pe]=me<65536?re(me):re(((me-=65536)>>10)+55296,me%1024+56320)}return Q(ae,"")}}),es_string_fromCodePoint}var es_string_includes={},hasRequiredEs_string_includes;function requireEs_string_includes(){if(hasRequiredEs_string_includes)return es_string_includes;hasRequiredEs_string_includes=1;var Y=require_export(),K=requireFunctionUncurryThis(),ee=requireNotARegexp(),ne=requireRequireObjectCoercible(),re=requireToString$1(),le=requireCorrectIsRegexpLogic(),Q=K("".indexOf);return Y({target:"String",proto:!0,forced:!le("includes")},{includes:function(U){return!!~Q(re(ne(this)),re(ee(U)),arguments.length>1?arguments[1]:void 0)}}),es_string_includes}var es_string_isWellFormed={},hasRequiredEs_string_isWellFormed;function requireEs_string_isWellFormed(){if(hasRequiredEs_string_isWellFormed)return es_string_isWellFormed;hasRequiredEs_string_isWellFormed=1;var Y=require_export(),K=requireFunctionUncurryThis(),ee=requireRequireObjectCoercible(),ne=requireToString$1(),re=K("".charCodeAt);return Y({target:"String",proto:!0},{isWellFormed:function(){for(var Q=ne(ee(this)),R=Q.length,U=0;U<R;U++){var Z=re(Q,U);if((Z&63488)===55296&&(Z>=56320||++U>=R||(re(Q,U)&64512)!==56320))return!1}return!0}}),es_string_isWellFormed}var es_string_iterator={},hasRequiredEs_string_iterator;function requireEs_string_iterator(){if(hasRequiredEs_string_iterator)return es_string_iterator;hasRequiredEs_string_iterator=1;var Y=requireStringMultibyte().charAt,K=requireToString$1(),ee=requireInternalState(),ne=requireIteratorDefine(),re=requireCreateIterResultObject(),le="String Iterator",Q=ee.set,R=ee.getterFor(le);return ne(String,"String",function(U){Q(this,{type:le,string:K(U),index:0})},function(){var Z=R(this),ae=Z.string,he=Z.index,pe;return he>=ae.length?re(void 0,!0):(pe=Y(ae,he),Z.index+=pe.length,re(pe,!1))}),es_string_iterator}var es_string_match={},fixRegexpWellKnownSymbolLogic,hasRequiredFixRegexpWellKnownSymbolLogic;function requireFixRegexpWellKnownSymbolLogic(){if(hasRequiredFixRegexpWellKnownSymbolLogic)return fixRegexpWellKnownSymbolLogic;hasRequiredFixRegexpWellKnownSymbolLogic=1,requireEs_regexp_exec();var Y=requireFunctionCall(),K=requireDefineBuiltIn(),ee=requireRegexpExec(),ne=requireFails(),re=requireWellKnownSymbol(),le=requireCreateNonEnumerableProperty(),Q=re("species"),R=RegExp.prototype;return fixRegexpWellKnownSymbolLogic=function(U,Z,ae,he){var pe=re(U),me=!ne(function(){var Te={};return Te[pe]=function(){return 7},""[U](Te)!==7}),ve=me&&!ne(function(){var Te=!1,Ce=/a/;return U==="split"&&(Ce={},Ce.constructor={},Ce.constructor[Q]=function(){return Ce},Ce.flags="",Ce[pe]=/./[pe]),Ce.exec=function(){return Te=!0,null},Ce[pe](""),!Te});if(!me||!ve||ae){var Re=/./[pe],Me=Z(pe,""[U],function(Te,Ce,We,Fe,ke){var Ze=Ce.exec;return Ze===ee||Ze===R.exec?me&&!ke?{done:!0,value:Y(Re,Ce,We,Fe)}:{done:!0,value:Y(Te,We,Ce,Fe)}:{done:!1}});K(String.prototype,U,Me[0]),K(R,pe,Me[1])}he&&le(R[pe],"sham",!0)},fixRegexpWellKnownSymbolLogic}var advanceStringIndex,hasRequiredAdvanceStringIndex;function requireAdvanceStringIndex(){if(hasRequiredAdvanceStringIndex)return advanceStringIndex;hasRequiredAdvanceStringIndex=1;var Y=requireStringMultibyte().charAt;return advanceStringIndex=function(K,ee,ne){return ee+(ne?Y(K,ee).length:1)},advanceStringIndex}var regexpExecAbstract,hasRequiredRegexpExecAbstract;function requireRegexpExecAbstract(){if(hasRequiredRegexpExecAbstract)return regexpExecAbstract;hasRequiredRegexpExecAbstract=1;var Y=requireFunctionCall(),K=requireAnObject(),ee=requireIsCallable(),ne=requireClassofRaw(),re=requireRegexpExec(),le=TypeError;return regexpExecAbstract=function(Q,R){var U=Q.exec;if(ee(U)){var Z=Y(U,Q,R);return Z!==null&&K(Z),Z}if(ne(Q)==="RegExp")return Y(re,Q,R);throw new le("RegExp#exec called on incompatible receiver")},regexpExecAbstract}var hasRequiredEs_string_match;function requireEs_string_match(){if(hasRequiredEs_string_match)return es_string_match;hasRequiredEs_string_match=1;var Y=requireFunctionCall(),K=requireFunctionUncurryThis(),ee=requireFixRegexpWellKnownSymbolLogic(),ne=requireAnObject(),re=requireIsObject$1(),le=requireToLength(),Q=requireToString$1(),R=requireRequireObjectCoercible(),U=requireGetMethod(),Z=requireAdvanceStringIndex(),ae=requireRegexpGetFlags(),he=requireRegexpExecAbstract(),pe=K("".indexOf);return ee("match",function(me,ve,Re){return[function(Te){var Ce=R(this),We=re(Te)?U(Te,me):void 0;return We?Y(We,Te,Ce):new RegExp(Te)[me](Q(Ce))},function(Me){var Te=ne(this),Ce=Q(Me),We=Re(ve,Te,Ce);if(We.done)return We.value;var Fe=Q(ae(Te));if(pe(Fe,"g")===-1)return he(Te,Ce);var ke=pe(Fe,"u")!==-1;Te.lastIndex=0;for(var Ze=[],Je=0,Qe;(Qe=he(Te,Ce))!==null;){var it=Q(Qe[0]);Ze[Je]=it,it===""&&(Te.lastIndex=Z(Ce,le(Te.lastIndex),ke)),Je++}return Je===0?null:Ze}]}),es_string_match}var es_string_matchAll={},hasRequiredEs_string_matchAll;function requireEs_string_matchAll(){if(hasRequiredEs_string_matchAll)return es_string_matchAll;hasRequiredEs_string_matchAll=1;var Y=require_export(),K=requireFunctionCall(),ee=requireFunctionUncurryThisClause(),ne=requireIteratorCreateConstructor(),re=requireCreateIterResultObject(),le=requireRequireObjectCoercible(),Q=requireToLength(),R=requireToString$1(),U=requireAnObject(),Z=requireIsObject$1(),ae=requireClassofRaw(),he=requireIsRegexp(),pe=requireRegexpGetFlags(),me=requireGetMethod(),ve=requireDefineBuiltIn(),Re=requireFails(),Me=requireWellKnownSymbol(),Te=requireSpeciesConstructor(),Ce=requireAdvanceStringIndex(),We=requireRegexpExecAbstract(),Fe=requireInternalState(),ke=requireIsPure(),Ze=Me("matchAll"),Je="RegExp String",Qe=Je+" Iterator",it=Fe.set,lt=Fe.getterFor(Qe),dt=RegExp.prototype,yt=TypeError,gt=ee("".indexOf),qt=ee("".matchAll),Ft=!!qt&&!Re(function(){qt("a",/./)}),Gt=ne(function(pt,At,It,Dt){it(this,{type:Qe,regexp:pt,string:At,global:It,unicode:Dt,done:!1})},Je,function(){var pt=lt(this);if(pt.done)return re(void 0,!0);var At=pt.regexp,It=pt.string,Dt=We(At,It);return Dt===null?(pt.done=!0,re(void 0,!0)):pt.global?(R(Dt[0])===""&&(At.lastIndex=Ce(It,Q(At.lastIndex),pt.unicode)),re(Dt,!1)):(pt.done=!0,re(Dt,!1))}),ft=function(Rt){var pt=U(this),At=R(Rt),It=Te(pt,RegExp),Dt=R(pe(pt)),Zt,nr,Er;return Zt=new It(It===RegExp?pt.source:pt,Dt),nr=!!~gt(Dt,"g"),Er=!!~gt(Dt,"u"),Zt.lastIndex=Q(pt.lastIndex),new Gt(Zt,At,nr,Er)};return Y({target:"String",proto:!0,forced:Ft},{matchAll:function(pt){var At=le(this),It,Dt,Zt,nr;if(Z(pt)){if(he(pt)&&(It=R(le(pe(pt))),!~gt(It,"g")))throw new yt("`.matchAll` does not allow non-global regexes");if(Ft)return qt(At,pt);if(Zt=me(pt,Ze),Zt===void 0&&ke&&ae(pt)==="RegExp"&&(Zt=ft),Zt)return K(Zt,pt,At)}else if(Ft)return qt(At,pt);return Dt=R(At),nr=new RegExp(pt,"g"),ke?K(ft,nr,Dt):nr[Ze](Dt)}}),ke||Ze in dt||ve(dt,Ze,ft),es_string_matchAll}var es_string_padEnd={},stringPadWebkitBug,hasRequiredStringPadWebkitBug;function requireStringPadWebkitBug(){if(hasRequiredStringPadWebkitBug)return stringPadWebkitBug;hasRequiredStringPadWebkitBug=1;var Y=requireEnvironmentUserAgent();return stringPadWebkitBug=/Version\/10(?:\.\d+){1,2}(?: [\w./]+)?(?: Mobile\/\w+)? Safari\//.test(Y),stringPadWebkitBug}var hasRequiredEs_string_padEnd;function requireEs_string_padEnd(){if(hasRequiredEs_string_padEnd)return es_string_padEnd;hasRequiredEs_string_padEnd=1;var Y=require_export(),K=requireStringPad().end,ee=requireStringPadWebkitBug();return Y({target:"String",proto:!0,forced:ee},{padEnd:function(re){return K(this,re,arguments.length>1?arguments[1]:void 0)}}),es_string_padEnd}var es_string_padStart={},hasRequiredEs_string_padStart;function requireEs_string_padStart(){if(hasRequiredEs_string_padStart)return es_string_padStart;hasRequiredEs_string_padStart=1;var Y=require_export(),K=requireStringPad().start,ee=requireStringPadWebkitBug();return Y({target:"String",proto:!0,forced:ee},{padStart:function(re){return K(this,re,arguments.length>1?arguments[1]:void 0)}}),es_string_padStart}var es_string_raw={},hasRequiredEs_string_raw;function requireEs_string_raw(){if(hasRequiredEs_string_raw)return es_string_raw;hasRequiredEs_string_raw=1;var Y=require_export(),K=requireFunctionUncurryThis(),ee=requireToIndexedObject(),ne=requireToObject(),re=requireToString$1(),le=requireLengthOfArrayLike(),Q=K([].push),R=K([].join);return Y({target:"String",stat:!0},{raw:function(Z){var ae=ee(ne(Z).raw),he=le(ae);if(!he)return"";for(var pe=arguments.length,me=[],ve=0;;){if(Q(me,re(ae[ve++])),ve===he)return R(me,"");ve<pe&&Q(me,re(arguments[ve]))}}}),es_string_raw}var es_string_repeat={},hasRequiredEs_string_repeat;function requireEs_string_repeat(){if(hasRequiredEs_string_repeat)return es_string_repeat;hasRequiredEs_string_repeat=1;var Y=require_export(),K=requireStringRepeat();return Y({target:"String",proto:!0},{repeat:K}),es_string_repeat}var es_string_replace={},getSubstitution,hasRequiredGetSubstitution;function requireGetSubstitution(){if(hasRequiredGetSubstitution)return getSubstitution;hasRequiredGetSubstitution=1;var Y=requireFunctionUncurryThis(),K=requireToObject(),ee=Math.floor,ne=Y("".charAt),re=Y("".replace),le=Y("".slice),Q=/\$([$&'`]|\d{1,2}|<[^>]*>)/g,R=/\$([$&'`]|\d{1,2})/g;return getSubstitution=function(U,Z,ae,he,pe,me){var ve=ae+U.length,Re=he.length,Me=R;return pe!==void 0&&(pe=K(pe),Me=Q),re(me,Me,function(Te,Ce){var We;switch(ne(Ce,0)){case"$":return"$";case"&":return U;case"`":return le(Z,0,ae);case"'":return le(Z,ve);case"<":We=pe[le(Ce,1,-1)];break;default:var Fe=+Ce;if(Fe===0)return Te;if(Fe>Re){var ke=ee(Fe/10);return ke===0?Te:ke<=Re?he[ke-1]===void 0?ne(Ce,1):he[ke-1]+ne(Ce,1):Te}We=he[Fe-1]}return We===void 0?"":We})},getSubstitution}var hasRequiredEs_string_replace;function requireEs_string_replace(){if(hasRequiredEs_string_replace)return es_string_replace;hasRequiredEs_string_replace=1;var Y=requireFunctionApply(),K=requireFunctionCall(),ee=requireFunctionUncurryThis(),ne=requireFixRegexpWellKnownSymbolLogic(),re=requireFails(),le=requireAnObject(),Q=requireIsCallable(),R=requireIsObject$1(),U=requireToIntegerOrInfinity(),Z=requireToLength(),ae=requireToString$1(),he=requireRequireObjectCoercible(),pe=requireAdvanceStringIndex(),me=requireGetMethod(),ve=requireGetSubstitution(),Re=requireRegexpGetFlags(),Me=requireRegexpExecAbstract(),Te=requireWellKnownSymbol(),Ce=Te("replace"),We=Math.max,Fe=Math.min,ke=ee([].concat),Ze=ee([].push),Je=ee("".indexOf),Qe=ee("".slice),it=function(gt){return gt===void 0?gt:String(gt)},lt=function(){return"a".replace(/./,"$0")==="$0"}(),dt=function(){return/./[Ce]?/./[Ce]("a","$0")==="":!1}(),yt=!re(function(){var gt=/./;return gt.exec=function(){var qt=[];return qt.groups={a:"7"},qt},"".replace(gt,"$<a>")!=="7"});return ne("replace",function(gt,qt,Ft){var Gt=dt?"$":"$0";return[function(Rt,pt){var At=he(this),It=R(Rt)?me(Rt,Ce):void 0;return It?K(It,Rt,At,pt):K(qt,ae(At),Rt,pt)},function(ft,Rt){var pt=le(this),At=ae(ft);if(typeof Rt=="string"&&Je(Rt,Gt)===-1&&Je(Rt,"$<")===-1){var It=Ft(qt,pt,At,Rt);if(It.done)return It.value}var Dt=Q(Rt);Dt||(Rt=ae(Rt));var Zt=ae(Re(pt)),nr=Je(Zt,"g")!==-1,Er;nr&&(Er=Je(Zt,"u")!==-1,pt.lastIndex=0);for(var vr=[],Sr;Sr=Me(pt,At),!(Sr===null||(Ze(vr,Sr),!nr));){var Qt=ae(Sr[0]);Qt===""&&(pt.lastIndex=pe(At,Z(pt.lastIndex),Er))}for(var or="",Ir=0,Rr=0;Rr<vr.length;Rr++){Sr=vr[Rr];for(var Cr=ae(Sr[0]),wr=We(Fe(U(Sr.index),At.length),0),Wr=[],Kr,Hr=1;Hr<Sr.length;Hr++)Ze(Wr,it(Sr[Hr]));var br=Sr.groups;if(Dt){var Lr=ke([Cr],Wr,wr,At);br!==void 0&&Ze(Lr,br),Kr=ae(Y(Rt,void 0,Lr))}else Kr=ve(Cr,At,wr,Wr,br,Rt);wr>=Ir&&(or+=Qe(At,Ir,wr)+Kr,Ir=wr+Cr.length)}return or+Qe(At,Ir)}]},!yt||!lt||dt),es_string_replace}var es_string_replaceAll={},hasRequiredEs_string_replaceAll;function requireEs_string_replaceAll(){if(hasRequiredEs_string_replaceAll)return es_string_replaceAll;hasRequiredEs_string_replaceAll=1;var Y=require_export(),K=requireFunctionCall(),ee=requireFunctionUncurryThis(),ne=requireRequireObjectCoercible(),re=requireIsCallable(),le=requireIsObject$1(),Q=requireIsRegexp(),R=requireToString$1(),U=requireGetMethod(),Z=requireRegexpGetFlags(),ae=requireGetSubstitution(),he=requireWellKnownSymbol(),pe=requireIsPure(),me=he("replace"),ve=TypeError,Re=ee("".indexOf),Me=ee("".replace),Te=ee("".slice),Ce=Math.max;return Y({target:"String",proto:!0},{replaceAll:function(Fe,ke){var Ze=ne(this),Je,Qe,it,lt,dt,yt,gt,qt,Ft,Gt,ft=0,Rt="";if(le(Fe)){if(Je=Q(Fe),Je&&(Qe=R(ne(Z(Fe))),!~Re(Qe,"g")))throw new ve("`.replaceAll` does not allow non-global regexes");if(it=U(Fe,me),it)return K(it,Fe,Ze,ke);if(pe&&Je)return Me(R(Ze),Fe,ke)}for(lt=R(Ze),dt=R(Fe),yt=re(ke),yt||(ke=R(ke)),gt=dt.length,qt=Ce(1,gt),Ft=Re(lt,dt);Ft!==-1;)Gt=yt?R(ke(dt,Ft,lt)):ae(dt,lt,Ft,[],void 0,ke),Rt+=Te(lt,ft,Ft)+Gt,ft=Ft+gt,Ft=Ft+qt>lt.length?-1:Re(lt,dt,Ft+qt);return ft<lt.length&&(Rt+=Te(lt,ft)),Rt}}),es_string_replaceAll}var es_string_search={},hasRequiredEs_string_search;function requireEs_string_search(){if(hasRequiredEs_string_search)return es_string_search;hasRequiredEs_string_search=1;var Y=requireFunctionCall(),K=requireFixRegexpWellKnownSymbolLogic(),ee=requireAnObject(),ne=requireIsObject$1(),re=requireRequireObjectCoercible(),le=requireSameValue(),Q=requireToString$1(),R=requireGetMethod(),U=requireRegexpExecAbstract();return K("search",function(Z,ae,he){return[function(me){var ve=re(this),Re=ne(me)?R(me,Z):void 0;return Re?Y(Re,me,ve):new RegExp(me)[Z](Q(ve))},function(pe){var me=ee(this),ve=Q(pe),Re=he(ae,me,ve);if(Re.done)return Re.value;var Me=me.lastIndex;le(Me,0)||(me.lastIndex=0);var Te=U(me,ve);return le(me.lastIndex,Me)||(me.lastIndex=Me),Te===null?-1:Te.index}]}),es_string_search}var es_string_split={},hasRequiredEs_string_split;function requireEs_string_split(){if(hasRequiredEs_string_split)return es_string_split;hasRequiredEs_string_split=1;var Y=requireFunctionCall(),K=requireFunctionUncurryThis(),ee=requireFixRegexpWellKnownSymbolLogic(),ne=requireAnObject(),re=requireIsObject$1(),le=requireRequireObjectCoercible(),Q=requireSpeciesConstructor(),R=requireAdvanceStringIndex(),U=requireToLength(),Z=requireToString$1(),ae=requireGetMethod(),he=requireRegexpExecAbstract(),pe=requireRegexpStickyHelpers(),me=requireFails(),ve=pe.UNSUPPORTED_Y,Re=4294967295,Me=Math.min,Te=K([].push),Ce=K("".slice),We=!me(function(){var ke=/(?:)/,Ze=ke.exec;ke.exec=function(){return Ze.apply(this,arguments)};var Je="ab".split(ke);return Je.length!==2||Je[0]!=="a"||Je[1]!=="b"}),Fe="abbc".split(/(b)*/)[1]==="c"||"test".split(/(?:)/,-1).length!==4||"ab".split(/(?:ab)*/).length!==2||".".split(/(.?)(.?)/).length!==4||".".split(/()()/).length>1||"".split(/.?/).length;return ee("split",function(ke,Ze,Je){var Qe="0".split(void 0,0).length?function(it,lt){return it===void 0&&lt===0?[]:Y(Ze,this,it,lt)}:Ze;return[function(lt,dt){var yt=le(this),gt=re(lt)?ae(lt,ke):void 0;return gt?Y(gt,lt,yt,dt):Y(Qe,Z(yt),lt,dt)},function(it,lt){var dt=ne(this),yt=Z(it);if(!Fe){var gt=Je(Qe,dt,yt,lt,Qe!==Ze);if(gt.done)return gt.value}var qt=Q(dt,RegExp),Ft=dt.unicode,Gt=(dt.ignoreCase?"i":"")+(dt.multiline?"m":"")+(dt.unicode?"u":"")+(ve?"g":"y"),ft=new qt(ve?"^(?:"+dt.source+")":dt,Gt),Rt=lt===void 0?Re:lt>>>0;if(Rt===0)return[];if(yt.length===0)return he(ft,yt)===null?[yt]:[];for(var pt=0,At=0,It=[];At<yt.length;){ft.lastIndex=ve?0:At;var Dt=he(ft,ve?Ce(yt,At):yt),Zt;if(Dt===null||(Zt=Me(U(ft.lastIndex+(ve?At:0)),yt.length))===pt)At=R(yt,At,Ft);else{if(Te(It,Ce(yt,pt,At)),It.length===Rt)return It;for(var nr=1;nr<=Dt.length-1;nr++)if(Te(It,Dt[nr]),It.length===Rt)return It;At=pt=Zt}}return Te(It,Ce(yt,pt)),It}]},Fe||!We,ve),es_string_split}var es_string_startsWith={},hasRequiredEs_string_startsWith;function requireEs_string_startsWith(){if(hasRequiredEs_string_startsWith)return es_string_startsWith;hasRequiredEs_string_startsWith=1;var Y=require_export(),K=requireFunctionUncurryThisClause(),ee=requireObjectGetOwnPropertyDescriptor().f,ne=requireToLength(),re=requireToString$1(),le=requireNotARegexp(),Q=requireRequireObjectCoercible(),R=requireCorrectIsRegexpLogic(),U=requireIsPure(),Z=K("".slice),ae=Math.min,he=R("startsWith"),pe=!U&&!he&&!!function(){var me=ee(String.prototype,"startsWith");return me&&!me.writable}();return Y({target:"String",proto:!0,forced:!pe&&!he},{startsWith:function(ve){var Re=re(Q(this));le(ve);var Me=ne(ae(arguments.length>1?arguments[1]:void 0,Re.length)),Te=re(ve);return Z(Re,Me,Me+Te.length)===Te}}),es_string_startsWith}var es_string_substr={},hasRequiredEs_string_substr;function requireEs_string_substr(){if(hasRequiredEs_string_substr)return es_string_substr;hasRequiredEs_string_substr=1;var Y=require_export(),K=requireFunctionUncurryThis(),ee=requireRequireObjectCoercible(),ne=requireToIntegerOrInfinity(),re=requireToString$1(),le=K("".slice),Q=Math.max,R=Math.min,U=!"".substr||"ab".substr(-1)!=="b";return Y({target:"String",proto:!0,forced:U},{substr:function(ae,he){var pe=re(ee(this)),me=pe.length,ve=ne(ae),Re,Me;return ve===1/0&&(ve=0),ve<0&&(ve=Q(me+ve,0)),Re=he===void 0?me:ne(he),Re<=0||Re===1/0?"":(Me=R(ve+Re,me),ve>=Me?"":le(pe,ve,Me))}}),es_string_substr}var es_string_toWellFormed={},hasRequiredEs_string_toWellFormed;function requireEs_string_toWellFormed(){if(hasRequiredEs_string_toWellFormed)return es_string_toWellFormed;hasRequiredEs_string_toWellFormed=1;var Y=require_export(),K=requireFunctionCall(),ee=requireFunctionUncurryThis(),ne=requireRequireObjectCoercible(),re=requireToString$1(),le=requireFails(),Q=Array,R=ee("".charAt),U=ee("".charCodeAt),Z=ee([].join),ae="".toWellFormed,he="�",pe=ae&&le(function(){return K(ae,1)!=="1"});return Y({target:"String",proto:!0,forced:pe},{toWellFormed:function(){var ve=re(ne(this));if(pe)return K(ae,ve);for(var Re=ve.length,Me=Q(Re),Te=0;Te<Re;Te++){var Ce=U(ve,Te);(Ce&63488)!==55296?Me[Te]=R(ve,Te):Ce>=56320||Te+1>=Re||(U(ve,Te+1)&64512)!==56320?Me[Te]=he:(Me[Te]=R(ve,Te),Me[++Te]=R(ve,Te))}return Z(Me,"")}}),es_string_toWellFormed}var es_string_trim={},stringTrimForced,hasRequiredStringTrimForced;function requireStringTrimForced(){if(hasRequiredStringTrimForced)return stringTrimForced;hasRequiredStringTrimForced=1;var Y=requireFunctionName().PROPER,K=requireFails(),ee=requireWhitespaces(),ne="​᠎";return stringTrimForced=function(re){return K(function(){return!!ee[re]()||ne[re]()!==ne||Y&&ee[re].name!==re})},stringTrimForced}var hasRequiredEs_string_trim;function requireEs_string_trim(){if(hasRequiredEs_string_trim)return es_string_trim;hasRequiredEs_string_trim=1;var Y=require_export(),K=requireStringTrim().trim,ee=requireStringTrimForced();return Y({target:"String",proto:!0,forced:ee("trim")},{trim:function(){return K(this)}}),es_string_trim}var es_string_trimEnd={},es_string_trimRight={},stringTrimEnd,hasRequiredStringTrimEnd;function requireStringTrimEnd(){if(hasRequiredStringTrimEnd)return stringTrimEnd;hasRequiredStringTrimEnd=1;var Y=requireStringTrim().end,K=requireStringTrimForced();return stringTrimEnd=K("trimEnd")?function(){return Y(this)}:"".trimEnd,stringTrimEnd}var hasRequiredEs_string_trimRight;function requireEs_string_trimRight(){if(hasRequiredEs_string_trimRight)return es_string_trimRight;hasRequiredEs_string_trimRight=1;var Y=require_export(),K=requireStringTrimEnd();return Y({target:"String",proto:!0,name:"trimEnd",forced:"".trimRight!==K},{trimRight:K}),es_string_trimRight}var hasRequiredEs_string_trimEnd;function requireEs_string_trimEnd(){if(hasRequiredEs_string_trimEnd)return es_string_trimEnd;hasRequiredEs_string_trimEnd=1,requireEs_string_trimRight();var Y=require_export(),K=requireStringTrimEnd();return Y({target:"String",proto:!0,name:"trimEnd",forced:"".trimEnd!==K},{trimEnd:K}),es_string_trimEnd}var es_string_trimStart={},es_string_trimLeft={},stringTrimStart,hasRequiredStringTrimStart;function requireStringTrimStart(){if(hasRequiredStringTrimStart)return stringTrimStart;hasRequiredStringTrimStart=1;var Y=requireStringTrim().start,K=requireStringTrimForced();return stringTrimStart=K("trimStart")?function(){return Y(this)}:"".trimStart,stringTrimStart}var hasRequiredEs_string_trimLeft;function requireEs_string_trimLeft(){if(hasRequiredEs_string_trimLeft)return es_string_trimLeft;hasRequiredEs_string_trimLeft=1;var Y=require_export(),K=requireStringTrimStart();return Y({target:"String",proto:!0,name:"trimStart",forced:"".trimLeft!==K},{trimLeft:K}),es_string_trimLeft}var hasRequiredEs_string_trimStart;function requireEs_string_trimStart(){if(hasRequiredEs_string_trimStart)return es_string_trimStart;hasRequiredEs_string_trimStart=1,requireEs_string_trimLeft();var Y=require_export(),K=requireStringTrimStart();return Y({target:"String",proto:!0,name:"trimStart",forced:"".trimStart!==K},{trimStart:K}),es_string_trimStart}var es_string_anchor={},createHtml,hasRequiredCreateHtml;function requireCreateHtml(){if(hasRequiredCreateHtml)return createHtml;hasRequiredCreateHtml=1;var Y=requireFunctionUncurryThis(),K=requireRequireObjectCoercible(),ee=requireToString$1(),ne=/"/g,re=Y("".replace);return createHtml=function(le,Q,R,U){var Z=ee(K(le)),ae="<"+Q;return R!==""&&(ae+=" "+R+'="'+re(ee(U),ne,"&quot;")+'"'),ae+">"+Z+"</"+Q+">"},createHtml}var stringHtmlForced,hasRequiredStringHtmlForced;function requireStringHtmlForced(){if(hasRequiredStringHtmlForced)return stringHtmlForced;hasRequiredStringHtmlForced=1;var Y=requireFails();return stringHtmlForced=function(K){return Y(function(){var ee=""[K]('"');return ee!==ee.toLowerCase()||ee.split('"').length>3})},stringHtmlForced}var hasRequiredEs_string_anchor;function requireEs_string_anchor(){if(hasRequiredEs_string_anchor)return es_string_anchor;hasRequiredEs_string_anchor=1;var Y=require_export(),K=requireCreateHtml(),ee=requireStringHtmlForced();return Y({target:"String",proto:!0,forced:ee("anchor")},{anchor:function(re){return K(this,"a","name",re)}}),es_string_anchor}var es_string_big={},hasRequiredEs_string_big;function requireEs_string_big(){if(hasRequiredEs_string_big)return es_string_big;hasRequiredEs_string_big=1;var Y=require_export(),K=requireCreateHtml(),ee=requireStringHtmlForced();return Y({target:"String",proto:!0,forced:ee("big")},{big:function(){return K(this,"big","","")}}),es_string_big}var es_string_blink={},hasRequiredEs_string_blink;function requireEs_string_blink(){if(hasRequiredEs_string_blink)return es_string_blink;hasRequiredEs_string_blink=1;var Y=require_export(),K=requireCreateHtml(),ee=requireStringHtmlForced();return Y({target:"String",proto:!0,forced:ee("blink")},{blink:function(){return K(this,"blink","","")}}),es_string_blink}var es_string_bold={},hasRequiredEs_string_bold;function requireEs_string_bold(){if(hasRequiredEs_string_bold)return es_string_bold;hasRequiredEs_string_bold=1;var Y=require_export(),K=requireCreateHtml(),ee=requireStringHtmlForced();return Y({target:"String",proto:!0,forced:ee("bold")},{bold:function(){return K(this,"b","","")}}),es_string_bold}var es_string_fixed={},hasRequiredEs_string_fixed;function requireEs_string_fixed(){if(hasRequiredEs_string_fixed)return es_string_fixed;hasRequiredEs_string_fixed=1;var Y=require_export(),K=requireCreateHtml(),ee=requireStringHtmlForced();return Y({target:"String",proto:!0,forced:ee("fixed")},{fixed:function(){return K(this,"tt","","")}}),es_string_fixed}var es_string_fontcolor={},hasRequiredEs_string_fontcolor;function requireEs_string_fontcolor(){if(hasRequiredEs_string_fontcolor)return es_string_fontcolor;hasRequiredEs_string_fontcolor=1;var Y=require_export(),K=requireCreateHtml(),ee=requireStringHtmlForced();return Y({target:"String",proto:!0,forced:ee("fontcolor")},{fontcolor:function(re){return K(this,"font","color",re)}}),es_string_fontcolor}var es_string_fontsize={},hasRequiredEs_string_fontsize;function requireEs_string_fontsize(){if(hasRequiredEs_string_fontsize)return es_string_fontsize;hasRequiredEs_string_fontsize=1;var Y=require_export(),K=requireCreateHtml(),ee=requireStringHtmlForced();return Y({target:"String",proto:!0,forced:ee("fontsize")},{fontsize:function(re){return K(this,"font","size",re)}}),es_string_fontsize}var es_string_italics={},hasRequiredEs_string_italics;function requireEs_string_italics(){if(hasRequiredEs_string_italics)return es_string_italics;hasRequiredEs_string_italics=1;var Y=require_export(),K=requireCreateHtml(),ee=requireStringHtmlForced();return Y({target:"String",proto:!0,forced:ee("italics")},{italics:function(){return K(this,"i","","")}}),es_string_italics}var es_string_link={},hasRequiredEs_string_link;function requireEs_string_link(){if(hasRequiredEs_string_link)return es_string_link;hasRequiredEs_string_link=1;var Y=require_export(),K=requireCreateHtml(),ee=requireStringHtmlForced();return Y({target:"String",proto:!0,forced:ee("link")},{link:function(re){return K(this,"a","href",re)}}),es_string_link}var es_string_small={},hasRequiredEs_string_small;function requireEs_string_small(){if(hasRequiredEs_string_small)return es_string_small;hasRequiredEs_string_small=1;var Y=require_export(),K=requireCreateHtml(),ee=requireStringHtmlForced();return Y({target:"String",proto:!0,forced:ee("small")},{small:function(){return K(this,"small","","")}}),es_string_small}var es_string_strike={},hasRequiredEs_string_strike;function requireEs_string_strike(){if(hasRequiredEs_string_strike)return es_string_strike;hasRequiredEs_string_strike=1;var Y=require_export(),K=requireCreateHtml(),ee=requireStringHtmlForced();return Y({target:"String",proto:!0,forced:ee("strike")},{strike:function(){return K(this,"strike","","")}}),es_string_strike}var es_string_sub={},hasRequiredEs_string_sub;function requireEs_string_sub(){if(hasRequiredEs_string_sub)return es_string_sub;hasRequiredEs_string_sub=1;var Y=require_export(),K=requireCreateHtml(),ee=requireStringHtmlForced();return Y({target:"String",proto:!0,forced:ee("sub")},{sub:function(){return K(this,"sub","","")}}),es_string_sub}var es_string_sup={},hasRequiredEs_string_sup;function requireEs_string_sup(){if(hasRequiredEs_string_sup)return es_string_sup;hasRequiredEs_string_sup=1;var Y=require_export(),K=requireCreateHtml(),ee=requireStringHtmlForced();return Y({target:"String",proto:!0,forced:ee("sup")},{sup:function(){return K(this,"sup","","")}}),es_string_sup}var es_typedArray_float32Array={},typedArrayConstructor={exports:{}},typedArrayConstructorsRequireWrappers,hasRequiredTypedArrayConstructorsRequireWrappers;function requireTypedArrayConstructorsRequireWrappers(){if(hasRequiredTypedArrayConstructorsRequireWrappers)return typedArrayConstructorsRequireWrappers;hasRequiredTypedArrayConstructorsRequireWrappers=1;var Y=requireGlobalThis(),K=requireFails(),ee=requireCheckCorrectnessOfIteration(),ne=requireArrayBufferViewCore().NATIVE_ARRAY_BUFFER_VIEWS,re=Y.ArrayBuffer,le=Y.Int8Array;return typedArrayConstructorsRequireWrappers=!ne||!K(function(){le(1)})||!K(function(){new le(-1)})||!ee(function(Q){new le,new le(null),new le(1.5),new le(Q)},!0)||K(function(){return new le(new re(2),1,void 0).length!==1}),typedArrayConstructorsRequireWrappers}var toOffset,hasRequiredToOffset;function requireToOffset(){if(hasRequiredToOffset)return toOffset;hasRequiredToOffset=1;var Y=requireToPositiveInteger(),K=RangeError;return toOffset=function(ee,ne){var re=Y(ee);if(re%ne)throw new K("Wrong offset");return re},toOffset}var toUint8Clamped,hasRequiredToUint8Clamped;function requireToUint8Clamped(){if(hasRequiredToUint8Clamped)return toUint8Clamped;hasRequiredToUint8Clamped=1;var Y=Math.round;return toUint8Clamped=function(K){var ee=Y(K);return ee<0?0:ee>255?255:ee&255},toUint8Clamped}var isBigIntArray,hasRequiredIsBigIntArray;function requireIsBigIntArray(){if(hasRequiredIsBigIntArray)return isBigIntArray;hasRequiredIsBigIntArray=1;var Y=requireClassof();return isBigIntArray=function(K){var ee=Y(K);return ee==="BigInt64Array"||ee==="BigUint64Array"},isBigIntArray}var toBigInt,hasRequiredToBigInt;function requireToBigInt(){if(hasRequiredToBigInt)return toBigInt;hasRequiredToBigInt=1;var Y=requireToPrimitive(),K=TypeError;return toBigInt=function(ee){var ne=Y(ee,"number");if(typeof ne=="number")throw new K("Can't convert number to bigint");return BigInt(ne)},toBigInt}var typedArrayFrom,hasRequiredTypedArrayFrom;function requireTypedArrayFrom(){if(hasRequiredTypedArrayFrom)return typedArrayFrom;hasRequiredTypedArrayFrom=1;var Y=requireFunctionBindContext(),K=requireFunctionCall(),ee=requireAConstructor(),ne=requireToObject(),re=requireLengthOfArrayLike(),le=requireGetIterator(),Q=requireGetIteratorMethod(),R=requireIsArrayIteratorMethod(),U=requireIsBigIntArray(),Z=requireArrayBufferViewCore().aTypedArrayConstructor,ae=requireToBigInt();return typedArrayFrom=function(pe){var me=ee(this),ve=ne(pe),Re=arguments.length,Me=Re>1?arguments[1]:void 0,Te=Me!==void 0,Ce=Q(ve),We,Fe,ke,Ze,Je,Qe,it,lt;if(Ce&&!R(Ce))for(it=le(ve,Ce),lt=it.next,ve=[];!(Qe=K(lt,it)).done;)ve.push(Qe.value);for(Te&&Re>2&&(Me=Y(Me,arguments[2])),Fe=re(ve),ke=new(Z(me))(Fe),Ze=U(ke),We=0;Fe>We;We++)Je=Te?Me(ve[We],We):ve[We],ke[We]=Ze?ae(Je):+Je;return ke},typedArrayFrom}var hasRequiredTypedArrayConstructor;function requireTypedArrayConstructor(){if(hasRequiredTypedArrayConstructor)return typedArrayConstructor.exports;hasRequiredTypedArrayConstructor=1;var Y=require_export(),K=requireGlobalThis(),ee=requireFunctionCall(),ne=requireDescriptors(),re=requireTypedArrayConstructorsRequireWrappers(),le=requireArrayBufferViewCore(),Q=requireArrayBuffer(),R=requireAnInstance(),U=requireCreatePropertyDescriptor(),Z=requireCreateNonEnumerableProperty(),ae=requireIsIntegralNumber(),he=requireToLength(),pe=requireToIndex(),me=requireToOffset(),ve=requireToUint8Clamped(),Re=requireToPropertyKey(),Me=requireHasOwnProperty(),Te=requireClassof(),Ce=requireIsObject$1(),We=requireIsSymbol$1(),Fe=requireObjectCreate(),ke=requireObjectIsPrototypeOf(),Ze=requireObjectSetPrototypeOf(),Je=requireObjectGetOwnPropertyNames().f,Qe=requireTypedArrayFrom(),it=requireArrayIteration().forEach,lt=requireSetSpecies(),dt=requireDefineBuiltInAccessor(),yt=requireObjectDefineProperty(),gt=requireObjectGetOwnPropertyDescriptor(),qt=requireArrayFromConstructorAndList(),Ft=requireInternalState(),Gt=requireInheritIfRequired(),ft=Ft.get,Rt=Ft.set,pt=Ft.enforce,At=yt.f,It=gt.f,Dt=K.RangeError,Zt=Q.ArrayBuffer,nr=Zt.prototype,Er=Q.DataView,vr=le.NATIVE_ARRAY_BUFFER_VIEWS,Sr=le.TYPED_ARRAY_TAG,Qt=le.TypedArray,or=le.TypedArrayPrototype,Ir=le.isTypedArray,Rr="BYTES_PER_ELEMENT",Cr="Wrong length",wr=function(Lr,Br){dt(Lr,Br,{configurable:!0,get:function(){return ft(this)[Br]}})},Wr=function(Lr){var Br;return ke(nr,Lr)||(Br=Te(Lr))==="ArrayBuffer"||Br==="SharedArrayBuffer"},Kr=function(Lr,Br){return Ir(Lr)&&!We(Br)&&Br in Lr&&ae(+Br)&&Br>=0},Hr=function(Br,zr){return zr=Re(zr),Kr(Br,zr)?U(2,Br[zr]):It(Br,zr)},br=function(Br,zr,rr){return zr=Re(zr),Kr(Br,zr)&&Ce(rr)&&Me(rr,"value")&&!Me(rr,"get")&&!Me(rr,"set")&&!rr.configurable&&(!Me(rr,"writable")||rr.writable)&&(!Me(rr,"enumerable")||rr.enumerable)?(Br[zr]=rr.value,Br):At(Br,zr,rr)};return ne?(vr||(gt.f=Hr,yt.f=br,wr(or,"buffer"),wr(or,"byteOffset"),wr(or,"byteLength"),wr(or,"length")),Y({target:"Object",stat:!0,forced:!vr},{getOwnPropertyDescriptor:Hr,defineProperty:br}),typedArrayConstructor.exports=function(Lr,Br,zr){var rr=Lr.match(/\d+/)[0]/8,sr=Lr+(zr?"Clamped":"")+"Array",Dr="get"+Lr,lr="set"+Lr,yr=K[sr],xr=yr,Ge=xr&&xr.prototype,Ee={},Pe=function(qe,De){var ze=ft(qe);return ze.view[Dr](De*rr+ze.byteOffset,!0)},He=function(qe,De,ze){var Le=ft(qe);Le.view[lr](De*rr+Le.byteOffset,zr?ve(ze):ze,!0)},ut=function(qe,De){At(qe,De,{get:function(){return Pe(this,De)},set:function(ze){return He(this,De,ze)},enumerable:!0})};vr?re&&(xr=Br(function(qe,De,ze,Le){return R(qe,Ge),Gt(function(){return Ce(De)?Wr(De)?Le!==void 0?new yr(De,me(ze,rr),Le):ze!==void 0?new yr(De,me(ze,rr)):new yr(De):Ir(De)?qt(xr,De):ee(Qe,xr,De):new yr(pe(De))}(),qe,xr)}),Ze&&Ze(xr,Qt),it(Je(yr),function(qe){qe in xr||Z(xr,qe,yr[qe])}),xr.prototype=Ge):(xr=Br(function(qe,De,ze,Le){R(qe,Ge);var Ke=0,et=0,_t,st,bt;if(!Ce(De))bt=pe(De),st=bt*rr,_t=new Zt(st);else if(Wr(De)){_t=De,et=me(ze,rr);var Mt=De.byteLength;if(Le===void 0){if(Mt%rr)throw new Dt(Cr);if(st=Mt-et,st<0)throw new Dt(Cr)}else if(st=he(Le)*rr,st+et>Mt)throw new Dt(Cr);bt=st/rr}else return Ir(De)?qt(xr,De):ee(Qe,xr,De);for(Rt(qe,{buffer:_t,byteOffset:et,byteLength:st,length:bt,view:new Er(_t)});Ke<bt;)ut(qe,Ke++)}),Ze&&Ze(xr,Qt),Ge=xr.prototype=Fe(or)),Ge.constructor!==xr&&Z(Ge,"constructor",xr),pt(Ge).TypedArrayConstructor=xr,Sr&&Z(Ge,Sr,sr);var Ve=xr!==yr;Ee[sr]=xr,Y({global:!0,constructor:!0,forced:Ve,sham:!vr},Ee),Rr in xr||Z(xr,Rr,rr),Rr in Ge||Z(Ge,Rr,rr),lt(sr)}):typedArrayConstructor.exports=function(){},typedArrayConstructor.exports}var hasRequiredEs_typedArray_float32Array;function requireEs_typedArray_float32Array(){if(hasRequiredEs_typedArray_float32Array)return es_typedArray_float32Array;hasRequiredEs_typedArray_float32Array=1;var Y=requireTypedArrayConstructor();return Y("Float32",function(K){return function(ne,re,le){return K(this,ne,re,le)}}),es_typedArray_float32Array}var es_typedArray_float64Array={},hasRequiredEs_typedArray_float64Array;function requireEs_typedArray_float64Array(){if(hasRequiredEs_typedArray_float64Array)return es_typedArray_float64Array;hasRequiredEs_typedArray_float64Array=1;var Y=requireTypedArrayConstructor();return Y("Float64",function(K){return function(ne,re,le){return K(this,ne,re,le)}}),es_typedArray_float64Array}var es_typedArray_int8Array={},hasRequiredEs_typedArray_int8Array;function requireEs_typedArray_int8Array(){if(hasRequiredEs_typedArray_int8Array)return es_typedArray_int8Array;hasRequiredEs_typedArray_int8Array=1;var Y=requireTypedArrayConstructor();return Y("Int8",function(K){return function(ne,re,le){return K(this,ne,re,le)}}),es_typedArray_int8Array}var es_typedArray_int16Array={},hasRequiredEs_typedArray_int16Array;function requireEs_typedArray_int16Array(){if(hasRequiredEs_typedArray_int16Array)return es_typedArray_int16Array;hasRequiredEs_typedArray_int16Array=1;var Y=requireTypedArrayConstructor();return Y("Int16",function(K){return function(ne,re,le){return K(this,ne,re,le)}}),es_typedArray_int16Array}var es_typedArray_int32Array={},hasRequiredEs_typedArray_int32Array;function requireEs_typedArray_int32Array(){if(hasRequiredEs_typedArray_int32Array)return es_typedArray_int32Array;hasRequiredEs_typedArray_int32Array=1;var Y=requireTypedArrayConstructor();return Y("Int32",function(K){return function(ne,re,le){return K(this,ne,re,le)}}),es_typedArray_int32Array}var es_typedArray_uint8Array={},hasRequiredEs_typedArray_uint8Array;function requireEs_typedArray_uint8Array(){if(hasRequiredEs_typedArray_uint8Array)return es_typedArray_uint8Array;hasRequiredEs_typedArray_uint8Array=1;var Y=requireTypedArrayConstructor();return Y("Uint8",function(K){return function(ne,re,le){return K(this,ne,re,le)}}),es_typedArray_uint8Array}var es_typedArray_uint8ClampedArray={},hasRequiredEs_typedArray_uint8ClampedArray;function requireEs_typedArray_uint8ClampedArray(){if(hasRequiredEs_typedArray_uint8ClampedArray)return es_typedArray_uint8ClampedArray;hasRequiredEs_typedArray_uint8ClampedArray=1;var Y=requireTypedArrayConstructor();return Y("Uint8",function(K){return function(ne,re,le){return K(this,ne,re,le)}},!0),es_typedArray_uint8ClampedArray}var es_typedArray_uint16Array={},hasRequiredEs_typedArray_uint16Array;function requireEs_typedArray_uint16Array(){if(hasRequiredEs_typedArray_uint16Array)return es_typedArray_uint16Array;hasRequiredEs_typedArray_uint16Array=1;var Y=requireTypedArrayConstructor();return Y("Uint16",function(K){return function(ne,re,le){return K(this,ne,re,le)}}),es_typedArray_uint16Array}var es_typedArray_uint32Array={},hasRequiredEs_typedArray_uint32Array;function requireEs_typedArray_uint32Array(){if(hasRequiredEs_typedArray_uint32Array)return es_typedArray_uint32Array;hasRequiredEs_typedArray_uint32Array=1;var Y=requireTypedArrayConstructor();return Y("Uint32",function(K){return function(ne,re,le){return K(this,ne,re,le)}}),es_typedArray_uint32Array}var es_typedArray_at={},hasRequiredEs_typedArray_at;function requireEs_typedArray_at(){if(hasRequiredEs_typedArray_at)return es_typedArray_at;hasRequiredEs_typedArray_at=1;var Y=requireArrayBufferViewCore(),K=requireLengthOfArrayLike(),ee=requireToIntegerOrInfinity(),ne=Y.aTypedArray,re=Y.exportTypedArrayMethod;return re("at",function(Q){var R=ne(this),U=K(R),Z=ee(Q),ae=Z>=0?Z:U+Z;return ae<0||ae>=U?void 0:R[ae]}),es_typedArray_at}var es_typedArray_copyWithin={},hasRequiredEs_typedArray_copyWithin;function requireEs_typedArray_copyWithin(){if(hasRequiredEs_typedArray_copyWithin)return es_typedArray_copyWithin;hasRequiredEs_typedArray_copyWithin=1;var Y=requireFunctionUncurryThis(),K=requireArrayBufferViewCore(),ee=requireArrayCopyWithin(),ne=Y(ee),re=K.aTypedArray,le=K.exportTypedArrayMethod;return le("copyWithin",function(R,U){return ne(re(this),R,U,arguments.length>2?arguments[2]:void 0)}),es_typedArray_copyWithin}var es_typedArray_every={},hasRequiredEs_typedArray_every;function requireEs_typedArray_every(){if(hasRequiredEs_typedArray_every)return es_typedArray_every;hasRequiredEs_typedArray_every=1;var Y=requireArrayBufferViewCore(),K=requireArrayIteration().every,ee=Y.aTypedArray,ne=Y.exportTypedArrayMethod;return ne("every",function(le){return K(ee(this),le,arguments.length>1?arguments[1]:void 0)}),es_typedArray_every}var es_typedArray_fill={},hasRequiredEs_typedArray_fill;function requireEs_typedArray_fill(){if(hasRequiredEs_typedArray_fill)return es_typedArray_fill;hasRequiredEs_typedArray_fill=1;var Y=requireArrayBufferViewCore(),K=requireArrayFill(),ee=requireToBigInt(),ne=requireClassof(),re=requireFunctionCall(),le=requireFunctionUncurryThis(),Q=requireFails(),R=Y.aTypedArray,U=Y.exportTypedArrayMethod,Z=le("".slice),ae=Q(function(){var he=0;return new Int8Array(2).fill({valueOf:function(){return he++}}),he!==1});return U("fill",function(pe){var me=arguments.length;R(this);var ve=Z(ne(this),0,3)==="Big"?ee(pe):+pe;return re(K,this,ve,me>1?arguments[1]:void 0,me>2?arguments[2]:void 0)},ae),es_typedArray_fill}var es_typedArray_filter={},typedArrayFromSameTypeAndList,hasRequiredTypedArrayFromSameTypeAndList;function requireTypedArrayFromSameTypeAndList(){if(hasRequiredTypedArrayFromSameTypeAndList)return typedArrayFromSameTypeAndList;hasRequiredTypedArrayFromSameTypeAndList=1;var Y=requireArrayFromConstructorAndList(),K=requireArrayBufferViewCore().getTypedArrayConstructor;return typedArrayFromSameTypeAndList=function(ee,ne){return Y(K(ee),ne)},typedArrayFromSameTypeAndList}var hasRequiredEs_typedArray_filter;function requireEs_typedArray_filter(){if(hasRequiredEs_typedArray_filter)return es_typedArray_filter;hasRequiredEs_typedArray_filter=1;var Y=requireArrayBufferViewCore(),K=requireArrayIteration().filter,ee=requireTypedArrayFromSameTypeAndList(),ne=Y.aTypedArray,re=Y.exportTypedArrayMethod;return re("filter",function(Q){var R=K(ne(this),Q,arguments.length>1?arguments[1]:void 0);return ee(this,R)}),es_typedArray_filter}var es_typedArray_find={},hasRequiredEs_typedArray_find;function requireEs_typedArray_find(){if(hasRequiredEs_typedArray_find)return es_typedArray_find;hasRequiredEs_typedArray_find=1;var Y=requireArrayBufferViewCore(),K=requireArrayIteration().find,ee=Y.aTypedArray,ne=Y.exportTypedArrayMethod;return ne("find",function(le){return K(ee(this),le,arguments.length>1?arguments[1]:void 0)}),es_typedArray_find}var es_typedArray_findIndex={},hasRequiredEs_typedArray_findIndex;function requireEs_typedArray_findIndex(){if(hasRequiredEs_typedArray_findIndex)return es_typedArray_findIndex;hasRequiredEs_typedArray_findIndex=1;var Y=requireArrayBufferViewCore(),K=requireArrayIteration().findIndex,ee=Y.aTypedArray,ne=Y.exportTypedArrayMethod;return ne("findIndex",function(le){return K(ee(this),le,arguments.length>1?arguments[1]:void 0)}),es_typedArray_findIndex}var es_typedArray_findLast={},hasRequiredEs_typedArray_findLast;function requireEs_typedArray_findLast(){if(hasRequiredEs_typedArray_findLast)return es_typedArray_findLast;hasRequiredEs_typedArray_findLast=1;var Y=requireArrayBufferViewCore(),K=requireArrayIterationFromLast().findLast,ee=Y.aTypedArray,ne=Y.exportTypedArrayMethod;return ne("findLast",function(le){return K(ee(this),le,arguments.length>1?arguments[1]:void 0)}),es_typedArray_findLast}var es_typedArray_findLastIndex={},hasRequiredEs_typedArray_findLastIndex;function requireEs_typedArray_findLastIndex(){if(hasRequiredEs_typedArray_findLastIndex)return es_typedArray_findLastIndex;hasRequiredEs_typedArray_findLastIndex=1;var Y=requireArrayBufferViewCore(),K=requireArrayIterationFromLast().findLastIndex,ee=Y.aTypedArray,ne=Y.exportTypedArrayMethod;return ne("findLastIndex",function(le){return K(ee(this),le,arguments.length>1?arguments[1]:void 0)}),es_typedArray_findLastIndex}var es_typedArray_forEach={},hasRequiredEs_typedArray_forEach;function requireEs_typedArray_forEach(){if(hasRequiredEs_typedArray_forEach)return es_typedArray_forEach;hasRequiredEs_typedArray_forEach=1;var Y=requireArrayBufferViewCore(),K=requireArrayIteration().forEach,ee=Y.aTypedArray,ne=Y.exportTypedArrayMethod;return ne("forEach",function(le){K(ee(this),le,arguments.length>1?arguments[1]:void 0)}),es_typedArray_forEach}var es_typedArray_from={},hasRequiredEs_typedArray_from;function requireEs_typedArray_from(){if(hasRequiredEs_typedArray_from)return es_typedArray_from;hasRequiredEs_typedArray_from=1;var Y=requireTypedArrayConstructorsRequireWrappers(),K=requireArrayBufferViewCore().exportTypedArrayStaticMethod,ee=requireTypedArrayFrom();return K("from",ee,Y),es_typedArray_from}var es_typedArray_includes={},hasRequiredEs_typedArray_includes;function requireEs_typedArray_includes(){if(hasRequiredEs_typedArray_includes)return es_typedArray_includes;hasRequiredEs_typedArray_includes=1;var Y=requireArrayBufferViewCore(),K=requireArrayIncludes().includes,ee=Y.aTypedArray,ne=Y.exportTypedArrayMethod;return ne("includes",function(le){return K(ee(this),le,arguments.length>1?arguments[1]:void 0)}),es_typedArray_includes}var es_typedArray_indexOf={},hasRequiredEs_typedArray_indexOf;function requireEs_typedArray_indexOf(){if(hasRequiredEs_typedArray_indexOf)return es_typedArray_indexOf;hasRequiredEs_typedArray_indexOf=1;var Y=requireArrayBufferViewCore(),K=requireArrayIncludes().indexOf,ee=Y.aTypedArray,ne=Y.exportTypedArrayMethod;return ne("indexOf",function(le){return K(ee(this),le,arguments.length>1?arguments[1]:void 0)}),es_typedArray_indexOf}var es_typedArray_iterator={},hasRequiredEs_typedArray_iterator;function requireEs_typedArray_iterator(){if(hasRequiredEs_typedArray_iterator)return es_typedArray_iterator;hasRequiredEs_typedArray_iterator=1;var Y=requireGlobalThis(),K=requireFails(),ee=requireFunctionUncurryThis(),ne=requireArrayBufferViewCore(),re=requireEs_array_iterator(),le=requireWellKnownSymbol(),Q=le("iterator"),R=Y.Uint8Array,U=ee(re.values),Z=ee(re.keys),ae=ee(re.entries),he=ne.aTypedArray,pe=ne.exportTypedArrayMethod,me=R&&R.prototype,ve=!K(function(){me[Q].call([1])}),Re=!!me&&me.values&&me[Q]===me.values&&me.values.name==="values",Me=function(){return U(he(this))};return pe("entries",function(){return ae(he(this))},ve),pe("keys",function(){return Z(he(this))},ve),pe("values",Me,ve||!Re,{name:"values"}),pe(Q,Me,ve||!Re,{name:"values"}),es_typedArray_iterator}var es_typedArray_join={},hasRequiredEs_typedArray_join;function requireEs_typedArray_join(){if(hasRequiredEs_typedArray_join)return es_typedArray_join;hasRequiredEs_typedArray_join=1;var Y=requireArrayBufferViewCore(),K=requireFunctionUncurryThis(),ee=Y.aTypedArray,ne=Y.exportTypedArrayMethod,re=K([].join);return ne("join",function(Q){return re(ee(this),Q)}),es_typedArray_join}var es_typedArray_lastIndexOf={},hasRequiredEs_typedArray_lastIndexOf;function requireEs_typedArray_lastIndexOf(){if(hasRequiredEs_typedArray_lastIndexOf)return es_typedArray_lastIndexOf;hasRequiredEs_typedArray_lastIndexOf=1;var Y=requireArrayBufferViewCore(),K=requireFunctionApply(),ee=requireArrayLastIndexOf(),ne=Y.aTypedArray,re=Y.exportTypedArrayMethod;return re("lastIndexOf",function(Q){var R=arguments.length;return K(ee,ne(this),R>1?[Q,arguments[1]]:[Q])}),es_typedArray_lastIndexOf}var es_typedArray_map={},hasRequiredEs_typedArray_map;function requireEs_typedArray_map(){if(hasRequiredEs_typedArray_map)return es_typedArray_map;hasRequiredEs_typedArray_map=1;var Y=requireArrayBufferViewCore(),K=requireArrayIteration().map,ee=Y.aTypedArray,ne=Y.getTypedArrayConstructor,re=Y.exportTypedArrayMethod;return re("map",function(Q){return K(ee(this),Q,arguments.length>1?arguments[1]:void 0,function(R,U){return new(ne(R))(U)})}),es_typedArray_map}var es_typedArray_of={},hasRequiredEs_typedArray_of;function requireEs_typedArray_of(){if(hasRequiredEs_typedArray_of)return es_typedArray_of;hasRequiredEs_typedArray_of=1;var Y=requireArrayBufferViewCore(),K=requireTypedArrayConstructorsRequireWrappers(),ee=Y.aTypedArrayConstructor,ne=Y.exportTypedArrayStaticMethod;return ne("of",function(){for(var le=0,Q=arguments.length,R=new(ee(this))(Q);Q>le;)R[le]=arguments[le++];return R},K),es_typedArray_of}var es_typedArray_reduce={},hasRequiredEs_typedArray_reduce;function requireEs_typedArray_reduce(){if(hasRequiredEs_typedArray_reduce)return es_typedArray_reduce;hasRequiredEs_typedArray_reduce=1;var Y=requireArrayBufferViewCore(),K=requireArrayReduce().left,ee=Y.aTypedArray,ne=Y.exportTypedArrayMethod;return ne("reduce",function(le){var Q=arguments.length;return K(ee(this),le,Q,Q>1?arguments[1]:void 0)}),es_typedArray_reduce}var es_typedArray_reduceRight={},hasRequiredEs_typedArray_reduceRight;function requireEs_typedArray_reduceRight(){if(hasRequiredEs_typedArray_reduceRight)return es_typedArray_reduceRight;hasRequiredEs_typedArray_reduceRight=1;var Y=requireArrayBufferViewCore(),K=requireArrayReduce().right,ee=Y.aTypedArray,ne=Y.exportTypedArrayMethod;return ne("reduceRight",function(le){var Q=arguments.length;return K(ee(this),le,Q,Q>1?arguments[1]:void 0)}),es_typedArray_reduceRight}var es_typedArray_reverse={},hasRequiredEs_typedArray_reverse;function requireEs_typedArray_reverse(){if(hasRequiredEs_typedArray_reverse)return es_typedArray_reverse;hasRequiredEs_typedArray_reverse=1;var Y=requireArrayBufferViewCore(),K=Y.aTypedArray,ee=Y.exportTypedArrayMethod,ne=Math.floor;return ee("reverse",function(){for(var le=this,Q=K(le).length,R=ne(Q/2),U=0,Z;U<R;)Z=le[U],le[U++]=le[--Q],le[Q]=Z;return le}),es_typedArray_reverse}var es_typedArray_set={},hasRequiredEs_typedArray_set;function requireEs_typedArray_set(){if(hasRequiredEs_typedArray_set)return es_typedArray_set;hasRequiredEs_typedArray_set=1;var Y=requireGlobalThis(),K=requireFunctionCall(),ee=requireArrayBufferViewCore(),ne=requireLengthOfArrayLike(),re=requireToOffset(),le=requireToObject(),Q=requireFails(),R=Y.RangeError,U=Y.Int8Array,Z=U&&U.prototype,ae=Z&&Z.set,he=ee.aTypedArray,pe=ee.exportTypedArrayMethod,me=!Q(function(){var Re=new Uint8ClampedArray(2);return K(ae,Re,{length:1,0:3},1),Re[1]!==3}),ve=me&&ee.NATIVE_ARRAY_BUFFER_VIEWS&&Q(function(){var Re=new U(2);return Re.set(1),Re.set("2",1),Re[0]!==0||Re[1]!==2});return pe("set",function(Me){he(this);var Te=re(arguments.length>1?arguments[1]:void 0,1),Ce=le(Me);if(me)return K(ae,this,Ce,Te);var We=this.length,Fe=ne(Ce),ke=0;if(Fe+Te>We)throw new R("Wrong length");for(;ke<Fe;)this[Te+ke]=Ce[ke++]},!me||ve),es_typedArray_set}var es_typedArray_slice={},hasRequiredEs_typedArray_slice;function requireEs_typedArray_slice(){if(hasRequiredEs_typedArray_slice)return es_typedArray_slice;hasRequiredEs_typedArray_slice=1;var Y=requireArrayBufferViewCore(),K=requireFails(),ee=requireArraySlice(),ne=Y.aTypedArray,re=Y.getTypedArrayConstructor,le=Y.exportTypedArrayMethod,Q=K(function(){new Int8Array(1).slice()});return le("slice",function(U,Z){for(var ae=ee(ne(this),U,Z),he=re(this),pe=0,me=ae.length,ve=new he(me);me>pe;)ve[pe]=ae[pe++];return ve},Q),es_typedArray_slice}var es_typedArray_some={},hasRequiredEs_typedArray_some;function requireEs_typedArray_some(){if(hasRequiredEs_typedArray_some)return es_typedArray_some;hasRequiredEs_typedArray_some=1;var Y=requireArrayBufferViewCore(),K=requireArrayIteration().some,ee=Y.aTypedArray,ne=Y.exportTypedArrayMethod;return ne("some",function(le){return K(ee(this),le,arguments.length>1?arguments[1]:void 0)}),es_typedArray_some}var es_typedArray_sort={},hasRequiredEs_typedArray_sort;function requireEs_typedArray_sort(){if(hasRequiredEs_typedArray_sort)return es_typedArray_sort;hasRequiredEs_typedArray_sort=1;var Y=requireGlobalThis(),K=requireFunctionUncurryThisClause(),ee=requireFails(),ne=requireACallable(),re=requireArraySort(),le=requireArrayBufferViewCore(),Q=requireEnvironmentFfVersion(),R=requireEnvironmentIsIeOrEdge(),U=requireEnvironmentV8Version(),Z=requireEnvironmentWebkitVersion(),ae=le.aTypedArray,he=le.exportTypedArrayMethod,pe=Y.Uint16Array,me=pe&&K(pe.prototype.sort),ve=!!me&&!(ee(function(){me(new pe(2),null)})&&ee(function(){me(new pe(2),{})})),Re=!!me&&!ee(function(){if(U)return U<74;if(Q)return Q<67;if(R)return!0;if(Z)return Z<602;var Te=new pe(516),Ce=Array(516),We,Fe;for(We=0;We<516;We++)Fe=We%4,Te[We]=515-We,Ce[We]=We-2*Fe+3;for(me(Te,function(ke,Ze){return(ke/4|0)-(Ze/4|0)}),We=0;We<516;We++)if(Te[We]!==Ce[We])return!0}),Me=function(Te){return function(Ce,We){return Te!==void 0?+Te(Ce,We)||0:We!==We?-1:Ce!==Ce?1:Ce===0&&We===0?1/Ce>0&&1/We<0?1:-1:Ce>We}};return he("sort",function(Ce){return Ce!==void 0&&ne(Ce),Re?me(this,Ce):re(ae(this),Me(Ce))},!Re||ve),es_typedArray_sort}var es_typedArray_subarray={},hasRequiredEs_typedArray_subarray;function requireEs_typedArray_subarray(){if(hasRequiredEs_typedArray_subarray)return es_typedArray_subarray;hasRequiredEs_typedArray_subarray=1;var Y=requireArrayBufferViewCore(),K=requireToLength(),ee=requireToAbsoluteIndex(),ne=Y.aTypedArray,re=Y.getTypedArrayConstructor,le=Y.exportTypedArrayMethod;return le("subarray",function(R,U){var Z=ne(this),ae=Z.length,he=ee(R,ae),pe=re(Z);return new pe(Z.buffer,Z.byteOffset+he*Z.BYTES_PER_ELEMENT,K((U===void 0?ae:ee(U,ae))-he))}),es_typedArray_subarray}var es_typedArray_toLocaleString={},hasRequiredEs_typedArray_toLocaleString;function requireEs_typedArray_toLocaleString(){if(hasRequiredEs_typedArray_toLocaleString)return es_typedArray_toLocaleString;hasRequiredEs_typedArray_toLocaleString=1;var Y=requireGlobalThis(),K=requireFunctionApply(),ee=requireArrayBufferViewCore(),ne=requireFails(),re=requireArraySlice(),le=Y.Int8Array,Q=ee.aTypedArray,R=ee.exportTypedArrayMethod,U=[].toLocaleString,Z=!!le&&ne(function(){U.call(new le(1))}),ae=ne(function(){return[1,2].toLocaleString()!==new le([1,2]).toLocaleString()})||!ne(function(){le.prototype.toLocaleString.call([1,2])});return R("toLocaleString",function(){return K(U,Z?re(Q(this)):Q(this),re(arguments))},ae),es_typedArray_toLocaleString}var es_typedArray_toReversed={},hasRequiredEs_typedArray_toReversed;function requireEs_typedArray_toReversed(){if(hasRequiredEs_typedArray_toReversed)return es_typedArray_toReversed;hasRequiredEs_typedArray_toReversed=1;var Y=requireArrayToReversed(),K=requireArrayBufferViewCore(),ee=K.aTypedArray,ne=K.exportTypedArrayMethod,re=K.getTypedArrayConstructor;return ne("toReversed",function(){return Y(ee(this),re(this))}),es_typedArray_toReversed}var es_typedArray_toSorted={},hasRequiredEs_typedArray_toSorted;function requireEs_typedArray_toSorted(){if(hasRequiredEs_typedArray_toSorted)return es_typedArray_toSorted;hasRequiredEs_typedArray_toSorted=1;var Y=requireArrayBufferViewCore(),K=requireFunctionUncurryThis(),ee=requireACallable(),ne=requireArrayFromConstructorAndList(),re=Y.aTypedArray,le=Y.getTypedArrayConstructor,Q=Y.exportTypedArrayMethod,R=K(Y.TypedArrayPrototype.sort);return Q("toSorted",function(Z){Z!==void 0&&ee(Z);var ae=re(this),he=ne(le(ae),ae);return R(he,Z)}),es_typedArray_toSorted}var es_typedArray_toString={},hasRequiredEs_typedArray_toString;function requireEs_typedArray_toString(){if(hasRequiredEs_typedArray_toString)return es_typedArray_toString;hasRequiredEs_typedArray_toString=1;var Y=requireArrayBufferViewCore().exportTypedArrayMethod,K=requireFails(),ee=requireGlobalThis(),ne=requireFunctionUncurryThis(),re=ee.Uint8Array,le=re&&re.prototype||{},Q=[].toString,R=ne([].join);K(function(){Q.call({})})&&(Q=function(){return R(this)});var U=le.toString!==Q;return Y("toString",Q,U),es_typedArray_toString}var es_typedArray_with={},hasRequiredEs_typedArray_with;function requireEs_typedArray_with(){if(hasRequiredEs_typedArray_with)return es_typedArray_with;hasRequiredEs_typedArray_with=1;var Y=requireArrayWith(),K=requireArrayBufferViewCore(),ee=requireIsBigIntArray(),ne=requireToIntegerOrInfinity(),re=requireToBigInt(),le=K.aTypedArray,Q=K.getTypedArrayConstructor,R=K.exportTypedArrayMethod,U=function(){try{new Int8Array(1).with(2,{valueOf:function(){throw 8}})}catch(ae){return ae===8}}(),Z=U&&function(){try{new Int8Array(1).with(-.5,1)}catch{return!0}}();return R("with",function(ae,he){var pe=le(this),me=ne(ae),ve=ee(pe)?re(he):+he;return Y(pe,Q(pe),me,ve)},!U||Z),es_typedArray_with}var es_unescape={},hasRequiredEs_unescape;function requireEs_unescape(){if(hasRequiredEs_unescape)return es_unescape;hasRequiredEs_unescape=1;var Y=require_export(),K=requireFunctionUncurryThis(),ee=requireToString$1(),ne=String.fromCharCode,re=K("".charAt),le=K(/./.exec),Q=K("".slice),R=/^[\da-f]{2}$/i,U=/^[\da-f]{4}$/i;return Y({global:!0},{unescape:function(ae){for(var he=ee(ae),pe="",me=he.length,ve=0,Re,Me;ve<me;){if(Re=re(he,ve++),Re==="%"){if(re(he,ve)==="u"){if(Me=Q(he,ve+1,ve+5),le(U,Me)){pe+=ne(parseInt(Me,16)),ve+=5;continue}}else if(Me=Q(he,ve,ve+2),le(R,Me)){pe+=ne(parseInt(Me,16)),ve+=2;continue}}pe+=Re}return pe}}),es_unescape}var es_weakMap={},es_weakMap_constructor={},collectionWeak,hasRequiredCollectionWeak;function requireCollectionWeak(){if(hasRequiredCollectionWeak)return collectionWeak;hasRequiredCollectionWeak=1;var Y=requireFunctionUncurryThis(),K=requireDefineBuiltIns(),ee=requireInternalMetadata().getWeakData,ne=requireAnInstance(),re=requireAnObject(),le=requireIsNullOrUndefined(),Q=requireIsObject$1(),R=requireIterate(),U=requireArrayIteration(),Z=requireHasOwnProperty(),ae=requireInternalState(),he=ae.set,pe=ae.getterFor,me=U.find,ve=U.findIndex,Re=Y([].splice),Me=0,Te=function(Fe){return Fe.frozen||(Fe.frozen=new Ce)},Ce=function(){this.entries=[]},We=function(Fe,ke){return me(Fe.entries,function(Ze){return Ze[0]===ke})};return Ce.prototype={get:function(Fe){var ke=We(this,Fe);if(ke)return ke[1]},has:function(Fe){return!!We(this,Fe)},set:function(Fe,ke){var Ze=We(this,Fe);Ze?Ze[1]=ke:this.entries.push([Fe,ke])},delete:function(Fe){var ke=ve(this.entries,function(Ze){return Ze[0]===Fe});return~ke&&Re(this.entries,ke,1),!!~ke}},collectionWeak={getConstructor:function(Fe,ke,Ze,Je){var Qe=Fe(function(yt,gt){ne(yt,it),he(yt,{type:ke,id:Me++,frozen:null}),le(gt)||R(gt,yt[Je],{that:yt,AS_ENTRIES:Ze})}),it=Qe.prototype,lt=pe(ke),dt=function(yt,gt,qt){var Ft=lt(yt),Gt=ee(re(gt),!0);return Gt===!0?Te(Ft).set(gt,qt):Gt[Ft.id]=qt,yt};return K(it,{delete:function(yt){var gt=lt(this);if(!Q(yt))return!1;var qt=ee(yt);return qt===!0?Te(gt).delete(yt):qt&&Z(qt,gt.id)&&delete qt[gt.id]},has:function(gt){var qt=lt(this);if(!Q(gt))return!1;var Ft=ee(gt);return Ft===!0?Te(qt).has(gt):Ft&&Z(Ft,qt.id)}}),K(it,Ze?{get:function(gt){var qt=lt(this);if(Q(gt)){var Ft=ee(gt);if(Ft===!0)return Te(qt).get(gt);if(Ft)return Ft[qt.id]}},set:function(gt,qt){return dt(this,gt,qt)}}:{add:function(gt){return dt(this,gt,!0)}}),Qe}},collectionWeak}var hasRequiredEs_weakMap_constructor;function requireEs_weakMap_constructor(){if(hasRequiredEs_weakMap_constructor)return es_weakMap_constructor;hasRequiredEs_weakMap_constructor=1;var Y=requireFreezing(),K=requireGlobalThis(),ee=requireFunctionUncurryThis(),ne=requireDefineBuiltIns(),re=requireInternalMetadata(),le=requireCollection(),Q=requireCollectionWeak(),R=requireIsObject$1(),U=requireInternalState().enforce,Z=requireFails(),ae=requireWeakMapBasicDetection(),he=Object,pe=Array.isArray,me=he.isExtensible,ve=he.isFrozen,Re=he.isSealed,Me=he.freeze,Te=he.seal,Ce=!K.ActiveXObject&&"ActiveXObject"in K,We,Fe=function(yt){return function(){return yt(this,arguments.length?arguments[0]:void 0)}},ke=le("WeakMap",Fe,Q),Ze=ke.prototype,Je=ee(Ze.set),Qe=function(){return Y&&Z(function(){var yt=Me([]);return Je(new ke,yt,1),!ve(yt)})};if(ae)if(Ce){We=Q.getConstructor(Fe,"WeakMap",!0),re.enable();var it=ee(Ze.delete),lt=ee(Ze.has),dt=ee(Ze.get);ne(Ze,{delete:function(yt){if(R(yt)&&!me(yt)){var gt=U(this);return gt.frozen||(gt.frozen=new We),it(this,yt)||gt.frozen.delete(yt)}return it(this,yt)},has:function(gt){if(R(gt)&&!me(gt)){var qt=U(this);return qt.frozen||(qt.frozen=new We),lt(this,gt)||qt.frozen.has(gt)}return lt(this,gt)},get:function(gt){if(R(gt)&&!me(gt)){var qt=U(this);return qt.frozen||(qt.frozen=new We),lt(this,gt)?dt(this,gt):qt.frozen.get(gt)}return dt(this,gt)},set:function(gt,qt){if(R(gt)&&!me(gt)){var Ft=U(this);Ft.frozen||(Ft.frozen=new We),lt(this,gt)?Je(this,gt,qt):Ft.frozen.set(gt,qt)}else Je(this,gt,qt);return this}})}else Qe()&&ne(Ze,{set:function(gt,qt){var Ft;return pe(gt)&&(ve(gt)?Ft=Me:Re(gt)&&(Ft=Te)),Je(this,gt,qt),Ft&&Ft(gt),this}});return es_weakMap_constructor}var hasRequiredEs_weakMap;function requireEs_weakMap(){return hasRequiredEs_weakMap||(hasRequiredEs_weakMap=1,requireEs_weakMap_constructor()),es_weakMap}var es_weakSet={},es_weakSet_constructor={},hasRequiredEs_weakSet_constructor;function requireEs_weakSet_constructor(){if(hasRequiredEs_weakSet_constructor)return es_weakSet_constructor;hasRequiredEs_weakSet_constructor=1;var Y=requireCollection(),K=requireCollectionWeak();return Y("WeakSet",function(ee){return function(){return ee(this,arguments.length?arguments[0]:void 0)}},K),es_weakSet_constructor}var hasRequiredEs_weakSet;function requireEs_weakSet(){return hasRequiredEs_weakSet||(hasRequiredEs_weakSet=1,requireEs_weakSet_constructor()),es_weakSet}var web_atob={},base64Map,hasRequiredBase64Map;function requireBase64Map(){if(hasRequiredBase64Map)return base64Map;hasRequiredBase64Map=1;var Y="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",K=Y+"+/",ee=Y+"-_",ne=function(re){for(var le={},Q=0;Q<64;Q++)le[re.charAt(Q)]=Q;return le};return base64Map={i2c:K,c2i:ne(K),i2cUrl:ee,c2iUrl:ne(ee)},base64Map}var hasRequiredWeb_atob;function requireWeb_atob(){if(hasRequiredWeb_atob)return web_atob;hasRequiredWeb_atob=1;var Y=require_export(),K=requireGlobalThis(),ee=requireGetBuiltIn(),ne=requireFunctionUncurryThis(),re=requireFunctionCall(),le=requireFails(),Q=requireToString$1(),R=requireValidateArgumentsLength(),U=requireBase64Map().c2i,Z=/[^\d+/a-z]/i,ae=/[\t\n\f\r ]+/g,he=/[=]{1,2}$/,pe=ee("atob"),me=String.fromCharCode,ve=ne("".charAt),Re=ne("".replace),Me=ne(Z.exec),Te=!!pe&&!le(function(){return pe("aGk=")!=="hi"}),Ce=Te&&le(function(){return pe(" ")!==""}),We=Te&&!le(function(){pe("a")}),Fe=Te&&!le(function(){pe()}),ke=Te&&pe.length!==1,Ze=!Te||Ce||We||Fe||ke;return Y({global:!0,bind:!0,enumerable:!0,forced:Ze},{atob:function(Qe){if(R(arguments.length,1),Te&&!Ce&&!We)return re(pe,K,Qe);var it=Re(Q(Qe),ae,""),lt="",dt=0,yt=0,gt,qt,Ft;if(it.length%4===0&&(it=Re(it,he,"")),gt=it.length,gt%4===1||Me(Z,it))throw new(ee("DOMException"))("The string is not correctly encoded","InvalidCharacterError");for(;dt<gt;)qt=ve(it,dt++),Ft=yt%4?Ft*64+U[qt]:U[qt],yt++%4&&(lt+=me(255&Ft>>(-2*yt&6)));return lt}}),web_atob}var web_btoa={},hasRequiredWeb_btoa;function requireWeb_btoa(){if(hasRequiredWeb_btoa)return web_btoa;hasRequiredWeb_btoa=1;var Y=require_export(),K=requireGlobalThis(),ee=requireGetBuiltIn(),ne=requireFunctionUncurryThis(),re=requireFunctionCall(),le=requireFails(),Q=requireToString$1(),R=requireValidateArgumentsLength(),U=requireBase64Map().i2c,Z=ee("btoa"),ae=ne("".charAt),he=ne("".charCodeAt),pe=!!Z&&!le(function(){return Z("hi")!=="aGk="}),me=pe&&!le(function(){Z()}),ve=pe&&le(function(){return Z(null)!=="bnVsbA=="}),Re=pe&&Z.length!==1;return Y({global:!0,bind:!0,enumerable:!0,forced:!pe||me||ve||Re},{btoa:function(Te){if(R(arguments.length,1),pe)return re(Z,K,Q(Te));for(var Ce=Q(Te),We="",Fe=0,ke=U,Ze,Je;ae(Ce,Fe)||(ke="=",Fe%1);){if(Je=he(Ce,Fe+=3/4),Je>255)throw new(ee("DOMException"))("The string contains characters outside of the Latin1 range","InvalidCharacterError");Ze=Ze<<8|Je,We+=ae(ke,63&Ze>>8-Fe%1*8)}return We}}),web_btoa}var web_domCollections_forEach={},domIterables,hasRequiredDomIterables;function requireDomIterables(){return hasRequiredDomIterables||(hasRequiredDomIterables=1,domIterables={CSSRuleList:0,CSSStyleDeclaration:0,CSSValueList:0,ClientRectList:0,DOMRectList:0,DOMStringList:0,DOMTokenList:1,DataTransferItemList:0,FileList:0,HTMLAllCollection:0,HTMLCollection:0,HTMLFormElement:0,HTMLSelectElement:0,MediaList:0,MimeTypeArray:0,NamedNodeMap:0,NodeList:1,PaintRequestList:0,Plugin:0,PluginArray:0,SVGLengthList:0,SVGNumberList:0,SVGPathSegList:0,SVGPointList:0,SVGStringList:0,SVGTransformList:0,SourceBufferList:0,StyleSheetList:0,TextTrackCueList:0,TextTrackList:0,TouchList:0}),domIterables}var domTokenListPrototype,hasRequiredDomTokenListPrototype;function requireDomTokenListPrototype(){if(hasRequiredDomTokenListPrototype)return domTokenListPrototype;hasRequiredDomTokenListPrototype=1;var Y=requireDocumentCreateElement(),K=Y("span").classList,ee=K&&K.constructor&&K.constructor.prototype;return domTokenListPrototype=ee===Object.prototype?void 0:ee,domTokenListPrototype}var hasRequiredWeb_domCollections_forEach;function requireWeb_domCollections_forEach(){if(hasRequiredWeb_domCollections_forEach)return web_domCollections_forEach;hasRequiredWeb_domCollections_forEach=1;var Y=requireGlobalThis(),K=requireDomIterables(),ee=requireDomTokenListPrototype(),ne=requireArrayForEach(),re=requireCreateNonEnumerableProperty(),le=function(R){if(R&&R.forEach!==ne)try{re(R,"forEach",ne)}catch{R.forEach=ne}};for(var Q in K)K[Q]&&le(Y[Q]&&Y[Q].prototype);return le(ee),web_domCollections_forEach}var web_domCollections_iterator={},hasRequiredWeb_domCollections_iterator;function requireWeb_domCollections_iterator(){if(hasRequiredWeb_domCollections_iterator)return web_domCollections_iterator;hasRequiredWeb_domCollections_iterator=1;var Y=requireGlobalThis(),K=requireDomIterables(),ee=requireDomTokenListPrototype(),ne=requireEs_array_iterator(),re=requireCreateNonEnumerableProperty(),le=requireSetToStringTag(),Q=requireWellKnownSymbol(),R=Q("iterator"),U=ne.values,Z=function(he,pe){if(he){if(he[R]!==U)try{re(he,R,U)}catch{he[R]=U}if(le(he,pe,!0),K[pe]){for(var me in ne)if(he[me]!==ne[me])try{re(he,me,ne[me])}catch{he[me]=ne[me]}}}};for(var ae in K)Z(Y[ae]&&Y[ae].prototype,ae);return Z(ee,"DOMTokenList"),web_domCollections_iterator}var web_domException_constructor={},domExceptionConstants,hasRequiredDomExceptionConstants;function requireDomExceptionConstants(){return hasRequiredDomExceptionConstants||(hasRequiredDomExceptionConstants=1,domExceptionConstants={IndexSizeError:{s:"INDEX_SIZE_ERR",c:1,m:1},DOMStringSizeError:{s:"DOMSTRING_SIZE_ERR",c:2,m:0},HierarchyRequestError:{s:"HIERARCHY_REQUEST_ERR",c:3,m:1},WrongDocumentError:{s:"WRONG_DOCUMENT_ERR",c:4,m:1},InvalidCharacterError:{s:"INVALID_CHARACTER_ERR",c:5,m:1},NoDataAllowedError:{s:"NO_DATA_ALLOWED_ERR",c:6,m:0},NoModificationAllowedError:{s:"NO_MODIFICATION_ALLOWED_ERR",c:7,m:1},NotFoundError:{s:"NOT_FOUND_ERR",c:8,m:1},NotSupportedError:{s:"NOT_SUPPORTED_ERR",c:9,m:1},InUseAttributeError:{s:"INUSE_ATTRIBUTE_ERR",c:10,m:1},InvalidStateError:{s:"INVALID_STATE_ERR",c:11,m:1},SyntaxError:{s:"SYNTAX_ERR",c:12,m:1},InvalidModificationError:{s:"INVALID_MODIFICATION_ERR",c:13,m:1},NamespaceError:{s:"NAMESPACE_ERR",c:14,m:1},InvalidAccessError:{s:"INVALID_ACCESS_ERR",c:15,m:1},ValidationError:{s:"VALIDATION_ERR",c:16,m:0},TypeMismatchError:{s:"TYPE_MISMATCH_ERR",c:17,m:1},SecurityError:{s:"SECURITY_ERR",c:18,m:1},NetworkError:{s:"NETWORK_ERR",c:19,m:1},AbortError:{s:"ABORT_ERR",c:20,m:1},URLMismatchError:{s:"URL_MISMATCH_ERR",c:21,m:1},QuotaExceededError:{s:"QUOTA_EXCEEDED_ERR",c:22,m:1},TimeoutError:{s:"TIMEOUT_ERR",c:23,m:1},InvalidNodeTypeError:{s:"INVALID_NODE_TYPE_ERR",c:24,m:1},DataCloneError:{s:"DATA_CLONE_ERR",c:25,m:1}}),domExceptionConstants}var hasRequiredWeb_domException_constructor;function requireWeb_domException_constructor(){if(hasRequiredWeb_domException_constructor)return web_domException_constructor;hasRequiredWeb_domException_constructor=1;var Y=require_export(),K=requireGetBuiltIn(),ee=requireGetBuiltInNodeModule(),ne=requireFails(),re=requireObjectCreate(),le=requireCreatePropertyDescriptor(),Q=requireObjectDefineProperty().f,R=requireDefineBuiltIn(),U=requireDefineBuiltInAccessor(),Z=requireHasOwnProperty(),ae=requireAnInstance(),he=requireAnObject(),pe=requireErrorToString(),me=requireNormalizeStringArgument(),ve=requireDomExceptionConstants(),Re=requireErrorStackClear(),Me=requireInternalState(),Te=requireDescriptors(),Ce=requireIsPure(),We="DOMException",Fe="DATA_CLONE_ERR",ke=K("Error"),Ze=K(We)||function(){try{var Qt=K("MessageChannel")||ee("worker_threads").MessageChannel;new Qt().port1.postMessage(new WeakMap)}catch(or){if(or.name===Fe&&or.code===25)return or.constructor}}(),Je=Ze&&Ze.prototype,Qe=ke.prototype,it=Me.set,lt=Me.getterFor(We),dt="stack"in new ke(We),yt=function(Qt){return Z(ve,Qt)&&ve[Qt].m?ve[Qt].c:0},gt=function(){ae(this,qt);var or=arguments.length,Ir=me(or<1?void 0:arguments[0]),Rr=me(or<2?void 0:arguments[1],"Error"),Cr=yt(Rr);if(it(this,{type:We,name:Rr,message:Ir,code:Cr}),Te||(this.name=Rr,this.message=Ir,this.code=Cr),dt){var wr=new ke(Ir);wr.name=We,Q(this,"stack",le(1,Re(wr.stack,1)))}},qt=gt.prototype=re(Qe),Ft=function(Qt){return{enumerable:!0,configurable:!0,get:Qt}},Gt=function(Qt){return Ft(function(){return lt(this)[Qt]})};Te&&(U(qt,"code",Gt("code")),U(qt,"message",Gt("message")),U(qt,"name",Gt("name"))),Q(qt,"constructor",le(1,gt));var ft=ne(function(){return!(new Ze instanceof ke)}),Rt=ft||ne(function(){return Qe.toString!==pe||String(new Ze(1,2))!=="2: 1"}),pt=ft||ne(function(){return new Ze(1,"DataCloneError").code!==25}),At=ft||Ze[Fe]!==25||Je[Fe]!==25,It=Ce?Rt||pt||At:ft;Y({global:!0,constructor:!0,forced:It},{DOMException:It?gt:Ze});var Dt=K(We),Zt=Dt.prototype;Rt&&(Ce||Ze===Dt)&&R(Zt,"toString",pe),pt&&Te&&Ze===Dt&&U(Zt,"code",Ft(function(){return yt(he(this).name)}));for(var nr in ve)if(Z(ve,nr)){var Er=ve[nr],vr=Er.s,Sr=le(6,Er.c);Z(Dt,vr)||Q(Dt,vr,Sr),Z(Zt,vr)||Q(Zt,vr,Sr)}return web_domException_constructor}var web_domException_stack={},hasRequiredWeb_domException_stack;function requireWeb_domException_stack(){if(hasRequiredWeb_domException_stack)return web_domException_stack;hasRequiredWeb_domException_stack=1;var Y=require_export(),K=requireGlobalThis(),ee=requireGetBuiltIn(),ne=requireCreatePropertyDescriptor(),re=requireObjectDefineProperty().f,le=requireHasOwnProperty(),Q=requireAnInstance(),R=requireInheritIfRequired(),U=requireNormalizeStringArgument(),Z=requireDomExceptionConstants(),ae=requireErrorStackClear(),he=requireDescriptors(),pe=requireIsPure(),me="DOMException",ve=ee("Error"),Re=ee(me),Me=function(){Q(this,Te);var gt=arguments.length,qt=U(gt<1?void 0:arguments[0]),Ft=U(gt<2?void 0:arguments[1],"Error"),Gt=new Re(qt,Ft),ft=new ve(qt);return ft.name=me,re(Gt,"stack",ne(1,ae(ft.stack,1))),R(Gt,this,Me),Gt},Te=Me.prototype=Re.prototype,Ce="stack"in new ve(me),We="stack"in new Re(1,2),Fe=Re&&he&&Object.getOwnPropertyDescriptor(K,me),ke=!!Fe&&!(Fe.writable&&Fe.configurable),Ze=Ce&&!ke&&!We;Y({global:!0,constructor:!0,forced:pe||Ze},{DOMException:Ze?Me:Re});var Je=ee(me),Qe=Je.prototype;if(Qe.constructor!==Je){pe||re(Qe,"constructor",ne(1,Je));for(var it in Z)if(le(Z,it)){var lt=Z[it],dt=lt.s;le(Je,dt)||re(Je,dt,ne(6,lt.c))}}return web_domException_stack}var web_domException_toStringTag={},hasRequiredWeb_domException_toStringTag;function requireWeb_domException_toStringTag(){if(hasRequiredWeb_domException_toStringTag)return web_domException_toStringTag;hasRequiredWeb_domException_toStringTag=1;var Y=requireGetBuiltIn(),K=requireSetToStringTag(),ee="DOMException";return K(Y(ee),ee),web_domException_toStringTag}var web_immediate={},web_clearImmediate={},hasRequiredWeb_clearImmediate;function requireWeb_clearImmediate(){if(hasRequiredWeb_clearImmediate)return web_clearImmediate;hasRequiredWeb_clearImmediate=1;var Y=require_export(),K=requireGlobalThis(),ee=requireTask().clear;return Y({global:!0,bind:!0,enumerable:!0,forced:K.clearImmediate!==ee},{clearImmediate:ee}),web_clearImmediate}var web_setImmediate={},schedulersFix,hasRequiredSchedulersFix;function requireSchedulersFix(){if(hasRequiredSchedulersFix)return schedulersFix;hasRequiredSchedulersFix=1;var Y=requireGlobalThis(),K=requireFunctionApply(),ee=requireIsCallable(),ne=requireEnvironment(),re=requireEnvironmentUserAgent(),le=requireArraySlice(),Q=requireValidateArgumentsLength(),R=Y.Function,U=/MSIE .\./.test(re)||ne==="BUN"&&function(){var Z=Y.Bun.version.split(".");return Z.length<3||Z[0]==="0"&&(Z[1]<3||Z[1]==="3"&&Z[2]==="0")}();return schedulersFix=function(Z,ae){var he=ae?2:1;return U?function(pe,me){var ve=Q(arguments.length,1)>he,Re=ee(pe)?pe:R(pe),Me=ve?le(arguments,he):[],Te=ve?function(){K(Re,this,Me)}:Re;return ae?Z(Te,me):Z(Te)}:Z},schedulersFix}var hasRequiredWeb_setImmediate;function requireWeb_setImmediate(){if(hasRequiredWeb_setImmediate)return web_setImmediate;hasRequiredWeb_setImmediate=1;var Y=require_export(),K=requireGlobalThis(),ee=requireTask().set,ne=requireSchedulersFix(),re=K.setImmediate?ne(ee,!1):ee;return Y({global:!0,bind:!0,enumerable:!0,forced:K.setImmediate!==re},{setImmediate:re}),web_setImmediate}var hasRequiredWeb_immediate;function requireWeb_immediate(){return hasRequiredWeb_immediate||(hasRequiredWeb_immediate=1,requireWeb_clearImmediate(),requireWeb_setImmediate()),web_immediate}var web_queueMicrotask={},hasRequiredWeb_queueMicrotask;function requireWeb_queueMicrotask(){if(hasRequiredWeb_queueMicrotask)return web_queueMicrotask;hasRequiredWeb_queueMicrotask=1;var Y=require_export(),K=requireGlobalThis(),ee=requireMicrotask(),ne=requireACallable(),re=requireValidateArgumentsLength(),le=requireFails(),Q=requireDescriptors(),R=le(function(){return Q&&Object.getOwnPropertyDescriptor(K,"queueMicrotask").value.length!==1});return Y({global:!0,enumerable:!0,dontCallGetSet:!0,forced:R},{queueMicrotask:function(Z){re(arguments.length,1),ee(ne(Z))}}),web_queueMicrotask}var web_self={},hasRequiredWeb_self;function requireWeb_self(){if(hasRequiredWeb_self)return web_self;hasRequiredWeb_self=1;var Y=require_export(),K=requireGlobalThis(),ee=requireDefineBuiltInAccessor(),ne=requireDescriptors(),re=TypeError,le=Object.defineProperty,Q=K.self!==K;try{if(ne){var R=Object.getOwnPropertyDescriptor(K,"self");(Q||!R||!R.get||!R.enumerable)&&ee(K,"self",{get:function(){return K},set:function(Z){if(this!==K)throw new re("Illegal invocation");le(K,"self",{value:Z,writable:!0,configurable:!0,enumerable:!0})},configurable:!0,enumerable:!0})}else Y({global:!0,simple:!0,forced:Q},{self:K})}catch{}return web_self}var web_structuredClone={},hasRequiredWeb_structuredClone;function requireWeb_structuredClone(){if(hasRequiredWeb_structuredClone)return web_structuredClone;hasRequiredWeb_structuredClone=1;var Y=requireIsPure(),K=require_export(),ee=requireGlobalThis(),ne=requireGetBuiltIn(),re=requireFunctionUncurryThis(),le=requireFails(),Q=requireUid(),R=requireIsCallable(),U=requireIsConstructor(),Z=requireIsNullOrUndefined(),ae=requireIsObject$1(),he=requireIsSymbol$1(),pe=requireIterate(),me=requireAnObject(),ve=requireClassof(),Re=requireHasOwnProperty(),Me=requireCreateProperty(),Te=requireCreateNonEnumerableProperty(),Ce=requireLengthOfArrayLike(),We=requireValidateArgumentsLength(),Fe=requireRegexpGetFlags(),ke=requireMapHelpers(),Ze=requireSetHelpers(),Je=requireSetIterate(),Qe=requireDetachTransferable(),it=requireErrorStackInstallable(),lt=requireStructuredCloneProperTransfer(),dt=ee.Object,yt=ee.Array,gt=ee.Date,qt=ee.Error,Ft=ee.TypeError,Gt=ee.PerformanceMark,ft=ne("DOMException"),Rt=ke.Map,pt=ke.has,At=ke.get,It=ke.set,Dt=Ze.Set,Zt=Ze.add,nr=Ze.has,Er=ne("Object","keys"),vr=re([].push),Sr=re((!0).valueOf),Qt=re(1.1.valueOf),or=re("".valueOf),Ir=re(gt.prototype.getTime),Rr=Q("structuredClone"),Cr="DataCloneError",wr="Transferring",Wr=function(He){return!le(function(){var ut=new ee.Set([7]),Ve=He(ut),qe=He(dt(7));return Ve===ut||!Ve.has(7)||!ae(qe)||+qe!=7})&&He},Kr=function(He,ut){return!le(function(){var Ve=new ut,qe=He({a:Ve,b:Ve});return!(qe&&qe.a===qe.b&&qe.a instanceof ut&&qe.a.stack===Ve.stack)})},Hr=function(He){return!le(function(){var ut=He(new ee.AggregateError([1],Rr,{cause:3}));return ut.name!=="AggregateError"||ut.errors[0]!==1||ut.message!==Rr||ut.cause!==3})},br=ee.structuredClone,Lr=Y||!Kr(br,qt)||!Kr(br,ft)||!Hr(br),Br=!br&&Wr(function(He){return new Gt(Rr,{detail:He}).detail}),zr=Wr(br)||Br,rr=function(He){throw new ft("Uncloneable type: "+He,Cr)},sr=function(He,ut){throw new ft((ut||"Cloning")+" of "+He+" cannot be properly polyfilled in this engine",Cr)},Dr=function(He,ut){return zr||sr(ut),zr(He)},lr=function(){var He;try{He=new ee.DataTransfer}catch{try{He=new ee.ClipboardEvent("").clipboardData}catch{}}return He&&He.items&&He.files?He:null},yr=function(He,ut,Ve){if(pt(ut,He))return At(ut,He);var qe=Ve||ve(He),De,ze,Le,Ke,et,_t;if(qe==="SharedArrayBuffer")zr?De=zr(He):De=He;else{var st=ee.DataView;!st&&!R(He.slice)&&sr("ArrayBuffer");try{if(R(He.slice)&&!He.resizable)De=He.slice(0);else for(ze=He.byteLength,Le=("maxByteLength"in He)?{maxByteLength:He.maxByteLength}:void 0,De=new ArrayBuffer(ze,Le),Ke=new st(He),et=new st(De),_t=0;_t<ze;_t++)et.setUint8(_t,Ke.getUint8(_t))}catch{throw new ft("ArrayBuffer is detached",Cr)}}return It(ut,He,De),De},xr=function(He,ut,Ve,qe,De){var ze=ee[ut];return ae(ze)||sr(ut),new ze(yr(He.buffer,De),Ve,qe)},Ge=function(He,ut){if(he(He)&&rr("Symbol"),!ae(He))return He;if(ut){if(pt(ut,He))return At(ut,He)}else ut=new Rt;var Ve=ve(He),qe,De,ze,Le,Ke,et,_t,st;switch(Ve){case"Array":ze=yt(Ce(He));break;case"Object":ze={};break;case"Map":ze=new Rt;break;case"Set":ze=new Dt;break;case"RegExp":ze=new RegExp(He.source,Fe(He));break;case"Error":switch(De=He.name,De){case"AggregateError":ze=new(ne(De))([]);break;case"EvalError":case"RangeError":case"ReferenceError":case"SuppressedError":case"SyntaxError":case"TypeError":case"URIError":ze=new(ne(De));break;case"CompileError":case"LinkError":case"RuntimeError":ze=new(ne("WebAssembly",De));break;default:ze=new qt}break;case"DOMException":ze=new ft(He.message,He.name);break;case"ArrayBuffer":case"SharedArrayBuffer":ze=yr(He,ut,Ve);break;case"DataView":case"Int8Array":case"Uint8Array":case"Uint8ClampedArray":case"Int16Array":case"Uint16Array":case"Int32Array":case"Uint32Array":case"Float16Array":case"Float32Array":case"Float64Array":case"BigInt64Array":case"BigUint64Array":et=Ve==="DataView"?He.byteLength:He.length,ze=xr(He,Ve,He.byteOffset,et,ut);break;case"DOMQuad":try{ze=new DOMQuad(Ge(He.p1,ut),Ge(He.p2,ut),Ge(He.p3,ut),Ge(He.p4,ut))}catch{ze=Dr(He,Ve)}break;case"File":if(zr)try{ze=zr(He),ve(ze)!==Ve&&(ze=void 0)}catch{}if(!ze)try{ze=new File([He],He.name,He)}catch{}ze||sr(Ve);break;case"FileList":if(Le=lr(),Le){for(Ke=0,et=Ce(He);Ke<et;Ke++)Le.items.add(Ge(He[Ke],ut));ze=Le.files}else ze=Dr(He,Ve);break;case"ImageData":try{ze=new ImageData(Ge(He.data,ut),He.width,He.height,{colorSpace:He.colorSpace})}catch{ze=Dr(He,Ve)}break;default:if(zr)ze=zr(He);else switch(Ve){case"BigInt":ze=dt(He.valueOf());break;case"Boolean":ze=dt(Sr(He));break;case"Number":ze=dt(Qt(He));break;case"String":ze=dt(or(He));break;case"Date":ze=new gt(Ir(He));break;case"Blob":try{ze=He.slice(0,He.size,He.type)}catch{sr(Ve)}break;case"DOMPoint":case"DOMPointReadOnly":qe=ee[Ve];try{ze=qe.fromPoint?qe.fromPoint(He):new qe(He.x,He.y,He.z,He.w)}catch{sr(Ve)}break;case"DOMRect":case"DOMRectReadOnly":qe=ee[Ve];try{ze=qe.fromRect?qe.fromRect(He):new qe(He.x,He.y,He.width,He.height)}catch{sr(Ve)}break;case"DOMMatrix":case"DOMMatrixReadOnly":qe=ee[Ve];try{ze=qe.fromMatrix?qe.fromMatrix(He):new qe(He)}catch{sr(Ve)}break;case"AudioData":case"VideoFrame":R(He.clone)||sr(Ve);try{ze=He.clone()}catch{rr(Ve)}break;case"CropTarget":case"CryptoKey":case"FileSystemDirectoryHandle":case"FileSystemFileHandle":case"FileSystemHandle":case"GPUCompilationInfo":case"GPUCompilationMessage":case"ImageBitmap":case"RTCCertificate":case"WebAssembly.Module":sr(Ve);default:rr(Ve)}}switch(It(ut,He,ze),Ve){case"Array":case"Object":for(_t=Er(He),Ke=0,et=Ce(_t);Ke<et;Ke++)st=_t[Ke],Me(ze,st,Ge(He[st],ut));break;case"Map":He.forEach(function(bt,Mt){It(ze,Ge(Mt,ut),Ge(bt,ut))});break;case"Set":He.forEach(function(bt){Zt(ze,Ge(bt,ut))});break;case"Error":Te(ze,"message",Ge(He.message,ut)),Re(He,"cause")&&Te(ze,"cause",Ge(He.cause,ut)),De==="AggregateError"?ze.errors=Ge(He.errors,ut):De==="SuppressedError"&&(ze.error=Ge(He.error,ut),ze.suppressed=Ge(He.suppressed,ut));case"DOMException":it&&Te(ze,"stack",Ge(He.stack,ut))}return ze},Ee=function(He,ut){if(!ae(He))throw new Ft("Transfer option cannot be converted to a sequence");var Ve=[];pe(He,function(Mt){vr(Ve,me(Mt))});for(var qe=0,De=Ce(Ve),ze=new Dt,Le,Ke,et,_t,st,bt;qe<De;){if(Le=Ve[qe++],Ke=ve(Le),Ke==="ArrayBuffer"?nr(ze,Le):pt(ut,Le))throw new ft("Duplicate transferable",Cr);if(Ke==="ArrayBuffer"){Zt(ze,Le);continue}if(lt)_t=br(Le,{transfer:[Le]});else switch(Ke){case"ImageBitmap":et=ee.OffscreenCanvas,U(et)||sr(Ke,wr);try{st=new et(Le.width,Le.height),bt=st.getContext("bitmaprenderer"),bt.transferFromImageBitmap(Le),_t=st.transferToImageBitmap()}catch{}break;case"AudioData":case"VideoFrame":(!R(Le.clone)||!R(Le.close))&&sr(Ke,wr);try{_t=Le.clone(),Le.close()}catch{}break;case"MediaSourceHandle":case"MessagePort":case"MIDIAccess":case"OffscreenCanvas":case"ReadableStream":case"RTCDataChannel":case"TransformStream":case"WebTransportReceiveStream":case"WebTransportSendStream":case"WritableStream":sr(Ke,wr)}if(_t===void 0)throw new ft("This object cannot be transferred: "+Ke,Cr);It(ut,Le,_t)}return ze},Pe=function(He){Je(He,function(ut){lt?zr(ut,{transfer:[ut]}):R(ut.transfer)?ut.transfer():Qe?Qe(ut):sr("ArrayBuffer",wr)})};return K({global:!0,enumerable:!0,sham:!lt,forced:Lr},{structuredClone:function(ut){var Ve=We(arguments.length,1)>1&&!Z(arguments[1])?me(arguments[1]):void 0,qe=Ve?Ve.transfer:void 0,De,ze;qe!==void 0&&(De=new Rt,ze=Ee(qe,De));var Le=Ge(ut,De);return ze&&Pe(ze),Le}}),web_structuredClone}var web_timers={},web_setInterval={},hasRequiredWeb_setInterval;function requireWeb_setInterval(){if(hasRequiredWeb_setInterval)return web_setInterval;hasRequiredWeb_setInterval=1;var Y=require_export(),K=requireGlobalThis(),ee=requireSchedulersFix(),ne=ee(K.setInterval,!0);return Y({global:!0,bind:!0,forced:K.setInterval!==ne},{setInterval:ne}),web_setInterval}var web_setTimeout={},hasRequiredWeb_setTimeout;function requireWeb_setTimeout(){if(hasRequiredWeb_setTimeout)return web_setTimeout;hasRequiredWeb_setTimeout=1;var Y=require_export(),K=requireGlobalThis(),ee=requireSchedulersFix(),ne=ee(K.setTimeout,!0);return Y({global:!0,bind:!0,forced:K.setTimeout!==ne},{setTimeout:ne}),web_setTimeout}var hasRequiredWeb_timers;function requireWeb_timers(){return hasRequiredWeb_timers||(hasRequiredWeb_timers=1,requireWeb_setInterval(),requireWeb_setTimeout()),web_timers}var web_url={},web_url_constructor={},urlConstructorDetection,hasRequiredUrlConstructorDetection;function requireUrlConstructorDetection(){if(hasRequiredUrlConstructorDetection)return urlConstructorDetection;hasRequiredUrlConstructorDetection=1;var Y=requireFails(),K=requireWellKnownSymbol(),ee=requireDescriptors(),ne=requireIsPure(),re=K("iterator");return urlConstructorDetection=!Y(function(){var le=new URL("b?a=1&b=2&c=3","https://a"),Q=le.searchParams,R=new URLSearchParams("a=1&a=2&b=3"),U="";return le.pathname="c%20d",Q.forEach(function(Z,ae){Q.delete("b"),U+=ae+Z}),R.delete("a",2),R.delete("b",void 0),ne&&(!le.toJSON||!R.has("a",1)||R.has("a",2)||!R.has("a",void 0)||R.has("b"))||!Q.size&&(ne||!ee)||!Q.sort||le.href!=="https://a/c%20d?a=1&c=3"||Q.get("c")!=="3"||String(new URLSearchParams("?a=1"))!=="a=1"||!Q[re]||new URL("https://a@b").username!=="a"||new URLSearchParams(new URLSearchParams("a=b")).get("a")!=="b"||new URL("https://тест").host!=="xn--e1aybc"||new URL("https://a#б").hash!=="#%D0%B1"||U!=="a1c3"||new URL("https://x",void 0).host!=="x"}),urlConstructorDetection}var stringPunycodeToAscii,hasRequiredStringPunycodeToAscii;function requireStringPunycodeToAscii(){if(hasRequiredStringPunycodeToAscii)return stringPunycodeToAscii;hasRequiredStringPunycodeToAscii=1;var Y=requireFunctionUncurryThis(),K=2147483647,ee=36,ne=1,re=26,le=38,Q=700,R=72,U=128,Z="-",ae=/[^\0-\u007E]/,he=/[.\u3002\uFF0E\uFF61]/g,pe="Overflow: input needs wider integers to process",me=ee-ne,ve=RangeError,Re=Y(he.exec),Me=Math.floor,Te=String.fromCharCode,Ce=Y("".charCodeAt),We=Y([].join),Fe=Y([].push),ke=Y("".replace),Ze=Y("".split),Je=Y("".toLowerCase),Qe=function(yt){for(var gt=[],qt=0,Ft=yt.length;qt<Ft;){var Gt=Ce(yt,qt++);if(Gt>=55296&&Gt<=56319&&qt<Ft){var ft=Ce(yt,qt++);(ft&64512)===56320?Fe(gt,((Gt&1023)<<10)+(ft&1023)+65536):(Fe(gt,Gt),qt--)}else Fe(gt,Gt)}return gt},it=function(yt){return yt+22+75*(yt<26)},lt=function(yt,gt,qt){var Ft=0;for(yt=qt?Me(yt/Q):yt>>1,yt+=Me(yt/gt);yt>me*re>>1;)yt=Me(yt/me),Ft+=ee;return Me(Ft+(me+1)*yt/(yt+le))},dt=function(yt){var gt=[];yt=Qe(yt);var qt=yt.length,Ft=U,Gt=0,ft=R,Rt,pt;for(Rt=0;Rt<yt.length;Rt++)pt=yt[Rt],pt<128&&Fe(gt,Te(pt));var At=gt.length,It=At;for(At&&Fe(gt,Z);It<qt;){var Dt=K;for(Rt=0;Rt<yt.length;Rt++)pt=yt[Rt],pt>=Ft&&pt<Dt&&(Dt=pt);var Zt=It+1;if(Dt-Ft>Me((K-Gt)/Zt))throw new ve(pe);for(Gt+=(Dt-Ft)*Zt,Ft=Dt,Rt=0;Rt<yt.length;Rt++){if(pt=yt[Rt],pt<Ft&&++Gt>K)throw new ve(pe);if(pt===Ft){for(var nr=Gt,Er=ee;;){var vr=Er<=ft?ne:Er>=ft+re?re:Er-ft;if(nr<vr)break;var Sr=nr-vr,Qt=ee-vr;Fe(gt,Te(it(vr+Sr%Qt))),nr=Me(Sr/Qt),Er+=ee}Fe(gt,Te(it(nr))),ft=lt(Gt,Zt,It===At),Gt=0,It++}}Gt++,Ft++}return We(gt,"")};return stringPunycodeToAscii=function(yt){var gt=[],qt=Ze(ke(Je(yt),he,"."),"."),Ft,Gt;for(Ft=0;Ft<qt.length;Ft++)Gt=qt[Ft],Fe(gt,Re(ae,Gt)?"xn--"+dt(Gt):Gt);return We(gt,".")},stringPunycodeToAscii}var web_urlSearchParams_constructor,hasRequiredWeb_urlSearchParams_constructor;function requireWeb_urlSearchParams_constructor(){if(hasRequiredWeb_urlSearchParams_constructor)return web_urlSearchParams_constructor;hasRequiredWeb_urlSearchParams_constructor=1,requireEs_array_iterator(),requireEs_string_fromCodePoint();var Y=require_export(),K=requireGlobalThis(),ee=requireSafeGetBuiltIn(),ne=requireGetBuiltIn(),re=requireFunctionCall(),le=requireFunctionUncurryThis(),Q=requireDescriptors(),R=requireUrlConstructorDetection(),U=requireDefineBuiltIn(),Z=requireDefineBuiltInAccessor(),ae=requireDefineBuiltIns(),he=requireSetToStringTag(),pe=requireIteratorCreateConstructor(),me=requireInternalState(),ve=requireAnInstance(),Re=requireIsCallable(),Me=requireHasOwnProperty(),Te=requireFunctionBindContext(),Ce=requireClassof(),We=requireAnObject(),Fe=requireIsObject$1(),ke=requireToString$1(),Ze=requireObjectCreate(),Je=requireCreatePropertyDescriptor(),Qe=requireGetIterator(),it=requireGetIteratorMethod(),lt=requireCreateIterResultObject(),dt=requireValidateArgumentsLength(),yt=requireWellKnownSymbol(),gt=requireArraySort(),qt=yt("iterator"),Ft="URLSearchParams",Gt=Ft+"Iterator",ft=me.set,Rt=me.getterFor(Ft),pt=me.getterFor(Gt),At=ee("fetch"),It=ee("Request"),Dt=ee("Headers"),Zt=It&&It.prototype,nr=Dt&&Dt.prototype,Er=K.TypeError,vr=K.encodeURIComponent,Sr=String.fromCharCode,Qt=ne("String","fromCodePoint"),or=parseInt,Ir=le("".charAt),Rr=le([].join),Cr=le([].push),wr=le("".replace),Wr=le([].shift),Kr=le([].splice),Hr=le("".split),br=le("".slice),Lr=le(/./.exec),Br=/\+/g,zr="�",rr=/^[0-9a-f]+$/i,sr=function(et,_t){var st=br(et,_t,_t+2);return Lr(rr,st)?or(st,16):NaN},Dr=function(et){for(var _t=0,st=128;st>0&&(et&st)!==0;st>>=1)_t++;return _t},lr=function(et){var _t=null;switch(et.length){case 1:_t=et[0];break;case 2:_t=(et[0]&31)<<6|et[1]&63;break;case 3:_t=(et[0]&15)<<12|(et[1]&63)<<6|et[2]&63;break;case 4:_t=(et[0]&7)<<18|(et[1]&63)<<12|(et[2]&63)<<6|et[3]&63;break}return _t>1114111?null:_t},yr=function(et){et=wr(et,Br," ");for(var _t=et.length,st="",bt=0;bt<_t;){var Mt=Ir(et,bt);if(Mt==="%"){if(Ir(et,bt+1)==="%"||bt+3>_t){st+="%",bt++;continue}var Ot=sr(et,bt+1);if(Ot!==Ot){st+=Mt,bt++;continue}bt+=2;var Nt=Dr(Ot);if(Nt===0)Mt=Sr(Ot);else{if(Nt===1||Nt>4){st+=zr,bt++;continue}for(var St=[Ot],ar=1;ar<Nt&&(bt++,!(bt+3>_t||Ir(et,bt)!=="%"));){var qr=sr(et,bt+1);if(qr!==qr){bt+=3;break}if(qr>191||qr<128)break;Cr(St,qr),bt+=2,ar++}if(St.length!==Nt){st+=zr;continue}var fr=lr(St);fr===null?st+=zr:Mt=Qt(fr)}}st+=Mt,bt++}return st},xr=/[!'()~]|%20/g,Ge={"!":"%21","'":"%27","(":"%28",")":"%29","~":"%7E","%20":"+"},Ee=function(et){return Ge[et]},Pe=function(et){return wr(vr(et),xr,Ee)},He=pe(function(_t,st){ft(this,{type:Gt,target:Rt(_t).entries,index:0,kind:st})},Ft,function(){var _t=pt(this),st=_t.target,bt=_t.index++;if(!st||bt>=st.length)return _t.target=null,lt(void 0,!0);var Mt=st[bt];switch(_t.kind){case"keys":return lt(Mt.key,!1);case"values":return lt(Mt.value,!1)}return lt([Mt.key,Mt.value],!1)},!0),ut=function(et){this.entries=[],this.url=null,et!==void 0&&(Fe(et)?this.parseObject(et):this.parseQuery(typeof et=="string"?Ir(et,0)==="?"?br(et,1):et:ke(et)))};ut.prototype={type:Ft,bindURL:function(et){this.url=et,this.update()},parseObject:function(et){var _t=this.entries,st=it(et),bt,Mt,Ot,Nt,St,ar,qr;if(st)for(bt=Qe(et,st),Mt=bt.next;!(Ot=re(Mt,bt)).done;){if(Nt=Qe(We(Ot.value)),St=Nt.next,(ar=re(St,Nt)).done||(qr=re(St,Nt)).done||!re(St,Nt).done)throw new Er("Expected sequence with length 2");Cr(_t,{key:ke(ar.value),value:ke(qr.value)})}else for(var fr in et)Me(et,fr)&&Cr(_t,{key:fr,value:ke(et[fr])})},parseQuery:function(et){if(et)for(var _t=this.entries,st=Hr(et,"&"),bt=0,Mt,Ot;bt<st.length;)Mt=st[bt++],Mt.length&&(Ot=Hr(Mt,"="),Cr(_t,{key:yr(Wr(Ot)),value:yr(Rr(Ot,"="))}))},serialize:function(){for(var et=this.entries,_t=[],st=0,bt;st<et.length;)bt=et[st++],Cr(_t,Pe(bt.key)+"="+Pe(bt.value));return Rr(_t,"&")},update:function(){this.entries.length=0,this.parseQuery(this.url.query)},updateURL:function(){this.url&&this.url.update()}};var Ve=function(){ve(this,qe);var _t=arguments.length>0?arguments[0]:void 0,st=ft(this,new ut(_t));Q||(this.size=st.entries.length)},qe=Ve.prototype;if(ae(qe,{append:function(_t,st){var bt=Rt(this);dt(arguments.length,2),Cr(bt.entries,{key:ke(_t),value:ke(st)}),Q||this.length++,bt.updateURL()},delete:function(et){for(var _t=Rt(this),st=dt(arguments.length,1),bt=_t.entries,Mt=ke(et),Ot=st<2?void 0:arguments[1],Nt=Ot===void 0?Ot:ke(Ot),St=0;St<bt.length;){var ar=bt[St];if(ar.key===Mt&&(Nt===void 0||ar.value===Nt)){if(Kr(bt,St,1),Nt!==void 0)break}else St++}Q||(this.size=bt.length),_t.updateURL()},get:function(_t){var st=Rt(this).entries;dt(arguments.length,1);for(var bt=ke(_t),Mt=0;Mt<st.length;Mt++)if(st[Mt].key===bt)return st[Mt].value;return null},getAll:function(_t){var st=Rt(this).entries;dt(arguments.length,1);for(var bt=ke(_t),Mt=[],Ot=0;Ot<st.length;Ot++)st[Ot].key===bt&&Cr(Mt,st[Ot].value);return Mt},has:function(_t){for(var st=Rt(this).entries,bt=dt(arguments.length,1),Mt=ke(_t),Ot=bt<2?void 0:arguments[1],Nt=Ot===void 0?Ot:ke(Ot),St=0;St<st.length;){var ar=st[St++];if(ar.key===Mt&&(Nt===void 0||ar.value===Nt))return!0}return!1},set:function(_t,st){var bt=Rt(this);dt(arguments.length,1);for(var Mt=bt.entries,Ot=!1,Nt=ke(_t),St=ke(st),ar=0,qr;ar<Mt.length;ar++)qr=Mt[ar],qr.key===Nt&&(Ot?Kr(Mt,ar--,1):(Ot=!0,qr.value=St));Ot||Cr(Mt,{key:Nt,value:St}),Q||(this.size=Mt.length),bt.updateURL()},sort:function(){var _t=Rt(this);gt(_t.entries,function(st,bt){return st.key>bt.key?1:-1}),_t.updateURL()},forEach:function(_t){for(var st=Rt(this).entries,bt=Te(_t,arguments.length>1?arguments[1]:void 0),Mt=0,Ot;Mt<st.length;)Ot=st[Mt++],bt(Ot.value,Ot.key,this)},keys:function(){return new He(this,"keys")},values:function(){return new He(this,"values")},entries:function(){return new He(this,"entries")}},{enumerable:!0}),U(qe,qt,qe.entries,{name:"entries"}),U(qe,"toString",function(){return Rt(this).serialize()},{enumerable:!0}),Q&&Z(qe,"size",{get:function(){return Rt(this).entries.length},configurable:!0,enumerable:!0}),he(Ve,Ft),Y({global:!0,constructor:!0,forced:!R},{URLSearchParams:Ve}),!R&&Re(Dt)){var De=le(nr.has),ze=le(nr.set),Le=function(et){if(Fe(et)){var _t=et.body,st;if(Ce(_t)===Ft)return st=et.headers?new Dt(et.headers):new Dt,De(st,"content-type")||ze(st,"content-type","application/x-www-form-urlencoded;charset=UTF-8"),Ze(et,{body:Je(0,ke(_t)),headers:Je(0,st)})}return et};if(Re(At)&&Y({global:!0,enumerable:!0,dontCallGetSet:!0,forced:!0},{fetch:function(_t){return At(_t,arguments.length>1?Le(arguments[1]):{})}}),Re(It)){var Ke=function(_t){return ve(this,Zt),new It(_t,arguments.length>1?Le(arguments[1]):{})};Zt.constructor=Ke,Ke.prototype=Zt,Y({global:!0,constructor:!0,dontCallGetSet:!0,forced:!0},{Request:Ke})}}return web_urlSearchParams_constructor={URLSearchParams:Ve,getState:Rt},web_urlSearchParams_constructor}var hasRequiredWeb_url_constructor;function requireWeb_url_constructor(){if(hasRequiredWeb_url_constructor)return web_url_constructor;hasRequiredWeb_url_constructor=1,requireEs_string_iterator();var Y=require_export(),K=requireDescriptors(),ee=requireUrlConstructorDetection(),ne=requireGlobalThis(),re=requireFunctionBindContext(),le=requireFunctionUncurryThis(),Q=requireDefineBuiltIn(),R=requireDefineBuiltInAccessor(),U=requireAnInstance(),Z=requireHasOwnProperty(),ae=requireObjectAssign(),he=requireArrayFrom(),pe=requireArraySlice(),me=requireStringMultibyte().codeAt,ve=requireStringPunycodeToAscii(),Re=requireToString$1(),Me=requireSetToStringTag(),Te=requireValidateArgumentsLength(),Ce=requireWeb_urlSearchParams_constructor(),We=requireInternalState(),Fe=We.set,ke=We.getterFor("URL"),Ze=Ce.URLSearchParams,Je=Ce.getState,Qe=ne.URL,it=ne.TypeError,lt=ne.parseInt,dt=Math.floor,yt=Math.pow,gt=le("".charAt),qt=le(/./.exec),Ft=le([].join),Gt=le(1.1.toString),ft=le([].pop),Rt=le([].push),pt=le("".replace),At=le([].shift),It=le("".split),Dt=le("".slice),Zt=le("".toLowerCase),nr=le([].unshift),Er="Invalid authority",vr="Invalid scheme",Sr="Invalid host",Qt="Invalid port",or=/[a-z]/i,Ir=/[\d+-.a-z]/i,Rr=/\d/,Cr=/^0x/i,wr=/^[0-7]+$/,Wr=/^\d+$/,Kr=/^[\da-f]+$/i,Hr=/[\0\t\n\r #%/:<>?@[\\\]^|]/,br=/[\0\t\n\r #/:<>?@[\\\]^|]/,Lr=/^[\u0000-\u0020]+/,Br=/(^|[^\u0000-\u0020])[\u0000-\u0020]+$/,zr=/[\t\n\r]/g,rr,sr=function(Lt){var Yt=It(Lt,"."),Ht,Bt,ir,gr,Mr,pi,ri;if(Yt.length&&Yt[Yt.length-1]===""&&Yt.length--,Ht=Yt.length,Ht>4)return Lt;for(Bt=[],ir=0;ir<Ht;ir++){if(gr=Yt[ir],gr==="")return Lt;if(Mr=10,gr.length>1&&gt(gr,0)==="0"&&(Mr=qt(Cr,gr)?16:8,gr=Dt(gr,Mr===8?1:2)),gr==="")pi=0;else{if(!qt(Mr===10?Wr:Mr===8?wr:Kr,gr))return Lt;pi=lt(gr,Mr)}Rt(Bt,pi)}for(ir=0;ir<Ht;ir++)if(pi=Bt[ir],ir===Ht-1){if(pi>=yt(256,5-Ht))return null}else if(pi>255)return null;for(ri=ft(Bt),ir=0;ir<Bt.length;ir++)ri+=Bt[ir]*yt(256,3-ir);return ri},Dr=function(Lt){var Yt=[0,0,0,0,0,0,0,0],Ht=0,Bt=null,ir=0,gr,Mr,pi,ri,Oi,Vi,hr,qi=function(){return gt(Lt,ir)};if(qi()===":"){if(gt(Lt,1)!==":")return;ir+=2,Ht++,Bt=Ht}for(;qi();){if(Ht===8)return;if(qi()===":"){if(Bt!==null)return;ir++,Ht++,Bt=Ht;continue}for(gr=Mr=0;Mr<4&&qt(Kr,qi());)gr=gr*16+lt(qi(),16),ir++,Mr++;if(qi()==="."){if(Mr===0||(ir-=Mr,Ht>6))return;for(pi=0;qi();){if(ri=null,pi>0)if(qi()==="."&&pi<4)ir++;else return;if(!qt(Rr,qi()))return;for(;qt(Rr,qi());){if(Oi=lt(qi(),10),ri===null)ri=Oi;else{if(ri===0)return;ri=ri*10+Oi}if(ri>255)return;ir++}Yt[Ht]=Yt[Ht]*256+ri,pi++,(pi===2||pi===4)&&Ht++}if(pi!==4)return;break}else if(qi()===":"){if(ir++,!qi())return}else if(qi())return;Yt[Ht++]=gr}if(Bt!==null)for(Vi=Ht-Bt,Ht=7;Ht!==0&&Vi>0;)hr=Yt[Ht],Yt[Ht--]=Yt[Bt+Vi-1],Yt[Bt+--Vi]=hr;else if(Ht!==8)return;return Yt},lr=function(Lt){for(var Yt=null,Ht=1,Bt=null,ir=0,gr=0;gr<8;gr++)Lt[gr]!==0?(ir>Ht&&(Yt=Bt,Ht=ir),Bt=null,ir=0):(Bt===null&&(Bt=gr),++ir);return ir>Ht?Bt:Yt},yr=function(Lt){var Yt,Ht,Bt,ir;if(typeof Lt=="number"){for(Yt=[],Ht=0;Ht<4;Ht++)nr(Yt,Lt%256),Lt=dt(Lt/256);return Ft(Yt,".")}if(typeof Lt=="object"){for(Yt="",Bt=lr(Lt),Ht=0;Ht<8;Ht++)ir&&Lt[Ht]===0||(ir&&(ir=!1),Bt===Ht?(Yt+=Ht?":":"::",ir=!0):(Yt+=Gt(Lt[Ht],16),Ht<7&&(Yt+=":")));return"["+Yt+"]"}return Lt},xr={},Ge=ae({},xr,{" ":1,'"':1,"<":1,">":1,"`":1}),Ee=ae({},Ge,{"#":1,"?":1,"{":1,"}":1}),Pe=ae({},Ee,{"/":1,":":1,";":1,"=":1,"@":1,"[":1,"\\":1,"]":1,"^":1,"|":1}),He=function(Lt,Yt){var Ht=me(Lt,0);return Ht>32&&Ht<127&&!Z(Yt,Lt)?Lt:encodeURIComponent(Lt)},ut={ftp:21,file:null,http:80,https:443,ws:80,wss:443},Ve=function(Lt,Yt){var Ht;return Lt.length===2&&qt(or,gt(Lt,0))&&((Ht=gt(Lt,1))===":"||!Yt&&Ht==="|")},qe=function(Lt){var Yt;return Lt.length>1&&Ve(Dt(Lt,0,2))&&(Lt.length===2||(Yt=gt(Lt,2))==="/"||Yt==="\\"||Yt==="?"||Yt==="#")},De=function(Lt){return Lt==="."||Zt(Lt)==="%2e"},ze=function(Lt){return Lt=Zt(Lt),Lt===".."||Lt==="%2e."||Lt===".%2e"||Lt==="%2e%2e"},Le={},Ke={},et={},_t={},st={},bt={},Mt={},Ot={},Nt={},St={},ar={},qr={},fr={},Fr={},Gr={},ci={},Jr={},Yr={},jr={},Zr={},fi={},cr=function(Lt,Yt,Ht){var Bt=Re(Lt),ir,gr,Mr;if(Yt){if(gr=this.parse(Bt),gr)throw new it(gr);this.searchParams=null}else{if(Ht!==void 0&&(ir=new cr(Ht,!0)),gr=this.parse(Bt,null,ir),gr)throw new it(gr);Mr=Je(new Ze),Mr.bindURL(this),this.searchParams=Mr}};cr.prototype={type:"URL",parse:function(Lt,Yt,Ht){var Bt=this,ir=Yt||Le,gr=0,Mr="",pi=!1,ri=!1,Oi=!1,Vi,hr,qi,Ci;for(Lt=Re(Lt),Yt||(Bt.scheme="",Bt.username="",Bt.password="",Bt.host=null,Bt.port=null,Bt.path=[],Bt.query=null,Bt.fragment=null,Bt.cannotBeABaseURL=!1,Lt=pt(Lt,Lr,""),Lt=pt(Lt,Br,"$1")),Lt=pt(Lt,zr,""),Vi=he(Lt);gr<=Vi.length;){switch(hr=Vi[gr],ir){case Le:if(hr&&qt(or,hr))Mr+=Zt(hr),ir=Ke;else{if(Yt)return vr;ir=et;continue}break;case Ke:if(hr&&(qt(Ir,hr)||hr==="+"||hr==="-"||hr==="."))Mr+=Zt(hr);else if(hr===":"){if(Yt&&(Bt.isSpecial()!==Z(ut,Mr)||Mr==="file"&&(Bt.includesCredentials()||Bt.port!==null)||Bt.scheme==="file"&&!Bt.host))return;if(Bt.scheme=Mr,Yt){Bt.isSpecial()&&ut[Bt.scheme]===Bt.port&&(Bt.port=null);return}Mr="",Bt.scheme==="file"?ir=Fr:Bt.isSpecial()&&Ht&&Ht.scheme===Bt.scheme?ir=_t:Bt.isSpecial()?ir=Ot:Vi[gr+1]==="/"?(ir=st,gr++):(Bt.cannotBeABaseURL=!0,Rt(Bt.path,""),ir=jr)}else{if(Yt)return vr;Mr="",ir=et,gr=0;continue}break;case et:if(!Ht||Ht.cannotBeABaseURL&&hr!=="#")return vr;if(Ht.cannotBeABaseURL&&hr==="#"){Bt.scheme=Ht.scheme,Bt.path=pe(Ht.path),Bt.query=Ht.query,Bt.fragment="",Bt.cannotBeABaseURL=!0,ir=fi;break}ir=Ht.scheme==="file"?Fr:bt;continue;case _t:if(hr==="/"&&Vi[gr+1]==="/")ir=Nt,gr++;else{ir=bt;continue}break;case st:if(hr==="/"){ir=St;break}else{ir=Yr;continue}case bt:if(Bt.scheme=Ht.scheme,hr===rr)Bt.username=Ht.username,Bt.password=Ht.password,Bt.host=Ht.host,Bt.port=Ht.port,Bt.path=pe(Ht.path),Bt.query=Ht.query;else if(hr==="/"||hr==="\\"&&Bt.isSpecial())ir=Mt;else if(hr==="?")Bt.username=Ht.username,Bt.password=Ht.password,Bt.host=Ht.host,Bt.port=Ht.port,Bt.path=pe(Ht.path),Bt.query="",ir=Zr;else if(hr==="#")Bt.username=Ht.username,Bt.password=Ht.password,Bt.host=Ht.host,Bt.port=Ht.port,Bt.path=pe(Ht.path),Bt.query=Ht.query,Bt.fragment="",ir=fi;else{Bt.username=Ht.username,Bt.password=Ht.password,Bt.host=Ht.host,Bt.port=Ht.port,Bt.path=pe(Ht.path),Bt.path.length--,ir=Yr;continue}break;case Mt:if(Bt.isSpecial()&&(hr==="/"||hr==="\\"))ir=Nt;else if(hr==="/")ir=St;else{Bt.username=Ht.username,Bt.password=Ht.password,Bt.host=Ht.host,Bt.port=Ht.port,ir=Yr;continue}break;case Ot:if(ir=Nt,hr!=="/"||gt(Mr,gr+1)!=="/")continue;gr++;break;case Nt:if(hr!=="/"&&hr!=="\\"){ir=St;continue}break;case St:if(hr==="@"){pi&&(Mr="%40"+Mr),pi=!0,qi=he(Mr);for(var yi=0;yi<qi.length;yi++){var lo=qi[yi];if(lo===":"&&!Oi){Oi=!0;continue}var ra=He(lo,Pe);Oi?Bt.password+=ra:Bt.username+=ra}Mr=""}else if(hr===rr||hr==="/"||hr==="?"||hr==="#"||hr==="\\"&&Bt.isSpecial()){if(pi&&Mr==="")return Er;gr-=he(Mr).length+1,Mr="",ir=ar}else Mr+=hr;break;case ar:case qr:if(Yt&&Bt.scheme==="file"){ir=ci;continue}else if(hr===":"&&!ri){if(Mr==="")return Sr;if(Ci=Bt.parseHost(Mr),Ci)return Ci;if(Mr="",ir=fr,Yt===qr)return}else if(hr===rr||hr==="/"||hr==="?"||hr==="#"||hr==="\\"&&Bt.isSpecial()){if(Bt.isSpecial()&&Mr==="")return Sr;if(Yt&&Mr===""&&(Bt.includesCredentials()||Bt.port!==null))return;if(Ci=Bt.parseHost(Mr),Ci)return Ci;if(Mr="",ir=Jr,Yt)return;continue}else hr==="["?ri=!0:hr==="]"&&(ri=!1),Mr+=hr;break;case fr:if(qt(Rr,hr))Mr+=hr;else if(hr===rr||hr==="/"||hr==="?"||hr==="#"||hr==="\\"&&Bt.isSpecial()||Yt){if(Mr!==""){var ia=lt(Mr,10);if(ia>65535)return Qt;Bt.port=Bt.isSpecial()&&ia===ut[Bt.scheme]?null:ia,Mr=""}if(Yt)return;ir=Jr;continue}else return Qt;break;case Fr:if(Bt.scheme="file",hr==="/"||hr==="\\")ir=Gr;else if(Ht&&Ht.scheme==="file")switch(hr){case rr:Bt.host=Ht.host,Bt.path=pe(Ht.path),Bt.query=Ht.query;break;case"?":Bt.host=Ht.host,Bt.path=pe(Ht.path),Bt.query="",ir=Zr;break;case"#":Bt.host=Ht.host,Bt.path=pe(Ht.path),Bt.query=Ht.query,Bt.fragment="",ir=fi;break;default:qe(Ft(pe(Vi,gr),""))||(Bt.host=Ht.host,Bt.path=pe(Ht.path),Bt.shortenPath()),ir=Yr;continue}else{ir=Yr;continue}break;case Gr:if(hr==="/"||hr==="\\"){ir=ci;break}Ht&&Ht.scheme==="file"&&!qe(Ft(pe(Vi,gr),""))&&(Ve(Ht.path[0],!0)?Rt(Bt.path,Ht.path[0]):Bt.host=Ht.host),ir=Yr;continue;case ci:if(hr===rr||hr==="/"||hr==="\\"||hr==="?"||hr==="#"){if(!Yt&&Ve(Mr))ir=Yr;else if(Mr===""){if(Bt.host="",Yt)return;ir=Jr}else{if(Ci=Bt.parseHost(Mr),Ci)return Ci;if(Bt.host==="localhost"&&(Bt.host=""),Yt)return;Mr="",ir=Jr}continue}else Mr+=hr;break;case Jr:if(Bt.isSpecial()){if(ir=Yr,hr!=="/"&&hr!=="\\")continue}else if(!Yt&&hr==="?")Bt.query="",ir=Zr;else if(!Yt&&hr==="#")Bt.fragment="",ir=fi;else if(hr!==rr&&(ir=Yr,hr!=="/"))continue;break;case Yr:if(hr===rr||hr==="/"||hr==="\\"&&Bt.isSpecial()||!Yt&&(hr==="?"||hr==="#")){if(ze(Mr)?(Bt.shortenPath(),hr!=="/"&&!(hr==="\\"&&Bt.isSpecial())&&Rt(Bt.path,"")):De(Mr)?hr!=="/"&&!(hr==="\\"&&Bt.isSpecial())&&Rt(Bt.path,""):(Bt.scheme==="file"&&!Bt.path.length&&Ve(Mr)&&(Bt.host&&(Bt.host=""),Mr=gt(Mr,0)+":"),Rt(Bt.path,Mr)),Mr="",Bt.scheme==="file"&&(hr===rr||hr==="?"||hr==="#"))for(;Bt.path.length>1&&Bt.path[0]==="";)At(Bt.path);hr==="?"?(Bt.query="",ir=Zr):hr==="#"&&(Bt.fragment="",ir=fi)}else Mr+=He(hr,Ee);break;case jr:hr==="?"?(Bt.query="",ir=Zr):hr==="#"?(Bt.fragment="",ir=fi):hr!==rr&&(Bt.path[0]+=He(hr,xr));break;case Zr:!Yt&&hr==="#"?(Bt.fragment="",ir=fi):hr!==rr&&(hr==="'"&&Bt.isSpecial()?Bt.query+="%27":hr==="#"?Bt.query+="%23":Bt.query+=He(hr,xr));break;case fi:hr!==rr&&(Bt.fragment+=He(hr,Ge));break}gr++}},parseHost:function(Lt){var Yt,Ht,Bt;if(gt(Lt,0)==="["){if(gt(Lt,Lt.length-1)!=="]"||(Yt=Dr(Dt(Lt,1,-1)),!Yt))return Sr;this.host=Yt}else if(this.isSpecial()){if(Lt=ve(Lt),qt(Hr,Lt)||(Yt=sr(Lt),Yt===null))return Sr;this.host=Yt}else{if(qt(br,Lt))return Sr;for(Yt="",Ht=he(Lt),Bt=0;Bt<Ht.length;Bt++)Yt+=He(Ht[Bt],xr);this.host=Yt}},cannotHaveUsernamePasswordPort:function(){return!this.host||this.cannotBeABaseURL||this.scheme==="file"},includesCredentials:function(){return this.username!==""||this.password!==""},isSpecial:function(){return Z(ut,this.scheme)},shortenPath:function(){var Lt=this.path,Yt=Lt.length;Yt&&(this.scheme!=="file"||Yt!==1||!Ve(Lt[0],!0))&&Lt.length--},serialize:function(){var Lt=this,Yt=Lt.scheme,Ht=Lt.username,Bt=Lt.password,ir=Lt.host,gr=Lt.port,Mr=Lt.path,pi=Lt.query,ri=Lt.fragment,Oi=Yt+":";return ir!==null?(Oi+="//",Lt.includesCredentials()&&(Oi+=Ht+(Bt?":"+Bt:"")+"@"),Oi+=yr(ir),gr!==null&&(Oi+=":"+gr)):Yt==="file"&&(Oi+="//"),Oi+=Lt.cannotBeABaseURL?Mr[0]:Mr.length?"/"+Ft(Mr,"/"):"",pi!==null&&(Oi+="?"+pi),ri!==null&&(Oi+="#"+ri),Oi},setHref:function(Lt){var Yt=this.parse(Lt);if(Yt)throw new it(Yt);this.searchParams.update()},getOrigin:function(){var Lt=this.scheme,Yt=this.port;if(Lt==="blob")try{return new bi(Lt.path[0]).origin}catch{return"null"}return Lt==="file"||!this.isSpecial()?"null":Lt+"://"+yr(this.host)+(Yt!==null?":"+Yt:"")},getProtocol:function(){return this.scheme+":"},setProtocol:function(Lt){this.parse(Re(Lt)+":",Le)},getUsername:function(){return this.username},setUsername:function(Lt){var Yt=he(Re(Lt));if(!this.cannotHaveUsernamePasswordPort()){this.username="";for(var Ht=0;Ht<Yt.length;Ht++)this.username+=He(Yt[Ht],Pe)}},getPassword:function(){return this.password},setPassword:function(Lt){var Yt=he(Re(Lt));if(!this.cannotHaveUsernamePasswordPort()){this.password="";for(var Ht=0;Ht<Yt.length;Ht++)this.password+=He(Yt[Ht],Pe)}},getHost:function(){var Lt=this.host,Yt=this.port;return Lt===null?"":Yt===null?yr(Lt):yr(Lt)+":"+Yt},setHost:function(Lt){this.cannotBeABaseURL||this.parse(Lt,ar)},getHostname:function(){var Lt=this.host;return Lt===null?"":yr(Lt)},setHostname:function(Lt){this.cannotBeABaseURL||this.parse(Lt,qr)},getPort:function(){var Lt=this.port;return Lt===null?"":Re(Lt)},setPort:function(Lt){this.cannotHaveUsernamePasswordPort()||(Lt=Re(Lt),Lt===""?this.port=null:this.parse(Lt,fr))},getPathname:function(){var Lt=this.path;return this.cannotBeABaseURL?Lt[0]:Lt.length?"/"+Ft(Lt,"/"):""},setPathname:function(Lt){this.cannotBeABaseURL||(this.path=[],this.parse(Lt,Jr))},getSearch:function(){var Lt=this.query;return Lt?"?"+Lt:""},setSearch:function(Lt){Lt=Re(Lt),Lt===""?this.query=null:(gt(Lt,0)==="?"&&(Lt=Dt(Lt,1)),this.query="",this.parse(Lt,Zr)),this.searchParams.update()},getSearchParams:function(){return this.searchParams.facade},getHash:function(){var Lt=this.fragment;return Lt?"#"+Lt:""},setHash:function(Lt){if(Lt=Re(Lt),Lt===""){this.fragment=null;return}gt(Lt,0)==="#"&&(Lt=Dt(Lt,1)),this.fragment="",this.parse(Lt,fi)},update:function(){this.query=this.searchParams.serialize()||null}};var bi=function(Yt){var Ht=U(this,Qr),Bt=Te(arguments.length,1)>1?arguments[1]:void 0,ir=Fe(Ht,new cr(Yt,!1,Bt));K||(Ht.href=ir.serialize(),Ht.origin=ir.getOrigin(),Ht.protocol=ir.getProtocol(),Ht.username=ir.getUsername(),Ht.password=ir.getPassword(),Ht.host=ir.getHost(),Ht.hostname=ir.getHostname(),Ht.port=ir.getPort(),Ht.pathname=ir.getPathname(),Ht.search=ir.getSearch(),Ht.searchParams=ir.getSearchParams(),Ht.hash=ir.getHash())},Qr=bi.prototype,Ei=function(Lt,Yt){return{get:function(){return ke(this)[Lt]()},set:Yt&&function(Ht){return ke(this)[Yt](Ht)},configurable:!0,enumerable:!0}};if(K&&(R(Qr,"href",Ei("serialize","setHref")),R(Qr,"origin",Ei("getOrigin")),R(Qr,"protocol",Ei("getProtocol","setProtocol")),R(Qr,"username",Ei("getUsername","setUsername")),R(Qr,"password",Ei("getPassword","setPassword")),R(Qr,"host",Ei("getHost","setHost")),R(Qr,"hostname",Ei("getHostname","setHostname")),R(Qr,"port",Ei("getPort","setPort")),R(Qr,"pathname",Ei("getPathname","setPathname")),R(Qr,"search",Ei("getSearch","setSearch")),R(Qr,"searchParams",Ei("getSearchParams")),R(Qr,"hash",Ei("getHash","setHash"))),Q(Qr,"toJSON",function(){return ke(this).serialize()},{enumerable:!0}),Q(Qr,"toString",function(){return ke(this).serialize()},{enumerable:!0}),Qe){var yn=Qe.createObjectURL,pr=Qe.revokeObjectURL;yn&&Q(bi,"createObjectURL",re(yn,Qe)),pr&&Q(bi,"revokeObjectURL",re(pr,Qe))}return Me(bi,"URL"),Y({global:!0,constructor:!0,forced:!ee,sham:!K},{URL:bi}),web_url_constructor}var hasRequiredWeb_url;function requireWeb_url(){return hasRequiredWeb_url||(hasRequiredWeb_url=1,requireWeb_url_constructor()),web_url}var web_url_canParse={},hasRequiredWeb_url_canParse;function requireWeb_url_canParse(){if(hasRequiredWeb_url_canParse)return web_url_canParse;hasRequiredWeb_url_canParse=1;var Y=require_export(),K=requireGetBuiltIn(),ee=requireFails(),ne=requireValidateArgumentsLength(),re=requireToString$1(),le=requireUrlConstructorDetection(),Q=K("URL"),R=le&&ee(function(){Q.canParse()}),U=ee(function(){return Q.canParse.length!==1});return Y({target:"URL",stat:!0,forced:!R||U},{canParse:function(ae){var he=ne(arguments.length,1),pe=re(ae),me=he<2||arguments[1]===void 0?void 0:re(arguments[1]);try{return!!new Q(pe,me)}catch{return!1}}}),web_url_canParse}var web_url_parse={},hasRequiredWeb_url_parse;function requireWeb_url_parse(){if(hasRequiredWeb_url_parse)return web_url_parse;hasRequiredWeb_url_parse=1;var Y=require_export(),K=requireGetBuiltIn(),ee=requireValidateArgumentsLength(),ne=requireToString$1(),re=requireUrlConstructorDetection(),le=K("URL");return Y({target:"URL",stat:!0,forced:!re},{parse:function(R){var U=ee(arguments.length,1),Z=ne(R),ae=U<2||arguments[1]===void 0?void 0:ne(arguments[1]);try{return new le(Z,ae)}catch{return null}}}),web_url_parse}var web_url_toJson={},hasRequiredWeb_url_toJson;function requireWeb_url_toJson(){if(hasRequiredWeb_url_toJson)return web_url_toJson;hasRequiredWeb_url_toJson=1;var Y=require_export(),K=requireFunctionCall();return Y({target:"URL",proto:!0,enumerable:!0},{toJSON:function(){return K(URL.prototype.toString,this)}}),web_url_toJson}var web_urlSearchParams={},hasRequiredWeb_urlSearchParams;function requireWeb_urlSearchParams(){return hasRequiredWeb_urlSearchParams||(hasRequiredWeb_urlSearchParams=1,requireWeb_urlSearchParams_constructor()),web_urlSearchParams}var web_urlSearchParams_delete={},hasRequiredWeb_urlSearchParams_delete;function requireWeb_urlSearchParams_delete(){if(hasRequiredWeb_urlSearchParams_delete)return web_urlSearchParams_delete;hasRequiredWeb_urlSearchParams_delete=1;var Y=requireDefineBuiltIn(),K=requireFunctionUncurryThis(),ee=requireToString$1(),ne=requireValidateArgumentsLength(),re=URLSearchParams,le=re.prototype,Q=K(le.append),R=K(le.delete),U=K(le.forEach),Z=K([].push),ae=new re("a=1&a=2&b=3");return ae.delete("a",1),ae.delete("b",void 0),ae+""!="a=2"&&Y(le,"delete",function(he){var pe=arguments.length,me=pe<2?void 0:arguments[1];if(pe&&me===void 0)return R(this,he);var ve=[];U(this,function(Ze,Je){Z(ve,{key:Je,value:Ze})}),ne(pe,1);for(var Re=ee(he),Me=ee(me),Te=0,Ce=0,We=!1,Fe=ve.length,ke;Te<Fe;)ke=ve[Te++],We||ke.key===Re?(We=!0,R(this,ke.key)):Ce++;for(;Ce<Fe;)ke=ve[Ce++],ke.key===Re&&ke.value===Me||Q(this,ke.key,ke.value)},{enumerable:!0,unsafe:!0}),web_urlSearchParams_delete}var web_urlSearchParams_has={},hasRequiredWeb_urlSearchParams_has;function requireWeb_urlSearchParams_has(){if(hasRequiredWeb_urlSearchParams_has)return web_urlSearchParams_has;hasRequiredWeb_urlSearchParams_has=1;var Y=requireDefineBuiltIn(),K=requireFunctionUncurryThis(),ee=requireToString$1(),ne=requireValidateArgumentsLength(),re=URLSearchParams,le=re.prototype,Q=K(le.getAll),R=K(le.has),U=new re("a=1");return(U.has("a",2)||!U.has("a",void 0))&&Y(le,"has",function(ae){var he=arguments.length,pe=he<2?void 0:arguments[1];if(he&&pe===void 0)return R(this,ae);var me=Q(this,ae);ne(he,1);for(var ve=ee(pe),Re=0;Re<me.length;)if(me[Re++]===ve)return!0;return!1},{enumerable:!0,unsafe:!0}),web_urlSearchParams_has}var web_urlSearchParams_size={},hasRequiredWeb_urlSearchParams_size;function requireWeb_urlSearchParams_size(){if(hasRequiredWeb_urlSearchParams_size)return web_urlSearchParams_size;hasRequiredWeb_urlSearchParams_size=1;var Y=requireDescriptors(),K=requireFunctionUncurryThis(),ee=requireDefineBuiltInAccessor(),ne=URLSearchParams.prototype,re=K(ne.forEach);return Y&&!("size"in ne)&&ee(ne,"size",{get:function(){var Q=0;return re(this,function(){Q++}),Q},configurable:!0,enumerable:!0}),web_urlSearchParams_size}var stable,hasRequiredStable;function requireStable(){return hasRequiredStable||(hasRequiredStable=1,requireEs_symbol(),requireEs_symbol_description(),requireEs_symbol_asyncDispose(),requireEs_symbol_asyncIterator(),requireEs_symbol_dispose(),requireEs_symbol_hasInstance(),requireEs_symbol_isConcatSpreadable(),requireEs_symbol_iterator(),requireEs_symbol_match(),requireEs_symbol_matchAll(),requireEs_symbol_replace(),requireEs_symbol_search(),requireEs_symbol_species(),requireEs_symbol_split(),requireEs_symbol_toPrimitive(),requireEs_symbol_toStringTag(),requireEs_symbol_unscopables(),requireEs_error_cause(),requireEs_error_isError(),requireEs_error_toString(),requireEs_aggregateError(),requireEs_aggregateError_cause(),requireEs_suppressedError_constructor(),requireEs_array_at(),requireEs_array_concat(),requireEs_array_copyWithin(),requireEs_array_every(),requireEs_array_fill(),requireEs_array_filter(),requireEs_array_find(),requireEs_array_findIndex(),requireEs_array_findLast(),requireEs_array_findLastIndex(),requireEs_array_flat(),requireEs_array_flatMap(),requireEs_array_forEach(),requireEs_array_from(),requireEs_array_includes(),requireEs_array_indexOf(),requireEs_array_isArray(),requireEs_array_iterator(),requireEs_array_join(),requireEs_array_lastIndexOf(),requireEs_array_map(),requireEs_array_of(),requireEs_array_push(),requireEs_array_reduce(),requireEs_array_reduceRight(),requireEs_array_reverse(),requireEs_array_slice(),requireEs_array_some(),requireEs_array_sort(),requireEs_array_species(),requireEs_array_splice(),requireEs_array_toReversed(),requireEs_array_toSorted(),requireEs_array_toSpliced(),requireEs_array_unscopables_flat(),requireEs_array_unscopables_flatMap(),requireEs_array_unshift(),requireEs_array_with(),requireEs_arrayBuffer_constructor(),requireEs_arrayBuffer_isView(),requireEs_arrayBuffer_slice(),requireEs_dataView(),requireEs_dataView_getFloat16(),requireEs_dataView_setFloat16(),requireEs_arrayBuffer_detached(),requireEs_arrayBuffer_transfer(),requireEs_arrayBuffer_transferToFixedLength(),requireEs_date_getYear(),requireEs_date_now(),requireEs_date_setYear(),requireEs_date_toGmtString(),requireEs_date_toIsoString(),requireEs_date_toJson(),requireEs_date_toPrimitive(),requireEs_date_toString(),requireEs_disposableStack_constructor(),requireEs_escape(),requireEs_function_bind(),requireEs_function_hasInstance(),requireEs_function_name(),requireEs_globalThis(),requireEs_iterator_constructor(),requireEs_iterator_dispose(),requireEs_iterator_drop(),requireEs_iterator_every(),requireEs_iterator_filter(),requireEs_iterator_find(),requireEs_iterator_flatMap(),requireEs_iterator_forEach(),requireEs_iterator_from(),requireEs_iterator_map(),requireEs_iterator_reduce(),requireEs_iterator_some(),requireEs_iterator_take(),requireEs_iterator_toArray(),requireEs_json_stringify(),requireEs_json_toStringTag(),requireEs_map(),requireEs_map_groupBy(),requireEs_math_acosh(),requireEs_math_asinh(),requireEs_math_atanh(),requireEs_math_cbrt(),requireEs_math_clz32(),requireEs_math_cosh(),requireEs_math_expm1(),requireEs_math_fround(),requireEs_math_f16round(),requireEs_math_hypot(),requireEs_math_imul(),requireEs_math_log10(),requireEs_math_log1p(),requireEs_math_log2(),requireEs_math_sign(),requireEs_math_sinh(),requireEs_math_tanh(),requireEs_math_toStringTag(),requireEs_math_trunc(),requireEs_number_constructor(),requireEs_number_epsilon(),requireEs_number_isFinite(),requireEs_number_isInteger(),requireEs_number_isNan(),requireEs_number_isSafeInteger(),requireEs_number_maxSafeInteger(),requireEs_number_minSafeInteger(),requireEs_number_parseFloat(),requireEs_number_parseInt(),requireEs_number_toExponential(),requireEs_number_toFixed(),requireEs_number_toPrecision(),requireEs_object_assign(),requireEs_object_create(),requireEs_object_defineGetter(),requireEs_object_defineProperties(),requireEs_object_defineProperty(),requireEs_object_defineSetter(),requireEs_object_entries(),requireEs_object_freeze(),requireEs_object_fromEntries(),requireEs_object_getOwnPropertyDescriptor(),requireEs_object_getOwnPropertyDescriptors(),requireEs_object_getOwnPropertyNames(),requireEs_object_getPrototypeOf(),requireEs_object_groupBy(),requireEs_object_hasOwn(),requireEs_object_is(),requireEs_object_isExtensible(),requireEs_object_isFrozen(),requireEs_object_isSealed(),requireEs_object_keys(),requireEs_object_lookupGetter(),requireEs_object_lookupSetter(),requireEs_object_preventExtensions(),requireEs_object_proto(),requireEs_object_seal(),requireEs_object_setPrototypeOf(),requireEs_object_toString(),requireEs_object_values(),requireEs_parseFloat(),requireEs_parseInt(),requireEs_promise(),requireEs_promise_allSettled(),requireEs_promise_any(),requireEs_promise_finally(),requireEs_promise_try(),requireEs_promise_withResolvers(),requireEs_array_fromAsync(),requireEs_asyncDisposableStack_constructor(),requireEs_asyncIterator_asyncDispose(),requireEs_reflect_apply(),requireEs_reflect_construct(),requireEs_reflect_defineProperty(),requireEs_reflect_deleteProperty(),requireEs_reflect_get(),requireEs_reflect_getOwnPropertyDescriptor(),requireEs_reflect_getPrototypeOf(),requireEs_reflect_has(),requireEs_reflect_isExtensible(),requireEs_reflect_ownKeys(),requireEs_reflect_preventExtensions(),requireEs_reflect_set(),requireEs_reflect_setPrototypeOf(),requireEs_reflect_toStringTag(),requireEs_regexp_constructor(),requireEs_regexp_escape(),requireEs_regexp_dotAll(),requireEs_regexp_exec(),requireEs_regexp_flags(),requireEs_regexp_sticky(),requireEs_regexp_test(),requireEs_regexp_toString(),requireEs_set(),requireEs_set_difference_v2(),requireEs_set_intersection_v2(),requireEs_set_isDisjointFrom_v2(),requireEs_set_isSubsetOf_v2(),requireEs_set_isSupersetOf_v2(),requireEs_set_symmetricDifference_v2(),requireEs_set_union_v2(),requireEs_string_atAlternative(),requireEs_string_codePointAt(),requireEs_string_endsWith(),requireEs_string_fromCodePoint(),requireEs_string_includes(),requireEs_string_isWellFormed(),requireEs_string_iterator(),requireEs_string_match(),requireEs_string_matchAll(),requireEs_string_padEnd(),requireEs_string_padStart(),requireEs_string_raw(),requireEs_string_repeat(),requireEs_string_replace(),requireEs_string_replaceAll(),requireEs_string_search(),requireEs_string_split(),requireEs_string_startsWith(),requireEs_string_substr(),requireEs_string_toWellFormed(),requireEs_string_trim(),requireEs_string_trimEnd(),requireEs_string_trimStart(),requireEs_string_anchor(),requireEs_string_big(),requireEs_string_blink(),requireEs_string_bold(),requireEs_string_fixed(),requireEs_string_fontcolor(),requireEs_string_fontsize(),requireEs_string_italics(),requireEs_string_link(),requireEs_string_small(),requireEs_string_strike(),requireEs_string_sub(),requireEs_string_sup(),requireEs_typedArray_float32Array(),requireEs_typedArray_float64Array(),requireEs_typedArray_int8Array(),requireEs_typedArray_int16Array(),requireEs_typedArray_int32Array(),requireEs_typedArray_uint8Array(),requireEs_typedArray_uint8ClampedArray(),requireEs_typedArray_uint16Array(),requireEs_typedArray_uint32Array(),requireEs_typedArray_at(),requireEs_typedArray_copyWithin(),requireEs_typedArray_every(),requireEs_typedArray_fill(),requireEs_typedArray_filter(),requireEs_typedArray_find(),requireEs_typedArray_findIndex(),requireEs_typedArray_findLast(),requireEs_typedArray_findLastIndex(),requireEs_typedArray_forEach(),requireEs_typedArray_from(),requireEs_typedArray_includes(),requireEs_typedArray_indexOf(),requireEs_typedArray_iterator(),requireEs_typedArray_join(),requireEs_typedArray_lastIndexOf(),requireEs_typedArray_map(),requireEs_typedArray_of(),requireEs_typedArray_reduce(),requireEs_typedArray_reduceRight(),requireEs_typedArray_reverse(),requireEs_typedArray_set(),requireEs_typedArray_slice(),requireEs_typedArray_some(),requireEs_typedArray_sort(),requireEs_typedArray_subarray(),requireEs_typedArray_toLocaleString(),requireEs_typedArray_toReversed(),requireEs_typedArray_toSorted(),requireEs_typedArray_toString(),requireEs_typedArray_with(),requireEs_unescape(),requireEs_weakMap(),requireEs_weakSet(),requireWeb_atob(),requireWeb_btoa(),requireWeb_domCollections_forEach(),requireWeb_domCollections_iterator(),requireWeb_domException_constructor(),requireWeb_domException_stack(),requireWeb_domException_toStringTag(),requireWeb_immediate(),requireWeb_queueMicrotask(),requireWeb_self(),requireWeb_structuredClone(),requireWeb_timers(),requireWeb_url(),requireWeb_url_canParse(),requireWeb_url_parse(),requireWeb_url_toJson(),requireWeb_urlSearchParams(),requireWeb_urlSearchParams_delete(),requireWeb_urlSearchParams_has(),requireWeb_urlSearchParams_size(),stable=requirePath()),stable}requireStable();var runtime={exports:{}},hasRequiredRuntime;function requireRuntime(){return hasRequiredRuntime||(hasRequiredRuntime=1,function(Y){var K=function(ee){var ne=Object.prototype,re=ne.hasOwnProperty,le=Object.defineProperty||function(pt,At,It){pt[At]=It.value},Q,R=typeof Symbol=="function"?Symbol:{},U=R.iterator||"@@iterator",Z=R.asyncIterator||"@@asyncIterator",ae=R.toStringTag||"@@toStringTag";function he(pt,At,It){return Object.defineProperty(pt,At,{value:It,enumerable:!0,configurable:!0,writable:!0}),pt[At]}try{he({},"")}catch{he=function(At,It,Dt){return At[It]=Dt}}function pe(pt,At,It,Dt){var Zt=At&&At.prototype instanceof We?At:We,nr=Object.create(Zt.prototype),Er=new Gt(Dt||[]);return le(nr,"_invoke",{value:yt(pt,It,Er)}),nr}ee.wrap=pe;function me(pt,At,It){try{return{type:"normal",arg:pt.call(At,It)}}catch(Dt){return{type:"throw",arg:Dt}}}var ve="suspendedStart",Re="suspendedYield",Me="executing",Te="completed",Ce={};function We(){}function Fe(){}function ke(){}var Ze={};he(Ze,U,function(){return this});var Je=Object.getPrototypeOf,Qe=Je&&Je(Je(ft([])));Qe&&Qe!==ne&&re.call(Qe,U)&&(Ze=Qe);var it=ke.prototype=We.prototype=Object.create(Ze);Fe.prototype=ke,le(it,"constructor",{value:ke,configurable:!0}),le(ke,"constructor",{value:Fe,configurable:!0}),Fe.displayName=he(ke,ae,"GeneratorFunction");function lt(pt){["next","throw","return"].forEach(function(At){he(pt,At,function(It){return this._invoke(At,It)})})}ee.isGeneratorFunction=function(pt){var At=typeof pt=="function"&&pt.constructor;return At?At===Fe||(At.displayName||At.name)==="GeneratorFunction":!1},ee.mark=function(pt){return Object.setPrototypeOf?Object.setPrototypeOf(pt,ke):(pt.__proto__=ke,he(pt,ae,"GeneratorFunction")),pt.prototype=Object.create(it),pt},ee.awrap=function(pt){return{__await:pt}};function dt(pt,At){function It(nr,Er,vr,Sr){var Qt=me(pt[nr],pt,Er);if(Qt.type==="throw")Sr(Qt.arg);else{var or=Qt.arg,Ir=or.value;return Ir&&typeof Ir=="object"&&re.call(Ir,"__await")?At.resolve(Ir.__await).then(function(Rr){It("next",Rr,vr,Sr)},function(Rr){It("throw",Rr,vr,Sr)}):At.resolve(Ir).then(function(Rr){or.value=Rr,vr(or)},function(Rr){return It("throw",Rr,vr,Sr)})}}var Dt;function Zt(nr,Er){function vr(){return new At(function(Sr,Qt){It(nr,Er,Sr,Qt)})}return Dt=Dt?Dt.then(vr,vr):vr()}le(this,"_invoke",{value:Zt})}lt(dt.prototype),he(dt.prototype,Z,function(){return this}),ee.AsyncIterator=dt,ee.async=function(pt,At,It,Dt,Zt){Zt===void 0&&(Zt=Promise);var nr=new dt(pe(pt,At,It,Dt),Zt);return ee.isGeneratorFunction(At)?nr:nr.next().then(function(Er){return Er.done?Er.value:nr.next()})};function yt(pt,At,It){var Dt=ve;return function(nr,Er){if(Dt===Me)throw new Error("Generator is already running");if(Dt===Te){if(nr==="throw")throw Er;return Rt()}for(It.method=nr,It.arg=Er;;){var vr=It.delegate;if(vr){var Sr=gt(vr,It);if(Sr){if(Sr===Ce)continue;return Sr}}if(It.method==="next")It.sent=It._sent=It.arg;else if(It.method==="throw"){if(Dt===ve)throw Dt=Te,It.arg;It.dispatchException(It.arg)}else It.method==="return"&&It.abrupt("return",It.arg);Dt=Me;var Qt=me(pt,At,It);if(Qt.type==="normal"){if(Dt=It.done?Te:Re,Qt.arg===Ce)continue;return{value:Qt.arg,done:It.done}}else Qt.type==="throw"&&(Dt=Te,It.method="throw",It.arg=Qt.arg)}}}function gt(pt,At){var It=At.method,Dt=pt.iterator[It];if(Dt===Q)return At.delegate=null,It==="throw"&&pt.iterator.return&&(At.method="return",At.arg=Q,gt(pt,At),At.method==="throw")||It!=="return"&&(At.method="throw",At.arg=new TypeError("The iterator does not provide a '"+It+"' method")),Ce;var Zt=me(Dt,pt.iterator,At.arg);if(Zt.type==="throw")return At.method="throw",At.arg=Zt.arg,At.delegate=null,Ce;var nr=Zt.arg;if(!nr)return At.method="throw",At.arg=new TypeError("iterator result is not an object"),At.delegate=null,Ce;if(nr.done)At[pt.resultName]=nr.value,At.next=pt.nextLoc,At.method!=="return"&&(At.method="next",At.arg=Q);else return nr;return At.delegate=null,Ce}lt(it),he(it,ae,"Generator"),he(it,U,function(){return this}),he(it,"toString",function(){return"[object Generator]"});function qt(pt){var At={tryLoc:pt[0]};1 in pt&&(At.catchLoc=pt[1]),2 in pt&&(At.finallyLoc=pt[2],At.afterLoc=pt[3]),this.tryEntries.push(At)}function Ft(pt){var At=pt.completion||{};At.type="normal",delete At.arg,pt.completion=At}function Gt(pt){this.tryEntries=[{tryLoc:"root"}],pt.forEach(qt,this),this.reset(!0)}ee.keys=function(pt){var At=Object(pt),It=[];for(var Dt in At)It.push(Dt);return It.reverse(),function Zt(){for(;It.length;){var nr=It.pop();if(nr in At)return Zt.value=nr,Zt.done=!1,Zt}return Zt.done=!0,Zt}};function ft(pt){if(pt!=null){var At=pt[U];if(At)return At.call(pt);if(typeof pt.next=="function")return pt;if(!isNaN(pt.length)){var It=-1,Dt=function Zt(){for(;++It<pt.length;)if(re.call(pt,It))return Zt.value=pt[It],Zt.done=!1,Zt;return Zt.value=Q,Zt.done=!0,Zt};return Dt.next=Dt}}throw new TypeError(typeof pt+" is not iterable")}ee.values=ft;function Rt(){return{value:Q,done:!0}}return Gt.prototype={constructor:Gt,reset:function(pt){if(this.prev=0,this.next=0,this.sent=this._sent=Q,this.done=!1,this.delegate=null,this.method="next",this.arg=Q,this.tryEntries.forEach(Ft),!pt)for(var At in this)At.charAt(0)==="t"&&re.call(this,At)&&!isNaN(+At.slice(1))&&(this[At]=Q)},stop:function(){this.done=!0;var pt=this.tryEntries[0],At=pt.completion;if(At.type==="throw")throw At.arg;return this.rval},dispatchException:function(pt){if(this.done)throw pt;var At=this;function It(Sr,Qt){return nr.type="throw",nr.arg=pt,At.next=Sr,Qt&&(At.method="next",At.arg=Q),!!Qt}for(var Dt=this.tryEntries.length-1;Dt>=0;--Dt){var Zt=this.tryEntries[Dt],nr=Zt.completion;if(Zt.tryLoc==="root")return It("end");if(Zt.tryLoc<=this.prev){var Er=re.call(Zt,"catchLoc"),vr=re.call(Zt,"finallyLoc");if(Er&&vr){if(this.prev<Zt.catchLoc)return It(Zt.catchLoc,!0);if(this.prev<Zt.finallyLoc)return It(Zt.finallyLoc)}else if(Er){if(this.prev<Zt.catchLoc)return It(Zt.catchLoc,!0)}else if(vr){if(this.prev<Zt.finallyLoc)return It(Zt.finallyLoc)}else throw new Error("try statement without catch or finally")}}},abrupt:function(pt,At){for(var It=this.tryEntries.length-1;It>=0;--It){var Dt=this.tryEntries[It];if(Dt.tryLoc<=this.prev&&re.call(Dt,"finallyLoc")&&this.prev<Dt.finallyLoc){var Zt=Dt;break}}Zt&&(pt==="break"||pt==="continue")&&Zt.tryLoc<=At&&At<=Zt.finallyLoc&&(Zt=null);var nr=Zt?Zt.completion:{};return nr.type=pt,nr.arg=At,Zt?(this.method="next",this.next=Zt.finallyLoc,Ce):this.complete(nr)},complete:function(pt,At){if(pt.type==="throw")throw pt.arg;return pt.type==="break"||pt.type==="continue"?this.next=pt.arg:pt.type==="return"?(this.rval=this.arg=pt.arg,this.method="return",this.next="end"):pt.type==="normal"&&At&&(this.next=At),Ce},finish:function(pt){for(var At=this.tryEntries.length-1;At>=0;--At){var It=this.tryEntries[At];if(It.finallyLoc===pt)return this.complete(It.completion,It.afterLoc),Ft(It),Ce}},catch:function(pt){for(var At=this.tryEntries.length-1;At>=0;--At){var It=this.tryEntries[At];if(It.tryLoc===pt){var Dt=It.completion;if(Dt.type==="throw"){var Zt=Dt.arg;Ft(It)}return Zt}}throw new Error("illegal catch attempt")},delegateYield:function(pt,At,It){return this.delegate={iterator:ft(pt),resultName:At,nextLoc:It},this.method==="next"&&(this.arg=Q),Ce}},ee}(Y.exports);try{regeneratorRuntime=K}catch{typeof globalThis=="object"?globalThis.regeneratorRuntime=K:Function("r","regeneratorRuntime = r")(K)}}(runtime)),runtime.exports}requireRuntime();var events={exports:{}},hasRequiredEvents;function requireEvents(){if(hasRequiredEvents)return events.exports;hasRequiredEvents=1;var Y=typeof Reflect=="object"?Reflect:null,K=Y&&typeof Y.apply=="function"?Y.apply:function(ke,Ze,Je){return Function.prototype.apply.call(ke,Ze,Je)},ee;Y&&typeof Y.ownKeys=="function"?ee=Y.ownKeys:Object.getOwnPropertySymbols?ee=function(ke){return Object.getOwnPropertyNames(ke).concat(Object.getOwnPropertySymbols(ke))}:ee=function(ke){return Object.getOwnPropertyNames(ke)};function ne(Fe){console&&console.warn&&console.warn(Fe)}var re=Number.isNaN||function(ke){return ke!==ke};function le(){le.init.call(this)}events.exports=le,events.exports.once=Te,le.EventEmitter=le,le.prototype._events=void 0,le.prototype._eventsCount=0,le.prototype._maxListeners=void 0;var Q=10;function R(Fe){if(typeof Fe!="function")throw new TypeError('The "listener" argument must be of type Function. Received type '+typeof Fe)}Object.defineProperty(le,"defaultMaxListeners",{enumerable:!0,get:function(){return Q},set:function(Fe){if(typeof Fe!="number"||Fe<0||re(Fe))throw new RangeError('The value of "defaultMaxListeners" is out of range. It must be a non-negative number. Received '+Fe+".");Q=Fe}}),le.init=function(){(this._events===void 0||this._events===Object.getPrototypeOf(this)._events)&&(this._events=Object.create(null),this._eventsCount=0),this._maxListeners=this._maxListeners||void 0},le.prototype.setMaxListeners=function(ke){if(typeof ke!="number"||ke<0||re(ke))throw new RangeError('The value of "n" is out of range. It must be a non-negative number. Received '+ke+".");return this._maxListeners=ke,this};function U(Fe){return Fe._maxListeners===void 0?le.defaultMaxListeners:Fe._maxListeners}le.prototype.getMaxListeners=function(){return U(this)},le.prototype.emit=function(ke){for(var Ze=[],Je=1;Je<arguments.length;Je++)Ze.push(arguments[Je]);var Qe=ke==="error",it=this._events;if(it!==void 0)Qe=Qe&&it.error===void 0;else if(!Qe)return!1;if(Qe){var lt;if(Ze.length>0&&(lt=Ze[0]),lt instanceof Error)throw lt;var dt=new Error("Unhandled error."+(lt?" ("+lt.message+")":""));throw dt.context=lt,dt}var yt=it[ke];if(yt===void 0)return!1;if(typeof yt=="function")K(yt,this,Ze);else for(var gt=yt.length,qt=ve(yt,gt),Je=0;Je<gt;++Je)K(qt[Je],this,Ze);return!0};function Z(Fe,ke,Ze,Je){var Qe,it,lt;if(R(Ze),it=Fe._events,it===void 0?(it=Fe._events=Object.create(null),Fe._eventsCount=0):(it.newListener!==void 0&&(Fe.emit("newListener",ke,Ze.listener?Ze.listener:Ze),it=Fe._events),lt=it[ke]),lt===void 0)lt=it[ke]=Ze,++Fe._eventsCount;else if(typeof lt=="function"?lt=it[ke]=Je?[Ze,lt]:[lt,Ze]:Je?lt.unshift(Ze):lt.push(Ze),Qe=U(Fe),Qe>0&&lt.length>Qe&&!lt.warned){lt.warned=!0;var dt=new Error("Possible EventEmitter memory leak detected. "+lt.length+" "+String(ke)+" listeners added. Use emitter.setMaxListeners() to increase limit");dt.name="MaxListenersExceededWarning",dt.emitter=Fe,dt.type=ke,dt.count=lt.length,ne(dt)}return Fe}le.prototype.addListener=function(ke,Ze){return Z(this,ke,Ze,!1)},le.prototype.on=le.prototype.addListener,le.prototype.prependListener=function(ke,Ze){return Z(this,ke,Ze,!0)};function ae(){if(!this.fired)return this.target.removeListener(this.type,this.wrapFn),this.fired=!0,arguments.length===0?this.listener.call(this.target):this.listener.apply(this.target,arguments)}function he(Fe,ke,Ze){var Je={fired:!1,wrapFn:void 0,target:Fe,type:ke,listener:Ze},Qe=ae.bind(Je);return Qe.listener=Ze,Je.wrapFn=Qe,Qe}le.prototype.once=function(ke,Ze){return R(Ze),this.on(ke,he(this,ke,Ze)),this},le.prototype.prependOnceListener=function(ke,Ze){return R(Ze),this.prependListener(ke,he(this,ke,Ze)),this},le.prototype.removeListener=function(ke,Ze){var Je,Qe,it,lt,dt;if(R(Ze),Qe=this._events,Qe===void 0)return this;if(Je=Qe[ke],Je===void 0)return this;if(Je===Ze||Je.listener===Ze)--this._eventsCount===0?this._events=Object.create(null):(delete Qe[ke],Qe.removeListener&&this.emit("removeListener",ke,Je.listener||Ze));else if(typeof Je!="function"){for(it=-1,lt=Je.length-1;lt>=0;lt--)if(Je[lt]===Ze||Je[lt].listener===Ze){dt=Je[lt].listener,it=lt;break}if(it<0)return this;it===0?Je.shift():Re(Je,it),Je.length===1&&(Qe[ke]=Je[0]),Qe.removeListener!==void 0&&this.emit("removeListener",ke,dt||Ze)}return this},le.prototype.off=le.prototype.removeListener,le.prototype.removeAllListeners=function(ke){var Ze,Je,Qe;if(Je=this._events,Je===void 0)return this;if(Je.removeListener===void 0)return arguments.length===0?(this._events=Object.create(null),this._eventsCount=0):Je[ke]!==void 0&&(--this._eventsCount===0?this._events=Object.create(null):delete Je[ke]),this;if(arguments.length===0){var it=Object.keys(Je),lt;for(Qe=0;Qe<it.length;++Qe)lt=it[Qe],lt!=="removeListener"&&this.removeAllListeners(lt);return this.removeAllListeners("removeListener"),this._events=Object.create(null),this._eventsCount=0,this}if(Ze=Je[ke],typeof Ze=="function")this.removeListener(ke,Ze);else if(Ze!==void 0)for(Qe=Ze.length-1;Qe>=0;Qe--)this.removeListener(ke,Ze[Qe]);return this};function pe(Fe,ke,Ze){var Je=Fe._events;if(Je===void 0)return[];var Qe=Je[ke];return Qe===void 0?[]:typeof Qe=="function"?Ze?[Qe.listener||Qe]:[Qe]:Ze?Me(Qe):ve(Qe,Qe.length)}le.prototype.listeners=function(ke){return pe(this,ke,!0)},le.prototype.rawListeners=function(ke){return pe(this,ke,!1)},le.listenerCount=function(Fe,ke){return typeof Fe.listenerCount=="function"?Fe.listenerCount(ke):me.call(Fe,ke)},le.prototype.listenerCount=me;function me(Fe){var ke=this._events;if(ke!==void 0){var Ze=ke[Fe];if(typeof Ze=="function")return 1;if(Ze!==void 0)return Ze.length}return 0}le.prototype.eventNames=function(){return this._eventsCount>0?ee(this._events):[]};function ve(Fe,ke){for(var Ze=new Array(ke),Je=0;Je<ke;++Je)Ze[Je]=Fe[Je];return Ze}function Re(Fe,ke){for(;ke+1<Fe.length;ke++)Fe[ke]=Fe[ke+1];Fe.pop()}function Me(Fe){for(var ke=new Array(Fe.length),Ze=0;Ze<ke.length;++Ze)ke[Ze]=Fe[Ze].listener||Fe[Ze];return ke}function Te(Fe,ke){return new Promise(function(Ze,Je){function Qe(lt){Fe.removeListener(ke,it),Je(lt)}function it(){typeof Fe.removeListener=="function"&&Fe.removeListener("error",Qe),Ze([].slice.call(arguments))}We(Fe,ke,it,{once:!0}),ke!=="error"&&Ce(Fe,Qe,{once:!0})})}function Ce(Fe,ke,Ze){typeof Fe.on=="function"&&We(Fe,"error",ke,Ze)}function We(Fe,ke,Ze,Je){if(typeof Fe.on=="function")Je.once?Fe.once(ke,Ze):Fe.on(ke,Ze);else if(typeof Fe.addEventListener=="function")Fe.addEventListener(ke,function Qe(it){Je.once&&Fe.removeEventListener(ke,Qe),Ze(it)});else throw new TypeError('The "emitter" argument must be of type EventEmitter. Received type '+typeof Fe)}return events.exports}var eventsExports=requireEvents();const EventEmitter=getDefaultExportFromCjs(eventsExports),viewStore=(Y,K)=>{Y.view="log",K.on("view:set",ee=>{ee!==Y.view&&(Y.view=ee,K.emit(K.STATE_CHANGE))})};var isObject_1,hasRequiredIsObject;function requireIsObject(){if(hasRequiredIsObject)return isObject_1;hasRequiredIsObject=1;function Y(K){var ee=typeof K;return K!=null&&(ee=="object"||ee=="function")}return isObject_1=Y,isObject_1}var _freeGlobal,hasRequired_freeGlobal;function require_freeGlobal(){if(hasRequired_freeGlobal)return _freeGlobal;hasRequired_freeGlobal=1;var Y=typeof commonjsGlobal=="object"&&commonjsGlobal&&commonjsGlobal.Object===Object&&commonjsGlobal;return _freeGlobal=Y,_freeGlobal}var _root,hasRequired_root;function require_root(){if(hasRequired_root)return _root;hasRequired_root=1;var Y=require_freeGlobal(),K=typeof self=="object"&&self&&self.Object===Object&&self,ee=Y||K||Function("return this")();return _root=ee,_root}var now_1,hasRequiredNow;function requireNow(){if(hasRequiredNow)return now_1;hasRequiredNow=1;var Y=require_root(),K=function(){return Y.Date.now()};return now_1=K,now_1}var _trimmedEndIndex,hasRequired_trimmedEndIndex;function require_trimmedEndIndex(){if(hasRequired_trimmedEndIndex)return _trimmedEndIndex;hasRequired_trimmedEndIndex=1;var Y=/\s/;function K(ee){for(var ne=ee.length;ne--&&Y.test(ee.charAt(ne)););return ne}return _trimmedEndIndex=K,_trimmedEndIndex}var _baseTrim,hasRequired_baseTrim;function require_baseTrim(){if(hasRequired_baseTrim)return _baseTrim;hasRequired_baseTrim=1;var Y=require_trimmedEndIndex(),K=/^\s+/;function ee(ne){return ne&&ne.slice(0,Y(ne)+1).replace(K,"")}return _baseTrim=ee,_baseTrim}var _Symbol,hasRequired_Symbol;function require_Symbol(){if(hasRequired_Symbol)return _Symbol;hasRequired_Symbol=1;var Y=require_root(),K=Y.Symbol;return _Symbol=K,_Symbol}var _getRawTag,hasRequired_getRawTag;function require_getRawTag(){if(hasRequired_getRawTag)return _getRawTag;hasRequired_getRawTag=1;var Y=require_Symbol(),K=Object.prototype,ee=K.hasOwnProperty,ne=K.toString,re=Y?Y.toStringTag:void 0;function le(Q){var R=ee.call(Q,re),U=Q[re];try{Q[re]=void 0;var Z=!0}catch{}var ae=ne.call(Q);return Z&&(R?Q[re]=U:delete Q[re]),ae}return _getRawTag=le,_getRawTag}var _objectToString,hasRequired_objectToString;function require_objectToString(){if(hasRequired_objectToString)return _objectToString;hasRequired_objectToString=1;var Y=Object.prototype,K=Y.toString;function ee(ne){return K.call(ne)}return _objectToString=ee,_objectToString}var _baseGetTag,hasRequired_baseGetTag;function require_baseGetTag(){if(hasRequired_baseGetTag)return _baseGetTag;hasRequired_baseGetTag=1;var Y=require_Symbol(),K=require_getRawTag(),ee=require_objectToString(),ne="[object Null]",re="[object Undefined]",le=Y?Y.toStringTag:void 0;function Q(R){return R==null?R===void 0?re:ne:le&&le in Object(R)?K(R):ee(R)}return _baseGetTag=Q,_baseGetTag}var isObjectLike_1,hasRequiredIsObjectLike;function requireIsObjectLike(){if(hasRequiredIsObjectLike)return isObjectLike_1;hasRequiredIsObjectLike=1;function Y(K){return K!=null&&typeof K=="object"}return isObjectLike_1=Y,isObjectLike_1}var isSymbol_1,hasRequiredIsSymbol;function requireIsSymbol(){if(hasRequiredIsSymbol)return isSymbol_1;hasRequiredIsSymbol=1;var Y=require_baseGetTag(),K=requireIsObjectLike(),ee="[object Symbol]";function ne(re){return typeof re=="symbol"||K(re)&&Y(re)==ee}return isSymbol_1=ne,isSymbol_1}var toNumber_1,hasRequiredToNumber;function requireToNumber(){if(hasRequiredToNumber)return toNumber_1;hasRequiredToNumber=1;var Y=require_baseTrim(),K=requireIsObject(),ee=requireIsSymbol(),ne=NaN,re=/^[-+]0x[0-9a-f]+$/i,le=/^0b[01]+$/i,Q=/^0o[0-7]+$/i,R=parseInt;function U(Z){if(typeof Z=="number")return Z;if(ee(Z))return ne;if(K(Z)){var ae=typeof Z.valueOf=="function"?Z.valueOf():Z;Z=K(ae)?ae+"":ae}if(typeof Z!="string")return Z===0?Z:+Z;Z=Y(Z);var he=le.test(Z);return he||Q.test(Z)?R(Z.slice(2),he?2:8):re.test(Z)?ne:+Z}return toNumber_1=U,toNumber_1}var debounce_1,hasRequiredDebounce;function requireDebounce(){if(hasRequiredDebounce)return debounce_1;hasRequiredDebounce=1;var Y=requireIsObject(),K=requireNow(),ee=requireToNumber(),ne="Expected a function",re=Math.max,le=Math.min;function Q(R,U,Z){var ae,he,pe,me,ve,Re,Me=0,Te=!1,Ce=!1,We=!0;if(typeof R!="function")throw new TypeError(ne);U=ee(U)||0,Y(Z)&&(Te=!!Z.leading,Ce="maxWait"in Z,pe=Ce?re(ee(Z.maxWait)||0,U):pe,We="trailing"in Z?!!Z.trailing:We);function Fe(gt){var qt=ae,Ft=he;return ae=he=void 0,Me=gt,me=R.apply(Ft,qt),me}function ke(gt){return Me=gt,ve=setTimeout(Qe,U),Te?Fe(gt):me}function Ze(gt){var qt=gt-Re,Ft=gt-Me,Gt=U-qt;return Ce?le(Gt,pe-Ft):Gt}function Je(gt){var qt=gt-Re,Ft=gt-Me;return Re===void 0||qt>=U||qt<0||Ce&&Ft>=pe}function Qe(){var gt=K();if(Je(gt))return it(gt);ve=setTimeout(Qe,Ze(gt))}function it(gt){return ve=void 0,We&&ae?Fe(gt):(ae=he=void 0,me)}function lt(){ve!==void 0&&clearTimeout(ve),Me=0,ae=Re=he=ve=void 0}function dt(){return ve===void 0?me:it(K())}function yt(){var gt=K(),qt=Je(gt);if(ae=arguments,he=this,Re=gt,qt){if(ve===void 0)return ke(Re);if(Ce)return clearTimeout(ve),ve=setTimeout(Qe,U),Fe(Re)}return ve===void 0&&(ve=setTimeout(Qe,U)),me}return yt.cancel=lt,yt.flush=dt,yt}return debounce_1=Q,debounce_1}var debounceExports=requireDebounce();const debounce=getDefaultExportFromCjs(debounceExports);var contentType={};/*!
 * content-type
 * Copyright(c) 2015 Douglas Christopher Wilson
 * MIT Licensed
 */var hasRequiredContentType;function requireContentType(){if(hasRequiredContentType)return contentType;hasRequiredContentType=1;var Y=/; *([!#$%&'*+.^_`|~0-9A-Za-z-]+) *= *("(?:[\u000b\u0020\u0021\u0023-\u005b\u005d-\u007e\u0080-\u00ff]|\\[\u000b\u0020-\u00ff])*"|[!#$%&'*+.^_`|~0-9A-Za-z-]+) */g,K=/^[\u000b\u0020-\u007e\u0080-\u00ff]+$/,ee=/^[!#$%&'*+.^_`|~0-9A-Za-z-]+$/,ne=/\\([\u000b\u0020-\u00ff])/g,re=/([\\"])/g,le=/^[!#$%&'*+.^_`|~0-9A-Za-z-]+\/[!#$%&'*+.^_`|~0-9A-Za-z-]+$/;contentType.format=Q,contentType.parse=R;function Q(he){if(!he||typeof he!="object")throw new TypeError("argument obj is required");var pe=he.parameters,me=he.type;if(!me||!le.test(me))throw new TypeError("invalid type");var ve=me;if(pe&&typeof pe=="object")for(var Re,Me=Object.keys(pe).sort(),Te=0;Te<Me.length;Te++){if(Re=Me[Te],!ee.test(Re))throw new TypeError("invalid parameter name");ve+="; "+Re+"="+Z(pe[Re])}return ve}function R(he){if(!he)throw new TypeError("argument string is required");var pe=typeof he=="object"?U(he):he;if(typeof pe!="string")throw new TypeError("argument string is required to be a string");var me=pe.indexOf(";"),ve=me!==-1?pe.slice(0,me).trim():pe.trim();if(!le.test(ve))throw new TypeError("invalid media type");var Re=new ae(ve.toLowerCase());if(me!==-1){var Me,Te,Ce;for(Y.lastIndex=me;Te=Y.exec(pe);){if(Te.index!==me)throw new TypeError("invalid parameter format");me+=Te[0].length,Me=Te[1].toLowerCase(),Ce=Te[2],Ce.charCodeAt(0)===34&&(Ce=Ce.slice(1,-1),Ce.indexOf("\\")!==-1&&(Ce=Ce.replace(ne,"$1"))),Re.parameters[Me]=Ce}if(me!==pe.length)throw new TypeError("invalid parameter format")}return Re}function U(he){var pe;if(typeof he.getHeader=="function"?pe=he.getHeader("content-type"):typeof he.headers=="object"&&(pe=he.headers&&he.headers["content-type"]),typeof pe!="string")throw new TypeError("content-type header is missing from object");return pe}function Z(he){var pe=String(he);if(ee.test(pe))return pe;if(pe.length>0&&!K.test(pe))throw new TypeError("invalid parameter value");return'"'+pe.replace(re,"\\$1")+'"'}function ae(he){this.parameters=Object.create(null),this.type=he}return contentType}var contentTypeExports=requireContentType(),buffer={},base64Js={},hasRequiredBase64Js;function requireBase64Js(){if(hasRequiredBase64Js)return base64Js;hasRequiredBase64Js=1,base64Js.byteLength=R,base64Js.toByteArray=Z,base64Js.fromByteArray=pe;for(var Y=[],K=[],ee=typeof Uint8Array<"u"?Uint8Array:Array,ne="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",re=0,le=ne.length;re<le;++re)Y[re]=ne[re],K[ne.charCodeAt(re)]=re;K[45]=62,K[95]=63;function Q(me){var ve=me.length;if(ve%4>0)throw new Error("Invalid string. Length must be a multiple of 4");var Re=me.indexOf("=");Re===-1&&(Re=ve);var Me=Re===ve?0:4-Re%4;return[Re,Me]}function R(me){var ve=Q(me),Re=ve[0],Me=ve[1];return(Re+Me)*3/4-Me}function U(me,ve,Re){return(ve+Re)*3/4-Re}function Z(me){var ve,Re=Q(me),Me=Re[0],Te=Re[1],Ce=new ee(U(me,Me,Te)),We=0,Fe=Te>0?Me-4:Me,ke;for(ke=0;ke<Fe;ke+=4)ve=K[me.charCodeAt(ke)]<<18|K[me.charCodeAt(ke+1)]<<12|K[me.charCodeAt(ke+2)]<<6|K[me.charCodeAt(ke+3)],Ce[We++]=ve>>16&255,Ce[We++]=ve>>8&255,Ce[We++]=ve&255;return Te===2&&(ve=K[me.charCodeAt(ke)]<<2|K[me.charCodeAt(ke+1)]>>4,Ce[We++]=ve&255),Te===1&&(ve=K[me.charCodeAt(ke)]<<10|K[me.charCodeAt(ke+1)]<<4|K[me.charCodeAt(ke+2)]>>2,Ce[We++]=ve>>8&255,Ce[We++]=ve&255),Ce}function ae(me){return Y[me>>18&63]+Y[me>>12&63]+Y[me>>6&63]+Y[me&63]}function he(me,ve,Re){for(var Me,Te=[],Ce=ve;Ce<Re;Ce+=3)Me=(me[Ce]<<16&16711680)+(me[Ce+1]<<8&65280)+(me[Ce+2]&255),Te.push(ae(Me));return Te.join("")}function pe(me){for(var ve,Re=me.length,Me=Re%3,Te=[],Ce=16383,We=0,Fe=Re-Me;We<Fe;We+=Ce)Te.push(he(me,We,We+Ce>Fe?Fe:We+Ce));return Me===1?(ve=me[Re-1],Te.push(Y[ve>>2]+Y[ve<<4&63]+"==")):Me===2&&(ve=(me[Re-2]<<8)+me[Re-1],Te.push(Y[ve>>10]+Y[ve>>4&63]+Y[ve<<2&63]+"=")),Te.join("")}return base64Js}var ieee754={};/*! ieee754. BSD-3-Clause License. Feross Aboukhadijeh <https://feross.org/opensource> */var hasRequiredIeee754;function requireIeee754(){return hasRequiredIeee754||(hasRequiredIeee754=1,ieee754.read=function(Y,K,ee,ne,re){var le,Q,R=re*8-ne-1,U=(1<<R)-1,Z=U>>1,ae=-7,he=ee?re-1:0,pe=ee?-1:1,me=Y[K+he];for(he+=pe,le=me&(1<<-ae)-1,me>>=-ae,ae+=R;ae>0;le=le*256+Y[K+he],he+=pe,ae-=8);for(Q=le&(1<<-ae)-1,le>>=-ae,ae+=ne;ae>0;Q=Q*256+Y[K+he],he+=pe,ae-=8);if(le===0)le=1-Z;else{if(le===U)return Q?NaN:(me?-1:1)*(1/0);Q=Q+Math.pow(2,ne),le=le-Z}return(me?-1:1)*Q*Math.pow(2,le-ne)},ieee754.write=function(Y,K,ee,ne,re,le){var Q,R,U,Z=le*8-re-1,ae=(1<<Z)-1,he=ae>>1,pe=re===23?Math.pow(2,-24)-Math.pow(2,-77):0,me=ne?0:le-1,ve=ne?1:-1,Re=K<0||K===0&&1/K<0?1:0;for(K=Math.abs(K),isNaN(K)||K===1/0?(R=isNaN(K)?1:0,Q=ae):(Q=Math.floor(Math.log(K)/Math.LN2),K*(U=Math.pow(2,-Q))<1&&(Q--,U*=2),Q+he>=1?K+=pe/U:K+=pe*Math.pow(2,1-he),K*U>=2&&(Q++,U/=2),Q+he>=ae?(R=0,Q=ae):Q+he>=1?(R=(K*U-1)*Math.pow(2,re),Q=Q+he):(R=K*Math.pow(2,he-1)*Math.pow(2,re),Q=0));re>=8;Y[ee+me]=R&255,me+=ve,R/=256,re-=8);for(Q=Q<<re|R,Z+=re;Z>0;Y[ee+me]=Q&255,me+=ve,Q/=256,Z-=8);Y[ee+me-ve]|=Re*128}),ieee754}/*!
 * The buffer module from node.js, for the browser.
 *
 * @author   Feross Aboukhadijeh <https://feross.org>
 * @license  MIT
 */var hasRequiredBuffer;function requireBuffer(){return hasRequiredBuffer||(hasRequiredBuffer=1,function(Y){const K=requireBase64Js(),ee=requireIeee754(),ne=typeof Symbol=="function"&&typeof Symbol.for=="function"?Symbol.for("nodejs.util.inspect.custom"):null;Y.Buffer=R,Y.SlowBuffer=Ce,Y.INSPECT_MAX_BYTES=50;const re=2147483647;Y.kMaxLength=re,R.TYPED_ARRAY_SUPPORT=le(),!R.TYPED_ARRAY_SUPPORT&&typeof console<"u"&&typeof console.error=="function"&&console.error("This browser lacks typed array (Uint8Array) support which is required by `buffer` v5.x. Use `buffer` v4.x if you require old browser support.");function le(){try{const Ge=new Uint8Array(1),Ee={foo:function(){return 42}};return Object.setPrototypeOf(Ee,Uint8Array.prototype),Object.setPrototypeOf(Ge,Ee),Ge.foo()===42}catch{return!1}}Object.defineProperty(R.prototype,"parent",{enumerable:!0,get:function(){if(R.isBuffer(this))return this.buffer}}),Object.defineProperty(R.prototype,"offset",{enumerable:!0,get:function(){if(R.isBuffer(this))return this.byteOffset}});function Q(Ge){if(Ge>re)throw new RangeError('The value "'+Ge+'" is invalid for option "size"');const Ee=new Uint8Array(Ge);return Object.setPrototypeOf(Ee,R.prototype),Ee}function R(Ge,Ee,Pe){if(typeof Ge=="number"){if(typeof Ee=="string")throw new TypeError('The "string" argument must be of type string. Received type number');return he(Ge)}return U(Ge,Ee,Pe)}R.poolSize=8192;function U(Ge,Ee,Pe){if(typeof Ge=="string")return pe(Ge,Ee);if(ArrayBuffer.isView(Ge))return ve(Ge);if(Ge==null)throw new TypeError("The first argument must be one of type string, Buffer, ArrayBuffer, Array, or Array-like Object. Received type "+typeof Ge);if(sr(Ge,ArrayBuffer)||Ge&&sr(Ge.buffer,ArrayBuffer)||typeof SharedArrayBuffer<"u"&&(sr(Ge,SharedArrayBuffer)||Ge&&sr(Ge.buffer,SharedArrayBuffer)))return Re(Ge,Ee,Pe);if(typeof Ge=="number")throw new TypeError('The "value" argument must not be of type number. Received type number');const He=Ge.valueOf&&Ge.valueOf();if(He!=null&&He!==Ge)return R.from(He,Ee,Pe);const ut=Me(Ge);if(ut)return ut;if(typeof Symbol<"u"&&Symbol.toPrimitive!=null&&typeof Ge[Symbol.toPrimitive]=="function")return R.from(Ge[Symbol.toPrimitive]("string"),Ee,Pe);throw new TypeError("The first argument must be one of type string, Buffer, ArrayBuffer, Array, or Array-like Object. Received type "+typeof Ge)}R.from=function(Ge,Ee,Pe){return U(Ge,Ee,Pe)},Object.setPrototypeOf(R.prototype,Uint8Array.prototype),Object.setPrototypeOf(R,Uint8Array);function Z(Ge){if(typeof Ge!="number")throw new TypeError('"size" argument must be of type number');if(Ge<0)throw new RangeError('The value "'+Ge+'" is invalid for option "size"')}function ae(Ge,Ee,Pe){return Z(Ge),Ge<=0?Q(Ge):Ee!==void 0?typeof Pe=="string"?Q(Ge).fill(Ee,Pe):Q(Ge).fill(Ee):Q(Ge)}R.alloc=function(Ge,Ee,Pe){return ae(Ge,Ee,Pe)};function he(Ge){return Z(Ge),Q(Ge<0?0:Te(Ge)|0)}R.allocUnsafe=function(Ge){return he(Ge)},R.allocUnsafeSlow=function(Ge){return he(Ge)};function pe(Ge,Ee){if((typeof Ee!="string"||Ee==="")&&(Ee="utf8"),!R.isEncoding(Ee))throw new TypeError("Unknown encoding: "+Ee);const Pe=We(Ge,Ee)|0;let He=Q(Pe);const ut=He.write(Ge,Ee);return ut!==Pe&&(He=He.slice(0,ut)),He}function me(Ge){const Ee=Ge.length<0?0:Te(Ge.length)|0,Pe=Q(Ee);for(let He=0;He<Ee;He+=1)Pe[He]=Ge[He]&255;return Pe}function ve(Ge){if(sr(Ge,Uint8Array)){const Ee=new Uint8Array(Ge);return Re(Ee.buffer,Ee.byteOffset,Ee.byteLength)}return me(Ge)}function Re(Ge,Ee,Pe){if(Ee<0||Ge.byteLength<Ee)throw new RangeError('"offset" is outside of buffer bounds');if(Ge.byteLength<Ee+(Pe||0))throw new RangeError('"length" is outside of buffer bounds');let He;return Ee===void 0&&Pe===void 0?He=new Uint8Array(Ge):Pe===void 0?He=new Uint8Array(Ge,Ee):He=new Uint8Array(Ge,Ee,Pe),Object.setPrototypeOf(He,R.prototype),He}function Me(Ge){if(R.isBuffer(Ge)){const Ee=Te(Ge.length)|0,Pe=Q(Ee);return Pe.length===0||Ge.copy(Pe,0,0,Ee),Pe}if(Ge.length!==void 0)return typeof Ge.length!="number"||Dr(Ge.length)?Q(0):me(Ge);if(Ge.type==="Buffer"&&Array.isArray(Ge.data))return me(Ge.data)}function Te(Ge){if(Ge>=re)throw new RangeError("Attempt to allocate Buffer larger than maximum size: 0x"+re.toString(16)+" bytes");return Ge|0}function Ce(Ge){return+Ge!=Ge&&(Ge=0),R.alloc(+Ge)}R.isBuffer=function(Ee){return Ee!=null&&Ee._isBuffer===!0&&Ee!==R.prototype},R.compare=function(Ee,Pe){if(sr(Ee,Uint8Array)&&(Ee=R.from(Ee,Ee.offset,Ee.byteLength)),sr(Pe,Uint8Array)&&(Pe=R.from(Pe,Pe.offset,Pe.byteLength)),!R.isBuffer(Ee)||!R.isBuffer(Pe))throw new TypeError('The "buf1", "buf2" arguments must be one of type Buffer or Uint8Array');if(Ee===Pe)return 0;let He=Ee.length,ut=Pe.length;for(let Ve=0,qe=Math.min(He,ut);Ve<qe;++Ve)if(Ee[Ve]!==Pe[Ve]){He=Ee[Ve],ut=Pe[Ve];break}return He<ut?-1:ut<He?1:0},R.isEncoding=function(Ee){switch(String(Ee).toLowerCase()){case"hex":case"utf8":case"utf-8":case"ascii":case"latin1":case"binary":case"base64":case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return!0;default:return!1}},R.concat=function(Ee,Pe){if(!Array.isArray(Ee))throw new TypeError('"list" argument must be an Array of Buffers');if(Ee.length===0)return R.alloc(0);let He;if(Pe===void 0)for(Pe=0,He=0;He<Ee.length;++He)Pe+=Ee[He].length;const ut=R.allocUnsafe(Pe);let Ve=0;for(He=0;He<Ee.length;++He){let qe=Ee[He];if(sr(qe,Uint8Array))Ve+qe.length>ut.length?(R.isBuffer(qe)||(qe=R.from(qe)),qe.copy(ut,Ve)):Uint8Array.prototype.set.call(ut,qe,Ve);else if(R.isBuffer(qe))qe.copy(ut,Ve);else throw new TypeError('"list" argument must be an Array of Buffers');Ve+=qe.length}return ut};function We(Ge,Ee){if(R.isBuffer(Ge))return Ge.length;if(ArrayBuffer.isView(Ge)||sr(Ge,ArrayBuffer))return Ge.byteLength;if(typeof Ge!="string")throw new TypeError('The "string" argument must be one of type string, Buffer, or ArrayBuffer. Received type '+typeof Ge);const Pe=Ge.length,He=arguments.length>2&&arguments[2]===!0;if(!He&&Pe===0)return 0;let ut=!1;for(;;)switch(Ee){case"ascii":case"latin1":case"binary":return Pe;case"utf8":case"utf-8":return br(Ge).length;case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return Pe*2;case"hex":return Pe>>>1;case"base64":return zr(Ge).length;default:if(ut)return He?-1:br(Ge).length;Ee=(""+Ee).toLowerCase(),ut=!0}}R.byteLength=We;function Fe(Ge,Ee,Pe){let He=!1;if((Ee===void 0||Ee<0)&&(Ee=0),Ee>this.length||((Pe===void 0||Pe>this.length)&&(Pe=this.length),Pe<=0)||(Pe>>>=0,Ee>>>=0,Pe<=Ee))return"";for(Ge||(Ge="utf8");;)switch(Ge){case"hex":return pt(this,Ee,Pe);case"utf8":case"utf-8":return qt(this,Ee,Pe);case"ascii":return ft(this,Ee,Pe);case"latin1":case"binary":return Rt(this,Ee,Pe);case"base64":return gt(this,Ee,Pe);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return At(this,Ee,Pe);default:if(He)throw new TypeError("Unknown encoding: "+Ge);Ge=(Ge+"").toLowerCase(),He=!0}}R.prototype._isBuffer=!0;function ke(Ge,Ee,Pe){const He=Ge[Ee];Ge[Ee]=Ge[Pe],Ge[Pe]=He}R.prototype.swap16=function(){const Ee=this.length;if(Ee%2!==0)throw new RangeError("Buffer size must be a multiple of 16-bits");for(let Pe=0;Pe<Ee;Pe+=2)ke(this,Pe,Pe+1);return this},R.prototype.swap32=function(){const Ee=this.length;if(Ee%4!==0)throw new RangeError("Buffer size must be a multiple of 32-bits");for(let Pe=0;Pe<Ee;Pe+=4)ke(this,Pe,Pe+3),ke(this,Pe+1,Pe+2);return this},R.prototype.swap64=function(){const Ee=this.length;if(Ee%8!==0)throw new RangeError("Buffer size must be a multiple of 64-bits");for(let Pe=0;Pe<Ee;Pe+=8)ke(this,Pe,Pe+7),ke(this,Pe+1,Pe+6),ke(this,Pe+2,Pe+5),ke(this,Pe+3,Pe+4);return this},R.prototype.toString=function(){const Ee=this.length;return Ee===0?"":arguments.length===0?qt(this,0,Ee):Fe.apply(this,arguments)},R.prototype.toLocaleString=R.prototype.toString,R.prototype.equals=function(Ee){if(!R.isBuffer(Ee))throw new TypeError("Argument must be a Buffer");return this===Ee?!0:R.compare(this,Ee)===0},R.prototype.inspect=function(){let Ee="";const Pe=Y.INSPECT_MAX_BYTES;return Ee=this.toString("hex",0,Pe).replace(/(.{2})/g,"$1 ").trim(),this.length>Pe&&(Ee+=" ... "),"<Buffer "+Ee+">"},ne&&(R.prototype[ne]=R.prototype.inspect),R.prototype.compare=function(Ee,Pe,He,ut,Ve){if(sr(Ee,Uint8Array)&&(Ee=R.from(Ee,Ee.offset,Ee.byteLength)),!R.isBuffer(Ee))throw new TypeError('The "target" argument must be one of type Buffer or Uint8Array. Received type '+typeof Ee);if(Pe===void 0&&(Pe=0),He===void 0&&(He=Ee?Ee.length:0),ut===void 0&&(ut=0),Ve===void 0&&(Ve=this.length),Pe<0||He>Ee.length||ut<0||Ve>this.length)throw new RangeError("out of range index");if(ut>=Ve&&Pe>=He)return 0;if(ut>=Ve)return-1;if(Pe>=He)return 1;if(Pe>>>=0,He>>>=0,ut>>>=0,Ve>>>=0,this===Ee)return 0;let qe=Ve-ut,De=He-Pe;const ze=Math.min(qe,De),Le=this.slice(ut,Ve),Ke=Ee.slice(Pe,He);for(let et=0;et<ze;++et)if(Le[et]!==Ke[et]){qe=Le[et],De=Ke[et];break}return qe<De?-1:De<qe?1:0};function Ze(Ge,Ee,Pe,He,ut){if(Ge.length===0)return-1;if(typeof Pe=="string"?(He=Pe,Pe=0):Pe>2147483647?Pe=2147483647:Pe<-2147483648&&(Pe=-2147483648),Pe=+Pe,Dr(Pe)&&(Pe=ut?0:Ge.length-1),Pe<0&&(Pe=Ge.length+Pe),Pe>=Ge.length){if(ut)return-1;Pe=Ge.length-1}else if(Pe<0)if(ut)Pe=0;else return-1;if(typeof Ee=="string"&&(Ee=R.from(Ee,He)),R.isBuffer(Ee))return Ee.length===0?-1:Je(Ge,Ee,Pe,He,ut);if(typeof Ee=="number")return Ee=Ee&255,typeof Uint8Array.prototype.indexOf=="function"?ut?Uint8Array.prototype.indexOf.call(Ge,Ee,Pe):Uint8Array.prototype.lastIndexOf.call(Ge,Ee,Pe):Je(Ge,[Ee],Pe,He,ut);throw new TypeError("val must be string, number or Buffer")}function Je(Ge,Ee,Pe,He,ut){let Ve=1,qe=Ge.length,De=Ee.length;if(He!==void 0&&(He=String(He).toLowerCase(),He==="ucs2"||He==="ucs-2"||He==="utf16le"||He==="utf-16le")){if(Ge.length<2||Ee.length<2)return-1;Ve=2,qe/=2,De/=2,Pe/=2}function ze(Ke,et){return Ve===1?Ke[et]:Ke.readUInt16BE(et*Ve)}let Le;if(ut){let Ke=-1;for(Le=Pe;Le<qe;Le++)if(ze(Ge,Le)===ze(Ee,Ke===-1?0:Le-Ke)){if(Ke===-1&&(Ke=Le),Le-Ke+1===De)return Ke*Ve}else Ke!==-1&&(Le-=Le-Ke),Ke=-1}else for(Pe+De>qe&&(Pe=qe-De),Le=Pe;Le>=0;Le--){let Ke=!0;for(let et=0;et<De;et++)if(ze(Ge,Le+et)!==ze(Ee,et)){Ke=!1;break}if(Ke)return Le}return-1}R.prototype.includes=function(Ee,Pe,He){return this.indexOf(Ee,Pe,He)!==-1},R.prototype.indexOf=function(Ee,Pe,He){return Ze(this,Ee,Pe,He,!0)},R.prototype.lastIndexOf=function(Ee,Pe,He){return Ze(this,Ee,Pe,He,!1)};function Qe(Ge,Ee,Pe,He){Pe=Number(Pe)||0;const ut=Ge.length-Pe;He?(He=Number(He),He>ut&&(He=ut)):He=ut;const Ve=Ee.length;He>Ve/2&&(He=Ve/2);let qe;for(qe=0;qe<He;++qe){const De=parseInt(Ee.substr(qe*2,2),16);if(Dr(De))return qe;Ge[Pe+qe]=De}return qe}function it(Ge,Ee,Pe,He){return rr(br(Ee,Ge.length-Pe),Ge,Pe,He)}function lt(Ge,Ee,Pe,He){return rr(Lr(Ee),Ge,Pe,He)}function dt(Ge,Ee,Pe,He){return rr(zr(Ee),Ge,Pe,He)}function yt(Ge,Ee,Pe,He){return rr(Br(Ee,Ge.length-Pe),Ge,Pe,He)}R.prototype.write=function(Ee,Pe,He,ut){if(Pe===void 0)ut="utf8",He=this.length,Pe=0;else if(He===void 0&&typeof Pe=="string")ut=Pe,He=this.length,Pe=0;else if(isFinite(Pe))Pe=Pe>>>0,isFinite(He)?(He=He>>>0,ut===void 0&&(ut="utf8")):(ut=He,He=void 0);else throw new Error("Buffer.write(string, encoding, offset[, length]) is no longer supported");const Ve=this.length-Pe;if((He===void 0||He>Ve)&&(He=Ve),Ee.length>0&&(He<0||Pe<0)||Pe>this.length)throw new RangeError("Attempt to write outside buffer bounds");ut||(ut="utf8");let qe=!1;for(;;)switch(ut){case"hex":return Qe(this,Ee,Pe,He);case"utf8":case"utf-8":return it(this,Ee,Pe,He);case"ascii":case"latin1":case"binary":return lt(this,Ee,Pe,He);case"base64":return dt(this,Ee,Pe,He);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return yt(this,Ee,Pe,He);default:if(qe)throw new TypeError("Unknown encoding: "+ut);ut=(""+ut).toLowerCase(),qe=!0}},R.prototype.toJSON=function(){return{type:"Buffer",data:Array.prototype.slice.call(this._arr||this,0)}};function gt(Ge,Ee,Pe){return Ee===0&&Pe===Ge.length?K.fromByteArray(Ge):K.fromByteArray(Ge.slice(Ee,Pe))}function qt(Ge,Ee,Pe){Pe=Math.min(Ge.length,Pe);const He=[];let ut=Ee;for(;ut<Pe;){const Ve=Ge[ut];let qe=null,De=Ve>239?4:Ve>223?3:Ve>191?2:1;if(ut+De<=Pe){let ze,Le,Ke,et;switch(De){case 1:Ve<128&&(qe=Ve);break;case 2:ze=Ge[ut+1],(ze&192)===128&&(et=(Ve&31)<<6|ze&63,et>127&&(qe=et));break;case 3:ze=Ge[ut+1],Le=Ge[ut+2],(ze&192)===128&&(Le&192)===128&&(et=(Ve&15)<<12|(ze&63)<<6|Le&63,et>2047&&(et<55296||et>57343)&&(qe=et));break;case 4:ze=Ge[ut+1],Le=Ge[ut+2],Ke=Ge[ut+3],(ze&192)===128&&(Le&192)===128&&(Ke&192)===128&&(et=(Ve&15)<<18|(ze&63)<<12|(Le&63)<<6|Ke&63,et>65535&&et<1114112&&(qe=et))}}qe===null?(qe=65533,De=1):qe>65535&&(qe-=65536,He.push(qe>>>10&1023|55296),qe=56320|qe&1023),He.push(qe),ut+=De}return Gt(He)}const Ft=4096;function Gt(Ge){const Ee=Ge.length;if(Ee<=Ft)return String.fromCharCode.apply(String,Ge);let Pe="",He=0;for(;He<Ee;)Pe+=String.fromCharCode.apply(String,Ge.slice(He,He+=Ft));return Pe}function ft(Ge,Ee,Pe){let He="";Pe=Math.min(Ge.length,Pe);for(let ut=Ee;ut<Pe;++ut)He+=String.fromCharCode(Ge[ut]&127);return He}function Rt(Ge,Ee,Pe){let He="";Pe=Math.min(Ge.length,Pe);for(let ut=Ee;ut<Pe;++ut)He+=String.fromCharCode(Ge[ut]);return He}function pt(Ge,Ee,Pe){const He=Ge.length;(!Ee||Ee<0)&&(Ee=0),(!Pe||Pe<0||Pe>He)&&(Pe=He);let ut="";for(let Ve=Ee;Ve<Pe;++Ve)ut+=lr[Ge[Ve]];return ut}function At(Ge,Ee,Pe){const He=Ge.slice(Ee,Pe);let ut="";for(let Ve=0;Ve<He.length-1;Ve+=2)ut+=String.fromCharCode(He[Ve]+He[Ve+1]*256);return ut}R.prototype.slice=function(Ee,Pe){const He=this.length;Ee=~~Ee,Pe=Pe===void 0?He:~~Pe,Ee<0?(Ee+=He,Ee<0&&(Ee=0)):Ee>He&&(Ee=He),Pe<0?(Pe+=He,Pe<0&&(Pe=0)):Pe>He&&(Pe=He),Pe<Ee&&(Pe=Ee);const ut=this.subarray(Ee,Pe);return Object.setPrototypeOf(ut,R.prototype),ut};function It(Ge,Ee,Pe){if(Ge%1!==0||Ge<0)throw new RangeError("offset is not uint");if(Ge+Ee>Pe)throw new RangeError("Trying to access beyond buffer length")}R.prototype.readUintLE=R.prototype.readUIntLE=function(Ee,Pe,He){Ee=Ee>>>0,Pe=Pe>>>0,He||It(Ee,Pe,this.length);let ut=this[Ee],Ve=1,qe=0;for(;++qe<Pe&&(Ve*=256);)ut+=this[Ee+qe]*Ve;return ut},R.prototype.readUintBE=R.prototype.readUIntBE=function(Ee,Pe,He){Ee=Ee>>>0,Pe=Pe>>>0,He||It(Ee,Pe,this.length);let ut=this[Ee+--Pe],Ve=1;for(;Pe>0&&(Ve*=256);)ut+=this[Ee+--Pe]*Ve;return ut},R.prototype.readUint8=R.prototype.readUInt8=function(Ee,Pe){return Ee=Ee>>>0,Pe||It(Ee,1,this.length),this[Ee]},R.prototype.readUint16LE=R.prototype.readUInt16LE=function(Ee,Pe){return Ee=Ee>>>0,Pe||It(Ee,2,this.length),this[Ee]|this[Ee+1]<<8},R.prototype.readUint16BE=R.prototype.readUInt16BE=function(Ee,Pe){return Ee=Ee>>>0,Pe||It(Ee,2,this.length),this[Ee]<<8|this[Ee+1]},R.prototype.readUint32LE=R.prototype.readUInt32LE=function(Ee,Pe){return Ee=Ee>>>0,Pe||It(Ee,4,this.length),(this[Ee]|this[Ee+1]<<8|this[Ee+2]<<16)+this[Ee+3]*16777216},R.prototype.readUint32BE=R.prototype.readUInt32BE=function(Ee,Pe){return Ee=Ee>>>0,Pe||It(Ee,4,this.length),this[Ee]*16777216+(this[Ee+1]<<16|this[Ee+2]<<8|this[Ee+3])},R.prototype.readBigUInt64LE=yr(function(Ee){Ee=Ee>>>0,wr(Ee,"offset");const Pe=this[Ee],He=this[Ee+7];(Pe===void 0||He===void 0)&&Wr(Ee,this.length-8);const ut=Pe+this[++Ee]*2**8+this[++Ee]*2**16+this[++Ee]*2**24,Ve=this[++Ee]+this[++Ee]*2**8+this[++Ee]*2**16+He*2**24;return BigInt(ut)+(BigInt(Ve)<<BigInt(32))}),R.prototype.readBigUInt64BE=yr(function(Ee){Ee=Ee>>>0,wr(Ee,"offset");const Pe=this[Ee],He=this[Ee+7];(Pe===void 0||He===void 0)&&Wr(Ee,this.length-8);const ut=Pe*2**24+this[++Ee]*2**16+this[++Ee]*2**8+this[++Ee],Ve=this[++Ee]*2**24+this[++Ee]*2**16+this[++Ee]*2**8+He;return(BigInt(ut)<<BigInt(32))+BigInt(Ve)}),R.prototype.readIntLE=function(Ee,Pe,He){Ee=Ee>>>0,Pe=Pe>>>0,He||It(Ee,Pe,this.length);let ut=this[Ee],Ve=1,qe=0;for(;++qe<Pe&&(Ve*=256);)ut+=this[Ee+qe]*Ve;return Ve*=128,ut>=Ve&&(ut-=Math.pow(2,8*Pe)),ut},R.prototype.readIntBE=function(Ee,Pe,He){Ee=Ee>>>0,Pe=Pe>>>0,He||It(Ee,Pe,this.length);let ut=Pe,Ve=1,qe=this[Ee+--ut];for(;ut>0&&(Ve*=256);)qe+=this[Ee+--ut]*Ve;return Ve*=128,qe>=Ve&&(qe-=Math.pow(2,8*Pe)),qe},R.prototype.readInt8=function(Ee,Pe){return Ee=Ee>>>0,Pe||It(Ee,1,this.length),this[Ee]&128?(255-this[Ee]+1)*-1:this[Ee]},R.prototype.readInt16LE=function(Ee,Pe){Ee=Ee>>>0,Pe||It(Ee,2,this.length);const He=this[Ee]|this[Ee+1]<<8;return He&32768?He|4294901760:He},R.prototype.readInt16BE=function(Ee,Pe){Ee=Ee>>>0,Pe||It(Ee,2,this.length);const He=this[Ee+1]|this[Ee]<<8;return He&32768?He|4294901760:He},R.prototype.readInt32LE=function(Ee,Pe){return Ee=Ee>>>0,Pe||It(Ee,4,this.length),this[Ee]|this[Ee+1]<<8|this[Ee+2]<<16|this[Ee+3]<<24},R.prototype.readInt32BE=function(Ee,Pe){return Ee=Ee>>>0,Pe||It(Ee,4,this.length),this[Ee]<<24|this[Ee+1]<<16|this[Ee+2]<<8|this[Ee+3]},R.prototype.readBigInt64LE=yr(function(Ee){Ee=Ee>>>0,wr(Ee,"offset");const Pe=this[Ee],He=this[Ee+7];(Pe===void 0||He===void 0)&&Wr(Ee,this.length-8);const ut=this[Ee+4]+this[Ee+5]*2**8+this[Ee+6]*2**16+(He<<24);return(BigInt(ut)<<BigInt(32))+BigInt(Pe+this[++Ee]*2**8+this[++Ee]*2**16+this[++Ee]*2**24)}),R.prototype.readBigInt64BE=yr(function(Ee){Ee=Ee>>>0,wr(Ee,"offset");const Pe=this[Ee],He=this[Ee+7];(Pe===void 0||He===void 0)&&Wr(Ee,this.length-8);const ut=(Pe<<24)+this[++Ee]*2**16+this[++Ee]*2**8+this[++Ee];return(BigInt(ut)<<BigInt(32))+BigInt(this[++Ee]*2**24+this[++Ee]*2**16+this[++Ee]*2**8+He)}),R.prototype.readFloatLE=function(Ee,Pe){return Ee=Ee>>>0,Pe||It(Ee,4,this.length),ee.read(this,Ee,!0,23,4)},R.prototype.readFloatBE=function(Ee,Pe){return Ee=Ee>>>0,Pe||It(Ee,4,this.length),ee.read(this,Ee,!1,23,4)},R.prototype.readDoubleLE=function(Ee,Pe){return Ee=Ee>>>0,Pe||It(Ee,8,this.length),ee.read(this,Ee,!0,52,8)},R.prototype.readDoubleBE=function(Ee,Pe){return Ee=Ee>>>0,Pe||It(Ee,8,this.length),ee.read(this,Ee,!1,52,8)};function Dt(Ge,Ee,Pe,He,ut,Ve){if(!R.isBuffer(Ge))throw new TypeError('"buffer" argument must be a Buffer instance');if(Ee>ut||Ee<Ve)throw new RangeError('"value" argument is out of bounds');if(Pe+He>Ge.length)throw new RangeError("Index out of range")}R.prototype.writeUintLE=R.prototype.writeUIntLE=function(Ee,Pe,He,ut){if(Ee=+Ee,Pe=Pe>>>0,He=He>>>0,!ut){const De=Math.pow(2,8*He)-1;Dt(this,Ee,Pe,He,De,0)}let Ve=1,qe=0;for(this[Pe]=Ee&255;++qe<He&&(Ve*=256);)this[Pe+qe]=Ee/Ve&255;return Pe+He},R.prototype.writeUintBE=R.prototype.writeUIntBE=function(Ee,Pe,He,ut){if(Ee=+Ee,Pe=Pe>>>0,He=He>>>0,!ut){const De=Math.pow(2,8*He)-1;Dt(this,Ee,Pe,He,De,0)}let Ve=He-1,qe=1;for(this[Pe+Ve]=Ee&255;--Ve>=0&&(qe*=256);)this[Pe+Ve]=Ee/qe&255;return Pe+He},R.prototype.writeUint8=R.prototype.writeUInt8=function(Ee,Pe,He){return Ee=+Ee,Pe=Pe>>>0,He||Dt(this,Ee,Pe,1,255,0),this[Pe]=Ee&255,Pe+1},R.prototype.writeUint16LE=R.prototype.writeUInt16LE=function(Ee,Pe,He){return Ee=+Ee,Pe=Pe>>>0,He||Dt(this,Ee,Pe,2,65535,0),this[Pe]=Ee&255,this[Pe+1]=Ee>>>8,Pe+2},R.prototype.writeUint16BE=R.prototype.writeUInt16BE=function(Ee,Pe,He){return Ee=+Ee,Pe=Pe>>>0,He||Dt(this,Ee,Pe,2,65535,0),this[Pe]=Ee>>>8,this[Pe+1]=Ee&255,Pe+2},R.prototype.writeUint32LE=R.prototype.writeUInt32LE=function(Ee,Pe,He){return Ee=+Ee,Pe=Pe>>>0,He||Dt(this,Ee,Pe,4,4294967295,0),this[Pe+3]=Ee>>>24,this[Pe+2]=Ee>>>16,this[Pe+1]=Ee>>>8,this[Pe]=Ee&255,Pe+4},R.prototype.writeUint32BE=R.prototype.writeUInt32BE=function(Ee,Pe,He){return Ee=+Ee,Pe=Pe>>>0,He||Dt(this,Ee,Pe,4,4294967295,0),this[Pe]=Ee>>>24,this[Pe+1]=Ee>>>16,this[Pe+2]=Ee>>>8,this[Pe+3]=Ee&255,Pe+4};function Zt(Ge,Ee,Pe,He,ut){Cr(Ee,He,ut,Ge,Pe,7);let Ve=Number(Ee&BigInt(4294967295));Ge[Pe++]=Ve,Ve=Ve>>8,Ge[Pe++]=Ve,Ve=Ve>>8,Ge[Pe++]=Ve,Ve=Ve>>8,Ge[Pe++]=Ve;let qe=Number(Ee>>BigInt(32)&BigInt(4294967295));return Ge[Pe++]=qe,qe=qe>>8,Ge[Pe++]=qe,qe=qe>>8,Ge[Pe++]=qe,qe=qe>>8,Ge[Pe++]=qe,Pe}function nr(Ge,Ee,Pe,He,ut){Cr(Ee,He,ut,Ge,Pe,7);let Ve=Number(Ee&BigInt(4294967295));Ge[Pe+7]=Ve,Ve=Ve>>8,Ge[Pe+6]=Ve,Ve=Ve>>8,Ge[Pe+5]=Ve,Ve=Ve>>8,Ge[Pe+4]=Ve;let qe=Number(Ee>>BigInt(32)&BigInt(4294967295));return Ge[Pe+3]=qe,qe=qe>>8,Ge[Pe+2]=qe,qe=qe>>8,Ge[Pe+1]=qe,qe=qe>>8,Ge[Pe]=qe,Pe+8}R.prototype.writeBigUInt64LE=yr(function(Ee,Pe=0){return Zt(this,Ee,Pe,BigInt(0),BigInt("0xffffffffffffffff"))}),R.prototype.writeBigUInt64BE=yr(function(Ee,Pe=0){return nr(this,Ee,Pe,BigInt(0),BigInt("0xffffffffffffffff"))}),R.prototype.writeIntLE=function(Ee,Pe,He,ut){if(Ee=+Ee,Pe=Pe>>>0,!ut){const ze=Math.pow(2,8*He-1);Dt(this,Ee,Pe,He,ze-1,-ze)}let Ve=0,qe=1,De=0;for(this[Pe]=Ee&255;++Ve<He&&(qe*=256);)Ee<0&&De===0&&this[Pe+Ve-1]!==0&&(De=1),this[Pe+Ve]=(Ee/qe>>0)-De&255;return Pe+He},R.prototype.writeIntBE=function(Ee,Pe,He,ut){if(Ee=+Ee,Pe=Pe>>>0,!ut){const ze=Math.pow(2,8*He-1);Dt(this,Ee,Pe,He,ze-1,-ze)}let Ve=He-1,qe=1,De=0;for(this[Pe+Ve]=Ee&255;--Ve>=0&&(qe*=256);)Ee<0&&De===0&&this[Pe+Ve+1]!==0&&(De=1),this[Pe+Ve]=(Ee/qe>>0)-De&255;return Pe+He},R.prototype.writeInt8=function(Ee,Pe,He){return Ee=+Ee,Pe=Pe>>>0,He||Dt(this,Ee,Pe,1,127,-128),Ee<0&&(Ee=255+Ee+1),this[Pe]=Ee&255,Pe+1},R.prototype.writeInt16LE=function(Ee,Pe,He){return Ee=+Ee,Pe=Pe>>>0,He||Dt(this,Ee,Pe,2,32767,-32768),this[Pe]=Ee&255,this[Pe+1]=Ee>>>8,Pe+2},R.prototype.writeInt16BE=function(Ee,Pe,He){return Ee=+Ee,Pe=Pe>>>0,He||Dt(this,Ee,Pe,2,32767,-32768),this[Pe]=Ee>>>8,this[Pe+1]=Ee&255,Pe+2},R.prototype.writeInt32LE=function(Ee,Pe,He){return Ee=+Ee,Pe=Pe>>>0,He||Dt(this,Ee,Pe,4,2147483647,-2147483648),this[Pe]=Ee&255,this[Pe+1]=Ee>>>8,this[Pe+2]=Ee>>>16,this[Pe+3]=Ee>>>24,Pe+4},R.prototype.writeInt32BE=function(Ee,Pe,He){return Ee=+Ee,Pe=Pe>>>0,He||Dt(this,Ee,Pe,4,2147483647,-2147483648),Ee<0&&(Ee=4294967295+Ee+1),this[Pe]=Ee>>>24,this[Pe+1]=Ee>>>16,this[Pe+2]=Ee>>>8,this[Pe+3]=Ee&255,Pe+4},R.prototype.writeBigInt64LE=yr(function(Ee,Pe=0){return Zt(this,Ee,Pe,-BigInt("0x8000000000000000"),BigInt("0x7fffffffffffffff"))}),R.prototype.writeBigInt64BE=yr(function(Ee,Pe=0){return nr(this,Ee,Pe,-BigInt("0x8000000000000000"),BigInt("0x7fffffffffffffff"))});function Er(Ge,Ee,Pe,He,ut,Ve){if(Pe+He>Ge.length)throw new RangeError("Index out of range");if(Pe<0)throw new RangeError("Index out of range")}function vr(Ge,Ee,Pe,He,ut){return Ee=+Ee,Pe=Pe>>>0,ut||Er(Ge,Ee,Pe,4),ee.write(Ge,Ee,Pe,He,23,4),Pe+4}R.prototype.writeFloatLE=function(Ee,Pe,He){return vr(this,Ee,Pe,!0,He)},R.prototype.writeFloatBE=function(Ee,Pe,He){return vr(this,Ee,Pe,!1,He)};function Sr(Ge,Ee,Pe,He,ut){return Ee=+Ee,Pe=Pe>>>0,ut||Er(Ge,Ee,Pe,8),ee.write(Ge,Ee,Pe,He,52,8),Pe+8}R.prototype.writeDoubleLE=function(Ee,Pe,He){return Sr(this,Ee,Pe,!0,He)},R.prototype.writeDoubleBE=function(Ee,Pe,He){return Sr(this,Ee,Pe,!1,He)},R.prototype.copy=function(Ee,Pe,He,ut){if(!R.isBuffer(Ee))throw new TypeError("argument should be a Buffer");if(He||(He=0),!ut&&ut!==0&&(ut=this.length),Pe>=Ee.length&&(Pe=Ee.length),Pe||(Pe=0),ut>0&&ut<He&&(ut=He),ut===He||Ee.length===0||this.length===0)return 0;if(Pe<0)throw new RangeError("targetStart out of bounds");if(He<0||He>=this.length)throw new RangeError("Index out of range");if(ut<0)throw new RangeError("sourceEnd out of bounds");ut>this.length&&(ut=this.length),Ee.length-Pe<ut-He&&(ut=Ee.length-Pe+He);const Ve=ut-He;return this===Ee&&typeof Uint8Array.prototype.copyWithin=="function"?this.copyWithin(Pe,He,ut):Uint8Array.prototype.set.call(Ee,this.subarray(He,ut),Pe),Ve},R.prototype.fill=function(Ee,Pe,He,ut){if(typeof Ee=="string"){if(typeof Pe=="string"?(ut=Pe,Pe=0,He=this.length):typeof He=="string"&&(ut=He,He=this.length),ut!==void 0&&typeof ut!="string")throw new TypeError("encoding must be a string");if(typeof ut=="string"&&!R.isEncoding(ut))throw new TypeError("Unknown encoding: "+ut);if(Ee.length===1){const qe=Ee.charCodeAt(0);(ut==="utf8"&&qe<128||ut==="latin1")&&(Ee=qe)}}else typeof Ee=="number"?Ee=Ee&255:typeof Ee=="boolean"&&(Ee=Number(Ee));if(Pe<0||this.length<Pe||this.length<He)throw new RangeError("Out of range index");if(He<=Pe)return this;Pe=Pe>>>0,He=He===void 0?this.length:He>>>0,Ee||(Ee=0);let Ve;if(typeof Ee=="number")for(Ve=Pe;Ve<He;++Ve)this[Ve]=Ee;else{const qe=R.isBuffer(Ee)?Ee:R.from(Ee,ut),De=qe.length;if(De===0)throw new TypeError('The value "'+Ee+'" is invalid for argument "value"');for(Ve=0;Ve<He-Pe;++Ve)this[Ve+Pe]=qe[Ve%De]}return this};const Qt={};function or(Ge,Ee,Pe){Qt[Ge]=class extends Pe{constructor(){super(),Object.defineProperty(this,"message",{value:Ee.apply(this,arguments),writable:!0,configurable:!0}),this.name=`${this.name} [${Ge}]`,this.stack,delete this.name}get code(){return Ge}set code(ut){Object.defineProperty(this,"code",{configurable:!0,enumerable:!0,value:ut,writable:!0})}toString(){return`${this.name} [${Ge}]: ${this.message}`}}}or("ERR_BUFFER_OUT_OF_BOUNDS",function(Ge){return Ge?`${Ge} is outside of buffer bounds`:"Attempt to access memory outside buffer bounds"},RangeError),or("ERR_INVALID_ARG_TYPE",function(Ge,Ee){return`The "${Ge}" argument must be of type number. Received type ${typeof Ee}`},TypeError),or("ERR_OUT_OF_RANGE",function(Ge,Ee,Pe){let He=`The value of "${Ge}" is out of range.`,ut=Pe;return Number.isInteger(Pe)&&Math.abs(Pe)>2**32?ut=Ir(String(Pe)):typeof Pe=="bigint"&&(ut=String(Pe),(Pe>BigInt(2)**BigInt(32)||Pe<-(BigInt(2)**BigInt(32)))&&(ut=Ir(ut)),ut+="n"),He+=` It must be ${Ee}. Received ${ut}`,He},RangeError);function Ir(Ge){let Ee="",Pe=Ge.length;const He=Ge[0]==="-"?1:0;for(;Pe>=He+4;Pe-=3)Ee=`_${Ge.slice(Pe-3,Pe)}${Ee}`;return`${Ge.slice(0,Pe)}${Ee}`}function Rr(Ge,Ee,Pe){wr(Ee,"offset"),(Ge[Ee]===void 0||Ge[Ee+Pe]===void 0)&&Wr(Ee,Ge.length-(Pe+1))}function Cr(Ge,Ee,Pe,He,ut,Ve){if(Ge>Pe||Ge<Ee){const qe=typeof Ee=="bigint"?"n":"";let De;throw Ee===0||Ee===BigInt(0)?De=`>= 0${qe} and < 2${qe} ** ${(Ve+1)*8}${qe}`:De=`>= -(2${qe} ** ${(Ve+1)*8-1}${qe}) and < 2 ** ${(Ve+1)*8-1}${qe}`,new Qt.ERR_OUT_OF_RANGE("value",De,Ge)}Rr(He,ut,Ve)}function wr(Ge,Ee){if(typeof Ge!="number")throw new Qt.ERR_INVALID_ARG_TYPE(Ee,"number",Ge)}function Wr(Ge,Ee,Pe){throw Math.floor(Ge)!==Ge?(wr(Ge,Pe),new Qt.ERR_OUT_OF_RANGE("offset","an integer",Ge)):Ee<0?new Qt.ERR_BUFFER_OUT_OF_BOUNDS:new Qt.ERR_OUT_OF_RANGE("offset",`>= 0 and <= ${Ee}`,Ge)}const Kr=/[^+/0-9A-Za-z-_]/g;function Hr(Ge){if(Ge=Ge.split("=")[0],Ge=Ge.trim().replace(Kr,""),Ge.length<2)return"";for(;Ge.length%4!==0;)Ge=Ge+"=";return Ge}function br(Ge,Ee){Ee=Ee||1/0;let Pe;const He=Ge.length;let ut=null;const Ve=[];for(let qe=0;qe<He;++qe){if(Pe=Ge.charCodeAt(qe),Pe>55295&&Pe<57344){if(!ut){if(Pe>56319){(Ee-=3)>-1&&Ve.push(239,191,189);continue}else if(qe+1===He){(Ee-=3)>-1&&Ve.push(239,191,189);continue}ut=Pe;continue}if(Pe<56320){(Ee-=3)>-1&&Ve.push(239,191,189),ut=Pe;continue}Pe=(ut-55296<<10|Pe-56320)+65536}else ut&&(Ee-=3)>-1&&Ve.push(239,191,189);if(ut=null,Pe<128){if((Ee-=1)<0)break;Ve.push(Pe)}else if(Pe<2048){if((Ee-=2)<0)break;Ve.push(Pe>>6|192,Pe&63|128)}else if(Pe<65536){if((Ee-=3)<0)break;Ve.push(Pe>>12|224,Pe>>6&63|128,Pe&63|128)}else if(Pe<1114112){if((Ee-=4)<0)break;Ve.push(Pe>>18|240,Pe>>12&63|128,Pe>>6&63|128,Pe&63|128)}else throw new Error("Invalid code point")}return Ve}function Lr(Ge){const Ee=[];for(let Pe=0;Pe<Ge.length;++Pe)Ee.push(Ge.charCodeAt(Pe)&255);return Ee}function Br(Ge,Ee){let Pe,He,ut;const Ve=[];for(let qe=0;qe<Ge.length&&!((Ee-=2)<0);++qe)Pe=Ge.charCodeAt(qe),He=Pe>>8,ut=Pe%256,Ve.push(ut),Ve.push(He);return Ve}function zr(Ge){return K.toByteArray(Hr(Ge))}function rr(Ge,Ee,Pe,He){let ut;for(ut=0;ut<He&&!(ut+Pe>=Ee.length||ut>=Ge.length);++ut)Ee[ut+Pe]=Ge[ut];return ut}function sr(Ge,Ee){return Ge instanceof Ee||Ge!=null&&Ge.constructor!=null&&Ge.constructor.name!=null&&Ge.constructor.name===Ee.name}function Dr(Ge){return Ge!==Ge}const lr=function(){const Ge="0123456789abcdef",Ee=new Array(256);for(let Pe=0;Pe<16;++Pe){const He=Pe*16;for(let ut=0;ut<16;++ut)Ee[He+ut]=Ge[Pe]+Ge[ut]}return Ee}();function yr(Ge){return typeof BigInt>"u"?xr:Ge}function xr(){throw new Error("BigInt not supported")}}(buffer)),buffer}var bufferExports=requireBuffer(),indexMinimal={},minimal$1={},aspromise,hasRequiredAspromise;function requireAspromise(){if(hasRequiredAspromise)return aspromise;hasRequiredAspromise=1,aspromise=Y;function Y(K,ee){for(var ne=new Array(arguments.length-1),re=0,le=2,Q=!0;le<arguments.length;)ne[re++]=arguments[le++];return new Promise(function(U,Z){ne[re]=function(he){if(Q)if(Q=!1,he)Z(he);else{for(var pe=new Array(arguments.length-1),me=0;me<pe.length;)pe[me++]=arguments[me];U.apply(null,pe)}};try{K.apply(ee||null,ne)}catch(ae){Q&&(Q=!1,Z(ae))}})}return aspromise}var base64={},hasRequiredBase64;function requireBase64(){return hasRequiredBase64||(hasRequiredBase64=1,function(Y){var K=Y;K.length=function(R){var U=R.length;if(!U)return 0;for(var Z=0;--U%4>1&&R.charAt(U)==="=";)++Z;return Math.ceil(R.length*3)/4-Z};for(var ee=new Array(64),ne=new Array(123),re=0;re<64;)ne[ee[re]=re<26?re+65:re<52?re+71:re<62?re-4:re-59|43]=re++;K.encode=function(R,U,Z){for(var ae=null,he=[],pe=0,me=0,ve;U<Z;){var Re=R[U++];switch(me){case 0:he[pe++]=ee[Re>>2],ve=(Re&3)<<4,me=1;break;case 1:he[pe++]=ee[ve|Re>>4],ve=(Re&15)<<2,me=2;break;case 2:he[pe++]=ee[ve|Re>>6],he[pe++]=ee[Re&63],me=0;break}pe>8191&&((ae||(ae=[])).push(String.fromCharCode.apply(String,he)),pe=0)}return me&&(he[pe++]=ee[ve],he[pe++]=61,me===1&&(he[pe++]=61)),ae?(pe&&ae.push(String.fromCharCode.apply(String,he.slice(0,pe))),ae.join("")):String.fromCharCode.apply(String,he.slice(0,pe))};var le="invalid encoding";K.decode=function(R,U,Z){for(var ae=Z,he=0,pe,me=0;me<R.length;){var ve=R.charCodeAt(me++);if(ve===61&&he>1)break;if((ve=ne[ve])===void 0)throw Error(le);switch(he){case 0:pe=ve,he=1;break;case 1:U[Z++]=pe<<2|(ve&48)>>4,pe=ve,he=2;break;case 2:U[Z++]=(pe&15)<<4|(ve&60)>>2,pe=ve,he=3;break;case 3:U[Z++]=(pe&3)<<6|ve,he=0;break}}if(he===1)throw Error(le);return Z-ae},K.test=function(R){return/^(?:[A-Za-z0-9+/]{4})*(?:[A-Za-z0-9+/]{2}==|[A-Za-z0-9+/]{3}=)?$/.test(R)}}(base64)),base64}var eventemitter,hasRequiredEventemitter;function requireEventemitter(){if(hasRequiredEventemitter)return eventemitter;hasRequiredEventemitter=1,eventemitter=Y;function Y(){this._listeners={}}return Y.prototype.on=function(ee,ne,re){return(this._listeners[ee]||(this._listeners[ee]=[])).push({fn:ne,ctx:re||this}),this},Y.prototype.off=function(ee,ne){if(ee===void 0)this._listeners={};else if(ne===void 0)this._listeners[ee]=[];else for(var re=this._listeners[ee],le=0;le<re.length;)re[le].fn===ne?re.splice(le,1):++le;return this},Y.prototype.emit=function(ee){var ne=this._listeners[ee];if(ne){for(var re=[],le=1;le<arguments.length;)re.push(arguments[le++]);for(le=0;le<ne.length;)ne[le].fn.apply(ne[le++].ctx,re)}return this},eventemitter}var float,hasRequiredFloat;function requireFloat(){if(hasRequiredFloat)return float;hasRequiredFloat=1,float=Y(Y);function Y(le){return typeof Float32Array<"u"?function(){var Q=new Float32Array([-0]),R=new Uint8Array(Q.buffer),U=R[3]===128;function Z(me,ve,Re){Q[0]=me,ve[Re]=R[0],ve[Re+1]=R[1],ve[Re+2]=R[2],ve[Re+3]=R[3]}function ae(me,ve,Re){Q[0]=me,ve[Re]=R[3],ve[Re+1]=R[2],ve[Re+2]=R[1],ve[Re+3]=R[0]}le.writeFloatLE=U?Z:ae,le.writeFloatBE=U?ae:Z;function he(me,ve){return R[0]=me[ve],R[1]=me[ve+1],R[2]=me[ve+2],R[3]=me[ve+3],Q[0]}function pe(me,ve){return R[3]=me[ve],R[2]=me[ve+1],R[1]=me[ve+2],R[0]=me[ve+3],Q[0]}le.readFloatLE=U?he:pe,le.readFloatBE=U?pe:he}():function(){function Q(U,Z,ae,he){var pe=Z<0?1:0;if(pe&&(Z=-Z),Z===0)U(1/Z>0?0:2147483648,ae,he);else if(isNaN(Z))U(2143289344,ae,he);else if(Z>34028234663852886e22)U((pe<<31|2139095040)>>>0,ae,he);else if(Z<11754943508222875e-54)U((pe<<31|Math.round(Z/1401298464324817e-60))>>>0,ae,he);else{var me=Math.floor(Math.log(Z)/Math.LN2),ve=Math.round(Z*Math.pow(2,-me)*8388608)&8388607;U((pe<<31|me+127<<23|ve)>>>0,ae,he)}}le.writeFloatLE=Q.bind(null,K),le.writeFloatBE=Q.bind(null,ee);function R(U,Z,ae){var he=U(Z,ae),pe=(he>>31)*2+1,me=he>>>23&255,ve=he&8388607;return me===255?ve?NaN:pe*(1/0):me===0?pe*1401298464324817e-60*ve:pe*Math.pow(2,me-150)*(ve+8388608)}le.readFloatLE=R.bind(null,ne),le.readFloatBE=R.bind(null,re)}(),typeof Float64Array<"u"?function(){var Q=new Float64Array([-0]),R=new Uint8Array(Q.buffer),U=R[7]===128;function Z(me,ve,Re){Q[0]=me,ve[Re]=R[0],ve[Re+1]=R[1],ve[Re+2]=R[2],ve[Re+3]=R[3],ve[Re+4]=R[4],ve[Re+5]=R[5],ve[Re+6]=R[6],ve[Re+7]=R[7]}function ae(me,ve,Re){Q[0]=me,ve[Re]=R[7],ve[Re+1]=R[6],ve[Re+2]=R[5],ve[Re+3]=R[4],ve[Re+4]=R[3],ve[Re+5]=R[2],ve[Re+6]=R[1],ve[Re+7]=R[0]}le.writeDoubleLE=U?Z:ae,le.writeDoubleBE=U?ae:Z;function he(me,ve){return R[0]=me[ve],R[1]=me[ve+1],R[2]=me[ve+2],R[3]=me[ve+3],R[4]=me[ve+4],R[5]=me[ve+5],R[6]=me[ve+6],R[7]=me[ve+7],Q[0]}function pe(me,ve){return R[7]=me[ve],R[6]=me[ve+1],R[5]=me[ve+2],R[4]=me[ve+3],R[3]=me[ve+4],R[2]=me[ve+5],R[1]=me[ve+6],R[0]=me[ve+7],Q[0]}le.readDoubleLE=U?he:pe,le.readDoubleBE=U?pe:he}():function(){function Q(U,Z,ae,he,pe,me){var ve=he<0?1:0;if(ve&&(he=-he),he===0)U(0,pe,me+Z),U(1/he>0?0:2147483648,pe,me+ae);else if(isNaN(he))U(0,pe,me+Z),U(2146959360,pe,me+ae);else if(he>17976931348623157e292)U(0,pe,me+Z),U((ve<<31|2146435072)>>>0,pe,me+ae);else{var Re;if(he<22250738585072014e-324)Re=he/5e-324,U(Re>>>0,pe,me+Z),U((ve<<31|Re/4294967296)>>>0,pe,me+ae);else{var Me=Math.floor(Math.log(he)/Math.LN2);Me===1024&&(Me=1023),Re=he*Math.pow(2,-Me),U(Re*4503599627370496>>>0,pe,me+Z),U((ve<<31|Me+1023<<20|Re*1048576&1048575)>>>0,pe,me+ae)}}}le.writeDoubleLE=Q.bind(null,K,0,4),le.writeDoubleBE=Q.bind(null,ee,4,0);function R(U,Z,ae,he,pe){var me=U(he,pe+Z),ve=U(he,pe+ae),Re=(ve>>31)*2+1,Me=ve>>>20&2047,Te=4294967296*(ve&1048575)+me;return Me===2047?Te?NaN:Re*(1/0):Me===0?Re*5e-324*Te:Re*Math.pow(2,Me-1075)*(Te+4503599627370496)}le.readDoubleLE=R.bind(null,ne,0,4),le.readDoubleBE=R.bind(null,re,4,0)}(),le}function K(le,Q,R){Q[R]=le&255,Q[R+1]=le>>>8&255,Q[R+2]=le>>>16&255,Q[R+3]=le>>>24}function ee(le,Q,R){Q[R]=le>>>24,Q[R+1]=le>>>16&255,Q[R+2]=le>>>8&255,Q[R+3]=le&255}function ne(le,Q){return(le[Q]|le[Q+1]<<8|le[Q+2]<<16|le[Q+3]<<24)>>>0}function re(le,Q){return(le[Q]<<24|le[Q+1]<<16|le[Q+2]<<8|le[Q+3])>>>0}return float}var inquire_1,hasRequiredInquire;function requireInquire(){if(hasRequiredInquire)return inquire_1;hasRequiredInquire=1,inquire_1=inquire;function inquire(moduleName){try{var mod=eval("quire".replace(/^/,"re"))(moduleName);if(mod&&(mod.length||Object.keys(mod).length))return mod}catch(Y){}return null}return inquire_1}var utf8={},hasRequiredUtf8;function requireUtf8(){return hasRequiredUtf8||(hasRequiredUtf8=1,function(Y){var K=Y;K.length=function(ne){for(var re=0,le=0,Q=0;Q<ne.length;++Q)le=ne.charCodeAt(Q),le<128?re+=1:le<2048?re+=2:(le&64512)===55296&&(ne.charCodeAt(Q+1)&64512)===56320?(++Q,re+=4):re+=3;return re},K.read=function(ne,re,le){var Q=le-re;if(Q<1)return"";for(var R=null,U=[],Z=0,ae;re<le;)ae=ne[re++],ae<128?U[Z++]=ae:ae>191&&ae<224?U[Z++]=(ae&31)<<6|ne[re++]&63:ae>239&&ae<365?(ae=((ae&7)<<18|(ne[re++]&63)<<12|(ne[re++]&63)<<6|ne[re++]&63)-65536,U[Z++]=55296+(ae>>10),U[Z++]=56320+(ae&1023)):U[Z++]=(ae&15)<<12|(ne[re++]&63)<<6|ne[re++]&63,Z>8191&&((R||(R=[])).push(String.fromCharCode.apply(String,U)),Z=0);return R?(Z&&R.push(String.fromCharCode.apply(String,U.slice(0,Z))),R.join("")):String.fromCharCode.apply(String,U.slice(0,Z))},K.write=function(ne,re,le){for(var Q=le,R,U,Z=0;Z<ne.length;++Z)R=ne.charCodeAt(Z),R<128?re[le++]=R:R<2048?(re[le++]=R>>6|192,re[le++]=R&63|128):(R&64512)===55296&&((U=ne.charCodeAt(Z+1))&64512)===56320?(R=65536+((R&1023)<<10)+(U&1023),++Z,re[le++]=R>>18|240,re[le++]=R>>12&63|128,re[le++]=R>>6&63|128,re[le++]=R&63|128):(re[le++]=R>>12|224,re[le++]=R>>6&63|128,re[le++]=R&63|128);return le-Q}}(utf8)),utf8}var pool_1,hasRequiredPool;function requirePool(){if(hasRequiredPool)return pool_1;hasRequiredPool=1,pool_1=Y;function Y(K,ee,ne){var re=ne||8192,le=re>>>1,Q=null,R=re;return function(Z){if(Z<1||Z>le)return K(Z);R+Z>re&&(Q=K(re),R=0);var ae=ee.call(Q,R,R+=Z);return R&7&&(R=(R|7)+1),ae}}return pool_1}var longbits,hasRequiredLongbits;function requireLongbits(){if(hasRequiredLongbits)return longbits;hasRequiredLongbits=1,longbits=K;var Y=requireMinimal$1();function K(le,Q){this.lo=le>>>0,this.hi=Q>>>0}var ee=K.zero=new K(0,0);ee.toNumber=function(){return 0},ee.zzEncode=ee.zzDecode=function(){return this},ee.length=function(){return 1};var ne=K.zeroHash="\0\0\0\0\0\0\0\0";K.fromNumber=function(Q){if(Q===0)return ee;var R=Q<0;R&&(Q=-Q);var U=Q>>>0,Z=(Q-U)/4294967296>>>0;return R&&(Z=~Z>>>0,U=~U>>>0,++U>4294967295&&(U=0,++Z>4294967295&&(Z=0))),new K(U,Z)},K.from=function(Q){if(typeof Q=="number")return K.fromNumber(Q);if(Y.isString(Q))if(Y.Long)Q=Y.Long.fromString(Q);else return K.fromNumber(parseInt(Q,10));return Q.low||Q.high?new K(Q.low>>>0,Q.high>>>0):ee},K.prototype.toNumber=function(Q){if(!Q&&this.hi>>>31){var R=~this.lo+1>>>0,U=~this.hi>>>0;return R||(U=U+1>>>0),-(R+U*4294967296)}return this.lo+this.hi*4294967296},K.prototype.toLong=function(Q){return Y.Long?new Y.Long(this.lo|0,this.hi|0,!!Q):{low:this.lo|0,high:this.hi|0,unsigned:!!Q}};var re=String.prototype.charCodeAt;return K.fromHash=function(Q){return Q===ne?ee:new K((re.call(Q,0)|re.call(Q,1)<<8|re.call(Q,2)<<16|re.call(Q,3)<<24)>>>0,(re.call(Q,4)|re.call(Q,5)<<8|re.call(Q,6)<<16|re.call(Q,7)<<24)>>>0)},K.prototype.toHash=function(){return String.fromCharCode(this.lo&255,this.lo>>>8&255,this.lo>>>16&255,this.lo>>>24,this.hi&255,this.hi>>>8&255,this.hi>>>16&255,this.hi>>>24)},K.prototype.zzEncode=function(){var Q=this.hi>>31;return this.hi=((this.hi<<1|this.lo>>>31)^Q)>>>0,this.lo=(this.lo<<1^Q)>>>0,this},K.prototype.zzDecode=function(){var Q=-(this.lo&1);return this.lo=((this.lo>>>1|this.hi<<31)^Q)>>>0,this.hi=(this.hi>>>1^Q)>>>0,this},K.prototype.length=function(){var Q=this.lo,R=(this.lo>>>28|this.hi<<4)>>>0,U=this.hi>>>24;return U===0?R===0?Q<16384?Q<128?1:2:Q<2097152?3:4:R<16384?R<128?5:6:R<2097152?7:8:U<128?9:10},longbits}var hasRequiredMinimal$1;function requireMinimal$1(){return hasRequiredMinimal$1||(hasRequiredMinimal$1=1,function(Y){var K=Y;K.asPromise=requireAspromise(),K.base64=requireBase64(),K.EventEmitter=requireEventemitter(),K.float=requireFloat(),K.inquire=requireInquire(),K.utf8=requireUtf8(),K.pool=requirePool(),K.LongBits=requireLongbits(),K.isNode=!!(typeof commonjsGlobal<"u"&&commonjsGlobal&&commonjsGlobal.process&&commonjsGlobal.process.versions&&commonjsGlobal.process.versions.node),K.global=K.isNode&&commonjsGlobal||typeof window<"u"&&window||typeof self<"u"&&self||minimal$1,K.emptyArray=Object.freeze?Object.freeze([]):[],K.emptyObject=Object.freeze?Object.freeze({}):{},K.isInteger=Number.isInteger||function(le){return typeof le=="number"&&isFinite(le)&&Math.floor(le)===le},K.isString=function(le){return typeof le=="string"||le instanceof String},K.isObject=function(le){return le&&typeof le=="object"},K.isset=K.isSet=function(le,Q){var R=le[Q];return R!=null&&le.hasOwnProperty(Q)?typeof R!="object"||(Array.isArray(R)?R.length:Object.keys(R).length)>0:!1},K.Buffer=function(){try{var re=K.inquire("buffer").Buffer;return re.prototype.utf8Write?re:null}catch{return null}}(),K._Buffer_from=null,K._Buffer_allocUnsafe=null,K.newBuffer=function(le){return typeof le=="number"?K.Buffer?K._Buffer_allocUnsafe(le):new K.Array(le):K.Buffer?K._Buffer_from(le):typeof Uint8Array>"u"?le:new Uint8Array(le)},K.Array=typeof Uint8Array<"u"?Uint8Array:Array,K.Long=K.global.dcodeIO&&K.global.dcodeIO.Long||K.global.Long||K.inquire("long"),K.key2Re=/^true|false|0|1$/,K.key32Re=/^-?(?:0|[1-9][0-9]*)$/,K.key64Re=/^(?:[\\x00-\\xff]{8}|-?(?:0|[1-9][0-9]*))$/,K.longToHash=function(le){return le?K.LongBits.from(le).toHash():K.LongBits.zeroHash},K.longFromHash=function(le,Q){var R=K.LongBits.fromHash(le);return K.Long?K.Long.fromBits(R.lo,R.hi,Q):R.toNumber(!!Q)};function ee(re,le,Q){for(var R=Object.keys(le),U=0;U<R.length;++U)(re[R[U]]===void 0||!Q)&&(re[R[U]]=le[R[U]]);return re}K.merge=ee,K.lcFirst=function(le){return le.charAt(0).toLowerCase()+le.substring(1)};function ne(re){function le(Q,R){if(!(this instanceof le))return new le(Q,R);Object.defineProperty(this,"message",{get:function(){return Q}}),Error.captureStackTrace?Error.captureStackTrace(this,le):Object.defineProperty(this,"stack",{value:new Error().stack||""}),R&&ee(this,R)}return le.prototype=Object.create(Error.prototype,{constructor:{value:le,writable:!0,enumerable:!1,configurable:!0},name:{get:function(){return re},set:void 0,enumerable:!1,configurable:!0},toString:{value:function(){return this.name+": "+this.message},writable:!0,enumerable:!1,configurable:!0}}),le}K.newError=ne,K.ProtocolError=ne("ProtocolError"),K.oneOfGetter=function(le){for(var Q={},R=0;R<le.length;++R)Q[le[R]]=1;return function(){for(var U=Object.keys(this),Z=U.length-1;Z>-1;--Z)if(Q[U[Z]]===1&&this[U[Z]]!==void 0&&this[U[Z]]!==null)return U[Z]}},K.oneOfSetter=function(le){return function(Q){for(var R=0;R<le.length;++R)le[R]!==Q&&delete this[le[R]]}},K.toJSONOptions={longs:String,enums:String,bytes:String,json:!0},K._configure=function(){var re=K.Buffer;if(!re){K._Buffer_from=K._Buffer_allocUnsafe=null;return}K._Buffer_from=re.from!==Uint8Array.from&&re.from||function(Q,R){return new re(Q,R)},K._Buffer_allocUnsafe=re.allocUnsafe||function(Q){return new re(Q)}}}(minimal$1)),minimal$1}var writer,hasRequiredWriter;function requireWriter(){if(hasRequiredWriter)return writer;hasRequiredWriter=1,writer=U;var Y=requireMinimal$1(),K,ee=Y.LongBits,ne=Y.base64,re=Y.utf8;function le(Me,Te,Ce){this.fn=Me,this.len=Te,this.next=void 0,this.val=Ce}function Q(){}function R(Me){this.head=Me.head,this.tail=Me.tail,this.len=Me.len,this.next=Me.states}function U(){this.len=0,this.head=new le(Q,0,0),this.tail=this.head,this.states=null}var Z=function(){return Y.Buffer?function(){return(U.create=function(){return new K})()}:function(){return new U}};U.create=Z(),U.alloc=function(Te){return new Y.Array(Te)},Y.Array!==Array&&(U.alloc=Y.pool(U.alloc,Y.Array.prototype.subarray)),U.prototype._push=function(Te,Ce,We){return this.tail=this.tail.next=new le(Te,Ce,We),this.len+=Ce,this};function ae(Me,Te,Ce){Te[Ce]=Me&255}function he(Me,Te,Ce){for(;Me>127;)Te[Ce++]=Me&127|128,Me>>>=7;Te[Ce]=Me}function pe(Me,Te){this.len=Me,this.next=void 0,this.val=Te}pe.prototype=Object.create(le.prototype),pe.prototype.fn=he,U.prototype.uint32=function(Te){return this.len+=(this.tail=this.tail.next=new pe((Te=Te>>>0)<128?1:Te<16384?2:Te<2097152?3:Te<268435456?4:5,Te)).len,this},U.prototype.int32=function(Te){return Te<0?this._push(me,10,ee.fromNumber(Te)):this.uint32(Te)},U.prototype.sint32=function(Te){return this.uint32((Te<<1^Te>>31)>>>0)};function me(Me,Te,Ce){for(;Me.hi;)Te[Ce++]=Me.lo&127|128,Me.lo=(Me.lo>>>7|Me.hi<<25)>>>0,Me.hi>>>=7;for(;Me.lo>127;)Te[Ce++]=Me.lo&127|128,Me.lo=Me.lo>>>7;Te[Ce++]=Me.lo}U.prototype.uint64=function(Te){var Ce=ee.from(Te);return this._push(me,Ce.length(),Ce)},U.prototype.int64=U.prototype.uint64,U.prototype.sint64=function(Te){var Ce=ee.from(Te).zzEncode();return this._push(me,Ce.length(),Ce)},U.prototype.bool=function(Te){return this._push(ae,1,Te?1:0)};function ve(Me,Te,Ce){Te[Ce]=Me&255,Te[Ce+1]=Me>>>8&255,Te[Ce+2]=Me>>>16&255,Te[Ce+3]=Me>>>24}U.prototype.fixed32=function(Te){return this._push(ve,4,Te>>>0)},U.prototype.sfixed32=U.prototype.fixed32,U.prototype.fixed64=function(Te){var Ce=ee.from(Te);return this._push(ve,4,Ce.lo)._push(ve,4,Ce.hi)},U.prototype.sfixed64=U.prototype.fixed64,U.prototype.float=function(Te){return this._push(Y.float.writeFloatLE,4,Te)},U.prototype.double=function(Te){return this._push(Y.float.writeDoubleLE,8,Te)};var Re=Y.Array.prototype.set?function(Te,Ce,We){Ce.set(Te,We)}:function(Te,Ce,We){for(var Fe=0;Fe<Te.length;++Fe)Ce[We+Fe]=Te[Fe]};return U.prototype.bytes=function(Te){var Ce=Te.length>>>0;if(!Ce)return this._push(ae,1,0);if(Y.isString(Te)){var We=U.alloc(Ce=ne.length(Te));ne.decode(Te,We,0),Te=We}return this.uint32(Ce)._push(Re,Ce,Te)},U.prototype.string=function(Te){var Ce=re.length(Te);return Ce?this.uint32(Ce)._push(re.write,Ce,Te):this._push(ae,1,0)},U.prototype.fork=function(){return this.states=new R(this),this.head=this.tail=new le(Q,0,0),this.len=0,this},U.prototype.reset=function(){return this.states?(this.head=this.states.head,this.tail=this.states.tail,this.len=this.states.len,this.states=this.states.next):(this.head=this.tail=new le(Q,0,0),this.len=0),this},U.prototype.ldelim=function(){var Te=this.head,Ce=this.tail,We=this.len;return this.reset().uint32(We),We&&(this.tail.next=Te.next,this.tail=Ce,this.len+=We),this},U.prototype.finish=function(){for(var Te=this.head.next,Ce=this.constructor.alloc(this.len),We=0;Te;)Te.fn(Te.val,Ce,We),We+=Te.len,Te=Te.next;return Ce},U._configure=function(Me){K=Me,U.create=Z(),K._configure()},writer}var writer_buffer,hasRequiredWriter_buffer;function requireWriter_buffer(){if(hasRequiredWriter_buffer)return writer_buffer;hasRequiredWriter_buffer=1,writer_buffer=ee;var Y=requireWriter();(ee.prototype=Object.create(Y.prototype)).constructor=ee;var K=requireMinimal$1();function ee(){Y.call(this)}ee._configure=function(){ee.alloc=K._Buffer_allocUnsafe,ee.writeBytesBuffer=K.Buffer&&K.Buffer.prototype instanceof Uint8Array&&K.Buffer.prototype.set.name==="set"?function(le,Q,R){Q.set(le,R)}:function(le,Q,R){if(le.copy)le.copy(Q,R,0,le.length);else for(var U=0;U<le.length;)Q[R++]=le[U++]}},ee.prototype.bytes=function(le){K.isString(le)&&(le=K._Buffer_from(le,"base64"));var Q=le.length>>>0;return this.uint32(Q),Q&&this._push(ee.writeBytesBuffer,Q,le),this};function ne(re,le,Q){re.length<40?K.utf8.write(re,le,Q):le.utf8Write?le.utf8Write(re,Q):le.write(re,Q)}return ee.prototype.string=function(le){var Q=K.Buffer.byteLength(le);return this.uint32(Q),Q&&this._push(ne,Q,le),this},ee._configure(),writer_buffer}var reader,hasRequiredReader;function requireReader(){if(hasRequiredReader)return reader;hasRequiredReader=1,reader=le;var Y=requireMinimal$1(),K,ee=Y.LongBits,ne=Y.utf8;function re(he,pe){return RangeError("index out of range: "+he.pos+" + "+(pe||1)+" > "+he.len)}function le(he){this.buf=he,this.pos=0,this.len=he.length}var Q=typeof Uint8Array<"u"?function(pe){if(pe instanceof Uint8Array||Array.isArray(pe))return new le(pe);throw Error("illegal buffer")}:function(pe){if(Array.isArray(pe))return new le(pe);throw Error("illegal buffer")},R=function(){return Y.Buffer?function(me){return(le.create=function(Re){return Y.Buffer.isBuffer(Re)?new K(Re):Q(Re)})(me)}:Q};le.create=R(),le.prototype._slice=Y.Array.prototype.subarray||Y.Array.prototype.slice,le.prototype.uint32=function(){var pe=4294967295;return function(){if(pe=(this.buf[this.pos]&127)>>>0,this.buf[this.pos++]<128||(pe=(pe|(this.buf[this.pos]&127)<<7)>>>0,this.buf[this.pos++]<128)||(pe=(pe|(this.buf[this.pos]&127)<<14)>>>0,this.buf[this.pos++]<128)||(pe=(pe|(this.buf[this.pos]&127)<<21)>>>0,this.buf[this.pos++]<128)||(pe=(pe|(this.buf[this.pos]&15)<<28)>>>0,this.buf[this.pos++]<128))return pe;if((this.pos+=5)>this.len)throw this.pos=this.len,re(this,10);return pe}}(),le.prototype.int32=function(){return this.uint32()|0},le.prototype.sint32=function(){var pe=this.uint32();return pe>>>1^-(pe&1)|0};function U(){var he=new ee(0,0),pe=0;if(this.len-this.pos>4){for(;pe<4;++pe)if(he.lo=(he.lo|(this.buf[this.pos]&127)<<pe*7)>>>0,this.buf[this.pos++]<128)return he;if(he.lo=(he.lo|(this.buf[this.pos]&127)<<28)>>>0,he.hi=(he.hi|(this.buf[this.pos]&127)>>4)>>>0,this.buf[this.pos++]<128)return he;pe=0}else{for(;pe<3;++pe){if(this.pos>=this.len)throw re(this);if(he.lo=(he.lo|(this.buf[this.pos]&127)<<pe*7)>>>0,this.buf[this.pos++]<128)return he}return he.lo=(he.lo|(this.buf[this.pos++]&127)<<pe*7)>>>0,he}if(this.len-this.pos>4){for(;pe<5;++pe)if(he.hi=(he.hi|(this.buf[this.pos]&127)<<pe*7+3)>>>0,this.buf[this.pos++]<128)return he}else for(;pe<5;++pe){if(this.pos>=this.len)throw re(this);if(he.hi=(he.hi|(this.buf[this.pos]&127)<<pe*7+3)>>>0,this.buf[this.pos++]<128)return he}throw Error("invalid varint encoding")}le.prototype.bool=function(){return this.uint32()!==0};function Z(he,pe){return(he[pe-4]|he[pe-3]<<8|he[pe-2]<<16|he[pe-1]<<24)>>>0}le.prototype.fixed32=function(){if(this.pos+4>this.len)throw re(this,4);return Z(this.buf,this.pos+=4)},le.prototype.sfixed32=function(){if(this.pos+4>this.len)throw re(this,4);return Z(this.buf,this.pos+=4)|0};function ae(){if(this.pos+8>this.len)throw re(this,8);return new ee(Z(this.buf,this.pos+=4),Z(this.buf,this.pos+=4))}return le.prototype.float=function(){if(this.pos+4>this.len)throw re(this,4);var pe=Y.float.readFloatLE(this.buf,this.pos);return this.pos+=4,pe},le.prototype.double=function(){if(this.pos+8>this.len)throw re(this,4);var pe=Y.float.readDoubleLE(this.buf,this.pos);return this.pos+=8,pe},le.prototype.bytes=function(){var pe=this.uint32(),me=this.pos,ve=this.pos+pe;if(ve>this.len)throw re(this,pe);if(this.pos+=pe,Array.isArray(this.buf))return this.buf.slice(me,ve);if(me===ve){var Re=Y.Buffer;return Re?Re.alloc(0):new this.buf.constructor(0)}return this._slice.call(this.buf,me,ve)},le.prototype.string=function(){var pe=this.bytes();return ne.read(pe,0,pe.length)},le.prototype.skip=function(pe){if(typeof pe=="number"){if(this.pos+pe>this.len)throw re(this,pe);this.pos+=pe}else do if(this.pos>=this.len)throw re(this);while(this.buf[this.pos++]&128);return this},le.prototype.skipType=function(he){switch(he){case 0:this.skip();break;case 1:this.skip(8);break;case 2:this.skip(this.uint32());break;case 3:for(;(he=this.uint32()&7)!==4;)this.skipType(he);break;case 5:this.skip(4);break;default:throw Error("invalid wire type "+he+" at offset "+this.pos)}return this},le._configure=function(he){K=he,le.create=R(),K._configure();var pe=Y.Long?"toLong":"toNumber";Y.merge(le.prototype,{int64:function(){return U.call(this)[pe](!1)},uint64:function(){return U.call(this)[pe](!0)},sint64:function(){return U.call(this).zzDecode()[pe](!1)},fixed64:function(){return ae.call(this)[pe](!0)},sfixed64:function(){return ae.call(this)[pe](!1)}})},reader}var reader_buffer,hasRequiredReader_buffer;function requireReader_buffer(){if(hasRequiredReader_buffer)return reader_buffer;hasRequiredReader_buffer=1,reader_buffer=ee;var Y=requireReader();(ee.prototype=Object.create(Y.prototype)).constructor=ee;var K=requireMinimal$1();function ee(ne){Y.call(this,ne)}return ee._configure=function(){K.Buffer&&(ee.prototype._slice=K.Buffer.prototype.slice)},ee.prototype.string=function(){var re=this.uint32();return this.buf.utf8Slice?this.buf.utf8Slice(this.pos,this.pos=Math.min(this.pos+re,this.len)):this.buf.toString("utf-8",this.pos,this.pos=Math.min(this.pos+re,this.len))},ee._configure(),reader_buffer}var rpc={},service,hasRequiredService;function requireService(){if(hasRequiredService)return service;hasRequiredService=1,service=K;var Y=requireMinimal$1();(K.prototype=Object.create(Y.EventEmitter.prototype)).constructor=K;function K(ee,ne,re){if(typeof ee!="function")throw TypeError("rpcImpl must be a function");Y.EventEmitter.call(this),this.rpcImpl=ee,this.requestDelimited=!!ne,this.responseDelimited=!!re}return K.prototype.rpcCall=function ee(ne,re,le,Q,R){if(!Q)throw TypeError("request must be specified");var U=this;if(!R)return Y.asPromise(ee,U,ne,re,le,Q);if(!U.rpcImpl){setTimeout(function(){R(Error("already ended"))},0);return}try{return U.rpcImpl(ne,re[U.requestDelimited?"encodeDelimited":"encode"](Q).finish(),function(ae,he){if(ae)return U.emit("error",ae,ne),R(ae);if(he===null){U.end(!0);return}if(!(he instanceof le))try{he=le[U.responseDelimited?"decodeDelimited":"decode"](he)}catch(pe){return U.emit("error",pe,ne),R(pe)}return U.emit("data",he,ne),R(null,he)})}catch(Z){U.emit("error",Z,ne),setTimeout(function(){R(Z)},0);return}},K.prototype.end=function(ne){return this.rpcImpl&&(ne||this.rpcImpl(null,null,null),this.rpcImpl=null,this.emit("end").off()),this},service}var hasRequiredRpc;function requireRpc(){return hasRequiredRpc||(hasRequiredRpc=1,function(Y){var K=Y;K.Service=requireService()}(rpc)),rpc}var roots,hasRequiredRoots;function requireRoots(){return hasRequiredRoots||(hasRequiredRoots=1,roots={}),roots}var hasRequiredIndexMinimal;function requireIndexMinimal(){return hasRequiredIndexMinimal||(hasRequiredIndexMinimal=1,function(Y){var K=Y;K.build="minimal",K.Writer=requireWriter(),K.BufferWriter=requireWriter_buffer(),K.Reader=requireReader(),K.BufferReader=requireReader_buffer(),K.util=requireMinimal$1(),K.rpc=requireRpc(),K.roots=requireRoots(),K.configure=ee;function ee(){K.util._configure(),K.Writer._configure(K.BufferWriter),K.Reader._configure(K.BufferReader)}ee()}(indexMinimal)),indexMinimal}var minimal,hasRequiredMinimal;function requireMinimal(){return hasRequiredMinimal||(hasRequiredMinimal=1,minimal=requireIndexMinimal()),minimal}var gtfsRealtime_pbf,hasRequiredGtfsRealtime_pbf;function requireGtfsRealtime_pbf(){if(hasRequiredGtfsRealtime_pbf)return gtfsRealtime_pbf;hasRequiredGtfsRealtime_pbf=1;var Y=requireMinimal(),K=Y.Reader,ee=Y.Writer,ne=Y.util,re=Y.roots.default||(Y.roots.default={});return re.transit_realtime=function(){var le={};return le.FeedMessage=function(){function Q(R){if(this.entity=[],R)for(var U=Object.keys(R),Z=0;Z<U.length;++Z)R[U[Z]]!=null&&(this[U[Z]]=R[U[Z]])}return Q.prototype.header=null,Q.prototype.entity=ne.emptyArray,Q.create=function(U){return new Q(U)},Q.encode=function(U,Z){if(Z||(Z=ee.create()),re.transit_realtime.FeedHeader.encode(U.header,Z.uint32(10).fork()).ldelim(),U.entity!=null&&U.entity.length)for(var ae=0;ae<U.entity.length;++ae)re.transit_realtime.FeedEntity.encode(U.entity[ae],Z.uint32(18).fork()).ldelim();return Z},Q.encodeDelimited=function(U,Z){return this.encode(U,Z).ldelim()},Q.decode=function(U,Z){U instanceof K||(U=K.create(U));for(var ae=Z===void 0?U.len:U.pos+Z,he=new re.transit_realtime.FeedMessage;U.pos<ae;){var pe=U.uint32();switch(pe>>>3){case 1:{he.header=re.transit_realtime.FeedHeader.decode(U,U.uint32());break}case 2:{he.entity&&he.entity.length||(he.entity=[]),he.entity.push(re.transit_realtime.FeedEntity.decode(U,U.uint32()));break}default:U.skipType(pe&7);break}}if(!he.hasOwnProperty("header"))throw ne.ProtocolError("missing required 'header'",{instance:he});return he},Q.decodeDelimited=function(U){return U instanceof K||(U=new K(U)),this.decode(U,U.uint32())},Q.verify=function(U){if(typeof U!="object"||U===null)return"object expected";{var Z=re.transit_realtime.FeedHeader.verify(U.header);if(Z)return"header."+Z}if(U.entity!=null&&U.hasOwnProperty("entity")){if(!Array.isArray(U.entity))return"entity: array expected";for(var ae=0;ae<U.entity.length;++ae){var Z=re.transit_realtime.FeedEntity.verify(U.entity[ae]);if(Z)return"entity."+Z}}return null},Q.fromObject=function(U){if(U instanceof re.transit_realtime.FeedMessage)return U;var Z=new re.transit_realtime.FeedMessage;if(U.header!=null){if(typeof U.header!="object")throw TypeError(".transit_realtime.FeedMessage.header: object expected");Z.header=re.transit_realtime.FeedHeader.fromObject(U.header)}if(U.entity){if(!Array.isArray(U.entity))throw TypeError(".transit_realtime.FeedMessage.entity: array expected");Z.entity=[];for(var ae=0;ae<U.entity.length;++ae){if(typeof U.entity[ae]!="object")throw TypeError(".transit_realtime.FeedMessage.entity: object expected");Z.entity[ae]=re.transit_realtime.FeedEntity.fromObject(U.entity[ae])}}return Z},Q.toObject=function(U,Z){Z||(Z={});var ae={};if((Z.arrays||Z.defaults)&&(ae.entity=[]),Z.defaults&&(ae.header=null),U.header!=null&&U.hasOwnProperty("header")&&(ae.header=re.transit_realtime.FeedHeader.toObject(U.header,Z)),U.entity&&U.entity.length){ae.entity=[];for(var he=0;he<U.entity.length;++he)ae.entity[he]=re.transit_realtime.FeedEntity.toObject(U.entity[he],Z)}return ae},Q.prototype.toJSON=function(){return this.constructor.toObject(this,Y.util.toJSONOptions)},Q.getTypeUrl=function(U){return U===void 0&&(U="type.googleapis.com"),U+"/transit_realtime.FeedMessage"},Q}(),le.FeedHeader=function(){function Q(R){if(R)for(var U=Object.keys(R),Z=0;Z<U.length;++Z)R[U[Z]]!=null&&(this[U[Z]]=R[U[Z]])}return Q.prototype.gtfs_realtime_version="",Q.prototype.incrementality=0,Q.prototype.timestamp=ne.Long?ne.Long.fromBits(0,0,!0):0,Q.prototype.feed_version="",Q.create=function(U){return new Q(U)},Q.encode=function(U,Z){return Z||(Z=ee.create()),Z.uint32(10).string(U.gtfs_realtime_version),U.incrementality!=null&&Object.hasOwnProperty.call(U,"incrementality")&&Z.uint32(16).int32(U.incrementality),U.timestamp!=null&&Object.hasOwnProperty.call(U,"timestamp")&&Z.uint32(24).uint64(U.timestamp),U.feed_version!=null&&Object.hasOwnProperty.call(U,"feed_version")&&Z.uint32(34).string(U.feed_version),Z},Q.encodeDelimited=function(U,Z){return this.encode(U,Z).ldelim()},Q.decode=function(U,Z){U instanceof K||(U=K.create(U));for(var ae=Z===void 0?U.len:U.pos+Z,he=new re.transit_realtime.FeedHeader;U.pos<ae;){var pe=U.uint32();switch(pe>>>3){case 1:{he.gtfs_realtime_version=U.string();break}case 2:{he.incrementality=U.int32();break}case 3:{he.timestamp=U.uint64();break}case 4:{he.feed_version=U.string();break}default:U.skipType(pe&7);break}}if(!he.hasOwnProperty("gtfs_realtime_version"))throw ne.ProtocolError("missing required 'gtfs_realtime_version'",{instance:he});return he},Q.decodeDelimited=function(U){return U instanceof K||(U=new K(U)),this.decode(U,U.uint32())},Q.verify=function(U){if(typeof U!="object"||U===null)return"object expected";if(!ne.isString(U.gtfs_realtime_version))return"gtfs_realtime_version: string expected";if(U.incrementality!=null&&U.hasOwnProperty("incrementality"))switch(U.incrementality){default:return"incrementality: enum value expected";case 0:case 1:break}return U.timestamp!=null&&U.hasOwnProperty("timestamp")&&!ne.isInteger(U.timestamp)&&!(U.timestamp&&ne.isInteger(U.timestamp.low)&&ne.isInteger(U.timestamp.high))?"timestamp: integer|Long expected":U.feed_version!=null&&U.hasOwnProperty("feed_version")&&!ne.isString(U.feed_version)?"feed_version: string expected":null},Q.fromObject=function(U){if(U instanceof re.transit_realtime.FeedHeader)return U;var Z=new re.transit_realtime.FeedHeader;switch(U.gtfs_realtime_version!=null&&(Z.gtfs_realtime_version=String(U.gtfs_realtime_version)),U.incrementality){default:if(typeof U.incrementality=="number"){Z.incrementality=U.incrementality;break}break;case"FULL_DATASET":case 0:Z.incrementality=0;break;case"DIFFERENTIAL":case 1:Z.incrementality=1;break}return U.timestamp!=null&&(ne.Long?(Z.timestamp=ne.Long.fromValue(U.timestamp)).unsigned=!0:typeof U.timestamp=="string"?Z.timestamp=parseInt(U.timestamp,10):typeof U.timestamp=="number"?Z.timestamp=U.timestamp:typeof U.timestamp=="object"&&(Z.timestamp=new ne.LongBits(U.timestamp.low>>>0,U.timestamp.high>>>0).toNumber(!0))),U.feed_version!=null&&(Z.feed_version=String(U.feed_version)),Z},Q.toObject=function(U,Z){Z||(Z={});var ae={};if(Z.defaults){if(ae.gtfs_realtime_version="",ae.incrementality=Z.enums===String?"FULL_DATASET":0,ne.Long){var he=new ne.Long(0,0,!0);ae.timestamp=Z.longs===String?he.toString():Z.longs===Number?he.toNumber():he}else ae.timestamp=Z.longs===String?"0":0;ae.feed_version=""}return U.gtfs_realtime_version!=null&&U.hasOwnProperty("gtfs_realtime_version")&&(ae.gtfs_realtime_version=U.gtfs_realtime_version),U.incrementality!=null&&U.hasOwnProperty("incrementality")&&(ae.incrementality=Z.enums===String?re.transit_realtime.FeedHeader.Incrementality[U.incrementality]===void 0?U.incrementality:re.transit_realtime.FeedHeader.Incrementality[U.incrementality]:U.incrementality),U.timestamp!=null&&U.hasOwnProperty("timestamp")&&(typeof U.timestamp=="number"?ae.timestamp=Z.longs===String?String(U.timestamp):U.timestamp:ae.timestamp=Z.longs===String?ne.Long.prototype.toString.call(U.timestamp):Z.longs===Number?new ne.LongBits(U.timestamp.low>>>0,U.timestamp.high>>>0).toNumber(!0):U.timestamp),U.feed_version!=null&&U.hasOwnProperty("feed_version")&&(ae.feed_version=U.feed_version),ae},Q.prototype.toJSON=function(){return this.constructor.toObject(this,Y.util.toJSONOptions)},Q.getTypeUrl=function(U){return U===void 0&&(U="type.googleapis.com"),U+"/transit_realtime.FeedHeader"},Q.Incrementality=function(){var R={},U=Object.create(R);return U[R[0]="FULL_DATASET"]=0,U[R[1]="DIFFERENTIAL"]=1,U}(),Q}(),le.FeedEntity=function(){function Q(R){if(R)for(var U=Object.keys(R),Z=0;Z<U.length;++Z)R[U[Z]]!=null&&(this[U[Z]]=R[U[Z]])}return Q.prototype.id="",Q.prototype.is_deleted=!1,Q.prototype.trip_update=null,Q.prototype.vehicle=null,Q.prototype.alert=null,Q.prototype.shape=null,Q.prototype.stop=null,Q.prototype.trip_modifications=null,Q.create=function(U){return new Q(U)},Q.encode=function(U,Z){return Z||(Z=ee.create()),Z.uint32(10).string(U.id),U.is_deleted!=null&&Object.hasOwnProperty.call(U,"is_deleted")&&Z.uint32(16).bool(U.is_deleted),U.trip_update!=null&&Object.hasOwnProperty.call(U,"trip_update")&&re.transit_realtime.TripUpdate.encode(U.trip_update,Z.uint32(26).fork()).ldelim(),U.vehicle!=null&&Object.hasOwnProperty.call(U,"vehicle")&&re.transit_realtime.VehiclePosition.encode(U.vehicle,Z.uint32(34).fork()).ldelim(),U.alert!=null&&Object.hasOwnProperty.call(U,"alert")&&re.transit_realtime.Alert.encode(U.alert,Z.uint32(42).fork()).ldelim(),U.shape!=null&&Object.hasOwnProperty.call(U,"shape")&&re.transit_realtime.Shape.encode(U.shape,Z.uint32(50).fork()).ldelim(),U.stop!=null&&Object.hasOwnProperty.call(U,"stop")&&re.transit_realtime.Stop.encode(U.stop,Z.uint32(58).fork()).ldelim(),U.trip_modifications!=null&&Object.hasOwnProperty.call(U,"trip_modifications")&&re.transit_realtime.TripModifications.encode(U.trip_modifications,Z.uint32(66).fork()).ldelim(),Z},Q.encodeDelimited=function(U,Z){return this.encode(U,Z).ldelim()},Q.decode=function(U,Z){U instanceof K||(U=K.create(U));for(var ae=Z===void 0?U.len:U.pos+Z,he=new re.transit_realtime.FeedEntity;U.pos<ae;){var pe=U.uint32();switch(pe>>>3){case 1:{he.id=U.string();break}case 2:{he.is_deleted=U.bool();break}case 3:{he.trip_update=re.transit_realtime.TripUpdate.decode(U,U.uint32());break}case 4:{he.vehicle=re.transit_realtime.VehiclePosition.decode(U,U.uint32());break}case 5:{he.alert=re.transit_realtime.Alert.decode(U,U.uint32());break}case 6:{he.shape=re.transit_realtime.Shape.decode(U,U.uint32());break}case 7:{he.stop=re.transit_realtime.Stop.decode(U,U.uint32());break}case 8:{he.trip_modifications=re.transit_realtime.TripModifications.decode(U,U.uint32());break}default:U.skipType(pe&7);break}}if(!he.hasOwnProperty("id"))throw ne.ProtocolError("missing required 'id'",{instance:he});return he},Q.decodeDelimited=function(U){return U instanceof K||(U=new K(U)),this.decode(U,U.uint32())},Q.verify=function(U){if(typeof U!="object"||U===null)return"object expected";if(!ne.isString(U.id))return"id: string expected";if(U.is_deleted!=null&&U.hasOwnProperty("is_deleted")&&typeof U.is_deleted!="boolean")return"is_deleted: boolean expected";if(U.trip_update!=null&&U.hasOwnProperty("trip_update")){var Z=re.transit_realtime.TripUpdate.verify(U.trip_update);if(Z)return"trip_update."+Z}if(U.vehicle!=null&&U.hasOwnProperty("vehicle")){var Z=re.transit_realtime.VehiclePosition.verify(U.vehicle);if(Z)return"vehicle."+Z}if(U.alert!=null&&U.hasOwnProperty("alert")){var Z=re.transit_realtime.Alert.verify(U.alert);if(Z)return"alert."+Z}if(U.shape!=null&&U.hasOwnProperty("shape")){var Z=re.transit_realtime.Shape.verify(U.shape);if(Z)return"shape."+Z}if(U.stop!=null&&U.hasOwnProperty("stop")){var Z=re.transit_realtime.Stop.verify(U.stop);if(Z)return"stop."+Z}if(U.trip_modifications!=null&&U.hasOwnProperty("trip_modifications")){var Z=re.transit_realtime.TripModifications.verify(U.trip_modifications);if(Z)return"trip_modifications."+Z}return null},Q.fromObject=function(U){if(U instanceof re.transit_realtime.FeedEntity)return U;var Z=new re.transit_realtime.FeedEntity;if(U.id!=null&&(Z.id=String(U.id)),U.is_deleted!=null&&(Z.is_deleted=!!U.is_deleted),U.trip_update!=null){if(typeof U.trip_update!="object")throw TypeError(".transit_realtime.FeedEntity.trip_update: object expected");Z.trip_update=re.transit_realtime.TripUpdate.fromObject(U.trip_update)}if(U.vehicle!=null){if(typeof U.vehicle!="object")throw TypeError(".transit_realtime.FeedEntity.vehicle: object expected");Z.vehicle=re.transit_realtime.VehiclePosition.fromObject(U.vehicle)}if(U.alert!=null){if(typeof U.alert!="object")throw TypeError(".transit_realtime.FeedEntity.alert: object expected");Z.alert=re.transit_realtime.Alert.fromObject(U.alert)}if(U.shape!=null){if(typeof U.shape!="object")throw TypeError(".transit_realtime.FeedEntity.shape: object expected");Z.shape=re.transit_realtime.Shape.fromObject(U.shape)}if(U.stop!=null){if(typeof U.stop!="object")throw TypeError(".transit_realtime.FeedEntity.stop: object expected");Z.stop=re.transit_realtime.Stop.fromObject(U.stop)}if(U.trip_modifications!=null){if(typeof U.trip_modifications!="object")throw TypeError(".transit_realtime.FeedEntity.trip_modifications: object expected");Z.trip_modifications=re.transit_realtime.TripModifications.fromObject(U.trip_modifications)}return Z},Q.toObject=function(U,Z){Z||(Z={});var ae={};return Z.defaults&&(ae.id="",ae.is_deleted=!1,ae.trip_update=null,ae.vehicle=null,ae.alert=null,ae.shape=null,ae.stop=null,ae.trip_modifications=null),U.id!=null&&U.hasOwnProperty("id")&&(ae.id=U.id),U.is_deleted!=null&&U.hasOwnProperty("is_deleted")&&(ae.is_deleted=U.is_deleted),U.trip_update!=null&&U.hasOwnProperty("trip_update")&&(ae.trip_update=re.transit_realtime.TripUpdate.toObject(U.trip_update,Z)),U.vehicle!=null&&U.hasOwnProperty("vehicle")&&(ae.vehicle=re.transit_realtime.VehiclePosition.toObject(U.vehicle,Z)),U.alert!=null&&U.hasOwnProperty("alert")&&(ae.alert=re.transit_realtime.Alert.toObject(U.alert,Z)),U.shape!=null&&U.hasOwnProperty("shape")&&(ae.shape=re.transit_realtime.Shape.toObject(U.shape,Z)),U.stop!=null&&U.hasOwnProperty("stop")&&(ae.stop=re.transit_realtime.Stop.toObject(U.stop,Z)),U.trip_modifications!=null&&U.hasOwnProperty("trip_modifications")&&(ae.trip_modifications=re.transit_realtime.TripModifications.toObject(U.trip_modifications,Z)),ae},Q.prototype.toJSON=function(){return this.constructor.toObject(this,Y.util.toJSONOptions)},Q.getTypeUrl=function(U){return U===void 0&&(U="type.googleapis.com"),U+"/transit_realtime.FeedEntity"},Q}(),le.TripUpdate=function(){function Q(R){if(this.stop_time_update=[],R)for(var U=Object.keys(R),Z=0;Z<U.length;++Z)R[U[Z]]!=null&&(this[U[Z]]=R[U[Z]])}return Q.prototype.trip=null,Q.prototype.vehicle=null,Q.prototype.stop_time_update=ne.emptyArray,Q.prototype.timestamp=ne.Long?ne.Long.fromBits(0,0,!0):0,Q.prototype.delay=0,Q.prototype.trip_properties=null,Q.create=function(U){return new Q(U)},Q.encode=function(U,Z){if(Z||(Z=ee.create()),re.transit_realtime.TripDescriptor.encode(U.trip,Z.uint32(10).fork()).ldelim(),U.stop_time_update!=null&&U.stop_time_update.length)for(var ae=0;ae<U.stop_time_update.length;++ae)re.transit_realtime.TripUpdate.StopTimeUpdate.encode(U.stop_time_update[ae],Z.uint32(18).fork()).ldelim();return U.vehicle!=null&&Object.hasOwnProperty.call(U,"vehicle")&&re.transit_realtime.VehicleDescriptor.encode(U.vehicle,Z.uint32(26).fork()).ldelim(),U.timestamp!=null&&Object.hasOwnProperty.call(U,"timestamp")&&Z.uint32(32).uint64(U.timestamp),U.delay!=null&&Object.hasOwnProperty.call(U,"delay")&&Z.uint32(40).int32(U.delay),U.trip_properties!=null&&Object.hasOwnProperty.call(U,"trip_properties")&&re.transit_realtime.TripUpdate.TripProperties.encode(U.trip_properties,Z.uint32(50).fork()).ldelim(),Z},Q.encodeDelimited=function(U,Z){return this.encode(U,Z).ldelim()},Q.decode=function(U,Z){U instanceof K||(U=K.create(U));for(var ae=Z===void 0?U.len:U.pos+Z,he=new re.transit_realtime.TripUpdate;U.pos<ae;){var pe=U.uint32();switch(pe>>>3){case 1:{he.trip=re.transit_realtime.TripDescriptor.decode(U,U.uint32());break}case 3:{he.vehicle=re.transit_realtime.VehicleDescriptor.decode(U,U.uint32());break}case 2:{he.stop_time_update&&he.stop_time_update.length||(he.stop_time_update=[]),he.stop_time_update.push(re.transit_realtime.TripUpdate.StopTimeUpdate.decode(U,U.uint32()));break}case 4:{he.timestamp=U.uint64();break}case 5:{he.delay=U.int32();break}case 6:{he.trip_properties=re.transit_realtime.TripUpdate.TripProperties.decode(U,U.uint32());break}default:U.skipType(pe&7);break}}if(!he.hasOwnProperty("trip"))throw ne.ProtocolError("missing required 'trip'",{instance:he});return he},Q.decodeDelimited=function(U){return U instanceof K||(U=new K(U)),this.decode(U,U.uint32())},Q.verify=function(U){if(typeof U!="object"||U===null)return"object expected";{var Z=re.transit_realtime.TripDescriptor.verify(U.trip);if(Z)return"trip."+Z}if(U.vehicle!=null&&U.hasOwnProperty("vehicle")){var Z=re.transit_realtime.VehicleDescriptor.verify(U.vehicle);if(Z)return"vehicle."+Z}if(U.stop_time_update!=null&&U.hasOwnProperty("stop_time_update")){if(!Array.isArray(U.stop_time_update))return"stop_time_update: array expected";for(var ae=0;ae<U.stop_time_update.length;++ae){var Z=re.transit_realtime.TripUpdate.StopTimeUpdate.verify(U.stop_time_update[ae]);if(Z)return"stop_time_update."+Z}}if(U.timestamp!=null&&U.hasOwnProperty("timestamp")&&!ne.isInteger(U.timestamp)&&!(U.timestamp&&ne.isInteger(U.timestamp.low)&&ne.isInteger(U.timestamp.high)))return"timestamp: integer|Long expected";if(U.delay!=null&&U.hasOwnProperty("delay")&&!ne.isInteger(U.delay))return"delay: integer expected";if(U.trip_properties!=null&&U.hasOwnProperty("trip_properties")){var Z=re.transit_realtime.TripUpdate.TripProperties.verify(U.trip_properties);if(Z)return"trip_properties."+Z}return null},Q.fromObject=function(U){if(U instanceof re.transit_realtime.TripUpdate)return U;var Z=new re.transit_realtime.TripUpdate;if(U.trip!=null){if(typeof U.trip!="object")throw TypeError(".transit_realtime.TripUpdate.trip: object expected");Z.trip=re.transit_realtime.TripDescriptor.fromObject(U.trip)}if(U.vehicle!=null){if(typeof U.vehicle!="object")throw TypeError(".transit_realtime.TripUpdate.vehicle: object expected");Z.vehicle=re.transit_realtime.VehicleDescriptor.fromObject(U.vehicle)}if(U.stop_time_update){if(!Array.isArray(U.stop_time_update))throw TypeError(".transit_realtime.TripUpdate.stop_time_update: array expected");Z.stop_time_update=[];for(var ae=0;ae<U.stop_time_update.length;++ae){if(typeof U.stop_time_update[ae]!="object")throw TypeError(".transit_realtime.TripUpdate.stop_time_update: object expected");Z.stop_time_update[ae]=re.transit_realtime.TripUpdate.StopTimeUpdate.fromObject(U.stop_time_update[ae])}}if(U.timestamp!=null&&(ne.Long?(Z.timestamp=ne.Long.fromValue(U.timestamp)).unsigned=!0:typeof U.timestamp=="string"?Z.timestamp=parseInt(U.timestamp,10):typeof U.timestamp=="number"?Z.timestamp=U.timestamp:typeof U.timestamp=="object"&&(Z.timestamp=new ne.LongBits(U.timestamp.low>>>0,U.timestamp.high>>>0).toNumber(!0))),U.delay!=null&&(Z.delay=U.delay|0),U.trip_properties!=null){if(typeof U.trip_properties!="object")throw TypeError(".transit_realtime.TripUpdate.trip_properties: object expected");Z.trip_properties=re.transit_realtime.TripUpdate.TripProperties.fromObject(U.trip_properties)}return Z},Q.toObject=function(U,Z){Z||(Z={});var ae={};if((Z.arrays||Z.defaults)&&(ae.stop_time_update=[]),Z.defaults){if(ae.trip=null,ae.vehicle=null,ne.Long){var he=new ne.Long(0,0,!0);ae.timestamp=Z.longs===String?he.toString():Z.longs===Number?he.toNumber():he}else ae.timestamp=Z.longs===String?"0":0;ae.delay=0,ae.trip_properties=null}if(U.trip!=null&&U.hasOwnProperty("trip")&&(ae.trip=re.transit_realtime.TripDescriptor.toObject(U.trip,Z)),U.stop_time_update&&U.stop_time_update.length){ae.stop_time_update=[];for(var pe=0;pe<U.stop_time_update.length;++pe)ae.stop_time_update[pe]=re.transit_realtime.TripUpdate.StopTimeUpdate.toObject(U.stop_time_update[pe],Z)}return U.vehicle!=null&&U.hasOwnProperty("vehicle")&&(ae.vehicle=re.transit_realtime.VehicleDescriptor.toObject(U.vehicle,Z)),U.timestamp!=null&&U.hasOwnProperty("timestamp")&&(typeof U.timestamp=="number"?ae.timestamp=Z.longs===String?String(U.timestamp):U.timestamp:ae.timestamp=Z.longs===String?ne.Long.prototype.toString.call(U.timestamp):Z.longs===Number?new ne.LongBits(U.timestamp.low>>>0,U.timestamp.high>>>0).toNumber(!0):U.timestamp),U.delay!=null&&U.hasOwnProperty("delay")&&(ae.delay=U.delay),U.trip_properties!=null&&U.hasOwnProperty("trip_properties")&&(ae.trip_properties=re.transit_realtime.TripUpdate.TripProperties.toObject(U.trip_properties,Z)),ae},Q.prototype.toJSON=function(){return this.constructor.toObject(this,Y.util.toJSONOptions)},Q.getTypeUrl=function(U){return U===void 0&&(U="type.googleapis.com"),U+"/transit_realtime.TripUpdate"},Q.StopTimeEvent=function(){function R(U){if(U)for(var Z=Object.keys(U),ae=0;ae<Z.length;++ae)U[Z[ae]]!=null&&(this[Z[ae]]=U[Z[ae]])}return R.prototype.delay=0,R.prototype.time=ne.Long?ne.Long.fromBits(0,0,!1):0,R.prototype.uncertainty=0,R.create=function(Z){return new R(Z)},R.encode=function(Z,ae){return ae||(ae=ee.create()),Z.delay!=null&&Object.hasOwnProperty.call(Z,"delay")&&ae.uint32(8).int32(Z.delay),Z.time!=null&&Object.hasOwnProperty.call(Z,"time")&&ae.uint32(16).int64(Z.time),Z.uncertainty!=null&&Object.hasOwnProperty.call(Z,"uncertainty")&&ae.uint32(24).int32(Z.uncertainty),ae},R.encodeDelimited=function(Z,ae){return this.encode(Z,ae).ldelim()},R.decode=function(Z,ae){Z instanceof K||(Z=K.create(Z));for(var he=ae===void 0?Z.len:Z.pos+ae,pe=new re.transit_realtime.TripUpdate.StopTimeEvent;Z.pos<he;){var me=Z.uint32();switch(me>>>3){case 1:{pe.delay=Z.int32();break}case 2:{pe.time=Z.int64();break}case 3:{pe.uncertainty=Z.int32();break}default:Z.skipType(me&7);break}}return pe},R.decodeDelimited=function(Z){return Z instanceof K||(Z=new K(Z)),this.decode(Z,Z.uint32())},R.verify=function(Z){return typeof Z!="object"||Z===null?"object expected":Z.delay!=null&&Z.hasOwnProperty("delay")&&!ne.isInteger(Z.delay)?"delay: integer expected":Z.time!=null&&Z.hasOwnProperty("time")&&!ne.isInteger(Z.time)&&!(Z.time&&ne.isInteger(Z.time.low)&&ne.isInteger(Z.time.high))?"time: integer|Long expected":Z.uncertainty!=null&&Z.hasOwnProperty("uncertainty")&&!ne.isInteger(Z.uncertainty)?"uncertainty: integer expected":null},R.fromObject=function(Z){if(Z instanceof re.transit_realtime.TripUpdate.StopTimeEvent)return Z;var ae=new re.transit_realtime.TripUpdate.StopTimeEvent;return Z.delay!=null&&(ae.delay=Z.delay|0),Z.time!=null&&(ne.Long?(ae.time=ne.Long.fromValue(Z.time)).unsigned=!1:typeof Z.time=="string"?ae.time=parseInt(Z.time,10):typeof Z.time=="number"?ae.time=Z.time:typeof Z.time=="object"&&(ae.time=new ne.LongBits(Z.time.low>>>0,Z.time.high>>>0).toNumber())),Z.uncertainty!=null&&(ae.uncertainty=Z.uncertainty|0),ae},R.toObject=function(Z,ae){ae||(ae={});var he={};if(ae.defaults){if(he.delay=0,ne.Long){var pe=new ne.Long(0,0,!1);he.time=ae.longs===String?pe.toString():ae.longs===Number?pe.toNumber():pe}else he.time=ae.longs===String?"0":0;he.uncertainty=0}return Z.delay!=null&&Z.hasOwnProperty("delay")&&(he.delay=Z.delay),Z.time!=null&&Z.hasOwnProperty("time")&&(typeof Z.time=="number"?he.time=ae.longs===String?String(Z.time):Z.time:he.time=ae.longs===String?ne.Long.prototype.toString.call(Z.time):ae.longs===Number?new ne.LongBits(Z.time.low>>>0,Z.time.high>>>0).toNumber():Z.time),Z.uncertainty!=null&&Z.hasOwnProperty("uncertainty")&&(he.uncertainty=Z.uncertainty),he},R.prototype.toJSON=function(){return this.constructor.toObject(this,Y.util.toJSONOptions)},R.getTypeUrl=function(Z){return Z===void 0&&(Z="type.googleapis.com"),Z+"/transit_realtime.TripUpdate.StopTimeEvent"},R}(),Q.StopTimeUpdate=function(){function R(U){if(U)for(var Z=Object.keys(U),ae=0;ae<Z.length;++ae)U[Z[ae]]!=null&&(this[Z[ae]]=U[Z[ae]])}return R.prototype.stop_sequence=0,R.prototype.stop_id="",R.prototype.arrival=null,R.prototype.departure=null,R.prototype.departure_occupancy_status=0,R.prototype.schedule_relationship=0,R.prototype.stop_time_properties=null,R.create=function(Z){return new R(Z)},R.encode=function(Z,ae){return ae||(ae=ee.create()),Z.stop_sequence!=null&&Object.hasOwnProperty.call(Z,"stop_sequence")&&ae.uint32(8).uint32(Z.stop_sequence),Z.arrival!=null&&Object.hasOwnProperty.call(Z,"arrival")&&re.transit_realtime.TripUpdate.StopTimeEvent.encode(Z.arrival,ae.uint32(18).fork()).ldelim(),Z.departure!=null&&Object.hasOwnProperty.call(Z,"departure")&&re.transit_realtime.TripUpdate.StopTimeEvent.encode(Z.departure,ae.uint32(26).fork()).ldelim(),Z.stop_id!=null&&Object.hasOwnProperty.call(Z,"stop_id")&&ae.uint32(34).string(Z.stop_id),Z.schedule_relationship!=null&&Object.hasOwnProperty.call(Z,"schedule_relationship")&&ae.uint32(40).int32(Z.schedule_relationship),Z.stop_time_properties!=null&&Object.hasOwnProperty.call(Z,"stop_time_properties")&&re.transit_realtime.TripUpdate.StopTimeUpdate.StopTimeProperties.encode(Z.stop_time_properties,ae.uint32(50).fork()).ldelim(),Z.departure_occupancy_status!=null&&Object.hasOwnProperty.call(Z,"departure_occupancy_status")&&ae.uint32(56).int32(Z.departure_occupancy_status),ae},R.encodeDelimited=function(Z,ae){return this.encode(Z,ae).ldelim()},R.decode=function(Z,ae){Z instanceof K||(Z=K.create(Z));for(var he=ae===void 0?Z.len:Z.pos+ae,pe=new re.transit_realtime.TripUpdate.StopTimeUpdate;Z.pos<he;){var me=Z.uint32();switch(me>>>3){case 1:{pe.stop_sequence=Z.uint32();break}case 4:{pe.stop_id=Z.string();break}case 2:{pe.arrival=re.transit_realtime.TripUpdate.StopTimeEvent.decode(Z,Z.uint32());break}case 3:{pe.departure=re.transit_realtime.TripUpdate.StopTimeEvent.decode(Z,Z.uint32());break}case 7:{pe.departure_occupancy_status=Z.int32();break}case 5:{pe.schedule_relationship=Z.int32();break}case 6:{pe.stop_time_properties=re.transit_realtime.TripUpdate.StopTimeUpdate.StopTimeProperties.decode(Z,Z.uint32());break}default:Z.skipType(me&7);break}}return pe},R.decodeDelimited=function(Z){return Z instanceof K||(Z=new K(Z)),this.decode(Z,Z.uint32())},R.verify=function(Z){if(typeof Z!="object"||Z===null)return"object expected";if(Z.stop_sequence!=null&&Z.hasOwnProperty("stop_sequence")&&!ne.isInteger(Z.stop_sequence))return"stop_sequence: integer expected";if(Z.stop_id!=null&&Z.hasOwnProperty("stop_id")&&!ne.isString(Z.stop_id))return"stop_id: string expected";if(Z.arrival!=null&&Z.hasOwnProperty("arrival")){var ae=re.transit_realtime.TripUpdate.StopTimeEvent.verify(Z.arrival);if(ae)return"arrival."+ae}if(Z.departure!=null&&Z.hasOwnProperty("departure")){var ae=re.transit_realtime.TripUpdate.StopTimeEvent.verify(Z.departure);if(ae)return"departure."+ae}if(Z.departure_occupancy_status!=null&&Z.hasOwnProperty("departure_occupancy_status"))switch(Z.departure_occupancy_status){default:return"departure_occupancy_status: enum value expected";case 0:case 1:case 2:case 3:case 4:case 5:case 6:case 7:case 8:break}if(Z.schedule_relationship!=null&&Z.hasOwnProperty("schedule_relationship"))switch(Z.schedule_relationship){default:return"schedule_relationship: enum value expected";case 0:case 1:case 2:case 3:break}if(Z.stop_time_properties!=null&&Z.hasOwnProperty("stop_time_properties")){var ae=re.transit_realtime.TripUpdate.StopTimeUpdate.StopTimeProperties.verify(Z.stop_time_properties);if(ae)return"stop_time_properties."+ae}return null},R.fromObject=function(Z){if(Z instanceof re.transit_realtime.TripUpdate.StopTimeUpdate)return Z;var ae=new re.transit_realtime.TripUpdate.StopTimeUpdate;if(Z.stop_sequence!=null&&(ae.stop_sequence=Z.stop_sequence>>>0),Z.stop_id!=null&&(ae.stop_id=String(Z.stop_id)),Z.arrival!=null){if(typeof Z.arrival!="object")throw TypeError(".transit_realtime.TripUpdate.StopTimeUpdate.arrival: object expected");ae.arrival=re.transit_realtime.TripUpdate.StopTimeEvent.fromObject(Z.arrival)}if(Z.departure!=null){if(typeof Z.departure!="object")throw TypeError(".transit_realtime.TripUpdate.StopTimeUpdate.departure: object expected");ae.departure=re.transit_realtime.TripUpdate.StopTimeEvent.fromObject(Z.departure)}switch(Z.departure_occupancy_status){default:if(typeof Z.departure_occupancy_status=="number"){ae.departure_occupancy_status=Z.departure_occupancy_status;break}break;case"EMPTY":case 0:ae.departure_occupancy_status=0;break;case"MANY_SEATS_AVAILABLE":case 1:ae.departure_occupancy_status=1;break;case"FEW_SEATS_AVAILABLE":case 2:ae.departure_occupancy_status=2;break;case"STANDING_ROOM_ONLY":case 3:ae.departure_occupancy_status=3;break;case"CRUSHED_STANDING_ROOM_ONLY":case 4:ae.departure_occupancy_status=4;break;case"FULL":case 5:ae.departure_occupancy_status=5;break;case"NOT_ACCEPTING_PASSENGERS":case 6:ae.departure_occupancy_status=6;break;case"NO_DATA_AVAILABLE":case 7:ae.departure_occupancy_status=7;break;case"NOT_BOARDABLE":case 8:ae.departure_occupancy_status=8;break}switch(Z.schedule_relationship){default:if(typeof Z.schedule_relationship=="number"){ae.schedule_relationship=Z.schedule_relationship;break}break;case"SCHEDULED":case 0:ae.schedule_relationship=0;break;case"SKIPPED":case 1:ae.schedule_relationship=1;break;case"NO_DATA":case 2:ae.schedule_relationship=2;break;case"UNSCHEDULED":case 3:ae.schedule_relationship=3;break}if(Z.stop_time_properties!=null){if(typeof Z.stop_time_properties!="object")throw TypeError(".transit_realtime.TripUpdate.StopTimeUpdate.stop_time_properties: object expected");ae.stop_time_properties=re.transit_realtime.TripUpdate.StopTimeUpdate.StopTimeProperties.fromObject(Z.stop_time_properties)}return ae},R.toObject=function(Z,ae){ae||(ae={});var he={};return ae.defaults&&(he.stop_sequence=0,he.arrival=null,he.departure=null,he.stop_id="",he.schedule_relationship=ae.enums===String?"SCHEDULED":0,he.stop_time_properties=null,he.departure_occupancy_status=ae.enums===String?"EMPTY":0),Z.stop_sequence!=null&&Z.hasOwnProperty("stop_sequence")&&(he.stop_sequence=Z.stop_sequence),Z.arrival!=null&&Z.hasOwnProperty("arrival")&&(he.arrival=re.transit_realtime.TripUpdate.StopTimeEvent.toObject(Z.arrival,ae)),Z.departure!=null&&Z.hasOwnProperty("departure")&&(he.departure=re.transit_realtime.TripUpdate.StopTimeEvent.toObject(Z.departure,ae)),Z.stop_id!=null&&Z.hasOwnProperty("stop_id")&&(he.stop_id=Z.stop_id),Z.schedule_relationship!=null&&Z.hasOwnProperty("schedule_relationship")&&(he.schedule_relationship=ae.enums===String?re.transit_realtime.TripUpdate.StopTimeUpdate.ScheduleRelationship[Z.schedule_relationship]===void 0?Z.schedule_relationship:re.transit_realtime.TripUpdate.StopTimeUpdate.ScheduleRelationship[Z.schedule_relationship]:Z.schedule_relationship),Z.stop_time_properties!=null&&Z.hasOwnProperty("stop_time_properties")&&(he.stop_time_properties=re.transit_realtime.TripUpdate.StopTimeUpdate.StopTimeProperties.toObject(Z.stop_time_properties,ae)),Z.departure_occupancy_status!=null&&Z.hasOwnProperty("departure_occupancy_status")&&(he.departure_occupancy_status=ae.enums===String?re.transit_realtime.VehiclePosition.OccupancyStatus[Z.departure_occupancy_status]===void 0?Z.departure_occupancy_status:re.transit_realtime.VehiclePosition.OccupancyStatus[Z.departure_occupancy_status]:Z.departure_occupancy_status),he},R.prototype.toJSON=function(){return this.constructor.toObject(this,Y.util.toJSONOptions)},R.getTypeUrl=function(Z){return Z===void 0&&(Z="type.googleapis.com"),Z+"/transit_realtime.TripUpdate.StopTimeUpdate"},R.ScheduleRelationship=function(){var U={},Z=Object.create(U);return Z[U[0]="SCHEDULED"]=0,Z[U[1]="SKIPPED"]=1,Z[U[2]="NO_DATA"]=2,Z[U[3]="UNSCHEDULED"]=3,Z}(),R.StopTimeProperties=function(){function U(Z){if(Z)for(var ae=Object.keys(Z),he=0;he<ae.length;++he)Z[ae[he]]!=null&&(this[ae[he]]=Z[ae[he]])}return U.prototype.assigned_stop_id="",U.create=function(ae){return new U(ae)},U.encode=function(ae,he){return he||(he=ee.create()),ae.assigned_stop_id!=null&&Object.hasOwnProperty.call(ae,"assigned_stop_id")&&he.uint32(10).string(ae.assigned_stop_id),he},U.encodeDelimited=function(ae,he){return this.encode(ae,he).ldelim()},U.decode=function(ae,he){ae instanceof K||(ae=K.create(ae));for(var pe=he===void 0?ae.len:ae.pos+he,me=new re.transit_realtime.TripUpdate.StopTimeUpdate.StopTimeProperties;ae.pos<pe;){var ve=ae.uint32();switch(ve>>>3){case 1:{me.assigned_stop_id=ae.string();break}default:ae.skipType(ve&7);break}}return me},U.decodeDelimited=function(ae){return ae instanceof K||(ae=new K(ae)),this.decode(ae,ae.uint32())},U.verify=function(ae){return typeof ae!="object"||ae===null?"object expected":ae.assigned_stop_id!=null&&ae.hasOwnProperty("assigned_stop_id")&&!ne.isString(ae.assigned_stop_id)?"assigned_stop_id: string expected":null},U.fromObject=function(ae){if(ae instanceof re.transit_realtime.TripUpdate.StopTimeUpdate.StopTimeProperties)return ae;var he=new re.transit_realtime.TripUpdate.StopTimeUpdate.StopTimeProperties;return ae.assigned_stop_id!=null&&(he.assigned_stop_id=String(ae.assigned_stop_id)),he},U.toObject=function(ae,he){he||(he={});var pe={};return he.defaults&&(pe.assigned_stop_id=""),ae.assigned_stop_id!=null&&ae.hasOwnProperty("assigned_stop_id")&&(pe.assigned_stop_id=ae.assigned_stop_id),pe},U.prototype.toJSON=function(){return this.constructor.toObject(this,Y.util.toJSONOptions)},U.getTypeUrl=function(ae){return ae===void 0&&(ae="type.googleapis.com"),ae+"/transit_realtime.TripUpdate.StopTimeUpdate.StopTimeProperties"},U}(),R}(),Q.TripProperties=function(){function R(U){if(U)for(var Z=Object.keys(U),ae=0;ae<Z.length;++ae)U[Z[ae]]!=null&&(this[Z[ae]]=U[Z[ae]])}return R.prototype.trip_id="",R.prototype.start_date="",R.prototype.start_time="",R.prototype.shape_id="",R.create=function(Z){return new R(Z)},R.encode=function(Z,ae){return ae||(ae=ee.create()),Z.trip_id!=null&&Object.hasOwnProperty.call(Z,"trip_id")&&ae.uint32(10).string(Z.trip_id),Z.start_date!=null&&Object.hasOwnProperty.call(Z,"start_date")&&ae.uint32(18).string(Z.start_date),Z.start_time!=null&&Object.hasOwnProperty.call(Z,"start_time")&&ae.uint32(26).string(Z.start_time),Z.shape_id!=null&&Object.hasOwnProperty.call(Z,"shape_id")&&ae.uint32(34).string(Z.shape_id),ae},R.encodeDelimited=function(Z,ae){return this.encode(Z,ae).ldelim()},R.decode=function(Z,ae){Z instanceof K||(Z=K.create(Z));for(var he=ae===void 0?Z.len:Z.pos+ae,pe=new re.transit_realtime.TripUpdate.TripProperties;Z.pos<he;){var me=Z.uint32();switch(me>>>3){case 1:{pe.trip_id=Z.string();break}case 2:{pe.start_date=Z.string();break}case 3:{pe.start_time=Z.string();break}case 4:{pe.shape_id=Z.string();break}default:Z.skipType(me&7);break}}return pe},R.decodeDelimited=function(Z){return Z instanceof K||(Z=new K(Z)),this.decode(Z,Z.uint32())},R.verify=function(Z){return typeof Z!="object"||Z===null?"object expected":Z.trip_id!=null&&Z.hasOwnProperty("trip_id")&&!ne.isString(Z.trip_id)?"trip_id: string expected":Z.start_date!=null&&Z.hasOwnProperty("start_date")&&!ne.isString(Z.start_date)?"start_date: string expected":Z.start_time!=null&&Z.hasOwnProperty("start_time")&&!ne.isString(Z.start_time)?"start_time: string expected":Z.shape_id!=null&&Z.hasOwnProperty("shape_id")&&!ne.isString(Z.shape_id)?"shape_id: string expected":null},R.fromObject=function(Z){if(Z instanceof re.transit_realtime.TripUpdate.TripProperties)return Z;var ae=new re.transit_realtime.TripUpdate.TripProperties;return Z.trip_id!=null&&(ae.trip_id=String(Z.trip_id)),Z.start_date!=null&&(ae.start_date=String(Z.start_date)),Z.start_time!=null&&(ae.start_time=String(Z.start_time)),Z.shape_id!=null&&(ae.shape_id=String(Z.shape_id)),ae},R.toObject=function(Z,ae){ae||(ae={});var he={};return ae.defaults&&(he.trip_id="",he.start_date="",he.start_time="",he.shape_id=""),Z.trip_id!=null&&Z.hasOwnProperty("trip_id")&&(he.trip_id=Z.trip_id),Z.start_date!=null&&Z.hasOwnProperty("start_date")&&(he.start_date=Z.start_date),Z.start_time!=null&&Z.hasOwnProperty("start_time")&&(he.start_time=Z.start_time),Z.shape_id!=null&&Z.hasOwnProperty("shape_id")&&(he.shape_id=Z.shape_id),he},R.prototype.toJSON=function(){return this.constructor.toObject(this,Y.util.toJSONOptions)},R.getTypeUrl=function(Z){return Z===void 0&&(Z="type.googleapis.com"),Z+"/transit_realtime.TripUpdate.TripProperties"},R}(),Q}(),le.VehiclePosition=function(){function Q(R){if(this.multi_carriage_details=[],R)for(var U=Object.keys(R),Z=0;Z<U.length;++Z)R[U[Z]]!=null&&(this[U[Z]]=R[U[Z]])}return Q.prototype.trip=null,Q.prototype.vehicle=null,Q.prototype.position=null,Q.prototype.current_stop_sequence=0,Q.prototype.stop_id="",Q.prototype.current_status=2,Q.prototype.timestamp=ne.Long?ne.Long.fromBits(0,0,!0):0,Q.prototype.congestion_level=0,Q.prototype.occupancy_status=0,Q.prototype.occupancy_percentage=0,Q.prototype.multi_carriage_details=ne.emptyArray,Q.create=function(U){return new Q(U)},Q.encode=function(U,Z){if(Z||(Z=ee.create()),U.trip!=null&&Object.hasOwnProperty.call(U,"trip")&&re.transit_realtime.TripDescriptor.encode(U.trip,Z.uint32(10).fork()).ldelim(),U.position!=null&&Object.hasOwnProperty.call(U,"position")&&re.transit_realtime.Position.encode(U.position,Z.uint32(18).fork()).ldelim(),U.current_stop_sequence!=null&&Object.hasOwnProperty.call(U,"current_stop_sequence")&&Z.uint32(24).uint32(U.current_stop_sequence),U.current_status!=null&&Object.hasOwnProperty.call(U,"current_status")&&Z.uint32(32).int32(U.current_status),U.timestamp!=null&&Object.hasOwnProperty.call(U,"timestamp")&&Z.uint32(40).uint64(U.timestamp),U.congestion_level!=null&&Object.hasOwnProperty.call(U,"congestion_level")&&Z.uint32(48).int32(U.congestion_level),U.stop_id!=null&&Object.hasOwnProperty.call(U,"stop_id")&&Z.uint32(58).string(U.stop_id),U.vehicle!=null&&Object.hasOwnProperty.call(U,"vehicle")&&re.transit_realtime.VehicleDescriptor.encode(U.vehicle,Z.uint32(66).fork()).ldelim(),U.occupancy_status!=null&&Object.hasOwnProperty.call(U,"occupancy_status")&&Z.uint32(72).int32(U.occupancy_status),U.occupancy_percentage!=null&&Object.hasOwnProperty.call(U,"occupancy_percentage")&&Z.uint32(80).uint32(U.occupancy_percentage),U.multi_carriage_details!=null&&U.multi_carriage_details.length)for(var ae=0;ae<U.multi_carriage_details.length;++ae)re.transit_realtime.VehiclePosition.CarriageDetails.encode(U.multi_carriage_details[ae],Z.uint32(90).fork()).ldelim();return Z},Q.encodeDelimited=function(U,Z){return this.encode(U,Z).ldelim()},Q.decode=function(U,Z){U instanceof K||(U=K.create(U));for(var ae=Z===void 0?U.len:U.pos+Z,he=new re.transit_realtime.VehiclePosition;U.pos<ae;){var pe=U.uint32();switch(pe>>>3){case 1:{he.trip=re.transit_realtime.TripDescriptor.decode(U,U.uint32());break}case 8:{he.vehicle=re.transit_realtime.VehicleDescriptor.decode(U,U.uint32());break}case 2:{he.position=re.transit_realtime.Position.decode(U,U.uint32());break}case 3:{he.current_stop_sequence=U.uint32();break}case 7:{he.stop_id=U.string();break}case 4:{he.current_status=U.int32();break}case 5:{he.timestamp=U.uint64();break}case 6:{he.congestion_level=U.int32();break}case 9:{he.occupancy_status=U.int32();break}case 10:{he.occupancy_percentage=U.uint32();break}case 11:{he.multi_carriage_details&&he.multi_carriage_details.length||(he.multi_carriage_details=[]),he.multi_carriage_details.push(re.transit_realtime.VehiclePosition.CarriageDetails.decode(U,U.uint32()));break}default:U.skipType(pe&7);break}}return he},Q.decodeDelimited=function(U){return U instanceof K||(U=new K(U)),this.decode(U,U.uint32())},Q.verify=function(U){if(typeof U!="object"||U===null)return"object expected";if(U.trip!=null&&U.hasOwnProperty("trip")){var Z=re.transit_realtime.TripDescriptor.verify(U.trip);if(Z)return"trip."+Z}if(U.vehicle!=null&&U.hasOwnProperty("vehicle")){var Z=re.transit_realtime.VehicleDescriptor.verify(U.vehicle);if(Z)return"vehicle."+Z}if(U.position!=null&&U.hasOwnProperty("position")){var Z=re.transit_realtime.Position.verify(U.position);if(Z)return"position."+Z}if(U.current_stop_sequence!=null&&U.hasOwnProperty("current_stop_sequence")&&!ne.isInteger(U.current_stop_sequence))return"current_stop_sequence: integer expected";if(U.stop_id!=null&&U.hasOwnProperty("stop_id")&&!ne.isString(U.stop_id))return"stop_id: string expected";if(U.current_status!=null&&U.hasOwnProperty("current_status"))switch(U.current_status){default:return"current_status: enum value expected";case 0:case 1:case 2:break}if(U.timestamp!=null&&U.hasOwnProperty("timestamp")&&!ne.isInteger(U.timestamp)&&!(U.timestamp&&ne.isInteger(U.timestamp.low)&&ne.isInteger(U.timestamp.high)))return"timestamp: integer|Long expected";if(U.congestion_level!=null&&U.hasOwnProperty("congestion_level"))switch(U.congestion_level){default:return"congestion_level: enum value expected";case 0:case 1:case 2:case 3:case 4:break}if(U.occupancy_status!=null&&U.hasOwnProperty("occupancy_status"))switch(U.occupancy_status){default:return"occupancy_status: enum value expected";case 0:case 1:case 2:case 3:case 4:case 5:case 6:case 7:case 8:break}if(U.occupancy_percentage!=null&&U.hasOwnProperty("occupancy_percentage")&&!ne.isInteger(U.occupancy_percentage))return"occupancy_percentage: integer expected";if(U.multi_carriage_details!=null&&U.hasOwnProperty("multi_carriage_details")){if(!Array.isArray(U.multi_carriage_details))return"multi_carriage_details: array expected";for(var ae=0;ae<U.multi_carriage_details.length;++ae){var Z=re.transit_realtime.VehiclePosition.CarriageDetails.verify(U.multi_carriage_details[ae]);if(Z)return"multi_carriage_details."+Z}}return null},Q.fromObject=function(U){if(U instanceof re.transit_realtime.VehiclePosition)return U;var Z=new re.transit_realtime.VehiclePosition;if(U.trip!=null){if(typeof U.trip!="object")throw TypeError(".transit_realtime.VehiclePosition.trip: object expected");Z.trip=re.transit_realtime.TripDescriptor.fromObject(U.trip)}if(U.vehicle!=null){if(typeof U.vehicle!="object")throw TypeError(".transit_realtime.VehiclePosition.vehicle: object expected");Z.vehicle=re.transit_realtime.VehicleDescriptor.fromObject(U.vehicle)}if(U.position!=null){if(typeof U.position!="object")throw TypeError(".transit_realtime.VehiclePosition.position: object expected");Z.position=re.transit_realtime.Position.fromObject(U.position)}switch(U.current_stop_sequence!=null&&(Z.current_stop_sequence=U.current_stop_sequence>>>0),U.stop_id!=null&&(Z.stop_id=String(U.stop_id)),U.current_status){case"INCOMING_AT":case 0:Z.current_status=0;break;case"STOPPED_AT":case 1:Z.current_status=1;break;default:if(typeof U.current_status=="number"){Z.current_status=U.current_status;break}break;case"IN_TRANSIT_TO":case 2:Z.current_status=2;break}switch(U.timestamp!=null&&(ne.Long?(Z.timestamp=ne.Long.fromValue(U.timestamp)).unsigned=!0:typeof U.timestamp=="string"?Z.timestamp=parseInt(U.timestamp,10):typeof U.timestamp=="number"?Z.timestamp=U.timestamp:typeof U.timestamp=="object"&&(Z.timestamp=new ne.LongBits(U.timestamp.low>>>0,U.timestamp.high>>>0).toNumber(!0))),U.congestion_level){default:if(typeof U.congestion_level=="number"){Z.congestion_level=U.congestion_level;break}break;case"UNKNOWN_CONGESTION_LEVEL":case 0:Z.congestion_level=0;break;case"RUNNING_SMOOTHLY":case 1:Z.congestion_level=1;break;case"STOP_AND_GO":case 2:Z.congestion_level=2;break;case"CONGESTION":case 3:Z.congestion_level=3;break;case"SEVERE_CONGESTION":case 4:Z.congestion_level=4;break}switch(U.occupancy_status){default:if(typeof U.occupancy_status=="number"){Z.occupancy_status=U.occupancy_status;break}break;case"EMPTY":case 0:Z.occupancy_status=0;break;case"MANY_SEATS_AVAILABLE":case 1:Z.occupancy_status=1;break;case"FEW_SEATS_AVAILABLE":case 2:Z.occupancy_status=2;break;case"STANDING_ROOM_ONLY":case 3:Z.occupancy_status=3;break;case"CRUSHED_STANDING_ROOM_ONLY":case 4:Z.occupancy_status=4;break;case"FULL":case 5:Z.occupancy_status=5;break;case"NOT_ACCEPTING_PASSENGERS":case 6:Z.occupancy_status=6;break;case"NO_DATA_AVAILABLE":case 7:Z.occupancy_status=7;break;case"NOT_BOARDABLE":case 8:Z.occupancy_status=8;break}if(U.occupancy_percentage!=null&&(Z.occupancy_percentage=U.occupancy_percentage>>>0),U.multi_carriage_details){if(!Array.isArray(U.multi_carriage_details))throw TypeError(".transit_realtime.VehiclePosition.multi_carriage_details: array expected");Z.multi_carriage_details=[];for(var ae=0;ae<U.multi_carriage_details.length;++ae){if(typeof U.multi_carriage_details[ae]!="object")throw TypeError(".transit_realtime.VehiclePosition.multi_carriage_details: object expected");Z.multi_carriage_details[ae]=re.transit_realtime.VehiclePosition.CarriageDetails.fromObject(U.multi_carriage_details[ae])}}return Z},Q.toObject=function(U,Z){Z||(Z={});var ae={};if((Z.arrays||Z.defaults)&&(ae.multi_carriage_details=[]),Z.defaults){if(ae.trip=null,ae.position=null,ae.current_stop_sequence=0,ae.current_status=Z.enums===String?"IN_TRANSIT_TO":2,ne.Long){var he=new ne.Long(0,0,!0);ae.timestamp=Z.longs===String?he.toString():Z.longs===Number?he.toNumber():he}else ae.timestamp=Z.longs===String?"0":0;ae.congestion_level=Z.enums===String?"UNKNOWN_CONGESTION_LEVEL":0,ae.stop_id="",ae.vehicle=null,ae.occupancy_status=Z.enums===String?"EMPTY":0,ae.occupancy_percentage=0}if(U.trip!=null&&U.hasOwnProperty("trip")&&(ae.trip=re.transit_realtime.TripDescriptor.toObject(U.trip,Z)),U.position!=null&&U.hasOwnProperty("position")&&(ae.position=re.transit_realtime.Position.toObject(U.position,Z)),U.current_stop_sequence!=null&&U.hasOwnProperty("current_stop_sequence")&&(ae.current_stop_sequence=U.current_stop_sequence),U.current_status!=null&&U.hasOwnProperty("current_status")&&(ae.current_status=Z.enums===String?re.transit_realtime.VehiclePosition.VehicleStopStatus[U.current_status]===void 0?U.current_status:re.transit_realtime.VehiclePosition.VehicleStopStatus[U.current_status]:U.current_status),U.timestamp!=null&&U.hasOwnProperty("timestamp")&&(typeof U.timestamp=="number"?ae.timestamp=Z.longs===String?String(U.timestamp):U.timestamp:ae.timestamp=Z.longs===String?ne.Long.prototype.toString.call(U.timestamp):Z.longs===Number?new ne.LongBits(U.timestamp.low>>>0,U.timestamp.high>>>0).toNumber(!0):U.timestamp),U.congestion_level!=null&&U.hasOwnProperty("congestion_level")&&(ae.congestion_level=Z.enums===String?re.transit_realtime.VehiclePosition.CongestionLevel[U.congestion_level]===void 0?U.congestion_level:re.transit_realtime.VehiclePosition.CongestionLevel[U.congestion_level]:U.congestion_level),U.stop_id!=null&&U.hasOwnProperty("stop_id")&&(ae.stop_id=U.stop_id),U.vehicle!=null&&U.hasOwnProperty("vehicle")&&(ae.vehicle=re.transit_realtime.VehicleDescriptor.toObject(U.vehicle,Z)),U.occupancy_status!=null&&U.hasOwnProperty("occupancy_status")&&(ae.occupancy_status=Z.enums===String?re.transit_realtime.VehiclePosition.OccupancyStatus[U.occupancy_status]===void 0?U.occupancy_status:re.transit_realtime.VehiclePosition.OccupancyStatus[U.occupancy_status]:U.occupancy_status),U.occupancy_percentage!=null&&U.hasOwnProperty("occupancy_percentage")&&(ae.occupancy_percentage=U.occupancy_percentage),U.multi_carriage_details&&U.multi_carriage_details.length){ae.multi_carriage_details=[];for(var pe=0;pe<U.multi_carriage_details.length;++pe)ae.multi_carriage_details[pe]=re.transit_realtime.VehiclePosition.CarriageDetails.toObject(U.multi_carriage_details[pe],Z)}return ae},Q.prototype.toJSON=function(){return this.constructor.toObject(this,Y.util.toJSONOptions)},Q.getTypeUrl=function(U){return U===void 0&&(U="type.googleapis.com"),U+"/transit_realtime.VehiclePosition"},Q.VehicleStopStatus=function(){var R={},U=Object.create(R);return U[R[0]="INCOMING_AT"]=0,U[R[1]="STOPPED_AT"]=1,U[R[2]="IN_TRANSIT_TO"]=2,U}(),Q.CongestionLevel=function(){var R={},U=Object.create(R);return U[R[0]="UNKNOWN_CONGESTION_LEVEL"]=0,U[R[1]="RUNNING_SMOOTHLY"]=1,U[R[2]="STOP_AND_GO"]=2,U[R[3]="CONGESTION"]=3,U[R[4]="SEVERE_CONGESTION"]=4,U}(),Q.OccupancyStatus=function(){var R={},U=Object.create(R);return U[R[0]="EMPTY"]=0,U[R[1]="MANY_SEATS_AVAILABLE"]=1,U[R[2]="FEW_SEATS_AVAILABLE"]=2,U[R[3]="STANDING_ROOM_ONLY"]=3,U[R[4]="CRUSHED_STANDING_ROOM_ONLY"]=4,U[R[5]="FULL"]=5,U[R[6]="NOT_ACCEPTING_PASSENGERS"]=6,U[R[7]="NO_DATA_AVAILABLE"]=7,U[R[8]="NOT_BOARDABLE"]=8,U}(),Q.CarriageDetails=function(){function R(U){if(U)for(var Z=Object.keys(U),ae=0;ae<Z.length;++ae)U[Z[ae]]!=null&&(this[Z[ae]]=U[Z[ae]])}return R.prototype.id="",R.prototype.label="",R.prototype.occupancy_status=7,R.prototype.occupancy_percentage=-1,R.prototype.carriage_sequence=0,R.create=function(Z){return new R(Z)},R.encode=function(Z,ae){return ae||(ae=ee.create()),Z.id!=null&&Object.hasOwnProperty.call(Z,"id")&&ae.uint32(10).string(Z.id),Z.label!=null&&Object.hasOwnProperty.call(Z,"label")&&ae.uint32(18).string(Z.label),Z.occupancy_status!=null&&Object.hasOwnProperty.call(Z,"occupancy_status")&&ae.uint32(24).int32(Z.occupancy_status),Z.occupancy_percentage!=null&&Object.hasOwnProperty.call(Z,"occupancy_percentage")&&ae.uint32(32).int32(Z.occupancy_percentage),Z.carriage_sequence!=null&&Object.hasOwnProperty.call(Z,"carriage_sequence")&&ae.uint32(40).uint32(Z.carriage_sequence),ae},R.encodeDelimited=function(Z,ae){return this.encode(Z,ae).ldelim()},R.decode=function(Z,ae){Z instanceof K||(Z=K.create(Z));for(var he=ae===void 0?Z.len:Z.pos+ae,pe=new re.transit_realtime.VehiclePosition.CarriageDetails;Z.pos<he;){var me=Z.uint32();switch(me>>>3){case 1:{pe.id=Z.string();break}case 2:{pe.label=Z.string();break}case 3:{pe.occupancy_status=Z.int32();break}case 4:{pe.occupancy_percentage=Z.int32();break}case 5:{pe.carriage_sequence=Z.uint32();break}default:Z.skipType(me&7);break}}return pe},R.decodeDelimited=function(Z){return Z instanceof K||(Z=new K(Z)),this.decode(Z,Z.uint32())},R.verify=function(Z){if(typeof Z!="object"||Z===null)return"object expected";if(Z.id!=null&&Z.hasOwnProperty("id")&&!ne.isString(Z.id))return"id: string expected";if(Z.label!=null&&Z.hasOwnProperty("label")&&!ne.isString(Z.label))return"label: string expected";if(Z.occupancy_status!=null&&Z.hasOwnProperty("occupancy_status"))switch(Z.occupancy_status){default:return"occupancy_status: enum value expected";case 0:case 1:case 2:case 3:case 4:case 5:case 6:case 7:case 8:break}return Z.occupancy_percentage!=null&&Z.hasOwnProperty("occupancy_percentage")&&!ne.isInteger(Z.occupancy_percentage)?"occupancy_percentage: integer expected":Z.carriage_sequence!=null&&Z.hasOwnProperty("carriage_sequence")&&!ne.isInteger(Z.carriage_sequence)?"carriage_sequence: integer expected":null},R.fromObject=function(Z){if(Z instanceof re.transit_realtime.VehiclePosition.CarriageDetails)return Z;var ae=new re.transit_realtime.VehiclePosition.CarriageDetails;switch(Z.id!=null&&(ae.id=String(Z.id)),Z.label!=null&&(ae.label=String(Z.label)),Z.occupancy_status){case"EMPTY":case 0:ae.occupancy_status=0;break;case"MANY_SEATS_AVAILABLE":case 1:ae.occupancy_status=1;break;case"FEW_SEATS_AVAILABLE":case 2:ae.occupancy_status=2;break;case"STANDING_ROOM_ONLY":case 3:ae.occupancy_status=3;break;case"CRUSHED_STANDING_ROOM_ONLY":case 4:ae.occupancy_status=4;break;case"FULL":case 5:ae.occupancy_status=5;break;case"NOT_ACCEPTING_PASSENGERS":case 6:ae.occupancy_status=6;break;default:if(typeof Z.occupancy_status=="number"){ae.occupancy_status=Z.occupancy_status;break}break;case"NO_DATA_AVAILABLE":case 7:ae.occupancy_status=7;break;case"NOT_BOARDABLE":case 8:ae.occupancy_status=8;break}return Z.occupancy_percentage!=null&&(ae.occupancy_percentage=Z.occupancy_percentage|0),Z.carriage_sequence!=null&&(ae.carriage_sequence=Z.carriage_sequence>>>0),ae},R.toObject=function(Z,ae){ae||(ae={});var he={};return ae.defaults&&(he.id="",he.label="",he.occupancy_status=ae.enums===String?"NO_DATA_AVAILABLE":7,he.occupancy_percentage=-1,he.carriage_sequence=0),Z.id!=null&&Z.hasOwnProperty("id")&&(he.id=Z.id),Z.label!=null&&Z.hasOwnProperty("label")&&(he.label=Z.label),Z.occupancy_status!=null&&Z.hasOwnProperty("occupancy_status")&&(he.occupancy_status=ae.enums===String?re.transit_realtime.VehiclePosition.OccupancyStatus[Z.occupancy_status]===void 0?Z.occupancy_status:re.transit_realtime.VehiclePosition.OccupancyStatus[Z.occupancy_status]:Z.occupancy_status),Z.occupancy_percentage!=null&&Z.hasOwnProperty("occupancy_percentage")&&(he.occupancy_percentage=Z.occupancy_percentage),Z.carriage_sequence!=null&&Z.hasOwnProperty("carriage_sequence")&&(he.carriage_sequence=Z.carriage_sequence),he},R.prototype.toJSON=function(){return this.constructor.toObject(this,Y.util.toJSONOptions)},R.getTypeUrl=function(Z){return Z===void 0&&(Z="type.googleapis.com"),Z+"/transit_realtime.VehiclePosition.CarriageDetails"},R}(),Q}(),le.Alert=function(){function Q(R){if(this.active_period=[],this.informed_entity=[],R)for(var U=Object.keys(R),Z=0;Z<U.length;++Z)R[U[Z]]!=null&&(this[U[Z]]=R[U[Z]])}return Q.prototype.active_period=ne.emptyArray,Q.prototype.informed_entity=ne.emptyArray,Q.prototype.cause=1,Q.prototype.effect=8,Q.prototype.url=null,Q.prototype.header_text=null,Q.prototype.description_text=null,Q.prototype.tts_header_text=null,Q.prototype.tts_description_text=null,Q.prototype.severity_level=1,Q.prototype.image=null,Q.prototype.image_alternative_text=null,Q.prototype.cause_detail=null,Q.prototype.effect_detail=null,Q.create=function(U){return new Q(U)},Q.encode=function(U,Z){if(Z||(Z=ee.create()),U.active_period!=null&&U.active_period.length)for(var ae=0;ae<U.active_period.length;++ae)re.transit_realtime.TimeRange.encode(U.active_period[ae],Z.uint32(10).fork()).ldelim();if(U.informed_entity!=null&&U.informed_entity.length)for(var ae=0;ae<U.informed_entity.length;++ae)re.transit_realtime.EntitySelector.encode(U.informed_entity[ae],Z.uint32(42).fork()).ldelim();return U.cause!=null&&Object.hasOwnProperty.call(U,"cause")&&Z.uint32(48).int32(U.cause),U.effect!=null&&Object.hasOwnProperty.call(U,"effect")&&Z.uint32(56).int32(U.effect),U.url!=null&&Object.hasOwnProperty.call(U,"url")&&re.transit_realtime.TranslatedString.encode(U.url,Z.uint32(66).fork()).ldelim(),U.header_text!=null&&Object.hasOwnProperty.call(U,"header_text")&&re.transit_realtime.TranslatedString.encode(U.header_text,Z.uint32(82).fork()).ldelim(),U.description_text!=null&&Object.hasOwnProperty.call(U,"description_text")&&re.transit_realtime.TranslatedString.encode(U.description_text,Z.uint32(90).fork()).ldelim(),U.tts_header_text!=null&&Object.hasOwnProperty.call(U,"tts_header_text")&&re.transit_realtime.TranslatedString.encode(U.tts_header_text,Z.uint32(98).fork()).ldelim(),U.tts_description_text!=null&&Object.hasOwnProperty.call(U,"tts_description_text")&&re.transit_realtime.TranslatedString.encode(U.tts_description_text,Z.uint32(106).fork()).ldelim(),U.severity_level!=null&&Object.hasOwnProperty.call(U,"severity_level")&&Z.uint32(112).int32(U.severity_level),U.image!=null&&Object.hasOwnProperty.call(U,"image")&&re.transit_realtime.TranslatedImage.encode(U.image,Z.uint32(122).fork()).ldelim(),U.image_alternative_text!=null&&Object.hasOwnProperty.call(U,"image_alternative_text")&&re.transit_realtime.TranslatedString.encode(U.image_alternative_text,Z.uint32(130).fork()).ldelim(),U.cause_detail!=null&&Object.hasOwnProperty.call(U,"cause_detail")&&re.transit_realtime.TranslatedString.encode(U.cause_detail,Z.uint32(138).fork()).ldelim(),U.effect_detail!=null&&Object.hasOwnProperty.call(U,"effect_detail")&&re.transit_realtime.TranslatedString.encode(U.effect_detail,Z.uint32(146).fork()).ldelim(),Z},Q.encodeDelimited=function(U,Z){return this.encode(U,Z).ldelim()},Q.decode=function(U,Z){U instanceof K||(U=K.create(U));for(var ae=Z===void 0?U.len:U.pos+Z,he=new re.transit_realtime.Alert;U.pos<ae;){var pe=U.uint32();switch(pe>>>3){case 1:{he.active_period&&he.active_period.length||(he.active_period=[]),he.active_period.push(re.transit_realtime.TimeRange.decode(U,U.uint32()));break}case 5:{he.informed_entity&&he.informed_entity.length||(he.informed_entity=[]),he.informed_entity.push(re.transit_realtime.EntitySelector.decode(U,U.uint32()));break}case 6:{he.cause=U.int32();break}case 7:{he.effect=U.int32();break}case 8:{he.url=re.transit_realtime.TranslatedString.decode(U,U.uint32());break}case 10:{he.header_text=re.transit_realtime.TranslatedString.decode(U,U.uint32());break}case 11:{he.description_text=re.transit_realtime.TranslatedString.decode(U,U.uint32());break}case 12:{he.tts_header_text=re.transit_realtime.TranslatedString.decode(U,U.uint32());break}case 13:{he.tts_description_text=re.transit_realtime.TranslatedString.decode(U,U.uint32());break}case 14:{he.severity_level=U.int32();break}case 15:{he.image=re.transit_realtime.TranslatedImage.decode(U,U.uint32());break}case 16:{he.image_alternative_text=re.transit_realtime.TranslatedString.decode(U,U.uint32());break}case 17:{he.cause_detail=re.transit_realtime.TranslatedString.decode(U,U.uint32());break}case 18:{he.effect_detail=re.transit_realtime.TranslatedString.decode(U,U.uint32());break}default:U.skipType(pe&7);break}}return he},Q.decodeDelimited=function(U){return U instanceof K||(U=new K(U)),this.decode(U,U.uint32())},Q.verify=function(U){if(typeof U!="object"||U===null)return"object expected";if(U.active_period!=null&&U.hasOwnProperty("active_period")){if(!Array.isArray(U.active_period))return"active_period: array expected";for(var Z=0;Z<U.active_period.length;++Z){var ae=re.transit_realtime.TimeRange.verify(U.active_period[Z]);if(ae)return"active_period."+ae}}if(U.informed_entity!=null&&U.hasOwnProperty("informed_entity")){if(!Array.isArray(U.informed_entity))return"informed_entity: array expected";for(var Z=0;Z<U.informed_entity.length;++Z){var ae=re.transit_realtime.EntitySelector.verify(U.informed_entity[Z]);if(ae)return"informed_entity."+ae}}if(U.cause!=null&&U.hasOwnProperty("cause"))switch(U.cause){default:return"cause: enum value expected";case 1:case 2:case 3:case 4:case 5:case 6:case 7:case 8:case 9:case 10:case 11:case 12:break}if(U.effect!=null&&U.hasOwnProperty("effect"))switch(U.effect){default:return"effect: enum value expected";case 1:case 2:case 3:case 4:case 5:case 6:case 7:case 8:case 9:case 10:case 11:break}if(U.url!=null&&U.hasOwnProperty("url")){var ae=re.transit_realtime.TranslatedString.verify(U.url);if(ae)return"url."+ae}if(U.header_text!=null&&U.hasOwnProperty("header_text")){var ae=re.transit_realtime.TranslatedString.verify(U.header_text);if(ae)return"header_text."+ae}if(U.description_text!=null&&U.hasOwnProperty("description_text")){var ae=re.transit_realtime.TranslatedString.verify(U.description_text);if(ae)return"description_text."+ae}if(U.tts_header_text!=null&&U.hasOwnProperty("tts_header_text")){var ae=re.transit_realtime.TranslatedString.verify(U.tts_header_text);if(ae)return"tts_header_text."+ae}if(U.tts_description_text!=null&&U.hasOwnProperty("tts_description_text")){var ae=re.transit_realtime.TranslatedString.verify(U.tts_description_text);if(ae)return"tts_description_text."+ae}if(U.severity_level!=null&&U.hasOwnProperty("severity_level"))switch(U.severity_level){default:return"severity_level: enum value expected";case 1:case 2:case 3:case 4:break}if(U.image!=null&&U.hasOwnProperty("image")){var ae=re.transit_realtime.TranslatedImage.verify(U.image);if(ae)return"image."+ae}if(U.image_alternative_text!=null&&U.hasOwnProperty("image_alternative_text")){var ae=re.transit_realtime.TranslatedString.verify(U.image_alternative_text);if(ae)return"image_alternative_text."+ae}if(U.cause_detail!=null&&U.hasOwnProperty("cause_detail")){var ae=re.transit_realtime.TranslatedString.verify(U.cause_detail);if(ae)return"cause_detail."+ae}if(U.effect_detail!=null&&U.hasOwnProperty("effect_detail")){var ae=re.transit_realtime.TranslatedString.verify(U.effect_detail);if(ae)return"effect_detail."+ae}return null},Q.fromObject=function(U){if(U instanceof re.transit_realtime.Alert)return U;var Z=new re.transit_realtime.Alert;if(U.active_period){if(!Array.isArray(U.active_period))throw TypeError(".transit_realtime.Alert.active_period: array expected");Z.active_period=[];for(var ae=0;ae<U.active_period.length;++ae){if(typeof U.active_period[ae]!="object")throw TypeError(".transit_realtime.Alert.active_period: object expected");Z.active_period[ae]=re.transit_realtime.TimeRange.fromObject(U.active_period[ae])}}if(U.informed_entity){if(!Array.isArray(U.informed_entity))throw TypeError(".transit_realtime.Alert.informed_entity: array expected");Z.informed_entity=[];for(var ae=0;ae<U.informed_entity.length;++ae){if(typeof U.informed_entity[ae]!="object")throw TypeError(".transit_realtime.Alert.informed_entity: object expected");Z.informed_entity[ae]=re.transit_realtime.EntitySelector.fromObject(U.informed_entity[ae])}}switch(U.cause){default:if(typeof U.cause=="number"){Z.cause=U.cause;break}break;case"UNKNOWN_CAUSE":case 1:Z.cause=1;break;case"OTHER_CAUSE":case 2:Z.cause=2;break;case"TECHNICAL_PROBLEM":case 3:Z.cause=3;break;case"STRIKE":case 4:Z.cause=4;break;case"DEMONSTRATION":case 5:Z.cause=5;break;case"ACCIDENT":case 6:Z.cause=6;break;case"HOLIDAY":case 7:Z.cause=7;break;case"WEATHER":case 8:Z.cause=8;break;case"MAINTENANCE":case 9:Z.cause=9;break;case"CONSTRUCTION":case 10:Z.cause=10;break;case"POLICE_ACTIVITY":case 11:Z.cause=11;break;case"MEDICAL_EMERGENCY":case 12:Z.cause=12;break}switch(U.effect){case"NO_SERVICE":case 1:Z.effect=1;break;case"REDUCED_SERVICE":case 2:Z.effect=2;break;case"SIGNIFICANT_DELAYS":case 3:Z.effect=3;break;case"DETOUR":case 4:Z.effect=4;break;case"ADDITIONAL_SERVICE":case 5:Z.effect=5;break;case"MODIFIED_SERVICE":case 6:Z.effect=6;break;case"OTHER_EFFECT":case 7:Z.effect=7;break;default:if(typeof U.effect=="number"){Z.effect=U.effect;break}break;case"UNKNOWN_EFFECT":case 8:Z.effect=8;break;case"STOP_MOVED":case 9:Z.effect=9;break;case"NO_EFFECT":case 10:Z.effect=10;break;case"ACCESSIBILITY_ISSUE":case 11:Z.effect=11;break}if(U.url!=null){if(typeof U.url!="object")throw TypeError(".transit_realtime.Alert.url: object expected");Z.url=re.transit_realtime.TranslatedString.fromObject(U.url)}if(U.header_text!=null){if(typeof U.header_text!="object")throw TypeError(".transit_realtime.Alert.header_text: object expected");Z.header_text=re.transit_realtime.TranslatedString.fromObject(U.header_text)}if(U.description_text!=null){if(typeof U.description_text!="object")throw TypeError(".transit_realtime.Alert.description_text: object expected");Z.description_text=re.transit_realtime.TranslatedString.fromObject(U.description_text)}if(U.tts_header_text!=null){if(typeof U.tts_header_text!="object")throw TypeError(".transit_realtime.Alert.tts_header_text: object expected");Z.tts_header_text=re.transit_realtime.TranslatedString.fromObject(U.tts_header_text)}if(U.tts_description_text!=null){if(typeof U.tts_description_text!="object")throw TypeError(".transit_realtime.Alert.tts_description_text: object expected");Z.tts_description_text=re.transit_realtime.TranslatedString.fromObject(U.tts_description_text)}switch(U.severity_level){default:if(typeof U.severity_level=="number"){Z.severity_level=U.severity_level;break}break;case"UNKNOWN_SEVERITY":case 1:Z.severity_level=1;break;case"INFO":case 2:Z.severity_level=2;break;case"WARNING":case 3:Z.severity_level=3;break;case"SEVERE":case 4:Z.severity_level=4;break}if(U.image!=null){if(typeof U.image!="object")throw TypeError(".transit_realtime.Alert.image: object expected");Z.image=re.transit_realtime.TranslatedImage.fromObject(U.image)}if(U.image_alternative_text!=null){if(typeof U.image_alternative_text!="object")throw TypeError(".transit_realtime.Alert.image_alternative_text: object expected");Z.image_alternative_text=re.transit_realtime.TranslatedString.fromObject(U.image_alternative_text)}if(U.cause_detail!=null){if(typeof U.cause_detail!="object")throw TypeError(".transit_realtime.Alert.cause_detail: object expected");Z.cause_detail=re.transit_realtime.TranslatedString.fromObject(U.cause_detail)}if(U.effect_detail!=null){if(typeof U.effect_detail!="object")throw TypeError(".transit_realtime.Alert.effect_detail: object expected");Z.effect_detail=re.transit_realtime.TranslatedString.fromObject(U.effect_detail)}return Z},Q.toObject=function(U,Z){Z||(Z={});var ae={};if((Z.arrays||Z.defaults)&&(ae.active_period=[],ae.informed_entity=[]),Z.defaults&&(ae.cause=Z.enums===String?"UNKNOWN_CAUSE":1,ae.effect=Z.enums===String?"UNKNOWN_EFFECT":8,ae.url=null,ae.header_text=null,ae.description_text=null,ae.tts_header_text=null,ae.tts_description_text=null,ae.severity_level=Z.enums===String?"UNKNOWN_SEVERITY":1,ae.image=null,ae.image_alternative_text=null,ae.cause_detail=null,ae.effect_detail=null),U.active_period&&U.active_period.length){ae.active_period=[];for(var he=0;he<U.active_period.length;++he)ae.active_period[he]=re.transit_realtime.TimeRange.toObject(U.active_period[he],Z)}if(U.informed_entity&&U.informed_entity.length){ae.informed_entity=[];for(var he=0;he<U.informed_entity.length;++he)ae.informed_entity[he]=re.transit_realtime.EntitySelector.toObject(U.informed_entity[he],Z)}return U.cause!=null&&U.hasOwnProperty("cause")&&(ae.cause=Z.enums===String?re.transit_realtime.Alert.Cause[U.cause]===void 0?U.cause:re.transit_realtime.Alert.Cause[U.cause]:U.cause),U.effect!=null&&U.hasOwnProperty("effect")&&(ae.effect=Z.enums===String?re.transit_realtime.Alert.Effect[U.effect]===void 0?U.effect:re.transit_realtime.Alert.Effect[U.effect]:U.effect),U.url!=null&&U.hasOwnProperty("url")&&(ae.url=re.transit_realtime.TranslatedString.toObject(U.url,Z)),U.header_text!=null&&U.hasOwnProperty("header_text")&&(ae.header_text=re.transit_realtime.TranslatedString.toObject(U.header_text,Z)),U.description_text!=null&&U.hasOwnProperty("description_text")&&(ae.description_text=re.transit_realtime.TranslatedString.toObject(U.description_text,Z)),U.tts_header_text!=null&&U.hasOwnProperty("tts_header_text")&&(ae.tts_header_text=re.transit_realtime.TranslatedString.toObject(U.tts_header_text,Z)),U.tts_description_text!=null&&U.hasOwnProperty("tts_description_text")&&(ae.tts_description_text=re.transit_realtime.TranslatedString.toObject(U.tts_description_text,Z)),U.severity_level!=null&&U.hasOwnProperty("severity_level")&&(ae.severity_level=Z.enums===String?re.transit_realtime.Alert.SeverityLevel[U.severity_level]===void 0?U.severity_level:re.transit_realtime.Alert.SeverityLevel[U.severity_level]:U.severity_level),U.image!=null&&U.hasOwnProperty("image")&&(ae.image=re.transit_realtime.TranslatedImage.toObject(U.image,Z)),U.image_alternative_text!=null&&U.hasOwnProperty("image_alternative_text")&&(ae.image_alternative_text=re.transit_realtime.TranslatedString.toObject(U.image_alternative_text,Z)),U.cause_detail!=null&&U.hasOwnProperty("cause_detail")&&(ae.cause_detail=re.transit_realtime.TranslatedString.toObject(U.cause_detail,Z)),U.effect_detail!=null&&U.hasOwnProperty("effect_detail")&&(ae.effect_detail=re.transit_realtime.TranslatedString.toObject(U.effect_detail,Z)),ae},Q.prototype.toJSON=function(){return this.constructor.toObject(this,Y.util.toJSONOptions)},Q.getTypeUrl=function(U){return U===void 0&&(U="type.googleapis.com"),U+"/transit_realtime.Alert"},Q.Cause=function(){var R={},U=Object.create(R);return U[R[1]="UNKNOWN_CAUSE"]=1,U[R[2]="OTHER_CAUSE"]=2,U[R[3]="TECHNICAL_PROBLEM"]=3,U[R[4]="STRIKE"]=4,U[R[5]="DEMONSTRATION"]=5,U[R[6]="ACCIDENT"]=6,U[R[7]="HOLIDAY"]=7,U[R[8]="WEATHER"]=8,U[R[9]="MAINTENANCE"]=9,U[R[10]="CONSTRUCTION"]=10,U[R[11]="POLICE_ACTIVITY"]=11,U[R[12]="MEDICAL_EMERGENCY"]=12,U}(),Q.Effect=function(){var R={},U=Object.create(R);return U[R[1]="NO_SERVICE"]=1,U[R[2]="REDUCED_SERVICE"]=2,U[R[3]="SIGNIFICANT_DELAYS"]=3,U[R[4]="DETOUR"]=4,U[R[5]="ADDITIONAL_SERVICE"]=5,U[R[6]="MODIFIED_SERVICE"]=6,U[R[7]="OTHER_EFFECT"]=7,U[R[8]="UNKNOWN_EFFECT"]=8,U[R[9]="STOP_MOVED"]=9,U[R[10]="NO_EFFECT"]=10,U[R[11]="ACCESSIBILITY_ISSUE"]=11,U}(),Q.SeverityLevel=function(){var R={},U=Object.create(R);return U[R[1]="UNKNOWN_SEVERITY"]=1,U[R[2]="INFO"]=2,U[R[3]="WARNING"]=3,U[R[4]="SEVERE"]=4,U}(),Q}(),le.TimeRange=function(){function Q(R){if(R)for(var U=Object.keys(R),Z=0;Z<U.length;++Z)R[U[Z]]!=null&&(this[U[Z]]=R[U[Z]])}return Q.prototype.start=ne.Long?ne.Long.fromBits(0,0,!0):0,Q.prototype.end=ne.Long?ne.Long.fromBits(0,0,!0):0,Q.create=function(U){return new Q(U)},Q.encode=function(U,Z){return Z||(Z=ee.create()),U.start!=null&&Object.hasOwnProperty.call(U,"start")&&Z.uint32(8).uint64(U.start),U.end!=null&&Object.hasOwnProperty.call(U,"end")&&Z.uint32(16).uint64(U.end),Z},Q.encodeDelimited=function(U,Z){return this.encode(U,Z).ldelim()},Q.decode=function(U,Z){U instanceof K||(U=K.create(U));for(var ae=Z===void 0?U.len:U.pos+Z,he=new re.transit_realtime.TimeRange;U.pos<ae;){var pe=U.uint32();switch(pe>>>3){case 1:{he.start=U.uint64();break}case 2:{he.end=U.uint64();break}default:U.skipType(pe&7);break}}return he},Q.decodeDelimited=function(U){return U instanceof K||(U=new K(U)),this.decode(U,U.uint32())},Q.verify=function(U){return typeof U!="object"||U===null?"object expected":U.start!=null&&U.hasOwnProperty("start")&&!ne.isInteger(U.start)&&!(U.start&&ne.isInteger(U.start.low)&&ne.isInteger(U.start.high))?"start: integer|Long expected":U.end!=null&&U.hasOwnProperty("end")&&!ne.isInteger(U.end)&&!(U.end&&ne.isInteger(U.end.low)&&ne.isInteger(U.end.high))?"end: integer|Long expected":null},Q.fromObject=function(U){if(U instanceof re.transit_realtime.TimeRange)return U;var Z=new re.transit_realtime.TimeRange;return U.start!=null&&(ne.Long?(Z.start=ne.Long.fromValue(U.start)).unsigned=!0:typeof U.start=="string"?Z.start=parseInt(U.start,10):typeof U.start=="number"?Z.start=U.start:typeof U.start=="object"&&(Z.start=new ne.LongBits(U.start.low>>>0,U.start.high>>>0).toNumber(!0))),U.end!=null&&(ne.Long?(Z.end=ne.Long.fromValue(U.end)).unsigned=!0:typeof U.end=="string"?Z.end=parseInt(U.end,10):typeof U.end=="number"?Z.end=U.end:typeof U.end=="object"&&(Z.end=new ne.LongBits(U.end.low>>>0,U.end.high>>>0).toNumber(!0))),Z},Q.toObject=function(U,Z){Z||(Z={});var ae={};if(Z.defaults){if(ne.Long){var he=new ne.Long(0,0,!0);ae.start=Z.longs===String?he.toString():Z.longs===Number?he.toNumber():he}else ae.start=Z.longs===String?"0":0;if(ne.Long){var he=new ne.Long(0,0,!0);ae.end=Z.longs===String?he.toString():Z.longs===Number?he.toNumber():he}else ae.end=Z.longs===String?"0":0}return U.start!=null&&U.hasOwnProperty("start")&&(typeof U.start=="number"?ae.start=Z.longs===String?String(U.start):U.start:ae.start=Z.longs===String?ne.Long.prototype.toString.call(U.start):Z.longs===Number?new ne.LongBits(U.start.low>>>0,U.start.high>>>0).toNumber(!0):U.start),U.end!=null&&U.hasOwnProperty("end")&&(typeof U.end=="number"?ae.end=Z.longs===String?String(U.end):U.end:ae.end=Z.longs===String?ne.Long.prototype.toString.call(U.end):Z.longs===Number?new ne.LongBits(U.end.low>>>0,U.end.high>>>0).toNumber(!0):U.end),ae},Q.prototype.toJSON=function(){return this.constructor.toObject(this,Y.util.toJSONOptions)},Q.getTypeUrl=function(U){return U===void 0&&(U="type.googleapis.com"),U+"/transit_realtime.TimeRange"},Q}(),le.Position=function(){function Q(R){if(R)for(var U=Object.keys(R),Z=0;Z<U.length;++Z)R[U[Z]]!=null&&(this[U[Z]]=R[U[Z]])}return Q.prototype.latitude=0,Q.prototype.longitude=0,Q.prototype.bearing=0,Q.prototype.odometer=0,Q.prototype.speed=0,Q.create=function(U){return new Q(U)},Q.encode=function(U,Z){return Z||(Z=ee.create()),Z.uint32(13).float(U.latitude),Z.uint32(21).float(U.longitude),U.bearing!=null&&Object.hasOwnProperty.call(U,"bearing")&&Z.uint32(29).float(U.bearing),U.odometer!=null&&Object.hasOwnProperty.call(U,"odometer")&&Z.uint32(33).double(U.odometer),U.speed!=null&&Object.hasOwnProperty.call(U,"speed")&&Z.uint32(45).float(U.speed),Z},Q.encodeDelimited=function(U,Z){return this.encode(U,Z).ldelim()},Q.decode=function(U,Z){U instanceof K||(U=K.create(U));for(var ae=Z===void 0?U.len:U.pos+Z,he=new re.transit_realtime.Position;U.pos<ae;){var pe=U.uint32();switch(pe>>>3){case 1:{he.latitude=U.float();break}case 2:{he.longitude=U.float();break}case 3:{he.bearing=U.float();break}case 4:{he.odometer=U.double();break}case 5:{he.speed=U.float();break}default:U.skipType(pe&7);break}}if(!he.hasOwnProperty("latitude"))throw ne.ProtocolError("missing required 'latitude'",{instance:he});if(!he.hasOwnProperty("longitude"))throw ne.ProtocolError("missing required 'longitude'",{instance:he});return he},Q.decodeDelimited=function(U){return U instanceof K||(U=new K(U)),this.decode(U,U.uint32())},Q.verify=function(U){return typeof U!="object"||U===null?"object expected":typeof U.latitude!="number"?"latitude: number expected":typeof U.longitude!="number"?"longitude: number expected":U.bearing!=null&&U.hasOwnProperty("bearing")&&typeof U.bearing!="number"?"bearing: number expected":U.odometer!=null&&U.hasOwnProperty("odometer")&&typeof U.odometer!="number"?"odometer: number expected":U.speed!=null&&U.hasOwnProperty("speed")&&typeof U.speed!="number"?"speed: number expected":null},Q.fromObject=function(U){if(U instanceof re.transit_realtime.Position)return U;var Z=new re.transit_realtime.Position;return U.latitude!=null&&(Z.latitude=Number(U.latitude)),U.longitude!=null&&(Z.longitude=Number(U.longitude)),U.bearing!=null&&(Z.bearing=Number(U.bearing)),U.odometer!=null&&(Z.odometer=Number(U.odometer)),U.speed!=null&&(Z.speed=Number(U.speed)),Z},Q.toObject=function(U,Z){Z||(Z={});var ae={};return Z.defaults&&(ae.latitude=0,ae.longitude=0,ae.bearing=0,ae.odometer=0,ae.speed=0),U.latitude!=null&&U.hasOwnProperty("latitude")&&(ae.latitude=Z.json&&!isFinite(U.latitude)?String(U.latitude):U.latitude),U.longitude!=null&&U.hasOwnProperty("longitude")&&(ae.longitude=Z.json&&!isFinite(U.longitude)?String(U.longitude):U.longitude),U.bearing!=null&&U.hasOwnProperty("bearing")&&(ae.bearing=Z.json&&!isFinite(U.bearing)?String(U.bearing):U.bearing),U.odometer!=null&&U.hasOwnProperty("odometer")&&(ae.odometer=Z.json&&!isFinite(U.odometer)?String(U.odometer):U.odometer),U.speed!=null&&U.hasOwnProperty("speed")&&(ae.speed=Z.json&&!isFinite(U.speed)?String(U.speed):U.speed),ae},Q.prototype.toJSON=function(){return this.constructor.toObject(this,Y.util.toJSONOptions)},Q.getTypeUrl=function(U){return U===void 0&&(U="type.googleapis.com"),U+"/transit_realtime.Position"},Q}(),le.TripDescriptor=function(){function Q(R){if(R)for(var U=Object.keys(R),Z=0;Z<U.length;++Z)R[U[Z]]!=null&&(this[U[Z]]=R[U[Z]])}return Q.prototype.trip_id="",Q.prototype.route_id="",Q.prototype.direction_id=0,Q.prototype.start_time="",Q.prototype.start_date="",Q.prototype.schedule_relationship=0,Q.prototype.modified_trip=null,Q.create=function(U){return new Q(U)},Q.encode=function(U,Z){return Z||(Z=ee.create()),U.trip_id!=null&&Object.hasOwnProperty.call(U,"trip_id")&&Z.uint32(10).string(U.trip_id),U.start_time!=null&&Object.hasOwnProperty.call(U,"start_time")&&Z.uint32(18).string(U.start_time),U.start_date!=null&&Object.hasOwnProperty.call(U,"start_date")&&Z.uint32(26).string(U.start_date),U.schedule_relationship!=null&&Object.hasOwnProperty.call(U,"schedule_relationship")&&Z.uint32(32).int32(U.schedule_relationship),U.route_id!=null&&Object.hasOwnProperty.call(U,"route_id")&&Z.uint32(42).string(U.route_id),U.direction_id!=null&&Object.hasOwnProperty.call(U,"direction_id")&&Z.uint32(48).uint32(U.direction_id),U.modified_trip!=null&&Object.hasOwnProperty.call(U,"modified_trip")&&re.transit_realtime.TripDescriptor.ModifiedTripSelector.encode(U.modified_trip,Z.uint32(58).fork()).ldelim(),Z},Q.encodeDelimited=function(U,Z){return this.encode(U,Z).ldelim()},Q.decode=function(U,Z){U instanceof K||(U=K.create(U));for(var ae=Z===void 0?U.len:U.pos+Z,he=new re.transit_realtime.TripDescriptor;U.pos<ae;){var pe=U.uint32();switch(pe>>>3){case 1:{he.trip_id=U.string();break}case 5:{he.route_id=U.string();break}case 6:{he.direction_id=U.uint32();break}case 2:{he.start_time=U.string();break}case 3:{he.start_date=U.string();break}case 4:{he.schedule_relationship=U.int32();break}case 7:{he.modified_trip=re.transit_realtime.TripDescriptor.ModifiedTripSelector.decode(U,U.uint32());break}default:U.skipType(pe&7);break}}return he},Q.decodeDelimited=function(U){return U instanceof K||(U=new K(U)),this.decode(U,U.uint32())},Q.verify=function(U){if(typeof U!="object"||U===null)return"object expected";if(U.trip_id!=null&&U.hasOwnProperty("trip_id")&&!ne.isString(U.trip_id))return"trip_id: string expected";if(U.route_id!=null&&U.hasOwnProperty("route_id")&&!ne.isString(U.route_id))return"route_id: string expected";if(U.direction_id!=null&&U.hasOwnProperty("direction_id")&&!ne.isInteger(U.direction_id))return"direction_id: integer expected";if(U.start_time!=null&&U.hasOwnProperty("start_time")&&!ne.isString(U.start_time))return"start_time: string expected";if(U.start_date!=null&&U.hasOwnProperty("start_date")&&!ne.isString(U.start_date))return"start_date: string expected";if(U.schedule_relationship!=null&&U.hasOwnProperty("schedule_relationship"))switch(U.schedule_relationship){default:return"schedule_relationship: enum value expected";case 0:case 1:case 2:case 3:case 5:case 6:case 7:break}if(U.modified_trip!=null&&U.hasOwnProperty("modified_trip")){var Z=re.transit_realtime.TripDescriptor.ModifiedTripSelector.verify(U.modified_trip);if(Z)return"modified_trip."+Z}return null},Q.fromObject=function(U){if(U instanceof re.transit_realtime.TripDescriptor)return U;var Z=new re.transit_realtime.TripDescriptor;switch(U.trip_id!=null&&(Z.trip_id=String(U.trip_id)),U.route_id!=null&&(Z.route_id=String(U.route_id)),U.direction_id!=null&&(Z.direction_id=U.direction_id>>>0),U.start_time!=null&&(Z.start_time=String(U.start_time)),U.start_date!=null&&(Z.start_date=String(U.start_date)),U.schedule_relationship){default:if(typeof U.schedule_relationship=="number"){Z.schedule_relationship=U.schedule_relationship;break}break;case"SCHEDULED":case 0:Z.schedule_relationship=0;break;case"ADDED":case 1:Z.schedule_relationship=1;break;case"UNSCHEDULED":case 2:Z.schedule_relationship=2;break;case"CANCELED":case 3:Z.schedule_relationship=3;break;case"REPLACEMENT":case 5:Z.schedule_relationship=5;break;case"DUPLICATED":case 6:Z.schedule_relationship=6;break;case"DELETED":case 7:Z.schedule_relationship=7;break}if(U.modified_trip!=null){if(typeof U.modified_trip!="object")throw TypeError(".transit_realtime.TripDescriptor.modified_trip: object expected");Z.modified_trip=re.transit_realtime.TripDescriptor.ModifiedTripSelector.fromObject(U.modified_trip)}return Z},Q.toObject=function(U,Z){Z||(Z={});var ae={};return Z.defaults&&(ae.trip_id="",ae.start_time="",ae.start_date="",ae.schedule_relationship=Z.enums===String?"SCHEDULED":0,ae.route_id="",ae.direction_id=0,ae.modified_trip=null),U.trip_id!=null&&U.hasOwnProperty("trip_id")&&(ae.trip_id=U.trip_id),U.start_time!=null&&U.hasOwnProperty("start_time")&&(ae.start_time=U.start_time),U.start_date!=null&&U.hasOwnProperty("start_date")&&(ae.start_date=U.start_date),U.schedule_relationship!=null&&U.hasOwnProperty("schedule_relationship")&&(ae.schedule_relationship=Z.enums===String?re.transit_realtime.TripDescriptor.ScheduleRelationship[U.schedule_relationship]===void 0?U.schedule_relationship:re.transit_realtime.TripDescriptor.ScheduleRelationship[U.schedule_relationship]:U.schedule_relationship),U.route_id!=null&&U.hasOwnProperty("route_id")&&(ae.route_id=U.route_id),U.direction_id!=null&&U.hasOwnProperty("direction_id")&&(ae.direction_id=U.direction_id),U.modified_trip!=null&&U.hasOwnProperty("modified_trip")&&(ae.modified_trip=re.transit_realtime.TripDescriptor.ModifiedTripSelector.toObject(U.modified_trip,Z)),ae},Q.prototype.toJSON=function(){return this.constructor.toObject(this,Y.util.toJSONOptions)},Q.getTypeUrl=function(U){return U===void 0&&(U="type.googleapis.com"),U+"/transit_realtime.TripDescriptor"},Q.ScheduleRelationship=function(){var R={},U=Object.create(R);return U[R[0]="SCHEDULED"]=0,U[R[1]="ADDED"]=1,U[R[2]="UNSCHEDULED"]=2,U[R[3]="CANCELED"]=3,U[R[5]="REPLACEMENT"]=5,U[R[6]="DUPLICATED"]=6,U[R[7]="DELETED"]=7,U}(),Q.ModifiedTripSelector=function(){function R(U){if(U)for(var Z=Object.keys(U),ae=0;ae<Z.length;++ae)U[Z[ae]]!=null&&(this[Z[ae]]=U[Z[ae]])}return R.prototype.modifications_id="",R.prototype.affected_trip_id="",R.prototype.start_time="",R.prototype.start_date="",R.create=function(Z){return new R(Z)},R.encode=function(Z,ae){return ae||(ae=ee.create()),Z.modifications_id!=null&&Object.hasOwnProperty.call(Z,"modifications_id")&&ae.uint32(10).string(Z.modifications_id),Z.affected_trip_id!=null&&Object.hasOwnProperty.call(Z,"affected_trip_id")&&ae.uint32(18).string(Z.affected_trip_id),Z.start_time!=null&&Object.hasOwnProperty.call(Z,"start_time")&&ae.uint32(26).string(Z.start_time),Z.start_date!=null&&Object.hasOwnProperty.call(Z,"start_date")&&ae.uint32(34).string(Z.start_date),ae},R.encodeDelimited=function(Z,ae){return this.encode(Z,ae).ldelim()},R.decode=function(Z,ae){Z instanceof K||(Z=K.create(Z));for(var he=ae===void 0?Z.len:Z.pos+ae,pe=new re.transit_realtime.TripDescriptor.ModifiedTripSelector;Z.pos<he;){var me=Z.uint32();switch(me>>>3){case 1:{pe.modifications_id=Z.string();break}case 2:{pe.affected_trip_id=Z.string();break}case 3:{pe.start_time=Z.string();break}case 4:{pe.start_date=Z.string();break}default:Z.skipType(me&7);break}}return pe},R.decodeDelimited=function(Z){return Z instanceof K||(Z=new K(Z)),this.decode(Z,Z.uint32())},R.verify=function(Z){return typeof Z!="object"||Z===null?"object expected":Z.modifications_id!=null&&Z.hasOwnProperty("modifications_id")&&!ne.isString(Z.modifications_id)?"modifications_id: string expected":Z.affected_trip_id!=null&&Z.hasOwnProperty("affected_trip_id")&&!ne.isString(Z.affected_trip_id)?"affected_trip_id: string expected":Z.start_time!=null&&Z.hasOwnProperty("start_time")&&!ne.isString(Z.start_time)?"start_time: string expected":Z.start_date!=null&&Z.hasOwnProperty("start_date")&&!ne.isString(Z.start_date)?"start_date: string expected":null},R.fromObject=function(Z){if(Z instanceof re.transit_realtime.TripDescriptor.ModifiedTripSelector)return Z;var ae=new re.transit_realtime.TripDescriptor.ModifiedTripSelector;return Z.modifications_id!=null&&(ae.modifications_id=String(Z.modifications_id)),Z.affected_trip_id!=null&&(ae.affected_trip_id=String(Z.affected_trip_id)),Z.start_time!=null&&(ae.start_time=String(Z.start_time)),Z.start_date!=null&&(ae.start_date=String(Z.start_date)),ae},R.toObject=function(Z,ae){ae||(ae={});var he={};return ae.defaults&&(he.modifications_id="",he.affected_trip_id="",he.start_time="",he.start_date=""),Z.modifications_id!=null&&Z.hasOwnProperty("modifications_id")&&(he.modifications_id=Z.modifications_id),Z.affected_trip_id!=null&&Z.hasOwnProperty("affected_trip_id")&&(he.affected_trip_id=Z.affected_trip_id),Z.start_time!=null&&Z.hasOwnProperty("start_time")&&(he.start_time=Z.start_time),Z.start_date!=null&&Z.hasOwnProperty("start_date")&&(he.start_date=Z.start_date),he},R.prototype.toJSON=function(){return this.constructor.toObject(this,Y.util.toJSONOptions)},R.getTypeUrl=function(Z){return Z===void 0&&(Z="type.googleapis.com"),Z+"/transit_realtime.TripDescriptor.ModifiedTripSelector"},R}(),Q}(),le.VehicleDescriptor=function(){function Q(R){if(R)for(var U=Object.keys(R),Z=0;Z<U.length;++Z)R[U[Z]]!=null&&(this[U[Z]]=R[U[Z]])}return Q.prototype.id="",Q.prototype.label="",Q.prototype.license_plate="",Q.prototype.wheelchair_accessible=0,Q.create=function(U){return new Q(U)},Q.encode=function(U,Z){return Z||(Z=ee.create()),U.id!=null&&Object.hasOwnProperty.call(U,"id")&&Z.uint32(10).string(U.id),U.label!=null&&Object.hasOwnProperty.call(U,"label")&&Z.uint32(18).string(U.label),U.license_plate!=null&&Object.hasOwnProperty.call(U,"license_plate")&&Z.uint32(26).string(U.license_plate),U.wheelchair_accessible!=null&&Object.hasOwnProperty.call(U,"wheelchair_accessible")&&Z.uint32(32).int32(U.wheelchair_accessible),Z},Q.encodeDelimited=function(U,Z){return this.encode(U,Z).ldelim()},Q.decode=function(U,Z){U instanceof K||(U=K.create(U));for(var ae=Z===void 0?U.len:U.pos+Z,he=new re.transit_realtime.VehicleDescriptor;U.pos<ae;){var pe=U.uint32();switch(pe>>>3){case 1:{he.id=U.string();break}case 2:{he.label=U.string();break}case 3:{he.license_plate=U.string();break}case 4:{he.wheelchair_accessible=U.int32();break}default:U.skipType(pe&7);break}}return he},Q.decodeDelimited=function(U){return U instanceof K||(U=new K(U)),this.decode(U,U.uint32())},Q.verify=function(U){if(typeof U!="object"||U===null)return"object expected";if(U.id!=null&&U.hasOwnProperty("id")&&!ne.isString(U.id))return"id: string expected";if(U.label!=null&&U.hasOwnProperty("label")&&!ne.isString(U.label))return"label: string expected";if(U.license_plate!=null&&U.hasOwnProperty("license_plate")&&!ne.isString(U.license_plate))return"license_plate: string expected";if(U.wheelchair_accessible!=null&&U.hasOwnProperty("wheelchair_accessible"))switch(U.wheelchair_accessible){default:return"wheelchair_accessible: enum value expected";case 0:case 1:case 2:case 3:break}return null},Q.fromObject=function(U){if(U instanceof re.transit_realtime.VehicleDescriptor)return U;var Z=new re.transit_realtime.VehicleDescriptor;switch(U.id!=null&&(Z.id=String(U.id)),U.label!=null&&(Z.label=String(U.label)),U.license_plate!=null&&(Z.license_plate=String(U.license_plate)),U.wheelchair_accessible){default:if(typeof U.wheelchair_accessible=="number"){Z.wheelchair_accessible=U.wheelchair_accessible;break}break;case"NO_VALUE":case 0:Z.wheelchair_accessible=0;break;case"UNKNOWN":case 1:Z.wheelchair_accessible=1;break;case"WHEELCHAIR_ACCESSIBLE":case 2:Z.wheelchair_accessible=2;break;case"WHEELCHAIR_INACCESSIBLE":case 3:Z.wheelchair_accessible=3;break}return Z},Q.toObject=function(U,Z){Z||(Z={});var ae={};return Z.defaults&&(ae.id="",ae.label="",ae.license_plate="",ae.wheelchair_accessible=Z.enums===String?"NO_VALUE":0),U.id!=null&&U.hasOwnProperty("id")&&(ae.id=U.id),U.label!=null&&U.hasOwnProperty("label")&&(ae.label=U.label),U.license_plate!=null&&U.hasOwnProperty("license_plate")&&(ae.license_plate=U.license_plate),U.wheelchair_accessible!=null&&U.hasOwnProperty("wheelchair_accessible")&&(ae.wheelchair_accessible=Z.enums===String?re.transit_realtime.VehicleDescriptor.WheelchairAccessible[U.wheelchair_accessible]===void 0?U.wheelchair_accessible:re.transit_realtime.VehicleDescriptor.WheelchairAccessible[U.wheelchair_accessible]:U.wheelchair_accessible),ae},Q.prototype.toJSON=function(){return this.constructor.toObject(this,Y.util.toJSONOptions)},Q.getTypeUrl=function(U){return U===void 0&&(U="type.googleapis.com"),U+"/transit_realtime.VehicleDescriptor"},Q.WheelchairAccessible=function(){var R={},U=Object.create(R);return U[R[0]="NO_VALUE"]=0,U[R[1]="UNKNOWN"]=1,U[R[2]="WHEELCHAIR_ACCESSIBLE"]=2,U[R[3]="WHEELCHAIR_INACCESSIBLE"]=3,U}(),Q}(),le.EntitySelector=function(){function Q(R){if(R)for(var U=Object.keys(R),Z=0;Z<U.length;++Z)R[U[Z]]!=null&&(this[U[Z]]=R[U[Z]])}return Q.prototype.agency_id="",Q.prototype.route_id="",Q.prototype.route_type=0,Q.prototype.trip=null,Q.prototype.stop_id="",Q.prototype.direction_id=0,Q.create=function(U){return new Q(U)},Q.encode=function(U,Z){return Z||(Z=ee.create()),U.agency_id!=null&&Object.hasOwnProperty.call(U,"agency_id")&&Z.uint32(10).string(U.agency_id),U.route_id!=null&&Object.hasOwnProperty.call(U,"route_id")&&Z.uint32(18).string(U.route_id),U.route_type!=null&&Object.hasOwnProperty.call(U,"route_type")&&Z.uint32(24).int32(U.route_type),U.trip!=null&&Object.hasOwnProperty.call(U,"trip")&&re.transit_realtime.TripDescriptor.encode(U.trip,Z.uint32(34).fork()).ldelim(),U.stop_id!=null&&Object.hasOwnProperty.call(U,"stop_id")&&Z.uint32(42).string(U.stop_id),U.direction_id!=null&&Object.hasOwnProperty.call(U,"direction_id")&&Z.uint32(48).uint32(U.direction_id),Z},Q.encodeDelimited=function(U,Z){return this.encode(U,Z).ldelim()},Q.decode=function(U,Z){U instanceof K||(U=K.create(U));for(var ae=Z===void 0?U.len:U.pos+Z,he=new re.transit_realtime.EntitySelector;U.pos<ae;){var pe=U.uint32();switch(pe>>>3){case 1:{he.agency_id=U.string();break}case 2:{he.route_id=U.string();break}case 3:{he.route_type=U.int32();break}case 4:{he.trip=re.transit_realtime.TripDescriptor.decode(U,U.uint32());break}case 5:{he.stop_id=U.string();break}case 6:{he.direction_id=U.uint32();break}default:U.skipType(pe&7);break}}return he},Q.decodeDelimited=function(U){return U instanceof K||(U=new K(U)),this.decode(U,U.uint32())},Q.verify=function(U){if(typeof U!="object"||U===null)return"object expected";if(U.agency_id!=null&&U.hasOwnProperty("agency_id")&&!ne.isString(U.agency_id))return"agency_id: string expected";if(U.route_id!=null&&U.hasOwnProperty("route_id")&&!ne.isString(U.route_id))return"route_id: string expected";if(U.route_type!=null&&U.hasOwnProperty("route_type")&&!ne.isInteger(U.route_type))return"route_type: integer expected";if(U.trip!=null&&U.hasOwnProperty("trip")){var Z=re.transit_realtime.TripDescriptor.verify(U.trip);if(Z)return"trip."+Z}return U.stop_id!=null&&U.hasOwnProperty("stop_id")&&!ne.isString(U.stop_id)?"stop_id: string expected":U.direction_id!=null&&U.hasOwnProperty("direction_id")&&!ne.isInteger(U.direction_id)?"direction_id: integer expected":null},Q.fromObject=function(U){if(U instanceof re.transit_realtime.EntitySelector)return U;var Z=new re.transit_realtime.EntitySelector;if(U.agency_id!=null&&(Z.agency_id=String(U.agency_id)),U.route_id!=null&&(Z.route_id=String(U.route_id)),U.route_type!=null&&(Z.route_type=U.route_type|0),U.trip!=null){if(typeof U.trip!="object")throw TypeError(".transit_realtime.EntitySelector.trip: object expected");Z.trip=re.transit_realtime.TripDescriptor.fromObject(U.trip)}return U.stop_id!=null&&(Z.stop_id=String(U.stop_id)),U.direction_id!=null&&(Z.direction_id=U.direction_id>>>0),Z},Q.toObject=function(U,Z){Z||(Z={});var ae={};return Z.defaults&&(ae.agency_id="",ae.route_id="",ae.route_type=0,ae.trip=null,ae.stop_id="",ae.direction_id=0),U.agency_id!=null&&U.hasOwnProperty("agency_id")&&(ae.agency_id=U.agency_id),U.route_id!=null&&U.hasOwnProperty("route_id")&&(ae.route_id=U.route_id),U.route_type!=null&&U.hasOwnProperty("route_type")&&(ae.route_type=U.route_type),U.trip!=null&&U.hasOwnProperty("trip")&&(ae.trip=re.transit_realtime.TripDescriptor.toObject(U.trip,Z)),U.stop_id!=null&&U.hasOwnProperty("stop_id")&&(ae.stop_id=U.stop_id),U.direction_id!=null&&U.hasOwnProperty("direction_id")&&(ae.direction_id=U.direction_id),ae},Q.prototype.toJSON=function(){return this.constructor.toObject(this,Y.util.toJSONOptions)},Q.getTypeUrl=function(U){return U===void 0&&(U="type.googleapis.com"),U+"/transit_realtime.EntitySelector"},Q}(),le.TranslatedString=function(){function Q(R){if(this.translation=[],R)for(var U=Object.keys(R),Z=0;Z<U.length;++Z)R[U[Z]]!=null&&(this[U[Z]]=R[U[Z]])}return Q.prototype.translation=ne.emptyArray,Q.create=function(U){return new Q(U)},Q.encode=function(U,Z){if(Z||(Z=ee.create()),U.translation!=null&&U.translation.length)for(var ae=0;ae<U.translation.length;++ae)re.transit_realtime.TranslatedString.Translation.encode(U.translation[ae],Z.uint32(10).fork()).ldelim();return Z},Q.encodeDelimited=function(U,Z){return this.encode(U,Z).ldelim()},Q.decode=function(U,Z){U instanceof K||(U=K.create(U));for(var ae=Z===void 0?U.len:U.pos+Z,he=new re.transit_realtime.TranslatedString;U.pos<ae;){var pe=U.uint32();switch(pe>>>3){case 1:{he.translation&&he.translation.length||(he.translation=[]),he.translation.push(re.transit_realtime.TranslatedString.Translation.decode(U,U.uint32()));break}default:U.skipType(pe&7);break}}return he},Q.decodeDelimited=function(U){return U instanceof K||(U=new K(U)),this.decode(U,U.uint32())},Q.verify=function(U){if(typeof U!="object"||U===null)return"object expected";if(U.translation!=null&&U.hasOwnProperty("translation")){if(!Array.isArray(U.translation))return"translation: array expected";for(var Z=0;Z<U.translation.length;++Z){var ae=re.transit_realtime.TranslatedString.Translation.verify(U.translation[Z]);if(ae)return"translation."+ae}}return null},Q.fromObject=function(U){if(U instanceof re.transit_realtime.TranslatedString)return U;var Z=new re.transit_realtime.TranslatedString;if(U.translation){if(!Array.isArray(U.translation))throw TypeError(".transit_realtime.TranslatedString.translation: array expected");Z.translation=[];for(var ae=0;ae<U.translation.length;++ae){if(typeof U.translation[ae]!="object")throw TypeError(".transit_realtime.TranslatedString.translation: object expected");Z.translation[ae]=re.transit_realtime.TranslatedString.Translation.fromObject(U.translation[ae])}}return Z},Q.toObject=function(U,Z){Z||(Z={});var ae={};if((Z.arrays||Z.defaults)&&(ae.translation=[]),U.translation&&U.translation.length){ae.translation=[];for(var he=0;he<U.translation.length;++he)ae.translation[he]=re.transit_realtime.TranslatedString.Translation.toObject(U.translation[he],Z)}return ae},Q.prototype.toJSON=function(){return this.constructor.toObject(this,Y.util.toJSONOptions)},Q.getTypeUrl=function(U){return U===void 0&&(U="type.googleapis.com"),U+"/transit_realtime.TranslatedString"},Q.Translation=function(){function R(U){if(U)for(var Z=Object.keys(U),ae=0;ae<Z.length;++ae)U[Z[ae]]!=null&&(this[Z[ae]]=U[Z[ae]])}return R.prototype.text="",R.prototype.language="",R.create=function(Z){return new R(Z)},R.encode=function(Z,ae){return ae||(ae=ee.create()),ae.uint32(10).string(Z.text),Z.language!=null&&Object.hasOwnProperty.call(Z,"language")&&ae.uint32(18).string(Z.language),ae},R.encodeDelimited=function(Z,ae){return this.encode(Z,ae).ldelim()},R.decode=function(Z,ae){Z instanceof K||(Z=K.create(Z));for(var he=ae===void 0?Z.len:Z.pos+ae,pe=new re.transit_realtime.TranslatedString.Translation;Z.pos<he;){var me=Z.uint32();switch(me>>>3){case 1:{pe.text=Z.string();break}case 2:{pe.language=Z.string();break}default:Z.skipType(me&7);break}}if(!pe.hasOwnProperty("text"))throw ne.ProtocolError("missing required 'text'",{instance:pe});return pe},R.decodeDelimited=function(Z){return Z instanceof K||(Z=new K(Z)),this.decode(Z,Z.uint32())},R.verify=function(Z){return typeof Z!="object"||Z===null?"object expected":ne.isString(Z.text)?Z.language!=null&&Z.hasOwnProperty("language")&&!ne.isString(Z.language)?"language: string expected":null:"text: string expected"},R.fromObject=function(Z){if(Z instanceof re.transit_realtime.TranslatedString.Translation)return Z;var ae=new re.transit_realtime.TranslatedString.Translation;return Z.text!=null&&(ae.text=String(Z.text)),Z.language!=null&&(ae.language=String(Z.language)),ae},R.toObject=function(Z,ae){ae||(ae={});var he={};return ae.defaults&&(he.text="",he.language=""),Z.text!=null&&Z.hasOwnProperty("text")&&(he.text=Z.text),Z.language!=null&&Z.hasOwnProperty("language")&&(he.language=Z.language),he},R.prototype.toJSON=function(){return this.constructor.toObject(this,Y.util.toJSONOptions)},R.getTypeUrl=function(Z){return Z===void 0&&(Z="type.googleapis.com"),Z+"/transit_realtime.TranslatedString.Translation"},R}(),Q}(),le.TranslatedImage=function(){function Q(R){if(this.localized_image=[],R)for(var U=Object.keys(R),Z=0;Z<U.length;++Z)R[U[Z]]!=null&&(this[U[Z]]=R[U[Z]])}return Q.prototype.localized_image=ne.emptyArray,Q.create=function(U){return new Q(U)},Q.encode=function(U,Z){if(Z||(Z=ee.create()),U.localized_image!=null&&U.localized_image.length)for(var ae=0;ae<U.localized_image.length;++ae)re.transit_realtime.TranslatedImage.LocalizedImage.encode(U.localized_image[ae],Z.uint32(10).fork()).ldelim();return Z},Q.encodeDelimited=function(U,Z){return this.encode(U,Z).ldelim()},Q.decode=function(U,Z){U instanceof K||(U=K.create(U));for(var ae=Z===void 0?U.len:U.pos+Z,he=new re.transit_realtime.TranslatedImage;U.pos<ae;){var pe=U.uint32();switch(pe>>>3){case 1:{he.localized_image&&he.localized_image.length||(he.localized_image=[]),he.localized_image.push(re.transit_realtime.TranslatedImage.LocalizedImage.decode(U,U.uint32()));break}default:U.skipType(pe&7);break}}return he},Q.decodeDelimited=function(U){return U instanceof K||(U=new K(U)),this.decode(U,U.uint32())},Q.verify=function(U){if(typeof U!="object"||U===null)return"object expected";if(U.localized_image!=null&&U.hasOwnProperty("localized_image")){if(!Array.isArray(U.localized_image))return"localized_image: array expected";for(var Z=0;Z<U.localized_image.length;++Z){var ae=re.transit_realtime.TranslatedImage.LocalizedImage.verify(U.localized_image[Z]);if(ae)return"localized_image."+ae}}return null},Q.fromObject=function(U){if(U instanceof re.transit_realtime.TranslatedImage)return U;var Z=new re.transit_realtime.TranslatedImage;if(U.localized_image){if(!Array.isArray(U.localized_image))throw TypeError(".transit_realtime.TranslatedImage.localized_image: array expected");Z.localized_image=[];for(var ae=0;ae<U.localized_image.length;++ae){if(typeof U.localized_image[ae]!="object")throw TypeError(".transit_realtime.TranslatedImage.localized_image: object expected");Z.localized_image[ae]=re.transit_realtime.TranslatedImage.LocalizedImage.fromObject(U.localized_image[ae])}}return Z},Q.toObject=function(U,Z){Z||(Z={});var ae={};if((Z.arrays||Z.defaults)&&(ae.localized_image=[]),U.localized_image&&U.localized_image.length){ae.localized_image=[];for(var he=0;he<U.localized_image.length;++he)ae.localized_image[he]=re.transit_realtime.TranslatedImage.LocalizedImage.toObject(U.localized_image[he],Z)}return ae},Q.prototype.toJSON=function(){return this.constructor.toObject(this,Y.util.toJSONOptions)},Q.getTypeUrl=function(U){return U===void 0&&(U="type.googleapis.com"),U+"/transit_realtime.TranslatedImage"},Q.LocalizedImage=function(){function R(U){if(U)for(var Z=Object.keys(U),ae=0;ae<Z.length;++ae)U[Z[ae]]!=null&&(this[Z[ae]]=U[Z[ae]])}return R.prototype.url="",R.prototype.media_type="",R.prototype.language="",R.create=function(Z){return new R(Z)},R.encode=function(Z,ae){return ae||(ae=ee.create()),ae.uint32(10).string(Z.url),ae.uint32(18).string(Z.media_type),Z.language!=null&&Object.hasOwnProperty.call(Z,"language")&&ae.uint32(26).string(Z.language),ae},R.encodeDelimited=function(Z,ae){return this.encode(Z,ae).ldelim()},R.decode=function(Z,ae){Z instanceof K||(Z=K.create(Z));for(var he=ae===void 0?Z.len:Z.pos+ae,pe=new re.transit_realtime.TranslatedImage.LocalizedImage;Z.pos<he;){var me=Z.uint32();switch(me>>>3){case 1:{pe.url=Z.string();break}case 2:{pe.media_type=Z.string();break}case 3:{pe.language=Z.string();break}default:Z.skipType(me&7);break}}if(!pe.hasOwnProperty("url"))throw ne.ProtocolError("missing required 'url'",{instance:pe});if(!pe.hasOwnProperty("media_type"))throw ne.ProtocolError("missing required 'media_type'",{instance:pe});return pe},R.decodeDelimited=function(Z){return Z instanceof K||(Z=new K(Z)),this.decode(Z,Z.uint32())},R.verify=function(Z){return typeof Z!="object"||Z===null?"object expected":ne.isString(Z.url)?ne.isString(Z.media_type)?Z.language!=null&&Z.hasOwnProperty("language")&&!ne.isString(Z.language)?"language: string expected":null:"media_type: string expected":"url: string expected"},R.fromObject=function(Z){if(Z instanceof re.transit_realtime.TranslatedImage.LocalizedImage)return Z;var ae=new re.transit_realtime.TranslatedImage.LocalizedImage;return Z.url!=null&&(ae.url=String(Z.url)),Z.media_type!=null&&(ae.media_type=String(Z.media_type)),Z.language!=null&&(ae.language=String(Z.language)),ae},R.toObject=function(Z,ae){ae||(ae={});var he={};return ae.defaults&&(he.url="",he.media_type="",he.language=""),Z.url!=null&&Z.hasOwnProperty("url")&&(he.url=Z.url),Z.media_type!=null&&Z.hasOwnProperty("media_type")&&(he.media_type=Z.media_type),Z.language!=null&&Z.hasOwnProperty("language")&&(he.language=Z.language),he},R.prototype.toJSON=function(){return this.constructor.toObject(this,Y.util.toJSONOptions)},R.getTypeUrl=function(Z){return Z===void 0&&(Z="type.googleapis.com"),Z+"/transit_realtime.TranslatedImage.LocalizedImage"},R}(),Q}(),le.Shape=function(){function Q(R){if(R)for(var U=Object.keys(R),Z=0;Z<U.length;++Z)R[U[Z]]!=null&&(this[U[Z]]=R[U[Z]])}return Q.prototype.shape_id="",Q.prototype.encoded_polyline="",Q.create=function(U){return new Q(U)},Q.encode=function(U,Z){return Z||(Z=ee.create()),U.shape_id!=null&&Object.hasOwnProperty.call(U,"shape_id")&&Z.uint32(10).string(U.shape_id),U.encoded_polyline!=null&&Object.hasOwnProperty.call(U,"encoded_polyline")&&Z.uint32(18).string(U.encoded_polyline),Z},Q.encodeDelimited=function(U,Z){return this.encode(U,Z).ldelim()},Q.decode=function(U,Z){U instanceof K||(U=K.create(U));for(var ae=Z===void 0?U.len:U.pos+Z,he=new re.transit_realtime.Shape;U.pos<ae;){var pe=U.uint32();switch(pe>>>3){case 1:{he.shape_id=U.string();break}case 2:{he.encoded_polyline=U.string();break}default:U.skipType(pe&7);break}}return he},Q.decodeDelimited=function(U){return U instanceof K||(U=new K(U)),this.decode(U,U.uint32())},Q.verify=function(U){return typeof U!="object"||U===null?"object expected":U.shape_id!=null&&U.hasOwnProperty("shape_id")&&!ne.isString(U.shape_id)?"shape_id: string expected":U.encoded_polyline!=null&&U.hasOwnProperty("encoded_polyline")&&!ne.isString(U.encoded_polyline)?"encoded_polyline: string expected":null},Q.fromObject=function(U){if(U instanceof re.transit_realtime.Shape)return U;var Z=new re.transit_realtime.Shape;return U.shape_id!=null&&(Z.shape_id=String(U.shape_id)),U.encoded_polyline!=null&&(Z.encoded_polyline=String(U.encoded_polyline)),Z},Q.toObject=function(U,Z){Z||(Z={});var ae={};return Z.defaults&&(ae.shape_id="",ae.encoded_polyline=""),U.shape_id!=null&&U.hasOwnProperty("shape_id")&&(ae.shape_id=U.shape_id),U.encoded_polyline!=null&&U.hasOwnProperty("encoded_polyline")&&(ae.encoded_polyline=U.encoded_polyline),ae},Q.prototype.toJSON=function(){return this.constructor.toObject(this,Y.util.toJSONOptions)},Q.getTypeUrl=function(U){return U===void 0&&(U="type.googleapis.com"),U+"/transit_realtime.Shape"},Q}(),le.Stop=function(){function Q(R){if(R)for(var U=Object.keys(R),Z=0;Z<U.length;++Z)R[U[Z]]!=null&&(this[U[Z]]=R[U[Z]])}return Q.prototype.stop_id="",Q.prototype.stop_code=null,Q.prototype.stop_name=null,Q.prototype.tts_stop_name=null,Q.prototype.stop_desc=null,Q.prototype.stop_lat=0,Q.prototype.stop_lon=0,Q.prototype.zone_id="",Q.prototype.stop_url=null,Q.prototype.parent_station="",Q.prototype.stop_timezone="",Q.prototype.wheelchair_boarding=0,Q.prototype.level_id="",Q.prototype.platform_code=null,Q.create=function(U){return new Q(U)},Q.encode=function(U,Z){return Z||(Z=ee.create()),U.stop_id!=null&&Object.hasOwnProperty.call(U,"stop_id")&&Z.uint32(10).string(U.stop_id),U.stop_code!=null&&Object.hasOwnProperty.call(U,"stop_code")&&re.transit_realtime.TranslatedString.encode(U.stop_code,Z.uint32(18).fork()).ldelim(),U.stop_name!=null&&Object.hasOwnProperty.call(U,"stop_name")&&re.transit_realtime.TranslatedString.encode(U.stop_name,Z.uint32(26).fork()).ldelim(),U.tts_stop_name!=null&&Object.hasOwnProperty.call(U,"tts_stop_name")&&re.transit_realtime.TranslatedString.encode(U.tts_stop_name,Z.uint32(34).fork()).ldelim(),U.stop_desc!=null&&Object.hasOwnProperty.call(U,"stop_desc")&&re.transit_realtime.TranslatedString.encode(U.stop_desc,Z.uint32(42).fork()).ldelim(),U.stop_lat!=null&&Object.hasOwnProperty.call(U,"stop_lat")&&Z.uint32(53).float(U.stop_lat),U.stop_lon!=null&&Object.hasOwnProperty.call(U,"stop_lon")&&Z.uint32(61).float(U.stop_lon),U.zone_id!=null&&Object.hasOwnProperty.call(U,"zone_id")&&Z.uint32(66).string(U.zone_id),U.stop_url!=null&&Object.hasOwnProperty.call(U,"stop_url")&&re.transit_realtime.TranslatedString.encode(U.stop_url,Z.uint32(74).fork()).ldelim(),U.parent_station!=null&&Object.hasOwnProperty.call(U,"parent_station")&&Z.uint32(90).string(U.parent_station),U.stop_timezone!=null&&Object.hasOwnProperty.call(U,"stop_timezone")&&Z.uint32(98).string(U.stop_timezone),U.wheelchair_boarding!=null&&Object.hasOwnProperty.call(U,"wheelchair_boarding")&&Z.uint32(104).int32(U.wheelchair_boarding),U.level_id!=null&&Object.hasOwnProperty.call(U,"level_id")&&Z.uint32(114).string(U.level_id),U.platform_code!=null&&Object.hasOwnProperty.call(U,"platform_code")&&re.transit_realtime.TranslatedString.encode(U.platform_code,Z.uint32(122).fork()).ldelim(),Z},Q.encodeDelimited=function(U,Z){return this.encode(U,Z).ldelim()},Q.decode=function(U,Z){U instanceof K||(U=K.create(U));for(var ae=Z===void 0?U.len:U.pos+Z,he=new re.transit_realtime.Stop;U.pos<ae;){var pe=U.uint32();switch(pe>>>3){case 1:{he.stop_id=U.string();break}case 2:{he.stop_code=re.transit_realtime.TranslatedString.decode(U,U.uint32());break}case 3:{he.stop_name=re.transit_realtime.TranslatedString.decode(U,U.uint32());break}case 4:{he.tts_stop_name=re.transit_realtime.TranslatedString.decode(U,U.uint32());break}case 5:{he.stop_desc=re.transit_realtime.TranslatedString.decode(U,U.uint32());break}case 6:{he.stop_lat=U.float();break}case 7:{he.stop_lon=U.float();break}case 8:{he.zone_id=U.string();break}case 9:{he.stop_url=re.transit_realtime.TranslatedString.decode(U,U.uint32());break}case 11:{he.parent_station=U.string();break}case 12:{he.stop_timezone=U.string();break}case 13:{he.wheelchair_boarding=U.int32();break}case 14:{he.level_id=U.string();break}case 15:{he.platform_code=re.transit_realtime.TranslatedString.decode(U,U.uint32());break}default:U.skipType(pe&7);break}}return he},Q.decodeDelimited=function(U){return U instanceof K||(U=new K(U)),this.decode(U,U.uint32())},Q.verify=function(U){if(typeof U!="object"||U===null)return"object expected";if(U.stop_id!=null&&U.hasOwnProperty("stop_id")&&!ne.isString(U.stop_id))return"stop_id: string expected";if(U.stop_code!=null&&U.hasOwnProperty("stop_code")){var Z=re.transit_realtime.TranslatedString.verify(U.stop_code);if(Z)return"stop_code."+Z}if(U.stop_name!=null&&U.hasOwnProperty("stop_name")){var Z=re.transit_realtime.TranslatedString.verify(U.stop_name);if(Z)return"stop_name."+Z}if(U.tts_stop_name!=null&&U.hasOwnProperty("tts_stop_name")){var Z=re.transit_realtime.TranslatedString.verify(U.tts_stop_name);if(Z)return"tts_stop_name."+Z}if(U.stop_desc!=null&&U.hasOwnProperty("stop_desc")){var Z=re.transit_realtime.TranslatedString.verify(U.stop_desc);if(Z)return"stop_desc."+Z}if(U.stop_lat!=null&&U.hasOwnProperty("stop_lat")&&typeof U.stop_lat!="number")return"stop_lat: number expected";if(U.stop_lon!=null&&U.hasOwnProperty("stop_lon")&&typeof U.stop_lon!="number")return"stop_lon: number expected";if(U.zone_id!=null&&U.hasOwnProperty("zone_id")&&!ne.isString(U.zone_id))return"zone_id: string expected";if(U.stop_url!=null&&U.hasOwnProperty("stop_url")){var Z=re.transit_realtime.TranslatedString.verify(U.stop_url);if(Z)return"stop_url."+Z}if(U.parent_station!=null&&U.hasOwnProperty("parent_station")&&!ne.isString(U.parent_station))return"parent_station: string expected";if(U.stop_timezone!=null&&U.hasOwnProperty("stop_timezone")&&!ne.isString(U.stop_timezone))return"stop_timezone: string expected";if(U.wheelchair_boarding!=null&&U.hasOwnProperty("wheelchair_boarding"))switch(U.wheelchair_boarding){default:return"wheelchair_boarding: enum value expected";case 0:case 1:case 2:break}if(U.level_id!=null&&U.hasOwnProperty("level_id")&&!ne.isString(U.level_id))return"level_id: string expected";if(U.platform_code!=null&&U.hasOwnProperty("platform_code")){var Z=re.transit_realtime.TranslatedString.verify(U.platform_code);if(Z)return"platform_code."+Z}return null},Q.fromObject=function(U){if(U instanceof re.transit_realtime.Stop)return U;var Z=new re.transit_realtime.Stop;if(U.stop_id!=null&&(Z.stop_id=String(U.stop_id)),U.stop_code!=null){if(typeof U.stop_code!="object")throw TypeError(".transit_realtime.Stop.stop_code: object expected");Z.stop_code=re.transit_realtime.TranslatedString.fromObject(U.stop_code)}if(U.stop_name!=null){if(typeof U.stop_name!="object")throw TypeError(".transit_realtime.Stop.stop_name: object expected");Z.stop_name=re.transit_realtime.TranslatedString.fromObject(U.stop_name)}if(U.tts_stop_name!=null){if(typeof U.tts_stop_name!="object")throw TypeError(".transit_realtime.Stop.tts_stop_name: object expected");Z.tts_stop_name=re.transit_realtime.TranslatedString.fromObject(U.tts_stop_name)}if(U.stop_desc!=null){if(typeof U.stop_desc!="object")throw TypeError(".transit_realtime.Stop.stop_desc: object expected");Z.stop_desc=re.transit_realtime.TranslatedString.fromObject(U.stop_desc)}if(U.stop_lat!=null&&(Z.stop_lat=Number(U.stop_lat)),U.stop_lon!=null&&(Z.stop_lon=Number(U.stop_lon)),U.zone_id!=null&&(Z.zone_id=String(U.zone_id)),U.stop_url!=null){if(typeof U.stop_url!="object")throw TypeError(".transit_realtime.Stop.stop_url: object expected");Z.stop_url=re.transit_realtime.TranslatedString.fromObject(U.stop_url)}switch(U.parent_station!=null&&(Z.parent_station=String(U.parent_station)),U.stop_timezone!=null&&(Z.stop_timezone=String(U.stop_timezone)),U.wheelchair_boarding){default:if(typeof U.wheelchair_boarding=="number"){Z.wheelchair_boarding=U.wheelchair_boarding;break}break;case"UNKNOWN":case 0:Z.wheelchair_boarding=0;break;case"AVAILABLE":case 1:Z.wheelchair_boarding=1;break;case"NOT_AVAILABLE":case 2:Z.wheelchair_boarding=2;break}if(U.level_id!=null&&(Z.level_id=String(U.level_id)),U.platform_code!=null){if(typeof U.platform_code!="object")throw TypeError(".transit_realtime.Stop.platform_code: object expected");Z.platform_code=re.transit_realtime.TranslatedString.fromObject(U.platform_code)}return Z},Q.toObject=function(U,Z){Z||(Z={});var ae={};return Z.defaults&&(ae.stop_id="",ae.stop_code=null,ae.stop_name=null,ae.tts_stop_name=null,ae.stop_desc=null,ae.stop_lat=0,ae.stop_lon=0,ae.zone_id="",ae.stop_url=null,ae.parent_station="",ae.stop_timezone="",ae.wheelchair_boarding=Z.enums===String?"UNKNOWN":0,ae.level_id="",ae.platform_code=null),U.stop_id!=null&&U.hasOwnProperty("stop_id")&&(ae.stop_id=U.stop_id),U.stop_code!=null&&U.hasOwnProperty("stop_code")&&(ae.stop_code=re.transit_realtime.TranslatedString.toObject(U.stop_code,Z)),U.stop_name!=null&&U.hasOwnProperty("stop_name")&&(ae.stop_name=re.transit_realtime.TranslatedString.toObject(U.stop_name,Z)),U.tts_stop_name!=null&&U.hasOwnProperty("tts_stop_name")&&(ae.tts_stop_name=re.transit_realtime.TranslatedString.toObject(U.tts_stop_name,Z)),U.stop_desc!=null&&U.hasOwnProperty("stop_desc")&&(ae.stop_desc=re.transit_realtime.TranslatedString.toObject(U.stop_desc,Z)),U.stop_lat!=null&&U.hasOwnProperty("stop_lat")&&(ae.stop_lat=Z.json&&!isFinite(U.stop_lat)?String(U.stop_lat):U.stop_lat),U.stop_lon!=null&&U.hasOwnProperty("stop_lon")&&(ae.stop_lon=Z.json&&!isFinite(U.stop_lon)?String(U.stop_lon):U.stop_lon),U.zone_id!=null&&U.hasOwnProperty("zone_id")&&(ae.zone_id=U.zone_id),U.stop_url!=null&&U.hasOwnProperty("stop_url")&&(ae.stop_url=re.transit_realtime.TranslatedString.toObject(U.stop_url,Z)),U.parent_station!=null&&U.hasOwnProperty("parent_station")&&(ae.parent_station=U.parent_station),U.stop_timezone!=null&&U.hasOwnProperty("stop_timezone")&&(ae.stop_timezone=U.stop_timezone),U.wheelchair_boarding!=null&&U.hasOwnProperty("wheelchair_boarding")&&(ae.wheelchair_boarding=Z.enums===String?re.transit_realtime.Stop.WheelchairBoarding[U.wheelchair_boarding]===void 0?U.wheelchair_boarding:re.transit_realtime.Stop.WheelchairBoarding[U.wheelchair_boarding]:U.wheelchair_boarding),U.level_id!=null&&U.hasOwnProperty("level_id")&&(ae.level_id=U.level_id),U.platform_code!=null&&U.hasOwnProperty("platform_code")&&(ae.platform_code=re.transit_realtime.TranslatedString.toObject(U.platform_code,Z)),ae},Q.prototype.toJSON=function(){return this.constructor.toObject(this,Y.util.toJSONOptions)},Q.getTypeUrl=function(U){return U===void 0&&(U="type.googleapis.com"),U+"/transit_realtime.Stop"},Q.WheelchairBoarding=function(){var R={},U=Object.create(R);return U[R[0]="UNKNOWN"]=0,U[R[1]="AVAILABLE"]=1,U[R[2]="NOT_AVAILABLE"]=2,U}(),Q}(),le.TripModifications=function(){function Q(R){if(this.selected_trips=[],this.start_times=[],this.service_dates=[],this.modifications=[],R)for(var U=Object.keys(R),Z=0;Z<U.length;++Z)R[U[Z]]!=null&&(this[U[Z]]=R[U[Z]])}return Q.prototype.selected_trips=ne.emptyArray,Q.prototype.start_times=ne.emptyArray,Q.prototype.service_dates=ne.emptyArray,Q.prototype.modifications=ne.emptyArray,Q.create=function(U){return new Q(U)},Q.encode=function(U,Z){if(Z||(Z=ee.create()),U.selected_trips!=null&&U.selected_trips.length)for(var ae=0;ae<U.selected_trips.length;++ae)re.transit_realtime.TripModifications.SelectedTrips.encode(U.selected_trips[ae],Z.uint32(10).fork()).ldelim();if(U.start_times!=null&&U.start_times.length)for(var ae=0;ae<U.start_times.length;++ae)Z.uint32(18).string(U.start_times[ae]);if(U.service_dates!=null&&U.service_dates.length)for(var ae=0;ae<U.service_dates.length;++ae)Z.uint32(26).string(U.service_dates[ae]);if(U.modifications!=null&&U.modifications.length)for(var ae=0;ae<U.modifications.length;++ae)re.transit_realtime.TripModifications.Modification.encode(U.modifications[ae],Z.uint32(34).fork()).ldelim();return Z},Q.encodeDelimited=function(U,Z){return this.encode(U,Z).ldelim()},Q.decode=function(U,Z){U instanceof K||(U=K.create(U));for(var ae=Z===void 0?U.len:U.pos+Z,he=new re.transit_realtime.TripModifications;U.pos<ae;){var pe=U.uint32();switch(pe>>>3){case 1:{he.selected_trips&&he.selected_trips.length||(he.selected_trips=[]),he.selected_trips.push(re.transit_realtime.TripModifications.SelectedTrips.decode(U,U.uint32()));break}case 2:{he.start_times&&he.start_times.length||(he.start_times=[]),he.start_times.push(U.string());break}case 3:{he.service_dates&&he.service_dates.length||(he.service_dates=[]),he.service_dates.push(U.string());break}case 4:{he.modifications&&he.modifications.length||(he.modifications=[]),he.modifications.push(re.transit_realtime.TripModifications.Modification.decode(U,U.uint32()));break}default:U.skipType(pe&7);break}}return he},Q.decodeDelimited=function(U){return U instanceof K||(U=new K(U)),this.decode(U,U.uint32())},Q.verify=function(U){if(typeof U!="object"||U===null)return"object expected";if(U.selected_trips!=null&&U.hasOwnProperty("selected_trips")){if(!Array.isArray(U.selected_trips))return"selected_trips: array expected";for(var Z=0;Z<U.selected_trips.length;++Z){var ae=re.transit_realtime.TripModifications.SelectedTrips.verify(U.selected_trips[Z]);if(ae)return"selected_trips."+ae}}if(U.start_times!=null&&U.hasOwnProperty("start_times")){if(!Array.isArray(U.start_times))return"start_times: array expected";for(var Z=0;Z<U.start_times.length;++Z)if(!ne.isString(U.start_times[Z]))return"start_times: string[] expected"}if(U.service_dates!=null&&U.hasOwnProperty("service_dates")){if(!Array.isArray(U.service_dates))return"service_dates: array expected";for(var Z=0;Z<U.service_dates.length;++Z)if(!ne.isString(U.service_dates[Z]))return"service_dates: string[] expected"}if(U.modifications!=null&&U.hasOwnProperty("modifications")){if(!Array.isArray(U.modifications))return"modifications: array expected";for(var Z=0;Z<U.modifications.length;++Z){var ae=re.transit_realtime.TripModifications.Modification.verify(U.modifications[Z]);if(ae)return"modifications."+ae}}return null},Q.fromObject=function(U){if(U instanceof re.transit_realtime.TripModifications)return U;var Z=new re.transit_realtime.TripModifications;if(U.selected_trips){if(!Array.isArray(U.selected_trips))throw TypeError(".transit_realtime.TripModifications.selected_trips: array expected");Z.selected_trips=[];for(var ae=0;ae<U.selected_trips.length;++ae){if(typeof U.selected_trips[ae]!="object")throw TypeError(".transit_realtime.TripModifications.selected_trips: object expected");Z.selected_trips[ae]=re.transit_realtime.TripModifications.SelectedTrips.fromObject(U.selected_trips[ae])}}if(U.start_times){if(!Array.isArray(U.start_times))throw TypeError(".transit_realtime.TripModifications.start_times: array expected");Z.start_times=[];for(var ae=0;ae<U.start_times.length;++ae)Z.start_times[ae]=String(U.start_times[ae])}if(U.service_dates){if(!Array.isArray(U.service_dates))throw TypeError(".transit_realtime.TripModifications.service_dates: array expected");Z.service_dates=[];for(var ae=0;ae<U.service_dates.length;++ae)Z.service_dates[ae]=String(U.service_dates[ae])}if(U.modifications){if(!Array.isArray(U.modifications))throw TypeError(".transit_realtime.TripModifications.modifications: array expected");Z.modifications=[];for(var ae=0;ae<U.modifications.length;++ae){if(typeof U.modifications[ae]!="object")throw TypeError(".transit_realtime.TripModifications.modifications: object expected");Z.modifications[ae]=re.transit_realtime.TripModifications.Modification.fromObject(U.modifications[ae])}}return Z},Q.toObject=function(U,Z){Z||(Z={});var ae={};if((Z.arrays||Z.defaults)&&(ae.selected_trips=[],ae.start_times=[],ae.service_dates=[],ae.modifications=[]),U.selected_trips&&U.selected_trips.length){ae.selected_trips=[];for(var he=0;he<U.selected_trips.length;++he)ae.selected_trips[he]=re.transit_realtime.TripModifications.SelectedTrips.toObject(U.selected_trips[he],Z)}if(U.start_times&&U.start_times.length){ae.start_times=[];for(var he=0;he<U.start_times.length;++he)ae.start_times[he]=U.start_times[he]}if(U.service_dates&&U.service_dates.length){ae.service_dates=[];for(var he=0;he<U.service_dates.length;++he)ae.service_dates[he]=U.service_dates[he]}if(U.modifications&&U.modifications.length){ae.modifications=[];for(var he=0;he<U.modifications.length;++he)ae.modifications[he]=re.transit_realtime.TripModifications.Modification.toObject(U.modifications[he],Z)}return ae},Q.prototype.toJSON=function(){return this.constructor.toObject(this,Y.util.toJSONOptions)},Q.getTypeUrl=function(U){return U===void 0&&(U="type.googleapis.com"),U+"/transit_realtime.TripModifications"},Q.Modification=function(){function R(U){if(this.replacement_stops=[],U)for(var Z=Object.keys(U),ae=0;ae<Z.length;++ae)U[Z[ae]]!=null&&(this[Z[ae]]=U[Z[ae]])}return R.prototype.start_stop_selector=null,R.prototype.end_stop_selector=null,R.prototype.propagated_modification_delay=0,R.prototype.replacement_stops=ne.emptyArray,R.prototype.service_alert_id="",R.prototype.last_modified_time=ne.Long?ne.Long.fromBits(0,0,!0):0,R.create=function(Z){return new R(Z)},R.encode=function(Z,ae){if(ae||(ae=ee.create()),Z.start_stop_selector!=null&&Object.hasOwnProperty.call(Z,"start_stop_selector")&&re.transit_realtime.StopSelector.encode(Z.start_stop_selector,ae.uint32(10).fork()).ldelim(),Z.end_stop_selector!=null&&Object.hasOwnProperty.call(Z,"end_stop_selector")&&re.transit_realtime.StopSelector.encode(Z.end_stop_selector,ae.uint32(18).fork()).ldelim(),Z.propagated_modification_delay!=null&&Object.hasOwnProperty.call(Z,"propagated_modification_delay")&&ae.uint32(24).int32(Z.propagated_modification_delay),Z.replacement_stops!=null&&Z.replacement_stops.length)for(var he=0;he<Z.replacement_stops.length;++he)re.transit_realtime.ReplacementStop.encode(Z.replacement_stops[he],ae.uint32(34).fork()).ldelim();return Z.service_alert_id!=null&&Object.hasOwnProperty.call(Z,"service_alert_id")&&ae.uint32(42).string(Z.service_alert_id),Z.last_modified_time!=null&&Object.hasOwnProperty.call(Z,"last_modified_time")&&ae.uint32(48).uint64(Z.last_modified_time),ae},R.encodeDelimited=function(Z,ae){return this.encode(Z,ae).ldelim()},R.decode=function(Z,ae){Z instanceof K||(Z=K.create(Z));for(var he=ae===void 0?Z.len:Z.pos+ae,pe=new re.transit_realtime.TripModifications.Modification;Z.pos<he;){var me=Z.uint32();switch(me>>>3){case 1:{pe.start_stop_selector=re.transit_realtime.StopSelector.decode(Z,Z.uint32());break}case 2:{pe.end_stop_selector=re.transit_realtime.StopSelector.decode(Z,Z.uint32());break}case 3:{pe.propagated_modification_delay=Z.int32();break}case 4:{pe.replacement_stops&&pe.replacement_stops.length||(pe.replacement_stops=[]),pe.replacement_stops.push(re.transit_realtime.ReplacementStop.decode(Z,Z.uint32()));break}case 5:{pe.service_alert_id=Z.string();break}case 6:{pe.last_modified_time=Z.uint64();break}default:Z.skipType(me&7);break}}return pe},R.decodeDelimited=function(Z){return Z instanceof K||(Z=new K(Z)),this.decode(Z,Z.uint32())},R.verify=function(Z){if(typeof Z!="object"||Z===null)return"object expected";if(Z.start_stop_selector!=null&&Z.hasOwnProperty("start_stop_selector")){var ae=re.transit_realtime.StopSelector.verify(Z.start_stop_selector);if(ae)return"start_stop_selector."+ae}if(Z.end_stop_selector!=null&&Z.hasOwnProperty("end_stop_selector")){var ae=re.transit_realtime.StopSelector.verify(Z.end_stop_selector);if(ae)return"end_stop_selector."+ae}if(Z.propagated_modification_delay!=null&&Z.hasOwnProperty("propagated_modification_delay")&&!ne.isInteger(Z.propagated_modification_delay))return"propagated_modification_delay: integer expected";if(Z.replacement_stops!=null&&Z.hasOwnProperty("replacement_stops")){if(!Array.isArray(Z.replacement_stops))return"replacement_stops: array expected";for(var he=0;he<Z.replacement_stops.length;++he){var ae=re.transit_realtime.ReplacementStop.verify(Z.replacement_stops[he]);if(ae)return"replacement_stops."+ae}}return Z.service_alert_id!=null&&Z.hasOwnProperty("service_alert_id")&&!ne.isString(Z.service_alert_id)?"service_alert_id: string expected":Z.last_modified_time!=null&&Z.hasOwnProperty("last_modified_time")&&!ne.isInteger(Z.last_modified_time)&&!(Z.last_modified_time&&ne.isInteger(Z.last_modified_time.low)&&ne.isInteger(Z.last_modified_time.high))?"last_modified_time: integer|Long expected":null},R.fromObject=function(Z){if(Z instanceof re.transit_realtime.TripModifications.Modification)return Z;var ae=new re.transit_realtime.TripModifications.Modification;if(Z.start_stop_selector!=null){if(typeof Z.start_stop_selector!="object")throw TypeError(".transit_realtime.TripModifications.Modification.start_stop_selector: object expected");ae.start_stop_selector=re.transit_realtime.StopSelector.fromObject(Z.start_stop_selector)}if(Z.end_stop_selector!=null){if(typeof Z.end_stop_selector!="object")throw TypeError(".transit_realtime.TripModifications.Modification.end_stop_selector: object expected");ae.end_stop_selector=re.transit_realtime.StopSelector.fromObject(Z.end_stop_selector)}if(Z.propagated_modification_delay!=null&&(ae.propagated_modification_delay=Z.propagated_modification_delay|0),Z.replacement_stops){if(!Array.isArray(Z.replacement_stops))throw TypeError(".transit_realtime.TripModifications.Modification.replacement_stops: array expected");ae.replacement_stops=[];for(var he=0;he<Z.replacement_stops.length;++he){if(typeof Z.replacement_stops[he]!="object")throw TypeError(".transit_realtime.TripModifications.Modification.replacement_stops: object expected");ae.replacement_stops[he]=re.transit_realtime.ReplacementStop.fromObject(Z.replacement_stops[he])}}return Z.service_alert_id!=null&&(ae.service_alert_id=String(Z.service_alert_id)),Z.last_modified_time!=null&&(ne.Long?(ae.last_modified_time=ne.Long.fromValue(Z.last_modified_time)).unsigned=!0:typeof Z.last_modified_time=="string"?ae.last_modified_time=parseInt(Z.last_modified_time,10):typeof Z.last_modified_time=="number"?ae.last_modified_time=Z.last_modified_time:typeof Z.last_modified_time=="object"&&(ae.last_modified_time=new ne.LongBits(Z.last_modified_time.low>>>0,Z.last_modified_time.high>>>0).toNumber(!0))),ae},R.toObject=function(Z,ae){ae||(ae={});var he={};if((ae.arrays||ae.defaults)&&(he.replacement_stops=[]),ae.defaults)if(he.start_stop_selector=null,he.end_stop_selector=null,he.propagated_modification_delay=0,he.service_alert_id="",ne.Long){var pe=new ne.Long(0,0,!0);he.last_modified_time=ae.longs===String?pe.toString():ae.longs===Number?pe.toNumber():pe}else he.last_modified_time=ae.longs===String?"0":0;if(Z.start_stop_selector!=null&&Z.hasOwnProperty("start_stop_selector")&&(he.start_stop_selector=re.transit_realtime.StopSelector.toObject(Z.start_stop_selector,ae)),Z.end_stop_selector!=null&&Z.hasOwnProperty("end_stop_selector")&&(he.end_stop_selector=re.transit_realtime.StopSelector.toObject(Z.end_stop_selector,ae)),Z.propagated_modification_delay!=null&&Z.hasOwnProperty("propagated_modification_delay")&&(he.propagated_modification_delay=Z.propagated_modification_delay),Z.replacement_stops&&Z.replacement_stops.length){he.replacement_stops=[];for(var me=0;me<Z.replacement_stops.length;++me)he.replacement_stops[me]=re.transit_realtime.ReplacementStop.toObject(Z.replacement_stops[me],ae)}return Z.service_alert_id!=null&&Z.hasOwnProperty("service_alert_id")&&(he.service_alert_id=Z.service_alert_id),Z.last_modified_time!=null&&Z.hasOwnProperty("last_modified_time")&&(typeof Z.last_modified_time=="number"?he.last_modified_time=ae.longs===String?String(Z.last_modified_time):Z.last_modified_time:he.last_modified_time=ae.longs===String?ne.Long.prototype.toString.call(Z.last_modified_time):ae.longs===Number?new ne.LongBits(Z.last_modified_time.low>>>0,Z.last_modified_time.high>>>0).toNumber(!0):Z.last_modified_time),he},R.prototype.toJSON=function(){return this.constructor.toObject(this,Y.util.toJSONOptions)},R.getTypeUrl=function(Z){return Z===void 0&&(Z="type.googleapis.com"),Z+"/transit_realtime.TripModifications.Modification"},R}(),Q.SelectedTrips=function(){function R(U){if(this.trip_ids=[],U)for(var Z=Object.keys(U),ae=0;ae<Z.length;++ae)U[Z[ae]]!=null&&(this[Z[ae]]=U[Z[ae]])}return R.prototype.trip_ids=ne.emptyArray,R.prototype.shape_id="",R.create=function(Z){return new R(Z)},R.encode=function(Z,ae){if(ae||(ae=ee.create()),Z.trip_ids!=null&&Z.trip_ids.length)for(var he=0;he<Z.trip_ids.length;++he)ae.uint32(10).string(Z.trip_ids[he]);return Z.shape_id!=null&&Object.hasOwnProperty.call(Z,"shape_id")&&ae.uint32(18).string(Z.shape_id),ae},R.encodeDelimited=function(Z,ae){return this.encode(Z,ae).ldelim()},R.decode=function(Z,ae){Z instanceof K||(Z=K.create(Z));for(var he=ae===void 0?Z.len:Z.pos+ae,pe=new re.transit_realtime.TripModifications.SelectedTrips;Z.pos<he;){var me=Z.uint32();switch(me>>>3){case 1:{pe.trip_ids&&pe.trip_ids.length||(pe.trip_ids=[]),pe.trip_ids.push(Z.string());break}case 2:{pe.shape_id=Z.string();break}default:Z.skipType(me&7);break}}return pe},R.decodeDelimited=function(Z){return Z instanceof K||(Z=new K(Z)),this.decode(Z,Z.uint32())},R.verify=function(Z){if(typeof Z!="object"||Z===null)return"object expected";if(Z.trip_ids!=null&&Z.hasOwnProperty("trip_ids")){if(!Array.isArray(Z.trip_ids))return"trip_ids: array expected";for(var ae=0;ae<Z.trip_ids.length;++ae)if(!ne.isString(Z.trip_ids[ae]))return"trip_ids: string[] expected"}return Z.shape_id!=null&&Z.hasOwnProperty("shape_id")&&!ne.isString(Z.shape_id)?"shape_id: string expected":null},R.fromObject=function(Z){if(Z instanceof re.transit_realtime.TripModifications.SelectedTrips)return Z;var ae=new re.transit_realtime.TripModifications.SelectedTrips;if(Z.trip_ids){if(!Array.isArray(Z.trip_ids))throw TypeError(".transit_realtime.TripModifications.SelectedTrips.trip_ids: array expected");ae.trip_ids=[];for(var he=0;he<Z.trip_ids.length;++he)ae.trip_ids[he]=String(Z.trip_ids[he])}return Z.shape_id!=null&&(ae.shape_id=String(Z.shape_id)),ae},R.toObject=function(Z,ae){ae||(ae={});var he={};if((ae.arrays||ae.defaults)&&(he.trip_ids=[]),ae.defaults&&(he.shape_id=""),Z.trip_ids&&Z.trip_ids.length){he.trip_ids=[];for(var pe=0;pe<Z.trip_ids.length;++pe)he.trip_ids[pe]=Z.trip_ids[pe]}return Z.shape_id!=null&&Z.hasOwnProperty("shape_id")&&(he.shape_id=Z.shape_id),he},R.prototype.toJSON=function(){return this.constructor.toObject(this,Y.util.toJSONOptions)},R.getTypeUrl=function(Z){return Z===void 0&&(Z="type.googleapis.com"),Z+"/transit_realtime.TripModifications.SelectedTrips"},R}(),Q}(),le.StopSelector=function(){function Q(R){if(R)for(var U=Object.keys(R),Z=0;Z<U.length;++Z)R[U[Z]]!=null&&(this[U[Z]]=R[U[Z]])}return Q.prototype.stop_sequence=0,Q.prototype.stop_id="",Q.create=function(U){return new Q(U)},Q.encode=function(U,Z){return Z||(Z=ee.create()),U.stop_sequence!=null&&Object.hasOwnProperty.call(U,"stop_sequence")&&Z.uint32(8).uint32(U.stop_sequence),U.stop_id!=null&&Object.hasOwnProperty.call(U,"stop_id")&&Z.uint32(18).string(U.stop_id),Z},Q.encodeDelimited=function(U,Z){return this.encode(U,Z).ldelim()},Q.decode=function(U,Z){U instanceof K||(U=K.create(U));for(var ae=Z===void 0?U.len:U.pos+Z,he=new re.transit_realtime.StopSelector;U.pos<ae;){var pe=U.uint32();switch(pe>>>3){case 1:{he.stop_sequence=U.uint32();break}case 2:{he.stop_id=U.string();break}default:U.skipType(pe&7);break}}return he},Q.decodeDelimited=function(U){return U instanceof K||(U=new K(U)),this.decode(U,U.uint32())},Q.verify=function(U){return typeof U!="object"||U===null?"object expected":U.stop_sequence!=null&&U.hasOwnProperty("stop_sequence")&&!ne.isInteger(U.stop_sequence)?"stop_sequence: integer expected":U.stop_id!=null&&U.hasOwnProperty("stop_id")&&!ne.isString(U.stop_id)?"stop_id: string expected":null},Q.fromObject=function(U){if(U instanceof re.transit_realtime.StopSelector)return U;var Z=new re.transit_realtime.StopSelector;return U.stop_sequence!=null&&(Z.stop_sequence=U.stop_sequence>>>0),U.stop_id!=null&&(Z.stop_id=String(U.stop_id)),Z},Q.toObject=function(U,Z){Z||(Z={});var ae={};return Z.defaults&&(ae.stop_sequence=0,ae.stop_id=""),U.stop_sequence!=null&&U.hasOwnProperty("stop_sequence")&&(ae.stop_sequence=U.stop_sequence),U.stop_id!=null&&U.hasOwnProperty("stop_id")&&(ae.stop_id=U.stop_id),ae},Q.prototype.toJSON=function(){return this.constructor.toObject(this,Y.util.toJSONOptions)},Q.getTypeUrl=function(U){return U===void 0&&(U="type.googleapis.com"),U+"/transit_realtime.StopSelector"},Q}(),le.ReplacementStop=function(){function Q(R){if(R)for(var U=Object.keys(R),Z=0;Z<U.length;++Z)R[U[Z]]!=null&&(this[U[Z]]=R[U[Z]])}return Q.prototype.travel_time_to_stop=0,Q.prototype.stop_id="",Q.create=function(U){return new Q(U)},Q.encode=function(U,Z){return Z||(Z=ee.create()),U.travel_time_to_stop!=null&&Object.hasOwnProperty.call(U,"travel_time_to_stop")&&Z.uint32(8).int32(U.travel_time_to_stop),U.stop_id!=null&&Object.hasOwnProperty.call(U,"stop_id")&&Z.uint32(18).string(U.stop_id),Z},Q.encodeDelimited=function(U,Z){return this.encode(U,Z).ldelim()},Q.decode=function(U,Z){U instanceof K||(U=K.create(U));for(var ae=Z===void 0?U.len:U.pos+Z,he=new re.transit_realtime.ReplacementStop;U.pos<ae;){var pe=U.uint32();switch(pe>>>3){case 1:{he.travel_time_to_stop=U.int32();break}case 2:{he.stop_id=U.string();break}default:U.skipType(pe&7);break}}return he},Q.decodeDelimited=function(U){return U instanceof K||(U=new K(U)),this.decode(U,U.uint32())},Q.verify=function(U){return typeof U!="object"||U===null?"object expected":U.travel_time_to_stop!=null&&U.hasOwnProperty("travel_time_to_stop")&&!ne.isInteger(U.travel_time_to_stop)?"travel_time_to_stop: integer expected":U.stop_id!=null&&U.hasOwnProperty("stop_id")&&!ne.isString(U.stop_id)?"stop_id: string expected":null},Q.fromObject=function(U){if(U instanceof re.transit_realtime.ReplacementStop)return U;var Z=new re.transit_realtime.ReplacementStop;return U.travel_time_to_stop!=null&&(Z.travel_time_to_stop=U.travel_time_to_stop|0),U.stop_id!=null&&(Z.stop_id=String(U.stop_id)),Z},Q.toObject=function(U,Z){Z||(Z={});var ae={};return Z.defaults&&(ae.travel_time_to_stop=0,ae.stop_id=""),U.travel_time_to_stop!=null&&U.hasOwnProperty("travel_time_to_stop")&&(ae.travel_time_to_stop=U.travel_time_to_stop),U.stop_id!=null&&U.hasOwnProperty("stop_id")&&(ae.stop_id=U.stop_id),ae},Q.prototype.toJSON=function(){return this.constructor.toObject(this,Y.util.toJSONOptions)},Q.getTypeUrl=function(U){return U===void 0&&(U="type.googleapis.com"),U+"/transit_realtime.ReplacementStop"},Q}(),le}(),gtfsRealtime_pbf=re,gtfsRealtime_pbf}var gtfsRtBindings,hasRequiredGtfsRtBindings;function requireGtfsRtBindings(){if(hasRequiredGtfsRtBindings)return gtfsRtBindings;hasRequiredGtfsRtBindings=1;const{transit_realtime:Y}=requireGtfsRealtime_pbf();return gtfsRtBindings=Y,gtfsRtBindings}var gtfsRtBindingsExports=requireGtfsRtBindings(),fetchBrowser$1={exports:{}},fetchBrowser=fetchBrowser$1.exports,hasRequiredFetchBrowser;function requireFetchBrowser(){return hasRequiredFetchBrowser||(hasRequiredFetchBrowser=1,function(Y,K){(function(ee){function ne(re){var le=re&&re.Promise||ee.Promise,Q=re&&re.XMLHttpRequest||ee.XMLHttpRequest;return function(){var R=Object.create(ee,{fetch:{value:void 0,writable:!0}});return function(U,Z){Z(K)}(this,function(U){var Z=typeof R<"u"&&R||typeof self<"u"&&self||typeof Z<"u"&&Z,ae={searchParams:"URLSearchParams"in Z,iterable:"Symbol"in Z&&"iterator"in Symbol,blob:"FileReader"in Z&&"Blob"in Z&&function(){try{return new Blob,!0}catch{return!1}}(),formData:"FormData"in Z,arrayBuffer:"ArrayBuffer"in Z};function he(ft){return ft&&DataView.prototype.isPrototypeOf(ft)}if(ae.arrayBuffer)var pe=["[object Int8Array]","[object Uint8Array]","[object Uint8ClampedArray]","[object Int16Array]","[object Uint16Array]","[object Int32Array]","[object Uint32Array]","[object Float32Array]","[object Float64Array]"],me=ArrayBuffer.isView||function(ft){return ft&&pe.indexOf(Object.prototype.toString.call(ft))>-1};function ve(ft){if(typeof ft!="string"&&(ft=String(ft)),/[^a-z0-9\-#$%&'*+.^_`|~!]/i.test(ft)||ft==="")throw new TypeError("Invalid character in header field name");return ft.toLowerCase()}function Re(ft){return typeof ft!="string"&&(ft=String(ft)),ft}function Me(ft){var Rt={next:function(){var pt=ft.shift();return{done:pt===void 0,value:pt}}};return ae.iterable&&(Rt[Symbol.iterator]=function(){return Rt}),Rt}function Te(ft){this.map={},ft instanceof Te?ft.forEach(function(Rt,pt){this.append(pt,Rt)},this):Array.isArray(ft)?ft.forEach(function(Rt){this.append(Rt[0],Rt[1])},this):ft&&Object.getOwnPropertyNames(ft).forEach(function(Rt){this.append(Rt,ft[Rt])},this)}Te.prototype.append=function(ft,Rt){ft=ve(ft),Rt=Re(Rt);var pt=this.map[ft];this.map[ft]=pt?pt+", "+Rt:Rt},Te.prototype.delete=function(ft){delete this.map[ve(ft)]},Te.prototype.get=function(ft){return ft=ve(ft),this.has(ft)?this.map[ft]:null},Te.prototype.has=function(ft){return this.map.hasOwnProperty(ve(ft))},Te.prototype.set=function(ft,Rt){this.map[ve(ft)]=Re(Rt)},Te.prototype.forEach=function(ft,Rt){for(var pt in this.map)this.map.hasOwnProperty(pt)&&ft.call(Rt,this.map[pt],pt,this)},Te.prototype.keys=function(){var ft=[];return this.forEach(function(Rt,pt){ft.push(pt)}),Me(ft)},Te.prototype.values=function(){var ft=[];return this.forEach(function(Rt){ft.push(Rt)}),Me(ft)},Te.prototype.entries=function(){var ft=[];return this.forEach(function(Rt,pt){ft.push([pt,Rt])}),Me(ft)},ae.iterable&&(Te.prototype[Symbol.iterator]=Te.prototype.entries);function Ce(ft){if(ft.bodyUsed)return le.reject(new TypeError("Already read"));ft.bodyUsed=!0}function We(ft){return new le(function(Rt,pt){ft.onload=function(){Rt(ft.result)},ft.onerror=function(){pt(ft.error)}})}function Fe(ft){var Rt=new FileReader,pt=We(Rt);return Rt.readAsArrayBuffer(ft),pt}function ke(ft){var Rt=new FileReader,pt=We(Rt);return Rt.readAsText(ft),pt}function Ze(ft){for(var Rt=new Uint8Array(ft),pt=new Array(Rt.length),At=0;At<Rt.length;At++)pt[At]=String.fromCharCode(Rt[At]);return pt.join("")}function Je(ft){if(ft.slice)return ft.slice(0);var Rt=new Uint8Array(ft.byteLength);return Rt.set(new Uint8Array(ft)),Rt.buffer}function Qe(){return this.bodyUsed=!1,this._initBody=function(ft){this.bodyUsed=this.bodyUsed,this._bodyInit=ft,ft?typeof ft=="string"?this._bodyText=ft:ae.blob&&Blob.prototype.isPrototypeOf(ft)?this._bodyBlob=ft:ae.formData&&FormData.prototype.isPrototypeOf(ft)?this._bodyFormData=ft:ae.searchParams&&URLSearchParams.prototype.isPrototypeOf(ft)?this._bodyText=ft.toString():ae.arrayBuffer&&ae.blob&&he(ft)?(this._bodyArrayBuffer=Je(ft.buffer),this._bodyInit=new Blob([this._bodyArrayBuffer])):ae.arrayBuffer&&(ArrayBuffer.prototype.isPrototypeOf(ft)||me(ft))?this._bodyArrayBuffer=Je(ft):this._bodyText=ft=Object.prototype.toString.call(ft):this._bodyText="",this.headers.get("content-type")||(typeof ft=="string"?this.headers.set("content-type","text/plain;charset=UTF-8"):this._bodyBlob&&this._bodyBlob.type?this.headers.set("content-type",this._bodyBlob.type):ae.searchParams&&URLSearchParams.prototype.isPrototypeOf(ft)&&this.headers.set("content-type","application/x-www-form-urlencoded;charset=UTF-8"))},ae.blob&&(this.blob=function(){var ft=Ce(this);if(ft)return ft;if(this._bodyBlob)return le.resolve(this._bodyBlob);if(this._bodyArrayBuffer)return le.resolve(new Blob([this._bodyArrayBuffer]));if(this._bodyFormData)throw new Error("could not read FormData body as blob");return le.resolve(new Blob([this._bodyText]))},this.arrayBuffer=function(){if(this._bodyArrayBuffer){var ft=Ce(this);return ft||(ArrayBuffer.isView(this._bodyArrayBuffer)?le.resolve(this._bodyArrayBuffer.buffer.slice(this._bodyArrayBuffer.byteOffset,this._bodyArrayBuffer.byteOffset+this._bodyArrayBuffer.byteLength)):le.resolve(this._bodyArrayBuffer))}else return this.blob().then(Fe)}),this.text=function(){var ft=Ce(this);if(ft)return ft;if(this._bodyBlob)return ke(this._bodyBlob);if(this._bodyArrayBuffer)return le.resolve(Ze(this._bodyArrayBuffer));if(this._bodyFormData)throw new Error("could not read FormData body as text");return le.resolve(this._bodyText)},ae.formData&&(this.formData=function(){return this.text().then(yt)}),this.json=function(){return this.text().then(JSON.parse)},this}var it=["DELETE","GET","HEAD","OPTIONS","POST","PUT"];function lt(ft){var Rt=ft.toUpperCase();return it.indexOf(Rt)>-1?Rt:ft}function dt(ft,Rt){if(!(this instanceof dt))throw new TypeError('Please use the "new" operator, this DOM object constructor cannot be called as a function.');Rt=Rt||{};var pt=Rt.body;if(ft instanceof dt){if(ft.bodyUsed)throw new TypeError("Already read");this.url=ft.url,this.credentials=ft.credentials,Rt.headers||(this.headers=new Te(ft.headers)),this.method=ft.method,this.mode=ft.mode,this.signal=ft.signal,!pt&&ft._bodyInit!=null&&(pt=ft._bodyInit,ft.bodyUsed=!0)}else this.url=String(ft);if(this.credentials=Rt.credentials||this.credentials||"same-origin",(Rt.headers||!this.headers)&&(this.headers=new Te(Rt.headers)),this.method=lt(Rt.method||this.method||"GET"),this.mode=Rt.mode||this.mode||null,this.signal=Rt.signal||this.signal,this.referrer=null,(this.method==="GET"||this.method==="HEAD")&&pt)throw new TypeError("Body not allowed for GET or HEAD requests");if(this._initBody(pt),(this.method==="GET"||this.method==="HEAD")&&(Rt.cache==="no-store"||Rt.cache==="no-cache")){var At=/([?&])_=[^&]*/;if(At.test(this.url))this.url=this.url.replace(At,"$1_="+new Date().getTime());else{var It=/\?/;this.url+=(It.test(this.url)?"&":"?")+"_="+new Date().getTime()}}}dt.prototype.clone=function(){return new dt(this,{body:this._bodyInit})};function yt(ft){var Rt=new FormData;return ft.trim().split("&").forEach(function(pt){if(pt){var At=pt.split("="),It=At.shift().replace(/\+/g," "),Dt=At.join("=").replace(/\+/g," ");Rt.append(decodeURIComponent(It),decodeURIComponent(Dt))}}),Rt}function gt(ft){var Rt=new Te,pt=ft.replace(/\r?\n[\t ]+/g," ");return pt.split("\r").map(function(At){return At.indexOf(`
`)===0?At.substr(1,At.length):At}).forEach(function(At){var It=At.split(":"),Dt=It.shift().trim();if(Dt){var Zt=It.join(":").trim();Rt.append(Dt,Zt)}}),Rt}Qe.call(dt.prototype);function qt(ft,Rt){if(!(this instanceof qt))throw new TypeError('Please use the "new" operator, this DOM object constructor cannot be called as a function.');Rt||(Rt={}),this.type="default",this.status=Rt.status===void 0?200:Rt.status,this.ok=this.status>=200&&this.status<300,this.statusText="statusText"in Rt?Rt.statusText:"",this.headers=new Te(Rt.headers),this.url=Rt.url||"",this._initBody(ft)}Qe.call(qt.prototype),qt.prototype.clone=function(){return new qt(this._bodyInit,{status:this.status,statusText:this.statusText,headers:new Te(this.headers),url:this.url})},qt.error=function(){var ft=new qt(null,{status:0,statusText:""});return ft.type="error",ft};var Ft=[301,302,303,307,308];qt.redirect=function(ft,Rt){if(Ft.indexOf(Rt)===-1)throw new RangeError("Invalid status code");return new qt(null,{status:Rt,headers:{location:ft}})},U.DOMException=Z.DOMException;try{new U.DOMException}catch{U.DOMException=function(Rt,pt){this.message=Rt,this.name=pt;var At=Error(Rt);this.stack=At.stack},U.DOMException.prototype=Object.create(Error.prototype),U.DOMException.prototype.constructor=U.DOMException}function Gt(ft,Rt){return new le(function(pt,At){var It=new dt(ft,Rt);if(It.signal&&It.signal.aborted)return At(new U.DOMException("Aborted","AbortError"));var Dt=new Q;function Zt(){Dt.abort()}Dt.onload=function(){var Er={status:Dt.status,statusText:Dt.statusText,headers:gt(Dt.getAllResponseHeaders()||"")};Er.url="responseURL"in Dt?Dt.responseURL:Er.headers.get("X-Request-URL");var vr="response"in Dt?Dt.response:Dt.responseText;setTimeout(function(){pt(new qt(vr,Er))},0)},Dt.onerror=function(){setTimeout(function(){At(new TypeError("Network request failed"))},0)},Dt.ontimeout=function(){setTimeout(function(){At(new TypeError("Network request failed"))},0)},Dt.onabort=function(){setTimeout(function(){At(new U.DOMException("Aborted","AbortError"))},0)};function nr(Er){try{return Er===""&&Z.location.href?Z.location.href:Er}catch{return Er}}Dt.open(It.method,nr(It.url),!0),It.credentials==="include"?Dt.withCredentials=!0:It.credentials==="omit"&&(Dt.withCredentials=!1),"responseType"in Dt&&(ae.blob?Dt.responseType="blob":ae.arrayBuffer&&It.headers.get("Content-Type")&&It.headers.get("Content-Type").indexOf("application/octet-stream")!==-1&&(Dt.responseType="arraybuffer")),Rt&&typeof Rt.headers=="object"&&!(Rt.headers instanceof Te)?Object.getOwnPropertyNames(Rt.headers).forEach(function(Er){Dt.setRequestHeader(Er,Re(Rt.headers[Er]))}):It.headers.forEach(function(Er,vr){Dt.setRequestHeader(vr,Er)}),It.signal&&(It.signal.addEventListener("abort",Zt),Dt.onreadystatechange=function(){Dt.readyState===4&&It.signal.removeEventListener("abort",Zt)}),Dt.send(typeof It._bodyInit>"u"?null:It._bodyInit)})}Gt.polyfill=!0,Z.fetch||(Z.fetch=Gt,Z.Headers=Te,Z.Request=dt,Z.Response=qt),U.Headers=Te,U.Request=dt,U.Response=qt,U.fetch=Gt,Object.defineProperty(U,"__esModule",{value:!0})}),{fetch:R.fetch,Headers:R.Headers,Request:R.Request,Response:R.Response,DOMException:R.DOMException}}()}Y.exports=ne})(typeof globalThis<"u"?globalThis:typeof self<"u"?self:typeof commonjsGlobal<"u"?commonjsGlobal:fetchBrowser)}(fetchBrowser$1,fetchBrowser$1.exports)),fetchBrowser$1.exports}var fetchPeriodicSync,hasRequiredFetchPeriodicSync;function requireFetchPeriodicSync(){if(hasRequiredFetchPeriodicSync)return fetchPeriodicSync;hasRequiredFetchPeriodicSync=1;const{EventEmitter:Y}=requireEvents(),{fetch:K}=requireFetchBrowser()();return fetchPeriodicSync=(ne,re={})=>{const{interval:le,respectDataSaving:Q,respectPageVisibility:R,fetchOpts:U,setTimer:Z,clearTimer:ae}={interval:3e4,respectDataSaving:!0,respectPageVisibility:!0,fetchOpts:{},setTimer:setTimeout,clearTimer:clearTimeout,...re},he="minInterval"in re?re.minInterval:le*3,pe=new Y;let me=null;const ve=async()=>{const lt={};me!==null&&(lt["if-none-match"]=me);const dt=await K(ne,{...U,headers:{...U.headers,...lt}});if(!dt.ok&&dt.status!==304){const qt=new Error(dt.statusText);throw qt.response=dt,qt}let yt=!0;dt.status===304&&(yt=!1);const gt=dt.headers.get("etag");return gt&&(gt===me&&(yt=!1),me=gt),dt.headers.get("last-modified"),{changed:yt,response:dt}};let Re=null;const Me=()=>(Re!==null||(pe.emit("fetch"),Re=ve().then(({changed:lt,response:dt})=>(Re=null,pe.emit("fetch-done"),lt&&pe.emit("change",dt),dt),lt=>{throw Re=null,pe.emit("fetch-done"),pe.emit("error",lt),lt})),Re),Te=globalThis.document,Ce=()=>!R||!Te?!1:typeof Te.hidden=="boolean"?Te.hidden:!1,We=globalThis.navigator&&globalThis.navigator.connection,Fe=()=>Q&&We?We.saveData:!1;let ke=!1,Ze=null;const Je=()=>{Me().catch(()=>{}).then(()=>{if(!ke)return;const lt=Ce()||Fe()?he:le;Ze=Z(Je,lt)})},Qe=()=>{ke||(ke=!0,Je(),pe.emit("start"))},it=()=>{ke&&(Ze===null&&(ae(Ze),Ze=null),ke=!1,pe.emit("stop"))};return Qe(),pe.url=()=>ne,pe.start=Qe,pe.stop=it,pe.isActive=()=>!!ke,pe.refetch=Me,pe.isFetching=()=>!!Re,pe},fetchPeriodicSync}var fetchPeriodicSyncExports=requireFetchPeriodicSync();const syncViaPeriodicFetch=getDefaultExportFromCjs(fetchPeriodicSyncExports),MAX_FEED_SIZE=128*1024*1024,CONTENT_TYPES=["application/octet-stream","application/x-protobuf","application/grtfeed"],feedStore=(Y,K)=>{Y.feedUrl=null,Y.feedSyncStopped=!1,Y.feedSyncInterval=30,Y.feedSyncing=!1,Y.feedError=null,Y.feedRawData=null,Y.feedData=null;let ee=null;const ne=async Q=>{const R=Q.headers.get("content-type"),U=R?contentTypeExports.parse(R):{};if(U.type&&!CONTENT_TYPES.includes(U.type)){const pe=new Error(`invalid content-type \`${U.type}\`, only ${CONTENT_TYPES.join(", ")} are supported`);throw pe.response=Q,pe}const Z=Q.headers.get("content-length");if(Z&&parseInt(Z)>MAX_FEED_SIZE){const pe=new Error("response is too large");throw pe.response=Q,pe}const ae=bufferExports.Buffer.from(await Q.arrayBuffer()),he=gtfsRtBindingsExports.FeedMessage.toObject(gtfsRtBindingsExports.FeedMessage.decode(ae));if(!he||!he.header||!Array.isArray(he.entity)){const pe=new Error("couldn't parse feed");throw pe.rawFeed=ae,pe.response=Q,pe}Y.feedError=null,Y.feedRawData=ae,Y.feedData=he,K.emit("feed:data-change"),K.emit(K.STATE_CHANGE)},re=Q=>{Y.feedSyncing=Q,K.emit(K.STATE_CHANGE)},le=debounce(()=>{ee=syncViaPeriodicFetch(Y.feedUrl,{interval:Y.feedSyncInterval*1e3}),ee.on("fetch",()=>re(!0)),ee.on("fetch-done",()=>re(!1)),ee.on("change",Q=>{ne(Q).catch(R=>{Y.feedError=R,K.emit(K.STATE_CHANGE)})}),ee.on("error",Q=>{Y.feedError=Q,K.emit(K.STATE_CHANGE)}),Y.feedSyncStopped&&ee.stop()},300);K.on("feed:set-url",Q=>{Q!==Y.feedUrl&&(ee&&(ee.stop(),ee=null),Y.feedUrl=Q,Y.feedSyncing=!1,Y.feedRawData=null,Y.feedData=null,Q!==null&&le(),K.emit("feed:data-change"),K.emit(K.STATE_CHANGE))}),K.on("feed:sync",()=>{ee&&ee.refetch()}),K.on("feed:stop-sync",()=>{Y.feedSyncStopped=!0,ee&&ee.stop(),K.emit(K.STATE_CHANGE)}),K.on("feed:start-sync",()=>{Y.feedSyncStopped=!1,ee&&ee.start(),K.emit(K.STATE_CHANGE)}),K.on("feed:set-sync-interval",Q=>{Q=Math.max(Q,1),Q!==Y.feedSyncInterval&&(ee&&(ee.stop(),ee=null),Y.feedSyncInterval=Q,Y.feedUrl!==null&&le(),K.emit(K.STATE_CHANGE))})},MAX_LOG_ITEMS=1e3,feedLogStore=(Y,K)=>{Y.feedLogFilter=null,Y.unfilteredFeedLog=[],Y.feedLog=[];const ee=()=>{if(!Y.feedData){Y.unfilteredFeedLog=[],Y.feedLog=[];return}const ne=Date.now()/1e3|0,re=Y.feedData.header||{},le=(Y.feedData.entity||[]).filter(Z=>!!Z.trip_update).flatMap(Z=>(Z.trip_update.stop_time_update||[]).map(ae=>{var he,pe,me,ve,Re,Me,Te,Ce;return{entityId:Z.id,timestamp:Z.trip_update.timestamp||re.timestamp||null,routeId:(he=Z.trip_update.trip)==null?void 0:he.route_id,directionId:(pe=Z.trip_update.trip)==null?void 0:pe.direction_id,tripId:(me=Z.trip_update.trip)==null?void 0:me.trip_id,vehicleId:(ve=Z.trip_update.vehicle)==null?void 0:ve.id,vehicleLabel:(Re=Z.trip_update.vehicle)==null?void 0:Re.label,stopId:ae.stop_id,scheduleRelationship:ae.schedule_relationship,tArrival:((Me=ae.arrival)==null?void 0:Me.time)??null,delay:((Te=ae.arrival)==null?void 0:Te.delay)??((Ce=ae.departure)==null?void 0:Ce.delay)}})).filter(({tArrival:Z,delay:ae})=>Z!==null?Z>=ne:ae!==null).sort((Z,ae)=>{const he=typeof Z.tArrival=="number"?Z.tArrival-ne:Number.MAX_SAFE_INTEGER,pe=typeof ae.tArrival=="number"?ae.tArrival-ne:Number.MAX_SAFE_INTEGER,me=typeof Z.delay=="number"?Z.delay:0,ve=typeof ae.delay=="number"?ae.delay:0;return he/30===pe/30?Math.abs(ve)-Math.abs(me):he-pe}),Q=Y.feedLogFilter??"",U=(Q?le.filter(Z=>JSON.stringify(Z).toLowerCase().includes(Q)):le).slice(0,MAX_LOG_ITEMS);Y.unfilteredFeedLog=le,Y.feedLog=U,K.emit(K.STATE_CHANGE)};K.on("feed-log:set-filter",ne=>{Y.feedLogFilter!==ne&&(Y.feedLogFilter=ne,ee())}),K.on("feed:data-change",ee)},MAX_TRIP_UPDATES=1e3,MAX_VEHICLE_POSITIONS=1e3,inspectorStore=(Y,K)=>{Y.inspectorFilter=null,Y.unfilteredTripUpdates=[],Y.tripUpdates=[],Y.unfilteredVehiclePositions=[],Y.vehiclePositions=[];const ee=()=>{var he;if(!Y.feedData){Y.unfilteredTripUpdates=[],Y.tripUpdates=[];return}const ne=((he=Y.feedData)==null?void 0:he.entity)??[],re=Y.inspectorFilter??"",le=ne.filter(pe=>!!pe.trip_update),R=(re?le.filter(pe=>JSON.stringify(pe).toLowerCase().includes(re)):le).slice(0,MAX_TRIP_UPDATES),U=ne.filter(pe=>!!pe.vehicle),ae=(re?U.filter(pe=>JSON.stringify(pe).toLowerCase().includes(re)):U).slice(0,MAX_VEHICLE_POSITIONS);Y.unfilteredTripUpdates=le,Y.tripUpdates=R,Y.unfilteredVehiclePositions=U,Y.vehiclePositions=ae,K.emit(K.STATE_CHANGE)};K.on("inspector:set-filter",ne=>{Y.inspectorFilter!==ne&&(Y.inspectorFilter=ne,ee())}),K.on("feed:data-change",ee)};var browser={exports:{}},hasRequiredBrowser;function requireBrowser(){if(hasRequiredBrowser)return browser.exports;hasRequiredBrowser=1;const{AbortController:Y,AbortSignal:K}=typeof self<"u"?self:typeof window<"u"?window:void 0;return browser.exports=Y,browser.exports.AbortSignal=K,browser.exports.default=Y,browser.exports}var browserExports=requireBrowser();const AbortController$1=getDefaultExportFromCjs(browserExports);var fetchBrowserExports=requireFetchBrowser();const createFetch=getDefaultExportFromCjs(fetchBrowserExports);function encodeReserved(Y){return Y.split(/(%[0-9A-Fa-f]{2})/g).map(function(K){return/%[0-9A-Fa-f]/.test(K)||(K=encodeURI(K).replace(/%5B/g,"[").replace(/%5D/g,"]")),K}).join("")}function encodeUnreserved(Y){return encodeURIComponent(Y).replace(/[!'()*]/g,function(K){return"%"+K.charCodeAt(0).toString(16).toUpperCase()})}function encodeValue(Y,K,ee){return K=Y==="+"||Y==="#"?encodeReserved(K):encodeUnreserved(K),ee?encodeUnreserved(ee)+"="+K:K}function isDefined(Y){return Y!=null}function isKeyOperator(Y){return Y===";"||Y==="&"||Y==="?"}function getValues(Y,K,ee,ne){var re=Y[ee],le=[];if(isDefined(re)&&re!=="")if(typeof re=="string"||typeof re=="number"||typeof re=="boolean")re=re.toString(),ne&&ne!=="*"&&(re=re.substring(0,parseInt(ne,10))),le.push(encodeValue(K,re,isKeyOperator(K)?ee:null));else if(ne==="*")Array.isArray(re)?re.filter(isDefined).forEach(function(R){le.push(encodeValue(K,R,isKeyOperator(K)?ee:null))}):Object.keys(re).forEach(function(R){isDefined(re[R])&&le.push(encodeValue(K,re[R],R))});else{var Q=[];Array.isArray(re)?re.filter(isDefined).forEach(function(R){Q.push(encodeValue(K,R))}):Object.keys(re).forEach(function(R){isDefined(re[R])&&(Q.push(encodeUnreserved(R)),Q.push(encodeValue(K,re[R].toString())))}),isKeyOperator(K)?le.push(encodeUnreserved(ee)+"="+Q.join(",")):Q.length!==0&&le.push(Q.join(","))}else K===";"?isDefined(re)&&le.push(encodeUnreserved(ee)):re===""&&(K==="&"||K==="?")?le.push(encodeUnreserved(ee)+"="):re===""&&le.push("");return le}function parseTemplate(Y){var K=["+","#",".","/",";","?","&"];return{expand:function(ee){return Y.replace(/\{([^\{\}]+)\}|([^\{\}]+)/g,function(ne,re,le){if(re){var Q=null,R=[];if(K.indexOf(re.charAt(0))!==-1&&(Q=re.charAt(0),re=re.substr(1)),re.split(/,/g).forEach(function(Z){var ae=/([^:\*]*)(?::(\d+)|(\*))?/.exec(Z);R.push.apply(R,getValues(ee,Q,ae[1],ae[2]||ae[3]))}),Q&&Q!=="+"){var U=",";return Q==="?"?U="&":Q!=="#"&&(U=Q),(R.length!==0?Q:"")+R.join(U)}else return R.join(",")}else return encodeReserved(le)})}}}const{Request:Request$1,fetch:fetch$1}=createFetch(),hasProp=(Y,K)=>Object.prototype.hasOwnProperty.call(Y,K),checkIfFeedContainsFocusedVehicleId=(Y,K)=>{const ee=Y==null?void 0:Y.entity;return Array.isArray(ee)?ee.some(ne=>{var re,le;return((le=(re=ne.vehicle)==null?void 0:re.vehicle)==null?void 0:le.id)===K}):!1},checkIfFeedContainsFocusedTripId=(Y,K)=>{const ee=Y==null?void 0:Y.entity;if(Array.isArray(ee))return ee.some(ne=>{var re,le,Q,R;return((le=(re=ne.vehicle)==null?void 0:re.trip)==null?void 0:le.trip_id)===K||((R=(Q=ne.trip_update)==null?void 0:Q.trip)==null?void 0:R.trip_id)===K})},focusStore=(Y,K)=>{const ee=async(me,ve={})=>{const Re=new Request$1(me,{mode:"cors",redirect:"follow",headers:{accept:"application/json"},...ve}),Me=await fetch$1(Re);if(!Me.ok){const Te=new Error(`${Me.url}: ${Me.status} ${Me.statusText}`);throw Te.req=Re,Te.res=Me,Te}return await Me.json()};Y.shapeIdsByTripIdUrl="/shape-ids-by-trip-id.json",K.on("shape-ids-by-trip-id-url:set",me=>{Y.shapeIdsByTripIdUrl!==me&&(Y.shapeIdsByTripIdUrl=me,Q(),K.emit(K.STATE_CHANGE))});let ne=new AbortController$1;const re=async()=>(ne=new AbortController$1,console.debug(`fetching shape IDs from ${Y.shapeIdsByTripIdUrl}`),await ee(Y.shapeIdsByTripIdUrl,{signal:ne.signal}));let le={};const Q=()=>{ne.abort(),re().then(me=>{le=me,pe()}).catch(me=>{console.error("failed to fetch shape IDs",me)})};Y.shapeUrl="/shapes/{shape_id}.geo.json";let R=parseTemplate(Y.shapeUrl);K.on("shape-url:set",me=>{Y.shapeUrl!==me&&(Y.shapeUrl=me,R=parseTemplate(Y.shapeUrl),pe(),K.emit(K.STATE_CHANGE))}),Y.focusedVehicleId=null,Y.focusedVehiclePosition=null;const U=()=>{var ve;if(Y.focusedVehicleId===null)return;if(checkIfFeedContainsFocusedVehicleId(Y.feedData,Y.focusedVehicleId)){const Re=Y.focusedVehicleId,Te=(((ve=Y.feedData)==null?void 0:ve.entity)||[]).find(Ce=>{var We,Fe;return((Fe=(We=Ce.vehicle)==null?void 0:We.vehicle)==null?void 0:Fe.id)===Re});Te?Y.focusedVehiclePosition={type:"Feature",properties:{vehicleId:Re},geometry:{type:"Point",coordinates:[Te.vehicle.position.longitude,Te.vehicle.position.latitude]}}:Y.focusedVehiclePosition=null,K.emit(K.STATE_CHANGE)}};K.on("feed:data-change",U),K.on("focus-vehicle-id",me=>{me!==Y.focusedVehicleId&&(Y.focusedVehicleId=me,Y.focusedVehiclePosition=null,U(),K.emit(K.STATE_CHANGE))}),Y.focusedTripId=null,Y.focusedTripShape=null;const Z=()=>{Y.focusedTripId!==null&&checkIfFeedContainsFocusedTripId(Y.feedData,Y.focusedTripId)};K.on("feed:data-change",Z);let ae=new AbortController$1;const he=async(me,ve)=>{ae=new AbortController$1;const Re=R.expand({shape_id:me});console.debug(`fetching shape ${me} for trip ${ve} from ${Re}`);const Me=Date.now(),Te=await ee(Re,{signal:ae.signal});return console.debug(`fetched shape ${me} in ${Date.now()-Me}ms`),Te},pe=()=>{const me=Y.focusedTripId;if(me!==null&&(ae.abort(),me!==null&&hasProp(le,me))){const ve=le[me];he(ve,me).then(Re=>{Y.focusedTripShape=Re,K.emit(K.STATE_CHANGE)}).catch(Re=>{console.error(`failed to fetch shape ${ve} for trip ${me}`,Re)})}};K.on("focus-trip-id",me=>{me!==Y.focusedTripId&&(Y.focusedTripId=me,Y.focusedTripShape=null,Z(),pe(),K.emit(K.STATE_CHANGE))})};var isFunction_1,hasRequiredIsFunction;function requireIsFunction(){if(hasRequiredIsFunction)return isFunction_1;hasRequiredIsFunction=1;var Y=require_baseGetTag(),K=requireIsObject(),ee="[object AsyncFunction]",ne="[object Function]",re="[object GeneratorFunction]",le="[object Proxy]";function Q(R){if(!K(R))return!1;var U=Y(R);return U==ne||U==re||U==ee||U==le}return isFunction_1=Q,isFunction_1}var _coreJsData,hasRequired_coreJsData;function require_coreJsData(){if(hasRequired_coreJsData)return _coreJsData;hasRequired_coreJsData=1;var Y=require_root(),K=Y["__core-js_shared__"];return _coreJsData=K,_coreJsData}var _isMasked,hasRequired_isMasked;function require_isMasked(){if(hasRequired_isMasked)return _isMasked;hasRequired_isMasked=1;var Y=require_coreJsData(),K=function(){var ne=/[^.]+$/.exec(Y&&Y.keys&&Y.keys.IE_PROTO||"");return ne?"Symbol(src)_1."+ne:""}();function ee(ne){return!!K&&K in ne}return _isMasked=ee,_isMasked}var _toSource,hasRequired_toSource;function require_toSource(){if(hasRequired_toSource)return _toSource;hasRequired_toSource=1;var Y=Function.prototype,K=Y.toString;function ee(ne){if(ne!=null){try{return K.call(ne)}catch{}try{return ne+""}catch{}}return""}return _toSource=ee,_toSource}var _baseIsNative,hasRequired_baseIsNative;function require_baseIsNative(){if(hasRequired_baseIsNative)return _baseIsNative;hasRequired_baseIsNative=1;var Y=requireIsFunction(),K=require_isMasked(),ee=requireIsObject(),ne=require_toSource(),re=/[\\^$.*+?()[\]{}|]/g,le=/^\[object .+?Constructor\]$/,Q=Function.prototype,R=Object.prototype,U=Q.toString,Z=R.hasOwnProperty,ae=RegExp("^"+U.call(Z).replace(re,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$");function he(pe){if(!ee(pe)||K(pe))return!1;var me=Y(pe)?ae:le;return me.test(ne(pe))}return _baseIsNative=he,_baseIsNative}var _getValue,hasRequired_getValue;function require_getValue(){if(hasRequired_getValue)return _getValue;hasRequired_getValue=1;function Y(K,ee){return K==null?void 0:K[ee]}return _getValue=Y,_getValue}var _getNative,hasRequired_getNative;function require_getNative(){if(hasRequired_getNative)return _getNative;hasRequired_getNative=1;var Y=require_baseIsNative(),K=require_getValue();function ee(ne,re){var le=K(ne,re);return Y(le)?le:void 0}return _getNative=ee,_getNative}var _nativeCreate,hasRequired_nativeCreate;function require_nativeCreate(){if(hasRequired_nativeCreate)return _nativeCreate;hasRequired_nativeCreate=1;var Y=require_getNative(),K=Y(Object,"create");return _nativeCreate=K,_nativeCreate}var _hashClear,hasRequired_hashClear;function require_hashClear(){if(hasRequired_hashClear)return _hashClear;hasRequired_hashClear=1;var Y=require_nativeCreate();function K(){this.__data__=Y?Y(null):{},this.size=0}return _hashClear=K,_hashClear}var _hashDelete,hasRequired_hashDelete;function require_hashDelete(){if(hasRequired_hashDelete)return _hashDelete;hasRequired_hashDelete=1;function Y(K){var ee=this.has(K)&&delete this.__data__[K];return this.size-=ee?1:0,ee}return _hashDelete=Y,_hashDelete}var _hashGet,hasRequired_hashGet;function require_hashGet(){if(hasRequired_hashGet)return _hashGet;hasRequired_hashGet=1;var Y=require_nativeCreate(),K="__lodash_hash_undefined__",ee=Object.prototype,ne=ee.hasOwnProperty;function re(le){var Q=this.__data__;if(Y){var R=Q[le];return R===K?void 0:R}return ne.call(Q,le)?Q[le]:void 0}return _hashGet=re,_hashGet}var _hashHas,hasRequired_hashHas;function require_hashHas(){if(hasRequired_hashHas)return _hashHas;hasRequired_hashHas=1;var Y=require_nativeCreate(),K=Object.prototype,ee=K.hasOwnProperty;function ne(re){var le=this.__data__;return Y?le[re]!==void 0:ee.call(le,re)}return _hashHas=ne,_hashHas}var _hashSet,hasRequired_hashSet;function require_hashSet(){if(hasRequired_hashSet)return _hashSet;hasRequired_hashSet=1;var Y=require_nativeCreate(),K="__lodash_hash_undefined__";function ee(ne,re){var le=this.__data__;return this.size+=this.has(ne)?0:1,le[ne]=Y&&re===void 0?K:re,this}return _hashSet=ee,_hashSet}var _Hash,hasRequired_Hash;function require_Hash(){if(hasRequired_Hash)return _Hash;hasRequired_Hash=1;var Y=require_hashClear(),K=require_hashDelete(),ee=require_hashGet(),ne=require_hashHas(),re=require_hashSet();function le(Q){var R=-1,U=Q==null?0:Q.length;for(this.clear();++R<U;){var Z=Q[R];this.set(Z[0],Z[1])}}return le.prototype.clear=Y,le.prototype.delete=K,le.prototype.get=ee,le.prototype.has=ne,le.prototype.set=re,_Hash=le,_Hash}var _listCacheClear,hasRequired_listCacheClear;function require_listCacheClear(){if(hasRequired_listCacheClear)return _listCacheClear;hasRequired_listCacheClear=1;function Y(){this.__data__=[],this.size=0}return _listCacheClear=Y,_listCacheClear}var eq_1,hasRequiredEq;function requireEq(){if(hasRequiredEq)return eq_1;hasRequiredEq=1;function Y(K,ee){return K===ee||K!==K&&ee!==ee}return eq_1=Y,eq_1}var _assocIndexOf,hasRequired_assocIndexOf;function require_assocIndexOf(){if(hasRequired_assocIndexOf)return _assocIndexOf;hasRequired_assocIndexOf=1;var Y=requireEq();function K(ee,ne){for(var re=ee.length;re--;)if(Y(ee[re][0],ne))return re;return-1}return _assocIndexOf=K,_assocIndexOf}var _listCacheDelete,hasRequired_listCacheDelete;function require_listCacheDelete(){if(hasRequired_listCacheDelete)return _listCacheDelete;hasRequired_listCacheDelete=1;var Y=require_assocIndexOf(),K=Array.prototype,ee=K.splice;function ne(re){var le=this.__data__,Q=Y(le,re);if(Q<0)return!1;var R=le.length-1;return Q==R?le.pop():ee.call(le,Q,1),--this.size,!0}return _listCacheDelete=ne,_listCacheDelete}var _listCacheGet,hasRequired_listCacheGet;function require_listCacheGet(){if(hasRequired_listCacheGet)return _listCacheGet;hasRequired_listCacheGet=1;var Y=require_assocIndexOf();function K(ee){var ne=this.__data__,re=Y(ne,ee);return re<0?void 0:ne[re][1]}return _listCacheGet=K,_listCacheGet}var _listCacheHas,hasRequired_listCacheHas;function require_listCacheHas(){if(hasRequired_listCacheHas)return _listCacheHas;hasRequired_listCacheHas=1;var Y=require_assocIndexOf();function K(ee){return Y(this.__data__,ee)>-1}return _listCacheHas=K,_listCacheHas}var _listCacheSet,hasRequired_listCacheSet;function require_listCacheSet(){if(hasRequired_listCacheSet)return _listCacheSet;hasRequired_listCacheSet=1;var Y=require_assocIndexOf();function K(ee,ne){var re=this.__data__,le=Y(re,ee);return le<0?(++this.size,re.push([ee,ne])):re[le][1]=ne,this}return _listCacheSet=K,_listCacheSet}var _ListCache,hasRequired_ListCache;function require_ListCache(){if(hasRequired_ListCache)return _ListCache;hasRequired_ListCache=1;var Y=require_listCacheClear(),K=require_listCacheDelete(),ee=require_listCacheGet(),ne=require_listCacheHas(),re=require_listCacheSet();function le(Q){var R=-1,U=Q==null?0:Q.length;for(this.clear();++R<U;){var Z=Q[R];this.set(Z[0],Z[1])}}return le.prototype.clear=Y,le.prototype.delete=K,le.prototype.get=ee,le.prototype.has=ne,le.prototype.set=re,_ListCache=le,_ListCache}var _Map,hasRequired_Map;function require_Map(){if(hasRequired_Map)return _Map;hasRequired_Map=1;var Y=require_getNative(),K=require_root(),ee=Y(K,"Map");return _Map=ee,_Map}var _mapCacheClear,hasRequired_mapCacheClear;function require_mapCacheClear(){if(hasRequired_mapCacheClear)return _mapCacheClear;hasRequired_mapCacheClear=1;var Y=require_Hash(),K=require_ListCache(),ee=require_Map();function ne(){this.size=0,this.__data__={hash:new Y,map:new(ee||K),string:new Y}}return _mapCacheClear=ne,_mapCacheClear}var _isKeyable,hasRequired_isKeyable;function require_isKeyable(){if(hasRequired_isKeyable)return _isKeyable;hasRequired_isKeyable=1;function Y(K){var ee=typeof K;return ee=="string"||ee=="number"||ee=="symbol"||ee=="boolean"?K!=="__proto__":K===null}return _isKeyable=Y,_isKeyable}var _getMapData,hasRequired_getMapData;function require_getMapData(){if(hasRequired_getMapData)return _getMapData;hasRequired_getMapData=1;var Y=require_isKeyable();function K(ee,ne){var re=ee.__data__;return Y(ne)?re[typeof ne=="string"?"string":"hash"]:re.map}return _getMapData=K,_getMapData}var _mapCacheDelete,hasRequired_mapCacheDelete;function require_mapCacheDelete(){if(hasRequired_mapCacheDelete)return _mapCacheDelete;hasRequired_mapCacheDelete=1;var Y=require_getMapData();function K(ee){var ne=Y(this,ee).delete(ee);return this.size-=ne?1:0,ne}return _mapCacheDelete=K,_mapCacheDelete}var _mapCacheGet,hasRequired_mapCacheGet;function require_mapCacheGet(){if(hasRequired_mapCacheGet)return _mapCacheGet;hasRequired_mapCacheGet=1;var Y=require_getMapData();function K(ee){return Y(this,ee).get(ee)}return _mapCacheGet=K,_mapCacheGet}var _mapCacheHas,hasRequired_mapCacheHas;function require_mapCacheHas(){if(hasRequired_mapCacheHas)return _mapCacheHas;hasRequired_mapCacheHas=1;var Y=require_getMapData();function K(ee){return Y(this,ee).has(ee)}return _mapCacheHas=K,_mapCacheHas}var _mapCacheSet,hasRequired_mapCacheSet;function require_mapCacheSet(){if(hasRequired_mapCacheSet)return _mapCacheSet;hasRequired_mapCacheSet=1;var Y=require_getMapData();function K(ee,ne){var re=Y(this,ee),le=re.size;return re.set(ee,ne),this.size+=re.size==le?0:1,this}return _mapCacheSet=K,_mapCacheSet}var _MapCache,hasRequired_MapCache;function require_MapCache(){if(hasRequired_MapCache)return _MapCache;hasRequired_MapCache=1;var Y=require_mapCacheClear(),K=require_mapCacheDelete(),ee=require_mapCacheGet(),ne=require_mapCacheHas(),re=require_mapCacheSet();function le(Q){var R=-1,U=Q==null?0:Q.length;for(this.clear();++R<U;){var Z=Q[R];this.set(Z[0],Z[1])}}return le.prototype.clear=Y,le.prototype.delete=K,le.prototype.get=ee,le.prototype.has=ne,le.prototype.set=re,_MapCache=le,_MapCache}var memoize_1,hasRequiredMemoize;function requireMemoize(){if(hasRequiredMemoize)return memoize_1;hasRequiredMemoize=1;var Y=require_MapCache(),K="Expected a function";function ee(ne,re){if(typeof ne!="function"||re!=null&&typeof re!="function")throw new TypeError(K);var le=function(){var Q=arguments,R=re?re.apply(this,Q):Q[0],U=le.cache;if(U.has(R))return U.get(R);var Z=ne.apply(this,Q);return le.cache=U.set(R,Z)||U,Z};return le.cache=new(ee.Cache||Y),le}return ee.Cache=Y,memoize_1=ee,memoize_1}var memoizeExports=requireMemoize();const memoize=getDefaultExportFromCjs(memoizeExports);var isArray_1,hasRequiredIsArray;function requireIsArray(){if(hasRequiredIsArray)return isArray_1;hasRequiredIsArray=1;var Y=Array.isArray;return isArray_1=Y,isArray_1}var _isKey,hasRequired_isKey;function require_isKey(){if(hasRequired_isKey)return _isKey;hasRequired_isKey=1;var Y=requireIsArray(),K=requireIsSymbol(),ee=/\.|\[(?:[^[\]]*|(["'])(?:(?!\1)[^\\]|\\.)*?\1)\]/,ne=/^\w*$/;function re(le,Q){if(Y(le))return!1;var R=typeof le;return R=="number"||R=="symbol"||R=="boolean"||le==null||K(le)?!0:ne.test(le)||!ee.test(le)||Q!=null&&le in Object(Q)}return _isKey=re,_isKey}var _memoizeCapped,hasRequired_memoizeCapped;function require_memoizeCapped(){if(hasRequired_memoizeCapped)return _memoizeCapped;hasRequired_memoizeCapped=1;var Y=requireMemoize(),K=500;function ee(ne){var re=Y(ne,function(Q){return le.size===K&&le.clear(),Q}),le=re.cache;return re}return _memoizeCapped=ee,_memoizeCapped}var _stringToPath,hasRequired_stringToPath;function require_stringToPath(){if(hasRequired_stringToPath)return _stringToPath;hasRequired_stringToPath=1;var Y=require_memoizeCapped(),K=/[^.[\]]+|\[(?:(-?\d+(?:\.\d+)?)|(["'])((?:(?!\2)[^\\]|\\.)*?)\2)\]|(?=(?:\.|\[\])(?:\.|\[\]|$))/g,ee=/\\(\\)?/g,ne=Y(function(re){var le=[];return re.charCodeAt(0)===46&&le.push(""),re.replace(K,function(Q,R,U,Z){le.push(U?Z.replace(ee,"$1"):R||Q)}),le});return _stringToPath=ne,_stringToPath}var _arrayMap,hasRequired_arrayMap;function require_arrayMap(){if(hasRequired_arrayMap)return _arrayMap;hasRequired_arrayMap=1;function Y(K,ee){for(var ne=-1,re=K==null?0:K.length,le=Array(re);++ne<re;)le[ne]=ee(K[ne],ne,K);return le}return _arrayMap=Y,_arrayMap}var _baseToString,hasRequired_baseToString;function require_baseToString(){if(hasRequired_baseToString)return _baseToString;hasRequired_baseToString=1;var Y=require_Symbol(),K=require_arrayMap(),ee=requireIsArray(),ne=requireIsSymbol(),re=Y?Y.prototype:void 0,le=re?re.toString:void 0;function Q(R){if(typeof R=="string")return R;if(ee(R))return K(R,Q)+"";if(ne(R))return le?le.call(R):"";var U=R+"";return U=="0"&&1/R==-1/0?"-0":U}return _baseToString=Q,_baseToString}var toString_1,hasRequiredToString;function requireToString(){if(hasRequiredToString)return toString_1;hasRequiredToString=1;var Y=require_baseToString();function K(ee){return ee==null?"":Y(ee)}return toString_1=K,toString_1}var _castPath,hasRequired_castPath;function require_castPath(){if(hasRequired_castPath)return _castPath;hasRequired_castPath=1;var Y=requireIsArray(),K=require_isKey(),ee=require_stringToPath(),ne=requireToString();function re(le,Q){return Y(le)?le:K(le,Q)?[le]:ee(ne(le))}return _castPath=re,_castPath}var _toKey,hasRequired_toKey;function require_toKey(){if(hasRequired_toKey)return _toKey;hasRequired_toKey=1;var Y=requireIsSymbol();function K(ee){if(typeof ee=="string"||Y(ee))return ee;var ne=ee+"";return ne=="0"&&1/ee==-1/0?"-0":ne}return _toKey=K,_toKey}var _baseGet,hasRequired_baseGet;function require_baseGet(){if(hasRequired_baseGet)return _baseGet;hasRequired_baseGet=1;var Y=require_castPath(),K=require_toKey();function ee(ne,re){re=Y(re,ne);for(var le=0,Q=re.length;ne!=null&&le<Q;)ne=ne[K(re[le++])];return le&&le==Q?ne:void 0}return _baseGet=ee,_baseGet}var _defineProperty,hasRequired_defineProperty;function require_defineProperty(){if(hasRequired_defineProperty)return _defineProperty;hasRequired_defineProperty=1;var Y=require_getNative(),K=function(){try{var ee=Y(Object,"defineProperty");return ee({},"",{}),ee}catch{}}();return _defineProperty=K,_defineProperty}var _baseAssignValue,hasRequired_baseAssignValue;function require_baseAssignValue(){if(hasRequired_baseAssignValue)return _baseAssignValue;hasRequired_baseAssignValue=1;var Y=require_defineProperty();function K(ee,ne,re){ne=="__proto__"&&Y?Y(ee,ne,{configurable:!0,enumerable:!0,value:re,writable:!0}):ee[ne]=re}return _baseAssignValue=K,_baseAssignValue}var _assignValue,hasRequired_assignValue;function require_assignValue(){if(hasRequired_assignValue)return _assignValue;hasRequired_assignValue=1;var Y=require_baseAssignValue(),K=requireEq(),ee=Object.prototype,ne=ee.hasOwnProperty;function re(le,Q,R){var U=le[Q];(!(ne.call(le,Q)&&K(U,R))||R===void 0&&!(Q in le))&&Y(le,Q,R)}return _assignValue=re,_assignValue}var _isIndex,hasRequired_isIndex;function require_isIndex(){if(hasRequired_isIndex)return _isIndex;hasRequired_isIndex=1;var Y=9007199254740991,K=/^(?:0|[1-9]\d*)$/;function ee(ne,re){var le=typeof ne;return re=re??Y,!!re&&(le=="number"||le!="symbol"&&K.test(ne))&&ne>-1&&ne%1==0&&ne<re}return _isIndex=ee,_isIndex}var _baseSet,hasRequired_baseSet;function require_baseSet(){if(hasRequired_baseSet)return _baseSet;hasRequired_baseSet=1;var Y=require_assignValue(),K=require_castPath(),ee=require_isIndex(),ne=requireIsObject(),re=require_toKey();function le(Q,R,U,Z){if(!ne(Q))return Q;R=K(R,Q);for(var ae=-1,he=R.length,pe=he-1,me=Q;me!=null&&++ae<he;){var ve=re(R[ae]),Re=U;if(ve==="__proto__"||ve==="constructor"||ve==="prototype")return Q;if(ae!=pe){var Me=me[ve];Re=Z?Z(Me,ve,me):void 0,Re===void 0&&(Re=ne(Me)?Me:ee(R[ae+1])?[]:{})}Y(me,ve,Re),me=me[ve]}return Q}return _baseSet=le,_baseSet}var _basePickBy,hasRequired_basePickBy;function require_basePickBy(){if(hasRequired_basePickBy)return _basePickBy;hasRequired_basePickBy=1;var Y=require_baseGet(),K=require_baseSet(),ee=require_castPath();function ne(re,le,Q){for(var R=-1,U=le.length,Z={};++R<U;){var ae=le[R],he=Y(re,ae);Q(he,ae)&&K(Z,ee(ae,re),he)}return Z}return _basePickBy=ne,_basePickBy}var _baseHasIn,hasRequired_baseHasIn;function require_baseHasIn(){if(hasRequired_baseHasIn)return _baseHasIn;hasRequired_baseHasIn=1;function Y(K,ee){return K!=null&&ee in Object(K)}return _baseHasIn=Y,_baseHasIn}var _baseIsArguments,hasRequired_baseIsArguments;function require_baseIsArguments(){if(hasRequired_baseIsArguments)return _baseIsArguments;hasRequired_baseIsArguments=1;var Y=require_baseGetTag(),K=requireIsObjectLike(),ee="[object Arguments]";function ne(re){return K(re)&&Y(re)==ee}return _baseIsArguments=ne,_baseIsArguments}var isArguments_1,hasRequiredIsArguments;function requireIsArguments(){if(hasRequiredIsArguments)return isArguments_1;hasRequiredIsArguments=1;var Y=require_baseIsArguments(),K=requireIsObjectLike(),ee=Object.prototype,ne=ee.hasOwnProperty,re=ee.propertyIsEnumerable,le=Y(function(){return arguments}())?Y:function(Q){return K(Q)&&ne.call(Q,"callee")&&!re.call(Q,"callee")};return isArguments_1=le,isArguments_1}var isLength_1,hasRequiredIsLength;function requireIsLength(){if(hasRequiredIsLength)return isLength_1;hasRequiredIsLength=1;var Y=9007199254740991;function K(ee){return typeof ee=="number"&&ee>-1&&ee%1==0&&ee<=Y}return isLength_1=K,isLength_1}var _hasPath,hasRequired_hasPath;function require_hasPath(){if(hasRequired_hasPath)return _hasPath;hasRequired_hasPath=1;var Y=require_castPath(),K=requireIsArguments(),ee=requireIsArray(),ne=require_isIndex(),re=requireIsLength(),le=require_toKey();function Q(R,U,Z){U=Y(U,R);for(var ae=-1,he=U.length,pe=!1;++ae<he;){var me=le(U[ae]);if(!(pe=R!=null&&Z(R,me)))break;R=R[me]}return pe||++ae!=he?pe:(he=R==null?0:R.length,!!he&&re(he)&&ne(me,he)&&(ee(R)||K(R)))}return _hasPath=Q,_hasPath}var hasIn_1,hasRequiredHasIn;function requireHasIn(){if(hasRequiredHasIn)return hasIn_1;hasRequiredHasIn=1;var Y=require_baseHasIn(),K=require_hasPath();function ee(ne,re){return ne!=null&&K(ne,re,Y)}return hasIn_1=ee,hasIn_1}var _basePick,hasRequired_basePick;function require_basePick(){if(hasRequired_basePick)return _basePick;hasRequired_basePick=1;var Y=require_basePickBy(),K=requireHasIn();function ee(ne,re){return Y(ne,re,function(le,Q){return K(ne,Q)})}return _basePick=ee,_basePick}var _arrayPush,hasRequired_arrayPush;function require_arrayPush(){if(hasRequired_arrayPush)return _arrayPush;hasRequired_arrayPush=1;function Y(K,ee){for(var ne=-1,re=ee.length,le=K.length;++ne<re;)K[le+ne]=ee[ne];return K}return _arrayPush=Y,_arrayPush}var _isFlattenable,hasRequired_isFlattenable;function require_isFlattenable(){if(hasRequired_isFlattenable)return _isFlattenable;hasRequired_isFlattenable=1;var Y=require_Symbol(),K=requireIsArguments(),ee=requireIsArray(),ne=Y?Y.isConcatSpreadable:void 0;function re(le){return ee(le)||K(le)||!!(ne&&le&&le[ne])}return _isFlattenable=re,_isFlattenable}var _baseFlatten,hasRequired_baseFlatten;function require_baseFlatten(){if(hasRequired_baseFlatten)return _baseFlatten;hasRequired_baseFlatten=1;var Y=require_arrayPush(),K=require_isFlattenable();function ee(ne,re,le,Q,R){var U=-1,Z=ne.length;for(le||(le=K),R||(R=[]);++U<Z;){var ae=ne[U];re>0&&le(ae)?re>1?ee(ae,re-1,le,Q,R):Y(R,ae):Q||(R[R.length]=ae)}return R}return _baseFlatten=ee,_baseFlatten}var flatten_1,hasRequiredFlatten;function requireFlatten(){if(hasRequiredFlatten)return flatten_1;hasRequiredFlatten=1;var Y=require_baseFlatten();function K(ee){var ne=ee==null?0:ee.length;return ne?Y(ee,1):[]}return flatten_1=K,flatten_1}var _apply,hasRequired_apply;function require_apply(){if(hasRequired_apply)return _apply;hasRequired_apply=1;function Y(K,ee,ne){switch(ne.length){case 0:return K.call(ee);case 1:return K.call(ee,ne[0]);case 2:return K.call(ee,ne[0],ne[1]);case 3:return K.call(ee,ne[0],ne[1],ne[2])}return K.apply(ee,ne)}return _apply=Y,_apply}var _overRest,hasRequired_overRest;function require_overRest(){if(hasRequired_overRest)return _overRest;hasRequired_overRest=1;var Y=require_apply(),K=Math.max;function ee(ne,re,le){return re=K(re===void 0?ne.length-1:re,0),function(){for(var Q=arguments,R=-1,U=K(Q.length-re,0),Z=Array(U);++R<U;)Z[R]=Q[re+R];R=-1;for(var ae=Array(re+1);++R<re;)ae[R]=Q[R];return ae[re]=le(Z),Y(ne,this,ae)}}return _overRest=ee,_overRest}var constant_1,hasRequiredConstant;function requireConstant(){if(hasRequiredConstant)return constant_1;hasRequiredConstant=1;function Y(K){return function(){return K}}return constant_1=Y,constant_1}var identity_1,hasRequiredIdentity;function requireIdentity(){if(hasRequiredIdentity)return identity_1;hasRequiredIdentity=1;function Y(K){return K}return identity_1=Y,identity_1}var _baseSetToString,hasRequired_baseSetToString;function require_baseSetToString(){if(hasRequired_baseSetToString)return _baseSetToString;hasRequired_baseSetToString=1;var Y=requireConstant(),K=require_defineProperty(),ee=requireIdentity(),ne=K?function(re,le){return K(re,"toString",{configurable:!0,enumerable:!1,value:Y(le),writable:!0})}:ee;return _baseSetToString=ne,_baseSetToString}var _shortOut,hasRequired_shortOut;function require_shortOut(){if(hasRequired_shortOut)return _shortOut;hasRequired_shortOut=1;var Y=800,K=16,ee=Date.now;function ne(re){var le=0,Q=0;return function(){var R=ee(),U=K-(R-Q);if(Q=R,U>0){if(++le>=Y)return arguments[0]}else le=0;return re.apply(void 0,arguments)}}return _shortOut=ne,_shortOut}var _setToString,hasRequired_setToString;function require_setToString(){if(hasRequired_setToString)return _setToString;hasRequired_setToString=1;var Y=require_baseSetToString(),K=require_shortOut(),ee=K(Y);return _setToString=ee,_setToString}var _flatRest,hasRequired_flatRest;function require_flatRest(){if(hasRequired_flatRest)return _flatRest;hasRequired_flatRest=1;var Y=requireFlatten(),K=require_overRest(),ee=require_setToString();function ne(re){return ee(K(re,void 0,Y),re+"")}return _flatRest=ne,_flatRest}var pick_1,hasRequiredPick;function requirePick(){if(hasRequiredPick)return pick_1;hasRequiredPick=1;var Y=require_basePick(),K=require_flatRest(),ee=K(function(ne,re){return ne==null?{}:Y(ne,re)});return pick_1=ee,pick_1}var pickExports=requirePick();const pick$1=getDefaultExportFromCjs(pickExports),token="%[a-f0-9]{2}",singleMatcher=new RegExp("("+token+")|([^%]+?)","gi"),multiMatcher=new RegExp("("+token+")+","gi");function decodeComponents(Y,K){try{return[decodeURIComponent(Y.join(""))]}catch{}if(Y.length===1)return Y;K=K||1;const ee=Y.slice(0,K),ne=Y.slice(K);return Array.prototype.concat.call([],decodeComponents(ee),decodeComponents(ne))}function decode$1(Y){try{return decodeURIComponent(Y)}catch{let K=Y.match(singleMatcher)||[];for(let ee=1;ee<K.length;ee++)Y=decodeComponents(K,ee).join(""),K=Y.match(singleMatcher)||[];return Y}}function customDecodeURIComponent(Y){const K={"%FE%FF":"��","%FF%FE":"��"};let ee=multiMatcher.exec(Y);for(;ee;){try{K[ee[0]]=decodeURIComponent(ee[0])}catch{const re=decode$1(ee[0]);re!==ee[0]&&(K[ee[0]]=re)}ee=multiMatcher.exec(Y)}K["%C2"]="�";const ne=Object.keys(K);for(const re of ne)Y=Y.replace(new RegExp(re,"g"),K[re]);return Y}function decodeUriComponent(Y){if(typeof Y!="string")throw new TypeError("Expected `encodedURI` to be of type `string`, got `"+typeof Y+"`");try{return decodeURIComponent(Y)}catch{return customDecodeURIComponent(Y)}}function includeKeys(Y,K){const ee={};if(Array.isArray(K))for(const ne of K){const re=Object.getOwnPropertyDescriptor(Y,ne);re!=null&&re.enumerable&&Object.defineProperty(ee,ne,re)}else for(const ne of Reflect.ownKeys(Y)){const re=Object.getOwnPropertyDescriptor(Y,ne);if(re.enumerable){const le=Y[ne];K(ne,le,Y)&&Object.defineProperty(ee,ne,re)}}return ee}function splitOnFirst(Y,K){if(!(typeof Y=="string"&&typeof K=="string"))throw new TypeError("Expected the arguments to be of type `string`");if(Y===""||K==="")return[];const ee=Y.indexOf(K);return ee===-1?[]:[Y.slice(0,ee),Y.slice(ee+K.length)]}const isNullOrUndefined=Y=>Y==null,strictUriEncode=Y=>encodeURIComponent(Y).replaceAll(/[!'()*]/g,K=>`%${K.charCodeAt(0).toString(16).toUpperCase()}`),encodeFragmentIdentifier=Symbol("encodeFragmentIdentifier");function encoderForArrayFormat(Y){switch(Y.arrayFormat){case"index":return K=>(ee,ne)=>{const re=ee.length;return ne===void 0||Y.skipNull&&ne===null||Y.skipEmptyString&&ne===""?ee:ne===null?[...ee,[encode(K,Y),"[",re,"]"].join("")]:[...ee,[encode(K,Y),"[",encode(re,Y),"]=",encode(ne,Y)].join("")]};case"bracket":return K=>(ee,ne)=>ne===void 0||Y.skipNull&&ne===null||Y.skipEmptyString&&ne===""?ee:ne===null?[...ee,[encode(K,Y),"[]"].join("")]:[...ee,[encode(K,Y),"[]=",encode(ne,Y)].join("")];case"colon-list-separator":return K=>(ee,ne)=>ne===void 0||Y.skipNull&&ne===null||Y.skipEmptyString&&ne===""?ee:ne===null?[...ee,[encode(K,Y),":list="].join("")]:[...ee,[encode(K,Y),":list=",encode(ne,Y)].join("")];case"comma":case"separator":case"bracket-separator":{const K=Y.arrayFormat==="bracket-separator"?"[]=":"=";return ee=>(ne,re)=>re===void 0||Y.skipNull&&re===null||Y.skipEmptyString&&re===""?ne:(re=re===null?"":re,ne.length===0?[[encode(ee,Y),K,encode(re,Y)].join("")]:[[ne,encode(re,Y)].join(Y.arrayFormatSeparator)])}default:return K=>(ee,ne)=>ne===void 0||Y.skipNull&&ne===null||Y.skipEmptyString&&ne===""?ee:ne===null?[...ee,encode(K,Y)]:[...ee,[encode(K,Y),"=",encode(ne,Y)].join("")]}}function parserForArrayFormat(Y){let K;switch(Y.arrayFormat){case"index":return(ee,ne,re)=>{if(K=/\[(\d*)]$/.exec(ee),ee=ee.replace(/\[\d*]$/,""),!K){re[ee]=ne;return}re[ee]===void 0&&(re[ee]={}),re[ee][K[1]]=ne};case"bracket":return(ee,ne,re)=>{if(K=/(\[])$/.exec(ee),ee=ee.replace(/\[]$/,""),!K){re[ee]=ne;return}if(re[ee]===void 0){re[ee]=[ne];return}re[ee]=[...re[ee],ne]};case"colon-list-separator":return(ee,ne,re)=>{if(K=/(:list)$/.exec(ee),ee=ee.replace(/:list$/,""),!K){re[ee]=ne;return}if(re[ee]===void 0){re[ee]=[ne];return}re[ee]=[...re[ee],ne]};case"comma":case"separator":return(ee,ne,re)=>{const le=typeof ne=="string"&&ne.includes(Y.arrayFormatSeparator),Q=typeof ne=="string"&&!le&&decode(ne,Y).includes(Y.arrayFormatSeparator);ne=Q?decode(ne,Y):ne;const R=le||Q?ne.split(Y.arrayFormatSeparator).map(U=>decode(U,Y)):ne===null?ne:decode(ne,Y);re[ee]=R};case"bracket-separator":return(ee,ne,re)=>{const le=/(\[])$/.test(ee);if(ee=ee.replace(/\[]$/,""),!le){re[ee]=ne&&decode(ne,Y);return}const Q=ne===null?[]:decode(ne,Y).split(Y.arrayFormatSeparator);if(re[ee]===void 0){re[ee]=Q;return}re[ee]=[...re[ee],...Q]};default:return(ee,ne,re)=>{if(re[ee]===void 0){re[ee]=ne;return}re[ee]=[...[re[ee]].flat(),ne]}}}function validateArrayFormatSeparator(Y){if(typeof Y!="string"||Y.length!==1)throw new TypeError("arrayFormatSeparator must be single character string")}function encode(Y,K){return K.encode?K.strict?strictUriEncode(Y):encodeURIComponent(Y):Y}function decode(Y,K){return K.decode?decodeUriComponent(Y):Y}function keysSorter(Y){return Array.isArray(Y)?Y.sort():typeof Y=="object"?keysSorter(Object.keys(Y)).sort((K,ee)=>Number(K)-Number(ee)).map(K=>Y[K]):Y}function removeHash(Y){const K=Y.indexOf("#");return K!==-1&&(Y=Y.slice(0,K)),Y}function getHash(Y){let K="";const ee=Y.indexOf("#");return ee!==-1&&(K=Y.slice(ee)),K}function parseValue(Y,K,ee){return ee==="string"&&typeof Y=="string"?Y:typeof ee=="function"&&typeof Y=="string"?ee(Y):ee==="boolean"&&Y===null?!0:ee==="boolean"&&Y!==null&&(Y.toLowerCase()==="true"||Y.toLowerCase()==="false")?Y.toLowerCase()==="true":ee==="boolean"&&Y!==null&&(Y.toLowerCase()==="1"||Y.toLowerCase()==="0")?Y.toLowerCase()==="1":ee==="string[]"&&K.arrayFormat!=="none"&&typeof Y=="string"?[Y]:ee==="number[]"&&K.arrayFormat!=="none"&&!Number.isNaN(Number(Y))&&typeof Y=="string"&&Y.trim()!==""?[Number(Y)]:ee==="number"&&!Number.isNaN(Number(Y))&&typeof Y=="string"&&Y.trim()!==""?Number(Y):K.parseBooleans&&Y!==null&&(Y.toLowerCase()==="true"||Y.toLowerCase()==="false")?Y.toLowerCase()==="true":K.parseNumbers&&!Number.isNaN(Number(Y))&&typeof Y=="string"&&Y.trim()!==""?Number(Y):Y}function extract(Y){Y=removeHash(Y);const K=Y.indexOf("?");return K===-1?"":Y.slice(K+1)}function parse(Y,K){K={decode:!0,sort:!0,arrayFormat:"none",arrayFormatSeparator:",",parseNumbers:!1,parseBooleans:!1,types:Object.create(null),...K},validateArrayFormatSeparator(K.arrayFormatSeparator);const ee=parserForArrayFormat(K),ne=Object.create(null);if(typeof Y!="string"||(Y=Y.trim().replace(/^[?#&]/,""),!Y))return ne;for(const re of Y.split("&")){if(re==="")continue;const le=K.decode?re.replaceAll("+"," "):re;let[Q,R]=splitOnFirst(le,"=");Q===void 0&&(Q=le),R=R===void 0?null:["comma","separator","bracket-separator"].includes(K.arrayFormat)?R:decode(R,K),ee(decode(Q,K),R,ne)}for(const[re,le]of Object.entries(ne))if(typeof le=="object"&&le!==null&&K.types[re]!=="string")for(const[Q,R]of Object.entries(le)){const U=K.types[re]?K.types[re].replace("[]",""):void 0;le[Q]=parseValue(R,K,U)}else typeof le=="object"&&le!==null&&K.types[re]==="string"?ne[re]=Object.values(le).join(K.arrayFormatSeparator):ne[re]=parseValue(le,K,K.types[re]);return K.sort===!1?ne:(K.sort===!0?Object.keys(ne).sort():Object.keys(ne).sort(K.sort)).reduce((re,le)=>{const Q=ne[le];return re[le]=Q&&typeof Q=="object"&&!Array.isArray(Q)?keysSorter(Q):Q,re},Object.create(null))}function stringify(Y,K){if(!Y)return"";K={encode:!0,strict:!0,arrayFormat:"none",arrayFormatSeparator:",",...K},validateArrayFormatSeparator(K.arrayFormatSeparator);const ee=Q=>K.skipNull&&isNullOrUndefined(Y[Q])||K.skipEmptyString&&Y[Q]==="",ne=encoderForArrayFormat(K),re={};for(const[Q,R]of Object.entries(Y))ee(Q)||(re[Q]=R);const le=Object.keys(re);return K.sort!==!1&&le.sort(K.sort),le.map(Q=>{const R=Y[Q];return R===void 0?"":R===null?encode(Q,K):Array.isArray(R)?R.length===0&&K.arrayFormat==="bracket-separator"?encode(Q,K)+"[]":R.reduce(ne(Q),[]).join("&"):encode(Q,K)+"="+encode(R,K)}).filter(Q=>Q.length>0).join("&")}function parseUrl(Y,K){var re;K={decode:!0,...K};let[ee,ne]=splitOnFirst(Y,"#");return ee===void 0&&(ee=Y),{url:((re=ee==null?void 0:ee.split("?"))==null?void 0:re[0])??"",query:parse(extract(Y),K),...K&&K.parseFragmentIdentifier&&ne?{fragmentIdentifier:decode(ne,K)}:{}}}function stringifyUrl(Y,K){K={encode:!0,strict:!0,[encodeFragmentIdentifier]:!0,...K};const ee=removeHash(Y.url).split("?")[0]||"",ne=extract(Y.url),re={...parse(ne,{sort:!1,...K}),...Y.query};let le=stringify(re,K);le&&(le=`?${le}`);let Q=getHash(Y.url);if(typeof Y.fragmentIdentifier=="string"){const R=new URL(ee);R.hash=Y.fragmentIdentifier,Q=K[encodeFragmentIdentifier]?R.hash:`#${Y.fragmentIdentifier}`}return`${ee}${le}${Q}`}function pick(Y,K,ee){ee={parseFragmentIdentifier:!0,[encodeFragmentIdentifier]:!1,...ee};const{url:ne,query:re,fragmentIdentifier:le}=parseUrl(Y,ee);return stringifyUrl({url:ne,query:includeKeys(re,K),fragmentIdentifier:le},ee)}function exclude(Y,K,ee){const ne=Array.isArray(K)?re=>!K.includes(re):(re,le)=>!K(re,le);return pick(Y,ne,ee)}const queryString=Object.freeze(Object.defineProperty({__proto__:null,exclude,extract,parse,parseUrl,pick,stringify,stringifyUrl},Symbol.toStringTag,{value:"Module"})),{parse:_qsParse,stringify:qsStringify}=queryString,qsParse=memoize(_qsParse),decodeString=Y=>Y,decodeBoolean=Y=>Y==="true",decodeInteger=Y=>parseInt(Y),PERSISTED_STATE_FIELDS={feedUrl:{decode:decodeString,apply:(Y,K)=>K.emit("feed:set-url",Y)},feedSyncStopped:{decode:decodeBoolean,apply:(Y,K)=>{K.emit(`feed:${Y?"stop":"start"}-sync`)}},feedSyncInterval:{decode:decodeInteger,apply:(Y,K)=>{K.emit("feed:set-sync-interval",Y)}},feedLogFilter:{decode:decodeString,apply:(Y,K)=>K.emit("feed-log:set-filter",Y)},inspectorFilter:{decode:decodeString,apply:(Y,K)=>K.emit("inspector:set-filter",Y)},view:{decode:decodeString,apply:(Y,K)=>K.emit("view:set",Y)},shapeIdsByTripIdUrl:{decode:decodeString,apply:(Y,K)=>K.emit("shape-ids-by-trip-id-url:set",Y)},shapeUrl:{decode:decodeString,apply:(Y,K)=>K.emit("shape-url:set",Y)},focusedTripId:{decode:decodeString,apply:(Y,K)=>K.emit("focus-trip-id",Y)},focusedVehicleId:{decode:decodeString,apply:(Y,K)=>K.emit("focus-vehicle-id",Y)}},pluckState=Y=>pick$1(Y,Object.keys(PERSISTED_STATE_FIELDS)),urlStore=(Y,K)=>{const ee=le=>{for(const[Q,R]of Object.entries(le)){const{decode:U,apply:Z}=PERSISTED_STATE_FIELDS[Q];Z(U(R),K)}K.emit(K.STATE_CHANGE)};window.addEventListener("popstate",le=>{const Q=pluckState(le.state||{});ee(Q)});const ne=debounce(()=>{const le=pluckState(Y),Q={...qsParse(location.search.slice(1)),...le},R="?"+qsStringify(Q);R!==location.search&&history.replaceState(le,"_",R)},500,{leading:!0});K.on(K.STATE_CHANGE,ne);const re=pluckState(qsParse(location.search.slice(1)));setTimeout(ee,1,re)},homepage="https://github.com/derhuerst/gtfs-rt-inspector",pkg={homepage},barView=({state:Y,emit:K})=>{const ee=(Z,ae)=>{const he=pe=>{pe.metaKey||pe.ctrlKey||(pe.preventDefault(),K("view:set",Z))};return u("li",{class:ae?"active":null,children:u("a",{href:"?view="+Z,onClick:he,children:Z})})},ne=u("ul",{class:"nav",children:[ee("log",Y.view==="log"),ee("inspector",Y.view==="inspector"),ee("map",Y.view==="map"),ee("raw",Y.view==="raw"),u("li",{children:u("a",{href:pkg.homepage,target:"_parent",title:name+" homepage",children:"?"})})]}),re=Z=>{K("feed:set-url",Z.target.value)},le=()=>{K("feed:sync")},Q=()=>{Y.feedSyncStopped?K("feed:start-sync"):K("feed:stop-sync")},R=Z=>{const ae=parseInt(Z.target.value);K("feed:set-sync-interval",ae)},U=u("div",{class:"feed",children:[u("input",{onInput:re,value:Y.feedUrl}),u("input",{class:"interval",type:"number",min:"1",step:"10",onChange:R,value:Y.feedSyncInterval}),u("button",{class:Y.feedSyncing?"sync syncing":"sync",onClick:le,disabled:!Y.feedUrl||!!Y.feedSyncing,children:u("span",{children:"↻"})}),u("button",{onClick:Q,disabled:!Y.feedUrl,children:Y.feedSyncStopped?"▶️":"⏸"})]});return u("div",{class:"bar",children:[u("div",{class:"logo",children:"🚂🔍"}),ne,U]})};var ms$1,hasRequiredMs;function requireMs(){if(hasRequiredMs)return ms$1;hasRequiredMs=1;var Y=1e3,K=Y*60,ee=K*60,ne=ee*24,re=ne*7,le=ne*365.25;ms$1=function(ae,he){he=he||{};var pe=typeof ae;if(pe==="string"&&ae.length>0)return Q(ae);if(pe==="number"&&isFinite(ae))return he.long?U(ae):R(ae);throw new Error("val is not a non-empty string or a valid number. val="+JSON.stringify(ae))};function Q(ae){if(ae=String(ae),!(ae.length>100)){var he=/^(-?(?:\d+)?\.?\d+) *(milliseconds?|msecs?|ms|seconds?|secs?|s|minutes?|mins?|m|hours?|hrs?|h|days?|d|weeks?|w|years?|yrs?|y)?$/i.exec(ae);if(he){var pe=parseFloat(he[1]),me=(he[2]||"ms").toLowerCase();switch(me){case"years":case"year":case"yrs":case"yr":case"y":return pe*le;case"weeks":case"week":case"w":return pe*re;case"days":case"day":case"d":return pe*ne;case"hours":case"hour":case"hrs":case"hr":case"h":return pe*ee;case"minutes":case"minute":case"mins":case"min":case"m":return pe*K;case"seconds":case"second":case"secs":case"sec":case"s":return pe*Y;case"milliseconds":case"millisecond":case"msecs":case"msec":case"ms":return pe;default:return}}}}function R(ae){var he=Math.abs(ae);return he>=ne?Math.round(ae/ne)+"d":he>=ee?Math.round(ae/ee)+"h":he>=K?Math.round(ae/K)+"m":he>=Y?Math.round(ae/Y)+"s":ae+"ms"}function U(ae){var he=Math.abs(ae);return he>=ne?Z(ae,he,ne,"day"):he>=ee?Z(ae,he,ee,"hour"):he>=K?Z(ae,he,K,"minute"):he>=Y?Z(ae,he,Y,"second"):ae+" ms"}function Z(ae,he,pe,me){var ve=he>=pe*1.5;return Math.round(ae/pe)+" "+me+(ve?"s":"")}return ms$1}var msExports=requireMs();const ms=getDefaultExportFromCjs(msExports),renderDelay=Y=>typeof Y!="number"?"?":Y===0?"0s":ms(Y*1e3),renderMaxItemsMsg=(Y,K)=>Y<K?null:u("p",{children:["Only ",K," items are displayed. Use the filter search box above to get fewer items."]}),renderFilterInput=(Y,K)=>u("p",{children:u("input",{value:Y??"",onChange:ee=>K(ee.target.value),placeholder:"filter by text"})}),renderTimestamp=Y=>Y?new Date(Y*1e3).toISOString():"?",{SCHEDULED:SCHEDULED$1,SKIPPED,NO_DATA}=gtfsRtBindingsExports.TripUpdate.StopTimeUpdate.ScheduleRelationship,renderStopTimeUpdateScheduleRelationship=Y=>Y===SCHEDULED$1?u("code",{children:u("abbr",{title:"SCHEDULED",children:"SCHED"})}):Y===SKIPPED?u("code",{children:u("abbr",{title:"SKIPPED",children:"SKIP"})}):Y===NO_DATA?u("code",{children:u("abbr",{title:"NO_DATA",children:"NO_DATA"})}):"?",renderFeedLogEntry=Y=>{const{entityId:K,timestamp:ee,routeId:ne,directionId:re,tripId:le,vehicleId:Q,vehicleLabel:R,stopId:U,scheduleRelationship:Z,tArrival:ae,delay:he}=Y;return u("tr",{id:"entity-"+K,children:[u("td",{children:u("code",{children:K})}),u("td",{children:renderTimestamp(ee)}),u("td",{children:u("code",{children:ne})}),u("td",{children:u("code",{children:re})}),u("td",{children:u("code",{children:le})}),u("td",{children:u("code",{children:Q})}),u("td",{children:u("code",{children:R})}),u("td",{children:u("code",{children:U})}),u("td",{children:renderStopTimeUpdateScheduleRelationship(Z)}),u("td",{children:renderTimestamp(ae)}),u("td",{children:renderDelay(he)})]})},logView=({state:Y,emit:K})=>{const{feedLogFilter:ee,feedLog:ne,unfilteredFeedLog:re}=Y,le=Q=>{K("feed-log:set-filter",Q)};return u("div",{class:"log",children:[u("h2",{children:["Upcoming ",u("code",{children:"StopTimeUpdate"}),"s (",ne.length," of ",re.length,")"]}),renderFilterInput(ee,le),renderMaxItemsMsg(ne.length,MAX_LOG_ITEMS),u("table",{children:[u("thead",{children:[u("tr",{children:[u("th",{rowspan:"2",children:u("code",{children:u("abbr",{title:"entity.id",children:"e_id"})})}),u("th",{rowspan:"2",children:u("abbr",{title:"stop_time_update[].timestamp or feed timestamp",children:u("code",{children:"t"})})}),u("th",{colspan:"2",children:u("code",{children:"trip"})}),u("th",{colspan:"3",children:u("code",{children:"vehicle"})}),u("th",{colspan:"4",children:u("code",{children:"stop_time_update"})})]}),u("tr",{children:[u("th",{children:u("code",{children:"route_id"})}),u("th",{children:u("code",{children:u("abbr",{title:"trip.direction_id",children:"dir_id"})})}),u("th",{children:u("code",{children:"trip_id"})}),u("th",{children:u("code",{children:"id"})}),u("th",{children:u("code",{children:"label"})}),u("th",{children:u("code",{children:"stop_id"})}),u("th",{children:u("abbr",{title:"stop_time_update[].schedule_relationship",children:"s_rel"})}),u("th",{children:u("code",{children:u("abbr",{title:"stop_time_update[].arrival.time",children:"arr"})})}),u("th",{children:u("code",{children:u("abbr",{title:"stop_time_update[].arrival.delay",children:"delay"})})})]})]}),u("tbody",{children:ne.map(renderFeedLogEntry)})]})]})},renderStartDate=Y=>typeof Y!="string"||!Y?"?":u("code",{children:u("abbr",{title:Y,children:[Y.slice(4,6),"-",Y.slice(6,8)]})}),renderStartTime=Y=>typeof Y!="string"||!Y?"?":u("code",{children:Y}),{SCHEDULED,ADDED,UNSCHEDULED,CANCELED,DUPLICATED,DELETED}=gtfsRtBindingsExports.TripDescriptor.ScheduleRelationship,renderTripScheduleRelationship=Y=>Y===SCHEDULED?u("code",{children:u("abbr",{title:"SCHEDULED",children:"SCHED"})}):Y===ADDED?u("code",{children:u("abbr",{title:"ADDED",children:"ADD"})}):Y===UNSCHEDULED?u("code",{children:u("abbr",{title:"UNSCHEDULED",children:"UNSCHED"})}):Y===CANCELED?u("code",{children:u("abbr",{title:"CANCELED",children:"CNCL"})}):Y===DUPLICATED?u("code",{children:u("abbr",{title:"DUPLICATED",children:"DUPL"})}):Y===DELETED?u("code",{children:u("abbr",{title:"DELETED",children:"DEL"})}):"?",{INCOMING_AT,STOPPED_AT,IN_TRANSIT_TO}=gtfsRtBindingsExports.VehiclePosition.VehicleStopStatus,renderVehicleStopStatus=Y=>Y===INCOMING_AT?u("code",{children:u("abbr",{title:"INCOMING_AT",children:"INC_AT"})}):Y===STOPPED_AT?u("code",{children:u("abbr",{title:"STOPPED_AT",children:"STOP_AT"})}):Y===IN_TRANSIT_TO?u("code",{children:u("abbr",{title:"IN_TRANSIT_TO",children:"IN_TR_TO"})}):"?",renderPosition=Y=>{if(!Y)return"?";const K=[typeof Y.latitude=="number"?Y.latitude:"?",typeof Y.longitude=="number"?Y.longitude:"?"].join(" | "),ee=typeof Y.latitude=="number"?u("code",{children:Y.latitude.toFixed(3)}):"?",ne=typeof Y.longitude=="number"?u("code",{children:Y.longitude.toFixed(3)}):"?";return u("abbr",{title:K,children:[ee," ",ne]})},{RUNNING_SMOOTHLY,STOP_AND_GO,CONGESTION,SEVERE_CONGESTION}=gtfsRtBindingsExports.VehiclePosition.CongestionLevel,renderCongestionLevel=Y=>Y===1?u("code",{children:u("abbr",{title:"RUNNING_SMOOTHLY",children:"SMOOTH"})}):Y===2?u("code",{children:u("abbr",{title:"STOP_AND_GO",children:"STOP_GO"})}):Y===3?u("code",{children:u("abbr",{title:"CONGESTION",children:"CONG"})}):Y===4?u("code",{children:u("abbr",{title:"SEVERE_CONGESTION",children:"SEV_CONG"})}):"?",{EMPTY,MANY_SEATS_AVAILABLE,FEW_SEATS_AVAILABLE,STANDING_ROOM_ONLY,CRUSHED_STANDING_ROOM_ONLY,FULL,NOT_ACCEPTING_PASSENGERS}=gtfsRtBindingsExports.VehiclePosition.OccupancyStatus,renderOccupancyStatus=Y=>Y===0?u("code",{children:u("abbr",{title:"EMPTY",children:"EMPTY"})}):Y===1?u("code",{children:u("abbr",{title:"MANY_SEATS_AVAILABLE",children:"MANY_SEATS"})}):Y===2?u("code",{children:u("abbr",{title:"FEW_SEATS_AVAILABLE",children:"FEW_SEATS"})}):Y===3?u("code",{children:u("abbr",{title:"STANDING_ROOM_ONLY",children:"STANDING"})}):Y===4?u("code",{children:u("abbr",{title:"CRUSHED_STANDING_ROOM_ONLY",children:"CRUSHED"})}):Y===5?u("code",{children:u("abbr",{title:"FULL",children:"FULL"})}):Y===6?u("code",{children:u("abbr",{title:"NOT_ACCEPTING_PASSENGERS",children:"NOT_ACCEPT"})}):"?",renderVehicleId=(Y,K,ee)=>u("a",{href:"#",onClick:re=>{ee("focus-vehicle-id",Y),ee("focus-trip-id",K.trip.trip_id),ee("view:set","map"),re.preventDefault()},alt:"show vehicle on the map",children:u("code",{children:Y})}),renderTripUpdate=(Y,K)=>{const ee=Y.trip_update.trip||{},ne=Y.trip_update.vehicle||{};return u("tr",{id:"entity-"+Y.id,children:[u("td",{children:u("code",{children:Y.id})}),u("td",{children:u("code",{children:ee.route_id})}),u("td",{children:u("code",{children:ee.direction_id})}),u("td",{children:u("code",{children:ee.trip_id})}),u("td",{children:renderStartDate(ee.start_date)}),u("td",{children:renderStartTime(ee.start_time)}),u("td",{children:renderTripScheduleRelationship(ee.schedule_relationship)}),u("td",{children:u("code",{children:ne.id})}),u("td",{children:u("code",{children:ne.label})}),u("td",{children:u("code",{children:ne.license_plate})}),u("td",{children:renderDelay(Y.trip_update.delay)})]})},renderTripUpdates=(Y,K)=>{const{tripUpdates:ee,unfilteredTripUpdates:ne}=Y;return u("div",{children:[u("h2",{children:[u("code",{children:"TripUpdate"}),"s (",ee.length," of ",ne.length,")"]}),renderMaxItemsMsg(ee.length,MAX_LOG_ITEMS),u("table",{class:"trip-updates",children:[u("thead",{children:[u("tr",{children:[u("th",{rowspan:"2",children:u("code",{children:u("abbr",{title:"entity_id",children:"e_id"})})}),u("th",{colspan:"5",children:u("code",{children:"trip"})}),u("th",{rowspan:"2",children:u("code",{children:u("abbr",{title:"schedule_relationship",children:"s_rel"})})}),u("th",{colspan:"3",children:u("code",{children:"vehicle"})}),u("th",{rowspan:"2",children:u("code",{children:"delay"})})]}),u("tr",{children:[u("th",{children:u("code",{children:"route_id"})}),u("th",{children:u("code",{children:u("abbr",{title:"direction_id",children:"dir_id"})})}),u("th",{children:u("code",{children:"trip_id"})}),u("th",{children:u("code",{children:u("abbr",{title:"start_date",children:"st_date"})})}),u("th",{children:u("code",{children:u("abbr",{title:"start_time",children:"st_time"})})}),u("th",{children:u("code",{children:"id"})}),u("th",{children:u("code",{children:"label"})}),u("th",{children:u("abbr",{title:"license_plate",children:u("code",{children:"lic_pl"})})})]})]}),u("tbody",{children:ee.map(renderTripUpdate)})]})]})},renderVehiclePosition=(Y,K)=>{const ee=Y.vehicle.trip||{},ne=Y.vehicle.vehicle||{};return u("tr",{id:"entity-"+Y.id,children:[u("td",{children:u("code",{children:Y.id})}),u("td",{children:u("code",{children:ee.route_id})}),u("td",{children:u("code",{children:ee.direction_id})}),u("td",{children:u("code",{children:ee.trip_id})}),u("td",{children:renderStartDate(ee.start_date)}),u("td",{children:renderStartTime(ee.start_time)}),u("td",{children:renderVehicleId(ne.id,Y.vehicle,K)}),u("td",{children:u("code",{children:ne.label})}),u("td",{children:u("code",{children:ne.license_plate})}),u("td",{children:u("code",{children:Y.vehicle.current_stop_sequence})}),u("td",{children:u("code",{children:Y.vehicle.stop_id})}),u("td",{children:renderVehicleStopStatus(Y.vehicle.current_status)}),u("td",{children:renderPosition(Y.vehicle.position)}),u("td",{children:renderCongestionLevel(Y.vehicle.congestion_level)}),u("td",{children:renderOccupancyStatus(Y.vehicle.occupancy_status)})]})},renderVehiclePositions=(Y,K)=>{const{vehiclePositions:ee,unfilteredVehiclePositions:ne}=Y;return u("div",{children:[u("h2",{children:[u("code",{children:"VehiclePosition"}),"s (",ee.length," of ",ne.length,")"]}),renderMaxItemsMsg(ee.length,MAX_LOG_ITEMS),u("table",{class:"vehicle-positions",children:[u("thead",{children:[u("tr",{children:[u("th",{rowspan:"2",children:u("code",{children:u("abbr",{title:"entity_id",children:"e_id"})})}),u("th",{colspan:"5",children:u("code",{children:"trip"})}),u("th",{colspan:"3",children:u("code",{children:"vehicle"})}),u("th",{rowspan:"2",children:u("code",{children:u("abbr",{title:"current_stop_sequence",children:"st_seq"})})}),u("th",{rowspan:"2",children:u("code",{children:"stop_id"})}),u("th",{rowspan:"2",children:u("code",{children:u("abbr",{title:"current_status",children:"status"})})}),u("th",{rowspan:"2",children:u("code",{children:"position"})}),u("th",{rowspan:"2",children:u("code",{children:u("abbr",{title:"congestion_level",children:"cong_lvl"})})}),u("th",{rowspan:"2",children:u("code",{children:u("abbr",{title:"occupancy_status",children:"occu"})})})]}),u("tr",{children:[u("th",{children:u("code",{children:"route_id"})}),u("th",{children:u("code",{children:u("abbr",{title:"direction_id",children:"dir_id"})})}),u("th",{children:u("code",{children:"trip_id"})}),u("th",{children:u("code",{children:u("abbr",{title:"start_date",children:"st_date"})})}),u("th",{children:u("code",{children:u("abbr",{title:"start_time",children:"st_time"})})}),u("th",{children:u("code",{children:"id"})}),u("th",{children:u("code",{children:"label"})}),u("th",{children:u("abbr",{title:"license_plate",children:u("code",{children:"lic_plate"})})})]})]}),u("tbody",{children:ee.map(re=>renderVehiclePosition(re,K))})]})]})},inspectorView=({state:Y,emit:K})=>{const ee=Y.feedData;if(!Array.isArray(ee.entity)||ee.entity.length===0)return u("p",{children:["The feed has no ",u("code",{children:"FeedEntity"}),"s."]});const{inspectorFilter:ne}=Y;return u("div",{class:"inspector",children:[renderFilterInput(ne,le=>{K("inspector:set-filter",le)}),renderTripUpdates(Y),renderVehiclePositions(Y,K)]})},MAX_BYTES=1024*1024,feedAsJsonCache=new WeakMap,downloadBlob=(Y,K)=>{const ee=window.document.createElement("a");ee.href=URL.createObjectURL(Y),ee.download=K,document.body.appendChild(ee),ee.click(),document.body.removeChild(ee),setTimeout(()=>{URL.revokeObjectURL(ee.href)},1e3)},rawView=({state:Y})=>{const K=Y.feedData,ee=Y.feedRawData;let ne;feedAsJsonCache.has(K)?ne=feedAsJsonCache.get(K):(ne=JSON.stringify(K,null,2),feedAsJsonCache.set(K,ne));const re=new URL(Y.feedUrl).pathname.split("/"),Q=`${re[re.length-1]||"gtfs-rt"}-${new Date().toISOString()}.json`,R=()=>{const Z=new Blob([ne],{type:"application/json"});downloadBlob(Z,Q)},U=()=>{const Z=new Blob([ee],{type:"application/vnd.google.protobuf"});downloadBlob(Z,Q)};return u("div",{class:"raw",children:[ne.length>MAX_BYTES?u("p",{children:["Truncated to ",MAX_BYTES," of ",ne.length," characters."]}):null,u("p",{children:[u("button",{onClick:R,children:"download JSON-encoded feed"}),u("button",{onClick:U,children:"download raw Protocol-Buffers-encoded feed"})]}),u("pre",{children:ne.substring(0,MAX_BYTES)})]})};var maplibreGl$1={exports:{}};/**
 * MapLibre GL JS
 * @license 3-Clause BSD. Full text of license: https://github.com/maplibre/maplibre-gl-js/blob/v5.6.1/LICENSE.txt
 */var maplibreGl=maplibreGl$1.exports,hasRequiredMaplibreGl;function requireMaplibreGl(){return hasRequiredMaplibreGl||(hasRequiredMaplibreGl=1,function(Y,K){(function(ee,ne){Y.exports=ne()})(maplibreGl,function(){var ee={},ne={};function re(Q,R,U){if(ne[Q]=U,Q==="index"){var Z="var sharedModule = {}; ("+ne.shared+")(sharedModule); ("+ne.worker+")(sharedModule);",ae={};return ne.shared(ae),ne.index(ee,ae),typeof window<"u"&&ee.setWorkerUrl(window.URL.createObjectURL(new Blob([Z],{type:"text/javascript"}))),ee}}re("shared",["exports"],function(Q){function R(H,h,W,X){return new(W||(W=Promise))(function(ie,ue){function ce(be){try{ye(X.next(be))}catch(we){ue(we)}}function fe(be){try{ye(X.throw(be))}catch(we){ue(we)}}function ye(be){var we;be.done?ie(be.value):(we=be.value,we instanceof W?we:new W(function(Ie){Ie(we)})).then(ce,fe)}ye((X=X.apply(H,h||[])).next())})}function U(H){return H&&H.__esModule&&Object.prototype.hasOwnProperty.call(H,"default")?H.default:H}var Z,ae;function he(){if(ae)return Z;function H(h,W){this.x=h,this.y=W}return ae=1,Z=H,H.prototype={clone:function(){return new H(this.x,this.y)},add:function(h){return this.clone()._add(h)},sub:function(h){return this.clone()._sub(h)},multByPoint:function(h){return this.clone()._multByPoint(h)},divByPoint:function(h){return this.clone()._divByPoint(h)},mult:function(h){return this.clone()._mult(h)},div:function(h){return this.clone()._div(h)},rotate:function(h){return this.clone()._rotate(h)},rotateAround:function(h,W){return this.clone()._rotateAround(h,W)},matMult:function(h){return this.clone()._matMult(h)},unit:function(){return this.clone()._unit()},perp:function(){return this.clone()._perp()},round:function(){return this.clone()._round()},mag:function(){return Math.sqrt(this.x*this.x+this.y*this.y)},equals:function(h){return this.x===h.x&&this.y===h.y},dist:function(h){return Math.sqrt(this.distSqr(h))},distSqr:function(h){var W=h.x-this.x,X=h.y-this.y;return W*W+X*X},angle:function(){return Math.atan2(this.y,this.x)},angleTo:function(h){return Math.atan2(this.y-h.y,this.x-h.x)},angleWith:function(h){return this.angleWithSep(h.x,h.y)},angleWithSep:function(h,W){return Math.atan2(this.x*W-this.y*h,this.x*h+this.y*W)},_matMult:function(h){var W=h[2]*this.x+h[3]*this.y;return this.x=h[0]*this.x+h[1]*this.y,this.y=W,this},_add:function(h){return this.x+=h.x,this.y+=h.y,this},_sub:function(h){return this.x-=h.x,this.y-=h.y,this},_mult:function(h){return this.x*=h,this.y*=h,this},_div:function(h){return this.x/=h,this.y/=h,this},_multByPoint:function(h){return this.x*=h.x,this.y*=h.y,this},_divByPoint:function(h){return this.x/=h.x,this.y/=h.y,this},_unit:function(){return this._div(this.mag()),this},_perp:function(){var h=this.y;return this.y=this.x,this.x=-h,this},_rotate:function(h){var W=Math.cos(h),X=Math.sin(h),ie=X*this.x+W*this.y;return this.x=W*this.x-X*this.y,this.y=ie,this},_rotateAround:function(h,W){var X=Math.cos(h),ie=Math.sin(h),ue=W.y+ie*(this.x-W.x)+X*(this.y-W.y);return this.x=W.x+X*(this.x-W.x)-ie*(this.y-W.y),this.y=ue,this},_round:function(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this}},H.convert=function(h){return h instanceof H?h:Array.isArray(h)?new H(h[0],h[1]):h},Z}typeof SuppressedError=="function"&&SuppressedError;var pe,me,ve=U(he()),Re=function(){if(me)return pe;function H(h,W,X,ie){this.cx=3*h,this.bx=3*(X-h)-this.cx,this.ax=1-this.cx-this.bx,this.cy=3*W,this.by=3*(ie-W)-this.cy,this.ay=1-this.cy-this.by,this.p1x=h,this.p1y=W,this.p2x=X,this.p2y=ie}return me=1,pe=H,H.prototype={sampleCurveX:function(h){return((this.ax*h+this.bx)*h+this.cx)*h},sampleCurveY:function(h){return((this.ay*h+this.by)*h+this.cy)*h},sampleCurveDerivativeX:function(h){return(3*this.ax*h+2*this.bx)*h+this.cx},solveCurveX:function(h,W){if(W===void 0&&(W=1e-6),h<0)return 0;if(h>1)return 1;for(var X=h,ie=0;ie<8;ie++){var ue=this.sampleCurveX(X)-h;if(Math.abs(ue)<W)return X;var ce=this.sampleCurveDerivativeX(X);if(Math.abs(ce)<1e-6)break;X-=ue/ce}var fe=0,ye=1;for(X=h,ie=0;ie<20&&(ue=this.sampleCurveX(X),!(Math.abs(ue-h)<W));ie++)h>ue?fe=X:ye=X,X=.5*(ye-fe)+fe;return X},solve:function(h,W){return this.sampleCurveY(this.solveCurveX(h,W))}},pe}(),Me=U(Re);let Te,Ce;function We(){return Te==null&&(Te=typeof OffscreenCanvas<"u"&&new OffscreenCanvas(1,1).getContext("2d")&&typeof createImageBitmap=="function"),Te}function Fe(){if(Ce==null&&(Ce=!1,We())){const h=new OffscreenCanvas(5,5).getContext("2d",{willReadFrequently:!0});if(h){for(let X=0;X<5*5;X++){const ie=4*X;h.fillStyle=`rgb(${ie},${ie+1},${ie+2})`,h.fillRect(X%5,Math.floor(X/5),1,1)}const W=h.getImageData(0,0,5,5).data;for(let X=0;X<5*5*4;X++)if(X%4!=3&&W[X]!==X){Ce=!0;break}}}return Ce||!1}var ke=1e-6,Ze=typeof Float32Array<"u"?Float32Array:Array;function Je(){var H=new Ze(9);return Ze!=Float32Array&&(H[1]=0,H[2]=0,H[3]=0,H[5]=0,H[6]=0,H[7]=0),H[0]=1,H[4]=1,H[8]=1,H}function Qe(H){return H[0]=1,H[1]=0,H[2]=0,H[3]=0,H[4]=0,H[5]=1,H[6]=0,H[7]=0,H[8]=0,H[9]=0,H[10]=1,H[11]=0,H[12]=0,H[13]=0,H[14]=0,H[15]=1,H}function it(){var H=new Ze(3);return Ze!=Float32Array&&(H[0]=0,H[1]=0,H[2]=0),H}function lt(H){return Math.hypot(H[0],H[1],H[2])}function dt(H,h,W){var X=new Ze(3);return X[0]=H,X[1]=h,X[2]=W,X}function yt(H,h,W){return H[0]=h[0]+W[0],H[1]=h[1]+W[1],H[2]=h[2]+W[2],H}function gt(H,h,W){return H[0]=h[0]*W,H[1]=h[1]*W,H[2]=h[2]*W,H}function qt(H,h,W){var X=h[0],ie=h[1],ue=h[2],ce=W[0],fe=W[1],ye=W[2];return H[0]=ie*ye-ue*fe,H[1]=ue*ce-X*ye,H[2]=X*fe-ie*ce,H}Math.hypot||(Math.hypot=function(){for(var H=0,h=arguments.length;h--;)H+=arguments[h]*arguments[h];return Math.sqrt(H)});var Ft,Gt=lt;function ft(H,h,W){var X=h[0],ie=h[1],ue=h[2],ce=h[3];return H[0]=W[0]*X+W[4]*ie+W[8]*ue+W[12]*ce,H[1]=W[1]*X+W[5]*ie+W[9]*ue+W[13]*ce,H[2]=W[2]*X+W[6]*ie+W[10]*ue+W[14]*ce,H[3]=W[3]*X+W[7]*ie+W[11]*ue+W[15]*ce,H}function Rt(){var H=new Ze(4);return Ze!=Float32Array&&(H[0]=0,H[1]=0,H[2]=0),H[3]=1,H}function pt(H,h,W,X){var ie=.5*Math.PI/180;h*=ie,W*=ie,X*=ie;var ue=Math.sin(h),ce=Math.cos(h),fe=Math.sin(W),ye=Math.cos(W),be=Math.sin(X),we=Math.cos(X);return H[0]=ue*ye*we-ce*fe*be,H[1]=ce*fe*we+ue*ye*be,H[2]=ce*ye*be-ue*fe*we,H[3]=ce*ye*we+ue*fe*be,H}function At(){var H=new Ze(2);return Ze!=Float32Array&&(H[0]=0,H[1]=0),H}function It(H,h){var W=new Ze(2);return W[0]=H,W[1]=h,W}it(),Ft=new Ze(4),Ze!=Float32Array&&(Ft[0]=0,Ft[1]=0,Ft[2]=0,Ft[3]=0),it(),dt(1,0,0),dt(0,1,0),Rt(),Rt(),Je(),At();const Dt=8192;function Zt(H,h,W){return h*(Dt/(H.tileSize*Math.pow(2,W-H.tileID.overscaledZ)))}function nr(H,h){return(H%h+h)%h}function Er(H,h,W){return H*(1-W)+h*W}function vr(H){if(H<=0)return 0;if(H>=1)return 1;const h=H*H,W=h*H;return 4*(H<.5?W:3*(H-h)+W-.75)}function Sr(H,h,W,X){const ie=new Me(H,h,W,X);return ue=>ie.solve(ue)}const Qt=Sr(.25,.1,.25,1);function or(H,h,W){return Math.min(W,Math.max(h,H))}function Ir(H,h,W){const X=W-h,ie=((H-h)%X+X)%X+h;return ie===h?W:ie}function Rr(H,...h){for(const W of h)for(const X in W)H[X]=W[X];return H}let Cr=1;function wr(H,h,W){const X={};for(const ie in H)X[ie]=h.call(this,H[ie],ie,H);return X}function Wr(H,h,W){const X={};for(const ie in H)h.call(this,H[ie],ie,H)&&(X[ie]=H[ie]);return X}function Kr(H){return Array.isArray(H)?H.map(Kr):typeof H=="object"&&H?wr(H,Kr):H}const Hr={};function br(H){Hr[H]||(typeof console<"u"&&console.warn(H),Hr[H]=!0)}function Lr(H,h,W){return(W.y-H.y)*(h.x-H.x)>(h.y-H.y)*(W.x-H.x)}function Br(H){return typeof WorkerGlobalScope<"u"&&H!==void 0&&H instanceof WorkerGlobalScope}let zr=null;function rr(H){return typeof ImageBitmap<"u"&&H instanceof ImageBitmap}const sr="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAAC0lEQVQYV2NgAAIAAAUAAarVyFEAAAAASUVORK5CYII=";function Dr(H,h,W,X,ie){return R(this,void 0,void 0,function*(){if(typeof VideoFrame>"u")throw new Error("VideoFrame not supported");const ue=new VideoFrame(H,{timestamp:0});try{const ce=ue==null?void 0:ue.format;if(!ce||!ce.startsWith("BGR")&&!ce.startsWith("RGB"))throw new Error(`Unrecognized format ${ce}`);const fe=ce.startsWith("BGR"),ye=new Uint8ClampedArray(X*ie*4);if(yield ue.copyTo(ye,function(be,we,Ie,Be,Ue){const $e=4*Math.max(-we,0),Xe=(Math.max(0,Ie)-Ie)*Be*4+$e,rt=4*Be,ct=Math.max(0,we),Ct=Math.max(0,Ie);return{rect:{x:ct,y:Ct,width:Math.min(be.width,we+Be)-ct,height:Math.min(be.height,Ie+Ue)-Ct},layout:[{offset:Xe,stride:rt}]}}(H,h,W,X,ie)),fe)for(let be=0;be<ye.length;be+=4){const we=ye[be];ye[be]=ye[be+2],ye[be+2]=we}return ye}finally{ue.close()}})}let lr,yr;function xr(H,h,W,X){return H.addEventListener(h,W,X),{unsubscribe:()=>{H.removeEventListener(h,W,X)}}}function Ge(H){return H*Math.PI/180}function Ee(H){return H/Math.PI*180}const Pe={touchstart:!0,touchmove:!0,touchmoveWindow:!0,touchend:!0,touchcancel:!0},He={dblclick:!0,click:!0,mouseover:!0,mouseout:!0,mousedown:!0,mousemove:!0,mousemoveWindow:!0,mouseup:!0,mouseupWindow:!0,contextmenu:!0,wheel:!0},ut="AbortError";function Ve(){return new Error(ut)}const qe={MAX_PARALLEL_IMAGE_REQUESTS:16,MAX_PARALLEL_IMAGE_REQUESTS_PER_FRAME:8,MAX_TILE_CACHE_ZOOM_LEVELS:5,REGISTERED_PROTOCOLS:{},WORKER_URL:""};function De(H){return qe.REGISTERED_PROTOCOLS[H.substring(0,H.indexOf("://"))]}const ze="global-dispatcher";class Le extends Error{constructor(h,W,X,ie){super(`AJAXError: ${W} (${h}): ${X}`),this.status=h,this.statusText=W,this.url=X,this.body=ie}}const Ke=()=>Br(self)?self.worker&&self.worker.referrer:(window.location.protocol==="blob:"?window.parent:window).location.href,et=function(H,h){if(/:\/\//.test(H.url)&&!/^https?:|^file:/.test(H.url)){const X=De(H.url);if(X)return X(H,h);if(Br(self)&&self.worker&&self.worker.actor)return self.worker.actor.sendAsync({type:"GR",data:H,targetMapId:ze},h)}if(!(/^file:/.test(W=H.url)||/^file:/.test(Ke())&&!/^\w+:/.test(W))){if(fetch&&Request&&AbortController&&Object.prototype.hasOwnProperty.call(Request.prototype,"signal"))return function(X,ie){return R(this,void 0,void 0,function*(){const ue=new Request(X.url,{method:X.method||"GET",body:X.body,credentials:X.credentials,headers:X.headers,cache:X.cache,referrer:Ke(),signal:ie.signal});let ce,fe;X.type!=="json"||ue.headers.has("Accept")||ue.headers.set("Accept","application/json");try{ce=yield fetch(ue)}catch(be){throw new Le(0,be.message,X.url,new Blob)}if(!ce.ok){const be=yield ce.blob();throw new Le(ce.status,ce.statusText,X.url,be)}fe=X.type==="arrayBuffer"||X.type==="image"?ce.arrayBuffer():X.type==="json"?ce.json():ce.text();const ye=yield fe;if(ie.signal.aborted)throw Ve();return{data:ye,cacheControl:ce.headers.get("Cache-Control"),expires:ce.headers.get("Expires")}})}(H,h);if(Br(self)&&self.worker&&self.worker.actor)return self.worker.actor.sendAsync({type:"GR",data:H,mustQueue:!0,targetMapId:ze},h)}var W;return function(X,ie){return new Promise((ue,ce)=>{var fe;const ye=new XMLHttpRequest;ye.open(X.method||"GET",X.url,!0),X.type!=="arrayBuffer"&&X.type!=="image"||(ye.responseType="arraybuffer");for(const be in X.headers)ye.setRequestHeader(be,X.headers[be]);X.type==="json"&&(ye.responseType="text",!((fe=X.headers)===null||fe===void 0)&&fe.Accept||ye.setRequestHeader("Accept","application/json")),ye.withCredentials=X.credentials==="include",ye.onerror=()=>{ce(new Error(ye.statusText))},ye.onload=()=>{if(!ie.signal.aborted)if((ye.status>=200&&ye.status<300||ye.status===0)&&ye.response!==null){let be=ye.response;if(X.type==="json")try{be=JSON.parse(ye.response)}catch(we){return void ce(we)}ue({data:be,cacheControl:ye.getResponseHeader("Cache-Control"),expires:ye.getResponseHeader("Expires")})}else{const be=new Blob([ye.response],{type:ye.getResponseHeader("Content-Type")});ce(new Le(ye.status,ye.statusText,X.url,be))}},ie.signal.addEventListener("abort",()=>{ye.abort(),ce(Ve())}),ye.send(X.body)})}(H,h)};function _t(H){if(!H||H.indexOf("://")<=0||H.indexOf("data:image/")===0||H.indexOf("blob:")===0)return!0;const h=new URL(H),W=window.location;return h.protocol===W.protocol&&h.host===W.host}function st(H,h,W){W[H]&&W[H].indexOf(h)!==-1||(W[H]=W[H]||[],W[H].push(h))}function bt(H,h,W){if(W&&W[H]){const X=W[H].indexOf(h);X!==-1&&W[H].splice(X,1)}}class Mt{constructor(h,W={}){Rr(this,W),this.type=h}}class Ot extends Mt{constructor(h,W={}){super("error",Rr({error:h},W))}}class Nt{on(h,W){return this._listeners=this._listeners||{},st(h,W,this._listeners),{unsubscribe:()=>{this.off(h,W)}}}off(h,W){return bt(h,W,this._listeners),bt(h,W,this._oneTimeListeners),this}once(h,W){return W?(this._oneTimeListeners=this._oneTimeListeners||{},st(h,W,this._oneTimeListeners),this):new Promise(X=>this.once(h,X))}fire(h,W){typeof h=="string"&&(h=new Mt(h,W||{}));const X=h.type;if(this.listens(X)){h.target=this;const ie=this._listeners&&this._listeners[X]?this._listeners[X].slice():[];for(const fe of ie)fe.call(this,h);const ue=this._oneTimeListeners&&this._oneTimeListeners[X]?this._oneTimeListeners[X].slice():[];for(const fe of ue)bt(X,fe,this._oneTimeListeners),fe.call(this,h);const ce=this._eventedParent;ce&&(Rr(h,typeof this._eventedParentData=="function"?this._eventedParentData():this._eventedParentData),ce.fire(h))}else h instanceof Ot&&console.error(h.error);return this}listens(h){return this._listeners&&this._listeners[h]&&this._listeners[h].length>0||this._oneTimeListeners&&this._oneTimeListeners[h]&&this._oneTimeListeners[h].length>0||this._eventedParent&&this._eventedParent.listens(h)}setEventedParent(h,W){return this._eventedParent=h,this._eventedParentData=W,this}}var St={$version:8,$root:{version:{required:!0,type:"enum",values:[8]},name:{type:"string"},metadata:{type:"*"},center:{type:"array",value:"number"},centerAltitude:{type:"number"},zoom:{type:"number"},bearing:{type:"number",default:0,period:360,units:"degrees"},pitch:{type:"number",default:0,units:"degrees"},roll:{type:"number",default:0,units:"degrees"},state:{type:"state",default:{}},light:{type:"light"},sky:{type:"sky"},projection:{type:"projection"},terrain:{type:"terrain"},sources:{required:!0,type:"sources"},sprite:{type:"sprite"},glyphs:{type:"string"},transition:{type:"transition"},layers:{required:!0,type:"array",value:"layer"}},sources:{"*":{type:"source"}},source:["source_vector","source_raster","source_raster_dem","source_geojson","source_video","source_image"],source_vector:{type:{required:!0,type:"enum",values:{vector:{}}},url:{type:"string"},tiles:{type:"array",value:"string"},bounds:{type:"array",value:"number",length:4,default:[-180,-85.051129,180,85.051129]},scheme:{type:"enum",values:{xyz:{},tms:{}},default:"xyz"},minzoom:{type:"number",default:0},maxzoom:{type:"number",default:22},attribution:{type:"string"},promoteId:{type:"promoteId"},volatile:{type:"boolean",default:!1},"*":{type:"*"}},source_raster:{type:{required:!0,type:"enum",values:{raster:{}}},url:{type:"string"},tiles:{type:"array",value:"string"},bounds:{type:"array",value:"number",length:4,default:[-180,-85.051129,180,85.051129]},minzoom:{type:"number",default:0},maxzoom:{type:"number",default:22},tileSize:{type:"number",default:512,units:"pixels"},scheme:{type:"enum",values:{xyz:{},tms:{}},default:"xyz"},attribution:{type:"string"},volatile:{type:"boolean",default:!1},"*":{type:"*"}},source_raster_dem:{type:{required:!0,type:"enum",values:{"raster-dem":{}}},url:{type:"string"},tiles:{type:"array",value:"string"},bounds:{type:"array",value:"number",length:4,default:[-180,-85.051129,180,85.051129]},minzoom:{type:"number",default:0},maxzoom:{type:"number",default:22},tileSize:{type:"number",default:512,units:"pixels"},attribution:{type:"string"},encoding:{type:"enum",values:{terrarium:{},mapbox:{},custom:{}},default:"mapbox"},redFactor:{type:"number",default:1},blueFactor:{type:"number",default:1},greenFactor:{type:"number",default:1},baseShift:{type:"number",default:0},volatile:{type:"boolean",default:!1},"*":{type:"*"}},source_geojson:{type:{required:!0,type:"enum",values:{geojson:{}}},data:{required:!0,type:"*"},maxzoom:{type:"number",default:18},attribution:{type:"string"},buffer:{type:"number",default:128,maximum:512,minimum:0},filter:{type:"*"},tolerance:{type:"number",default:.375},cluster:{type:"boolean",default:!1},clusterRadius:{type:"number",default:50,minimum:0},clusterMaxZoom:{type:"number"},clusterMinPoints:{type:"number"},clusterProperties:{type:"*"},lineMetrics:{type:"boolean",default:!1},generateId:{type:"boolean",default:!1},promoteId:{type:"promoteId"}},source_video:{type:{required:!0,type:"enum",values:{video:{}}},urls:{required:!0,type:"array",value:"string"},coordinates:{required:!0,type:"array",length:4,value:{type:"array",length:2,value:"number"}}},source_image:{type:{required:!0,type:"enum",values:{image:{}}},url:{required:!0,type:"string"},coordinates:{required:!0,type:"array",length:4,value:{type:"array",length:2,value:"number"}}},layer:{id:{type:"string",required:!0},type:{type:"enum",values:{fill:{},line:{},symbol:{},circle:{},heatmap:{},"fill-extrusion":{},raster:{},hillshade:{},"color-relief":{},background:{}},required:!0},metadata:{type:"*"},source:{type:"string"},"source-layer":{type:"string"},minzoom:{type:"number",minimum:0,maximum:24},maxzoom:{type:"number",minimum:0,maximum:24},filter:{type:"filter"},layout:{type:"layout"},paint:{type:"paint"}},layout:["layout_fill","layout_line","layout_circle","layout_heatmap","layout_fill-extrusion","layout_symbol","layout_raster","layout_hillshade","layout_color-relief","layout_background"],layout_background:{visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_fill:{"fill-sort-key":{type:"number",expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_circle:{"circle-sort-key":{type:"number",expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_heatmap:{visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},"layout_fill-extrusion":{visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_line:{"line-cap":{type:"enum",values:{butt:{},round:{},square:{}},default:"butt",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"line-join":{type:"enum",values:{bevel:{},round:{},miter:{}},default:"miter",expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"line-miter-limit":{type:"number",default:2,requires:[{"line-join":"miter"}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"line-round-limit":{type:"number",default:1.05,requires:[{"line-join":"round"}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"line-sort-key":{type:"number",expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_symbol:{"symbol-placement":{type:"enum",values:{point:{},line:{},"line-center":{}},default:"point",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"symbol-spacing":{type:"number",default:250,minimum:1,units:"pixels",requires:[{"symbol-placement":"line"}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"symbol-avoid-edges":{type:"boolean",default:!1,expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"symbol-sort-key":{type:"number",expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"symbol-z-order":{type:"enum",values:{auto:{},"viewport-y":{},source:{}},default:"auto",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-allow-overlap":{type:"boolean",default:!1,requires:["icon-image",{"!":"icon-overlap"}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-overlap":{type:"enum",values:{never:{},always:{},cooperative:{}},requires:["icon-image"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-ignore-placement":{type:"boolean",default:!1,requires:["icon-image"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-optional":{type:"boolean",default:!1,requires:["icon-image","text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-rotation-alignment":{type:"enum",values:{map:{},viewport:{},auto:{}},default:"auto",requires:["icon-image"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-size":{type:"number",default:1,minimum:0,units:"factor of the original icon size",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-text-fit":{type:"enum",values:{none:{},width:{},height:{},both:{}},default:"none",requires:["icon-image","text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-text-fit-padding":{type:"array",value:"number",length:4,default:[0,0,0,0],units:"pixels",requires:["icon-image","text-field",{"icon-text-fit":["both","width","height"]}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"icon-image":{type:"resolvedImage",tokens:!0,expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-rotate":{type:"number",default:0,period:360,units:"degrees",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-padding":{type:"padding",default:[2],units:"pixels",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-keep-upright":{type:"boolean",default:!1,requires:["icon-image",{"icon-rotation-alignment":"map"},{"symbol-placement":["line","line-center"]}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-offset":{type:"array",value:"number",length:2,default:[0,0],requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-anchor":{type:"enum",values:{center:{},left:{},right:{},top:{},bottom:{},"top-left":{},"top-right":{},"bottom-left":{},"bottom-right":{}},default:"center",requires:["icon-image"],expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-pitch-alignment":{type:"enum",values:{map:{},viewport:{},auto:{}},default:"auto",requires:["icon-image"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-pitch-alignment":{type:"enum",values:{map:{},viewport:{},auto:{}},default:"auto",requires:["text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-rotation-alignment":{type:"enum",values:{map:{},viewport:{},"viewport-glyph":{},auto:{}},default:"auto",requires:["text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-field":{type:"formatted",default:"",tokens:!0,expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-font":{type:"array",value:"string",default:["Open Sans Regular","Arial Unicode MS Regular"],requires:["text-field"],expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-size":{type:"number",default:16,minimum:0,units:"pixels",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-max-width":{type:"number",default:10,minimum:0,units:"ems",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-line-height":{type:"number",default:1.2,units:"ems",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"text-letter-spacing":{type:"number",default:0,units:"ems",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-justify":{type:"enum",values:{auto:{},left:{},center:{},right:{}},default:"center",requires:["text-field"],expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-radial-offset":{type:"number",units:"ems",default:0,requires:["text-field"],"property-type":"data-driven",expression:{interpolated:!0,parameters:["zoom","feature"]}},"text-variable-anchor":{type:"array",value:"enum",values:{center:{},left:{},right:{},top:{},bottom:{},"top-left":{},"top-right":{},"bottom-left":{},"bottom-right":{}},requires:["text-field",{"symbol-placement":["point"]}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-variable-anchor-offset":{type:"variableAnchorOffsetCollection",requires:["text-field",{"symbol-placement":["point"]}],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-anchor":{type:"enum",values:{center:{},left:{},right:{},top:{},bottom:{},"top-left":{},"top-right":{},"bottom-left":{},"bottom-right":{}},default:"center",requires:["text-field",{"!":"text-variable-anchor"}],expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-max-angle":{type:"number",default:45,units:"degrees",requires:["text-field",{"symbol-placement":["line","line-center"]}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"text-writing-mode":{type:"array",value:"enum",values:{horizontal:{},vertical:{}},requires:["text-field",{"symbol-placement":["point"]}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-rotate":{type:"number",default:0,period:360,units:"degrees",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-padding":{type:"number",default:2,minimum:0,units:"pixels",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"text-keep-upright":{type:"boolean",default:!0,requires:["text-field",{"text-rotation-alignment":"map"},{"symbol-placement":["line","line-center"]}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-transform":{type:"enum",values:{none:{},uppercase:{},lowercase:{}},default:"none",requires:["text-field"],expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-offset":{type:"array",value:"number",units:"ems",length:2,default:[0,0],requires:["text-field",{"!":"text-radial-offset"}],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-allow-overlap":{type:"boolean",default:!1,requires:["text-field",{"!":"text-overlap"}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-overlap":{type:"enum",values:{never:{},always:{},cooperative:{}},requires:["text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-ignore-placement":{type:"boolean",default:!1,requires:["text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-optional":{type:"boolean",default:!1,requires:["text-field","icon-image"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_raster:{visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_hillshade:{visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},"layout_color-relief":{visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},filter:{type:"array",value:"*"},filter_operator:{type:"enum",values:{"==":{},"!=":{},">":{},">=":{},"<":{},"<=":{},in:{},"!in":{},all:{},any:{},none:{},has:{},"!has":{}}},geometry_type:{type:"enum",values:{Point:{},LineString:{},Polygon:{}}},function:{expression:{type:"expression"},stops:{type:"array",value:"function_stop"},base:{type:"number",default:1,minimum:0},property:{type:"string",default:"$zoom"},type:{type:"enum",values:{identity:{},exponential:{},interval:{},categorical:{}},default:"exponential"},colorSpace:{type:"enum",values:{rgb:{},lab:{},hcl:{}},default:"rgb"},default:{type:"*",required:!1}},function_stop:{type:"array",minimum:0,maximum:24,value:["number","color"],length:2},expression:{type:"array",value:"*",minimum:1},light:{anchor:{type:"enum",default:"viewport",values:{map:{},viewport:{}},"property-type":"data-constant",transition:!1,expression:{interpolated:!1,parameters:["zoom"]}},position:{type:"array",default:[1.15,210,30],length:3,value:"number","property-type":"data-constant",transition:!0,expression:{interpolated:!0,parameters:["zoom"]}},color:{type:"color","property-type":"data-constant",default:"#ffffff",expression:{interpolated:!0,parameters:["zoom"]},transition:!0},intensity:{type:"number","property-type":"data-constant",default:.5,minimum:0,maximum:1,expression:{interpolated:!0,parameters:["zoom"]},transition:!0}},sky:{"sky-color":{type:"color","property-type":"data-constant",default:"#88C6FC",expression:{interpolated:!0,parameters:["zoom"]},transition:!0},"horizon-color":{type:"color","property-type":"data-constant",default:"#ffffff",expression:{interpolated:!0,parameters:["zoom"]},transition:!0},"fog-color":{type:"color","property-type":"data-constant",default:"#ffffff",expression:{interpolated:!0,parameters:["zoom"]},transition:!0},"fog-ground-blend":{type:"number","property-type":"data-constant",default:.5,minimum:0,maximum:1,expression:{interpolated:!0,parameters:["zoom"]},transition:!0},"horizon-fog-blend":{type:"number","property-type":"data-constant",default:.8,minimum:0,maximum:1,expression:{interpolated:!0,parameters:["zoom"]},transition:!0},"sky-horizon-blend":{type:"number","property-type":"data-constant",default:.8,minimum:0,maximum:1,expression:{interpolated:!0,parameters:["zoom"]},transition:!0},"atmosphere-blend":{type:"number","property-type":"data-constant",default:.8,minimum:0,maximum:1,expression:{interpolated:!0,parameters:["zoom"]},transition:!0}},terrain:{source:{type:"string",required:!0},exaggeration:{type:"number",minimum:0,default:1}},projection:{type:{type:"projectionDefinition",default:"mercator","property-type":"data-constant",transition:!1,expression:{interpolated:!0,parameters:["zoom"]}}},paint:["paint_fill","paint_line","paint_circle","paint_heatmap","paint_fill-extrusion","paint_symbol","paint_raster","paint_hillshade","paint_color-relief","paint_background"],paint_fill:{"fill-antialias":{type:"boolean",default:!0,expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"fill-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-color":{type:"color",default:"#000000",transition:!0,requires:[{"!":"fill-pattern"}],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-outline-color":{type:"color",transition:!0,requires:[{"!":"fill-pattern"},{"fill-antialias":!0}],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"fill-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["fill-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"fill-pattern":{type:"resolvedImage",transition:!0,expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"cross-faded-data-driven"}},"paint_fill-extrusion":{"fill-extrusion-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"fill-extrusion-color":{type:"color",default:"#000000",transition:!0,requires:[{"!":"fill-extrusion-pattern"}],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-extrusion-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"fill-extrusion-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["fill-extrusion-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"fill-extrusion-pattern":{type:"resolvedImage",transition:!0,expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"cross-faded-data-driven"},"fill-extrusion-height":{type:"number",default:0,minimum:0,units:"meters",transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-extrusion-base":{type:"number",default:0,minimum:0,units:"meters",transition:!0,requires:["fill-extrusion-height"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-extrusion-vertical-gradient":{type:"boolean",default:!0,transition:!1,expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"}},paint_line:{"line-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-color":{type:"color",default:"#000000",transition:!0,requires:[{"!":"line-pattern"}],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"line-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["line-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"line-width":{type:"number",default:1,minimum:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-gap-width":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-offset":{type:"number",default:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-blur":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-dasharray":{type:"array",value:"number",minimum:0,transition:!0,units:"line widths",requires:[{"!":"line-pattern"}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"cross-faded"},"line-pattern":{type:"resolvedImage",transition:!0,expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"cross-faded-data-driven"},"line-gradient":{type:"color",transition:!1,requires:[{"!":"line-dasharray"},{"!":"line-pattern"},{source:"geojson",has:{lineMetrics:!0}}],expression:{interpolated:!0,parameters:["line-progress"]},"property-type":"color-ramp"}},paint_circle:{"circle-radius":{type:"number",default:5,minimum:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-color":{type:"color",default:"#000000",transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-blur":{type:"number",default:0,transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"circle-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["circle-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"circle-pitch-scale":{type:"enum",values:{map:{},viewport:{}},default:"map",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"circle-pitch-alignment":{type:"enum",values:{map:{},viewport:{}},default:"viewport",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"circle-stroke-width":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-stroke-color":{type:"color",default:"#000000",transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-stroke-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"}},paint_heatmap:{"heatmap-radius":{type:"number",default:30,minimum:1,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"heatmap-weight":{type:"number",default:1,minimum:0,transition:!1,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"heatmap-intensity":{type:"number",default:1,minimum:0,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"heatmap-color":{type:"color",default:["interpolate",["linear"],["heatmap-density"],0,"rgba(0, 0, 255, 0)",.1,"royalblue",.3,"cyan",.5,"lime",.7,"yellow",1,"red"],transition:!1,expression:{interpolated:!0,parameters:["heatmap-density"]},"property-type":"color-ramp"},"heatmap-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"}},paint_symbol:{"icon-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-color":{type:"color",default:"#000000",transition:!0,requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-halo-color":{type:"color",default:"rgba(0, 0, 0, 0)",transition:!0,requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-halo-width":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-halo-blur":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"icon-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["icon-image","icon-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-color":{type:"color",default:"#000000",transition:!0,overridable:!0,requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-halo-color":{type:"color",default:"rgba(0, 0, 0, 0)",transition:!0,requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-halo-width":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-halo-blur":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"text-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["text-field","text-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"}},paint_raster:{"raster-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-hue-rotate":{type:"number",default:0,period:360,transition:!0,units:"degrees",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-brightness-min":{type:"number",default:0,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-brightness-max":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-saturation":{type:"number",default:0,minimum:-1,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-contrast":{type:"number",default:0,minimum:-1,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-resampling":{type:"enum",values:{linear:{},nearest:{}},default:"linear",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"raster-fade-duration":{type:"number",default:300,minimum:0,transition:!1,units:"milliseconds",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"}},paint_hillshade:{"hillshade-illumination-direction":{type:"numberArray",default:335,minimum:0,maximum:359,transition:!1,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-illumination-altitude":{type:"numberArray",default:45,minimum:0,maximum:90,transition:!1,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-illumination-anchor":{type:"enum",values:{map:{},viewport:{}},default:"viewport",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-exaggeration":{type:"number",default:.5,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-shadow-color":{type:"colorArray",default:"#000000",transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-highlight-color":{type:"colorArray",default:"#FFFFFF",transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-accent-color":{type:"color",default:"#000000",transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-method":{type:"enum",values:{standard:{},basic:{},combined:{},igor:{},multidirectional:{}},default:"standard",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"}},"paint_color-relief":{"color-relief-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"color-relief-color":{type:"color",transition:!1,expression:{interpolated:!0,parameters:["elevation"]},"property-type":"color-ramp"}},paint_background:{"background-color":{type:"color",default:"#000000",transition:!0,requires:[{"!":"background-pattern"}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"background-pattern":{type:"resolvedImage",transition:!0,expression:{interpolated:!1,parameters:["zoom"]},"property-type":"cross-faded"},"background-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"}},transition:{duration:{type:"number",default:300,minimum:0,units:"milliseconds"},delay:{type:"number",default:0,minimum:0,units:"milliseconds"}},"property-type":{"data-driven":{type:"property-type"},"cross-faded":{type:"property-type"},"cross-faded-data-driven":{type:"property-type"},"color-ramp":{type:"property-type"},"data-constant":{type:"property-type"},constant:{type:"property-type"}},promoteId:{"*":{type:"string"}}};const ar=["type","source","source-layer","minzoom","maxzoom","filter","layout"];function qr(H,h){const W={};for(const X in H)X!=="ref"&&(W[X]=H[X]);return ar.forEach(X=>{X in h&&(W[X]=h[X])}),W}function fr(H,h){if(Array.isArray(H)){if(!Array.isArray(h)||H.length!==h.length)return!1;for(let W=0;W<H.length;W++)if(!fr(H[W],h[W]))return!1;return!0}if(typeof H=="object"&&H!==null&&h!==null){if(typeof h!="object"||Object.keys(H).length!==Object.keys(h).length)return!1;for(const W in H)if(!fr(H[W],h[W]))return!1;return!0}return H===h}function Fr(H,h){H.push(h)}function Gr(H,h,W){Fr(W,{command:"addSource",args:[H,h[H]]})}function ci(H,h,W){Fr(h,{command:"removeSource",args:[H]}),W[H]=!0}function Jr(H,h,W,X){ci(H,W,X),Gr(H,h,W)}function Yr(H,h,W){let X;for(X in H[W])if(Object.prototype.hasOwnProperty.call(H[W],X)&&X!=="data"&&!fr(H[W][X],h[W][X]))return!1;for(X in h[W])if(Object.prototype.hasOwnProperty.call(h[W],X)&&X!=="data"&&!fr(H[W][X],h[W][X]))return!1;return!0}function jr(H,h,W,X,ie,ue){H=H||{},h=h||{};for(const ce in H)Object.prototype.hasOwnProperty.call(H,ce)&&(fr(H[ce],h[ce])||W.push({command:ue,args:[X,ce,h[ce],ie]}));for(const ce in h)Object.prototype.hasOwnProperty.call(h,ce)&&!Object.prototype.hasOwnProperty.call(H,ce)&&(fr(H[ce],h[ce])||W.push({command:ue,args:[X,ce,h[ce],ie]}))}function Zr(H){return H.id}function fi(H,h){return H[h.id]=h,H}class cr{constructor(h,W,X,ie){this.message=(h?`${h}: `:"")+X,ie&&(this.identifier=ie),W!=null&&W.__line__&&(this.line=W.__line__)}}function bi(H,...h){for(const W of h)for(const X in W)H[X]=W[X];return H}class Qr extends Error{constructor(h,W){super(W),this.message=W,this.key=h}}class Ei{constructor(h,W=[]){this.parent=h,this.bindings={};for(const[X,ie]of W)this.bindings[X]=ie}concat(h){return new Ei(this,h)}get(h){if(this.bindings[h])return this.bindings[h];if(this.parent)return this.parent.get(h);throw new Error(`${h} not found in scope.`)}has(h){return!!this.bindings[h]||!!this.parent&&this.parent.has(h)}}const yn={kind:"null"},pr={kind:"number"},Lt={kind:"string"},Yt={kind:"boolean"},Ht={kind:"color"},Bt={kind:"projectionDefinition"},ir={kind:"object"},gr={kind:"value"},Mr={kind:"collator"},pi={kind:"formatted"},ri={kind:"padding"},Oi={kind:"colorArray"},Vi={kind:"numberArray"},hr={kind:"resolvedImage"},qi={kind:"variableAnchorOffsetCollection"};function Ci(H,h){return{kind:"array",itemType:H,N:h}}function yi(H){if(H.kind==="array"){const h=yi(H.itemType);return typeof H.N=="number"?`array<${h}, ${H.N}>`:H.itemType.kind==="value"?"array":`array<${h}>`}return H.kind}const lo=[yn,pr,Lt,Yt,Ht,Bt,pi,ir,Ci(gr),ri,Vi,Oi,hr,qi];function ra(H,h){if(h.kind==="error")return null;if(H.kind==="array"){if(h.kind==="array"&&(h.N===0&&h.itemType.kind==="value"||!ra(H.itemType,h.itemType))&&(typeof H.N!="number"||H.N===h.N))return null}else{if(H.kind===h.kind)return null;if(H.kind==="value"){for(const W of lo)if(!ra(W,h))return null}}return`Expected ${yi(H)} but found ${yi(h)} instead.`}function ia(H,h){return h.some(W=>W.kind===H.kind)}function ya(H,h){return h.some(W=>W==="null"?H===null:W==="array"?Array.isArray(H):W==="object"?H&&!Array.isArray(H)&&typeof H=="object":W===typeof H)}function na(H,h){return H.kind==="array"&&h.kind==="array"?H.itemType.kind===h.itemType.kind&&typeof H.N=="number":H.kind===h.kind}const il=.96422,nl=.82521,al=4/29,Oa=6/29,ol=3*Oa*Oa,sl=Oa*Oa*Oa,co=Math.PI/180,fc=180/Math.PI;function ul(H){return(H%=360)<0&&(H+=360),H}function Ca([H,h,W,X]){let ie,ue;const ce=Hs((.2225045*(H=Ws(H))+.7168786*(h=Ws(h))+.0606169*(W=Ws(W)))/1);H===h&&h===W?ie=ue=ce:(ie=Hs((.4360747*H+.3850649*h+.1430804*W)/il),ue=Hs((.0139322*H+.0971045*h+.7141733*W)/nl));const fe=116*ce-16;return[fe<0?0:fe,500*(ie-ce),200*(ce-ue),X]}function Ws(H){return H<=.04045?H/12.92:Math.pow((H+.055)/1.055,2.4)}function Hs(H){return H>sl?Math.pow(H,1/3):H/ol+al}function ll([H,h,W,X]){let ie=(H+16)/116,ue=isNaN(h)?ie:ie+h/500,ce=isNaN(W)?ie:ie-W/200;return ie=1*Jo(ie),ue=il*Jo(ue),ce=nl*Jo(ce),[Xo(3.1338561*ue-1.6168667*ie-.4906146*ce),Xo(-.9787684*ue+1.9161415*ie+.033454*ce),Xo(.0719453*ue-.2289914*ie+1.4052427*ce),X]}function Xo(H){return(H=H<=.00304?12.92*H:1.055*Math.pow(H,1/2.4)-.055)<0?0:H>1?1:H}function Jo(H){return H>Oa?H*H*H:ol*(H-al)}const Nn=Object.hasOwn||function(H,h){return Object.prototype.hasOwnProperty.call(H,h)};function ii(H,h){return Nn(H,h)?H[h]:void 0}function Wn(H){return parseInt(H.padEnd(2,H),16)/255}function Hn(H,h){return ga(h?H/100:H,0,1)}function ga(H,h,W){return Math.min(Math.max(h,H),W)}function Zs(H){return!H.some(Number.isNaN)}const Ks={aliceblue:[240,248,255],antiquewhite:[250,235,215],aqua:[0,255,255],aquamarine:[127,255,212],azure:[240,255,255],beige:[245,245,220],bisque:[255,228,196],black:[0,0,0],blanchedalmond:[255,235,205],blue:[0,0,255],blueviolet:[138,43,226],brown:[165,42,42],burlywood:[222,184,135],cadetblue:[95,158,160],chartreuse:[127,255,0],chocolate:[210,105,30],coral:[255,127,80],cornflowerblue:[100,149,237],cornsilk:[255,248,220],crimson:[220,20,60],cyan:[0,255,255],darkblue:[0,0,139],darkcyan:[0,139,139],darkgoldenrod:[184,134,11],darkgray:[169,169,169],darkgreen:[0,100,0],darkgrey:[169,169,169],darkkhaki:[189,183,107],darkmagenta:[139,0,139],darkolivegreen:[85,107,47],darkorange:[255,140,0],darkorchid:[153,50,204],darkred:[139,0,0],darksalmon:[233,150,122],darkseagreen:[143,188,143],darkslateblue:[72,61,139],darkslategray:[47,79,79],darkslategrey:[47,79,79],darkturquoise:[0,206,209],darkviolet:[148,0,211],deeppink:[255,20,147],deepskyblue:[0,191,255],dimgray:[105,105,105],dimgrey:[105,105,105],dodgerblue:[30,144,255],firebrick:[178,34,34],floralwhite:[255,250,240],forestgreen:[34,139,34],fuchsia:[255,0,255],gainsboro:[220,220,220],ghostwhite:[248,248,255],gold:[255,215,0],goldenrod:[218,165,32],gray:[128,128,128],green:[0,128,0],greenyellow:[173,255,47],grey:[128,128,128],honeydew:[240,255,240],hotpink:[255,105,180],indianred:[205,92,92],indigo:[75,0,130],ivory:[255,255,240],khaki:[240,230,140],lavender:[230,230,250],lavenderblush:[255,240,245],lawngreen:[124,252,0],lemonchiffon:[255,250,205],lightblue:[173,216,230],lightcoral:[240,128,128],lightcyan:[224,255,255],lightgoldenrodyellow:[250,250,210],lightgray:[211,211,211],lightgreen:[144,238,144],lightgrey:[211,211,211],lightpink:[255,182,193],lightsalmon:[255,160,122],lightseagreen:[32,178,170],lightskyblue:[135,206,250],lightslategray:[119,136,153],lightslategrey:[119,136,153],lightsteelblue:[176,196,222],lightyellow:[255,255,224],lime:[0,255,0],limegreen:[50,205,50],linen:[250,240,230],magenta:[255,0,255],maroon:[128,0,0],mediumaquamarine:[102,205,170],mediumblue:[0,0,205],mediumorchid:[186,85,211],mediumpurple:[147,112,219],mediumseagreen:[60,179,113],mediumslateblue:[123,104,238],mediumspringgreen:[0,250,154],mediumturquoise:[72,209,204],mediumvioletred:[199,21,133],midnightblue:[25,25,112],mintcream:[245,255,250],mistyrose:[255,228,225],moccasin:[255,228,181],navajowhite:[255,222,173],navy:[0,0,128],oldlace:[253,245,230],olive:[128,128,0],olivedrab:[107,142,35],orange:[255,165,0],orangered:[255,69,0],orchid:[218,112,214],palegoldenrod:[238,232,170],palegreen:[152,251,152],paleturquoise:[175,238,238],palevioletred:[219,112,147],papayawhip:[255,239,213],peachpuff:[255,218,185],peru:[205,133,63],pink:[255,192,203],plum:[221,160,221],powderblue:[176,224,230],purple:[128,0,128],rebeccapurple:[102,51,153],red:[255,0,0],rosybrown:[188,143,143],royalblue:[65,105,225],saddlebrown:[139,69,19],salmon:[250,128,114],sandybrown:[244,164,96],seagreen:[46,139,87],seashell:[255,245,238],sienna:[160,82,45],silver:[192,192,192],skyblue:[135,206,235],slateblue:[106,90,205],slategray:[112,128,144],slategrey:[112,128,144],snow:[255,250,250],springgreen:[0,255,127],steelblue:[70,130,180],tan:[210,180,140],teal:[0,128,128],thistle:[216,191,216],tomato:[255,99,71],turquoise:[64,224,208],violet:[238,130,238],wheat:[245,222,179],white:[255,255,255],whitesmoke:[245,245,245],yellow:[255,255,0],yellowgreen:[154,205,50]};function Rn(H,h,W){return H+W*(h-H)}function Zn(H,h,W){return H.map((X,ie)=>Rn(X,h[ie],W))}class ni{constructor(h,W,X,ie=1,ue=!0){this.r=h,this.g=W,this.b=X,this.a=ie,ue||(this.r*=ie,this.g*=ie,this.b*=ie,ie||this.overwriteGetter("rgb",[h,W,X,ie]))}static parse(h){if(h instanceof ni)return h;if(typeof h!="string")return;const W=function(X){if((X=X.toLowerCase().trim())==="transparent")return[0,0,0,0];const ie=ii(Ks,X);if(ie){const[ce,fe,ye]=ie;return[ce/255,fe/255,ye/255,1]}if(X.startsWith("#")&&/^#(?:[0-9a-f]{3,4}|[0-9a-f]{6}|[0-9a-f]{8})$/.test(X)){const ce=X.length<6?1:2;let fe=1;return[Wn(X.slice(fe,fe+=ce)),Wn(X.slice(fe,fe+=ce)),Wn(X.slice(fe,fe+=ce)),Wn(X.slice(fe,fe+ce)||"ff")]}if(X.startsWith("rgb")){const ce=X.match(/^rgba?\(\s*([\de.+-]+)(%)?(?:\s+|\s*(,)\s*)([\de.+-]+)(%)?(?:\s+|\s*(,)\s*)([\de.+-]+)(%)?(?:\s*([,\/])\s*([\de.+-]+)(%)?)?\s*\)$/);if(ce){const[fe,ye,be,we,Ie,Be,Ue,$e,Xe,rt,ct,Ct]=ce,wt=[we||" ",Ue||" ",rt].join("");if(wt==="  "||wt==="  /"||wt===",,"||wt===",,,"){const Ne=[be,Be,Xe].join(""),tt=Ne==="%%%"?100:Ne===""?255:0;if(tt){const Et=[ga(+ye/tt,0,1),ga(+Ie/tt,0,1),ga(+$e/tt,0,1),ct?Hn(+ct,Ct):1];if(Zs(Et))return Et}}return}}const ue=X.match(/^hsla?\(\s*([\de.+-]+)(?:deg)?(?:\s+|\s*(,)\s*)([\de.+-]+)%(?:\s+|\s*(,)\s*)([\de.+-]+)%(?:\s*([,\/])\s*([\de.+-]+)(%)?)?\s*\)$/);if(ue){const[ce,fe,ye,be,we,Ie,Be,Ue,$e]=ue,Xe=[ye||" ",we||" ",Be].join("");if(Xe==="  "||Xe==="  /"||Xe===",,"||Xe===",,,"){const rt=[+fe,ga(+be,0,100),ga(+Ie,0,100),Ue?Hn(+Ue,$e):1];if(Zs(rt))return function([ct,Ct,wt,Ne]){function tt(Et){const Ut=(Et+ct/30)%12,Jt=Ct*Math.min(wt,1-wt);return wt-Jt*Math.max(-1,Math.min(Ut-3,9-Ut,1))}return ct=ul(ct),Ct/=100,wt/=100,[tt(0),tt(8),tt(4),Ne]}(rt)}}}(h);return W?new ni(...W,!1):void 0}get rgb(){const{r:h,g:W,b:X,a:ie}=this,ue=ie||1/0;return this.overwriteGetter("rgb",[h/ue,W/ue,X/ue,ie])}get hcl(){return this.overwriteGetter("hcl",function(h){const[W,X,ie,ue]=Ca(h),ce=Math.sqrt(X*X+ie*ie);return[Math.round(1e4*ce)?ul(Math.atan2(ie,X)*fc):NaN,ce,W,ue]}(this.rgb))}get lab(){return this.overwriteGetter("lab",Ca(this.rgb))}overwriteGetter(h,W){return Object.defineProperty(this,h,{value:W}),W}toString(){const[h,W,X,ie]=this.rgb;return`rgba(${[h,W,X].map(ue=>Math.round(255*ue)).join(",")},${ie})`}static interpolate(h,W,X,ie="rgb"){switch(ie){case"rgb":{const[ue,ce,fe,ye]=Zn(h.rgb,W.rgb,X);return new ni(ue,ce,fe,ye,!1)}case"hcl":{const[ue,ce,fe,ye]=h.hcl,[be,we,Ie,Be]=W.hcl;let Ue,$e;if(isNaN(ue)||isNaN(be))isNaN(ue)?isNaN(be)?Ue=NaN:(Ue=be,fe!==1&&fe!==0||($e=we)):(Ue=ue,Ie!==1&&Ie!==0||($e=ce));else{let wt=be-ue;be>ue&&wt>180?wt-=360:be<ue&&ue-be>180&&(wt+=360),Ue=ue+X*wt}const[Xe,rt,ct,Ct]=function([wt,Ne,tt,Et]){return wt=isNaN(wt)?0:wt*co,ll([tt,Math.cos(wt)*Ne,Math.sin(wt)*Ne,Et])}([Ue,$e??Rn(ce,we,X),Rn(fe,Ie,X),Rn(ye,Be,X)]);return new ni(Xe,rt,ct,Ct,!1)}case"lab":{const[ue,ce,fe,ye]=ll(Zn(h.lab,W.lab,X));return new ni(ue,ce,fe,ye,!1)}}}}ni.black=new ni(0,0,0,1),ni.white=new ni(1,1,1,1),ni.transparent=new ni(0,0,0,0),ni.red=new ni(1,0,0,1);class ho{constructor(h,W,X){this.sensitivity=h?W?"variant":"case":W?"accent":"base",this.locale=X,this.collator=new Intl.Collator(this.locale?this.locale:[],{sensitivity:this.sensitivity,usage:"search"})}compare(h,W){return this.collator.compare(h,W)}resolvedLocale(){return new Intl.Collator(this.locale?this.locale:[]).resolvedOptions().locale}}const Qo=["bottom","center","top"];class Ys{constructor(h,W,X,ie,ue,ce){this.text=h,this.image=W,this.scale=X,this.fontStack=ie,this.textColor=ue,this.verticalAlign=ce}}class sn{constructor(h){this.sections=h}static fromString(h){return new sn([new Ys(h,null,null,null,null,null)])}isEmpty(){return this.sections.length===0||!this.sections.some(h=>h.text.length!==0||h.image&&h.image.name.length!==0)}static factory(h){return h instanceof sn?h:sn.fromString(h)}toString(){return this.sections.length===0?"":this.sections.map(h=>h.text).join("")}}class Bi{constructor(h){this.values=h.slice()}static parse(h){if(h instanceof Bi)return h;if(typeof h=="number")return new Bi([h,h,h,h]);if(Array.isArray(h)&&!(h.length<1||h.length>4)){for(const W of h)if(typeof W!="number")return;switch(h.length){case 1:h=[h[0],h[0],h[0],h[0]];break;case 2:h=[h[0],h[1],h[0],h[1]];break;case 3:h=[h[0],h[1],h[2],h[1]]}return new Bi(h)}}toString(){return JSON.stringify(this.values)}static interpolate(h,W,X){return new Bi(Zn(h.values,W.values,X))}}class un{constructor(h){this.values=h.slice()}static parse(h){if(h instanceof un)return h;if(typeof h=="number")return new un([h]);if(Array.isArray(h)){for(const W of h)if(typeof W!="number")return;return new un(h)}}toString(){return JSON.stringify(this.values)}static interpolate(h,W,X){return new un(Zn(h.values,W.values,X))}}class $i{constructor(h){this.values=h.slice()}static parse(h){if(h instanceof $i)return h;if(typeof h=="string"){const X=ni.parse(h);return X?new $i([X]):void 0}if(!Array.isArray(h))return;const W=[];for(const X of h){if(typeof X!="string")return;const ie=ni.parse(X);if(!ie)return;W.push(ie)}return new $i(W)}toString(){return JSON.stringify(this.values)}static interpolate(h,W,X,ie="rgb"){const ue=[];if(h.values.length!=W.values.length)throw new Error(`colorArray: Arrays have mismatched length (${h.values.length} vs. ${W.values.length}), cannot interpolate.`);for(let ce=0;ce<h.values.length;ce++)ue.push(ni.interpolate(h.values[ce],W.values[ce],X,ie));return new $i(ue)}}class Ti extends Error{constructor(h){super(h),this.name="RuntimeError"}toJSON(){return this.message}}const es=new Set(["center","left","right","top","bottom","top-left","top-right","bottom-left","bottom-right"]);class ui{constructor(h){this.values=h.slice()}static parse(h){if(h instanceof ui)return h;if(Array.isArray(h)&&!(h.length<1)&&h.length%2==0){for(let W=0;W<h.length;W+=2){const X=h[W],ie=h[W+1];if(typeof X!="string"||!es.has(X)||!Array.isArray(ie)||ie.length!==2||typeof ie[0]!="number"||typeof ie[1]!="number")return}return new ui(h)}}toString(){return JSON.stringify(this.values)}static interpolate(h,W,X){const ie=h.values,ue=W.values;if(ie.length!==ue.length)throw new Ti(`Cannot interpolate values of different length. from: ${h.toString()}, to: ${W.toString()}`);const ce=[];for(let fe=0;fe<ie.length;fe+=2){if(ie[fe]!==ue[fe])throw new Ti(`Cannot interpolate values containing mismatched anchors. from[${fe}]: ${ie[fe]}, to[${fe}]: ${ue[fe]}`);ce.push(ie[fe]);const[ye,be]=ie[fe+1],[we,Ie]=ue[fe+1];ce.push([Rn(ye,we,X),Rn(be,Ie,X)])}return new ui(ce)}}class gn{constructor(h){this.name=h.name,this.available=h.available}toString(){return this.name}static fromString(h){return h?new gn({name:h,available:!1}):null}}class Xr{constructor(h,W,X){this.from=h,this.to=W,this.transition=X}static interpolate(h,W,X){return new Xr(h,W,X)}static parse(h){return h instanceof Xr?h:Array.isArray(h)&&h.length===3&&typeof h[0]=="string"&&typeof h[1]=="string"&&typeof h[2]=="number"?new Xr(h[0],h[1],h[2]):typeof h=="object"&&typeof h.from=="string"&&typeof h.to=="string"&&typeof h.transition=="number"?new Xr(h.from,h.to,h.transition):typeof h=="string"?new Xr(h,h,1):void 0}}function ei(H,h,W,X){return typeof H=="number"&&H>=0&&H<=255&&typeof h=="number"&&h>=0&&h<=255&&typeof W=="number"&&W>=0&&W<=255?X===void 0||typeof X=="number"&&X>=0&&X<=1?null:`Invalid rgba value [${[H,h,W,X].join(", ")}]: 'a' must be between 0 and 1.`:`Invalid rgba value [${(typeof X=="number"?[H,h,W,X]:[H,h,W]).join(", ")}]: 'r', 'g', and 'b' must be between 0 and 255.`}function va(H){if(H===null||typeof H=="string"||typeof H=="boolean"||typeof H=="number"||H instanceof Xr||H instanceof ni||H instanceof ho||H instanceof sn||H instanceof Bi||H instanceof un||H instanceof $i||H instanceof ui||H instanceof gn)return!0;if(Array.isArray(H)){for(const h of H)if(!va(h))return!1;return!0}if(typeof H=="object"){for(const h in H)if(!va(H[h]))return!1;return!0}return!1}function $r(H){if(H===null)return yn;if(typeof H=="string")return Lt;if(typeof H=="boolean")return Yt;if(typeof H=="number")return pr;if(H instanceof ni)return Ht;if(H instanceof Xr)return Bt;if(H instanceof ho)return Mr;if(H instanceof sn)return pi;if(H instanceof Bi)return ri;if(H instanceof un)return Vi;if(H instanceof $i)return Oi;if(H instanceof ui)return qi;if(H instanceof gn)return hr;if(Array.isArray(H)){const h=H.length;let W;for(const X of H){const ie=$r(X);if(W){if(W===ie)continue;W=gr;break}W=ie}return Ci(W||gr,h)}return ir}function ba(H){const h=typeof H;return H===null?"":h==="string"||h==="number"||h==="boolean"?String(H):H instanceof ni||H instanceof Xr||H instanceof sn||H instanceof Bi||H instanceof un||H instanceof $i||H instanceof ui||H instanceof gn?H.toString():JSON.stringify(H)}class hn{constructor(h,W){this.type=h,this.value=W}static parse(h,W){if(h.length!==2)return W.error(`'literal' expression requires exactly one argument, but found ${h.length-1} instead.`);if(!va(h[1]))return W.error("invalid value");const X=h[1];let ie=$r(X);const ue=W.expectedType;return ie.kind!=="array"||ie.N!==0||!ue||ue.kind!=="array"||typeof ue.N=="number"&&ue.N!==0||(ie=ue),new hn(ie,X)}evaluate(){return this.value}eachChild(){}outputDefined(){return!0}}const Ma={string:Lt,number:pr,boolean:Yt,object:ir};class vn{constructor(h,W){this.type=h,this.args=W}static parse(h,W){if(h.length<2)return W.error("Expected at least one argument.");let X,ie=1;const ue=h[0];if(ue==="array"){let fe,ye;if(h.length>2){const be=h[1];if(typeof be!="string"||!(be in Ma)||be==="object")return W.error('The item type argument of "array" must be one of string, number, boolean',1);fe=Ma[be],ie++}else fe=gr;if(h.length>3){if(h[2]!==null&&(typeof h[2]!="number"||h[2]<0||h[2]!==Math.floor(h[2])))return W.error('The length argument to "array" must be a positive integer literal',2);ye=h[2],ie++}X=Ci(fe,ye)}else{if(!Ma[ue])throw new Error(`Types doesn't contain name = ${ue}`);X=Ma[ue]}const ce=[];for(;ie<h.length;ie++){const fe=W.parse(h[ie],ie,gr);if(!fe)return null;ce.push(fe)}return new vn(X,ce)}evaluate(h){for(let W=0;W<this.args.length;W++){const X=this.args[W].evaluate(h);if(!ra(this.type,$r(X)))return X;if(W===this.args.length-1)throw new Ti(`Expected value to be of type ${yi(this.type)}, but found ${yi($r(X))} instead.`)}throw new Error}eachChild(h){this.args.forEach(h)}outputDefined(){return this.args.every(h=>h.outputDefined())}}const Xs={"to-boolean":Yt,"to-color":Ht,"to-number":pr,"to-string":Lt};class zn{constructor(h,W){this.type=h,this.args=W}static parse(h,W){if(h.length<2)return W.error("Expected at least one argument.");const X=h[0];if(!Xs[X])throw new Error(`Can't parse ${X} as it is not part of the known types`);if((X==="to-boolean"||X==="to-string")&&h.length!==2)return W.error("Expected one argument.");const ie=Xs[X],ue=[];for(let ce=1;ce<h.length;ce++){const fe=W.parse(h[ce],ce,gr);if(!fe)return null;ue.push(fe)}return new zn(ie,ue)}evaluate(h){switch(this.type.kind){case"boolean":return!!this.args[0].evaluate(h);case"color":{let W,X;for(const ie of this.args){if(W=ie.evaluate(h),X=null,W instanceof ni)return W;if(typeof W=="string"){const ue=h.parseColor(W);if(ue)return ue}else if(Array.isArray(W)&&(X=W.length<3||W.length>4?`Invalid rgba value ${JSON.stringify(W)}: expected an array containing either three or four numeric values.`:ei(W[0],W[1],W[2],W[3]),!X))return new ni(W[0]/255,W[1]/255,W[2]/255,W[3])}throw new Ti(X||`Could not parse color from value '${typeof W=="string"?W:JSON.stringify(W)}'`)}case"padding":{let W;for(const X of this.args){W=X.evaluate(h);const ie=Bi.parse(W);if(ie)return ie}throw new Ti(`Could not parse padding from value '${typeof W=="string"?W:JSON.stringify(W)}'`)}case"numberArray":{let W;for(const X of this.args){W=X.evaluate(h);const ie=un.parse(W);if(ie)return ie}throw new Ti(`Could not parse numberArray from value '${typeof W=="string"?W:JSON.stringify(W)}'`)}case"colorArray":{let W;for(const X of this.args){W=X.evaluate(h);const ie=$i.parse(W);if(ie)return ie}throw new Ti(`Could not parse colorArray from value '${typeof W=="string"?W:JSON.stringify(W)}'`)}case"variableAnchorOffsetCollection":{let W;for(const X of this.args){W=X.evaluate(h);const ie=ui.parse(W);if(ie)return ie}throw new Ti(`Could not parse variableAnchorOffsetCollection from value '${typeof W=="string"?W:JSON.stringify(W)}'`)}case"number":{let W=null;for(const X of this.args){if(W=X.evaluate(h),W===null)return 0;const ie=Number(W);if(!isNaN(ie))return ie}throw new Ti(`Could not convert ${JSON.stringify(W)} to number.`)}case"formatted":return sn.fromString(ba(this.args[0].evaluate(h)));case"resolvedImage":return gn.fromString(ba(this.args[0].evaluate(h)));case"projectionDefinition":return this.args[0].evaluate(h);default:return ba(this.args[0].evaluate(h))}}eachChild(h){this.args.forEach(h)}outputDefined(){return this.args.every(h=>h.outputDefined())}}const cl=["Unknown","Point","LineString","Polygon"];class hl{constructor(){this.globals=null,this.feature=null,this.featureState=null,this.formattedSection=null,this._parseColorCache=new Map,this.availableImages=null,this.canonical=null}id(){return this.feature&&"id"in this.feature?this.feature.id:null}geometryType(){return this.feature?typeof this.feature.type=="number"?cl[this.feature.type]:this.feature.type:null}geometry(){return this.feature&&"geometry"in this.feature?this.feature.geometry:null}canonicalID(){return this.canonical}properties(){return this.feature&&this.feature.properties||{}}parseColor(h){let W=this._parseColorCache.get(h);return W||(W=ni.parse(h),this._parseColorCache.set(h,W)),W}}class fo{constructor(h,W,X=[],ie,ue=new Ei,ce=[]){this.registry=h,this.path=X,this.key=X.map(fe=>`[${fe}]`).join(""),this.scope=ue,this.errors=ce,this.expectedType=ie,this._isConstant=W}parse(h,W,X,ie,ue={}){return W?this.concat(W,X,ie)._parse(h,ue):this._parse(h,ue)}_parse(h,W){function X(ie,ue,ce){return ce==="assert"?new vn(ue,[ie]):ce==="coerce"?new zn(ue,[ie]):ie}if(h!==null&&typeof h!="string"&&typeof h!="boolean"&&typeof h!="number"||(h=["literal",h]),Array.isArray(h)){if(h.length===0)return this.error('Expected an array with at least one element. If you wanted a literal array, use ["literal", []].');const ie=h[0];if(typeof ie!="string")return this.error(`Expression name must be a string, but found ${typeof ie} instead. If you wanted a literal array, use ["literal", [...]].`,0),null;const ue=this.registry[ie];if(ue){let ce=ue.parse(h,this);if(!ce)return null;if(this.expectedType){const fe=this.expectedType,ye=ce.type;if(fe.kind!=="string"&&fe.kind!=="number"&&fe.kind!=="boolean"&&fe.kind!=="object"&&fe.kind!=="array"||ye.kind!=="value"){if(fe.kind==="projectionDefinition"&&["string","array"].includes(ye.kind)||["color","formatted","resolvedImage"].includes(fe.kind)&&["value","string"].includes(ye.kind)||["padding","numberArray"].includes(fe.kind)&&["value","number","array"].includes(ye.kind)||fe.kind==="colorArray"&&["value","string","array"].includes(ye.kind)||fe.kind==="variableAnchorOffsetCollection"&&["value","array"].includes(ye.kind))ce=X(ce,fe,W.typeAnnotation||"coerce");else if(this.checkSubtype(fe,ye))return null}else ce=X(ce,fe,W.typeAnnotation||"assert")}if(!(ce instanceof hn)&&ce.type.kind!=="resolvedImage"&&this._isConstant(ce)){const fe=new hl;try{ce=new hn(ce.type,ce.evaluate(fe))}catch(ye){return this.error(ye.message),null}}return ce}return this.error(`Unknown expression "${ie}". If you wanted a literal array, use ["literal", [...]].`,0)}return this.error(h===void 0?"'undefined' value invalid. Use null instead.":typeof h=="object"?'Bare objects invalid. Use ["literal", {...}] instead.':`Expected an array, but found ${typeof h} instead.`)}concat(h,W,X){const ie=typeof h=="number"?this.path.concat(h):this.path,ue=X?this.scope.concat(X):this.scope;return new fo(this.registry,this._isConstant,ie,W||null,ue,this.errors)}error(h,...W){const X=`${this.key}${W.map(ie=>`[${ie}]`).join("")}`;this.errors.push(new Qr(X,h))}checkSubtype(h,W){const X=ra(h,W);return X&&this.error(X),X}}class po{constructor(h,W){this.type=W.type,this.bindings=[].concat(h),this.result=W}evaluate(h){return this.result.evaluate(h)}eachChild(h){for(const W of this.bindings)h(W[1]);h(this.result)}static parse(h,W){if(h.length<4)return W.error(`Expected at least 3 arguments, but found ${h.length-1} instead.`);const X=[];for(let ue=1;ue<h.length-1;ue+=2){const ce=h[ue];if(typeof ce!="string")return W.error(`Expected string, but found ${typeof ce} instead.`,ue);if(/[^a-zA-Z0-9_]/.test(ce))return W.error("Variable names must contain only alphanumeric characters or '_'.",ue);const fe=W.parse(h[ue+1],ue+1);if(!fe)return null;X.push([ce,fe])}const ie=W.parse(h[h.length-1],h.length-1,W.expectedType,X);return ie?new po(X,ie):null}outputDefined(){return this.result.outputDefined()}}class Cn{constructor(h,W){this.type=W.type,this.name=h,this.boundExpression=W}static parse(h,W){if(h.length!==2||typeof h[1]!="string")return W.error("'var' expression requires exactly one string literal argument.");const X=h[1];return W.scope.has(X)?new Cn(X,W.scope.get(X)):W.error(`Unknown variable "${X}". Make sure "${X}" has been bound in an enclosing "let" expression before using it.`,1)}evaluate(h){return this.boundExpression.evaluate(h)}eachChild(){}outputDefined(){return!1}}class Wi{constructor(h,W,X){this.type=h,this.index=W,this.input=X}static parse(h,W){if(h.length!==3)return W.error(`Expected 2 arguments, but found ${h.length-1} instead.`);const X=W.parse(h[1],1,pr),ie=W.parse(h[2],2,Ci(W.expectedType||gr));return X&&ie?new Wi(ie.type.itemType,X,ie):null}evaluate(h){const W=this.index.evaluate(h),X=this.input.evaluate(h);if(W<0)throw new Ti(`Array index out of bounds: ${W} < 0.`);if(W>=X.length)throw new Ti(`Array index out of bounds: ${W} > ${X.length-1}.`);if(W!==Math.floor(W))throw new Ti(`Array index must be an integer, but found ${W} instead.`);return X[W]}eachChild(h){h(this.index),h(this.input)}outputDefined(){return!1}}class Da{constructor(h,W){this.type=Yt,this.needle=h,this.haystack=W}static parse(h,W){if(h.length!==3)return W.error(`Expected 2 arguments, but found ${h.length-1} instead.`);const X=W.parse(h[1],1,gr),ie=W.parse(h[2],2,gr);return X&&ie?ia(X.type,[Yt,Lt,pr,yn,gr])?new Da(X,ie):W.error(`Expected first argument to be of type boolean, string, number or null, but found ${yi(X.type)} instead`):null}evaluate(h){const W=this.needle.evaluate(h),X=this.haystack.evaluate(h);if(!X)return!1;if(!ya(W,["boolean","string","number","null"]))throw new Ti(`Expected first argument to be of type boolean, string, number or null, but found ${yi($r(W))} instead.`);if(!ya(X,["string","array"]))throw new Ti(`Expected second argument to be of type array or string, but found ${yi($r(X))} instead.`);return X.indexOf(W)>=0}eachChild(h){h(this.needle),h(this.haystack)}outputDefined(){return!0}}class _o{constructor(h,W,X){this.type=pr,this.needle=h,this.haystack=W,this.fromIndex=X}static parse(h,W){if(h.length<=2||h.length>=5)return W.error(`Expected 3 or 4 arguments, but found ${h.length-1} instead.`);const X=W.parse(h[1],1,gr),ie=W.parse(h[2],2,gr);if(!X||!ie)return null;if(!ia(X.type,[Yt,Lt,pr,yn,gr]))return W.error(`Expected first argument to be of type boolean, string, number or null, but found ${yi(X.type)} instead`);if(h.length===4){const ue=W.parse(h[3],3,pr);return ue?new _o(X,ie,ue):null}return new _o(X,ie)}evaluate(h){const W=this.needle.evaluate(h),X=this.haystack.evaluate(h);if(!ya(W,["boolean","string","number","null"]))throw new Ti(`Expected first argument to be of type boolean, string, number or null, but found ${yi($r(W))} instead.`);let ie;if(this.fromIndex&&(ie=this.fromIndex.evaluate(h)),ya(X,["string"])){const ue=X.indexOf(W,ie);return ue===-1?-1:[...X.slice(0,ue)].length}if(ya(X,["array"]))return X.indexOf(W,ie);throw new Ti(`Expected second argument to be of type array or string, but found ${yi($r(X))} instead.`)}eachChild(h){h(this.needle),h(this.haystack),this.fromIndex&&h(this.fromIndex)}outputDefined(){return!1}}class Fa{constructor(h,W,X,ie,ue,ce){this.inputType=h,this.type=W,this.input=X,this.cases=ie,this.outputs=ue,this.otherwise=ce}static parse(h,W){if(h.length<5)return W.error(`Expected at least 4 arguments, but found only ${h.length-1}.`);if(h.length%2!=1)return W.error("Expected an even number of arguments.");let X,ie;W.expectedType&&W.expectedType.kind!=="value"&&(ie=W.expectedType);const ue={},ce=[];for(let be=2;be<h.length-1;be+=2){let we=h[be];const Ie=h[be+1];Array.isArray(we)||(we=[we]);const Be=W.concat(be);if(we.length===0)return Be.error("Expected at least one branch label.");for(const $e of we){if(typeof $e!="number"&&typeof $e!="string")return Be.error("Branch labels must be numbers or strings.");if(typeof $e=="number"&&Math.abs($e)>Number.MAX_SAFE_INTEGER)return Be.error(`Branch labels must be integers no larger than ${Number.MAX_SAFE_INTEGER}.`);if(typeof $e=="number"&&Math.floor($e)!==$e)return Be.error("Numeric branch labels must be integer values.");if(X){if(Be.checkSubtype(X,$r($e)))return null}else X=$r($e);if(ue[String($e)]!==void 0)return Be.error("Branch labels must be unique.");ue[String($e)]=ce.length}const Ue=W.parse(Ie,be,ie);if(!Ue)return null;ie=ie||Ue.type,ce.push(Ue)}const fe=W.parse(h[1],1,gr);if(!fe)return null;const ye=W.parse(h[h.length-1],h.length-1,ie);return ye?fe.type.kind!=="value"&&W.concat(1).checkSubtype(X,fe.type)?null:new Fa(X,ie,fe,ue,ce,ye):null}evaluate(h){const W=this.input.evaluate(h);return($r(W)===this.inputType&&this.outputs[this.cases[W]]||this.otherwise).evaluate(h)}eachChild(h){h(this.input),this.outputs.forEach(h),h(this.otherwise)}outputDefined(){return this.outputs.every(h=>h.outputDefined())&&this.otherwise.outputDefined()}}class ji{constructor(h,W,X){this.type=h,this.branches=W,this.otherwise=X}static parse(h,W){if(h.length<4)return W.error(`Expected at least 3 arguments, but found only ${h.length-1}.`);if(h.length%2!=0)return W.error("Expected an odd number of arguments.");let X;W.expectedType&&W.expectedType.kind!=="value"&&(X=W.expectedType);const ie=[];for(let ce=1;ce<h.length-1;ce+=2){const fe=W.parse(h[ce],ce,Yt);if(!fe)return null;const ye=W.parse(h[ce+1],ce+1,X);if(!ye)return null;ie.push([fe,ye]),X=X||ye.type}const ue=W.parse(h[h.length-1],h.length-1,X);if(!ue)return null;if(!X)throw new Error("Can't infer output type");return new ji(X,ie,ue)}evaluate(h){for(const[W,X]of this.branches)if(W.evaluate(h))return X.evaluate(h);return this.otherwise.evaluate(h)}eachChild(h){for(const[W,X]of this.branches)h(W),h(X);h(this.otherwise)}outputDefined(){return this.branches.every(([h,W])=>W.outputDefined())&&this.otherwise.outputDefined()}}class mo{constructor(h,W,X,ie){this.type=h,this.input=W,this.beginIndex=X,this.endIndex=ie}static parse(h,W){if(h.length<=2||h.length>=5)return W.error(`Expected 3 or 4 arguments, but found ${h.length-1} instead.`);const X=W.parse(h[1],1,gr),ie=W.parse(h[2],2,pr);if(!X||!ie)return null;if(!ia(X.type,[Ci(gr),Lt,gr]))return W.error(`Expected first argument to be of type array or string, but found ${yi(X.type)} instead`);if(h.length===4){const ue=W.parse(h[3],3,pr);return ue?new mo(X.type,X,ie,ue):null}return new mo(X.type,X,ie)}evaluate(h){const W=this.input.evaluate(h),X=this.beginIndex.evaluate(h);let ie;if(this.endIndex&&(ie=this.endIndex.evaluate(h)),ya(W,["string"]))return[...W].slice(X,ie).join("");if(ya(W,["array"]))return W.slice(X,ie);throw new Ti(`Expected first argument to be of type array or string, but found ${yi($r(W))} instead.`)}eachChild(h){h(this.input),h(this.beginIndex),this.endIndex&&h(this.endIndex)}outputDefined(){return!1}}function ka(H,h){const W=H.length-1;let X,ie,ue=0,ce=W,fe=0;for(;ue<=ce;)if(fe=Math.floor((ue+ce)/2),X=H[fe],ie=H[fe+1],X<=h){if(fe===W||h<ie)return fe;ue=fe+1}else{if(!(X>h))throw new Ti("Input is not a number.");ce=fe-1}return 0}class La{constructor(h,W,X){this.type=h,this.input=W,this.labels=[],this.outputs=[];for(const[ie,ue]of X)this.labels.push(ie),this.outputs.push(ue)}static parse(h,W){if(h.length-1<4)return W.error(`Expected at least 4 arguments, but found only ${h.length-1}.`);if((h.length-1)%2!=0)return W.error("Expected an even number of arguments.");const X=W.parse(h[1],1,pr);if(!X)return null;const ie=[];let ue=null;W.expectedType&&W.expectedType.kind!=="value"&&(ue=W.expectedType);for(let ce=1;ce<h.length;ce+=2){const fe=ce===1?-1/0:h[ce],ye=h[ce+1],be=ce,we=ce+1;if(typeof fe!="number")return W.error('Input/output pairs for "step" expressions must be defined using literal numeric values (not computed expressions) for the input values.',be);if(ie.length&&ie[ie.length-1][0]>=fe)return W.error('Input/output pairs for "step" expressions must be arranged with input values in strictly ascending order.',be);const Ie=W.parse(ye,we,ue);if(!Ie)return null;ue=ue||Ie.type,ie.push([fe,Ie])}return new La(ue,X,ie)}evaluate(h){const W=this.labels,X=this.outputs;if(W.length===1)return X[0].evaluate(h);const ie=this.input.evaluate(h);if(ie<=W[0])return X[0].evaluate(h);const ue=W.length;return ie>=W[ue-1]?X[ue-1].evaluate(h):X[ka(W,ie)].evaluate(h)}eachChild(h){h(this.input);for(const W of this.outputs)h(W)}outputDefined(){return this.outputs.every(h=>h.outputDefined())}}function pc(H){return H&&H.__esModule&&Object.prototype.hasOwnProperty.call(H,"default")?H.default:H}var aa,yo,Js=function(){if(yo)return aa;function H(h,W,X,ie){this.cx=3*h,this.bx=3*(X-h)-this.cx,this.ax=1-this.cx-this.bx,this.cy=3*W,this.by=3*(ie-W)-this.cy,this.ay=1-this.cy-this.by,this.p1x=h,this.p1y=W,this.p2x=X,this.p2y=ie}return yo=1,aa=H,H.prototype={sampleCurveX:function(h){return((this.ax*h+this.bx)*h+this.cx)*h},sampleCurveY:function(h){return((this.ay*h+this.by)*h+this.cy)*h},sampleCurveDerivativeX:function(h){return(3*this.ax*h+2*this.bx)*h+this.cx},solveCurveX:function(h,W){if(W===void 0&&(W=1e-6),h<0)return 0;if(h>1)return 1;for(var X=h,ie=0;ie<8;ie++){var ue=this.sampleCurveX(X)-h;if(Math.abs(ue)<W)return X;var ce=this.sampleCurveDerivativeX(X);if(Math.abs(ce)<1e-6)break;X-=ue/ce}var fe=0,ye=1;for(X=h,ie=0;ie<20&&(ue=this.sampleCurveX(X),!(Math.abs(ue-h)<W));ie++)h>ue?fe=X:ye=X,X=.5*(ye-fe)+fe;return X},solve:function(h,W){return this.sampleCurveY(this.solveCurveX(h,W))}},aa}(),_c=pc(Js);class dn{constructor(h,W,X,ie,ue){this.type=h,this.operator=W,this.interpolation=X,this.input=ie,this.labels=[],this.outputs=[];for(const[ce,fe]of ue)this.labels.push(ce),this.outputs.push(fe)}static interpolationFactor(h,W,X,ie){let ue=0;if(h.name==="exponential")ue=Ba(W,h.base,X,ie);else if(h.name==="linear")ue=Ba(W,1,X,ie);else if(h.name==="cubic-bezier"){const ce=h.controlPoints;ue=new _c(ce[0],ce[1],ce[2],ce[3]).solve(Ba(W,1,X,ie))}return ue}static parse(h,W){let[X,ie,ue,...ce]=h;if(!Array.isArray(ie)||ie.length===0)return W.error("Expected an interpolation type expression.",1);if(ie[0]==="linear")ie={name:"linear"};else if(ie[0]==="exponential"){const be=ie[1];if(typeof be!="number")return W.error("Exponential interpolation requires a numeric base.",1,1);ie={name:"exponential",base:be}}else{if(ie[0]!=="cubic-bezier")return W.error(`Unknown interpolation type ${String(ie[0])}`,1,0);{const be=ie.slice(1);if(be.length!==4||be.some(we=>typeof we!="number"||we<0||we>1))return W.error("Cubic bezier interpolation requires four numeric arguments with values between 0 and 1.",1);ie={name:"cubic-bezier",controlPoints:be}}}if(h.length-1<4)return W.error(`Expected at least 4 arguments, but found only ${h.length-1}.`);if((h.length-1)%2!=0)return W.error("Expected an even number of arguments.");if(ue=W.parse(ue,2,pr),!ue)return null;const fe=[];let ye=null;X!=="interpolate-hcl"&&X!=="interpolate-lab"||W.expectedType==Oi?W.expectedType&&W.expectedType.kind!=="value"&&(ye=W.expectedType):ye=Ht;for(let be=0;be<ce.length;be+=2){const we=ce[be],Ie=ce[be+1],Be=be+3,Ue=be+4;if(typeof we!="number")return W.error('Input/output pairs for "interpolate" expressions must be defined using literal numeric values (not computed expressions) for the input values.',Be);if(fe.length&&fe[fe.length-1][0]>=we)return W.error('Input/output pairs for "interpolate" expressions must be arranged with input values in strictly ascending order.',Be);const $e=W.parse(Ie,Ue,ye);if(!$e)return null;ye=ye||$e.type,fe.push([we,$e])}return na(ye,pr)||na(ye,Bt)||na(ye,Ht)||na(ye,ri)||na(ye,Vi)||na(ye,Oi)||na(ye,qi)||na(ye,Ci(pr))?new dn(ye,X,ie,ue,fe):W.error(`Type ${yi(ye)} is not interpolatable.`)}evaluate(h){const W=this.labels,X=this.outputs;if(W.length===1)return X[0].evaluate(h);const ie=this.input.evaluate(h);if(ie<=W[0])return X[0].evaluate(h);const ue=W.length;if(ie>=W[ue-1])return X[ue-1].evaluate(h);const ce=ka(W,ie),fe=dn.interpolationFactor(this.interpolation,ie,W[ce],W[ce+1]),ye=X[ce].evaluate(h),be=X[ce+1].evaluate(h);switch(this.operator){case"interpolate":switch(this.type.kind){case"number":return Rn(ye,be,fe);case"color":return ni.interpolate(ye,be,fe);case"padding":return Bi.interpolate(ye,be,fe);case"colorArray":return $i.interpolate(ye,be,fe);case"numberArray":return un.interpolate(ye,be,fe);case"variableAnchorOffsetCollection":return ui.interpolate(ye,be,fe);case"array":return Zn(ye,be,fe);case"projectionDefinition":return Xr.interpolate(ye,be,fe)}case"interpolate-hcl":switch(this.type.kind){case"color":return ni.interpolate(ye,be,fe,"hcl");case"colorArray":return $i.interpolate(ye,be,fe,"hcl")}case"interpolate-lab":switch(this.type.kind){case"color":return ni.interpolate(ye,be,fe,"lab");case"colorArray":return $i.interpolate(ye,be,fe,"lab")}}}eachChild(h){h(this.input);for(const W of this.outputs)h(W)}outputDefined(){return this.outputs.every(h=>h.outputDefined())}}function Ba(H,h,W,X){const ie=X-W,ue=H-W;return ie===0?0:h===1?ue/ie:(Math.pow(h,ue)-1)/(Math.pow(h,ie)-1)}const En={color:ni.interpolate,number:Rn,padding:Bi.interpolate,numberArray:un.interpolate,colorArray:$i.interpolate,variableAnchorOffsetCollection:ui.interpolate,array:Zn};class bn{constructor(h,W){this.type=h,this.args=W}static parse(h,W){if(h.length<2)return W.error("Expected at least one argument.");let X=null;const ie=W.expectedType;ie&&ie.kind!=="value"&&(X=ie);const ue=[];for(const fe of h.slice(1)){const ye=W.parse(fe,1+ue.length,X,void 0,{typeAnnotation:"omit"});if(!ye)return null;X=X||ye.type,ue.push(ye)}if(!X)throw new Error("No output type");const ce=ie&&ue.some(fe=>ra(ie,fe.type));return new bn(ce?gr:X,ue)}evaluate(h){let W,X=null,ie=0;for(const ue of this.args)if(ie++,X=ue.evaluate(h),X&&X instanceof gn&&!X.available&&(W||(W=X.name),X=null,ie===this.args.length&&(X=W)),X!==null)break;return X}eachChild(h){this.args.forEach(h)}outputDefined(){return this.args.every(h=>h.outputDefined())}}function Qs(H,h){return H==="=="||H==="!="?h.kind==="boolean"||h.kind==="string"||h.kind==="number"||h.kind==="null"||h.kind==="value":h.kind==="string"||h.kind==="number"||h.kind==="value"}function go(H,h,W,X){return X.compare(h,W)===0}function ja(H,h,W){const X=H!=="=="&&H!=="!=";return class mf{constructor(ue,ce,fe){this.type=Yt,this.lhs=ue,this.rhs=ce,this.collator=fe,this.hasUntypedArgument=ue.type.kind==="value"||ce.type.kind==="value"}static parse(ue,ce){if(ue.length!==3&&ue.length!==4)return ce.error("Expected two or three arguments.");const fe=ue[0];let ye=ce.parse(ue[1],1,gr);if(!ye)return null;if(!Qs(fe,ye.type))return ce.concat(1).error(`"${fe}" comparisons are not supported for type '${yi(ye.type)}'.`);let be=ce.parse(ue[2],2,gr);if(!be)return null;if(!Qs(fe,be.type))return ce.concat(2).error(`"${fe}" comparisons are not supported for type '${yi(be.type)}'.`);if(ye.type.kind!==be.type.kind&&ye.type.kind!=="value"&&be.type.kind!=="value")return ce.error(`Cannot compare types '${yi(ye.type)}' and '${yi(be.type)}'.`);X&&(ye.type.kind==="value"&&be.type.kind!=="value"?ye=new vn(be.type,[ye]):ye.type.kind!=="value"&&be.type.kind==="value"&&(be=new vn(ye.type,[be])));let we=null;if(ue.length===4){if(ye.type.kind!=="string"&&be.type.kind!=="string"&&ye.type.kind!=="value"&&be.type.kind!=="value")return ce.error("Cannot use collator to compare non-string types.");if(we=ce.parse(ue[3],3,Mr),!we)return null}return new mf(ye,be,we)}evaluate(ue){const ce=this.lhs.evaluate(ue),fe=this.rhs.evaluate(ue);if(X&&this.hasUntypedArgument){const ye=$r(ce),be=$r(fe);if(ye.kind!==be.kind||ye.kind!=="string"&&ye.kind!=="number")throw new Ti(`Expected arguments for "${H}" to be (string, string) or (number, number), but found (${ye.kind}, ${be.kind}) instead.`)}if(this.collator&&!X&&this.hasUntypedArgument){const ye=$r(ce),be=$r(fe);if(ye.kind!=="string"||be.kind!=="string")return h(ue,ce,fe)}return this.collator?W(ue,ce,fe,this.collator.evaluate(ue)):h(ue,ce,fe)}eachChild(ue){ue(this.lhs),ue(this.rhs),this.collator&&ue(this.collator)}outputDefined(){return!0}}}const eu=ja("==",function(H,h,W){return h===W},go),mc=ja("!=",function(H,h,W){return h!==W},function(H,h,W,X){return!go(0,h,W,X)}),yc=ja("<",function(H,h,W){return h<W},function(H,h,W,X){return X.compare(h,W)<0}),gc=ja(">",function(H,h,W){return h>W},function(H,h,W,X){return X.compare(h,W)>0}),vc=ja("<=",function(H,h,W){return h<=W},function(H,h,W,X){return X.compare(h,W)<=0}),ts=ja(">=",function(H,h,W){return h>=W},function(H,h,W,X){return X.compare(h,W)>=0});class rs{constructor(h,W,X){this.type=Mr,this.locale=X,this.caseSensitive=h,this.diacriticSensitive=W}static parse(h,W){if(h.length!==2)return W.error("Expected one argument.");const X=h[1];if(typeof X!="object"||Array.isArray(X))return W.error("Collator options argument must be an object.");const ie=W.parse(X["case-sensitive"]!==void 0&&X["case-sensitive"],1,Yt);if(!ie)return null;const ue=W.parse(X["diacritic-sensitive"]!==void 0&&X["diacritic-sensitive"],1,Yt);if(!ue)return null;let ce=null;return X.locale&&(ce=W.parse(X.locale,1,Lt),!ce)?null:new rs(ie,ue,ce)}evaluate(h){return new ho(this.caseSensitive.evaluate(h),this.diacriticSensitive.evaluate(h),this.locale?this.locale.evaluate(h):null)}eachChild(h){h(this.caseSensitive),h(this.diacriticSensitive),this.locale&&h(this.locale)}outputDefined(){return!1}}class is{constructor(h,W,X,ie,ue){this.type=Lt,this.number=h,this.locale=W,this.currency=X,this.minFractionDigits=ie,this.maxFractionDigits=ue}static parse(h,W){if(h.length!==3)return W.error("Expected two arguments.");const X=W.parse(h[1],1,pr);if(!X)return null;const ie=h[2];if(typeof ie!="object"||Array.isArray(ie))return W.error("NumberFormat options argument must be an object.");let ue=null;if(ie.locale&&(ue=W.parse(ie.locale,1,Lt),!ue))return null;let ce=null;if(ie.currency&&(ce=W.parse(ie.currency,1,Lt),!ce))return null;let fe=null;if(ie["min-fraction-digits"]&&(fe=W.parse(ie["min-fraction-digits"],1,pr),!fe))return null;let ye=null;return ie["max-fraction-digits"]&&(ye=W.parse(ie["max-fraction-digits"],1,pr),!ye)?null:new is(X,ue,ce,fe,ye)}evaluate(h){return new Intl.NumberFormat(this.locale?this.locale.evaluate(h):[],{style:this.currency?"currency":"decimal",currency:this.currency?this.currency.evaluate(h):void 0,minimumFractionDigits:this.minFractionDigits?this.minFractionDigits.evaluate(h):void 0,maximumFractionDigits:this.maxFractionDigits?this.maxFractionDigits.evaluate(h):void 0}).format(this.number.evaluate(h))}eachChild(h){h(this.number),this.locale&&h(this.locale),this.currency&&h(this.currency),this.minFractionDigits&&h(this.minFractionDigits),this.maxFractionDigits&&h(this.maxFractionDigits)}outputDefined(){return!1}}class vo{constructor(h){this.type=pi,this.sections=h}static parse(h,W){if(h.length<2)return W.error("Expected at least one argument.");const X=h[1];if(!Array.isArray(X)&&typeof X=="object")return W.error("First argument must be an image or text section.");const ie=[];let ue=!1;for(let ce=1;ce<=h.length-1;++ce){const fe=h[ce];if(ue&&typeof fe=="object"&&!Array.isArray(fe)){ue=!1;let ye=null;if(fe["font-scale"]&&(ye=W.parse(fe["font-scale"],1,pr),!ye))return null;let be=null;if(fe["text-font"]&&(be=W.parse(fe["text-font"],1,Ci(Lt)),!be))return null;let we=null;if(fe["text-color"]&&(we=W.parse(fe["text-color"],1,Ht),!we))return null;let Ie=null;if(fe["vertical-align"]){if(typeof fe["vertical-align"]=="string"&&!Qo.includes(fe["vertical-align"]))return W.error(`'vertical-align' must be one of: 'bottom', 'center', 'top' but found '${fe["vertical-align"]}' instead.`);if(Ie=W.parse(fe["vertical-align"],1,Lt),!Ie)return null}const Be=ie[ie.length-1];Be.scale=ye,Be.font=be,Be.textColor=we,Be.verticalAlign=Ie}else{const ye=W.parse(h[ce],1,gr);if(!ye)return null;const be=ye.type.kind;if(be!=="string"&&be!=="value"&&be!=="null"&&be!=="resolvedImage")return W.error("Formatted text type must be 'string', 'value', 'image' or 'null'.");ue=!0,ie.push({content:ye,scale:null,font:null,textColor:null,verticalAlign:null})}}return new vo(ie)}evaluate(h){return new sn(this.sections.map(W=>{const X=W.content.evaluate(h);return $r(X)===hr?new Ys("",X,null,null,null,W.verticalAlign?W.verticalAlign.evaluate(h):null):new Ys(ba(X),null,W.scale?W.scale.evaluate(h):null,W.font?W.font.evaluate(h).join(","):null,W.textColor?W.textColor.evaluate(h):null,W.verticalAlign?W.verticalAlign.evaluate(h):null)}))}eachChild(h){for(const W of this.sections)h(W.content),W.scale&&h(W.scale),W.font&&h(W.font),W.textColor&&h(W.textColor),W.verticalAlign&&h(W.verticalAlign)}outputDefined(){return!1}}class tu{constructor(h){this.type=hr,this.input=h}static parse(h,W){if(h.length!==2)return W.error("Expected two arguments.");const X=W.parse(h[1],1,Lt);return X?new tu(X):W.error("No image name provided.")}evaluate(h){const W=this.input.evaluate(h),X=gn.fromString(W);return X&&h.availableImages&&(X.available=h.availableImages.indexOf(W)>-1),X}eachChild(h){h(this.input)}outputDefined(){return!1}}class ns{constructor(h){this.type=pr,this.input=h}static parse(h,W){if(h.length!==2)return W.error(`Expected 1 argument, but found ${h.length-1} instead.`);const X=W.parse(h[1],1);return X?X.type.kind!=="array"&&X.type.kind!=="string"&&X.type.kind!=="value"?W.error(`Expected argument of type string or array, but found ${yi(X.type)} instead.`):new ns(X):null}evaluate(h){const W=this.input.evaluate(h);if(typeof W=="string")return[...W].length;if(Array.isArray(W))return W.length;throw new Ti(`Expected value to be of type string or array, but found ${yi($r(W))} instead.`)}eachChild(h){h(this.input)}outputDefined(){return!1}}const Un=8192;function bc(H,h){const W=(180+H[0])/360,X=(180-180/Math.PI*Math.log(Math.tan(Math.PI/4+H[1]*Math.PI/360)))/360,ie=Math.pow(2,h.z);return[Math.round(W*ie*Un),Math.round(X*ie*Un)]}function ru(H,h){const W=Math.pow(2,h.z);return[(ie=(H[0]/Un+h.x)/W,360*ie-180),(X=(H[1]/Un+h.y)/W,360/Math.PI*Math.atan(Math.exp((180-360*X)*Math.PI/180))-90)];var X,ie}function bo(H,h){H[0]=Math.min(H[0],h[0]),H[1]=Math.min(H[1],h[1]),H[2]=Math.max(H[2],h[0]),H[3]=Math.max(H[3],h[1])}function xo(H,h){return!(H[0]<=h[0]||H[2]>=h[2]||H[1]<=h[1]||H[3]>=h[3])}function dl(H,h,W){const X=H[0]-h[0],ie=H[1]-h[1],ue=H[0]-W[0],ce=H[1]-W[1];return X*ce-ue*ie==0&&X*ue<=0&&ie*ce<=0}function wo(H,h,W,X){return(ie=[X[0]-W[0],X[1]-W[1]])[0]*(ue=[h[0]-H[0],h[1]-H[1]])[1]-ie[1]*ue[0]!=0&&!(!as(H,h,W,X)||!as(W,X,H,h));var ie,ue}function fl(H,h,W){for(const X of W)for(let ie=0;ie<X.length-1;++ie)if(wo(H,h,X[ie],X[ie+1]))return!0;return!1}function Na(H,h,W=!1){let X=!1;for(const fe of h)for(let ye=0;ye<fe.length-1;ye++){if(dl(H,fe[ye],fe[ye+1]))return W;(ue=fe[ye])[1]>(ie=H)[1]!=(ce=fe[ye+1])[1]>ie[1]&&ie[0]<(ce[0]-ue[0])*(ie[1]-ue[1])/(ce[1]-ue[1])+ue[0]&&(X=!X)}var ie,ue,ce;return X}function xc(H,h){for(const W of h)if(Na(H,W))return!0;return!1}function pl(H,h){for(const W of H)if(!Na(W,h))return!1;for(let W=0;W<H.length-1;++W)if(fl(H[W],H[W+1],h))return!1;return!0}function wc(H,h){for(const W of h)if(pl(H,W))return!0;return!1}function as(H,h,W,X){const ie=X[0]-W[0],ue=X[1]-W[1],ce=(H[0]-W[0])*ue-ie*(H[1]-W[1]),fe=(h[0]-W[0])*ue-ie*(h[1]-W[1]);return ce>0&&fe<0||ce<0&&fe>0}function iu(H,h,W){const X=[];for(let ie=0;ie<H.length;ie++){const ue=[];for(let ce=0;ce<H[ie].length;ce++){const fe=bc(H[ie][ce],W);bo(h,fe),ue.push(fe)}X.push(ue)}return X}function _l(H,h,W){const X=[];for(let ie=0;ie<H.length;ie++){const ue=iu(H[ie],h,W);X.push(ue)}return X}function ml(H,h,W,X){if(H[0]<W[0]||H[0]>W[2]){const ie=.5*X;let ue=H[0]-W[0]>ie?-X:W[0]-H[0]>ie?X:0;ue===0&&(ue=H[0]-W[2]>ie?-X:W[2]-H[0]>ie?X:0),H[0]+=ue}bo(h,H)}function nu(H,h,W,X){const ie=Math.pow(2,X.z)*Un,ue=[X.x*Un,X.y*Un],ce=[];for(const fe of H)for(const ye of fe){const be=[ye.x+ue[0],ye.y+ue[1]];ml(be,h,W,ie),ce.push(be)}return ce}function au(H,h,W,X){const ie=Math.pow(2,X.z)*Un,ue=[X.x*Un,X.y*Un],ce=[];for(const ye of H){const be=[];for(const we of ye){const Ie=[we.x+ue[0],we.y+ue[1]];bo(h,Ie),be.push(Ie)}ce.push(be)}if(h[2]-h[0]<=ie/2){(fe=h)[0]=fe[1]=1/0,fe[2]=fe[3]=-1/0;for(const ye of ce)for(const be of ye)ml(be,h,W,ie)}var fe;return ce}class xa{constructor(h,W){this.type=Yt,this.geojson=h,this.geometries=W}static parse(h,W){if(h.length!==2)return W.error(`'within' expression requires exactly one argument, but found ${h.length-1} instead.`);if(va(h[1])){const X=h[1];if(X.type==="FeatureCollection"){const ie=[];for(const ue of X.features){const{type:ce,coordinates:fe}=ue.geometry;ce==="Polygon"&&ie.push(fe),ce==="MultiPolygon"&&ie.push(...fe)}if(ie.length)return new xa(X,{type:"MultiPolygon",coordinates:ie})}else if(X.type==="Feature"){const ie=X.geometry.type;if(ie==="Polygon"||ie==="MultiPolygon")return new xa(X,X.geometry)}else if(X.type==="Polygon"||X.type==="MultiPolygon")return new xa(X,X)}return W.error("'within' expression requires valid geojson object that contains polygon geometry type.")}evaluate(h){if(h.geometry()!=null&&h.canonicalID()!=null){if(h.geometryType()==="Point")return function(W,X){const ie=[1/0,1/0,-1/0,-1/0],ue=[1/0,1/0,-1/0,-1/0],ce=W.canonicalID();if(X.type==="Polygon"){const fe=iu(X.coordinates,ue,ce),ye=nu(W.geometry(),ie,ue,ce);if(!xo(ie,ue))return!1;for(const be of ye)if(!Na(be,fe))return!1}if(X.type==="MultiPolygon"){const fe=_l(X.coordinates,ue,ce),ye=nu(W.geometry(),ie,ue,ce);if(!xo(ie,ue))return!1;for(const be of ye)if(!xc(be,fe))return!1}return!0}(h,this.geometries);if(h.geometryType()==="LineString")return function(W,X){const ie=[1/0,1/0,-1/0,-1/0],ue=[1/0,1/0,-1/0,-1/0],ce=W.canonicalID();if(X.type==="Polygon"){const fe=iu(X.coordinates,ue,ce),ye=au(W.geometry(),ie,ue,ce);if(!xo(ie,ue))return!1;for(const be of ye)if(!pl(be,fe))return!1}if(X.type==="MultiPolygon"){const fe=_l(X.coordinates,ue,ce),ye=au(W.geometry(),ie,ue,ce);if(!xo(ie,ue))return!1;for(const be of ye)if(!wc(be,fe))return!1}return!0}(h,this.geometries)}return!1}eachChild(){}outputDefined(){return!0}}let yl=class{constructor(H=[],h=(W,X)=>W<X?-1:W>X?1:0){if(this.data=H,this.length=this.data.length,this.compare=h,this.length>0)for(let W=(this.length>>1)-1;W>=0;W--)this._down(W)}push(H){this.data.push(H),this._up(this.length++)}pop(){if(this.length===0)return;const H=this.data[0],h=this.data.pop();return--this.length>0&&(this.data[0]=h,this._down(0)),H}peek(){return this.data[0]}_up(H){const{data:h,compare:W}=this,X=h[H];for(;H>0;){const ie=H-1>>1,ue=h[ie];if(W(X,ue)>=0)break;h[H]=ue,H=ie}h[H]=X}_down(H){const{data:h,compare:W}=this,X=this.length>>1,ie=h[H];for(;H<X;){let ue=1+(H<<1);const ce=ue+1;if(ce<this.length&&W(h[ce],h[ue])<0&&(ue=ce),W(h[ue],ie)>=0)break;h[H]=h[ue],H=ue}h[H]=ie}};function ou(H,h,W=0,X=H.length-1,ie=Sc){for(;X>W;){if(X-W>600){const ye=X-W+1,be=h-W+1,we=Math.log(ye),Ie=.5*Math.exp(2*we/3),Be=.5*Math.sqrt(we*Ie*(ye-Ie)/ye)*(be-ye/2<0?-1:1);ou(H,h,Math.max(W,Math.floor(h-be*Ie/ye+Be)),Math.min(X,Math.floor(h+(ye-be)*Ie/ye+Be)),ie)}const ue=H[h];let ce=W,fe=X;for(za(H,W,h),ie(H[X],ue)>0&&za(H,W,X);ce<fe;){for(za(H,ce,fe),ce++,fe--;ie(H[ce],ue)<0;)ce++;for(;ie(H[fe],ue)>0;)fe--}ie(H[W],ue)===0?za(H,W,fe):(fe++,za(H,fe,X)),fe<=h&&(W=fe+1),h<=fe&&(X=fe-1)}}function za(H,h,W){const X=H[h];H[h]=H[W],H[W]=X}function Sc(H,h){return H<h?-1:H>h?1:0}function os(H,h){if(H.length<=1)return[H];const W=[];let X,ie;for(const ue of H){const ce=gl(ue);ce!==0&&(ue.area=Math.abs(ce),ie===void 0&&(ie=ce<0),ie===ce<0?(X&&W.push(X),X=[ue]):X.push(ue))}if(X&&W.push(X),h>1)for(let ue=0;ue<W.length;ue++)W[ue].length<=h||(ou(W[ue],h,1,W[ue].length-1,Ec),W[ue]=W[ue].slice(0,h));return W}function Ec(H,h){return h.area-H.area}function gl(H){let h=0;for(let W,X,ie=0,ue=H.length,ce=ue-1;ie<ue;ce=ie++)W=H[ie],X=H[ce],h+=(X.x-W.x)*(W.y+X.y);return h}const vl=1/298.257223563,bl=vl*(2-vl),xl=Math.PI/180;class su{constructor(h){const W=6378.137*xl*1e3,X=Math.cos(h*xl),ie=1/(1-bl*(1-X*X)),ue=Math.sqrt(ie);this.kx=W*ue*X,this.ky=W*ue*ie*(1-bl)}distance(h,W){const X=this.wrap(h[0]-W[0])*this.kx,ie=(h[1]-W[1])*this.ky;return Math.sqrt(X*X+ie*ie)}pointOnLine(h,W){let X,ie,ue,ce,fe=1/0;for(let ye=0;ye<h.length-1;ye++){let be=h[ye][0],we=h[ye][1],Ie=this.wrap(h[ye+1][0]-be)*this.kx,Be=(h[ye+1][1]-we)*this.ky,Ue=0;Ie===0&&Be===0||(Ue=(this.wrap(W[0]-be)*this.kx*Ie+(W[1]-we)*this.ky*Be)/(Ie*Ie+Be*Be),Ue>1?(be=h[ye+1][0],we=h[ye+1][1]):Ue>0&&(be+=Ie/this.kx*Ue,we+=Be/this.ky*Ue)),Ie=this.wrap(W[0]-be)*this.kx,Be=(W[1]-we)*this.ky;const $e=Ie*Ie+Be*Be;$e<fe&&(fe=$e,X=be,ie=we,ue=ye,ce=Ue)}return{point:[X,ie],index:ue,t:Math.max(0,Math.min(1,ce))}}wrap(h){for(;h<-180;)h+=360;for(;h>180;)h-=360;return h}}function hi(H,h){return h[0]-H[0]}function ss(H){return H[1]-H[0]+1}function Kn(H,h){return H[1]>=H[0]&&H[1]<h}function uu(H,h){if(H[0]>H[1])return[null,null];const W=ss(H);if(h){if(W===2)return[H,null];const ie=Math.floor(W/2);return[[H[0],H[0]+ie],[H[0]+ie,H[1]]]}if(W===1)return[H,null];const X=Math.floor(W/2)-1;return[[H[0],H[0]+X],[H[0]+X+1,H[1]]]}function lu(H,h){if(!Kn(h,H.length))return[1/0,1/0,-1/0,-1/0];const W=[1/0,1/0,-1/0,-1/0];for(let X=h[0];X<=h[1];++X)bo(W,H[X]);return W}function cu(H){const h=[1/0,1/0,-1/0,-1/0];for(const W of H)for(const X of W)bo(h,X);return h}function wl(H){return H[0]!==-1/0&&H[1]!==-1/0&&H[2]!==1/0&&H[3]!==1/0}function hu(H,h,W){if(!wl(H)||!wl(h))return NaN;let X=0,ie=0;return H[2]<h[0]&&(X=h[0]-H[2]),H[0]>h[2]&&(X=H[0]-h[2]),H[1]>h[3]&&(ie=H[1]-h[3]),H[3]<h[1]&&(ie=h[1]-H[3]),W.distance([0,0],[X,ie])}function wa(H,h,W){const X=W.pointOnLine(h,H);return W.distance(H,X.point)}function du(H,h,W,X,ie){const ue=Math.min(wa(H,[W,X],ie),wa(h,[W,X],ie)),ce=Math.min(wa(W,[H,h],ie),wa(X,[H,h],ie));return Math.min(ue,ce)}function qc(H,h,W,X,ie){if(!Kn(h,H.length)||!Kn(X,W.length))return 1/0;let ue=1/0;for(let ce=h[0];ce<h[1];++ce){const fe=H[ce],ye=H[ce+1];for(let be=X[0];be<X[1];++be){const we=W[be],Ie=W[be+1];if(wo(fe,ye,we,Ie))return 0;ue=Math.min(ue,du(fe,ye,we,Ie,ie))}}return ue}function Tc(H,h,W,X,ie){if(!Kn(h,H.length)||!Kn(X,W.length))return NaN;let ue=1/0;for(let ce=h[0];ce<=h[1];++ce)for(let fe=X[0];fe<=X[1];++fe)if(ue=Math.min(ue,ie.distance(H[ce],W[fe])),ue===0)return ue;return ue}function Ic(H,h,W){if(Na(H,h,!0))return 0;let X=1/0;for(const ie of h){const ue=ie[0],ce=ie[ie.length-1];if(ue!==ce&&(X=Math.min(X,wa(H,[ce,ue],W)),X===0))return X;const fe=W.pointOnLine(ie,H);if(X=Math.min(X,W.distance(H,fe.point)),X===0)return X}return X}function Rc(H,h,W,X){if(!Kn(h,H.length))return NaN;for(let ue=h[0];ue<=h[1];++ue)if(Na(H[ue],W,!0))return 0;let ie=1/0;for(let ue=h[0];ue<h[1];++ue){const ce=H[ue],fe=H[ue+1];for(const ye of W)for(let be=0,we=ye.length,Ie=we-1;be<we;Ie=be++){const Be=ye[Ie],Ue=ye[be];if(wo(ce,fe,Be,Ue))return 0;ie=Math.min(ie,du(ce,fe,Be,Ue,X))}}return ie}function Sl(H,h){for(const W of H)for(const X of W)if(Na(X,h,!0))return!0;return!1}function Ac(H,h,W,X=1/0){const ie=cu(H),ue=cu(h);if(X!==1/0&&hu(ie,ue,W)>=X)return X;if(xo(ie,ue)){if(Sl(H,h))return 0}else if(Sl(h,H))return 0;let ce=1/0;for(const fe of H)for(let ye=0,be=fe.length,we=be-1;ye<be;we=ye++){const Ie=fe[we],Be=fe[ye];for(const Ue of h)for(let $e=0,Xe=Ue.length,rt=Xe-1;$e<Xe;rt=$e++){const ct=Ue[rt],Ct=Ue[$e];if(wo(Ie,Be,ct,Ct))return 0;ce=Math.min(ce,du(Ie,Be,ct,Ct,W))}}return ce}function El(H,h,W,X,ie,ue){if(!ue)return;const ce=hu(lu(X,ue),ie,W);ce<h&&H.push([ce,ue,[0,0]])}function us(H,h,W,X,ie,ue,ce){if(!ue||!ce)return;const fe=hu(lu(X,ue),lu(ie,ce),W);fe<h&&H.push([fe,ue,ce])}function ls(H,h,W,X,ie=1/0){let ue=Math.min(X.distance(H[0],W[0][0]),ie);if(ue===0)return ue;const ce=new yl([[0,[0,H.length-1],[0,0]]],hi),fe=cu(W);for(;ce.length>0;){const ye=ce.pop();if(ye[0]>=ue)continue;const be=ye[1],we=h?50:100;if(ss(be)<=we){if(!Kn(be,H.length))return NaN;if(h){const Ie=Rc(H,be,W,X);if(isNaN(Ie)||Ie===0)return Ie;ue=Math.min(ue,Ie)}else for(let Ie=be[0];Ie<=be[1];++Ie){const Be=Ic(H[Ie],W,X);if(ue=Math.min(ue,Be),ue===0)return 0}}else{const Ie=uu(be,h);El(ce,ue,X,H,fe,Ie[0]),El(ce,ue,X,H,fe,Ie[1])}}return ue}function cs(H,h,W,X,ie,ue=1/0){let ce=Math.min(ue,ie.distance(H[0],W[0]));if(ce===0)return ce;const fe=new yl([[0,[0,H.length-1],[0,W.length-1]]],hi);for(;fe.length>0;){const ye=fe.pop();if(ye[0]>=ce)continue;const be=ye[1],we=ye[2],Ie=h?50:100,Be=X?50:100;if(ss(be)<=Ie&&ss(we)<=Be){if(!Kn(be,H.length)&&Kn(we,W.length))return NaN;let Ue;if(h&&X)Ue=qc(H,be,W,we,ie),ce=Math.min(ce,Ue);else if(h&&!X){const $e=H.slice(be[0],be[1]+1);for(let Xe=we[0];Xe<=we[1];++Xe)if(Ue=wa(W[Xe],$e,ie),ce=Math.min(ce,Ue),ce===0)return ce}else if(!h&&X){const $e=W.slice(we[0],we[1]+1);for(let Xe=be[0];Xe<=be[1];++Xe)if(Ue=wa(H[Xe],$e,ie),ce=Math.min(ce,Ue),ce===0)return ce}else Ue=Tc(H,be,W,we,ie),ce=Math.min(ce,Ue)}else{const Ue=uu(be,h),$e=uu(we,X);us(fe,ce,ie,H,W,Ue[0],$e[0]),us(fe,ce,ie,H,W,Ue[0],$e[1]),us(fe,ce,ie,H,W,Ue[1],$e[0]),us(fe,ce,ie,H,W,Ue[1],$e[1])}}return ce}function fu(H){return H.type==="MultiPolygon"?H.coordinates.map(h=>({type:"Polygon",coordinates:h})):H.type==="MultiLineString"?H.coordinates.map(h=>({type:"LineString",coordinates:h})):H.type==="MultiPoint"?H.coordinates.map(h=>({type:"Point",coordinates:h})):[H]}class Sa{constructor(h,W){this.type=pr,this.geojson=h,this.geometries=W}static parse(h,W){if(h.length!==2)return W.error(`'distance' expression requires exactly one argument, but found ${h.length-1} instead.`);if(va(h[1])){const X=h[1];if(X.type==="FeatureCollection")return new Sa(X,X.features.map(ie=>fu(ie.geometry)).flat());if(X.type==="Feature")return new Sa(X,fu(X.geometry));if("type"in X&&"coordinates"in X)return new Sa(X,fu(X))}return W.error("'distance' expression requires valid geojson object that contains polygon geometry type.")}evaluate(h){if(h.geometry()!=null&&h.canonicalID()!=null){if(h.geometryType()==="Point")return function(W,X){const ie=W.geometry(),ue=ie.flat().map(ye=>ru([ye.x,ye.y],W.canonical));if(ie.length===0)return NaN;const ce=new su(ue[0][1]);let fe=1/0;for(const ye of X){switch(ye.type){case"Point":fe=Math.min(fe,cs(ue,!1,[ye.coordinates],!1,ce,fe));break;case"LineString":fe=Math.min(fe,cs(ue,!1,ye.coordinates,!0,ce,fe));break;case"Polygon":fe=Math.min(fe,ls(ue,!1,ye.coordinates,ce,fe))}if(fe===0)return fe}return fe}(h,this.geometries);if(h.geometryType()==="LineString")return function(W,X){const ie=W.geometry(),ue=ie.flat().map(ye=>ru([ye.x,ye.y],W.canonical));if(ie.length===0)return NaN;const ce=new su(ue[0][1]);let fe=1/0;for(const ye of X){switch(ye.type){case"Point":fe=Math.min(fe,cs(ue,!0,[ye.coordinates],!1,ce,fe));break;case"LineString":fe=Math.min(fe,cs(ue,!0,ye.coordinates,!0,ce,fe));break;case"Polygon":fe=Math.min(fe,ls(ue,!0,ye.coordinates,ce,fe))}if(fe===0)return fe}return fe}(h,this.geometries);if(h.geometryType()==="Polygon")return function(W,X){const ie=W.geometry();if(ie.length===0||ie[0].length===0)return NaN;const ue=os(ie,0).map(ye=>ye.map(be=>be.map(we=>ru([we.x,we.y],W.canonical)))),ce=new su(ue[0][0][0][1]);let fe=1/0;for(const ye of X)for(const be of ue){switch(ye.type){case"Point":fe=Math.min(fe,ls([ye.coordinates],!1,be,ce,fe));break;case"LineString":fe=Math.min(fe,ls(ye.coordinates,!0,be,ce,fe));break;case"Polygon":fe=Math.min(fe,Ac(be,ye.coordinates,ce,fe))}if(fe===0)return fe}return fe}(h,this.geometries)}return NaN}eachChild(){}outputDefined(){return!0}}class So{constructor(h){this.type=gr,this.key=h}static parse(h,W){if(h.length!==2)return W.error(`Expected 1 argument, but found ${h.length-1} instead.`);const X=h[1];return X==null?W.error("Global state property must be defined."):typeof X!="string"?W.error(`Global state property must be string, but found ${typeof h[1]} instead.`):new So(X)}evaluate(h){var W;const X=(W=h.globals)===null||W===void 0?void 0:W.globalState;return X&&Object.keys(X).length!==0?ii(X,this.key):null}eachChild(){}outputDefined(){return!1}}const Ua={"==":eu,"!=":mc,">":gc,"<":yc,">=":ts,"<=":vc,array:vn,at:Wi,boolean:vn,case:ji,coalesce:bn,collator:rs,format:vo,image:tu,in:Da,"index-of":_o,interpolate:dn,"interpolate-hcl":dn,"interpolate-lab":dn,length:ns,let:po,literal:hn,match:Fa,number:vn,"number-format":is,object:vn,slice:mo,step:La,string:vn,"to-boolean":zn,"to-color":zn,"to-number":zn,"to-string":zn,var:Cn,within:xa,distance:Sa,"global-state":So};class An{constructor(h,W,X,ie){this.name=h,this.type=W,this._evaluate=X,this.args=ie}evaluate(h){return this._evaluate(h,this.args)}eachChild(h){this.args.forEach(h)}outputDefined(){return!1}static parse(h,W){const X=h[0],ie=An.definitions[X];if(!ie)return W.error(`Unknown expression "${X}". If you wanted a literal array, use ["literal", [...]].`,0);const ue=Array.isArray(ie)?ie[0]:ie.type,ce=Array.isArray(ie)?[[ie[1],ie[2]]]:ie.overloads,fe=ce.filter(([be])=>!Array.isArray(be)||be.length===h.length-1);let ye=null;for(const[be,we]of fe){ye=new fo(W.registry,hs,W.path,null,W.scope);const Ie=[];let Be=!1;for(let Ue=1;Ue<h.length;Ue++){const $e=h[Ue],Xe=Array.isArray(be)?be[Ue-1]:be.type,rt=ye.parse($e,1+Ie.length,Xe);if(!rt){Be=!0;break}Ie.push(rt)}if(!Be)if(Array.isArray(be)&&be.length!==Ie.length)ye.error(`Expected ${be.length} arguments, but found ${Ie.length} instead.`);else{for(let Ue=0;Ue<Ie.length;Ue++){const $e=Array.isArray(be)?be[Ue]:be.type,Xe=Ie[Ue];ye.concat(Ue+1).checkSubtype($e,Xe.type)}if(ye.errors.length===0)return new An(X,ue,we,Ie)}}if(fe.length===1)W.errors.push(...ye.errors);else{const be=(fe.length?fe:ce).map(([Ie])=>{return Be=Ie,Array.isArray(Be)?`(${Be.map(yi).join(", ")})`:`(${yi(Be.type)}...)`;var Be}).join(" | "),we=[];for(let Ie=1;Ie<h.length;Ie++){const Be=W.parse(h[Ie],1+we.length);if(!Be)return null;we.push(yi(Be.type))}W.error(`Expected arguments of type ${be}, but found (${we.join(", ")}) instead.`)}return null}static register(h,W){An.definitions=W;for(const X in W)h[X]=An}}function ql(H,[h,W,X,ie]){h=h.evaluate(H),W=W.evaluate(H),X=X.evaluate(H);const ue=ie?ie.evaluate(H):1,ce=ei(h,W,X,ue);if(ce)throw new Ti(ce);return new ni(h/255,W/255,X/255,ue,!1)}function Tl(H,h){return H in h}function pu(H,h){const W=h[H];return W===void 0?null:W}function Ea(H){return{type:H}}function hs(H){if(H instanceof Cn)return hs(H.boundExpression);if(H instanceof An&&H.name==="error"||H instanceof rs||H instanceof xa||H instanceof Sa||H instanceof So)return!1;const h=H instanceof zn||H instanceof vn;let W=!0;return H.eachChild(X=>{W=h?W&&hs(X):W&&X instanceof hn}),!!W&&ds(H)&&Ga(H,["zoom","heatmap-density","elevation","line-progress","accumulated","is-supported-script"])}function ds(H){if(H instanceof An&&(H.name==="get"&&H.args.length===1||H.name==="feature-state"||H.name==="has"&&H.args.length===1||H.name==="properties"||H.name==="geometry-type"||H.name==="id"||/^filter-/.test(H.name))||H instanceof xa||H instanceof Sa)return!1;let h=!0;return H.eachChild(W=>{h&&!ds(W)&&(h=!1)}),h}function Eo(H){if(H instanceof An&&H.name==="feature-state")return!1;let h=!0;return H.eachChild(W=>{h&&!Eo(W)&&(h=!1)}),h}function Ga(H,h){if(H instanceof An&&h.indexOf(H.name)>=0)return!1;let W=!0;return H.eachChild(X=>{W&&!Ga(X,h)&&(W=!1)}),W}function Il(H){return{result:"success",value:H}}function Va(H){return{result:"error",value:H}}function $a(H){return H["property-type"]==="data-driven"||H["property-type"]==="cross-faded-data-driven"}function _u(H){return!!H.expression&&H.expression.parameters.indexOf("zoom")>-1}function mu(H){return!!H.expression&&H.expression.interpolated}function ai(H){return H instanceof Number?"number":H instanceof String?"string":H instanceof Boolean?"boolean":Array.isArray(H)?"array":H===null?"null":typeof H}function qa(H){return typeof H=="object"&&H!==null&&!Array.isArray(H)&&$r(H)===ir}function Rl(H){return H}function Al(H,h){const W=H.stops&&typeof H.stops[0][0]=="object",X=W||!(W||H.property!==void 0),ie=H.type||(mu(h)?"exponential":"interval"),ue=function(we){switch(we.type){case"color":return ni.parse;case"padding":return Bi.parse;case"numberArray":return un.parse;case"colorArray":return $i.parse;default:return null}}(h);if(ue&&((H=bi({},H)).stops&&(H.stops=H.stops.map(we=>[we[0],ue(we[1])])),H.default=ue(H.default?H.default:h.default)),H.colorSpace&&(ce=H.colorSpace)!=="rgb"&&ce!=="hcl"&&ce!=="lab")throw new Error(`Unknown color space: "${H.colorSpace}"`);var ce;const fe=function(we){switch(we){case"exponential":return Pl;case"interval":return Oc;case"categorical":return Pc;case"identity":return Ol;default:throw new Error(`Unknown function type "${we}"`)}}(ie);let ye,be;if(ie==="categorical"){ye=Object.create(null);for(const we of H.stops)ye[we[0]]=we[1];be=typeof H.stops[0][0]}if(W){const we={},Ie=[];for(let $e=0;$e<H.stops.length;$e++){const Xe=H.stops[$e],rt=Xe[0].zoom;we[rt]===void 0&&(we[rt]={zoom:rt,type:H.type,property:H.property,default:H.default,stops:[]},Ie.push(rt)),we[rt].stops.push([Xe[0].value,Xe[1]])}const Be=[];for(const $e of Ie)Be.push([we[$e].zoom,Al(we[$e],h)]);const Ue={name:"linear"};return{kind:"composite",interpolationType:Ue,interpolationFactor:dn.interpolationFactor.bind(void 0,Ue),zoomStops:Be.map($e=>$e[0]),evaluate:({zoom:$e},Xe)=>Pl({stops:Be,base:H.base},h,$e).evaluate($e,Xe)}}if(X){const we=ie==="exponential"?{name:"exponential",base:H.base!==void 0?H.base:1}:null;return{kind:"camera",interpolationType:we,interpolationFactor:dn.interpolationFactor.bind(void 0,we),zoomStops:H.stops.map(Ie=>Ie[0]),evaluate:({zoom:Ie})=>fe(H,h,Ie,ye,be)}}return{kind:"source",evaluate(we,Ie){const Be=Ie&&Ie.properties?Ie.properties[H.property]:void 0;return Be===void 0?qo(H.default,h.default):fe(H,h,Be,ye,be)}}}function qo(H,h,W){return H!==void 0?H:h!==void 0?h:W!==void 0?W:void 0}function Pc(H,h,W,X,ie){return qo(typeof W===ie?X[W]:void 0,H.default,h.default)}function Oc(H,h,W){if(ai(W)!=="number")return qo(H.default,h.default);const X=H.stops.length;if(X===1||W<=H.stops[0][0])return H.stops[0][1];if(W>=H.stops[X-1][0])return H.stops[X-1][1];const ie=ka(H.stops.map(ue=>ue[0]),W);return H.stops[ie][1]}function Pl(H,h,W){const X=H.base!==void 0?H.base:1;if(ai(W)!=="number")return qo(H.default,h.default);const ie=H.stops.length;if(ie===1||W<=H.stops[0][0])return H.stops[0][1];if(W>=H.stops[ie-1][0])return H.stops[ie-1][1];const ue=ka(H.stops.map(we=>we[0]),W),ce=function(we,Ie,Be,Ue){const $e=Ue-Be,Xe=we-Be;return $e===0?0:Ie===1?Xe/$e:(Math.pow(Ie,Xe)-1)/(Math.pow(Ie,$e)-1)}(W,X,H.stops[ue][0],H.stops[ue+1][0]),fe=H.stops[ue][1],ye=H.stops[ue+1][1],be=En[h.type]||Rl;return typeof fe.evaluate=="function"?{evaluate(...we){const Ie=fe.evaluate.apply(void 0,we),Be=ye.evaluate.apply(void 0,we);if(Ie!==void 0&&Be!==void 0)return be(Ie,Be,ce,H.colorSpace)}}:be(fe,ye,ce,H.colorSpace)}function Ol(H,h,W){switch(h.type){case"color":W=ni.parse(W);break;case"formatted":W=sn.fromString(W.toString());break;case"resolvedImage":W=gn.fromString(W.toString());break;case"padding":W=Bi.parse(W);break;case"colorArray":W=$i.parse(W);break;case"numberArray":W=un.parse(W);break;default:ai(W)===h.type||h.type==="enum"&&h.values[W]||(W=void 0)}return qo(W,H.default,h.default)}An.register(Ua,{error:[{kind:"error"},[Lt],(H,[h])=>{throw new Ti(h.evaluate(H))}],typeof:[Lt,[gr],(H,[h])=>yi($r(h.evaluate(H)))],"to-rgba":[Ci(pr,4),[Ht],(H,[h])=>{const[W,X,ie,ue]=h.evaluate(H).rgb;return[255*W,255*X,255*ie,ue]}],rgb:[Ht,[pr,pr,pr],ql],rgba:[Ht,[pr,pr,pr,pr],ql],has:{type:Yt,overloads:[[[Lt],(H,[h])=>Tl(h.evaluate(H),H.properties())],[[Lt,ir],(H,[h,W])=>Tl(h.evaluate(H),W.evaluate(H))]]},get:{type:gr,overloads:[[[Lt],(H,[h])=>pu(h.evaluate(H),H.properties())],[[Lt,ir],(H,[h,W])=>pu(h.evaluate(H),W.evaluate(H))]]},"feature-state":[gr,[Lt],(H,[h])=>pu(h.evaluate(H),H.featureState||{})],properties:[ir,[],H=>H.properties()],"geometry-type":[Lt,[],H=>H.geometryType()],id:[gr,[],H=>H.id()],zoom:[pr,[],H=>H.globals.zoom],"heatmap-density":[pr,[],H=>H.globals.heatmapDensity||0],elevation:[pr,[],H=>H.globals.elevation||0],"line-progress":[pr,[],H=>H.globals.lineProgress||0],accumulated:[gr,[],H=>H.globals.accumulated===void 0?null:H.globals.accumulated],"+":[pr,Ea(pr),(H,h)=>{let W=0;for(const X of h)W+=X.evaluate(H);return W}],"*":[pr,Ea(pr),(H,h)=>{let W=1;for(const X of h)W*=X.evaluate(H);return W}],"-":{type:pr,overloads:[[[pr,pr],(H,[h,W])=>h.evaluate(H)-W.evaluate(H)],[[pr],(H,[h])=>-h.evaluate(H)]]},"/":[pr,[pr,pr],(H,[h,W])=>h.evaluate(H)/W.evaluate(H)],"%":[pr,[pr,pr],(H,[h,W])=>h.evaluate(H)%W.evaluate(H)],ln2:[pr,[],()=>Math.LN2],pi:[pr,[],()=>Math.PI],e:[pr,[],()=>Math.E],"^":[pr,[pr,pr],(H,[h,W])=>Math.pow(h.evaluate(H),W.evaluate(H))],sqrt:[pr,[pr],(H,[h])=>Math.sqrt(h.evaluate(H))],log10:[pr,[pr],(H,[h])=>Math.log(h.evaluate(H))/Math.LN10],ln:[pr,[pr],(H,[h])=>Math.log(h.evaluate(H))],log2:[pr,[pr],(H,[h])=>Math.log(h.evaluate(H))/Math.LN2],sin:[pr,[pr],(H,[h])=>Math.sin(h.evaluate(H))],cos:[pr,[pr],(H,[h])=>Math.cos(h.evaluate(H))],tan:[pr,[pr],(H,[h])=>Math.tan(h.evaluate(H))],asin:[pr,[pr],(H,[h])=>Math.asin(h.evaluate(H))],acos:[pr,[pr],(H,[h])=>Math.acos(h.evaluate(H))],atan:[pr,[pr],(H,[h])=>Math.atan(h.evaluate(H))],min:[pr,Ea(pr),(H,h)=>Math.min(...h.map(W=>W.evaluate(H)))],max:[pr,Ea(pr),(H,h)=>Math.max(...h.map(W=>W.evaluate(H)))],abs:[pr,[pr],(H,[h])=>Math.abs(h.evaluate(H))],round:[pr,[pr],(H,[h])=>{const W=h.evaluate(H);return W<0?-Math.round(-W):Math.round(W)}],floor:[pr,[pr],(H,[h])=>Math.floor(h.evaluate(H))],ceil:[pr,[pr],(H,[h])=>Math.ceil(h.evaluate(H))],"filter-==":[Yt,[Lt,gr],(H,[h,W])=>H.properties()[h.value]===W.value],"filter-id-==":[Yt,[gr],(H,[h])=>H.id()===h.value],"filter-type-==":[Yt,[Lt],(H,[h])=>H.geometryType()===h.value],"filter-<":[Yt,[Lt,gr],(H,[h,W])=>{const X=H.properties()[h.value],ie=W.value;return typeof X==typeof ie&&X<ie}],"filter-id-<":[Yt,[gr],(H,[h])=>{const W=H.id(),X=h.value;return typeof W==typeof X&&W<X}],"filter->":[Yt,[Lt,gr],(H,[h,W])=>{const X=H.properties()[h.value],ie=W.value;return typeof X==typeof ie&&X>ie}],"filter-id->":[Yt,[gr],(H,[h])=>{const W=H.id(),X=h.value;return typeof W==typeof X&&W>X}],"filter-<=":[Yt,[Lt,gr],(H,[h,W])=>{const X=H.properties()[h.value],ie=W.value;return typeof X==typeof ie&&X<=ie}],"filter-id-<=":[Yt,[gr],(H,[h])=>{const W=H.id(),X=h.value;return typeof W==typeof X&&W<=X}],"filter->=":[Yt,[Lt,gr],(H,[h,W])=>{const X=H.properties()[h.value],ie=W.value;return typeof X==typeof ie&&X>=ie}],"filter-id->=":[Yt,[gr],(H,[h])=>{const W=H.id(),X=h.value;return typeof W==typeof X&&W>=X}],"filter-has":[Yt,[gr],(H,[h])=>h.value in H.properties()],"filter-has-id":[Yt,[],H=>H.id()!==null&&H.id()!==void 0],"filter-type-in":[Yt,[Ci(Lt)],(H,[h])=>h.value.indexOf(H.geometryType())>=0],"filter-id-in":[Yt,[Ci(gr)],(H,[h])=>h.value.indexOf(H.id())>=0],"filter-in-small":[Yt,[Lt,Ci(gr)],(H,[h,W])=>W.value.indexOf(H.properties()[h.value])>=0],"filter-in-large":[Yt,[Lt,Ci(gr)],(H,[h,W])=>function(X,ie,ue,ce){for(;ue<=ce;){const fe=ue+ce>>1;if(ie[fe]===X)return!0;ie[fe]>X?ce=fe-1:ue=fe+1}return!1}(H.properties()[h.value],W.value,0,W.value.length-1)],all:{type:Yt,overloads:[[[Yt,Yt],(H,[h,W])=>h.evaluate(H)&&W.evaluate(H)],[Ea(Yt),(H,h)=>{for(const W of h)if(!W.evaluate(H))return!1;return!0}]]},any:{type:Yt,overloads:[[[Yt,Yt],(H,[h,W])=>h.evaluate(H)||W.evaluate(H)],[Ea(Yt),(H,h)=>{for(const W of h)if(W.evaluate(H))return!0;return!1}]]},"!":[Yt,[Yt],(H,[h])=>!h.evaluate(H)],"is-supported-script":[Yt,[Lt],(H,[h])=>{const W=H.globals&&H.globals.isSupportedScript;return!W||W(h.evaluate(H))}],upcase:[Lt,[Lt],(H,[h])=>h.evaluate(H).toUpperCase()],downcase:[Lt,[Lt],(H,[h])=>h.evaluate(H).toLowerCase()],concat:[Lt,Ea(gr),(H,h)=>h.map(W=>ba(W.evaluate(H))).join("")],"resolved-locale":[Lt,[Mr],(H,[h])=>h.evaluate(H).resolvedLocale()]});class fs{constructor(h,W){this.expression=h,this._warningHistory={},this._evaluator=new hl,this._defaultValue=W?function(X){if(X.type==="color"&&qa(X.default))return new ni(0,0,0,0);switch(X.type){case"color":return ni.parse(X.default)||null;case"padding":return Bi.parse(X.default)||null;case"numberArray":return un.parse(X.default)||null;case"colorArray":return $i.parse(X.default)||null;case"variableAnchorOffsetCollection":return ui.parse(X.default)||null;case"projectionDefinition":return Xr.parse(X.default)||null;default:return X.default===void 0?null:X.default}}(W):null,this._enumValues=W&&W.type==="enum"?W.values:null}evaluateWithoutErrorHandling(h,W,X,ie,ue,ce){return this._evaluator.globals=h,this._evaluator.feature=W,this._evaluator.featureState=X,this._evaluator.canonical=ie,this._evaluator.availableImages=ue||null,this._evaluator.formattedSection=ce,this.expression.evaluate(this._evaluator)}evaluate(h,W,X,ie,ue,ce){this._evaluator.globals=h,this._evaluator.feature=W||null,this._evaluator.featureState=X||null,this._evaluator.canonical=ie,this._evaluator.availableImages=ue||null,this._evaluator.formattedSection=ce||null;try{const fe=this.expression.evaluate(this._evaluator);if(fe==null||typeof fe=="number"&&fe!=fe)return this._defaultValue;if(this._enumValues&&!(fe in this._enumValues))throw new Ti(`Expected value to be one of ${Object.keys(this._enumValues).map(ye=>JSON.stringify(ye)).join(", ")}, but found ${JSON.stringify(fe)} instead.`);return fe}catch(fe){return this._warningHistory[fe.message]||(this._warningHistory[fe.message]=!0,typeof console<"u"&&console.warn(fe.message)),this._defaultValue}}}function ps(H){return Array.isArray(H)&&H.length>0&&typeof H[0]=="string"&&H[0]in Ua}function _s(H,h){const W=new fo(Ua,hs,[],h?function(ie){const ue={color:Ht,string:Lt,number:pr,enum:Lt,boolean:Yt,formatted:pi,padding:ri,numberArray:Vi,colorArray:Oi,projectionDefinition:Bt,resolvedImage:hr,variableAnchorOffsetCollection:qi};return ie.type==="array"?Ci(ue[ie.value]||gr,ie.length):ue[ie.type]}(h):void 0),X=W.parse(H,void 0,void 0,void 0,h&&h.type==="string"?{typeAnnotation:"coerce"}:void 0);return X?Il(new fs(X,h)):Va(W.errors)}class To{constructor(h,W){this.kind=h,this._styleExpression=W,this.isStateDependent=h!=="constant"&&!Eo(W.expression),this.globalStateRefs=Ha(W.expression)}evaluateWithoutErrorHandling(h,W,X,ie,ue,ce){return this._styleExpression.evaluateWithoutErrorHandling(h,W,X,ie,ue,ce)}evaluate(h,W,X,ie,ue,ce){return this._styleExpression.evaluate(h,W,X,ie,ue,ce)}}class ys{constructor(h,W,X,ie){this.kind=h,this.zoomStops=X,this._styleExpression=W,this.isStateDependent=h!=="camera"&&!Eo(W.expression),this.globalStateRefs=Ha(W.expression),this.interpolationType=ie}evaluateWithoutErrorHandling(h,W,X,ie,ue,ce){return this._styleExpression.evaluateWithoutErrorHandling(h,W,X,ie,ue,ce)}evaluate(h,W,X,ie,ue,ce){return this._styleExpression.evaluate(h,W,X,ie,ue,ce)}interpolationFactor(h,W,X){return this.interpolationType?dn.interpolationFactor(this.interpolationType,h,W,X):0}}function yu(H,h){const W=_s(H,h);if(W.result==="error")return W;const X=W.value.expression,ie=ds(X);if(!ie&&!$a(h))return Va([new Qr("","data expressions not supported")]);const ue=Ga(X,["zoom"]);if(!ue&&!_u(h))return Va([new Qr("","zoom expressions not supported")]);const ce=Wa(X);return ce||ue?ce instanceof Qr?Va([ce]):ce instanceof dn&&!mu(h)?Va([new Qr("",'"interpolate" expressions cannot be used with this property')]):Il(ce?new ys(ie?"camera":"composite",W.value,ce.labels,ce instanceof dn?ce.interpolation:void 0):new To(ie?"constant":"source",W.value)):Va([new Qr("",'"zoom" expression may only be used as input to a top-level "step" or "interpolate" expression.')])}class Io{constructor(h,W){this._parameters=h,this._specification=W,bi(this,Al(this._parameters,this._specification))}static deserialize(h){return new Io(h._parameters,h._specification)}static serialize(h){return{_parameters:h._parameters,_specification:h._specification}}}function Wa(H){let h=null;if(H instanceof po)h=Wa(H.result);else if(H instanceof bn){for(const W of H.args)if(h=Wa(W),h)break}else(H instanceof La||H instanceof dn)&&H.input instanceof An&&H.input.name==="zoom"&&(h=H);return h instanceof Qr||H.eachChild(W=>{const X=Wa(W);X instanceof Qr?h=X:!h&&X?h=new Qr("",'"zoom" expression may only be used as input to a top-level "step" or "interpolate" expression.'):h&&X&&h!==X&&(h=new Qr("",'Only one zoom-based "step" or "interpolate" subexpression may be used in an expression.'))}),h}function Ha(H,h=new Set){return H instanceof So&&h.add(H.key),H.eachChild(W=>{Ha(W,h)}),h}function Ro(H){if(H===!0||H===!1)return!0;if(!Array.isArray(H)||H.length===0)return!1;switch(H[0]){case"has":return H.length>=2&&H[1]!=="$id"&&H[1]!=="$type";case"in":return H.length>=3&&(typeof H[1]!="string"||Array.isArray(H[2]));case"!in":case"!has":case"none":return!1;case"==":case"!=":case">":case">=":case"<":case"<=":return H.length!==3||Array.isArray(H[1])||Array.isArray(H[2]);case"any":case"all":for(const h of H.slice(1))if(!Ro(h)&&typeof h!="boolean")return!1;return!0;default:return!0}}const gu={type:"boolean",default:!1,transition:!1,"property-type":"data-driven",expression:{interpolated:!1,parameters:["zoom","feature"]}};function oa(H){if(H==null)return{filter:()=>!0,needGeometry:!1,getGlobalStateRefs:()=>new Set};Ro(H)||(H=gs(H));const h=_s(H,gu);if(h.result==="error")throw new Error(h.value.map(W=>`${W.key}: ${W.message}`).join(", "));return{filter:(W,X,ie)=>h.value.evaluate(W,X,{},ie),needGeometry:Cl(H),getGlobalStateRefs:()=>Ha(h.value.expression)}}function Cc(H,h){return H<h?-1:H>h?1:0}function Cl(H){if(!Array.isArray(H))return!1;if(H[0]==="within"||H[0]==="distance")return!0;for(let h=1;h<H.length;h++)if(Cl(H[h]))return!0;return!1}function gs(H){if(!H)return!0;const h=H[0];return H.length<=1?h!=="any":h==="=="?vu(H[1],H[2],"=="):h==="!="?Ao(vu(H[1],H[2],"==")):h==="<"||h===">"||h==="<="||h===">="?vu(H[1],H[2],h):h==="any"?(W=H.slice(1),["any"].concat(W.map(gs))):h==="all"?["all"].concat(H.slice(1).map(gs)):h==="none"?["all"].concat(H.slice(1).map(gs).map(Ao)):h==="in"?Ml(H[1],H.slice(2)):h==="!in"?Ao(Ml(H[1],H.slice(2))):h==="has"?Dl(H[1]):h!=="!has"||Ao(Dl(H[1]));var W}function vu(H,h,W){switch(H){case"$type":return[`filter-type-${W}`,h];case"$id":return[`filter-id-${W}`,h];default:return[`filter-${W}`,H,h]}}function Ml(H,h){if(h.length===0)return!1;switch(H){case"$type":return["filter-type-in",["literal",h]];case"$id":return["filter-id-in",["literal",h]];default:return h.length>200&&!h.some(W=>typeof W!=typeof h[0])?["filter-in-large",H,["literal",h.sort(Cc)]]:["filter-in-small",H,["literal",h]]}}function Dl(H){switch(H){case"$type":return!0;case"$id":return["filter-has-id"];default:return["filter-has",H]}}function Ao(H){return["!",H]}function vs(H){const h=typeof H;if(h==="number"||h==="boolean"||h==="string"||H==null)return JSON.stringify(H);if(Array.isArray(H)){let ie="[";for(const ue of H)ie+=`${vs(ue)},`;return`${ie}]`}const W=Object.keys(H).sort();let X="{";for(let ie=0;ie<W.length;ie++)X+=`${JSON.stringify(W[ie])}:${vs(H[W[ie]])},`;return`${X}}`}function bs(H){let h="";for(const W of ar)h+=`/${vs(H[W])}`;return h}function Fl(H){const h=H.value;return h?[new cr(H.key,h,"constants have been deprecated as of v8")]:[]}function Mi(H){return H instanceof Number||H instanceof String||H instanceof Boolean?H.valueOf():H}function sa(H){if(Array.isArray(H))return H.map(sa);if(H instanceof Object&&!(H instanceof Number||H instanceof String||H instanceof Boolean)){const h={};for(const W in H)h[W]=sa(H[W]);return h}return Mi(H)}function Pn(H){const h=H.key,W=H.value,X=H.valueSpec||{},ie=H.objectElementValidators||{},ue=H.style,ce=H.styleSpec,fe=H.validateSpec;let ye=[];const be=ai(W);if(be!=="object")return[new cr(h,W,`object expected, ${be} found`)];for(const we in W){const Ie=we.split(".")[0],Be=ii(X,Ie)||X["*"];let Ue;if(ii(ie,Ie))Ue=ie[Ie];else if(ii(X,Ie))Ue=fe;else if(ie["*"])Ue=ie["*"];else{if(!X["*"]){ye.push(new cr(h,W[we],`unknown property "${we}"`));continue}Ue=fe}ye=ye.concat(Ue({key:(h&&`${h}.`)+we,value:W[we],valueSpec:Be,style:ue,styleSpec:ce,object:W,objectKey:we,validateSpec:fe},W))}for(const we in X)ie[we]||X[we].required&&X[we].default===void 0&&W[we]===void 0&&ye.push(new cr(h,W,`missing required property "${we}"`));return ye}function xs(H){const h=H.value,W=H.valueSpec,X=H.style,ie=H.styleSpec,ue=H.key,ce=H.arrayElementValidator||H.validateSpec;if(ai(h)!=="array")return[new cr(ue,h,`array expected, ${ai(h)} found`)];if(W.length&&h.length!==W.length)return[new cr(ue,h,`array length ${W.length} expected, length ${h.length} found`)];if(W["min-length"]&&h.length<W["min-length"])return[new cr(ue,h,`array length at least ${W["min-length"]} expected, length ${h.length} found`)];let fe={type:W.value,values:W.values};ie.$version<7&&(fe.function=W.function),ai(W.value)==="object"&&(fe=W.value);let ye=[];for(let be=0;be<h.length;be++)ye=ye.concat(ce({array:h,arrayIndex:be,value:h[be],valueSpec:fe,validateSpec:H.validateSpec,style:X,styleSpec:ie,key:`${ue}[${be}]`}));return ye}function Po(H){const h=H.key,W=H.value,X=H.valueSpec;let ie=ai(W);return ie==="number"&&W!=W&&(ie="NaN"),ie!=="number"?[new cr(h,W,`number expected, ${ie} found`)]:"minimum"in X&&W<X.minimum?[new cr(h,W,`${W} is less than the minimum value ${X.minimum}`)]:"maximum"in X&&W>X.maximum?[new cr(h,W,`${W} is greater than the maximum value ${X.maximum}`)]:[]}function Za(H){const h=H.valueSpec,W=Mi(H.value.type);let X,ie,ue,ce={};const fe=W!=="categorical"&&H.value.property===void 0,ye=!fe,be=ai(H.value.stops)==="array"&&ai(H.value.stops[0])==="array"&&ai(H.value.stops[0][0])==="object",we=Pn({key:H.key,value:H.value,valueSpec:H.styleSpec.function,validateSpec:H.validateSpec,style:H.style,styleSpec:H.styleSpec,objectElementValidators:{stops:function(Ue){if(W==="identity")return[new cr(Ue.key,Ue.value,'identity function may not have a "stops" property')];let $e=[];const Xe=Ue.value;return $e=$e.concat(xs({key:Ue.key,value:Xe,valueSpec:Ue.valueSpec,validateSpec:Ue.validateSpec,style:Ue.style,styleSpec:Ue.styleSpec,arrayElementValidator:Ie})),ai(Xe)==="array"&&Xe.length===0&&$e.push(new cr(Ue.key,Xe,"array must have at least one stop")),$e},default:function(Ue){return Ue.validateSpec({key:Ue.key,value:Ue.value,valueSpec:h,validateSpec:Ue.validateSpec,style:Ue.style,styleSpec:Ue.styleSpec})}}});return W==="identity"&&fe&&we.push(new cr(H.key,H.value,'missing required property "property"')),W==="identity"||H.value.stops||we.push(new cr(H.key,H.value,'missing required property "stops"')),W==="exponential"&&H.valueSpec.expression&&!mu(H.valueSpec)&&we.push(new cr(H.key,H.value,"exponential functions not supported")),H.styleSpec.$version>=8&&(ye&&!$a(H.valueSpec)?we.push(new cr(H.key,H.value,"property functions not supported")):fe&&!_u(H.valueSpec)&&we.push(new cr(H.key,H.value,"zoom functions not supported"))),W!=="categorical"&&!be||H.value.property!==void 0||we.push(new cr(H.key,H.value,'"property" property is required')),we;function Ie(Ue){let $e=[];const Xe=Ue.value,rt=Ue.key;if(ai(Xe)!=="array")return[new cr(rt,Xe,`array expected, ${ai(Xe)} found`)];if(Xe.length!==2)return[new cr(rt,Xe,`array length 2 expected, length ${Xe.length} found`)];if(be){if(ai(Xe[0])!=="object")return[new cr(rt,Xe,`object expected, ${ai(Xe[0])} found`)];if(Xe[0].zoom===void 0)return[new cr(rt,Xe,"object stop key must have zoom")];if(Xe[0].value===void 0)return[new cr(rt,Xe,"object stop key must have value")];if(ue&&ue>Mi(Xe[0].zoom))return[new cr(rt,Xe[0].zoom,"stop zoom values must appear in ascending order")];Mi(Xe[0].zoom)!==ue&&(ue=Mi(Xe[0].zoom),ie=void 0,ce={}),$e=$e.concat(Pn({key:`${rt}[0]`,value:Xe[0],valueSpec:{zoom:{}},validateSpec:Ue.validateSpec,style:Ue.style,styleSpec:Ue.styleSpec,objectElementValidators:{zoom:Po,value:Be}}))}else $e=$e.concat(Be({key:`${rt}[0]`,value:Xe[0],validateSpec:Ue.validateSpec,style:Ue.style,styleSpec:Ue.styleSpec},Xe));return ps(sa(Xe[1]))?$e.concat([new cr(`${rt}[1]`,Xe[1],"expressions are not allowed in function stops.")]):$e.concat(Ue.validateSpec({key:`${rt}[1]`,value:Xe[1],valueSpec:h,validateSpec:Ue.validateSpec,style:Ue.style,styleSpec:Ue.styleSpec}))}function Be(Ue,$e){const Xe=ai(Ue.value),rt=Mi(Ue.value),ct=Ue.value!==null?Ue.value:$e;if(X){if(Xe!==X)return[new cr(Ue.key,ct,`${Xe} stop domain type must match previous stop domain type ${X}`)]}else X=Xe;if(Xe!=="number"&&Xe!=="string"&&Xe!=="boolean")return[new cr(Ue.key,ct,"stop domain value must be a number, string, or boolean")];if(Xe!=="number"&&W!=="categorical"){let Ct=`number expected, ${Xe} found`;return $a(h)&&W===void 0&&(Ct+='\nIf you intended to use a categorical function, specify `"type": "categorical"`.'),[new cr(Ue.key,ct,Ct)]}return W!=="categorical"||Xe!=="number"||isFinite(rt)&&Math.floor(rt)===rt?W!=="categorical"&&Xe==="number"&&ie!==void 0&&rt<ie?[new cr(Ue.key,ct,"stop domain values must appear in ascending order")]:(ie=rt,W==="categorical"&&rt in ce?[new cr(Ue.key,ct,"stop domain values must be unique")]:(ce[rt]=!0,[])):[new cr(Ue.key,ct,`integer expected, found ${rt}`)]}}function Ka(H){const h=(H.expressionContext==="property"?yu:_s)(sa(H.value),H.valueSpec);if(h.result==="error")return h.value.map(X=>new cr(`${H.key}${X.key}`,H.value,X.message));const W=h.value.expression||h.value._styleExpression.expression;if(H.expressionContext==="property"&&H.propertyKey==="text-font"&&!W.outputDefined())return[new cr(H.key,H.value,`Invalid data expression for "${H.propertyKey}". Output values must be contained as literals within the expression.`)];if(H.expressionContext==="property"&&H.propertyType==="layout"&&!Eo(W))return[new cr(H.key,H.value,'"feature-state" data expressions are not supported with layout properties.')];if(H.expressionContext==="filter"&&!Eo(W))return[new cr(H.key,H.value,'"feature-state" data expressions are not supported with filters.')];if(H.expressionContext&&H.expressionContext.indexOf("cluster")===0){if(!Ga(W,["zoom","feature-state"]))return[new cr(H.key,H.value,'"zoom" and "feature-state" expressions are not supported with cluster properties.')];if(H.expressionContext==="cluster-initial"&&!ds(W))return[new cr(H.key,H.value,"Feature data expressions are not supported with initial expression part of cluster properties.")]}return[]}function bu(H){const h=H.key,W=H.value,X=ai(W);return X!=="string"?[new cr(h,W,`color expected, ${X} found`)]:ni.parse(String(W))?[]:[new cr(h,W,`color expected, "${W}" found`)]}function Oo(H){const h=H.key,W=H.value,X=H.valueSpec,ie=[];return Array.isArray(X.values)?X.values.indexOf(Mi(W))===-1&&ie.push(new cr(h,W,`expected one of [${X.values.join(", ")}], ${JSON.stringify(W)} found`)):Object.keys(X.values).indexOf(Mi(W))===-1&&ie.push(new cr(h,W,`expected one of [${Object.keys(X.values).join(", ")}], ${JSON.stringify(W)} found`)),ie}function xu(H){return Ro(sa(H.value))?Ka(bi({},H,{expressionContext:"filter",valueSpec:{value:"boolean"}})):kl(H)}function kl(H){const h=H.value,W=H.key;if(ai(h)!=="array")return[new cr(W,h,`array expected, ${ai(h)} found`)];const X=H.styleSpec;let ie,ue=[];if(h.length<1)return[new cr(W,h,"filter array must have at least 1 element")];switch(ue=ue.concat(Oo({key:`${W}[0]`,value:h[0],valueSpec:X.filter_operator,style:H.style,styleSpec:H.styleSpec})),Mi(h[0])){case"<":case"<=":case">":case">=":h.length>=2&&Mi(h[1])==="$type"&&ue.push(new cr(W,h,`"$type" cannot be use with operator "${h[0]}"`));case"==":case"!=":h.length!==3&&ue.push(new cr(W,h,`filter array for operator "${h[0]}" must have 3 elements`));case"in":case"!in":h.length>=2&&(ie=ai(h[1]),ie!=="string"&&ue.push(new cr(`${W}[1]`,h[1],`string expected, ${ie} found`)));for(let ce=2;ce<h.length;ce++)ie=ai(h[ce]),Mi(h[1])==="$type"?ue=ue.concat(Oo({key:`${W}[${ce}]`,value:h[ce],valueSpec:X.geometry_type,style:H.style,styleSpec:H.styleSpec})):ie!=="string"&&ie!=="number"&&ie!=="boolean"&&ue.push(new cr(`${W}[${ce}]`,h[ce],`string, number, or boolean expected, ${ie} found`));break;case"any":case"all":case"none":for(let ce=1;ce<h.length;ce++)ue=ue.concat(kl({key:`${W}[${ce}]`,value:h[ce],style:H.style,styleSpec:H.styleSpec}));break;case"has":case"!has":ie=ai(h[1]),h.length!==2?ue.push(new cr(W,h,`filter array for "${h[0]}" operator must have 2 elements`)):ie!=="string"&&ue.push(new cr(`${W}[1]`,h[1],`string expected, ${ie} found`))}return ue}function Ll(H,h){const W=H.key,X=H.validateSpec,ie=H.style,ue=H.styleSpec,ce=H.value,fe=H.objectKey,ye=ue[`${h}_${H.layerType}`];if(!ye)return[];const be=fe.match(/^(.*)-transition$/);if(h==="paint"&&be&&ye[be[1]]&&ye[be[1]].transition)return X({key:W,value:ce,valueSpec:ue.transition,style:ie,styleSpec:ue});const we=H.valueSpec||ye[fe];if(!we)return[new cr(W,ce,`unknown property "${fe}"`)];let Ie;if(ai(ce)==="string"&&$a(we)&&!we.tokens&&(Ie=/^{([^}]+)}$/.exec(ce)))return[new cr(W,ce,`"${fe}" does not support interpolation syntax
Use an identity property function instead: \`{ "type": "identity", "property": ${JSON.stringify(Ie[1])} }\`.`)];const Be=[];return H.layerType==="symbol"&&(fe==="text-field"&&ie&&!ie.glyphs&&Be.push(new cr(W,ce,'use of "text-field" requires a style "glyphs" property')),fe==="text-font"&&qa(sa(ce))&&Mi(ce.type)==="identity"&&Be.push(new cr(W,ce,'"text-font" does not support identity functions'))),Be.concat(X({key:H.key,value:ce,valueSpec:we,style:ie,styleSpec:ue,expressionContext:"property",propertyType:h,propertyKey:fe}))}function Ya(H){return Ll(H,"paint")}function Xa(H){return Ll(H,"layout")}function xn(H){let h=[];const W=H.value,X=H.key,ie=H.style,ue=H.styleSpec;if(ai(W)!=="object")return[new cr(X,W,`object expected, ${ai(W)} found`)];W.type||W.ref||h.push(new cr(X,W,'either "type" or "ref" is required'));let ce=Mi(W.type);const fe=Mi(W.ref);if(W.id){const ye=Mi(W.id);for(let be=0;be<H.arrayIndex;be++){const we=ie.layers[be];Mi(we.id)===ye&&h.push(new cr(X,W.id,`duplicate layer id "${W.id}", previously used at line ${we.id.__line__}`))}}if("ref"in W){let ye;["type","source","source-layer","filter","layout"].forEach(be=>{be in W&&h.push(new cr(X,W[be],`"${be}" is prohibited for ref layers`))}),ie.layers.forEach(be=>{Mi(be.id)===fe&&(ye=be)}),ye?ye.ref?h.push(new cr(X,W.ref,"ref cannot reference another ref layer")):ce=Mi(ye.type):h.push(new cr(X,W.ref,`ref layer "${fe}" not found`))}else if(ce!=="background")if(W.source){const ye=ie.sources&&ie.sources[W.source],be=ye&&Mi(ye.type);ye?be==="vector"&&ce==="raster"?h.push(new cr(X,W.source,`layer "${W.id}" requires a raster source`)):be!=="raster-dem"&&ce==="hillshade"||be!=="raster-dem"&&ce==="color-relief"?h.push(new cr(X,W.source,`layer "${W.id}" requires a raster-dem source`)):be==="raster"&&ce!=="raster"?h.push(new cr(X,W.source,`layer "${W.id}" requires a vector source`)):be!=="vector"||W["source-layer"]?be==="raster-dem"&&ce!=="hillshade"&&ce!=="color-relief"?h.push(new cr(X,W.source,"raster-dem source can only be used with layer type 'hillshade' or 'color-relief'.")):ce!=="line"||!W.paint||!W.paint["line-gradient"]||be==="geojson"&&ye.lineMetrics||h.push(new cr(X,W,`layer "${W.id}" specifies a line-gradient, which requires a GeoJSON source with \`lineMetrics\` enabled.`)):h.push(new cr(X,W,`layer "${W.id}" must specify a "source-layer"`)):h.push(new cr(X,W.source,`source "${W.source}" not found`))}else h.push(new cr(X,W,'missing required property "source"'));return h=h.concat(Pn({key:X,value:W,valueSpec:ue.layer,style:H.style,styleSpec:H.styleSpec,validateSpec:H.validateSpec,objectElementValidators:{"*":()=>[],type:()=>H.validateSpec({key:`${X}.type`,value:W.type,valueSpec:ue.layer.type,style:H.style,styleSpec:H.styleSpec,validateSpec:H.validateSpec,object:W,objectKey:"type"}),filter:xu,layout:ye=>Pn({layer:W,key:ye.key,value:ye.value,style:ye.style,styleSpec:ye.styleSpec,validateSpec:ye.validateSpec,objectElementValidators:{"*":be=>Xa(bi({layerType:ce},be))}}),paint:ye=>Pn({layer:W,key:ye.key,value:ye.value,style:ye.style,styleSpec:ye.styleSpec,validateSpec:ye.validateSpec,objectElementValidators:{"*":be=>Ya(bi({layerType:ce},be))}})}})),h}function Mn(H){const h=H.value,W=H.key,X=ai(h);return X!=="string"?[new cr(W,h,`string expected, ${X} found`)]:[]}const wu={promoteId:function({key:H,value:h}){if(ai(h)==="string")return Mn({key:H,value:h});{const W=[];for(const X in h)W.push(...Mn({key:`${H}.${X}`,value:h[X]}));return W}}};function Bl(H){const h=H.value,W=H.key,X=H.styleSpec,ie=H.style,ue=H.validateSpec;if(!h.type)return[new cr(W,h,'"type" is required')];const ce=Mi(h.type);let fe;switch(ce){case"vector":case"raster":return fe=Pn({key:W,value:h,valueSpec:X[`source_${ce.replace("-","_")}`],style:H.style,styleSpec:X,objectElementValidators:wu,validateSpec:ue}),fe;case"raster-dem":return fe=function(ye){var be;const we=(be=ye.sourceName)!==null&&be!==void 0?be:"",Ie=ye.value,Be=ye.styleSpec,Ue=Be.source_raster_dem,$e=ye.style;let Xe=[];const rt=ai(Ie);if(Ie===void 0)return Xe;if(rt!=="object")return Xe.push(new cr("source_raster_dem",Ie,`object expected, ${rt} found`)),Xe;const ct=Mi(Ie.encoding)==="custom",Ct=["redFactor","greenFactor","blueFactor","baseShift"],wt=ye.value.encoding?`"${ye.value.encoding}"`:"Default";for(const Ne in Ie)!ct&&Ct.includes(Ne)?Xe.push(new cr(Ne,Ie[Ne],`In "${we}": "${Ne}" is only valid when "encoding" is set to "custom". ${wt} encoding found`)):Ue[Ne]?Xe=Xe.concat(ye.validateSpec({key:Ne,value:Ie[Ne],valueSpec:Ue[Ne],validateSpec:ye.validateSpec,style:$e,styleSpec:Be})):Xe.push(new cr(Ne,Ie[Ne],`unknown property "${Ne}"`));return Xe}({sourceName:W,value:h,style:H.style,styleSpec:X,validateSpec:ue}),fe;case"geojson":if(fe=Pn({key:W,value:h,valueSpec:X.source_geojson,style:ie,styleSpec:X,validateSpec:ue,objectElementValidators:wu}),h.cluster)for(const ye in h.clusterProperties){const[be,we]=h.clusterProperties[ye],Ie=typeof be=="string"?[be,["accumulated"],["get",ye]]:be;fe.push(...Ka({key:`${W}.${ye}.map`,value:we,expressionContext:"cluster-map"})),fe.push(...Ka({key:`${W}.${ye}.reduce`,value:Ie,expressionContext:"cluster-reduce"}))}return fe;case"video":return Pn({key:W,value:h,valueSpec:X.source_video,style:ie,validateSpec:ue,styleSpec:X});case"image":return Pn({key:W,value:h,valueSpec:X.source_image,style:ie,validateSpec:ue,styleSpec:X});case"canvas":return[new cr(W,null,"Please use runtime APIs to add canvas sources, rather than including them in stylesheets.","source.canvas")];default:return Oo({key:`${W}.type`,value:h.type,valueSpec:{values:["vector","raster","raster-dem","geojson","video","image"]}})}}function jl(H){const h=H.value,W=H.styleSpec,X=W.light,ie=H.style;let ue=[];const ce=ai(h);if(h===void 0)return ue;if(ce!=="object")return ue=ue.concat([new cr("light",h,`object expected, ${ce} found`)]),ue;for(const fe in h){const ye=fe.match(/^(.*)-transition$/);ue=ue.concat(ye&&X[ye[1]]&&X[ye[1]].transition?H.validateSpec({key:fe,value:h[fe],valueSpec:W.transition,validateSpec:H.validateSpec,style:ie,styleSpec:W}):X[fe]?H.validateSpec({key:fe,value:h[fe],valueSpec:X[fe],validateSpec:H.validateSpec,style:ie,styleSpec:W}):[new cr(fe,h[fe],`unknown property "${fe}"`)])}return ue}function Ja(H){const h=H.value,W=H.styleSpec,X=W.sky,ie=H.style,ue=ai(h);if(h===void 0)return[];if(ue!=="object")return[new cr("sky",h,`object expected, ${ue} found`)];let ce=[];for(const fe in h)ce=ce.concat(X[fe]?H.validateSpec({key:fe,value:h[fe],valueSpec:X[fe],style:ie,styleSpec:W}):[new cr(fe,h[fe],`unknown property "${fe}"`)]);return ce}function Su(H){const h=H.value,W=H.styleSpec,X=W.terrain,ie=H.style;let ue=[];const ce=ai(h);if(h===void 0)return ue;if(ce!=="object")return ue=ue.concat([new cr("terrain",h,`object expected, ${ce} found`)]),ue;for(const fe in h)ue=ue.concat(X[fe]?H.validateSpec({key:fe,value:h[fe],valueSpec:X[fe],validateSpec:H.validateSpec,style:ie,styleSpec:W}):[new cr(fe,h[fe],`unknown property "${fe}"`)]);return ue}function ws(H){let h=[];const W=H.value,X=H.key;if(Array.isArray(W)){const ie=[],ue=[];for(const ce in W)W[ce].id&&ie.includes(W[ce].id)&&h.push(new cr(X,W,`all the sprites' ids must be unique, but ${W[ce].id} is duplicated`)),ie.push(W[ce].id),W[ce].url&&ue.includes(W[ce].url)&&h.push(new cr(X,W,`all the sprites' URLs must be unique, but ${W[ce].url} is duplicated`)),ue.push(W[ce].url),h=h.concat(Pn({key:`${X}[${ce}]`,value:W[ce],valueSpec:{id:{type:"string",required:!0},url:{type:"string",required:!0}},validateSpec:H.validateSpec}));return h}return Mn({key:X,value:W})}function Nl(H){return h=H.value,h&&h.constructor===Object?[]:[new cr(H.key,H.value,`object expected, ${ai(H.value)} found`)];var h}const Ss={"*":()=>[],array:xs,boolean:function(H){const h=H.value,W=H.key,X=ai(h);return X!=="boolean"?[new cr(W,h,`boolean expected, ${X} found`)]:[]},number:Po,color:bu,constants:Fl,enum:Oo,filter:xu,function:Za,layer:xn,object:Pn,source:Bl,light:jl,sky:Ja,terrain:Su,projection:function(H){const h=H.value,W=H.styleSpec,X=W.projection,ie=H.style,ue=ai(h);if(h===void 0)return[];if(ue!=="object")return[new cr("projection",h,`object expected, ${ue} found`)];let ce=[];for(const fe in h)ce=ce.concat(X[fe]?H.validateSpec({key:fe,value:h[fe],valueSpec:X[fe],style:ie,styleSpec:W}):[new cr(fe,h[fe],`unknown property "${fe}"`)]);return ce},projectionDefinition:function(H){const h=H.key;let W=H.value;W=W instanceof String?W.valueOf():W;const X=ai(W);return X!=="array"||function(ie){return Array.isArray(ie)&&ie.length===3&&typeof ie[0]=="string"&&typeof ie[1]=="string"&&typeof ie[2]=="number"}(W)||function(ie){return!!["interpolate","step","literal"].includes(ie[0])}(W)?["array","string"].includes(X)?[]:[new cr(h,W,`projection expected, invalid type "${X}" found`)]:[new cr(h,W,`projection expected, invalid array ${JSON.stringify(W)} found`)]},string:Mn,formatted:function(H){return Mn(H).length===0?[]:Ka(H)},resolvedImage:function(H){return Mn(H).length===0?[]:Ka(H)},padding:function(H){const h=H.key,W=H.value;if(ai(W)==="array"){if(W.length<1||W.length>4)return[new cr(h,W,`padding requires 1 to 4 values; ${W.length} values found`)];const X={type:"number"};let ie=[];for(let ue=0;ue<W.length;ue++)ie=ie.concat(H.validateSpec({key:`${h}[${ue}]`,value:W[ue],validateSpec:H.validateSpec,valueSpec:X}));return ie}return Po({key:h,value:W,valueSpec:{}})},numberArray:function(H){const h=H.key,W=H.value;if(ai(W)==="array"){const X={type:"number"};if(W.length<1)return[new cr(h,W,"array length at least 1 expected, length 0 found")];let ie=[];for(let ue=0;ue<W.length;ue++)ie=ie.concat(H.validateSpec({key:`${h}[${ue}]`,value:W[ue],validateSpec:H.validateSpec,valueSpec:X}));return ie}return Po({key:h,value:W,valueSpec:{}})},colorArray:function(H){const h=H.key,W=H.value;if(ai(W)==="array"){if(W.length<1)return[new cr(h,W,"array length at least 1 expected, length 0 found")];let X=[];for(let ie=0;ie<W.length;ie++)X=X.concat(bu({key:`${h}[${ie}]`,value:W[ie]}));return X}return bu({key:h,value:W})},variableAnchorOffsetCollection:function(H){const h=H.key,W=H.value,X=ai(W),ie=H.styleSpec;if(X!=="array"||W.length<1||W.length%2!=0)return[new cr(h,W,"variableAnchorOffsetCollection requires a non-empty array of even length")];let ue=[];for(let ce=0;ce<W.length;ce+=2)ue=ue.concat(Oo({key:`${h}[${ce}]`,value:W[ce],valueSpec:ie.layout_symbol["text-anchor"]})),ue=ue.concat(xs({key:`${h}[${ce+1}]`,value:W[ce+1],valueSpec:{length:2,value:"number"},validateSpec:H.validateSpec,style:H.style,styleSpec:ie}));return ue},sprite:ws,state:Nl};function Es(H){const h=H.value,W=H.valueSpec,X=H.styleSpec;return H.validateSpec=Es,W.expression&&qa(Mi(h))?Za(H):W.expression&&ps(sa(h))?Ka(H):W.type&&Ss[W.type]?Ss[W.type](H):Pn(bi({},H,{valueSpec:W.type?X[W.type]:W}))}function Qa(H){const h=H.value,W=H.key,X=Mn(H);return X.length||(h.indexOf("{fontstack}")===-1&&X.push(new cr(W,h,'"glyphs" url must include a "{fontstack}" token')),h.indexOf("{range}")===-1&&X.push(new cr(W,h,'"glyphs" url must include a "{range}" token'))),X}function On(H,h=St){let W=[];return W=W.concat(Es({key:"",value:H,valueSpec:h.$root,styleSpec:h,style:H,validateSpec:Es,objectElementValidators:{glyphs:Qa,"*":()=>[]}})),H.constants&&(W=W.concat(Fl({key:"constants",value:H.constants}))),zl(W)}function Dn(H){return function(h){return H({...h,validateSpec:Es})}}function zl(H){return[].concat(H).sort((h,W)=>h.line-W.line)}function fn(H){return function(...h){return zl(H.apply(this,h))}}On.source=fn(Dn(Bl)),On.sprite=fn(Dn(ws)),On.glyphs=fn(Dn(Qa)),On.light=fn(Dn(jl)),On.sky=fn(Dn(Ja)),On.terrain=fn(Dn(Su)),On.state=fn(Dn(Nl)),On.layer=fn(Dn(xn)),On.filter=fn(Dn(xu)),On.paintProperty=fn(Dn(Ya)),On.layoutProperty=fn(Dn(Xa));const eo=On,Mc=eo.light,qs=eo.sky,Dc=eo.paintProperty,Eu=eo.layoutProperty;function Co(H,h){let W=!1;if(h&&h.length)for(const X of h)H.fire(new Ot(new Error(X.message))),W=!0;return W}class to{constructor(h,W,X){const ie=this.cells=[];if(h instanceof ArrayBuffer){this.arrayBuffer=h;const ce=new Int32Array(this.arrayBuffer);h=ce[0],this.d=(W=ce[1])+2*(X=ce[2]);for(let ye=0;ye<this.d*this.d;ye++){const be=ce[3+ye],we=ce[3+ye+1];ie.push(be===we?null:ce.subarray(be,we))}const fe=ce[3+ie.length+1];this.keys=ce.subarray(ce[3+ie.length],fe),this.bboxes=ce.subarray(fe),this.insert=this._insertReadonly}else{this.d=W+2*X;for(let ce=0;ce<this.d*this.d;ce++)ie.push([]);this.keys=[],this.bboxes=[]}this.n=W,this.extent=h,this.padding=X,this.scale=W/h,this.uid=0;const ue=X/W*h;this.min=-ue,this.max=h+ue}insert(h,W,X,ie,ue){this._forEachCell(W,X,ie,ue,this._insertCell,this.uid++,void 0,void 0),this.keys.push(h),this.bboxes.push(W),this.bboxes.push(X),this.bboxes.push(ie),this.bboxes.push(ue)}_insertReadonly(){throw new Error("Cannot insert into a GridIndex created from an ArrayBuffer.")}_insertCell(h,W,X,ie,ue,ce){this.cells[ue].push(ce)}query(h,W,X,ie,ue){const ce=this.min,fe=this.max;if(h<=ce&&W<=ce&&fe<=X&&fe<=ie&&!ue)return Array.prototype.slice.call(this.keys);{const ye=[];return this._forEachCell(h,W,X,ie,this._queryCell,ye,{},ue),ye}}_queryCell(h,W,X,ie,ue,ce,fe,ye){const be=this.cells[ue];if(be!==null){const we=this.keys,Ie=this.bboxes;for(let Be=0;Be<be.length;Be++){const Ue=be[Be];if(fe[Ue]===void 0){const $e=4*Ue;(ye?ye(Ie[$e+0],Ie[$e+1],Ie[$e+2],Ie[$e+3]):h<=Ie[$e+2]&&W<=Ie[$e+3]&&X>=Ie[$e+0]&&ie>=Ie[$e+1])?(fe[Ue]=!0,ce.push(we[Ue])):fe[Ue]=!1}}}}_forEachCell(h,W,X,ie,ue,ce,fe,ye){const be=this._convertToCellCoord(h),we=this._convertToCellCoord(W),Ie=this._convertToCellCoord(X),Be=this._convertToCellCoord(ie);for(let Ue=be;Ue<=Ie;Ue++)for(let $e=we;$e<=Be;$e++){const Xe=this.d*$e+Ue;if((!ye||ye(this._convertFromCellCoord(Ue),this._convertFromCellCoord($e),this._convertFromCellCoord(Ue+1),this._convertFromCellCoord($e+1)))&&ue.call(this,h,W,X,ie,Xe,ce,fe,ye))return}}_convertFromCellCoord(h){return(h-this.padding)/this.scale}_convertToCellCoord(h){return Math.max(0,Math.min(this.d-1,Math.floor(h*this.scale)+this.padding))}toArrayBuffer(){if(this.arrayBuffer)return this.arrayBuffer;const h=this.cells,W=3+this.cells.length+1+1;let X=0;for(let ce=0;ce<this.cells.length;ce++)X+=this.cells[ce].length;const ie=new Int32Array(W+X+this.keys.length+this.bboxes.length);ie[0]=this.extent,ie[1]=this.n,ie[2]=this.padding;let ue=W;for(let ce=0;ce<h.length;ce++){const fe=h[ce];ie[3+ce]=ue,ie.set(fe,ue),ue+=fe.length}return ie[3+h.length]=ue,ie.set(this.keys,ue),ue+=this.keys.length,ie[3+h.length+1]=ue,ie.set(this.bboxes,ue),ue+=this.bboxes.length,ie.buffer}static serialize(h,W){const X=h.toArrayBuffer();return W&&W.push(X),{buffer:X}}static deserialize(h){return new to(h.buffer)}}const Gn={};function Tr(H,h,W={}){if(Gn[H])throw new Error(`${H} is already registered.`);Object.defineProperty(h,"_classRegistryKey",{value:H,writeable:!1}),Gn[H]={klass:h,omit:W.omit||[],shallow:W.shallow||[]}}Tr("Object",Object),Tr("Set",Set),Tr("TransferableGridIndex",to),Tr("Color",ni),Tr("Error",Error),Tr("AJAXError",Le),Tr("ResolvedImage",gn),Tr("StylePropertyFunction",Io),Tr("StyleExpression",fs,{omit:["_evaluator"]}),Tr("ZoomDependentExpression",ys),Tr("ZoomConstantExpression",To),Tr("CompoundExpression",An,{omit:["_evaluate"]});for(const H in Ua)Ua[H]._classRegistryKey||Tr(`Expression_${H}`,Ua[H]);function qu(H){return H&&typeof ArrayBuffer<"u"&&(H instanceof ArrayBuffer||H.constructor&&H.constructor.name==="ArrayBuffer")}function Mo(H){return H.$name||H.constructor._classRegistryKey}function Tu(H){return!function(h){if(h===null||typeof h!="object")return!1;const W=Mo(h);return!(!W||W==="Object")}(H)&&(H==null||typeof H=="boolean"||typeof H=="number"||typeof H=="string"||H instanceof Boolean||H instanceof Number||H instanceof String||H instanceof Date||H instanceof RegExp||H instanceof Blob||H instanceof Error||qu(H)||rr(H)||ArrayBuffer.isView(H)||H instanceof ImageData)}function Do(H,h){if(Tu(H))return(qu(H)||rr(H))&&h&&h.push(H),ArrayBuffer.isView(H)&&h&&h.push(H.buffer),H instanceof ImageData&&h&&h.push(H.data.buffer),H;if(Array.isArray(H)){const ue=[];for(const ce of H)ue.push(Do(ce,h));return ue}if(typeof H!="object")throw new Error("can't serialize object of type "+typeof H);const W=Mo(H);if(!W)throw new Error(`can't serialize object of unregistered class ${H.constructor.name}`);if(!Gn[W])throw new Error(`${W} is not registered.`);const{klass:X}=Gn[W],ie=X.serialize?X.serialize(H,h):{};if(X.serialize){if(h&&ie===h[h.length-1])throw new Error("statically serialized object won't survive transfer of $name property")}else{for(const ue in H){if(!H.hasOwnProperty(ue)||Gn[W].omit.indexOf(ue)>=0)continue;const ce=H[ue];ie[ue]=Gn[W].shallow.indexOf(ue)>=0?ce:Do(ce,h)}H instanceof Error&&(ie.message=H.message)}if(ie.$name)throw new Error("$name property is reserved for worker serialization logic.");return W!=="Object"&&(ie.$name=W),ie}function ro(H){if(Tu(H))return H;if(Array.isArray(H))return H.map(ro);if(typeof H!="object")throw new Error("can't deserialize object of type "+typeof H);const h=Mo(H)||"Object";if(!Gn[h])throw new Error(`can't deserialize unregistered class ${h}`);const{klass:W}=Gn[h];if(!W)throw new Error(`can't deserialize unregistered class ${h}`);if(W.deserialize)return W.deserialize(H);const X=Object.create(W.prototype);for(const ie of Object.keys(H)){if(ie==="$name")continue;const ue=H[ie];X[ie]=Gn[h].shallow.indexOf(ie)>=0?ue:ro(ue)}return X}class Iu{constructor(){this.first=!0}update(h,W){const X=Math.floor(h);return this.first?(this.first=!1,this.lastIntegerZoom=X,this.lastIntegerZoomTime=0,this.lastZoom=h,this.lastFloorZoom=X,!0):(this.lastFloorZoom>X?(this.lastIntegerZoom=X+1,this.lastIntegerZoomTime=W):this.lastFloorZoom<X&&(this.lastIntegerZoom=X,this.lastIntegerZoomTime=W),h!==this.lastZoom&&(this.lastZoom=h,this.lastFloorZoom=X,!0))}}const oi={"Latin-1 Supplement":H=>H>=128&&H<=255,"Hangul Jamo":H=>H>=4352&&H<=4607,Khmer:H=>H>=6016&&H<=6143,"General Punctuation":H=>H>=8192&&H<=8303,"Letterlike Symbols":H=>H>=8448&&H<=8527,"Number Forms":H=>H>=8528&&H<=8591,"Miscellaneous Technical":H=>H>=8960&&H<=9215,"Control Pictures":H=>H>=9216&&H<=9279,"Optical Character Recognition":H=>H>=9280&&H<=9311,"Enclosed Alphanumerics":H=>H>=9312&&H<=9471,"Geometric Shapes":H=>H>=9632&&H<=9727,"Miscellaneous Symbols":H=>H>=9728&&H<=9983,"Miscellaneous Symbols and Arrows":H=>H>=11008&&H<=11263,"Ideographic Description Characters":H=>H>=12272&&H<=12287,"CJK Symbols and Punctuation":H=>H>=12288&&H<=12351,Hiragana:H=>H>=12352&&H<=12447,Katakana:H=>H>=12448&&H<=12543,Kanbun:H=>H>=12688&&H<=12703,"CJK Strokes":H=>H>=12736&&H<=12783,"Enclosed CJK Letters and Months":H=>H>=12800&&H<=13055,"CJK Compatibility":H=>H>=13056&&H<=13311,"Yijing Hexagram Symbols":H=>H>=19904&&H<=19967,"CJK Unified Ideographs":H=>H>=19968&&H<=40959,"Hangul Syllables":H=>H>=44032&&H<=55215,"Private Use Area":H=>H>=57344&&H<=63743,"Vertical Forms":H=>H>=65040&&H<=65055,"CJK Compatibility Forms":H=>H>=65072&&H<=65103,"Small Form Variants":H=>H>=65104&&H<=65135,"Halfwidth and Fullwidth Forms":H=>H>=65280&&H<=65519};function Ru(H){for(const h of H)if(Is(h.charCodeAt(0)))return!0;return!1}function Ul(H){for(const h of H)if(!kc(h.charCodeAt(0)))return!1;return!0}function Ts(H){const h=H.map(W=>{try{return new RegExp(`\\p{sc=${W}}`,"u").source}catch{return null}}).filter(W=>W);return new RegExp(h.join("|"),"u")}const Fc=Ts(["Arab","Dupl","Mong","Ougr","Syrc"]);function kc(H){return!Fc.test(String.fromCodePoint(H))}const Au=Ts(["Bopo","Hani","Hira","Kana","Kits","Nshu","Tang","Yiii"]);function Is(H){return!(H!==746&&H!==747&&(H<4352||!(oi["CJK Compatibility Forms"](H)&&!(H>=65097&&H<=65103)||oi["CJK Compatibility"](H)||oi["CJK Strokes"](H)||!(!oi["CJK Symbols and Punctuation"](H)||H>=12296&&H<=12305||H>=12308&&H<=12319||H===12336)||oi["Enclosed CJK Letters and Months"](H)||oi["Ideographic Description Characters"](H)||oi.Kanbun(H)||oi.Katakana(H)&&H!==12540||!(!oi["Halfwidth and Fullwidth Forms"](H)||H===65288||H===65289||H===65293||H>=65306&&H<=65310||H===65339||H===65341||H===65343||H>=65371&&H<=65503||H===65507||H>=65512&&H<=65519)||!(!oi["Small Form Variants"](H)||H>=65112&&H<=65118||H>=65123&&H<=65126)||oi["Vertical Forms"](H)||oi["Yijing Hexagram Symbols"](H)||new RegExp("\\p{sc=Cans}","u").test(String.fromCodePoint(H))||new RegExp("\\p{sc=Hang}","u").test(String.fromCodePoint(H))||Au.test(String.fromCodePoint(H)))))}function Pu(H){return!(Is(H)||function(h){return!!(oi["Latin-1 Supplement"](h)&&(h===167||h===169||h===174||h===177||h===188||h===189||h===190||h===215||h===247)||oi["General Punctuation"](h)&&(h===8214||h===8224||h===8225||h===8240||h===8241||h===8251||h===8252||h===8258||h===8263||h===8264||h===8265||h===8273)||oi["Letterlike Symbols"](h)||oi["Number Forms"](h)||oi["Miscellaneous Technical"](h)&&(h>=8960&&h<=8967||h>=8972&&h<=8991||h>=8996&&h<=9e3||h===9003||h>=9085&&h<=9114||h>=9150&&h<=9165||h===9167||h>=9169&&h<=9179||h>=9186&&h<=9215)||oi["Control Pictures"](h)&&h!==9251||oi["Optical Character Recognition"](h)||oi["Enclosed Alphanumerics"](h)||oi["Geometric Shapes"](h)||oi["Miscellaneous Symbols"](h)&&!(h>=9754&&h<=9759)||oi["Miscellaneous Symbols and Arrows"](h)&&(h>=11026&&h<=11055||h>=11088&&h<=11097||h>=11192&&h<=11243)||oi["CJK Symbols and Punctuation"](h)||oi.Katakana(h)||oi["Private Use Area"](h)||oi["CJK Compatibility Forms"](h)||oi["Small Form Variants"](h)||oi["Halfwidth and Fullwidth Forms"](h)||h===8734||h===8756||h===8757||h>=9984&&h<=10087||h>=10102&&h<=10131||h===65532||h===65533)}(H))}const Gl=Ts(["Adlm","Arab","Armi","Avst","Chrs","Cprt","Egyp","Elym","Gara","Hatr","Hebr","Hung","Khar","Lydi","Mand","Mani","Mend","Merc","Mero","Narb","Nbat","Nkoo","Orkh","Palm","Phli","Phlp","Phnx","Prti","Rohg","Samr","Sarb","Sogo","Syrc","Thaa","Todr","Yezi"]);function Fo(H){return Gl.test(String.fromCodePoint(H))}function Lc(H,h){return!(!h&&Fo(H)||H>=2304&&H<=3583||H>=3840&&H<=4255||oi.Khmer(H))}function Ou(H){for(const h of H)if(Fo(h.charCodeAt(0)))return!0;return!1}const ua=new class{constructor(){this.TIMEOUT=5e3,this.applyArabicShaping=null,this.processBidirectionalText=null,this.processStyledBidirectionalText=null,this.pluginStatus="unavailable",this.pluginURL=null,this.loadScriptResolve=()=>{}}setState(H){this.pluginStatus=H.pluginStatus,this.pluginURL=H.pluginURL}getState(){return{pluginStatus:this.pluginStatus,pluginURL:this.pluginURL}}setMethods(H){if(ua.isParsed())throw new Error("RTL text plugin already registered.");this.applyArabicShaping=H.applyArabicShaping,this.processBidirectionalText=H.processBidirectionalText,this.processStyledBidirectionalText=H.processStyledBidirectionalText,this.loadScriptResolve()}isParsed(){return this.applyArabicShaping!=null&&this.processBidirectionalText!=null&&this.processStyledBidirectionalText!=null}getRTLTextPluginStatus(){return this.pluginStatus}syncState(H,h){return R(this,void 0,void 0,function*(){if(this.isParsed())return this.getState();if(H.pluginStatus!=="loading")return this.setState(H),H;const W=H.pluginURL,X=new Promise(ue=>{this.loadScriptResolve=ue});h(W);const ie=new Promise(ue=>setTimeout(()=>ue(),this.TIMEOUT));if(yield Promise.race([X,ie]),this.isParsed()){const ue={pluginStatus:"loaded",pluginURL:W};return this.setState(ue),ue}throw this.setState({pluginStatus:"error",pluginURL:""}),new Error(`RTL Text Plugin failed to import scripts from ${W}`)})}};class Si{constructor(h,W){this.zoom=h,W?(this.now=W.now||0,this.fadeDuration=W.fadeDuration||0,this.zoomHistory=W.zoomHistory||new Iu,this.transition=W.transition||{},this.globalState=W.globalState||{}):(this.now=0,this.fadeDuration=0,this.zoomHistory=new Iu,this.transition={},this.globalState={})}isSupportedScript(h){return function(W,X){for(const ie of W)if(!Lc(ie.charCodeAt(0),X))return!1;return!0}(h,ua.getRTLTextPluginStatus()==="loaded")}crossFadingFactor(){return this.fadeDuration===0?1:Math.min((this.now-this.zoomHistory.lastIntegerZoomTime)/this.fadeDuration,1)}getCrossfadeParameters(){const h=this.zoom,W=h-Math.floor(h),X=this.crossFadingFactor();return h>this.zoomHistory.lastIntegerZoom?{fromScale:2,toScale:1,t:W+(1-W)*X}:{fromScale:.5,toScale:1,t:1-(1-X)*W}}}class ko{constructor(h,W){this.property=h,this.value=W,this.expression=function(X,ie){if(qa(X))return new Io(X,ie);if(ps(X)){const ue=yu(X,ie);if(ue.result==="error")throw new Error(ue.value.map(ce=>`${ce.key}: ${ce.message}`).join(", "));return ue.value}{let ue=X;return ie.type==="color"&&typeof X=="string"?ue=ni.parse(X):ie.type!=="padding"||typeof X!="number"&&!Array.isArray(X)?ie.type!=="numberArray"||typeof X!="number"&&!Array.isArray(X)?ie.type!=="colorArray"||typeof X!="string"&&!Array.isArray(X)?ie.type==="variableAnchorOffsetCollection"&&Array.isArray(X)?ue=ui.parse(X):ie.type==="projectionDefinition"&&typeof X=="string"&&(ue=Xr.parse(X)):ue=$i.parse(X):ue=un.parse(X):ue=Bi.parse(X),{globalStateRefs:new Set,kind:"constant",evaluate:()=>ue}}}(W===void 0?h.specification.default:W,h.specification)}isDataDriven(){return this.expression.kind==="source"||this.expression.kind==="composite"}getGlobalStateRefs(){return this.expression.globalStateRefs||new Set}possiblyEvaluate(h,W,X){return this.property.possiblyEvaluate(this,h,W,X)}}class Rs{constructor(h){this.property=h,this.value=new ko(h,void 0)}transitioned(h,W){return new Vl(this.property,this.value,W,Rr({},h.transition,this.transition),h.now)}untransitioned(){return new Vl(this.property,this.value,null,{},0)}}class Cu{constructor(h){this._properties=h,this._values=Object.create(h.defaultTransitionablePropertyValues)}getValue(h){return Kr(this._values[h].value.value)}setValue(h,W){Object.prototype.hasOwnProperty.call(this._values,h)||(this._values[h]=new Rs(this._values[h].property)),this._values[h].value=new ko(this._values[h].property,W===null?void 0:Kr(W))}getTransition(h){return Kr(this._values[h].transition)}setTransition(h,W){Object.prototype.hasOwnProperty.call(this._values,h)||(this._values[h]=new Rs(this._values[h].property)),this._values[h].transition=Kr(W)||void 0}serialize(){const h={};for(const W of Object.keys(this._values)){const X=this.getValue(W);X!==void 0&&(h[W]=X);const ie=this.getTransition(W);ie!==void 0&&(h[`${W}-transition`]=ie)}return h}transitioned(h,W){const X=new $l(this._properties);for(const ie of Object.keys(this._values))X._values[ie]=this._values[ie].transitioned(h,W._values[ie]);return X}untransitioned(){const h=new $l(this._properties);for(const W of Object.keys(this._values))h._values[W]=this._values[W].untransitioned();return h}}class Vl{constructor(h,W,X,ie,ue){this.property=h,this.value=W,this.begin=ue+ie.delay||0,this.end=this.begin+ie.duration||0,h.specification.transition&&(ie.delay||ie.duration)&&(this.prior=X)}possiblyEvaluate(h,W,X){const ie=h.now||0,ue=this.value.possiblyEvaluate(h,W,X),ce=this.prior;if(ce){if(ie>this.end)return this.prior=null,ue;if(this.value.isDataDriven())return this.prior=null,ue;if(ie<this.begin)return ce.possiblyEvaluate(h,W,X);{const fe=(ie-this.begin)/(this.end-this.begin);return this.property.interpolate(ce.possiblyEvaluate(h,W,X),ue,vr(fe))}}return ue}}class $l{constructor(h){this._properties=h,this._values=Object.create(h.defaultTransitioningPropertyValues)}possiblyEvaluate(h,W,X){const ie=new As(this._properties);for(const ue of Object.keys(this._values))ie._values[ue]=this._values[ue].possiblyEvaluate(h,W,X);return ie}hasTransition(){for(const h of Object.keys(this._values))if(this._values[h].prior)return!0;return!1}}class Bc{constructor(h){this._properties=h,this._values=Object.create(h.defaultPropertyValues)}hasValue(h){return this._values[h].value!==void 0}getValue(h){return Kr(this._values[h].value)}setValue(h,W){this._values[h]=new ko(this._values[h].property,W===null?void 0:Kr(W))}serialize(){const h={};for(const W of Object.keys(this._values)){const X=this.getValue(W);X!==void 0&&(h[W]=X)}return h}possiblyEvaluate(h,W,X){const ie=new As(this._properties);for(const ue of Object.keys(this._values))ie._values[ue]=this._values[ue].possiblyEvaluate(h,W,X);return ie}}class Vn{constructor(h,W,X){this.property=h,this.value=W,this.parameters=X}isConstant(){return this.value.kind==="constant"}constantOr(h){return this.value.kind==="constant"?this.value.value:h}evaluate(h,W,X,ie){return this.property.evaluate(this.value,this.parameters,h,W,X,ie)}}class As{constructor(h){this._properties=h,this._values=Object.create(h.defaultPossiblyEvaluatedValues)}get(h){return this._values[h]}}class Or{constructor(h){this.specification=h}possiblyEvaluate(h,W){if(h.isDataDriven())throw new Error("Value should not be data driven");return h.expression.evaluate(W)}interpolate(h,W,X){const ie=En[this.specification.type];return ie?ie(h,W,X):h}}class Vr{constructor(h,W){this.specification=h,this.overrides=W}possiblyEvaluate(h,W,X,ie){return new Vn(this,h.expression.kind==="constant"||h.expression.kind==="camera"?{kind:"constant",value:h.expression.evaluate(W,null,{},X,ie)}:h.expression,W)}interpolate(h,W,X){if(h.value.kind!=="constant"||W.value.kind!=="constant")return h;if(h.value.value===void 0||W.value.value===void 0)return new Vn(this,{kind:"constant",value:void 0},h.parameters);const ie=En[this.specification.type];if(ie){const ue=ie(h.value.value,W.value.value,X);return new Vn(this,{kind:"constant",value:ue},h.parameters)}return h}evaluate(h,W,X,ie,ue,ce){return h.kind==="constant"?h.value:h.evaluate(W,X,ie,ue,ce)}}class Ps extends Vr{possiblyEvaluate(h,W,X,ie){if(h.value===void 0)return new Vn(this,{kind:"constant",value:void 0},W);if(h.expression.kind==="constant"){const ue=h.expression.evaluate(W,null,{},X,ie),ce=h.property.specification.type==="resolvedImage"&&typeof ue!="string"?ue.name:ue,fe=this._calculate(ce,ce,ce,W);return new Vn(this,{kind:"constant",value:fe},W)}if(h.expression.kind==="camera"){const ue=this._calculate(h.expression.evaluate({zoom:W.zoom-1}),h.expression.evaluate({zoom:W.zoom}),h.expression.evaluate({zoom:W.zoom+1}),W);return new Vn(this,{kind:"constant",value:ue},W)}return new Vn(this,h.expression,W)}evaluate(h,W,X,ie,ue,ce){if(h.kind==="source"){const fe=h.evaluate(W,X,ie,ue,ce);return this._calculate(fe,fe,fe,W)}return h.kind==="composite"?this._calculate(h.evaluate({zoom:Math.floor(W.zoom)-1},X,ie),h.evaluate({zoom:Math.floor(W.zoom)},X,ie),h.evaluate({zoom:Math.floor(W.zoom)+1},X,ie),W):h.value}_calculate(h,W,X,ie){return ie.zoom>ie.zoomHistory.lastIntegerZoom?{from:h,to:W}:{from:X,to:W}}interpolate(h){return h}}class Mu{constructor(h){this.specification=h}possiblyEvaluate(h,W,X,ie){if(h.value!==void 0){if(h.expression.kind==="constant"){const ue=h.expression.evaluate(W,null,{},X,ie);return this._calculate(ue,ue,ue,W)}return this._calculate(h.expression.evaluate(new Si(Math.floor(W.zoom-1),W)),h.expression.evaluate(new Si(Math.floor(W.zoom),W)),h.expression.evaluate(new Si(Math.floor(W.zoom+1),W)),W)}}_calculate(h,W,X,ie){return ie.zoom>ie.zoomHistory.lastIntegerZoom?{from:h,to:W}:{from:X,to:W}}interpolate(h){return h}}class Lo{constructor(h){this.specification=h}possiblyEvaluate(h,W,X,ie){return!!h.expression.evaluate(W,null,{},X,ie)}interpolate(){return!1}}class pn{constructor(h){this.properties=h,this.defaultPropertyValues={},this.defaultTransitionablePropertyValues={},this.defaultTransitioningPropertyValues={},this.defaultPossiblyEvaluatedValues={},this.overridableProperties=[];for(const W in h){const X=h[W];X.specification.overridable&&this.overridableProperties.push(W);const ie=this.defaultPropertyValues[W]=new ko(X,void 0),ue=this.defaultTransitionablePropertyValues[W]=new Rs(X);this.defaultTransitioningPropertyValues[W]=ue.untransitioned(),this.defaultPossiblyEvaluatedValues[W]=ie.possiblyEvaluate({})}}}Tr("DataDrivenProperty",Vr),Tr("DataConstantProperty",Or),Tr("CrossFadedDataDrivenProperty",Ps),Tr("CrossFadedProperty",Mu),Tr("ColorRampProperty",Lo);const Wl="-transition";class Qi extends Nt{constructor(h,W){if(super(),this.id=h.id,this.type=h.type,this._featureFilter={filter:()=>!0,needGeometry:!1,getGlobalStateRefs:()=>new Set},h.type!=="custom"&&(this.metadata=h.metadata,this.minzoom=h.minzoom,this.maxzoom=h.maxzoom,h.type!=="background"&&(this.source=h.source,this.sourceLayer=h["source-layer"],this.filter=h.filter,this._featureFilter=oa(h.filter)),W.layout&&(this._unevaluatedLayout=new Bc(W.layout)),W.paint)){this._transitionablePaint=new Cu(W.paint);for(const X in h.paint)this.setPaintProperty(X,h.paint[X],{validate:!1});for(const X in h.layout)this.setLayoutProperty(X,h.layout[X],{validate:!1});this._transitioningPaint=this._transitionablePaint.untransitioned(),this.paint=new As(W.paint)}}setFilter(h){this.filter=h,this._featureFilter=oa(h)}getCrossfadeParameters(){return this._crossfadeParameters}getLayoutProperty(h){return h==="visibility"?this.visibility:this._unevaluatedLayout.getValue(h)}getLayoutAffectingGlobalStateRefs(){const h=new Set;if(this._unevaluatedLayout)for(const W in this._unevaluatedLayout._values){const X=this._unevaluatedLayout._values[W];for(const ie of X.getGlobalStateRefs())h.add(ie)}for(const W of this._featureFilter.getGlobalStateRefs())h.add(W);return h}setLayoutProperty(h,W,X={}){W!=null&&this._validate(Eu,`layers.${this.id}.layout.${h}`,h,W,X)||(h!=="visibility"?this._unevaluatedLayout.setValue(h,W):this.visibility=W)}getPaintProperty(h){return h.endsWith(Wl)?this._transitionablePaint.getTransition(h.slice(0,-11)):this._transitionablePaint.getValue(h)}setPaintProperty(h,W,X={}){if(W!=null&&this._validate(Dc,`layers.${this.id}.paint.${h}`,h,W,X))return!1;if(h.endsWith(Wl))return this._transitionablePaint.setTransition(h.slice(0,-11),W||void 0),!1;{const ie=this._transitionablePaint._values[h],ue=ie.property.specification["property-type"]==="cross-faded-data-driven",ce=ie.value.isDataDriven(),fe=ie.value;this._transitionablePaint.setValue(h,W),this._handleSpecialPaintPropertyUpdate(h);const ye=this._transitionablePaint._values[h].value;return ye.isDataDriven()||ce||ue||this._handleOverridablePaintPropertyUpdate(h,fe,ye)}}_handleSpecialPaintPropertyUpdate(h){}_handleOverridablePaintPropertyUpdate(h,W,X){return!1}isHidden(h){return!!(this.minzoom&&h<this.minzoom)||!!(this.maxzoom&&h>=this.maxzoom)||this.visibility==="none"}updateTransitions(h){this._transitioningPaint=this._transitionablePaint.transitioned(h,this._transitioningPaint)}hasTransition(){return this._transitioningPaint.hasTransition()}recalculate(h,W){h.getCrossfadeParameters&&(this._crossfadeParameters=h.getCrossfadeParameters()),this._unevaluatedLayout&&(this.layout=this._unevaluatedLayout.possiblyEvaluate(h,void 0,W)),this.paint=this._transitioningPaint.possiblyEvaluate(h,void 0,W)}serialize(){const h={id:this.id,type:this.type,source:this.source,"source-layer":this.sourceLayer,metadata:this.metadata,minzoom:this.minzoom,maxzoom:this.maxzoom,filter:this.filter,layout:this._unevaluatedLayout&&this._unevaluatedLayout.serialize(),paint:this._transitionablePaint&&this._transitionablePaint.serialize()};return this.visibility&&(h.layout=h.layout||{},h.layout.visibility=this.visibility),Wr(h,(W,X)=>!(W===void 0||X==="layout"&&!Object.keys(W).length||X==="paint"&&!Object.keys(W).length))}_validate(h,W,X,ie,ue={}){return(!ue||ue.validate!==!1)&&Co(this,h.call(eo,{key:W,layerType:this.type,objectKey:X,value:ie,styleSpec:St,style:{glyphs:!0,sprite:!0}}))}is3D(){return!1}isTileClipped(){return!1}hasOffscreenPass(){return!1}resize(){}isStateDependent(){for(const h in this.paint._values){const W=this.paint.get(h);if(W instanceof Vn&&$a(W.property.specification)&&(W.value.kind==="source"||W.value.kind==="composite")&&W.value.isStateDependent)return!0}return!1}}const Hl={Int8:Int8Array,Uint8:Uint8Array,Int16:Int16Array,Uint16:Uint16Array,Int32:Int32Array,Uint32:Uint32Array,Float32:Float32Array};class Ta{constructor(h,W){this._structArray=h,this._pos1=W*this.size,this._pos2=this._pos1/2,this._pos4=this._pos1/4,this._pos8=this._pos1/8}}class Ii{constructor(){this.isTransferred=!1,this.capacity=-1,this.resize(0)}static serialize(h,W){return h._trim(),W&&(h.isTransferred=!0,W.push(h.arrayBuffer)),{length:h.length,arrayBuffer:h.arrayBuffer}}static deserialize(h){const W=Object.create(this.prototype);return W.arrayBuffer=h.arrayBuffer,W.length=h.length,W.capacity=h.arrayBuffer.byteLength/W.bytesPerElement,W._refreshViews(),W}_trim(){this.length!==this.capacity&&(this.capacity=this.length,this.arrayBuffer=this.arrayBuffer.slice(0,this.length*this.bytesPerElement),this._refreshViews())}clear(){this.length=0}resize(h){this.reserve(h),this.length=h}reserve(h){if(h>this.capacity){this.capacity=Math.max(h,Math.floor(5*this.capacity),128),this.arrayBuffer=new ArrayBuffer(this.capacity*this.bytesPerElement);const W=this.uint8;this._refreshViews(),W&&this.uint8.set(W)}}_refreshViews(){throw new Error("_refreshViews() must be implemented by each concrete StructArray layout")}}function Di(H,h=1){let W=0,X=0;return{members:H.map(ie=>{const ue=Hl[ie.type].BYTES_PER_ELEMENT,ce=W=Zl(W,Math.max(h,ue)),fe=ie.components||1;return X=Math.max(X,ue),W+=ue*fe,{name:ie.name,type:ie.type,components:fe,offset:ce}}),size:Zl(W,Math.max(X,h)),alignment:h}}function Zl(H,h){return Math.ceil(H/h)*h}class la extends Ii{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(h,W){const X=this.length;return this.resize(X+1),this.emplace(X,h,W)}emplace(h,W,X){const ie=2*h;return this.int16[ie+0]=W,this.int16[ie+1]=X,h}}la.prototype.bytesPerElement=4,Tr("StructArrayLayout2i4",la);class ca extends Ii{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(h,W,X){const ie=this.length;return this.resize(ie+1),this.emplace(ie,h,W,X)}emplace(h,W,X,ie){const ue=3*h;return this.int16[ue+0]=W,this.int16[ue+1]=X,this.int16[ue+2]=ie,h}}ca.prototype.bytesPerElement=6,Tr("StructArrayLayout3i6",ca);class Du extends Ii{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(h,W,X,ie){const ue=this.length;return this.resize(ue+1),this.emplace(ue,h,W,X,ie)}emplace(h,W,X,ie,ue){const ce=4*h;return this.int16[ce+0]=W,this.int16[ce+1]=X,this.int16[ce+2]=ie,this.int16[ce+3]=ue,h}}Du.prototype.bytesPerElement=8,Tr("StructArrayLayout4i8",Du);class Os extends Ii{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(h,W,X,ie,ue,ce){const fe=this.length;return this.resize(fe+1),this.emplace(fe,h,W,X,ie,ue,ce)}emplace(h,W,X,ie,ue,ce,fe){const ye=6*h;return this.int16[ye+0]=W,this.int16[ye+1]=X,this.int16[ye+2]=ie,this.int16[ye+3]=ue,this.int16[ye+4]=ce,this.int16[ye+5]=fe,h}}Os.prototype.bytesPerElement=12,Tr("StructArrayLayout2i4i12",Os);class Ia extends Ii{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(h,W,X,ie,ue,ce){const fe=this.length;return this.resize(fe+1),this.emplace(fe,h,W,X,ie,ue,ce)}emplace(h,W,X,ie,ue,ce,fe){const ye=4*h,be=8*h;return this.int16[ye+0]=W,this.int16[ye+1]=X,this.uint8[be+4]=ie,this.uint8[be+5]=ue,this.uint8[be+6]=ce,this.uint8[be+7]=fe,h}}Ia.prototype.bytesPerElement=8,Tr("StructArrayLayout2i4ub8",Ia);class Bo extends Ii{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(h,W){const X=this.length;return this.resize(X+1),this.emplace(X,h,W)}emplace(h,W,X){const ie=2*h;return this.float32[ie+0]=W,this.float32[ie+1]=X,h}}Bo.prototype.bytesPerElement=8,Tr("StructArrayLayout2f8",Bo);class Fu extends Ii{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(h,W,X,ie,ue,ce,fe,ye,be,we){const Ie=this.length;return this.resize(Ie+1),this.emplace(Ie,h,W,X,ie,ue,ce,fe,ye,be,we)}emplace(h,W,X,ie,ue,ce,fe,ye,be,we,Ie){const Be=10*h;return this.uint16[Be+0]=W,this.uint16[Be+1]=X,this.uint16[Be+2]=ie,this.uint16[Be+3]=ue,this.uint16[Be+4]=ce,this.uint16[Be+5]=fe,this.uint16[Be+6]=ye,this.uint16[Be+7]=be,this.uint16[Be+8]=we,this.uint16[Be+9]=Ie,h}}Fu.prototype.bytesPerElement=20,Tr("StructArrayLayout10ui20",Fu);class Cs extends Ii{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(h,W,X,ie,ue,ce,fe,ye,be,we,Ie,Be){const Ue=this.length;return this.resize(Ue+1),this.emplace(Ue,h,W,X,ie,ue,ce,fe,ye,be,we,Ie,Be)}emplace(h,W,X,ie,ue,ce,fe,ye,be,we,Ie,Be,Ue){const $e=12*h;return this.int16[$e+0]=W,this.int16[$e+1]=X,this.int16[$e+2]=ie,this.int16[$e+3]=ue,this.uint16[$e+4]=ce,this.uint16[$e+5]=fe,this.uint16[$e+6]=ye,this.uint16[$e+7]=be,this.int16[$e+8]=we,this.int16[$e+9]=Ie,this.int16[$e+10]=Be,this.int16[$e+11]=Ue,h}}Cs.prototype.bytesPerElement=24,Tr("StructArrayLayout4i4ui4i24",Cs);class ku extends Ii{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(h,W,X){const ie=this.length;return this.resize(ie+1),this.emplace(ie,h,W,X)}emplace(h,W,X,ie){const ue=3*h;return this.float32[ue+0]=W,this.float32[ue+1]=X,this.float32[ue+2]=ie,h}}ku.prototype.bytesPerElement=12,Tr("StructArrayLayout3f12",ku);class oe extends Ii{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer)}emplaceBack(h){const W=this.length;return this.resize(W+1),this.emplace(W,h)}emplace(h,W){return this.uint32[1*h+0]=W,h}}oe.prototype.bytesPerElement=4,Tr("StructArrayLayout1ul4",oe);class t extends Ii{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(h,W,X,ie,ue,ce,fe,ye,be){const we=this.length;return this.resize(we+1),this.emplace(we,h,W,X,ie,ue,ce,fe,ye,be)}emplace(h,W,X,ie,ue,ce,fe,ye,be,we){const Ie=10*h,Be=5*h;return this.int16[Ie+0]=W,this.int16[Ie+1]=X,this.int16[Ie+2]=ie,this.int16[Ie+3]=ue,this.int16[Ie+4]=ce,this.int16[Ie+5]=fe,this.uint32[Be+3]=ye,this.uint16[Ie+8]=be,this.uint16[Ie+9]=we,h}}t.prototype.bytesPerElement=20,Tr("StructArrayLayout6i1ul2ui20",t);class G extends Ii{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(h,W,X,ie,ue,ce){const fe=this.length;return this.resize(fe+1),this.emplace(fe,h,W,X,ie,ue,ce)}emplace(h,W,X,ie,ue,ce,fe){const ye=6*h;return this.int16[ye+0]=W,this.int16[ye+1]=X,this.int16[ye+2]=ie,this.int16[ye+3]=ue,this.int16[ye+4]=ce,this.int16[ye+5]=fe,h}}G.prototype.bytesPerElement=12,Tr("StructArrayLayout2i2i2i12",G);class J extends Ii{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(h,W,X,ie,ue){const ce=this.length;return this.resize(ce+1),this.emplace(ce,h,W,X,ie,ue)}emplace(h,W,X,ie,ue,ce){const fe=4*h,ye=8*h;return this.float32[fe+0]=W,this.float32[fe+1]=X,this.float32[fe+2]=ie,this.int16[ye+6]=ue,this.int16[ye+7]=ce,h}}J.prototype.bytesPerElement=16,Tr("StructArrayLayout2f1f2i16",J);class te extends Ii{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(h,W,X,ie,ue,ce){const fe=this.length;return this.resize(fe+1),this.emplace(fe,h,W,X,ie,ue,ce)}emplace(h,W,X,ie,ue,ce,fe){const ye=16*h,be=4*h,we=8*h;return this.uint8[ye+0]=W,this.uint8[ye+1]=X,this.float32[be+1]=ie,this.float32[be+2]=ue,this.int16[we+6]=ce,this.int16[we+7]=fe,h}}te.prototype.bytesPerElement=16,Tr("StructArrayLayout2ub2f2i16",te);class se extends Ii{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(h,W,X){const ie=this.length;return this.resize(ie+1),this.emplace(ie,h,W,X)}emplace(h,W,X,ie){const ue=3*h;return this.uint16[ue+0]=W,this.uint16[ue+1]=X,this.uint16[ue+2]=ie,h}}se.prototype.bytesPerElement=6,Tr("StructArrayLayout3ui6",se);class de extends Ii{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(h,W,X,ie,ue,ce,fe,ye,be,we,Ie,Be,Ue,$e,Xe,rt,ct){const Ct=this.length;return this.resize(Ct+1),this.emplace(Ct,h,W,X,ie,ue,ce,fe,ye,be,we,Ie,Be,Ue,$e,Xe,rt,ct)}emplace(h,W,X,ie,ue,ce,fe,ye,be,we,Ie,Be,Ue,$e,Xe,rt,ct,Ct){const wt=24*h,Ne=12*h,tt=48*h;return this.int16[wt+0]=W,this.int16[wt+1]=X,this.uint16[wt+2]=ie,this.uint16[wt+3]=ue,this.uint32[Ne+2]=ce,this.uint32[Ne+3]=fe,this.uint32[Ne+4]=ye,this.uint16[wt+10]=be,this.uint16[wt+11]=we,this.uint16[wt+12]=Ie,this.float32[Ne+7]=Be,this.float32[Ne+8]=Ue,this.uint8[tt+36]=$e,this.uint8[tt+37]=Xe,this.uint8[tt+38]=rt,this.uint32[Ne+10]=ct,this.int16[wt+22]=Ct,h}}de.prototype.bytesPerElement=48,Tr("StructArrayLayout2i2ui3ul3ui2f3ub1ul1i48",de);class _e extends Ii{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(h,W,X,ie,ue,ce,fe,ye,be,we,Ie,Be,Ue,$e,Xe,rt,ct,Ct,wt,Ne,tt,Et,Ut,Jt,Wt,Kt,ur,tr){const dr=this.length;return this.resize(dr+1),this.emplace(dr,h,W,X,ie,ue,ce,fe,ye,be,we,Ie,Be,Ue,$e,Xe,rt,ct,Ct,wt,Ne,tt,Et,Ut,Jt,Wt,Kt,ur,tr)}emplace(h,W,X,ie,ue,ce,fe,ye,be,we,Ie,Be,Ue,$e,Xe,rt,ct,Ct,wt,Ne,tt,Et,Ut,Jt,Wt,Kt,ur,tr,dr){const Xt=32*h,Pr=16*h;return this.int16[Xt+0]=W,this.int16[Xt+1]=X,this.int16[Xt+2]=ie,this.int16[Xt+3]=ue,this.int16[Xt+4]=ce,this.int16[Xt+5]=fe,this.int16[Xt+6]=ye,this.int16[Xt+7]=be,this.uint16[Xt+8]=we,this.uint16[Xt+9]=Ie,this.uint16[Xt+10]=Be,this.uint16[Xt+11]=Ue,this.uint16[Xt+12]=$e,this.uint16[Xt+13]=Xe,this.uint16[Xt+14]=rt,this.uint16[Xt+15]=ct,this.uint16[Xt+16]=Ct,this.uint16[Xt+17]=wt,this.uint16[Xt+18]=Ne,this.uint16[Xt+19]=tt,this.uint16[Xt+20]=Et,this.uint16[Xt+21]=Ut,this.uint16[Xt+22]=Jt,this.uint32[Pr+12]=Wt,this.float32[Pr+13]=Kt,this.float32[Pr+14]=ur,this.uint16[Xt+30]=tr,this.uint16[Xt+31]=dr,h}}_e.prototype.bytesPerElement=64,Tr("StructArrayLayout8i15ui1ul2f2ui64",_e);class ge extends Ii{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(h){const W=this.length;return this.resize(W+1),this.emplace(W,h)}emplace(h,W){return this.float32[1*h+0]=W,h}}ge.prototype.bytesPerElement=4,Tr("StructArrayLayout1f4",ge);class xe extends Ii{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(h,W,X){const ie=this.length;return this.resize(ie+1),this.emplace(ie,h,W,X)}emplace(h,W,X,ie){const ue=3*h;return this.uint16[6*h+0]=W,this.float32[ue+1]=X,this.float32[ue+2]=ie,h}}xe.prototype.bytesPerElement=12,Tr("StructArrayLayout1ui2f12",xe);class Se extends Ii{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(h,W,X){const ie=this.length;return this.resize(ie+1),this.emplace(ie,h,W,X)}emplace(h,W,X,ie){const ue=4*h;return this.uint32[2*h+0]=W,this.uint16[ue+2]=X,this.uint16[ue+3]=ie,h}}Se.prototype.bytesPerElement=8,Tr("StructArrayLayout1ul2ui8",Se);class Oe extends Ii{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(h,W){const X=this.length;return this.resize(X+1),this.emplace(X,h,W)}emplace(h,W,X){const ie=2*h;return this.uint16[ie+0]=W,this.uint16[ie+1]=X,h}}Oe.prototype.bytesPerElement=4,Tr("StructArrayLayout2ui4",Oe);class Ae extends Ii{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(h){const W=this.length;return this.resize(W+1),this.emplace(W,h)}emplace(h,W){return this.uint16[1*h+0]=W,h}}Ae.prototype.bytesPerElement=2,Tr("StructArrayLayout1ui2",Ae);class je extends Ii{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(h,W,X,ie){const ue=this.length;return this.resize(ue+1),this.emplace(ue,h,W,X,ie)}emplace(h,W,X,ie,ue){const ce=4*h;return this.float32[ce+0]=W,this.float32[ce+1]=X,this.float32[ce+2]=ie,this.float32[ce+3]=ue,h}}je.prototype.bytesPerElement=16,Tr("StructArrayLayout4f16",je);class Ye extends Ta{get anchorPointX(){return this._structArray.int16[this._pos2+0]}get anchorPointY(){return this._structArray.int16[this._pos2+1]}get x1(){return this._structArray.int16[this._pos2+2]}get y1(){return this._structArray.int16[this._pos2+3]}get x2(){return this._structArray.int16[this._pos2+4]}get y2(){return this._structArray.int16[this._pos2+5]}get featureIndex(){return this._structArray.uint32[this._pos4+3]}get sourceLayerIndex(){return this._structArray.uint16[this._pos2+8]}get bucketIndex(){return this._structArray.uint16[this._pos2+9]}get anchorPoint(){return new ve(this.anchorPointX,this.anchorPointY)}}Ye.prototype.size=20;class at extends t{get(h){return new Ye(this,h)}}Tr("CollisionBoxArray",at);class nt extends Ta{get anchorX(){return this._structArray.int16[this._pos2+0]}get anchorY(){return this._structArray.int16[this._pos2+1]}get glyphStartIndex(){return this._structArray.uint16[this._pos2+2]}get numGlyphs(){return this._structArray.uint16[this._pos2+3]}get vertexStartIndex(){return this._structArray.uint32[this._pos4+2]}get lineStartIndex(){return this._structArray.uint32[this._pos4+3]}get lineLength(){return this._structArray.uint32[this._pos4+4]}get segment(){return this._structArray.uint16[this._pos2+10]}get lowerSize(){return this._structArray.uint16[this._pos2+11]}get upperSize(){return this._structArray.uint16[this._pos2+12]}get lineOffsetX(){return this._structArray.float32[this._pos4+7]}get lineOffsetY(){return this._structArray.float32[this._pos4+8]}get writingMode(){return this._structArray.uint8[this._pos1+36]}get placedOrientation(){return this._structArray.uint8[this._pos1+37]}set placedOrientation(h){this._structArray.uint8[this._pos1+37]=h}get hidden(){return this._structArray.uint8[this._pos1+38]}set hidden(h){this._structArray.uint8[this._pos1+38]=h}get crossTileID(){return this._structArray.uint32[this._pos4+10]}set crossTileID(h){this._structArray.uint32[this._pos4+10]=h}get associatedIconIndex(){return this._structArray.int16[this._pos2+22]}}nt.prototype.size=48;class ot extends de{get(h){return new nt(this,h)}}Tr("PlacedSymbolArray",ot);class ht extends Ta{get anchorX(){return this._structArray.int16[this._pos2+0]}get anchorY(){return this._structArray.int16[this._pos2+1]}get rightJustifiedTextSymbolIndex(){return this._structArray.int16[this._pos2+2]}get centerJustifiedTextSymbolIndex(){return this._structArray.int16[this._pos2+3]}get leftJustifiedTextSymbolIndex(){return this._structArray.int16[this._pos2+4]}get verticalPlacedTextSymbolIndex(){return this._structArray.int16[this._pos2+5]}get placedIconSymbolIndex(){return this._structArray.int16[this._pos2+6]}get verticalPlacedIconSymbolIndex(){return this._structArray.int16[this._pos2+7]}get key(){return this._structArray.uint16[this._pos2+8]}get textBoxStartIndex(){return this._structArray.uint16[this._pos2+9]}get textBoxEndIndex(){return this._structArray.uint16[this._pos2+10]}get verticalTextBoxStartIndex(){return this._structArray.uint16[this._pos2+11]}get verticalTextBoxEndIndex(){return this._structArray.uint16[this._pos2+12]}get iconBoxStartIndex(){return this._structArray.uint16[this._pos2+13]}get iconBoxEndIndex(){return this._structArray.uint16[this._pos2+14]}get verticalIconBoxStartIndex(){return this._structArray.uint16[this._pos2+15]}get verticalIconBoxEndIndex(){return this._structArray.uint16[this._pos2+16]}get featureIndex(){return this._structArray.uint16[this._pos2+17]}get numHorizontalGlyphVertices(){return this._structArray.uint16[this._pos2+18]}get numVerticalGlyphVertices(){return this._structArray.uint16[this._pos2+19]}get numIconVertices(){return this._structArray.uint16[this._pos2+20]}get numVerticalIconVertices(){return this._structArray.uint16[this._pos2+21]}get useRuntimeCollisionCircles(){return this._structArray.uint16[this._pos2+22]}get crossTileID(){return this._structArray.uint32[this._pos4+12]}set crossTileID(h){this._structArray.uint32[this._pos4+12]=h}get textBoxScale(){return this._structArray.float32[this._pos4+13]}get collisionCircleDiameter(){return this._structArray.float32[this._pos4+14]}get textAnchorOffsetStartIndex(){return this._structArray.uint16[this._pos2+30]}get textAnchorOffsetEndIndex(){return this._structArray.uint16[this._pos2+31]}}ht.prototype.size=64;class xt extends _e{get(h){return new ht(this,h)}}Tr("SymbolInstanceArray",xt);class mt extends ge{getoffsetX(h){return this.float32[1*h+0]}}Tr("GlyphOffsetArray",mt);class Tt extends ca{getx(h){return this.int16[3*h+0]}gety(h){return this.int16[3*h+1]}gettileUnitDistanceFromAnchor(h){return this.int16[3*h+2]}}Tr("SymbolLineVertexArray",Tt);class Pt extends Ta{get textAnchor(){return this._structArray.uint16[this._pos2+0]}get textOffset0(){return this._structArray.float32[this._pos4+1]}get textOffset1(){return this._structArray.float32[this._pos4+2]}}Pt.prototype.size=12;class vt extends xe{get(h){return new Pt(this,h)}}Tr("TextAnchorOffsetArray",vt);class kt extends Ta{get featureIndex(){return this._structArray.uint32[this._pos4+0]}get sourceLayerIndex(){return this._structArray.uint16[this._pos2+2]}get bucketIndex(){return this._structArray.uint16[this._pos2+3]}}kt.prototype.size=8;class Vt extends Se{get(h){return new kt(this,h)}}Tr("FeatureIndexArray",Vt);class jt extends la{}class zt extends la{}class $t extends la{}class mr extends Os{}class _r extends Ia{}class er extends Bo{}class Ar extends Fu{}class ti extends Cs{}class di extends ku{}class Ri extends oe{}class _i extends G{}class Ai extends te{}class gi extends se{}class mi extends Oe{}const vi=Di([{name:"a_pos",components:2,type:"Int16"}],4),{members:en}=vi;class li{constructor(h=[]){this._forceNewSegmentOnNextPrepare=!1,this.segments=h}prepareSegment(h,W,X,ie){const ue=this.segments[this.segments.length-1];return h>li.MAX_VERTEX_ARRAY_LENGTH&&br(`Max vertices per segment is ${li.MAX_VERTEX_ARRAY_LENGTH}: bucket requested ${h}. Consider using the \`fillLargeMeshArrays\` function if you require meshes with more than ${li.MAX_VERTEX_ARRAY_LENGTH} vertices.`),this._forceNewSegmentOnNextPrepare||!ue||ue.vertexLength+h>li.MAX_VERTEX_ARRAY_LENGTH||ue.sortKey!==ie?this.createNewSegment(W,X,ie):ue}createNewSegment(h,W,X){const ie={vertexOffset:h.length,primitiveOffset:W.length,vertexLength:0,primitiveLength:0,vaos:{}};return X!==void 0&&(ie.sortKey=X),this._forceNewSegmentOnNextPrepare=!1,this.segments.push(ie),ie}getOrCreateLatestSegment(h,W,X){return this.prepareSegment(0,h,W,X)}forceNewSegmentOnNextPrepare(){this._forceNewSegmentOnNextPrepare=!0}get(){return this.segments}destroy(){for(const h of this.segments)for(const W in h.vaos)h.vaos[W].destroy()}static simpleSegment(h,W,X,ie){return new li([{vertexOffset:h,primitiveOffset:W,vertexLength:X,primitiveLength:ie,vaos:{},sortKey:0}])}}function Hi(H,h){return 256*(H=or(Math.floor(H),0,255))+or(Math.floor(h),0,255)}li.MAX_VERTEX_ARRAY_LENGTH=Math.pow(2,16)-1,Tr("SegmentVector",li);const tn=Di([{name:"a_pattern_from",components:4,type:"Uint16"},{name:"a_pattern_to",components:4,type:"Uint16"},{name:"a_pixel_ratio_from",components:1,type:"Uint16"},{name:"a_pixel_ratio_to",components:1,type:"Uint16"}]);var ha,da,fa,$n={exports:{}},jo={exports:{}},No={exports:{}},io=function(){if(fa)return $n.exports;fa=1;var H=(ha||(ha=1,jo.exports=function(W,X){var ie,ue,ce,fe,ye,be,we,Ie;for(ue=W.length-(ie=3&W.length),ce=X,ye=3432918353,be=461845907,Ie=0;Ie<ue;)we=255&W.charCodeAt(Ie)|(255&W.charCodeAt(++Ie))<<8|(255&W.charCodeAt(++Ie))<<16|(255&W.charCodeAt(++Ie))<<24,++Ie,ce=27492+(65535&(fe=5*(65535&(ce=(ce^=we=(65535&(we=(we=(65535&we)*ye+(((we>>>16)*ye&65535)<<16)&4294967295)<<15|we>>>17))*be+(((we>>>16)*be&65535)<<16)&4294967295)<<13|ce>>>19))+((5*(ce>>>16)&65535)<<16)&4294967295))+((58964+(fe>>>16)&65535)<<16);switch(we=0,ie){case 3:we^=(255&W.charCodeAt(Ie+2))<<16;case 2:we^=(255&W.charCodeAt(Ie+1))<<8;case 1:ce^=we=(65535&(we=(we=(65535&(we^=255&W.charCodeAt(Ie)))*ye+(((we>>>16)*ye&65535)<<16)&4294967295)<<15|we>>>17))*be+(((we>>>16)*be&65535)<<16)&4294967295}return ce^=W.length,ce=2246822507*(65535&(ce^=ce>>>16))+((2246822507*(ce>>>16)&65535)<<16)&4294967295,ce=3266489909*(65535&(ce^=ce>>>13))+((3266489909*(ce>>>16)&65535)<<16)&4294967295,(ce^=ce>>>16)>>>0}),jo.exports),h=(da||(da=1,No.exports=function(W,X){for(var ie,ue=W.length,ce=X^ue,fe=0;ue>=4;)ie=1540483477*(65535&(ie=255&W.charCodeAt(fe)|(255&W.charCodeAt(++fe))<<8|(255&W.charCodeAt(++fe))<<16|(255&W.charCodeAt(++fe))<<24))+((1540483477*(ie>>>16)&65535)<<16),ce=1540483477*(65535&ce)+((1540483477*(ce>>>16)&65535)<<16)^(ie=1540483477*(65535&(ie^=ie>>>24))+((1540483477*(ie>>>16)&65535)<<16)),ue-=4,++fe;switch(ue){case 3:ce^=(255&W.charCodeAt(fe+2))<<16;case 2:ce^=(255&W.charCodeAt(fe+1))<<8;case 1:ce=1540483477*(65535&(ce^=255&W.charCodeAt(fe)))+((1540483477*(ce>>>16)&65535)<<16)}return ce=1540483477*(65535&(ce^=ce>>>13))+((1540483477*(ce>>>16)&65535)<<16),(ce^=ce>>>15)>>>0}),No.exports);return $n.exports=H,$n.exports.murmur3=H,$n.exports.murmur2=h,$n.exports}(),wn=U(io);class Fn{constructor(){this.ids=[],this.positions=[],this.indexed=!1}add(h,W,X,ie){this.ids.push(pa(h)),this.positions.push(W,X,ie)}getPositions(h){if(!this.indexed)throw new Error("Trying to get index, but feature positions are not indexed");const W=pa(h);let X=0,ie=this.ids.length-1;for(;X<ie;){const ce=X+ie>>1;this.ids[ce]>=W?ie=ce:X=ce+1}const ue=[];for(;this.ids[X]===W;)ue.push({index:this.positions[3*X],start:this.positions[3*X+1],end:this.positions[3*X+2]}),X++;return ue}static serialize(h,W){const X=new Float64Array(h.ids),ie=new Uint32Array(h.positions);return Ra(X,ie,0,X.length-1),W&&W.push(X.buffer,ie.buffer),{ids:X,positions:ie}}static deserialize(h){const W=new Fn;return W.ids=h.ids,W.positions=h.positions,W.indexed=!0,W}}function pa(H){const h=+H;return!isNaN(h)&&h<=Number.MAX_SAFE_INTEGER?h:wn(String(H))}function Ra(H,h,W,X){for(;W<X;){const ie=H[W+X>>1];let ue=W-1,ce=X+1;for(;;){do ue++;while(H[ue]<ie);do ce--;while(H[ce]>ie);if(ue>=ce)break;ki(H,ue,ce),ki(h,3*ue,3*ce),ki(h,3*ue+1,3*ce+1),ki(h,3*ue+2,3*ce+2)}ce-W<X-ce?(Ra(H,h,W,ce),W=ce+1):(Ra(H,h,ce+1,X),X=ce)}}function ki(H,h,W){const X=H[h];H[h]=H[W],H[W]=X}Tr("FeaturePositionMap",Fn);class xi{constructor(h,W){this.gl=h.gl,this.location=W}}class _n extends xi{constructor(h,W){super(h,W),this.current=0}set(h){this.current!==h&&(this.current=h,this.gl.uniform1f(this.location,h))}}class zi extends xi{constructor(h,W){super(h,W),this.current=[0,0,0,0]}set(h){h[0]===this.current[0]&&h[1]===this.current[1]&&h[2]===this.current[2]&&h[3]===this.current[3]||(this.current=h,this.gl.uniform4f(this.location,h[0],h[1],h[2],h[3]))}}class Kl extends xi{constructor(h,W){super(h,W),this.current=ni.transparent}set(h){h.r===this.current.r&&h.g===this.current.g&&h.b===this.current.b&&h.a===this.current.a||(this.current=h,this.gl.uniform4f(this.location,h.r,h.g,h.b,h.a))}}const jc=new Float32Array(16);function Lu(H){return[Hi(255*H.r,255*H.g),Hi(255*H.b,255*H.a)]}class zo{constructor(h,W,X){this.value=h,this.uniformNames=W.map(ie=>`u_${ie}`),this.type=X}setUniform(h,W,X){h.set(X.constantOr(this.value))}getBinding(h,W,X){return this.type==="color"?new Kl(h,W):new _n(h,W)}}class no{constructor(h,W){this.uniformNames=W.map(X=>`u_${X}`),this.patternFrom=null,this.patternTo=null,this.pixelRatioFrom=1,this.pixelRatioTo=1}setConstantPatternPositions(h,W){this.pixelRatioFrom=W.pixelRatio,this.pixelRatioTo=h.pixelRatio,this.patternFrom=W.tlbr,this.patternTo=h.tlbr}setUniform(h,W,X,ie){const ue=ie==="u_pattern_to"?this.patternTo:ie==="u_pattern_from"?this.patternFrom:ie==="u_pixel_ratio_to"?this.pixelRatioTo:ie==="u_pixel_ratio_from"?this.pixelRatioFrom:null;ue&&h.set(ue)}getBinding(h,W,X){return X.substr(0,9)==="u_pattern"?new zi(h,W):new _n(h,W)}}class Yn{constructor(h,W,X,ie){this.expression=h,this.type=X,this.maxValue=0,this.paintVertexAttributes=W.map(ue=>({name:`a_${ue}`,type:"Float32",components:X==="color"?2:1,offset:0})),this.paintVertexArray=new ie}populatePaintArray(h,W,X,ie,ue){const ce=this.paintVertexArray.length,fe=this.expression.evaluate(new Si(0),W,{},ie,[],ue);this.paintVertexArray.resize(h),this._setPaintValue(ce,h,fe)}updatePaintArray(h,W,X,ie){const ue=this.expression.evaluate({zoom:0},X,ie);this._setPaintValue(h,W,ue)}_setPaintValue(h,W,X){if(this.type==="color"){const ie=Lu(X);for(let ue=h;ue<W;ue++)this.paintVertexArray.emplace(ue,ie[0],ie[1])}else{for(let ie=h;ie<W;ie++)this.paintVertexArray.emplace(ie,X);this.maxValue=Math.max(this.maxValue,Math.abs(X))}}upload(h){this.paintVertexArray&&this.paintVertexArray.arrayBuffer&&(this.paintVertexBuffer&&this.paintVertexBuffer.buffer?this.paintVertexBuffer.updateData(this.paintVertexArray):this.paintVertexBuffer=h.createVertexBuffer(this.paintVertexArray,this.paintVertexAttributes,this.expression.isStateDependent))}destroy(){this.paintVertexBuffer&&this.paintVertexBuffer.destroy()}}class rn{constructor(h,W,X,ie,ue,ce){this.expression=h,this.uniformNames=W.map(fe=>`u_${fe}_t`),this.type=X,this.useIntegerZoom=ie,this.zoom=ue,this.maxValue=0,this.paintVertexAttributes=W.map(fe=>({name:`a_${fe}`,type:"Float32",components:X==="color"?4:2,offset:0})),this.paintVertexArray=new ce}populatePaintArray(h,W,X,ie,ue){const ce=this.expression.evaluate(new Si(this.zoom),W,{},ie,[],ue),fe=this.expression.evaluate(new Si(this.zoom+1),W,{},ie,[],ue),ye=this.paintVertexArray.length;this.paintVertexArray.resize(h),this._setPaintValue(ye,h,ce,fe)}updatePaintArray(h,W,X,ie){const ue=this.expression.evaluate({zoom:this.zoom},X,ie),ce=this.expression.evaluate({zoom:this.zoom+1},X,ie);this._setPaintValue(h,W,ue,ce)}_setPaintValue(h,W,X,ie){if(this.type==="color"){const ue=Lu(X),ce=Lu(ie);for(let fe=h;fe<W;fe++)this.paintVertexArray.emplace(fe,ue[0],ue[1],ce[0],ce[1])}else{for(let ue=h;ue<W;ue++)this.paintVertexArray.emplace(ue,X,ie);this.maxValue=Math.max(this.maxValue,Math.abs(X),Math.abs(ie))}}upload(h){this.paintVertexArray&&this.paintVertexArray.arrayBuffer&&(this.paintVertexBuffer&&this.paintVertexBuffer.buffer?this.paintVertexBuffer.updateData(this.paintVertexArray):this.paintVertexBuffer=h.createVertexBuffer(this.paintVertexArray,this.paintVertexAttributes,this.expression.isStateDependent))}destroy(){this.paintVertexBuffer&&this.paintVertexBuffer.destroy()}setUniform(h,W){const X=this.useIntegerZoom?Math.floor(W.zoom):W.zoom,ie=or(this.expression.interpolationFactor(X,this.zoom,this.zoom+1),0,1);h.set(ie)}getBinding(h,W,X){return new _n(h,W)}}class Xn{constructor(h,W,X,ie,ue,ce){this.expression=h,this.type=W,this.useIntegerZoom=X,this.zoom=ie,this.layerId=ce,this.zoomInPaintVertexArray=new ue,this.zoomOutPaintVertexArray=new ue}populatePaintArray(h,W,X){const ie=this.zoomInPaintVertexArray.length;this.zoomInPaintVertexArray.resize(h),this.zoomOutPaintVertexArray.resize(h),this._setPaintValues(ie,h,W.patterns&&W.patterns[this.layerId],X)}updatePaintArray(h,W,X,ie,ue){this._setPaintValues(h,W,X.patterns&&X.patterns[this.layerId],ue)}_setPaintValues(h,W,X,ie){if(!ie||!X)return;const{min:ue,mid:ce,max:fe}=X,ye=ie[ue],be=ie[ce],we=ie[fe];if(ye&&be&&we)for(let Ie=h;Ie<W;Ie++)this.zoomInPaintVertexArray.emplace(Ie,be.tl[0],be.tl[1],be.br[0],be.br[1],ye.tl[0],ye.tl[1],ye.br[0],ye.br[1],be.pixelRatio,ye.pixelRatio),this.zoomOutPaintVertexArray.emplace(Ie,be.tl[0],be.tl[1],be.br[0],be.br[1],we.tl[0],we.tl[1],we.br[0],we.br[1],be.pixelRatio,we.pixelRatio)}upload(h){this.zoomInPaintVertexArray&&this.zoomInPaintVertexArray.arrayBuffer&&this.zoomOutPaintVertexArray&&this.zoomOutPaintVertexArray.arrayBuffer&&(this.zoomInPaintVertexBuffer=h.createVertexBuffer(this.zoomInPaintVertexArray,tn.members,this.expression.isStateDependent),this.zoomOutPaintVertexBuffer=h.createVertexBuffer(this.zoomOutPaintVertexArray,tn.members,this.expression.isStateDependent))}destroy(){this.zoomOutPaintVertexBuffer&&this.zoomOutPaintVertexBuffer.destroy(),this.zoomInPaintVertexBuffer&&this.zoomInPaintVertexBuffer.destroy()}}class Bu{constructor(h,W,X){this.binders={},this._buffers=[];const ie=[];for(const ue in h.paint._values){if(!X(ue))continue;const ce=h.paint.get(ue);if(!(ce instanceof Vn&&$a(ce.property.specification)))continue;const fe=ju(ue,h.type),ye=ce.value,be=ce.property.specification.type,we=ce.property.useIntegerZoom,Ie=ce.property.specification["property-type"],Be=Ie==="cross-faded"||Ie==="cross-faded-data-driven";if(ye.kind==="constant")this.binders[ue]=Be?new no(ye.value,fe):new zo(ye.value,fe,be),ie.push(`/u_${ue}`);else if(ye.kind==="source"||Be){const Ue=Nu(ue,be,"source");this.binders[ue]=Be?new Xn(ye,be,we,W,Ue,h.id):new Yn(ye,fe,be,Ue),ie.push(`/a_${ue}`)}else{const Ue=Nu(ue,be,"composite");this.binders[ue]=new rn(ye,fe,be,we,W,Ue),ie.push(`/z_${ue}`)}}this.cacheKey=ie.sort().join("")}getMaxValue(h){const W=this.binders[h];return W instanceof Yn||W instanceof rn?W.maxValue:0}populatePaintArrays(h,W,X,ie,ue){for(const ce in this.binders){const fe=this.binders[ce];(fe instanceof Yn||fe instanceof rn||fe instanceof Xn)&&fe.populatePaintArray(h,W,X,ie,ue)}}setConstantPatternPositions(h,W){for(const X in this.binders){const ie=this.binders[X];ie instanceof no&&ie.setConstantPatternPositions(h,W)}}updatePaintArrays(h,W,X,ie,ue){let ce=!1;for(const fe in h){const ye=W.getPositions(fe);for(const be of ye){const we=X.feature(be.index);for(const Ie in this.binders){const Be=this.binders[Ie];if((Be instanceof Yn||Be instanceof rn||Be instanceof Xn)&&Be.expression.isStateDependent===!0){const Ue=ie.paint.get(Ie);Be.expression=Ue.value,Be.updatePaintArray(be.start,be.end,we,h[fe],ue),ce=!0}}}}return ce}defines(){const h=[];for(const W in this.binders){const X=this.binders[W];(X instanceof zo||X instanceof no)&&h.push(...X.uniformNames.map(ie=>`#define HAS_UNIFORM_${ie}`))}return h}getBinderAttributes(){const h=[];for(const W in this.binders){const X=this.binders[W];if(X instanceof Yn||X instanceof rn)for(let ie=0;ie<X.paintVertexAttributes.length;ie++)h.push(X.paintVertexAttributes[ie].name);else if(X instanceof Xn)for(let ie=0;ie<tn.members.length;ie++)h.push(tn.members[ie].name)}return h}getBinderUniforms(){const h=[];for(const W in this.binders){const X=this.binders[W];if(X instanceof zo||X instanceof no||X instanceof rn)for(const ie of X.uniformNames)h.push(ie)}return h}getPaintVertexBuffers(){return this._buffers}getUniforms(h,W){const X=[];for(const ie in this.binders){const ue=this.binders[ie];if(ue instanceof zo||ue instanceof no||ue instanceof rn){for(const ce of ue.uniformNames)if(W[ce]){const fe=ue.getBinding(h,W[ce],ce);X.push({name:ce,property:ie,binding:fe})}}}return X}setUniforms(h,W,X,ie){for(const{name:ue,property:ce,binding:fe}of W)this.binders[ce].setUniform(fe,ie,X.get(ce),ue)}updatePaintBuffers(h){this._buffers=[];for(const W in this.binders){const X=this.binders[W];if(h&&X instanceof Xn){const ie=h.fromScale===2?X.zoomInPaintVertexBuffer:X.zoomOutPaintVertexBuffer;ie&&this._buffers.push(ie)}else(X instanceof Yn||X instanceof rn)&&X.paintVertexBuffer&&this._buffers.push(X.paintVertexBuffer)}}upload(h){for(const W in this.binders){const X=this.binders[W];(X instanceof Yn||X instanceof rn||X instanceof Xn)&&X.upload(h)}this.updatePaintBuffers()}destroy(){for(const h in this.binders){const W=this.binders[h];(W instanceof Yn||W instanceof rn||W instanceof Xn)&&W.destroy()}}}class _a{constructor(h,W,X=()=>!0){this.programConfigurations={};for(const ie of h)this.programConfigurations[ie.id]=new Bu(ie,W,X);this.needsUpload=!1,this._featureMap=new Fn,this._bufferOffset=0}populatePaintArrays(h,W,X,ie,ue,ce){for(const fe in this.programConfigurations)this.programConfigurations[fe].populatePaintArrays(h,W,ie,ue,ce);W.id!==void 0&&this._featureMap.add(W.id,X,this._bufferOffset,h),this._bufferOffset=h,this.needsUpload=!0}updatePaintArrays(h,W,X,ie){for(const ue of X)this.needsUpload=this.programConfigurations[ue.id].updatePaintArrays(h,this._featureMap,W,ue,ie)||this.needsUpload}get(h){return this.programConfigurations[h]}upload(h){if(this.needsUpload){for(const W in this.programConfigurations)this.programConfigurations[W].upload(h);this.needsUpload=!1}}destroy(){for(const h in this.programConfigurations)this.programConfigurations[h].destroy()}}function ju(H,h){return{"text-opacity":["opacity"],"icon-opacity":["opacity"],"text-color":["fill_color"],"icon-color":["fill_color"],"text-halo-color":["halo_color"],"icon-halo-color":["halo_color"],"text-halo-blur":["halo_blur"],"icon-halo-blur":["halo_blur"],"text-halo-width":["halo_width"],"icon-halo-width":["halo_width"],"line-gap-width":["gapwidth"],"line-pattern":["pattern_to","pattern_from","pixel_ratio_to","pixel_ratio_from"],"fill-pattern":["pattern_to","pattern_from","pixel_ratio_to","pixel_ratio_from"],"fill-extrusion-pattern":["pattern_to","pattern_from","pixel_ratio_to","pixel_ratio_from"]}[H]||[H.replace(`${h}-`,"").replace(/-/g,"_")]}function Nu(H,h,W){const X={color:{source:Bo,composite:je},number:{source:ge,composite:Bo}},ie=function(ue){return{"line-pattern":{source:Ar,composite:Ar},"fill-pattern":{source:Ar,composite:Ar},"fill-extrusion-pattern":{source:Ar,composite:Ar}}[ue]}(H);return ie&&ie[W]||X[h][W]}Tr("ConstantBinder",zo),Tr("CrossFadedConstantBinder",no),Tr("SourceExpressionBinder",Yn),Tr("CrossFadedCompositeBinder",Xn),Tr("CompositeExpressionBinder",rn),Tr("ProgramConfiguration",Bu,{omit:["_buffers"]}),Tr("ProgramConfigurationSet",_a);const Uo=Math.pow(2,14)-1,Ah=-Uo-1;function Go(H){const h=Dt/H.extent,W=H.loadGeometry();for(let X=0;X<W.length;X++){const ie=W[X];for(let ue=0;ue<ie.length;ue++){const ce=ie[ue],fe=Math.round(ce.x*h),ye=Math.round(ce.y*h);ce.x=or(fe,Ah,Uo),ce.y=or(ye,Ah,Uo),(fe<ce.x||fe>ce.x+1||ye<ce.y||ye>ce.y+1)&&br("Geometry exceeds allowed extent, reduce your vector tile buffer size")}}return W}function Vo(H,h){return{type:H.type,id:H.id,properties:H.properties,geometry:h?Go(H):[]}}const Ph=-32768;function yf(H,h,W,X,ie){H.emplaceBack(Ph+8*h+X,Ph+8*W+ie)}class Nc{constructor(h){this.zoom=h.zoom,this.globalState=h.globalState,this.overscaling=h.overscaling,this.layers=h.layers,this.layerIds=this.layers.map(W=>W.id),this.index=h.index,this.hasPattern=!1,this.layoutVertexArray=new zt,this.indexArray=new gi,this.segments=new li,this.programConfigurations=new _a(h.layers,h.zoom),this.stateDependentLayerIds=this.layers.filter(W=>W.isStateDependent()).map(W=>W.id)}populate(h,W,X){const ie=this.layers[0],ue=[];let ce=null,fe=!1,ye=ie.type==="heatmap";if(ie.type==="circle"){const we=ie;ce=we.layout.get("circle-sort-key"),fe=!ce.isConstant(),ye=ye||we.paint.get("circle-pitch-alignment")==="map"}const be=ye?W.subdivisionGranularity.circle:1;for(const{feature:we,id:Ie,index:Be,sourceLayerIndex:Ue}of h){const $e=this.layers[0]._featureFilter.needGeometry,Xe=Vo(we,$e);if(!this.layers[0]._featureFilter.filter(new Si(this.zoom,{globalState:this.globalState}),Xe,X))continue;const rt=fe?ce.evaluate(Xe,{},X):void 0,ct={id:Ie,properties:we.properties,type:we.type,sourceLayerIndex:Ue,index:Be,geometry:$e?Xe.geometry:Go(we),patterns:{},sortKey:rt};ue.push(ct)}fe&&ue.sort((we,Ie)=>we.sortKey-Ie.sortKey);for(const we of ue){const{geometry:Ie,index:Be,sourceLayerIndex:Ue}=we,$e=h[Be].feature;this.addFeature(we,Ie,Be,X,be),W.featureIndex.insert($e,Ie,Be,Ue,this.index)}}update(h,W,X){this.stateDependentLayers.length&&this.programConfigurations.updatePaintArrays(h,W,this.stateDependentLayers,X)}isEmpty(){return this.layoutVertexArray.length===0}uploadPending(){return!this.uploaded||this.programConfigurations.needsUpload}upload(h){this.uploaded||(this.layoutVertexBuffer=h.createVertexBuffer(this.layoutVertexArray,en),this.indexBuffer=h.createIndexBuffer(this.indexArray)),this.programConfigurations.upload(h),this.uploaded=!0}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy())}addFeature(h,W,X,ie,ue=1){let ce;switch(ue){case 1:ce=[0,7];break;case 3:ce=[0,2,5,7];break;case 5:ce=[0,1,3,4,6,7];break;case 7:ce=[0,1,2,3,4,5,6,7];break;default:throw new Error(`Invalid circle bucket granularity: ${ue}; valid values are 1, 3, 5, 7.`)}const fe=ce.length;for(const ye of W)for(const be of ye){const we=be.x,Ie=be.y;if(we<0||we>=Dt||Ie<0||Ie>=Dt)continue;const Be=this.segments.prepareSegment(fe*fe,this.layoutVertexArray,this.indexArray,h.sortKey),Ue=Be.vertexLength;for(let $e=0;$e<fe;$e++)for(let Xe=0;Xe<fe;Xe++)yf(this.layoutVertexArray,we,Ie,ce[Xe],ce[$e]);for(let $e=0;$e<fe-1;$e++)for(let Xe=0;Xe<fe-1;Xe++){const rt=Ue+$e*fe+Xe,ct=Ue+($e+1)*fe+Xe;this.indexArray.emplaceBack(rt,ct+1,rt+1),this.indexArray.emplaceBack(rt,ct,ct+1)}Be.vertexLength+=fe*fe,Be.primitiveLength+=(fe-1)*(fe-1)*2}this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,h,X,{},ie)}}function Oh(H,h){for(let W=0;W<H.length;W++)if(Ms(h,H[W]))return!0;for(let W=0;W<h.length;W++)if(Ms(H,h[W]))return!0;return!!zc(H,h)}function gf(H,h,W){return!!Ms(H,h)||!!Uc(h,H,W)}function Ch(H,h){if(H.length===1)return Dh(h,H[0]);for(let W=0;W<h.length;W++){const X=h[W];for(let ie=0;ie<X.length;ie++)if(Ms(H,X[ie]))return!0}for(let W=0;W<H.length;W++)if(Dh(h,H[W]))return!0;for(let W=0;W<h.length;W++)if(zc(H,h[W]))return!0;return!1}function vf(H,h,W){if(H.length>1){if(zc(H,h))return!0;for(let X=0;X<h.length;X++)if(Uc(h[X],H,W))return!0}for(let X=0;X<H.length;X++)if(Uc(H[X],h,W))return!0;return!1}function zc(H,h){if(H.length===0||h.length===0)return!1;for(let W=0;W<H.length-1;W++){const X=H[W],ie=H[W+1];for(let ue=0;ue<h.length-1;ue++)if(bf(X,ie,h[ue],h[ue+1]))return!0}return!1}function bf(H,h,W,X){return Lr(H,W,X)!==Lr(h,W,X)&&Lr(H,h,W)!==Lr(H,h,X)}function Uc(H,h,W){const X=W*W;if(h.length===1)return H.distSqr(h[0])<X;for(let ie=1;ie<h.length;ie++)if(Mh(H,h[ie-1],h[ie])<X)return!0;return!1}function Mh(H,h,W){const X=h.distSqr(W);if(X===0)return H.distSqr(h);const ie=((H.x-h.x)*(W.x-h.x)+(H.y-h.y)*(W.y-h.y))/X;return H.distSqr(ie<0?h:ie>1?W:W.sub(h)._mult(ie)._add(h))}function Dh(H,h){let W,X,ie,ue=!1;for(let ce=0;ce<H.length;ce++){W=H[ce];for(let fe=0,ye=W.length-1;fe<W.length;ye=fe++)X=W[fe],ie=W[ye],X.y>h.y!=ie.y>h.y&&h.x<(ie.x-X.x)*(h.y-X.y)/(ie.y-X.y)+X.x&&(ue=!ue)}return ue}function Ms(H,h){let W=!1;for(let X=0,ie=H.length-1;X<H.length;ie=X++){const ue=H[X],ce=H[ie];ue.y>h.y!=ce.y>h.y&&h.x<(ce.x-ue.x)*(h.y-ue.y)/(ce.y-ue.y)+ue.x&&(W=!W)}return W}function xf(H,h,W){const X=W[0],ie=W[2];if(H.x<X.x&&h.x<X.x||H.x>ie.x&&h.x>ie.x||H.y<X.y&&h.y<X.y||H.y>ie.y&&h.y>ie.y)return!1;const ue=Lr(H,h,W[0]);return ue!==Lr(H,h,W[1])||ue!==Lr(H,h,W[2])||ue!==Lr(H,h,W[3])}function zu(H,h,W){const X=h.paint.get(H).value;return X.kind==="constant"?X.value:W.programConfigurations.get(h.id).getMaxValue(H)}function Yl(H){return Math.sqrt(H[0]*H[0]+H[1]*H[1])}function Xl(H,h,W,X,ie){if(!h[0]&&!h[1])return H;const ue=ve.convert(h)._mult(ie);W==="viewport"&&ue._rotate(-X);const ce=[];for(let fe=0;fe<H.length;fe++)ce.push(H[fe].sub(ue));return ce}let Fh,kh;Tr("CircleBucket",Nc,{omit:["layers"]});var wf={get paint(){return kh=kh||new pn({"circle-radius":new Vr(St.paint_circle["circle-radius"]),"circle-color":new Vr(St.paint_circle["circle-color"]),"circle-blur":new Vr(St.paint_circle["circle-blur"]),"circle-opacity":new Vr(St.paint_circle["circle-opacity"]),"circle-translate":new Or(St.paint_circle["circle-translate"]),"circle-translate-anchor":new Or(St.paint_circle["circle-translate-anchor"]),"circle-pitch-scale":new Or(St.paint_circle["circle-pitch-scale"]),"circle-pitch-alignment":new Or(St.paint_circle["circle-pitch-alignment"]),"circle-stroke-width":new Vr(St.paint_circle["circle-stroke-width"]),"circle-stroke-color":new Vr(St.paint_circle["circle-stroke-color"]),"circle-stroke-opacity":new Vr(St.paint_circle["circle-stroke-opacity"])})},get layout(){return Fh=Fh||new pn({"circle-sort-key":new Vr(St.layout_circle["circle-sort-key"])})}};class Sf extends Qi{constructor(h){super(h,wf)}createBucket(h){return new Nc(h)}queryRadius(h){const W=h;return zu("circle-radius",this,W)+zu("circle-stroke-width",this,W)+Yl(this.paint.get("circle-translate"))}queryIntersectsFeature({queryGeometry:h,feature:W,featureState:X,geometry:ie,transform:ue,pixelsToTileUnits:ce,unwrappedTileID:fe,getElevation:ye}){const be=Xl(h,this.paint.get("circle-translate"),this.paint.get("circle-translate-anchor"),-ue.bearingInRadians,ce),we=this.paint.get("circle-radius").evaluate(W,X)+this.paint.get("circle-stroke-width").evaluate(W,X),Ie=this.paint.get("circle-pitch-alignment")==="map",Be=Ie?be:function($e,Xe,rt,ct){return $e.map(Ct=>Lh(Ct,Xe,rt,ct))}(be,ue,fe,ye),Ue=Ie?we*ce:we;for(const $e of ie)for(const Xe of $e){const rt=Ie?Xe:Lh(Xe,ue,fe,ye);let ct=Ue;const Ct=ue.projectTileCoordinates(Xe.x,Xe.y,fe,ye).signedDistanceFromCamera;if(this.paint.get("circle-pitch-scale")==="viewport"&&this.paint.get("circle-pitch-alignment")==="map"?ct*=Ct/ue.cameraToCenterDistance:this.paint.get("circle-pitch-scale")==="map"&&this.paint.get("circle-pitch-alignment")==="viewport"&&(ct*=ue.cameraToCenterDistance/Ct),gf(Be,rt,ct))return!0}return!1}}function Lh(H,h,W,X){const ie=h.projectTileCoordinates(H.x,H.y,W,X).point;return new ve((.5*ie.x+.5)*h.width,(.5*-ie.y+.5)*h.height)}class Bh extends Nc{}let jh;Tr("HeatmapBucket",Bh,{omit:["layers"]});var Ef={get paint(){return jh=jh||new pn({"heatmap-radius":new Vr(St.paint_heatmap["heatmap-radius"]),"heatmap-weight":new Vr(St.paint_heatmap["heatmap-weight"]),"heatmap-intensity":new Or(St.paint_heatmap["heatmap-intensity"]),"heatmap-color":new Lo(St.paint_heatmap["heatmap-color"]),"heatmap-opacity":new Or(St.paint_heatmap["heatmap-opacity"])})}};function Gc(H,{width:h,height:W},X,ie){if(ie){if(ie instanceof Uint8ClampedArray)ie=new Uint8Array(ie.buffer);else if(ie.length!==h*W*X)throw new RangeError(`mismatched image size. expected: ${ie.length} but got: ${h*W*X}`)}else ie=new Uint8Array(h*W*X);return H.width=h,H.height=W,H.data=ie,H}function Nh(H,{width:h,height:W},X){if(h===H.width&&W===H.height)return;const ie=Gc({},{width:h,height:W},X);Vc(H,ie,{x:0,y:0},{x:0,y:0},{width:Math.min(H.width,h),height:Math.min(H.height,W)},X),H.width=h,H.height=W,H.data=ie.data}function Vc(H,h,W,X,ie,ue){if(ie.width===0||ie.height===0)return h;if(ie.width>H.width||ie.height>H.height||W.x>H.width-ie.width||W.y>H.height-ie.height)throw new RangeError("out of range source coordinates for image copy");if(ie.width>h.width||ie.height>h.height||X.x>h.width-ie.width||X.y>h.height-ie.height)throw new RangeError("out of range destination coordinates for image copy");const ce=H.data,fe=h.data;if(ce===fe)throw new Error("srcData equals dstData, so image is already copied");for(let ye=0;ye<ie.height;ye++){const be=((W.y+ye)*H.width+W.x)*ue,we=((X.y+ye)*h.width+X.x)*ue;for(let Ie=0;Ie<ie.width*ue;Ie++)fe[we+Ie]=ce[be+Ie]}return h}class Uu{constructor(h,W){Gc(this,h,1,W)}resize(h){Nh(this,h,1)}clone(){return new Uu({width:this.width,height:this.height},new Uint8Array(this.data))}static copy(h,W,X,ie,ue){Vc(h,W,X,ie,ue,1)}}class qn{constructor(h,W){Gc(this,h,4,W)}resize(h){Nh(this,h,4)}replace(h,W){W?this.data.set(h):this.data=h instanceof Uint8ClampedArray?new Uint8Array(h.buffer):h}clone(){return new qn({width:this.width,height:this.height},new Uint8Array(this.data))}static copy(h,W,X,ie,ue){Vc(h,W,X,ie,ue,4)}setPixel(h,W,X){const ie=4*(h*this.width+W);this.data[ie+0]=Math.round(255*X.r/X.a),this.data[ie+1]=Math.round(255*X.g/X.a),this.data[ie+2]=Math.round(255*X.b/X.a),this.data[ie+3]=Math.round(255*X.a)}}function zh(H){const h={},W=H.resolution||256,X=H.clips?H.clips.length:1,ie=H.image||new qn({width:W,height:X});if(Math.log(W)/Math.LN2%1!=0)throw new Error(`width is not a power of 2 - ${W}`);const ue=(ce,fe,ye)=>{h[H.evaluationKey]=ye;const be=H.expression.evaluate(h);ie.setPixel(ce/4/W,fe/4,be)};if(H.clips)for(let ce=0,fe=0;ce<X;++ce,fe+=4*W)for(let ye=0,be=0;ye<W;ye++,be+=4){const we=ye/(W-1),{start:Ie,end:Be}=H.clips[ce];ue(fe,be,Ie*(1-we)+Be*we)}else for(let ce=0,fe=0;ce<W;ce++,fe+=4)ue(0,fe,ce/(W-1));return ie}Tr("AlphaImage",Uu),Tr("RGBAImage",qn);const $c="big-fb";class qf extends Qi{createBucket(h){return new Bh(h)}constructor(h){super(h,Ef),this.heatmapFbos=new Map,this._updateColorRamp()}_handleSpecialPaintPropertyUpdate(h){h==="heatmap-color"&&this._updateColorRamp()}_updateColorRamp(){this.colorRamp=zh({expression:this._transitionablePaint._values["heatmap-color"].value.expression,evaluationKey:"heatmapDensity",image:this.colorRamp}),this.colorRampTexture=null}resize(){this.heatmapFbos.has($c)&&this.heatmapFbos.delete($c)}queryRadius(){return 0}queryIntersectsFeature(){return!1}hasOffscreenPass(){return this.paint.get("heatmap-opacity")!==0&&this.visibility!=="none"}}let Uh;var Tf={get paint(){return Uh=Uh||new pn({"hillshade-illumination-direction":new Or(St.paint_hillshade["hillshade-illumination-direction"]),"hillshade-illumination-altitude":new Or(St.paint_hillshade["hillshade-illumination-altitude"]),"hillshade-illumination-anchor":new Or(St.paint_hillshade["hillshade-illumination-anchor"]),"hillshade-exaggeration":new Or(St.paint_hillshade["hillshade-exaggeration"]),"hillshade-shadow-color":new Or(St.paint_hillshade["hillshade-shadow-color"]),"hillshade-highlight-color":new Or(St.paint_hillshade["hillshade-highlight-color"]),"hillshade-accent-color":new Or(St.paint_hillshade["hillshade-accent-color"]),"hillshade-method":new Or(St.paint_hillshade["hillshade-method"])})}};class If extends Qi{constructor(h){super(h,Tf),this.recalculate({zoom:0,zoomHistory:{}},void 0)}getIlluminationProperties(){let h=this.paint.get("hillshade-illumination-direction").values,W=this.paint.get("hillshade-illumination-altitude").values,X=this.paint.get("hillshade-highlight-color").values,ie=this.paint.get("hillshade-shadow-color").values;const ue=Math.max(h.length,W.length,X.length,ie.length);h=h.concat(Array(ue-h.length).fill(h.at(-1))),W=W.concat(Array(ue-W.length).fill(W.at(-1))),X=X.concat(Array(ue-X.length).fill(X.at(-1))),ie=ie.concat(Array(ue-ie.length).fill(ie.at(-1)));const ce=W.map(Ge);return{directionRadians:h.map(Ge),altitudeRadians:ce,shadowColor:ie,highlightColor:X}}hasOffscreenPass(){return this.paint.get("hillshade-exaggeration")!==0&&this.visibility!=="none"}}let Gh;var Rf={get paint(){return Gh=Gh||new pn({"color-relief-opacity":new Or(St["paint_color-relief"]["color-relief-opacity"]),"color-relief-color":new Lo(St["paint_color-relief"]["color-relief-color"])})}};class Wc{constructor(h,W,X,ie){this.context=h,this.format=X,this.texture=h.gl.createTexture(),this.update(W,ie)}update(h,W,X){const{width:ie,height:ue}=h,ce=!(this.size&&this.size[0]===ie&&this.size[1]===ue||X),{context:fe}=this,{gl:ye}=fe;if(this.useMipmap=!!(W&&W.useMipmap),ye.bindTexture(ye.TEXTURE_2D,this.texture),fe.pixelStoreUnpackFlipY.set(!1),fe.pixelStoreUnpack.set(1),fe.pixelStoreUnpackPremultiplyAlpha.set(this.format===ye.RGBA&&(!W||W.premultiply!==!1)),ce)this.size=[ie,ue],h instanceof HTMLImageElement||h instanceof HTMLCanvasElement||h instanceof HTMLVideoElement||h instanceof ImageData||rr(h)?ye.texImage2D(ye.TEXTURE_2D,0,this.format,this.format,ye.UNSIGNED_BYTE,h):ye.texImage2D(ye.TEXTURE_2D,0,this.format,ie,ue,0,this.format,ye.UNSIGNED_BYTE,h.data);else{const{x:be,y:we}=X||{x:0,y:0};h instanceof HTMLImageElement||h instanceof HTMLCanvasElement||h instanceof HTMLVideoElement||h instanceof ImageData||rr(h)?ye.texSubImage2D(ye.TEXTURE_2D,0,be,we,ye.RGBA,ye.UNSIGNED_BYTE,h):ye.texSubImage2D(ye.TEXTURE_2D,0,be,we,ie,ue,ye.RGBA,ye.UNSIGNED_BYTE,h.data)}this.useMipmap&&this.isSizePowerOfTwo()&&ye.generateMipmap(ye.TEXTURE_2D),fe.pixelStoreUnpackFlipY.setDefault(),fe.pixelStoreUnpack.setDefault(),fe.pixelStoreUnpackPremultiplyAlpha.setDefault()}bind(h,W,X){const{context:ie}=this,{gl:ue}=ie;ue.bindTexture(ue.TEXTURE_2D,this.texture),X!==ue.LINEAR_MIPMAP_NEAREST||this.isSizePowerOfTwo()||(X=ue.LINEAR),h!==this.filter&&(ue.texParameteri(ue.TEXTURE_2D,ue.TEXTURE_MAG_FILTER,h),ue.texParameteri(ue.TEXTURE_2D,ue.TEXTURE_MIN_FILTER,X||h),this.filter=h),W!==this.wrap&&(ue.texParameteri(ue.TEXTURE_2D,ue.TEXTURE_WRAP_S,W),ue.texParameteri(ue.TEXTURE_2D,ue.TEXTURE_WRAP_T,W),this.wrap=W)}isSizePowerOfTwo(){return this.size[0]===this.size[1]&&Math.log(this.size[0])/Math.LN2%1==0}destroy(){const{gl:h}=this.context;h.deleteTexture(this.texture),this.texture=null}}class Vh{constructor(h,W,X,ie=1,ue=1,ce=1,fe=0){if(this.uid=h,W.height!==W.width)throw new RangeError("DEM tiles must be square");if(X&&!["mapbox","terrarium","custom"].includes(X))return void br(`"${X}" is not a valid encoding type. Valid types include "mapbox", "terrarium" and "custom".`);this.stride=W.height;const ye=this.dim=W.height-2;switch(this.data=new Uint32Array(W.data.buffer),X){case"terrarium":this.redFactor=256,this.greenFactor=1,this.blueFactor=1/256,this.baseShift=32768;break;case"custom":this.redFactor=ie,this.greenFactor=ue,this.blueFactor=ce,this.baseShift=fe;break;default:this.redFactor=6553.6,this.greenFactor=25.6,this.blueFactor=.1,this.baseShift=1e4}for(let be=0;be<ye;be++)this.data[this._idx(-1,be)]=this.data[this._idx(0,be)],this.data[this._idx(ye,be)]=this.data[this._idx(ye-1,be)],this.data[this._idx(be,-1)]=this.data[this._idx(be,0)],this.data[this._idx(be,ye)]=this.data[this._idx(be,ye-1)];this.data[this._idx(-1,-1)]=this.data[this._idx(0,0)],this.data[this._idx(ye,-1)]=this.data[this._idx(ye-1,0)],this.data[this._idx(-1,ye)]=this.data[this._idx(0,ye-1)],this.data[this._idx(ye,ye)]=this.data[this._idx(ye-1,ye-1)],this.min=Number.MAX_SAFE_INTEGER,this.max=Number.MIN_SAFE_INTEGER;for(let be=0;be<ye;be++)for(let we=0;we<ye;we++){const Ie=this.get(be,we);Ie>this.max&&(this.max=Ie),Ie<this.min&&(this.min=Ie)}}get(h,W){const X=new Uint8Array(this.data.buffer),ie=4*this._idx(h,W);return this.unpack(X[ie],X[ie+1],X[ie+2])}getUnpackVector(){return[this.redFactor,this.greenFactor,this.blueFactor,this.baseShift]}_idx(h,W){if(h<-1||h>=this.dim+1||W<-1||W>=this.dim+1)throw new RangeError("out of range source coordinates for DEM data");return(W+1)*this.stride+(h+1)}unpack(h,W,X){return h*this.redFactor+W*this.greenFactor+X*this.blueFactor-this.baseShift}pack(h){return $h(h,this.getUnpackVector())}getPixels(){return new qn({width:this.stride,height:this.stride},new Uint8Array(this.data.buffer))}backfillBorder(h,W,X){if(this.dim!==h.dim)throw new Error("dem dimension mismatch");let ie=W*this.dim,ue=W*this.dim+this.dim,ce=X*this.dim,fe=X*this.dim+this.dim;switch(W){case-1:ie=ue-1;break;case 1:ue=ie+1}switch(X){case-1:ce=fe-1;break;case 1:fe=ce+1}const ye=-W*this.dim,be=-X*this.dim;for(let we=ce;we<fe;we++)for(let Ie=ie;Ie<ue;Ie++)this.data[this._idx(Ie,we)]=h.data[this._idx(Ie+ye,we+be)]}}function $h(H,h){const W=h[0],X=h[1],ie=h[2],ue=h[3],ce=Math.min(W,X,ie),fe=Math.round((H+ue)/ce);return{r:Math.floor(fe*ce/W)%256,g:Math.floor(fe*ce/X)%256,b:Math.floor(fe*ce/ie)%256}}Tr("DEMData",Vh);class Af extends Qi{constructor(h){super(h,Rf)}_createColorRamp(h){const W={elevationStops:[],colorStops:[]},X=this._transitionablePaint._values["color-relief-color"].value.expression;if(X instanceof To&&X._styleExpression.expression instanceof dn){this.colorRampExpression=X;const ce=X._styleExpression.expression;W.elevationStops=ce.labels,W.colorStops=[];for(const fe of W.elevationStops)W.colorStops.push(ce.evaluate({globals:{elevation:fe}}))}if(W.elevationStops.length<1&&(W.elevationStops=[0],W.colorStops=[ni.transparent]),W.elevationStops.length<2&&(W.elevationStops.push(W.elevationStops[0]+1),W.colorStops.push(W.colorStops[0])),W.elevationStops.length<=h)return W;const ie={elevationStops:[],colorStops:[]},ue=(W.elevationStops.length-1)/(h-1);for(let ce=0;ce<W.elevationStops.length-.5;ce+=ue)ie.elevationStops.push(W.elevationStops[Math.round(ce)]),ie.colorStops.push(W.colorStops[Math.round(ce)]);return br(`Too many colors in specification of ${this.id} color-relief layer, may not render properly.`),ie}_colorRampChanged(){return this.colorRampExpression!=this._transitionablePaint._values["color-relief-color"].value.expression}getColorRampTextures(h,W,X){if(this.colorRampTextures&&!this._colorRampChanged())return this.colorRampTextures;const ie=this._createColorRamp(W),ue=new qn({width:ie.colorStops.length,height:1}),ce=new qn({width:ie.colorStops.length,height:1});for(let fe=0;fe<ie.elevationStops.length;fe++){const ye=$h(ie.elevationStops[fe],X);ce.setPixel(0,fe,new ni(ye.r/255,ye.g/255,ye.b/255,1)),ue.setPixel(0,fe,ie.colorStops[fe])}return this.colorRampTextures={elevationTexture:new Wc(h,ce,h.gl.RGBA),colorTexture:new Wc(h,ue,h.gl.RGBA)},this.colorRampTextures}hasOffscreenPass(){return this.visibility!=="none"&&!!this.colorRampTextures}}const Pf=Di([{name:"a_pos",components:2,type:"Int16"}],4),{members:Of}=Pf;function Hc(H,h,W){const X=W.patternDependencies;let ie=!1;for(const ue of h){const ce=ue.paint.get(`${H}-pattern`);ce.isConstant()||(ie=!0);const fe=ce.constantOr(null);fe&&(ie=!0,X[fe.to]=!0,X[fe.from]=!0)}return ie}function Zc(H,h,W,X,ie){const ue=ie.patternDependencies;for(const ce of h){const fe=ce.paint.get(`${H}-pattern`).value;if(fe.kind!=="constant"){let ye=fe.evaluate({zoom:X-1},W,{},ie.availableImages),be=fe.evaluate({zoom:X},W,{},ie.availableImages),we=fe.evaluate({zoom:X+1},W,{},ie.availableImages);ye=ye&&ye.name?ye.name:ye,be=be&&be.name?be.name:be,we=we&&we.name?we.name:we,ue[ye]=!0,ue[be]=!0,ue[we]=!0,W.patterns[ce.id]={min:ye,mid:be,max:we}}}return W}function Wh(H,h,W,X,ie){let ue;if(ie===function(ce,fe,ye,be){let we=0;for(let Ie=fe,Be=ye-be;Ie<ye;Ie+=be)we+=(ce[Be]-ce[Ie])*(ce[Ie+1]+ce[Be+1]),Be=Ie;return we}(H,h,W,X)>0)for(let ce=h;ce<W;ce+=X)ue=Yh(ce/X|0,H[ce],H[ce+1],ue);else for(let ce=W-X;ce>=h;ce-=X)ue=Yh(ce/X|0,H[ce],H[ce+1],ue);return ue&&Ds(ue,ue.next)&&(Wu(ue),ue=ue.next),ue}function $o(H,h){if(!H)return H;h||(h=H);let W,X=H;do if(W=!1,X.steiner||!Ds(X,X.next)&&Li(X.prev,X,X.next)!==0)X=X.next;else{if(Wu(X),X=h=X.prev,X===X.next)break;W=!0}while(W||X!==h);return h}function Gu(H,h,W,X,ie,ue,ce){if(!H)return;!ce&&ue&&function(ye,be,we,Ie){let Be=ye;do Be.z===0&&(Be.z=Kc(Be.x,Be.y,be,we,Ie)),Be.prevZ=Be.prev,Be.nextZ=Be.next,Be=Be.next;while(Be!==ye);Be.prevZ.nextZ=null,Be.prevZ=null,function(Ue){let $e,Xe=1;do{let rt,ct=Ue;Ue=null;let Ct=null;for($e=0;ct;){$e++;let wt=ct,Ne=0;for(let Et=0;Et<Xe&&(Ne++,wt=wt.nextZ,wt);Et++);let tt=Xe;for(;Ne>0||tt>0&&wt;)Ne!==0&&(tt===0||!wt||ct.z<=wt.z)?(rt=ct,ct=ct.nextZ,Ne--):(rt=wt,wt=wt.nextZ,tt--),Ct?Ct.nextZ=rt:Ue=rt,rt.prevZ=Ct,Ct=rt;ct=wt}Ct.nextZ=null,Xe*=2}while($e>1)}(Be)}(H,X,ie,ue);let fe=H;for(;H.prev!==H.next;){const ye=H.prev,be=H.next;if(ue?Mf(H,X,ie,ue):Cf(H))h.push(ye.i,H.i,be.i),Wu(H),H=be.next,fe=be.next;else if((H=be)===fe){ce?ce===1?Gu(H=Df($o(H),h),h,W,X,ie,ue,2):ce===2&&Ff(H,h,W,X,ie,ue):Gu($o(H),h,W,X,ie,ue,1);break}}}function Cf(H){const h=H.prev,W=H,X=H.next;if(Li(h,W,X)>=0)return!1;const ie=h.x,ue=W.x,ce=X.x,fe=h.y,ye=W.y,be=X.y,we=Math.min(ie,ue,ce),Ie=Math.min(fe,ye,be),Be=Math.max(ie,ue,ce),Ue=Math.max(fe,ye,be);let $e=X.next;for(;$e!==h;){if($e.x>=we&&$e.x<=Be&&$e.y>=Ie&&$e.y<=Ue&&Vu(ie,fe,ue,ye,ce,be,$e.x,$e.y)&&Li($e.prev,$e,$e.next)>=0)return!1;$e=$e.next}return!0}function Mf(H,h,W,X){const ie=H.prev,ue=H,ce=H.next;if(Li(ie,ue,ce)>=0)return!1;const fe=ie.x,ye=ue.x,be=ce.x,we=ie.y,Ie=ue.y,Be=ce.y,Ue=Math.min(fe,ye,be),$e=Math.min(we,Ie,Be),Xe=Math.max(fe,ye,be),rt=Math.max(we,Ie,Be),ct=Kc(Ue,$e,h,W,X),Ct=Kc(Xe,rt,h,W,X);let wt=H.prevZ,Ne=H.nextZ;for(;wt&&wt.z>=ct&&Ne&&Ne.z<=Ct;){if(wt.x>=Ue&&wt.x<=Xe&&wt.y>=$e&&wt.y<=rt&&wt!==ie&&wt!==ce&&Vu(fe,we,ye,Ie,be,Be,wt.x,wt.y)&&Li(wt.prev,wt,wt.next)>=0||(wt=wt.prevZ,Ne.x>=Ue&&Ne.x<=Xe&&Ne.y>=$e&&Ne.y<=rt&&Ne!==ie&&Ne!==ce&&Vu(fe,we,ye,Ie,be,Be,Ne.x,Ne.y)&&Li(Ne.prev,Ne,Ne.next)>=0))return!1;Ne=Ne.nextZ}for(;wt&&wt.z>=ct;){if(wt.x>=Ue&&wt.x<=Xe&&wt.y>=$e&&wt.y<=rt&&wt!==ie&&wt!==ce&&Vu(fe,we,ye,Ie,be,Be,wt.x,wt.y)&&Li(wt.prev,wt,wt.next)>=0)return!1;wt=wt.prevZ}for(;Ne&&Ne.z<=Ct;){if(Ne.x>=Ue&&Ne.x<=Xe&&Ne.y>=$e&&Ne.y<=rt&&Ne!==ie&&Ne!==ce&&Vu(fe,we,ye,Ie,be,Be,Ne.x,Ne.y)&&Li(Ne.prev,Ne,Ne.next)>=0)return!1;Ne=Ne.nextZ}return!0}function Df(H,h){let W=H;do{const X=W.prev,ie=W.next.next;!Ds(X,ie)&&Zh(X,W,W.next,ie)&&$u(X,ie)&&$u(ie,X)&&(h.push(X.i,W.i,ie.i),Wu(W),Wu(W.next),W=H=ie),W=W.next}while(W!==H);return $o(W)}function Ff(H,h,W,X,ie,ue){let ce=H;do{let fe=ce.next.next;for(;fe!==ce.prev;){if(ce.i!==fe.i&&Nf(ce,fe)){let ye=Kh(ce,fe);return ce=$o(ce,ce.next),ye=$o(ye,ye.next),Gu(ce,h,W,X,ie,ue,0),void Gu(ye,h,W,X,ie,ue,0)}fe=fe.next}ce=ce.next}while(ce!==H)}function kf(H,h){let W=H.x-h.x;return W===0&&(W=H.y-h.y,W===0)&&(W=(H.next.y-H.y)/(H.next.x-H.x)-(h.next.y-h.y)/(h.next.x-h.x)),W}function Lf(H,h){const W=function(ie,ue){let ce=ue;const fe=ie.x,ye=ie.y;let be,we=-1/0;if(Ds(ie,ce))return ce;do{if(Ds(ie,ce.next))return ce.next;if(ye<=ce.y&&ye>=ce.next.y&&ce.next.y!==ce.y){const Xe=ce.x+(ye-ce.y)*(ce.next.x-ce.x)/(ce.next.y-ce.y);if(Xe<=fe&&Xe>we&&(we=Xe,be=ce.x<ce.next.x?ce:ce.next,Xe===fe))return be}ce=ce.next}while(ce!==ue);if(!be)return null;const Ie=be,Be=be.x,Ue=be.y;let $e=1/0;ce=be;do{if(fe>=ce.x&&ce.x>=Be&&fe!==ce.x&&Hh(ye<Ue?fe:we,ye,Be,Ue,ye<Ue?we:fe,ye,ce.x,ce.y)){const Xe=Math.abs(ye-ce.y)/(fe-ce.x);$u(ce,ie)&&(Xe<$e||Xe===$e&&(ce.x>be.x||ce.x===be.x&&Bf(be,ce)))&&(be=ce,$e=Xe)}ce=ce.next}while(ce!==Ie);return be}(H,h);if(!W)return h;const X=Kh(W,H);return $o(X,X.next),$o(W,W.next)}function Bf(H,h){return Li(H.prev,H,h.prev)<0&&Li(h.next,H,H.next)<0}function Kc(H,h,W,X,ie){return(H=1431655765&((H=858993459&((H=252645135&((H=16711935&((H=(H-W)*ie|0)|H<<8))|H<<4))|H<<2))|H<<1))|(h=1431655765&((h=858993459&((h=252645135&((h=16711935&((h=(h-X)*ie|0)|h<<8))|h<<4))|h<<2))|h<<1))<<1}function jf(H){let h=H,W=H;do(h.x<W.x||h.x===W.x&&h.y<W.y)&&(W=h),h=h.next;while(h!==H);return W}function Hh(H,h,W,X,ie,ue,ce,fe){return(ie-ce)*(h-fe)>=(H-ce)*(ue-fe)&&(H-ce)*(X-fe)>=(W-ce)*(h-fe)&&(W-ce)*(ue-fe)>=(ie-ce)*(X-fe)}function Vu(H,h,W,X,ie,ue,ce,fe){return!(H===ce&&h===fe)&&Hh(H,h,W,X,ie,ue,ce,fe)}function Nf(H,h){return H.next.i!==h.i&&H.prev.i!==h.i&&!function(W,X){let ie=W;do{if(ie.i!==W.i&&ie.next.i!==W.i&&ie.i!==X.i&&ie.next.i!==X.i&&Zh(ie,ie.next,W,X))return!0;ie=ie.next}while(ie!==W);return!1}(H,h)&&($u(H,h)&&$u(h,H)&&function(W,X){let ie=W,ue=!1;const ce=(W.x+X.x)/2,fe=(W.y+X.y)/2;do ie.y>fe!=ie.next.y>fe&&ie.next.y!==ie.y&&ce<(ie.next.x-ie.x)*(fe-ie.y)/(ie.next.y-ie.y)+ie.x&&(ue=!ue),ie=ie.next;while(ie!==W);return ue}(H,h)&&(Li(H.prev,H,h.prev)||Li(H,h.prev,h))||Ds(H,h)&&Li(H.prev,H,H.next)>0&&Li(h.prev,h,h.next)>0)}function Li(H,h,W){return(h.y-H.y)*(W.x-h.x)-(h.x-H.x)*(W.y-h.y)}function Ds(H,h){return H.x===h.x&&H.y===h.y}function Zh(H,h,W,X){const ie=Ql(Li(H,h,W)),ue=Ql(Li(H,h,X)),ce=Ql(Li(W,X,H)),fe=Ql(Li(W,X,h));return ie!==ue&&ce!==fe||!(ie!==0||!Jl(H,W,h))||!(ue!==0||!Jl(H,X,h))||!(ce!==0||!Jl(W,H,X))||!(fe!==0||!Jl(W,h,X))}function Jl(H,h,W){return h.x<=Math.max(H.x,W.x)&&h.x>=Math.min(H.x,W.x)&&h.y<=Math.max(H.y,W.y)&&h.y>=Math.min(H.y,W.y)}function Ql(H){return H>0?1:H<0?-1:0}function $u(H,h){return Li(H.prev,H,H.next)<0?Li(H,h,H.next)>=0&&Li(H,H.prev,h)>=0:Li(H,h,H.prev)<0||Li(H,H.next,h)<0}function Kh(H,h){const W=Yc(H.i,H.x,H.y),X=Yc(h.i,h.x,h.y),ie=H.next,ue=h.prev;return H.next=h,h.prev=H,W.next=ie,ie.prev=W,X.next=W,W.prev=X,ue.next=X,X.prev=ue,X}function Yh(H,h,W,X){const ie=Yc(H,h,W);return X?(ie.next=X.next,ie.prev=X,X.next.prev=ie,X.next=ie):(ie.prev=ie,ie.next=ie),ie}function Wu(H){H.next.prev=H.prev,H.prev.next=H.next,H.prevZ&&(H.prevZ.nextZ=H.nextZ),H.nextZ&&(H.nextZ.prevZ=H.prevZ)}function Yc(H,h,W){return{i:H,x:h,y:W,prev:null,next:null,z:0,prevZ:null,nextZ:null,steiner:!1}}class Fs{constructor(h,W){if(W>h)throw new Error("Min granularity must not be greater than base granularity.");this._baseZoomGranularity=h,this._minGranularity=W}getGranularityForZoomLevel(h){return Math.max(Math.floor(this._baseZoomGranularity/(1<<h)),this._minGranularity,1)}}class ec{constructor(h){this.fill=h.fill,this.line=h.line,this.tile=h.tile,this.stencil=h.stencil,this.circle=h.circle}}ec.noSubdivision=new ec({fill:new Fs(0,0),line:new Fs(0,0),tile:new Fs(0,0),stencil:new Fs(0,0),circle:1}),Tr("SubdivisionGranularityExpression",Fs),Tr("SubdivisionGranularitySetting",ec);const ks=-32768,Hu=32767;class zf{constructor(h,W){this._vertexBuffer=[],this._vertexDictionary=new Map,this._used=!1,this._granularity=h,this._granularityCellSize=Dt/h,this._canonical=W}_getKey(h,W){return(h+=32768)<<16|W+32768}_vertexToIndex(h,W){if(h<-32768||W<-32768||h>32767||W>32767)throw new Error("Vertex coordinates are out of signed 16 bit integer range.");const X=0|Math.round(h),ie=0|Math.round(W),ue=this._getKey(X,ie);if(this._vertexDictionary.has(ue))return this._vertexDictionary.get(ue);const ce=this._vertexBuffer.length/2;return this._vertexDictionary.set(ue,ce),this._vertexBuffer.push(X,ie),ce}_subdivideTrianglesScanline(h){if(this._granularity<2)return function(ie,ue){const ce=[];for(let fe=0;fe<ue.length;fe+=3){const ye=ue[fe],be=ue[fe+1],we=ue[fe+2],Ie=ie[2*ye],Be=ie[2*ye+1];(ie[2*be]-Ie)*(ie[2*we+1]-Be)-(ie[2*be+1]-Be)*(ie[2*we]-Ie)>0?(ce.push(ye),ce.push(we),ce.push(be)):(ce.push(ye),ce.push(be),ce.push(we))}return ce}(this._vertexBuffer,h);const W=[],X=h.length;for(let ie=0;ie<X;ie+=3){const ue=[h[ie+0],h[ie+1],h[ie+2]],ce=[this._vertexBuffer[2*h[ie+0]+0],this._vertexBuffer[2*h[ie+0]+1],this._vertexBuffer[2*h[ie+1]+0],this._vertexBuffer[2*h[ie+1]+1],this._vertexBuffer[2*h[ie+2]+0],this._vertexBuffer[2*h[ie+2]+1]];let fe=1/0,ye=1/0,be=-1/0,we=-1/0;for(let Xe=0;Xe<3;Xe++){const rt=ce[2*Xe],ct=ce[2*Xe+1];fe=Math.min(fe,rt),be=Math.max(be,rt),ye=Math.min(ye,ct),we=Math.max(we,ct)}if(fe===be||ye===we)continue;const Ie=Math.floor(fe/this._granularityCellSize),Be=Math.ceil(be/this._granularityCellSize),Ue=Math.floor(ye/this._granularityCellSize),$e=Math.ceil(we/this._granularityCellSize);if(Ie!==Be||Ue!==$e)for(let Xe=Ue;Xe<$e;Xe++){const rt=this._scanlineGenerateVertexRingForCellRow(Xe,ce,ue);Uf(this._vertexBuffer,rt,W)}else W.push(...ue)}return W}_scanlineGenerateVertexRingForCellRow(h,W,X){const ie=h*this._granularityCellSize,ue=ie+this._granularityCellSize,ce=[];for(let fe=0;fe<3;fe++){const ye=W[2*fe],be=W[2*fe+1],we=W[2*(fe+1)%6],Ie=W[(2*(fe+1)+1)%6],Be=W[2*(fe+2)%6],Ue=W[(2*(fe+2)+1)%6],$e=we-ye,Xe=Ie-be,rt=$e===0,ct=Xe===0,Ct=(ie-be)/Xe,wt=(ue-be)/Xe,Ne=Math.min(Ct,wt),tt=Math.max(Ct,wt);if(!ct&&(Ne>=1||tt<=0)||ct&&(be<ie||be>ue)){Ie>=ie&&Ie<=ue&&ce.push(X[(fe+1)%3]);continue}!ct&&Ne>0&&ce.push(this._vertexToIndex(ye+$e*Ne,be+Xe*Ne));const Et=ye+$e*Math.max(Ne,0),Ut=ye+$e*Math.min(tt,1);rt||this._generateIntraEdgeVertices(ce,ye,be,we,Ie,Et,Ut),!ct&&tt<1&&ce.push(this._vertexToIndex(ye+$e*tt,be+Xe*tt)),(ct||Ie>=ie&&Ie<=ue)&&ce.push(X[(fe+1)%3]),!ct&&(Ie<=ie||Ie>=ue)&&this._generateInterEdgeVertices(ce,ye,be,we,Ie,Be,Ue,Ut,ie,ue)}return ce}_generateIntraEdgeVertices(h,W,X,ie,ue,ce,fe){const ye=ie-W,be=ue-X,we=be===0,Ie=we?Math.min(W,ie):Math.min(ce,fe),Be=we?Math.max(W,ie):Math.max(ce,fe),Ue=Math.floor(Ie/this._granularityCellSize)+1,$e=Math.ceil(Be/this._granularityCellSize)-1;if(we?W<ie:ce<fe)for(let Xe=Ue;Xe<=$e;Xe++){const rt=Xe*this._granularityCellSize;h.push(this._vertexToIndex(rt,X+be*(rt-W)/ye))}else for(let Xe=$e;Xe>=Ue;Xe--){const rt=Xe*this._granularityCellSize;h.push(this._vertexToIndex(rt,X+be*(rt-W)/ye))}}_generateInterEdgeVertices(h,W,X,ie,ue,ce,fe,ye,be,we){const Ie=ue-X,Be=ce-ie,Ue=fe-ue,$e=(be-ue)/Ue,Xe=(we-ue)/Ue,rt=Math.min($e,Xe),ct=Math.max($e,Xe),Ct=ie+Be*rt;let wt=Math.floor(Math.min(Ct,ye)/this._granularityCellSize)+1,Ne=Math.ceil(Math.max(Ct,ye)/this._granularityCellSize)-1,tt=ye<Ct;const Et=Ue===0;if(Et&&(fe===be||fe===we))return;if(Et||rt>=1||ct<=0){const Jt=X-fe,Wt=ce+(W-ce)*Math.min((be-fe)/Jt,(we-fe)/Jt);wt=Math.floor(Math.min(Wt,ye)/this._granularityCellSize)+1,Ne=Math.ceil(Math.max(Wt,ye)/this._granularityCellSize)-1,tt=ye<Wt}const Ut=Ie>0?we:be;if(tt)for(let Jt=wt;Jt<=Ne;Jt++)h.push(this._vertexToIndex(Jt*this._granularityCellSize,Ut));else for(let Jt=Ne;Jt>=wt;Jt--)h.push(this._vertexToIndex(Jt*this._granularityCellSize,Ut))}_generateOutline(h){const W=[];for(const X of h){const ie=Wo(X,this._granularity,!0),ue=this._pointArrayToIndices(ie),ce=[];for(let fe=1;fe<ue.length;fe++)ce.push(ue[fe-1]),ce.push(ue[fe]);W.push(ce)}return W}_handlePoles(h){let W=!1,X=!1;this._canonical&&(this._canonical.y===0&&(W=!0),this._canonical.y===(1<<this._canonical.z)-1&&(X=!0)),(W||X)&&this._fillPoles(h,W,X)}_ensureNoPoleVertices(){const h=this._vertexBuffer;for(let W=0;W<h.length;W+=2){const X=h[W+1];X===ks&&(h[W+1]=-32767),X===Hu&&(h[W+1]=32766)}}_generatePoleQuad(h,W,X,ie,ue,ce){ie>ue!=(ce===ks)?(h.push(W),h.push(X),h.push(this._vertexToIndex(ie,ce)),h.push(X),h.push(this._vertexToIndex(ue,ce)),h.push(this._vertexToIndex(ie,ce))):(h.push(X),h.push(W),h.push(this._vertexToIndex(ie,ce)),h.push(this._vertexToIndex(ue,ce)),h.push(X),h.push(this._vertexToIndex(ie,ce)))}_fillPoles(h,W,X){const ie=this._vertexBuffer,ue=Dt,ce=h.length;for(let fe=2;fe<ce;fe+=3){const ye=h[fe-2],be=h[fe-1],we=h[fe],Ie=ie[2*ye],Be=ie[2*ye+1],Ue=ie[2*be],$e=ie[2*be+1],Xe=ie[2*we],rt=ie[2*we+1];W&&(Be===0&&$e===0&&this._generatePoleQuad(h,ye,be,Ie,Ue,ks),$e===0&&rt===0&&this._generatePoleQuad(h,be,we,Ue,Xe,ks),rt===0&&Be===0&&this._generatePoleQuad(h,we,ye,Xe,Ie,ks)),X&&(Be===ue&&$e===ue&&this._generatePoleQuad(h,ye,be,Ie,Ue,Hu),$e===ue&&rt===ue&&this._generatePoleQuad(h,be,we,Ue,Xe,Hu),rt===ue&&Be===ue&&this._generatePoleQuad(h,we,ye,Xe,Ie,Hu))}}_initializeVertices(h){for(let W=0;W<h.length;W+=2)this._vertexToIndex(h[W],h[W+1])}subdividePolygonInternal(h,W){if(this._used)throw new Error("Subdivision: multiple use not allowed.");this._used=!0;const{flattened:X,holeIndices:ie}=function(fe){const ye=[],be=[];for(const we of fe)if(we.length!==0){we!==fe[0]&&ye.push(be.length/2);for(let Ie=0;Ie<we.length;Ie++)be.push(we[Ie].x),be.push(we[Ie].y)}return{flattened:be,holeIndices:ye}}(h);let ue;this._initializeVertices(X);try{const fe=function(be,we,Ie=2){const Be=we&&we.length,Ue=Be?we[0]*Ie:be.length;let $e=Wh(be,0,Ue,Ie,!0);const Xe=[];if(!$e||$e.next===$e.prev)return Xe;let rt,ct,Ct;if(Be&&($e=function(wt,Ne,tt,Et){const Ut=[];for(let Jt=0,Wt=Ne.length;Jt<Wt;Jt++){const Kt=Wh(wt,Ne[Jt]*Et,Jt<Wt-1?Ne[Jt+1]*Et:wt.length,Et,!1);Kt===Kt.next&&(Kt.steiner=!0),Ut.push(jf(Kt))}Ut.sort(kf);for(let Jt=0;Jt<Ut.length;Jt++)tt=Lf(Ut[Jt],tt);return tt}(be,we,$e,Ie)),be.length>80*Ie){rt=1/0,ct=1/0;let wt=-1/0,Ne=-1/0;for(let tt=Ie;tt<Ue;tt+=Ie){const Et=be[tt],Ut=be[tt+1];Et<rt&&(rt=Et),Ut<ct&&(ct=Ut),Et>wt&&(wt=Et),Ut>Ne&&(Ne=Ut)}Ct=Math.max(wt-rt,Ne-ct),Ct=Ct!==0?32767/Ct:0}return Gu($e,Xe,Ie,rt,ct,Ct,0),Xe}(X,ie),ye=this._convertIndices(X,fe);ue=this._subdivideTrianglesScanline(ye)}catch(fe){console.error(fe)}let ce=[];return W&&(ce=this._generateOutline(h)),this._ensureNoPoleVertices(),this._handlePoles(ue),{verticesFlattened:this._vertexBuffer,indicesTriangles:ue,indicesLineList:ce}}_convertIndices(h,W){const X=[];for(let ie=0;ie<W.length;ie++)X.push(this._vertexToIndex(h[2*W[ie]],h[2*W[ie]+1]));return X}_pointArrayToIndices(h){const W=[];for(let X=0;X<h.length;X++){const ie=h[X];W.push(this._vertexToIndex(ie.x,ie.y))}return W}}function Xh(H,h,W,X=!0){return new zf(W,h).subdividePolygonInternal(H,X)}function Wo(H,h,W=!1){if(!H||H.length<1)return[];if(H.length<2)return[];const X=H[0],ie=H[H.length-1],ue=W&&(X.x!==ie.x||X.y!==ie.y);if(h<2)return ue?[...H,H[0]]:[...H];const ce=Math.floor(Dt/h),fe=[];fe.push(new ve(H[0].x,H[0].y));const ye=H.length,be=ue?ye:ye-1;for(let we=0;we<be;we++){const Ie=H[we],Be=we<ye-1?H[we+1]:H[0],Ue=Ie.x,$e=Ie.y,Xe=Be.x,rt=Be.y,ct=Ue!==Xe,Ct=$e!==rt;if(!ct&&!Ct)continue;const wt=Xe-Ue,Ne=rt-$e,tt=Math.abs(wt),Et=Math.abs(Ne);let Ut=Ue,Jt=$e;for(;;){const Kt=wt>0?(Math.floor(Ut/ce)+1)*ce:(Math.ceil(Ut/ce)-1)*ce,ur=Ne>0?(Math.floor(Jt/ce)+1)*ce:(Math.ceil(Jt/ce)-1)*ce,tr=Math.abs(Ut-Kt),dr=Math.abs(Jt-ur),Xt=Math.abs(Ut-Xe),Pr=Math.abs(Jt-rt),Ur=ct?tr/tt:Number.POSITIVE_INFINITY,Nr=Ct?dr/Et:Number.POSITIVE_INFINITY;if((Xt<=tr||!ct)&&(Pr<=dr||!Ct))break;if(Ur<Nr&&ct||!Ct){Ut=Kt,Jt+=Ne*Ur;const kr=new ve(Ut,Math.round(Jt));fe[fe.length-1].x===kr.x&&fe[fe.length-1].y===kr.y||fe.push(kr)}else{Ut+=wt*Nr,Jt=ur;const kr=new ve(Math.round(Ut),Jt);fe[fe.length-1].x===kr.x&&fe[fe.length-1].y===kr.y||fe.push(kr)}}const Wt=new ve(Xe,rt);fe[fe.length-1].x===Wt.x&&fe[fe.length-1].y===Wt.y||fe.push(Wt)}return fe}function Uf(H,h,W){if(h.length===0)throw new Error("Subdivision vertex ring is empty.");let X=0,ie=H[2*h[0]];for(let ye=1;ye<h.length;ye++){const be=H[2*h[ye]];be<ie&&(ie=be,X=ye)}const ue=h.length;let ce=X,fe=(ce+1)%ue;for(;;){const ye=ce-1>=0?ce-1:ue-1,be=(fe+1)%ue,we=H[2*h[ye]],Ie=H[2*h[be]],Be=H[2*h[ce]],Ue=H[2*h[ce]+1],$e=H[2*h[fe]+1];let Xe=!1;if(we<Ie)Xe=!0;else if(we>Ie)Xe=!1;else{const rt=$e-Ue,ct=-(H[2*h[fe]]-Be),Ct=Ue<$e?1:-1;((we-Be)*rt+(H[2*h[ye]+1]-Ue)*ct)*Ct>((Ie-Be)*rt+(H[2*h[be]+1]-Ue)*ct)*Ct&&(Xe=!0)}if(Xe){const rt=h[ye],ct=h[ce],Ct=h[fe];rt!==ct&&rt!==Ct&&ct!==Ct&&W.push(Ct,ct,rt),ce--,ce<0&&(ce=ue-1)}else{const rt=h[be],ct=h[ce],Ct=h[fe];rt!==ct&&rt!==Ct&&ct!==Ct&&W.push(Ct,ct,rt),fe++,fe>=ue&&(fe=0)}if(ye===be)break}}function Jh(H,h,W,X,ie,ue,ce,fe,ye){const be=ie.length/2,we=ce&&fe&&ye;if(be<li.MAX_VERTEX_ARRAY_LENGTH){const Ie=h.prepareSegment(be,W,X),Be=Ie.vertexLength;for(let Xe=0;Xe<ue.length;Xe+=3)X.emplaceBack(Be+ue[Xe],Be+ue[Xe+1],Be+ue[Xe+2]);let Ue,$e;Ie.vertexLength+=be,Ie.primitiveLength+=ue.length/3,we&&($e=ce.prepareSegment(be,W,fe),Ue=$e.vertexLength,$e.vertexLength+=be);for(let Xe=0;Xe<ie.length;Xe+=2)H(ie[Xe],ie[Xe+1]);if(we)for(let Xe=0;Xe<ye.length;Xe++){const rt=ye[Xe];for(let ct=1;ct<rt.length;ct+=2)fe.emplaceBack(Ue+rt[ct-1],Ue+rt[ct]);$e.primitiveLength+=rt.length/2}}else(function(Ie,Be,Ue,$e,Xe,rt){const ct=[];for(let Et=0;Et<$e.length/2;Et++)ct.push(-1);const Ct={count:0};let wt=0,Ne=Ie.getOrCreateLatestSegment(Be,Ue),tt=Ne.vertexLength;for(let Et=2;Et<Xe.length;Et+=3){const Ut=Xe[Et-2],Jt=Xe[Et-1],Wt=Xe[Et];let Kt=ct[Ut]<wt,ur=ct[Jt]<wt,tr=ct[Wt]<wt;Ne.vertexLength+((Kt?1:0)+(ur?1:0)+(tr?1:0))>li.MAX_VERTEX_ARRAY_LENGTH&&(Ne=Ie.createNewSegment(Be,Ue),wt=Ct.count,Kt=!0,ur=!0,tr=!0,tt=0);const dr=Zu(ct,$e,rt,Ct,Ut,Kt,Ne),Xt=Zu(ct,$e,rt,Ct,Jt,ur,Ne),Pr=Zu(ct,$e,rt,Ct,Wt,tr,Ne);Ue.emplaceBack(tt+dr-wt,tt+Xt-wt,tt+Pr-wt),Ne.primitiveLength++}})(h,W,X,ie,ue,H),we&&function(Ie,Be,Ue,$e,Xe,rt){const ct=[];for(let Et=0;Et<$e.length/2;Et++)ct.push(-1);const Ct={count:0};let wt=0,Ne=Ie.getOrCreateLatestSegment(Be,Ue),tt=Ne.vertexLength;for(let Et=0;Et<Xe.length;Et++){const Ut=Xe[Et];for(let Jt=1;Jt<Xe[Et].length;Jt+=2){const Wt=Ut[Jt-1],Kt=Ut[Jt];let ur=ct[Wt]<wt,tr=ct[Kt]<wt;Ne.vertexLength+((ur?1:0)+(tr?1:0))>li.MAX_VERTEX_ARRAY_LENGTH&&(Ne=Ie.createNewSegment(Be,Ue),wt=Ct.count,ur=!0,tr=!0,tt=0);const dr=Zu(ct,$e,rt,Ct,Wt,ur,Ne),Xt=Zu(ct,$e,rt,Ct,Kt,tr,Ne);Ue.emplaceBack(tt+dr-wt,tt+Xt-wt),Ne.primitiveLength++}}}(ce,W,fe,ie,ye,H),h.forceNewSegmentOnNextPrepare(),ce==null||ce.forceNewSegmentOnNextPrepare()}function Zu(H,h,W,X,ie,ue,ce){if(ue){const fe=X.count;return W(h[2*ie],h[2*ie+1]),H[ie]=X.count,X.count++,ce.vertexLength++,fe}return H[ie]}class Xc{constructor(h){this.zoom=h.zoom,this.globalState=h.globalState,this.overscaling=h.overscaling,this.layers=h.layers,this.layerIds=this.layers.map(W=>W.id),this.index=h.index,this.hasPattern=!1,this.patternFeatures=[],this.layoutVertexArray=new $t,this.indexArray=new gi,this.indexArray2=new mi,this.programConfigurations=new _a(h.layers,h.zoom),this.segments=new li,this.segments2=new li,this.stateDependentLayerIds=this.layers.filter(W=>W.isStateDependent()).map(W=>W.id)}populate(h,W,X){this.hasPattern=Hc("fill",this.layers,W);const ie=this.layers[0].layout.get("fill-sort-key"),ue=!ie.isConstant(),ce=[];for(const{feature:fe,id:ye,index:be,sourceLayerIndex:we}of h){const Ie=this.layers[0]._featureFilter.needGeometry,Be=Vo(fe,Ie);if(!this.layers[0]._featureFilter.filter(new Si(this.zoom,{globalState:this.globalState}),Be,X))continue;const Ue=ue?ie.evaluate(Be,{},X,W.availableImages):void 0,$e={id:ye,properties:fe.properties,type:fe.type,sourceLayerIndex:we,index:be,geometry:Ie?Be.geometry:Go(fe),patterns:{},sortKey:Ue};ce.push($e)}ue&&ce.sort((fe,ye)=>fe.sortKey-ye.sortKey);for(const fe of ce){const{geometry:ye,index:be,sourceLayerIndex:we}=fe;if(this.hasPattern){const Ie=Zc("fill",this.layers,fe,this.zoom,W);this.patternFeatures.push(Ie)}else this.addFeature(fe,ye,be,X,{},W.subdivisionGranularity);W.featureIndex.insert(h[be].feature,ye,be,we,this.index)}}update(h,W,X){this.stateDependentLayers.length&&this.programConfigurations.updatePaintArrays(h,W,this.stateDependentLayers,X)}addFeatures(h,W,X){for(const ie of this.patternFeatures)this.addFeature(ie,ie.geometry,ie.index,W,X,h.subdivisionGranularity)}isEmpty(){return this.layoutVertexArray.length===0}uploadPending(){return!this.uploaded||this.programConfigurations.needsUpload}upload(h){this.uploaded||(this.layoutVertexBuffer=h.createVertexBuffer(this.layoutVertexArray,Of),this.indexBuffer=h.createIndexBuffer(this.indexArray),this.indexBuffer2=h.createIndexBuffer(this.indexArray2)),this.programConfigurations.upload(h),this.uploaded=!0}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.indexBuffer2.destroy(),this.programConfigurations.destroy(),this.segments.destroy(),this.segments2.destroy())}addFeature(h,W,X,ie,ue,ce){for(const fe of os(W,500)){const ye=Xh(fe,ie,ce.fill.getGranularityForZoomLevel(ie.z)),be=this.layoutVertexArray;Jh((we,Ie)=>{be.emplaceBack(we,Ie)},this.segments,this.layoutVertexArray,this.indexArray,ye.verticesFlattened,ye.indicesTriangles,this.segments2,this.indexArray2,ye.indicesLineList)}this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,h,X,ue,ie)}}let Qh,ed;Tr("FillBucket",Xc,{omit:["layers","patternFeatures"]});var Gf={get paint(){return ed=ed||new pn({"fill-antialias":new Or(St.paint_fill["fill-antialias"]),"fill-opacity":new Vr(St.paint_fill["fill-opacity"]),"fill-color":new Vr(St.paint_fill["fill-color"]),"fill-outline-color":new Vr(St.paint_fill["fill-outline-color"]),"fill-translate":new Or(St.paint_fill["fill-translate"]),"fill-translate-anchor":new Or(St.paint_fill["fill-translate-anchor"]),"fill-pattern":new Ps(St.paint_fill["fill-pattern"])})},get layout(){return Qh=Qh||new pn({"fill-sort-key":new Vr(St.layout_fill["fill-sort-key"])})}};class Vf extends Qi{constructor(h){super(h,Gf)}recalculate(h,W){super.recalculate(h,W);const X=this.paint._values["fill-outline-color"];X.value.kind==="constant"&&X.value.value===void 0&&(this.paint._values["fill-outline-color"]=this.paint._values["fill-color"])}createBucket(h){return new Xc(h)}queryRadius(){return Yl(this.paint.get("fill-translate"))}queryIntersectsFeature({queryGeometry:h,geometry:W,transform:X,pixelsToTileUnits:ie}){return Ch(Xl(h,this.paint.get("fill-translate"),this.paint.get("fill-translate-anchor"),-X.bearingInRadians,ie),W)}isTileClipped(){return!0}}const $f=Di([{name:"a_pos",components:2,type:"Int16"},{name:"a_normal_ed",components:4,type:"Int16"}],4),Wf=Di([{name:"a_centroid",components:2,type:"Int16"}],4),{members:Hf}=$f;var Jc,td,Qc,rd,eh,id,nd,tc={};function ad(){if(td)return Jc;td=1;var H=he();function h(ie,ue,ce,fe,ye){this.properties={},this.extent=ce,this.type=0,this._pbf=ie,this._geometry=-1,this._keys=fe,this._values=ye,ie.readFields(W,this,ue)}function W(ie,ue,ce){ie==1?ue.id=ce.readVarint():ie==2?function(fe,ye){for(var be=fe.readVarint()+fe.pos;fe.pos<be;){var we=ye._keys[fe.readVarint()],Ie=ye._values[fe.readVarint()];ye.properties[we]=Ie}}(ce,ue):ie==3?ue.type=ce.readVarint():ie==4&&(ue._geometry=ce.pos)}function X(ie){for(var ue,ce,fe=0,ye=0,be=ie.length,we=be-1;ye<be;we=ye++)fe+=((ce=ie[we]).x-(ue=ie[ye]).x)*(ue.y+ce.y);return fe}return Jc=h,h.types=["Unknown","Point","LineString","Polygon"],h.prototype.loadGeometry=function(){var ie=this._pbf;ie.pos=this._geometry;for(var ue,ce=ie.readVarint()+ie.pos,fe=1,ye=0,be=0,we=0,Ie=[];ie.pos<ce;){if(ye<=0){var Be=ie.readVarint();fe=7&Be,ye=Be>>3}if(ye--,fe===1||fe===2)be+=ie.readSVarint(),we+=ie.readSVarint(),fe===1&&(ue&&Ie.push(ue),ue=[]),ue.push(new H(be,we));else{if(fe!==7)throw new Error("unknown command "+fe);ue&&ue.push(ue[0].clone())}}return ue&&Ie.push(ue),Ie},h.prototype.bbox=function(){var ie=this._pbf;ie.pos=this._geometry;for(var ue=ie.readVarint()+ie.pos,ce=1,fe=0,ye=0,be=0,we=1/0,Ie=-1/0,Be=1/0,Ue=-1/0;ie.pos<ue;){if(fe<=0){var $e=ie.readVarint();ce=7&$e,fe=$e>>3}if(fe--,ce===1||ce===2)(ye+=ie.readSVarint())<we&&(we=ye),ye>Ie&&(Ie=ye),(be+=ie.readSVarint())<Be&&(Be=be),be>Ue&&(Ue=be);else if(ce!==7)throw new Error("unknown command "+ce)}return[we,Be,Ie,Ue]},h.prototype.toGeoJSON=function(ie,ue,ce){var fe,ye,be=this.extent*Math.pow(2,ce),we=this.extent*ie,Ie=this.extent*ue,Be=this.loadGeometry(),Ue=h.types[this.type];function $e(ct){for(var Ct=0;Ct<ct.length;Ct++){var wt=ct[Ct];ct[Ct]=[360*(wt.x+we)/be-180,360/Math.PI*Math.atan(Math.exp((180-360*(wt.y+Ie)/be)*Math.PI/180))-90]}}switch(this.type){case 1:var Xe=[];for(fe=0;fe<Be.length;fe++)Xe[fe]=Be[fe][0];$e(Be=Xe);break;case 2:for(fe=0;fe<Be.length;fe++)$e(Be[fe]);break;case 3:for(Be=function(ct){var Ct=ct.length;if(Ct<=1)return[ct];for(var wt,Ne,tt=[],Et=0;Et<Ct;Et++){var Ut=X(ct[Et]);Ut!==0&&(Ne===void 0&&(Ne=Ut<0),Ne===Ut<0?(wt&&tt.push(wt),wt=[ct[Et]]):wt.push(ct[Et]))}return wt&&tt.push(wt),tt}(Be),fe=0;fe<Be.length;fe++)for(ye=0;ye<Be[fe].length;ye++)$e(Be[fe][ye])}Be.length===1?Be=Be[0]:Ue="Multi"+Ue;var rt={type:"Feature",geometry:{type:Ue,coordinates:Be},properties:this.properties};return"id"in this&&(rt.id=this.id),rt},Jc}function od(){if(rd)return Qc;rd=1;var H=ad();function h(X,ie){this.version=1,this.name=null,this.extent=4096,this.length=0,this._pbf=X,this._keys=[],this._values=[],this._features=[],X.readFields(W,this,ie),this.length=this._features.length}function W(X,ie,ue){X===15?ie.version=ue.readVarint():X===1?ie.name=ue.readString():X===5?ie.extent=ue.readVarint():X===2?ie._features.push(ue.pos):X===3?ie._keys.push(ue.readString()):X===4&&ie._values.push(function(ce){for(var fe=null,ye=ce.readVarint()+ce.pos;ce.pos<ye;){var be=ce.readVarint()>>3;fe=be===1?ce.readString():be===2?ce.readFloat():be===3?ce.readDouble():be===4?ce.readVarint64():be===5?ce.readVarint():be===6?ce.readSVarint():be===7?ce.readBoolean():null}return fe}(ue))}return Qc=h,h.prototype.feature=function(X){if(X<0||X>=this._features.length)throw new Error("feature index out of bounds");this._pbf.pos=this._features[X];var ie=this._pbf.readVarint()+this._pbf.pos;return new H(this._pbf,ie,this.extent,this._keys,this._values)},Qc}function sd(){return nd||(nd=1,tc.VectorTile=function(){if(id)return eh;id=1;var H=od();function h(W,X,ie){if(W===3){var ue=new H(ie,ie.readVarint()+ie.pos);ue.length&&(X[ue.name]=ue)}}return eh=function(W,X){this.layers=W.readFields(h,{},X)},eh}(),tc.VectorTileFeature=ad(),tc.VectorTileLayer=od()),tc}var Ku=U(sd());const Zf=Ku.VectorTileFeature.types,th=Math.pow(2,13);function Yu(H,h,W,X,ie,ue,ce,fe){H.emplaceBack(h,W,2*Math.floor(X*th)+ce,ie*th*2,ue*th*2,Math.round(fe))}class rh{constructor(h){this.zoom=h.zoom,this.globalState=h.globalState,this.overscaling=h.overscaling,this.layers=h.layers,this.layerIds=this.layers.map(W=>W.id),this.index=h.index,this.hasPattern=!1,this.layoutVertexArray=new mr,this.centroidVertexArray=new jt,this.indexArray=new gi,this.programConfigurations=new _a(h.layers,h.zoom),this.segments=new li,this.stateDependentLayerIds=this.layers.filter(W=>W.isStateDependent()).map(W=>W.id)}populate(h,W,X){this.features=[],this.hasPattern=Hc("fill-extrusion",this.layers,W);for(const{feature:ie,id:ue,index:ce,sourceLayerIndex:fe}of h){const ye=this.layers[0]._featureFilter.needGeometry,be=Vo(ie,ye);if(!this.layers[0]._featureFilter.filter(new Si(this.zoom,{globalState:this.globalState}),be,X))continue;const we={id:ue,sourceLayerIndex:fe,index:ce,geometry:ye?be.geometry:Go(ie),properties:ie.properties,type:ie.type,patterns:{}};this.hasPattern?this.features.push(Zc("fill-extrusion",this.layers,we,this.zoom,W)):this.addFeature(we,we.geometry,ce,X,{},W.subdivisionGranularity),W.featureIndex.insert(ie,we.geometry,ce,fe,this.index,!0)}}addFeatures(h,W,X){for(const ie of this.features){const{geometry:ue}=ie;this.addFeature(ie,ue,ie.index,W,X,h.subdivisionGranularity)}}update(h,W,X){this.stateDependentLayers.length&&this.programConfigurations.updatePaintArrays(h,W,this.stateDependentLayers,X)}isEmpty(){return this.layoutVertexArray.length===0&&this.centroidVertexArray.length===0}uploadPending(){return!this.uploaded||this.programConfigurations.needsUpload}upload(h){this.uploaded||(this.layoutVertexBuffer=h.createVertexBuffer(this.layoutVertexArray,Hf),this.centroidVertexBuffer=h.createVertexBuffer(this.centroidVertexArray,Wf.members,!0),this.indexBuffer=h.createIndexBuffer(this.indexArray)),this.programConfigurations.upload(h),this.uploaded=!0}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy(),this.centroidVertexBuffer.destroy())}addFeature(h,W,X,ie,ue,ce){for(const fe of os(W,500)){const ye={x:0,y:0,sampleCount:0},be=this.layoutVertexArray.length;this.processPolygon(ye,ie,h,fe,ce);const we=this.layoutVertexArray.length-be,Ie=Math.floor(ye.x/ye.sampleCount),Be=Math.floor(ye.y/ye.sampleCount);for(let Ue=0;Ue<we;Ue++)this.centroidVertexArray.emplaceBack(Ie,Be)}this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,h,X,ue,ie)}processPolygon(h,W,X,ie,ue){if(ie.length<1||ud(ie[0]))return;for(const Ie of ie)Ie.length!==0&&Kf(h,Ie);const ce={segment:this.segments.prepareSegment(4,this.layoutVertexArray,this.indexArray)},fe=ue.fill.getGranularityForZoomLevel(W.z),ye=Zf[X.type]==="Polygon";for(const Ie of ie){if(Ie.length===0||ud(Ie))continue;const Be=Wo(Ie,fe,ye);this._generateSideFaces(Be,ce)}if(!ye)return;const be=Xh(ie,W,fe,!1),we=this.layoutVertexArray;Jh((Ie,Be)=>{Yu(we,Ie,Be,0,0,1,1,0)},this.segments,this.layoutVertexArray,this.indexArray,be.verticesFlattened,be.indicesTriangles)}_generateSideFaces(h,W){let X=0;for(let ie=1;ie<h.length;ie++){const ue=h[ie],ce=h[ie-1];if(Yf(ue,ce))continue;W.segment.vertexLength+4>li.MAX_VERTEX_ARRAY_LENGTH&&(W.segment=this.segments.prepareSegment(4,this.layoutVertexArray,this.indexArray));const fe=ue.sub(ce)._perp()._unit(),ye=ce.dist(ue);X+ye>32768&&(X=0),Yu(this.layoutVertexArray,ue.x,ue.y,fe.x,fe.y,0,0,X),Yu(this.layoutVertexArray,ue.x,ue.y,fe.x,fe.y,0,1,X),X+=ye,Yu(this.layoutVertexArray,ce.x,ce.y,fe.x,fe.y,0,0,X),Yu(this.layoutVertexArray,ce.x,ce.y,fe.x,fe.y,0,1,X);const be=W.segment.vertexLength;this.indexArray.emplaceBack(be,be+2,be+1),this.indexArray.emplaceBack(be+1,be+2,be+3),W.segment.vertexLength+=4,W.segment.primitiveLength+=2}}}function Kf(H,h){for(let W=0;W<h.length;W++){const X=h[W];W===h.length-1&&h[0].x===X.x&&h[0].y===X.y||(H.x+=X.x,H.y+=X.y,H.sampleCount++)}}function Yf(H,h){return H.x===h.x&&(H.x<0||H.x>Dt)||H.y===h.y&&(H.y<0||H.y>Dt)}function ud(H){return H.every(h=>h.x<0)||H.every(h=>h.x>Dt)||H.every(h=>h.y<0)||H.every(h=>h.y>Dt)}let ld;Tr("FillExtrusionBucket",rh,{omit:["layers","features"]});var Xf={get paint(){return ld=ld||new pn({"fill-extrusion-opacity":new Or(St["paint_fill-extrusion"]["fill-extrusion-opacity"]),"fill-extrusion-color":new Vr(St["paint_fill-extrusion"]["fill-extrusion-color"]),"fill-extrusion-translate":new Or(St["paint_fill-extrusion"]["fill-extrusion-translate"]),"fill-extrusion-translate-anchor":new Or(St["paint_fill-extrusion"]["fill-extrusion-translate-anchor"]),"fill-extrusion-pattern":new Ps(St["paint_fill-extrusion"]["fill-extrusion-pattern"]),"fill-extrusion-height":new Vr(St["paint_fill-extrusion"]["fill-extrusion-height"]),"fill-extrusion-base":new Vr(St["paint_fill-extrusion"]["fill-extrusion-base"]),"fill-extrusion-vertical-gradient":new Or(St["paint_fill-extrusion"]["fill-extrusion-vertical-gradient"])})}};class Jf extends Qi{constructor(h){super(h,Xf)}createBucket(h){return new rh(h)}queryRadius(){return Yl(this.paint.get("fill-extrusion-translate"))}is3D(){return!0}queryIntersectsFeature({queryGeometry:h,feature:W,featureState:X,geometry:ie,transform:ue,pixelsToTileUnits:ce,pixelPosMatrix:fe}){const ye=Xl(h,this.paint.get("fill-extrusion-translate"),this.paint.get("fill-extrusion-translate-anchor"),-ue.bearingInRadians,ce),be=this.paint.get("fill-extrusion-height").evaluate(W,X),we=this.paint.get("fill-extrusion-base").evaluate(W,X),Ie=function(Ue,$e){const Xe=[];for(const rt of Ue){const ct=[rt.x,rt.y,0,1];ft(ct,ct,$e),Xe.push(new ve(ct[0]/ct[3],ct[1]/ct[3]))}return Xe}(ye,fe),Be=function(Ue,$e,Xe,rt){const ct=[],Ct=[],wt=rt[8]*$e,Ne=rt[9]*$e,tt=rt[10]*$e,Et=rt[11]*$e,Ut=rt[8]*Xe,Jt=rt[9]*Xe,Wt=rt[10]*Xe,Kt=rt[11]*Xe;for(const ur of Ue){const tr=[],dr=[];for(const Xt of ur){const Pr=Xt.x,Ur=Xt.y,Nr=rt[0]*Pr+rt[4]*Ur+rt[12],kr=rt[1]*Pr+rt[5]*Ur+rt[13],si=rt[2]*Pr+rt[6]*Ur+rt[14],Fi=rt[3]*Pr+rt[7]*Ur+rt[15],Ui=si+tt,cn=Fi+Et,Ln=Nr+Ut,Tn=kr+Jt,nn=si+Wt,Pi=Fi+Kt,Ki=new ve((Nr+wt)/cn,(kr+Ne)/cn);Ki.z=Ui/cn,tr.push(Ki);const an=new ve(Ln/Pi,Tn/Pi);an.z=nn/Pi,dr.push(an)}ct.push(tr),Ct.push(dr)}return[ct,Ct]}(ie,we,be,fe);return function(Ue,$e,Xe){let rt=1/0;Ch(Xe,$e)&&(rt=cd(Xe,$e[0]));for(let ct=0;ct<$e.length;ct++){const Ct=$e[ct],wt=Ue[ct];for(let Ne=0;Ne<Ct.length-1;Ne++){const tt=Ct[Ne],Et=[tt,Ct[Ne+1],wt[Ne+1],wt[Ne],tt];Oh(Xe,Et)&&(rt=Math.min(rt,cd(Xe,Et)))}}return rt!==1/0&&rt}(Be[0],Be[1],Ie)}}function Xu(H,h){return H.x*h.x+H.y*h.y}function cd(H,h){if(H.length===1){let W=0;const X=h[W++];let ie;for(;!ie||X.equals(ie);)if(ie=h[W++],!ie)return 1/0;for(;W<h.length;W++){const ue=h[W],ce=H[0],fe=ie.sub(X),ye=ue.sub(X),be=ce.sub(X),we=Xu(fe,fe),Ie=Xu(fe,ye),Be=Xu(ye,ye),Ue=Xu(be,fe),$e=Xu(be,ye),Xe=we*Be-Ie*Ie,rt=(Be*Ue-Ie*$e)/Xe,ct=(we*$e-Ie*Ue)/Xe,Ct=X.z*(1-rt-ct)+ie.z*rt+ue.z*ct;if(isFinite(Ct))return Ct}return 1/0}{let W=1/0;for(const X of h)W=Math.min(W,X.z);return W}}const Qf=Di([{name:"a_pos_normal",components:2,type:"Int16"},{name:"a_data",components:4,type:"Uint8"}],4),{members:ep}=Qf,tp=Di([{name:"a_uv_x",components:1,type:"Float32"},{name:"a_split_index",components:1,type:"Float32"}]),{members:rp}=tp,ip=Ku.VectorTileFeature.types,np=Math.cos(Math.PI/180*37.5),hd=Math.pow(2,14)/.5;class ih{constructor(h){this.zoom=h.zoom,this.globalState=h.globalState,this.overscaling=h.overscaling,this.layers=h.layers,this.layerIds=this.layers.map(W=>W.id),this.index=h.index,this.hasPattern=!1,this.patternFeatures=[],this.lineClipsArray=[],this.gradients={},this.layers.forEach(W=>{this.gradients[W.id]={}}),this.layoutVertexArray=new _r,this.layoutVertexArray2=new er,this.indexArray=new gi,this.programConfigurations=new _a(h.layers,h.zoom),this.segments=new li,this.maxLineLength=0,this.stateDependentLayerIds=this.layers.filter(W=>W.isStateDependent()).map(W=>W.id)}populate(h,W,X){this.hasPattern=Hc("line",this.layers,W);const ie=this.layers[0].layout.get("line-sort-key"),ue=!ie.isConstant(),ce=[];for(const{feature:fe,id:ye,index:be,sourceLayerIndex:we}of h){const Ie=this.layers[0]._featureFilter.needGeometry,Be=Vo(fe,Ie);if(!this.layers[0]._featureFilter.filter(new Si(this.zoom,{globalState:this.globalState}),Be,X))continue;const Ue=ue?ie.evaluate(Be,{},X):void 0,$e={id:ye,properties:fe.properties,type:fe.type,sourceLayerIndex:we,index:be,geometry:Ie?Be.geometry:Go(fe),patterns:{},sortKey:Ue};ce.push($e)}ue&&ce.sort((fe,ye)=>fe.sortKey-ye.sortKey);for(const fe of ce){const{geometry:ye,index:be,sourceLayerIndex:we}=fe;if(this.hasPattern){const Ie=Zc("line",this.layers,fe,this.zoom,W);this.patternFeatures.push(Ie)}else this.addFeature(fe,ye,be,X,{},W.subdivisionGranularity);W.featureIndex.insert(h[be].feature,ye,be,we,this.index)}}update(h,W,X){this.stateDependentLayers.length&&this.programConfigurations.updatePaintArrays(h,W,this.stateDependentLayers,X)}addFeatures(h,W,X){for(const ie of this.patternFeatures)this.addFeature(ie,ie.geometry,ie.index,W,X,h.subdivisionGranularity)}isEmpty(){return this.layoutVertexArray.length===0}uploadPending(){return!this.uploaded||this.programConfigurations.needsUpload}upload(h){this.uploaded||(this.layoutVertexArray2.length!==0&&(this.layoutVertexBuffer2=h.createVertexBuffer(this.layoutVertexArray2,rp)),this.layoutVertexBuffer=h.createVertexBuffer(this.layoutVertexArray,ep),this.indexBuffer=h.createIndexBuffer(this.indexArray)),this.programConfigurations.upload(h),this.uploaded=!0}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy())}lineFeatureClips(h){if(h.properties&&Object.prototype.hasOwnProperty.call(h.properties,"mapbox_clip_start")&&Object.prototype.hasOwnProperty.call(h.properties,"mapbox_clip_end"))return{start:+h.properties.mapbox_clip_start,end:+h.properties.mapbox_clip_end}}addFeature(h,W,X,ie,ue,ce){const fe=this.layers[0].layout,ye=fe.get("line-join").evaluate(h,{}),be=fe.get("line-cap"),we=fe.get("line-miter-limit"),Ie=fe.get("line-round-limit");this.lineClips=this.lineFeatureClips(h);for(const Be of W)this.addLine(Be,h,ye,be,we,Ie,ie,ce);this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,h,X,ue,ie)}addLine(h,W,X,ie,ue,ce,fe,ye){if(this.distance=0,this.scaledDistance=0,this.totalDistance=0,h=Wo(h,fe?ye.line.getGranularityForZoomLevel(fe.z):1),this.lineClips){this.lineClipsArray.push(this.lineClips);for(let wt=0;wt<h.length-1;wt++)this.totalDistance+=h[wt].dist(h[wt+1]);this.updateScaledDistance(),this.maxLineLength=Math.max(this.maxLineLength,this.totalDistance)}const be=ip[W.type]==="Polygon";let we=h.length;for(;we>=2&&h[we-1].equals(h[we-2]);)we--;let Ie=0;for(;Ie<we-1&&h[Ie].equals(h[Ie+1]);)Ie++;if(we<(be?3:2))return;X==="bevel"&&(ue=1.05);const Be=this.overscaling<=16?122880/(512*this.overscaling):0,Ue=this.segments.prepareSegment(10*we,this.layoutVertexArray,this.indexArray);let $e,Xe,rt,ct,Ct;this.e1=this.e2=-1,be&&($e=h[we-2],Ct=h[Ie].sub($e)._unit()._perp());for(let wt=Ie;wt<we;wt++){if(rt=wt===we-1?be?h[Ie+1]:void 0:h[wt+1],rt&&h[wt].equals(rt))continue;Ct&&(ct=Ct),$e&&(Xe=$e),$e=h[wt],Ct=rt?rt.sub($e)._unit()._perp():ct,ct=ct||Ct;let Ne=ct.add(Ct);Ne.x===0&&Ne.y===0||Ne._unit();const tt=ct.x*Ct.x+ct.y*Ct.y,Et=Ne.x*Ct.x+Ne.y*Ct.y,Ut=Et!==0?1/Et:1/0,Jt=2*Math.sqrt(2-2*Et),Wt=Et<np&&Xe&&rt,Kt=ct.x*Ct.y-ct.y*Ct.x>0;if(Wt&&wt>Ie){const dr=$e.dist(Xe);if(dr>2*Be){const Xt=$e.sub($e.sub(Xe)._mult(Be/dr)._round());this.updateDistance(Xe,Xt),this.addCurrentVertex(Xt,ct,0,0,Ue),Xe=Xt}}const ur=Xe&&rt;let tr=ur?X:be?"butt":ie;if(ur&&tr==="round"&&(Ut<ce?tr="miter":Ut<=2&&(tr="fakeround")),tr==="miter"&&Ut>ue&&(tr="bevel"),tr==="bevel"&&(Ut>2&&(tr="flipbevel"),Ut<ue&&(tr="miter")),Xe&&this.updateDistance(Xe,$e),tr==="miter")Ne._mult(Ut),this.addCurrentVertex($e,Ne,0,0,Ue);else if(tr==="flipbevel"){if(Ut>100)Ne=Ct.mult(-1);else{const dr=Ut*ct.add(Ct).mag()/ct.sub(Ct).mag();Ne._perp()._mult(dr*(Kt?-1:1))}this.addCurrentVertex($e,Ne,0,0,Ue),this.addCurrentVertex($e,Ne.mult(-1),0,0,Ue)}else if(tr==="bevel"||tr==="fakeround"){const dr=-Math.sqrt(Ut*Ut-1),Xt=Kt?dr:0,Pr=Kt?0:dr;if(Xe&&this.addCurrentVertex($e,ct,Xt,Pr,Ue),tr==="fakeround"){const Ur=Math.round(180*Jt/Math.PI/20);for(let Nr=1;Nr<Ur;Nr++){let kr=Nr/Ur;if(kr!==.5){const Fi=kr-.5;kr+=kr*Fi*(kr-1)*((1.0904+tt*(tt*(3.55645-1.43519*tt)-3.2452))*Fi*Fi+(.848013+tt*(.215638*tt-1.06021)))}const si=Ct.sub(ct)._mult(kr)._add(ct)._unit()._mult(Kt?-1:1);this.addHalfVertex($e,si.x,si.y,!1,Kt,0,Ue)}}rt&&this.addCurrentVertex($e,Ct,-Xt,-Pr,Ue)}else if(tr==="butt")this.addCurrentVertex($e,Ne,0,0,Ue);else if(tr==="square"){const dr=Xe?1:-1;this.addCurrentVertex($e,Ne,dr,dr,Ue)}else tr==="round"&&(Xe&&(this.addCurrentVertex($e,ct,0,0,Ue),this.addCurrentVertex($e,ct,1,1,Ue,!0)),rt&&(this.addCurrentVertex($e,Ct,-1,-1,Ue,!0),this.addCurrentVertex($e,Ct,0,0,Ue)));if(Wt&&wt<we-1){const dr=$e.dist(rt);if(dr>2*Be){const Xt=$e.add(rt.sub($e)._mult(Be/dr)._round());this.updateDistance($e,Xt),this.addCurrentVertex(Xt,Ct,0,0,Ue),$e=Xt}}}}addCurrentVertex(h,W,X,ie,ue,ce=!1){const fe=W.y*ie-W.x,ye=-W.y-W.x*ie;this.addHalfVertex(h,W.x+W.y*X,W.y-W.x*X,ce,!1,X,ue),this.addHalfVertex(h,fe,ye,ce,!0,-ie,ue),this.distance>hd/2&&this.totalDistance===0&&(this.distance=0,this.updateScaledDistance(),this.addCurrentVertex(h,W,X,ie,ue,ce))}addHalfVertex({x:h,y:W},X,ie,ue,ce,fe,ye){const be=.5*(this.lineClips?this.scaledDistance*(hd-1):this.scaledDistance);this.layoutVertexArray.emplaceBack((h<<1)+(ue?1:0),(W<<1)+(ce?1:0),Math.round(63*X)+128,Math.round(63*ie)+128,1+(fe===0?0:fe<0?-1:1)|(63&be)<<2,be>>6),this.lineClips&&this.layoutVertexArray2.emplaceBack((this.scaledDistance-this.lineClips.start)/(this.lineClips.end-this.lineClips.start),this.lineClipsArray.length);const we=ye.vertexLength++;this.e1>=0&&this.e2>=0&&(this.indexArray.emplaceBack(this.e1,we,this.e2),ye.primitiveLength++),ce?this.e2=we:this.e1=we}updateScaledDistance(){this.scaledDistance=this.lineClips?this.lineClips.start+(this.lineClips.end-this.lineClips.start)*this.distance/this.totalDistance:this.distance}updateDistance(h,W){this.distance+=h.dist(W),this.updateScaledDistance()}}let dd,fd;Tr("LineBucket",ih,{omit:["layers","patternFeatures"]});var pd={get paint(){return fd=fd||new pn({"line-opacity":new Vr(St.paint_line["line-opacity"]),"line-color":new Vr(St.paint_line["line-color"]),"line-translate":new Or(St.paint_line["line-translate"]),"line-translate-anchor":new Or(St.paint_line["line-translate-anchor"]),"line-width":new Vr(St.paint_line["line-width"]),"line-gap-width":new Vr(St.paint_line["line-gap-width"]),"line-offset":new Vr(St.paint_line["line-offset"]),"line-blur":new Vr(St.paint_line["line-blur"]),"line-dasharray":new Mu(St.paint_line["line-dasharray"]),"line-pattern":new Ps(St.paint_line["line-pattern"]),"line-gradient":new Lo(St.paint_line["line-gradient"])})},get layout(){return dd=dd||new pn({"line-cap":new Or(St.layout_line["line-cap"]),"line-join":new Vr(St.layout_line["line-join"]),"line-miter-limit":new Or(St.layout_line["line-miter-limit"]),"line-round-limit":new Or(St.layout_line["line-round-limit"]),"line-sort-key":new Vr(St.layout_line["line-sort-key"])})}};class ap extends Vr{possiblyEvaluate(h,W){return W=new Si(Math.floor(W.zoom),{now:W.now,fadeDuration:W.fadeDuration,zoomHistory:W.zoomHistory,transition:W.transition}),super.possiblyEvaluate(h,W)}evaluate(h,W,X,ie){return W=Rr({},W,{zoom:Math.floor(W.zoom)}),super.evaluate(h,W,X,ie)}}let rc;class op extends Qi{constructor(h){super(h,pd),this.gradientVersion=0,rc||(rc=new ap(pd.paint.properties["line-width"].specification),rc.useIntegerZoom=!0)}_handleSpecialPaintPropertyUpdate(h){if(h==="line-gradient"){const W=this.gradientExpression();this.stepInterpolant=!!function(X){return X._styleExpression!==void 0}(W)&&W._styleExpression.expression instanceof La,this.gradientVersion=(this.gradientVersion+1)%Number.MAX_SAFE_INTEGER}}gradientExpression(){return this._transitionablePaint._values["line-gradient"].value.expression}recalculate(h,W){super.recalculate(h,W),this.paint._values["line-floorwidth"]=rc.possiblyEvaluate(this._transitioningPaint._values["line-width"].value,h)}createBucket(h){return new ih(h)}queryRadius(h){const W=h,X=_d(zu("line-width",this,W),zu("line-gap-width",this,W)),ie=zu("line-offset",this,W);return X/2+Math.abs(ie)+Yl(this.paint.get("line-translate"))}queryIntersectsFeature({queryGeometry:h,feature:W,featureState:X,geometry:ie,transform:ue,pixelsToTileUnits:ce}){const fe=Xl(h,this.paint.get("line-translate"),this.paint.get("line-translate-anchor"),-ue.bearingInRadians,ce),ye=ce/2*_d(this.paint.get("line-width").evaluate(W,X),this.paint.get("line-gap-width").evaluate(W,X)),be=this.paint.get("line-offset").evaluate(W,X);return be&&(ie=function(we,Ie){const Be=[];for(let Ue=0;Ue<we.length;Ue++){const $e=we[Ue],Xe=[];for(let rt=0;rt<$e.length;rt++){const ct=$e[rt-1],Ct=$e[rt],wt=$e[rt+1],Ne=rt===0?new ve(0,0):Ct.sub(ct)._unit()._perp(),tt=rt===$e.length-1?new ve(0,0):wt.sub(Ct)._unit()._perp(),Et=Ne._add(tt)._unit(),Ut=Et.x*tt.x+Et.y*tt.y;Ut!==0&&Et._mult(1/Ut),Xe.push(Et._mult(Ie)._add(Ct))}Be.push(Xe)}return Be}(ie,be*ce)),function(we,Ie,Be){for(let Ue=0;Ue<Ie.length;Ue++){const $e=Ie[Ue];if(we.length>=3){for(let Xe=0;Xe<$e.length;Xe++)if(Ms(we,$e[Xe]))return!0}if(vf(we,$e,Be))return!0}return!1}(fe,ie,ye)}isTileClipped(){return!0}}function _d(H,h){return h>0?h+2*H:H}const sp=Di([{name:"a_pos_offset",components:4,type:"Int16"},{name:"a_data",components:4,type:"Uint16"},{name:"a_pixeloffset",components:4,type:"Int16"}],4),up=Di([{name:"a_projected_pos",components:3,type:"Float32"}],4);Di([{name:"a_fade_opacity",components:1,type:"Uint32"}],4);const lp=Di([{name:"a_placed",components:2,type:"Uint8"},{name:"a_shift",components:2,type:"Float32"},{name:"a_box_real",components:2,type:"Int16"}]);Di([{type:"Int16",name:"anchorPointX"},{type:"Int16",name:"anchorPointY"},{type:"Int16",name:"x1"},{type:"Int16",name:"y1"},{type:"Int16",name:"x2"},{type:"Int16",name:"y2"},{type:"Uint32",name:"featureIndex"},{type:"Uint16",name:"sourceLayerIndex"},{type:"Uint16",name:"bucketIndex"}]);const md=Di([{name:"a_pos",components:2,type:"Int16"},{name:"a_anchor_pos",components:2,type:"Int16"},{name:"a_extrude",components:2,type:"Int16"}],4),cp=Di([{name:"a_pos",components:2,type:"Float32"},{name:"a_radius",components:1,type:"Float32"},{name:"a_flags",components:2,type:"Int16"}],4);function hp(H,h,W){return H.sections.forEach(X=>{X.text=function(ie,ue,ce){const fe=ue.layout.get("text-transform").evaluate(ce,{});return fe==="uppercase"?ie=ie.toLocaleUpperCase():fe==="lowercase"&&(ie=ie.toLocaleLowerCase()),ua.applyArabicShaping&&(ie=ua.applyArabicShaping(ie)),ie}(X.text,h,W)}),H}Di([{name:"triangle",components:3,type:"Uint16"}]),Di([{type:"Int16",name:"anchorX"},{type:"Int16",name:"anchorY"},{type:"Uint16",name:"glyphStartIndex"},{type:"Uint16",name:"numGlyphs"},{type:"Uint32",name:"vertexStartIndex"},{type:"Uint32",name:"lineStartIndex"},{type:"Uint32",name:"lineLength"},{type:"Uint16",name:"segment"},{type:"Uint16",name:"lowerSize"},{type:"Uint16",name:"upperSize"},{type:"Float32",name:"lineOffsetX"},{type:"Float32",name:"lineOffsetY"},{type:"Uint8",name:"writingMode"},{type:"Uint8",name:"placedOrientation"},{type:"Uint8",name:"hidden"},{type:"Uint32",name:"crossTileID"},{type:"Int16",name:"associatedIconIndex"}]),Di([{type:"Int16",name:"anchorX"},{type:"Int16",name:"anchorY"},{type:"Int16",name:"rightJustifiedTextSymbolIndex"},{type:"Int16",name:"centerJustifiedTextSymbolIndex"},{type:"Int16",name:"leftJustifiedTextSymbolIndex"},{type:"Int16",name:"verticalPlacedTextSymbolIndex"},{type:"Int16",name:"placedIconSymbolIndex"},{type:"Int16",name:"verticalPlacedIconSymbolIndex"},{type:"Uint16",name:"key"},{type:"Uint16",name:"textBoxStartIndex"},{type:"Uint16",name:"textBoxEndIndex"},{type:"Uint16",name:"verticalTextBoxStartIndex"},{type:"Uint16",name:"verticalTextBoxEndIndex"},{type:"Uint16",name:"iconBoxStartIndex"},{type:"Uint16",name:"iconBoxEndIndex"},{type:"Uint16",name:"verticalIconBoxStartIndex"},{type:"Uint16",name:"verticalIconBoxEndIndex"},{type:"Uint16",name:"featureIndex"},{type:"Uint16",name:"numHorizontalGlyphVertices"},{type:"Uint16",name:"numVerticalGlyphVertices"},{type:"Uint16",name:"numIconVertices"},{type:"Uint16",name:"numVerticalIconVertices"},{type:"Uint16",name:"useRuntimeCollisionCircles"},{type:"Uint32",name:"crossTileID"},{type:"Float32",name:"textBoxScale"},{type:"Float32",name:"collisionCircleDiameter"},{type:"Uint16",name:"textAnchorOffsetStartIndex"},{type:"Uint16",name:"textAnchorOffsetEndIndex"}]),Di([{type:"Float32",name:"offsetX"}]),Di([{type:"Int16",name:"x"},{type:"Int16",name:"y"},{type:"Int16",name:"tileUnitDistanceFromAnchor"}]),Di([{type:"Uint16",name:"textAnchor"},{type:"Float32",components:2,name:"textOffset"}]);const Ju={"!":"︕","#":"＃",$:"＄","%":"％","&":"＆","(":"︵",")":"︶","*":"＊","+":"＋",",":"︐","-":"︲",".":"・","/":"／",":":"︓",";":"︔","<":"︿","=":"＝",">":"﹀","?":"︖","@":"＠","[":"﹇","\\":"＼","]":"﹈","^":"＾",_:"︳","`":"｀","{":"︷","|":"―","}":"︸","~":"～","¢":"￠","£":"￡","¥":"￥","¦":"￤","¬":"￢","¯":"￣","–":"︲","—":"︱","‘":"﹃","’":"﹄","“":"﹁","”":"﹂","…":"︙","‧":"・","₩":"￦","、":"︑","。":"︒","〈":"︿","〉":"﹀","《":"︽","》":"︾","「":"﹁","」":"﹂","『":"﹃","』":"﹄","【":"︻","】":"︼","〔":"︹","〕":"︺","〖":"︗","〗":"︘","！":"︕","（":"︵","）":"︶","，":"︐","－":"︲","．":"・","：":"︓","；":"︔","＜":"︿","＞":"﹀","？":"︖","［":"﹇","］":"﹈","＿":"︳","｛":"︷","｜":"―","｝":"︸","｟":"︵","｠":"︶","｡":"︒","｢":"﹁","｣":"﹂"};var yd,nh,gd,Zi=24,ah={};function dp(){return yd||(yd=1,ah.read=function(H,h,W,X,ie){var ue,ce,fe=8*ie-X-1,ye=(1<<fe)-1,be=ye>>1,we=-7,Ie=W?ie-1:0,Be=W?-1:1,Ue=H[h+Ie];for(Ie+=Be,ue=Ue&(1<<-we)-1,Ue>>=-we,we+=fe;we>0;ue=256*ue+H[h+Ie],Ie+=Be,we-=8);for(ce=ue&(1<<-we)-1,ue>>=-we,we+=X;we>0;ce=256*ce+H[h+Ie],Ie+=Be,we-=8);if(ue===0)ue=1-be;else{if(ue===ye)return ce?NaN:1/0*(Ue?-1:1);ce+=Math.pow(2,X),ue-=be}return(Ue?-1:1)*ce*Math.pow(2,ue-X)},ah.write=function(H,h,W,X,ie,ue){var ce,fe,ye,be=8*ue-ie-1,we=(1<<be)-1,Ie=we>>1,Be=ie===23?Math.pow(2,-24)-Math.pow(2,-77):0,Ue=X?0:ue-1,$e=X?1:-1,Xe=h<0||h===0&&1/h<0?1:0;for(h=Math.abs(h),isNaN(h)||h===1/0?(fe=isNaN(h)?1:0,ce=we):(ce=Math.floor(Math.log(h)/Math.LN2),h*(ye=Math.pow(2,-ce))<1&&(ce--,ye*=2),(h+=ce+Ie>=1?Be/ye:Be*Math.pow(2,1-Ie))*ye>=2&&(ce++,ye/=2),ce+Ie>=we?(fe=0,ce=we):ce+Ie>=1?(fe=(h*ye-1)*Math.pow(2,ie),ce+=Ie):(fe=h*Math.pow(2,Ie-1)*Math.pow(2,ie),ce=0));ie>=8;H[W+Ue]=255&fe,Ue+=$e,fe/=256,ie-=8);for(ce=ce<<ie|fe,be+=ie;be>0;H[W+Ue]=255&ce,Ue+=$e,ce/=256,be-=8);H[W+Ue-$e]|=128*Xe}),ah}function vd(){if(gd)return nh;gd=1,nh=h;var H=dp();function h(Ne){this.buf=ArrayBuffer.isView&&ArrayBuffer.isView(Ne)?Ne:new Uint8Array(Ne||0),this.pos=0,this.type=0,this.length=this.buf.length}h.Varint=0,h.Fixed64=1,h.Bytes=2,h.Fixed32=5;var W=4294967296,X=1/W,ie=typeof TextDecoder>"u"?null:new TextDecoder("utf-8");function ue(Ne){return Ne.type===h.Bytes?Ne.readVarint()+Ne.pos:Ne.pos+1}function ce(Ne,tt,Et){return Et?4294967296*tt+(Ne>>>0):4294967296*(tt>>>0)+(Ne>>>0)}function fe(Ne,tt,Et){var Ut=tt<=16383?1:tt<=2097151?2:tt<=268435455?3:Math.floor(Math.log(tt)/(7*Math.LN2));Et.realloc(Ut);for(var Jt=Et.pos-1;Jt>=Ne;Jt--)Et.buf[Jt+Ut]=Et.buf[Jt]}function ye(Ne,tt){for(var Et=0;Et<Ne.length;Et++)tt.writeVarint(Ne[Et])}function be(Ne,tt){for(var Et=0;Et<Ne.length;Et++)tt.writeSVarint(Ne[Et])}function we(Ne,tt){for(var Et=0;Et<Ne.length;Et++)tt.writeFloat(Ne[Et])}function Ie(Ne,tt){for(var Et=0;Et<Ne.length;Et++)tt.writeDouble(Ne[Et])}function Be(Ne,tt){for(var Et=0;Et<Ne.length;Et++)tt.writeBoolean(Ne[Et])}function Ue(Ne,tt){for(var Et=0;Et<Ne.length;Et++)tt.writeFixed32(Ne[Et])}function $e(Ne,tt){for(var Et=0;Et<Ne.length;Et++)tt.writeSFixed32(Ne[Et])}function Xe(Ne,tt){for(var Et=0;Et<Ne.length;Et++)tt.writeFixed64(Ne[Et])}function rt(Ne,tt){for(var Et=0;Et<Ne.length;Et++)tt.writeSFixed64(Ne[Et])}function ct(Ne,tt){return(Ne[tt]|Ne[tt+1]<<8|Ne[tt+2]<<16)+16777216*Ne[tt+3]}function Ct(Ne,tt,Et){Ne[Et]=tt,Ne[Et+1]=tt>>>8,Ne[Et+2]=tt>>>16,Ne[Et+3]=tt>>>24}function wt(Ne,tt){return(Ne[tt]|Ne[tt+1]<<8|Ne[tt+2]<<16)+(Ne[tt+3]<<24)}return h.prototype={destroy:function(){this.buf=null},readFields:function(Ne,tt,Et){for(Et=Et||this.length;this.pos<Et;){var Ut=this.readVarint(),Jt=Ut>>3,Wt=this.pos;this.type=7&Ut,Ne(Jt,tt,this),this.pos===Wt&&this.skip(Ut)}return tt},readMessage:function(Ne,tt){return this.readFields(Ne,tt,this.readVarint()+this.pos)},readFixed32:function(){var Ne=ct(this.buf,this.pos);return this.pos+=4,Ne},readSFixed32:function(){var Ne=wt(this.buf,this.pos);return this.pos+=4,Ne},readFixed64:function(){var Ne=ct(this.buf,this.pos)+ct(this.buf,this.pos+4)*W;return this.pos+=8,Ne},readSFixed64:function(){var Ne=ct(this.buf,this.pos)+wt(this.buf,this.pos+4)*W;return this.pos+=8,Ne},readFloat:function(){var Ne=H.read(this.buf,this.pos,!0,23,4);return this.pos+=4,Ne},readDouble:function(){var Ne=H.read(this.buf,this.pos,!0,52,8);return this.pos+=8,Ne},readVarint:function(Ne){var tt,Et,Ut=this.buf;return tt=127&(Et=Ut[this.pos++]),Et<128?tt:(tt|=(127&(Et=Ut[this.pos++]))<<7,Et<128?tt:(tt|=(127&(Et=Ut[this.pos++]))<<14,Et<128?tt:(tt|=(127&(Et=Ut[this.pos++]))<<21,Et<128?tt:function(Jt,Wt,Kt){var ur,tr,dr=Kt.buf;if(ur=(112&(tr=dr[Kt.pos++]))>>4,tr<128||(ur|=(127&(tr=dr[Kt.pos++]))<<3,tr<128)||(ur|=(127&(tr=dr[Kt.pos++]))<<10,tr<128)||(ur|=(127&(tr=dr[Kt.pos++]))<<17,tr<128)||(ur|=(127&(tr=dr[Kt.pos++]))<<24,tr<128)||(ur|=(1&(tr=dr[Kt.pos++]))<<31,tr<128))return ce(Jt,ur,Wt);throw new Error("Expected varint not more than 10 bytes")}(tt|=(15&(Et=Ut[this.pos]))<<28,Ne,this))))},readVarint64:function(){return this.readVarint(!0)},readSVarint:function(){var Ne=this.readVarint();return Ne%2==1?(Ne+1)/-2:Ne/2},readBoolean:function(){return!!this.readVarint()},readString:function(){var Ne=this.readVarint()+this.pos,tt=this.pos;return this.pos=Ne,Ne-tt>=12&&ie?function(Et,Ut,Jt){return ie.decode(Et.subarray(Ut,Jt))}(this.buf,tt,Ne):function(Et,Ut,Jt){for(var Wt="",Kt=Ut;Kt<Jt;){var ur,tr,dr,Xt=Et[Kt],Pr=null,Ur=Xt>239?4:Xt>223?3:Xt>191?2:1;if(Kt+Ur>Jt)break;Ur===1?Xt<128&&(Pr=Xt):Ur===2?(192&(ur=Et[Kt+1]))==128&&(Pr=(31&Xt)<<6|63&ur)<=127&&(Pr=null):Ur===3?(tr=Et[Kt+2],(192&(ur=Et[Kt+1]))==128&&(192&tr)==128&&((Pr=(15&Xt)<<12|(63&ur)<<6|63&tr)<=2047||Pr>=55296&&Pr<=57343)&&(Pr=null)):Ur===4&&(tr=Et[Kt+2],dr=Et[Kt+3],(192&(ur=Et[Kt+1]))==128&&(192&tr)==128&&(192&dr)==128&&((Pr=(15&Xt)<<18|(63&ur)<<12|(63&tr)<<6|63&dr)<=65535||Pr>=1114112)&&(Pr=null)),Pr===null?(Pr=65533,Ur=1):Pr>65535&&(Pr-=65536,Wt+=String.fromCharCode(Pr>>>10&1023|55296),Pr=56320|1023&Pr),Wt+=String.fromCharCode(Pr),Kt+=Ur}return Wt}(this.buf,tt,Ne)},readBytes:function(){var Ne=this.readVarint()+this.pos,tt=this.buf.subarray(this.pos,Ne);return this.pos=Ne,tt},readPackedVarint:function(Ne,tt){if(this.type!==h.Bytes)return Ne.push(this.readVarint(tt));var Et=ue(this);for(Ne=Ne||[];this.pos<Et;)Ne.push(this.readVarint(tt));return Ne},readPackedSVarint:function(Ne){if(this.type!==h.Bytes)return Ne.push(this.readSVarint());var tt=ue(this);for(Ne=Ne||[];this.pos<tt;)Ne.push(this.readSVarint());return Ne},readPackedBoolean:function(Ne){if(this.type!==h.Bytes)return Ne.push(this.readBoolean());var tt=ue(this);for(Ne=Ne||[];this.pos<tt;)Ne.push(this.readBoolean());return Ne},readPackedFloat:function(Ne){if(this.type!==h.Bytes)return Ne.push(this.readFloat());var tt=ue(this);for(Ne=Ne||[];this.pos<tt;)Ne.push(this.readFloat());return Ne},readPackedDouble:function(Ne){if(this.type!==h.Bytes)return Ne.push(this.readDouble());var tt=ue(this);for(Ne=Ne||[];this.pos<tt;)Ne.push(this.readDouble());return Ne},readPackedFixed32:function(Ne){if(this.type!==h.Bytes)return Ne.push(this.readFixed32());var tt=ue(this);for(Ne=Ne||[];this.pos<tt;)Ne.push(this.readFixed32());return Ne},readPackedSFixed32:function(Ne){if(this.type!==h.Bytes)return Ne.push(this.readSFixed32());var tt=ue(this);for(Ne=Ne||[];this.pos<tt;)Ne.push(this.readSFixed32());return Ne},readPackedFixed64:function(Ne){if(this.type!==h.Bytes)return Ne.push(this.readFixed64());var tt=ue(this);for(Ne=Ne||[];this.pos<tt;)Ne.push(this.readFixed64());return Ne},readPackedSFixed64:function(Ne){if(this.type!==h.Bytes)return Ne.push(this.readSFixed64());var tt=ue(this);for(Ne=Ne||[];this.pos<tt;)Ne.push(this.readSFixed64());return Ne},skip:function(Ne){var tt=7&Ne;if(tt===h.Varint)for(;this.buf[this.pos++]>127;);else if(tt===h.Bytes)this.pos=this.readVarint()+this.pos;else if(tt===h.Fixed32)this.pos+=4;else{if(tt!==h.Fixed64)throw new Error("Unimplemented type: "+tt);this.pos+=8}},writeTag:function(Ne,tt){this.writeVarint(Ne<<3|tt)},realloc:function(Ne){for(var tt=this.length||16;tt<this.pos+Ne;)tt*=2;if(tt!==this.length){var Et=new Uint8Array(tt);Et.set(this.buf),this.buf=Et,this.length=tt}},finish:function(){return this.length=this.pos,this.pos=0,this.buf.subarray(0,this.length)},writeFixed32:function(Ne){this.realloc(4),Ct(this.buf,Ne,this.pos),this.pos+=4},writeSFixed32:function(Ne){this.realloc(4),Ct(this.buf,Ne,this.pos),this.pos+=4},writeFixed64:function(Ne){this.realloc(8),Ct(this.buf,-1&Ne,this.pos),Ct(this.buf,Math.floor(Ne*X),this.pos+4),this.pos+=8},writeSFixed64:function(Ne){this.realloc(8),Ct(this.buf,-1&Ne,this.pos),Ct(this.buf,Math.floor(Ne*X),this.pos+4),this.pos+=8},writeVarint:function(Ne){(Ne=+Ne||0)>268435455||Ne<0?function(tt,Et){var Ut,Jt;if(tt>=0?(Ut=tt%4294967296|0,Jt=tt/4294967296|0):(Jt=~(-tt/4294967296),4294967295^(Ut=~(-tt%4294967296))?Ut=Ut+1|0:(Ut=0,Jt=Jt+1|0)),tt>=18446744073709552e3||tt<-18446744073709552e3)throw new Error("Given varint doesn't fit into 10 bytes");Et.realloc(10),function(Wt,Kt,ur){ur.buf[ur.pos++]=127&Wt|128,Wt>>>=7,ur.buf[ur.pos++]=127&Wt|128,Wt>>>=7,ur.buf[ur.pos++]=127&Wt|128,Wt>>>=7,ur.buf[ur.pos++]=127&Wt|128,ur.buf[ur.pos]=127&(Wt>>>=7)}(Ut,0,Et),function(Wt,Kt){var ur=(7&Wt)<<4;Kt.buf[Kt.pos++]|=ur|((Wt>>>=3)?128:0),Wt&&(Kt.buf[Kt.pos++]=127&Wt|((Wt>>>=7)?128:0),Wt&&(Kt.buf[Kt.pos++]=127&Wt|((Wt>>>=7)?128:0),Wt&&(Kt.buf[Kt.pos++]=127&Wt|((Wt>>>=7)?128:0),Wt&&(Kt.buf[Kt.pos++]=127&Wt|((Wt>>>=7)?128:0),Wt&&(Kt.buf[Kt.pos++]=127&Wt)))))}(Jt,Et)}(Ne,this):(this.realloc(4),this.buf[this.pos++]=127&Ne|(Ne>127?128:0),Ne<=127||(this.buf[this.pos++]=127&(Ne>>>=7)|(Ne>127?128:0),Ne<=127||(this.buf[this.pos++]=127&(Ne>>>=7)|(Ne>127?128:0),Ne<=127||(this.buf[this.pos++]=Ne>>>7&127))))},writeSVarint:function(Ne){this.writeVarint(Ne<0?2*-Ne-1:2*Ne)},writeBoolean:function(Ne){this.writeVarint(!!Ne)},writeString:function(Ne){Ne=String(Ne),this.realloc(4*Ne.length),this.pos++;var tt=this.pos;this.pos=function(Ut,Jt,Wt){for(var Kt,ur,tr=0;tr<Jt.length;tr++){if((Kt=Jt.charCodeAt(tr))>55295&&Kt<57344){if(!ur){Kt>56319||tr+1===Jt.length?(Ut[Wt++]=239,Ut[Wt++]=191,Ut[Wt++]=189):ur=Kt;continue}if(Kt<56320){Ut[Wt++]=239,Ut[Wt++]=191,Ut[Wt++]=189,ur=Kt;continue}Kt=ur-55296<<10|Kt-56320|65536,ur=null}else ur&&(Ut[Wt++]=239,Ut[Wt++]=191,Ut[Wt++]=189,ur=null);Kt<128?Ut[Wt++]=Kt:(Kt<2048?Ut[Wt++]=Kt>>6|192:(Kt<65536?Ut[Wt++]=Kt>>12|224:(Ut[Wt++]=Kt>>18|240,Ut[Wt++]=Kt>>12&63|128),Ut[Wt++]=Kt>>6&63|128),Ut[Wt++]=63&Kt|128)}return Wt}(this.buf,Ne,this.pos);var Et=this.pos-tt;Et>=128&&fe(tt,Et,this),this.pos=tt-1,this.writeVarint(Et),this.pos+=Et},writeFloat:function(Ne){this.realloc(4),H.write(this.buf,Ne,this.pos,!0,23,4),this.pos+=4},writeDouble:function(Ne){this.realloc(8),H.write(this.buf,Ne,this.pos,!0,52,8),this.pos+=8},writeBytes:function(Ne){var tt=Ne.length;this.writeVarint(tt),this.realloc(tt);for(var Et=0;Et<tt;Et++)this.buf[this.pos++]=Ne[Et]},writeRawMessage:function(Ne,tt){this.pos++;var Et=this.pos;Ne(tt,this);var Ut=this.pos-Et;Ut>=128&&fe(Et,Ut,this),this.pos=Et-1,this.writeVarint(Ut),this.pos+=Ut},writeMessage:function(Ne,tt,Et){this.writeTag(Ne,h.Bytes),this.writeRawMessage(tt,Et)},writePackedVarint:function(Ne,tt){tt.length&&this.writeMessage(Ne,ye,tt)},writePackedSVarint:function(Ne,tt){tt.length&&this.writeMessage(Ne,be,tt)},writePackedBoolean:function(Ne,tt){tt.length&&this.writeMessage(Ne,Be,tt)},writePackedFloat:function(Ne,tt){tt.length&&this.writeMessage(Ne,we,tt)},writePackedDouble:function(Ne,tt){tt.length&&this.writeMessage(Ne,Ie,tt)},writePackedFixed32:function(Ne,tt){tt.length&&this.writeMessage(Ne,Ue,tt)},writePackedSFixed32:function(Ne,tt){tt.length&&this.writeMessage(Ne,$e,tt)},writePackedFixed64:function(Ne,tt){tt.length&&this.writeMessage(Ne,Xe,tt)},writePackedSFixed64:function(Ne,tt){tt.length&&this.writeMessage(Ne,rt,tt)},writeBytesField:function(Ne,tt){this.writeTag(Ne,h.Bytes),this.writeBytes(tt)},writeFixed32Field:function(Ne,tt){this.writeTag(Ne,h.Fixed32),this.writeFixed32(tt)},writeSFixed32Field:function(Ne,tt){this.writeTag(Ne,h.Fixed32),this.writeSFixed32(tt)},writeFixed64Field:function(Ne,tt){this.writeTag(Ne,h.Fixed64),this.writeFixed64(tt)},writeSFixed64Field:function(Ne,tt){this.writeTag(Ne,h.Fixed64),this.writeSFixed64(tt)},writeVarintField:function(Ne,tt){this.writeTag(Ne,h.Varint),this.writeVarint(tt)},writeSVarintField:function(Ne,tt){this.writeTag(Ne,h.Varint),this.writeSVarint(tt)},writeStringField:function(Ne,tt){this.writeTag(Ne,h.Bytes),this.writeString(tt)},writeFloatField:function(Ne,tt){this.writeTag(Ne,h.Fixed32),this.writeFloat(tt)},writeDoubleField:function(Ne,tt){this.writeTag(Ne,h.Fixed64),this.writeDouble(tt)},writeBooleanField:function(Ne,tt){this.writeVarintField(Ne,!!tt)}},nh}var ao,oh=U(vd());function fp(H,h,W){H===1&&W.readMessage(pp,h)}function pp(H,h,W){if(H===3){const{id:X,bitmap:ie,width:ue,height:ce,left:fe,top:ye,advance:be}=W.readMessage(_p,{});h.push({id:X,bitmap:new Uu({width:ue+6,height:ce+6},ie),metrics:{width:ue,height:ce,left:fe,top:ye,advance:be}})}}function _p(H,h,W){H===1?h.id=W.readVarint():H===2?h.bitmap=W.readBytes():H===3?h.width=W.readVarint():H===4?h.height=W.readVarint():H===5?h.left=W.readSVarint():H===6?h.top=W.readSVarint():H===7&&(h.advance=W.readVarint())}function bd(H){let h=0,W=0;for(const ce of H)h+=ce.w*ce.h,W=Math.max(W,ce.w);H.sort((ce,fe)=>fe.h-ce.h);const X=[{x:0,y:0,w:Math.max(Math.ceil(Math.sqrt(h/.95)),W),h:1/0}];let ie=0,ue=0;for(const ce of H)for(let fe=X.length-1;fe>=0;fe--){const ye=X[fe];if(!(ce.w>ye.w||ce.h>ye.h)){if(ce.x=ye.x,ce.y=ye.y,ue=Math.max(ue,ce.y+ce.h),ie=Math.max(ie,ce.x+ce.w),ce.w===ye.w&&ce.h===ye.h){const be=X.pop();fe<X.length&&(X[fe]=be)}else ce.h===ye.h?(ye.x+=ce.w,ye.w-=ce.w):ce.w===ye.w?(ye.y+=ce.h,ye.h-=ce.h):(X.push({x:ye.x+ce.w,y:ye.y,w:ye.w-ce.w,h:ce.h}),ye.y+=ce.h,ye.h-=ce.h);break}}return{w:ie,h:ue,fill:h/(ie*ue)||0}}class sh{constructor(h,{pixelRatio:W,version:X,stretchX:ie,stretchY:ue,content:ce,textFitWidth:fe,textFitHeight:ye}){this.paddedRect=h,this.pixelRatio=W,this.stretchX=ie,this.stretchY=ue,this.content=ce,this.version=X,this.textFitWidth=fe,this.textFitHeight=ye}get tl(){return[this.paddedRect.x+1,this.paddedRect.y+1]}get br(){return[this.paddedRect.x+this.paddedRect.w-1,this.paddedRect.y+this.paddedRect.h-1]}get tlbr(){return this.tl.concat(this.br)}get displaySize(){return[(this.paddedRect.w-2)/this.pixelRatio,(this.paddedRect.h-2)/this.pixelRatio]}}class xd{constructor(h,W){const X={},ie={};this.haveRenderCallbacks=[];const ue=[];this.addImages(h,X,ue),this.addImages(W,ie,ue);const{w:ce,h:fe}=bd(ue),ye=new qn({width:ce||1,height:fe||1});for(const be in h){const we=h[be],Ie=X[be].paddedRect;qn.copy(we.data,ye,{x:0,y:0},{x:Ie.x+1,y:Ie.y+1},we.data)}for(const be in W){const we=W[be],Ie=ie[be].paddedRect,Be=Ie.x+1,Ue=Ie.y+1,$e=we.data.width,Xe=we.data.height;qn.copy(we.data,ye,{x:0,y:0},{x:Be,y:Ue},we.data),qn.copy(we.data,ye,{x:0,y:Xe-1},{x:Be,y:Ue-1},{width:$e,height:1}),qn.copy(we.data,ye,{x:0,y:0},{x:Be,y:Ue+Xe},{width:$e,height:1}),qn.copy(we.data,ye,{x:$e-1,y:0},{x:Be-1,y:Ue},{width:1,height:Xe}),qn.copy(we.data,ye,{x:0,y:0},{x:Be+$e,y:Ue},{width:1,height:Xe})}this.image=ye,this.iconPositions=X,this.patternPositions=ie}addImages(h,W,X){for(const ie in h){const ue=h[ie],ce={x:0,y:0,w:ue.data.width+2,h:ue.data.height+2};X.push(ce),W[ie]=new sh(ce,ue),ue.hasRenderCallback&&this.haveRenderCallbacks.push(ie)}}patchUpdatedImages(h,W){h.dispatchRenderCallbacks(this.haveRenderCallbacks);for(const X in h.updatedImages)this.patchUpdatedImage(this.iconPositions[X],h.getImage(X),W),this.patchUpdatedImage(this.patternPositions[X],h.getImage(X),W)}patchUpdatedImage(h,W,X){if(!h||!W||h.version===W.version)return;h.version=W.version;const[ie,ue]=h.tl;X.update(W.data,void 0,{x:ie,y:ue})}}Tr("ImagePosition",sh),Tr("ImageAtlas",xd),Q.an=void 0,(ao=Q.an||(Q.an={}))[ao.none=0]="none",ao[ao.horizontal=1]="horizontal",ao[ao.vertical=2]="vertical",ao[ao.horizontalOnly=3]="horizontalOnly";class Qu{constructor(){this.scale=1,this.fontStack="",this.imageName=null,this.verticalAlign="bottom"}static forText(h,W,X){const ie=new Qu;return ie.scale=h||1,ie.fontStack=W,ie.verticalAlign=X||"bottom",ie}static forImage(h,W){const X=new Qu;return X.imageName=h,X.verticalAlign=W||"bottom",X}}class Ls{constructor(){this.text="",this.sectionIndex=[],this.sections=[],this.imageSectionID=null}static fromFeature(h,W){const X=new Ls;for(let ie=0;ie<h.sections.length;ie++){const ue=h.sections[ie];ue.image?X.addImageSection(ue):X.addTextSection(ue,W)}return X}length(){return this.text.length}getSection(h){return this.sections[this.sectionIndex[h]]}getSectionIndex(h){return this.sectionIndex[h]}getCharCode(h){return this.text.charCodeAt(h)}verticalizePunctuation(){this.text=function(h){let W="";for(let X=0;X<h.length;X++){const ie=h.charCodeAt(X+1)||null,ue=h.charCodeAt(X-1)||null;W+=ie&&Pu(ie)&&!Ju[h[X+1]]||ue&&Pu(ue)&&!Ju[h[X-1]]||!Ju[h[X]]?h[X]:Ju[h[X]]}return W}(this.text)}trim(){let h=0;for(let X=0;X<this.text.length&&nc[this.text.charCodeAt(X)];X++)h++;let W=this.text.length;for(let X=this.text.length-1;X>=0&&X>=h&&nc[this.text.charCodeAt(X)];X--)W--;this.text=this.text.substring(h,W),this.sectionIndex=this.sectionIndex.slice(h,W)}substring(h,W){const X=new Ls;return X.text=this.text.substring(h,W),X.sectionIndex=this.sectionIndex.slice(h,W),X.sections=this.sections,X}toString(){return this.text}getMaxScale(){return this.sectionIndex.reduce((h,W)=>Math.max(h,this.sections[W].scale),0)}getMaxImageSize(h){let W=0,X=0;for(let ie=0;ie<this.length();ie++){const ue=this.getSection(ie);if(ue.imageName){const ce=h[ue.imageName];if(!ce)continue;const fe=ce.displaySize;W=Math.max(W,fe[0]),X=Math.max(X,fe[1])}}return{maxImageWidth:W,maxImageHeight:X}}addTextSection(h,W){this.text+=h.text,this.sections.push(Qu.forText(h.scale,h.fontStack||W,h.verticalAlign));const X=this.sections.length-1;for(let ie=0;ie<h.text.length;++ie)this.sectionIndex.push(X)}addImageSection(h){const W=h.image?h.image.name:"";if(W.length===0)return void br("Can't add FormattedSection with an empty image.");const X=this.getNextImageSectionCharCode();X?(this.text+=String.fromCharCode(X),this.sections.push(Qu.forImage(W,h.verticalAlign)),this.sectionIndex.push(this.sections.length-1)):br("Reached maximum number of images 6401")}getNextImageSectionCharCode(){return this.imageSectionID?this.imageSectionID>=63743?null:++this.imageSectionID:(this.imageSectionID=57344,this.imageSectionID)}}function ic(H,h,W,X,ie,ue,ce,fe,ye,be,we,Ie,Be,Ue,$e){const Xe=Ls.fromFeature(H,ie);let rt;Ie===Q.an.vertical&&Xe.verticalizePunctuation();const{processBidirectionalText:ct,processStyledBidirectionalText:Ct}=ua;if(ct&&Xe.sections.length===1){rt=[];const tt=ct(Xe.toString(),uh(Xe,be,ue,h,X,Ue));for(const Et of tt){const Ut=new Ls;Ut.text=Et,Ut.sections=Xe.sections;for(let Jt=0;Jt<Et.length;Jt++)Ut.sectionIndex.push(0);rt.push(Ut)}}else if(Ct){rt=[];const tt=Ct(Xe.text,Xe.sectionIndex,uh(Xe,be,ue,h,X,Ue));for(const Et of tt){const Ut=new Ls;Ut.text=Et[0],Ut.sectionIndex=Et[1],Ut.sections=Xe.sections,rt.push(Ut)}}else rt=function(tt,Et){const Ut=[],Jt=tt.text;let Wt=0;for(const Kt of Et)Ut.push(tt.substring(Wt,Kt)),Wt=Kt;return Wt<Jt.length&&Ut.push(tt.substring(Wt,Jt.length)),Ut}(Xe,uh(Xe,be,ue,h,X,Ue));const wt=[],Ne={positionedLines:wt,text:Xe.toString(),top:we[1],bottom:we[1],left:we[0],right:we[0],writingMode:Ie,iconsInText:!1,verticalizable:!1};return function(tt,Et,Ut,Jt,Wt,Kt,ur,tr,dr,Xt,Pr,Ur){let Nr=0,kr=0,si=0,Fi=0;const Ui=tr==="right"?1:tr==="left"?0:.5,cn=Zi/Ur;let Ln=0;for(const Pi of Wt){Pi.trim();const Ki=Pi.getMaxScale(),an={positionedGlyphs:[],lineOffset:0};tt.positionedLines[Ln]=an;const on=an.positionedGlyphs;let Sn=0;if(!Pi.length()){kr+=Kt,++Ln;continue}const Bn=vp(Jt,Pi,cn);for(let In=0;In<Pi.length();In++){const Gi=Pi.getSection(In),Xi=Pi.getSectionIndex(In),Ji=Pi.getCharCode(In),Ni=bp(dr,Pr,Ji);let wi;if(Gi.imageName){if(tt.iconsInText=!0,Gi.scale=Gi.scale*cn,wi=wp(Gi,Ni,Ki,Bn,Jt),!wi)continue;Sn=Math.max(Sn,wi.imageOffset)}else if(wi=xp(Gi,Ji,Ni,Bn,Et,Ut),!wi)continue;const{rect:Jn,metrics:zs,baselineOffset:Qn}=wi;on.push({glyph:Ji,imageName:Gi.imageName,x:Nr,y:kr+Qn+-17,vertical:Ni,scale:Gi.scale,fontStack:Gi.fontStack,sectionIndex:Xi,metrics:zs,rect:Jn}),Ni?(tt.verticalizable=!0,Nr+=(Gi.imageName?zs.advance:Zi)*Gi.scale+Xt):Nr+=zs.advance*Gi.scale+Xt}on.length!==0&&(si=Math.max(Nr-Xt,si),Sp(on,0,on.length-1,Ui)),Nr=0,an.lineOffset=Math.max(Sn,(Ki-1)*Zi);const Yi=Kt*Ki+Sn;kr+=Yi,Fi=Math.max(Yi,Fi),++Ln}const{horizontalAlign:Tn,verticalAlign:nn}=lh(ur);(function(Pi,Ki,an,on,Sn,Bn,Yi,In,Gi){const Xi=(Ki-an)*Sn;let Ji=0;Ji=Bn!==Yi?-In*on- -17:-on*Gi*Yi+.5*Yi;for(const Ni of Pi)for(const wi of Ni.positionedGlyphs)wi.x+=Xi,wi.y+=Ji})(tt.positionedLines,Ui,Tn,nn,si,Fi,Kt,kr,Wt.length),tt.top+=-nn*kr,tt.bottom=tt.top+kr,tt.left+=-Tn*si,tt.right=tt.left+si}(Ne,h,W,X,rt,ce,fe,ye,Ie,be,Be,$e),!function(tt){for(const Et of tt)if(Et.positionedGlyphs.length!==0)return!1;return!0}(wt)&&Ne}const nc={9:!0,10:!0,11:!0,12:!0,13:!0,32:!0},mp={10:!0,32:!0,38:!0,41:!0,43:!0,45:!0,47:!0,173:!0,183:!0,8203:!0,8208:!0,8211:!0,8231:!0},yp={40:!0};function wd(H,h,W,X,ie,ue){if(h.imageName){const ce=X[h.imageName];return ce?ce.displaySize[0]*h.scale*Zi/ue+ie:0}{const ce=W[h.fontStack],fe=ce&&ce[H];return fe?fe.metrics.advance*h.scale+ie:0}}function Sd(H,h,W,X){const ie=Math.pow(H-h,2);return X?H<h?ie/2:2*ie:ie+Math.abs(W)*W}function gp(H,h,W){let X=0;return H===10&&(X-=1e4),W&&(X+=150),H!==40&&H!==65288||(X+=50),h!==41&&h!==65289||(X+=50),X}function Ed(H,h,W,X,ie,ue){let ce=null,fe=Sd(h,W,ie,ue);for(const ye of X){const be=Sd(h-ye.x,W,ie,ue)+ye.badness;be<=fe&&(ce=ye,fe=be)}return{index:H,x:h,priorBreak:ce,badness:fe}}function qd(H){return H?qd(H.priorBreak).concat(H.index):[]}function uh(H,h,W,X,ie,ue){if(!H)return[];const ce=[],fe=function(Ie,Be,Ue,$e,Xe,rt){let ct=0;for(let Ct=0;Ct<Ie.length();Ct++){const wt=Ie.getSection(Ct);ct+=wd(Ie.getCharCode(Ct),wt,$e,Xe,Be,rt)}return ct/Math.max(1,Math.ceil(ct/Ue))}(H,h,W,X,ie,ue),ye=H.text.indexOf("​")>=0;let be=0;for(let Ie=0;Ie<H.length();Ie++){const Be=H.getSection(Ie),Ue=H.getCharCode(Ie);if(nc[Ue]||(be+=wd(Ue,Be,X,ie,h,ue)),Ie<H.length()-1){const $e=!((we=Ue)<11904)&&(!!oi["CJK Compatibility Forms"](we)||!!oi["CJK Compatibility"](we)||!!oi["CJK Strokes"](we)||!!oi["CJK Symbols and Punctuation"](we)||!!oi["Enclosed CJK Letters and Months"](we)||!!oi["Halfwidth and Fullwidth Forms"](we)||!!oi["Ideographic Description Characters"](we)||!!oi["Vertical Forms"](we)||Au.test(String.fromCodePoint(we)));(mp[Ue]||$e||Be.imageName||Ie!==H.length()-2&&yp[H.getCharCode(Ie+1)])&&ce.push(Ed(Ie+1,be,fe,ce,gp(Ue,H.getCharCode(Ie+1),$e&&ye),!1))}}var we;return qd(Ed(H.length(),be,fe,ce,0,!0))}function lh(H){let h=.5,W=.5;switch(H){case"right":case"top-right":case"bottom-right":h=1;break;case"left":case"top-left":case"bottom-left":h=0}switch(H){case"bottom":case"bottom-right":case"bottom-left":W=1;break;case"top":case"top-right":case"top-left":W=0}return{horizontalAlign:h,verticalAlign:W}}function vp(H,h,W){const X=h.getMaxScale()*Zi,{maxImageWidth:ie,maxImageHeight:ue}=h.getMaxImageSize(H),ce=Math.max(X,ue*W);return{verticalLineContentWidth:Math.max(X,ie*W),horizontalLineContentHeight:ce}}function Td(H){switch(H){case"top":return 0;case"center":return .5;default:return 1}}function bp(H,h,W){return!(H===Q.an.horizontal||!h&&!Is(W)||h&&(nc[W]||(X=W,new RegExp("\\p{sc=Arab}","u").test(String.fromCodePoint(X)))));var X}function xp(H,h,W,X,ie,ue){const ce=ue[H.fontStack],fe=function(be,we,Ie,Be){if(be&&be.rect)return be;const Ue=we[Ie.fontStack],$e=Ue&&Ue[Be];return $e?{rect:null,metrics:$e.metrics}:null}(ce&&ce[h],ie,H,h);if(fe===null)return null;let ye;if(W)ye=X.verticalLineContentWidth-H.scale*Zi;else{const be=Td(H.verticalAlign);ye=(X.horizontalLineContentHeight-H.scale*Zi)*be}return{rect:fe.rect,metrics:fe.metrics,baselineOffset:ye}}function wp(H,h,W,X,ie){const ue=ie[H.imageName];if(!ue)return null;const ce=ue.paddedRect,fe=ue.displaySize,ye={width:fe[0],height:fe[1],left:1,top:-3,advance:h?fe[1]:fe[0]};let be;if(h)be=X.verticalLineContentWidth-fe[1]*H.scale;else{const we=Td(H.verticalAlign);be=(X.horizontalLineContentHeight-fe[1]*H.scale)*we}return{rect:ce,metrics:ye,baselineOffset:be,imageOffset:(h?fe[0]:fe[1])*H.scale-Zi*W}}function Sp(H,h,W,X){if(X===0)return;const ie=H[W],ue=(H[W].x+ie.metrics.advance*ie.scale)*X;for(let ce=h;ce<=W;ce++)H[ce].x-=ue}function Ep(H,h,W){const{horizontalAlign:X,verticalAlign:ie}=lh(W),ue=h[0]-H.displaySize[0]*X,ce=h[1]-H.displaySize[1]*ie;return{image:H,top:ce,bottom:ce+H.displaySize[1],left:ue,right:ue+H.displaySize[0]}}function Id(H){var h,W;let X=H.left,ie=H.top,ue=H.right-X,ce=H.bottom-ie;const fe=(h=H.image.textFitWidth)!==null&&h!==void 0?h:"stretchOrShrink",ye=(W=H.image.textFitHeight)!==null&&W!==void 0?W:"stretchOrShrink",be=(H.image.content[2]-H.image.content[0])/(H.image.content[3]-H.image.content[1]);if(ye==="proportional"){if(fe==="stretchOnly"&&ue/ce<be||fe==="proportional"){const we=Math.ceil(ce*be);X*=we/ue,ue=we}}else if(fe==="proportional"&&ye==="stretchOnly"&&be!==0&&ue/ce>be){const we=Math.ceil(ue/be);ie*=we/ce,ce=we}return{x1:X,y1:ie,x2:X+ue,y2:ie+ce}}function Rd(H,h,W,X,ie,ue){const ce=H.image;let fe;if(ce.content){const rt=ce.content,ct=ce.pixelRatio||1;fe=[rt[0]/ct,rt[1]/ct,ce.displaySize[0]-rt[2]/ct,ce.displaySize[1]-rt[3]/ct]}const ye=h.left*ue,be=h.right*ue;let we,Ie,Be,Ue;W==="width"||W==="both"?(Ue=ie[0]+ye-X[3],Ie=ie[0]+be+X[1]):(Ue=ie[0]+(ye+be-ce.displaySize[0])/2,Ie=Ue+ce.displaySize[0]);const $e=h.top*ue,Xe=h.bottom*ue;return W==="height"||W==="both"?(we=ie[1]+$e-X[0],Be=ie[1]+Xe+X[2]):(we=ie[1]+($e+Xe-ce.displaySize[1])/2,Be=we+ce.displaySize[1]),{image:ce,top:we,right:Ie,bottom:Be,left:Ue,collisionPadding:fe}}const Aa=128,oo=32640;function Ad(H,h){const{expression:W}=h;if(W.kind==="constant")return{kind:"constant",layoutSize:W.evaluate(new Si(H+1))};if(W.kind==="source")return{kind:"source"};{const{zoomStops:X,interpolationType:ie}=W;let ue=0;for(;ue<X.length&&X[ue]<=H;)ue++;ue=Math.max(0,ue-1);let ce=ue;for(;ce<X.length&&X[ce]<H+1;)ce++;ce=Math.min(X.length-1,ce);const fe=X[ue],ye=X[ce];return W.kind==="composite"?{kind:"composite",minZoom:fe,maxZoom:ye,interpolationType:ie}:{kind:"camera",minZoom:fe,maxZoom:ye,minSize:W.evaluate(new Si(fe)),maxSize:W.evaluate(new Si(ye)),interpolationType:ie}}}function ch(H,h,W){let X="never";const ie=H.get(h);return ie?X=ie:H.get(W)&&(X="always"),X}const qp=Ku.VectorTileFeature.types,Tp=[{name:"a_fade_opacity",components:1,type:"Uint8",offset:0}];function ac(H,h,W,X,ie,ue,ce,fe,ye,be,we,Ie,Be){const Ue=fe?Math.min(oo,Math.round(fe[0])):0,$e=fe?Math.min(oo,Math.round(fe[1])):0;H.emplaceBack(h,W,Math.round(32*X),Math.round(32*ie),ue,ce,(Ue<<1)+(ye?1:0),$e,16*be,16*we,256*Ie,256*Be)}function hh(H,h,W){H.emplaceBack(h.x,h.y,W),H.emplaceBack(h.x,h.y,W),H.emplaceBack(h.x,h.y,W),H.emplaceBack(h.x,h.y,W)}function Ip(H){for(const h of H.sections)if(Ou(h.text))return!0;return!1}class dh{constructor(h){this.layoutVertexArray=new ti,this.indexArray=new gi,this.programConfigurations=h,this.segments=new li,this.dynamicLayoutVertexArray=new di,this.opacityVertexArray=new Ri,this.hasVisibleVertices=!1,this.placedSymbolArray=new ot}isEmpty(){return this.layoutVertexArray.length===0&&this.indexArray.length===0&&this.dynamicLayoutVertexArray.length===0&&this.opacityVertexArray.length===0}upload(h,W,X,ie){this.isEmpty()||(X&&(this.layoutVertexBuffer=h.createVertexBuffer(this.layoutVertexArray,sp.members),this.indexBuffer=h.createIndexBuffer(this.indexArray,W),this.dynamicLayoutVertexBuffer=h.createVertexBuffer(this.dynamicLayoutVertexArray,up.members,!0),this.opacityVertexBuffer=h.createVertexBuffer(this.opacityVertexArray,Tp,!0),this.opacityVertexBuffer.itemSize=1),(X||ie)&&this.programConfigurations.upload(h))}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy(),this.dynamicLayoutVertexBuffer.destroy(),this.opacityVertexBuffer.destroy())}}Tr("SymbolBuffers",dh);class fh{constructor(h,W,X){this.layoutVertexArray=new h,this.layoutAttributes=W,this.indexArray=new X,this.segments=new li,this.collisionVertexArray=new Ai}upload(h){this.layoutVertexBuffer=h.createVertexBuffer(this.layoutVertexArray,this.layoutAttributes),this.indexBuffer=h.createIndexBuffer(this.indexArray),this.collisionVertexBuffer=h.createVertexBuffer(this.collisionVertexArray,lp.members,!0)}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.segments.destroy(),this.collisionVertexBuffer.destroy())}}Tr("CollisionBuffers",fh);class Bs{constructor(h){this.collisionBoxArray=h.collisionBoxArray,this.zoom=h.zoom,this.globalState=h.globalState,this.overscaling=h.overscaling,this.layers=h.layers,this.layerIds=this.layers.map(ce=>ce.id),this.index=h.index,this.pixelRatio=h.pixelRatio,this.sourceLayerIndex=h.sourceLayerIndex,this.hasPattern=!1,this.hasRTLText=!1,this.sortKeyRanges=[],this.collisionCircleArray=[];const W=this.layers[0]._unevaluatedLayout._values;this.textSizeData=Ad(this.zoom,W["text-size"]),this.iconSizeData=Ad(this.zoom,W["icon-size"]);const X=this.layers[0].layout,ie=X.get("symbol-sort-key"),ue=X.get("symbol-z-order");this.canOverlap=ch(X,"text-overlap","text-allow-overlap")!=="never"||ch(X,"icon-overlap","icon-allow-overlap")!=="never"||X.get("text-ignore-placement")||X.get("icon-ignore-placement"),this.sortFeaturesByKey=ue!=="viewport-y"&&!ie.isConstant(),this.sortFeaturesByY=(ue==="viewport-y"||ue==="auto"&&!this.sortFeaturesByKey)&&this.canOverlap,X.get("symbol-placement")==="point"&&(this.writingModes=X.get("text-writing-mode").map(ce=>Q.an[ce])),this.stateDependentLayerIds=this.layers.filter(ce=>ce.isStateDependent()).map(ce=>ce.id),this.sourceID=h.sourceID}createArrays(){this.text=new dh(new _a(this.layers,this.zoom,h=>/^text/.test(h))),this.icon=new dh(new _a(this.layers,this.zoom,h=>/^icon/.test(h))),this.glyphOffsetArray=new mt,this.lineVertexArray=new Tt,this.symbolInstances=new xt,this.textAnchorOffsets=new vt}calculateGlyphDependencies(h,W,X,ie,ue){for(let ce=0;ce<h.length;ce++)if(W[h.charCodeAt(ce)]=!0,(X||ie)&&ue){const fe=Ju[h.charAt(ce)];fe&&(W[fe.charCodeAt(0)]=!0)}}populate(h,W,X){const ie=this.layers[0],ue=ie.layout,ce=ue.get("text-font"),fe=ue.get("text-field"),ye=ue.get("icon-image"),be=(fe.value.kind!=="constant"||fe.value.value instanceof sn&&!fe.value.value.isEmpty()||fe.value.value.toString().length>0)&&(ce.value.kind!=="constant"||ce.value.value.length>0),we=ye.value.kind!=="constant"||!!ye.value.value||Object.keys(ye.parameters).length>0,Ie=ue.get("symbol-sort-key");if(this.features=[],!be&&!we)return;const Be=W.iconDependencies,Ue=W.glyphDependencies,$e=W.availableImages,Xe=new Si(this.zoom,{globalState:this.globalState});for(const{feature:rt,id:ct,index:Ct,sourceLayerIndex:wt}of h){const Ne=ie._featureFilter.needGeometry,tt=Vo(rt,Ne);if(!ie._featureFilter.filter(Xe,tt,X))continue;let Et,Ut;if(Ne||(tt.geometry=Go(rt)),be){const Wt=ie.getValueAndResolveTokens("text-field",tt,X,$e),Kt=sn.factory(Wt),ur=this.hasRTLText=this.hasRTLText||Ip(Kt);(!ur||ua.getRTLTextPluginStatus()==="unavailable"||ur&&ua.isParsed())&&(Et=hp(Kt,ie,tt))}if(we){const Wt=ie.getValueAndResolveTokens("icon-image",tt,X,$e);Ut=Wt instanceof gn?Wt:gn.fromString(Wt)}if(!Et&&!Ut)continue;const Jt=this.sortFeaturesByKey?Ie.evaluate(tt,{},X):void 0;if(this.features.push({id:ct,text:Et,icon:Ut,index:Ct,sourceLayerIndex:wt,geometry:tt.geometry,properties:rt.properties,type:qp[rt.type],sortKey:Jt}),Ut&&(Be[Ut.name]=!0),Et){const Wt=ce.evaluate(tt,{},X).join(","),Kt=ue.get("text-rotation-alignment")!=="viewport"&&ue.get("symbol-placement")!=="point";this.allowVerticalPlacement=this.writingModes&&this.writingModes.indexOf(Q.an.vertical)>=0;for(const ur of Et.sections)if(ur.image)Be[ur.image.name]=!0;else{const tr=Ru(Et.toString()),dr=ur.fontStack||Wt,Xt=Ue[dr]=Ue[dr]||{};this.calculateGlyphDependencies(ur.text,Xt,Kt,this.allowVerticalPlacement,tr)}}}ue.get("symbol-placement")==="line"&&(this.features=function(rt){const ct={},Ct={},wt=[];let Ne=0;function tt(Wt){wt.push(rt[Wt]),Ne++}function Et(Wt,Kt,ur){const tr=Ct[Wt];return delete Ct[Wt],Ct[Kt]=tr,wt[tr].geometry[0].pop(),wt[tr].geometry[0]=wt[tr].geometry[0].concat(ur[0]),tr}function Ut(Wt,Kt,ur){const tr=ct[Kt];return delete ct[Kt],ct[Wt]=tr,wt[tr].geometry[0].shift(),wt[tr].geometry[0]=ur[0].concat(wt[tr].geometry[0]),tr}function Jt(Wt,Kt,ur){const tr=ur?Kt[0][Kt[0].length-1]:Kt[0][0];return`${Wt}:${tr.x}:${tr.y}`}for(let Wt=0;Wt<rt.length;Wt++){const Kt=rt[Wt],ur=Kt.geometry,tr=Kt.text?Kt.text.toString():null;if(!tr){tt(Wt);continue}const dr=Jt(tr,ur),Xt=Jt(tr,ur,!0);if(dr in Ct&&Xt in ct&&Ct[dr]!==ct[Xt]){const Pr=Ut(dr,Xt,ur),Ur=Et(dr,Xt,wt[Pr].geometry);delete ct[dr],delete Ct[Xt],Ct[Jt(tr,wt[Ur].geometry,!0)]=Ur,wt[Pr].geometry=null}else dr in Ct?Et(dr,Xt,ur):Xt in ct?Ut(dr,Xt,ur):(tt(Wt),ct[dr]=Ne-1,Ct[Xt]=Ne-1)}return wt.filter(Wt=>Wt.geometry)}(this.features)),this.sortFeaturesByKey&&this.features.sort((rt,ct)=>rt.sortKey-ct.sortKey)}update(h,W,X){this.stateDependentLayers.length&&(this.text.programConfigurations.updatePaintArrays(h,W,this.layers,X),this.icon.programConfigurations.updatePaintArrays(h,W,this.layers,X))}isEmpty(){return this.symbolInstances.length===0&&!this.hasRTLText}uploadPending(){return!this.uploaded||this.text.programConfigurations.needsUpload||this.icon.programConfigurations.needsUpload}upload(h){!this.uploaded&&this.hasDebugData()&&(this.textCollisionBox.upload(h),this.iconCollisionBox.upload(h)),this.text.upload(h,this.sortFeaturesByY,!this.uploaded,this.text.programConfigurations.needsUpload),this.icon.upload(h,this.sortFeaturesByY,!this.uploaded,this.icon.programConfigurations.needsUpload),this.uploaded=!0}destroyDebugData(){this.textCollisionBox.destroy(),this.iconCollisionBox.destroy()}destroy(){this.text.destroy(),this.icon.destroy(),this.hasDebugData()&&this.destroyDebugData()}addToLineVertexArray(h,W){const X=this.lineVertexArray.length;if(h.segment!==void 0){let ie=h.dist(W[h.segment+1]),ue=h.dist(W[h.segment]);const ce={};for(let fe=h.segment+1;fe<W.length;fe++)ce[fe]={x:W[fe].x,y:W[fe].y,tileUnitDistanceFromAnchor:ie},fe<W.length-1&&(ie+=W[fe+1].dist(W[fe]));for(let fe=h.segment||0;fe>=0;fe--)ce[fe]={x:W[fe].x,y:W[fe].y,tileUnitDistanceFromAnchor:ue},fe>0&&(ue+=W[fe-1].dist(W[fe]));for(let fe=0;fe<W.length;fe++){const ye=ce[fe];this.lineVertexArray.emplaceBack(ye.x,ye.y,ye.tileUnitDistanceFromAnchor)}}return{lineStartIndex:X,lineLength:this.lineVertexArray.length-X}}addSymbols(h,W,X,ie,ue,ce,fe,ye,be,we,Ie,Be){const Ue=h.indexArray,$e=h.layoutVertexArray,Xe=h.segments.prepareSegment(4*W.length,$e,Ue,this.canOverlap?ce.sortKey:void 0),rt=this.glyphOffsetArray.length,ct=Xe.vertexLength,Ct=this.allowVerticalPlacement&&fe===Q.an.vertical?Math.PI/2:0,wt=ce.text&&ce.text.sections;for(let Ne=0;Ne<W.length;Ne++){const{tl:tt,tr:Et,bl:Ut,br:Jt,tex:Wt,pixelOffsetTL:Kt,pixelOffsetBR:ur,minFontScaleX:tr,minFontScaleY:dr,glyphOffset:Xt,isSDF:Pr,sectionIndex:Ur}=W[Ne],Nr=Xe.vertexLength,kr=Xt[1];ac($e,ye.x,ye.y,tt.x,kr+tt.y,Wt.x,Wt.y,X,Pr,Kt.x,Kt.y,tr,dr),ac($e,ye.x,ye.y,Et.x,kr+Et.y,Wt.x+Wt.w,Wt.y,X,Pr,ur.x,Kt.y,tr,dr),ac($e,ye.x,ye.y,Ut.x,kr+Ut.y,Wt.x,Wt.y+Wt.h,X,Pr,Kt.x,ur.y,tr,dr),ac($e,ye.x,ye.y,Jt.x,kr+Jt.y,Wt.x+Wt.w,Wt.y+Wt.h,X,Pr,ur.x,ur.y,tr,dr),hh(h.dynamicLayoutVertexArray,ye,Ct),Ue.emplaceBack(Nr,Nr+2,Nr+1),Ue.emplaceBack(Nr+1,Nr+2,Nr+3),Xe.vertexLength+=4,Xe.primitiveLength+=2,this.glyphOffsetArray.emplaceBack(Xt[0]),Ne!==W.length-1&&Ur===W[Ne+1].sectionIndex||h.programConfigurations.populatePaintArrays($e.length,ce,ce.index,{},Be,wt&&wt[Ur])}h.placedSymbolArray.emplaceBack(ye.x,ye.y,rt,this.glyphOffsetArray.length-rt,ct,be,we,ye.segment,X?X[0]:0,X?X[1]:0,ie[0],ie[1],fe,0,!1,0,Ie)}_addCollisionDebugVertex(h,W,X,ie,ue,ce){return W.emplaceBack(0,0),h.emplaceBack(X.x,X.y,ie,ue,Math.round(ce.x),Math.round(ce.y))}addCollisionDebugVertices(h,W,X,ie,ue,ce,fe){const ye=ue.segments.prepareSegment(4,ue.layoutVertexArray,ue.indexArray),be=ye.vertexLength,we=ue.layoutVertexArray,Ie=ue.collisionVertexArray,Be=fe.anchorX,Ue=fe.anchorY;this._addCollisionDebugVertex(we,Ie,ce,Be,Ue,new ve(h,W)),this._addCollisionDebugVertex(we,Ie,ce,Be,Ue,new ve(X,W)),this._addCollisionDebugVertex(we,Ie,ce,Be,Ue,new ve(X,ie)),this._addCollisionDebugVertex(we,Ie,ce,Be,Ue,new ve(h,ie)),ye.vertexLength+=4;const $e=ue.indexArray;$e.emplaceBack(be,be+1),$e.emplaceBack(be+1,be+2),$e.emplaceBack(be+2,be+3),$e.emplaceBack(be+3,be),ye.primitiveLength+=4}addDebugCollisionBoxes(h,W,X,ie){for(let ue=h;ue<W;ue++){const ce=this.collisionBoxArray.get(ue);this.addCollisionDebugVertices(ce.x1,ce.y1,ce.x2,ce.y2,ie?this.textCollisionBox:this.iconCollisionBox,ce.anchorPoint,X)}}generateCollisionDebugBuffers(){this.hasDebugData()&&this.destroyDebugData(),this.textCollisionBox=new fh(_i,md.members,mi),this.iconCollisionBox=new fh(_i,md.members,mi);for(let h=0;h<this.symbolInstances.length;h++){const W=this.symbolInstances.get(h);this.addDebugCollisionBoxes(W.textBoxStartIndex,W.textBoxEndIndex,W,!0),this.addDebugCollisionBoxes(W.verticalTextBoxStartIndex,W.verticalTextBoxEndIndex,W,!0),this.addDebugCollisionBoxes(W.iconBoxStartIndex,W.iconBoxEndIndex,W,!1),this.addDebugCollisionBoxes(W.verticalIconBoxStartIndex,W.verticalIconBoxEndIndex,W,!1)}}_deserializeCollisionBoxesForSymbol(h,W,X,ie,ue,ce,fe,ye,be){const we={};for(let Ie=W;Ie<X;Ie++){const Be=h.get(Ie);we.textBox={x1:Be.x1,y1:Be.y1,x2:Be.x2,y2:Be.y2,anchorPointX:Be.anchorPointX,anchorPointY:Be.anchorPointY},we.textFeatureIndex=Be.featureIndex;break}for(let Ie=ie;Ie<ue;Ie++){const Be=h.get(Ie);we.verticalTextBox={x1:Be.x1,y1:Be.y1,x2:Be.x2,y2:Be.y2,anchorPointX:Be.anchorPointX,anchorPointY:Be.anchorPointY},we.verticalTextFeatureIndex=Be.featureIndex;break}for(let Ie=ce;Ie<fe;Ie++){const Be=h.get(Ie);we.iconBox={x1:Be.x1,y1:Be.y1,x2:Be.x2,y2:Be.y2,anchorPointX:Be.anchorPointX,anchorPointY:Be.anchorPointY},we.iconFeatureIndex=Be.featureIndex;break}for(let Ie=ye;Ie<be;Ie++){const Be=h.get(Ie);we.verticalIconBox={x1:Be.x1,y1:Be.y1,x2:Be.x2,y2:Be.y2,anchorPointX:Be.anchorPointX,anchorPointY:Be.anchorPointY},we.verticalIconFeatureIndex=Be.featureIndex;break}return we}deserializeCollisionBoxes(h){this.collisionArrays=[];for(let W=0;W<this.symbolInstances.length;W++){const X=this.symbolInstances.get(W);this.collisionArrays.push(this._deserializeCollisionBoxesForSymbol(h,X.textBoxStartIndex,X.textBoxEndIndex,X.verticalTextBoxStartIndex,X.verticalTextBoxEndIndex,X.iconBoxStartIndex,X.iconBoxEndIndex,X.verticalIconBoxStartIndex,X.verticalIconBoxEndIndex))}}hasTextData(){return this.text.segments.get().length>0}hasIconData(){return this.icon.segments.get().length>0}hasDebugData(){return this.textCollisionBox&&this.iconCollisionBox}hasTextCollisionBoxData(){return this.hasDebugData()&&this.textCollisionBox.segments.get().length>0}hasIconCollisionBoxData(){return this.hasDebugData()&&this.iconCollisionBox.segments.get().length>0}addIndicesForPlacedSymbol(h,W){const X=h.placedSymbolArray.get(W),ie=X.vertexStartIndex+4*X.numGlyphs;for(let ue=X.vertexStartIndex;ue<ie;ue+=4)h.indexArray.emplaceBack(ue,ue+2,ue+1),h.indexArray.emplaceBack(ue+1,ue+2,ue+3)}getSortedSymbolIndexes(h){if(this.sortedAngle===h&&this.symbolInstanceIndexes!==void 0)return this.symbolInstanceIndexes;const W=Math.sin(h),X=Math.cos(h),ie=[],ue=[],ce=[];for(let fe=0;fe<this.symbolInstances.length;++fe){ce.push(fe);const ye=this.symbolInstances.get(fe);ie.push(0|Math.round(W*ye.anchorX+X*ye.anchorY)),ue.push(ye.featureIndex)}return ce.sort((fe,ye)=>ie[fe]-ie[ye]||ue[ye]-ue[fe]),ce}addToSortKeyRanges(h,W){const X=this.sortKeyRanges[this.sortKeyRanges.length-1];X&&X.sortKey===W?X.symbolInstanceEnd=h+1:this.sortKeyRanges.push({sortKey:W,symbolInstanceStart:h,symbolInstanceEnd:h+1})}sortFeatures(h){if(this.sortFeaturesByY&&this.sortedAngle!==h&&!(this.text.segments.get().length>1||this.icon.segments.get().length>1)){this.symbolInstanceIndexes=this.getSortedSymbolIndexes(h),this.sortedAngle=h,this.text.indexArray.clear(),this.icon.indexArray.clear(),this.featureSortOrder=[];for(const W of this.symbolInstanceIndexes){const X=this.symbolInstances.get(W);this.featureSortOrder.push(X.featureIndex),[X.rightJustifiedTextSymbolIndex,X.centerJustifiedTextSymbolIndex,X.leftJustifiedTextSymbolIndex].forEach((ie,ue,ce)=>{ie>=0&&ce.indexOf(ie)===ue&&this.addIndicesForPlacedSymbol(this.text,ie)}),X.verticalPlacedTextSymbolIndex>=0&&this.addIndicesForPlacedSymbol(this.text,X.verticalPlacedTextSymbolIndex),X.placedIconSymbolIndex>=0&&this.addIndicesForPlacedSymbol(this.icon,X.placedIconSymbolIndex),X.verticalPlacedIconSymbolIndex>=0&&this.addIndicesForPlacedSymbol(this.icon,X.verticalPlacedIconSymbolIndex)}this.text.indexBuffer&&this.text.indexBuffer.updateData(this.text.indexArray),this.icon.indexBuffer&&this.icon.indexBuffer.updateData(this.icon.indexArray)}}}let Pd,Od;Tr("SymbolBucket",Bs,{omit:["layers","collisionBoxArray","features","compareText"]}),Bs.MAX_GLYPHS=65535,Bs.addDynamicAttributes=hh;var ph={get paint(){return Od=Od||new pn({"icon-opacity":new Vr(St.paint_symbol["icon-opacity"]),"icon-color":new Vr(St.paint_symbol["icon-color"]),"icon-halo-color":new Vr(St.paint_symbol["icon-halo-color"]),"icon-halo-width":new Vr(St.paint_symbol["icon-halo-width"]),"icon-halo-blur":new Vr(St.paint_symbol["icon-halo-blur"]),"icon-translate":new Or(St.paint_symbol["icon-translate"]),"icon-translate-anchor":new Or(St.paint_symbol["icon-translate-anchor"]),"text-opacity":new Vr(St.paint_symbol["text-opacity"]),"text-color":new Vr(St.paint_symbol["text-color"],{runtimeType:Ht,getOverride:H=>H.textColor,hasOverride:H=>!!H.textColor}),"text-halo-color":new Vr(St.paint_symbol["text-halo-color"]),"text-halo-width":new Vr(St.paint_symbol["text-halo-width"]),"text-halo-blur":new Vr(St.paint_symbol["text-halo-blur"]),"text-translate":new Or(St.paint_symbol["text-translate"]),"text-translate-anchor":new Or(St.paint_symbol["text-translate-anchor"])})},get layout(){return Pd=Pd||new pn({"symbol-placement":new Or(St.layout_symbol["symbol-placement"]),"symbol-spacing":new Or(St.layout_symbol["symbol-spacing"]),"symbol-avoid-edges":new Or(St.layout_symbol["symbol-avoid-edges"]),"symbol-sort-key":new Vr(St.layout_symbol["symbol-sort-key"]),"symbol-z-order":new Or(St.layout_symbol["symbol-z-order"]),"icon-allow-overlap":new Or(St.layout_symbol["icon-allow-overlap"]),"icon-overlap":new Or(St.layout_symbol["icon-overlap"]),"icon-ignore-placement":new Or(St.layout_symbol["icon-ignore-placement"]),"icon-optional":new Or(St.layout_symbol["icon-optional"]),"icon-rotation-alignment":new Or(St.layout_symbol["icon-rotation-alignment"]),"icon-size":new Vr(St.layout_symbol["icon-size"]),"icon-text-fit":new Or(St.layout_symbol["icon-text-fit"]),"icon-text-fit-padding":new Or(St.layout_symbol["icon-text-fit-padding"]),"icon-image":new Vr(St.layout_symbol["icon-image"]),"icon-rotate":new Vr(St.layout_symbol["icon-rotate"]),"icon-padding":new Vr(St.layout_symbol["icon-padding"]),"icon-keep-upright":new Or(St.layout_symbol["icon-keep-upright"]),"icon-offset":new Vr(St.layout_symbol["icon-offset"]),"icon-anchor":new Vr(St.layout_symbol["icon-anchor"]),"icon-pitch-alignment":new Or(St.layout_symbol["icon-pitch-alignment"]),"text-pitch-alignment":new Or(St.layout_symbol["text-pitch-alignment"]),"text-rotation-alignment":new Or(St.layout_symbol["text-rotation-alignment"]),"text-field":new Vr(St.layout_symbol["text-field"]),"text-font":new Vr(St.layout_symbol["text-font"]),"text-size":new Vr(St.layout_symbol["text-size"]),"text-max-width":new Vr(St.layout_symbol["text-max-width"]),"text-line-height":new Or(St.layout_symbol["text-line-height"]),"text-letter-spacing":new Vr(St.layout_symbol["text-letter-spacing"]),"text-justify":new Vr(St.layout_symbol["text-justify"]),"text-radial-offset":new Vr(St.layout_symbol["text-radial-offset"]),"text-variable-anchor":new Or(St.layout_symbol["text-variable-anchor"]),"text-variable-anchor-offset":new Vr(St.layout_symbol["text-variable-anchor-offset"]),"text-anchor":new Vr(St.layout_symbol["text-anchor"]),"text-max-angle":new Or(St.layout_symbol["text-max-angle"]),"text-writing-mode":new Or(St.layout_symbol["text-writing-mode"]),"text-rotate":new Vr(St.layout_symbol["text-rotate"]),"text-padding":new Or(St.layout_symbol["text-padding"]),"text-keep-upright":new Or(St.layout_symbol["text-keep-upright"]),"text-transform":new Vr(St.layout_symbol["text-transform"]),"text-offset":new Vr(St.layout_symbol["text-offset"]),"text-allow-overlap":new Or(St.layout_symbol["text-allow-overlap"]),"text-overlap":new Or(St.layout_symbol["text-overlap"]),"text-ignore-placement":new Or(St.layout_symbol["text-ignore-placement"]),"text-optional":new Or(St.layout_symbol["text-optional"])})}};class Cd{constructor(h){if(h.property.overrides===void 0)throw new Error("overrides must be provided to instantiate FormatSectionOverride class");this.type=h.property.overrides?h.property.overrides.runtimeType:yn,this.defaultValue=h}evaluate(h){if(h.formattedSection){const W=this.defaultValue.property.overrides;if(W&&W.hasOverride(h.formattedSection))return W.getOverride(h.formattedSection)}return h.feature&&h.featureState?this.defaultValue.evaluate(h.feature,h.featureState):this.defaultValue.property.specification.default}eachChild(h){this.defaultValue.isConstant()||h(this.defaultValue.value._styleExpression.expression)}outputDefined(){return!1}serialize(){return null}}Tr("FormatSectionOverride",Cd,{omit:["defaultValue"]});class oc extends Qi{constructor(h){super(h,ph)}recalculate(h,W){if(super.recalculate(h,W),this.layout.get("icon-rotation-alignment")==="auto"&&(this.layout._values["icon-rotation-alignment"]=this.layout.get("symbol-placement")!=="point"?"map":"viewport"),this.layout.get("text-rotation-alignment")==="auto"&&(this.layout._values["text-rotation-alignment"]=this.layout.get("symbol-placement")!=="point"?"map":"viewport"),this.layout.get("text-pitch-alignment")==="auto"&&(this.layout._values["text-pitch-alignment"]=this.layout.get("text-rotation-alignment")==="map"?"map":"viewport"),this.layout.get("icon-pitch-alignment")==="auto"&&(this.layout._values["icon-pitch-alignment"]=this.layout.get("icon-rotation-alignment")),this.layout.get("symbol-placement")==="point"){const X=this.layout.get("text-writing-mode");if(X){const ie=[];for(const ue of X)ie.indexOf(ue)<0&&ie.push(ue);this.layout._values["text-writing-mode"]=ie}else this.layout._values["text-writing-mode"]=["horizontal"]}this._setPaintOverrides()}getValueAndResolveTokens(h,W,X,ie){const ue=this.layout.get(h).evaluate(W,{},X,ie),ce=this._unevaluatedLayout._values[h];return ce.isDataDriven()||ps(ce.value)||!ue?ue:function(fe,ye){return ye.replace(/{([^{}]+)}/g,(be,we)=>fe&&we in fe?String(fe[we]):"")}(W.properties,ue)}createBucket(h){return new Bs(h)}queryRadius(){return 0}queryIntersectsFeature(){throw new Error("Should take a different path in FeatureIndex")}_setPaintOverrides(){for(const h of ph.paint.overridableProperties){if(!oc.hasPaintOverride(this.layout,h))continue;const W=this.paint.get(h),X=new Cd(W),ie=new fs(X,W.property.specification);let ue=null;ue=W.value.kind==="constant"||W.value.kind==="source"?new To("source",ie):new ys("composite",ie,W.value.zoomStops),this.paint._values[h]=new Vn(W.property,ue,W.parameters)}}_handleOverridablePaintPropertyUpdate(h,W,X){return!(!this.layout||W.isDataDriven()||X.isDataDriven())&&oc.hasPaintOverride(this.layout,h)}static hasPaintOverride(h,W){const X=h.get("text-field"),ie=ph.paint.properties[W];let ue=!1;const ce=fe=>{for(const ye of fe)if(ie.overrides&&ie.overrides.hasOverride(ye))return void(ue=!0)};if(X.value.kind==="constant"&&X.value.value instanceof sn)ce(X.value.value.sections);else if(X.value.kind==="source"){const fe=be=>{ue||(be instanceof hn&&$r(be.value)===pi?ce(be.value.sections):be instanceof vo?ce(be.sections):be.eachChild(fe))},ye=X.value;ye._styleExpression&&fe(ye._styleExpression.expression)}return ue}}let Md;var Rp={get paint(){return Md=Md||new pn({"background-color":new Or(St.paint_background["background-color"]),"background-pattern":new Mu(St.paint_background["background-pattern"]),"background-opacity":new Or(St.paint_background["background-opacity"])})}};class Ap extends Qi{constructor(h){super(h,Rp)}}let Dd;var Pp={get paint(){return Dd=Dd||new pn({"raster-opacity":new Or(St.paint_raster["raster-opacity"]),"raster-hue-rotate":new Or(St.paint_raster["raster-hue-rotate"]),"raster-brightness-min":new Or(St.paint_raster["raster-brightness-min"]),"raster-brightness-max":new Or(St.paint_raster["raster-brightness-max"]),"raster-saturation":new Or(St.paint_raster["raster-saturation"]),"raster-contrast":new Or(St.paint_raster["raster-contrast"]),"raster-resampling":new Or(St.paint_raster["raster-resampling"]),"raster-fade-duration":new Or(St.paint_raster["raster-fade-duration"])})}};class Op extends Qi{constructor(h){super(h,Pp)}}class Cp extends Qi{constructor(h){super(h,{}),this.onAdd=W=>{this.implementation.onAdd&&this.implementation.onAdd(W,W.painter.context.gl)},this.onRemove=W=>{this.implementation.onRemove&&this.implementation.onRemove(W,W.painter.context.gl)},this.implementation=h}is3D(){return this.implementation.renderingMode==="3d"}hasOffscreenPass(){return this.implementation.prerender!==void 0}recalculate(){}updateTransitions(){}hasTransition(){return!1}serialize(){throw new Error("Custom layers cannot be serialized")}}class Mp{constructor(h){this._methodToThrottle=h,this._triggered=!1,typeof MessageChannel<"u"&&(this._channel=new MessageChannel,this._channel.port2.onmessage=()=>{this._triggered=!1,this._methodToThrottle()})}trigger(){this._triggered||(this._triggered=!0,this._channel?this._channel.port1.postMessage(!0):setTimeout(()=>{this._triggered=!1,this._methodToThrottle()},0))}remove(){delete this._channel,this._methodToThrottle=()=>{}}}const Dp={once:!0},_h=63710088e-1;class so{constructor(h,W){if(isNaN(h)||isNaN(W))throw new Error(`Invalid LngLat object: (${h}, ${W})`);if(this.lng=+h,this.lat=+W,this.lat>90||this.lat<-90)throw new Error("Invalid LngLat latitude value: must be between -90 and 90")}wrap(){return new so(Ir(this.lng,-180,180),this.lat)}toArray(){return[this.lng,this.lat]}toString(){return`LngLat(${this.lng}, ${this.lat})`}distanceTo(h){const W=Math.PI/180,X=this.lat*W,ie=h.lat*W,ue=Math.sin(X)*Math.sin(ie)+Math.cos(X)*Math.cos(ie)*Math.cos((h.lng-this.lng)*W);return _h*Math.acos(Math.min(ue,1))}static convert(h){if(h instanceof so)return h;if(Array.isArray(h)&&(h.length===2||h.length===3))return new so(Number(h[0]),Number(h[1]));if(!Array.isArray(h)&&typeof h=="object"&&h!==null)return new so(Number("lng"in h?h.lng:h.lon),Number(h.lat));throw new Error("`LngLatLike` argument must be specified as a LngLat instance, an object {lng: <lng>, lat: <lat>}, an object {lon: <lng>, lat: <lat>}, or an array of [<lng>, <lat>]")}}const Fd=2*Math.PI*_h;function kd(H){return Fd*Math.cos(H*Math.PI/180)}function Ld(H){return(180+H)/360}function Bd(H){return(180-180/Math.PI*Math.log(Math.tan(Math.PI/4+H*Math.PI/360)))/360}function jd(H,h){return H/kd(h)}function mh(H){return 360/Math.PI*Math.atan(Math.exp((180-360*H)*Math.PI/180))-90}function Nd(H,h){return H*kd(mh(h))}class el{constructor(h,W,X=0){this.x=+h,this.y=+W,this.z=+X}static fromLngLat(h,W=0){const X=so.convert(h);return new el(Ld(X.lng),Bd(X.lat),jd(W,X.lat))}toLngLat(){return new so(360*this.x-180,mh(this.y))}toAltitude(){return Nd(this.z,this.y)}meterInMercatorCoordinateUnits(){return 1/Fd*(h=mh(this.y),1/Math.cos(h*Math.PI/180));var h}}function zd(H,h,W){var X=2*Math.PI*6378137/256/Math.pow(2,W);return[H*X-2*Math.PI*6378137/2,h*X-2*Math.PI*6378137/2]}class yh{constructor(h,W,X){if(!function(ie,ue,ce){return!(ie<0||ie>25||ce<0||ce>=Math.pow(2,ie)||ue<0||ue>=Math.pow(2,ie))}(h,W,X))throw new Error(`x=${W}, y=${X}, z=${h} outside of bounds. 0<=x<${Math.pow(2,h)}, 0<=y<${Math.pow(2,h)} 0<=z<=25 `);this.z=h,this.x=W,this.y=X,this.key=js(0,h,h,W,X)}equals(h){return this.z===h.z&&this.x===h.x&&this.y===h.y}url(h,W,X){const ie=(ce=this.y,fe=this.z,ye=zd(256*(ue=this.x),256*(ce=Math.pow(2,fe)-ce-1),fe),be=zd(256*(ue+1),256*(ce+1),fe),ye[0]+","+ye[1]+","+be[0]+","+be[1]);var ue,ce,fe,ye,be;const we=function(Ie,Be,Ue){let $e,Xe="";for(let rt=Ie;rt>0;rt--)$e=1<<rt-1,Xe+=(Be&$e?1:0)+(Ue&$e?2:0);return Xe}(this.z,this.x,this.y);return h[(this.x+this.y)%h.length].replace(/{prefix}/g,(this.x%16).toString(16)+(this.y%16).toString(16)).replace(/{z}/g,String(this.z)).replace(/{x}/g,String(this.x)).replace(/{y}/g,String(X==="tms"?Math.pow(2,this.z)-this.y-1:this.y)).replace(/{ratio}/g,W>1?"@2x":"").replace(/{quadkey}/g,we).replace(/{bbox-epsg-3857}/g,ie)}isChildOf(h){const W=this.z-h.z;return W>0&&h.x===this.x>>W&&h.y===this.y>>W}getTilePoint(h){const W=Math.pow(2,this.z);return new ve((h.x*W-this.x)*Dt,(h.y*W-this.y)*Dt)}toString(){return`${this.z}/${this.x}/${this.y}`}}class Ud{constructor(h,W){this.wrap=h,this.canonical=W,this.key=js(h,W.z,W.z,W.x,W.y)}}class kn{constructor(h,W,X,ie,ue){if(this.terrainRttPosMatrix32f=null,h<X)throw new Error(`overscaledZ should be >= z; overscaledZ = ${h}; z = ${X}`);this.overscaledZ=h,this.wrap=W,this.canonical=new yh(X,+ie,+ue),this.key=js(W,h,X,ie,ue)}clone(){return new kn(this.overscaledZ,this.wrap,this.canonical.z,this.canonical.x,this.canonical.y)}equals(h){return this.overscaledZ===h.overscaledZ&&this.wrap===h.wrap&&this.canonical.equals(h.canonical)}scaledTo(h){if(h>this.overscaledZ)throw new Error(`targetZ > this.overscaledZ; targetZ = ${h}; overscaledZ = ${this.overscaledZ}`);const W=this.canonical.z-h;return h>this.canonical.z?new kn(h,this.wrap,this.canonical.z,this.canonical.x,this.canonical.y):new kn(h,this.wrap,h,this.canonical.x>>W,this.canonical.y>>W)}calculateScaledKey(h,W){if(h>this.overscaledZ)throw new Error(`targetZ > this.overscaledZ; targetZ = ${h}; overscaledZ = ${this.overscaledZ}`);const X=this.canonical.z-h;return h>this.canonical.z?js(this.wrap*+W,h,this.canonical.z,this.canonical.x,this.canonical.y):js(this.wrap*+W,h,h,this.canonical.x>>X,this.canonical.y>>X)}isChildOf(h){if(h.wrap!==this.wrap)return!1;const W=this.canonical.z-h.canonical.z;return h.overscaledZ===0||h.overscaledZ<this.overscaledZ&&h.canonical.x===this.canonical.x>>W&&h.canonical.y===this.canonical.y>>W}children(h){if(this.overscaledZ>=h)return[new kn(this.overscaledZ+1,this.wrap,this.canonical.z,this.canonical.x,this.canonical.y)];const W=this.canonical.z+1,X=2*this.canonical.x,ie=2*this.canonical.y;return[new kn(W,this.wrap,W,X,ie),new kn(W,this.wrap,W,X+1,ie),new kn(W,this.wrap,W,X,ie+1),new kn(W,this.wrap,W,X+1,ie+1)]}isLessThan(h){return this.wrap<h.wrap||!(this.wrap>h.wrap)&&(this.overscaledZ<h.overscaledZ||!(this.overscaledZ>h.overscaledZ)&&(this.canonical.x<h.canonical.x||!(this.canonical.x>h.canonical.x)&&this.canonical.y<h.canonical.y))}wrapped(){return new kn(this.overscaledZ,0,this.canonical.z,this.canonical.x,this.canonical.y)}unwrapTo(h){return new kn(this.overscaledZ,h,this.canonical.z,this.canonical.x,this.canonical.y)}overscaleFactor(){return Math.pow(2,this.overscaledZ-this.canonical.z)}toUnwrapped(){return new Ud(this.wrap,this.canonical)}toString(){return`${this.overscaledZ}/${this.canonical.x}/${this.canonical.y}`}getTilePoint(h){return this.canonical.getTilePoint(new el(h.x-this.wrap,h.y))}}function js(H,h,W,X,ie){(H*=2)<0&&(H=-1*H-1);const ue=1<<W;return(ue*ue*H+ue*ie+X).toString(36)+W.toString(36)+h.toString(36)}Tr("CanonicalTileID",yh),Tr("OverscaledTileID",kn,{omit:["terrainRttPosMatrix32f"]});class Ho{constructor(){this.minX=1/0,this.maxX=-1/0,this.minY=1/0,this.maxY=-1/0}extend(h){return this.minX=Math.min(this.minX,h.x),this.minY=Math.min(this.minY,h.y),this.maxX=Math.max(this.maxX,h.x),this.maxY=Math.max(this.maxY,h.y),this}expandBy(h){return this.minX-=h,this.minY-=h,this.maxX+=h,this.maxY+=h,(this.minX>this.maxX||this.minY>this.maxY)&&(this.minX=1/0,this.maxX=-1/0,this.minY=1/0,this.maxY=-1/0),this}shrinkBy(h){return this.expandBy(-h)}map(h){const W=new Ho;return W.extend(h(new ve(this.minX,this.minY))),W.extend(h(new ve(this.maxX,this.minY))),W.extend(h(new ve(this.minX,this.maxY))),W.extend(h(new ve(this.maxX,this.maxY))),W}static fromPoints(h){const W=new Ho;for(const X of h)W.extend(X);return W}contains(h){return h.x>=this.minX&&h.x<=this.maxX&&h.y>=this.minY&&h.y<=this.maxY}empty(){return this.minX>this.maxX}width(){return this.maxX-this.minX}height(){return this.maxY-this.minY}covers(h){return!this.empty()&&!h.empty()&&h.minX>=this.minX&&h.maxX<=this.maxX&&h.minY>=this.minY&&h.maxY<=this.maxY}intersects(h){return!this.empty()&&!h.empty()&&h.minX<=this.maxX&&h.maxX>=this.minX&&h.minY<=this.maxY&&h.maxY>=this.minY}}class Gd{constructor(h){this._stringToNumber={},this._numberToString=[];for(let W=0;W<h.length;W++){const X=h[W];this._stringToNumber[X]=W,this._numberToString[W]=X}}encode(h){return this._stringToNumber[h]}decode(h){if(h>=this._numberToString.length)throw new Error(`Out of bounds. Index requested n=${h} can't be >= this._numberToString.length ${this._numberToString.length}`);return this._numberToString[h]}}class Vd{constructor(h,W,X,ie,ue){this.type="Feature",this._vectorTileFeature=h,h._z=W,h._x=X,h._y=ie,this.properties=h.properties,this.id=ue}get geometry(){return this._geometry===void 0&&(this._geometry=this._vectorTileFeature.toGeoJSON(this._vectorTileFeature._x,this._vectorTileFeature._y,this._vectorTileFeature._z).geometry),this._geometry}set geometry(h){this._geometry=h}toJSON(){const h={geometry:this.geometry};for(const W in this)W!=="_geometry"&&W!=="_vectorTileFeature"&&(h[W]=this[W]);return h}}class $d{constructor(h,W){this.tileID=h,this.x=h.canonical.x,this.y=h.canonical.y,this.z=h.canonical.z,this.grid=new to(Dt,16,0),this.grid3D=new to(Dt,16,0),this.featureIndexArray=new Vt,this.promoteId=W}insert(h,W,X,ie,ue,ce){const fe=this.featureIndexArray.length;this.featureIndexArray.emplaceBack(X,ie,ue);const ye=ce?this.grid3D:this.grid;for(let be=0;be<W.length;be++){const we=W[be],Ie=[1/0,1/0,-1/0,-1/0];for(let Be=0;Be<we.length;Be++){const Ue=we[Be];Ie[0]=Math.min(Ie[0],Ue.x),Ie[1]=Math.min(Ie[1],Ue.y),Ie[2]=Math.max(Ie[2],Ue.x),Ie[3]=Math.max(Ie[3],Ue.y)}Ie[0]<Dt&&Ie[1]<Dt&&Ie[2]>=0&&Ie[3]>=0&&ye.insert(fe,Ie[0],Ie[1],Ie[2],Ie[3])}}loadVTLayers(){return this.vtLayers||(this.vtLayers=new Ku.VectorTile(new oh(this.rawTileData)).layers,this.sourceLayerCoder=new Gd(this.vtLayers?Object.keys(this.vtLayers).sort():["_geojsonTileLayer"])),this.vtLayers}query(h,W,X,ie){this.loadVTLayers();const ue=h.params,ce=Dt/h.tileSize/h.scale,fe=oa(ue.filter),ye=h.queryGeometry,be=h.queryPadding*ce,we=Ho.fromPoints(ye),Ie=this.grid.query(we.minX-be,we.minY-be,we.maxX+be,we.maxY+be),Be=Ho.fromPoints(h.cameraQueryGeometry).expandBy(be),Ue=this.grid3D.query(Be.minX,Be.minY,Be.maxX,Be.maxY,(rt,ct,Ct,wt)=>function(Ne,tt,Et,Ut,Jt){for(const Kt of Ne)if(tt<=Kt.x&&Et<=Kt.y&&Ut>=Kt.x&&Jt>=Kt.y)return!0;const Wt=[new ve(tt,Et),new ve(tt,Jt),new ve(Ut,Jt),new ve(Ut,Et)];if(Ne.length>2){for(const Kt of Wt)if(Ms(Ne,Kt))return!0}for(let Kt=0;Kt<Ne.length-1;Kt++)if(xf(Ne[Kt],Ne[Kt+1],Wt))return!0;return!1}(h.cameraQueryGeometry,rt-be,ct-be,Ct+be,wt+be));for(const rt of Ue)Ie.push(rt);Ie.sort(Fp);const $e={};let Xe;for(let rt=0;rt<Ie.length;rt++){const ct=Ie[rt];if(ct===Xe)continue;Xe=ct;const Ct=this.featureIndexArray.get(ct);let wt=null;this.loadMatchingFeature($e,Ct.bucketIndex,Ct.sourceLayerIndex,Ct.featureIndex,fe,ue.layers,ue.availableImages,W,X,ie,(Ne,tt,Et)=>(wt||(wt=Go(Ne)),tt.queryIntersectsFeature({queryGeometry:ye,feature:Ne,featureState:Et,geometry:wt,zoom:this.z,transform:h.transform,pixelsToTileUnits:ce,pixelPosMatrix:h.pixelPosMatrix,unwrappedTileID:this.tileID.toUnwrapped(),getElevation:h.getElevation})))}return $e}loadMatchingFeature(h,W,X,ie,ue,ce,fe,ye,be,we,Ie){const Be=this.bucketLayerIDs[W];if(ce&&!Be.some(rt=>ce.has(rt)))return;const Ue=this.sourceLayerCoder.decode(X),$e=this.vtLayers[Ue].feature(ie);if(ue.needGeometry){const rt=Vo($e,!0);if(!ue.filter(new Si(this.tileID.overscaledZ),rt,this.tileID.canonical))return}else if(!ue.filter(new Si(this.tileID.overscaledZ),$e))return;const Xe=this.getId($e,Ue);for(let rt=0;rt<Be.length;rt++){const ct=Be[rt];if(ce&&!ce.has(ct))continue;const Ct=ye[ct];if(!Ct)continue;let wt={};Xe&&we&&(wt=we.getState(Ct.sourceLayer||"_geojsonTileLayer",Xe));const Ne=Rr({},be[ct]);Ne.paint=Wd(Ne.paint,Ct.paint,$e,wt,fe),Ne.layout=Wd(Ne.layout,Ct.layout,$e,wt,fe);const tt=!Ie||Ie($e,Ct,wt);if(!tt)continue;const Et=new Vd($e,this.z,this.x,this.y,Xe);Et.layer=Ne;let Ut=h[ct];Ut===void 0&&(Ut=h[ct]=[]),Ut.push({featureIndex:ie,feature:Et,intersectionZ:tt})}}lookupSymbolFeatures(h,W,X,ie,ue,ce,fe,ye){const be={};this.loadVTLayers();const we=oa(ue);for(const Ie of h)this.loadMatchingFeature(be,X,ie,Ie,we,ce,fe,ye,W);return be}hasLayer(h){for(const W of this.bucketLayerIDs)for(const X of W)if(h===X)return!0;return!1}getId(h,W){var X;let ie=h.id;return this.promoteId&&(ie=h.properties[typeof this.promoteId=="string"?this.promoteId:this.promoteId[W]],typeof ie=="boolean"&&(ie=Number(ie)),ie===void 0&&(!((X=h.properties)===null||X===void 0)&&X.cluster)&&this.promoteId&&(ie=Number(h.properties.cluster_id))),ie}}function Wd(H,h,W,X,ie){return wr(H,(ue,ce)=>{const fe=h instanceof As?h.get(ce):null;return fe&&fe.evaluate?fe.evaluate(W,X,ie):fe})}function Fp(H,h){return h-H}function Hd(H,h,W,X,ie){const ue=[];for(let ce=0;ce<H.length;ce++){const fe=H[ce];let ye;for(let be=0;be<fe.length-1;be++){let we=fe[be],Ie=fe[be+1];we.x<h&&Ie.x<h||(we.x<h?we=new ve(h,we.y+(h-we.x)/(Ie.x-we.x)*(Ie.y-we.y))._round():Ie.x<h&&(Ie=new ve(h,we.y+(h-we.x)/(Ie.x-we.x)*(Ie.y-we.y))._round()),we.y<W&&Ie.y<W||(we.y<W?we=new ve(we.x+(W-we.y)/(Ie.y-we.y)*(Ie.x-we.x),W)._round():Ie.y<W&&(Ie=new ve(we.x+(W-we.y)/(Ie.y-we.y)*(Ie.x-we.x),W)._round()),we.x>=X&&Ie.x>=X||(we.x>=X?we=new ve(X,we.y+(X-we.x)/(Ie.x-we.x)*(Ie.y-we.y))._round():Ie.x>=X&&(Ie=new ve(X,we.y+(X-we.x)/(Ie.x-we.x)*(Ie.y-we.y))._round()),we.y>=ie&&Ie.y>=ie||(we.y>=ie?we=new ve(we.x+(ie-we.y)/(Ie.y-we.y)*(Ie.x-we.x),ie)._round():Ie.y>=ie&&(Ie=new ve(we.x+(ie-we.y)/(Ie.y-we.y)*(Ie.x-we.x),ie)._round()),ye&&we.equals(ye[ye.length-1])||(ye=[we],ue.push(ye)),ye.push(Ie)))))}}return ue}Tr("FeatureIndex",$d,{omit:["rawTileData","sourceLayerCoder"]});class uo extends ve{constructor(h,W,X,ie){super(h,W),this.angle=X,ie!==void 0&&(this.segment=ie)}clone(){return new uo(this.x,this.y,this.angle,this.segment)}}function Zd(H,h,W,X,ie){if(h.segment===void 0||W===0)return!0;let ue=h,ce=h.segment+1,fe=0;for(;fe>-W/2;){if(ce--,ce<0)return!1;fe-=H[ce].dist(ue),ue=H[ce]}fe+=H[ce].dist(H[ce+1]),ce++;const ye=[];let be=0;for(;fe<W/2;){const we=H[ce],Ie=H[ce+1];if(!Ie)return!1;let Be=H[ce-1].angleTo(we)-we.angleTo(Ie);for(Be=Math.abs((Be+3*Math.PI)%(2*Math.PI)-Math.PI),ye.push({distance:fe,angleDelta:Be}),be+=Be;fe-ye[0].distance>X;)be-=ye.shift().angleDelta;if(be>ie)return!1;ce++,fe+=we.dist(Ie)}return!0}function Kd(H){let h=0;for(let W=0;W<H.length-1;W++)h+=H[W].dist(H[W+1]);return h}function Yd(H,h,W){return H?.6*h*W:0}function Xd(H,h){return Math.max(H?H.right-H.left:0,h?h.right-h.left:0)}function kp(H,h,W,X,ie,ue){const ce=Yd(W,ie,ue),fe=Xd(W,X)*ue;let ye=0;const be=Kd(H)/2;for(let we=0;we<H.length-1;we++){const Ie=H[we],Be=H[we+1],Ue=Ie.dist(Be);if(ye+Ue>be){const $e=(be-ye)/Ue,Xe=En.number(Ie.x,Be.x,$e),rt=En.number(Ie.y,Be.y,$e),ct=new uo(Xe,rt,Be.angleTo(Ie),we);return ct._round(),!ce||Zd(H,ct,fe,ce,h)?ct:void 0}ye+=Ue}}function Lp(H,h,W,X,ie,ue,ce,fe,ye){const be=Yd(X,ue,ce),we=Xd(X,ie),Ie=we*ce,Be=H[0].x===0||H[0].x===ye||H[0].y===0||H[0].y===ye;return h-Ie<h/4&&(h=Ie+h/4),Jd(H,Be?h/2*fe%h:(we/2+2*ue)*ce*fe%h,h,be,W,Ie,Be,!1,ye)}function Jd(H,h,W,X,ie,ue,ce,fe,ye){const be=ue/2,we=Kd(H);let Ie=0,Be=h-W,Ue=[];for(let $e=0;$e<H.length-1;$e++){const Xe=H[$e],rt=H[$e+1],ct=Xe.dist(rt),Ct=rt.angleTo(Xe);for(;Be+W<Ie+ct;){Be+=W;const wt=(Be-Ie)/ct,Ne=En.number(Xe.x,rt.x,wt),tt=En.number(Xe.y,rt.y,wt);if(Ne>=0&&Ne<ye&&tt>=0&&tt<ye&&Be-be>=0&&Be+be<=we){const Et=new uo(Ne,tt,Ct,$e);Et._round(),X&&!Zd(H,Et,ue,X,ie)||Ue.push(Et)}}Ie+=ct}return fe||Ue.length||ce||(Ue=Jd(H,Ie/2,W,X,ie,ue,ce,!0,ye)),Ue}function Qd(H,h,W,X){const ie=[],ue=H.image,ce=ue.pixelRatio,fe=ue.paddedRect.w-2,ye=ue.paddedRect.h-2;let be={x1:H.left,y1:H.top,x2:H.right,y2:H.bottom};const we=ue.stretchX||[[0,fe]],Ie=ue.stretchY||[[0,ye]],Be=(Xt,Pr)=>Xt+Pr[1]-Pr[0],Ue=we.reduce(Be,0),$e=Ie.reduce(Be,0),Xe=fe-Ue,rt=ye-$e;let ct=0,Ct=Ue,wt=0,Ne=$e,tt=0,Et=Xe,Ut=0,Jt=rt;if(ue.content&&X){const Xt=ue.content,Pr=Xt[2]-Xt[0],Ur=Xt[3]-Xt[1];(ue.textFitWidth||ue.textFitHeight)&&(be=Id(H)),ct=sc(we,0,Xt[0]),wt=sc(Ie,0,Xt[1]),Ct=sc(we,Xt[0],Xt[2]),Ne=sc(Ie,Xt[1],Xt[3]),tt=Xt[0]-ct,Ut=Xt[1]-wt,Et=Pr-Ct,Jt=Ur-Ne}const Wt=be.x1,Kt=be.y1,ur=be.x2-Wt,tr=be.y2-Kt,dr=(Xt,Pr,Ur,Nr)=>{const kr=uc(Xt.stretch-ct,Ct,ur,Wt),si=lc(Xt.fixed-tt,Et,Xt.stretch,Ue),Fi=uc(Pr.stretch-wt,Ne,tr,Kt),Ui=lc(Pr.fixed-Ut,Jt,Pr.stretch,$e),cn=uc(Ur.stretch-ct,Ct,ur,Wt),Ln=lc(Ur.fixed-tt,Et,Ur.stretch,Ue),Tn=uc(Nr.stretch-wt,Ne,tr,Kt),nn=lc(Nr.fixed-Ut,Jt,Nr.stretch,$e),Pi=new ve(kr,Fi),Ki=new ve(cn,Fi),an=new ve(cn,Tn),on=new ve(kr,Tn),Sn=new ve(si/ce,Ui/ce),Bn=new ve(Ln/ce,nn/ce),Yi=h*Math.PI/180;if(Yi){const Xi=Math.sin(Yi),Ji=Math.cos(Yi),Ni=[Ji,-Xi,Xi,Ji];Pi._matMult(Ni),Ki._matMult(Ni),on._matMult(Ni),an._matMult(Ni)}const In=Xt.stretch+Xt.fixed,Gi=Pr.stretch+Pr.fixed;return{tl:Pi,tr:Ki,bl:on,br:an,tex:{x:ue.paddedRect.x+1+In,y:ue.paddedRect.y+1+Gi,w:Ur.stretch+Ur.fixed-In,h:Nr.stretch+Nr.fixed-Gi},writingMode:void 0,glyphOffset:[0,0],sectionIndex:0,pixelOffsetTL:Sn,pixelOffsetBR:Bn,minFontScaleX:Et/ce/ur,minFontScaleY:Jt/ce/tr,isSDF:W}};if(X&&(ue.stretchX||ue.stretchY)){const Xt=ef(we,Xe,Ue),Pr=ef(Ie,rt,$e);for(let Ur=0;Ur<Xt.length-1;Ur++){const Nr=Xt[Ur],kr=Xt[Ur+1];for(let si=0;si<Pr.length-1;si++)ie.push(dr(Nr,Pr[si],kr,Pr[si+1]))}}else ie.push(dr({fixed:0,stretch:-1},{fixed:0,stretch:-1},{fixed:0,stretch:fe+1},{fixed:0,stretch:ye+1}));return ie}function sc(H,h,W){let X=0;for(const ie of H)X+=Math.max(h,Math.min(W,ie[1]))-Math.max(h,Math.min(W,ie[0]));return X}function ef(H,h,W){const X=[{fixed:-1,stretch:0}];for(const[ie,ue]of H){const ce=X[X.length-1];X.push({fixed:ie-ce.stretch,stretch:ce.stretch}),X.push({fixed:ie-ce.stretch,stretch:ce.stretch+(ue-ie)})}return X.push({fixed:h+1,stretch:W}),X}function uc(H,h,W,X){return H/h*W+X}function lc(H,h,W,X){return H-h*W/X}Tr("Anchor",uo);class cc{constructor(h,W,X,ie,ue,ce,fe,ye,be,we){var Ie;if(this.boxStartIndex=h.length,be){let Be=ce.top,Ue=ce.bottom;const $e=ce.collisionPadding;$e&&(Be-=$e[1],Ue+=$e[3]);let Xe=Ue-Be;Xe>0&&(Xe=Math.max(10,Xe),this.circleDiameter=Xe)}else{const Be=!((Ie=ce.image)===null||Ie===void 0)&&Ie.content&&(ce.image.textFitWidth||ce.image.textFitHeight)?Id(ce):{x1:ce.left,y1:ce.top,x2:ce.right,y2:ce.bottom};Be.y1=Be.y1*fe-ye[0],Be.y2=Be.y2*fe+ye[2],Be.x1=Be.x1*fe-ye[3],Be.x2=Be.x2*fe+ye[1];const Ue=ce.collisionPadding;if(Ue&&(Be.x1-=Ue[0]*fe,Be.y1-=Ue[1]*fe,Be.x2+=Ue[2]*fe,Be.y2+=Ue[3]*fe),we){const $e=new ve(Be.x1,Be.y1),Xe=new ve(Be.x2,Be.y1),rt=new ve(Be.x1,Be.y2),ct=new ve(Be.x2,Be.y2),Ct=we*Math.PI/180;$e._rotate(Ct),Xe._rotate(Ct),rt._rotate(Ct),ct._rotate(Ct),Be.x1=Math.min($e.x,Xe.x,rt.x,ct.x),Be.x2=Math.max($e.x,Xe.x,rt.x,ct.x),Be.y1=Math.min($e.y,Xe.y,rt.y,ct.y),Be.y2=Math.max($e.y,Xe.y,rt.y,ct.y)}h.emplaceBack(W.x,W.y,Be.x1,Be.y1,Be.x2,Be.y2,X,ie,ue)}this.boxEndIndex=h.length}}class Bp{constructor(h=[],W=(X,ie)=>X<ie?-1:X>ie?1:0){if(this.data=h,this.length=this.data.length,this.compare=W,this.length>0)for(let X=(this.length>>1)-1;X>=0;X--)this._down(X)}push(h){this.data.push(h),this._up(this.length++)}pop(){if(this.length===0)return;const h=this.data[0],W=this.data.pop();return--this.length>0&&(this.data[0]=W,this._down(0)),h}peek(){return this.data[0]}_up(h){const{data:W,compare:X}=this,ie=W[h];for(;h>0;){const ue=h-1>>1,ce=W[ue];if(X(ie,ce)>=0)break;W[h]=ce,h=ue}W[h]=ie}_down(h){const{data:W,compare:X}=this,ie=this.length>>1,ue=W[h];for(;h<ie;){let ce=1+(h<<1);const fe=ce+1;if(fe<this.length&&X(W[fe],W[ce])<0&&(ce=fe),X(W[ce],ue)>=0)break;W[h]=W[ce],h=ce}W[h]=ue}}function jp(H,h=1,W=!1){const X=Ho.fromPoints(H[0]),ie=Math.min(X.width(),X.height());let ue=ie/2;const ce=new Bp([],Np),{minX:fe,minY:ye,maxX:be,maxY:we}=X;if(ie===0)return new ve(fe,ye);for(let Ue=fe;Ue<be;Ue+=ie)for(let $e=ye;$e<we;$e+=ie)ce.push(new Ns(Ue+ue,$e+ue,ue,H));let Ie=function(Ue){let $e=0,Xe=0,rt=0;const ct=Ue[0];for(let Ct=0,wt=ct.length,Ne=wt-1;Ct<wt;Ne=Ct++){const tt=ct[Ct],Et=ct[Ne],Ut=tt.x*Et.y-Et.x*tt.y;Xe+=(tt.x+Et.x)*Ut,rt+=(tt.y+Et.y)*Ut,$e+=3*Ut}return new Ns(Xe/$e,rt/$e,0,Ue)}(H),Be=ce.length;for(;ce.length;){const Ue=ce.pop();(Ue.d>Ie.d||!Ie.d)&&(Ie=Ue,W&&console.log("found best %d after %d probes",Math.round(1e4*Ue.d)/1e4,Be)),Ue.max-Ie.d<=h||(ue=Ue.h/2,ce.push(new Ns(Ue.p.x-ue,Ue.p.y-ue,ue,H)),ce.push(new Ns(Ue.p.x+ue,Ue.p.y-ue,ue,H)),ce.push(new Ns(Ue.p.x-ue,Ue.p.y+ue,ue,H)),ce.push(new Ns(Ue.p.x+ue,Ue.p.y+ue,ue,H)),Be+=4)}return W&&(console.log(`num probes: ${Be}`),console.log(`best distance: ${Ie.d}`)),Ie.p}function Np(H,h){return h.max-H.max}function Ns(H,h,W,X){this.p=new ve(H,h),this.h=W,this.d=function(ie,ue){let ce=!1,fe=1/0;for(let ye=0;ye<ue.length;ye++){const be=ue[ye];for(let we=0,Ie=be.length,Be=Ie-1;we<Ie;Be=we++){const Ue=be[we],$e=be[Be];Ue.y>ie.y!=$e.y>ie.y&&ie.x<($e.x-Ue.x)*(ie.y-Ue.y)/($e.y-Ue.y)+Ue.x&&(ce=!ce),fe=Math.min(fe,Mh(ie,Ue,$e))}}return(ce?1:-1)*Math.sqrt(fe)}(this.p,X),this.max=this.d+this.h*Math.SQRT2}var ln;Q.aD=void 0,(ln=Q.aD||(Q.aD={}))[ln.center=1]="center",ln[ln.left=2]="left",ln[ln.right=3]="right",ln[ln.top=4]="top",ln[ln.bottom=5]="bottom",ln[ln["top-left"]=6]="top-left",ln[ln["top-right"]=7]="top-right",ln[ln["bottom-left"]=8]="bottom-left",ln[ln["bottom-right"]=9]="bottom-right";const gh=Number.POSITIVE_INFINITY;function tf(H,h){return h[1]!==gh?function(W,X,ie){let ue=0,ce=0;switch(X=Math.abs(X),ie=Math.abs(ie),W){case"top-right":case"top-left":case"top":ce=ie-7;break;case"bottom-right":case"bottom-left":case"bottom":ce=7-ie}switch(W){case"top-right":case"bottom-right":case"right":ue=-X;break;case"top-left":case"bottom-left":case"left":ue=X}return[ue,ce]}(H,h[0],h[1]):function(W,X){let ie=0,ue=0;X<0&&(X=0);const ce=X/Math.SQRT2;switch(W){case"top-right":case"top-left":ue=ce-7;break;case"bottom-right":case"bottom-left":ue=7-ce;break;case"bottom":ue=7-X;break;case"top":ue=X-7}switch(W){case"top-right":case"bottom-right":ie=-ce;break;case"top-left":case"bottom-left":ie=ce;break;case"left":ie=X;break;case"right":ie=-X}return[ie,ue]}(H,h[0])}function rf(H,h,W){var X;const ie=H.layout,ue=(X=ie.get("text-variable-anchor-offset"))===null||X===void 0?void 0:X.evaluate(h,{},W);if(ue){const fe=ue.values,ye=[];for(let be=0;be<fe.length;be+=2){const we=ye[be]=fe[be],Ie=fe[be+1].map(Be=>Be*Zi);we.startsWith("top")?Ie[1]-=7:we.startsWith("bottom")&&(Ie[1]+=7),ye[be+1]=Ie}return new ui(ye)}const ce=ie.get("text-variable-anchor");if(ce){let fe;fe=H._unevaluatedLayout.getValue("text-radial-offset")!==void 0?[ie.get("text-radial-offset").evaluate(h,{},W)*Zi,gh]:ie.get("text-offset").evaluate(h,{},W).map(be=>be*Zi);const ye=[];for(const be of ce)ye.push(be,tf(be,fe));return new ui(ye)}return null}function vh(H){switch(H){case"right":case"top-right":case"bottom-right":return"right";case"left":case"top-left":case"bottom-left":return"left"}return"center"}function zp(H,h,W,X,ie,ue,ce,fe,ye,be,we,Ie){let Be=ue.textMaxSize.evaluate(h,{});Be===void 0&&(Be=ce);const Ue=H.layers[0].layout,$e=Ue.get("icon-offset").evaluate(h,{},we),Xe=af(W.horizontal),rt=ce/24,ct=H.tilePixelRatio*rt,Ct=H.tilePixelRatio*Be/24,wt=H.tilePixelRatio*fe,Ne=H.tilePixelRatio*Ue.get("symbol-spacing"),tt=Ue.get("text-padding")*H.tilePixelRatio,Et=function(Ur,Nr,kr,si=1){const Fi=Ur.get("icon-padding").evaluate(Nr,{},kr),Ui=Fi&&Fi.values;return[Ui[0]*si,Ui[1]*si,Ui[2]*si,Ui[3]*si]}(Ue,h,we,H.tilePixelRatio),Ut=Ue.get("text-max-angle")/180*Math.PI,Jt=Ue.get("text-rotation-alignment")!=="viewport"&&Ue.get("symbol-placement")!=="point",Wt=Ue.get("icon-rotation-alignment")==="map"&&Ue.get("symbol-placement")!=="point",Kt=Ue.get("symbol-placement"),ur=Ne/2,tr=Ue.get("icon-text-fit");let dr;X&&tr!=="none"&&(H.allowVerticalPlacement&&W.vertical&&(dr=Rd(X,W.vertical,tr,Ue.get("icon-text-fit-padding"),$e,rt)),Xe&&(X=Rd(X,Xe,tr,Ue.get("icon-text-fit-padding"),$e,rt)));const Xt=we?Ie.line.getGranularityForZoomLevel(we.z):1,Pr=(Ur,Nr)=>{Nr.x<0||Nr.x>=Dt||Nr.y<0||Nr.y>=Dt||function(kr,si,Fi,Ui,cn,Ln,Tn,nn,Pi,Ki,an,on,Sn,Bn,Yi,In,Gi,Xi,Ji,Ni,wi,Jn,zs,Qn,Vp){const Us=kr.addToLineVertexArray(si,Fi);let Zo,Gs,Vs,$s,lf=0,cf=0,hf=0,df=0,Ih=-1,Rh=-1;const Pa={};let ff=wn("");if(kr.allowVerticalPlacement&&Ui.vertical){const mn=nn.layout.get("text-rotate").evaluate(wi,{},Qn)+90;Vs=new cc(Pi,si,Ki,an,on,Ui.vertical,Sn,Bn,Yi,mn),Tn&&($s=new cc(Pi,si,Ki,an,on,Tn,Gi,Xi,Yi,mn))}if(cn){const mn=nn.layout.get("icon-rotate").evaluate(wi,{}),jn=nn.layout.get("icon-text-fit")!=="none",Ko=Qd(cn,mn,zs,jn),ta=Tn?Qd(Tn,mn,zs,jn):void 0;Gs=new cc(Pi,si,Ki,an,on,cn,Gi,Xi,!1,mn),lf=4*Ko.length;const Yo=kr.iconSizeData;let ma=null;Yo.kind==="source"?(ma=[Aa*nn.layout.get("icon-size").evaluate(wi,{})],ma[0]>oo&&br(`${kr.layerIds[0]}: Value for "icon-size" is >= 255. Reduce your "icon-size".`)):Yo.kind==="composite"&&(ma=[Aa*Jn.compositeIconSizes[0].evaluate(wi,{},Qn),Aa*Jn.compositeIconSizes[1].evaluate(wi,{},Qn)],(ma[0]>oo||ma[1]>oo)&&br(`${kr.layerIds[0]}: Value for "icon-size" is >= 255. Reduce your "icon-size".`)),kr.addSymbols(kr.icon,Ko,ma,Ni,Ji,wi,Q.an.none,si,Us.lineStartIndex,Us.lineLength,-1,Qn),Ih=kr.icon.placedSymbolArray.length-1,ta&&(cf=4*ta.length,kr.addSymbols(kr.icon,ta,ma,Ni,Ji,wi,Q.an.vertical,si,Us.lineStartIndex,Us.lineLength,-1,Qn),Rh=kr.icon.placedSymbolArray.length-1)}const pf=Object.keys(Ui.horizontal);for(const mn of pf){const jn=Ui.horizontal[mn];if(!Zo){ff=wn(jn.text);const ta=nn.layout.get("text-rotate").evaluate(wi,{},Qn);Zo=new cc(Pi,si,Ki,an,on,jn,Sn,Bn,Yi,ta)}const Ko=jn.positionedLines.length===1;if(hf+=nf(kr,si,jn,Ln,nn,Yi,wi,In,Us,Ui.vertical?Q.an.horizontal:Q.an.horizontalOnly,Ko?pf:[mn],Pa,Ih,Jn,Qn),Ko)break}Ui.vertical&&(df+=nf(kr,si,Ui.vertical,Ln,nn,Yi,wi,In,Us,Q.an.vertical,["vertical"],Pa,Rh,Jn,Qn));const $p=Zo?Zo.boxStartIndex:kr.collisionBoxArray.length,Wp=Zo?Zo.boxEndIndex:kr.collisionBoxArray.length,Hp=Vs?Vs.boxStartIndex:kr.collisionBoxArray.length,Zp=Vs?Vs.boxEndIndex:kr.collisionBoxArray.length,Kp=Gs?Gs.boxStartIndex:kr.collisionBoxArray.length,Yp=Gs?Gs.boxEndIndex:kr.collisionBoxArray.length,Xp=$s?$s.boxStartIndex:kr.collisionBoxArray.length,Jp=$s?$s.boxEndIndex:kr.collisionBoxArray.length;let ea=-1;const dc=(mn,jn)=>mn&&mn.circleDiameter?Math.max(mn.circleDiameter,jn):jn;ea=dc(Zo,ea),ea=dc(Vs,ea),ea=dc(Gs,ea),ea=dc($s,ea);const _f=ea>-1?1:0;_f&&(ea*=Vp/Zi),kr.glyphOffsetArray.length>=Bs.MAX_GLYPHS&&br("Too many glyphs being rendered in a tile. See https://github.com/mapbox/mapbox-gl-js/issues/2907"),wi.sortKey!==void 0&&kr.addToSortKeyRanges(kr.symbolInstances.length,wi.sortKey);const Qp=rf(nn,wi,Qn),[e_,t_]=function(mn,jn){const Ko=mn.length,ta=jn==null?void 0:jn.values;if((ta==null?void 0:ta.length)>0)for(let Yo=0;Yo<ta.length;Yo+=2){const ma=ta[Yo+1];mn.emplaceBack(Q.aD[ta[Yo]],ma[0],ma[1])}return[Ko,mn.length]}(kr.textAnchorOffsets,Qp);kr.symbolInstances.emplaceBack(si.x,si.y,Pa.right>=0?Pa.right:-1,Pa.center>=0?Pa.center:-1,Pa.left>=0?Pa.left:-1,Pa.vertical||-1,Ih,Rh,ff,$p,Wp,Hp,Zp,Kp,Yp,Xp,Jp,Ki,hf,df,lf,cf,_f,0,Sn,ea,e_,t_)}(H,Nr,Ur,W,X,ie,dr,H.layers[0],H.collisionBoxArray,h.index,h.sourceLayerIndex,H.index,ct,[tt,tt,tt,tt],Jt,ye,wt,Et,Wt,$e,h,ue,be,we,ce)};if(Kt==="line")for(const Ur of Hd(h.geometry,0,0,Dt,Dt)){const Nr=Wo(Ur,Xt),kr=Lp(Nr,Ne,Ut,W.vertical||Xe,X,24,Ct,H.overscaling,Dt);for(const si of kr)Xe&&Up(H,Xe.text,ur,si)||Pr(Nr,si)}else if(Kt==="line-center"){for(const Ur of h.geometry)if(Ur.length>1){const Nr=Wo(Ur,Xt),kr=kp(Nr,Ut,W.vertical||Xe,X,24,Ct);kr&&Pr(Nr,kr)}}else if(h.type==="Polygon")for(const Ur of os(h.geometry,0)){const Nr=jp(Ur,16);Pr(Wo(Ur[0],Xt,!0),new uo(Nr.x,Nr.y,0))}else if(h.type==="LineString")for(const Ur of h.geometry){const Nr=Wo(Ur,Xt);Pr(Nr,new uo(Nr[0].x,Nr[0].y,0))}else if(h.type==="Point")for(const Ur of h.geometry)for(const Nr of Ur)Pr([Nr],new uo(Nr.x,Nr.y,0))}function nf(H,h,W,X,ie,ue,ce,fe,ye,be,we,Ie,Be,Ue,$e){const Xe=function(Ct,wt,Ne,tt,Et,Ut,Jt,Wt){const Kt=tt.layout.get("text-rotate").evaluate(Ut,{})*Math.PI/180,ur=[];for(const tr of wt.positionedLines)for(const dr of tr.positionedGlyphs){if(!dr.rect)continue;const Xt=dr.rect||{};let Pr=4,Ur=!0,Nr=1,kr=0;const si=(Et||Wt)&&dr.vertical,Fi=dr.metrics.advance*dr.scale/2;if(Wt&&wt.verticalizable&&(kr=tr.lineOffset/2-(dr.imageName?-(Zi-dr.metrics.width*dr.scale)/2:(dr.scale-1)*Zi)),dr.imageName){const Xi=Jt[dr.imageName];Ur=Xi.sdf,Nr=Xi.pixelRatio,Pr=1/Nr}const Ui=Et?[dr.x+Fi,dr.y]:[0,0];let cn=Et?[0,0]:[dr.x+Fi+Ne[0],dr.y+Ne[1]-kr],Ln=[0,0];si&&(Ln=cn,cn=[0,0]);const Tn=dr.metrics.isDoubleResolution?2:1,nn=(dr.metrics.left-Pr)*dr.scale-Fi+cn[0],Pi=(-dr.metrics.top-Pr)*dr.scale+cn[1],Ki=nn+Xt.w/Tn*dr.scale/Nr,an=Pi+Xt.h/Tn*dr.scale/Nr,on=new ve(nn,Pi),Sn=new ve(Ki,Pi),Bn=new ve(nn,an),Yi=new ve(Ki,an);if(si){const Xi=new ve(-Fi,Fi- -17),Ji=-Math.PI/2,Ni=12-Fi,wi=new ve(22-Ni,-(dr.imageName?Ni:0)),Jn=new ve(...Ln);on._rotateAround(Ji,Xi)._add(wi)._add(Jn),Sn._rotateAround(Ji,Xi)._add(wi)._add(Jn),Bn._rotateAround(Ji,Xi)._add(wi)._add(Jn),Yi._rotateAround(Ji,Xi)._add(wi)._add(Jn)}if(Kt){const Xi=Math.sin(Kt),Ji=Math.cos(Kt),Ni=[Ji,-Xi,Xi,Ji];on._matMult(Ni),Sn._matMult(Ni),Bn._matMult(Ni),Yi._matMult(Ni)}const In=new ve(0,0),Gi=new ve(0,0);ur.push({tl:on,tr:Sn,bl:Bn,br:Yi,tex:Xt,writingMode:wt.writingMode,glyphOffset:Ui,sectionIndex:dr.sectionIndex,isSDF:Ur,pixelOffsetTL:In,pixelOffsetBR:Gi,minFontScaleX:0,minFontScaleY:0})}return ur}(0,W,fe,ie,ue,ce,X,H.allowVerticalPlacement),rt=H.textSizeData;let ct=null;rt.kind==="source"?(ct=[Aa*ie.layout.get("text-size").evaluate(ce,{})],ct[0]>oo&&br(`${H.layerIds[0]}: Value for "text-size" is >= 255. Reduce your "text-size".`)):rt.kind==="composite"&&(ct=[Aa*Ue.compositeTextSizes[0].evaluate(ce,{},$e),Aa*Ue.compositeTextSizes[1].evaluate(ce,{},$e)],(ct[0]>oo||ct[1]>oo)&&br(`${H.layerIds[0]}: Value for "text-size" is >= 255. Reduce your "text-size".`)),H.addSymbols(H.text,Xe,ct,fe,ue,ce,be,h,ye.lineStartIndex,ye.lineLength,Be,$e);for(const Ct of we)Ie[Ct]=H.text.placedSymbolArray.length-1;return 4*Xe.length}function af(H){for(const h in H)return H[h];return null}function Up(H,h,W,X){const ie=H.compareText;if(h in ie){const ue=ie[h];for(let ce=ue.length-1;ce>=0;ce--)if(X.dist(ue[ce])<W)return!0}else ie[h]=[];return ie[h].push(X),!1}const of=[Int8Array,Uint8Array,Uint8ClampedArray,Int16Array,Uint16Array,Int32Array,Uint32Array,Float32Array,Float64Array];class bh{static from(h){if(!(h instanceof ArrayBuffer))throw new Error("Data must be an instance of ArrayBuffer.");const[W,X]=new Uint8Array(h,0,2);if(W!==219)throw new Error("Data does not appear to be in a KDBush format.");const ie=X>>4;if(ie!==1)throw new Error(`Got v${ie} data when expected v1.`);const ue=of[15&X];if(!ue)throw new Error("Unrecognized array type.");const[ce]=new Uint16Array(h,2,1),[fe]=new Uint32Array(h,4,1);return new bh(fe,ce,ue,h)}constructor(h,W=64,X=Float64Array,ie){if(isNaN(h)||h<0)throw new Error(`Unpexpected numItems value: ${h}.`);this.numItems=+h,this.nodeSize=Math.min(Math.max(+W,2),65535),this.ArrayType=X,this.IndexArrayType=h<65536?Uint16Array:Uint32Array;const ue=of.indexOf(this.ArrayType),ce=2*h*this.ArrayType.BYTES_PER_ELEMENT,fe=h*this.IndexArrayType.BYTES_PER_ELEMENT,ye=(8-fe%8)%8;if(ue<0)throw new Error(`Unexpected typed array class: ${X}.`);ie&&ie instanceof ArrayBuffer?(this.data=ie,this.ids=new this.IndexArrayType(this.data,8,h),this.coords=new this.ArrayType(this.data,8+fe+ye,2*h),this._pos=2*h,this._finished=!0):(this.data=new ArrayBuffer(8+ce+fe+ye),this.ids=new this.IndexArrayType(this.data,8,h),this.coords=new this.ArrayType(this.data,8+fe+ye,2*h),this._pos=0,this._finished=!1,new Uint8Array(this.data,0,2).set([219,16+ue]),new Uint16Array(this.data,2,1)[0]=W,new Uint32Array(this.data,4,1)[0]=h)}add(h,W){const X=this._pos>>1;return this.ids[X]=X,this.coords[this._pos++]=h,this.coords[this._pos++]=W,X}finish(){const h=this._pos>>1;if(h!==this.numItems)throw new Error(`Added ${h} items when expected ${this.numItems}.`);return xh(this.ids,this.coords,this.nodeSize,0,this.numItems-1,0),this._finished=!0,this}range(h,W,X,ie){if(!this._finished)throw new Error("Data not yet indexed - call index.finish().");const{ids:ue,coords:ce,nodeSize:fe}=this,ye=[0,ue.length-1,0],be=[];for(;ye.length;){const we=ye.pop()||0,Ie=ye.pop()||0,Be=ye.pop()||0;if(Ie-Be<=fe){for(let rt=Be;rt<=Ie;rt++){const ct=ce[2*rt],Ct=ce[2*rt+1];ct>=h&&ct<=X&&Ct>=W&&Ct<=ie&&be.push(ue[rt])}continue}const Ue=Be+Ie>>1,$e=ce[2*Ue],Xe=ce[2*Ue+1];$e>=h&&$e<=X&&Xe>=W&&Xe<=ie&&be.push(ue[Ue]),(we===0?h<=$e:W<=Xe)&&(ye.push(Be),ye.push(Ue-1),ye.push(1-we)),(we===0?X>=$e:ie>=Xe)&&(ye.push(Ue+1),ye.push(Ie),ye.push(1-we))}return be}within(h,W,X){if(!this._finished)throw new Error("Data not yet indexed - call index.finish().");const{ids:ie,coords:ue,nodeSize:ce}=this,fe=[0,ie.length-1,0],ye=[],be=X*X;for(;fe.length;){const we=fe.pop()||0,Ie=fe.pop()||0,Be=fe.pop()||0;if(Ie-Be<=ce){for(let rt=Be;rt<=Ie;rt++)uf(ue[2*rt],ue[2*rt+1],h,W)<=be&&ye.push(ie[rt]);continue}const Ue=Be+Ie>>1,$e=ue[2*Ue],Xe=ue[2*Ue+1];uf($e,Xe,h,W)<=be&&ye.push(ie[Ue]),(we===0?h-X<=$e:W-X<=Xe)&&(fe.push(Be),fe.push(Ue-1),fe.push(1-we)),(we===0?h+X>=$e:W+X>=Xe)&&(fe.push(Ue+1),fe.push(Ie),fe.push(1-we))}return ye}}function xh(H,h,W,X,ie,ue){if(ie-X<=W)return;const ce=X+ie>>1;sf(H,h,ce,X,ie,ue),xh(H,h,W,X,ce-1,1-ue),xh(H,h,W,ce+1,ie,1-ue)}function sf(H,h,W,X,ie,ue){for(;ie>X;){if(ie-X>600){const be=ie-X+1,we=W-X+1,Ie=Math.log(be),Be=.5*Math.exp(2*Ie/3),Ue=.5*Math.sqrt(Ie*Be*(be-Be)/be)*(we-be/2<0?-1:1);sf(H,h,W,Math.max(X,Math.floor(W-we*Be/be+Ue)),Math.min(ie,Math.floor(W+(be-we)*Be/be+Ue)),ue)}const ce=h[2*W+ue];let fe=X,ye=ie;for(tl(H,h,X,W),h[2*ie+ue]>ce&&tl(H,h,X,ie);fe<ye;){for(tl(H,h,fe,ye),fe++,ye--;h[2*fe+ue]<ce;)fe++;for(;h[2*ye+ue]>ce;)ye--}h[2*X+ue]===ce?tl(H,h,X,ye):(ye++,tl(H,h,ye,ie)),ye<=W&&(X=ye+1),W<=ye&&(ie=ye-1)}}function tl(H,h,W,X){wh(H,W,X),wh(h,2*W,2*X),wh(h,2*W+1,2*X+1)}function wh(H,h,W){const X=H[h];H[h]=H[W],H[W]=X}function uf(H,h,W,X){const ie=H-W,ue=h-X;return ie*ie+ue*ue}var Sh;Q.cw=void 0,(Sh=Q.cw||(Q.cw={})).create="create",Sh.load="load",Sh.fullLoad="fullLoad";let hc=null,rl=[];const Eh=1e3/60,qh="loadTime",Th="fullLoadTime",Gp={mark(H){performance.mark(H)},frame(H){const h=H;hc!=null&&rl.push(h-hc),hc=h},clearMetrics(){hc=null,rl=[],performance.clearMeasures(qh),performance.clearMeasures(Th);for(const H in Q.cw)performance.clearMarks(Q.cw[H])},getPerformanceMetrics(){performance.measure(qh,Q.cw.create,Q.cw.load),performance.measure(Th,Q.cw.create,Q.cw.fullLoad);const H=performance.getEntriesByName(qh)[0].duration,h=performance.getEntriesByName(Th)[0].duration,W=rl.length,X=1/(rl.reduce((ue,ce)=>ue+ce,0)/W/1e3),ie=rl.filter(ue=>ue>Eh).reduce((ue,ce)=>ue+(ce-Eh)/Eh,0);return{loadTime:H,fullLoadTime:h,fps:X,percentDroppedFrames:ie/(W+ie)*100,totalFrames:W}}};Q.$=Dt,Q.A=Ze,Q.B=function([H,h,W]){return h+=90,h*=Math.PI/180,W*=Math.PI/180,{x:H*Math.cos(h)*Math.sin(W),y:H*Math.sin(h)*Math.sin(W),z:H*Math.cos(W)}},Q.C=En,Q.D=Or,Q.E=Nt,Q.F=Si,Q.G=qs,Q.H=function(H){if(zr==null){const h=H.navigator?H.navigator.userAgent:null;zr=!!H.safari||!(!h||!(/\b(iPad|iPhone|iPod)\b/.test(h)||h.match("Safari")&&!h.match("Chrome")))}return zr},Q.I=sh,Q.J=class{constructor(H,h){this.target=H,this.mapId=h,this.resolveRejects={},this.tasks={},this.taskQueue=[],this.abortControllers={},this.messageHandlers={},this.invoker=new Mp(()=>this.process()),this.subscription=xr(this.target,"message",W=>this.receive(W),!1),this.globalScope=Br(self)?H:window}registerMessageHandler(H,h){this.messageHandlers[H]=h}sendAsync(H,h){return new Promise((W,X)=>{const ie=Math.round(1e18*Math.random()).toString(36).substring(0,10),ue=h?xr(h.signal,"abort",()=>{ue==null||ue.unsubscribe(),delete this.resolveRejects[ie];const ye={id:ie,type:"<cancel>",origin:location.origin,targetMapId:H.targetMapId,sourceMapId:this.mapId};this.target.postMessage(ye)},Dp):null;this.resolveRejects[ie]={resolve:ye=>{ue==null||ue.unsubscribe(),W(ye)},reject:ye=>{ue==null||ue.unsubscribe(),X(ye)}};const ce=[],fe=Object.assign(Object.assign({},H),{id:ie,sourceMapId:this.mapId,origin:location.origin,data:Do(H.data,ce)});this.target.postMessage(fe,{transfer:ce})})}receive(H){const h=H.data,W=h.id;if(!(h.origin!=="file://"&&location.origin!=="file://"&&h.origin!=="resource://android"&&location.origin!=="resource://android"&&h.origin!==location.origin||h.targetMapId&&this.mapId!==h.targetMapId)){if(h.type==="<cancel>"){delete this.tasks[W];const X=this.abortControllers[W];return delete this.abortControllers[W],void(X&&X.abort())}if(Br(self)||h.mustQueue)return this.tasks[W]=h,this.taskQueue.push(W),void this.invoker.trigger();this.processTask(W,h)}}process(){if(this.taskQueue.length===0)return;const H=this.taskQueue.shift(),h=this.tasks[H];delete this.tasks[H],this.taskQueue.length>0&&this.invoker.trigger(),h&&this.processTask(H,h)}processTask(H,h){return R(this,void 0,void 0,function*(){if(h.type==="<response>"){const ie=this.resolveRejects[H];return delete this.resolveRejects[H],ie?void(h.error?ie.reject(ro(h.error)):ie.resolve(ro(h.data))):void 0}if(!this.messageHandlers[h.type])return void this.completeTask(H,new Error(`Could not find a registered handler for ${h.type}, map ID: ${this.mapId}, available handlers: ${Object.keys(this.messageHandlers).join(", ")}`));const W=ro(h.data),X=new AbortController;this.abortControllers[H]=X;try{const ie=yield this.messageHandlers[h.type](h.sourceMapId,W,X);this.completeTask(H,null,ie)}catch(ie){this.completeTask(H,ie)}})}completeTask(H,h,W){const X=[];delete this.abortControllers[H];const ie={id:H,type:"<response>",sourceMapId:this.mapId,origin:location.origin,error:h?Do(h):null,data:Do(W,X)};this.target.postMessage(ie,{transfer:X})}remove(){this.invoker.remove(),this.subscription.unsubscribe()}},Q.K=ze,Q.L=function(){var H=new Ze(16);return Ze!=Float32Array&&(H[1]=0,H[2]=0,H[3]=0,H[4]=0,H[6]=0,H[7]=0,H[8]=0,H[9]=0,H[11]=0,H[12]=0,H[13]=0,H[14]=0),H[0]=1,H[5]=1,H[10]=1,H[15]=1,H},Q.M=function(H,h,W){var X,ie,ue,ce,fe,ye,be,we,Ie,Be,Ue,$e,Xe=W[0],rt=W[1],ct=W[2];return h===H?(H[12]=h[0]*Xe+h[4]*rt+h[8]*ct+h[12],H[13]=h[1]*Xe+h[5]*rt+h[9]*ct+h[13],H[14]=h[2]*Xe+h[6]*rt+h[10]*ct+h[14],H[15]=h[3]*Xe+h[7]*rt+h[11]*ct+h[15]):(ie=h[1],ue=h[2],ce=h[3],fe=h[4],ye=h[5],be=h[6],we=h[7],Ie=h[8],Be=h[9],Ue=h[10],$e=h[11],H[0]=X=h[0],H[1]=ie,H[2]=ue,H[3]=ce,H[4]=fe,H[5]=ye,H[6]=be,H[7]=we,H[8]=Ie,H[9]=Be,H[10]=Ue,H[11]=$e,H[12]=X*Xe+fe*rt+Ie*ct+h[12],H[13]=ie*Xe+ye*rt+Be*ct+h[13],H[14]=ue*Xe+be*rt+Ue*ct+h[14],H[15]=ce*Xe+we*rt+$e*ct+h[15]),H},Q.N=function(H,h,W){var X=W[0],ie=W[1],ue=W[2];return H[0]=h[0]*X,H[1]=h[1]*X,H[2]=h[2]*X,H[3]=h[3]*X,H[4]=h[4]*ie,H[5]=h[5]*ie,H[6]=h[6]*ie,H[7]=h[7]*ie,H[8]=h[8]*ue,H[9]=h[9]*ue,H[10]=h[10]*ue,H[11]=h[11]*ue,H[12]=h[12],H[13]=h[13],H[14]=h[14],H[15]=h[15],H},Q.O=function(H,h,W){var X=h[0],ie=h[1],ue=h[2],ce=h[3],fe=h[4],ye=h[5],be=h[6],we=h[7],Ie=h[8],Be=h[9],Ue=h[10],$e=h[11],Xe=h[12],rt=h[13],ct=h[14],Ct=h[15],wt=W[0],Ne=W[1],tt=W[2],Et=W[3];return H[0]=wt*X+Ne*fe+tt*Ie+Et*Xe,H[1]=wt*ie+Ne*ye+tt*Be+Et*rt,H[2]=wt*ue+Ne*be+tt*Ue+Et*ct,H[3]=wt*ce+Ne*we+tt*$e+Et*Ct,H[4]=(wt=W[4])*X+(Ne=W[5])*fe+(tt=W[6])*Ie+(Et=W[7])*Xe,H[5]=wt*ie+Ne*ye+tt*Be+Et*rt,H[6]=wt*ue+Ne*be+tt*Ue+Et*ct,H[7]=wt*ce+Ne*we+tt*$e+Et*Ct,H[8]=(wt=W[8])*X+(Ne=W[9])*fe+(tt=W[10])*Ie+(Et=W[11])*Xe,H[9]=wt*ie+Ne*ye+tt*Be+Et*rt,H[10]=wt*ue+Ne*be+tt*Ue+Et*ct,H[11]=wt*ce+Ne*we+tt*$e+Et*Ct,H[12]=(wt=W[12])*X+(Ne=W[13])*fe+(tt=W[14])*Ie+(Et=W[15])*Xe,H[13]=wt*ie+Ne*ye+tt*Be+Et*rt,H[14]=wt*ue+Ne*be+tt*Ue+Et*ct,H[15]=wt*ce+Ne*we+tt*$e+Et*Ct,H},Q.P=ve,Q.Q=function(H,h){const W={};for(let X=0;X<h.length;X++){const ie=h[X];ie in H&&(W[ie]=H[ie])}return W},Q.R=qn,Q.S=so,Q.T=Wc,Q.U=Bd,Q.V=Ld,Q.W=We,Q.X=Fe,Q.Y=Dr,Q.Z=kn,Q._=R,Q.a=qe,Q.a$=function(H,h,W){return H[0]=h[0]*W,H[1]=h[1]*W,H[2]=h[2]*W,H[3]=h[3]*W,H},Q.a0=el,Q.a1=Ho,Q.a2=25,Q.a3=yh,Q.a4=H=>{const h=window.document.createElement("video");return h.muted=!0,new Promise(W=>{h.onloadstart=()=>{W(h)};for(const X of H){const ie=window.document.createElement("source");_t(X)||(h.crossOrigin="Anonymous"),ie.src=X,h.appendChild(ie)}})},Q.a5=cr,Q.a6=function(){return Cr++},Q.a7=at,Q.a8=Bs,Q.a9=oa,Q.aA=Zi,Q.aB=Zt,Q.aC=function(H,h,W,X,ie=!1){if(!W[0]&&!W[1])return[0,0];const ue=ie?X==="map"?-H.bearingInRadians:0:X==="viewport"?H.bearingInRadians:0;if(ue){const ce=Math.sin(ue),fe=Math.cos(ue);W=[W[0]*fe-W[1]*ce,W[0]*ce+W[1]*fe]}return[ie?W[0]:Zt(h,W[0],H.zoom),ie?W[1]:Zt(h,W[1],H.zoom)]},Q.aE=ch,Q.aF=vh,Q.aG=lh,Q.aH=bh,Q.aI=Di,Q.aJ=ec,Q.aK=jt,Q.aL=li,Q.aM=gi,Q.aN=Ir,Q.aO=Ee,Q.aP=Nd,Q.aQ=gt,Q.aR=yt,Q.aS=function(H){var h=new Ze(3);return h[0]=H[0],h[1]=H[1],h[2]=H[2],h},Q.aT=function(H,h,W){return H[0]=h[0]-W[0],H[1]=h[1]-W[1],H[2]=h[2]-W[2],H},Q.aU=function(H,h){var W=h[0],X=h[1],ie=h[2],ue=W*W+X*X+ie*ie;return ue>0&&(ue=1/Math.sqrt(ue)),H[0]=h[0]*ue,H[1]=h[1]*ue,H[2]=h[2]*ue,H},Q.aV=qt,Q.aW=function(H,h){return H[0]*h[0]+H[1]*h[1]+H[2]*h[2]},Q.aX=function(H,h,W){return H[0]=h[0]*W[0],H[1]=h[1]*W[1],H[2]=h[2]*W[2],H[3]=h[3]*W[3],H},Q.aY=lt,Q.aZ=function(H,h,W){const X=h[0]*W[0]+h[1]*W[1]+h[2]*W[2];return X===0?null:(-(H[0]*W[0]+H[1]*W[1]+H[2]*W[2])-W[3])/X},Q.a_=Gt,Q.aa=Vo,Q.ab=Vd,Q.ac=function(H){const h={};if(H.replace(/(?:^|(?:\s*\,\s*))([^\x00-\x20\(\)<>@\,;\:\\"\/\[\]\?\=\{\}\x7F]+)(?:\=(?:([^\x00-\x20\(\)<>@\,;\:\\"\/\[\]\?\=\{\}\x7F]+)|(?:\"((?:[^"\\]|\\.)*)\")))?/g,(W,X,ie,ue)=>{const ce=ie||ue;return h[X]=!ce||ce.toLowerCase(),""}),h["max-age"]){const W=parseInt(h["max-age"],10);isNaN(W)?delete h["max-age"]:h["max-age"]=W}return h},Q.ad=Ge,Q.ae=function(H){return Math.pow(2,H)},Q.af=Qe,Q.ag=or,Q.ah=85.051129,Q.ai=jd,Q.aj=function(H){return Math.log(H)/Math.LN2},Q.ak=function(H){var h=H[0],W=H[1];return h*h+W*W},Q.al=function(H,h){const W=[];for(const X in H)X in h||W.push(X);return W},Q.am=function(H,h){let W=0,X=0;if(H.kind==="constant")X=H.layoutSize;else if(H.kind!=="source"){const{interpolationType:ie,minZoom:ue,maxZoom:ce}=H,fe=ie?or(dn.interpolationFactor(ie,h,ue,ce),0,1):0;H.kind==="camera"?X=En.number(H.minSize,H.maxSize,fe):W=fe}return{uSizeT:W,uSize:X}},Q.ao=function(H,{uSize:h,uSizeT:W},{lowerSize:X,upperSize:ie}){return H.kind==="source"?X/Aa:H.kind==="composite"?En.number(X/Aa,ie/Aa,W):h},Q.ap=function(H,h){var W=h[0],X=h[1],ie=h[2],ue=h[3],ce=h[4],fe=h[5],ye=h[6],be=h[7],we=h[8],Ie=h[9],Be=h[10],Ue=h[11],$e=h[12],Xe=h[13],rt=h[14],ct=h[15],Ct=W*fe-X*ce,wt=W*ye-ie*ce,Ne=W*be-ue*ce,tt=X*ye-ie*fe,Et=X*be-ue*fe,Ut=ie*be-ue*ye,Jt=we*Xe-Ie*$e,Wt=we*rt-Be*$e,Kt=we*ct-Ue*$e,ur=Ie*rt-Be*Xe,tr=Ie*ct-Ue*Xe,dr=Be*ct-Ue*rt,Xt=Ct*dr-wt*tr+Ne*ur+tt*Kt-Et*Wt+Ut*Jt;return Xt?(H[0]=(fe*dr-ye*tr+be*ur)*(Xt=1/Xt),H[1]=(ie*tr-X*dr-ue*ur)*Xt,H[2]=(Xe*Ut-rt*Et+ct*tt)*Xt,H[3]=(Be*Et-Ie*Ut-Ue*tt)*Xt,H[4]=(ye*Kt-ce*dr-be*Wt)*Xt,H[5]=(W*dr-ie*Kt+ue*Wt)*Xt,H[6]=(rt*Ne-$e*Ut-ct*wt)*Xt,H[7]=(we*Ut-Be*Ne+Ue*wt)*Xt,H[8]=(ce*tr-fe*Kt+be*Jt)*Xt,H[9]=(X*Kt-W*tr-ue*Jt)*Xt,H[10]=($e*Et-Xe*Ne+ct*Ct)*Xt,H[11]=(Ie*Ne-we*Et-Ue*Ct)*Xt,H[12]=(fe*Wt-ce*ur-ye*Jt)*Xt,H[13]=(W*ur-X*Wt+ie*Jt)*Xt,H[14]=(Xe*wt-$e*tt-rt*Ct)*Xt,H[15]=(we*tt-Ie*wt+Be*Ct)*Xt,H):null},Q.aq=At,Q.ar=function(H){return Math.hypot(H[0],H[1])},Q.as=function(H){return H[0]=0,H[1]=0,H},Q.at=function(H,h,W){return H[0]=h[0]*W,H[1]=h[1]*W,H},Q.au=hh,Q.av=ft,Q.aw=function(H,h,W,X){const ie=h.y-H.y,ue=h.x-H.x,ce=X.y-W.y,fe=X.x-W.x,ye=ce*ue-fe*ie;if(ye===0)return null;const be=(fe*(H.y-W.y)-ce*(H.x-W.x))/ye;return new ve(H.x+be*ue,H.y+be*ie)},Q.ax=Hd,Q.ay=Oh,Q.az=function(H){let h=1/0,W=1/0,X=-1/0,ie=-1/0;for(const ue of H)h=Math.min(h,ue.x),W=Math.min(W,ue.y),X=Math.max(X,ue.x),ie=Math.max(ie,ue.y);return[h,W,X,ie]},Q.b=rr,Q.b$=cp,Q.b0=function(H,h){return H[0]*h[0]+H[1]*h[1]+H[2]*h[2]+H[3]},Q.b1=Ud,Q.b2=js,Q.b3=function(H,h,W,X,ie){var ue,ce=1/Math.tan(h/2);return H[0]=ce/W,H[1]=0,H[2]=0,H[3]=0,H[4]=0,H[5]=ce,H[6]=0,H[7]=0,H[8]=0,H[9]=0,H[11]=-1,H[12]=0,H[13]=0,H[15]=0,ie!=null&&ie!==1/0?(H[10]=(ie+X)*(ue=1/(X-ie)),H[14]=2*ie*X*ue):(H[10]=-1,H[14]=-2*X),H},Q.b4=function(H){var h=new Ze(16);return h[0]=H[0],h[1]=H[1],h[2]=H[2],h[3]=H[3],h[4]=H[4],h[5]=H[5],h[6]=H[6],h[7]=H[7],h[8]=H[8],h[9]=H[9],h[10]=H[10],h[11]=H[11],h[12]=H[12],h[13]=H[13],h[14]=H[14],h[15]=H[15],h},Q.b5=function(H,h,W){var X=Math.sin(W),ie=Math.cos(W),ue=h[0],ce=h[1],fe=h[2],ye=h[3],be=h[4],we=h[5],Ie=h[6],Be=h[7];return h!==H&&(H[8]=h[8],H[9]=h[9],H[10]=h[10],H[11]=h[11],H[12]=h[12],H[13]=h[13],H[14]=h[14],H[15]=h[15]),H[0]=ue*ie+be*X,H[1]=ce*ie+we*X,H[2]=fe*ie+Ie*X,H[3]=ye*ie+Be*X,H[4]=be*ie-ue*X,H[5]=we*ie-ce*X,H[6]=Ie*ie-fe*X,H[7]=Be*ie-ye*X,H},Q.b6=function(H,h,W){var X=Math.sin(W),ie=Math.cos(W),ue=h[4],ce=h[5],fe=h[6],ye=h[7],be=h[8],we=h[9],Ie=h[10],Be=h[11];return h!==H&&(H[0]=h[0],H[1]=h[1],H[2]=h[2],H[3]=h[3],H[12]=h[12],H[13]=h[13],H[14]=h[14],H[15]=h[15]),H[4]=ue*ie+be*X,H[5]=ce*ie+we*X,H[6]=fe*ie+Ie*X,H[7]=ye*ie+Be*X,H[8]=be*ie-ue*X,H[9]=we*ie-ce*X,H[10]=Ie*ie-fe*X,H[11]=Be*ie-ye*X,H},Q.b7=function(){const H=new Float32Array(16);return Qe(H),H},Q.b8=function(){const H=new Float64Array(16);return Qe(H),H},Q.b9=function(){return new Float64Array(16)},Q.bA=function(H){return H[0]=0,H[1]=0,H[2]=0,H},Q.bB=function(H,h,W,X){const ie=Math.sqrt(H*H+h*h),ue=Math.sqrt(W*W+X*X);H/=ie,h/=ie,W/=ue,X/=ue;const ce=Math.acos(H*W+h*X);return-h*W+H*X>0?ce:-ce},Q.bC=function(H,h){const W=nr(H,2*Math.PI),X=nr(h,2*Math.PI);return Math.min(Math.abs(W-X),Math.abs(W-X+2*Math.PI),Math.abs(W-X-2*Math.PI))},Q.bD=function(){const H={},h=St.$version;for(const W in St.$root){const X=St.$root[W];if(X.required){let ie=null;ie=W==="version"?h:X.type==="array"?[]:{},ie!=null&&(H[W]=ie)}}return H},Q.bE=Iu,Q.bF=Ke,Q.bG=function H(h,W){if(Array.isArray(h)){if(!Array.isArray(W)||h.length!==W.length)return!1;for(let X=0;X<h.length;X++)if(!H(h[X],W[X]))return!1;return!0}if(typeof h=="object"&&h!==null&&W!==null){if(typeof W!="object"||Object.keys(h).length!==Object.keys(W).length)return!1;for(const X in h)if(!H(h[X],W[X]))return!1;return!0}return h===W},Q.bH=function(H){H=H.slice();const h=Object.create(null);for(let W=0;W<H.length;W++)h[H[W].id]=H[W];for(let W=0;W<H.length;W++)"ref"in H[W]&&(H[W]=qr(H[W],h[H[W].ref]));return H},Q.bI=function(H){if(H.type==="custom")return new Cp(H);switch(H.type){case"background":return new Ap(H);case"circle":return new Sf(H);case"color-relief":return new Af(H);case"fill":return new Vf(H);case"fill-extrusion":return new Jf(H);case"heatmap":return new qf(H);case"hillshade":return new If(H);case"line":return new op(H);case"raster":return new Op(H);case"symbol":return new oc(H)}},Q.bJ=Kr,Q.bK=function(H,h){if(!H)return[{command:"setStyle",args:[h]}];let W=[];try{if(!fr(H.version,h.version))return[{command:"setStyle",args:[h]}];fr(H.center,h.center)||W.push({command:"setCenter",args:[h.center]}),fr(H.state,h.state)||W.push({command:"setGlobalState",args:[h.state]}),fr(H.centerAltitude,h.centerAltitude)||W.push({command:"setCenterAltitude",args:[h.centerAltitude]}),fr(H.zoom,h.zoom)||W.push({command:"setZoom",args:[h.zoom]}),fr(H.bearing,h.bearing)||W.push({command:"setBearing",args:[h.bearing]}),fr(H.pitch,h.pitch)||W.push({command:"setPitch",args:[h.pitch]}),fr(H.roll,h.roll)||W.push({command:"setRoll",args:[h.roll]}),fr(H.sprite,h.sprite)||W.push({command:"setSprite",args:[h.sprite]}),fr(H.glyphs,h.glyphs)||W.push({command:"setGlyphs",args:[h.glyphs]}),fr(H.transition,h.transition)||W.push({command:"setTransition",args:[h.transition]}),fr(H.light,h.light)||W.push({command:"setLight",args:[h.light]}),fr(H.terrain,h.terrain)||W.push({command:"setTerrain",args:[h.terrain]}),fr(H.sky,h.sky)||W.push({command:"setSky",args:[h.sky]}),fr(H.projection,h.projection)||W.push({command:"setProjection",args:[h.projection]});const X={},ie=[];(function(ce,fe,ye,be){let we;for(we in fe=fe||{},ce=ce||{})Object.prototype.hasOwnProperty.call(ce,we)&&(Object.prototype.hasOwnProperty.call(fe,we)||ci(we,ye,be));for(we in fe)Object.prototype.hasOwnProperty.call(fe,we)&&(Object.prototype.hasOwnProperty.call(ce,we)?fr(ce[we],fe[we])||(ce[we].type==="geojson"&&fe[we].type==="geojson"&&Yr(ce,fe,we)?Fr(ye,{command:"setGeoJSONSourceData",args:[we,fe[we].data]}):Jr(we,fe,ye,be)):Gr(we,fe,ye))})(H.sources,h.sources,ie,X);const ue=[];H.layers&&H.layers.forEach(ce=>{"source"in ce&&X[ce.source]?W.push({command:"removeLayer",args:[ce.id]}):ue.push(ce)}),W=W.concat(ie),function(ce,fe,ye){fe=fe||[];const be=(ce=ce||[]).map(Zr),we=fe.map(Zr),Ie=ce.reduce(fi,{}),Be=fe.reduce(fi,{}),Ue=be.slice(),$e=Object.create(null);let Xe,rt,ct,Ct,wt;for(let Ne=0,tt=0;Ne<be.length;Ne++)Xe=be[Ne],Object.prototype.hasOwnProperty.call(Be,Xe)?tt++:(Fr(ye,{command:"removeLayer",args:[Xe]}),Ue.splice(Ue.indexOf(Xe,tt),1));for(let Ne=0,tt=0;Ne<we.length;Ne++)Xe=we[we.length-1-Ne],Ue[Ue.length-1-Ne]!==Xe&&(Object.prototype.hasOwnProperty.call(Ie,Xe)?(Fr(ye,{command:"removeLayer",args:[Xe]}),Ue.splice(Ue.lastIndexOf(Xe,Ue.length-tt),1)):tt++,Ct=Ue[Ue.length-Ne],Fr(ye,{command:"addLayer",args:[Be[Xe],Ct]}),Ue.splice(Ue.length-Ne,0,Xe),$e[Xe]=!0);for(let Ne=0;Ne<we.length;Ne++)if(Xe=we[Ne],rt=Ie[Xe],ct=Be[Xe],!$e[Xe]&&!fr(rt,ct))if(fr(rt.source,ct.source)&&fr(rt["source-layer"],ct["source-layer"])&&fr(rt.type,ct.type)){for(wt in jr(rt.layout,ct.layout,ye,Xe,null,"setLayoutProperty"),jr(rt.paint,ct.paint,ye,Xe,null,"setPaintProperty"),fr(rt.filter,ct.filter)||Fr(ye,{command:"setFilter",args:[Xe,ct.filter]}),fr(rt.minzoom,ct.minzoom)&&fr(rt.maxzoom,ct.maxzoom)||Fr(ye,{command:"setLayerZoomRange",args:[Xe,ct.minzoom,ct.maxzoom]}),rt)Object.prototype.hasOwnProperty.call(rt,wt)&&wt!=="layout"&&wt!=="paint"&&wt!=="filter"&&wt!=="metadata"&&wt!=="minzoom"&&wt!=="maxzoom"&&(wt.indexOf("paint.")===0?jr(rt[wt],ct[wt],ye,Xe,wt.slice(6),"setPaintProperty"):fr(rt[wt],ct[wt])||Fr(ye,{command:"setLayerProperty",args:[Xe,wt,ct[wt]]}));for(wt in ct)Object.prototype.hasOwnProperty.call(ct,wt)&&!Object.prototype.hasOwnProperty.call(rt,wt)&&wt!=="layout"&&wt!=="paint"&&wt!=="filter"&&wt!=="metadata"&&wt!=="minzoom"&&wt!=="maxzoom"&&(wt.indexOf("paint.")===0?jr(rt[wt],ct[wt],ye,Xe,wt.slice(6),"setPaintProperty"):fr(rt[wt],ct[wt])||Fr(ye,{command:"setLayerProperty",args:[Xe,wt,ct[wt]]}))}else Fr(ye,{command:"removeLayer",args:[Xe]}),Ct=Ue[Ue.lastIndexOf(Xe)+1],Fr(ye,{command:"addLayer",args:[ct,Ct]})}(ue,h.layers,W)}catch(X){console.warn("Unable to compute style diff:",X),W=[{command:"setStyle",args:[h]}]}return W},Q.bL=function(H){const h=[],W=H.id;return W===void 0&&h.push({message:`layers.${W}: missing required property "id"`}),H.render===void 0&&h.push({message:`layers.${W}: missing required method "render"`}),H.renderingMode&&H.renderingMode!=="2d"&&H.renderingMode!=="3d"&&h.push({message:`layers.${W}: property "renderingMode" must be either "2d" or "3d"`}),h},Q.bM=wr,Q.bN=Wr,Q.bO=class extends xi{constructor(H,h){super(H,h),this.current=0}set(H){this.current!==H&&(this.current=H,this.gl.uniform1i(this.location,H))}},Q.bP=Kl,Q.bQ=class extends xi{constructor(H,h){super(H,h),this.current=jc}set(H){if(H[12]!==this.current[12]||H[0]!==this.current[0])return this.current=H,void this.gl.uniformMatrix4fv(this.location,!1,H);for(let h=1;h<16;h++)if(H[h]!==this.current[h]){this.current=H,this.gl.uniformMatrix4fv(this.location,!1,H);break}}},Q.bR=zi,Q.bS=class extends xi{constructor(H,h){super(H,h),this.current=[0,0,0]}set(H){H[0]===this.current[0]&&H[1]===this.current[1]&&H[2]===this.current[2]||(this.current=H,this.gl.uniform3f(this.location,H[0],H[1],H[2]))}},Q.bT=class extends xi{constructor(H,h){super(H,h),this.current=[0,0]}set(H){H[0]===this.current[0]&&H[1]===this.current[1]||(this.current=H,this.gl.uniform2f(this.location,H[0],H[1]))}},Q.bU=Je,Q.bV=function(H,h){var W=Math.sin(h),X=Math.cos(h);return H[0]=X,H[1]=W,H[2]=0,H[3]=-W,H[4]=X,H[5]=0,H[6]=0,H[7]=0,H[8]=1,H},Q.bW=function(H,h,W){var X=h[0],ie=h[1],ue=h[2];return H[0]=X*W[0]+ie*W[3]+ue*W[6],H[1]=X*W[1]+ie*W[4]+ue*W[7],H[2]=X*W[2]+ie*W[5]+ue*W[8],H},Q.bX=function(H,h,W,X,ie,ue,ce){var fe=1/(h-W),ye=1/(X-ie),be=1/(ue-ce);return H[0]=-2*fe,H[1]=0,H[2]=0,H[3]=0,H[4]=0,H[5]=-2*ye,H[6]=0,H[7]=0,H[8]=0,H[9]=0,H[10]=2*be,H[11]=0,H[12]=(h+W)*fe,H[13]=(ie+X)*ye,H[14]=(ce+ue)*be,H[15]=1,H},Q.bY=class extends xi{constructor(H,h){super(H,h),this.current=new Array}set(H){if(H!=this.current){this.current=H;const h=new Float32Array(4*H.length);for(let W=0;W<H.length;W++)h[4*W]=H[W].r,h[4*W+1]=H[W].g,h[4*W+2]=H[W].b,h[4*W+3]=H[W].a;this.gl.uniform4fv(this.location,h)}}},Q.bZ=class extends xi{constructor(H,h){super(H,h),this.current=new Array}set(H){if(H!=this.current){this.current=H;const h=new Float32Array(H);this.gl.uniform1fv(this.location,h)}}},Q.b_=class extends J{},Q.ba=function(H,h,W){const X=new Float64Array(4);return pt(X,H,h-90,W),X},Q.bb=function(H,h,W,X){var ie,ue,ce,fe,ye,be=h[0],we=h[1],Ie=h[2],Be=h[3],Ue=W[0],$e=W[1],Xe=W[2],rt=W[3];return(ue=be*Ue+we*$e+Ie*Xe+Be*rt)<0&&(ue=-ue,Ue=-Ue,$e=-$e,Xe=-Xe,rt=-rt),1-ue>ke?(ie=Math.acos(ue),ce=Math.sin(ie),fe=Math.sin((1-X)*ie)/ce,ye=Math.sin(X*ie)/ce):(fe=1-X,ye=X),H[0]=fe*be+ye*Ue,H[1]=fe*we+ye*$e,H[2]=fe*Ie+ye*Xe,H[3]=fe*Be+ye*rt,H},Q.bc=function(H){const h=new Float64Array(9);var W,X,ie,ue,ce,fe,ye,be,we,Ie,Be,Ue,$e,Xe,rt,ct,Ct,wt;Ie=(ie=(X=H)[0])*(ye=ie+ie),Be=(ue=X[1])*ye,$e=(ce=X[2])*ye,Xe=ce*(be=ue+ue),ct=(fe=X[3])*ye,Ct=fe*be,wt=fe*(we=ce+ce),(W=h)[0]=1-(Ue=ue*be)-(rt=ce*we),W[3]=Be-wt,W[6]=$e+Ct,W[1]=Be+wt,W[4]=1-Ie-rt,W[7]=Xe-ct,W[2]=$e-Ct,W[5]=Xe+ct,W[8]=1-Ie-Ue;const Ne=Ee(-Math.asin(or(h[2],-1,1)));let tt,Et;return Math.hypot(h[5],h[8])<.001?(tt=0,Et=-Ee(Math.atan2(h[3],h[4]))):(tt=Ee(h[5]===0&&h[8]===0?0:Math.atan2(h[5],h[8])),Et=Ee(h[1]===0&&h[0]===0?0:Math.atan2(h[1],h[0]))),{roll:tt,pitch:Ne+90,bearing:Et}},Q.bd=function(H,h){return H.roll==h.roll&&H.pitch==h.pitch&&H.bearing==h.bearing},Q.be=ni,Q.bf=_n,Q.bg=ks,Q.bh=Hu,Q.bi=Fs,Q.bj=Er,Q.bk=vr,Q.bl=Xr,Q.bm=function(H,h,W,X,ie){return Er(X,ie,or((H-h)/(W-h),0,1))},Q.bn=nr,Q.bo=function(){return new Float64Array(3)},Q.bp=function(H,h,W,X){return H[0]=h[0]+W[0]*X,H[1]=h[1]+W[1]*X,H[2]=h[2]+W[2]*X,H},Q.bq=pt,Q.br=function(H,h,W){var X=W[0],ie=W[1],ue=W[2],ce=h[0],fe=h[1],ye=h[2],be=ie*ye-ue*fe,we=ue*ce-X*ye,Ie=X*fe-ie*ce,Be=ie*Ie-ue*we,Ue=ue*be-X*Ie,$e=X*we-ie*be,Xe=2*W[3];return we*=Xe,Ie*=Xe,Ue*=2,$e*=2,H[0]=ce+(be*=Xe)+(Be*=2),H[1]=fe+we+Ue,H[2]=ye+Ie+$e,H},Q.bs=function(H,h,W){const X=(ie=[H[0],H[1],H[2],h[0],h[1],h[2],W[0],W[1],W[2]])[0]*((we=ie[8])*(ce=ie[4])-(fe=ie[5])*(be=ie[7]))+ie[1]*(-we*(ue=ie[3])+fe*(ye=ie[6]))+ie[2]*(be*ue-ce*ye);var ie,ue,ce,fe,ye,be,we;if(X===0)return null;const Ie=qt([],[h[0],h[1],h[2]],[W[0],W[1],W[2]]),Be=qt([],[W[0],W[1],W[2]],[H[0],H[1],H[2]]),Ue=qt([],[H[0],H[1],H[2]],[h[0],h[1],h[2]]),$e=gt([],Ie,-H[3]);return yt($e,$e,gt([],Be,-h[3])),yt($e,$e,gt([],Ue,-W[3])),gt($e,$e,1/X),$e},Q.bt=_h,Q.bu=function(){return new Float64Array(4)},Q.bv=function(H,h,W,X){var ie=[],ue=[];return ie[0]=h[0]-W[0],ie[1]=h[1]-W[1],ie[2]=h[2]-W[2],ue[0]=ie[0]*Math.cos(X)-ie[1]*Math.sin(X),ue[1]=ie[0]*Math.sin(X)+ie[1]*Math.cos(X),ue[2]=ie[2],H[0]=ue[0]+W[0],H[1]=ue[1]+W[1],H[2]=ue[2]+W[2],H},Q.bw=function(H,h,W,X){var ie=[],ue=[];return ie[0]=h[0]-W[0],ie[1]=h[1]-W[1],ie[2]=h[2]-W[2],ue[0]=ie[0],ue[1]=ie[1]*Math.cos(X)-ie[2]*Math.sin(X),ue[2]=ie[1]*Math.sin(X)+ie[2]*Math.cos(X),H[0]=ue[0]+W[0],H[1]=ue[1]+W[1],H[2]=ue[2]+W[2],H},Q.bx=function(H,h,W,X){var ie=[],ue=[];return ie[0]=h[0]-W[0],ie[1]=h[1]-W[1],ie[2]=h[2]-W[2],ue[0]=ie[2]*Math.sin(X)+ie[0]*Math.cos(X),ue[1]=ie[1],ue[2]=ie[2]*Math.cos(X)-ie[0]*Math.sin(X),H[0]=ue[0]+W[0],H[1]=ue[1]+W[1],H[2]=ue[2]+W[2],H},Q.by=function(H,h,W){var X=Math.sin(W),ie=Math.cos(W),ue=h[0],ce=h[1],fe=h[2],ye=h[3],be=h[8],we=h[9],Ie=h[10],Be=h[11];return h!==H&&(H[4]=h[4],H[5]=h[5],H[6]=h[6],H[7]=h[7],H[12]=h[12],H[13]=h[13],H[14]=h[14],H[15]=h[15]),H[0]=ue*ie-be*X,H[1]=ce*ie-we*X,H[2]=fe*ie-Ie*X,H[3]=ye*ie-Be*X,H[8]=ue*X+be*ie,H[9]=ce*X+we*ie,H[10]=fe*X+Ie*ie,H[11]=ye*X+Be*ie,H},Q.bz=function(H,h){const W=nr(H,360),X=nr(h,360),ie=X-W,ue=X>W?ie-360:ie+360;return Math.abs(ie)<Math.abs(ue)?ie:ue},Q.c=Ve,Q.c0=class extends se{},Q.c1=$c,Q.c2=function(H){return H<=1?1:Math.pow(2,Math.ceil(Math.log(H)/Math.LN2))},Q.c3=zh,Q.c4=function(H,h,W){var X=h[0],ie=h[1],ue=h[2],ce=W[3]*X+W[7]*ie+W[11]*ue+W[15];return H[0]=(W[0]*X+W[4]*ie+W[8]*ue+W[12])/(ce=ce||1),H[1]=(W[1]*X+W[5]*ie+W[9]*ue+W[13])/ce,H[2]=(W[2]*X+W[6]*ie+W[10]*ue+W[14])/ce,H},Q.c5=class extends Du{},Q.c6=class extends Ae{},Q.c7=function(H,h){return H[0]===h[0]&&H[1]===h[1]&&H[2]===h[2]&&H[3]===h[3]&&H[4]===h[4]&&H[5]===h[5]&&H[6]===h[6]&&H[7]===h[7]&&H[8]===h[8]&&H[9]===h[9]&&H[10]===h[10]&&H[11]===h[11]&&H[12]===h[12]&&H[13]===h[13]&&H[14]===h[14]&&H[15]===h[15]},Q.c8=function(H,h){var W=H[0],X=H[1],ie=H[2],ue=H[3],ce=H[4],fe=H[5],ye=H[6],be=H[7],we=H[8],Ie=H[9],Be=H[10],Ue=H[11],$e=H[12],Xe=H[13],rt=H[14],ct=H[15],Ct=h[0],wt=h[1],Ne=h[2],tt=h[3],Et=h[4],Ut=h[5],Jt=h[6],Wt=h[7],Kt=h[8],ur=h[9],tr=h[10],dr=h[11],Xt=h[12],Pr=h[13],Ur=h[14],Nr=h[15];return Math.abs(W-Ct)<=ke*Math.max(1,Math.abs(W),Math.abs(Ct))&&Math.abs(X-wt)<=ke*Math.max(1,Math.abs(X),Math.abs(wt))&&Math.abs(ie-Ne)<=ke*Math.max(1,Math.abs(ie),Math.abs(Ne))&&Math.abs(ue-tt)<=ke*Math.max(1,Math.abs(ue),Math.abs(tt))&&Math.abs(ce-Et)<=ke*Math.max(1,Math.abs(ce),Math.abs(Et))&&Math.abs(fe-Ut)<=ke*Math.max(1,Math.abs(fe),Math.abs(Ut))&&Math.abs(ye-Jt)<=ke*Math.max(1,Math.abs(ye),Math.abs(Jt))&&Math.abs(be-Wt)<=ke*Math.max(1,Math.abs(be),Math.abs(Wt))&&Math.abs(we-Kt)<=ke*Math.max(1,Math.abs(we),Math.abs(Kt))&&Math.abs(Ie-ur)<=ke*Math.max(1,Math.abs(Ie),Math.abs(ur))&&Math.abs(Be-tr)<=ke*Math.max(1,Math.abs(Be),Math.abs(tr))&&Math.abs(Ue-dr)<=ke*Math.max(1,Math.abs(Ue),Math.abs(dr))&&Math.abs($e-Xt)<=ke*Math.max(1,Math.abs($e),Math.abs(Xt))&&Math.abs(Xe-Pr)<=ke*Math.max(1,Math.abs(Xe),Math.abs(Pr))&&Math.abs(rt-Ur)<=ke*Math.max(1,Math.abs(rt),Math.abs(Ur))&&Math.abs(ct-Nr)<=ke*Math.max(1,Math.abs(ct),Math.abs(Nr))},Q.c9=function(H,h){return H[0]=h[0],H[1]=h[1],H[2]=h[2],H[3]=h[3],H[4]=h[4],H[5]=h[5],H[6]=h[6],H[7]=h[7],H[8]=h[8],H[9]=h[9],H[10]=h[10],H[11]=h[11],H[12]=h[12],H[13]=h[13],H[14]=h[14],H[15]=h[15],H},Q.cA=function(H){delete qe.REGISTERED_PROTOCOLS[H]},Q.cB=function(H,h){const W={};for(let ie=0;ie<H.length;ie++){const ue=h&&h[H[ie].id]||bs(H[ie]);h&&(h[H[ie].id]=ue);let ce=W[ue];ce||(ce=W[ue]=[]),ce.push(H[ie])}const X=[];for(const ie in W)X.push(W[ie]);return X},Q.cC=Tr,Q.cD=Gd,Q.cE=$d,Q.cF=xd,Q.cG=function(H){H.bucket.createArrays(),H.bucket.tilePixelRatio=Dt/(512*H.bucket.overscaling),H.bucket.compareText={},H.bucket.iconsNeedLinear=!1;const h=H.bucket.layers[0],W=h.layout,X=h._unevaluatedLayout._values,ie={layoutIconSize:X["icon-size"].possiblyEvaluate(new Si(H.bucket.zoom+1),H.canonical),layoutTextSize:X["text-size"].possiblyEvaluate(new Si(H.bucket.zoom+1),H.canonical),textMaxSize:X["text-size"].possiblyEvaluate(new Si(18))};if(H.bucket.textSizeData.kind==="composite"){const{minZoom:be,maxZoom:we}=H.bucket.textSizeData;ie.compositeTextSizes=[X["text-size"].possiblyEvaluate(new Si(be),H.canonical),X["text-size"].possiblyEvaluate(new Si(we),H.canonical)]}if(H.bucket.iconSizeData.kind==="composite"){const{minZoom:be,maxZoom:we}=H.bucket.iconSizeData;ie.compositeIconSizes=[X["icon-size"].possiblyEvaluate(new Si(be),H.canonical),X["icon-size"].possiblyEvaluate(new Si(we),H.canonical)]}const ue=W.get("text-line-height")*Zi,ce=W.get("text-rotation-alignment")!=="viewport"&&W.get("symbol-placement")!=="point",fe=W.get("text-keep-upright"),ye=W.get("text-size");for(const be of H.bucket.features){const we=W.get("text-font").evaluate(be,{},H.canonical).join(","),Ie=ye.evaluate(be,{},H.canonical),Be=ie.layoutTextSize.evaluate(be,{},H.canonical),Ue=ie.layoutIconSize.evaluate(be,{},H.canonical),$e={horizontal:{},vertical:void 0},Xe=be.text;let rt,ct=[0,0];if(Xe){const Ne=Xe.toString(),tt=W.get("text-letter-spacing").evaluate(be,{},H.canonical)*Zi,Et=Ul(Ne)?tt:0,Ut=W.get("text-anchor").evaluate(be,{},H.canonical),Jt=rf(h,be,H.canonical);if(!Jt){const tr=W.get("text-radial-offset").evaluate(be,{},H.canonical);ct=tr?tf(Ut,[tr*Zi,gh]):W.get("text-offset").evaluate(be,{},H.canonical).map(dr=>dr*Zi)}let Wt=ce?"center":W.get("text-justify").evaluate(be,{},H.canonical);const Kt=W.get("symbol-placement")==="point"?W.get("text-max-width").evaluate(be,{},H.canonical)*Zi:1/0,ur=()=>{H.bucket.allowVerticalPlacement&&Ru(Ne)&&($e.vertical=ic(Xe,H.glyphMap,H.glyphPositions,H.imagePositions,we,Kt,ue,Ut,"left",Et,ct,Q.an.vertical,!0,Be,Ie))};if(!ce&&Jt){const tr=new Set;if(Wt==="auto")for(let Xt=0;Xt<Jt.values.length;Xt+=2)tr.add(vh(Jt.values[Xt]));else tr.add(Wt);let dr=!1;for(const Xt of tr)if(!$e.horizontal[Xt])if(dr)$e.horizontal[Xt]=$e.horizontal[0];else{const Pr=ic(Xe,H.glyphMap,H.glyphPositions,H.imagePositions,we,Kt,ue,"center",Xt,Et,ct,Q.an.horizontal,!1,Be,Ie);Pr&&($e.horizontal[Xt]=Pr,dr=Pr.positionedLines.length===1)}ur()}else{Wt==="auto"&&(Wt=vh(Ut));const tr=ic(Xe,H.glyphMap,H.glyphPositions,H.imagePositions,we,Kt,ue,Ut,Wt,Et,ct,Q.an.horizontal,!1,Be,Ie);tr&&($e.horizontal[Wt]=tr),ur(),Ru(Ne)&&ce&&fe&&($e.vertical=ic(Xe,H.glyphMap,H.glyphPositions,H.imagePositions,we,Kt,ue,Ut,Wt,Et,ct,Q.an.vertical,!1,Be,Ie))}}let Ct=!1;if(be.icon&&be.icon.name){const Ne=H.imageMap[be.icon.name];Ne&&(rt=Ep(H.imagePositions[be.icon.name],W.get("icon-offset").evaluate(be,{},H.canonical),W.get("icon-anchor").evaluate(be,{},H.canonical)),Ct=!!Ne.sdf,H.bucket.sdfIcons===void 0?H.bucket.sdfIcons=Ct:H.bucket.sdfIcons!==Ct&&br("Style sheet warning: Cannot mix SDF and non-SDF icons in one buffer"),(Ne.pixelRatio!==H.bucket.pixelRatio||W.get("icon-rotate").constantOr(1)!==0)&&(H.bucket.iconsNeedLinear=!0))}const wt=af($e.horizontal)||$e.vertical;H.bucket.iconsInText=!!wt&&wt.iconsInText,(wt||rt)&&zp(H.bucket,be,$e,rt,H.imageMap,ie,Be,Ue,ct,Ct,H.canonical,H.subdivisionGranularity)}H.showCollisionBoxes&&H.bucket.generateCollisionDebugBuffers()},Q.cH=ih,Q.cI=Xc,Q.cJ=rh,Q.cK=Ku,Q.cL=oh,Q.cM=class{constructor(H){this._marks={start:[H.url,"start"].join("#"),end:[H.url,"end"].join("#"),measure:H.url.toString()},performance.mark(this._marks.start)}finish(){performance.mark(this._marks.end);let H=performance.getEntriesByName(this._marks.measure);return H.length===0&&(performance.measure(this._marks.measure,this._marks.start,this._marks.end),H=performance.getEntriesByName(this._marks.measure),performance.clearMarks(this._marks.start),performance.clearMarks(this._marks.end),performance.clearMeasures(this._marks.measure)),H}},Q.cN=function(H,h,W,X,ie){return R(this,void 0,void 0,function*(){if(Fe())try{return yield Dr(H,h,W,X,ie)}catch{}return function(ue,ce,fe,ye,be){const we=ue.width,Ie=ue.height;lr&&yr||(lr=new OffscreenCanvas(we,Ie),yr=lr.getContext("2d",{willReadFrequently:!0})),lr.width=we,lr.height=Ie,yr.drawImage(ue,0,0,we,Ie);const Be=yr.getImageData(ce,fe,ye,be);return yr.clearRect(0,0,we,Ie),Be.data}(H,h,W,X,ie)})},Q.cO=Vh,Q.cP=U,Q.cQ=he,Q.cR=sd,Q.cS=vd,Q.cT=_s,Q.cU=ua,Q.ca=H=>H.type==="symbol",Q.cb=H=>H.type==="circle",Q.cc=H=>H.type==="heatmap",Q.cd=H=>H.type==="line",Q.ce=H=>H.type==="fill",Q.cf=H=>H.type==="fill-extrusion",Q.cg=H=>H.type==="hillshade",Q.ch=H=>H.type==="color-relief",Q.ci=H=>H.type==="raster",Q.cj=H=>H.type==="background",Q.ck=H=>H.type==="custom",Q.cl=Sr,Q.cm=function(H,h,W){const X=It(h.x-W.x,h.y-W.y),ie=It(H.x-W.x,H.y-W.y);var ue,ce;return Ee(Math.atan2(X[0]*ie[1]-X[1]*ie[0],(ue=X)[0]*(ce=ie)[0]+ue[1]*ce[1]))},Q.cn=Qt,Q.co=function(H,h){return He[h]&&(H instanceof MouseEvent||H instanceof WheelEvent)},Q.cp=function(H,h){return Pe[h]&&"touches"in H},Q.cq=function(H){return Pe[H]||He[H]},Q.cr=function(H,h,W){var X=h[0],ie=h[1];return H[0]=W[0]*X+W[4]*ie+W[12],H[1]=W[1]*X+W[5]*ie+W[13],H},Q.cs=function(H,h){const{x:W,y:X}=el.fromLngLat(h);return!(H<0||H>25||X<0||X>=1||W<0||W>=1)},Q.ct=function(H,h){return H[0]=h[0],H[1]=0,H[2]=0,H[3]=0,H[4]=0,H[5]=h[1],H[6]=0,H[7]=0,H[8]=0,H[9]=0,H[10]=h[2],H[11]=0,H[12]=0,H[13]=0,H[14]=0,H[15]=1,H},Q.cu=class extends ca{},Q.cv=Gp,Q.cx=function(H){return H.message===ut},Q.cy=Le,Q.cz=function(H,h){qe.REGISTERED_PROTOCOLS[H]=h},Q.d=_t,Q.e=Rr,Q.f=H=>R(void 0,void 0,void 0,function*(){if(H.byteLength===0)return createImageBitmap(new ImageData(1,1));const h=new Blob([new Uint8Array(H)],{type:"image/png"});try{return createImageBitmap(h)}catch(W){throw new Error(`Could not load image because of ${W.message}. Please make sure to use a supported image type such as PNG or JPEG. Note that SVGs are not supported.`)}}),Q.g=De,Q.h=H=>new Promise((h,W)=>{const X=new Image;X.onload=()=>{h(X),URL.revokeObjectURL(X.src),X.onload=null,window.requestAnimationFrame(()=>{X.src=sr})},X.onerror=()=>W(new Error("Could not load image. Please make sure to use a supported image type such as PNG or JPEG. Note that SVGs are not supported."));const ie=new Blob([new Uint8Array(H)],{type:"image/png"});X.src=H.byteLength?URL.createObjectURL(ie):sr}),Q.i=Br,Q.j=(H,h)=>et(Rr(H,{type:"json"}),h),Q.k=Ot,Q.l=Mt,Q.m=et,Q.n=(H,h)=>et(Rr(H,{type:"arrayBuffer"}),h),Q.o=function(H){return new oh(H).readFields(fp,[])},Q.p=bd,Q.q=Uu,Q.r=pn,Q.s=xr,Q.t=Cu,Q.u=oi,Q.v=St,Q.w=br,Q.x=Mc,Q.y=Co,Q.z=eo}),re("worker",["./shared"],function(Q){class R{constructor(qe){this.keyCache={},qe&&this.replace(qe)}replace(qe){this._layerConfigs={},this._layers={},this.update(qe,[])}update(qe,De){for(const Le of qe){this._layerConfigs[Le.id]=Le;const Ke=this._layers[Le.id]=Q.bI(Le);Ke._featureFilter=Q.a9(Ke.filter),this.keyCache[Le.id]&&delete this.keyCache[Le.id]}for(const Le of De)delete this.keyCache[Le],delete this._layerConfigs[Le],delete this._layers[Le];this.familiesBySource={};const ze=Q.cB(Object.values(this._layerConfigs),this.keyCache);for(const Le of ze){const Ke=Le.map(Ot=>this._layers[Ot.id]),et=Ke[0];if(et.visibility==="none")continue;const _t=et.source||"";let st=this.familiesBySource[_t];st||(st=this.familiesBySource[_t]={});const bt=et.sourceLayer||"_geojsonTileLayer";let Mt=st[bt];Mt||(Mt=st[bt]=[]),Mt.push(Ke)}}}class U{constructor(qe){const De={},ze=[];for(const _t in qe){const st=qe[_t],bt=De[_t]={};for(const Mt in st){const Ot=st[+Mt];if(!Ot||Ot.bitmap.width===0||Ot.bitmap.height===0)continue;const Nt={x:0,y:0,w:Ot.bitmap.width+2,h:Ot.bitmap.height+2};ze.push(Nt),bt[Mt]={rect:Nt,metrics:Ot.metrics}}}const{w:Le,h:Ke}=Q.p(ze),et=new Q.q({width:Le||1,height:Ke||1});for(const _t in qe){const st=qe[_t];for(const bt in st){const Mt=st[+bt];if(!Mt||Mt.bitmap.width===0||Mt.bitmap.height===0)continue;const Ot=De[_t][bt].rect;Q.q.copy(Mt.bitmap,et,{x:0,y:0},{x:Ot.x+1,y:Ot.y+1},Mt.bitmap)}}this.image=et,this.positions=De}}Q.cC("GlyphAtlas",U);class Z{constructor(qe){this.tileID=new Q.Z(qe.tileID.overscaledZ,qe.tileID.wrap,qe.tileID.canonical.z,qe.tileID.canonical.x,qe.tileID.canonical.y),this.uid=qe.uid,this.zoom=qe.zoom,this.pixelRatio=qe.pixelRatio,this.tileSize=qe.tileSize,this.source=qe.source,this.overscaling=this.tileID.overscaleFactor(),this.showCollisionBoxes=qe.showCollisionBoxes,this.collectResourceTiming=!!qe.collectResourceTiming,this.returnDependencies=!!qe.returnDependencies,this.promoteId=qe.promoteId,this.inFlightDependencies=[],this.globalState=qe.globalState}parse(qe,De,ze,Le,Ke){return Q._(this,void 0,void 0,function*(){this.status="parsing",this.data=qe,this.collisionBoxArray=new Q.a7;const et=new Q.cD(Object.keys(qe.layers).sort()),_t=new Q.cE(this.tileID,this.promoteId);_t.bucketLayerIDs=[];const st={},bt={featureIndex:_t,iconDependencies:{},patternDependencies:{},glyphDependencies:{},availableImages:ze,subdivisionGranularity:Ke},Mt=De.familiesBySource[this.source];for(const jr in Mt){const Zr=qe.layers[jr];if(!Zr)continue;Zr.version===1&&Q.w(`Vector tile source "${this.source}" layer "${jr}" does not use vector tile spec v2 and therefore may have some rendering errors.`);const fi=et.encode(jr),cr=[];for(let bi=0;bi<Zr.length;bi++){const Qr=Zr.feature(bi),Ei=_t.getId(Qr,jr);cr.push({feature:Qr,id:Ei,index:bi,sourceLayerIndex:fi})}for(const bi of Mt[jr]){const Qr=bi[0];Qr.source!==this.source&&Q.w(`layer.source = ${Qr.source} does not equal this.source = ${this.source}`),Qr.minzoom&&this.zoom<Math.floor(Qr.minzoom)||Qr.maxzoom&&this.zoom>=Qr.maxzoom||Qr.visibility!=="none"&&(ae(bi,this.zoom,ze),(st[Qr.id]=Qr.createBucket({index:_t.bucketLayerIDs.length,layers:bi,zoom:this.zoom,pixelRatio:this.pixelRatio,overscaling:this.overscaling,collisionBoxArray:this.collisionBoxArray,sourceLayerIndex:fi,sourceID:this.source,globalState:this.globalState})).populate(cr,bt,this.tileID.canonical),_t.bucketLayerIDs.push(bi.map(Ei=>Ei.id)))}}const Ot=Q.bM(bt.glyphDependencies,jr=>Object.keys(jr).map(Number));this.inFlightDependencies.forEach(jr=>jr==null?void 0:jr.abort()),this.inFlightDependencies=[];let Nt=Promise.resolve({});if(Object.keys(Ot).length){const jr=new AbortController;this.inFlightDependencies.push(jr),Nt=Le.sendAsync({type:"GG",data:{stacks:Ot,source:this.source,tileID:this.tileID,type:"glyphs"}},jr)}const St=Object.keys(bt.iconDependencies);let ar=Promise.resolve({});if(St.length){const jr=new AbortController;this.inFlightDependencies.push(jr),ar=Le.sendAsync({type:"GI",data:{icons:St,source:this.source,tileID:this.tileID,type:"icons"}},jr)}const qr=Object.keys(bt.patternDependencies);let fr=Promise.resolve({});if(qr.length){const jr=new AbortController;this.inFlightDependencies.push(jr),fr=Le.sendAsync({type:"GI",data:{icons:qr,source:this.source,tileID:this.tileID,type:"patterns"}},jr)}const[Fr,Gr,ci]=yield Promise.all([Nt,ar,fr]),Jr=new U(Fr),Yr=new Q.cF(Gr,ci);for(const jr in st){const Zr=st[jr];Zr instanceof Q.a8?(ae(Zr.layers,this.zoom,ze),Q.cG({bucket:Zr,glyphMap:Fr,glyphPositions:Jr.positions,imageMap:Gr,imagePositions:Yr.iconPositions,showCollisionBoxes:this.showCollisionBoxes,canonical:this.tileID.canonical,subdivisionGranularity:bt.subdivisionGranularity})):Zr.hasPattern&&(Zr instanceof Q.cH||Zr instanceof Q.cI||Zr instanceof Q.cJ)&&(ae(Zr.layers,this.zoom,ze),Zr.addFeatures(bt,this.tileID.canonical,Yr.patternPositions))}return this.status="done",{buckets:Object.values(st).filter(jr=>!jr.isEmpty()),featureIndex:_t,collisionBoxArray:this.collisionBoxArray,glyphAtlasImage:Jr.image,imageAtlas:Yr,glyphMap:this.returnDependencies?Fr:null,iconMap:this.returnDependencies?Gr:null,glyphPositions:this.returnDependencies?Jr.positions:null}})}}function ae(Ve,qe,De){const ze=new Q.F(qe);for(const Le of Ve)Le.recalculate(ze,De)}class he{constructor(qe,De,ze){this.actor=qe,this.layerIndex=De,this.availableImages=ze,this.fetching={},this.loading={},this.loaded={}}loadVectorTile(qe,De){return Q._(this,void 0,void 0,function*(){const ze=yield Q.n(qe.request,De);try{return{vectorTile:new Q.cK.VectorTile(new Q.cL(ze.data)),rawData:ze.data,cacheControl:ze.cacheControl,expires:ze.expires}}catch(Le){const Ke=new Uint8Array(ze.data);let et=`Unable to parse the tile at ${qe.request.url}, `;throw et+=Ke[0]===31&&Ke[1]===139?"please make sure the data is not gzipped and that you have configured the relevant header in the server":`got error: ${Le.message}`,new Error(et)}})}loadTile(qe){return Q._(this,void 0,void 0,function*(){const De=qe.uid,ze=!!(qe&&qe.request&&qe.request.collectResourceTiming)&&new Q.cM(qe.request),Le=new Z(qe);this.loading[De]=Le;const Ke=new AbortController;Le.abort=Ke;try{const et=yield this.loadVectorTile(qe,Ke);if(delete this.loading[De],!et)return null;const _t=et.rawData,st={};et.expires&&(st.expires=et.expires),et.cacheControl&&(st.cacheControl=et.cacheControl);const bt={};if(ze){const Ot=ze.finish();Ot&&(bt.resourceTiming=JSON.parse(JSON.stringify(Ot)))}Le.vectorTile=et.vectorTile;const Mt=Le.parse(et.vectorTile,this.layerIndex,this.availableImages,this.actor,qe.subdivisionGranularity);this.loaded[De]=Le,this.fetching[De]={rawTileData:_t,cacheControl:st,resourceTiming:bt};try{const Ot=yield Mt;return Q.e({rawTileData:_t.slice(0)},Ot,st,bt)}finally{delete this.fetching[De]}}catch(et){throw delete this.loading[De],Le.status="done",this.loaded[De]=Le,et}})}reloadTile(qe){return Q._(this,void 0,void 0,function*(){const De=qe.uid;if(!this.loaded||!this.loaded[De])throw new Error("Should not be trying to reload a tile that was never loaded or has been removed");const ze=this.loaded[De];if(ze.showCollisionBoxes=qe.showCollisionBoxes,ze.globalState=qe.globalState,ze.status==="parsing"){const Le=yield ze.parse(ze.vectorTile,this.layerIndex,this.availableImages,this.actor,qe.subdivisionGranularity);let Ke;if(this.fetching[De]){const{rawTileData:et,cacheControl:_t,resourceTiming:st}=this.fetching[De];delete this.fetching[De],Ke=Q.e({rawTileData:et.slice(0)},Le,_t,st)}else Ke=Le;return Ke}if(ze.status==="done"&&ze.vectorTile)return ze.parse(ze.vectorTile,this.layerIndex,this.availableImages,this.actor,qe.subdivisionGranularity)})}abortTile(qe){return Q._(this,void 0,void 0,function*(){const De=this.loading,ze=qe.uid;De&&De[ze]&&De[ze].abort&&(De[ze].abort.abort(),delete De[ze])})}removeTile(qe){return Q._(this,void 0,void 0,function*(){this.loaded&&this.loaded[qe.uid]&&delete this.loaded[qe.uid]})}}class pe{constructor(){this.loaded={}}loadTile(qe){return Q._(this,void 0,void 0,function*(){const{uid:De,encoding:ze,rawImageData:Le,redFactor:Ke,greenFactor:et,blueFactor:_t,baseShift:st}=qe,bt=Le.width+2,Mt=Le.height+2,Ot=Q.b(Le)?new Q.R({width:bt,height:Mt},yield Q.cN(Le,-1,-1,bt,Mt)):Le,Nt=new Q.cO(De,Ot,ze,Ke,et,_t,st);return this.loaded=this.loaded||{},this.loaded[De]=Nt,Nt})}removeTile(qe){const De=this.loaded,ze=qe.uid;De&&De[ze]&&delete De[ze]}}var me,ve,Re=function(){if(ve)return me;function Ve(De,ze){if(De.length!==0){qe(De[0],ze);for(var Le=1;Le<De.length;Le++)qe(De[Le],!ze)}}function qe(De,ze){for(var Le=0,Ke=0,et=0,_t=De.length,st=_t-1;et<_t;st=et++){var bt=(De[et][0]-De[st][0])*(De[st][1]+De[et][1]),Mt=Le+bt;Ke+=Math.abs(Le)>=Math.abs(bt)?Le-Mt+bt:bt-Mt+Le,Le=Mt}Le+Ke>=0!=!!ze&&De.reverse()}return ve=1,me=function De(ze,Le){var Ke,et=ze&&ze.type;if(et==="FeatureCollection")for(Ke=0;Ke<ze.features.length;Ke++)De(ze.features[Ke],Le);else if(et==="GeometryCollection")for(Ke=0;Ke<ze.geometries.length;Ke++)De(ze.geometries[Ke],Le);else if(et==="Feature")De(ze.geometry,Le);else if(et==="Polygon")Ve(ze.coordinates,Le);else if(et==="MultiPolygon")for(Ke=0;Ke<ze.coordinates.length;Ke++)Ve(ze.coordinates[Ke],Le);return ze}}(),Me=Q.cP(Re);const Te=Q.cK.VectorTileFeature.prototype.toGeoJSON;class Ce{constructor(qe){this._feature=qe,this.extent=Q.$,this.type=qe.type,this.properties=qe.tags,"id"in qe&&!isNaN(qe.id)&&(this.id=parseInt(qe.id,10))}loadGeometry(){if(this._feature.type===1){const qe=[];for(const De of this._feature.geometry)qe.push([new Q.P(De[0],De[1])]);return qe}{const qe=[];for(const De of this._feature.geometry){const ze=[];for(const Le of De)ze.push(new Q.P(Le[0],Le[1]));qe.push(ze)}return qe}}toGeoJSON(qe,De,ze){return Te.call(this,qe,De,ze)}}class We{constructor(qe){this.layers={_geojsonTileLayer:this},this.name="_geojsonTileLayer",this.extent=Q.$,this.length=qe.length,this._features=qe}feature(qe){return new Ce(this._features[qe])}}var Fe,ke,Ze,Je={exports:{}},Qe=function(){if(Ze)return Je.exports;Ze=1;var Ve=Q.cS(),qe=function(){if(ke)return Fe;ke=1;var Mt=Q.cQ(),Ot=Q.cR().VectorTileFeature;function Nt(ar,qr){this.options=qr||{},this.features=ar,this.length=ar.length}function St(ar,qr){this.id=typeof ar.id=="number"?ar.id:void 0,this.type=ar.type,this.rawGeometry=ar.type===1?[ar.geometry]:ar.geometry,this.properties=ar.tags,this.extent=qr||4096}return Fe=Nt,Nt.prototype.feature=function(ar){return new St(this.features[ar],this.options.extent)},St.prototype.loadGeometry=function(){var ar=this.rawGeometry;this.geometry=[];for(var qr=0;qr<ar.length;qr++){for(var fr=ar[qr],Fr=[],Gr=0;Gr<fr.length;Gr++)Fr.push(new Mt(fr[Gr][0],fr[Gr][1]));this.geometry.push(Fr)}return this.geometry},St.prototype.bbox=function(){this.geometry||this.loadGeometry();for(var ar=this.geometry,qr=1/0,fr=-1/0,Fr=1/0,Gr=-1/0,ci=0;ci<ar.length;ci++)for(var Jr=ar[ci],Yr=0;Yr<Jr.length;Yr++){var jr=Jr[Yr];qr=Math.min(qr,jr.x),fr=Math.max(fr,jr.x),Fr=Math.min(Fr,jr.y),Gr=Math.max(Gr,jr.y)}return[qr,Fr,fr,Gr]},St.prototype.toGeoJSON=Ot.prototype.toGeoJSON,Fe}();function De(Mt){var Ot=new Ve;return function(Nt,St){for(var ar in Nt.layers)St.writeMessage(3,ze,Nt.layers[ar])}(Mt,Ot),Ot.finish()}function ze(Mt,Ot){var Nt;Ot.writeVarintField(15,Mt.version||1),Ot.writeStringField(1,Mt.name||""),Ot.writeVarintField(5,Mt.extent||4096);var St={keys:[],values:[],keycache:{},valuecache:{}};for(Nt=0;Nt<Mt.length;Nt++)St.feature=Mt.feature(Nt),Ot.writeMessage(2,Le,St);var ar=St.keys;for(Nt=0;Nt<ar.length;Nt++)Ot.writeStringField(3,ar[Nt]);var qr=St.values;for(Nt=0;Nt<qr.length;Nt++)Ot.writeMessage(4,bt,qr[Nt])}function Le(Mt,Ot){var Nt=Mt.feature;Nt.id!==void 0&&Ot.writeVarintField(1,Nt.id),Ot.writeMessage(2,Ke,Mt),Ot.writeVarintField(3,Nt.type),Ot.writeMessage(4,st,Nt)}function Ke(Mt,Ot){var Nt=Mt.feature,St=Mt.keys,ar=Mt.values,qr=Mt.keycache,fr=Mt.valuecache;for(var Fr in Nt.properties){var Gr=Nt.properties[Fr],ci=qr[Fr];if(Gr!==null){ci===void 0&&(St.push(Fr),qr[Fr]=ci=St.length-1),Ot.writeVarint(ci);var Jr=typeof Gr;Jr!=="string"&&Jr!=="boolean"&&Jr!=="number"&&(Gr=JSON.stringify(Gr));var Yr=Jr+":"+Gr,jr=fr[Yr];jr===void 0&&(ar.push(Gr),fr[Yr]=jr=ar.length-1),Ot.writeVarint(jr)}}}function et(Mt,Ot){return(Ot<<3)+(7&Mt)}function _t(Mt){return Mt<<1^Mt>>31}function st(Mt,Ot){for(var Nt=Mt.loadGeometry(),St=Mt.type,ar=0,qr=0,fr=Nt.length,Fr=0;Fr<fr;Fr++){var Gr=Nt[Fr],ci=1;St===1&&(ci=Gr.length),Ot.writeVarint(et(1,ci));for(var Jr=St===3?Gr.length-1:Gr.length,Yr=0;Yr<Jr;Yr++){Yr===1&&St!==1&&Ot.writeVarint(et(2,Jr-1));var jr=Gr[Yr].x-ar,Zr=Gr[Yr].y-qr;Ot.writeVarint(_t(jr)),Ot.writeVarint(_t(Zr)),ar+=jr,qr+=Zr}St===3&&Ot.writeVarint(et(7,1))}}function bt(Mt,Ot){var Nt=typeof Mt;Nt==="string"?Ot.writeStringField(1,Mt):Nt==="boolean"?Ot.writeBooleanField(7,Mt):Nt==="number"&&(Mt%1!=0?Ot.writeDoubleField(3,Mt):Mt<0?Ot.writeSVarintField(6,Mt):Ot.writeVarintField(5,Mt))}return Je.exports=De,Je.exports.fromVectorTileJs=De,Je.exports.fromGeojsonVt=function(Mt,Ot){Ot=Ot||{};var Nt={};for(var St in Mt)Nt[St]=new qe(Mt[St].features,Ot),Nt[St].name=St,Nt[St].version=Ot.version,Nt[St].extent=Ot.extent;return De({layers:Nt})},Je.exports.GeoJSONWrapper=qe,Je.exports}(),it=Q.cP(Qe);const lt={minZoom:0,maxZoom:16,minPoints:2,radius:40,extent:512,nodeSize:64,log:!1,generateId:!1,reduce:null,map:Ve=>Ve},dt=Math.fround||(yt=new Float32Array(1),Ve=>(yt[0]=+Ve,yt[0]));var yt;class gt{constructor(qe){this.options=Object.assign(Object.create(lt),qe),this.trees=new Array(this.options.maxZoom+1),this.stride=this.options.reduce?7:6,this.clusterProps=[]}load(qe){const{log:De,minZoom:ze,maxZoom:Le}=this.options;De&&console.time("total time");const Ke=`prepare ${qe.length} points`;De&&console.time(Ke),this.points=qe;const et=[];for(let st=0;st<qe.length;st++){const bt=qe[st];if(!bt.geometry)continue;const[Mt,Ot]=bt.geometry.coordinates,Nt=dt(Gt(Mt)),St=dt(ft(Ot));et.push(Nt,St,1/0,st,-1,1),this.options.reduce&&et.push(0)}let _t=this.trees[Le+1]=this._createTree(et);De&&console.timeEnd(Ke);for(let st=Le;st>=ze;st--){const bt=+Date.now();_t=this.trees[st]=this._createTree(this._cluster(_t,st)),De&&console.log("z%d: %d clusters in %dms",st,_t.numItems,+Date.now()-bt)}return De&&console.timeEnd("total time"),this}getClusters(qe,De){let ze=((qe[0]+180)%360+360)%360-180;const Le=Math.max(-90,Math.min(90,qe[1]));let Ke=qe[2]===180?180:((qe[2]+180)%360+360)%360-180;const et=Math.max(-90,Math.min(90,qe[3]));if(qe[2]-qe[0]>=360)ze=-180,Ke=180;else if(ze>Ke){const Ot=this.getClusters([ze,Le,180,et],De),Nt=this.getClusters([-180,Le,Ke,et],De);return Ot.concat(Nt)}const _t=this.trees[this._limitZoom(De)],st=_t.range(Gt(ze),ft(et),Gt(Ke),ft(Le)),bt=_t.data,Mt=[];for(const Ot of st){const Nt=this.stride*Ot;Mt.push(bt[Nt+5]>1?qt(bt,Nt,this.clusterProps):this.points[bt[Nt+3]])}return Mt}getChildren(qe){const De=this._getOriginId(qe),ze=this._getOriginZoom(qe),Le="No cluster with the specified id.",Ke=this.trees[ze];if(!Ke)throw new Error(Le);const et=Ke.data;if(De*this.stride>=et.length)throw new Error(Le);const _t=this.options.radius/(this.options.extent*Math.pow(2,ze-1)),st=Ke.within(et[De*this.stride],et[De*this.stride+1],_t),bt=[];for(const Mt of st){const Ot=Mt*this.stride;et[Ot+4]===qe&&bt.push(et[Ot+5]>1?qt(et,Ot,this.clusterProps):this.points[et[Ot+3]])}if(bt.length===0)throw new Error(Le);return bt}getLeaves(qe,De,ze){const Le=[];return this._appendLeaves(Le,qe,De=De||10,ze=ze||0,0),Le}getTile(qe,De,ze){const Le=this.trees[this._limitZoom(qe)],Ke=Math.pow(2,qe),{extent:et,radius:_t}=this.options,st=_t/et,bt=(ze-st)/Ke,Mt=(ze+1+st)/Ke,Ot={features:[]};return this._addTileFeatures(Le.range((De-st)/Ke,bt,(De+1+st)/Ke,Mt),Le.data,De,ze,Ke,Ot),De===0&&this._addTileFeatures(Le.range(1-st/Ke,bt,1,Mt),Le.data,Ke,ze,Ke,Ot),De===Ke-1&&this._addTileFeatures(Le.range(0,bt,st/Ke,Mt),Le.data,-1,ze,Ke,Ot),Ot.features.length?Ot:null}getClusterExpansionZoom(qe){let De=this._getOriginZoom(qe)-1;for(;De<=this.options.maxZoom;){const ze=this.getChildren(qe);if(De++,ze.length!==1)break;qe=ze[0].properties.cluster_id}return De}_appendLeaves(qe,De,ze,Le,Ke){const et=this.getChildren(De);for(const _t of et){const st=_t.properties;if(st&&st.cluster?Ke+st.point_count<=Le?Ke+=st.point_count:Ke=this._appendLeaves(qe,st.cluster_id,ze,Le,Ke):Ke<Le?Ke++:qe.push(_t),qe.length===ze)break}return Ke}_createTree(qe){const De=new Q.aH(qe.length/this.stride|0,this.options.nodeSize,Float32Array);for(let ze=0;ze<qe.length;ze+=this.stride)De.add(qe[ze],qe[ze+1]);return De.finish(),De.data=qe,De}_addTileFeatures(qe,De,ze,Le,Ke,et){for(const _t of qe){const st=_t*this.stride,bt=De[st+5]>1;let Mt,Ot,Nt;if(bt)Mt=Ft(De,st,this.clusterProps),Ot=De[st],Nt=De[st+1];else{const qr=this.points[De[st+3]];Mt=qr.properties;const[fr,Fr]=qr.geometry.coordinates;Ot=Gt(fr),Nt=ft(Fr)}const St={type:1,geometry:[[Math.round(this.options.extent*(Ot*Ke-ze)),Math.round(this.options.extent*(Nt*Ke-Le))]],tags:Mt};let ar;ar=bt||this.options.generateId?De[st+3]:this.points[De[st+3]].id,ar!==void 0&&(St.id=ar),et.features.push(St)}}_limitZoom(qe){return Math.max(this.options.minZoom,Math.min(Math.floor(+qe),this.options.maxZoom+1))}_cluster(qe,De){const{radius:ze,extent:Le,reduce:Ke,minPoints:et}=this.options,_t=ze/(Le*Math.pow(2,De)),st=qe.data,bt=[],Mt=this.stride;for(let Ot=0;Ot<st.length;Ot+=Mt){if(st[Ot+2]<=De)continue;st[Ot+2]=De;const Nt=st[Ot],St=st[Ot+1],ar=qe.within(st[Ot],st[Ot+1],_t),qr=st[Ot+5];let fr=qr;for(const Fr of ar){const Gr=Fr*Mt;st[Gr+2]>De&&(fr+=st[Gr+5])}if(fr>qr&&fr>=et){let Fr,Gr=Nt*qr,ci=St*qr,Jr=-1;const Yr=(Ot/Mt<<5)+(De+1)+this.points.length;for(const jr of ar){const Zr=jr*Mt;if(st[Zr+2]<=De)continue;st[Zr+2]=De;const fi=st[Zr+5];Gr+=st[Zr]*fi,ci+=st[Zr+1]*fi,st[Zr+4]=Yr,Ke&&(Fr||(Fr=this._map(st,Ot,!0),Jr=this.clusterProps.length,this.clusterProps.push(Fr)),Ke(Fr,this._map(st,Zr)))}st[Ot+4]=Yr,bt.push(Gr/fr,ci/fr,1/0,Yr,-1,fr),Ke&&bt.push(Jr)}else{for(let Fr=0;Fr<Mt;Fr++)bt.push(st[Ot+Fr]);if(fr>1)for(const Fr of ar){const Gr=Fr*Mt;if(!(st[Gr+2]<=De)){st[Gr+2]=De;for(let ci=0;ci<Mt;ci++)bt.push(st[Gr+ci])}}}}return bt}_getOriginId(qe){return qe-this.points.length>>5}_getOriginZoom(qe){return(qe-this.points.length)%32}_map(qe,De,ze){if(qe[De+5]>1){const et=this.clusterProps[qe[De+6]];return ze?Object.assign({},et):et}const Le=this.points[qe[De+3]].properties,Ke=this.options.map(Le);return ze&&Ke===Le?Object.assign({},Ke):Ke}}function qt(Ve,qe,De){return{type:"Feature",id:Ve[qe+3],properties:Ft(Ve,qe,De),geometry:{type:"Point",coordinates:[(ze=Ve[qe],360*(ze-.5)),Rt(Ve[qe+1])]}};var ze}function Ft(Ve,qe,De){const ze=Ve[qe+5],Le=ze>=1e4?`${Math.round(ze/1e3)}k`:ze>=1e3?Math.round(ze/100)/10+"k":ze,Ke=Ve[qe+6],et=Ke===-1?{}:Object.assign({},De[Ke]);return Object.assign(et,{cluster:!0,cluster_id:Ve[qe+3],point_count:ze,point_count_abbreviated:Le})}function Gt(Ve){return Ve/360+.5}function ft(Ve){const qe=Math.sin(Ve*Math.PI/180),De=.5-.25*Math.log((1+qe)/(1-qe))/Math.PI;return De<0?0:De>1?1:De}function Rt(Ve){const qe=(180-360*Ve)*Math.PI/180;return 360*Math.atan(Math.exp(qe))/Math.PI-90}function pt(Ve,qe,De,ze){let Le=ze;const Ke=qe+(De-qe>>1);let et,_t=De-qe;const st=Ve[qe],bt=Ve[qe+1],Mt=Ve[De],Ot=Ve[De+1];for(let Nt=qe+3;Nt<De;Nt+=3){const St=At(Ve[Nt],Ve[Nt+1],st,bt,Mt,Ot);if(St>Le)et=Nt,Le=St;else if(St===Le){const ar=Math.abs(Nt-Ke);ar<_t&&(et=Nt,_t=ar)}}Le>ze&&(et-qe>3&&pt(Ve,qe,et,ze),Ve[et+2]=Le,De-et>3&&pt(Ve,et,De,ze))}function At(Ve,qe,De,ze,Le,Ke){let et=Le-De,_t=Ke-ze;if(et!==0||_t!==0){const st=((Ve-De)*et+(qe-ze)*_t)/(et*et+_t*_t);st>1?(De=Le,ze=Ke):st>0&&(De+=et*st,ze+=_t*st)}return et=Ve-De,_t=qe-ze,et*et+_t*_t}function It(Ve,qe,De,ze){const Le={id:Ve??null,type:qe,geometry:De,tags:ze,minX:1/0,minY:1/0,maxX:-1/0,maxY:-1/0};if(qe==="Point"||qe==="MultiPoint"||qe==="LineString")Dt(Le,De);else if(qe==="Polygon")Dt(Le,De[0]);else if(qe==="MultiLineString")for(const Ke of De)Dt(Le,Ke);else if(qe==="MultiPolygon")for(const Ke of De)Dt(Le,Ke[0]);return Le}function Dt(Ve,qe){for(let De=0;De<qe.length;De+=3)Ve.minX=Math.min(Ve.minX,qe[De]),Ve.minY=Math.min(Ve.minY,qe[De+1]),Ve.maxX=Math.max(Ve.maxX,qe[De]),Ve.maxY=Math.max(Ve.maxY,qe[De+1])}function Zt(Ve,qe,De,ze){if(!qe.geometry)return;const Le=qe.geometry.coordinates;if(Le&&Le.length===0)return;const Ke=qe.geometry.type,et=Math.pow(De.tolerance/((1<<De.maxZoom)*De.extent),2);let _t=[],st=qe.id;if(De.promoteId?st=qe.properties[De.promoteId]:De.generateId&&(st=ze||0),Ke==="Point")nr(Le,_t);else if(Ke==="MultiPoint")for(const bt of Le)nr(bt,_t);else if(Ke==="LineString")Er(Le,_t,et,!1);else if(Ke==="MultiLineString"){if(De.lineMetrics){for(const bt of Le)_t=[],Er(bt,_t,et,!1),Ve.push(It(st,"LineString",_t,qe.properties));return}vr(Le,_t,et,!1)}else if(Ke==="Polygon")vr(Le,_t,et,!0);else{if(Ke!=="MultiPolygon"){if(Ke==="GeometryCollection"){for(const bt of qe.geometry.geometries)Zt(Ve,{id:st,geometry:bt,properties:qe.properties},De,ze);return}throw new Error("Input data is not a valid GeoJSON object.")}for(const bt of Le){const Mt=[];vr(bt,Mt,et,!0),_t.push(Mt)}}Ve.push(It(st,Ke,_t,qe.properties))}function nr(Ve,qe){qe.push(Sr(Ve[0]),Qt(Ve[1]),0)}function Er(Ve,qe,De,ze){let Le,Ke,et=0;for(let st=0;st<Ve.length;st++){const bt=Sr(Ve[st][0]),Mt=Qt(Ve[st][1]);qe.push(bt,Mt,0),st>0&&(et+=ze?(Le*Mt-bt*Ke)/2:Math.sqrt(Math.pow(bt-Le,2)+Math.pow(Mt-Ke,2))),Le=bt,Ke=Mt}const _t=qe.length-3;qe[2]=1,pt(qe,0,_t,De),qe[_t+2]=1,qe.size=Math.abs(et),qe.start=0,qe.end=qe.size}function vr(Ve,qe,De,ze){for(let Le=0;Le<Ve.length;Le++){const Ke=[];Er(Ve[Le],Ke,De,ze),qe.push(Ke)}}function Sr(Ve){return Ve/360+.5}function Qt(Ve){const qe=Math.sin(Ve*Math.PI/180),De=.5-.25*Math.log((1+qe)/(1-qe))/Math.PI;return De<0?0:De>1?1:De}function or(Ve,qe,De,ze,Le,Ke,et,_t){if(ze/=qe,Ke>=(De/=qe)&&et<ze)return Ve;if(et<De||Ke>=ze)return null;const st=[];for(const bt of Ve){const Mt=bt.geometry;let Ot=bt.type;const Nt=Le===0?bt.minX:bt.minY,St=Le===0?bt.maxX:bt.maxY;if(Nt>=De&&St<ze){st.push(bt);continue}if(St<De||Nt>=ze)continue;let ar=[];if(Ot==="Point"||Ot==="MultiPoint")Ir(Mt,ar,De,ze,Le);else if(Ot==="LineString")Rr(Mt,ar,De,ze,Le,!1,_t.lineMetrics);else if(Ot==="MultiLineString")wr(Mt,ar,De,ze,Le,!1);else if(Ot==="Polygon")wr(Mt,ar,De,ze,Le,!0);else if(Ot==="MultiPolygon")for(const qr of Mt){const fr=[];wr(qr,fr,De,ze,Le,!0),fr.length&&ar.push(fr)}if(ar.length){if(_t.lineMetrics&&Ot==="LineString"){for(const qr of ar)st.push(It(bt.id,Ot,qr,bt.tags));continue}Ot!=="LineString"&&Ot!=="MultiLineString"||(ar.length===1?(Ot="LineString",ar=ar[0]):Ot="MultiLineString"),Ot!=="Point"&&Ot!=="MultiPoint"||(Ot=ar.length===3?"Point":"MultiPoint"),st.push(It(bt.id,Ot,ar,bt.tags))}}return st.length?st:null}function Ir(Ve,qe,De,ze,Le){for(let Ke=0;Ke<Ve.length;Ke+=3){const et=Ve[Ke+Le];et>=De&&et<=ze&&Wr(qe,Ve[Ke],Ve[Ke+1],Ve[Ke+2])}}function Rr(Ve,qe,De,ze,Le,Ke,et){let _t=Cr(Ve);const st=Le===0?Kr:Hr;let bt,Mt,Ot=Ve.start;for(let fr=0;fr<Ve.length-3;fr+=3){const Fr=Ve[fr],Gr=Ve[fr+1],ci=Ve[fr+2],Jr=Ve[fr+3],Yr=Ve[fr+4],jr=Le===0?Fr:Gr,Zr=Le===0?Jr:Yr;let fi=!1;et&&(bt=Math.sqrt(Math.pow(Fr-Jr,2)+Math.pow(Gr-Yr,2))),jr<De?Zr>De&&(Mt=st(_t,Fr,Gr,Jr,Yr,De),et&&(_t.start=Ot+bt*Mt)):jr>ze?Zr<ze&&(Mt=st(_t,Fr,Gr,Jr,Yr,ze),et&&(_t.start=Ot+bt*Mt)):Wr(_t,Fr,Gr,ci),Zr<De&&jr>=De&&(Mt=st(_t,Fr,Gr,Jr,Yr,De),fi=!0),Zr>ze&&jr<=ze&&(Mt=st(_t,Fr,Gr,Jr,Yr,ze),fi=!0),!Ke&&fi&&(et&&(_t.end=Ot+bt*Mt),qe.push(_t),_t=Cr(Ve)),et&&(Ot+=bt)}let Nt=Ve.length-3;const St=Ve[Nt],ar=Ve[Nt+1],qr=Le===0?St:ar;qr>=De&&qr<=ze&&Wr(_t,St,ar,Ve[Nt+2]),Nt=_t.length-3,Ke&&Nt>=3&&(_t[Nt]!==_t[0]||_t[Nt+1]!==_t[1])&&Wr(_t,_t[0],_t[1],_t[2]),_t.length&&qe.push(_t)}function Cr(Ve){const qe=[];return qe.size=Ve.size,qe.start=Ve.start,qe.end=Ve.end,qe}function wr(Ve,qe,De,ze,Le,Ke){for(const et of Ve)Rr(et,qe,De,ze,Le,Ke,!1)}function Wr(Ve,qe,De,ze){Ve.push(qe,De,ze)}function Kr(Ve,qe,De,ze,Le,Ke){const et=(Ke-qe)/(ze-qe);return Wr(Ve,Ke,De+(Le-De)*et,1),et}function Hr(Ve,qe,De,ze,Le,Ke){const et=(Ke-De)/(Le-De);return Wr(Ve,qe+(ze-qe)*et,Ke,1),et}function br(Ve,qe){const De=[];for(let ze=0;ze<Ve.length;ze++){const Le=Ve[ze],Ke=Le.type;let et;if(Ke==="Point"||Ke==="MultiPoint"||Ke==="LineString")et=Lr(Le.geometry,qe);else if(Ke==="MultiLineString"||Ke==="Polygon"){et=[];for(const _t of Le.geometry)et.push(Lr(_t,qe))}else if(Ke==="MultiPolygon"){et=[];for(const _t of Le.geometry){const st=[];for(const bt of _t)st.push(Lr(bt,qe));et.push(st)}}De.push(It(Le.id,Ke,et,Le.tags))}return De}function Lr(Ve,qe){const De=[];De.size=Ve.size,Ve.start!==void 0&&(De.start=Ve.start,De.end=Ve.end);for(let ze=0;ze<Ve.length;ze+=3)De.push(Ve[ze]+qe,Ve[ze+1],Ve[ze+2]);return De}function Br(Ve,qe){if(Ve.transformed)return Ve;const De=1<<Ve.z,ze=Ve.x,Le=Ve.y;for(const Ke of Ve.features){const et=Ke.geometry,_t=Ke.type;if(Ke.geometry=[],_t===1)for(let st=0;st<et.length;st+=2)Ke.geometry.push(zr(et[st],et[st+1],qe,De,ze,Le));else for(let st=0;st<et.length;st++){const bt=[];for(let Mt=0;Mt<et[st].length;Mt+=2)bt.push(zr(et[st][Mt],et[st][Mt+1],qe,De,ze,Le));Ke.geometry.push(bt)}}return Ve.transformed=!0,Ve}function zr(Ve,qe,De,ze,Le,Ke){return[Math.round(De*(Ve*ze-Le)),Math.round(De*(qe*ze-Ke))]}function rr(Ve,qe,De,ze,Le){const Ke=qe===Le.maxZoom?0:Le.tolerance/((1<<qe)*Le.extent),et={features:[],numPoints:0,numSimplified:0,numFeatures:Ve.length,source:null,x:De,y:ze,z:qe,transformed:!1,minX:2,minY:1,maxX:-1,maxY:0};for(const _t of Ve)sr(et,_t,Ke,Le);return et}function sr(Ve,qe,De,ze){const Le=qe.geometry,Ke=qe.type,et=[];if(Ve.minX=Math.min(Ve.minX,qe.minX),Ve.minY=Math.min(Ve.minY,qe.minY),Ve.maxX=Math.max(Ve.maxX,qe.maxX),Ve.maxY=Math.max(Ve.maxY,qe.maxY),Ke==="Point"||Ke==="MultiPoint")for(let _t=0;_t<Le.length;_t+=3)et.push(Le[_t],Le[_t+1]),Ve.numPoints++,Ve.numSimplified++;else if(Ke==="LineString")Dr(et,Le,Ve,De,!1,!1);else if(Ke==="MultiLineString"||Ke==="Polygon")for(let _t=0;_t<Le.length;_t++)Dr(et,Le[_t],Ve,De,Ke==="Polygon",_t===0);else if(Ke==="MultiPolygon")for(let _t=0;_t<Le.length;_t++){const st=Le[_t];for(let bt=0;bt<st.length;bt++)Dr(et,st[bt],Ve,De,!0,bt===0)}if(et.length){let _t=qe.tags||null;if(Ke==="LineString"&&ze.lineMetrics){_t={};for(const bt in qe.tags)_t[bt]=qe.tags[bt];_t.mapbox_clip_start=Le.start/Le.size,_t.mapbox_clip_end=Le.end/Le.size}const st={geometry:et,type:Ke==="Polygon"||Ke==="MultiPolygon"?3:Ke==="LineString"||Ke==="MultiLineString"?2:1,tags:_t};qe.id!==null&&(st.id=qe.id),Ve.features.push(st)}}function Dr(Ve,qe,De,ze,Le,Ke){const et=ze*ze;if(ze>0&&qe.size<(Le?et:ze))return void(De.numPoints+=qe.length/3);const _t=[];for(let st=0;st<qe.length;st+=3)(ze===0||qe[st+2]>et)&&(De.numSimplified++,_t.push(qe[st],qe[st+1])),De.numPoints++;Le&&function(st,bt){let Mt=0;for(let Ot=0,Nt=st.length,St=Nt-2;Ot<Nt;St=Ot,Ot+=2)Mt+=(st[Ot]-st[St])*(st[Ot+1]+st[St+1]);if(Mt>0===bt)for(let Ot=0,Nt=st.length;Ot<Nt/2;Ot+=2){const St=st[Ot],ar=st[Ot+1];st[Ot]=st[Nt-2-Ot],st[Ot+1]=st[Nt-1-Ot],st[Nt-2-Ot]=St,st[Nt-1-Ot]=ar}}(_t,Ke),Ve.push(_t)}const lr={maxZoom:14,indexMaxZoom:5,indexMaxPoints:1e5,tolerance:3,extent:4096,buffer:64,lineMetrics:!1,promoteId:null,generateId:!1,debug:0};class yr{constructor(qe,De){const ze=(De=this.options=function(Ke,et){for(const _t in et)Ke[_t]=et[_t];return Ke}(Object.create(lr),De)).debug;if(ze&&console.time("preprocess data"),De.maxZoom<0||De.maxZoom>24)throw new Error("maxZoom should be in the 0-24 range");if(De.promoteId&&De.generateId)throw new Error("promoteId and generateId cannot be used together.");let Le=function(Ke,et){const _t=[];if(Ke.type==="FeatureCollection")for(let st=0;st<Ke.features.length;st++)Zt(_t,Ke.features[st],et,st);else Zt(_t,Ke.type==="Feature"?Ke:{geometry:Ke},et);return _t}(qe,De);this.tiles={},this.tileCoords=[],ze&&(console.timeEnd("preprocess data"),console.log("index: maxZoom: %d, maxPoints: %d",De.indexMaxZoom,De.indexMaxPoints),console.time("generate tiles"),this.stats={},this.total=0),Le=function(Ke,et){const _t=et.buffer/et.extent;let st=Ke;const bt=or(Ke,1,-1-_t,_t,0,-1,2,et),Mt=or(Ke,1,1-_t,2+_t,0,-1,2,et);return(bt||Mt)&&(st=or(Ke,1,-_t,1+_t,0,-1,2,et)||[],bt&&(st=br(bt,1).concat(st)),Mt&&(st=st.concat(br(Mt,-1)))),st}(Le,De),Le.length&&this.splitTile(Le,0,0,0),ze&&(Le.length&&console.log("features: %d, points: %d",this.tiles[0].numFeatures,this.tiles[0].numPoints),console.timeEnd("generate tiles"),console.log("tiles generated:",this.total,JSON.stringify(this.stats)))}splitTile(qe,De,ze,Le,Ke,et,_t){const st=[qe,De,ze,Le],bt=this.options,Mt=bt.debug;for(;st.length;){Le=st.pop(),ze=st.pop(),De=st.pop(),qe=st.pop();const Ot=1<<De,Nt=xr(De,ze,Le);let St=this.tiles[Nt];if(!St&&(Mt>1&&console.time("creation"),St=this.tiles[Nt]=rr(qe,De,ze,Le,bt),this.tileCoords.push({z:De,x:ze,y:Le}),Mt)){Mt>1&&(console.log("tile z%d-%d-%d (features: %d, points: %d, simplified: %d)",De,ze,Le,St.numFeatures,St.numPoints,St.numSimplified),console.timeEnd("creation"));const fi=`z${De}`;this.stats[fi]=(this.stats[fi]||0)+1,this.total++}if(St.source=qe,Ke==null){if(De===bt.indexMaxZoom||St.numPoints<=bt.indexMaxPoints)continue}else{if(De===bt.maxZoom||De===Ke)continue;if(Ke!=null){const fi=Ke-De;if(ze!==et>>fi||Le!==_t>>fi)continue}}if(St.source=null,qe.length===0)continue;Mt>1&&console.time("clipping");const ar=.5*bt.buffer/bt.extent,qr=.5-ar,fr=.5+ar,Fr=1+ar;let Gr=null,ci=null,Jr=null,Yr=null,jr=or(qe,Ot,ze-ar,ze+fr,0,St.minX,St.maxX,bt),Zr=or(qe,Ot,ze+qr,ze+Fr,0,St.minX,St.maxX,bt);qe=null,jr&&(Gr=or(jr,Ot,Le-ar,Le+fr,1,St.minY,St.maxY,bt),ci=or(jr,Ot,Le+qr,Le+Fr,1,St.minY,St.maxY,bt),jr=null),Zr&&(Jr=or(Zr,Ot,Le-ar,Le+fr,1,St.minY,St.maxY,bt),Yr=or(Zr,Ot,Le+qr,Le+Fr,1,St.minY,St.maxY,bt),Zr=null),Mt>1&&console.timeEnd("clipping"),st.push(Gr||[],De+1,2*ze,2*Le),st.push(ci||[],De+1,2*ze,2*Le+1),st.push(Jr||[],De+1,2*ze+1,2*Le),st.push(Yr||[],De+1,2*ze+1,2*Le+1)}}getTile(qe,De,ze){qe=+qe,De=+De,ze=+ze;const Le=this.options,{extent:Ke,debug:et}=Le;if(qe<0||qe>24)return null;const _t=1<<qe,st=xr(qe,De=De+_t&_t-1,ze);if(this.tiles[st])return Br(this.tiles[st],Ke);et>1&&console.log("drilling down to z%d-%d-%d",qe,De,ze);let bt,Mt=qe,Ot=De,Nt=ze;for(;!bt&&Mt>0;)Mt--,Ot>>=1,Nt>>=1,bt=this.tiles[xr(Mt,Ot,Nt)];return bt&&bt.source?(et>1&&(console.log("found parent tile z%d-%d-%d",Mt,Ot,Nt),console.time("drilling down")),this.splitTile(bt.source,Mt,Ot,Nt,qe,De,ze),et>1&&console.timeEnd("drilling down"),this.tiles[st]?Br(this.tiles[st],Ke):null):null}}function xr(Ve,qe,De){return 32*((1<<Ve)*De+qe)+Ve}function Ge(Ve,qe){return qe?Ve.properties[qe]:Ve.id}function Ee(Ve,qe){if(Ve==null)return!0;if(Ve.type==="Feature")return Ge(Ve,qe)!=null;if(Ve.type==="FeatureCollection"){const De=new Set;for(const ze of Ve.features){const Le=Ge(ze,qe);if(Le==null||De.has(Le))return!1;De.add(Le)}return!0}return!1}function Pe(Ve,qe){const De=new Map;if(Ve!=null)if(Ve.type==="Feature")De.set(Ge(Ve,qe),Ve);else for(const ze of Ve.features)De.set(Ge(ze,qe),ze);return De}class He extends he{constructor(){super(...arguments),this._dataUpdateable=new Map}loadVectorTile(qe,De){return Q._(this,void 0,void 0,function*(){const ze=qe.tileID.canonical;if(!this._geoJSONIndex)throw new Error("Unable to parse the data into a cluster or geojson");const Le=this._geoJSONIndex.getTile(ze.z,ze.x,ze.y);if(!Le)return null;const Ke=new We(Le.features);let et=it(Ke);return et.byteOffset===0&&et.byteLength===et.buffer.byteLength||(et=new Uint8Array(et)),{vectorTile:Ke,rawData:et.buffer}})}loadData(qe){return Q._(this,void 0,void 0,function*(){var De;(De=this._pendingRequest)===null||De===void 0||De.abort();const ze=!!(qe&&qe.request&&qe.request.collectResourceTiming)&&new Q.cM(qe.request);this._pendingRequest=new AbortController;try{this._pendingData=this.loadAndProcessGeoJSON(qe,this._pendingRequest),this._geoJSONIndex=qe.cluster?new gt(function({superclusterOptions:et,clusterProperties:_t}){if(!_t||!et)return et;const st={},bt={},Mt={accumulated:null,zoom:0},Ot={properties:null},Nt=Object.keys(_t);for(const St of Nt){const[ar,qr]=_t[St],fr=Q.cT(qr),Fr=Q.cT(typeof ar=="string"?[ar,["accumulated"],["get",St]]:ar);st[St]=fr.value,bt[St]=Fr.value}return et.map=St=>{Ot.properties=St;const ar={};for(const qr of Nt)ar[qr]=st[qr].evaluate(Mt,Ot);return ar},et.reduce=(St,ar)=>{Ot.properties=ar;for(const qr of Nt)Mt.accumulated=St[qr],St[qr]=bt[qr].evaluate(Mt,Ot)},et}(qe)).load((yield this._pendingData).features):(Le=yield this._pendingData,new yr(Le,qe.geojsonVtOptions)),this.loaded={};const Ke={};if(ze){const et=ze.finish();et&&(Ke.resourceTiming={},Ke.resourceTiming[qe.source]=JSON.parse(JSON.stringify(et)))}return Ke}catch(Ke){if(delete this._pendingRequest,Q.cx(Ke))return{abandoned:!0};throw Ke}var Le})}getData(){return Q._(this,void 0,void 0,function*(){return this._pendingData})}reloadTile(qe){const De=this.loaded;return De&&De[qe.uid]?super.reloadTile(qe):this.loadTile(qe)}loadAndProcessGeoJSON(qe,De){return Q._(this,void 0,void 0,function*(){let ze=yield this.loadGeoJSON(qe,De);if(delete this._pendingRequest,typeof ze!="object")throw new Error(`Input data given to '${qe.source}' is not a valid GeoJSON object.`);if(Me(ze,!0),qe.filter){const Le=Q.cT(qe.filter,{type:"boolean","property-type":"data-driven",overridable:!1,transition:!1});if(Le.result==="error")throw new Error(Le.value.map(et=>`${et.key}: ${et.message}`).join(", "));ze={type:"FeatureCollection",features:ze.features.filter(et=>Le.value.evaluate({zoom:0},et))}}return ze})}loadGeoJSON(qe,De){return Q._(this,void 0,void 0,function*(){const{promoteId:ze}=qe;if(qe.request){const Le=yield Q.j(qe.request,De);return this._dataUpdateable=Ee(Le.data,ze)?Pe(Le.data,ze):void 0,Le.data}if(typeof qe.data=="string")try{const Le=JSON.parse(qe.data);return this._dataUpdateable=Ee(Le,ze)?Pe(Le,ze):void 0,Le}catch{throw new Error(`Input data given to '${qe.source}' is not a valid GeoJSON object.`)}if(!qe.dataDiff)throw new Error(`Input data given to '${qe.source}' is not a valid GeoJSON object.`);if(!this._dataUpdateable)throw new Error(`Cannot update existing geojson data in ${qe.source}`);return function(Le,Ke,et){var _t,st,bt,Mt;if(Ke.removeAll&&Le.clear(),Ke.remove)for(const Ot of Ke.remove)Le.delete(Ot);if(Ke.add)for(const Ot of Ke.add){const Nt=Ge(Ot,et);Nt!=null&&Le.set(Nt,Ot)}if(Ke.update)for(const Ot of Ke.update){let Nt=Le.get(Ot.id);if(Nt==null)continue;const St=!Ot.removeAllProperties&&(((_t=Ot.removeProperties)===null||_t===void 0?void 0:_t.length)>0||((st=Ot.addOrUpdateProperties)===null||st===void 0?void 0:st.length)>0);if((Ot.newGeometry||Ot.removeAllProperties||St)&&(Nt=Object.assign({},Nt),Le.set(Ot.id,Nt),St&&(Nt.properties=Object.assign({},Nt.properties))),Ot.newGeometry&&(Nt.geometry=Ot.newGeometry),Ot.removeAllProperties)Nt.properties={};else if(((bt=Ot.removeProperties)===null||bt===void 0?void 0:bt.length)>0)for(const ar of Ot.removeProperties)Object.prototype.hasOwnProperty.call(Nt.properties,ar)&&delete Nt.properties[ar];if(((Mt=Ot.addOrUpdateProperties)===null||Mt===void 0?void 0:Mt.length)>0)for(const{key:ar,value:qr}of Ot.addOrUpdateProperties)Nt.properties[ar]=qr}}(this._dataUpdateable,qe.dataDiff,ze),{type:"FeatureCollection",features:Array.from(this._dataUpdateable.values())}})}removeSource(qe){return Q._(this,void 0,void 0,function*(){this._pendingRequest&&this._pendingRequest.abort()})}getClusterExpansionZoom(qe){return this._geoJSONIndex.getClusterExpansionZoom(qe.clusterId)}getClusterChildren(qe){return this._geoJSONIndex.getChildren(qe.clusterId)}getClusterLeaves(qe){return this._geoJSONIndex.getLeaves(qe.clusterId,qe.limit,qe.offset)}}class ut{constructor(qe){this.self=qe,this.actor=new Q.J(qe),this.layerIndexes={},this.availableImages={},this.workerSources={},this.demWorkerSources={},this.externalWorkerSourceTypes={},this.self.registerWorkerSource=(De,ze)=>{if(this.externalWorkerSourceTypes[De])throw new Error(`Worker source with name "${De}" already registered.`);this.externalWorkerSourceTypes[De]=ze},this.self.addProtocol=Q.cz,this.self.removeProtocol=Q.cA,this.self.registerRTLTextPlugin=De=>{Q.cU.setMethods(De)},this.actor.registerMessageHandler("LDT",(De,ze)=>this._getDEMWorkerSource(De,ze.source).loadTile(ze)),this.actor.registerMessageHandler("RDT",(De,ze)=>Q._(this,void 0,void 0,function*(){this._getDEMWorkerSource(De,ze.source).removeTile(ze)})),this.actor.registerMessageHandler("GCEZ",(De,ze)=>Q._(this,void 0,void 0,function*(){return this._getWorkerSource(De,ze.type,ze.source).getClusterExpansionZoom(ze)})),this.actor.registerMessageHandler("GCC",(De,ze)=>Q._(this,void 0,void 0,function*(){return this._getWorkerSource(De,ze.type,ze.source).getClusterChildren(ze)})),this.actor.registerMessageHandler("GCL",(De,ze)=>Q._(this,void 0,void 0,function*(){return this._getWorkerSource(De,ze.type,ze.source).getClusterLeaves(ze)})),this.actor.registerMessageHandler("LD",(De,ze)=>this._getWorkerSource(De,ze.type,ze.source).loadData(ze)),this.actor.registerMessageHandler("GD",(De,ze)=>this._getWorkerSource(De,ze.type,ze.source).getData()),this.actor.registerMessageHandler("LT",(De,ze)=>this._getWorkerSource(De,ze.type,ze.source).loadTile(ze)),this.actor.registerMessageHandler("RT",(De,ze)=>this._getWorkerSource(De,ze.type,ze.source).reloadTile(ze)),this.actor.registerMessageHandler("AT",(De,ze)=>this._getWorkerSource(De,ze.type,ze.source).abortTile(ze)),this.actor.registerMessageHandler("RMT",(De,ze)=>this._getWorkerSource(De,ze.type,ze.source).removeTile(ze)),this.actor.registerMessageHandler("RS",(De,ze)=>Q._(this,void 0,void 0,function*(){if(!this.workerSources[De]||!this.workerSources[De][ze.type]||!this.workerSources[De][ze.type][ze.source])return;const Le=this.workerSources[De][ze.type][ze.source];delete this.workerSources[De][ze.type][ze.source],Le.removeSource!==void 0&&Le.removeSource(ze)})),this.actor.registerMessageHandler("RM",De=>Q._(this,void 0,void 0,function*(){delete this.layerIndexes[De],delete this.availableImages[De],delete this.workerSources[De],delete this.demWorkerSources[De]})),this.actor.registerMessageHandler("SR",(De,ze)=>Q._(this,void 0,void 0,function*(){this.referrer=ze})),this.actor.registerMessageHandler("SRPS",(De,ze)=>this._syncRTLPluginState(De,ze)),this.actor.registerMessageHandler("IS",(De,ze)=>Q._(this,void 0,void 0,function*(){this.self.importScripts(ze)})),this.actor.registerMessageHandler("SI",(De,ze)=>this._setImages(De,ze)),this.actor.registerMessageHandler("UL",(De,ze)=>Q._(this,void 0,void 0,function*(){this._getLayerIndex(De).update(ze.layers,ze.removedIds)})),this.actor.registerMessageHandler("SL",(De,ze)=>Q._(this,void 0,void 0,function*(){this._getLayerIndex(De).replace(ze)}))}_setImages(qe,De){return Q._(this,void 0,void 0,function*(){this.availableImages[qe]=De;for(const ze in this.workerSources[qe]){const Le=this.workerSources[qe][ze];for(const Ke in Le)Le[Ke].availableImages=De}})}_syncRTLPluginState(qe,De){return Q._(this,void 0,void 0,function*(){return yield Q.cU.syncState(De,this.self.importScripts)})}_getAvailableImages(qe){let De=this.availableImages[qe];return De||(De=[]),De}_getLayerIndex(qe){let De=this.layerIndexes[qe];return De||(De=this.layerIndexes[qe]=new R),De}_getWorkerSource(qe,De,ze){if(this.workerSources[qe]||(this.workerSources[qe]={}),this.workerSources[qe][De]||(this.workerSources[qe][De]={}),!this.workerSources[qe][De][ze]){const Le={sendAsync:(Ke,et)=>(Ke.targetMapId=qe,this.actor.sendAsync(Ke,et))};switch(De){case"vector":this.workerSources[qe][De][ze]=new he(Le,this._getLayerIndex(qe),this._getAvailableImages(qe));break;case"geojson":this.workerSources[qe][De][ze]=new He(Le,this._getLayerIndex(qe),this._getAvailableImages(qe));break;default:this.workerSources[qe][De][ze]=new this.externalWorkerSourceTypes[De](Le,this._getLayerIndex(qe),this._getAvailableImages(qe))}}return this.workerSources[qe][De][ze]}_getDEMWorkerSource(qe,De){return this.demWorkerSources[qe]||(this.demWorkerSources[qe]={}),this.demWorkerSources[qe][De]||(this.demWorkerSources[qe][De]=new pe),this.demWorkerSources[qe][De]}}return Q.i(self)&&(self.worker=new ut(self)),ut}),re("index",["exports","./shared"],function(Q,R){var U="5.6.1";function Z(){var oe=new R.A(4);return R.A!=Float32Array&&(oe[1]=0,oe[2]=0),oe[0]=1,oe[3]=1,oe}let ae,he;const pe={now:typeof performance<"u"&&performance&&performance.now?performance.now.bind(performance):Date.now.bind(Date),frame(oe,t,G){const J=requestAnimationFrame(se=>{te(),t(se)}),{unsubscribe:te}=R.s(oe.signal,"abort",()=>{te(),cancelAnimationFrame(J),G(R.c())},!1)},frameAsync(oe){return new Promise((t,G)=>{this.frame(oe,t,G)})},getImageData(oe,t=0){return this.getImageCanvasContext(oe).getImageData(-t,-t,oe.width+2*t,oe.height+2*t)},getImageCanvasContext(oe){const t=window.document.createElement("canvas"),G=t.getContext("2d",{willReadFrequently:!0});if(!G)throw new Error("failed to create canvas 2d context");return t.width=oe.width,t.height=oe.height,G.drawImage(oe,0,0,oe.width,oe.height),G},resolveURL:oe=>(ae||(ae=document.createElement("a")),ae.href=oe,ae.href),hardwareConcurrency:typeof navigator<"u"&&navigator.hardwareConcurrency||4,get prefersReducedMotion(){return!!matchMedia&&(he==null&&(he=matchMedia("(prefers-reduced-motion: reduce)")),he.matches)}};class me{static testProp(t){if(!me.docStyle)return t[0];for(let G=0;G<t.length;G++)if(t[G]in me.docStyle)return t[G];return t[0]}static create(t,G,J){const te=window.document.createElement(t);return G!==void 0&&(te.className=G),J&&J.appendChild(te),te}static createNS(t,G){return window.document.createElementNS(t,G)}static disableDrag(){me.docStyle&&me.selectProp&&(me.userSelect=me.docStyle[me.selectProp],me.docStyle[me.selectProp]="none")}static enableDrag(){me.docStyle&&me.selectProp&&(me.docStyle[me.selectProp]=me.userSelect)}static setTransform(t,G){t.style[me.transformProp]=G}static addEventListener(t,G,J,te={}){t.addEventListener(G,J,"passive"in te?te:te.capture)}static removeEventListener(t,G,J,te={}){t.removeEventListener(G,J,"passive"in te?te:te.capture)}static suppressClickInternal(t){t.preventDefault(),t.stopPropagation(),window.removeEventListener("click",me.suppressClickInternal,!0)}static suppressClick(){window.addEventListener("click",me.suppressClickInternal,!0),window.setTimeout(()=>{window.removeEventListener("click",me.suppressClickInternal,!0)},0)}static getScale(t){const G=t.getBoundingClientRect();return{x:G.width/t.offsetWidth||1,y:G.height/t.offsetHeight||1,boundingClientRect:G}}static getPoint(t,G,J){const te=G.boundingClientRect;return new R.P((J.clientX-te.left)/G.x-t.clientLeft,(J.clientY-te.top)/G.y-t.clientTop)}static mousePos(t,G){const J=me.getScale(t);return me.getPoint(t,J,G)}static touchPos(t,G){const J=[],te=me.getScale(t);for(let se=0;se<G.length;se++)J.push(me.getPoint(t,te,G[se]));return J}static mouseButton(t){return t.button}static remove(t){t.parentNode&&t.parentNode.removeChild(t)}static sanitize(t){const G=new DOMParser().parseFromString(t,"text/html").body||document.createElement("body"),J=G.querySelectorAll("script");for(const te of J)te.remove();return me.clean(G),G.innerHTML}static isPossiblyDangerous(t,G){const J=G.replace(/\s+/g,"").toLowerCase();return!(!["src","href","xlink:href"].includes(t)||!J.includes("javascript:")&&!J.includes("data:"))||!!t.startsWith("on")||void 0}static clean(t){const G=t.children;for(const J of G)me.removeAttributes(J),me.clean(J)}static removeAttributes(t){for(const{name:G,value:J}of t.attributes)me.isPossiblyDangerous(G,J)&&t.removeAttribute(G)}}me.docStyle=typeof window<"u"&&window.document&&window.document.documentElement.style,me.selectProp=me.testProp(["userSelect","MozUserSelect","WebkitUserSelect","msUserSelect"]),me.transformProp=me.testProp(["transform","WebkitTransform"]);const ve={supported:!1,testSupport:function(oe){!Te&&Me&&(Ce?We(oe):Re=oe)}};let Re,Me,Te=!1,Ce=!1;function We(oe){const t=oe.createTexture();oe.bindTexture(oe.TEXTURE_2D,t);try{if(oe.texImage2D(oe.TEXTURE_2D,0,oe.RGBA,oe.RGBA,oe.UNSIGNED_BYTE,Me),oe.isContextLost())return;ve.supported=!0}catch{}oe.deleteTexture(t),Te=!0}var Fe;typeof document<"u"&&(Me=document.createElement("img"),Me.onload=()=>{Re&&We(Re),Re=null,Ce=!0},Me.onerror=()=>{Te=!0,Re=null},Me.src="data:image/webp;base64,UklGRh4AAABXRUJQVlA4TBEAAAAvAQAAAAfQ//73v/+BiOh/AAA="),function(oe){let t,G,J,te;oe.resetRequestQueue=()=>{t=[],G=0,J=0,te={}},oe.addThrottleControl=ge=>{const xe=J++;return te[xe]=ge,xe},oe.removeThrottleControl=ge=>{delete te[ge],de()},oe.getImage=(ge,xe,Se=!0)=>new Promise((Oe,Ae)=>{ve.supported&&(ge.headers||(ge.headers={}),ge.headers.accept="image/webp,*/*"),R.e(ge,{type:"image"}),t.push({abortController:xe,requestParameters:ge,supportImageRefresh:Se,state:"queued",onError:je=>{Ae(je)},onSuccess:je=>{Oe(je)}}),de()});const se=ge=>R._(this,void 0,void 0,function*(){ge.state="running";const{requestParameters:xe,supportImageRefresh:Se,onError:Oe,onSuccess:Ae,abortController:je}=ge,Ye=Se===!1&&!R.i(self)&&!R.g(xe.url)&&(!xe.headers||Object.keys(xe.headers).reduce((ot,ht)=>ot&&ht==="accept",!0));G++;const at=Ye?_e(xe,je):R.m(xe,je);try{const ot=yield at;delete ge.abortController,ge.state="completed",ot.data instanceof HTMLImageElement||R.b(ot.data)?Ae(ot):ot.data&&Ae({data:yield(nt=ot.data,typeof createImageBitmap=="function"?R.f(nt):R.h(nt)),cacheControl:ot.cacheControl,expires:ot.expires})}catch(ot){delete ge.abortController,Oe(ot)}finally{G--,de()}var nt}),de=()=>{const ge=(()=>{for(const xe of Object.keys(te))if(te[xe]())return!0;return!1})()?R.a.MAX_PARALLEL_IMAGE_REQUESTS_PER_FRAME:R.a.MAX_PARALLEL_IMAGE_REQUESTS;for(let xe=G;xe<ge&&t.length>0;xe++){const Se=t.shift();Se.abortController.signal.aborted?xe--:se(Se)}},_e=(ge,xe)=>new Promise((Se,Oe)=>{const Ae=new Image,je=ge.url,Ye=ge.credentials;Ye&&Ye==="include"?Ae.crossOrigin="use-credentials":(Ye&&Ye==="same-origin"||!R.d(je))&&(Ae.crossOrigin="anonymous"),xe.signal.addEventListener("abort",()=>{Ae.src="",Oe(R.c())}),Ae.fetchPriority="high",Ae.onload=()=>{Ae.onerror=Ae.onload=null,Se({data:Ae})},Ae.onerror=()=>{Ae.onerror=Ae.onload=null,xe.signal.aborted||Oe(new Error("Could not load image. Please make sure to use a supported image type such as PNG or JPEG. Note that SVGs are not supported."))},Ae.src=je})}(Fe||(Fe={})),Fe.resetRequestQueue();class ke{constructor(t){this._transformRequestFn=t}transformRequest(t,G){return this._transformRequestFn&&this._transformRequestFn(t,G)||{url:t}}setTransformRequest(t){this._transformRequestFn=t}}function Ze(oe){const t=[];if(typeof oe=="string")t.push({id:"default",url:oe});else if(oe&&oe.length>0){const G=[];for(const{id:J,url:te}of oe){const se=`${J}${te}`;G.indexOf(se)===-1&&(G.push(se),t.push({id:J,url:te}))}}return t}function Je(oe,t,G){try{const J=new URL(oe);return J.pathname+=`${t}${G}`,J.toString()}catch{throw new Error(`Invalid sprite URL "${oe}", must be absolute. Modify style specification directly or use TransformStyleFunction to correct the issue dynamically`)}}function Qe(oe){const{userImage:t}=oe;return!!(t&&t.render&&t.render())&&(oe.data.replace(new Uint8Array(t.data.buffer)),!0)}class it extends R.E{constructor(){super(),this.images={},this.updatedImages={},this.callbackDispatchedThisFrame={},this.loaded=!1,this.requestors=[],this.patterns={},this.atlasImage=new R.R({width:1,height:1}),this.dirty=!0}isLoaded(){return this.loaded}setLoaded(t){if(this.loaded!==t&&(this.loaded=t,t)){for(const{ids:G,promiseResolve:J}of this.requestors)J(this._getImagesForIds(G));this.requestors=[]}}getImage(t){const G=this.images[t];if(G&&!G.data&&G.spriteData){const J=G.spriteData;G.data=new R.R({width:J.width,height:J.height},J.context.getImageData(J.x,J.y,J.width,J.height).data),G.spriteData=null}return G}addImage(t,G){if(this.images[t])throw new Error(`Image id ${t} already exist, use updateImage instead`);this._validate(t,G)&&(this.images[t]=G)}_validate(t,G){let J=!0;const te=G.data||G.spriteData;return this._validateStretch(G.stretchX,te&&te.width)||(this.fire(new R.k(new Error(`Image "${t}" has invalid "stretchX" value`))),J=!1),this._validateStretch(G.stretchY,te&&te.height)||(this.fire(new R.k(new Error(`Image "${t}" has invalid "stretchY" value`))),J=!1),this._validateContent(G.content,G)||(this.fire(new R.k(new Error(`Image "${t}" has invalid "content" value`))),J=!1),J}_validateStretch(t,G){if(!t)return!0;let J=0;for(const te of t){if(te[0]<J||te[1]<te[0]||G<te[1])return!1;J=te[1]}return!0}_validateContent(t,G){if(!t)return!0;if(t.length!==4)return!1;const J=G.spriteData,te=J&&J.width||G.data.width,se=J&&J.height||G.data.height;return!(t[0]<0||te<t[0]||t[1]<0||se<t[1]||t[2]<0||te<t[2]||t[3]<0||se<t[3]||t[2]<t[0]||t[3]<t[1])}updateImage(t,G,J=!0){const te=this.getImage(t);if(J&&(te.data.width!==G.data.width||te.data.height!==G.data.height))throw new Error(`size mismatch between old image (${te.data.width}x${te.data.height}) and new image (${G.data.width}x${G.data.height}).`);G.version=te.version+1,this.images[t]=G,this.updatedImages[t]=!0}removeImage(t){const G=this.images[t];delete this.images[t],delete this.patterns[t],G.userImage&&G.userImage.onRemove&&G.userImage.onRemove()}listImages(){return Object.keys(this.images)}getImages(t){return new Promise((G,J)=>{let te=!0;if(!this.isLoaded())for(const se of t)this.images[se]||(te=!1);this.isLoaded()||te?G(this._getImagesForIds(t)):this.requestors.push({ids:t,promiseResolve:G})})}_getImagesForIds(t){const G={};for(const J of t){let te=this.getImage(J);te||(this.fire(new R.l("styleimagemissing",{id:J})),te=this.getImage(J)),te?G[J]={data:te.data.clone(),pixelRatio:te.pixelRatio,sdf:te.sdf,version:te.version,stretchX:te.stretchX,stretchY:te.stretchY,content:te.content,textFitWidth:te.textFitWidth,textFitHeight:te.textFitHeight,hasRenderCallback:!!(te.userImage&&te.userImage.render)}:R.w(`Image "${J}" could not be loaded. Please make sure you have added the image with map.addImage() or a "sprite" property in your style. You can provide missing images by listening for the "styleimagemissing" map event.`)}return G}getPixelSize(){const{width:t,height:G}=this.atlasImage;return{width:t,height:G}}getPattern(t){const G=this.patterns[t],J=this.getImage(t);if(!J)return null;if(G&&G.position.version===J.version)return G.position;if(G)G.position.version=J.version;else{const te={w:J.data.width+2,h:J.data.height+2,x:0,y:0},se=new R.I(te,J);this.patterns[t]={bin:te,position:se}}return this._updatePatternAtlas(),this.patterns[t].position}bind(t){const G=t.gl;this.atlasTexture?this.dirty&&(this.atlasTexture.update(this.atlasImage),this.dirty=!1):this.atlasTexture=new R.T(t,this.atlasImage,G.RGBA),this.atlasTexture.bind(G.LINEAR,G.CLAMP_TO_EDGE)}_updatePatternAtlas(){const t=[];for(const se in this.patterns)t.push(this.patterns[se].bin);const{w:G,h:J}=R.p(t),te=this.atlasImage;te.resize({width:G||1,height:J||1});for(const se in this.patterns){const{bin:de}=this.patterns[se],_e=de.x+1,ge=de.y+1,xe=this.getImage(se).data,Se=xe.width,Oe=xe.height;R.R.copy(xe,te,{x:0,y:0},{x:_e,y:ge},{width:Se,height:Oe}),R.R.copy(xe,te,{x:0,y:Oe-1},{x:_e,y:ge-1},{width:Se,height:1}),R.R.copy(xe,te,{x:0,y:0},{x:_e,y:ge+Oe},{width:Se,height:1}),R.R.copy(xe,te,{x:Se-1,y:0},{x:_e-1,y:ge},{width:1,height:Oe}),R.R.copy(xe,te,{x:0,y:0},{x:_e+Se,y:ge},{width:1,height:Oe})}this.dirty=!0}beginFrame(){this.callbackDispatchedThisFrame={}}dispatchRenderCallbacks(t){for(const G of t){if(this.callbackDispatchedThisFrame[G])continue;this.callbackDispatchedThisFrame[G]=!0;const J=this.getImage(G);J||R.w(`Image with ID: "${G}" was not found`),Qe(J)&&this.updateImage(G,J)}}}const lt=1e20;function dt(oe,t,G,J,te,se,de,_e,ge){for(let xe=t;xe<t+J;xe++)yt(oe,G*se+xe,se,te,de,_e,ge);for(let xe=G;xe<G+te;xe++)yt(oe,xe*se+t,1,J,de,_e,ge)}function yt(oe,t,G,J,te,se,de){se[0]=0,de[0]=-lt,de[1]=lt,te[0]=oe[t];for(let _e=1,ge=0,xe=0;_e<J;_e++){te[_e]=oe[t+_e*G];const Se=_e*_e;do{const Oe=se[ge];xe=(te[_e]-te[Oe]+Se-Oe*Oe)/(_e-Oe)/2}while(xe<=de[ge]&&--ge>-1);ge++,se[ge]=_e,de[ge]=xe,de[ge+1]=lt}for(let _e=0,ge=0;_e<J;_e++){for(;de[ge+1]<_e;)ge++;const xe=se[ge],Se=_e-xe;oe[t+_e*G]=te[xe]+Se*Se}}class gt{constructor(t,G){this.requestManager=t,this.localIdeographFontFamily=G,this.entries={}}setURL(t){this.url=t}getGlyphs(t){return R._(this,void 0,void 0,function*(){const G=[];for(const se in t)for(const de of t[se])G.push(this._getAndCacheGlyphsPromise(se,de));const J=yield Promise.all(G),te={};for(const{stack:se,id:de,glyph:_e}of J)te[se]||(te[se]={}),te[se][de]=_e&&{id:_e.id,bitmap:_e.bitmap.clone(),metrics:_e.metrics};return te})}_getAndCacheGlyphsPromise(t,G){return R._(this,void 0,void 0,function*(){let J=this.entries[t];J||(J=this.entries[t]={glyphs:{},requests:{},ranges:{}});let te=J.glyphs[G];if(te!==void 0)return{stack:t,id:G,glyph:te};if(te=this._tinySDF(J,t,G),te)return J.glyphs[G]=te,{stack:t,id:G,glyph:te};const se=Math.floor(G/256);if(256*se>65535)throw new Error("glyphs > 65535 not supported");if(J.ranges[se])return{stack:t,id:G,glyph:te};if(!this.url)throw new Error("glyphsUrl is not set");if(!J.requests[se]){const _e=gt.loadGlyphRange(t,se,this.url,this.requestManager);J.requests[se]=_e}const de=yield J.requests[se];for(const _e in de)this._doesCharSupportLocalGlyph(+_e)||(J.glyphs[+_e]=de[+_e]);return J.ranges[se]=!0,{stack:t,id:G,glyph:de[G]||null}})}_doesCharSupportLocalGlyph(t){return!!this.localIdeographFontFamily&&(new RegExp("\\p{Ideo}|\\p{sc=Hang}|\\p{sc=Hira}|\\p{sc=Kana}","u").test(String.fromCodePoint(t))||R.u["CJK Unified Ideographs"](t)||R.u["Hangul Syllables"](t)||R.u.Hiragana(t)||R.u.Katakana(t)||R.u["CJK Symbols and Punctuation"](t)||R.u["Halfwidth and Fullwidth Forms"](t))}_tinySDF(t,G,J){const te=this.localIdeographFontFamily;if(!te||!this._doesCharSupportLocalGlyph(J))return;let se=t.tinySDF;if(!se){let _e="400";/bold/i.test(G)?_e="900":/medium/i.test(G)?_e="500":/light/i.test(G)&&(_e="200"),se=t.tinySDF=new gt.TinySDF({fontSize:48,buffer:6,radius:16,cutoff:.25,fontFamily:te,fontWeight:_e})}const de=se.draw(String.fromCharCode(J));return{id:J,bitmap:new R.q({width:de.width||60,height:de.height||60},de.data),metrics:{width:de.glyphWidth/2||24,height:de.glyphHeight/2||24,left:de.glyphLeft/2+.5||0,top:de.glyphTop/2-27.5||-8,advance:de.glyphAdvance/2||24,isDoubleResolution:!0}}}}gt.loadGlyphRange=function(oe,t,G,J){return R._(this,void 0,void 0,function*(){const te=256*t,se=te+255,de=J.transformRequest(G.replace("{fontstack}",oe).replace("{range}",`${te}-${se}`),"Glyphs"),_e=yield R.n(de,new AbortController);if(!_e||!_e.data)throw new Error(`Could not load glyph range. range: ${t}, ${te}-${se}`);const ge={};for(const xe of R.o(_e.data))ge[xe.id]=xe;return ge})},gt.TinySDF=class{constructor({fontSize:oe=24,buffer:t=3,radius:G=8,cutoff:J=.25,fontFamily:te="sans-serif",fontWeight:se="normal",fontStyle:de="normal"}={}){this.buffer=t,this.cutoff=J,this.radius=G;const _e=this.size=oe+4*t,ge=this._createCanvas(_e),xe=this.ctx=ge.getContext("2d",{willReadFrequently:!0});xe.font=`${de} ${se} ${oe}px ${te}`,xe.textBaseline="alphabetic",xe.textAlign="left",xe.fillStyle="black",this.gridOuter=new Float64Array(_e*_e),this.gridInner=new Float64Array(_e*_e),this.f=new Float64Array(_e),this.z=new Float64Array(_e+1),this.v=new Uint16Array(_e)}_createCanvas(oe){const t=document.createElement("canvas");return t.width=t.height=oe,t}draw(oe){const{width:t,actualBoundingBoxAscent:G,actualBoundingBoxDescent:J,actualBoundingBoxLeft:te,actualBoundingBoxRight:se}=this.ctx.measureText(oe),de=Math.ceil(G),_e=Math.max(0,Math.min(this.size-this.buffer,Math.ceil(se-te))),ge=Math.min(this.size-this.buffer,de+Math.ceil(J)),xe=_e+2*this.buffer,Se=ge+2*this.buffer,Oe=Math.max(xe*Se,0),Ae=new Uint8ClampedArray(Oe),je={data:Ae,width:xe,height:Se,glyphWidth:_e,glyphHeight:ge,glyphTop:de,glyphLeft:0,glyphAdvance:t};if(_e===0||ge===0)return je;const{ctx:Ye,buffer:at,gridInner:nt,gridOuter:ot}=this;Ye.clearRect(at,at,_e,ge),Ye.fillText(oe,at,at+de);const ht=Ye.getImageData(at,at,_e,ge);ot.fill(lt,0,Oe),nt.fill(0,0,Oe);for(let xt=0;xt<ge;xt++)for(let mt=0;mt<_e;mt++){const Tt=ht.data[4*(xt*_e+mt)+3]/255;if(Tt===0)continue;const Pt=(xt+at)*xe+mt+at;if(Tt===1)ot[Pt]=0,nt[Pt]=lt;else{const vt=.5-Tt;ot[Pt]=vt>0?vt*vt:0,nt[Pt]=vt<0?vt*vt:0}}dt(ot,0,0,xe,Se,xe,this.f,this.v,this.z),dt(nt,at,at,_e,ge,xe,this.f,this.v,this.z);for(let xt=0;xt<Oe;xt++){const mt=Math.sqrt(ot[xt])-Math.sqrt(nt[xt]);Ae[xt]=Math.round(255-255*(mt/this.radius+this.cutoff))}return je}};class qt{constructor(){this.specification=R.v.light.position}possiblyEvaluate(t,G){return R.B(t.expression.evaluate(G))}interpolate(t,G,J){return{x:R.C.number(t.x,G.x,J),y:R.C.number(t.y,G.y,J),z:R.C.number(t.z,G.z,J)}}}let Ft;class Gt extends R.E{constructor(t){super(),Ft=Ft||new R.r({anchor:new R.D(R.v.light.anchor),position:new qt,color:new R.D(R.v.light.color),intensity:new R.D(R.v.light.intensity)}),this._transitionable=new R.t(Ft),this.setLight(t),this._transitioning=this._transitionable.untransitioned()}getLight(){return this._transitionable.serialize()}setLight(t,G={}){if(!this._validate(R.x,t,G))for(const J in t){const te=t[J];J.endsWith("-transition")?this._transitionable.setTransition(J.slice(0,-11),te):this._transitionable.setValue(J,te)}}updateTransitions(t){this._transitioning=this._transitionable.transitioned(t,this._transitioning)}hasTransition(){return this._transitioning.hasTransition()}recalculate(t){this.properties=this._transitioning.possiblyEvaluate(t)}_validate(t,G,J){return(!J||J.validate!==!1)&&R.y(this,t.call(R.z,{value:G,style:{glyphs:!0,sprite:!0},styleSpec:R.v}))}}const ft=new R.r({"sky-color":new R.D(R.v.sky["sky-color"]),"horizon-color":new R.D(R.v.sky["horizon-color"]),"fog-color":new R.D(R.v.sky["fog-color"]),"fog-ground-blend":new R.D(R.v.sky["fog-ground-blend"]),"horizon-fog-blend":new R.D(R.v.sky["horizon-fog-blend"]),"sky-horizon-blend":new R.D(R.v.sky["sky-horizon-blend"]),"atmosphere-blend":new R.D(R.v.sky["atmosphere-blend"])});class Rt extends R.E{constructor(t){super(),this._transitionable=new R.t(ft),this.setSky(t),this._transitioning=this._transitionable.untransitioned(),this.recalculate(new R.F(0))}setSky(t,G={}){if(!this._validate(R.G,t,G)){t||(t={"sky-color":"transparent","horizon-color":"transparent","fog-color":"transparent","fog-ground-blend":1,"atmosphere-blend":0});for(const J in t){const te=t[J];J.endsWith("-transition")?this._transitionable.setTransition(J.slice(0,-11),te):this._transitionable.setValue(J,te)}}}getSky(){return this._transitionable.serialize()}updateTransitions(t){this._transitioning=this._transitionable.transitioned(t,this._transitioning)}hasTransition(){return this._transitioning.hasTransition()}recalculate(t){this.properties=this._transitioning.possiblyEvaluate(t)}_validate(t,G,J={}){return(J==null?void 0:J.validate)!==!1&&R.y(this,t.call(R.z,R.e({value:G,style:{glyphs:!0,sprite:!0},styleSpec:R.v})))}calculateFogBlendOpacity(t){return t<60?0:t<70?(t-60)/10:1}}class pt{constructor(t,G){this.width=t,this.height=G,this.nextRow=0,this.data=new Uint8Array(this.width*this.height),this.dashEntry={}}getDash(t,G){const J=t.join(",")+String(G);return this.dashEntry[J]||(this.dashEntry[J]=this.addDash(t,G)),this.dashEntry[J]}getDashRanges(t,G,J){const te=[];let se=t.length%2==1?-t[t.length-1]*J:0,de=t[0]*J,_e=!0;te.push({left:se,right:de,isDash:_e,zeroLength:t[0]===0});let ge=t[0];for(let xe=1;xe<t.length;xe++){_e=!_e;const Se=t[xe];se=ge*J,ge+=Se,de=ge*J,te.push({left:se,right:de,isDash:_e,zeroLength:Se===0})}return te}addRoundDash(t,G,J){const te=G/2;for(let se=-J;se<=J;se++){const de=this.width*(this.nextRow+J+se);let _e=0,ge=t[_e];for(let xe=0;xe<this.width;xe++){xe/ge.right>1&&(ge=t[++_e]);const Se=Math.abs(xe-ge.left),Oe=Math.abs(xe-ge.right),Ae=Math.min(Se,Oe);let je;const Ye=se/J*(te+1);if(ge.isDash){const at=te-Math.abs(Ye);je=Math.sqrt(Ae*Ae+at*at)}else je=te-Math.sqrt(Ae*Ae+Ye*Ye);this.data[de+xe]=Math.max(0,Math.min(255,je+128))}}}addRegularDash(t){for(let _e=t.length-1;_e>=0;--_e){const ge=t[_e],xe=t[_e+1];ge.zeroLength?t.splice(_e,1):xe&&xe.isDash===ge.isDash&&(xe.left=ge.left,t.splice(_e,1))}const G=t[0],J=t[t.length-1];G.isDash===J.isDash&&(G.left=J.left-this.width,J.right=G.right+this.width);const te=this.width*this.nextRow;let se=0,de=t[se];for(let _e=0;_e<this.width;_e++){_e/de.right>1&&(de=t[++se]);const ge=Math.abs(_e-de.left),xe=Math.abs(_e-de.right),Se=Math.min(ge,xe);this.data[te+_e]=Math.max(0,Math.min(255,(de.isDash?Se:-Se)+128))}}addDash(t,G){const J=G?7:0,te=2*J+1;if(this.nextRow+te>this.height)return R.w("LineAtlas out of space"),null;let se=0;for(let _e=0;_e<t.length;_e++)se+=t[_e];if(se!==0){const _e=this.width/se,ge=this.getDashRanges(t,this.width,_e);G?this.addRoundDash(ge,_e,J):this.addRegularDash(ge)}const de={y:(this.nextRow+J+.5)/this.height,height:2*J/this.height,width:se};return this.nextRow+=te,this.dirty=!0,de}bind(t){const G=t.gl;this.texture?(G.bindTexture(G.TEXTURE_2D,this.texture),this.dirty&&(this.dirty=!1,G.texSubImage2D(G.TEXTURE_2D,0,0,0,this.width,this.height,G.ALPHA,G.UNSIGNED_BYTE,this.data))):(this.texture=G.createTexture(),G.bindTexture(G.TEXTURE_2D,this.texture),G.texParameteri(G.TEXTURE_2D,G.TEXTURE_WRAP_S,G.REPEAT),G.texParameteri(G.TEXTURE_2D,G.TEXTURE_WRAP_T,G.REPEAT),G.texParameteri(G.TEXTURE_2D,G.TEXTURE_MIN_FILTER,G.LINEAR),G.texParameteri(G.TEXTURE_2D,G.TEXTURE_MAG_FILTER,G.LINEAR),G.texImage2D(G.TEXTURE_2D,0,G.ALPHA,this.width,this.height,0,G.ALPHA,G.UNSIGNED_BYTE,this.data))}}const At="maplibre_preloaded_worker_pool";class It{constructor(){this.active={}}acquire(t){if(!this.workers)for(this.workers=[];this.workers.length<It.workerCount;)this.workers.push(new Worker(R.a.WORKER_URL));return this.active[t]=!0,this.workers.slice()}release(t){delete this.active[t],this.numActive()===0&&(this.workers.forEach(G=>{G.terminate()}),this.workers=null)}isPreloaded(){return!!this.active[At]}numActive(){return Object.keys(this.active).length}}const Dt=Math.floor(pe.hardwareConcurrency/2);let Zt,nr;function Er(){return Zt||(Zt=new It),Zt}It.workerCount=R.H(globalThis)?Math.max(Math.min(Dt,3),1):1;class vr{constructor(t,G){this.workerPool=t,this.actors=[],this.currentActor=0,this.id=G;const J=this.workerPool.acquire(G);for(let te=0;te<J.length;te++){const se=new R.J(J[te],G);se.name=`Worker ${te}`,this.actors.push(se)}if(!this.actors.length)throw new Error("No actors found")}broadcast(t,G){const J=[];for(const te of this.actors)J.push(te.sendAsync({type:t,data:G}));return Promise.all(J)}getActor(){return this.currentActor=(this.currentActor+1)%this.actors.length,this.actors[this.currentActor]}remove(t=!0){this.actors.forEach(G=>{G.remove()}),this.actors=[],t&&this.workerPool.release(this.id)}registerMessageHandler(t,G){for(const J of this.actors)J.registerMessageHandler(t,G)}}function Sr(){return nr||(nr=new vr(Er(),R.K),nr.registerMessageHandler("GR",(oe,t,G)=>R.m(t,G))),nr}function Qt(oe,t){const G=R.L();return R.M(G,G,[1,1,0]),R.N(G,G,[.5*oe.width,.5*oe.height,1]),oe.calculatePosMatrix?R.O(G,G,oe.calculatePosMatrix(t.toUnwrapped())):G}function or(oe,t,G,J,te,se,de){var _e;const ge=function(Ae,je,Ye){if(Ae)for(const at of Ae){const nt=je[at];if(nt&&nt.source===Ye&&nt.type==="fill-extrusion")return!0}else for(const at in je){const nt=je[at];if(nt.source===Ye&&nt.type==="fill-extrusion")return!0}return!1}((_e=te==null?void 0:te.layers)!==null&&_e!==void 0?_e:null,t,oe.id),xe=se.maxPitchScaleFactor(),Se=oe.tilesIn(J,xe,ge);Se.sort(Ir);const Oe=[];for(const Ae of Se)Oe.push({wrappedTileID:Ae.tileID.wrapped().key,queryResults:Ae.tile.queryRenderedFeatures(t,G,oe._state,Ae.queryGeometry,Ae.cameraQueryGeometry,Ae.scale,te,se,xe,Qt(oe.transform,Ae.tileID),de?(je,Ye)=>de(Ae.tileID,je,Ye):void 0)});return function(Ae,je){for(const Ye in Ae)for(const at of Ae[Ye])Rr(at,je);return Ae}(function(Ae){const je={},Ye={};for(const at of Ae){const nt=at.queryResults,ot=at.wrappedTileID,ht=Ye[ot]=Ye[ot]||{};for(const xt in nt){const mt=nt[xt],Tt=ht[xt]=ht[xt]||{},Pt=je[xt]=je[xt]||[];for(const vt of mt)Tt[vt.featureIndex]||(Tt[vt.featureIndex]=!0,Pt.push(vt))}}return je}(Oe),oe)}function Ir(oe,t){const G=oe.tileID,J=t.tileID;return G.overscaledZ-J.overscaledZ||G.canonical.y-J.canonical.y||G.wrap-J.wrap||G.canonical.x-J.canonical.x}function Rr(oe,t){const G=oe.feature,J=t.getFeatureState(G.layer["source-layer"],G.id);G.source=G.layer.source,G.layer["source-layer"]&&(G.sourceLayer=G.layer["source-layer"]),G.state=J}function Cr(oe,t,G){return R._(this,void 0,void 0,function*(){let J=oe;if(oe.url?J=(yield R.j(t.transformRequest(oe.url,"Source"),G)).data:yield pe.frameAsync(G),!J)return null;const te=R.Q(R.e(J,oe),["tiles","minzoom","maxzoom","attribution","bounds","scheme","tileSize","encoding"]);return"vector_layers"in J&&J.vector_layers&&(te.vectorLayerIds=J.vector_layers.map(se=>se.id)),te})}class wr{constructor(t,G){t&&(G?this.setSouthWest(t).setNorthEast(G):Array.isArray(t)&&(t.length===4?this.setSouthWest([t[0],t[1]]).setNorthEast([t[2],t[3]]):this.setSouthWest(t[0]).setNorthEast(t[1])))}setNorthEast(t){return this._ne=t instanceof R.S?new R.S(t.lng,t.lat):R.S.convert(t),this}setSouthWest(t){return this._sw=t instanceof R.S?new R.S(t.lng,t.lat):R.S.convert(t),this}extend(t){const G=this._sw,J=this._ne;let te,se;if(t instanceof R.S)te=t,se=t;else{if(!(t instanceof wr))return Array.isArray(t)?t.length===4||t.every(Array.isArray)?this.extend(wr.convert(t)):this.extend(R.S.convert(t)):t&&("lng"in t||"lon"in t)&&"lat"in t?this.extend(R.S.convert(t)):this;if(te=t._sw,se=t._ne,!te||!se)return this}return G||J?(G.lng=Math.min(te.lng,G.lng),G.lat=Math.min(te.lat,G.lat),J.lng=Math.max(se.lng,J.lng),J.lat=Math.max(se.lat,J.lat)):(this._sw=new R.S(te.lng,te.lat),this._ne=new R.S(se.lng,se.lat)),this}getCenter(){return new R.S((this._sw.lng+this._ne.lng)/2,(this._sw.lat+this._ne.lat)/2)}getSouthWest(){return this._sw}getNorthEast(){return this._ne}getNorthWest(){return new R.S(this.getWest(),this.getNorth())}getSouthEast(){return new R.S(this.getEast(),this.getSouth())}getWest(){return this._sw.lng}getSouth(){return this._sw.lat}getEast(){return this._ne.lng}getNorth(){return this._ne.lat}toArray(){return[this._sw.toArray(),this._ne.toArray()]}toString(){return`LngLatBounds(${this._sw.toString()}, ${this._ne.toString()})`}isEmpty(){return!(this._sw&&this._ne)}contains(t){const{lng:G,lat:J}=R.S.convert(t);let te=this._sw.lng<=G&&G<=this._ne.lng;return this._sw.lng>this._ne.lng&&(te=this._sw.lng>=G&&G>=this._ne.lng),this._sw.lat<=J&&J<=this._ne.lat&&te}static convert(t){return t instanceof wr?t:t&&new wr(t)}static fromLngLat(t,G=0){const J=360*G/40075017,te=J/Math.cos(Math.PI/180*t.lat);return new wr(new R.S(t.lng-te,t.lat-J),new R.S(t.lng+te,t.lat+J))}adjustAntiMeridian(){const t=new R.S(this._sw.lng,this._sw.lat),G=new R.S(this._ne.lng,this._ne.lat);return new wr(t,t.lng>G.lng?new R.S(G.lng+360,G.lat):G)}}class Wr{constructor(t,G,J){this.bounds=wr.convert(this.validateBounds(t)),this.minzoom=G||0,this.maxzoom=J||24}validateBounds(t){return Array.isArray(t)&&t.length===4?[Math.max(-180,t[0]),Math.max(-90,t[1]),Math.min(180,t[2]),Math.min(90,t[3])]:[-180,-90,180,90]}contains(t){const G=Math.pow(2,t.z),J=Math.floor(R.V(this.bounds.getWest())*G),te=Math.floor(R.U(this.bounds.getNorth())*G),se=Math.ceil(R.V(this.bounds.getEast())*G),de=Math.ceil(R.U(this.bounds.getSouth())*G);return t.x>=J&&t.x<se&&t.y>=te&&t.y<de}}class Kr extends R.E{constructor(t,G,J,te){if(super(),this.id=t,this.dispatcher=J,this.type="vector",this.minzoom=0,this.maxzoom=22,this.scheme="xyz",this.tileSize=512,this.reparseOverscaled=!0,this.isTileClipped=!0,this._loaded=!1,R.e(this,R.Q(G,["url","scheme","tileSize","promoteId"])),this._options=R.e({type:"vector"},G),this._collectResourceTiming=G.collectResourceTiming,this.tileSize!==512)throw new Error("vector tile sources must have a tileSize of 512");this.setEventedParent(te)}load(){return R._(this,void 0,void 0,function*(){this._loaded=!1,this.fire(new R.l("dataloading",{dataType:"source"})),this._tileJSONRequest=new AbortController;try{const t=yield Cr(this._options,this.map._requestManager,this._tileJSONRequest);this._tileJSONRequest=null,this._loaded=!0,this.map.style.sourceCaches[this.id].clearTiles(),t&&(R.e(this,t),t.bounds&&(this.tileBounds=new Wr(t.bounds,this.minzoom,this.maxzoom)),this.fire(new R.l("data",{dataType:"source",sourceDataType:"metadata"})),this.fire(new R.l("data",{dataType:"source",sourceDataType:"content"})))}catch(t){this._tileJSONRequest=null,this.fire(new R.k(t))}})}loaded(){return this._loaded}hasTile(t){return!this.tileBounds||this.tileBounds.contains(t.canonical)}onAdd(t){this.map=t,this.load()}setSourceProperty(t){this._tileJSONRequest&&this._tileJSONRequest.abort(),t(),this.load()}setTiles(t){return this.setSourceProperty(()=>{this._options.tiles=t}),this}setUrl(t){return this.setSourceProperty(()=>{this.url=t,this._options.url=t}),this}onRemove(){this._tileJSONRequest&&(this._tileJSONRequest.abort(),this._tileJSONRequest=null)}serialize(){return R.e({},this._options)}loadTile(t){return R._(this,void 0,void 0,function*(){const G=t.tileID.canonical.url(this.tiles,this.map.getPixelRatio(),this.scheme),J={request:this.map._requestManager.transformRequest(G,"Tile"),uid:t.uid,tileID:t.tileID,zoom:t.tileID.overscaledZ,tileSize:this.tileSize*t.tileID.overscaleFactor(),type:this.type,source:this.id,pixelRatio:this.map.getPixelRatio(),showCollisionBoxes:this.map.showCollisionBoxes,promoteId:this.promoteId,subdivisionGranularity:this.map.style.projection.subdivisionGranularity,globalState:this.map.getGlobalState()};J.request.collectResourceTiming=this._collectResourceTiming;let te="RT";if(t.actor&&t.state!=="expired"){if(t.state==="loading")return new Promise((se,de)=>{t.reloadPromise={resolve:se,reject:de}})}else t.actor=this.dispatcher.getActor(),te="LT";t.abortController=new AbortController;try{const se=yield t.actor.sendAsync({type:te,data:J},t.abortController);if(delete t.abortController,t.aborted)return;this._afterTileLoadWorkerResponse(t,se)}catch(se){if(delete t.abortController,t.aborted)return;if(se&&se.status!==404)throw se;this._afterTileLoadWorkerResponse(t,null)}})}_afterTileLoadWorkerResponse(t,G){if(G&&G.resourceTiming&&(t.resourceTiming=G.resourceTiming),G&&this.map._refreshExpiredTiles&&t.setExpiryData(G),t.loadVectorData(G,this.map.painter),t.reloadPromise){const J=t.reloadPromise;t.reloadPromise=null,this.loadTile(t).then(J.resolve).catch(J.reject)}}abortTile(t){return R._(this,void 0,void 0,function*(){t.abortController&&(t.abortController.abort(),delete t.abortController),t.actor&&(yield t.actor.sendAsync({type:"AT",data:{uid:t.uid,type:this.type,source:this.id}}))})}unloadTile(t){return R._(this,void 0,void 0,function*(){t.unloadVectorData(),t.actor&&(yield t.actor.sendAsync({type:"RMT",data:{uid:t.uid,type:this.type,source:this.id}}))})}hasTransition(){return!1}}class Hr extends R.E{constructor(t,G,J,te){super(),this.id=t,this.dispatcher=J,this.setEventedParent(te),this.type="raster",this.minzoom=0,this.maxzoom=22,this.roundZoom=!0,this.scheme="xyz",this.tileSize=512,this._loaded=!1,this._options=R.e({type:"raster"},G),R.e(this,R.Q(G,["url","scheme","tileSize"]))}load(){return R._(this,arguments,void 0,function*(t=!1){this._loaded=!1,this.fire(new R.l("dataloading",{dataType:"source"})),this._tileJSONRequest=new AbortController;try{const G=yield Cr(this._options,this.map._requestManager,this._tileJSONRequest);this._tileJSONRequest=null,this._loaded=!0,G&&(R.e(this,G),G.bounds&&(this.tileBounds=new Wr(G.bounds,this.minzoom,this.maxzoom)),this.fire(new R.l("data",{dataType:"source",sourceDataType:"metadata"})),this.fire(new R.l("data",{dataType:"source",sourceDataType:"content",sourceDataChanged:t})))}catch(G){this._tileJSONRequest=null,this.fire(new R.k(G))}})}loaded(){return this._loaded}onAdd(t){this.map=t,this.load()}onRemove(){this._tileJSONRequest&&(this._tileJSONRequest.abort(),this._tileJSONRequest=null)}setSourceProperty(t){this._tileJSONRequest&&(this._tileJSONRequest.abort(),this._tileJSONRequest=null),t(),this.load(!0)}setTiles(t){return this.setSourceProperty(()=>{this._options.tiles=t}),this}setUrl(t){return this.setSourceProperty(()=>{this.url=t,this._options.url=t}),this}serialize(){return R.e({},this._options)}hasTile(t){return!this.tileBounds||this.tileBounds.contains(t.canonical)}loadTile(t){return R._(this,void 0,void 0,function*(){const G=t.tileID.canonical.url(this.tiles,this.map.getPixelRatio(),this.scheme);t.abortController=new AbortController;try{const J=yield Fe.getImage(this.map._requestManager.transformRequest(G,"Tile"),t.abortController,this.map._refreshExpiredTiles);if(delete t.abortController,t.aborted)return void(t.state="unloaded");if(J&&J.data){this.map._refreshExpiredTiles&&(J.cacheControl||J.expires)&&t.setExpiryData({cacheControl:J.cacheControl,expires:J.expires});const te=this.map.painter.context,se=te.gl,de=J.data;t.texture=this.map.painter.getTileTexture(de.width),t.texture?t.texture.update(de,{useMipmap:!0}):(t.texture=new R.T(te,de,se.RGBA,{useMipmap:!0}),t.texture.bind(se.LINEAR,se.CLAMP_TO_EDGE,se.LINEAR_MIPMAP_NEAREST)),t.state="loaded"}}catch(J){if(delete t.abortController,t.aborted)t.state="unloaded";else if(J)throw t.state="errored",J}})}abortTile(t){return R._(this,void 0,void 0,function*(){t.abortController&&(t.abortController.abort(),delete t.abortController)})}unloadTile(t){return R._(this,void 0,void 0,function*(){t.texture&&this.map.painter.saveTileTexture(t.texture)})}hasTransition(){return!1}}class br extends Hr{constructor(t,G,J,te){super(t,G,J,te),this.type="raster-dem",this.maxzoom=22,this._options=R.e({type:"raster-dem"},G),this.encoding=G.encoding||"mapbox",this.redFactor=G.redFactor,this.greenFactor=G.greenFactor,this.blueFactor=G.blueFactor,this.baseShift=G.baseShift}loadTile(t){return R._(this,void 0,void 0,function*(){const G=t.tileID.canonical.url(this.tiles,this.map.getPixelRatio(),this.scheme),J=this.map._requestManager.transformRequest(G,"Tile");t.neighboringTiles=this._getNeighboringTiles(t.tileID),t.abortController=new AbortController;try{const te=yield Fe.getImage(J,t.abortController,this.map._refreshExpiredTiles);if(delete t.abortController,t.aborted)return void(t.state="unloaded");if(te&&te.data){const se=te.data;this.map._refreshExpiredTiles&&(te.cacheControl||te.expires)&&t.setExpiryData({cacheControl:te.cacheControl,expires:te.expires});const de=R.b(se)&&R.W()?se:yield this.readImageNow(se),_e={type:this.type,uid:t.uid,source:this.id,rawImageData:de,encoding:this.encoding,redFactor:this.redFactor,greenFactor:this.greenFactor,blueFactor:this.blueFactor,baseShift:this.baseShift};if(!t.actor||t.state==="expired"){t.actor=this.dispatcher.getActor();const ge=yield t.actor.sendAsync({type:"LDT",data:_e});t.dem=ge,t.needsHillshadePrepare=!0,t.needsTerrainPrepare=!0,t.state="loaded"}}}catch(te){if(delete t.abortController,t.aborted)t.state="unloaded";else if(te)throw t.state="errored",te}})}readImageNow(t){return R._(this,void 0,void 0,function*(){if(typeof VideoFrame<"u"&&R.X()){const G=t.width+2,J=t.height+2;try{return new R.R({width:G,height:J},yield R.Y(t,-1,-1,G,J))}catch{}}return pe.getImageData(t,1)})}_getNeighboringTiles(t){const G=t.canonical,J=Math.pow(2,G.z),te=(G.x-1+J)%J,se=G.x===0?t.wrap-1:t.wrap,de=(G.x+1+J)%J,_e=G.x+1===J?t.wrap+1:t.wrap,ge={};return ge[new R.Z(t.overscaledZ,se,G.z,te,G.y).key]={backfilled:!1},ge[new R.Z(t.overscaledZ,_e,G.z,de,G.y).key]={backfilled:!1},G.y>0&&(ge[new R.Z(t.overscaledZ,se,G.z,te,G.y-1).key]={backfilled:!1},ge[new R.Z(t.overscaledZ,t.wrap,G.z,G.x,G.y-1).key]={backfilled:!1},ge[new R.Z(t.overscaledZ,_e,G.z,de,G.y-1).key]={backfilled:!1}),G.y+1<J&&(ge[new R.Z(t.overscaledZ,se,G.z,te,G.y+1).key]={backfilled:!1},ge[new R.Z(t.overscaledZ,t.wrap,G.z,G.x,G.y+1).key]={backfilled:!1},ge[new R.Z(t.overscaledZ,_e,G.z,de,G.y+1).key]={backfilled:!1}),ge}unloadTile(t){return R._(this,void 0,void 0,function*(){t.demTexture&&this.map.painter.saveTileTexture(t.demTexture),t.fbo&&(t.fbo.destroy(),delete t.fbo),t.dem&&delete t.dem,delete t.neighboringTiles,t.state="unloaded",t.actor&&(yield t.actor.sendAsync({type:"RDT",data:{type:this.type,uid:t.uid,source:this.id}}))})}}class Lr extends R.E{constructor(t,G,J,te){super(),this.id=t,this.type="geojson",this.minzoom=0,this.maxzoom=18,this.tileSize=512,this.isTileClipped=!0,this.reparseOverscaled=!0,this._removed=!1,this._pendingLoads=0,this.actor=J.getActor(),this.setEventedParent(te),this._data=G.data,this._options=R.e({},G),this._collectResourceTiming=G.collectResourceTiming,G.maxzoom!==void 0&&(this.maxzoom=G.maxzoom),G.type&&(this.type=G.type),G.attribution&&(this.attribution=G.attribution),this.promoteId=G.promoteId,G.clusterMaxZoom!==void 0&&this.maxzoom<=G.clusterMaxZoom&&R.w(`The maxzoom value "${this.maxzoom}" is expected to be greater than the clusterMaxZoom value "${G.clusterMaxZoom}".`),this.workerOptions=R.e({source:this.id,cluster:G.cluster||!1,geojsonVtOptions:{buffer:this._pixelsToTileUnits(G.buffer!==void 0?G.buffer:128),tolerance:this._pixelsToTileUnits(G.tolerance!==void 0?G.tolerance:.375),extent:R.$,maxZoom:this.maxzoom,lineMetrics:G.lineMetrics||!1,generateId:G.generateId||!1},superclusterOptions:{maxZoom:this._getClusterMaxZoom(G.clusterMaxZoom),minPoints:Math.max(2,G.clusterMinPoints||2),extent:R.$,radius:this._pixelsToTileUnits(G.clusterRadius||50),log:!1,generateId:G.generateId||!1},clusterProperties:G.clusterProperties,filter:G.filter},G.workerOptions),typeof this.promoteId=="string"&&(this.workerOptions.promoteId=this.promoteId)}_pixelsToTileUnits(t){return t*(R.$/this.tileSize)}_getClusterMaxZoom(t){const G=t?Math.round(t):this.maxzoom-1;return Number.isInteger(t)||t===void 0||R.w(`Integer expected for option 'clusterMaxZoom': provided value "${t}" rounded to "${G}"`),G}load(){return R._(this,void 0,void 0,function*(){yield this._updateWorkerData()})}onAdd(t){this.map=t,this.load()}setData(t){return this._data=t,this._updateWorkerData(),this}updateData(t){return this._updateWorkerData(t),this}getData(){return R._(this,void 0,void 0,function*(){const t=R.e({type:this.type},this.workerOptions);return this.actor.sendAsync({type:"GD",data:t})})}getCoordinatesFromGeometry(t){return t.type==="GeometryCollection"?t.geometries.map(G=>G.coordinates).flat(1/0):t.coordinates.flat(1/0)}getBounds(){return R._(this,void 0,void 0,function*(){const t=new wr,G=yield this.getData();let J;switch(G.type){case"FeatureCollection":J=G.features.map(te=>this.getCoordinatesFromGeometry(te.geometry)).flat(1/0);break;case"Feature":J=this.getCoordinatesFromGeometry(G.geometry);break;default:J=this.getCoordinatesFromGeometry(G)}if(J.length==0)return t;for(let te=0;te<J.length-1;te+=2)t.extend([J[te],J[te+1]]);return t})}setClusterOptions(t){return this.workerOptions.cluster=t.cluster,t&&(t.clusterRadius!==void 0&&(this.workerOptions.superclusterOptions.radius=this._pixelsToTileUnits(t.clusterRadius)),t.clusterMaxZoom!==void 0&&(this.workerOptions.superclusterOptions.maxZoom=this._getClusterMaxZoom(t.clusterMaxZoom))),this._updateWorkerData(),this}getClusterExpansionZoom(t){return this.actor.sendAsync({type:"GCEZ",data:{type:this.type,clusterId:t,source:this.id}})}getClusterChildren(t){return this.actor.sendAsync({type:"GCC",data:{type:this.type,clusterId:t,source:this.id}})}getClusterLeaves(t,G,J){return this.actor.sendAsync({type:"GCL",data:{type:this.type,source:this.id,clusterId:t,limit:G,offset:J}})}_updateWorkerData(t){return R._(this,void 0,void 0,function*(){const G=R.e({type:this.type},this.workerOptions);t?G.dataDiff=t:typeof this._data=="string"?(G.request=this.map._requestManager.transformRequest(pe.resolveURL(this._data),"Source"),G.request.collectResourceTiming=this._collectResourceTiming):G.data=JSON.stringify(this._data),this._pendingLoads++,this.fire(new R.l("dataloading",{dataType:"source"}));try{const J=yield this.actor.sendAsync({type:"LD",data:G});if(this._pendingLoads--,this._removed||J.abandoned)return void this.fire(new R.l("dataabort",{dataType:"source"}));let te=null;J.resourceTiming&&J.resourceTiming[this.id]&&(te=J.resourceTiming[this.id].slice(0));const se={dataType:"source"};this._collectResourceTiming&&te&&te.length>0&&R.e(se,{resourceTiming:te}),this.fire(new R.l("data",Object.assign(Object.assign({},se),{sourceDataType:"metadata"}))),this.fire(new R.l("data",Object.assign(Object.assign({},se),{sourceDataType:"content"})))}catch(J){if(this._pendingLoads--,this._removed)return void this.fire(new R.l("dataabort",{dataType:"source"}));this.fire(new R.k(J))}})}loaded(){return this._pendingLoads===0}loadTile(t){return R._(this,void 0,void 0,function*(){const G=t.actor?"RT":"LT";t.actor=this.actor;const J={type:this.type,uid:t.uid,tileID:t.tileID,zoom:t.tileID.overscaledZ,maxZoom:this.maxzoom,tileSize:this.tileSize,source:this.id,pixelRatio:this.map.getPixelRatio(),showCollisionBoxes:this.map.showCollisionBoxes,promoteId:this.promoteId,subdivisionGranularity:this.map.style.projection.subdivisionGranularity,globalState:this.map.getGlobalState()};t.abortController=new AbortController;const te=yield this.actor.sendAsync({type:G,data:J},t.abortController);delete t.abortController,t.unloadVectorData(),t.aborted||t.loadVectorData(te,this.map.painter,G==="RT")})}abortTile(t){return R._(this,void 0,void 0,function*(){t.abortController&&(t.abortController.abort(),delete t.abortController),t.aborted=!0})}unloadTile(t){return R._(this,void 0,void 0,function*(){t.unloadVectorData(),yield this.actor.sendAsync({type:"RMT",data:{uid:t.uid,type:this.type,source:this.id}})})}onRemove(){this._removed=!0,this.actor.sendAsync({type:"RS",data:{type:this.type,source:this.id}})}serialize(){return R.e({},this._options,{type:this.type,data:this._data})}hasTransition(){return!1}}class Br extends R.E{constructor(t,G,J,te){super(),this.flippedWindingOrder=!1,this.id=t,this.dispatcher=J,this.coordinates=G.coordinates,this.type="image",this.minzoom=0,this.maxzoom=22,this.tileSize=512,this.tiles={},this._loaded=!1,this.setEventedParent(te),this.options=G}load(t){return R._(this,void 0,void 0,function*(){this._loaded=!1,this.fire(new R.l("dataloading",{dataType:"source"})),this.url=this.options.url,this._request=new AbortController;try{const G=yield Fe.getImage(this.map._requestManager.transformRequest(this.url,"Image"),this._request);this._request=null,this._loaded=!0,G&&G.data&&(this.image=G.data,t&&(this.coordinates=t),this._finishLoading())}catch(G){this._request=null,this._loaded=!0,this.fire(new R.k(G))}})}loaded(){return this._loaded}updateImage(t){return t.url?(this._request&&(this._request.abort(),this._request=null),this.options.url=t.url,this.load(t.coordinates).finally(()=>{this.texture=null}),this):this}_finishLoading(){this.map&&(this.setCoordinates(this.coordinates),this.fire(new R.l("data",{dataType:"source",sourceDataType:"metadata"})))}onAdd(t){this.map=t,this.load()}onRemove(){this._request&&(this._request.abort(),this._request=null)}setCoordinates(t){this.coordinates=t;const G=t.map(R.a0.fromLngLat);var J;return this.tileID=function(te){const se=R.a1.fromPoints(te),de=se.width(),_e=se.height(),ge=Math.max(de,_e),xe=Math.max(0,Math.floor(-Math.log(ge)/Math.LN2)),Se=Math.pow(2,xe);return new R.a3(xe,Math.floor((se.minX+se.maxX)/2*Se),Math.floor((se.minY+se.maxY)/2*Se))}(G),this.terrainTileRanges=this._getOverlappingTileRanges(G),this.minzoom=this.maxzoom=this.tileID.z,this.tileCoords=G.map(te=>this.tileID.getTilePoint(te)._round()),this.flippedWindingOrder=((J=this.tileCoords)[1].x-J[0].x)*(J[2].y-J[0].y)-(J[1].y-J[0].y)*(J[2].x-J[0].x)<0,this.fire(new R.l("data",{dataType:"source",sourceDataType:"content"})),this}prepare(){if(Object.keys(this.tiles).length===0||!this.image)return;const t=this.map.painter.context,G=t.gl;this.texture||(this.texture=new R.T(t,this.image,G.RGBA),this.texture.bind(G.LINEAR,G.CLAMP_TO_EDGE));let J=!1;for(const te in this.tiles){const se=this.tiles[te];se.state!=="loaded"&&(se.state="loaded",se.texture=this.texture,J=!0)}J&&this.fire(new R.l("data",{dataType:"source",sourceDataType:"idle",sourceId:this.id}))}loadTile(t){return R._(this,void 0,void 0,function*(){this.tileID&&this.tileID.equals(t.tileID.canonical)?(this.tiles[String(t.tileID.wrap)]=t,t.buckets={}):t.state="errored"})}serialize(){return{type:"image",url:this.options.url,coordinates:this.coordinates}}hasTransition(){return!1}_getOverlappingTileRanges(t){const{minX:G,minY:J,maxX:te,maxY:se}=R.a1.fromPoints(t),de={};for(let _e=0;_e<=R.a2;_e++){const ge=Math.pow(2,_e),xe=Math.floor(G*ge),Se=Math.floor(J*ge),Oe=Math.floor(te*ge),Ae=Math.floor(se*ge);de[_e]={minTileX:xe,minTileY:Se,maxTileX:Oe,maxTileY:Ae}}return de}}class zr extends Br{constructor(t,G,J,te){super(t,G,J,te),this.roundZoom=!0,this.type="video",this.options=G}load(){return R._(this,void 0,void 0,function*(){this._loaded=!1;const t=this.options;this.urls=[];for(const G of t.urls)this.urls.push(this.map._requestManager.transformRequest(G,"Source").url);try{const G=yield R.a4(this.urls);if(this._loaded=!0,!G)return;this.video=G,this.video.loop=!0,this.video.addEventListener("playing",()=>{this.map.triggerRepaint()}),this.map&&this.video.play(),this._finishLoading()}catch(G){this.fire(new R.k(G))}})}pause(){this.video&&this.video.pause()}play(){this.video&&this.video.play()}seek(t){if(this.video){const G=this.video.seekable;t<G.start(0)||t>G.end(0)?this.fire(new R.k(new R.a5(`sources.${this.id}`,null,`Playback for this video can be set only between the ${G.start(0)} and ${G.end(0)}-second mark.`))):this.video.currentTime=t}}getVideo(){return this.video}onAdd(t){this.map||(this.map=t,this.load(),this.video&&(this.video.play(),this.setCoordinates(this.coordinates)))}prepare(){if(Object.keys(this.tiles).length===0||this.video.readyState<2)return;const t=this.map.painter.context,G=t.gl;this.texture?this.video.paused||(this.texture.bind(G.LINEAR,G.CLAMP_TO_EDGE),G.texSubImage2D(G.TEXTURE_2D,0,0,0,G.RGBA,G.UNSIGNED_BYTE,this.video)):(this.texture=new R.T(t,this.video,G.RGBA),this.texture.bind(G.LINEAR,G.CLAMP_TO_EDGE));let J=!1;for(const te in this.tiles){const se=this.tiles[te];se.state!=="loaded"&&(se.state="loaded",se.texture=this.texture,J=!0)}J&&this.fire(new R.l("data",{dataType:"source",sourceDataType:"idle",sourceId:this.id}))}serialize(){return{type:"video",urls:this.urls,coordinates:this.coordinates}}hasTransition(){return this.video&&!this.video.paused}}class rr extends Br{constructor(t,G,J,te){super(t,G,J,te),G.coordinates?Array.isArray(G.coordinates)&&G.coordinates.length===4&&!G.coordinates.some(se=>!Array.isArray(se)||se.length!==2||se.some(de=>typeof de!="number"))||this.fire(new R.k(new R.a5(`sources.${t}`,null,'"coordinates" property must be an array of 4 longitude/latitude array pairs'))):this.fire(new R.k(new R.a5(`sources.${t}`,null,'missing required property "coordinates"'))),G.animate&&typeof G.animate!="boolean"&&this.fire(new R.k(new R.a5(`sources.${t}`,null,'optional "animate" property must be a boolean value'))),G.canvas?typeof G.canvas=="string"||G.canvas instanceof HTMLCanvasElement||this.fire(new R.k(new R.a5(`sources.${t}`,null,'"canvas" must be either a string representing the ID of the canvas element from which to read, or an HTMLCanvasElement instance'))):this.fire(new R.k(new R.a5(`sources.${t}`,null,'missing required property "canvas"'))),this.options=G,this.animate=G.animate===void 0||G.animate}load(){return R._(this,void 0,void 0,function*(){this._loaded=!0,this.canvas||(this.canvas=this.options.canvas instanceof HTMLCanvasElement?this.options.canvas:document.getElementById(this.options.canvas)),this.width=this.canvas.width,this.height=this.canvas.height,this._hasInvalidDimensions()?this.fire(new R.k(new Error("Canvas dimensions cannot be less than or equal to zero."))):(this.play=function(){this._playing=!0,this.map.triggerRepaint()},this.pause=function(){this._playing&&(this.prepare(),this._playing=!1)},this._finishLoading())})}getCanvas(){return this.canvas}onAdd(t){this.map=t,this.load(),this.canvas&&this.animate&&this.play()}onRemove(){this.pause()}prepare(){let t=!1;if(this.canvas.width!==this.width&&(this.width=this.canvas.width,t=!0),this.canvas.height!==this.height&&(this.height=this.canvas.height,t=!0),this._hasInvalidDimensions()||Object.keys(this.tiles).length===0)return;const G=this.map.painter.context,J=G.gl;this.texture?(t||this._playing)&&this.texture.update(this.canvas,{premultiply:!0}):this.texture=new R.T(G,this.canvas,J.RGBA,{premultiply:!0});let te=!1;for(const se in this.tiles){const de=this.tiles[se];de.state!=="loaded"&&(de.state="loaded",de.texture=this.texture,te=!0)}te&&this.fire(new R.l("data",{dataType:"source",sourceDataType:"idle",sourceId:this.id}))}serialize(){return{type:"canvas",coordinates:this.coordinates}}hasTransition(){return this._playing}_hasInvalidDimensions(){for(const t of[this.canvas.width,this.canvas.height])if(isNaN(t)||t<=0)return!0;return!1}}const sr={},Dr=oe=>{switch(oe){case"geojson":return Lr;case"image":return Br;case"raster":return Hr;case"raster-dem":return br;case"vector":return Kr;case"video":return zr;case"canvas":return rr}return sr[oe]},lr="RTLPluginLoaded";class yr extends R.E{constructor(){super(...arguments),this.status="unavailable",this.url=null,this.dispatcher=Sr()}_syncState(t){return this.status=t,this.dispatcher.broadcast("SRPS",{pluginStatus:t,pluginURL:this.url}).catch(G=>{throw this.status="error",G})}getRTLTextPluginStatus(){return this.status}clearRTLTextPlugin(){this.status="unavailable",this.url=null}setRTLTextPlugin(t){return R._(this,arguments,void 0,function*(G,J=!1){if(this.url)throw new Error("setRTLTextPlugin cannot be called multiple times.");if(this.url=pe.resolveURL(G),!this.url)throw new Error(`requested url ${G} is invalid`);if(this.status==="unavailable"){if(!J)return this._requestImport();this.status="deferred",this._syncState(this.status)}else if(this.status==="requested")return this._requestImport()})}_requestImport(){return R._(this,void 0,void 0,function*(){yield this._syncState("loading"),this.status="loaded",this.fire(new R.l(lr))})}lazyLoad(){this.status==="unavailable"?this.status="requested":this.status==="deferred"&&this._requestImport()}}let xr=null;function Ge(){return xr||(xr=new yr),xr}class Ee{constructor(t,G){this.timeAdded=0,this.fadeEndTime=0,this.tileID=t,this.uid=R.a6(),this.uses=0,this.tileSize=G,this.buckets={},this.expirationTime=null,this.queryPadding=0,this.hasSymbolBuckets=!1,this.hasRTLText=!1,this.dependencies={},this.rtt=[],this.rttCoords={},this.expiredRequestCount=0,this.state="loading"}registerFadeDuration(t){const G=t+this.timeAdded;G<this.fadeEndTime||(this.fadeEndTime=G)}wasRequested(){return this.state==="errored"||this.state==="loaded"||this.state==="reloading"}clearTextures(t){this.demTexture&&t.saveTileTexture(this.demTexture),this.demTexture=null}loadVectorData(t,G,J){if(this.hasData()&&this.unloadVectorData(),this.state="loaded",t){t.featureIndex&&(this.latestFeatureIndex=t.featureIndex,t.rawTileData?(this.latestRawTileData=t.rawTileData,this.latestFeatureIndex.rawTileData=t.rawTileData):this.latestRawTileData&&(this.latestFeatureIndex.rawTileData=this.latestRawTileData)),this.collisionBoxArray=t.collisionBoxArray,this.buckets=function(te,se){const de={};if(!se)return de;for(const _e of te){const ge=_e.layerIds.map(xe=>se.getLayer(xe)).filter(Boolean);if(ge.length!==0){_e.layers=ge,_e.stateDependentLayerIds&&(_e.stateDependentLayers=_e.stateDependentLayerIds.map(xe=>ge.filter(Se=>Se.id===xe)[0]));for(const xe of ge)de[xe.id]=_e}}return de}(t.buckets,G==null?void 0:G.style),this.hasSymbolBuckets=!1;for(const te in this.buckets){const se=this.buckets[te];if(se instanceof R.a8){if(this.hasSymbolBuckets=!0,!J)break;se.justReloaded=!0}}if(this.hasRTLText=!1,this.hasSymbolBuckets)for(const te in this.buckets){const se=this.buckets[te];if(se instanceof R.a8&&se.hasRTLText){this.hasRTLText=!0,Ge().lazyLoad();break}}this.queryPadding=0;for(const te in this.buckets){const se=this.buckets[te];this.queryPadding=Math.max(this.queryPadding,G.style.getLayer(te).queryRadius(se))}t.imageAtlas&&(this.imageAtlas=t.imageAtlas),t.glyphAtlasImage&&(this.glyphAtlasImage=t.glyphAtlasImage)}else this.collisionBoxArray=new R.a7}unloadVectorData(){for(const t in this.buckets)this.buckets[t].destroy();this.buckets={},this.imageAtlasTexture&&this.imageAtlasTexture.destroy(),this.imageAtlas&&(this.imageAtlas=null),this.glyphAtlasTexture&&this.glyphAtlasTexture.destroy(),this.latestFeatureIndex=null,this.state="unloaded"}getBucket(t){return this.buckets[t.id]}upload(t){for(const J in this.buckets){const te=this.buckets[J];te.uploadPending()&&te.upload(t)}const G=t.gl;this.imageAtlas&&!this.imageAtlas.uploaded&&(this.imageAtlasTexture=new R.T(t,this.imageAtlas.image,G.RGBA),this.imageAtlas.uploaded=!0),this.glyphAtlasImage&&(this.glyphAtlasTexture=new R.T(t,this.glyphAtlasImage,G.ALPHA),this.glyphAtlasImage=null)}prepare(t){this.imageAtlas&&this.imageAtlas.patchUpdatedImages(t,this.imageAtlasTexture)}queryRenderedFeatures(t,G,J,te,se,de,_e,ge,xe,Se,Oe){return this.latestFeatureIndex&&this.latestFeatureIndex.rawTileData?this.latestFeatureIndex.query({queryGeometry:te,cameraQueryGeometry:se,scale:de,tileSize:this.tileSize,pixelPosMatrix:Se,transform:ge,params:_e,queryPadding:this.queryPadding*xe,getElevation:Oe},t,G,J):{}}querySourceFeatures(t,G){const J=this.latestFeatureIndex;if(!J||!J.rawTileData)return;const te=J.loadVTLayers(),se=G&&G.sourceLayer?G.sourceLayer:"",de=te._geojsonTileLayer||te[se];if(!de)return;const _e=R.a9(G&&G.filter),{z:ge,x:xe,y:Se}=this.tileID.canonical,Oe={z:ge,x:xe,y:Se};for(let Ae=0;Ae<de.length;Ae++){const je=de.feature(Ae);if(_e.needGeometry){const nt=R.aa(je,!0);if(!_e.filter(new R.F(this.tileID.overscaledZ),nt,this.tileID.canonical))continue}else if(!_e.filter(new R.F(this.tileID.overscaledZ),je))continue;const Ye=J.getId(je,se),at=new R.ab(je,ge,xe,Se,Ye);at.tile=Oe,t.push(at)}}hasData(){return this.state==="loaded"||this.state==="reloading"||this.state==="expired"}patternsLoaded(){return this.imageAtlas&&!!Object.keys(this.imageAtlas.patternPositions).length}setExpiryData(t){const G=this.expirationTime;if(t.cacheControl){const J=R.ac(t.cacheControl);J["max-age"]&&(this.expirationTime=Date.now()+1e3*J["max-age"])}else t.expires&&(this.expirationTime=new Date(t.expires).getTime());if(this.expirationTime){const J=Date.now();let te=!1;if(this.expirationTime>J)te=!1;else if(G)if(this.expirationTime<G)te=!0;else{const se=this.expirationTime-G;se?this.expirationTime=J+Math.max(se,3e4):te=!0}else te=!0;te?(this.expiredRequestCount++,this.state="expired"):this.expiredRequestCount=0}}getExpiryTimeout(){if(this.expirationTime)return this.expiredRequestCount?1e3*(1<<Math.min(this.expiredRequestCount-1,31)):Math.min(this.expirationTime-new Date().getTime(),Math.pow(2,31)-1)}setFeatureState(t,G){if(!this.latestFeatureIndex||!this.latestFeatureIndex.rawTileData||Object.keys(t).length===0)return;const J=this.latestFeatureIndex.loadVTLayers();for(const te in this.buckets){if(!G.style.hasLayer(te))continue;const se=this.buckets[te],de=se.layers[0].sourceLayer||"_geojsonTileLayer",_e=J[de],ge=t[de];if(!_e||!ge||Object.keys(ge).length===0)continue;se.update(ge,_e,this.imageAtlas&&this.imageAtlas.patternPositions||{});const xe=G&&G.style&&G.style.getLayer(te);xe&&(this.queryPadding=Math.max(this.queryPadding,xe.queryRadius(se)))}}holdingForFade(){return this.symbolFadeHoldUntil!==void 0}symbolFadeFinished(){return!this.symbolFadeHoldUntil||this.symbolFadeHoldUntil<pe.now()}clearFadeHold(){this.symbolFadeHoldUntil=void 0}setHoldDuration(t){this.symbolFadeHoldUntil=pe.now()+t}setDependencies(t,G){const J={};for(const te of G)J[te]=!0;this.dependencies[t]=J}hasDependency(t,G){for(const J of t){const te=this.dependencies[J];if(te){for(const se of G)if(te[se])return!0}}return!1}}class Pe{constructor(t,G){this.max=t,this.onRemove=G,this.reset()}reset(){for(const t in this.data)for(const G of this.data[t])G.timeout&&clearTimeout(G.timeout),this.onRemove(G.value);return this.data={},this.order=[],this}add(t,G,J){const te=t.wrapped().key;this.data[te]===void 0&&(this.data[te]=[]);const se={value:G,timeout:void 0};if(J!==void 0&&(se.timeout=setTimeout(()=>{this.remove(t,se)},J)),this.data[te].push(se),this.order.push(te),this.order.length>this.max){const de=this._getAndRemoveByKey(this.order[0]);de&&this.onRemove(de)}return this}has(t){return t.wrapped().key in this.data}getAndRemove(t){return this.has(t)?this._getAndRemoveByKey(t.wrapped().key):null}_getAndRemoveByKey(t){const G=this.data[t].shift();return G.timeout&&clearTimeout(G.timeout),this.data[t].length===0&&delete this.data[t],this.order.splice(this.order.indexOf(t),1),G.value}getByKey(t){const G=this.data[t];return G?G[0].value:null}get(t){return this.has(t)?this.data[t.wrapped().key][0].value:null}remove(t,G){if(!this.has(t))return this;const J=t.wrapped().key,te=G===void 0?0:this.data[J].indexOf(G),se=this.data[J][te];return this.data[J].splice(te,1),se.timeout&&clearTimeout(se.timeout),this.data[J].length===0&&delete this.data[J],this.onRemove(se.value),this.order.splice(this.order.indexOf(J),1),this}setMaxSize(t){for(this.max=t;this.order.length>this.max;){const G=this._getAndRemoveByKey(this.order[0]);G&&this.onRemove(G)}return this}filter(t){const G=[];for(const J in this.data)for(const te of this.data[J])t(te.value)||G.push(te);for(const J of G)this.remove(J.value.tileID,J)}}class He{constructor(){this.state={},this.stateChanges={},this.deletedStates={}}updateState(t,G,J){const te=String(G);if(this.stateChanges[t]=this.stateChanges[t]||{},this.stateChanges[t][te]=this.stateChanges[t][te]||{},R.e(this.stateChanges[t][te],J),this.deletedStates[t]===null){this.deletedStates[t]={};for(const se in this.state[t])se!==te&&(this.deletedStates[t][se]=null)}else if(this.deletedStates[t]&&this.deletedStates[t][te]===null){this.deletedStates[t][te]={};for(const se in this.state[t][te])J[se]||(this.deletedStates[t][te][se]=null)}else for(const se in J)this.deletedStates[t]&&this.deletedStates[t][te]&&this.deletedStates[t][te][se]===null&&delete this.deletedStates[t][te][se]}removeFeatureState(t,G,J){if(this.deletedStates[t]===null)return;const te=String(G);if(this.deletedStates[t]=this.deletedStates[t]||{},J&&G!==void 0)this.deletedStates[t][te]!==null&&(this.deletedStates[t][te]=this.deletedStates[t][te]||{},this.deletedStates[t][te][J]=null);else if(G!==void 0)if(this.stateChanges[t]&&this.stateChanges[t][te])for(J in this.deletedStates[t][te]={},this.stateChanges[t][te])this.deletedStates[t][te][J]=null;else this.deletedStates[t][te]=null;else this.deletedStates[t]=null}getState(t,G){const J=String(G),te=R.e({},(this.state[t]||{})[J],(this.stateChanges[t]||{})[J]);if(this.deletedStates[t]===null)return{};if(this.deletedStates[t]){const se=this.deletedStates[t][G];if(se===null)return{};for(const de in se)delete te[de]}return te}initializeTileState(t,G){t.setFeatureState(this.state,G)}coalesceChanges(t,G){const J={};for(const te in this.stateChanges){this.state[te]=this.state[te]||{};const se={};for(const de in this.stateChanges[te])this.state[te][de]||(this.state[te][de]={}),R.e(this.state[te][de],this.stateChanges[te][de]),se[de]=this.state[te][de];J[te]=se}for(const te in this.deletedStates){this.state[te]=this.state[te]||{};const se={};if(this.deletedStates[te]===null)for(const de in this.state[te])se[de]={},this.state[te][de]={};else for(const de in this.deletedStates[te]){if(this.deletedStates[te][de]===null)this.state[te][de]={};else for(const _e of Object.keys(this.deletedStates[te][de]))delete this.state[te][de][_e];se[de]=this.state[te][de]}J[te]=J[te]||{},R.e(J[te],se)}if(this.stateChanges={},this.deletedStates={},Object.keys(J).length!==0)for(const te in t)t[te].setFeatureState(J,G)}}const ut=89.25;function Ve(oe,t){const G=R.ag(t.lat,-R.ah,R.ah);return new R.P(R.V(t.lng)*oe,R.U(G)*oe)}function qe(oe,t){return new R.a0(t.x/oe,t.y/oe).toLngLat()}function De(oe){return oe.cameraToCenterDistance*Math.min(.85*Math.tan(R.ad(90-oe.pitch)),Math.tan(R.ad(ut-oe.pitch)))}function ze(oe,t){const G=oe.canonical,J=t/R.ae(G.z),te=G.x+Math.pow(2,G.z)*oe.wrap,se=R.af(new Float64Array(16));return R.M(se,se,[te*J,G.y*J,0]),R.N(se,se,[J/R.$,J/R.$,1]),se}function Le(oe,t,G,J,te){const se=R.a0.fromLngLat(oe,t),de=te*R.ai(1,oe.lat),_e=de*Math.cos(R.ad(G)),ge=Math.sqrt(de*de-_e*_e),xe=ge*Math.sin(R.ad(-J)),Se=ge*Math.cos(R.ad(-J));return new R.a0(se.x+xe,se.y+Se,se.z+_e)}function Ke(oe,t,G){const J=t.intersectsFrustum(oe);if(!G||J===0)return J;const te=t.intersectsPlane(G);return te===0?0:J===2&&te===2?2:1}function et(oe,t,G){let J=0;const te=(G-t)/10;for(let se=0;se<10;se++)J+=te*Math.pow(Math.cos(t+(se+.5)/10*(G-t)),oe);return J}function _t(oe,t){return function(G,J,te,se,de){const _e=2*((oe-1)/R.aj(Math.cos(R.ad(ut-de))/Math.cos(R.ad(ut)))-1),ge=Math.acos(te/se),xe=2*et(_e-1,0,R.ad(de/2)),Se=Math.min(R.ad(ut),ge+R.ad(de/2)),Oe=et(_e-1,Math.min(Se,ge-R.ad(de/2)),Se),Ae=Math.atan(J/te),je=Math.hypot(J,te);let Ye=G;return Ye+=R.aj(se/je/Math.max(.5,Math.cos(R.ad(de/2)))),Ye+=_e*R.aj(Math.cos(Ae))/2,Ye-=R.aj(Math.max(1,Oe/xe/t))/2,Ye}}const st=_t(9.314,3);function bt(oe,t){const G=(t.roundZoom?Math.round:Math.floor)(oe.zoom+R.aj(oe.tileSize/t.tileSize));return Math.max(0,G)}function Mt(oe,t){const G=oe.getCameraFrustum(),J=oe.getClippingPlane(),te=oe.screenPointToMercatorCoordinate(oe.getCameraPoint()),se=R.a0.fromLngLat(oe.center,oe.elevation);te.z=se.z+Math.cos(oe.pitchInRadians)*oe.cameraToCenterDistance/oe.worldSize;const de=oe.getCoveringTilesDetailsProvider(),_e=de.allowVariableZoom(oe,t),ge=bt(oe,t),xe=t.minzoom||0,Se=t.maxzoom!==void 0?t.maxzoom:oe.maxZoom,Oe=Math.min(Math.max(0,ge),Se),Ae=Math.pow(2,Oe),je=[Ae*te.x,Ae*te.y,0],Ye=[Ae*se.x,Ae*se.y,0],at=Math.hypot(se.x-te.x,se.y-te.y),nt=Math.abs(se.z-te.z),ot=Math.hypot(at,nt),ht=Tt=>({zoom:0,x:0,y:0,wrap:Tt,fullyVisible:!1}),xt=[],mt=[];if(oe.renderWorldCopies&&de.allowWorldCopies())for(let Tt=1;Tt<=3;Tt++)xt.push(ht(-Tt)),xt.push(ht(Tt));for(xt.push(ht(0));xt.length>0;){const Tt=xt.pop(),Pt=Tt.x,vt=Tt.y;let kt=Tt.fullyVisible;const Vt={x:Pt,y:vt,z:Tt.zoom},jt=de.getTileBoundingVolume(Vt,Tt.wrap,oe.elevation,t);if(!kt){const _r=Ke(G,jt,J);if(_r===0)continue;kt=_r===2}const zt=de.distanceToTile2d(te.x,te.y,Vt,jt);let $t=ge;_e&&($t=(t.calculateTileZoom||st)(oe.zoom+R.aj(oe.tileSize/t.tileSize),zt,nt,ot,oe.fov)),$t=(t.roundZoom?Math.round:Math.floor)($t),$t=Math.max(0,$t);const mr=Math.min($t,Se);if(Tt.wrap=de.getWrap(se,Vt,Tt.wrap),Tt.zoom>=mr){if(Tt.zoom<xe)continue;const _r=Oe-Tt.zoom,er=je[0]-.5-(Pt<<_r),Ar=je[1]-.5-(vt<<_r),ti=t.reparseOverscaled?Math.max(Tt.zoom,$t):Tt.zoom;mt.push({tileID:new R.Z(Tt.zoom===Se?ti:Tt.zoom,Tt.wrap,Tt.zoom,Pt,vt),distanceSq:R.ak([Ye[0]-.5-Pt,Ye[1]-.5-vt]),tileDistanceToCamera:Math.sqrt(er*er+Ar*Ar)})}else for(let _r=0;_r<4;_r++)xt.push({zoom:Tt.zoom+1,x:(Pt<<1)+_r%2,y:(vt<<1)+(_r>>1),wrap:Tt.wrap,fullyVisible:kt})}return mt.sort((Tt,Pt)=>Tt.distanceSq-Pt.distanceSq).map(Tt=>Tt.tileID)}const Ot=R.a1.fromPoints([new R.P(0,0),new R.P(R.$,R.$)]);class Nt extends R.E{constructor(t,G,J){super(),this.id=t,this.dispatcher=J,this.on("data",te=>this._dataHandler(te)),this.on("dataloading",()=>{this._sourceErrored=!1}),this.on("error",()=>{this._sourceErrored=this._source.loaded()}),this._source=((te,se,de,_e)=>{const ge=new(Dr(se.type))(te,se,de,_e);if(ge.id!==te)throw new Error(`Expected Source id to be ${te} instead of ${ge.id}`);return ge})(t,G,J,this),this._tiles={},this._cache=new Pe(0,te=>this._unloadTile(te)),this._timers={},this._cacheTimers={},this._maxTileCacheSize=null,this._maxTileCacheZoomLevels=null,this._loadedParentTiles={},this._coveredTiles={},this._state=new He,this._didEmitContent=!1,this._updated=!1}onAdd(t){this.map=t,this._maxTileCacheSize=t?t._maxTileCacheSize:null,this._maxTileCacheZoomLevels=t?t._maxTileCacheZoomLevels:null,this._source&&this._source.onAdd&&this._source.onAdd(t)}onRemove(t){this.clearTiles(),this._source&&this._source.onRemove&&this._source.onRemove(t)}loaded(){if(this._sourceErrored)return!0;if(!this._sourceLoaded||!this._source.loaded())return!1;if(!(this.used===void 0&&this.usedForTerrain===void 0||this.used||this.usedForTerrain))return!0;if(!this._updated)return!1;for(const t in this._tiles){const G=this._tiles[t];if(G.state!=="loaded"&&G.state!=="errored")return!1}return!0}getSource(){return this._source}pause(){this._paused=!0}resume(){if(!this._paused)return;const t=this._shouldReloadOnResume;this._paused=!1,this._shouldReloadOnResume=!1,t&&this.reload(),this.transform&&this.update(this.transform,this.terrain)}_loadTile(t,G,J){return R._(this,void 0,void 0,function*(){try{yield this._source.loadTile(t),this._tileLoaded(t,G,J)}catch(te){t.state="errored",te.status!==404?this._source.fire(new R.k(te,{tile:t})):this.update(this.transform,this.terrain)}})}_unloadTile(t){this._source.unloadTile&&this._source.unloadTile(t)}_abortTile(t){this._source.abortTile&&this._source.abortTile(t),this._source.fire(new R.l("dataabort",{tile:t,coord:t.tileID,dataType:"source"}))}serialize(){return this._source.serialize()}prepare(t){this._source.prepare&&this._source.prepare(),this._state.coalesceChanges(this._tiles,this.map?this.map.painter:null);for(const G in this._tiles){const J=this._tiles[G];J.upload(t),J.prepare(this.map.style.imageManager)}}getIds(){return Object.values(this._tiles).map(t=>t.tileID).sort(St).map(t=>t.key)}getRenderableIds(t){const G=[];for(const J in this._tiles)this._isIdRenderable(J,t)&&G.push(this._tiles[J]);return t?G.sort((J,te)=>{const se=J.tileID,de=te.tileID,_e=new R.P(se.canonical.x,se.canonical.y)._rotate(-this.transform.bearingInRadians),ge=new R.P(de.canonical.x,de.canonical.y)._rotate(-this.transform.bearingInRadians);return se.overscaledZ-de.overscaledZ||ge.y-_e.y||ge.x-_e.x}).map(J=>J.tileID.key):G.map(J=>J.tileID).sort(St).map(J=>J.key)}hasRenderableParent(t){const G=this.findLoadedParent(t,0);return!!G&&this._isIdRenderable(G.tileID.key)}_isIdRenderable(t,G){return this._tiles[t]&&this._tiles[t].hasData()&&!this._coveredTiles[t]&&(G||!this._tiles[t].holdingForFade())}reload(t){if(this._paused)this._shouldReloadOnResume=!0;else{this._cache.reset();for(const G in this._tiles)t?this._reloadTile(G,"expired"):this._tiles[G].state!=="errored"&&this._reloadTile(G,"reloading")}}_reloadTile(t,G){return R._(this,void 0,void 0,function*(){const J=this._tiles[t];J&&(J.state!=="loading"&&(J.state=G),yield this._loadTile(J,t,G))})}_tileLoaded(t,G,J){t.timeAdded=pe.now(),J==="expired"&&(t.refreshedUponExpiration=!0),this._setTileReloadTimer(G,t),this.getSource().type==="raster-dem"&&t.dem&&this._backfillDEM(t),this._state.initializeTileState(t,this.map?this.map.painter:null),t.aborted||this._source.fire(new R.l("data",{dataType:"source",tile:t,coord:t.tileID}))}_backfillDEM(t){const G=this.getRenderableIds();for(let te=0;te<G.length;te++){const se=G[te];if(t.neighboringTiles&&t.neighboringTiles[se]){const de=this.getTileByID(se);J(t,de),J(de,t)}}function J(te,se){te.needsHillshadePrepare=!0,te.needsTerrainPrepare=!0;let de=se.tileID.canonical.x-te.tileID.canonical.x;const _e=se.tileID.canonical.y-te.tileID.canonical.y,ge=Math.pow(2,te.tileID.canonical.z),xe=se.tileID.key;de===0&&_e===0||Math.abs(_e)>1||(Math.abs(de)>1&&(Math.abs(de+ge)===1?de+=ge:Math.abs(de-ge)===1&&(de-=ge)),se.dem&&te.dem&&(te.dem.backfillBorder(se.dem,de,_e),te.neighboringTiles&&te.neighboringTiles[xe]&&(te.neighboringTiles[xe].backfilled=!0)))}}getTile(t){return this.getTileByID(t.key)}getTileByID(t){return this._tiles[t]}_retainLoadedChildren(t,G,J,te){for(const se in this._tiles){let de=this._tiles[se];if(te[se]||!de.hasData()||de.tileID.overscaledZ<=G||de.tileID.overscaledZ>J)continue;let _e=de.tileID;for(;de&&de.tileID.overscaledZ>G+1;){const xe=de.tileID.scaledTo(de.tileID.overscaledZ-1);de=this._tiles[xe.key],de&&de.hasData()&&(_e=xe)}let ge=_e;for(;ge.overscaledZ>G;)if(ge=ge.scaledTo(ge.overscaledZ-1),t[ge.key]||t[ge.canonical.key]){te[_e.key]=_e;break}}}findLoadedParent(t,G){if(t.key in this._loadedParentTiles){const J=this._loadedParentTiles[t.key];return J&&J.tileID.overscaledZ>=G?J:null}for(let J=t.overscaledZ-1;J>=G;J--){const te=t.scaledTo(J),se=this._getLoadedTile(te);if(se)return se}}findLoadedSibling(t){return this._getLoadedTile(t)}_getLoadedTile(t){const G=this._tiles[t.key];return G&&G.hasData()?G:this._cache.getByKey(t.wrapped().key)}updateCacheSize(t){const G=Math.ceil(t.width/this._source.tileSize)+1,J=Math.ceil(t.height/this._source.tileSize)+1,te=Math.floor(G*J*(this._maxTileCacheZoomLevels===null?R.a.MAX_TILE_CACHE_ZOOM_LEVELS:this._maxTileCacheZoomLevels)),se=typeof this._maxTileCacheSize=="number"?Math.min(this._maxTileCacheSize,te):te;this._cache.setMaxSize(se)}handleWrapJump(t){const G=Math.round((t-(this._prevLng===void 0?t:this._prevLng))/360);if(this._prevLng=t,G){const J={};for(const te in this._tiles){const se=this._tiles[te];se.tileID=se.tileID.unwrapTo(se.tileID.wrap+G),J[se.tileID.key]=se}this._tiles=J;for(const te in this._timers)clearTimeout(this._timers[te]),delete this._timers[te];for(const te in this._tiles)this._setTileReloadTimer(te,this._tiles[te])}}_updateCoveredAndRetainedTiles(t,G,J,te,se,de){const _e={},ge={},xe=Object.keys(t),Se=pe.now();for(const Oe of xe){const Ae=t[Oe],je=this._tiles[Oe];if(!je||je.fadeEndTime!==0&&je.fadeEndTime<=Se)continue;const Ye=this.findLoadedParent(Ae,G),at=this.findLoadedSibling(Ae),nt=Ye||at||null;nt&&(this._addTile(nt.tileID),_e[nt.tileID.key]=nt.tileID),ge[Oe]=Ae}this._retainLoadedChildren(ge,te,J,t);for(const Oe in _e)t[Oe]||(this._coveredTiles[Oe]=!0,t[Oe]=_e[Oe]);if(de){const Oe={},Ae={};for(const je of se)this._tiles[je.key].hasData()?Oe[je.key]=je:Ae[je.key]=je;for(const je in Ae){const Ye=Ae[je].children(this._source.maxzoom);this._tiles[Ye[0].key]&&this._tiles[Ye[1].key]&&this._tiles[Ye[2].key]&&this._tiles[Ye[3].key]&&(Oe[Ye[0].key]=t[Ye[0].key]=Ye[0],Oe[Ye[1].key]=t[Ye[1].key]=Ye[1],Oe[Ye[2].key]=t[Ye[2].key]=Ye[2],Oe[Ye[3].key]=t[Ye[3].key]=Ye[3],delete Ae[je])}for(const je in Ae){const Ye=Ae[je],at=this.findLoadedParent(Ye,this._source.minzoom),nt=this.findLoadedSibling(Ye),ot=at||nt||null;if(ot){Oe[ot.tileID.key]=t[ot.tileID.key]=ot.tileID;for(const ht in Oe)Oe[ht].isChildOf(ot.tileID)&&delete Oe[ht]}}for(const je in this._tiles)Oe[je]||(this._coveredTiles[je]=!0)}}update(t,G){if(!this._sourceLoaded||this._paused)return;let J;this.transform=t,this.terrain=G,this.updateCacheSize(t),this.handleWrapJump(this.transform.center.lng),this._coveredTiles={},this.used||this.usedForTerrain?this._source.tileID?J=t.getVisibleUnwrappedCoordinates(this._source.tileID).map(Se=>new R.Z(Se.canonical.z,Se.wrap,Se.canonical.z,Se.canonical.x,Se.canonical.y)):(J=Mt(t,{tileSize:this.usedForTerrain?this.tileSize:this._source.tileSize,minzoom:this._source.minzoom,maxzoom:this._source.maxzoom,roundZoom:!this.usedForTerrain&&this._source.roundZoom,reparseOverscaled:this._source.reparseOverscaled,terrain:G,calculateTileZoom:this._source.calculateTileZoom}),this._source.hasTile&&(J=J.filter(Se=>this._source.hasTile(Se)))):J=[];const te=bt(t,this._source),se=Math.max(te-Nt.maxOverzooming,this._source.minzoom),de=Math.max(te+Nt.maxUnderzooming,this._source.minzoom);if(this.usedForTerrain){const Se={};for(const Oe of J)if(Oe.canonical.z>this._source.minzoom){const Ae=Oe.scaledTo(Oe.canonical.z-1);Se[Ae.key]=Ae;const je=Oe.scaledTo(Math.max(this._source.minzoom,Math.min(Oe.canonical.z,5)));Se[je.key]=je}J=J.concat(Object.values(Se))}const _e=J.length===0&&!this._updated&&this._didEmitContent;this._updated=!0,_e&&this.fire(new R.l("data",{sourceDataType:"idle",dataType:"source",sourceId:this.id}));const ge=this._updateRetainedTiles(J,te);ar(this._source.type)&&this._updateCoveredAndRetainedTiles(ge,se,de,te,J,G);for(const Se in ge)this._tiles[Se].clearFadeHold();const xe=R.al(this._tiles,ge);for(const Se of xe){const Oe=this._tiles[Se];Oe.hasSymbolBuckets&&!Oe.holdingForFade()?Oe.setHoldDuration(this.map._fadeDuration):Oe.hasSymbolBuckets&&!Oe.symbolFadeFinished()||this._removeTile(Se)}this._updateLoadedParentTileCache(),this._updateLoadedSiblingTileCache()}releaseSymbolFadeTiles(){for(const t in this._tiles)this._tiles[t].holdingForFade()&&this._removeTile(t)}_updateRetainedTiles(t,G){var J;const te={},se={},de=Math.max(G-Nt.maxOverzooming,this._source.minzoom),_e=Math.max(G+Nt.maxUnderzooming,this._source.minzoom),ge={};for(const xe of t){const Se=this._addTile(xe);te[xe.key]=xe,Se.hasData()||G<this._source.maxzoom&&(ge[xe.key]=xe)}this._retainLoadedChildren(ge,G,_e,te);for(const xe of t){let Se=this._tiles[xe.key];if(Se.hasData())continue;if(G+1>this._source.maxzoom){const Ae=xe.children(this._source.maxzoom)[0],je=this.getTile(Ae);if(je&&je.hasData()){te[Ae.key]=Ae;continue}}else{const Ae=xe.children(this._source.maxzoom);if(te[Ae[0].key]&&te[Ae[1].key]&&te[Ae[2].key]&&te[Ae[3].key])continue}let Oe=Se.wasRequested();for(let Ae=xe.overscaledZ-1;Ae>=de;--Ae){const je=xe.scaledTo(Ae);if(se[je.key])break;if(se[je.key]=!0,Se=this.getTile(je),!Se&&Oe&&(Se=this._addTile(je)),Se){const Ye=Se.hasData();if((Ye||!(!((J=this.map)===null||J===void 0)&&J.cancelPendingTileRequestsWhileZooming)||Oe)&&(te[je.key]=je),Oe=Se.wasRequested(),Ye)break}}}return te}_updateLoadedParentTileCache(){this._loadedParentTiles={};for(const t in this._tiles){const G=[];let J,te=this._tiles[t].tileID;for(;te.overscaledZ>0;){if(te.key in this._loadedParentTiles){J=this._loadedParentTiles[te.key];break}G.push(te.key);const se=te.scaledTo(te.overscaledZ-1);if(J=this._getLoadedTile(se),J)break;te=se}for(const se of G)this._loadedParentTiles[se]=J}}_updateLoadedSiblingTileCache(){this._loadedSiblingTiles={};for(const t in this._tiles){const G=this._tiles[t].tileID,J=this._getLoadedTile(G);this._loadedSiblingTiles[G.key]=J}}_addTile(t){let G=this._tiles[t.key];if(G)return G;G=this._cache.getAndRemove(t),G&&(this._setTileReloadTimer(t.key,G),G.tileID=t,this._state.initializeTileState(G,this.map?this.map.painter:null),this._cacheTimers[t.key]&&(clearTimeout(this._cacheTimers[t.key]),delete this._cacheTimers[t.key],this._setTileReloadTimer(t.key,G)));const J=G;return G||(G=new Ee(t,this._source.tileSize*t.overscaleFactor()),this._loadTile(G,t.key,G.state)),G.uses++,this._tiles[t.key]=G,J||this._source.fire(new R.l("dataloading",{tile:G,coord:G.tileID,dataType:"source"})),G}_setTileReloadTimer(t,G){t in this._timers&&(clearTimeout(this._timers[t]),delete this._timers[t]);const J=G.getExpiryTimeout();J&&(this._timers[t]=setTimeout(()=>{this._reloadTile(t,"expired"),delete this._timers[t]},J))}refreshTiles(t){for(const G in this._tiles)(this._isIdRenderable(G)||this._tiles[G].state=="errored")&&t.some(J=>J.equals(this._tiles[G].tileID.canonical))&&this._reloadTile(G,"expired")}_removeTile(t){const G=this._tiles[t];G&&(G.uses--,delete this._tiles[t],this._timers[t]&&(clearTimeout(this._timers[t]),delete this._timers[t]),G.uses>0||(G.hasData()&&G.state!=="reloading"?this._cache.add(G.tileID,G,G.getExpiryTimeout()):(G.aborted=!0,this._abortTile(G),this._unloadTile(G))))}_dataHandler(t){const G=t.sourceDataType;t.dataType==="source"&&G==="metadata"&&(this._sourceLoaded=!0),this._sourceLoaded&&!this._paused&&t.dataType==="source"&&G==="content"&&(this.reload(t.sourceDataChanged),this.transform&&this.update(this.transform,this.terrain),this._didEmitContent=!0)}clearTiles(){this._shouldReloadOnResume=!1,this._paused=!1;for(const t in this._tiles)this._removeTile(t);this._cache.reset()}tilesIn(t,G,J){const te=[],se=this.transform;if(!se)return te;const de=se.getCoveringTilesDetailsProvider().allowWorldCopies(),_e=J?se.getCameraQueryGeometry(t):t,ge=je=>se.screenPointToMercatorCoordinate(je,this.terrain),xe=this.transformBbox(t,ge,!de),Se=this.transformBbox(_e,ge,!de),Oe=this.getIds(),Ae=R.a1.fromPoints(Se);for(let je=0;je<Oe.length;je++){const Ye=this._tiles[Oe[je]];if(Ye.holdingForFade())continue;const at=de?[Ye.tileID]:[Ye.tileID.unwrapTo(-1),Ye.tileID.unwrapTo(0)],nt=Math.pow(2,se.zoom-Ye.tileID.overscaledZ),ot=G*Ye.queryPadding*R.$/Ye.tileSize/nt;for(const ht of at){const xt=Ae.map(mt=>ht.getTilePoint(new R.a0(mt.x,mt.y)));if(xt.expandBy(ot),xt.intersects(Ot)){const mt=xe.map(Pt=>ht.getTilePoint(Pt)),Tt=Se.map(Pt=>ht.getTilePoint(Pt));te.push({tile:Ye,tileID:de?ht:ht.unwrapTo(0),queryGeometry:mt,cameraQueryGeometry:Tt,scale:nt})}}}return te}transformBbox(t,G,J){let te=t.map(G);if(J){const se=R.a1.fromPoints(t);se.shrinkBy(.001*Math.min(se.width(),se.height()));const de=se.map(G);R.a1.fromPoints(te).covers(de)||(te=te.map(_e=>_e.x>.5?new R.a0(_e.x-1,_e.y,_e.z):_e))}return te}getVisibleCoordinates(t){const G=this.getRenderableIds(t).map(J=>this._tiles[J].tileID);return this.transform&&this.transform.populateCache(G),G}hasTransition(){if(this._source.hasTransition())return!0;if(ar(this._source.type)){const t=pe.now();for(const G in this._tiles)if(this._tiles[G].fadeEndTime>=t)return!0}return!1}setFeatureState(t,G,J){this._state.updateState(t=t||"_geojsonTileLayer",G,J)}removeFeatureState(t,G,J){this._state.removeFeatureState(t=t||"_geojsonTileLayer",G,J)}getFeatureState(t,G){return this._state.getState(t=t||"_geojsonTileLayer",G)}setDependencies(t,G,J){const te=this._tiles[t];te&&te.setDependencies(G,J)}reloadTilesForDependencies(t,G){for(const J in this._tiles)this._tiles[J].hasDependency(t,G)&&this._reloadTile(J,"reloading");this._cache.filter(J=>!J.hasDependency(t,G))}}function St(oe,t){const G=Math.abs(2*oe.wrap)-+(oe.wrap<0),J=Math.abs(2*t.wrap)-+(t.wrap<0);return oe.overscaledZ-t.overscaledZ||J-G||t.canonical.y-oe.canonical.y||t.canonical.x-oe.canonical.x}function ar(oe){return oe==="raster"||oe==="image"||oe==="video"}Nt.maxOverzooming=10,Nt.maxUnderzooming=3;class qr{constructor(t,G){this.reset(t,G)}reset(t,G){this.points=t||[],this._distances=[0];for(let J=1;J<this.points.length;J++)this._distances[J]=this._distances[J-1]+this.points[J].dist(this.points[J-1]);this.length=this._distances[this._distances.length-1],this.padding=Math.min(G||0,.5*this.length),this.paddedLength=this.length-2*this.padding}lerp(t){if(this.points.length===1)return this.points[0];t=R.ag(t,0,1);let G=1,J=this._distances[G];const te=t*this.paddedLength+this.padding;for(;J<te&&G<this._distances.length;)J=this._distances[++G];const se=G-1,de=this._distances[se],_e=J-de,ge=_e>0?(te-de)/_e:0;return this.points[se].mult(1-ge).add(this.points[G].mult(ge))}}function fr(oe,t){let G=!0;return oe==="always"||oe!=="never"&&t!=="never"||(G=!1),G}class Fr{constructor(t,G,J){const te=this.boxCells=[],se=this.circleCells=[];this.xCellCount=Math.ceil(t/J),this.yCellCount=Math.ceil(G/J);for(let de=0;de<this.xCellCount*this.yCellCount;de++)te.push([]),se.push([]);this.circleKeys=[],this.boxKeys=[],this.bboxes=[],this.circles=[],this.width=t,this.height=G,this.xScale=this.xCellCount/t,this.yScale=this.yCellCount/G,this.boxUid=0,this.circleUid=0}keysLength(){return this.boxKeys.length+this.circleKeys.length}insert(t,G,J,te,se){this._forEachCell(G,J,te,se,this._insertBoxCell,this.boxUid++),this.boxKeys.push(t),this.bboxes.push(G),this.bboxes.push(J),this.bboxes.push(te),this.bboxes.push(se)}insertCircle(t,G,J,te){this._forEachCell(G-te,J-te,G+te,J+te,this._insertCircleCell,this.circleUid++),this.circleKeys.push(t),this.circles.push(G),this.circles.push(J),this.circles.push(te)}_insertBoxCell(t,G,J,te,se,de){this.boxCells[se].push(de)}_insertCircleCell(t,G,J,te,se,de){this.circleCells[se].push(de)}_query(t,G,J,te,se,de,_e){if(J<0||t>this.width||te<0||G>this.height)return[];const ge=[];if(t<=0&&G<=0&&this.width<=J&&this.height<=te){if(se)return[{key:null,x1:t,y1:G,x2:J,y2:te}];for(let xe=0;xe<this.boxKeys.length;xe++)ge.push({key:this.boxKeys[xe],x1:this.bboxes[4*xe],y1:this.bboxes[4*xe+1],x2:this.bboxes[4*xe+2],y2:this.bboxes[4*xe+3]});for(let xe=0;xe<this.circleKeys.length;xe++){const Se=this.circles[3*xe],Oe=this.circles[3*xe+1],Ae=this.circles[3*xe+2];ge.push({key:this.circleKeys[xe],x1:Se-Ae,y1:Oe-Ae,x2:Se+Ae,y2:Oe+Ae})}}else this._forEachCell(t,G,J,te,this._queryCell,ge,{hitTest:se,overlapMode:de,seenUids:{box:{},circle:{}}},_e);return ge}query(t,G,J,te){return this._query(t,G,J,te,!1,null)}hitTest(t,G,J,te,se,de){return this._query(t,G,J,te,!0,se,de).length>0}hitTestCircle(t,G,J,te,se){const de=t-J,_e=t+J,ge=G-J,xe=G+J;if(_e<0||de>this.width||xe<0||ge>this.height)return!1;const Se=[];return this._forEachCell(de,ge,_e,xe,this._queryCellCircle,Se,{hitTest:!0,overlapMode:te,circle:{x:t,y:G,radius:J},seenUids:{box:{},circle:{}}},se),Se.length>0}_queryCell(t,G,J,te,se,de,_e,ge){const{seenUids:xe,hitTest:Se,overlapMode:Oe}=_e,Ae=this.boxCells[se];if(Ae!==null){const Ye=this.bboxes;for(const at of Ae)if(!xe.box[at]){xe.box[at]=!0;const nt=4*at,ot=this.boxKeys[at];if(t<=Ye[nt+2]&&G<=Ye[nt+3]&&J>=Ye[nt+0]&&te>=Ye[nt+1]&&(!ge||ge(ot))&&(!Se||!fr(Oe,ot.overlapMode))&&(de.push({key:ot,x1:Ye[nt],y1:Ye[nt+1],x2:Ye[nt+2],y2:Ye[nt+3]}),Se))return!0}}const je=this.circleCells[se];if(je!==null){const Ye=this.circles;for(const at of je)if(!xe.circle[at]){xe.circle[at]=!0;const nt=3*at,ot=this.circleKeys[at];if(this._circleAndRectCollide(Ye[nt],Ye[nt+1],Ye[nt+2],t,G,J,te)&&(!ge||ge(ot))&&(!Se||!fr(Oe,ot.overlapMode))){const ht=Ye[nt],xt=Ye[nt+1],mt=Ye[nt+2];if(de.push({key:ot,x1:ht-mt,y1:xt-mt,x2:ht+mt,y2:xt+mt}),Se)return!0}}}return!1}_queryCellCircle(t,G,J,te,se,de,_e,ge){const{circle:xe,seenUids:Se,overlapMode:Oe}=_e,Ae=this.boxCells[se];if(Ae!==null){const Ye=this.bboxes;for(const at of Ae)if(!Se.box[at]){Se.box[at]=!0;const nt=4*at,ot=this.boxKeys[at];if(this._circleAndRectCollide(xe.x,xe.y,xe.radius,Ye[nt+0],Ye[nt+1],Ye[nt+2],Ye[nt+3])&&(!ge||ge(ot))&&!fr(Oe,ot.overlapMode))return de.push(!0),!0}}const je=this.circleCells[se];if(je!==null){const Ye=this.circles;for(const at of je)if(!Se.circle[at]){Se.circle[at]=!0;const nt=3*at,ot=this.circleKeys[at];if(this._circlesCollide(Ye[nt],Ye[nt+1],Ye[nt+2],xe.x,xe.y,xe.radius)&&(!ge||ge(ot))&&!fr(Oe,ot.overlapMode))return de.push(!0),!0}}}_forEachCell(t,G,J,te,se,de,_e,ge){const xe=this._convertToXCellCoord(t),Se=this._convertToYCellCoord(G),Oe=this._convertToXCellCoord(J),Ae=this._convertToYCellCoord(te);for(let je=xe;je<=Oe;je++)for(let Ye=Se;Ye<=Ae;Ye++)if(se.call(this,t,G,J,te,this.xCellCount*Ye+je,de,_e,ge))return}_convertToXCellCoord(t){return Math.max(0,Math.min(this.xCellCount-1,Math.floor(t*this.xScale)))}_convertToYCellCoord(t){return Math.max(0,Math.min(this.yCellCount-1,Math.floor(t*this.yScale)))}_circlesCollide(t,G,J,te,se,de){const _e=te-t,ge=se-G,xe=J+de;return xe*xe>_e*_e+ge*ge}_circleAndRectCollide(t,G,J,te,se,de,_e){const ge=(de-te)/2,xe=Math.abs(t-(te+ge));if(xe>ge+J)return!1;const Se=(_e-se)/2,Oe=Math.abs(G-(se+Se));if(Oe>Se+J)return!1;if(xe<=ge||Oe<=Se)return!0;const Ae=xe-ge,je=Oe-Se;return Ae*Ae+je*je<=J*J}}function Gr(oe,t,G){const J=R.L();if(!oe){const{vecSouth:Oe,vecEast:Ae}=Jr(t),je=Z();je[0]=Ae[0],je[1]=Ae[1],je[2]=Oe[0],je[3]=Oe[1],te=je,(Se=(de=(se=je)[0])*(xe=se[3])-(ge=se[2])*(_e=se[1]))&&(te[0]=xe*(Se=1/Se),te[1]=-_e*Se,te[2]=-ge*Se,te[3]=de*Se),J[0]=je[0],J[1]=je[1],J[4]=je[2],J[5]=je[3]}var te,se,de,_e,ge,xe,Se;return R.N(J,J,[1/G,1/G,1]),J}function ci(oe,t,G,J){if(oe){const te=R.L();if(!t){const{vecSouth:se,vecEast:de}=Jr(G);te[0]=de[0],te[1]=de[1],te[4]=se[0],te[5]=se[1]}return R.N(te,te,[J,J,1]),te}return G.pixelsToClipSpaceMatrix}function Jr(oe){const t=Math.cos(oe.rollInRadians),G=Math.sin(oe.rollInRadians),J=Math.cos(oe.pitchInRadians),te=Math.cos(oe.bearingInRadians),se=Math.sin(oe.bearingInRadians),de=R.aq();de[0]=-te*J*G-se*t,de[1]=-se*J*G+te*t;const _e=R.ar(de);_e<1e-9?R.as(de):R.at(de,de,1/_e);const ge=R.aq();ge[0]=te*J*t-se*G,ge[1]=se*J*t+te*G;const xe=R.ar(ge);return xe<1e-9?R.as(ge):R.at(ge,ge,1/xe),{vecEast:ge,vecSouth:de}}function Yr(oe,t,G,J){let te;J?(te=[oe,t,J(oe,t),1],R.av(te,te,G)):(te=[oe,t,0,1],pi(te,te,G));const se=te[3];return{point:new R.P(te[0]/se,te[1]/se),signedDistanceFromCamera:se,isOccluded:!1}}function jr(oe,t){return .5+oe/t*.5}function Zr(oe,t){return oe.x>=-t[0]&&oe.x<=t[0]&&oe.y>=-t[1]&&oe.y<=t[1]}function fi(oe,t,G,J,te,se,de,_e,ge,xe,Se,Oe,Ae){const je=G?oe.textSizeData:oe.iconSizeData,Ye=R.am(je,t.transform.zoom),at=[256/t.width*2+1,256/t.height*2+1],nt=G?oe.text.dynamicLayoutVertexArray:oe.icon.dynamicLayoutVertexArray;nt.clear();const ot=oe.lineVertexArray,ht=G?oe.text.placedSymbolArray:oe.icon.placedSymbolArray,xt=t.transform.width/t.transform.height;let mt=!1;for(let Tt=0;Tt<ht.length;Tt++){const Pt=ht.get(Tt);if(Pt.hidden||Pt.writingMode===R.an.vertical&&!mt){Mr(Pt.numGlyphs,nt);continue}mt=!1;const vt=new R.P(Pt.anchorX,Pt.anchorY),kt={getElevation:Ae,pitchedLabelPlaneMatrix:J,lineVertexArray:ot,pitchWithMap:se,projectionCache:{projections:{},offsets:{},cachedAnchorPoint:void 0,anyProjectionOccluded:!1},transform:t.transform,tileAnchorPoint:vt,unwrappedTileID:ge,width:xe,height:Se,translation:Oe},Vt=Yt(Pt.anchorX,Pt.anchorY,kt);if(!Zr(Vt.point,at)){Mr(Pt.numGlyphs,nt);continue}const jt=jr(t.transform.cameraToCenterDistance,Vt.signedDistanceFromCamera),zt=R.ao(je,Ye,Pt),$t=se?zt*t.transform.getPitchedTextCorrection(Pt.anchorX,Pt.anchorY,ge)/jt:zt*jt,mr=Qr({projectionContext:kt,pitchedLabelPlaneMatrixInverse:te,symbol:Pt,fontSize:$t,flip:!1,keepUpright:de,glyphOffsetArray:oe.glyphOffsetArray,dynamicLayoutVertexArray:nt,aspectRatio:xt,rotateToLine:_e});mt=mr.useVertical,(mr.notEnoughRoom||mt||mr.needsFlipping&&Qr({projectionContext:kt,pitchedLabelPlaneMatrixInverse:te,symbol:Pt,fontSize:$t,flip:!0,keepUpright:de,glyphOffsetArray:oe.glyphOffsetArray,dynamicLayoutVertexArray:nt,aspectRatio:xt,rotateToLine:_e}).notEnoughRoom)&&Mr(Pt.numGlyphs,nt)}G?oe.text.dynamicLayoutVertexBuffer.updateData(nt):oe.icon.dynamicLayoutVertexBuffer.updateData(nt)}function cr(oe,t,G,J,te,se,de,_e){const ge=se.glyphStartIndex+se.numGlyphs,xe=se.lineStartIndex,Se=se.lineStartIndex+se.lineLength,Oe=t.getoffsetX(se.glyphStartIndex),Ae=t.getoffsetX(ge-1),je=ir(oe*Oe,G,J,te,se.segment,xe,Se,_e,de);if(!je)return null;const Ye=ir(oe*Ae,G,J,te,se.segment,xe,Se,_e,de);return Ye?_e.projectionCache.anyProjectionOccluded?null:{first:je,last:Ye}:null}function bi(oe,t,G,J){return oe===R.an.horizontal&&Math.abs(G.y-t.y)>Math.abs(G.x-t.x)*J?{useVertical:!0}:(oe===R.an.vertical?t.y<G.y:t.x>G.x)?{needsFlipping:!0}:null}function Qr(oe){const{projectionContext:t,pitchedLabelPlaneMatrixInverse:G,symbol:J,fontSize:te,flip:se,keepUpright:de,glyphOffsetArray:_e,dynamicLayoutVertexArray:ge,aspectRatio:xe,rotateToLine:Se}=oe,Oe=te/24,Ae=J.lineOffsetX*Oe,je=J.lineOffsetY*Oe;let Ye;if(J.numGlyphs>1){const at=J.glyphStartIndex+J.numGlyphs,nt=J.lineStartIndex,ot=J.lineStartIndex+J.lineLength,ht=cr(Oe,_e,Ae,je,se,J,Se,t);if(!ht)return{notEnoughRoom:!0};const xt=Lt(ht.first.point.x,ht.first.point.y,t,G),mt=Lt(ht.last.point.x,ht.last.point.y,t,G);if(de&&!se){const Tt=bi(J.writingMode,xt,mt,xe);if(Tt)return Tt}Ye=[ht.first];for(let Tt=J.glyphStartIndex+1;Tt<at-1;Tt++){const Pt=ir(Oe*_e.getoffsetX(Tt),Ae,je,se,J.segment,nt,ot,t,Se);if(!Pt)return{notEnoughRoom:!0};Ye.push(Pt)}Ye.push(ht.last)}else{if(de&&!se){const nt=pr(t.tileAnchorPoint.x,t.tileAnchorPoint.y,t).point,ot=J.lineStartIndex+J.segment+1,ht=new R.P(t.lineVertexArray.getx(ot),t.lineVertexArray.gety(ot)),xt=pr(ht.x,ht.y,t),mt=xt.signedDistanceFromCamera>0?xt.point:Ei(t.tileAnchorPoint,ht,nt,1,t),Tt=Lt(nt.x,nt.y,t,G),Pt=Lt(mt.x,mt.y,t,G),vt=bi(J.writingMode,Tt,Pt,xe);if(vt)return vt}const at=ir(Oe*_e.getoffsetX(J.glyphStartIndex),Ae,je,se,J.segment,J.lineStartIndex,J.lineStartIndex+J.lineLength,t,Se);if(!at||t.projectionCache.anyProjectionOccluded)return{notEnoughRoom:!0};Ye=[at]}for(const at of Ye)R.au(ge,at.point,at.angle);return{}}function Ei(oe,t,G,J,te){const se=oe.add(oe.sub(t)._unit()),de=pr(se.x,se.y,te).point,_e=G.sub(de);return G.add(_e._mult(J/_e.mag()))}function yn(oe,t,G){const J=t.projectionCache;if(J.projections[oe])return J.projections[oe];const te=new R.P(t.lineVertexArray.getx(oe),t.lineVertexArray.gety(oe)),se=pr(te.x,te.y,t);if(se.signedDistanceFromCamera>0)return J.projections[oe]=se.point,J.anyProjectionOccluded=J.anyProjectionOccluded||se.isOccluded,se.point;const de=oe-G.direction;return Ei(G.distanceFromAnchor===0?t.tileAnchorPoint:new R.P(t.lineVertexArray.getx(de),t.lineVertexArray.gety(de)),te,G.previousVertex,G.absOffsetX-G.distanceFromAnchor+1,t)}function pr(oe,t,G){const J=oe+G.translation[0],te=t+G.translation[1];let se;return G.pitchWithMap?(se=Yr(J,te,G.pitchedLabelPlaneMatrix,G.getElevation),se.isOccluded=!1):(se=G.transform.projectTileCoordinates(J,te,G.unwrappedTileID,G.getElevation),se.point.x=(.5*se.point.x+.5)*G.width,se.point.y=(.5*-se.point.y+.5)*G.height),se}function Lt(oe,t,G,J){if(G.pitchWithMap){const te=[oe,t,0,1];return R.av(te,te,J),G.transform.projectTileCoordinates(te[0]/te[3],te[1]/te[3],G.unwrappedTileID,G.getElevation).point}return{x:oe/G.width*2-1,y:1-t/G.height*2}}function Yt(oe,t,G){return G.transform.projectTileCoordinates(oe,t,G.unwrappedTileID,G.getElevation)}function Ht(oe,t,G){return oe._unit()._perp()._mult(t*G)}function Bt(oe,t,G,J,te,se,de,_e,ge){if(_e.projectionCache.offsets[oe])return _e.projectionCache.offsets[oe];const xe=G.add(t);if(oe+ge.direction<J||oe+ge.direction>=te)return _e.projectionCache.offsets[oe]=xe,xe;const Se=yn(oe+ge.direction,_e,ge),Oe=Ht(Se.sub(G),de,ge.direction),Ae=G.add(Oe),je=Se.add(Oe);return _e.projectionCache.offsets[oe]=R.aw(se,xe,Ae,je)||xe,_e.projectionCache.offsets[oe]}function ir(oe,t,G,J,te,se,de,_e,ge){const xe=J?oe-t:oe+t;let Se=xe>0?1:-1,Oe=0;J&&(Se*=-1,Oe=Math.PI),Se<0&&(Oe+=Math.PI);let Ae,je=Se>0?se+te:se+te+1;_e.projectionCache.cachedAnchorPoint?Ae=_e.projectionCache.cachedAnchorPoint:(Ae=pr(_e.tileAnchorPoint.x,_e.tileAnchorPoint.y,_e).point,_e.projectionCache.cachedAnchorPoint=Ae);let Ye,at,nt=Ae,ot=Ae,ht=0,xt=0;const mt=Math.abs(xe),Tt=[];let Pt;for(;ht+xt<=mt;){if(je+=Se,je<se||je>=de)return null;ht+=xt,ot=nt,at=Ye;const Vt={absOffsetX:mt,direction:Se,distanceFromAnchor:ht,previousVertex:ot};if(nt=yn(je,_e,Vt),G===0)Tt.push(ot),Pt=nt.sub(ot);else{let jt;const zt=nt.sub(ot);jt=zt.mag()===0?Ht(yn(je+Se,_e,Vt).sub(nt),G,Se):Ht(zt,G,Se),at||(at=ot.add(jt)),Ye=Bt(je,jt,nt,se,de,at,G,_e,Vt),Tt.push(at),Pt=Ye.sub(at)}xt=Pt.mag()}const vt=Pt._mult((mt-ht)/xt)._add(at||ot),kt=Oe+Math.atan2(nt.y-ot.y,nt.x-ot.x);return Tt.push(vt),{point:vt,angle:ge?kt:0,path:Tt}}const gr=new Float32Array([-1/0,-1/0,0,-1/0,-1/0,0,-1/0,-1/0,0,-1/0,-1/0,0]);function Mr(oe,t){for(let G=0;G<oe;G++){const J=t.length;t.resize(J+4),t.float32.set(gr,3*J)}}function pi(oe,t,G){const J=t[0],te=t[1];return oe[0]=G[0]*J+G[4]*te+G[12],oe[1]=G[1]*J+G[5]*te+G[13],oe[3]=G[3]*J+G[7]*te+G[15],oe}const ri=100;class Oi{constructor(t,G=new Fr(t.width+200,t.height+200,25),J=new Fr(t.width+200,t.height+200,25)){this.transform=t,this.grid=G,this.ignoredGrid=J,this.pitchFactor=Math.cos(t.pitch*Math.PI/180)*t.cameraToCenterDistance,this.screenRightBoundary=t.width+ri,this.screenBottomBoundary=t.height+ri,this.gridRightBoundary=t.width+200,this.gridBottomBoundary=t.height+200,this.perspectiveRatioCutoff=.6}placeCollisionBox(t,G,J,te,se,de,_e,ge,xe,Se,Oe,Ae){const je=this.projectAndGetPerspectiveRatio(t.anchorPointX+ge[0],t.anchorPointY+ge[1],se,Se,Ae),Ye=J*je.perspectiveRatio;let at;if(de||_e)at=this._projectCollisionBox(t,Ye,te,se,de,_e,ge,je,Se,Oe,Ae);else{const Pt=je.x+(Oe?Oe.x*Ye:0),vt=je.y+(Oe?Oe.y*Ye:0);at={allPointsOccluded:!1,box:[Pt+t.x1*Ye,vt+t.y1*Ye,Pt+t.x2*Ye,vt+t.y2*Ye]}}const[nt,ot,ht,xt]=at.box,mt=de?at.allPointsOccluded:je.isOccluded;let Tt=mt;return Tt||(Tt=je.perspectiveRatio<this.perspectiveRatioCutoff),Tt||(Tt=!this.isInsideGrid(nt,ot,ht,xt)),Tt||G!=="always"&&this.grid.hitTest(nt,ot,ht,xt,G,xe)?{box:[nt,ot,ht,xt],placeable:!1,offscreen:!1,occluded:mt}:{box:[nt,ot,ht,xt],placeable:!0,offscreen:this.isOffscreen(nt,ot,ht,xt),occluded:mt}}placeCollisionCircles(t,G,J,te,se,de,_e,ge,xe,Se,Oe,Ae,je,Ye){const at=[],nt=new R.P(G.anchorX,G.anchorY),ot=this.getPerspectiveRatio(nt.x,nt.y,de,Ye),ht=(xe?se*this.transform.getPitchedTextCorrection(G.anchorX,G.anchorY,de)/ot:se*ot)/R.aA,xt={getElevation:Ye,pitchedLabelPlaneMatrix:_e,lineVertexArray:J,pitchWithMap:xe,projectionCache:{projections:{},offsets:{},cachedAnchorPoint:void 0,anyProjectionOccluded:!1},transform:this.transform,tileAnchorPoint:nt,unwrappedTileID:de,width:this.transform.width,height:this.transform.height,translation:je},mt=cr(ht,te,G.lineOffsetX*ht,G.lineOffsetY*ht,!1,G,!1,xt);let Tt=!1,Pt=!1,vt=!0;if(mt){const kt=.5*Oe*ot+Ae,Vt=new R.P(-100,-100),jt=new R.P(this.screenRightBoundary,this.screenBottomBoundary),zt=new qr,$t=mt.first,mr=mt.last;let _r=[];for(let ti=$t.path.length-1;ti>=1;ti--)_r.push($t.path[ti]);for(let ti=1;ti<mr.path.length;ti++)_r.push(mr.path[ti]);const er=2.5*kt;if(xe){const ti=this.projectPathToScreenSpace(_r,xt);_r=ti.some(di=>di.signedDistanceFromCamera<=0)?[]:ti.map(di=>di.point)}let Ar=[];if(_r.length>0){const ti=_r[0].clone(),di=_r[0].clone();for(let Ri=1;Ri<_r.length;Ri++)ti.x=Math.min(ti.x,_r[Ri].x),ti.y=Math.min(ti.y,_r[Ri].y),di.x=Math.max(di.x,_r[Ri].x),di.y=Math.max(di.y,_r[Ri].y);Ar=ti.x>=Vt.x&&di.x<=jt.x&&ti.y>=Vt.y&&di.y<=jt.y?[_r]:di.x<Vt.x||ti.x>jt.x||di.y<Vt.y||ti.y>jt.y?[]:R.ax([_r],Vt.x,Vt.y,jt.x,jt.y)}for(const ti of Ar){zt.reset(ti,.25*kt);let di=0;di=zt.length<=.5*kt?1:Math.ceil(zt.paddedLength/er)+1;for(let Ri=0;Ri<di;Ri++){const _i=Ri/Math.max(di-1,1),Ai=zt.lerp(_i),gi=Ai.x+ri,mi=Ai.y+ri;at.push(gi,mi,kt,0);const vi=gi-kt,en=mi-kt,li=gi+kt,Hi=mi+kt;if(vt=vt&&this.isOffscreen(vi,en,li,Hi),Pt=Pt||this.isInsideGrid(vi,en,li,Hi),t!=="always"&&this.grid.hitTestCircle(gi,mi,kt,t,Se)&&(Tt=!0,!ge))return{circles:[],offscreen:!1,collisionDetected:Tt}}}}return{circles:!ge&&Tt||!Pt||ot<this.perspectiveRatioCutoff?[]:at,offscreen:vt,collisionDetected:Tt}}projectPathToScreenSpace(t,G){const J=function(te,se){const de=R.L();return R.ap(de,se.pitchedLabelPlaneMatrix),te.map(_e=>{const ge=Yr(_e.x,_e.y,de,se.getElevation),xe=se.transform.projectTileCoordinates(ge.point.x,ge.point.y,se.unwrappedTileID,se.getElevation);return xe.point.x=(.5*xe.point.x+.5)*se.width,xe.point.y=(.5*-xe.point.y+.5)*se.height,xe})}(t,G);return function(te){let se=0,de=0,_e=0,ge=0;for(let xe=0;xe<te.length;xe++)te[xe].isOccluded?(_e=xe+1,ge=0):(ge++,ge>de&&(de=ge,se=_e));return te.slice(se,se+de)}(J)}queryRenderedSymbols(t){if(t.length===0||this.grid.keysLength()===0&&this.ignoredGrid.keysLength()===0)return{};const G=[],J=new R.a1;for(const Oe of t){const Ae=new R.P(Oe.x+ri,Oe.y+ri);J.extend(Ae),G.push(Ae)}const{minX:te,minY:se,maxX:de,maxY:_e}=J,ge=this.grid.query(te,se,de,_e).concat(this.ignoredGrid.query(te,se,de,_e)),xe={},Se={};for(const Oe of ge){const Ae=Oe.key;if(xe[Ae.bucketInstanceId]===void 0&&(xe[Ae.bucketInstanceId]={}),xe[Ae.bucketInstanceId][Ae.featureIndex])continue;const je=[new R.P(Oe.x1,Oe.y1),new R.P(Oe.x2,Oe.y1),new R.P(Oe.x2,Oe.y2),new R.P(Oe.x1,Oe.y2)];R.ay(G,je)&&(xe[Ae.bucketInstanceId][Ae.featureIndex]=!0,Se[Ae.bucketInstanceId]===void 0&&(Se[Ae.bucketInstanceId]=[]),Se[Ae.bucketInstanceId].push(Ae.featureIndex))}return Se}insertCollisionBox(t,G,J,te,se,de){(J?this.ignoredGrid:this.grid).insert({bucketInstanceId:te,featureIndex:se,collisionGroupID:de,overlapMode:G},t[0],t[1],t[2],t[3])}insertCollisionCircles(t,G,J,te,se,de){const _e=J?this.ignoredGrid:this.grid,ge={bucketInstanceId:te,featureIndex:se,collisionGroupID:de,overlapMode:G};for(let xe=0;xe<t.length;xe+=4)_e.insertCircle(ge,t[xe],t[xe+1],t[xe+2])}projectAndGetPerspectiveRatio(t,G,J,te,se){if(se){let de;te?(de=[t,G,te(t,G),1],R.av(de,de,se)):(de=[t,G,0,1],pi(de,de,se));const _e=de[3];return{x:(de[0]/_e+1)/2*this.transform.width+ri,y:(-de[1]/_e+1)/2*this.transform.height+ri,perspectiveRatio:.5+this.transform.cameraToCenterDistance/_e*.5,isOccluded:!1,signedDistanceFromCamera:_e}}{const de=this.transform.projectTileCoordinates(t,G,J,te);return{x:(de.point.x+1)/2*this.transform.width+ri,y:(1-de.point.y)/2*this.transform.height+ri,perspectiveRatio:.5+this.transform.cameraToCenterDistance/de.signedDistanceFromCamera*.5,isOccluded:de.isOccluded,signedDistanceFromCamera:de.signedDistanceFromCamera}}}getPerspectiveRatio(t,G,J,te){const se=this.transform.projectTileCoordinates(t,G,J,te);return .5+this.transform.cameraToCenterDistance/se.signedDistanceFromCamera*.5}isOffscreen(t,G,J,te){return J<ri||t>=this.screenRightBoundary||te<ri||G>this.screenBottomBoundary}isInsideGrid(t,G,J,te){return J>=0&&t<this.gridRightBoundary&&te>=0&&G<this.gridBottomBoundary}getViewportMatrix(){const t=R.af([]);return R.M(t,t,[-100,-100,0]),t}_projectCollisionBox(t,G,J,te,se,de,_e,ge,xe,Se,Oe){let Ae=1,je=0,Ye=0,at=1;const nt=t.anchorPointX+_e[0],ot=t.anchorPointY+_e[1];if(de&&!se){const _r=this.projectAndGetPerspectiveRatio(nt+1,ot,te,xe,Oe),er=_r.x-ge.x,Ar=Math.atan((_r.y-ge.y)/er)+(er<0?Math.PI:0),ti=Math.sin(Ar),di=Math.cos(Ar);Ae=di,je=ti,Ye=-ti,at=di}else if(!de&&se){const _r=Jr(this.transform);Ae=_r.vecEast[0],je=_r.vecEast[1],Ye=_r.vecSouth[0],at=_r.vecSouth[1]}let ht=ge.x,xt=ge.y,mt=G;se&&(ht=nt,xt=ot,mt=Math.pow(2,-(this.transform.zoom-J.overscaledZ)),mt*=this.transform.getPitchedTextCorrection(nt,ot,te),Se||(mt*=R.ag(.5+ge.signedDistanceFromCamera/this.transform.cameraToCenterDistance*.5,0,4))),Se&&(ht+=Ae*Se.x*mt+Ye*Se.y*mt,xt+=je*Se.x*mt+at*Se.y*mt);const Tt=t.x1*mt,Pt=t.x2*mt,vt=(Tt+Pt)/2,kt=t.y1*mt,Vt=t.y2*mt,jt=(kt+Vt)/2,zt=[{offsetX:Tt,offsetY:kt},{offsetX:vt,offsetY:kt},{offsetX:Pt,offsetY:kt},{offsetX:Pt,offsetY:jt},{offsetX:Pt,offsetY:Vt},{offsetX:vt,offsetY:Vt},{offsetX:Tt,offsetY:Vt},{offsetX:Tt,offsetY:jt}];let $t=[];for(const{offsetX:_r,offsetY:er}of zt)$t.push(new R.P(ht+Ae*_r+Ye*er,xt+je*_r+at*er));let mr=!1;if(se){const _r=$t.map(er=>this.projectAndGetPerspectiveRatio(er.x,er.y,te,xe,Oe));mr=_r.some(er=>!er.isOccluded),$t=_r.map(er=>new R.P(er.x,er.y))}else mr=!0;return{box:R.az($t),allPointsOccluded:!mr}}}class Vi{constructor(t,G,J,te){this.opacity=t?Math.max(0,Math.min(1,t.opacity+(t.placed?G:-G))):te&&J?1:0,this.placed=J}isHidden(){return this.opacity===0&&!this.placed}}class hr{constructor(t,G,J,te,se){this.text=new Vi(t?t.text:null,G,J,se),this.icon=new Vi(t?t.icon:null,G,te,se)}isHidden(){return this.text.isHidden()&&this.icon.isHidden()}}class qi{constructor(t,G,J){this.text=t,this.icon=G,this.skipFade=J}}class Ci{constructor(t,G,J,te,se){this.bucketInstanceId=t,this.featureIndex=G,this.sourceLayerIndex=J,this.bucketIndex=te,this.tileID=se}}class yi{constructor(t){this.crossSourceCollisions=t,this.maxGroupID=0,this.collisionGroups={}}get(t){if(this.crossSourceCollisions)return{ID:0,predicate:null};if(!this.collisionGroups[t]){const G=++this.maxGroupID;this.collisionGroups[t]={ID:G,predicate:J=>J.collisionGroupID===G}}return this.collisionGroups[t]}}function lo(oe,t,G,J,te){const{horizontalAlign:se,verticalAlign:de}=R.aG(oe);return new R.P(-(se-.5)*t+J[0]*te,-(de-.5)*G+J[1]*te)}class ra{constructor(t,G,J,te,se){this.transform=t.clone(),this.terrain=G,this.collisionIndex=new Oi(this.transform),this.placements={},this.opacities={},this.variableOffsets={},this.stale=!1,this.commitTime=0,this.fadeDuration=J,this.retainedQueryData={},this.collisionGroups=new yi(te),this.collisionCircleArrays={},this.collisionBoxArrays=new Map,this.prevPlacement=se,se&&(se.prevPlacement=void 0),this.placedOrientations={}}_getTerrainElevationFunc(t){const G=this.terrain;return G?(J,te)=>G.getElevation(t,J,te):null}getBucketParts(t,G,J,te){const se=J.getBucket(G),de=J.latestFeatureIndex;if(!se||!de||G.id!==se.layerIds[0])return;const _e=J.collisionBoxArray,ge=se.layers[0].layout,xe=se.layers[0].paint,Se=Math.pow(2,this.transform.zoom-J.tileID.overscaledZ),Oe=J.tileSize/R.$,Ae=J.tileID.toUnwrapped(),je=ge.get("text-rotation-alignment")==="map",Ye=R.aB(J,1,this.transform.zoom),at=R.aC(this.collisionIndex.transform,J,xe.get("text-translate"),xe.get("text-translate-anchor")),nt=R.aC(this.collisionIndex.transform,J,xe.get("icon-translate"),xe.get("icon-translate-anchor")),ot=Gr(je,this.transform,Ye);this.retainedQueryData[se.bucketInstanceId]=new Ci(se.bucketInstanceId,de,se.sourceLayerIndex,se.index,J.tileID);const ht={bucket:se,layout:ge,translationText:at,translationIcon:nt,unwrappedTileID:Ae,pitchedLabelPlaneMatrix:ot,scale:Se,textPixelRatio:Oe,holdingForFade:J.holdingForFade(),collisionBoxArray:_e,partiallyEvaluatedTextSize:R.am(se.textSizeData,this.transform.zoom),collisionGroup:this.collisionGroups.get(se.sourceID)};if(te)for(const xt of se.sortKeyRanges){const{sortKey:mt,symbolInstanceStart:Tt,symbolInstanceEnd:Pt}=xt;t.push({sortKey:mt,symbolInstanceStart:Tt,symbolInstanceEnd:Pt,parameters:ht})}else t.push({symbolInstanceStart:0,symbolInstanceEnd:se.symbolInstances.length,parameters:ht})}attemptAnchorPlacement(t,G,J,te,se,de,_e,ge,xe,Se,Oe,Ae,je,Ye,at,nt,ot,ht,xt,mt){const Tt=R.aD[t.textAnchor],Pt=[t.textOffset0,t.textOffset1],vt=lo(Tt,J,te,Pt,se),kt=this.collisionIndex.placeCollisionBox(G,Ae,ge,xe,Se,_e,de,nt,Oe.predicate,xt,vt,mt);if((!ht||this.collisionIndex.placeCollisionBox(ht,Ae,ge,xe,Se,_e,de,ot,Oe.predicate,xt,vt,mt).placeable)&&kt.placeable){let Vt;if(this.prevPlacement&&this.prevPlacement.variableOffsets[je.crossTileID]&&this.prevPlacement.placements[je.crossTileID]&&this.prevPlacement.placements[je.crossTileID].text&&(Vt=this.prevPlacement.variableOffsets[je.crossTileID].anchor),je.crossTileID===0)throw new Error("symbolInstance.crossTileID can't be 0");return this.variableOffsets[je.crossTileID]={textOffset:Pt,width:J,height:te,anchor:Tt,textBoxScale:se,prevAnchor:Vt},this.markUsedJustification(Ye,Tt,je,at),Ye.allowVerticalPlacement&&(this.markUsedOrientation(Ye,at,je),this.placedOrientations[je.crossTileID]=at),{shift:vt,placedGlyphBoxes:kt}}}placeLayerBucketPart(t,G,J){const{bucket:te,layout:se,translationText:de,translationIcon:_e,unwrappedTileID:ge,pitchedLabelPlaneMatrix:xe,textPixelRatio:Se,holdingForFade:Oe,collisionBoxArray:Ae,partiallyEvaluatedTextSize:je,collisionGroup:Ye}=t.parameters,at=se.get("text-optional"),nt=se.get("icon-optional"),ot=R.aE(se,"text-overlap","text-allow-overlap"),ht=ot==="always",xt=R.aE(se,"icon-overlap","icon-allow-overlap"),mt=xt==="always",Tt=se.get("text-rotation-alignment")==="map",Pt=se.get("text-pitch-alignment")==="map",vt=se.get("icon-text-fit")!=="none",kt=se.get("symbol-z-order")==="viewport-y",Vt=ht&&(mt||!te.hasIconData()||nt),jt=mt&&(ht||!te.hasTextData()||at);!te.collisionArrays&&Ae&&te.deserializeCollisionBoxes(Ae);const zt=this.retainedQueryData[te.bucketInstanceId].tileID,$t=this._getTerrainElevationFunc(zt),mr=this.transform.getFastPathSimpleProjectionMatrix(zt),_r=(er,Ar,ti)=>{var di,Ri;if(G[er.crossTileID])return;if(Oe)return void(this.placements[er.crossTileID]=new qi(!1,!1,!1));let _i=!1,Ai=!1,gi=!0,mi=null,vi={box:null,placeable:!1,offscreen:null,occluded:!1},en={placeable:!1},li=null,Hi=null,tn=null,ha=0,da=0,fa=0;Ar.textFeatureIndex?ha=Ar.textFeatureIndex:er.useRuntimeCollisionCircles&&(ha=er.featureIndex),Ar.verticalTextFeatureIndex&&(da=Ar.verticalTextFeatureIndex);const $n=Ar.textBox;if($n){const wn=ki=>{let xi=R.an.horizontal;if(te.allowVerticalPlacement&&!ki&&this.prevPlacement){const _n=this.prevPlacement.placedOrientations[er.crossTileID];_n&&(this.placedOrientations[er.crossTileID]=_n,xi=_n,this.markUsedOrientation(te,xi,er))}return xi},Fn=(ki,xi)=>{if(te.allowVerticalPlacement&&er.numVerticalGlyphVertices>0&&Ar.verticalTextBox){for(const _n of te.writingModes)if(_n===R.an.vertical?(vi=xi(),en=vi):vi=ki(),vi&&vi.placeable)break}else vi=ki()},pa=er.textAnchorOffsetStartIndex,Ra=er.textAnchorOffsetEndIndex;if(Ra===pa){const ki=(xi,_n)=>{const zi=this.collisionIndex.placeCollisionBox(xi,ot,Se,zt,ge,Pt,Tt,de,Ye.predicate,$t,void 0,mr);return zi&&zi.placeable&&(this.markUsedOrientation(te,_n,er),this.placedOrientations[er.crossTileID]=_n),zi};Fn(()=>ki($n,R.an.horizontal),()=>{const xi=Ar.verticalTextBox;return te.allowVerticalPlacement&&er.numVerticalGlyphVertices>0&&xi?ki(xi,R.an.vertical):{box:null,offscreen:null}}),wn(vi&&vi.placeable)}else{let ki=R.aD[(Ri=(di=this.prevPlacement)===null||di===void 0?void 0:di.variableOffsets[er.crossTileID])===null||Ri===void 0?void 0:Ri.anchor];const xi=(zi,Kl,jc)=>{const Lu=zi.x2-zi.x1,zo=zi.y2-zi.y1,no=er.textBoxScale,Yn=vt&&xt==="never"?Kl:null;let rn=null,Xn=ot==="never"?1:2,Bu="never";ki&&Xn++;for(let _a=0;_a<Xn;_a++){for(let ju=pa;ju<Ra;ju++){const Nu=te.textAnchorOffsets.get(ju);if(ki&&Nu.textAnchor!==ki)continue;const Uo=this.attemptAnchorPlacement(Nu,zi,Lu,zo,no,Tt,Pt,Se,zt,ge,Ye,Bu,er,te,jc,de,_e,Yn,$t);if(Uo&&(rn=Uo.placedGlyphBoxes,rn&&rn.placeable))return _i=!0,mi=Uo.shift,rn}ki?ki=null:Bu=ot}return J&&!rn&&(rn={box:this.collisionIndex.placeCollisionBox($n,"always",Se,zt,ge,Pt,Tt,de,Ye.predicate,$t,void 0,mr).box,offscreen:!1,placeable:!1,occluded:!1}),rn};Fn(()=>xi($n,Ar.iconBox,R.an.horizontal),()=>{const zi=Ar.verticalTextBox;return te.allowVerticalPlacement&&(!vi||!vi.placeable)&&er.numVerticalGlyphVertices>0&&zi?xi(zi,Ar.verticalIconBox,R.an.vertical):{box:null,occluded:!0,offscreen:null}}),vi&&(_i=vi.placeable,gi=vi.offscreen);const _n=wn(vi&&vi.placeable);if(!_i&&this.prevPlacement){const zi=this.prevPlacement.variableOffsets[er.crossTileID];zi&&(this.variableOffsets[er.crossTileID]=zi,this.markUsedJustification(te,zi.anchor,er,_n))}}}if(li=vi,_i=li&&li.placeable,gi=li&&li.offscreen,er.useRuntimeCollisionCircles){const wn=te.text.placedSymbolArray.get(er.centerJustifiedTextSymbolIndex),Fn=R.ao(te.textSizeData,je,wn),pa=se.get("text-padding");Hi=this.collisionIndex.placeCollisionCircles(ot,wn,te.lineVertexArray,te.glyphOffsetArray,Fn,ge,xe,J,Pt,Ye.predicate,er.collisionCircleDiameter,pa,de,$t),Hi.circles.length&&Hi.collisionDetected&&!J&&R.w("Collisions detected, but collision boxes are not shown"),_i=ht||Hi.circles.length>0&&!Hi.collisionDetected,gi=gi&&Hi.offscreen}if(Ar.iconFeatureIndex&&(fa=Ar.iconFeatureIndex),Ar.iconBox){const wn=Fn=>this.collisionIndex.placeCollisionBox(Fn,xt,Se,zt,ge,Pt,Tt,_e,Ye.predicate,$t,vt&&mi?mi:void 0,mr);en&&en.placeable&&Ar.verticalIconBox?(tn=wn(Ar.verticalIconBox),Ai=tn.placeable):(tn=wn(Ar.iconBox),Ai=tn.placeable),gi=gi&&tn.offscreen}const jo=at||er.numHorizontalGlyphVertices===0&&er.numVerticalGlyphVertices===0,No=nt||er.numIconVertices===0;jo||No?No?jo||(Ai=Ai&&_i):_i=Ai&&_i:Ai=_i=Ai&&_i;const io=Ai&&tn.placeable;if(_i&&li.placeable&&this.collisionIndex.insertCollisionBox(li.box,ot,se.get("text-ignore-placement"),te.bucketInstanceId,en&&en.placeable&&da?da:ha,Ye.ID),io&&this.collisionIndex.insertCollisionBox(tn.box,xt,se.get("icon-ignore-placement"),te.bucketInstanceId,fa,Ye.ID),Hi&&_i&&this.collisionIndex.insertCollisionCircles(Hi.circles,ot,se.get("text-ignore-placement"),te.bucketInstanceId,ha,Ye.ID),J&&this.storeCollisionData(te.bucketInstanceId,ti,Ar,li,tn,Hi),er.crossTileID===0)throw new Error("symbolInstance.crossTileID can't be 0");if(te.bucketInstanceId===0)throw new Error("bucket.bucketInstanceId can't be 0");this.placements[er.crossTileID]=new qi((_i||Vt)&&!(li!=null&&li.occluded),(Ai||jt)&&!(tn!=null&&tn.occluded),gi||te.justReloaded),G[er.crossTileID]=!0};if(kt){if(t.symbolInstanceStart!==0)throw new Error("bucket.bucketInstanceId should be 0");const er=te.getSortedSymbolIndexes(-this.transform.bearingInRadians);for(let Ar=er.length-1;Ar>=0;--Ar){const ti=er[Ar];_r(te.symbolInstances.get(ti),te.collisionArrays[ti],ti)}}else for(let er=t.symbolInstanceStart;er<t.symbolInstanceEnd;er++)_r(te.symbolInstances.get(er),te.collisionArrays[er],er);te.justReloaded=!1}storeCollisionData(t,G,J,te,se,de){if(J.textBox||J.iconBox){let _e,ge;this.collisionBoxArrays.has(t)?_e=this.collisionBoxArrays.get(t):(_e=new Map,this.collisionBoxArrays.set(t,_e)),_e.has(G)?ge=_e.get(G):(ge={text:null,icon:null},_e.set(G,ge)),J.textBox&&(ge.text=te.box),J.iconBox&&(ge.icon=se.box)}if(de){let _e=this.collisionCircleArrays[t];_e===void 0&&(_e=this.collisionCircleArrays[t]=[]);for(let ge=0;ge<de.circles.length;ge+=4)_e.push(de.circles[ge+0]-ri),_e.push(de.circles[ge+1]-ri),_e.push(de.circles[ge+2]),_e.push(de.collisionDetected?1:0)}}markUsedJustification(t,G,J,te){let se;se=te===R.an.vertical?J.verticalPlacedTextSymbolIndex:{left:J.leftJustifiedTextSymbolIndex,center:J.centerJustifiedTextSymbolIndex,right:J.rightJustifiedTextSymbolIndex}[R.aF(G)];const de=[J.leftJustifiedTextSymbolIndex,J.centerJustifiedTextSymbolIndex,J.rightJustifiedTextSymbolIndex,J.verticalPlacedTextSymbolIndex];for(const _e of de)_e>=0&&(t.text.placedSymbolArray.get(_e).crossTileID=se>=0&&_e!==se?0:J.crossTileID)}markUsedOrientation(t,G,J){const te=G===R.an.horizontal||G===R.an.horizontalOnly?G:0,se=G===R.an.vertical?G:0,de=[J.leftJustifiedTextSymbolIndex,J.centerJustifiedTextSymbolIndex,J.rightJustifiedTextSymbolIndex];for(const _e of de)t.text.placedSymbolArray.get(_e).placedOrientation=te;J.verticalPlacedTextSymbolIndex&&(t.text.placedSymbolArray.get(J.verticalPlacedTextSymbolIndex).placedOrientation=se)}commit(t){this.commitTime=t,this.zoomAtLastRecencyCheck=this.transform.zoom;const G=this.prevPlacement;let J=!1;this.prevZoomAdjustment=G?G.zoomAdjustment(this.transform.zoom):0;const te=G?G.symbolFadeChange(t):1,se=G?G.opacities:{},de=G?G.variableOffsets:{},_e=G?G.placedOrientations:{};for(const ge in this.placements){const xe=this.placements[ge],Se=se[ge];Se?(this.opacities[ge]=new hr(Se,te,xe.text,xe.icon),J=J||xe.text!==Se.text.placed||xe.icon!==Se.icon.placed):(this.opacities[ge]=new hr(null,te,xe.text,xe.icon,xe.skipFade),J=J||xe.text||xe.icon)}for(const ge in se){const xe=se[ge];if(!this.opacities[ge]){const Se=new hr(xe,te,!1,!1);Se.isHidden()||(this.opacities[ge]=Se,J=J||xe.text.placed||xe.icon.placed)}}for(const ge in de)this.variableOffsets[ge]||!this.opacities[ge]||this.opacities[ge].isHidden()||(this.variableOffsets[ge]=de[ge]);for(const ge in _e)this.placedOrientations[ge]||!this.opacities[ge]||this.opacities[ge].isHidden()||(this.placedOrientations[ge]=_e[ge]);if(G&&G.lastPlacementChangeTime===void 0)throw new Error("Last placement time for previous placement is not defined");J?this.lastPlacementChangeTime=t:typeof this.lastPlacementChangeTime!="number"&&(this.lastPlacementChangeTime=G?G.lastPlacementChangeTime:t)}updateLayerOpacities(t,G){const J={};for(const te of G){const se=te.getBucket(t);se&&te.latestFeatureIndex&&t.id===se.layerIds[0]&&this.updateBucketOpacities(se,te.tileID,J,te.collisionBoxArray)}}updateBucketOpacities(t,G,J,te){t.hasTextData()&&(t.text.opacityVertexArray.clear(),t.text.hasVisibleVertices=!1),t.hasIconData()&&(t.icon.opacityVertexArray.clear(),t.icon.hasVisibleVertices=!1),t.hasIconCollisionBoxData()&&t.iconCollisionBox.collisionVertexArray.clear(),t.hasTextCollisionBoxData()&&t.textCollisionBox.collisionVertexArray.clear();const se=t.layers[0],de=se.layout,_e=new hr(null,0,!1,!1,!0),ge=de.get("text-allow-overlap"),xe=de.get("icon-allow-overlap"),Se=se._unevaluatedLayout.hasValue("text-variable-anchor")||se._unevaluatedLayout.hasValue("text-variable-anchor-offset"),Oe=de.get("text-rotation-alignment")==="map",Ae=de.get("text-pitch-alignment")==="map",je=de.get("icon-text-fit")!=="none",Ye=new hr(null,0,ge&&(xe||!t.hasIconData()||de.get("icon-optional")),xe&&(ge||!t.hasTextData()||de.get("text-optional")),!0);!t.collisionArrays&&te&&(t.hasIconCollisionBoxData()||t.hasTextCollisionBoxData())&&t.deserializeCollisionBoxes(te);const at=(ot,ht,xt)=>{for(let mt=0;mt<ht/4;mt++)ot.opacityVertexArray.emplaceBack(xt);ot.hasVisibleVertices=ot.hasVisibleVertices||xt!==co},nt=this.collisionBoxArrays.get(t.bucketInstanceId);for(let ot=0;ot<t.symbolInstances.length;ot++){const ht=t.symbolInstances.get(ot),{numHorizontalGlyphVertices:xt,numVerticalGlyphVertices:mt,crossTileID:Tt}=ht;let Pt=this.opacities[Tt];J[Tt]?Pt=_e:Pt||(Pt=Ye,this.opacities[Tt]=Pt),J[Tt]=!0;const vt=ht.numIconVertices>0,kt=this.placedOrientations[ht.crossTileID],Vt=kt===R.an.vertical,jt=kt===R.an.horizontal||kt===R.an.horizontalOnly;if(xt>0||mt>0){const $t=sl(Pt.text);at(t.text,xt,Vt?co:$t),at(t.text,mt,jt?co:$t);const mr=Pt.text.isHidden();[ht.rightJustifiedTextSymbolIndex,ht.centerJustifiedTextSymbolIndex,ht.leftJustifiedTextSymbolIndex].forEach(Ar=>{Ar>=0&&(t.text.placedSymbolArray.get(Ar).hidden=mr||Vt?1:0)}),ht.verticalPlacedTextSymbolIndex>=0&&(t.text.placedSymbolArray.get(ht.verticalPlacedTextSymbolIndex).hidden=mr||jt?1:0);const _r=this.variableOffsets[ht.crossTileID];_r&&this.markUsedJustification(t,_r.anchor,ht,kt);const er=this.placedOrientations[ht.crossTileID];er&&(this.markUsedJustification(t,"left",ht,er),this.markUsedOrientation(t,er,ht))}if(vt){const $t=sl(Pt.icon),mr=!(je&&ht.verticalPlacedIconSymbolIndex&&Vt);ht.placedIconSymbolIndex>=0&&(at(t.icon,ht.numIconVertices,mr?$t:co),t.icon.placedSymbolArray.get(ht.placedIconSymbolIndex).hidden=Pt.icon.isHidden()),ht.verticalPlacedIconSymbolIndex>=0&&(at(t.icon,ht.numVerticalIconVertices,mr?co:$t),t.icon.placedSymbolArray.get(ht.verticalPlacedIconSymbolIndex).hidden=Pt.icon.isHidden())}const zt=nt&&nt.has(ot)?nt.get(ot):{text:null,icon:null};if(t.hasIconCollisionBoxData()||t.hasTextCollisionBoxData()){const $t=t.collisionArrays[ot];if($t){let mr=new R.P(0,0);if($t.textBox||$t.verticalTextBox){let _r=!0;if(Se){const er=this.variableOffsets[Tt];er?(mr=lo(er.anchor,er.width,er.height,er.textOffset,er.textBoxScale),Oe&&mr._rotate(Ae?-this.transform.bearingInRadians:this.transform.bearingInRadians)):_r=!1}if($t.textBox||$t.verticalTextBox){let er;$t.textBox&&(er=Vt),$t.verticalTextBox&&(er=jt),ia(t.textCollisionBox.collisionVertexArray,Pt.text.placed,!_r||er,zt.text,mr.x,mr.y)}}if($t.iconBox||$t.verticalIconBox){const _r=!!(!jt&&$t.verticalIconBox);let er;$t.iconBox&&(er=_r),$t.verticalIconBox&&(er=!_r),ia(t.iconCollisionBox.collisionVertexArray,Pt.icon.placed,er,zt.icon,je?mr.x:0,je?mr.y:0)}}}}if(t.sortFeatures(-this.transform.bearingInRadians),this.retainedQueryData[t.bucketInstanceId]&&(this.retainedQueryData[t.bucketInstanceId].featureSortOrder=t.featureSortOrder),t.hasTextData()&&t.text.opacityVertexBuffer&&t.text.opacityVertexBuffer.updateData(t.text.opacityVertexArray),t.hasIconData()&&t.icon.opacityVertexBuffer&&t.icon.opacityVertexBuffer.updateData(t.icon.opacityVertexArray),t.hasIconCollisionBoxData()&&t.iconCollisionBox.collisionVertexBuffer&&t.iconCollisionBox.collisionVertexBuffer.updateData(t.iconCollisionBox.collisionVertexArray),t.hasTextCollisionBoxData()&&t.textCollisionBox.collisionVertexBuffer&&t.textCollisionBox.collisionVertexBuffer.updateData(t.textCollisionBox.collisionVertexArray),t.text.opacityVertexArray.length!==t.text.layoutVertexArray.length/4)throw new Error(`bucket.text.opacityVertexArray.length (= ${t.text.opacityVertexArray.length}) !== bucket.text.layoutVertexArray.length (= ${t.text.layoutVertexArray.length}) / 4`);if(t.icon.opacityVertexArray.length!==t.icon.layoutVertexArray.length/4)throw new Error(`bucket.icon.opacityVertexArray.length (= ${t.icon.opacityVertexArray.length}) !== bucket.icon.layoutVertexArray.length (= ${t.icon.layoutVertexArray.length}) / 4`);t.bucketInstanceId in this.collisionCircleArrays&&(t.collisionCircleArray=this.collisionCircleArrays[t.bucketInstanceId],delete this.collisionCircleArrays[t.bucketInstanceId])}symbolFadeChange(t){return this.fadeDuration===0?1:(t-this.commitTime)/this.fadeDuration+this.prevZoomAdjustment}zoomAdjustment(t){return Math.max(0,(this.transform.zoom-t)/1.5)}hasTransitions(t){return this.stale||t-this.lastPlacementChangeTime<this.fadeDuration}stillRecent(t,G){const J=this.zoomAtLastRecencyCheck===G?1-this.zoomAdjustment(G):1;return this.zoomAtLastRecencyCheck=G,this.commitTime+this.fadeDuration*J>t}setStale(){this.stale=!0}}function ia(oe,t,G,J,te,se){J&&J.length!==0||(J=[0,0,0,0]);const de=J[0]-ri,_e=J[1]-ri,ge=J[2]-ri,xe=J[3]-ri;oe.emplaceBack(t?1:0,G?1:0,te||0,se||0,de,_e),oe.emplaceBack(t?1:0,G?1:0,te||0,se||0,ge,_e),oe.emplaceBack(t?1:0,G?1:0,te||0,se||0,ge,xe),oe.emplaceBack(t?1:0,G?1:0,te||0,se||0,de,xe)}const ya=Math.pow(2,25),na=Math.pow(2,24),il=Math.pow(2,17),nl=Math.pow(2,16),al=Math.pow(2,9),Oa=Math.pow(2,8),ol=Math.pow(2,1);function sl(oe){if(oe.opacity===0&&!oe.placed)return 0;if(oe.opacity===1&&oe.placed)return 4294967295;const t=oe.placed?1:0,G=Math.floor(127*oe.opacity);return G*ya+t*na+G*il+t*nl+G*al+t*Oa+G*ol+t}const co=0;class fc{constructor(t){this._sortAcrossTiles=t.layout.get("symbol-z-order")!=="viewport-y"&&!t.layout.get("symbol-sort-key").isConstant(),this._currentTileIndex=0,this._currentPartIndex=0,this._seenCrossTileIDs={},this._bucketParts=[]}continuePlacement(t,G,J,te,se){const de=this._bucketParts;for(;this._currentTileIndex<t.length;)if(G.getBucketParts(de,te,t[this._currentTileIndex],this._sortAcrossTiles),this._currentTileIndex++,se())return!0;for(this._sortAcrossTiles&&(this._sortAcrossTiles=!1,de.sort((_e,ge)=>_e.sortKey-ge.sortKey));this._currentPartIndex<de.length;)if(G.placeLayerBucketPart(de[this._currentPartIndex],this._seenCrossTileIDs,J),this._currentPartIndex++,se())return!0;return!1}}class ul{constructor(t,G,J,te,se,de,_e,ge){this.placement=new ra(t,G,de,_e,ge),this._currentPlacementIndex=J.length-1,this._forceFullPlacement=te,this._showCollisionBoxes=se,this._done=!1}isDone(){return this._done}continuePlacement(t,G,J){const te=pe.now(),se=()=>!this._forceFullPlacement&&pe.now()-te>2;for(;this._currentPlacementIndex>=0;){const de=G[t[this._currentPlacementIndex]],_e=this.placement.collisionIndex.transform.zoom;if(de.type==="symbol"&&(!de.minzoom||de.minzoom<=_e)&&(!de.maxzoom||de.maxzoom>_e)){if(this._inProgressLayer||(this._inProgressLayer=new fc(de)),this._inProgressLayer.continuePlacement(J[de.source],this.placement,this._showCollisionBoxes,de,se))return;delete this._inProgressLayer}this._currentPlacementIndex--}this._done=!0}commit(t){return this.placement.commit(t),this.placement}}const Ca=512/R.$/2;class Ws{constructor(t,G,J){this.tileID=t,this.bucketInstanceId=J,this._symbolsByKey={};const te=new Map;for(let se=0;se<G.length;se++){const de=G.get(se),_e=de.key,ge=te.get(_e);ge?ge.push(de):te.set(_e,[de])}for(const[se,de]of te){const _e={positions:de.map(ge=>({x:Math.floor(ge.anchorX*Ca),y:Math.floor(ge.anchorY*Ca)})),crossTileIDs:de.map(ge=>ge.crossTileID)};if(_e.positions.length>128){const ge=new R.aH(_e.positions.length,16,Uint16Array);for(const{x:xe,y:Se}of _e.positions)ge.add(xe,Se);ge.finish(),delete _e.positions,_e.index=ge}this._symbolsByKey[se]=_e}}getScaledCoordinates(t,G){const{x:J,y:te,z:se}=this.tileID.canonical,{x:de,y:_e,z:ge}=G.canonical,xe=Ca/Math.pow(2,ge-se),Se=(_e*R.$+t.anchorY)*xe,Oe=te*R.$*Ca;return{x:Math.floor((de*R.$+t.anchorX)*xe-J*R.$*Ca),y:Math.floor(Se-Oe)}}findMatches(t,G,J){const te=this.tileID.canonical.z<G.canonical.z?1:Math.pow(2,this.tileID.canonical.z-G.canonical.z);for(let se=0;se<t.length;se++){const de=t.get(se);if(de.crossTileID)continue;const _e=this._symbolsByKey[de.key];if(!_e)continue;const ge=this.getScaledCoordinates(de,G);if(_e.index){const xe=_e.index.range(ge.x-te,ge.y-te,ge.x+te,ge.y+te).sort();for(const Se of xe){const Oe=_e.crossTileIDs[Se];if(!J[Oe]){J[Oe]=!0,de.crossTileID=Oe;break}}}else if(_e.positions)for(let xe=0;xe<_e.positions.length;xe++){const Se=_e.positions[xe],Oe=_e.crossTileIDs[xe];if(Math.abs(Se.x-ge.x)<=te&&Math.abs(Se.y-ge.y)<=te&&!J[Oe]){J[Oe]=!0,de.crossTileID=Oe;break}}}}getCrossTileIDsLists(){return Object.values(this._symbolsByKey).map(({crossTileIDs:t})=>t)}}class Hs{constructor(){this.maxCrossTileID=0}generate(){return++this.maxCrossTileID}}class ll{constructor(){this.indexes={},this.usedCrossTileIDs={},this.lng=0}handleWrapJump(t){const G=Math.round((t-this.lng)/360);if(G!==0)for(const J in this.indexes){const te=this.indexes[J],se={};for(const de in te){const _e=te[de];_e.tileID=_e.tileID.unwrapTo(_e.tileID.wrap+G),se[_e.tileID.key]=_e}this.indexes[J]=se}this.lng=t}addBucket(t,G,J){if(this.indexes[t.overscaledZ]&&this.indexes[t.overscaledZ][t.key]){if(this.indexes[t.overscaledZ][t.key].bucketInstanceId===G.bucketInstanceId)return!1;this.removeBucketCrossTileIDs(t.overscaledZ,this.indexes[t.overscaledZ][t.key])}for(let se=0;se<G.symbolInstances.length;se++)G.symbolInstances.get(se).crossTileID=0;this.usedCrossTileIDs[t.overscaledZ]||(this.usedCrossTileIDs[t.overscaledZ]={});const te=this.usedCrossTileIDs[t.overscaledZ];for(const se in this.indexes){const de=this.indexes[se];if(Number(se)>t.overscaledZ)for(const _e in de){const ge=de[_e];ge.tileID.isChildOf(t)&&ge.findMatches(G.symbolInstances,t,te)}else{const _e=de[t.scaledTo(Number(se)).key];_e&&_e.findMatches(G.symbolInstances,t,te)}}for(let se=0;se<G.symbolInstances.length;se++){const de=G.symbolInstances.get(se);de.crossTileID||(de.crossTileID=J.generate(),te[de.crossTileID]=!0)}return this.indexes[t.overscaledZ]===void 0&&(this.indexes[t.overscaledZ]={}),this.indexes[t.overscaledZ][t.key]=new Ws(t,G.symbolInstances,G.bucketInstanceId),!0}removeBucketCrossTileIDs(t,G){for(const J of G.getCrossTileIDsLists())for(const te of J)delete this.usedCrossTileIDs[t][te]}removeStaleBuckets(t){let G=!1;for(const J in this.indexes){const te=this.indexes[J];for(const se in te)t[te[se].bucketInstanceId]||(this.removeBucketCrossTileIDs(J,te[se]),delete te[se],G=!0)}return G}}class Xo{constructor(){this.layerIndexes={},this.crossTileIDs=new Hs,this.maxBucketInstanceId=0,this.bucketsInCurrentPlacement={}}addLayer(t,G,J){let te=this.layerIndexes[t.id];te===void 0&&(te=this.layerIndexes[t.id]=new ll);let se=!1;const de={};te.handleWrapJump(J);for(const _e of G){const ge=_e.getBucket(t);ge&&t.id===ge.layerIds[0]&&(ge.bucketInstanceId||(ge.bucketInstanceId=++this.maxBucketInstanceId),te.addBucket(_e.tileID,ge,this.crossTileIDs)&&(se=!0),de[ge.bucketInstanceId]=!0)}return te.removeStaleBuckets(de)&&(se=!0),se}pruneUnusedLayers(t){const G={};t.forEach(J=>{G[J]=!0});for(const J in this.layerIndexes)G[J]||delete this.layerIndexes[J]}}var Jo="void main() {fragColor=vec4(1.0);}";const Nn={prelude:ii(`#ifdef GL_ES
precision mediump float;
#else
#if !defined(lowp)
#define lowp
#endif
#if !defined(mediump)
#define mediump
#endif
#if !defined(highp)
#define highp
#endif
#endif
out highp vec4 fragColor;`,`#ifdef GL_ES
precision highp float;
#else
#if !defined(lowp)
#define lowp
#endif
#if !defined(mediump)
#define mediump
#endif
#if !defined(highp)
#define highp
#endif
#endif
vec2 unpack_float(const float packedValue) {int packedIntValue=int(packedValue);int v0=packedIntValue/256;return vec2(v0,packedIntValue-v0*256);}vec2 unpack_opacity(const float packedOpacity) {int intOpacity=int(packedOpacity)/2;return vec2(float(intOpacity)/127.0,mod(packedOpacity,2.0));}vec4 decode_color(const vec2 encodedColor) {return vec4(unpack_float(encodedColor[0])/255.0,unpack_float(encodedColor[1])/255.0
);}float unpack_mix_vec2(const vec2 packedValue,const float t) {return mix(packedValue[0],packedValue[1],t);}vec4 unpack_mix_color(const vec4 packedColors,const float t) {vec4 minColor=decode_color(vec2(packedColors[0],packedColors[1]));vec4 maxColor=decode_color(vec2(packedColors[2],packedColors[3]));return mix(minColor,maxColor,t);}vec2 get_pattern_pos(const vec2 pixel_coord_upper,const vec2 pixel_coord_lower,const vec2 pattern_size,const float tile_units_to_pixels,const vec2 pos) {vec2 offset=mod(mod(mod(pixel_coord_upper,pattern_size)*256.0,pattern_size)*256.0+pixel_coord_lower,pattern_size);return (tile_units_to_pixels*pos+offset)/pattern_size;}mat3 rotationMatrixFromAxisAngle(vec3 u,float angle) {float c=cos(angle);float s=sin(angle);float c2=1.0-c;return mat3(u.x*u.x*c2+      c,u.x*u.y*c2-u.z*s,u.x*u.z*c2+u.y*s,u.y*u.x*c2+u.z*s,u.y*u.y*c2+    c,u.y*u.z*c2-u.x*s,u.z*u.x*c2-u.y*s,u.z*u.y*c2+u.x*s,u.z*u.z*c2+    c
);}
#ifdef TERRAIN3D
uniform sampler2D u_terrain;uniform float u_terrain_dim;uniform mat4 u_terrain_matrix;uniform vec4 u_terrain_unpack;uniform float u_terrain_exaggeration;uniform highp sampler2D u_depth;
#endif
const highp vec4 bitSh=vec4(256.*256.*256.,256.*256.,256.,1.);const highp vec4 bitShifts=vec4(1.)/bitSh;highp float unpack(highp vec4 color) {return dot(color,bitShifts);}highp float depthOpacity(vec3 frag) {
#ifdef TERRAIN3D
highp float d=unpack(texture(u_depth,frag.xy*0.5+0.5))+0.0001-frag.z;return 1.0-max(0.0,min(1.0,-d*500.0));
#else
return 1.0;
#endif
}float calculate_visibility(vec4 pos) {
#ifdef TERRAIN3D
vec3 frag=pos.xyz/pos.w;highp float d=depthOpacity(frag);if (d > 0.95) return 1.0;return (d+depthOpacity(frag+vec3(0.0,0.01,0.0)))/2.0;
#else
return 1.0;
#endif
}float ele(vec2 pos) {
#ifdef TERRAIN3D
vec4 rgb=(texture(u_terrain,pos)*255.0)*u_terrain_unpack;return rgb.r+rgb.g+rgb.b-u_terrain_unpack.a;
#else
return 0.0;
#endif
}float get_elevation(vec2 pos) {
#ifdef TERRAIN3D
#ifdef GLOBE
if ((pos.y <-32767.5) || (pos.y > 32766.5)) {return 0.0;}
#endif
vec2 coord=(u_terrain_matrix*vec4(pos,0.0,1.0)).xy*u_terrain_dim+1.0;vec2 f=fract(coord);vec2 c=(floor(coord)+0.5)/(u_terrain_dim+2.0);float d=1.0/(u_terrain_dim+2.0);float tl=ele(c);float tr=ele(c+vec2(d,0.0));float bl=ele(c+vec2(0.0,d));float br=ele(c+vec2(d,d));float elevation=mix(mix(tl,tr,f.x),mix(bl,br,f.x),f.y);return elevation*u_terrain_exaggeration;
#else
return 0.0;
#endif
}const float PI=3.141592653589793;uniform mat4 u_projection_matrix;`),projectionMercator:ii("","float projectLineThickness(float tileY) {return 1.0;}float projectCircleRadius(float tileY) {return 1.0;}vec4 projectTile(vec2 p) {vec4 result=u_projection_matrix*vec4(p,0.0,1.0);return result;}vec4 projectTile(vec2 p,vec2 rawPos) {vec4 result=u_projection_matrix*vec4(p,0.0,1.0);if (rawPos.y <-32767.5 || rawPos.y > 32766.5) {result.z=-10000000.0;}return result;}vec4 projectTileWithElevation(vec2 posInTile,float elevation) {return u_projection_matrix*vec4(posInTile,elevation,1.0);}vec4 projectTileFor3D(vec2 posInTile,float elevation) {return projectTileWithElevation(posInTile,elevation);}"),projectionGlobe:ii("",`#define GLOBE_RADIUS 6371008.8
uniform highp vec4 u_projection_tile_mercator_coords;uniform highp vec4 u_projection_clipping_plane;uniform highp float u_projection_transition;uniform mat4 u_projection_fallback_matrix;vec3 globeRotateVector(vec3 vec,vec2 angles) {vec3 axisRight=vec3(vec.z,0.0,-vec.x);vec3 axisUp=cross(axisRight,vec);axisRight=normalize(axisRight);axisUp=normalize(axisUp);vec2 t=tan(angles);return normalize(vec+axisRight*t.x+axisUp*t.y);}mat3 globeGetRotationMatrix(vec3 spherePos) {vec3 axisRight=vec3(spherePos.z,0.0,-spherePos.x);vec3 axisDown=cross(axisRight,spherePos);axisRight=normalize(axisRight);axisDown=normalize(axisDown);return mat3(axisRight,axisDown,spherePos
);}float circumferenceRatioAtTileY(float tileY) {float mercator_pos_y=u_projection_tile_mercator_coords.y+u_projection_tile_mercator_coords.w*tileY;float spherical_y=2.0*atan(exp(PI-(mercator_pos_y*PI*2.0)))-PI*0.5;return cos(spherical_y);}float projectLineThickness(float tileY) {float thickness=1.0/circumferenceRatioAtTileY(tileY); 
if (u_projection_transition < 0.999) {return mix(1.0,thickness,u_projection_transition);} else {return thickness;}}vec3 projectToSphere(vec2 translatedPos,vec2 rawPos) {vec2 mercator_pos=u_projection_tile_mercator_coords.xy+u_projection_tile_mercator_coords.zw*translatedPos;vec2 spherical;spherical.x=mercator_pos.x*PI*2.0+PI;spherical.y=2.0*atan(exp(PI-(mercator_pos.y*PI*2.0)))-PI*0.5;float len=cos(spherical.y);vec3 pos=vec3(sin(spherical.x)*len,sin(spherical.y),cos(spherical.x)*len
);if (rawPos.y <-32767.5) {pos=vec3(0.0,1.0,0.0);}if (rawPos.y > 32766.5) {pos=vec3(0.0,-1.0,0.0);}return pos;}vec3 projectToSphere(vec2 posInTile) {return projectToSphere(posInTile,vec2(0.0,0.0));}float globeComputeClippingZ(vec3 spherePos) {return (1.0-(dot(spherePos,u_projection_clipping_plane.xyz)+u_projection_clipping_plane.w));}vec4 interpolateProjection(vec2 posInTile,vec3 spherePos,float elevation) {vec3 elevatedPos=spherePos*(1.0+elevation/GLOBE_RADIUS);vec4 globePosition=u_projection_matrix*vec4(elevatedPos,1.0);globePosition.z=globeComputeClippingZ(elevatedPos)*globePosition.w;if (u_projection_transition > 0.999) {return globePosition;}vec4 flatPosition=u_projection_fallback_matrix*vec4(posInTile,elevation,1.0);const float z_globeness_threshold=0.2;vec4 result=globePosition;result.z=mix(0.0,globePosition.z,clamp((u_projection_transition-z_globeness_threshold)/(1.0-z_globeness_threshold),0.0,1.0));result.xyw=mix(flatPosition.xyw,globePosition.xyw,u_projection_transition);if ((posInTile.y <-32767.5) || (posInTile.y > 32766.5)) {result=globePosition;const float poles_hidden_anim_percentage=0.02;result.z=mix(globePosition.z,100.0,pow(max((1.0-u_projection_transition)/poles_hidden_anim_percentage,0.0),8.0));}return result;}vec4 interpolateProjectionFor3D(vec2 posInTile,vec3 spherePos,float elevation) {vec3 elevatedPos=spherePos*(1.0+elevation/GLOBE_RADIUS);vec4 globePosition=u_projection_matrix*vec4(elevatedPos,1.0);if (u_projection_transition > 0.999) {return globePosition;}vec4 fallbackPosition=u_projection_fallback_matrix*vec4(posInTile,elevation,1.0);return mix(fallbackPosition,globePosition,u_projection_transition);}vec4 projectTile(vec2 posInTile) {return interpolateProjection(posInTile,projectToSphere(posInTile),0.0);}vec4 projectTile(vec2 posInTile,vec2 rawPos) {return interpolateProjection(posInTile,projectToSphere(posInTile,rawPos),0.0);}vec4 projectTileWithElevation(vec2 posInTile,float elevation) {return interpolateProjection(posInTile,projectToSphere(posInTile),elevation);}vec4 projectTileFor3D(vec2 posInTile,float elevation) {vec3 spherePos=projectToSphere(posInTile,posInTile);return interpolateProjectionFor3D(posInTile,spherePos,elevation);}`),background:ii(`uniform vec4 u_color;uniform float u_opacity;void main() {fragColor=u_color*u_opacity;
#ifdef OVERDRAW_INSPECTOR
fragColor=vec4(1.0);
#endif
}`,"in vec2 a_pos;void main() {gl_Position=projectTile(a_pos);}"),backgroundPattern:ii(`uniform vec2 u_pattern_tl_a;uniform vec2 u_pattern_br_a;uniform vec2 u_pattern_tl_b;uniform vec2 u_pattern_br_b;uniform vec2 u_texsize;uniform float u_mix;uniform float u_opacity;uniform sampler2D u_image;in vec2 v_pos_a;in vec2 v_pos_b;void main() {vec2 imagecoord=mod(v_pos_a,1.0);vec2 pos=mix(u_pattern_tl_a/u_texsize,u_pattern_br_a/u_texsize,imagecoord);vec4 color1=texture(u_image,pos);vec2 imagecoord_b=mod(v_pos_b,1.0);vec2 pos2=mix(u_pattern_tl_b/u_texsize,u_pattern_br_b/u_texsize,imagecoord_b);vec4 color2=texture(u_image,pos2);fragColor=mix(color1,color2,u_mix)*u_opacity;
#ifdef OVERDRAW_INSPECTOR
fragColor=vec4(1.0);
#endif
}`,"uniform vec2 u_pattern_size_a;uniform vec2 u_pattern_size_b;uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform float u_scale_a;uniform float u_scale_b;uniform float u_tile_units_to_pixels;in vec2 a_pos;out vec2 v_pos_a;out vec2 v_pos_b;void main() {gl_Position=projectTile(a_pos);v_pos_a=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,u_scale_a*u_pattern_size_a,u_tile_units_to_pixels,a_pos);v_pos_b=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,u_scale_b*u_pattern_size_b,u_tile_units_to_pixels,a_pos);}"),circle:ii(`in vec3 v_data;in float v_visibility;
#pragma mapbox: define highp vec4 color
#pragma mapbox: define mediump float radius
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define highp vec4 stroke_color
#pragma mapbox: define mediump float stroke_width
#pragma mapbox: define lowp float stroke_opacity
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize mediump float radius
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize highp vec4 stroke_color
#pragma mapbox: initialize mediump float stroke_width
#pragma mapbox: initialize lowp float stroke_opacity
vec2 extrude=v_data.xy;float extrude_length=length(extrude);float antialiased_blur=v_data.z;float opacity_t=smoothstep(0.0,antialiased_blur,extrude_length-1.0);float color_t=stroke_width < 0.01 ? 0.0 : smoothstep(antialiased_blur,0.0,extrude_length-radius/(radius+stroke_width));fragColor=v_visibility*opacity_t*mix(color*opacity,stroke_color*stroke_opacity,color_t);const float epsilon=0.5/255.0;if (fragColor.r < epsilon && fragColor.g < epsilon && fragColor.b < epsilon && fragColor.a < epsilon) {discard;}
#ifdef OVERDRAW_INSPECTOR
fragColor=vec4(1.0);
#endif
}`,`uniform bool u_scale_with_map;uniform bool u_pitch_with_map;uniform vec2 u_extrude_scale;uniform highp float u_globe_extrude_scale;uniform lowp float u_device_pixel_ratio;uniform highp float u_camera_to_center_distance;uniform vec2 u_translate;in vec2 a_pos;out vec3 v_data;out float v_visibility;
#pragma mapbox: define highp vec4 color
#pragma mapbox: define mediump float radius
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define highp vec4 stroke_color
#pragma mapbox: define mediump float stroke_width
#pragma mapbox: define lowp float stroke_opacity
void main(void) {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize mediump float radius
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize highp vec4 stroke_color
#pragma mapbox: initialize mediump float stroke_width
#pragma mapbox: initialize lowp float stroke_opacity
vec2 pos_raw=a_pos+32768.0;vec2 extrude=vec2(mod(pos_raw,8.0)/7.0*2.0-1.0);vec2 circle_center=floor(pos_raw/8.0)+u_translate;float ele=get_elevation(circle_center);v_visibility=calculate_visibility(projectTileWithElevation(circle_center,ele));if (u_pitch_with_map) {
#ifdef GLOBE
vec3 center_vector=projectToSphere(circle_center);
#endif
float angle_scale=u_globe_extrude_scale;vec2 corner_position=circle_center;if (u_scale_with_map) {angle_scale*=(radius+stroke_width);corner_position+=extrude*u_extrude_scale*(radius+stroke_width);} else {
#ifdef GLOBE
vec4 projected_center=interpolateProjection(circle_center,center_vector,ele);
#else
vec4 projected_center=projectTileWithElevation(circle_center,ele);
#endif
corner_position+=extrude*u_extrude_scale*(radius+stroke_width)*(projected_center.w/u_camera_to_center_distance);angle_scale*=(radius+stroke_width)*(projected_center.w/u_camera_to_center_distance);}
#ifdef GLOBE
vec2 angles=extrude*angle_scale;vec3 corner_vector=globeRotateVector(center_vector,angles);gl_Position=interpolateProjection(corner_position,corner_vector,ele);
#else
gl_Position=projectTileWithElevation(corner_position,ele);
#endif
} else {gl_Position=projectTileWithElevation(circle_center,ele);if (gl_Position.z/gl_Position.w > 1.0) {gl_Position.xy=vec2(10000.0);}if (u_scale_with_map) {gl_Position.xy+=extrude*(radius+stroke_width)*u_extrude_scale*u_camera_to_center_distance;} else {gl_Position.xy+=extrude*(radius+stroke_width)*u_extrude_scale*gl_Position.w;}}float antialiasblur=-max(1.0/u_device_pixel_ratio/(radius+stroke_width),blur);v_data=vec3(extrude.x,extrude.y,antialiasblur);}`),clippingMask:ii(Jo,"in vec2 a_pos;void main() {gl_Position=projectTile(a_pos);}"),heatmap:ii(`uniform highp float u_intensity;in vec2 v_extrude;
#pragma mapbox: define highp float weight
#define GAUSS_COEF 0.3989422804014327
void main() {
#pragma mapbox: initialize highp float weight
float d=-0.5*3.0*3.0*dot(v_extrude,v_extrude);float val=weight*u_intensity*GAUSS_COEF*exp(d);fragColor=vec4(val,1.0,1.0,1.0);
#ifdef OVERDRAW_INSPECTOR
fragColor=vec4(1.0);
#endif
}`,`uniform float u_extrude_scale;uniform float u_opacity;uniform float u_intensity;uniform highp float u_globe_extrude_scale;in vec2 a_pos;out vec2 v_extrude;
#pragma mapbox: define highp float weight
#pragma mapbox: define mediump float radius
const highp float ZERO=1.0/255.0/16.0;
#define GAUSS_COEF 0.3989422804014327
void main(void) {
#pragma mapbox: initialize highp float weight
#pragma mapbox: initialize mediump float radius
vec2 pos_raw=a_pos+32768.0;vec2 unscaled_extrude=vec2(mod(pos_raw,8.0)/7.0*2.0-1.0);float S=sqrt(-2.0*log(ZERO/weight/u_intensity/GAUSS_COEF))/3.0;v_extrude=S*unscaled_extrude;vec2 extrude=v_extrude*radius*u_extrude_scale;vec2 circle_center=floor(pos_raw/8.0);
#ifdef GLOBE
vec2 angles=v_extrude*radius*u_globe_extrude_scale;vec3 center_vector=projectToSphere(circle_center);vec3 corner_vector=globeRotateVector(center_vector,angles);gl_Position=interpolateProjection(circle_center+extrude,corner_vector,0.0);
#else
gl_Position=projectTileFor3D(circle_center+extrude,get_elevation(circle_center));
#endif
}`),heatmapTexture:ii(`uniform sampler2D u_image;uniform sampler2D u_color_ramp;uniform float u_opacity;in vec2 v_pos;void main() {float t=texture(u_image,v_pos).r;vec4 color=texture(u_color_ramp,vec2(t,0.5));fragColor=color*u_opacity;
#ifdef OVERDRAW_INSPECTOR
fragColor=vec4(0.0);
#endif
}`,"uniform mat4 u_matrix;uniform vec2 u_world;in vec2 a_pos;out vec2 v_pos;void main() {gl_Position=u_matrix*vec4(a_pos*u_world,0,1);v_pos.x=a_pos.x;v_pos.y=1.0-a_pos.y;}"),collisionBox:ii("in float v_placed;in float v_notUsed;void main() {float alpha=0.5;fragColor=vec4(1.0,0.0,0.0,1.0)*alpha;if (v_placed > 0.5) {fragColor=vec4(0.0,0.0,1.0,0.5)*alpha;}if (v_notUsed > 0.5) {fragColor*=.1;}}","in vec2 a_anchor_pos;in vec2 a_placed;in vec2 a_box_real;uniform vec2 u_pixel_extrude_scale;out float v_placed;out float v_notUsed;void main() {gl_Position=projectTileWithElevation(a_anchor_pos,get_elevation(a_anchor_pos));gl_Position.xy=((a_box_real+0.5)*u_pixel_extrude_scale*2.0-1.0)*vec2(1.0,-1.0)*gl_Position.w;if (gl_Position.z/gl_Position.w < 1.1) {gl_Position.z=0.5;}v_placed=a_placed.x;v_notUsed=a_placed.y;}"),collisionCircle:ii("in float v_radius;in vec2 v_extrude;in float v_collision;void main() {float alpha=0.5;float stroke_radius=0.9;float distance_to_center=length(v_extrude);float distance_to_edge=abs(distance_to_center-v_radius);float opacity_t=smoothstep(-stroke_radius,0.0,-distance_to_edge);vec4 color=mix(vec4(0.0,0.0,1.0,0.5),vec4(1.0,0.0,0.0,1.0),v_collision);fragColor=color*alpha*opacity_t;}","in vec2 a_pos;in float a_radius;in vec2 a_flags;uniform vec2 u_viewport_size;out float v_radius;out vec2 v_extrude;out float v_collision;void main() {float radius=a_radius;float collision=a_flags.x;float vertexIdx=a_flags.y;vec2 quadVertexOffset=vec2(mix(-1.0,1.0,float(vertexIdx >=2.0)),mix(-1.0,1.0,float(vertexIdx >=1.0 && vertexIdx <=2.0)));vec2 quadVertexExtent=quadVertexOffset*radius;float padding_factor=1.2;v_radius=radius;v_extrude=quadVertexExtent*padding_factor;v_collision=collision;gl_Position=vec4((a_pos/u_viewport_size*2.0-1.0)*vec2(1.0,-1.0),0.0,1.0)+vec4(quadVertexExtent*padding_factor/u_viewport_size*2.0,0.0,0.0);}"),colorRelief:ii(`#ifdef GL_ES
precision highp float;
#endif
uniform sampler2D u_image;uniform vec4 u_unpack;uniform sampler2D u_elevation_stops;uniform sampler2D u_color_stops;uniform int u_color_ramp_size;uniform float u_opacity;in vec2 v_pos;float getElevation(vec2 coord) {vec4 data=texture(u_image,coord)*255.0;data.a=-1.0;return dot(data,u_unpack);}float getElevationStop(int stop) {float x=(float(stop)+0.5)/float(u_color_ramp_size);vec4 data=texture(u_elevation_stops,vec2(x,0))*255.0;data.a=-1.0;return dot(data,u_unpack);}void main() {float el=getElevation(v_pos);int r=(u_color_ramp_size-1);int l=0;float el_l=getElevationStop(l);float el_r=getElevationStop(r);while(r-l > 1){int m=(r+l)/2;float el_m=getElevationStop(m);if(el < el_m){r=m;el_r=el_m;}else
{l=m;el_l=el_m;}}float x=(float(l)+(el-el_l)/(el_r-el_l)+0.5)/float(u_color_ramp_size);fragColor=u_opacity*texture(u_color_stops,vec2(x,0));
#ifdef OVERDRAW_INSPECTOR
fragColor=vec4(1.0);
#endif
}`,"uniform vec2 u_dimension;in vec2 a_pos;out vec2 v_pos;void main() {gl_Position=projectTile(a_pos,a_pos);highp vec2 epsilon=1.0/u_dimension;float scale=(u_dimension.x-2.0)/u_dimension.x;v_pos=(a_pos/8192.0)*scale+epsilon;if (a_pos.y <-32767.5) {v_pos.y=0.0;}if (a_pos.y > 32766.5) {v_pos.y=1.0;}}"),debug:ii("uniform highp vec4 u_color;uniform sampler2D u_overlay;in vec2 v_uv;void main() {vec4 overlay_color=texture(u_overlay,v_uv);fragColor=mix(u_color,overlay_color,overlay_color.a);}","in vec2 a_pos;out vec2 v_uv;uniform float u_overlay_scale;void main() {v_uv=a_pos/8192.0;gl_Position=projectTileWithElevation(a_pos*u_overlay_scale,get_elevation(a_pos));}"),depth:ii(Jo,`in vec2 a_pos;void main() {
#ifdef GLOBE
gl_Position=projectTileFor3D(a_pos,0.0);
#else
gl_Position=u_projection_matrix*vec4(a_pos,0.0,1.0);
#endif
}`),fill:ii(`#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float opacity
fragColor=color*opacity;
#ifdef OVERDRAW_INSPECTOR
fragColor=vec4(1.0);
#endif
}`,`uniform vec2 u_fill_translate;in vec2 a_pos;
#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float opacity
gl_Position=projectTile(a_pos+u_fill_translate,a_pos);}`),fillOutline:ii(`in vec2 v_pos;
#ifdef GLOBE
in float v_depth;
#endif
#pragma mapbox: define highp vec4 outline_color
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize highp vec4 outline_color
#pragma mapbox: initialize lowp float opacity
float dist=length(v_pos-gl_FragCoord.xy);float alpha=1.0-smoothstep(0.0,1.0,dist);fragColor=outline_color*(alpha*opacity);
#ifdef GLOBE
if (v_depth > 1.0) {discard;}
#endif
#ifdef OVERDRAW_INSPECTOR
fragColor=vec4(1.0);
#endif
}`,`uniform vec2 u_world;uniform vec2 u_fill_translate;in vec2 a_pos;out vec2 v_pos;
#ifdef GLOBE
out float v_depth;
#endif
#pragma mapbox: define highp vec4 outline_color
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize highp vec4 outline_color
#pragma mapbox: initialize lowp float opacity
gl_Position=projectTile(a_pos+u_fill_translate,a_pos);v_pos=(gl_Position.xy/gl_Position.w+1.0)/2.0*u_world;
#ifdef GLOBE
v_depth=gl_Position.z/gl_Position.w;
#endif
}`),fillOutlinePattern:ii(`uniform vec2 u_texsize;uniform sampler2D u_image;uniform float u_fade;in vec2 v_pos_a;in vec2 v_pos_b;in vec2 v_pos;
#ifdef GLOBE
in float v_depth;
#endif
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
void main() {
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
vec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;vec2 imagecoord=mod(v_pos_a,1.0);vec2 pos=mix(pattern_tl_a/u_texsize,pattern_br_a/u_texsize,imagecoord);vec4 color1=texture(u_image,pos);vec2 imagecoord_b=mod(v_pos_b,1.0);vec2 pos2=mix(pattern_tl_b/u_texsize,pattern_br_b/u_texsize,imagecoord_b);vec4 color2=texture(u_image,pos2);float dist=length(v_pos-gl_FragCoord.xy);float alpha=1.0-smoothstep(0.0,1.0,dist);fragColor=mix(color1,color2,u_fade)*alpha*opacity;
#ifdef GLOBE
if (v_depth > 1.0) {discard;}
#endif
#ifdef OVERDRAW_INSPECTOR
fragColor=vec4(1.0);
#endif
}`,`uniform vec2 u_world;uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform vec3 u_scale;uniform vec2 u_fill_translate;in vec2 a_pos;out vec2 v_pos_a;out vec2 v_pos_b;out vec2 v_pos;
#ifdef GLOBE
out float v_depth;
#endif
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
#pragma mapbox: define lowp float pixel_ratio_from
#pragma mapbox: define lowp float pixel_ratio_to
void main() {
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
#pragma mapbox: initialize lowp float pixel_ratio_from
#pragma mapbox: initialize lowp float pixel_ratio_to
vec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;float tileRatio=u_scale.x;float fromScale=u_scale.y;float toScale=u_scale.z;gl_Position=projectTile(a_pos+u_fill_translate,a_pos);vec2 display_size_a=(pattern_br_a-pattern_tl_a)/pixel_ratio_from;vec2 display_size_b=(pattern_br_b-pattern_tl_b)/pixel_ratio_to;v_pos_a=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,fromScale*display_size_a,tileRatio,a_pos);v_pos_b=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,toScale*display_size_b,tileRatio,a_pos);v_pos=(gl_Position.xy/gl_Position.w+1.0)/2.0*u_world;
#ifdef GLOBE
v_depth=gl_Position.z/gl_Position.w;
#endif
}`),fillPattern:ii(`#ifdef GL_ES
precision highp float;
#endif
uniform vec2 u_texsize;uniform float u_fade;uniform sampler2D u_image;in vec2 v_pos_a;in vec2 v_pos_b;
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
void main() {
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
vec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;vec2 imagecoord=mod(v_pos_a,1.0);vec2 pos=mix(pattern_tl_a/u_texsize,pattern_br_a/u_texsize,imagecoord);vec4 color1=texture(u_image,pos);vec2 imagecoord_b=mod(v_pos_b,1.0);vec2 pos2=mix(pattern_tl_b/u_texsize,pattern_br_b/u_texsize,imagecoord_b);vec4 color2=texture(u_image,pos2);fragColor=mix(color1,color2,u_fade)*opacity;
#ifdef OVERDRAW_INSPECTOR
fragColor=vec4(1.0);
#endif
}`,`uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform vec3 u_scale;uniform vec2 u_fill_translate;in vec2 a_pos;out vec2 v_pos_a;out vec2 v_pos_b;
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
#pragma mapbox: define lowp float pixel_ratio_from
#pragma mapbox: define lowp float pixel_ratio_to
void main() {
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
#pragma mapbox: initialize lowp float pixel_ratio_from
#pragma mapbox: initialize lowp float pixel_ratio_to
vec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;float tileZoomRatio=u_scale.x;float fromScale=u_scale.y;float toScale=u_scale.z;vec2 display_size_a=(pattern_br_a-pattern_tl_a)/pixel_ratio_from;vec2 display_size_b=(pattern_br_b-pattern_tl_b)/pixel_ratio_to;gl_Position=projectTile(a_pos+u_fill_translate,a_pos);v_pos_a=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,fromScale*display_size_a,tileZoomRatio,a_pos);v_pos_b=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,toScale*display_size_b,tileZoomRatio,a_pos);}`),fillExtrusion:ii(`in vec4 v_color;void main() {fragColor=v_color;
#ifdef OVERDRAW_INSPECTOR
fragColor=vec4(1.0);
#endif
}`,`uniform vec3 u_lightcolor;uniform lowp vec3 u_lightpos;uniform lowp vec3 u_lightpos_globe;uniform lowp float u_lightintensity;uniform float u_vertical_gradient;uniform lowp float u_opacity;uniform vec2 u_fill_translate;in vec2 a_pos;in vec4 a_normal_ed;
#ifdef TERRAIN3D
in vec2 a_centroid;
#endif
out vec4 v_color;
#pragma mapbox: define highp float base
#pragma mapbox: define highp float height
#pragma mapbox: define highp vec4 color
void main() {
#pragma mapbox: initialize highp float base
#pragma mapbox: initialize highp float height
#pragma mapbox: initialize highp vec4 color
vec3 normal=a_normal_ed.xyz;
#ifdef TERRAIN3D
float height_terrain3d_offset=get_elevation(a_centroid);float base_terrain3d_offset=height_terrain3d_offset-(base > 0.0 ? 0.0 : 10.0);
#else
float height_terrain3d_offset=0.0;float base_terrain3d_offset=0.0;
#endif
base=max(0.0,base)+base_terrain3d_offset;height=max(0.0,height)+height_terrain3d_offset;float t=mod(normal.x,2.0);float elevation=t > 0.0 ? height : base;vec2 posInTile=a_pos+u_fill_translate;
#ifdef GLOBE
vec3 spherePos=projectToSphere(posInTile,a_pos);gl_Position=interpolateProjectionFor3D(posInTile,spherePos,elevation);
#else
gl_Position=u_projection_matrix*vec4(posInTile,elevation,1.0);
#endif
float colorvalue=color.r*0.2126+color.g*0.7152+color.b*0.0722;v_color=vec4(0.0,0.0,0.0,1.0);vec4 ambientlight=vec4(0.03,0.03,0.03,1.0);color+=ambientlight;vec3 normalForLighting=normal/16384.0;float directional=clamp(dot(normalForLighting,u_lightpos),0.0,1.0);
#ifdef GLOBE
mat3 rotMatrix=globeGetRotationMatrix(spherePos);normalForLighting=rotMatrix*normalForLighting;directional=mix(directional,clamp(dot(normalForLighting,u_lightpos_globe),0.0,1.0),u_projection_transition);
#endif
directional=mix((1.0-u_lightintensity),max((1.0-colorvalue+u_lightintensity),1.0),directional);if (normal.y !=0.0) {directional*=((1.0-u_vertical_gradient)+(u_vertical_gradient*clamp((t+base)*pow(height/150.0,0.5),mix(0.7,0.98,1.0-u_lightintensity),1.0)));}v_color.r+=clamp(color.r*directional*u_lightcolor.r,mix(0.0,0.3,1.0-u_lightcolor.r),1.0);v_color.g+=clamp(color.g*directional*u_lightcolor.g,mix(0.0,0.3,1.0-u_lightcolor.g),1.0);v_color.b+=clamp(color.b*directional*u_lightcolor.b,mix(0.0,0.3,1.0-u_lightcolor.b),1.0);v_color*=u_opacity;}`),fillExtrusionPattern:ii(`uniform vec2 u_texsize;uniform float u_fade;uniform sampler2D u_image;in vec2 v_pos_a;in vec2 v_pos_b;in vec4 v_lighting;
#pragma mapbox: define lowp float base
#pragma mapbox: define lowp float height
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
#pragma mapbox: define lowp float pixel_ratio_from
#pragma mapbox: define lowp float pixel_ratio_to
void main() {
#pragma mapbox: initialize lowp float base
#pragma mapbox: initialize lowp float height
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
#pragma mapbox: initialize lowp float pixel_ratio_from
#pragma mapbox: initialize lowp float pixel_ratio_to
vec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;vec2 imagecoord=mod(v_pos_a,1.0);vec2 pos=mix(pattern_tl_a/u_texsize,pattern_br_a/u_texsize,imagecoord);vec4 color1=texture(u_image,pos);vec2 imagecoord_b=mod(v_pos_b,1.0);vec2 pos2=mix(pattern_tl_b/u_texsize,pattern_br_b/u_texsize,imagecoord_b);vec4 color2=texture(u_image,pos2);vec4 mixedColor=mix(color1,color2,u_fade);fragColor=mixedColor*v_lighting;
#ifdef OVERDRAW_INSPECTOR
fragColor=vec4(1.0);
#endif
}`,`uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform float u_height_factor;uniform vec3 u_scale;uniform float u_vertical_gradient;uniform lowp float u_opacity;uniform vec2 u_fill_translate;uniform vec3 u_lightcolor;uniform lowp vec3 u_lightpos;uniform lowp vec3 u_lightpos_globe;uniform lowp float u_lightintensity;in vec2 a_pos;in vec4 a_normal_ed;
#ifdef TERRAIN3D
in vec2 a_centroid;
#endif
#ifdef GLOBE
out vec3 v_sphere_pos;
#endif
out vec2 v_pos_a;out vec2 v_pos_b;out vec4 v_lighting;
#pragma mapbox: define lowp float base
#pragma mapbox: define lowp float height
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
#pragma mapbox: define lowp float pixel_ratio_from
#pragma mapbox: define lowp float pixel_ratio_to
void main() {
#pragma mapbox: initialize lowp float base
#pragma mapbox: initialize lowp float height
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
#pragma mapbox: initialize lowp float pixel_ratio_from
#pragma mapbox: initialize lowp float pixel_ratio_to
vec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;float tileRatio=u_scale.x;float fromScale=u_scale.y;float toScale=u_scale.z;vec3 normal=a_normal_ed.xyz;float edgedistance=a_normal_ed.w;vec2 display_size_a=(pattern_br_a-pattern_tl_a)/pixel_ratio_from;vec2 display_size_b=(pattern_br_b-pattern_tl_b)/pixel_ratio_to;
#ifdef TERRAIN3D
float height_terrain3d_offset=get_elevation(a_centroid);float base_terrain3d_offset=height_terrain3d_offset-(base > 0.0 ? 0.0 : 10.0);
#else
float height_terrain3d_offset=0.0;float base_terrain3d_offset=0.0;
#endif
base=max(0.0,base)+base_terrain3d_offset;height=max(0.0,height)+height_terrain3d_offset;float t=mod(normal.x,2.0);float elevation=t > 0.0 ? height : base;vec2 posInTile=a_pos+u_fill_translate;
#ifdef GLOBE
vec3 spherePos=projectToSphere(posInTile,a_pos);vec3 elevatedPos=spherePos*(1.0+elevation/GLOBE_RADIUS);v_sphere_pos=elevatedPos;gl_Position=interpolateProjectionFor3D(posInTile,spherePos,elevation);
#else
gl_Position=u_projection_matrix*vec4(posInTile,elevation,1.0);
#endif
vec2 pos=normal.x==1.0 && normal.y==0.0 && normal.z==16384.0
? a_pos
: vec2(edgedistance,elevation*u_height_factor);v_pos_a=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,fromScale*display_size_a,tileRatio,pos);v_pos_b=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,toScale*display_size_b,tileRatio,pos);v_lighting=vec4(0.0,0.0,0.0,1.0);float directional=clamp(dot(normal/16383.0,u_lightpos),0.0,1.0);directional=mix((1.0-u_lightintensity),max((0.5+u_lightintensity),1.0),directional);if (normal.y !=0.0) {directional*=((1.0-u_vertical_gradient)+(u_vertical_gradient*clamp((t+base)*pow(height/150.0,0.5),mix(0.7,0.98,1.0-u_lightintensity),1.0)));}v_lighting.rgb+=clamp(directional*u_lightcolor,mix(vec3(0.0),vec3(0.3),1.0-u_lightcolor),vec3(1.0));v_lighting*=u_opacity;}`),hillshadePrepare:ii(`#ifdef GL_ES
precision highp float;
#endif
uniform sampler2D u_image;in vec2 v_pos;uniform vec2 u_dimension;uniform float u_zoom;uniform vec4 u_unpack;float getElevation(vec2 coord,float bias) {vec4 data=texture(u_image,coord)*255.0;data.a=-1.0;return dot(data,u_unpack);}void main() {vec2 epsilon=1.0/u_dimension;float tileSize=u_dimension.x-2.0;float a=getElevation(v_pos+vec2(-epsilon.x,-epsilon.y),0.0);float b=getElevation(v_pos+vec2(0,-epsilon.y),0.0);float c=getElevation(v_pos+vec2(epsilon.x,-epsilon.y),0.0);float d=getElevation(v_pos+vec2(-epsilon.x,0),0.0);float e=getElevation(v_pos,0.0);float f=getElevation(v_pos+vec2(epsilon.x,0),0.0);float g=getElevation(v_pos+vec2(-epsilon.x,epsilon.y),0.0);float h=getElevation(v_pos+vec2(0,epsilon.y),0.0);float i=getElevation(v_pos+vec2(epsilon.x,epsilon.y),0.0);float exaggerationFactor=u_zoom < 2.0 ? 0.4 : u_zoom < 4.5 ? 0.35 : 0.3;float exaggeration=u_zoom < 15.0 ? (u_zoom-15.0)*exaggerationFactor : 0.0;vec2 deriv=vec2((c+f+f+i)-(a+d+d+g),(g+h+h+i)-(a+b+b+c))*tileSize/pow(2.0,exaggeration+(28.2562-u_zoom));fragColor=clamp(vec4(deriv.x/8.0+0.5,deriv.y/8.0+0.5,1.0,1.0),0.0,1.0);
#ifdef OVERDRAW_INSPECTOR
fragColor=vec4(1.0);
#endif
}`,"uniform mat4 u_matrix;uniform vec2 u_dimension;in vec2 a_pos;in vec2 a_texture_pos;out vec2 v_pos;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);highp vec2 epsilon=1.0/u_dimension;float scale=(u_dimension.x-2.0)/u_dimension.x;v_pos=(a_texture_pos/8192.0)*scale+epsilon;}"),hillshade:ii(`uniform sampler2D u_image;in vec2 v_pos;uniform vec2 u_latrange;uniform float u_exaggeration;uniform vec4 u_accent;uniform int u_method;uniform float u_altitudes[NUM_ILLUMINATION_SOURCES];uniform float u_azimuths[NUM_ILLUMINATION_SOURCES];uniform vec4 u_shadows[NUM_ILLUMINATION_SOURCES];uniform vec4 u_highlights[NUM_ILLUMINATION_SOURCES];
#define PI 3.141592653589793
#define STANDARD 0
#define COMBINED 1
#define IGOR 2
#define MULTIDIRECTIONAL 3
#define BASIC 4
float get_aspect(vec2 deriv){return deriv.x !=0.0 ? atan(deriv.y,-deriv.x) : PI/2.0*(deriv.y > 0.0 ? 1.0 :-1.0);}void igor_hillshade(vec2 deriv){deriv=deriv*u_exaggeration*2.0;float aspect=get_aspect(deriv);float azimuth=u_azimuths[0]+PI;float slope_stength=atan(length(deriv))*2.0/PI;float aspect_strength=1.0-abs(mod((aspect+azimuth)/PI+0.5,2.0)-1.0);float shadow_strength=slope_stength*aspect_strength;float highlight_strength=slope_stength*(1.0-aspect_strength);fragColor=u_shadows[0]*shadow_strength+u_highlights[0]*highlight_strength;}void standard_hillshade(vec2 deriv){float azimuth=u_azimuths[0]+PI;float slope=atan(0.625*length(deriv));float aspect=get_aspect(deriv);float intensity=u_exaggeration;float base=1.875-intensity*1.75;float maxValue=0.5*PI;float scaledSlope=intensity !=0.5 ? ((pow(base,slope)-1.0)/(pow(base,maxValue)-1.0))*maxValue : slope;float accent=cos(scaledSlope);vec4 accent_color=(1.0-accent)*u_accent*clamp(intensity*2.0,0.0,1.0);float shade=abs(mod((aspect+azimuth)/PI+0.5,2.0)-1.0);vec4 shade_color=mix(u_shadows[0],u_highlights[0],shade)*sin(scaledSlope)*clamp(intensity*2.0,0.0,1.0);fragColor=accent_color*(1.0-shade_color.a)+shade_color;}void basic_hillshade(vec2 deriv){deriv=deriv*u_exaggeration*2.0;float azimuth=u_azimuths[0]+PI;float cos_az=cos(azimuth);float sin_az=sin(azimuth);float cos_alt=cos(u_altitudes[0]);float sin_alt=sin(u_altitudes[0]);float cang=(sin_alt-(deriv.y*cos_az*cos_alt-deriv.x*sin_az*cos_alt))/sqrt(1.0+dot(deriv,deriv));float shade=clamp(cang,0.0,1.0);if(shade > 0.5){fragColor=u_highlights[0]*(2.0*shade-1.0);}else
{fragColor=u_shadows[0]*(1.0-2.0*shade);}}void multidirectional_hillshade(vec2 deriv){deriv=deriv*u_exaggeration*2.0;fragColor=vec4(0,0,0,0);for(int i=0; i < NUM_ILLUMINATION_SOURCES; i++){float cos_alt=cos(u_altitudes[i]);float sin_alt=sin(u_altitudes[i]);float cos_az=-cos(u_azimuths[i]);float sin_az=-sin(u_azimuths[i]);float cang=(sin_alt-(deriv.y*cos_az*cos_alt-deriv.x*sin_az*cos_alt))/sqrt(1.0+dot(deriv,deriv));float shade=clamp(cang,0.0,1.0);if(shade > 0.5){fragColor+=u_highlights[i]*(2.0*shade-1.0)/float(NUM_ILLUMINATION_SOURCES);}else
{fragColor+=u_shadows[i]*(1.0-2.0*shade)/float(NUM_ILLUMINATION_SOURCES);}}}void combined_hillshade(vec2 deriv){deriv=deriv*u_exaggeration*2.0;float azimuth=u_azimuths[0]+PI;float cos_az=cos(azimuth);float sin_az=sin(azimuth);float cos_alt=cos(u_altitudes[0]);float sin_alt=sin(u_altitudes[0]);float cang=acos((sin_alt-(deriv.y*cos_az*cos_alt-deriv.x*sin_az*cos_alt))/sqrt(1.0+dot(deriv,deriv)));cang=clamp(cang,0.0,PI/2.0);float shade=cang*atan(length(deriv))*4.0/PI/PI;float highlight=(PI/2.0-cang)*atan(length(deriv))*4.0/PI/PI;fragColor=u_shadows[0]*shade+u_highlights[0]*highlight;}void main() {vec4 pixel=texture(u_image,v_pos);float scaleFactor=cos(radians((u_latrange[0]-u_latrange[1])*(1.0-v_pos.y)+u_latrange[1]));vec2 deriv=((pixel.rg*8.0)-4.0)/scaleFactor;if (u_method==BASIC) {basic_hillshade(deriv);} else if (u_method==COMBINED) {combined_hillshade(deriv);} else if (u_method==IGOR) {igor_hillshade(deriv);} else if (u_method==MULTIDIRECTIONAL) {multidirectional_hillshade(deriv);} else if (u_method==STANDARD) {standard_hillshade(deriv);} else {standard_hillshade(deriv);}
#ifdef OVERDRAW_INSPECTOR
fragColor=vec4(1.0);
#endif
}`,"uniform mat4 u_matrix;in vec2 a_pos;out vec2 v_pos;void main() {gl_Position=projectTile(a_pos,a_pos);v_pos=a_pos/8192.0;if (a_pos.y <-32767.5) {v_pos.y=0.0;}if (a_pos.y > 32766.5) {v_pos.y=1.0;}}"),line:ii(`uniform lowp float u_device_pixel_ratio;in vec2 v_width2;in vec2 v_normal;in float v_gamma_scale;
#ifdef GLOBE
in float v_depth;
#endif
#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
float dist=length(v_normal)*v_width2.s;float blur2=(blur+1.0/u_device_pixel_ratio)*v_gamma_scale;float alpha=clamp(min(dist-(v_width2.t-blur2),v_width2.s-dist)/blur2,0.0,1.0);fragColor=color*(alpha*opacity);
#ifdef GLOBE
if (v_depth > 1.0) {discard;}
#endif
#ifdef OVERDRAW_INSPECTOR
fragColor=vec4(1.0);
#endif
}`,`
#define scale 0.015873016
in vec2 a_pos_normal;in vec4 a_data;uniform vec2 u_translation;uniform mediump float u_ratio;uniform vec2 u_units_to_pixels;uniform lowp float u_device_pixel_ratio;out vec2 v_normal;out vec2 v_width2;out float v_gamma_scale;out highp float v_linesofar;
#ifdef GLOBE
out float v_depth;
#endif
#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define mediump float gapwidth
#pragma mapbox: define lowp float offset
#pragma mapbox: define mediump float width
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump float gapwidth
#pragma mapbox: initialize lowp float offset
#pragma mapbox: initialize mediump float width
float ANTIALIASING=1.0/u_device_pixel_ratio/2.0;vec2 a_extrude=a_data.xy-128.0;float a_direction=mod(a_data.z,4.0)-1.0;v_linesofar=(floor(a_data.z/4.0)+a_data.w*64.0)*2.0;vec2 pos=floor(a_pos_normal*0.5);mediump vec2 normal=a_pos_normal-2.0*pos;normal.y=normal.y*2.0-1.0;v_normal=normal;gapwidth=gapwidth/2.0;float halfwidth=width/2.0;offset=-1.0*offset;float inset=gapwidth+(gapwidth > 0.0 ? ANTIALIASING : 0.0);float outset=gapwidth+halfwidth*(gapwidth > 0.0 ? 2.0 : 1.0)+(halfwidth==0.0 ? 0.0 : ANTIALIASING);mediump vec2 dist=outset*a_extrude*scale;mediump float u=0.5*a_direction;mediump float t=1.0-abs(u);mediump vec2 offset2=offset*a_extrude*scale*normal.y*mat2(t,-u,u,t);float adjustedThickness=projectLineThickness(pos.y);vec4 projected_no_extrude=projectTile(pos+offset2/u_ratio*adjustedThickness+u_translation);vec4 projected_with_extrude=projectTile(pos+offset2/u_ratio*adjustedThickness+u_translation+dist/u_ratio*adjustedThickness);gl_Position=projected_with_extrude;
#ifdef GLOBE
v_depth=gl_Position.z/gl_Position.w;
#endif
#ifdef TERRAIN3D
v_gamma_scale=1.0;
#else
float extrude_length_without_perspective=length(dist);float extrude_length_with_perspective=length((projected_with_extrude.xy-projected_no_extrude.xy)/projected_with_extrude.w*u_units_to_pixels);v_gamma_scale=extrude_length_without_perspective/extrude_length_with_perspective;
#endif
v_width2=vec2(outset,inset);}`),lineGradient:ii(`uniform lowp float u_device_pixel_ratio;uniform sampler2D u_image;in vec2 v_width2;in vec2 v_normal;in float v_gamma_scale;in highp vec2 v_uv;
#ifdef GLOBE
in float v_depth;
#endif
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
float dist=length(v_normal)*v_width2.s;float blur2=(blur+1.0/u_device_pixel_ratio)*v_gamma_scale;float alpha=clamp(min(dist-(v_width2.t-blur2),v_width2.s-dist)/blur2,0.0,1.0);vec4 color=texture(u_image,v_uv);fragColor=color*(alpha*opacity);
#ifdef GLOBE
if (v_depth > 1.0) {discard;}
#endif
#ifdef OVERDRAW_INSPECTOR
fragColor=vec4(1.0);
#endif
}`,`
#define scale 0.015873016
in vec2 a_pos_normal;in vec4 a_data;in float a_uv_x;in float a_split_index;uniform vec2 u_translation;uniform mediump float u_ratio;uniform lowp float u_device_pixel_ratio;uniform vec2 u_units_to_pixels;uniform float u_image_height;out vec2 v_normal;out vec2 v_width2;out float v_gamma_scale;out highp vec2 v_uv;
#ifdef GLOBE
out float v_depth;
#endif
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define mediump float gapwidth
#pragma mapbox: define lowp float offset
#pragma mapbox: define mediump float width
void main() {
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump float gapwidth
#pragma mapbox: initialize lowp float offset
#pragma mapbox: initialize mediump float width
float ANTIALIASING=1.0/u_device_pixel_ratio/2.0;vec2 a_extrude=a_data.xy-128.0;float a_direction=mod(a_data.z,4.0)-1.0;highp float texel_height=1.0/u_image_height;highp float half_texel_height=0.5*texel_height;v_uv=vec2(a_uv_x,a_split_index*texel_height-half_texel_height);vec2 pos=floor(a_pos_normal*0.5);mediump vec2 normal=a_pos_normal-2.0*pos;normal.y=normal.y*2.0-1.0;v_normal=normal;gapwidth=gapwidth/2.0;float halfwidth=width/2.0;offset=-1.0*offset;float inset=gapwidth+(gapwidth > 0.0 ? ANTIALIASING : 0.0);float outset=gapwidth+halfwidth*(gapwidth > 0.0 ? 2.0 : 1.0)+(halfwidth==0.0 ? 0.0 : ANTIALIASING);mediump vec2 dist=outset*a_extrude*scale;mediump float u=0.5*a_direction;mediump float t=1.0-abs(u);mediump vec2 offset2=offset*a_extrude*scale*normal.y*mat2(t,-u,u,t);float adjustedThickness=projectLineThickness(pos.y);vec4 projected_no_extrude=projectTile(pos+offset2/u_ratio*adjustedThickness+u_translation);vec4 projected_with_extrude=projectTile(pos+offset2/u_ratio*adjustedThickness+u_translation+dist/u_ratio*adjustedThickness);gl_Position=projected_with_extrude;
#ifdef GLOBE
v_depth=gl_Position.z/gl_Position.w;
#endif
#ifdef TERRAIN3D
v_gamma_scale=1.0;
#else
float extrude_length_without_perspective=length(dist);float extrude_length_with_perspective=length((projected_with_extrude.xy-projected_no_extrude.xy)/projected_with_extrude.w*u_units_to_pixels);v_gamma_scale=extrude_length_without_perspective/extrude_length_with_perspective;
#endif
v_width2=vec2(outset,inset);}`),linePattern:ii(`#ifdef GL_ES
precision highp float;
#endif
uniform lowp float u_device_pixel_ratio;uniform vec2 u_texsize;uniform float u_fade;uniform mediump vec3 u_scale;uniform sampler2D u_image;in vec2 v_normal;in vec2 v_width2;in float v_linesofar;in float v_gamma_scale;in float v_width;
#ifdef GLOBE
in float v_depth;
#endif
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
#pragma mapbox: define lowp float pixel_ratio_from
#pragma mapbox: define lowp float pixel_ratio_to
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
#pragma mapbox: initialize lowp float pixel_ratio_from
#pragma mapbox: initialize lowp float pixel_ratio_to
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
vec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;float tileZoomRatio=u_scale.x;float fromScale=u_scale.y;float toScale=u_scale.z;vec2 display_size_a=(pattern_br_a-pattern_tl_a)/pixel_ratio_from;vec2 display_size_b=(pattern_br_b-pattern_tl_b)/pixel_ratio_to;vec2 pattern_size_a=vec2(display_size_a.x*fromScale/tileZoomRatio,display_size_a.y);vec2 pattern_size_b=vec2(display_size_b.x*toScale/tileZoomRatio,display_size_b.y);float aspect_a=display_size_a.y/v_width;float aspect_b=display_size_b.y/v_width;float dist=length(v_normal)*v_width2.s;float blur2=(blur+1.0/u_device_pixel_ratio)*v_gamma_scale;float alpha=clamp(min(dist-(v_width2.t-blur2),v_width2.s-dist)/blur2,0.0,1.0);float x_a=mod(v_linesofar/pattern_size_a.x*aspect_a,1.0);float x_b=mod(v_linesofar/pattern_size_b.x*aspect_b,1.0);float y=0.5*v_normal.y+0.5;vec2 texel_size=1.0/u_texsize;vec2 pos_a=mix(pattern_tl_a*texel_size-texel_size,pattern_br_a*texel_size+texel_size,vec2(x_a,y));vec2 pos_b=mix(pattern_tl_b*texel_size-texel_size,pattern_br_b*texel_size+texel_size,vec2(x_b,y));vec4 color=mix(texture(u_image,pos_a),texture(u_image,pos_b),u_fade);fragColor=color*alpha*opacity;
#ifdef GLOBE
if (v_depth > 1.0) {discard;}
#endif
#ifdef OVERDRAW_INSPECTOR
fragColor=vec4(1.0);
#endif
}`,`
#define scale 0.015873016
#define LINE_DISTANCE_SCALE 2.0
in vec2 a_pos_normal;in vec4 a_data;uniform vec2 u_translation;uniform vec2 u_units_to_pixels;uniform mediump float u_ratio;uniform lowp float u_device_pixel_ratio;out vec2 v_normal;out vec2 v_width2;out float v_linesofar;out float v_gamma_scale;out float v_width;
#ifdef GLOBE
out float v_depth;
#endif
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp float offset
#pragma mapbox: define mediump float gapwidth
#pragma mapbox: define mediump float width
#pragma mapbox: define lowp float floorwidth
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
#pragma mapbox: define lowp float pixel_ratio_from
#pragma mapbox: define lowp float pixel_ratio_to
void main() {
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize lowp float offset
#pragma mapbox: initialize mediump float gapwidth
#pragma mapbox: initialize mediump float width
#pragma mapbox: initialize lowp float floorwidth
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
#pragma mapbox: initialize lowp float pixel_ratio_from
#pragma mapbox: initialize lowp float pixel_ratio_to
float ANTIALIASING=1.0/u_device_pixel_ratio/2.0;vec2 a_extrude=a_data.xy-128.0;float a_direction=mod(a_data.z,4.0)-1.0;float a_linesofar=(floor(a_data.z/4.0)+a_data.w*64.0)*LINE_DISTANCE_SCALE;vec2 pos=floor(a_pos_normal*0.5);mediump vec2 normal=a_pos_normal-2.0*pos;normal.y=normal.y*2.0-1.0;v_normal=normal;gapwidth=gapwidth/2.0;float halfwidth=width/2.0;offset=-1.0*offset;float inset=gapwidth+(gapwidth > 0.0 ? ANTIALIASING : 0.0);float outset=gapwidth+halfwidth*(gapwidth > 0.0 ? 2.0 : 1.0)+(halfwidth==0.0 ? 0.0 : ANTIALIASING);mediump vec2 dist=outset*a_extrude*scale;mediump float u=0.5*a_direction;mediump float t=1.0-abs(u);mediump vec2 offset2=offset*a_extrude*scale*normal.y*mat2(t,-u,u,t);float adjustedThickness=projectLineThickness(pos.y);vec4 projected_no_extrude=projectTile(pos+offset2/u_ratio*adjustedThickness+u_translation);vec4 projected_with_extrude=projectTile(pos+offset2/u_ratio*adjustedThickness+u_translation+dist/u_ratio*adjustedThickness);gl_Position=projected_with_extrude;
#ifdef GLOBE
v_depth=gl_Position.z/gl_Position.w;
#endif
#ifdef TERRAIN3D
v_gamma_scale=1.0;
#else
float extrude_length_without_perspective=length(dist);float extrude_length_with_perspective=length((projected_with_extrude.xy-projected_no_extrude.xy)/projected_with_extrude.w*u_units_to_pixels);v_gamma_scale=extrude_length_without_perspective/extrude_length_with_perspective;
#endif
v_linesofar=a_linesofar;v_width2=vec2(outset,inset);v_width=floorwidth;}`),lineSDF:ii(`uniform lowp float u_device_pixel_ratio;uniform sampler2D u_image;uniform float u_sdfgamma;uniform float u_mix;in vec2 v_normal;in vec2 v_width2;in vec2 v_tex_a;in vec2 v_tex_b;in float v_gamma_scale;
#ifdef GLOBE
in float v_depth;
#endif
#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define mediump float width
#pragma mapbox: define lowp float floorwidth
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump float width
#pragma mapbox: initialize lowp float floorwidth
float dist=length(v_normal)*v_width2.s;float blur2=(blur+1.0/u_device_pixel_ratio)*v_gamma_scale;float alpha=clamp(min(dist-(v_width2.t-blur2),v_width2.s-dist)/blur2,0.0,1.0);float sdfdist_a=texture(u_image,v_tex_a).a;float sdfdist_b=texture(u_image,v_tex_b).a;float sdfdist=mix(sdfdist_a,sdfdist_b,u_mix);alpha*=smoothstep(0.5-u_sdfgamma/floorwidth,0.5+u_sdfgamma/floorwidth,sdfdist);fragColor=color*(alpha*opacity);
#ifdef GLOBE
if (v_depth > 1.0) {discard;}
#endif
#ifdef OVERDRAW_INSPECTOR
fragColor=vec4(1.0);
#endif
}`,`
#define scale 0.015873016
#define LINE_DISTANCE_SCALE 2.0
in vec2 a_pos_normal;in vec4 a_data;uniform vec2 u_translation;uniform mediump float u_ratio;uniform lowp float u_device_pixel_ratio;uniform vec2 u_patternscale_a;uniform float u_tex_y_a;uniform vec2 u_patternscale_b;uniform float u_tex_y_b;uniform vec2 u_units_to_pixels;out vec2 v_normal;out vec2 v_width2;out vec2 v_tex_a;out vec2 v_tex_b;out float v_gamma_scale;
#ifdef GLOBE
out float v_depth;
#endif
#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define mediump float gapwidth
#pragma mapbox: define lowp float offset
#pragma mapbox: define mediump float width
#pragma mapbox: define lowp float floorwidth
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump float gapwidth
#pragma mapbox: initialize lowp float offset
#pragma mapbox: initialize mediump float width
#pragma mapbox: initialize lowp float floorwidth
float ANTIALIASING=1.0/u_device_pixel_ratio/2.0;vec2 a_extrude=a_data.xy-128.0;float a_direction=mod(a_data.z,4.0)-1.0;float a_linesofar=(floor(a_data.z/4.0)+a_data.w*64.0)*LINE_DISTANCE_SCALE;vec2 pos=floor(a_pos_normal*0.5);mediump vec2 normal=a_pos_normal-2.0*pos;normal.y=normal.y*2.0-1.0;v_normal=normal;gapwidth=gapwidth/2.0;float halfwidth=width/2.0;offset=-1.0*offset;float inset=gapwidth+(gapwidth > 0.0 ? ANTIALIASING : 0.0);float outset=gapwidth+halfwidth*(gapwidth > 0.0 ? 2.0 : 1.0)+(halfwidth==0.0 ? 0.0 : ANTIALIASING);mediump vec2 dist=outset*a_extrude*scale;mediump float u=0.5*a_direction;mediump float t=1.0-abs(u);mediump vec2 offset2=offset*a_extrude*scale*normal.y*mat2(t,-u,u,t);float adjustedThickness=projectLineThickness(pos.y);vec4 projected_no_extrude=projectTile(pos+offset2/u_ratio*adjustedThickness+u_translation);vec4 projected_with_extrude=projectTile(pos+offset2/u_ratio*adjustedThickness+u_translation+dist/u_ratio*adjustedThickness);gl_Position=projected_with_extrude;
#ifdef GLOBE
v_depth=gl_Position.z/gl_Position.w;
#endif
#ifdef TERRAIN3D
v_gamma_scale=1.0;
#else
float extrude_length_without_perspective=length(dist);float extrude_length_with_perspective=length((projected_with_extrude.xy-projected_no_extrude.xy)/projected_with_extrude.w*u_units_to_pixels);v_gamma_scale=extrude_length_without_perspective/extrude_length_with_perspective;
#endif
v_tex_a=vec2(a_linesofar*u_patternscale_a.x/floorwidth,normal.y*u_patternscale_a.y+u_tex_y_a);v_tex_b=vec2(a_linesofar*u_patternscale_b.x/floorwidth,normal.y*u_patternscale_b.y+u_tex_y_b);v_width2=vec2(outset,inset);}`),raster:ii(`uniform float u_fade_t;uniform float u_opacity;uniform sampler2D u_image0;uniform sampler2D u_image1;in vec2 v_pos0;in vec2 v_pos1;uniform float u_brightness_low;uniform float u_brightness_high;uniform float u_saturation_factor;uniform float u_contrast_factor;uniform vec3 u_spin_weights;void main() {vec4 color0=texture(u_image0,v_pos0);vec4 color1=texture(u_image1,v_pos1);if (color0.a > 0.0) {color0.rgb=color0.rgb/color0.a;}if (color1.a > 0.0) {color1.rgb=color1.rgb/color1.a;}vec4 color=mix(color0,color1,u_fade_t);color.a*=u_opacity;vec3 rgb=color.rgb;rgb=vec3(dot(rgb,u_spin_weights.xyz),dot(rgb,u_spin_weights.zxy),dot(rgb,u_spin_weights.yzx));float average=(color.r+color.g+color.b)/3.0;rgb+=(average-rgb)*u_saturation_factor;rgb=(rgb-0.5)*u_contrast_factor+0.5;vec3 u_high_vec=vec3(u_brightness_low,u_brightness_low,u_brightness_low);vec3 u_low_vec=vec3(u_brightness_high,u_brightness_high,u_brightness_high);fragColor=vec4(mix(u_high_vec,u_low_vec,rgb)*color.a,color.a);
#ifdef OVERDRAW_INSPECTOR
fragColor=vec4(1.0);
#endif
}`,`uniform vec2 u_tl_parent;uniform float u_scale_parent;uniform float u_buffer_scale;uniform vec4 u_coords_top;uniform vec4 u_coords_bottom;in vec2 a_pos;out vec2 v_pos0;out vec2 v_pos1;void main() {vec2 fractionalPos=a_pos/8192.0;vec2 position=mix(mix(u_coords_top.xy,u_coords_top.zw,fractionalPos.x),mix(u_coords_bottom.xy,u_coords_bottom.zw,fractionalPos.x),fractionalPos.y);gl_Position=projectTile(position,position);v_pos0=((fractionalPos-0.5)/u_buffer_scale)+0.5;
#ifdef GLOBE
if (a_pos.y <-32767.5) {v_pos0.y=0.0;}if (a_pos.y > 32766.5) {v_pos0.y=1.0;}
#endif
v_pos1=(v_pos0*u_scale_parent)+u_tl_parent;}`),symbolIcon:ii(`uniform sampler2D u_texture;in vec2 v_tex;in float v_fade_opacity;
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize lowp float opacity
lowp float alpha=opacity*v_fade_opacity;fragColor=texture(u_texture,v_tex)*alpha;
#ifdef OVERDRAW_INSPECTOR
fragColor=vec4(1.0);
#endif
}`,`in vec4 a_pos_offset;in vec4 a_data;in vec4 a_pixeloffset;in vec3 a_projected_pos;in float a_fade_opacity;uniform bool u_is_size_zoom_constant;uniform bool u_is_size_feature_constant;uniform highp float u_size_t;uniform highp float u_size;uniform highp float u_camera_to_center_distance;uniform highp float u_pitch;uniform bool u_rotate_symbol;uniform highp float u_aspect_ratio;uniform float u_fade_change;uniform mat4 u_label_plane_matrix;uniform mat4 u_coord_matrix;uniform bool u_is_text;uniform bool u_pitch_with_map;uniform vec2 u_texsize;uniform bool u_is_along_line;uniform bool u_is_variable_anchor;uniform vec2 u_translation;uniform float u_pitched_scale;out vec2 v_tex;out float v_fade_opacity;
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize lowp float opacity
vec2 a_pos=a_pos_offset.xy;vec2 a_offset=a_pos_offset.zw;vec2 a_tex=a_data.xy;vec2 a_size=a_data.zw;float a_size_min=floor(a_size[0]*0.5);vec2 a_pxoffset=a_pixeloffset.xy;vec2 a_minFontScale=a_pixeloffset.zw/256.0;float ele=get_elevation(a_pos);highp float segment_angle=-a_projected_pos[2];float size;if (!u_is_size_zoom_constant && !u_is_size_feature_constant) {size=mix(a_size_min,a_size[1],u_size_t)/128.0;} else if (u_is_size_zoom_constant && !u_is_size_feature_constant) {size=a_size_min/128.0;} else {size=u_size;}vec2 translated_a_pos=a_pos+u_translation;vec4 projectedPoint=projectTileWithElevation(translated_a_pos,ele);highp float camera_to_anchor_distance=projectedPoint.w;highp float distance_ratio=u_pitch_with_map ?
camera_to_anchor_distance/u_camera_to_center_distance :
u_camera_to_center_distance/camera_to_anchor_distance;highp float perspective_ratio=clamp(0.5+0.5*distance_ratio,0.0,4.0);size*=perspective_ratio;float fontScale=u_is_text ? size/24.0 : size;highp float symbol_rotation=0.0;if (u_rotate_symbol) {vec4 offsetProjectedPoint=projectTileWithElevation(translated_a_pos+vec2(1,0),ele);vec2 a=projectedPoint.xy/projectedPoint.w;vec2 b=offsetProjectedPoint.xy/offsetProjectedPoint.w;symbol_rotation=atan((b.y-a.y)/u_aspect_ratio,b.x-a.x);}highp float angle_sin=sin(segment_angle+symbol_rotation);highp float angle_cos=cos(segment_angle+symbol_rotation);mat2 rotation_matrix=mat2(angle_cos,-1.0*angle_sin,angle_sin,angle_cos);vec4 projected_pos;if (u_is_along_line || u_is_variable_anchor) {projected_pos=vec4(a_projected_pos.xy,ele,1.0);} else if (u_pitch_with_map) {projected_pos=u_label_plane_matrix*vec4(a_projected_pos.xy+u_translation,ele,1.0);} else {projected_pos=u_label_plane_matrix*projectTileWithElevation(a_projected_pos.xy+u_translation,ele);}float z=float(u_pitch_with_map)*projected_pos.z/projected_pos.w;float projectionScaling=1.0;
#ifdef GLOBE
if(u_pitch_with_map) {float anchor_pos_tile_y=(u_coord_matrix*vec4(projected_pos.xy/projected_pos.w,z,1.0)).y;projectionScaling=mix(projectionScaling,1.0/circumferenceRatioAtTileY(anchor_pos_tile_y)*u_pitched_scale,u_projection_transition);}
#endif
vec4 finalPos=u_coord_matrix*vec4(projected_pos.xy/projected_pos.w+rotation_matrix*(a_offset/32.0*max(a_minFontScale,fontScale)+a_pxoffset/16.0)*projectionScaling,z,1.0);if(u_pitch_with_map) {finalPos=projectTileWithElevation(finalPos.xy,finalPos.z);}gl_Position=finalPos;v_tex=a_tex/u_texsize;vec2 fade_opacity=unpack_opacity(a_fade_opacity);float fade_change=fade_opacity[1] > 0.5 ? u_fade_change :-u_fade_change;float visibility=calculate_visibility(projectedPoint);v_fade_opacity=max(0.0,min(visibility,fade_opacity[0]+fade_change));}`),symbolSDF:ii(`#define SDF_PX 8.0
uniform bool u_is_halo;uniform sampler2D u_texture;uniform highp float u_gamma_scale;uniform lowp float u_device_pixel_ratio;uniform bool u_is_text;in vec2 v_data0;in vec3 v_data1;
#pragma mapbox: define highp vec4 fill_color
#pragma mapbox: define highp vec4 halo_color
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp float halo_width
#pragma mapbox: define lowp float halo_blur
void main() {
#pragma mapbox: initialize highp vec4 fill_color
#pragma mapbox: initialize highp vec4 halo_color
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize lowp float halo_width
#pragma mapbox: initialize lowp float halo_blur
float EDGE_GAMMA=0.105/u_device_pixel_ratio;vec2 tex=v_data0.xy;float gamma_scale=v_data1.x;float size=v_data1.y;float fade_opacity=v_data1[2];float fontScale=u_is_text ? size/24.0 : size;lowp vec4 color=fill_color;highp float gamma=EDGE_GAMMA/(fontScale*u_gamma_scale);lowp float inner_edge=(256.0-64.0)/256.0;if (u_is_halo) {color=halo_color;gamma=(halo_blur*1.19/SDF_PX+EDGE_GAMMA)/(fontScale*u_gamma_scale);inner_edge=inner_edge+gamma*gamma_scale;}lowp float dist=texture(u_texture,tex).a;highp float gamma_scaled=gamma*gamma_scale;highp float alpha=smoothstep(inner_edge-gamma_scaled,inner_edge+gamma_scaled,dist);if (u_is_halo) {lowp float halo_edge=(6.0-halo_width/fontScale)/SDF_PX;alpha=min(smoothstep(halo_edge-gamma_scaled,halo_edge+gamma_scaled,dist),1.0-alpha);}fragColor=color*(alpha*opacity*fade_opacity);
#ifdef OVERDRAW_INSPECTOR
fragColor=vec4(1.0);
#endif
}`,`in vec4 a_pos_offset;in vec4 a_data;in vec4 a_pixeloffset;in vec3 a_projected_pos;in float a_fade_opacity;uniform bool u_is_size_zoom_constant;uniform bool u_is_size_feature_constant;uniform highp float u_size_t;uniform highp float u_size;uniform mat4 u_label_plane_matrix;uniform mat4 u_coord_matrix;uniform bool u_is_text;uniform bool u_pitch_with_map;uniform bool u_is_along_line;uniform bool u_is_variable_anchor;uniform highp float u_pitch;uniform bool u_rotate_symbol;uniform highp float u_aspect_ratio;uniform highp float u_camera_to_center_distance;uniform float u_fade_change;uniform vec2 u_texsize;uniform vec2 u_translation;uniform float u_pitched_scale;out vec2 v_data0;out vec3 v_data1;
#pragma mapbox: define highp vec4 fill_color
#pragma mapbox: define highp vec4 halo_color
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp float halo_width
#pragma mapbox: define lowp float halo_blur
void main() {
#pragma mapbox: initialize highp vec4 fill_color
#pragma mapbox: initialize highp vec4 halo_color
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize lowp float halo_width
#pragma mapbox: initialize lowp float halo_blur
vec2 a_pos=a_pos_offset.xy;vec2 a_offset=a_pos_offset.zw;vec2 a_tex=a_data.xy;vec2 a_size=a_data.zw;float a_size_min=floor(a_size[0]*0.5);vec2 a_pxoffset=a_pixeloffset.xy;float ele=get_elevation(a_pos);highp float segment_angle=-a_projected_pos[2];float size;if (!u_is_size_zoom_constant && !u_is_size_feature_constant) {size=mix(a_size_min,a_size[1],u_size_t)/128.0;} else if (u_is_size_zoom_constant && !u_is_size_feature_constant) {size=a_size_min/128.0;} else {size=u_size;}vec2 translated_a_pos=a_pos+u_translation;vec4 projectedPoint=projectTileWithElevation(translated_a_pos,ele);highp float camera_to_anchor_distance=projectedPoint.w;highp float distance_ratio=u_pitch_with_map ?
camera_to_anchor_distance/u_camera_to_center_distance :
u_camera_to_center_distance/camera_to_anchor_distance;highp float perspective_ratio=clamp(0.5+0.5*distance_ratio,0.0,4.0);size*=perspective_ratio;float fontScale=u_is_text ? size/24.0 : size;highp float symbol_rotation=0.0;if (u_rotate_symbol) {vec4 offsetProjectedPoint=projectTileWithElevation(translated_a_pos+vec2(1,0),ele);vec2 a=projectedPoint.xy/projectedPoint.w;vec2 b=offsetProjectedPoint.xy/offsetProjectedPoint.w;symbol_rotation=atan((b.y-a.y)/u_aspect_ratio,b.x-a.x);}highp float angle_sin=sin(segment_angle+symbol_rotation);highp float angle_cos=cos(segment_angle+symbol_rotation);mat2 rotation_matrix=mat2(angle_cos,-1.0*angle_sin,angle_sin,angle_cos);vec4 projected_pos;if (u_is_along_line || u_is_variable_anchor) {projected_pos=vec4(a_projected_pos.xy,ele,1.0);} else if (u_pitch_with_map) {projected_pos=u_label_plane_matrix*vec4(a_projected_pos.xy+u_translation,ele,1.0);} else {projected_pos=u_label_plane_matrix*projectTileWithElevation(a_projected_pos.xy+u_translation,ele);}float z=float(u_pitch_with_map)*projected_pos.z/projected_pos.w;float projectionScaling=1.0;
#ifdef GLOBE
if(u_pitch_with_map) {float anchor_pos_tile_y=(u_coord_matrix*vec4(projected_pos.xy/projected_pos.w,z,1.0)).y;projectionScaling=mix(projectionScaling,1.0/circumferenceRatioAtTileY(anchor_pos_tile_y)*u_pitched_scale,u_projection_transition);}
#endif
vec4 finalPos=u_coord_matrix*vec4(projected_pos.xy/projected_pos.w+rotation_matrix*(a_offset/32.0*fontScale+a_pxoffset)*projectionScaling,z,1.0);if(u_pitch_with_map) {finalPos=projectTileWithElevation(finalPos.xy,finalPos.z);}float gamma_scale=finalPos.w;gl_Position=finalPos;vec2 fade_opacity=unpack_opacity(a_fade_opacity);float visibility=calculate_visibility(projectedPoint);float fade_change=fade_opacity[1] > 0.5 ? u_fade_change :-u_fade_change;float interpolated_fade_opacity=max(0.0,min(visibility,fade_opacity[0]+fade_change));v_data0=a_tex/u_texsize;v_data1=vec3(gamma_scale,size,interpolated_fade_opacity);}`),symbolTextAndIcon:ii(`#define SDF_PX 8.0
#define SDF 1.0
#define ICON 0.0
uniform bool u_is_halo;uniform sampler2D u_texture;uniform sampler2D u_texture_icon;uniform highp float u_gamma_scale;uniform lowp float u_device_pixel_ratio;in vec4 v_data0;in vec4 v_data1;
#pragma mapbox: define highp vec4 fill_color
#pragma mapbox: define highp vec4 halo_color
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp float halo_width
#pragma mapbox: define lowp float halo_blur
void main() {
#pragma mapbox: initialize highp vec4 fill_color
#pragma mapbox: initialize highp vec4 halo_color
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize lowp float halo_width
#pragma mapbox: initialize lowp float halo_blur
float fade_opacity=v_data1[2];if (v_data1.w==ICON) {vec2 tex_icon=v_data0.zw;lowp float alpha=opacity*fade_opacity;fragColor=texture(u_texture_icon,tex_icon)*alpha;
#ifdef OVERDRAW_INSPECTOR
fragColor=vec4(1.0);
#endif
return;}vec2 tex=v_data0.xy;float EDGE_GAMMA=0.105/u_device_pixel_ratio;float gamma_scale=v_data1.x;float size=v_data1.y;float fontScale=size/24.0;lowp vec4 color=fill_color;highp float gamma=EDGE_GAMMA/(fontScale*u_gamma_scale);lowp float buff=(256.0-64.0)/256.0;if (u_is_halo) {color=halo_color;gamma=(halo_blur*1.19/SDF_PX+EDGE_GAMMA)/(fontScale*u_gamma_scale);buff=(6.0-halo_width/fontScale)/SDF_PX;}lowp float dist=texture(u_texture,tex).a;highp float gamma_scaled=gamma*gamma_scale;highp float alpha=smoothstep(buff-gamma_scaled,buff+gamma_scaled,dist);fragColor=color*(alpha*opacity*fade_opacity);
#ifdef OVERDRAW_INSPECTOR
fragColor=vec4(1.0);
#endif
}`,`in vec4 a_pos_offset;in vec4 a_data;in vec3 a_projected_pos;in float a_fade_opacity;uniform bool u_is_size_zoom_constant;uniform bool u_is_size_feature_constant;uniform highp float u_size_t;uniform highp float u_size;uniform mat4 u_label_plane_matrix;uniform mat4 u_coord_matrix;uniform bool u_is_text;uniform bool u_pitch_with_map;uniform highp float u_pitch;uniform bool u_rotate_symbol;uniform highp float u_aspect_ratio;uniform highp float u_camera_to_center_distance;uniform float u_fade_change;uniform vec2 u_texsize;uniform vec2 u_texsize_icon;uniform bool u_is_along_line;uniform bool u_is_variable_anchor;uniform vec2 u_translation;uniform float u_pitched_scale;out vec4 v_data0;out vec4 v_data1;
#pragma mapbox: define highp vec4 fill_color
#pragma mapbox: define highp vec4 halo_color
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp float halo_width
#pragma mapbox: define lowp float halo_blur
void main() {
#pragma mapbox: initialize highp vec4 fill_color
#pragma mapbox: initialize highp vec4 halo_color
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize lowp float halo_width
#pragma mapbox: initialize lowp float halo_blur
vec2 a_pos=a_pos_offset.xy;vec2 a_offset=a_pos_offset.zw;vec2 a_tex=a_data.xy;vec2 a_size=a_data.zw;float a_size_min=floor(a_size[0]*0.5);float is_sdf=a_size[0]-2.0*a_size_min;float ele=get_elevation(a_pos);highp float segment_angle=-a_projected_pos[2];float size;if (!u_is_size_zoom_constant && !u_is_size_feature_constant) {size=mix(a_size_min,a_size[1],u_size_t)/128.0;} else if (u_is_size_zoom_constant && !u_is_size_feature_constant) {size=a_size_min/128.0;} else {size=u_size;}vec2 translated_a_pos=a_pos+u_translation;vec4 projectedPoint=projectTileWithElevation(translated_a_pos,ele);highp float camera_to_anchor_distance=projectedPoint.w;highp float distance_ratio=u_pitch_with_map ?
camera_to_anchor_distance/u_camera_to_center_distance :
u_camera_to_center_distance/camera_to_anchor_distance;highp float perspective_ratio=clamp(0.5+0.5*distance_ratio,0.0,4.0);size*=perspective_ratio;float fontScale=size/24.0;highp float symbol_rotation=0.0;if (u_rotate_symbol) {vec4 offsetProjectedPoint=projectTileWithElevation(translated_a_pos+vec2(1,0),ele);vec2 a=projectedPoint.xy/projectedPoint.w;vec2 b=offsetProjectedPoint.xy/offsetProjectedPoint.w;symbol_rotation=atan((b.y-a.y)/u_aspect_ratio,b.x-a.x);}highp float angle_sin=sin(segment_angle+symbol_rotation);highp float angle_cos=cos(segment_angle+symbol_rotation);mat2 rotation_matrix=mat2(angle_cos,-1.0*angle_sin,angle_sin,angle_cos);vec4 projected_pos;if (u_is_along_line || u_is_variable_anchor) {projected_pos=vec4(a_projected_pos.xy,ele,1.0);} else if (u_pitch_with_map) {projected_pos=u_label_plane_matrix*vec4(a_projected_pos.xy+u_translation,ele,1.0);} else {projected_pos=u_label_plane_matrix*projectTileWithElevation(a_projected_pos.xy+u_translation,ele);}float z=float(u_pitch_with_map)*projected_pos.z/projected_pos.w;float projectionScaling=1.0;
#ifdef GLOBE
if(u_pitch_with_map && !u_is_along_line) {float anchor_pos_tile_y=(u_coord_matrix*vec4(projected_pos.xy/projected_pos.w,z,1.0)).y;projectionScaling=mix(projectionScaling,1.0/circumferenceRatioAtTileY(anchor_pos_tile_y)*u_pitched_scale,u_projection_transition);}
#endif
vec4 finalPos=u_coord_matrix*vec4(projected_pos.xy/projected_pos.w+rotation_matrix*(a_offset/32.0*fontScale)*projectionScaling,z,1.0);if(u_pitch_with_map) {finalPos=projectTileWithElevation(finalPos.xy,finalPos.z);}float gamma_scale=finalPos.w;gl_Position=finalPos;vec2 fade_opacity=unpack_opacity(a_fade_opacity);float visibility=calculate_visibility(projectedPoint);float fade_change=fade_opacity[1] > 0.5 ? u_fade_change :-u_fade_change;float interpolated_fade_opacity=max(0.0,min(visibility,fade_opacity[0]+fade_change));v_data0.xy=a_tex/u_texsize;v_data0.zw=a_tex/u_texsize_icon;v_data1=vec4(gamma_scale,size,interpolated_fade_opacity,is_sdf);}`),terrain:ii("uniform sampler2D u_texture;uniform vec4 u_fog_color;uniform vec4 u_horizon_color;uniform float u_fog_ground_blend;uniform float u_fog_ground_blend_opacity;uniform float u_horizon_fog_blend;uniform bool u_is_globe_mode;in vec2 v_texture_pos;in float v_fog_depth;const float gamma=2.2;vec4 gammaToLinear(vec4 color) {return pow(color,vec4(gamma));}vec4 linearToGamma(vec4 color) {return pow(color,vec4(1.0/gamma));}void main() {vec4 surface_color=texture(u_texture,vec2(v_texture_pos.x,1.0-v_texture_pos.y));if (!u_is_globe_mode && v_fog_depth > u_fog_ground_blend) {vec4 surface_color_linear=gammaToLinear(surface_color);float blend_color=smoothstep(0.0,1.0,max((v_fog_depth-u_horizon_fog_blend)/(1.0-u_horizon_fog_blend),0.0));vec4 fog_horizon_color_linear=mix(gammaToLinear(u_fog_color),gammaToLinear(u_horizon_color),blend_color);float factor_fog=max(v_fog_depth-u_fog_ground_blend,0.0)/(1.0-u_fog_ground_blend);fragColor=linearToGamma(mix(surface_color_linear,fog_horizon_color_linear,pow(factor_fog,2.0)*u_fog_ground_blend_opacity));} else {fragColor=surface_color;}}","in vec3 a_pos3d;uniform mat4 u_fog_matrix;uniform float u_ele_delta;out vec2 v_texture_pos;out float v_fog_depth;void main() {float ele=get_elevation(a_pos3d.xy);float ele_delta=a_pos3d.z==1.0 ? u_ele_delta : 0.0;v_texture_pos=a_pos3d.xy/8192.0;gl_Position=projectTileFor3D(a_pos3d.xy,get_elevation(a_pos3d.xy)-ele_delta);vec4 pos=u_fog_matrix*vec4(a_pos3d.xy,ele,1.0);v_fog_depth=pos.z/pos.w*0.5+0.5;}"),terrainDepth:ii("in float v_depth;const highp vec4 bitSh=vec4(256.*256.*256.,256.*256.,256.,1.);const highp vec4 bitMsk=vec4(0.,vec3(1./256.0));highp vec4 pack(highp float value) {highp vec4 comp=fract(value*bitSh);comp-=comp.xxyz*bitMsk;return comp;}void main() {fragColor=pack(v_depth);}","in vec3 a_pos3d;uniform float u_ele_delta;out float v_depth;void main() {float ele=get_elevation(a_pos3d.xy);float ele_delta=a_pos3d.z==1.0 ? u_ele_delta : 0.0;gl_Position=projectTileFor3D(a_pos3d.xy,ele-ele_delta);v_depth=gl_Position.z/gl_Position.w;}"),terrainCoords:ii("precision mediump float;uniform sampler2D u_texture;uniform float u_terrain_coords_id;in vec2 v_texture_pos;void main() {vec4 rgba=texture(u_texture,v_texture_pos);fragColor=vec4(rgba.r,rgba.g,rgba.b,u_terrain_coords_id);}","in vec3 a_pos3d;uniform float u_ele_delta;out vec2 v_texture_pos;void main() {float ele=get_elevation(a_pos3d.xy);float ele_delta=a_pos3d.z==1.0 ? u_ele_delta : 0.0;v_texture_pos=a_pos3d.xy/8192.0;gl_Position=projectTileFor3D(a_pos3d.xy,ele-ele_delta);}"),projectionErrorMeasurement:ii("in vec4 v_output_error_encoded;void main() {fragColor=v_output_error_encoded;}","in vec2 a_pos;uniform highp float u_input;uniform highp float u_output_expected;out vec4 v_output_error_encoded;void main() {float real_output=2.0*atan(exp(PI-(u_input*PI*2.0)))-PI*0.5;float error=real_output-u_output_expected;float abs_error=abs(error)*128.0;v_output_error_encoded.x=min(floor(abs_error*256.0),255.0)/255.0;abs_error-=v_output_error_encoded.x;v_output_error_encoded.y=min(floor(abs_error*65536.0),255.0)/255.0;abs_error-=v_output_error_encoded.x/255.0;v_output_error_encoded.z=min(floor(abs_error*16777216.0),255.0)/255.0;v_output_error_encoded.w=error >=0.0 ? 1.0 : 0.0;gl_Position=vec4(a_pos,0.0,1.0);}"),atmosphere:ii(`in vec3 view_direction;uniform vec3 u_sun_pos;uniform vec3 u_globe_position;uniform float u_globe_radius;uniform float u_atmosphere_blend;/**Shader use from https:*Made some change to adapt to MapLibre Globe geometry*/const float PI=3.141592653589793;const int iSteps=5;const int jSteps=3;/*radius of the planet*/const float EARTH_RADIUS=6371e3;/*radius of the atmosphere*/const float ATMOS_RADIUS=6471e3;vec2 rsi(vec3 r0,vec3 rd,float sr) {float a=dot(rd,rd);float b=2.0*dot(rd,r0);float c=dot(r0,r0)-(sr*sr);float d=(b*b)-4.0*a*c;if (d < 0.0) return vec2(1e5,-1e5);return vec2((-b-sqrt(d))/(2.0*a),(-b+sqrt(d))/(2.0*a));}vec4 atmosphere(vec3 r,vec3 r0,vec3 pSun,float iSun,float rPlanet,float rAtmos,vec3 kRlh,float kMie,float shRlh,float shMie,float g) {pSun=normalize(pSun);r=normalize(r);vec2 p=rsi(r0,r,rAtmos);if (p.x > p.y) {return vec4(0.0,0.0,0.0,1.0);}if (p.x < 0.0) {p.x=0.0;}vec3 pos=r0+r*p.x;vec2 p2=rsi(r0,r,rPlanet);if (p2.x <=p2.y && p2.x > 0.0) {p.y=min(p.y,p2.x);}float iStepSize=(p.y-p.x)/float(iSteps);float iTime=p.x+iStepSize*0.5;vec3 totalRlh=vec3(0,0,0);vec3 totalMie=vec3(0,0,0);float iOdRlh=0.0;float iOdMie=0.0;float mu=dot(r,pSun);float mumu=mu*mu;float gg=g*g;float pRlh=3.0/(16.0*PI)*(1.0+mumu);float pMie=3.0/(8.0*PI)*((1.0-gg)*(mumu+1.0))/(pow(1.0+gg-2.0*mu*g,1.5)*(2.0+gg));for (int i=0; i < iSteps; i++) {vec3 iPos=r0+r*iTime;float iHeight=length(iPos)-rPlanet;float odStepRlh=exp(-iHeight/shRlh)*iStepSize;float odStepMie=exp(-iHeight/shMie)*iStepSize;iOdRlh+=odStepRlh;iOdMie+=odStepMie;float jStepSize=rsi(iPos,pSun,rAtmos).y/float(jSteps);float jTime=jStepSize*0.5;float jOdRlh=0.0;float jOdMie=0.0;for (int j=0; j < jSteps; j++) {vec3 jPos=iPos+pSun*jTime;float jHeight=length(jPos)-rPlanet;jOdRlh+=exp(-jHeight/shRlh)*jStepSize;jOdMie+=exp(-jHeight/shMie)*jStepSize;jTime+=jStepSize;}vec3 attn=exp(-(kMie*(iOdMie+jOdMie)+kRlh*(iOdRlh+jOdRlh)));totalRlh+=odStepRlh*attn;totalMie+=odStepMie*attn;iTime+=iStepSize;}float opacity=exp(-(length(kRlh)*length(totalRlh)+kMie*length(totalMie)));vec3 color=iSun*(pRlh*kRlh*totalRlh+pMie*kMie*totalMie);return vec4(color,opacity);}void main() {vec3 scale_camera_pos=-u_globe_position*EARTH_RADIUS/u_globe_radius;vec4 color=atmosphere(normalize(view_direction),scale_camera_pos,u_sun_pos,22.0,EARTH_RADIUS,ATMOS_RADIUS,vec3(5.5e-6,13.0e-6,22.4e-6),21e-6,8e3,1.2e3,0.758
);color.rgb=1.0-exp(-1.0*color.rgb);color=pow(color,vec4(1.0/2.2));fragColor=vec4(color.rgb,1.0-color.a)*u_atmosphere_blend;}`,"in vec2 a_pos;uniform mat4 u_inv_proj_matrix;out vec3 view_direction;void main() {view_direction=(u_inv_proj_matrix*vec4(a_pos,0.0,1.0)).xyz;gl_Position=vec4(a_pos,0.0,1.0);}"),sky:ii("uniform vec4 u_sky_color;uniform vec4 u_horizon_color;uniform vec2 u_horizon;uniform vec2 u_horizon_normal;uniform float u_sky_horizon_blend;uniform float u_sky_blend;void main() {float x=gl_FragCoord.x;float y=gl_FragCoord.y;float blend=(y-u_horizon.y)*u_horizon_normal.y+(x-u_horizon.x)*u_horizon_normal.x;if (blend > 0.0) {if (blend < u_sky_horizon_blend) {fragColor=mix(u_sky_color,u_horizon_color,pow(1.0-blend/u_sky_horizon_blend,2.0));} else {fragColor=u_sky_color;}}fragColor=mix(fragColor,vec4(vec3(0.0),0.0),u_sky_blend);}","in vec2 a_pos;void main() {gl_Position=vec4(a_pos,1.0,1.0);}")};function ii(oe,t){const G=/#pragma mapbox: ([\w]+) ([\w]+) ([\w]+) ([\w]+)/g,J=t.match(/in ([\w]+) ([\w]+)/g),te=oe.match(/uniform ([\w]+) ([\w]+)([\s]*)([\w]*)/g),se=t.match(/uniform ([\w]+) ([\w]+)([\s]*)([\w]*)/g),de=se?se.concat(te):te,_e={};return{fragmentSource:oe=oe.replace(G,(ge,xe,Se,Oe,Ae)=>(_e[Ae]=!0,xe==="define"?`
#ifndef HAS_UNIFORM_u_${Ae}
in ${Se} ${Oe} ${Ae};
#else
uniform ${Se} ${Oe} u_${Ae};
#endif
`:`
#ifdef HAS_UNIFORM_u_${Ae}
    ${Se} ${Oe} ${Ae} = u_${Ae};
#endif
`)),vertexSource:t=t.replace(G,(ge,xe,Se,Oe,Ae)=>{const je=Oe==="float"?"vec2":"vec4",Ye=Ae.match(/color/)?"color":je;return _e[Ae]?xe==="define"?`
#ifndef HAS_UNIFORM_u_${Ae}
uniform lowp float u_${Ae}_t;
in ${Se} ${je} a_${Ae};
out ${Se} ${Oe} ${Ae};
#else
uniform ${Se} ${Oe} u_${Ae};
#endif
`:Ye==="vec4"?`
#ifndef HAS_UNIFORM_u_${Ae}
    ${Ae} = a_${Ae};
#else
    ${Se} ${Oe} ${Ae} = u_${Ae};
#endif
`:`
#ifndef HAS_UNIFORM_u_${Ae}
    ${Ae} = unpack_mix_${Ye}(a_${Ae}, u_${Ae}_t);
#else
    ${Se} ${Oe} ${Ae} = u_${Ae};
#endif
`:xe==="define"?`
#ifndef HAS_UNIFORM_u_${Ae}
uniform lowp float u_${Ae}_t;
in ${Se} ${je} a_${Ae};
#else
uniform ${Se} ${Oe} u_${Ae};
#endif
`:Ye==="vec4"?`
#ifndef HAS_UNIFORM_u_${Ae}
    ${Se} ${Oe} ${Ae} = a_${Ae};
#else
    ${Se} ${Oe} ${Ae} = u_${Ae};
#endif
`:`
#ifndef HAS_UNIFORM_u_${Ae}
    ${Se} ${Oe} ${Ae} = unpack_mix_${Ye}(a_${Ae}, u_${Ae}_t);
#else
    ${Se} ${Oe} ${Ae} = u_${Ae};
#endif
`}),staticAttributes:J,staticUniforms:de}}class Wn{constructor(t,G,J){this.vertexBuffer=t,this.indexBuffer=G,this.segments=J}destroy(){this.vertexBuffer.destroy(),this.indexBuffer.destroy(),this.segments.destroy(),this.vertexBuffer=null,this.indexBuffer=null,this.segments=null}}var Hn=R.aI([{name:"a_pos",type:"Int16",components:2}]);const ga="#define PROJECTION_MERCATOR",Zs="mercator";class Ks{constructor(){this._cachedMesh=null}get name(){return"mercator"}get useSubdivision(){return!1}get shaderVariantName(){return Zs}get shaderDefine(){return ga}get shaderPreludeCode(){return Nn.projectionMercator}get vertexShaderPreludeCode(){return Nn.projectionMercator.vertexSource}get subdivisionGranularity(){return R.aJ.noSubdivision}get useGlobeControls(){return!1}get transitionState(){return 0}get latitudeErrorCorrectionRadians(){return 0}destroy(){}updateGPUdependent(t){}getMeshFromTileID(t,G,J,te,se){if(this._cachedMesh)return this._cachedMesh;const de=new R.aK;de.emplaceBack(0,0),de.emplaceBack(R.$,0),de.emplaceBack(0,R.$),de.emplaceBack(R.$,R.$);const _e=t.createVertexBuffer(de,Hn.members),ge=R.aL.simpleSegment(0,0,4,2),xe=new R.aM;xe.emplaceBack(1,0,2),xe.emplaceBack(1,2,3);const Se=t.createIndexBuffer(xe);return this._cachedMesh=new Wn(_e,Se,ge),this._cachedMesh}recalculate(){}hasTransition(){return!1}setErrorQueryLatitudeDegrees(t){}}class Rn{constructor(t=0,G=0,J=0,te=0){if(isNaN(t)||t<0||isNaN(G)||G<0||isNaN(J)||J<0||isNaN(te)||te<0)throw new Error("Invalid value for edge-insets, top, bottom, left and right must all be numbers");this.top=t,this.bottom=G,this.left=J,this.right=te}interpolate(t,G,J){return G.top!=null&&t.top!=null&&(this.top=R.C.number(t.top,G.top,J)),G.bottom!=null&&t.bottom!=null&&(this.bottom=R.C.number(t.bottom,G.bottom,J)),G.left!=null&&t.left!=null&&(this.left=R.C.number(t.left,G.left,J)),G.right!=null&&t.right!=null&&(this.right=R.C.number(t.right,G.right,J)),this}getCenter(t,G){const J=R.ag((this.left+t-this.right)/2,0,t),te=R.ag((this.top+G-this.bottom)/2,0,G);return new R.P(J,te)}equals(t){return this.top===t.top&&this.bottom===t.bottom&&this.left===t.left&&this.right===t.right}clone(){return new Rn(this.top,this.bottom,this.left,this.right)}toJSON(){return{top:this.top,bottom:this.bottom,left:this.left,right:this.right}}}function Zn(oe,t){if(!oe.renderWorldCopies||oe.lngRange)return;const G=t.lng-oe.center.lng;t.lng+=G>180?-360:G<-180?360:0}function ni(oe){return Math.max(0,Math.floor(oe))}class ho{constructor(t,G,J,te,se,de){this._callbacks=t,this._tileSize=512,this._renderWorldCopies=de===void 0||!!de,this._minZoom=G||0,this._maxZoom=J||22,this._minPitch=te??0,this._maxPitch=se??60,this.setMaxBounds(),this._width=0,this._height=0,this._center=new R.S(0,0),this._elevation=0,this._zoom=0,this._tileZoom=ni(this._zoom),this._scale=R.ae(this._zoom),this._bearingInRadians=0,this._fovInRadians=.6435011087932844,this._pitchInRadians=0,this._rollInRadians=0,this._unmodified=!0,this._edgeInsets=new Rn,this._minElevationForCurrentTile=0,this._autoCalculateNearFarZ=!0}apply(t,G,J){this._latRange=t.latRange,this._lngRange=t.lngRange,this._width=t.width,this._height=t.height,this._center=t.center,this._elevation=t.elevation,this._minElevationForCurrentTile=t.minElevationForCurrentTile,this._zoom=t.zoom,this._tileZoom=ni(this._zoom),this._scale=R.ae(this._zoom),this._bearingInRadians=t.bearingInRadians,this._fovInRadians=t.fovInRadians,this._pitchInRadians=t.pitchInRadians,this._rollInRadians=t.rollInRadians,this._unmodified=t.unmodified,this._edgeInsets=new Rn(t.padding.top,t.padding.bottom,t.padding.left,t.padding.right),this._minZoom=t.minZoom,this._maxZoom=t.maxZoom,this._minPitch=t.minPitch,this._maxPitch=t.maxPitch,this._renderWorldCopies=t.renderWorldCopies,this._cameraToCenterDistance=t.cameraToCenterDistance,this._nearZ=t.nearZ,this._farZ=t.farZ,this._autoCalculateNearFarZ=!J&&t.autoCalculateNearFarZ,G&&this._constrain(),this._calcMatrices()}get pixelsToClipSpaceMatrix(){return this._pixelsToClipSpaceMatrix}get clipSpaceToPixelsMatrix(){return this._clipSpaceToPixelsMatrix}get minElevationForCurrentTile(){return this._minElevationForCurrentTile}setMinElevationForCurrentTile(t){this._minElevationForCurrentTile=t}get tileSize(){return this._tileSize}get tileZoom(){return this._tileZoom}get scale(){return this._scale}get width(){return this._width}get height(){return this._height}get bearingInRadians(){return this._bearingInRadians}get lngRange(){return this._lngRange}get latRange(){return this._latRange}get pixelsToGLUnits(){return this._pixelsToGLUnits}get minZoom(){return this._minZoom}setMinZoom(t){this._minZoom!==t&&(this._minZoom=t,this.setZoom(this.getConstrained(this._center,this.zoom).zoom))}get maxZoom(){return this._maxZoom}setMaxZoom(t){this._maxZoom!==t&&(this._maxZoom=t,this.setZoom(this.getConstrained(this._center,this.zoom).zoom))}get minPitch(){return this._minPitch}setMinPitch(t){this._minPitch!==t&&(this._minPitch=t,this.setPitch(Math.max(this.pitch,t)))}get maxPitch(){return this._maxPitch}setMaxPitch(t){this._maxPitch!==t&&(this._maxPitch=t,this.setPitch(Math.min(this.pitch,t)))}get renderWorldCopies(){return this._renderWorldCopies}setRenderWorldCopies(t){t===void 0?t=!0:t===null&&(t=!1),this._renderWorldCopies=t}get worldSize(){return this._tileSize*this._scale}get centerOffset(){return this.centerPoint._sub(this.size._div(2))}get size(){return new R.P(this._width,this._height)}get bearing(){return this._bearingInRadians/Math.PI*180}setBearing(t){const G=R.aN(t,-180,180)*Math.PI/180;var J,te,se,de,_e,ge,xe,Se,Oe;this._bearingInRadians!==G&&(this._unmodified=!1,this._bearingInRadians=G,this._calcMatrices(),this._rotationMatrix=Z(),J=this._rotationMatrix,se=-this._bearingInRadians,de=(te=this._rotationMatrix)[0],_e=te[1],ge=te[2],xe=te[3],Se=Math.sin(se),Oe=Math.cos(se),J[0]=de*Oe+ge*Se,J[1]=_e*Oe+xe*Se,J[2]=de*-Se+ge*Oe,J[3]=_e*-Se+xe*Oe)}get rotationMatrix(){return this._rotationMatrix}get pitchInRadians(){return this._pitchInRadians}get pitch(){return this._pitchInRadians/Math.PI*180}setPitch(t){const G=R.ag(t,this.minPitch,this.maxPitch)/180*Math.PI;this._pitchInRadians!==G&&(this._unmodified=!1,this._pitchInRadians=G,this._calcMatrices())}get rollInRadians(){return this._rollInRadians}get roll(){return this._rollInRadians/Math.PI*180}setRoll(t){const G=t/180*Math.PI;this._rollInRadians!==G&&(this._unmodified=!1,this._rollInRadians=G,this._calcMatrices())}get fovInRadians(){return this._fovInRadians}get fov(){return R.aO(this._fovInRadians)}setFov(t){t=R.ag(t,.1,150),this.fov!==t&&(this._unmodified=!1,this._fovInRadians=R.ad(t),this._calcMatrices())}get zoom(){return this._zoom}setZoom(t){const G=this.getConstrained(this._center,t).zoom;this._zoom!==G&&(this._unmodified=!1,this._zoom=G,this._tileZoom=Math.max(0,Math.floor(G)),this._scale=R.ae(G),this._constrain(),this._calcMatrices())}get center(){return this._center}setCenter(t){t.lat===this._center.lat&&t.lng===this._center.lng||(this._unmodified=!1,this._center=t,this._constrain(),this._calcMatrices())}get elevation(){return this._elevation}setElevation(t){t!==this._elevation&&(this._elevation=t,this._constrain(),this._calcMatrices())}get padding(){return this._edgeInsets.toJSON()}setPadding(t){this._edgeInsets.equals(t)||(this._unmodified=!1,this._edgeInsets.interpolate(this._edgeInsets,t,1),this._calcMatrices())}get centerPoint(){return this._edgeInsets.getCenter(this._width,this._height)}get pixelsPerMeter(){return this._pixelPerMeter}get unmodified(){return this._unmodified}get cameraToCenterDistance(){return this._cameraToCenterDistance}get nearZ(){return this._nearZ}get farZ(){return this._farZ}get autoCalculateNearFarZ(){return this._autoCalculateNearFarZ}overrideNearFarZ(t,G){this._autoCalculateNearFarZ=!1,this._nearZ=t,this._farZ=G,this._calcMatrices()}clearNearFarZOverride(){this._autoCalculateNearFarZ=!0,this._calcMatrices()}isPaddingEqual(t){return this._edgeInsets.equals(t)}interpolatePadding(t,G,J){this._unmodified=!1,this._edgeInsets.interpolate(t,G,J),this._constrain(),this._calcMatrices()}resize(t,G,J=!0){this._width=t,this._height=G,J&&this._constrain(),this._calcMatrices()}getMaxBounds(){return this._latRange&&this._latRange.length===2&&this._lngRange&&this._lngRange.length===2?new wr([this._lngRange[0],this._latRange[0]],[this._lngRange[1],this._latRange[1]]):null}setMaxBounds(t){t?(this._lngRange=[t.getWest(),t.getEast()],this._latRange=[t.getSouth(),t.getNorth()],this._constrain()):(this._lngRange=null,this._latRange=[-R.ah,R.ah])}getConstrained(t,G){return this._callbacks.getConstrained(t,G)}getCameraQueryGeometry(t,G){if(G.length===1)return[G[0],t];{const{minX:J,minY:te,maxX:se,maxY:de}=R.a1.fromPoints(G).extend(t);return[new R.P(J,te),new R.P(se,te),new R.P(se,de),new R.P(J,de),new R.P(J,te)]}}_constrain(){if(!this.center||!this._width||!this._height||this._constraining)return;this._constraining=!0;const t=this._unmodified,{center:G,zoom:J}=this.getConstrained(this.center,this.zoom);this.setCenter(G),this.setZoom(J),this._unmodified=t,this._constraining=!1}_calcMatrices(){if(this._width&&this._height){this._pixelsToGLUnits=[2/this._width,-2/this._height];let t=R.af(new Float64Array(16));R.N(t,t,[this._width/2,-this._height/2,1]),R.M(t,t,[1,-1,0]),this._clipSpaceToPixelsMatrix=t,t=R.af(new Float64Array(16)),R.N(t,t,[1,-1,1]),R.M(t,t,[-1,-1,0]),R.N(t,t,[2/this._width,2/this._height,1]),this._pixelsToClipSpaceMatrix=t,this._cameraToCenterDistance=.5/Math.tan(this.fovInRadians/2)*this._height}this._callbacks.calcMatrices()}calculateCenterFromCameraLngLatAlt(t,G,J,te){const se=J!==void 0?J:this.bearing,de=te=te!==void 0?te:this.pitch,_e=R.a0.fromLngLat(t,G),ge=-Math.cos(R.ad(de)),xe=Math.sin(R.ad(de)),Se=xe*Math.sin(R.ad(se)),Oe=-xe*Math.cos(R.ad(se));let Ae=this.elevation;const je=G-Ae;let Ye;ge*je>=0||Math.abs(ge)<.1?(Ye=1e4,Ae=G+Ye*ge):Ye=-je/ge;let at,nt,ot=R.aP(1,_e.y),ht=0;do{if(ht+=1,ht>10)break;nt=Ye/ot,at=new R.a0(_e.x+Se*nt,_e.y+Oe*nt),ot=1/at.meterInMercatorCoordinateUnits()}while(Math.abs(Ye-nt*ot)>1e-12);return{center:at.toLngLat(),elevation:Ae,zoom:R.aj(this.height/2/Math.tan(this.fovInRadians/2)/nt/this.tileSize)}}recalculateZoomAndCenter(t){if(this.elevation-t==0)return;const G=R.ai(1,this.center.lat)*this.worldSize,J=this.cameraToCenterDistance/G,te=R.a0.fromLngLat(this.center,this.elevation),se=Le(this.center,this.elevation,this.pitch,this.bearing,J);this._elevation=t;const de=this.calculateCenterFromCameraLngLatAlt(se.toLngLat(),R.aP(se.z,te.y),this.bearing,this.pitch);this._elevation=de.elevation,this._center=de.center,this.setZoom(de.zoom)}getCameraPoint(){const t=Math.tan(this.pitchInRadians)*(this.cameraToCenterDistance||1);return this.centerPoint.add(new R.P(t*Math.sin(this.rollInRadians),t*Math.cos(this.rollInRadians)))}getCameraAltitude(){return Math.cos(this.pitchInRadians)*this._cameraToCenterDistance/this._pixelPerMeter+this.elevation}getCameraLngLat(){const t=R.ai(1,this.center.lat)*this.worldSize;return Le(this.center,this.elevation,this.pitch,this.bearing,this.cameraToCenterDistance/t).toLngLat()}getMercatorTileCoordinates(t){if(!t)return[0,0,1,1];const G=t.canonical.z>=0?1<<t.canonical.z:Math.pow(2,t.canonical.z);return[t.canonical.x/G,t.canonical.y/G,1/G/R.$,1/G/R.$]}}class Qo{constructor(t,G){this.min=t,this.max=G,this.center=R.aQ([],R.aR([],this.min,this.max),.5)}quadrant(t){const G=[t%2==0,t<2],J=R.aS(this.min),te=R.aS(this.max);for(let se=0;se<G.length;se++)J[se]=G[se]?this.min[se]:this.center[se],te[se]=G[se]?this.center[se]:this.max[se];return te[2]=this.max[2],new Qo(J,te)}distanceX(t){return Math.max(Math.min(this.max[0],t[0]),this.min[0])-t[0]}distanceY(t){return Math.max(Math.min(this.max[1],t[1]),this.min[1])-t[1]}intersectsFrustum(t){let G=!0;for(let J=0;J<t.planes.length;J++){const te=this.intersectsPlane(t.planes[J]);if(te===0)return 0;te===1&&(G=!1)}return G?2:t.aabb.min[0]>this.max[0]||t.aabb.min[1]>this.max[1]||t.aabb.min[2]>this.max[2]||t.aabb.max[0]<this.min[0]||t.aabb.max[1]<this.min[1]||t.aabb.max[2]<this.min[2]?0:1}intersectsPlane(t){let G=t[3],J=t[3];for(let te=0;te<3;te++)t[te]>0?(G+=t[te]*this.min[te],J+=t[te]*this.max[te]):(J+=t[te]*this.min[te],G+=t[te]*this.max[te]);return G>=0?2:J<0?0:1}}class Ys{distanceToTile2d(t,G,J,te){const se=te.distanceX([t,G]),de=te.distanceY([t,G]);return Math.hypot(se,de)}getWrap(t,G,J){return J}getTileBoundingVolume(t,G,J,te){var se,de;let _e=J,ge=J;if(te!=null&&te.terrain){const Se=new R.Z(t.z,G,t.z,t.x,t.y),Oe=te.terrain.getMinMaxElevation(Se);_e=(se=Oe.minElevation)!==null&&se!==void 0?se:J,ge=(de=Oe.maxElevation)!==null&&de!==void 0?de:J}const xe=1<<t.z;return new Qo([G+t.x/xe,t.y/xe,_e],[G+(t.x+1)/xe,(t.y+1)/xe,ge])}allowVariableZoom(t,G){const J=t.fov*(Math.abs(Math.cos(t.rollInRadians))*t.height+Math.abs(Math.sin(t.rollInRadians))*t.width)/t.height,te=R.ag(78.5-J/2,0,60);return!!G.terrain||t.pitch>te}allowWorldCopies(){return!0}prepareNextFrame(){}}class sn{constructor(t,G,J){this.points=t,this.planes=G,this.aabb=J}static fromInvProjectionMatrix(t,G=1,J=0,te,se){const de=se?[[6,5,4],[0,1,2],[0,3,7],[2,1,5],[3,2,6],[0,4,5]]:[[0,1,2],[6,5,4],[0,3,7],[2,1,5],[3,2,6],[0,4,5]],_e=Math.pow(2,J),ge=[[-1,1,-1,1],[1,1,-1,1],[1,-1,-1,1],[-1,-1,-1,1],[-1,1,1,1],[1,1,1,1],[1,-1,1,1],[-1,-1,1,1]].map(Ae=>function(je,Ye,at,nt){const ot=R.av([],je,Ye),ht=1/ot[3]/at*nt;return R.aX(ot,ot,[ht,ht,1/ot[3],ht])}(Ae,t,G,_e));te&&function(Ae,je,Ye,at){const nt=at?4:0,ot=at?0:4;let ht=0;const xt=[],mt=[];for(let vt=0;vt<4;vt++){const kt=R.aT([],Ae[vt+ot],Ae[vt+nt]),Vt=R.aY(kt);R.aQ(kt,kt,1/Vt),xt.push(Vt),mt.push(kt)}for(let vt=0;vt<4;vt++){const kt=R.aZ(Ae[vt+nt],mt[vt],Ye);ht=kt!==null&&kt>=0?Math.max(ht,kt):Math.max(ht,xt[vt])}const Tt=function(vt,kt){const Vt=R.aT([],vt[kt[0]],vt[kt[1]]),jt=R.aT([],vt[kt[2]],vt[kt[1]]),zt=[0,0,0,0];return R.aU(zt,R.aV([],Vt,jt)),zt[3]=-R.aW(zt,vt[kt[0]]),zt}(Ae,je),Pt=function(vt,kt){const Vt=R.a_(vt),jt=R.a$([],vt,1/Vt),zt=R.aT([],kt,R.aQ([],jt,R.aW(kt,jt))),$t=R.a_(zt);if($t>0){const mr=Math.sqrt(1-jt[3]*jt[3]),_r=R.aQ([],jt,-jt[3]),er=R.aR([],_r,R.aQ([],zt,mr/$t));return R.b0(kt,er)}return null}(Ye,Tt);if(Pt!==null){const vt=Pt/R.aW(mt[0],Tt);ht=Math.min(ht,vt)}for(let vt=0;vt<4;vt++){const kt=Math.min(ht,xt[vt]);Ae[vt+ot]=[Ae[vt+nt][0]+mt[vt][0]*kt,Ae[vt+nt][1]+mt[vt][1]*kt,Ae[vt+nt][2]+mt[vt][2]*kt,1]}}(ge,de[0],te,se);const xe=de.map(Ae=>{const je=R.aT([],ge[Ae[0]],ge[Ae[1]]),Ye=R.aT([],ge[Ae[2]],ge[Ae[1]]),at=R.aU([],R.aV([],je,Ye)),nt=-R.aW(at,ge[Ae[1]]);return at.concat(nt)}),Se=[Number.POSITIVE_INFINITY,Number.POSITIVE_INFINITY,Number.POSITIVE_INFINITY],Oe=[Number.NEGATIVE_INFINITY,Number.NEGATIVE_INFINITY,Number.NEGATIVE_INFINITY];for(const Ae of ge)for(let je=0;je<3;je++)Se[je]=Math.min(Se[je],Ae[je]),Oe[je]=Math.max(Oe[je],Ae[je]);return new sn(ge,xe,new Qo(Se,Oe))}}class Bi{get pixelsToClipSpaceMatrix(){return this._helper.pixelsToClipSpaceMatrix}get clipSpaceToPixelsMatrix(){return this._helper.clipSpaceToPixelsMatrix}get pixelsToGLUnits(){return this._helper.pixelsToGLUnits}get centerOffset(){return this._helper.centerOffset}get size(){return this._helper.size}get rotationMatrix(){return this._helper.rotationMatrix}get centerPoint(){return this._helper.centerPoint}get pixelsPerMeter(){return this._helper.pixelsPerMeter}setMinZoom(t){this._helper.setMinZoom(t)}setMaxZoom(t){this._helper.setMaxZoom(t)}setMinPitch(t){this._helper.setMinPitch(t)}setMaxPitch(t){this._helper.setMaxPitch(t)}setRenderWorldCopies(t){this._helper.setRenderWorldCopies(t)}setBearing(t){this._helper.setBearing(t)}setPitch(t){this._helper.setPitch(t)}setRoll(t){this._helper.setRoll(t)}setFov(t){this._helper.setFov(t)}setZoom(t){this._helper.setZoom(t)}setCenter(t){this._helper.setCenter(t)}setElevation(t){this._helper.setElevation(t)}setMinElevationForCurrentTile(t){this._helper.setMinElevationForCurrentTile(t)}setPadding(t){this._helper.setPadding(t)}interpolatePadding(t,G,J){return this._helper.interpolatePadding(t,G,J)}isPaddingEqual(t){return this._helper.isPaddingEqual(t)}resize(t,G,J=!0){this._helper.resize(t,G,J)}getMaxBounds(){return this._helper.getMaxBounds()}setMaxBounds(t){this._helper.setMaxBounds(t)}overrideNearFarZ(t,G){this._helper.overrideNearFarZ(t,G)}clearNearFarZOverride(){this._helper.clearNearFarZOverride()}getCameraQueryGeometry(t){return this._helper.getCameraQueryGeometry(this.getCameraPoint(),t)}get tileSize(){return this._helper.tileSize}get tileZoom(){return this._helper.tileZoom}get scale(){return this._helper.scale}get worldSize(){return this._helper.worldSize}get width(){return this._helper.width}get height(){return this._helper.height}get lngRange(){return this._helper.lngRange}get latRange(){return this._helper.latRange}get minZoom(){return this._helper.minZoom}get maxZoom(){return this._helper.maxZoom}get zoom(){return this._helper.zoom}get center(){return this._helper.center}get minPitch(){return this._helper.minPitch}get maxPitch(){return this._helper.maxPitch}get pitch(){return this._helper.pitch}get pitchInRadians(){return this._helper.pitchInRadians}get roll(){return this._helper.roll}get rollInRadians(){return this._helper.rollInRadians}get bearing(){return this._helper.bearing}get bearingInRadians(){return this._helper.bearingInRadians}get fov(){return this._helper.fov}get fovInRadians(){return this._helper.fovInRadians}get elevation(){return this._helper.elevation}get minElevationForCurrentTile(){return this._helper.minElevationForCurrentTile}get padding(){return this._helper.padding}get unmodified(){return this._helper.unmodified}get renderWorldCopies(){return this._helper.renderWorldCopies}get cameraToCenterDistance(){return this._helper.cameraToCenterDistance}get nearZ(){return this._helper.nearZ}get farZ(){return this._helper.farZ}get autoCalculateNearFarZ(){return this._helper.autoCalculateNearFarZ}setTransitionState(t,G){}constructor(t,G,J,te,se){this._posMatrixCache=new Map,this._alignedPosMatrixCache=new Map,this._fogMatrixCacheF32=new Map,this._helper=new ho({calcMatrices:()=>{this._calcMatrices()},getConstrained:(de,_e)=>this.getConstrained(de,_e)},t,G,J,te,se),this._coveringTilesDetailsProvider=new Ys}clone(){const t=new Bi;return t.apply(this),t}apply(t,G,J){this._helper.apply(t,G,J)}get cameraPosition(){return this._cameraPosition}get projectionMatrix(){return this._projectionMatrix}get modelViewProjectionMatrix(){return this._viewProjMatrix}get inverseProjectionMatrix(){return this._invProjMatrix}get mercatorMatrix(){return this._mercatorMatrix}getVisibleUnwrappedCoordinates(t){const G=[new R.b1(0,t)];if(this._helper._renderWorldCopies){const J=this.screenPointToMercatorCoordinate(new R.P(0,0)),te=this.screenPointToMercatorCoordinate(new R.P(this._helper._width,0)),se=this.screenPointToMercatorCoordinate(new R.P(this._helper._width,this._helper._height)),de=this.screenPointToMercatorCoordinate(new R.P(0,this._helper._height)),_e=Math.floor(Math.min(J.x,te.x,se.x,de.x)),ge=Math.floor(Math.max(J.x,te.x,se.x,de.x)),xe=1;for(let Se=_e-xe;Se<=ge+xe;Se++)Se!==0&&G.push(new R.b1(Se,t))}return G}getCameraFrustum(){return sn.fromInvProjectionMatrix(this._invViewProjMatrix,this.worldSize)}getClippingPlane(){return null}getCoveringTilesDetailsProvider(){return this._coveringTilesDetailsProvider}recalculateZoomAndCenter(t){const G=this.screenPointToLocation(this.centerPoint,t),J=t?t.getElevationForLngLatZoom(G,this._helper._tileZoom):0;this._helper.recalculateZoomAndCenter(J)}setLocationAtPoint(t,G){const J=R.ai(this.elevation,this.center.lat),te=this.screenPointToMercatorCoordinateAtZ(G,J),se=this.screenPointToMercatorCoordinateAtZ(this.centerPoint,J),de=R.a0.fromLngLat(t),_e=new R.a0(de.x-(te.x-se.x),de.y-(te.y-se.y));this.setCenter(_e==null?void 0:_e.toLngLat()),this._helper._renderWorldCopies&&this.setCenter(this.center.wrap())}locationToScreenPoint(t,G){return G?this.coordinatePoint(R.a0.fromLngLat(t),G.getElevationForLngLatZoom(t,this._helper._tileZoom),this._pixelMatrix3D):this.coordinatePoint(R.a0.fromLngLat(t))}screenPointToLocation(t,G){var J;return(J=this.screenPointToMercatorCoordinate(t,G))===null||J===void 0?void 0:J.toLngLat()}screenPointToMercatorCoordinate(t,G){if(G){const J=G.pointCoordinate(t);if(J!=null)return J}return this.screenPointToMercatorCoordinateAtZ(t)}screenPointToMercatorCoordinateAtZ(t,G){const J=G||0,te=[t.x,t.y,0,1],se=[t.x,t.y,1,1];R.av(te,te,this._pixelMatrixInverse),R.av(se,se,this._pixelMatrixInverse);const de=te[3],_e=se[3],ge=te[1]/de,xe=se[1]/_e,Se=te[2]/de,Oe=se[2]/_e,Ae=Se===Oe?0:(J-Se)/(Oe-Se);return new R.a0(R.C.number(te[0]/de,se[0]/_e,Ae)/this.worldSize,R.C.number(ge,xe,Ae)/this.worldSize,J)}coordinatePoint(t,G=0,J=this._pixelMatrix){const te=[t.x*this.worldSize,t.y*this.worldSize,G,1];return R.av(te,te,J),new R.P(te[0]/te[3],te[1]/te[3])}getBounds(){const t=Math.max(0,this._helper._height/2-De(this));return new wr().extend(this.screenPointToLocation(new R.P(0,t))).extend(this.screenPointToLocation(new R.P(this._helper._width,t))).extend(this.screenPointToLocation(new R.P(this._helper._width,this._helper._height))).extend(this.screenPointToLocation(new R.P(0,this._helper._height)))}isPointOnMapSurface(t,G){return G?G.pointCoordinate(t)!=null:t.y>this.height/2-De(this)}calculatePosMatrix(t,G=!1,J){var te;const se=(te=t.key)!==null&&te!==void 0?te:R.b2(t.wrap,t.canonical.z,t.canonical.z,t.canonical.x,t.canonical.y),de=G?this._alignedPosMatrixCache:this._posMatrixCache;if(de.has(se)){const xe=de.get(se);return J?xe.f32:xe.f64}const _e=ze(t,this.worldSize);R.O(_e,G?this._alignedProjMatrix:this._viewProjMatrix,_e);const ge={f64:_e,f32:new Float32Array(_e)};return de.set(se,ge),J?ge.f32:ge.f64}calculateFogMatrix(t){const G=t.key,J=this._fogMatrixCacheF32;if(J.has(G))return J.get(G);const te=ze(t,this.worldSize);return R.O(te,this._fogMatrix,te),J.set(G,new Float32Array(te)),J.get(G)}getConstrained(t,G){G=R.ag(+G,this.minZoom,this.maxZoom);const J={center:new R.S(t.lng,t.lat),zoom:G};let te=this._helper._lngRange;if(!this._helper._renderWorldCopies&&te===null){const xt=179.9999999999;te=[-xt,xt]}const se=this.tileSize*R.ae(J.zoom);let de=0,_e=se,ge=0,xe=se,Se=0,Oe=0;const{x:Ae,y:je}=this.size;if(this._helper._latRange){const xt=this._helper._latRange;de=R.U(xt[1])*se,_e=R.U(xt[0])*se,_e-de<je&&(Se=je/(_e-de))}te&&(ge=R.aN(R.V(te[0])*se,0,se),xe=R.aN(R.V(te[1])*se,0,se),xe<ge&&(xe+=se),xe-ge<Ae&&(Oe=Ae/(xe-ge)));const{x:Ye,y:at}=Ve(se,t);let nt,ot;const ht=Math.max(Oe||0,Se||0);if(ht){const xt=new R.P(Oe?(xe+ge)/2:Ye,Se?(_e+de)/2:at);return J.center=qe(se,xt).wrap(),J.zoom+=R.aj(ht),J}if(this._helper._latRange){const xt=je/2;at-xt<de&&(ot=de+xt),at+xt>_e&&(ot=_e-xt)}if(te){const xt=(ge+xe)/2;let mt=Ye;this._helper._renderWorldCopies&&(mt=R.aN(Ye,xt-se/2,xt+se/2));const Tt=Ae/2;mt-Tt<ge&&(nt=ge+Tt),mt+Tt>xe&&(nt=xe-Tt)}if(nt!==void 0||ot!==void 0){const xt=new R.P(nt??Ye,ot??at);J.center=qe(se,xt).wrap()}return J}calculateCenterFromCameraLngLatAlt(t,G,J,te){return this._helper.calculateCenterFromCameraLngLatAlt(t,G,J,te)}_calculateNearFarZIfNeeded(t,G,J){if(!this._helper.autoCalculateNearFarZ)return;const te=Math.min(this.elevation,this.minElevationForCurrentTile,this.getCameraAltitude()-100),se=t-te*this._helper._pixelPerMeter/Math.cos(G),de=te<0?se:t,_e=Math.PI/2+this.pitchInRadians,ge=R.ad(this.fov)*(Math.abs(Math.cos(R.ad(this.roll)))*this.height+Math.abs(Math.sin(R.ad(this.roll)))*this.width)/this.height*(.5+J.y/this.height),xe=Math.sin(ge)*de/Math.sin(R.ag(Math.PI-_e-ge,.01,Math.PI-.01)),Se=De(this),Oe=Math.atan(Se/this._helper.cameraToCenterDistance),Ae=R.ad(.75),je=Oe>Ae?2*Oe*(.5+J.y/(2*Se)):Ae,Ye=Math.sin(je)*de/Math.sin(R.ag(Math.PI-_e-je,.01,Math.PI-.01)),at=Math.min(xe,Ye);this._helper._farZ=1.01*(Math.cos(Math.PI/2-G)*at+de),this._helper._nearZ=this._helper._height/50}_calcMatrices(){if(!this._helper._height)return;const t=this.centerOffset,G=Ve(this.worldSize,this.center),J=G.x,te=G.y;this._helper._pixelPerMeter=R.ai(1,this.center.lat)*this.worldSize;const se=R.ad(Math.min(this.pitch,ut)),de=Math.max(this._helper.cameraToCenterDistance/2,this._helper.cameraToCenterDistance+this._helper._elevation*this._helper._pixelPerMeter/Math.cos(se));let _e;this._calculateNearFarZIfNeeded(de,se,t),_e=new Float64Array(16),R.b3(_e,this.fovInRadians,this._helper._width/this._helper._height,this._helper._nearZ,this._helper._farZ),this._invProjMatrix=new Float64Array(16),R.ap(this._invProjMatrix,_e),_e[8]=2*-t.x/this._helper._width,_e[9]=2*t.y/this._helper._height,this._projectionMatrix=R.b4(_e),R.N(_e,_e,[1,-1,1]),R.M(_e,_e,[0,0,-this._helper.cameraToCenterDistance]),R.b5(_e,_e,-this.rollInRadians),R.b6(_e,_e,this.pitchInRadians),R.b5(_e,_e,-this.bearingInRadians),R.M(_e,_e,[-J,-te,0]),this._mercatorMatrix=R.N([],_e,[this.worldSize,this.worldSize,this.worldSize]),R.N(_e,_e,[1,1,this._helper._pixelPerMeter]),this._pixelMatrix=R.O(new Float64Array(16),this.clipSpaceToPixelsMatrix,_e),R.M(_e,_e,[0,0,-this.elevation]),this._viewProjMatrix=_e,this._invViewProjMatrix=R.ap([],_e);const ge=[0,0,-1,1];R.av(ge,ge,this._invViewProjMatrix),this._cameraPosition=[ge[0]/ge[3],ge[1]/ge[3],ge[2]/ge[3]],this._fogMatrix=new Float64Array(16),R.b3(this._fogMatrix,this.fovInRadians,this.width/this.height,de,this._helper._farZ),this._fogMatrix[8]=2*-t.x/this.width,this._fogMatrix[9]=2*t.y/this.height,R.N(this._fogMatrix,this._fogMatrix,[1,-1,1]),R.M(this._fogMatrix,this._fogMatrix,[0,0,-this.cameraToCenterDistance]),R.b5(this._fogMatrix,this._fogMatrix,-this.rollInRadians),R.b6(this._fogMatrix,this._fogMatrix,this.pitchInRadians),R.b5(this._fogMatrix,this._fogMatrix,-this.bearingInRadians),R.M(this._fogMatrix,this._fogMatrix,[-J,-te,0]),R.N(this._fogMatrix,this._fogMatrix,[1,1,this._helper._pixelPerMeter]),R.M(this._fogMatrix,this._fogMatrix,[0,0,-this.elevation]),this._pixelMatrix3D=R.O(new Float64Array(16),this.clipSpaceToPixelsMatrix,_e);const xe=this._helper._width%2/2,Se=this._helper._height%2/2,Oe=Math.cos(this.bearingInRadians),Ae=Math.sin(-this.bearingInRadians),je=J-Math.round(J)+Oe*xe+Ae*Se,Ye=te-Math.round(te)+Oe*Se+Ae*xe,at=new Float64Array(_e);if(R.M(at,at,[je>.5?je-1:je,Ye>.5?Ye-1:Ye,0]),this._alignedProjMatrix=at,_e=R.ap(new Float64Array(16),this._pixelMatrix),!_e)throw new Error("failed to invert matrix");this._pixelMatrixInverse=_e,this._clearMatrixCaches()}_clearMatrixCaches(){this._posMatrixCache.clear(),this._alignedPosMatrixCache.clear(),this._fogMatrixCacheF32.clear()}maxPitchScaleFactor(){if(!this._pixelMatrixInverse)return 1;const t=this.screenPointToMercatorCoordinate(new R.P(0,0)),G=[t.x*this.worldSize,t.y*this.worldSize,0,1];return R.av(G,G,this._pixelMatrix)[3]/this._helper.cameraToCenterDistance}getCameraPoint(){return this._helper.getCameraPoint()}getCameraAltitude(){return this._helper.getCameraAltitude()}getCameraLngLat(){const t=R.ai(1,this.center.lat)*this.worldSize;return Le(this.center,this.elevation,this.pitch,this.bearing,this._helper.cameraToCenterDistance/t).toLngLat()}lngLatToCameraDepth(t,G){const J=R.a0.fromLngLat(t),te=[J.x*this.worldSize,J.y*this.worldSize,G,1];return R.av(te,te,this._viewProjMatrix),te[2]/te[3]}getProjectionData(t){const{overscaledTileID:G,aligned:J,applyTerrainMatrix:te}=t,se=this._helper.getMercatorTileCoordinates(G),de=G?this.calculatePosMatrix(G,J,!0):null;let _e;return _e=G&&G.terrainRttPosMatrix32f&&te?G.terrainRttPosMatrix32f:de||R.b7(),{mainMatrix:_e,tileMercatorCoords:se,clippingPlane:[0,0,0,0],projectionTransition:0,fallbackMatrix:_e}}isLocationOccluded(t){return!1}getPixelScale(){return 1}getCircleRadiusCorrection(){return 1}getPitchedTextCorrection(t,G,J){return 1}transformLightDirection(t){return R.aS(t)}getRayDirectionFromPixel(t){throw new Error("Not implemented.")}projectTileCoordinates(t,G,J,te){const se=this.calculatePosMatrix(J);let de;te?(de=[t,G,te(t,G),1],R.av(de,de,se)):(de=[t,G,0,1],pi(de,de,se));const _e=de[3];return{point:new R.P(de[0]/_e,de[1]/_e),signedDistanceFromCamera:_e,isOccluded:!1}}populateCache(t){for(const G of t)this.calculatePosMatrix(G)}getMatrixForModel(t,G){const J=R.a0.fromLngLat(t,G),te=J.meterInMercatorCoordinateUnits(),se=R.b8();return R.M(se,se,[J.x,J.y,J.z]),R.b5(se,se,Math.PI),R.b6(se,se,Math.PI/2),R.N(se,se,[-te,te,te]),se}getProjectionDataForCustomLayer(t=!0){const G=new R.Z(0,0,0,0,0),J=this.getProjectionData({overscaledTileID:G,applyGlobeMatrix:t}),te=ze(G,this.worldSize);R.O(te,this._viewProjMatrix,te),J.tileMercatorCoords=[0,0,1,1];const se=[R.$,R.$,this.worldSize/this._helper.pixelsPerMeter],de=R.b9();return R.N(de,te,se),J.fallbackMatrix=de,J.mainMatrix=de,J}getFastPathSimpleProjectionMatrix(t){return this.calculatePosMatrix(t)}}function un(){R.w("Map cannot fit within canvas with the given bounds, padding, and/or offset.")}function $i(oe){if(oe.useSlerp)if(oe.k<1){const t=R.ba(oe.startEulerAngles.roll,oe.startEulerAngles.pitch,oe.startEulerAngles.bearing),G=R.ba(oe.endEulerAngles.roll,oe.endEulerAngles.pitch,oe.endEulerAngles.bearing),J=new Float64Array(4);R.bb(J,t,G,oe.k);const te=R.bc(J);oe.tr.setRoll(te.roll),oe.tr.setPitch(te.pitch),oe.tr.setBearing(te.bearing)}else oe.tr.setRoll(oe.endEulerAngles.roll),oe.tr.setPitch(oe.endEulerAngles.pitch),oe.tr.setBearing(oe.endEulerAngles.bearing);else oe.tr.setRoll(R.C.number(oe.startEulerAngles.roll,oe.endEulerAngles.roll,oe.k)),oe.tr.setPitch(R.C.number(oe.startEulerAngles.pitch,oe.endEulerAngles.pitch,oe.k)),oe.tr.setBearing(R.C.number(oe.startEulerAngles.bearing,oe.endEulerAngles.bearing,oe.k))}function Ti(oe,t,G,J,te){const se=te.padding,de=Ve(te.worldSize,G.getNorthWest()),_e=Ve(te.worldSize,G.getNorthEast()),ge=Ve(te.worldSize,G.getSouthEast()),xe=Ve(te.worldSize,G.getSouthWest()),Se=R.ad(-J),Oe=de.rotate(Se),Ae=_e.rotate(Se),je=ge.rotate(Se),Ye=xe.rotate(Se),at=new R.P(Math.max(Oe.x,Ae.x,Ye.x,je.x),Math.max(Oe.y,Ae.y,Ye.y,je.y)),nt=new R.P(Math.min(Oe.x,Ae.x,Ye.x,je.x),Math.min(Oe.y,Ae.y,Ye.y,je.y)),ot=at.sub(nt),ht=(te.width-(se.left+se.right+t.left+t.right))/ot.x,xt=(te.height-(se.top+se.bottom+t.top+t.bottom))/ot.y;if(xt<0||ht<0)return void un();const mt=Math.min(R.aj(te.scale*Math.min(ht,xt)),oe.maxZoom),Tt=R.P.convert(oe.offset),Pt=new R.P((t.left-t.right)/2,(t.top-t.bottom)/2).rotate(R.ad(J)),vt=Tt.add(Pt).mult(te.scale/R.ae(mt));return{center:qe(te.worldSize,de.add(ge).div(2).sub(vt)),zoom:mt,bearing:J}}class es{get useGlobeControls(){return!1}handlePanInertia(t,G){return{easingOffset:t,easingCenter:G.center}}handleMapControlsRollPitchBearingZoom(t,G){t.bearingDelta&&G.setBearing(G.bearing+t.bearingDelta),t.pitchDelta&&G.setPitch(G.pitch+t.pitchDelta),t.rollDelta&&G.setRoll(G.roll+t.rollDelta),t.zoomDelta&&G.setZoom(G.zoom+t.zoomDelta)}handleMapControlsPan(t,G,J){t.around.distSqr(G.centerPoint)<.01||G.setLocationAtPoint(J,t.around)}cameraForBoxAndBearing(t,G,J,te,se){return Ti(t,G,J,te,se)}handleJumpToCenterZoom(t,G){t.zoom!==(G.zoom!==void 0?+G.zoom:t.zoom)&&t.setZoom(+G.zoom),G.center!==void 0&&t.setCenter(R.S.convert(G.center))}handleEaseTo(t,G){const J=t.zoom,te=t.padding,se={roll:t.roll,pitch:t.pitch,bearing:t.bearing},de={roll:G.roll===void 0?t.roll:G.roll,pitch:G.pitch===void 0?t.pitch:G.pitch,bearing:G.bearing===void 0?t.bearing:G.bearing},_e=G.zoom!==void 0,ge=!t.isPaddingEqual(G.padding);let xe=!1;const Se=_e?+G.zoom:t.zoom;let Oe=t.centerPoint.add(G.offsetAsPoint);const Ae=t.screenPointToLocation(Oe),{center:je,zoom:Ye}=t.getConstrained(R.S.convert(G.center||Ae),Se??J);Zn(t,je);const at=Ve(t.worldSize,Ae),nt=Ve(t.worldSize,je).sub(at),ot=R.ae(Ye-J);return xe=Ye!==J,{easeFunc:ht=>{if(xe&&t.setZoom(R.C.number(J,Ye,ht)),R.bd(se,de)||$i({startEulerAngles:se,endEulerAngles:de,tr:t,k:ht,useSlerp:se.roll!=de.roll}),ge&&(t.interpolatePadding(te,G.padding,ht),Oe=t.centerPoint.add(G.offsetAsPoint)),G.around)t.setLocationAtPoint(G.around,G.aroundPoint);else{const xt=R.ae(t.zoom-J),mt=Ye>J?Math.min(2,ot):Math.max(.5,ot),Tt=Math.pow(mt,1-ht),Pt=qe(t.worldSize,at.add(nt.mult(ht*Tt)).mult(xt));t.setLocationAtPoint(t.renderWorldCopies?Pt.wrap():Pt,Oe)}},isZooming:xe,elevationCenter:je}}handleFlyTo(t,G){const J=G.zoom!==void 0,te=t.zoom,se=t.getConstrained(R.S.convert(G.center||G.locationAtOffset),J?+G.zoom:te),de=se.center,_e=se.zoom;Zn(t,de);const ge=Ve(t.worldSize,G.locationAtOffset),xe=Ve(t.worldSize,de).sub(ge),Se=xe.mag(),Oe=R.ae(_e-te);let Ae;if(G.minZoom!==void 0){const je=Math.min(+G.minZoom,te,_e),Ye=t.getConstrained(de,je).zoom;Ae=R.ae(Ye-te)}return{easeFunc:(je,Ye,at,nt)=>{t.setZoom(je===1?_e:te+R.aj(Ye));const ot=je===1?de:qe(t.worldSize,ge.add(xe.mult(at)).mult(Ye));t.setLocationAtPoint(t.renderWorldCopies?ot.wrap():ot,nt)},scaleOfZoom:Oe,targetCenter:de,scaleOfMinZoom:Ae,pixelPathLength:Se}}}class ui{constructor(t,G,J){this.blendFunction=t,this.blendColor=G,this.mask=J}}ui.Replace=[1,0],ui.disabled=new ui(ui.Replace,R.be.transparent,[!1,!1,!1,!1]),ui.unblended=new ui(ui.Replace,R.be.transparent,[!0,!0,!0,!0]),ui.alphaBlended=new ui([1,771],R.be.transparent,[!0,!0,!0,!0]);const gn=2305;class Xr{constructor(t,G,J){this.enable=t,this.mode=G,this.frontFace=J}}Xr.disabled=new Xr(!1,1029,gn),Xr.backCCW=new Xr(!0,1029,gn),Xr.frontCCW=new Xr(!0,1028,gn);class ei{constructor(t,G,J){this.func=t,this.mask=G,this.range=J}}ei.ReadOnly=!1,ei.ReadWrite=!0,ei.disabled=new ei(519,ei.ReadOnly,[0,1]);const va=7680;class $r{constructor(t,G,J,te,se,de){this.test=t,this.ref=G,this.mask=J,this.fail=te,this.depthFail=se,this.pass=de}}$r.disabled=new $r({func:519,mask:0},0,0,va,va,va);const ba=new WeakMap;function hn(oe){var t;if(ba.has(oe))return ba.get(oe);{const G=(t=oe.getParameter(oe.VERSION))===null||t===void 0?void 0:t.startsWith("WebGL 2.0");return ba.set(oe,G),G}}class Ma{get awaitingQuery(){return!!this._readbackQueue}constructor(t){this._readbackWaitFrames=4,this._measureWaitFrames=6,this._texWidth=1,this._texHeight=1,this._measuredError=0,this._updateCount=0,this._lastReadbackFrame=-1e3,this._readbackQueue=null,this._cachedRenderContext=t;const G=t.context,J=G.gl;this._texFormat=J.RGBA,this._texType=J.UNSIGNED_BYTE;const te=new R.aK;te.emplaceBack(-1,-1),te.emplaceBack(2,-1),te.emplaceBack(-1,2);const se=new R.aM;se.emplaceBack(0,1,2),this._fullscreenTriangle=new Wn(G.createVertexBuffer(te,Hn.members),G.createIndexBuffer(se),R.aL.simpleSegment(0,0,te.length,se.length)),this._resultBuffer=new Uint8Array(4),G.activeTexture.set(J.TEXTURE1);const de=J.createTexture();J.bindTexture(J.TEXTURE_2D,de),J.texParameteri(J.TEXTURE_2D,J.TEXTURE_WRAP_S,J.CLAMP_TO_EDGE),J.texParameteri(J.TEXTURE_2D,J.TEXTURE_WRAP_T,J.CLAMP_TO_EDGE),J.texParameteri(J.TEXTURE_2D,J.TEXTURE_MIN_FILTER,J.NEAREST),J.texParameteri(J.TEXTURE_2D,J.TEXTURE_MAG_FILTER,J.NEAREST),J.texImage2D(J.TEXTURE_2D,0,this._texFormat,this._texWidth,this._texHeight,0,this._texFormat,this._texType,null),this._fbo=G.createFramebuffer(this._texWidth,this._texHeight,!1,!1),this._fbo.colorAttachment.set(de),hn(J)&&(this._pbo=J.createBuffer(),J.bindBuffer(J.PIXEL_PACK_BUFFER,this._pbo),J.bufferData(J.PIXEL_PACK_BUFFER,4,J.STREAM_READ),J.bindBuffer(J.PIXEL_PACK_BUFFER,null))}destroy(){const t=this._cachedRenderContext.context.gl;this._fullscreenTriangle.destroy(),this._fbo.destroy(),t.deleteBuffer(this._pbo),this._fullscreenTriangle=null,this._fbo=null,this._pbo=null,this._resultBuffer=null}updateErrorLoop(t,G){const J=this._updateCount;return this._readbackQueue?J>=this._readbackQueue.frameNumberIssued+this._readbackWaitFrames&&this._tryReadback():J>=this._lastReadbackFrame+this._measureWaitFrames&&this._renderErrorTexture(t,G),this._updateCount++,this._measuredError}_bindFramebuffer(){const t=this._cachedRenderContext.context,G=t.gl;t.activeTexture.set(G.TEXTURE1),G.bindTexture(G.TEXTURE_2D,this._fbo.colorAttachment.get()),t.bindFramebuffer.set(this._fbo.framebuffer)}_renderErrorTexture(t,G){const J=this._cachedRenderContext.context,te=J.gl;if(this._bindFramebuffer(),J.viewport.set([0,0,this._texWidth,this._texHeight]),J.clear({color:R.be.transparent}),this._cachedRenderContext.useProgram("projectionErrorMeasurement").draw(J,te.TRIANGLES,ei.disabled,$r.disabled,ui.unblended,Xr.disabled,((se,de)=>({u_input:se,u_output_expected:de}))(t,G),null,null,"$clipping",this._fullscreenTriangle.vertexBuffer,this._fullscreenTriangle.indexBuffer,this._fullscreenTriangle.segments),this._pbo&&hn(te)){te.bindBuffer(te.PIXEL_PACK_BUFFER,this._pbo),te.readBuffer(te.COLOR_ATTACHMENT0),te.readPixels(0,0,this._texWidth,this._texHeight,this._texFormat,this._texType,0),te.bindBuffer(te.PIXEL_PACK_BUFFER,null);const se=te.fenceSync(te.SYNC_GPU_COMMANDS_COMPLETE,0);te.flush(),this._readbackQueue={frameNumberIssued:this._updateCount,sync:se}}else this._readbackQueue={frameNumberIssued:this._updateCount,sync:null}}_tryReadback(){const t=this._cachedRenderContext.context.gl;if(this._pbo&&this._readbackQueue&&hn(t)){const G=t.clientWaitSync(this._readbackQueue.sync,0,0);if(G===t.WAIT_FAILED)return R.w("WebGL2 clientWaitSync failed."),this._readbackQueue=null,void(this._lastReadbackFrame=this._updateCount);if(G===t.TIMEOUT_EXPIRED)return;t.bindBuffer(t.PIXEL_PACK_BUFFER,this._pbo),t.getBufferSubData(t.PIXEL_PACK_BUFFER,0,this._resultBuffer,0,4),t.bindBuffer(t.PIXEL_PACK_BUFFER,null)}else this._bindFramebuffer(),t.readPixels(0,0,this._texWidth,this._texHeight,this._texFormat,this._texType,this._resultBuffer);this._readbackQueue=null,this._measuredError=Ma._parseRGBA8float(this._resultBuffer),this._lastReadbackFrame=this._updateCount}static _parseRGBA8float(t){let G=0;return G+=t[0]/256,G+=t[1]/65536,G+=t[2]/16777216,t[3]<127&&(G=-G),G/128}}const vn=R.$/128;function Xs(oe,t){const G=oe.granularity!==void 0?Math.max(oe.granularity,1):1,J=G+(oe.generateBorders?2:0),te=G+(oe.extendToNorthPole||oe.generateBorders?1:0)+(oe.extendToSouthPole||oe.generateBorders?1:0),se=J+1,de=te+1,_e=oe.generateBorders?-1:0,ge=oe.generateBorders||oe.extendToNorthPole?-1:0,xe=G+(oe.generateBorders?1:0),Se=G+(oe.generateBorders||oe.extendToSouthPole?1:0),Oe=se*de,Ae=J*te*6,je=se*de>65536;if(je&&t==="16bit")throw new Error("Granularity is too large and meshes would not fit inside 16 bit vertex indices.");const Ye=je||t==="32bit",at=new Int16Array(2*Oe);let nt=0;for(let xt=ge;xt<=Se;xt++)for(let mt=_e;mt<=xe;mt++){let Tt=mt/G*R.$;mt===-1&&(Tt=-vn),mt===G+1&&(Tt=R.$+vn);let Pt=xt/G*R.$;xt===-1&&(Pt=oe.extendToNorthPole?R.bg:-vn),xt===G+1&&(Pt=oe.extendToSouthPole?R.bh:R.$+vn),at[nt++]=Tt,at[nt++]=Pt}const ot=Ye?new Uint32Array(Ae):new Uint16Array(Ae);let ht=0;for(let xt=0;xt<te;xt++)for(let mt=0;mt<J;mt++){const Tt=mt+1+xt*se,Pt=mt+(xt+1)*se,vt=mt+1+(xt+1)*se;ot[ht++]=mt+xt*se,ot[ht++]=Pt,ot[ht++]=Tt,ot[ht++]=Tt,ot[ht++]=Pt,ot[ht++]=vt}return{vertices:at.buffer.slice(0),indices:ot.buffer.slice(0),uses32bitIndices:Ye}}const zn=new R.aJ({fill:new R.bi(128,2),line:new R.bi(512,0),tile:new R.bi(128,32),stencil:new R.bi(128,1),circle:3});class cl{constructor(){this._tileMeshCache={},this._errorCorrectionUsable=0,this._errorMeasurementLastValue=0,this._errorCorrectionPreviousValue=0,this._errorMeasurementLastChangeTime=-1e3}get name(){return"vertical-perspective"}get transitionState(){return 1}get useSubdivision(){return!0}get shaderVariantName(){return"globe"}get shaderDefine(){return"#define GLOBE"}get shaderPreludeCode(){return Nn.projectionGlobe}get vertexShaderPreludeCode(){return Nn.projectionMercator.vertexSource}get subdivisionGranularity(){return zn}get useGlobeControls(){return!0}get latitudeErrorCorrectionRadians(){return this._errorCorrectionUsable}destroy(){this._errorMeasurement&&this._errorMeasurement.destroy()}updateGPUdependent(t){this._errorMeasurement||(this._errorMeasurement=new Ma(t));const G=R.U(this._errorQueryLatitudeDegrees),J=2*Math.atan(Math.exp(Math.PI-G*Math.PI*2))-.5*Math.PI,te=this._errorMeasurement.updateErrorLoop(G,J),se=pe.now();te!==this._errorMeasurementLastValue&&(this._errorCorrectionPreviousValue=this._errorCorrectionUsable,this._errorMeasurementLastValue=te,this._errorMeasurementLastChangeTime=se);const de=Math.min(Math.max((se-this._errorMeasurementLastChangeTime)/1e3/.5,0),1);this._errorCorrectionUsable=R.bj(this._errorCorrectionPreviousValue,-this._errorMeasurementLastValue,R.bk(de))}_getMeshKey(t){return`${t.granularity.toString(36)}_${t.generateBorders?"b":""}${t.extendToNorthPole?"n":""}${t.extendToSouthPole?"s":""}`}getMeshFromTileID(t,G,J,te,se){const de=(se==="stencil"?zn.stencil:zn.tile).getGranularityForZoomLevel(G.z);return this._getMesh(t,{granularity:de,generateBorders:J,extendToNorthPole:G.y===0&&te,extendToSouthPole:G.y===(1<<G.z)-1&&te})}_getMesh(t,G){const J=this._getMeshKey(G);if(J in this._tileMeshCache)return this._tileMeshCache[J];const te=function(se,de){const _e=Xs(de,"16bit"),ge=R.aK.deserialize({arrayBuffer:_e.vertices,length:_e.vertices.byteLength/2/2}),xe=R.aM.deserialize({arrayBuffer:_e.indices,length:_e.indices.byteLength/2/3});return new Wn(se.createVertexBuffer(ge,Hn.members),se.createIndexBuffer(xe),R.aL.simpleSegment(0,0,ge.length,xe.length))}(t,G);return this._tileMeshCache[J]=te,te}recalculate(t){}hasTransition(){const t=pe.now();let G=!1;return G=G||(t-this._errorMeasurementLastChangeTime)/1e3<.7,G=G||this._errorMeasurement&&this._errorMeasurement.awaitingQuery,G}setErrorQueryLatitudeDegrees(t){this._errorQueryLatitudeDegrees=t}}const hl=new R.r({type:new R.D(R.v.projection.type)});class fo extends R.E{constructor(t){super(),this._transitionable=new R.t(hl),this.setProjection(t),this._transitioning=this._transitionable.untransitioned(),this.recalculate(new R.F(0)),this._mercatorProjection=new Ks,this._verticalPerspectiveProjection=new cl}get transitionState(){const t=this.properties.get("type");if(typeof t=="string"&&t==="mercator")return 0;if(typeof t=="string"&&t==="vertical-perspective")return 1;if(t instanceof R.bl){if(t.from==="vertical-perspective"&&t.to==="mercator")return 1-t.transition;if(t.from==="mercator"&&t.to==="vertical-perspective")return t.transition}return 1}get useGlobeRendering(){return this.transitionState>0}get latitudeErrorCorrectionRadians(){return this._verticalPerspectiveProjection.latitudeErrorCorrectionRadians}get currentProjection(){return this.useGlobeRendering?this._verticalPerspectiveProjection:this._mercatorProjection}get name(){return"globe"}get useSubdivision(){return this.currentProjection.useSubdivision}get shaderVariantName(){return this.currentProjection.shaderVariantName}get shaderDefine(){return this.currentProjection.shaderDefine}get shaderPreludeCode(){return this.currentProjection.shaderPreludeCode}get vertexShaderPreludeCode(){return this.currentProjection.vertexShaderPreludeCode}get subdivisionGranularity(){return this.currentProjection.subdivisionGranularity}get useGlobeControls(){return this.transitionState>0}destroy(){this._mercatorProjection.destroy(),this._verticalPerspectiveProjection.destroy()}updateGPUdependent(t){this._mercatorProjection.updateGPUdependent(t),this._verticalPerspectiveProjection.updateGPUdependent(t)}getMeshFromTileID(t,G,J,te,se){return this.currentProjection.getMeshFromTileID(t,G,J,te,se)}setProjection(t){this._transitionable.setValue("type",(t==null?void 0:t.type)||"mercator")}updateTransitions(t){this._transitioning=this._transitionable.transitioned(t,this._transitioning)}hasTransition(){return this._transitioning.hasTransition()||this.currentProjection.hasTransition()}recalculate(t){this.properties=this._transitioning.possiblyEvaluate(t)}setErrorQueryLatitudeDegrees(t){this._verticalPerspectiveProjection.setErrorQueryLatitudeDegrees(t),this._mercatorProjection.setErrorQueryLatitudeDegrees(t)}}function po(oe){const t=Da(oe.worldSize,oe.center.lat);return 2*Math.PI*t}function Cn(oe,t,G,J,te){const se=1/(1<<te),de=t/R.$*se+J*se,_e=R.bn((oe/R.$*se+G*se)*Math.PI*2+Math.PI,2*Math.PI),ge=2*Math.atan(Math.exp(Math.PI-de*Math.PI*2))-.5*Math.PI,xe=Math.cos(ge),Se=new Float64Array(3);return Se[0]=Math.sin(_e)*xe,Se[1]=Math.sin(ge),Se[2]=Math.cos(_e)*xe,Se}function Wi(oe){return function(t,G){const J=Math.cos(G),te=new Float64Array(3);return te[0]=Math.sin(t)*J,te[1]=Math.sin(G),te[2]=Math.cos(t)*J,te}(oe.lng*Math.PI/180,oe.lat*Math.PI/180)}function Da(oe,t){return oe/(2*Math.PI)/Math.cos(t*Math.PI/180)}function _o(oe){const t=Math.asin(oe[1])/Math.PI*180,G=Math.sqrt(oe[0]*oe[0]+oe[2]*oe[2]);if(G>1e-6){const J=oe[0]/G,te=Math.acos(oe[2]/G),se=(J>0?te:-te)/Math.PI*180;return new R.S(R.aN(se,-180,180),t)}return new R.S(0,t)}function Fa(oe){return Math.cos(oe*Math.PI/180)}function ji(oe,t){const G=Fa(oe),J=Fa(t);return R.aj(J/G)}function mo(oe,t){const G=oe.rotate(t.bearingInRadians),J=t.zoom+ji(t.center.lat,0),te=R.bj(1/Fa(t.center.lat),1/Fa(Math.min(Math.abs(t.center.lat),60)),R.bm(J,7,3,0,1)),se=360/po({worldSize:t.worldSize,center:{lat:t.center.lat}});return new R.S(t.center.lng-G.x*se*te,R.ag(t.center.lat+G.y*se,-R.ah,R.ah))}function ka(oe){const t=.5*oe,G=Math.sin(t),J=Math.cos(t);return Math.log(G+J)-Math.log(J-G)}function La(oe,t,G,J){const te=oe.lat+G*J;if(Math.abs(G)>1){const se=(Math.sign(oe.lat+G)!==Math.sign(oe.lat)?-Math.abs(oe.lat):Math.abs(oe.lat))*Math.PI/180,de=Math.abs(oe.lat+G)*Math.PI/180,_e=ka(se+J*(de-se)),ge=ka(se),xe=ka(de);return new R.S(oe.lng+t*((_e-ge)/(xe-ge)),te)}return new R.S(oe.lng+t*J,te)}class pc{constructor(t){this._cachePrevious=new Map,this._cache=new Map,this._hadAnyChanges=!1,this._boundingVolumeFactory=t}swapBuffers(){if(!this._hadAnyChanges)return;const t=this._cachePrevious;this._cachePrevious=this._cache,this._cache=t,this._cache.clear(),this._hadAnyChanges=!1}getTileBoundingVolume(t,G,J,te){const se=`${t.z}_${t.x}_${t.y}_${te!=null&&te.terrain?"t":""}`,de=this._cache.get(se);if(de)return de;const _e=this._cachePrevious.get(se);if(_e)return this._cache.set(se,_e),_e;const ge=this._boundingVolumeFactory(t,G,J,te);return this._cache.set(se,ge),this._hadAnyChanges=!0,ge}}class aa{constructor(t,G,J,te){this.min=J,this.max=te,this.points=t,this.planes=G}static fromAabb(t,G){const J=[];for(let te=0;te<8;te++)J.push([1&~te?t[0]:G[0],(te>>1&1)==1?G[1]:t[1],(te>>2&1)==1?G[2]:t[2]]);return new aa(J,[[-1,0,0,G[0]],[1,0,0,-t[0]],[0,-1,0,G[1]],[0,1,0,-t[1]],[0,0,-1,G[2]],[0,0,1,-t[2]]],t,G)}static fromCenterSizeAngles(t,G,J){const te=R.bq([],J[0],J[1],J[2]),se=R.br([],[G[0],0,0],te),de=R.br([],[0,G[1],0],te),_e=R.br([],[0,0,G[2]],te),ge=[...t],xe=[...t];for(let Oe=0;Oe<8;Oe++)for(let Ae=0;Ae<3;Ae++){const je=t[Ae]+se[Ae]*(1&~Oe?-1:1)+de[Ae]*((Oe>>1&1)==1?1:-1)+_e[Ae]*((Oe>>2&1)==1?1:-1);ge[Ae]=Math.min(ge[Ae],je),xe[Ae]=Math.max(xe[Ae],je)}const Se=[];for(let Oe=0;Oe<8;Oe++){const Ae=[...t];R.aR(Ae,Ae,R.aQ([],se,1&~Oe?-1:1)),R.aR(Ae,Ae,R.aQ([],de,(Oe>>1&1)==1?1:-1)),R.aR(Ae,Ae,R.aQ([],_e,(Oe>>2&1)==1?1:-1)),Se.push(Ae)}return new aa(Se,[[...se,-R.aW(se,Se[0])],[...de,-R.aW(de,Se[0])],[..._e,-R.aW(_e,Se[0])],[-se[0],-se[1],-se[2],-R.aW(se,Se[7])],[-de[0],-de[1],-de[2],-R.aW(de,Se[7])],[-_e[0],-_e[1],-_e[2],-R.aW(_e,Se[7])]],ge,xe)}intersectsFrustum(t){let G=!0;const J=this.points.length,te=this.planes.length,se=t.planes.length,de=t.points.length;for(let _e=0;_e<se;_e++){const ge=t.planes[_e];let xe=0;for(let Se=0;Se<J;Se++){const Oe=this.points[Se];ge[0]*Oe[0]+ge[1]*Oe[1]+ge[2]*Oe[2]+ge[3]>=0&&xe++}if(xe===0)return 0;xe<J&&(G=!1)}if(G)return 2;for(let _e=0;_e<te;_e++){const ge=this.planes[_e];let xe=0;for(let Se=0;Se<de;Se++){const Oe=t.points[Se];ge[0]*Oe[0]+ge[1]*Oe[1]+ge[2]*Oe[2]+ge[3]>=0&&xe++}if(xe===0)return 0}return 1}intersectsPlane(t){const G=this.points.length;let J=0;for(let te=0;te<G;te++){const se=this.points[te];t[0]*se[0]+t[1]*se[1]+t[2]*se[2]+t[3]>=0&&J++}return J===G?2:J===0?0:1}}function yo(oe,t,G){const J=oe-t;return J<0?-J:Math.max(0,J-G)}function Js(oe,t,G,J,te){const se=oe-G;let de;return de=se<0?Math.min(-se,1+se-te):se>1?Math.min(Math.max(se-te,0),1-se):0,Math.max(de,yo(t,J,te))}class _c{constructor(){this._boundingVolumeCache=new pc(this._computeTileBoundingVolume)}prepareNextFrame(){this._boundingVolumeCache.swapBuffers()}distanceToTile2d(t,G,J,te){const se=1<<J.z,de=1/se,_e=J.x/se,ge=J.y/se;let xe=2;return xe=Math.min(xe,Js(t,G,_e,ge,de)),xe=Math.min(xe,Js(t,G,_e+.5,-ge-de,de)),xe=Math.min(xe,Js(t,G,_e+.5,2-ge-de,de)),xe}getWrap(t,G,J){const te=1<<G.z,se=1/te,de=G.x/te,_e=yo(t.x,de,se),ge=yo(t.x,de-1,se),xe=yo(t.x,de+1,se),Se=Math.min(_e,ge,xe);return Se===xe?1:Se===ge?-1:0}allowVariableZoom(t,G){return bt(t,G)>4}allowWorldCopies(){return!1}getTileBoundingVolume(t,G,J,te){return this._boundingVolumeCache.getTileBoundingVolume(t,G,J,te)}_computeTileBoundingVolume(t,G,J,te){var se,de;let _e=J,ge=J;if(te!=null&&te.terrain){const xe=new R.Z(t.z,G,t.z,t.x,t.y),Se=te.terrain.getMinMaxElevation(xe);_e=(se=Se.minElevation)!==null&&se!==void 0?se:J,ge=(de=Se.maxElevation)!==null&&de!==void 0?de:J}if(_e/=R.bt,ge/=R.bt,_e+=1,ge+=1,t.z<=0)return aa.fromAabb([-ge,-ge,-ge],[ge,ge,ge]);if(t.z===1)return aa.fromAabb([t.x===0?-ge:0,t.y===0?0:-ge,-ge],[t.x===0?0:ge,t.y===0?ge:0,ge]);{const xe=[Cn(0,0,t.x,t.y,t.z),Cn(R.$,0,t.x,t.y,t.z),Cn(R.$,R.$,t.x,t.y,t.z),Cn(0,R.$,t.x,t.y,t.z)],Se=[];for(const zt of xe)Se.push(R.aQ([],zt,ge));if(ge!==_e)for(const zt of xe)Se.push(R.aQ([],zt,_e));t.y===0&&Se.push([0,1,0]),t.y===(1<<t.z)-1&&Se.push([0,-1,0]);const Oe=[1,1,1],Ae=[-1,-1,-1];for(const zt of Se)for(let $t=0;$t<3;$t++)Oe[$t]=Math.min(Oe[$t],zt[$t]),Ae[$t]=Math.max(Ae[$t],zt[$t]);const je=Cn(R.$/2,R.$/2,t.x,t.y,t.z),Ye=R.aV([],[0,1,0],je);R.aU(Ye,Ye);const at=R.aV([],je,Ye);R.aU(at,at);const nt=R.aV([],xe[2],xe[1]);R.aU(nt,nt);const ot=R.aV([],xe[0],xe[3]);R.aU(ot,ot),Se.push(R.aQ([],je,ge)),t.y>=(1<<t.z)/2&&Se.push(R.aQ([],Cn(R.$/2,0,t.x,t.y,t.z),ge)),t.y<(1<<t.z)/2&&Se.push(R.aQ([],Cn(R.$/2,R.$,t.x,t.y,t.z),ge));const ht=dn(je,Se),xt=dn(at,Se),mt=[-je[0],-je[1],-je[2],ht.max],Tt=[je[0],je[1],je[2],-ht.min],Pt=[-at[0],-at[1],-at[2],xt.max],vt=[at[0],at[1],at[2],-xt.min],kt=[...nt,0],Vt=[...ot,0],jt=[];return t.y===0?jt.push(R.bs(Vt,kt,mt),R.bs(Vt,kt,Tt)):jt.push(R.bs(Pt,kt,mt),R.bs(Pt,kt,Tt),R.bs(Pt,Vt,mt),R.bs(Pt,Vt,Tt)),t.y===(1<<t.z)-1?jt.push(R.bs(Vt,kt,mt),R.bs(Vt,kt,Tt)):jt.push(R.bs(vt,kt,mt),R.bs(vt,kt,Tt),R.bs(vt,Vt,mt),R.bs(vt,Vt,Tt)),new aa(jt,[mt,Tt,Pt,vt,kt,Vt],Oe,Ae)}}}function dn(oe,t){let G=1/0,J=-1/0;for(const te of t){const se=R.aW(oe,te);G=Math.min(G,se),J=Math.max(J,se)}return{min:G,max:J}}class Ba{get pixelsToClipSpaceMatrix(){return this._helper.pixelsToClipSpaceMatrix}get clipSpaceToPixelsMatrix(){return this._helper.clipSpaceToPixelsMatrix}get pixelsToGLUnits(){return this._helper.pixelsToGLUnits}get centerOffset(){return this._helper.centerOffset}get size(){return this._helper.size}get rotationMatrix(){return this._helper.rotationMatrix}get centerPoint(){return this._helper.centerPoint}get pixelsPerMeter(){return this._helper.pixelsPerMeter}setMinZoom(t){this._helper.setMinZoom(t)}setMaxZoom(t){this._helper.setMaxZoom(t)}setMinPitch(t){this._helper.setMinPitch(t)}setMaxPitch(t){this._helper.setMaxPitch(t)}setRenderWorldCopies(t){this._helper.setRenderWorldCopies(t)}setBearing(t){this._helper.setBearing(t)}setPitch(t){this._helper.setPitch(t)}setRoll(t){this._helper.setRoll(t)}setFov(t){this._helper.setFov(t)}setZoom(t){this._helper.setZoom(t)}setCenter(t){this._helper.setCenter(t)}setElevation(t){this._helper.setElevation(t)}setMinElevationForCurrentTile(t){this._helper.setMinElevationForCurrentTile(t)}setPadding(t){this._helper.setPadding(t)}interpolatePadding(t,G,J){return this._helper.interpolatePadding(t,G,J)}isPaddingEqual(t){return this._helper.isPaddingEqual(t)}resize(t,G){this._helper.resize(t,G)}getMaxBounds(){return this._helper.getMaxBounds()}setMaxBounds(t){this._helper.setMaxBounds(t)}overrideNearFarZ(t,G){this._helper.overrideNearFarZ(t,G)}clearNearFarZOverride(){this._helper.clearNearFarZOverride()}getCameraQueryGeometry(t){return this._helper.getCameraQueryGeometry(this.getCameraPoint(),t)}get tileSize(){return this._helper.tileSize}get tileZoom(){return this._helper.tileZoom}get scale(){return this._helper.scale}get worldSize(){return this._helper.worldSize}get width(){return this._helper.width}get height(){return this._helper.height}get lngRange(){return this._helper.lngRange}get latRange(){return this._helper.latRange}get minZoom(){return this._helper.minZoom}get maxZoom(){return this._helper.maxZoom}get zoom(){return this._helper.zoom}get center(){return this._helper.center}get minPitch(){return this._helper.minPitch}get maxPitch(){return this._helper.maxPitch}get pitch(){return this._helper.pitch}get pitchInRadians(){return this._helper.pitchInRadians}get roll(){return this._helper.roll}get rollInRadians(){return this._helper.rollInRadians}get bearing(){return this._helper.bearing}get bearingInRadians(){return this._helper.bearingInRadians}get fov(){return this._helper.fov}get fovInRadians(){return this._helper.fovInRadians}get elevation(){return this._helper.elevation}get minElevationForCurrentTile(){return this._helper.minElevationForCurrentTile}get padding(){return this._helper.padding}get unmodified(){return this._helper.unmodified}get renderWorldCopies(){return this._helper.renderWorldCopies}get nearZ(){return this._helper.nearZ}get farZ(){return this._helper.farZ}get autoCalculateNearFarZ(){return this._helper.autoCalculateNearFarZ}setTransitionState(t){}constructor(){this._cachedClippingPlane=R.bu(),this._projectionMatrix=R.b8(),this._globeViewProjMatrix32f=R.b7(),this._globeViewProjMatrixNoCorrection=R.b8(),this._globeViewProjMatrixNoCorrectionInverted=R.b8(),this._globeProjMatrixInverted=R.b8(),this._cameraPosition=R.bo(),this._globeLatitudeErrorCorrectionRadians=0,this._helper=new ho({calcMatrices:()=>{this._calcMatrices()},getConstrained:(t,G)=>this.getConstrained(t,G)}),this._coveringTilesDetailsProvider=new _c}clone(){const t=new Ba;return t.apply(this),t}apply(t,G){this._globeLatitudeErrorCorrectionRadians=G||0,this._helper.apply(t)}get projectionMatrix(){return this._projectionMatrix}get modelViewProjectionMatrix(){return this._globeViewProjMatrixNoCorrection}get inverseProjectionMatrix(){return this._globeProjMatrixInverted}get cameraPosition(){const t=R.bo();return t[0]=this._cameraPosition[0],t[1]=this._cameraPosition[1],t[2]=this._cameraPosition[2],t}get cameraToCenterDistance(){return this._helper.cameraToCenterDistance}getProjectionData(t){const{overscaledTileID:G,applyGlobeMatrix:J}=t,te=this._helper.getMercatorTileCoordinates(G);return{mainMatrix:this._globeViewProjMatrix32f,tileMercatorCoords:te,clippingPlane:this._cachedClippingPlane,projectionTransition:J?1:0,fallbackMatrix:this._globeViewProjMatrix32f}}_computeClippingPlane(t){const G=this.pitchInRadians,J=this.cameraToCenterDistance/t,te=Math.sin(G)*J,se=Math.cos(G)*J+1,de=1/Math.sqrt(te*te+se*se)*1;let _e=-te,ge=se;const xe=Math.sqrt(_e*_e+ge*ge);_e/=xe,ge/=xe;const Se=[0,_e,ge];R.bv(Se,Se,[0,0,0],-this.bearingInRadians),R.bw(Se,Se,[0,0,0],-1*this.center.lat*Math.PI/180),R.bx(Se,Se,[0,0,0],this.center.lng*Math.PI/180);const Oe=1/R.aY(Se);return R.aQ(Se,Se,Oe),[...Se,-de*Oe]}isLocationOccluded(t){return!this.isSurfacePointVisible(Wi(t))}transformLightDirection(t){const G=this._helper._center.lng*Math.PI/180,J=this._helper._center.lat*Math.PI/180,te=Math.cos(J),se=[Math.sin(G)*te,Math.sin(J),Math.cos(G)*te],de=[se[2],0,-se[0]],_e=[0,0,0];R.aV(_e,de,se),R.aU(de,de),R.aU(_e,_e);const ge=[0,0,0];return R.aU(ge,[de[0]*t[0]+_e[0]*t[1]+se[0]*t[2],de[1]*t[0]+_e[1]*t[1]+se[1]*t[2],de[2]*t[0]+_e[2]*t[1]+se[2]*t[2]]),ge}getPixelScale(){return 1/Math.cos(this._helper._center.lat*Math.PI/180)}getCircleRadiusCorrection(){return Math.cos(this._helper._center.lat*Math.PI/180)}getPitchedTextCorrection(t,G,J){const te=function(_e,ge,xe){const Se=1/(1<<xe.z);return new R.a0(_e/R.$*Se+xe.x*Se,ge/R.$*Se+xe.y*Se)}(t,G,J.canonical),se=(de=te.y,[R.bn(te.x*Math.PI*2+Math.PI,2*Math.PI),2*Math.atan(Math.exp(Math.PI-de*Math.PI*2))-.5*Math.PI]);var de;return this.getCircleRadiusCorrection()/Math.cos(se[1])}projectTileCoordinates(t,G,J,te){const se=J.canonical,de=Cn(t,G,se.x,se.y,se.z),_e=1+(te?te(t,G):0)/R.bt,ge=[de[0]*_e,de[1]*_e,de[2]*_e,1];R.av(ge,ge,this._globeViewProjMatrixNoCorrection);const xe=this._cachedClippingPlane,Se=xe[0]*de[0]+xe[1]*de[1]+xe[2]*de[2]+xe[3]<0;return{point:new R.P(ge[0]/ge[3],ge[1]/ge[3]),signedDistanceFromCamera:ge[3],isOccluded:Se}}_calcMatrices(){if(!this._helper._width||!this._helper._height)return;const t=Da(this.worldSize,this.center.lat),G=R.b9(),J=R.b9();this._helper.autoCalculateNearFarZ&&(this._helper._nearZ=.5,this._helper._farZ=this.cameraToCenterDistance+2*t),R.b3(G,this.fovInRadians,this.width/this.height,this._helper._nearZ,this._helper._farZ);const te=this.centerOffset;G[8]=2*-te.x/this._helper._width,G[9]=2*te.y/this._helper._height,this._projectionMatrix=R.b4(G),this._globeProjMatrixInverted=R.b9(),R.ap(this._globeProjMatrixInverted,G),R.M(G,G,[0,0,-this.cameraToCenterDistance]),R.b5(G,G,this.rollInRadians),R.b6(G,G,-this.pitchInRadians),R.b5(G,G,this.bearingInRadians),R.M(G,G,[0,0,-t]);const se=R.bo();se[0]=t,se[1]=t,se[2]=t,R.b6(J,G,this.center.lat*Math.PI/180),R.by(J,J,-this.center.lng*Math.PI/180),R.N(J,J,se),this._globeViewProjMatrixNoCorrection=J,R.b6(G,G,this.center.lat*Math.PI/180-this._globeLatitudeErrorCorrectionRadians),R.by(G,G,-this.center.lng*Math.PI/180),R.N(G,G,se),this._globeViewProjMatrix32f=new Float32Array(G),this._globeViewProjMatrixNoCorrectionInverted=R.b9(),R.ap(this._globeViewProjMatrixNoCorrectionInverted,J);const de=R.bo();this._cameraPosition=R.bo(),this._cameraPosition[2]=this.cameraToCenterDistance/t,R.bv(this._cameraPosition,this._cameraPosition,de,-this.rollInRadians),R.bw(this._cameraPosition,this._cameraPosition,de,this.pitchInRadians),R.bv(this._cameraPosition,this._cameraPosition,de,-this.bearingInRadians),R.aR(this._cameraPosition,this._cameraPosition,[0,0,1]),R.bw(this._cameraPosition,this._cameraPosition,de,-this.center.lat*Math.PI/180),R.bx(this._cameraPosition,this._cameraPosition,de,this.center.lng*Math.PI/180),this._cachedClippingPlane=this._computeClippingPlane(t);const _e=R.b4(this._globeViewProjMatrixNoCorrectionInverted);R.N(_e,_e,[1,1,-1]),this._cachedFrustum=sn.fromInvProjectionMatrix(_e,1,0,this._cachedClippingPlane,!0)}calculateFogMatrix(t){R.w("calculateFogMatrix is not supported on globe projection.");const G=R.b9();return R.af(G),G}getVisibleUnwrappedCoordinates(t){return[new R.b1(0,t)]}getCameraFrustum(){return this._cachedFrustum}getClippingPlane(){return this._cachedClippingPlane}getCoveringTilesDetailsProvider(){return this._coveringTilesDetailsProvider}recalculateZoomAndCenter(t){t&&R.w("terrain is not fully supported on vertical perspective projection."),this._helper.recalculateZoomAndCenter(0)}maxPitchScaleFactor(){return 1}getCameraPoint(){return this._helper.getCameraPoint()}getCameraAltitude(){return this._helper.getCameraAltitude()}getCameraLngLat(){return this._helper.getCameraLngLat()}lngLatToCameraDepth(t,G){if(!this._globeViewProjMatrixNoCorrection)return 1;const J=Wi(t);R.aQ(J,J,1+G/R.bt);const te=R.bu();return R.av(te,[J[0],J[1],J[2],1],this._globeViewProjMatrixNoCorrection),te[2]/te[3]}populateCache(t){}getBounds(){const t=.5*this.width,G=.5*this.height,J=[new R.P(0,0),new R.P(t,0),new R.P(this.width,0),new R.P(this.width,G),new R.P(this.width,this.height),new R.P(t,this.height),new R.P(0,this.height),new R.P(0,G)],te=[];for(const Oe of J)te.push(this.unprojectScreenPoint(Oe));let se=0,de=0,_e=0,ge=0;const xe=this.center;for(const Oe of te){const Ae=R.bz(xe.lng,Oe.lng),je=R.bz(xe.lat,Oe.lat);Ae<de&&(de=Ae),Ae>se&&(se=Ae),je<ge&&(ge=je),je>_e&&(_e=je)}const Se=[xe.lng+de,xe.lat+ge,xe.lng+se,xe.lat+_e];return this.isSurfacePointOnScreen([0,1,0])&&(Se[3]=90,Se[0]=-180,Se[2]=180),this.isSurfacePointOnScreen([0,-1,0])&&(Se[1]=-90,Se[0]=-180,Se[2]=180),new wr(Se)}getConstrained(t,G){const J=R.ag(t.lat,-R.ah,R.ah),te=R.ag(+G,this.minZoom+ji(0,J),this.maxZoom);return{center:new R.S(t.lng,J),zoom:te}}calculateCenterFromCameraLngLatAlt(t,G,J,te){return this._helper.calculateCenterFromCameraLngLatAlt(t,G,J,te)}setLocationAtPoint(t,G){const J=Wi(this.unprojectScreenPoint(G)),te=Wi(t),se=R.bo();R.bA(se);const de=R.bo();R.bx(de,J,se,-this.center.lng*Math.PI/180),R.bw(de,de,se,this.center.lat*Math.PI/180);const _e=te[0]*te[0]+te[2]*te[2],ge=de[0]*de[0];if(_e<ge)return;const xe=Math.sqrt(_e-ge),Se=-xe,Oe=R.bB(te[0],te[2],de[0],xe),Ae=R.bB(te[0],te[2],de[0],Se),je=R.bo();R.bx(je,te,se,-Oe);const Ye=R.bB(je[1],je[2],de[1],de[2]),at=R.bo();R.bx(at,te,se,-Ae);const nt=R.bB(at[1],at[2],de[1],de[2]),ot=.5*Math.PI,ht=Ye>=-ot&&Ye<=ot,xt=nt>=-ot&&nt<=ot;let mt,Tt;if(ht&&xt){const Vt=this.center.lng*Math.PI/180,jt=this.center.lat*Math.PI/180;R.bC(Oe,Vt)+R.bC(Ye,jt)<R.bC(Ae,Vt)+R.bC(nt,jt)?(mt=Oe,Tt=Ye):(mt=Ae,Tt=nt)}else if(ht)mt=Oe,Tt=Ye;else{if(!xt)return;mt=Ae,Tt=nt}const Pt=mt/Math.PI*180,vt=Tt/Math.PI*180,kt=this.center.lat;this.setCenter(new R.S(Pt,R.ag(vt,-90,90))),this.setZoom(this.zoom+ji(kt,this.center.lat))}locationToScreenPoint(t,G){const J=Wi(t);if(G){const te=G.getElevationForLngLatZoom(t,this._helper._tileZoom);R.aQ(J,J,1+te/R.bt)}return this._projectSurfacePointToScreen(J)}_projectSurfacePointToScreen(t){const G=R.bu();return R.av(G,[...t,1],this._globeViewProjMatrixNoCorrection),G[0]/=G[3],G[1]/=G[3],new R.P((.5*G[0]+.5)*this.width,(.5*-G[1]+.5)*this.height)}screenPointToMercatorCoordinate(t,G){if(G){const J=G.pointCoordinate(t);if(J)return J}return R.a0.fromLngLat(this.unprojectScreenPoint(t))}screenPointToLocation(t,G){var J;return(J=this.screenPointToMercatorCoordinate(t,G))===null||J===void 0?void 0:J.toLngLat()}isPointOnMapSurface(t,G){const J=this._cameraPosition,te=this.getRayDirectionFromPixel(t);return!!this.rayPlanetIntersection(J,te)}getRayDirectionFromPixel(t){const G=R.bu();G[0]=t.x/this.width*2-1,G[1]=-1*(t.y/this.height*2-1),G[2]=1,G[3]=1,R.av(G,G,this._globeViewProjMatrixNoCorrectionInverted),G[0]/=G[3],G[1]/=G[3],G[2]/=G[3];const J=R.bo();J[0]=G[0]-this._cameraPosition[0],J[1]=G[1]-this._cameraPosition[1],J[2]=G[2]-this._cameraPosition[2];const te=R.bo();return R.aU(te,J),te}isSurfacePointVisible(t){const G=this._cachedClippingPlane;return G[0]*t[0]+G[1]*t[1]+G[2]*t[2]+G[3]>=0}isSurfacePointOnScreen(t){if(!this.isSurfacePointVisible(t))return!1;const G=R.bu();return R.av(G,[...t,1],this._globeViewProjMatrixNoCorrection),G[0]/=G[3],G[1]/=G[3],G[2]/=G[3],G[0]>-1&&G[0]<1&&G[1]>-1&&G[1]<1&&G[2]>-1&&G[2]<1}rayPlanetIntersection(t,G){const J=R.aW(t,G),te=R.bo(),se=R.bo();R.aQ(se,G,J),R.aT(te,t,se);const de=1-R.aW(te,te);if(de<0)return null;const _e=R.aW(t,t)-1,ge=-J+(J<0?1:-1)*Math.sqrt(de),xe=_e/ge,Se=ge;return{tMin:Math.min(xe,Se),tMax:Math.max(xe,Se)}}unprojectScreenPoint(t){const G=this._cameraPosition,J=this.getRayDirectionFromPixel(t),te=this.rayPlanetIntersection(G,J);if(te){const Se=R.bo();R.aR(Se,G,[J[0]*te.tMin,J[1]*te.tMin,J[2]*te.tMin]);const Oe=R.bo();return R.aU(Oe,Se),_o(Oe)}const se=this._cachedClippingPlane,de=se[0]*J[0]+se[1]*J[1]+se[2]*J[2],_e=-R.b0(se,G)/de,ge=R.bo();if(_e>0)R.aR(ge,G,[J[0]*_e,J[1]*_e,J[2]*_e]);else{const Se=R.bo();R.aR(Se,G,[2*J[0],2*J[1],2*J[2]]);const Oe=R.b0(this._cachedClippingPlane,Se);R.aT(ge,Se,[this._cachedClippingPlane[0]*Oe,this._cachedClippingPlane[1]*Oe,this._cachedClippingPlane[2]*Oe])}const xe=function(Se){const Oe=R.bo();return Oe[0]=Se[0]*-Se[3],Oe[1]=Se[1]*-Se[3],Oe[2]=Se[2]*-Se[3],{center:Oe,radius:Math.sqrt(1-Se[3]*Se[3])}}(se);return _o(function(Se,Oe,Ae){const je=R.bo();R.aT(je,Ae,Se);const Ye=R.bo();return R.bp(Ye,Se,je,Oe/R.a_(je)),Ye}(xe.center,xe.radius,ge))}getMatrixForModel(t,G){const J=R.S.convert(t),te=1/R.bt,se=R.b8();return R.by(se,se,J.lng/180*Math.PI),R.b6(se,se,-J.lat/180*Math.PI),R.M(se,se,[0,0,1+G/R.bt]),R.b6(se,se,.5*Math.PI),R.N(se,se,[te,te,te]),se}getProjectionDataForCustomLayer(t=!0){const G=this.getProjectionData({overscaledTileID:new R.Z(0,0,0,0,0),applyGlobeMatrix:t});return G.tileMercatorCoords=[0,0,1,1],G}getFastPathSimpleProjectionMatrix(t){}}class En{get pixelsToClipSpaceMatrix(){return this._helper.pixelsToClipSpaceMatrix}get clipSpaceToPixelsMatrix(){return this._helper.clipSpaceToPixelsMatrix}get pixelsToGLUnits(){return this._helper.pixelsToGLUnits}get centerOffset(){return this._helper.centerOffset}get size(){return this._helper.size}get rotationMatrix(){return this._helper.rotationMatrix}get centerPoint(){return this._helper.centerPoint}get pixelsPerMeter(){return this._helper.pixelsPerMeter}setMinZoom(t){this._helper.setMinZoom(t)}setMaxZoom(t){this._helper.setMaxZoom(t)}setMinPitch(t){this._helper.setMinPitch(t)}setMaxPitch(t){this._helper.setMaxPitch(t)}setRenderWorldCopies(t){this._helper.setRenderWorldCopies(t)}setBearing(t){this._helper.setBearing(t)}setPitch(t){this._helper.setPitch(t)}setRoll(t){this._helper.setRoll(t)}setFov(t){this._helper.setFov(t)}setZoom(t){this._helper.setZoom(t)}setCenter(t){this._helper.setCenter(t)}setElevation(t){this._helper.setElevation(t)}setMinElevationForCurrentTile(t){this._helper.setMinElevationForCurrentTile(t)}setPadding(t){this._helper.setPadding(t)}interpolatePadding(t,G,J){return this._helper.interpolatePadding(t,G,J)}isPaddingEqual(t){return this._helper.isPaddingEqual(t)}resize(t,G,J=!0){this._helper.resize(t,G,J)}getMaxBounds(){return this._helper.getMaxBounds()}setMaxBounds(t){this._helper.setMaxBounds(t)}overrideNearFarZ(t,G){this._helper.overrideNearFarZ(t,G)}clearNearFarZOverride(){this._helper.clearNearFarZOverride()}getCameraQueryGeometry(t){return this._helper.getCameraQueryGeometry(this.getCameraPoint(),t)}get tileSize(){return this._helper.tileSize}get tileZoom(){return this._helper.tileZoom}get scale(){return this._helper.scale}get worldSize(){return this._helper.worldSize}get width(){return this._helper.width}get height(){return this._helper.height}get lngRange(){return this._helper.lngRange}get latRange(){return this._helper.latRange}get minZoom(){return this._helper.minZoom}get maxZoom(){return this._helper.maxZoom}get zoom(){return this._helper.zoom}get center(){return this._helper.center}get minPitch(){return this._helper.minPitch}get maxPitch(){return this._helper.maxPitch}get pitch(){return this._helper.pitch}get pitchInRadians(){return this._helper.pitchInRadians}get roll(){return this._helper.roll}get rollInRadians(){return this._helper.rollInRadians}get bearing(){return this._helper.bearing}get bearingInRadians(){return this._helper.bearingInRadians}get fov(){return this._helper.fov}get fovInRadians(){return this._helper.fovInRadians}get elevation(){return this._helper.elevation}get minElevationForCurrentTile(){return this._helper.minElevationForCurrentTile}get padding(){return this._helper.padding}get unmodified(){return this._helper.unmodified}get renderWorldCopies(){return this._helper.renderWorldCopies}get cameraToCenterDistance(){return this._helper.cameraToCenterDistance}get nearZ(){return this._helper.nearZ}get farZ(){return this._helper.farZ}get autoCalculateNearFarZ(){return this._helper.autoCalculateNearFarZ}get isGlobeRendering(){return this._globeness>0}setTransitionState(t,G){this._globeness=t,this._globeLatitudeErrorCorrectionRadians=G,this._calcMatrices(),this._verticalPerspectiveTransform.getCoveringTilesDetailsProvider().prepareNextFrame(),this._mercatorTransform.getCoveringTilesDetailsProvider().prepareNextFrame()}get currentTransform(){return this.isGlobeRendering?this._verticalPerspectiveTransform:this._mercatorTransform}constructor(){this._globeLatitudeErrorCorrectionRadians=0,this._globeness=1,this._helper=new ho({calcMatrices:()=>{this._calcMatrices()},getConstrained:(t,G)=>this.getConstrained(t,G)}),this._globeness=1,this._mercatorTransform=new Bi,this._verticalPerspectiveTransform=new Ba}clone(){const t=new En;return t._globeness=this._globeness,t._globeLatitudeErrorCorrectionRadians=this._globeLatitudeErrorCorrectionRadians,t.apply(this),t}apply(t){this._helper.apply(t),this._mercatorTransform.apply(this),this._verticalPerspectiveTransform.apply(this,this._globeLatitudeErrorCorrectionRadians)}get projectionMatrix(){return this.currentTransform.projectionMatrix}get modelViewProjectionMatrix(){return this.currentTransform.modelViewProjectionMatrix}get inverseProjectionMatrix(){return this.currentTransform.inverseProjectionMatrix}get cameraPosition(){return this.currentTransform.cameraPosition}getProjectionData(t){const G=this._mercatorTransform.getProjectionData(t),J=this._verticalPerspectiveTransform.getProjectionData(t);return{mainMatrix:this.isGlobeRendering?J.mainMatrix:G.mainMatrix,clippingPlane:J.clippingPlane,tileMercatorCoords:J.tileMercatorCoords,projectionTransition:t.applyGlobeMatrix?this._globeness:0,fallbackMatrix:G.fallbackMatrix}}isLocationOccluded(t){return this.currentTransform.isLocationOccluded(t)}transformLightDirection(t){return this.currentTransform.transformLightDirection(t)}getPixelScale(){return R.bj(this._mercatorTransform.getPixelScale(),this._verticalPerspectiveTransform.getPixelScale(),this._globeness)}getCircleRadiusCorrection(){return R.bj(this._mercatorTransform.getCircleRadiusCorrection(),this._verticalPerspectiveTransform.getCircleRadiusCorrection(),this._globeness)}getPitchedTextCorrection(t,G,J){const te=this._mercatorTransform.getPitchedTextCorrection(t,G,J),se=this._verticalPerspectiveTransform.getPitchedTextCorrection(t,G,J);return R.bj(te,se,this._globeness)}projectTileCoordinates(t,G,J,te){return this.currentTransform.projectTileCoordinates(t,G,J,te)}_calcMatrices(){this._helper._width&&this._helper._height&&(this._verticalPerspectiveTransform.apply(this,this._globeLatitudeErrorCorrectionRadians),this._helper._nearZ=this._verticalPerspectiveTransform.nearZ,this._helper._farZ=this._verticalPerspectiveTransform.farZ,this._mercatorTransform.apply(this,!0,this.isGlobeRendering),this._helper._nearZ=this._mercatorTransform.nearZ,this._helper._farZ=this._mercatorTransform.farZ)}calculateFogMatrix(t){return this.currentTransform.calculateFogMatrix(t)}getVisibleUnwrappedCoordinates(t){return this.currentTransform.getVisibleUnwrappedCoordinates(t)}getCameraFrustum(){return this.currentTransform.getCameraFrustum()}getClippingPlane(){return this.currentTransform.getClippingPlane()}getCoveringTilesDetailsProvider(){return this.currentTransform.getCoveringTilesDetailsProvider()}recalculateZoomAndCenter(t){this._mercatorTransform.recalculateZoomAndCenter(t),this._verticalPerspectiveTransform.recalculateZoomAndCenter(t)}maxPitchScaleFactor(){return this._mercatorTransform.maxPitchScaleFactor()}getCameraPoint(){return this._helper.getCameraPoint()}getCameraAltitude(){return this._helper.getCameraAltitude()}getCameraLngLat(){return this._helper.getCameraLngLat()}lngLatToCameraDepth(t,G){return this.currentTransform.lngLatToCameraDepth(t,G)}populateCache(t){this._mercatorTransform.populateCache(t),this._verticalPerspectiveTransform.populateCache(t)}getBounds(){return this.currentTransform.getBounds()}getConstrained(t,G){return this.currentTransform.getConstrained(t,G)}calculateCenterFromCameraLngLatAlt(t,G,J,te){return this._helper.calculateCenterFromCameraLngLatAlt(t,G,J,te)}setLocationAtPoint(t,G){if(!this.isGlobeRendering)return this._mercatorTransform.setLocationAtPoint(t,G),void this.apply(this._mercatorTransform);this._verticalPerspectiveTransform.setLocationAtPoint(t,G),this.apply(this._verticalPerspectiveTransform)}locationToScreenPoint(t,G){return this.currentTransform.locationToScreenPoint(t,G)}screenPointToMercatorCoordinate(t,G){return this.currentTransform.screenPointToMercatorCoordinate(t,G)}screenPointToLocation(t,G){return this.currentTransform.screenPointToLocation(t,G)}isPointOnMapSurface(t,G){return this.currentTransform.isPointOnMapSurface(t,G)}getRayDirectionFromPixel(t){return this._verticalPerspectiveTransform.getRayDirectionFromPixel(t)}getMatrixForModel(t,G){return this.currentTransform.getMatrixForModel(t,G)}getProjectionDataForCustomLayer(t=!0){const G=this._mercatorTransform.getProjectionDataForCustomLayer(t);if(!this.isGlobeRendering)return G;const J=this._verticalPerspectiveTransform.getProjectionDataForCustomLayer(t);return J.fallbackMatrix=G.mainMatrix,J}getFastPathSimpleProjectionMatrix(t){return this.currentTransform.getFastPathSimpleProjectionMatrix(t)}}class bn{get useGlobeControls(){return!0}handlePanInertia(t,G){const J=mo(t,G);return Math.abs(J.lng-G.center.lng)>180&&(J.lng=G.center.lng+179.5*Math.sign(J.lng-G.center.lng)),{easingCenter:J,easingOffset:new R.P(0,0)}}handleMapControlsRollPitchBearingZoom(t,G){const J=t.around,te=G.screenPointToLocation(J);t.bearingDelta&&G.setBearing(G.bearing+t.bearingDelta),t.pitchDelta&&G.setPitch(G.pitch+t.pitchDelta),t.rollDelta&&G.setRoll(G.roll+t.rollDelta);const se=G.zoom;t.zoomDelta&&G.setZoom(G.zoom+t.zoomDelta);const de=G.zoom-se;if(de===0)return;const _e=R.bz(G.center.lng,te.lng),ge=_e/(Math.abs(_e/180)+1),xe=R.bz(G.center.lat,te.lat),Se=G.getRayDirectionFromPixel(J),Oe=G.cameraPosition,Ae=-1*R.aW(Oe,Se),je=R.bo();R.aR(je,Oe,[Se[0]*Ae,Se[1]*Ae,Se[2]*Ae]);const Ye=R.aY(je)-1,at=Math.exp(.5*-Math.max(Ye-.3,0)),nt=Da(G.worldSize,G.center.lat)/Math.min(G.width,G.height),ot=R.bm(nt,.9,.5,1,.25),ht=(1-R.ae(-de))*Math.min(at,ot),xt=G.center.lat,mt=G.zoom,Tt=new R.S(G.center.lng+ge*ht,R.ag(G.center.lat+xe*ht,-R.ah,R.ah));G.setLocationAtPoint(te,J);const Pt=G.center,vt=R.bm(Math.abs(_e),45,85,0,1),kt=R.bm(nt,.75,.35,0,1),Vt=Math.pow(Math.max(vt,kt),.25),jt=R.bz(Pt.lng,Tt.lng),zt=R.bz(Pt.lat,Tt.lat);G.setCenter(new R.S(Pt.lng+jt*Vt,Pt.lat+zt*Vt).wrap()),G.setZoom(mt+ji(xt,G.center.lat))}handleMapControlsPan(t,G,J){if(!t.panDelta)return;const te=G.center.lat,se=G.zoom;G.setCenter(mo(t.panDelta,G).wrap()),G.setZoom(se+ji(te,G.center.lat))}cameraForBoxAndBearing(t,G,J,te,se){const de=Ti(t,G,J,te,se),_e=G.left/se.width*2-1,ge=(se.width-G.right)/se.width*2-1,xe=G.top/se.height*-2+1,Se=(se.height-G.bottom)/se.height*-2+1,Oe=R.bz(J.getWest(),J.getEast())<0,Ae=Oe?J.getEast():J.getWest(),je=Oe?J.getWest():J.getEast(),Ye=Math.max(J.getNorth(),J.getSouth()),at=Math.min(J.getNorth(),J.getSouth()),nt=Ae+.5*R.bz(Ae,je),ot=Ye+.5*R.bz(Ye,at),ht=se.clone();ht.setCenter(de.center),ht.setBearing(de.bearing),ht.setPitch(0),ht.setRoll(0),ht.setZoom(de.zoom);const xt=ht.modelViewProjectionMatrix,mt=[Wi(J.getNorthWest()),Wi(J.getNorthEast()),Wi(J.getSouthWest()),Wi(J.getSouthEast()),Wi(new R.S(je,ot)),Wi(new R.S(Ae,ot)),Wi(new R.S(nt,Ye)),Wi(new R.S(nt,at))],Tt=Wi(de.center);let Pt=Number.POSITIVE_INFINITY;for(const vt of mt)_e<0&&(Pt=bn.getLesserNonNegativeNonNull(Pt,bn.solveVectorScale(vt,Tt,xt,"x",_e))),ge>0&&(Pt=bn.getLesserNonNegativeNonNull(Pt,bn.solveVectorScale(vt,Tt,xt,"x",ge))),xe>0&&(Pt=bn.getLesserNonNegativeNonNull(Pt,bn.solveVectorScale(vt,Tt,xt,"y",xe))),Se<0&&(Pt=bn.getLesserNonNegativeNonNull(Pt,bn.solveVectorScale(vt,Tt,xt,"y",Se)));if(Number.isFinite(Pt)&&Pt!==0)return de.zoom=ht.zoom+R.aj(Pt),de;un()}handleJumpToCenterZoom(t,G){const J=t.center.lat,te=t.getConstrained(G.center?R.S.convert(G.center):t.center,t.zoom).center;t.setCenter(te.wrap());const se=G.zoom!==void 0?+G.zoom:t.zoom+ji(J,te.lat);t.zoom!==se&&t.setZoom(se)}handleEaseTo(t,G){const J=t.zoom,te=t.center,se=t.padding,de={roll:t.roll,pitch:t.pitch,bearing:t.bearing},_e={roll:G.roll===void 0?t.roll:G.roll,pitch:G.pitch===void 0?t.pitch:G.pitch,bearing:G.bearing===void 0?t.bearing:G.bearing},ge=G.zoom!==void 0,xe=!t.isPaddingEqual(G.padding);let Se=!1;const Oe=G.center?R.S.convert(G.center):te,Ae=t.getConstrained(Oe,J).center;Zn(t,Ae);const je=t.clone();je.setCenter(Ae),je.setZoom(ge?+G.zoom:J+ji(te.lat,Oe.lat)),je.setBearing(G.bearing);const Ye=new R.P(R.ag(t.centerPoint.x+G.offsetAsPoint.x,0,t.width),R.ag(t.centerPoint.y+G.offsetAsPoint.y,0,t.height));je.setLocationAtPoint(Ae,Ye);const at=(G.offset&&G.offsetAsPoint.mag())>0?je.center:Ae,nt=ge?+G.zoom:J+ji(te.lat,at.lat),ot=J+ji(te.lat,0),ht=nt+ji(at.lat,0),xt=R.bz(te.lng,at.lng),mt=R.bz(te.lat,at.lat),Tt=R.ae(ht-ot);return Se=nt!==J,{easeFunc:Pt=>{if(R.bd(de,_e)||$i({startEulerAngles:de,endEulerAngles:_e,tr:t,k:Pt,useSlerp:de.roll!=_e.roll}),xe&&t.interpolatePadding(se,G.padding,Pt),G.around)R.w("Easing around a point is not supported under globe projection."),t.setLocationAtPoint(G.around,G.aroundPoint);else{const vt=ht>ot?Math.min(2,Tt):Math.max(.5,Tt),kt=Math.pow(vt,1-Pt),Vt=La(te,xt,mt,Pt*kt);t.setCenter(Vt.wrap())}if(Se){const vt=R.C.number(ot,ht,Pt)+ji(0,t.center.lat);t.setZoom(vt)}},isZooming:Se,elevationCenter:at}}handleFlyTo(t,G){const J=G.zoom!==void 0,te=t.center,se=t.zoom,de=t.padding,_e=!t.isPaddingEqual(G.padding),ge=t.getConstrained(R.S.convert(G.center||G.locationAtOffset),se).center,xe=J?+G.zoom:t.zoom+ji(t.center.lat,ge.lat),Se=t.clone();Se.setCenter(ge),Se.setZoom(xe),Se.setBearing(G.bearing);const Oe=new R.P(R.ag(t.centerPoint.x+G.offsetAsPoint.x,0,t.width),R.ag(t.centerPoint.y+G.offsetAsPoint.y,0,t.height));Se.setLocationAtPoint(ge,Oe);const Ae=Se.center;Zn(t,Ae);const je=function(mt,Tt,Pt){const vt=Wi(Tt),kt=Wi(Pt),Vt=R.aW(vt,kt),jt=Math.acos(Vt),zt=po(mt);return jt/(2*Math.PI)*zt}(t,te,Ae),Ye=se+ji(te.lat,0),at=xe+ji(Ae.lat,0),nt=R.ae(at-Ye);let ot;if(typeof G.minZoom=="number"){const mt=+G.minZoom+ji(Ae.lat,0),Tt=Math.min(mt,Ye,at)+ji(0,Ae.lat),Pt=t.getConstrained(Ae,Tt).zoom+ji(Ae.lat,0);ot=R.ae(Pt-Ye)}const ht=R.bz(te.lng,Ae.lng),xt=R.bz(te.lat,Ae.lat);return{easeFunc:(mt,Tt,Pt,vt)=>{const kt=La(te,ht,xt,Pt);_e&&t.interpolatePadding(de,G.padding,mt);const Vt=mt===1?Ae:kt;t.setCenter(Vt.wrap());const jt=Ye+R.aj(Tt);t.setZoom(mt===1?xe:jt+ji(0,Vt.lat))},scaleOfZoom:nt,targetCenter:Ae,scaleOfMinZoom:ot,pixelPathLength:je}}static solveVectorScale(t,G,J,te,se){const de=te==="x"?[J[0],J[4],J[8],J[12]]:[J[1],J[5],J[9],J[13]],_e=[J[3],J[7],J[11],J[15]],ge=t[0]*de[0]+t[1]*de[1]+t[2]*de[2],xe=t[0]*_e[0]+t[1]*_e[1]+t[2]*_e[2],Se=G[0]*de[0]+G[1]*de[1]+G[2]*de[2],Oe=G[0]*_e[0]+G[1]*_e[1]+G[2]*_e[2];return Se+se*xe===ge+se*Oe||_e[3]*(ge-Se)+de[3]*(Oe-xe)+ge*Oe==Se*xe?null:(Se+de[3]-se*Oe-se*_e[3])/(Se-ge-se*Oe+se*xe)}static getLesserNonNegativeNonNull(t,G){return G!==null&&G>=0&&G<t?G:t}}class Qs{constructor(t){this._globe=t,this._mercatorCameraHelper=new es,this._verticalPerspectiveCameraHelper=new bn}get useGlobeControls(){return this._globe.useGlobeRendering}get currentHelper(){return this.useGlobeControls?this._verticalPerspectiveCameraHelper:this._mercatorCameraHelper}handlePanInertia(t,G){return this.currentHelper.handlePanInertia(t,G)}handleMapControlsRollPitchBearingZoom(t,G){return this.currentHelper.handleMapControlsRollPitchBearingZoom(t,G)}handleMapControlsPan(t,G,J){this.currentHelper.handleMapControlsPan(t,G,J)}cameraForBoxAndBearing(t,G,J,te,se){return this.currentHelper.cameraForBoxAndBearing(t,G,J,te,se)}handleJumpToCenterZoom(t,G){this.currentHelper.handleJumpToCenterZoom(t,G)}handleEaseTo(t,G){return this.currentHelper.handleEaseTo(t,G)}handleFlyTo(t,G){return this.currentHelper.handleFlyTo(t,G)}}const go=(oe,t)=>R.y(oe,t&&t.filter(G=>G.identifier!=="source.canvas")),ja=R.bD();class eu extends R.E{constructor(t,G={}){super(),this._rtlPluginLoaded=()=>{for(const J in this.sourceCaches){const te=this.sourceCaches[J].getSource().type;te!=="vector"&&te!=="geojson"||this.sourceCaches[J].reload()}},this.map=t,this.dispatcher=new vr(Er(),t._getMapId()),this.dispatcher.registerMessageHandler("GG",(J,te)=>this.getGlyphs(J,te)),this.dispatcher.registerMessageHandler("GI",(J,te)=>this.getImages(J,te)),this.imageManager=new it,this.imageManager.setEventedParent(this),this.glyphManager=new gt(t._requestManager,G.localIdeographFontFamily),this.lineAtlas=new pt(256,512),this.crossTileSymbolIndex=new Xo,this._spritesImagesIds={},this._layers={},this._order=[],this.sourceCaches={},this.zoomHistory=new R.bE,this._loaded=!1,this._availableImages=[],this._globalState={},this._resetUpdates(),this.dispatcher.broadcast("SR",R.bF()),Ge().on(lr,this._rtlPluginLoaded),this.on("data",J=>{if(J.dataType!=="source"||J.sourceDataType!=="metadata")return;const te=this.sourceCaches[J.sourceId];if(!te)return;const se=te.getSource();if(se&&se.vectorLayerIds)for(const de in this._layers){const _e=this._layers[de];_e.source===se.id&&this._validateLayer(_e)}})}setGlobalStateProperty(t,G){var J,te,se;this._checkLoaded();const de=G===null?(se=(te=(J=this.stylesheet.state)===null||J===void 0?void 0:J[t])===null||te===void 0?void 0:te.default)!==null&&se!==void 0?se:null:G;if(R.bG(de,this._globalState[t]))return this;this._globalState[t]=de;const _e=this._findGlobalStateAffectedSources([t]);for(const ge in this.sourceCaches)_e.has(ge)&&(this._reloadSource(ge),this._changed=!0)}getGlobalState(){return this._globalState}setGlobalState(t){this._checkLoaded();const G=[];for(const te in t)!R.bG(this._globalState[te],t[te].default)&&(G.push(te),this._globalState[te]=t[te].default);const J=this._findGlobalStateAffectedSources(G);for(const te in this.sourceCaches)J.has(te)&&(this._reloadSource(te),this._changed=!0)}_findGlobalStateAffectedSources(t){if(t.length===0)return new Set;const G=new Set;for(const J in this._layers){const te=this._layers[J],se=te.getLayoutAffectingGlobalStateRefs();for(const de of t)se.has(de)&&G.add(te.source)}return G}loadURL(t,G={},J){this.fire(new R.l("dataloading",{dataType:"style"})),G.validate=typeof G.validate!="boolean"||G.validate;const te=this.map._requestManager.transformRequest(t,"Style");this._loadStyleRequest=new AbortController;const se=this._loadStyleRequest;R.j(te,this._loadStyleRequest).then(de=>{this._loadStyleRequest=null,this._load(de.data,G,J)}).catch(de=>{this._loadStyleRequest=null,de&&!se.signal.aborted&&this.fire(new R.k(de))})}loadJSON(t,G={},J){this.fire(new R.l("dataloading",{dataType:"style"})),this._frameRequest=new AbortController,pe.frameAsync(this._frameRequest).then(()=>{this._frameRequest=null,G.validate=G.validate!==!1,this._load(t,G,J)}).catch(()=>{})}loadEmpty(){this.fire(new R.l("dataloading",{dataType:"style"})),this._load(ja,{validate:!1})}_load(t,G,J){var te,se,de;const _e=G.transformStyle?G.transformStyle(J,t):t;if(!G.validate||!go(this,R.z(_e))){this._loaded=!0,this.stylesheet=_e;for(const ge in _e.sources)this.addSource(ge,_e.sources[ge],{validate:!1});_e.sprite?this._loadSprite(_e.sprite):this.imageManager.setLoaded(!0),this.glyphManager.setURL(_e.glyphs),this._createLayers(),this.light=new Gt(this.stylesheet.light),this._setProjectionInternal(((te=this.stylesheet.projection)===null||te===void 0?void 0:te.type)||"mercator"),this.sky=new Rt(this.stylesheet.sky),this.map.setTerrain((se=this.stylesheet.terrain)!==null&&se!==void 0?se:null),this.setGlobalState((de=this.stylesheet.state)!==null&&de!==void 0?de:null),this.fire(new R.l("data",{dataType:"style"})),this.fire(new R.l("style.load"))}}_createLayers(){const t=R.bH(this.stylesheet.layers);this.dispatcher.broadcast("SL",t),this._order=t.map(G=>G.id),this._layers={},this._serializedLayers=null;for(const G of t){const J=R.bI(G);J.setEventedParent(this,{layer:{id:G.id}}),this._layers[G.id]=J}}_loadSprite(t,G=!1,J=void 0){let te;this.imageManager.setLoaded(!1),this._spriteRequest=new AbortController,function(se,de,_e,ge){return R._(this,void 0,void 0,function*(){const xe=Ze(se),Se=_e>1?"@2x":"",Oe={},Ae={};for(const{id:je,url:Ye}of xe){const at=de.transformRequest(Je(Ye,Se,".json"),"SpriteJSON");Oe[je]=R.j(at,ge);const nt=de.transformRequest(Je(Ye,Se,".png"),"SpriteImage");Ae[je]=Fe.getImage(nt,ge)}return yield Promise.all([...Object.values(Oe),...Object.values(Ae)]),function(je,Ye){return R._(this,void 0,void 0,function*(){const at={};for(const nt in je){at[nt]={};const ot=pe.getImageCanvasContext((yield Ye[nt]).data),ht=(yield je[nt]).data;for(const xt in ht){const{width:mt,height:Tt,x:Pt,y:vt,sdf:kt,pixelRatio:Vt,stretchX:jt,stretchY:zt,content:$t,textFitWidth:mr,textFitHeight:_r}=ht[xt];at[nt][xt]={data:null,pixelRatio:Vt,sdf:kt,stretchX:jt,stretchY:zt,content:$t,textFitWidth:mr,textFitHeight:_r,spriteData:{width:mt,height:Tt,x:Pt,y:vt,context:ot}}}}return at})}(Oe,Ae)})}(t,this.map._requestManager,this.map.getPixelRatio(),this._spriteRequest).then(se=>{if(this._spriteRequest=null,se)for(const de in se){this._spritesImagesIds[de]=[];const _e=this._spritesImagesIds[de]?this._spritesImagesIds[de].filter(ge=>!(ge in se)):[];for(const ge of _e)this.imageManager.removeImage(ge),this._changedImages[ge]=!0;for(const ge in se[de]){const xe=de==="default"?ge:`${de}:${ge}`;this._spritesImagesIds[de].push(xe),xe in this.imageManager.images?this.imageManager.updateImage(xe,se[de][ge],!1):this.imageManager.addImage(xe,se[de][ge]),G&&(this._changedImages[xe]=!0)}}}).catch(se=>{this._spriteRequest=null,te=se,this.fire(new R.k(te))}).finally(()=>{this.imageManager.setLoaded(!0),this._availableImages=this.imageManager.listImages(),G&&(this._changed=!0),this.dispatcher.broadcast("SI",this._availableImages),this.fire(new R.l("data",{dataType:"style"})),J&&J(te)})}_unloadSprite(){for(const t of Object.values(this._spritesImagesIds).flat())this.imageManager.removeImage(t),this._changedImages[t]=!0;this._spritesImagesIds={},this._availableImages=this.imageManager.listImages(),this._changed=!0,this.dispatcher.broadcast("SI",this._availableImages),this.fire(new R.l("data",{dataType:"style"}))}_validateLayer(t){const G=this.sourceCaches[t.source];if(!G)return;const J=t.sourceLayer;if(!J)return;const te=G.getSource();(te.type==="geojson"||te.vectorLayerIds&&te.vectorLayerIds.indexOf(J)===-1)&&this.fire(new R.k(new Error(`Source layer "${J}" does not exist on source "${te.id}" as specified by style layer "${t.id}".`)))}loaded(){if(!this._loaded||Object.keys(this._updatedSources).length)return!1;for(const t in this.sourceCaches)if(!this.sourceCaches[t].loaded())return!1;return!!this.imageManager.isLoaded()}_serializeByIds(t,G=!1){const J=this._serializedAllLayers();if(!t||t.length===0)return Object.values(G?R.bJ(J):J);const te=[];for(const se of t)if(J[se]){const de=G?R.bJ(J[se]):J[se];te.push(de)}return te}_serializedAllLayers(){let t=this._serializedLayers;if(t)return t;t=this._serializedLayers={};const G=Object.keys(this._layers);for(const J of G){const te=this._layers[J];te.type!=="custom"&&(t[J]=te.serialize())}return t}hasTransitions(){var t,G,J;if(!((t=this.light)===null||t===void 0)&&t.hasTransition()||!((G=this.sky)===null||G===void 0)&&G.hasTransition()||!((J=this.projection)===null||J===void 0)&&J.hasTransition())return!0;for(const te in this.sourceCaches)if(this.sourceCaches[te].hasTransition())return!0;for(const te in this._layers)if(this._layers[te].hasTransition())return!0;return!1}_checkLoaded(){if(!this._loaded)throw new Error("Style is not done loading.")}update(t){if(!this._loaded)return;const G=this._changed;if(G){const te=Object.keys(this._updatedLayers),se=Object.keys(this._removedLayers);(te.length||se.length)&&this._updateWorkerLayers(te,se);for(const de in this._updatedSources){const _e=this._updatedSources[de];if(_e==="reload")this._reloadSource(de);else{if(_e!=="clear")throw new Error(`Invalid action ${_e}`);this._clearSource(de)}}this._updateTilesForChangedImages(),this._updateTilesForChangedGlyphs();for(const de in this._updatedPaintProps)this._layers[de].updateTransitions(t);this.light.updateTransitions(t),this.sky.updateTransitions(t),this._resetUpdates()}const J={};for(const te in this.sourceCaches){const se=this.sourceCaches[te];J[te]=se.used,se.used=!1}for(const te of this._order){const se=this._layers[te];se.recalculate(t,this._availableImages),!se.isHidden(t.zoom)&&se.source&&(this.sourceCaches[se.source].used=!0)}for(const te in J){const se=this.sourceCaches[te];!!J[te]!=!!se.used&&se.fire(new R.l("data",{sourceDataType:"visibility",dataType:"source",sourceId:te}))}this.light.recalculate(t),this.sky.recalculate(t),this.projection.recalculate(t),this.z=t.zoom,G&&this.fire(new R.l("data",{dataType:"style"}))}_updateTilesForChangedImages(){const t=Object.keys(this._changedImages);if(t.length){for(const G in this.sourceCaches)this.sourceCaches[G].reloadTilesForDependencies(["icons","patterns"],t);this._changedImages={}}}_updateTilesForChangedGlyphs(){if(this._glyphsDidChange){for(const t in this.sourceCaches)this.sourceCaches[t].reloadTilesForDependencies(["glyphs"],[""]);this._glyphsDidChange=!1}}_updateWorkerLayers(t,G){this.dispatcher.broadcast("UL",{layers:this._serializeByIds(t,!1),removedIds:G})}_resetUpdates(){this._changed=!1,this._updatedLayers={},this._removedLayers={},this._updatedSources={},this._updatedPaintProps={},this._changedImages={},this._glyphsDidChange=!1}setState(t,G={}){var J;this._checkLoaded();const te=this.serialize();if(t=G.transformStyle?G.transformStyle(te,t):t,((J=G.validate)===null||J===void 0||J)&&go(this,R.z(t)))return!1;(t=R.bJ(t)).layers=R.bH(t.layers);const se=R.bK(te,t),de=this._getOperationsToPerform(se);if(de.unimplemented.length>0)throw new Error(`Unimplemented: ${de.unimplemented.join(", ")}.`);if(de.operations.length===0)return!1;for(const _e of de.operations)_e();return this.stylesheet=t,this._serializedLayers=null,!0}_getOperationsToPerform(t){const G=[],J=[];for(const te of t)switch(te.command){case"setCenter":case"setZoom":case"setBearing":case"setPitch":case"setRoll":continue;case"addLayer":G.push(()=>this.addLayer.apply(this,te.args));break;case"removeLayer":G.push(()=>this.removeLayer.apply(this,te.args));break;case"setPaintProperty":G.push(()=>this.setPaintProperty.apply(this,te.args));break;case"setLayoutProperty":G.push(()=>this.setLayoutProperty.apply(this,te.args));break;case"setFilter":G.push(()=>this.setFilter.apply(this,te.args));break;case"addSource":G.push(()=>this.addSource.apply(this,te.args));break;case"removeSource":G.push(()=>this.removeSource.apply(this,te.args));break;case"setLayerZoomRange":G.push(()=>this.setLayerZoomRange.apply(this,te.args));break;case"setLight":G.push(()=>this.setLight.apply(this,te.args));break;case"setGeoJSONSourceData":G.push(()=>this.setGeoJSONSourceData.apply(this,te.args));break;case"setGlyphs":G.push(()=>this.setGlyphs.apply(this,te.args));break;case"setSprite":G.push(()=>this.setSprite.apply(this,te.args));break;case"setTerrain":G.push(()=>this.map.setTerrain.apply(this,te.args));break;case"setSky":G.push(()=>this.setSky.apply(this,te.args));break;case"setProjection":this.setProjection.apply(this,te.args);break;case"setGlobalState":G.push(()=>this.setGlobalState.apply(this,te.args));break;case"setTransition":G.push(()=>{});break;default:J.push(te.command)}return{operations:G,unimplemented:J}}addImage(t,G){if(this.getImage(t))return this.fire(new R.k(new Error(`An image named "${t}" already exists.`)));this.imageManager.addImage(t,G),this._afterImageUpdated(t)}updateImage(t,G){this.imageManager.updateImage(t,G)}getImage(t){return this.imageManager.getImage(t)}removeImage(t){if(!this.getImage(t))return this.fire(new R.k(new Error(`An image named "${t}" does not exist.`)));this.imageManager.removeImage(t),this._afterImageUpdated(t)}_afterImageUpdated(t){this._availableImages=this.imageManager.listImages(),this._changedImages[t]=!0,this._changed=!0,this.dispatcher.broadcast("SI",this._availableImages),this.fire(new R.l("data",{dataType:"style"}))}listImages(){return this._checkLoaded(),this.imageManager.listImages()}addSource(t,G,J={}){if(this._checkLoaded(),this.sourceCaches[t]!==void 0)throw new Error(`Source "${t}" already exists.`);if(!G.type)throw new Error(`The type property must be defined, but only the following properties were given: ${Object.keys(G).join(", ")}.`);if(["vector","raster","geojson","video","image"].indexOf(G.type)>=0&&this._validate(R.z.source,`sources.${t}`,G,null,J))return;this.map&&this.map._collectResourceTiming&&(G.collectResourceTiming=!0);const te=this.sourceCaches[t]=new Nt(t,G,this.dispatcher);te.style=this,te.setEventedParent(this,()=>({isSourceLoaded:te.loaded(),source:te.serialize(),sourceId:t})),te.onAdd(this.map),this._changed=!0}removeSource(t){if(this._checkLoaded(),this.sourceCaches[t]===void 0)throw new Error("There is no source with this ID");for(const J in this._layers)if(this._layers[J].source===t)return this.fire(new R.k(new Error(`Source "${t}" cannot be removed while layer "${J}" is using it.`)));const G=this.sourceCaches[t];delete this.sourceCaches[t],delete this._updatedSources[t],G.fire(new R.l("data",{sourceDataType:"metadata",dataType:"source",sourceId:t})),G.setEventedParent(null),G.onRemove(this.map),this._changed=!0}setGeoJSONSourceData(t,G){if(this._checkLoaded(),this.sourceCaches[t]===void 0)throw new Error(`There is no source with this ID=${t}`);const J=this.sourceCaches[t].getSource();if(J.type!=="geojson")throw new Error(`geojsonSource.type is ${J.type}, which is !== 'geojson`);J.setData(G),this._changed=!0}getSource(t){return this.sourceCaches[t]&&this.sourceCaches[t].getSource()}addLayer(t,G,J={}){this._checkLoaded();const te=t.id;if(this.getLayer(te))return void this.fire(new R.k(new Error(`Layer "${te}" already exists on this map.`)));let se;if(t.type==="custom"){if(go(this,R.bL(t)))return;se=R.bI(t)}else{if("source"in t&&typeof t.source=="object"&&(this.addSource(te,t.source),t=R.bJ(t),t=R.e(t,{source:te})),this._validate(R.z.layer,`layers.${te}`,t,{arrayIndex:-1},J))return;se=R.bI(t),this._validateLayer(se),se.setEventedParent(this,{layer:{id:te}})}const de=G?this._order.indexOf(G):this._order.length;if(G&&de===-1)this.fire(new R.k(new Error(`Cannot add layer "${te}" before non-existing layer "${G}".`)));else{if(this._order.splice(de,0,te),this._layerOrderChanged=!0,this._layers[te]=se,this._removedLayers[te]&&se.source&&se.type!=="custom"){const _e=this._removedLayers[te];delete this._removedLayers[te],_e.type!==se.type?this._updatedSources[se.source]="clear":(this._updatedSources[se.source]="reload",this.sourceCaches[se.source].pause())}this._updateLayer(se),se.onAdd&&se.onAdd(this.map)}}moveLayer(t,G){if(this._checkLoaded(),this._changed=!0,!this._layers[t])return void this.fire(new R.k(new Error(`The layer '${t}' does not exist in the map's style and cannot be moved.`)));if(t===G)return;const J=this._order.indexOf(t);this._order.splice(J,1);const te=G?this._order.indexOf(G):this._order.length;G&&te===-1?this.fire(new R.k(new Error(`Cannot move layer "${t}" before non-existing layer "${G}".`))):(this._order.splice(te,0,t),this._layerOrderChanged=!0)}removeLayer(t){this._checkLoaded();const G=this._layers[t];if(!G)return void this.fire(new R.k(new Error(`Cannot remove non-existing layer "${t}".`)));G.setEventedParent(null);const J=this._order.indexOf(t);this._order.splice(J,1),this._layerOrderChanged=!0,this._changed=!0,this._removedLayers[t]=G,delete this._layers[t],this._serializedLayers&&delete this._serializedLayers[t],delete this._updatedLayers[t],delete this._updatedPaintProps[t],G.onRemove&&G.onRemove(this.map)}getLayer(t){return this._layers[t]}getLayersOrder(){return[...this._order]}hasLayer(t){return t in this._layers}setLayerZoomRange(t,G,J){this._checkLoaded();const te=this.getLayer(t);te?te.minzoom===G&&te.maxzoom===J||(G!=null&&(te.minzoom=G),J!=null&&(te.maxzoom=J),this._updateLayer(te)):this.fire(new R.k(new Error(`Cannot set the zoom range of non-existing layer "${t}".`)))}setFilter(t,G,J={}){this._checkLoaded();const te=this.getLayer(t);if(te){if(!R.bG(te.filter,G))return G==null?(te.setFilter(void 0),void this._updateLayer(te)):void(this._validate(R.z.filter,`layers.${te.id}.filter`,G,null,J)||(te.setFilter(R.bJ(G)),this._updateLayer(te)))}else this.fire(new R.k(new Error(`Cannot filter non-existing layer "${t}".`)))}getFilter(t){return R.bJ(this.getLayer(t).filter)}setLayoutProperty(t,G,J,te={}){this._checkLoaded();const se=this.getLayer(t);se?R.bG(se.getLayoutProperty(G),J)||(se.setLayoutProperty(G,J,te),this._updateLayer(se)):this.fire(new R.k(new Error(`Cannot style non-existing layer "${t}".`)))}getLayoutProperty(t,G){const J=this.getLayer(t);if(J)return J.getLayoutProperty(G);this.fire(new R.k(new Error(`Cannot get style of non-existing layer "${t}".`)))}setPaintProperty(t,G,J,te={}){this._checkLoaded();const se=this.getLayer(t);se?R.bG(se.getPaintProperty(G),J)||(se.setPaintProperty(G,J,te)&&this._updateLayer(se),this._changed=!0,this._updatedPaintProps[t]=!0,this._serializedLayers=null):this.fire(new R.k(new Error(`Cannot style non-existing layer "${t}".`)))}getPaintProperty(t,G){return this.getLayer(t).getPaintProperty(G)}setFeatureState(t,G){this._checkLoaded();const J=t.source,te=t.sourceLayer,se=this.sourceCaches[J];if(se===void 0)return void this.fire(new R.k(new Error(`The source '${J}' does not exist in the map's style.`)));const de=se.getSource().type;de==="geojson"&&te?this.fire(new R.k(new Error("GeoJSON sources cannot have a sourceLayer parameter."))):de!=="vector"||te?(t.id===void 0&&this.fire(new R.k(new Error("The feature id parameter must be provided."))),se.setFeatureState(te,t.id,G)):this.fire(new R.k(new Error("The sourceLayer parameter must be provided for vector source types.")))}removeFeatureState(t,G){this._checkLoaded();const J=t.source,te=this.sourceCaches[J];if(te===void 0)return void this.fire(new R.k(new Error(`The source '${J}' does not exist in the map's style.`)));const se=te.getSource().type,de=se==="vector"?t.sourceLayer:void 0;se!=="vector"||de?G&&typeof t.id!="string"&&typeof t.id!="number"?this.fire(new R.k(new Error("A feature id is required to remove its specific state property."))):te.removeFeatureState(de,t.id,G):this.fire(new R.k(new Error("The sourceLayer parameter must be provided for vector source types.")))}getFeatureState(t){this._checkLoaded();const G=t.source,J=t.sourceLayer,te=this.sourceCaches[G];if(te!==void 0)return te.getSource().type!=="vector"||J?(t.id===void 0&&this.fire(new R.k(new Error("The feature id parameter must be provided."))),te.getFeatureState(J,t.id)):void this.fire(new R.k(new Error("The sourceLayer parameter must be provided for vector source types.")));this.fire(new R.k(new Error(`The source '${G}' does not exist in the map's style.`)))}getTransition(){return R.e({duration:300,delay:0},this.stylesheet&&this.stylesheet.transition)}serialize(){if(!this._loaded)return;const t=R.bM(this.sourceCaches,se=>se.serialize()),G=this._serializeByIds(this._order,!0),J=this.map.getTerrain()||void 0,te=this.stylesheet;return R.bN({version:te.version,name:te.name,metadata:te.metadata,light:te.light,sky:te.sky,center:te.center,zoom:te.zoom,bearing:te.bearing,pitch:te.pitch,sprite:te.sprite,glyphs:te.glyphs,transition:te.transition,projection:te.projection,sources:t,layers:G,terrain:J},se=>se!==void 0)}_updateLayer(t){this._updatedLayers[t.id]=!0,t.source&&!this._updatedSources[t.source]&&this.sourceCaches[t.source].getSource().type!=="raster"&&(this._updatedSources[t.source]="reload",this.sourceCaches[t.source].pause()),this._serializedLayers=null,this._changed=!0}_flattenAndSortRenderedFeatures(t){const G=de=>this._layers[de].type==="fill-extrusion",J={},te=[];for(let de=this._order.length-1;de>=0;de--){const _e=this._order[de];if(G(_e)){J[_e]=de;for(const ge of t){const xe=ge[_e];if(xe)for(const Se of xe)te.push(Se)}}}te.sort((de,_e)=>_e.intersectionZ-de.intersectionZ);const se=[];for(let de=this._order.length-1;de>=0;de--){const _e=this._order[de];if(G(_e))for(let ge=te.length-1;ge>=0;ge--){const xe=te[ge].feature;if(J[xe.layer.id]<de)break;se.push(xe),te.pop()}else for(const ge of t){const xe=ge[_e];if(xe)for(const Se of xe)se.push(Se.feature)}}return se}queryRenderedFeatures(t,G,J){G&&G.filter&&this._validate(R.z.filter,"queryRenderedFeatures.filter",G.filter,null,G);const te={};if(G&&G.layers){if(!(Array.isArray(G.layers)||G.layers instanceof Set))return this.fire(new R.k(new Error("parameters.layers must be an Array or a Set of strings"))),[];for(const xe of G.layers){const Se=this._layers[xe];if(!Se)return this.fire(new R.k(new Error(`The layer '${xe}' does not exist in the map's style and cannot be queried for features.`))),[];te[Se.source]=!0}}const se=[];G.availableImages=this._availableImages;const de=this._serializedAllLayers(),_e=G.layers instanceof Set?G.layers:Array.isArray(G.layers)?new Set(G.layers):null,ge=Object.assign(Object.assign({},G),{layers:_e});for(const xe in this.sourceCaches)G.layers&&!te[xe]||se.push(or(this.sourceCaches[xe],this._layers,de,t,ge,J,this.map.terrain?(Se,Oe,Ae)=>this.map.terrain.getElevation(Se,Oe,Ae):void 0));return this.placement&&se.push(function(xe,Se,Oe,Ae,je,Ye,at){const nt={},ot=Ye.queryRenderedSymbols(Ae),ht=[];for(const xt of Object.keys(ot).map(Number))ht.push(at[xt]);ht.sort(Ir);for(const xt of ht){const mt=xt.featureIndex.lookupSymbolFeatures(ot[xt.bucketInstanceId],Se,xt.bucketIndex,xt.sourceLayerIndex,je.filter,je.layers,je.availableImages,xe);for(const Tt in mt){const Pt=nt[Tt]=nt[Tt]||[],vt=mt[Tt];vt.sort((kt,Vt)=>{const jt=xt.featureSortOrder;if(jt){const zt=jt.indexOf(kt.featureIndex);return jt.indexOf(Vt.featureIndex)-zt}return Vt.featureIndex-kt.featureIndex});for(const kt of vt)Pt.push(kt)}}return function(xt,mt,Tt){for(const Pt in xt)for(const vt of xt[Pt])Rr(vt,Tt[mt[Pt].source]);return xt}(nt,xe,Oe)}(this._layers,de,this.sourceCaches,t,ge,this.placement.collisionIndex,this.placement.retainedQueryData)),this._flattenAndSortRenderedFeatures(se)}querySourceFeatures(t,G){G&&G.filter&&this._validate(R.z.filter,"querySourceFeatures.filter",G.filter,null,G);const J=this.sourceCaches[t];return J?function(te,se){const de=te.getRenderableIds().map(xe=>te.getTileByID(xe)),_e=[],ge={};for(let xe=0;xe<de.length;xe++){const Se=de[xe],Oe=Se.tileID.canonical.key;ge[Oe]||(ge[Oe]=!0,Se.querySourceFeatures(_e,se))}return _e}(J,G):[]}getLight(){return this.light.getLight()}setLight(t,G={}){this._checkLoaded();const J=this.light.getLight();let te=!1;for(const de in t)if(!R.bG(t[de],J[de])){te=!0;break}if(!te)return;const se={now:pe.now(),transition:R.e({duration:300,delay:0},this.stylesheet.transition)};this.light.setLight(t,G),this.light.updateTransitions(se)}getProjection(){var t;return(t=this.stylesheet)===null||t===void 0?void 0:t.projection}setProjection(t){if(this._checkLoaded(),this.projection){if(this.projection.name===t.type)return;this.projection.destroy(),delete this.projection}this.stylesheet.projection=t,this._setProjectionInternal(t.type)}getSky(){var t;return(t=this.stylesheet)===null||t===void 0?void 0:t.sky}setSky(t,G={}){this._checkLoaded();const J=this.getSky();let te=!1;if(!t&&!J)return;if(t&&!J)te=!0;else if(!t&&J)te=!0;else for(const de in t)if(!R.bG(t[de],J[de])){te=!0;break}if(!te)return;const se={now:pe.now(),transition:R.e({duration:300,delay:0},this.stylesheet.transition)};this.stylesheet.sky=t,this.sky.setSky(t,G),this.sky.updateTransitions(se)}_setProjectionInternal(t){const G=function(J){if(Array.isArray(J)){const te=new fo({type:J});return{projection:te,transform:new En,cameraHelper:new Qs(te)}}switch(J){case"mercator":return{projection:new Ks,transform:new Bi,cameraHelper:new es};case"globe":{const te=new fo({type:["interpolate",["linear"],["zoom"],11,"vertical-perspective",12,"mercator"]});return{projection:te,transform:new En,cameraHelper:new Qs(te)}}case"vertical-perspective":return{projection:new cl,transform:new Ba,cameraHelper:new bn};default:return R.w(`Unknown projection name: ${J}. Falling back to mercator projection.`),{projection:new Ks,transform:new Bi,cameraHelper:new es}}}(t);this.projection=G.projection,this.map.migrateProjection(G.transform,G.cameraHelper);for(const J in this.sourceCaches)this.sourceCaches[J].reload()}_validate(t,G,J,te,se={}){return(!se||se.validate!==!1)&&go(this,t.call(R.z,R.e({key:G,style:this.serialize(),value:J,styleSpec:R.v},te)))}_remove(t=!0){this._frameRequest&&(this._frameRequest.abort(),this._frameRequest=null),this._loadStyleRequest&&(this._loadStyleRequest.abort(),this._loadStyleRequest=null),this._spriteRequest&&(this._spriteRequest.abort(),this._spriteRequest=null),Ge().off(lr,this._rtlPluginLoaded);for(const G in this._layers)this._layers[G].setEventedParent(null);for(const G in this.sourceCaches){const J=this.sourceCaches[G];J.setEventedParent(null),J.onRemove(this.map)}this.imageManager.setEventedParent(null),this.setEventedParent(null),t&&this.dispatcher.broadcast("RM",void 0),this.dispatcher.remove(t)}_clearSource(t){this.sourceCaches[t].clearTiles()}_reloadSource(t){this.sourceCaches[t].resume(),this.sourceCaches[t].reload()}_updateSources(t){for(const G in this.sourceCaches)this.sourceCaches[G].update(t,this.map.terrain)}_generateCollisionBoxes(){for(const t in this.sourceCaches)this._reloadSource(t)}_updatePlacement(t,G,J,te,se=!1){let de=!1,_e=!1;const ge={};for(const xe of this._order){const Se=this._layers[xe];if(Se.type!=="symbol")continue;if(!ge[Se.source]){const Ae=this.sourceCaches[Se.source];ge[Se.source]=Ae.getRenderableIds(!0).map(je=>Ae.getTileByID(je)).sort((je,Ye)=>Ye.tileID.overscaledZ-je.tileID.overscaledZ||(je.tileID.isLessThan(Ye.tileID)?-1:1))}const Oe=this.crossTileSymbolIndex.addLayer(Se,ge[Se.source],t.center.lng);de=de||Oe}if(this.crossTileSymbolIndex.pruneUnusedLayers(this._order),((se=se||this._layerOrderChanged||J===0)||!this.pauseablePlacement||this.pauseablePlacement.isDone()&&!this.placement.stillRecent(pe.now(),t.zoom))&&(this.pauseablePlacement=new ul(t,this.map.terrain,this._order,se,G,J,te,this.placement),this._layerOrderChanged=!1),this.pauseablePlacement.isDone()?this.placement.setStale():(this.pauseablePlacement.continuePlacement(this._order,this._layers,ge),this.pauseablePlacement.isDone()&&(this.placement=this.pauseablePlacement.commit(pe.now()),_e=!0),de&&this.pauseablePlacement.placement.setStale()),_e||de)for(const xe of this._order){const Se=this._layers[xe];Se.type==="symbol"&&this.placement.updateLayerOpacities(Se,ge[Se.source])}return!this.pauseablePlacement.isDone()||this.placement.hasTransitions(pe.now())}_releaseSymbolFadeTiles(){for(const t in this.sourceCaches)this.sourceCaches[t].releaseSymbolFadeTiles()}getImages(t,G){return R._(this,void 0,void 0,function*(){const J=yield this.imageManager.getImages(G.icons);this._updateTilesForChangedImages();const te=this.sourceCaches[G.source];return te&&te.setDependencies(G.tileID.key,G.type,G.icons),J})}getGlyphs(t,G){return R._(this,void 0,void 0,function*(){const J=yield this.glyphManager.getGlyphs(G.stacks),te=this.sourceCaches[G.source];return te&&te.setDependencies(G.tileID.key,G.type,[""]),J})}getGlyphsUrl(){return this.stylesheet.glyphs||null}setGlyphs(t,G={}){this._checkLoaded(),t&&this._validate(R.z.glyphs,"glyphs",t,null,G)||(this._glyphsDidChange=!0,this.stylesheet.glyphs=t,this.glyphManager.entries={},this.glyphManager.setURL(t))}addSprite(t,G,J={},te){this._checkLoaded();const se=[{id:t,url:G}],de=[...Ze(this.stylesheet.sprite),...se];this._validate(R.z.sprite,"sprite",de,null,J)||(this.stylesheet.sprite=de,this._loadSprite(se,!0,te))}removeSprite(t){this._checkLoaded();const G=Ze(this.stylesheet.sprite);if(G.find(J=>J.id===t)){if(this._spritesImagesIds[t])for(const J of this._spritesImagesIds[t])this.imageManager.removeImage(J),this._changedImages[J]=!0;G.splice(G.findIndex(J=>J.id===t),1),this.stylesheet.sprite=G.length>0?G:void 0,delete this._spritesImagesIds[t],this._availableImages=this.imageManager.listImages(),this._changed=!0,this.dispatcher.broadcast("SI",this._availableImages),this.fire(new R.l("data",{dataType:"style"}))}else this.fire(new R.k(new Error(`Sprite "${t}" doesn't exists on this map.`)))}getSprite(){return Ze(this.stylesheet.sprite)}setSprite(t,G={},J){this._checkLoaded(),t&&this._validate(R.z.sprite,"sprite",t,null,G)||(this.stylesheet.sprite=t,t?this._loadSprite(t,!0,J):(this._unloadSprite(),J&&J(null)))}}var mc=R.aI([{name:"a_pos",type:"Int16",components:2},{name:"a_texture_pos",type:"Int16",components:2}]);class yc{constructor(){this.boundProgram=null,this.boundLayoutVertexBuffer=null,this.boundPaintVertexBuffers=[],this.boundIndexBuffer=null,this.boundVertexOffset=null,this.boundDynamicVertexBuffer=null,this.vao=null}bind(t,G,J,te,se,de,_e,ge,xe){this.context=t;let Se=this.boundPaintVertexBuffers.length!==te.length;for(let Oe=0;!Se&&Oe<te.length;Oe++)this.boundPaintVertexBuffers[Oe]!==te[Oe]&&(Se=!0);!this.vao||this.boundProgram!==G||this.boundLayoutVertexBuffer!==J||Se||this.boundIndexBuffer!==se||this.boundVertexOffset!==de||this.boundDynamicVertexBuffer!==_e||this.boundDynamicVertexBuffer2!==ge||this.boundDynamicVertexBuffer3!==xe?this.freshBind(G,J,te,se,de,_e,ge,xe):(t.bindVertexArray.set(this.vao),_e&&_e.bind(),se&&se.dynamicDraw&&se.bind(),ge&&ge.bind(),xe&&xe.bind())}freshBind(t,G,J,te,se,de,_e,ge){const xe=t.numAttributes,Se=this.context,Oe=Se.gl;this.vao&&this.destroy(),this.vao=Se.createVertexArray(),Se.bindVertexArray.set(this.vao),this.boundProgram=t,this.boundLayoutVertexBuffer=G,this.boundPaintVertexBuffers=J,this.boundIndexBuffer=te,this.boundVertexOffset=se,this.boundDynamicVertexBuffer=de,this.boundDynamicVertexBuffer2=_e,this.boundDynamicVertexBuffer3=ge,G.enableAttributes(Oe,t);for(const Ae of J)Ae.enableAttributes(Oe,t);de&&de.enableAttributes(Oe,t),_e&&_e.enableAttributes(Oe,t),ge&&ge.enableAttributes(Oe,t),G.bind(),G.setVertexAttribPointers(Oe,t,se);for(const Ae of J)Ae.bind(),Ae.setVertexAttribPointers(Oe,t,se);de&&(de.bind(),de.setVertexAttribPointers(Oe,t,se)),te&&te.bind(),_e&&(_e.bind(),_e.setVertexAttribPointers(Oe,t,se)),ge&&(ge.bind(),ge.setVertexAttribPointers(Oe,t,se)),Se.currentNumAttributes=xe}destroy(){this.vao&&(this.context.deleteVertexArray(this.vao),this.vao=null)}}const gc=(oe,t,G,J,te)=>({u_texture:0,u_ele_delta:oe,u_fog_matrix:t,u_fog_color:G?G.properties.get("fog-color"):R.be.white,u_fog_ground_blend:G?G.properties.get("fog-ground-blend"):1,u_fog_ground_blend_opacity:te?0:G?G.calculateFogBlendOpacity(J):0,u_horizon_color:G?G.properties.get("horizon-color"):R.be.white,u_horizon_fog_blend:G?G.properties.get("horizon-fog-blend"):1,u_is_globe_mode:te?1:0}),vc={mainMatrix:"u_projection_matrix",tileMercatorCoords:"u_projection_tile_mercator_coords",clippingPlane:"u_projection_clipping_plane",projectionTransition:"u_projection_transition",fallbackMatrix:"u_projection_fallback_matrix"};function ts(oe){const t=[];for(let G=0;G<oe.length;G++){if(oe[G]===null)continue;const J=oe[G].split(" ");t.push(J.pop())}return t}class rs{constructor(t,G,J,te,se,de,_e,ge,xe=[]){const Se=t.gl;this.program=Se.createProgram();const Oe=ts(G.staticAttributes),Ae=J?J.getBinderAttributes():[],je=Oe.concat(Ae),Ye=Nn.prelude.staticUniforms?ts(Nn.prelude.staticUniforms):[],at=_e.staticUniforms?ts(_e.staticUniforms):[],nt=G.staticUniforms?ts(G.staticUniforms):[],ot=J?J.getBinderUniforms():[],ht=Ye.concat(at).concat(nt).concat(ot),xt=[];for(const jt of ht)xt.indexOf(jt)<0&&xt.push(jt);const mt=J?J.defines():[];hn(Se)&&mt.unshift("#version 300 es"),se&&mt.push("#define OVERDRAW_INSPECTOR;"),de&&mt.push("#define TERRAIN3D;"),ge&&mt.push(ge),xe&&mt.push(...xe);let Tt=mt.concat(Nn.prelude.fragmentSource,_e.fragmentSource,G.fragmentSource).join(`
`),Pt=mt.concat(Nn.prelude.vertexSource,_e.vertexSource,G.vertexSource).join(`
`);hn(Se)||(Tt=function(jt){return jt.replace(/\bin\s/g,"varying ").replace("out highp vec4 fragColor;","").replace(/fragColor/g,"gl_FragColor").replace(/texture\(/g,"texture2D(")}(Tt),Pt=function(jt){return jt.replace(/\bin\s/g,"attribute ").replace(/\bout\s/g,"varying ").replace(/texture\(/g,"texture2D(")}(Pt));const vt=Se.createShader(Se.FRAGMENT_SHADER);if(Se.isContextLost())return void(this.failedToCreate=!0);if(Se.shaderSource(vt,Tt),Se.compileShader(vt),!Se.getShaderParameter(vt,Se.COMPILE_STATUS))throw new Error(`Could not compile fragment shader: ${Se.getShaderInfoLog(vt)}`);Se.attachShader(this.program,vt);const kt=Se.createShader(Se.VERTEX_SHADER);if(Se.isContextLost())return void(this.failedToCreate=!0);if(Se.shaderSource(kt,Pt),Se.compileShader(kt),!Se.getShaderParameter(kt,Se.COMPILE_STATUS))throw new Error(`Could not compile vertex shader: ${Se.getShaderInfoLog(kt)}`);Se.attachShader(this.program,kt),this.attributes={};const Vt={};this.numAttributes=je.length;for(let jt=0;jt<this.numAttributes;jt++)je[jt]&&(Se.bindAttribLocation(this.program,jt,je[jt]),this.attributes[je[jt]]=jt);if(Se.linkProgram(this.program),!Se.getProgramParameter(this.program,Se.LINK_STATUS))throw new Error(`Program failed to link: ${Se.getProgramInfoLog(this.program)}`);Se.deleteShader(kt),Se.deleteShader(vt);for(let jt=0;jt<xt.length;jt++){const zt=xt[jt];if(zt&&!Vt[zt]){const $t=Se.getUniformLocation(this.program,zt);$t&&(Vt[zt]=$t)}}this.fixedUniforms=te(t,Vt),this.terrainUniforms=((jt,zt)=>({u_depth:new R.bO(jt,zt.u_depth),u_terrain:new R.bO(jt,zt.u_terrain),u_terrain_dim:new R.bf(jt,zt.u_terrain_dim),u_terrain_matrix:new R.bQ(jt,zt.u_terrain_matrix),u_terrain_unpack:new R.bR(jt,zt.u_terrain_unpack),u_terrain_exaggeration:new R.bf(jt,zt.u_terrain_exaggeration)}))(t,Vt),this.projectionUniforms=((jt,zt)=>({u_projection_matrix:new R.bQ(jt,zt.u_projection_matrix),u_projection_tile_mercator_coords:new R.bR(jt,zt.u_projection_tile_mercator_coords),u_projection_clipping_plane:new R.bR(jt,zt.u_projection_clipping_plane),u_projection_transition:new R.bf(jt,zt.u_projection_transition),u_projection_fallback_matrix:new R.bQ(jt,zt.u_projection_fallback_matrix)}))(t,Vt),this.binderUniforms=J?J.getUniforms(t,Vt):[]}draw(t,G,J,te,se,de,_e,ge,xe,Se,Oe,Ae,je,Ye,at,nt,ot,ht,xt){const mt=t.gl;if(this.failedToCreate)return;if(t.program.set(this.program),t.setDepthMode(J),t.setStencilMode(te),t.setColorMode(se),t.setCullFace(de),ge){t.activeTexture.set(mt.TEXTURE2),mt.bindTexture(mt.TEXTURE_2D,ge.depthTexture),t.activeTexture.set(mt.TEXTURE3),mt.bindTexture(mt.TEXTURE_2D,ge.texture);for(const Pt in this.terrainUniforms)this.terrainUniforms[Pt].set(ge[Pt])}if(xe)for(const Pt in xe)this.projectionUniforms[vc[Pt]].set(xe[Pt]);if(_e)for(const Pt in this.fixedUniforms)this.fixedUniforms[Pt].set(_e[Pt]);nt&&nt.setUniforms(t,this.binderUniforms,Ye,{zoom:at});let Tt=0;switch(G){case mt.LINES:Tt=2;break;case mt.TRIANGLES:Tt=3;break;case mt.LINE_STRIP:Tt=1}for(const Pt of je.get()){const vt=Pt.vaos||(Pt.vaos={});(vt[Se]||(vt[Se]=new yc)).bind(t,this,Oe,nt?nt.getPaintVertexBuffers():[],Ae,Pt.vertexOffset,ot,ht,xt),mt.drawElements(G,Pt.primitiveLength*Tt,mt.UNSIGNED_SHORT,Pt.primitiveOffset*Tt*2)}}}function is(oe,t,G){const J=1/R.aB(G,1,t.transform.tileZoom),te=Math.pow(2,G.tileID.overscaledZ),se=G.tileSize*Math.pow(2,t.transform.tileZoom)/te,de=se*(G.tileID.canonical.x+G.tileID.wrap*te),_e=se*G.tileID.canonical.y;return{u_image:0,u_texsize:G.imageAtlasTexture.size,u_scale:[J,oe.fromScale,oe.toScale],u_fade:oe.t,u_pixel_coord_upper:[de>>16,_e>>16],u_pixel_coord_lower:[65535&de,65535&_e]}}const vo=(oe,t,G,J)=>{const te=oe.style.light,se=te.properties.get("position"),de=[se.x,se.y,se.z],_e=R.bU();te.properties.get("anchor")==="viewport"&&R.bV(_e,oe.transform.bearingInRadians),R.bW(de,de,_e);const ge=oe.transform.transformLightDirection(de),xe=te.properties.get("color");return{u_lightpos:de,u_lightpos_globe:ge,u_lightintensity:te.properties.get("intensity"),u_lightcolor:[xe.r,xe.g,xe.b],u_vertical_gradient:+t,u_opacity:G,u_fill_translate:J}},tu=(oe,t,G,J,te,se,de)=>R.e(vo(oe,t,G,J),is(se,oe,de),{u_height_factor:-Math.pow(2,te.overscaledZ)/de.tileSize/8}),ns=(oe,t,G,J)=>R.e(is(t,oe,G),{u_fill_translate:J}),Un=(oe,t)=>({u_world:oe,u_fill_translate:t}),bc=(oe,t,G,J,te)=>R.e(ns(oe,t,G,te),{u_world:J}),ru=(oe,t,G,J,te)=>{const se=oe.transform;let de,_e,ge=0;if(G.paint.get("circle-pitch-alignment")==="map"){const xe=R.aB(t,1,se.zoom);de=!0,_e=[xe,xe],ge=xe/(R.$*Math.pow(2,t.tileID.overscaledZ))*2*Math.PI*te}else de=!1,_e=se.pixelsToGLUnits;return{u_camera_to_center_distance:se.cameraToCenterDistance,u_scale_with_map:+(G.paint.get("circle-pitch-scale")==="map"),u_pitch_with_map:+de,u_device_pixel_ratio:oe.pixelRatio,u_extrude_scale:_e,u_globe_extrude_scale:ge,u_translate:J}},bo=oe=>({u_pixel_extrude_scale:[1/oe.width,1/oe.height]}),xo=oe=>({u_viewport_size:[oe.width,oe.height]}),dl=(oe,t=1)=>({u_color:oe,u_overlay:0,u_overlay_scale:t}),wo=(oe,t,G,J)=>{const te=R.aB(oe,1,t)/(R.$*Math.pow(2,oe.tileID.overscaledZ))*2*Math.PI*J;return{u_extrude_scale:R.aB(oe,1,t),u_intensity:G,u_globe_extrude_scale:te}},fl=(oe,t,G,J)=>{const te=R.L();R.bX(te,0,oe.width,oe.height,0,0,1);const se=oe.context.gl;return{u_matrix:te,u_world:[se.drawingBufferWidth,se.drawingBufferHeight],u_image:G,u_color_ramp:J,u_opacity:t.paint.get("heatmap-opacity")}},Na=(oe,t,G)=>{const J=G.paint.get("hillshade-accent-color");let te;switch(G.paint.get("hillshade-method")){case"basic":te=4;break;case"combined":te=1;break;case"igor":te=2;break;case"multidirectional":te=3;break;default:te=0}const se=G.getIlluminationProperties();for(let de=0;de<se.directionRadians.length;de++)G.paint.get("hillshade-illumination-anchor")==="viewport"&&(se.directionRadians[de]+=oe.transform.bearingInRadians);return{u_image:0,u_latrange:pl(0,t.tileID),u_exaggeration:G.paint.get("hillshade-exaggeration"),u_altitudes:se.altitudeRadians,u_azimuths:se.directionRadians,u_accent:J,u_method:te,u_highlights:se.highlightColor,u_shadows:se.shadowColor}},xc=(oe,t)=>{const G=t.stride,J=R.L();return R.bX(J,0,R.$,-R.$,0,0,1),R.M(J,J,[0,-R.$,0]),{u_matrix:J,u_image:1,u_dimension:[G,G],u_zoom:oe.overscaledZ,u_unpack:t.getUnpackVector()}};function pl(oe,t){const G=Math.pow(2,t.canonical.z),J=t.canonical.y;return[new R.a0(0,J/G).toLngLat().lat,new R.a0(0,(J+1)/G).toLngLat().lat]}const wc=(oe,t,G=0)=>({u_image:0,u_unpack:t.getUnpackVector(),u_dimension:[t.stride,t.stride],u_elevation_stops:1,u_color_stops:4,u_color_ramp_size:G,u_opacity:oe.paint.get("color-relief-opacity")}),as=(oe,t,G,J)=>{const te=oe.transform;return{u_translation:au(oe,t,G),u_ratio:J/R.aB(t,1,te.zoom),u_device_pixel_ratio:oe.pixelRatio,u_units_to_pixels:[1/te.pixelsToGLUnits[0],1/te.pixelsToGLUnits[1]]}},iu=(oe,t,G,J,te)=>R.e(as(oe,t,G,J),{u_image:0,u_image_height:te}),_l=(oe,t,G,J,te)=>{const se=oe.transform,de=nu(t,se);return{u_translation:au(oe,t,G),u_texsize:t.imageAtlasTexture.size,u_ratio:J/R.aB(t,1,se.zoom),u_device_pixel_ratio:oe.pixelRatio,u_image:0,u_scale:[de,te.fromScale,te.toScale],u_fade:te.t,u_units_to_pixels:[1/se.pixelsToGLUnits[0],1/se.pixelsToGLUnits[1]]}},ml=(oe,t,G,J,te,se)=>{const de=oe.lineAtlas,_e=nu(t,oe.transform),ge=G.layout.get("line-cap")==="round",xe=de.getDash(te.from,ge),Se=de.getDash(te.to,ge),Oe=xe.width*se.fromScale,Ae=Se.width*se.toScale;return R.e(as(oe,t,G,J),{u_patternscale_a:[_e/Oe,-xe.height/2],u_patternscale_b:[_e/Ae,-Se.height/2],u_sdfgamma:de.width/(256*Math.min(Oe,Ae)*oe.pixelRatio)/2,u_image:0,u_tex_y_a:xe.y,u_tex_y_b:Se.y,u_mix:se.t})};function nu(oe,t){return 1/R.aB(oe,1,t.tileZoom)}function au(oe,t,G){return R.aC(oe.transform,t,G.paint.get("line-translate"),G.paint.get("line-translate-anchor"))}const xa=(oe,t,G,J,te)=>{return{u_tl_parent:oe,u_scale_parent:t,u_buffer_scale:1,u_fade_t:G.mix,u_opacity:G.opacity*J.paint.get("raster-opacity"),u_image0:0,u_image1:1,u_brightness_low:J.paint.get("raster-brightness-min"),u_brightness_high:J.paint.get("raster-brightness-max"),u_saturation_factor:(de=J.paint.get("raster-saturation"),de>0?1-1/(1.001-de):-de),u_contrast_factor:(se=J.paint.get("raster-contrast"),se>0?1/(1-se):1+se),u_spin_weights:yl(J.paint.get("raster-hue-rotate")),u_coords_top:[te[0].x,te[0].y,te[1].x,te[1].y],u_coords_bottom:[te[3].x,te[3].y,te[2].x,te[2].y]};var se,de};function yl(oe){oe*=Math.PI/180;const t=Math.sin(oe),G=Math.cos(oe);return[(2*G+1)/3,(-Math.sqrt(3)*t-G+1)/3,(Math.sqrt(3)*t-G+1)/3]}const ou=(oe,t,G,J,te,se,de,_e,ge,xe,Se,Oe,Ae)=>{const je=de.transform;return{u_is_size_zoom_constant:+(oe==="constant"||oe==="source"),u_is_size_feature_constant:+(oe==="constant"||oe==="camera"),u_size_t:t?t.uSizeT:0,u_size:t?t.uSize:0,u_camera_to_center_distance:je.cameraToCenterDistance,u_pitch:je.pitch/360*2*Math.PI,u_rotate_symbol:+G,u_aspect_ratio:je.width/je.height,u_fade_change:de.options.fadeDuration?de.symbolFadeChange:1,u_label_plane_matrix:_e,u_coord_matrix:ge,u_is_text:+Se,u_pitch_with_map:+J,u_is_along_line:te,u_is_variable_anchor:se,u_texsize:Oe,u_texture:0,u_translation:xe,u_pitched_scale:Ae}},za=(oe,t,G,J,te,se,de,_e,ge,xe,Se,Oe,Ae,je)=>{const Ye=de.transform;return R.e(ou(oe,t,G,J,te,se,de,_e,ge,xe,Se,Oe,je),{u_gamma_scale:J?Math.cos(Ye.pitch*Math.PI/180)*Ye.cameraToCenterDistance:1,u_device_pixel_ratio:de.pixelRatio,u_is_halo:1})},Sc=(oe,t,G,J,te,se,de,_e,ge,xe,Se,Oe,Ae)=>R.e(za(oe,t,G,J,te,se,de,_e,ge,xe,!0,Se,0,Ae),{u_texsize_icon:Oe,u_texture_icon:1}),os=(oe,t)=>({u_opacity:oe,u_color:t}),Ec=(oe,t,G,J,te)=>R.e(function(se,de,_e,ge){const xe=_e.imageManager.getPattern(se.from.toString()),Se=_e.imageManager.getPattern(se.to.toString()),{width:Oe,height:Ae}=_e.imageManager.getPixelSize(),je=Math.pow(2,ge.tileID.overscaledZ),Ye=ge.tileSize*Math.pow(2,_e.transform.tileZoom)/je,at=Ye*(ge.tileID.canonical.x+ge.tileID.wrap*je),nt=Ye*ge.tileID.canonical.y;return{u_image:0,u_pattern_tl_a:xe.tl,u_pattern_br_a:xe.br,u_pattern_tl_b:Se.tl,u_pattern_br_b:Se.br,u_texsize:[Oe,Ae],u_mix:de.t,u_pattern_size_a:xe.displaySize,u_pattern_size_b:Se.displaySize,u_scale_a:de.fromScale,u_scale_b:de.toScale,u_tile_units_to_pixels:1/R.aB(ge,1,_e.transform.tileZoom),u_pixel_coord_upper:[at>>16,nt>>16],u_pixel_coord_lower:[65535&at,65535&nt]}}(G,te,t,J),{u_opacity:oe}),gl=(oe,t)=>{},vl={fillExtrusion:(oe,t)=>({u_lightpos:new R.bS(oe,t.u_lightpos),u_lightpos_globe:new R.bS(oe,t.u_lightpos_globe),u_lightintensity:new R.bf(oe,t.u_lightintensity),u_lightcolor:new R.bS(oe,t.u_lightcolor),u_vertical_gradient:new R.bf(oe,t.u_vertical_gradient),u_opacity:new R.bf(oe,t.u_opacity),u_fill_translate:new R.bT(oe,t.u_fill_translate)}),fillExtrusionPattern:(oe,t)=>({u_lightpos:new R.bS(oe,t.u_lightpos),u_lightpos_globe:new R.bS(oe,t.u_lightpos_globe),u_lightintensity:new R.bf(oe,t.u_lightintensity),u_lightcolor:new R.bS(oe,t.u_lightcolor),u_vertical_gradient:new R.bf(oe,t.u_vertical_gradient),u_height_factor:new R.bf(oe,t.u_height_factor),u_opacity:new R.bf(oe,t.u_opacity),u_fill_translate:new R.bT(oe,t.u_fill_translate),u_image:new R.bO(oe,t.u_image),u_texsize:new R.bT(oe,t.u_texsize),u_pixel_coord_upper:new R.bT(oe,t.u_pixel_coord_upper),u_pixel_coord_lower:new R.bT(oe,t.u_pixel_coord_lower),u_scale:new R.bS(oe,t.u_scale),u_fade:new R.bf(oe,t.u_fade)}),fill:(oe,t)=>({u_fill_translate:new R.bT(oe,t.u_fill_translate)}),fillPattern:(oe,t)=>({u_image:new R.bO(oe,t.u_image),u_texsize:new R.bT(oe,t.u_texsize),u_pixel_coord_upper:new R.bT(oe,t.u_pixel_coord_upper),u_pixel_coord_lower:new R.bT(oe,t.u_pixel_coord_lower),u_scale:new R.bS(oe,t.u_scale),u_fade:new R.bf(oe,t.u_fade),u_fill_translate:new R.bT(oe,t.u_fill_translate)}),fillOutline:(oe,t)=>({u_world:new R.bT(oe,t.u_world),u_fill_translate:new R.bT(oe,t.u_fill_translate)}),fillOutlinePattern:(oe,t)=>({u_world:new R.bT(oe,t.u_world),u_image:new R.bO(oe,t.u_image),u_texsize:new R.bT(oe,t.u_texsize),u_pixel_coord_upper:new R.bT(oe,t.u_pixel_coord_upper),u_pixel_coord_lower:new R.bT(oe,t.u_pixel_coord_lower),u_scale:new R.bS(oe,t.u_scale),u_fade:new R.bf(oe,t.u_fade),u_fill_translate:new R.bT(oe,t.u_fill_translate)}),circle:(oe,t)=>({u_camera_to_center_distance:new R.bf(oe,t.u_camera_to_center_distance),u_scale_with_map:new R.bO(oe,t.u_scale_with_map),u_pitch_with_map:new R.bO(oe,t.u_pitch_with_map),u_extrude_scale:new R.bT(oe,t.u_extrude_scale),u_device_pixel_ratio:new R.bf(oe,t.u_device_pixel_ratio),u_globe_extrude_scale:new R.bf(oe,t.u_globe_extrude_scale),u_translate:new R.bT(oe,t.u_translate)}),collisionBox:(oe,t)=>({u_pixel_extrude_scale:new R.bT(oe,t.u_pixel_extrude_scale)}),collisionCircle:(oe,t)=>({u_viewport_size:new R.bT(oe,t.u_viewport_size)}),debug:(oe,t)=>({u_color:new R.bP(oe,t.u_color),u_overlay:new R.bO(oe,t.u_overlay),u_overlay_scale:new R.bf(oe,t.u_overlay_scale)}),depth:gl,clippingMask:gl,heatmap:(oe,t)=>({u_extrude_scale:new R.bf(oe,t.u_extrude_scale),u_intensity:new R.bf(oe,t.u_intensity),u_globe_extrude_scale:new R.bf(oe,t.u_globe_extrude_scale)}),heatmapTexture:(oe,t)=>({u_matrix:new R.bQ(oe,t.u_matrix),u_world:new R.bT(oe,t.u_world),u_image:new R.bO(oe,t.u_image),u_color_ramp:new R.bO(oe,t.u_color_ramp),u_opacity:new R.bf(oe,t.u_opacity)}),hillshade:(oe,t)=>({u_image:new R.bO(oe,t.u_image),u_latrange:new R.bT(oe,t.u_latrange),u_exaggeration:new R.bf(oe,t.u_exaggeration),u_altitudes:new R.bZ(oe,t.u_altitudes),u_azimuths:new R.bZ(oe,t.u_azimuths),u_accent:new R.bP(oe,t.u_accent),u_method:new R.bO(oe,t.u_method),u_shadows:new R.bY(oe,t.u_shadows),u_highlights:new R.bY(oe,t.u_highlights)}),hillshadePrepare:(oe,t)=>({u_matrix:new R.bQ(oe,t.u_matrix),u_image:new R.bO(oe,t.u_image),u_dimension:new R.bT(oe,t.u_dimension),u_zoom:new R.bf(oe,t.u_zoom),u_unpack:new R.bR(oe,t.u_unpack)}),colorRelief:(oe,t)=>({u_image:new R.bO(oe,t.u_image),u_unpack:new R.bR(oe,t.u_unpack),u_dimension:new R.bT(oe,t.u_dimension),u_elevation_stops:new R.bO(oe,t.u_elevation_stops),u_color_stops:new R.bO(oe,t.u_color_stops),u_color_ramp_size:new R.bO(oe,t.u_color_ramp_size),u_opacity:new R.bf(oe,t.u_opacity)}),line:(oe,t)=>({u_translation:new R.bT(oe,t.u_translation),u_ratio:new R.bf(oe,t.u_ratio),u_device_pixel_ratio:new R.bf(oe,t.u_device_pixel_ratio),u_units_to_pixels:new R.bT(oe,t.u_units_to_pixels)}),lineGradient:(oe,t)=>({u_translation:new R.bT(oe,t.u_translation),u_ratio:new R.bf(oe,t.u_ratio),u_device_pixel_ratio:new R.bf(oe,t.u_device_pixel_ratio),u_units_to_pixels:new R.bT(oe,t.u_units_to_pixels),u_image:new R.bO(oe,t.u_image),u_image_height:new R.bf(oe,t.u_image_height)}),linePattern:(oe,t)=>({u_translation:new R.bT(oe,t.u_translation),u_texsize:new R.bT(oe,t.u_texsize),u_ratio:new R.bf(oe,t.u_ratio),u_device_pixel_ratio:new R.bf(oe,t.u_device_pixel_ratio),u_image:new R.bO(oe,t.u_image),u_units_to_pixels:new R.bT(oe,t.u_units_to_pixels),u_scale:new R.bS(oe,t.u_scale),u_fade:new R.bf(oe,t.u_fade)}),lineSDF:(oe,t)=>({u_translation:new R.bT(oe,t.u_translation),u_ratio:new R.bf(oe,t.u_ratio),u_device_pixel_ratio:new R.bf(oe,t.u_device_pixel_ratio),u_units_to_pixels:new R.bT(oe,t.u_units_to_pixels),u_patternscale_a:new R.bT(oe,t.u_patternscale_a),u_patternscale_b:new R.bT(oe,t.u_patternscale_b),u_sdfgamma:new R.bf(oe,t.u_sdfgamma),u_image:new R.bO(oe,t.u_image),u_tex_y_a:new R.bf(oe,t.u_tex_y_a),u_tex_y_b:new R.bf(oe,t.u_tex_y_b),u_mix:new R.bf(oe,t.u_mix)}),raster:(oe,t)=>({u_tl_parent:new R.bT(oe,t.u_tl_parent),u_scale_parent:new R.bf(oe,t.u_scale_parent),u_buffer_scale:new R.bf(oe,t.u_buffer_scale),u_fade_t:new R.bf(oe,t.u_fade_t),u_opacity:new R.bf(oe,t.u_opacity),u_image0:new R.bO(oe,t.u_image0),u_image1:new R.bO(oe,t.u_image1),u_brightness_low:new R.bf(oe,t.u_brightness_low),u_brightness_high:new R.bf(oe,t.u_brightness_high),u_saturation_factor:new R.bf(oe,t.u_saturation_factor),u_contrast_factor:new R.bf(oe,t.u_contrast_factor),u_spin_weights:new R.bS(oe,t.u_spin_weights),u_coords_top:new R.bR(oe,t.u_coords_top),u_coords_bottom:new R.bR(oe,t.u_coords_bottom)}),symbolIcon:(oe,t)=>({u_is_size_zoom_constant:new R.bO(oe,t.u_is_size_zoom_constant),u_is_size_feature_constant:new R.bO(oe,t.u_is_size_feature_constant),u_size_t:new R.bf(oe,t.u_size_t),u_size:new R.bf(oe,t.u_size),u_camera_to_center_distance:new R.bf(oe,t.u_camera_to_center_distance),u_pitch:new R.bf(oe,t.u_pitch),u_rotate_symbol:new R.bO(oe,t.u_rotate_symbol),u_aspect_ratio:new R.bf(oe,t.u_aspect_ratio),u_fade_change:new R.bf(oe,t.u_fade_change),u_label_plane_matrix:new R.bQ(oe,t.u_label_plane_matrix),u_coord_matrix:new R.bQ(oe,t.u_coord_matrix),u_is_text:new R.bO(oe,t.u_is_text),u_pitch_with_map:new R.bO(oe,t.u_pitch_with_map),u_is_along_line:new R.bO(oe,t.u_is_along_line),u_is_variable_anchor:new R.bO(oe,t.u_is_variable_anchor),u_texsize:new R.bT(oe,t.u_texsize),u_texture:new R.bO(oe,t.u_texture),u_translation:new R.bT(oe,t.u_translation),u_pitched_scale:new R.bf(oe,t.u_pitched_scale)}),symbolSDF:(oe,t)=>({u_is_size_zoom_constant:new R.bO(oe,t.u_is_size_zoom_constant),u_is_size_feature_constant:new R.bO(oe,t.u_is_size_feature_constant),u_size_t:new R.bf(oe,t.u_size_t),u_size:new R.bf(oe,t.u_size),u_camera_to_center_distance:new R.bf(oe,t.u_camera_to_center_distance),u_pitch:new R.bf(oe,t.u_pitch),u_rotate_symbol:new R.bO(oe,t.u_rotate_symbol),u_aspect_ratio:new R.bf(oe,t.u_aspect_ratio),u_fade_change:new R.bf(oe,t.u_fade_change),u_label_plane_matrix:new R.bQ(oe,t.u_label_plane_matrix),u_coord_matrix:new R.bQ(oe,t.u_coord_matrix),u_is_text:new R.bO(oe,t.u_is_text),u_pitch_with_map:new R.bO(oe,t.u_pitch_with_map),u_is_along_line:new R.bO(oe,t.u_is_along_line),u_is_variable_anchor:new R.bO(oe,t.u_is_variable_anchor),u_texsize:new R.bT(oe,t.u_texsize),u_texture:new R.bO(oe,t.u_texture),u_gamma_scale:new R.bf(oe,t.u_gamma_scale),u_device_pixel_ratio:new R.bf(oe,t.u_device_pixel_ratio),u_is_halo:new R.bO(oe,t.u_is_halo),u_translation:new R.bT(oe,t.u_translation),u_pitched_scale:new R.bf(oe,t.u_pitched_scale)}),symbolTextAndIcon:(oe,t)=>({u_is_size_zoom_constant:new R.bO(oe,t.u_is_size_zoom_constant),u_is_size_feature_constant:new R.bO(oe,t.u_is_size_feature_constant),u_size_t:new R.bf(oe,t.u_size_t),u_size:new R.bf(oe,t.u_size),u_camera_to_center_distance:new R.bf(oe,t.u_camera_to_center_distance),u_pitch:new R.bf(oe,t.u_pitch),u_rotate_symbol:new R.bO(oe,t.u_rotate_symbol),u_aspect_ratio:new R.bf(oe,t.u_aspect_ratio),u_fade_change:new R.bf(oe,t.u_fade_change),u_label_plane_matrix:new R.bQ(oe,t.u_label_plane_matrix),u_coord_matrix:new R.bQ(oe,t.u_coord_matrix),u_is_text:new R.bO(oe,t.u_is_text),u_pitch_with_map:new R.bO(oe,t.u_pitch_with_map),u_is_along_line:new R.bO(oe,t.u_is_along_line),u_is_variable_anchor:new R.bO(oe,t.u_is_variable_anchor),u_texsize:new R.bT(oe,t.u_texsize),u_texsize_icon:new R.bT(oe,t.u_texsize_icon),u_texture:new R.bO(oe,t.u_texture),u_texture_icon:new R.bO(oe,t.u_texture_icon),u_gamma_scale:new R.bf(oe,t.u_gamma_scale),u_device_pixel_ratio:new R.bf(oe,t.u_device_pixel_ratio),u_is_halo:new R.bO(oe,t.u_is_halo),u_translation:new R.bT(oe,t.u_translation),u_pitched_scale:new R.bf(oe,t.u_pitched_scale)}),background:(oe,t)=>({u_opacity:new R.bf(oe,t.u_opacity),u_color:new R.bP(oe,t.u_color)}),backgroundPattern:(oe,t)=>({u_opacity:new R.bf(oe,t.u_opacity),u_image:new R.bO(oe,t.u_image),u_pattern_tl_a:new R.bT(oe,t.u_pattern_tl_a),u_pattern_br_a:new R.bT(oe,t.u_pattern_br_a),u_pattern_tl_b:new R.bT(oe,t.u_pattern_tl_b),u_pattern_br_b:new R.bT(oe,t.u_pattern_br_b),u_texsize:new R.bT(oe,t.u_texsize),u_mix:new R.bf(oe,t.u_mix),u_pattern_size_a:new R.bT(oe,t.u_pattern_size_a),u_pattern_size_b:new R.bT(oe,t.u_pattern_size_b),u_scale_a:new R.bf(oe,t.u_scale_a),u_scale_b:new R.bf(oe,t.u_scale_b),u_pixel_coord_upper:new R.bT(oe,t.u_pixel_coord_upper),u_pixel_coord_lower:new R.bT(oe,t.u_pixel_coord_lower),u_tile_units_to_pixels:new R.bf(oe,t.u_tile_units_to_pixels)}),terrain:(oe,t)=>({u_texture:new R.bO(oe,t.u_texture),u_ele_delta:new R.bf(oe,t.u_ele_delta),u_fog_matrix:new R.bQ(oe,t.u_fog_matrix),u_fog_color:new R.bP(oe,t.u_fog_color),u_fog_ground_blend:new R.bf(oe,t.u_fog_ground_blend),u_fog_ground_blend_opacity:new R.bf(oe,t.u_fog_ground_blend_opacity),u_horizon_color:new R.bP(oe,t.u_horizon_color),u_horizon_fog_blend:new R.bf(oe,t.u_horizon_fog_blend),u_is_globe_mode:new R.bf(oe,t.u_is_globe_mode)}),terrainDepth:(oe,t)=>({u_ele_delta:new R.bf(oe,t.u_ele_delta)}),terrainCoords:(oe,t)=>({u_texture:new R.bO(oe,t.u_texture),u_terrain_coords_id:new R.bf(oe,t.u_terrain_coords_id),u_ele_delta:new R.bf(oe,t.u_ele_delta)}),projectionErrorMeasurement:(oe,t)=>({u_input:new R.bf(oe,t.u_input),u_output_expected:new R.bf(oe,t.u_output_expected)}),atmosphere:(oe,t)=>({u_sun_pos:new R.bS(oe,t.u_sun_pos),u_atmosphere_blend:new R.bf(oe,t.u_atmosphere_blend),u_globe_position:new R.bS(oe,t.u_globe_position),u_globe_radius:new R.bf(oe,t.u_globe_radius),u_inv_proj_matrix:new R.bQ(oe,t.u_inv_proj_matrix)}),sky:(oe,t)=>({u_sky_color:new R.bP(oe,t.u_sky_color),u_horizon_color:new R.bP(oe,t.u_horizon_color),u_horizon:new R.bT(oe,t.u_horizon),u_horizon_normal:new R.bT(oe,t.u_horizon_normal),u_sky_horizon_blend:new R.bf(oe,t.u_sky_horizon_blend),u_sky_blend:new R.bf(oe,t.u_sky_blend)})};class bl{constructor(t,G,J){this.context=t;const te=t.gl;this.buffer=te.createBuffer(),this.dynamicDraw=!!J,this.context.unbindVAO(),t.bindElementBuffer.set(this.buffer),te.bufferData(te.ELEMENT_ARRAY_BUFFER,G.arrayBuffer,this.dynamicDraw?te.DYNAMIC_DRAW:te.STATIC_DRAW),this.dynamicDraw||delete G.arrayBuffer}bind(){this.context.bindElementBuffer.set(this.buffer)}updateData(t){const G=this.context.gl;if(!this.dynamicDraw)throw new Error("Attempted to update data while not in dynamic mode.");this.context.unbindVAO(),this.bind(),G.bufferSubData(G.ELEMENT_ARRAY_BUFFER,0,t.arrayBuffer)}destroy(){this.buffer&&(this.context.gl.deleteBuffer(this.buffer),delete this.buffer)}}const xl={Int8:"BYTE",Uint8:"UNSIGNED_BYTE",Int16:"SHORT",Uint16:"UNSIGNED_SHORT",Int32:"INT",Uint32:"UNSIGNED_INT",Float32:"FLOAT"};class su{constructor(t,G,J,te){this.length=G.length,this.attributes=J,this.itemSize=G.bytesPerElement,this.dynamicDraw=te,this.context=t;const se=t.gl;this.buffer=se.createBuffer(),t.bindVertexBuffer.set(this.buffer),se.bufferData(se.ARRAY_BUFFER,G.arrayBuffer,this.dynamicDraw?se.DYNAMIC_DRAW:se.STATIC_DRAW),this.dynamicDraw||delete G.arrayBuffer}bind(){this.context.bindVertexBuffer.set(this.buffer)}updateData(t){if(t.length!==this.length)throw new Error(`Length of new data is ${t.length}, which doesn't match current length of ${this.length}`);const G=this.context.gl;this.bind(),G.bufferSubData(G.ARRAY_BUFFER,0,t.arrayBuffer)}enableAttributes(t,G){for(let J=0;J<this.attributes.length;J++){const te=G.attributes[this.attributes[J].name];te!==void 0&&t.enableVertexAttribArray(te)}}setVertexAttribPointers(t,G,J){for(let te=0;te<this.attributes.length;te++){const se=this.attributes[te],de=G.attributes[se.name];de!==void 0&&t.vertexAttribPointer(de,se.components,t[xl[se.type]],!1,this.itemSize,se.offset+this.itemSize*(J||0))}}destroy(){this.buffer&&(this.context.gl.deleteBuffer(this.buffer),delete this.buffer)}}class hi{constructor(t){this.gl=t.gl,this.default=this.getDefault(),this.current=this.default,this.dirty=!1}get(){return this.current}set(t){}getDefault(){return this.default}setDefault(){this.set(this.default)}}class ss extends hi{getDefault(){return R.be.transparent}set(t){const G=this.current;(t.r!==G.r||t.g!==G.g||t.b!==G.b||t.a!==G.a||this.dirty)&&(this.gl.clearColor(t.r,t.g,t.b,t.a),this.current=t,this.dirty=!1)}}class Kn extends hi{getDefault(){return 1}set(t){(t!==this.current||this.dirty)&&(this.gl.clearDepth(t),this.current=t,this.dirty=!1)}}class uu extends hi{getDefault(){return 0}set(t){(t!==this.current||this.dirty)&&(this.gl.clearStencil(t),this.current=t,this.dirty=!1)}}class lu extends hi{getDefault(){return[!0,!0,!0,!0]}set(t){const G=this.current;(t[0]!==G[0]||t[1]!==G[1]||t[2]!==G[2]||t[3]!==G[3]||this.dirty)&&(this.gl.colorMask(t[0],t[1],t[2],t[3]),this.current=t,this.dirty=!1)}}class cu extends hi{getDefault(){return!0}set(t){(t!==this.current||this.dirty)&&(this.gl.depthMask(t),this.current=t,this.dirty=!1)}}class wl extends hi{getDefault(){return 255}set(t){(t!==this.current||this.dirty)&&(this.gl.stencilMask(t),this.current=t,this.dirty=!1)}}class hu extends hi{getDefault(){return{func:this.gl.ALWAYS,ref:0,mask:255}}set(t){const G=this.current;(t.func!==G.func||t.ref!==G.ref||t.mask!==G.mask||this.dirty)&&(this.gl.stencilFunc(t.func,t.ref,t.mask),this.current=t,this.dirty=!1)}}class wa extends hi{getDefault(){const t=this.gl;return[t.KEEP,t.KEEP,t.KEEP]}set(t){const G=this.current;(t[0]!==G[0]||t[1]!==G[1]||t[2]!==G[2]||this.dirty)&&(this.gl.stencilOp(t[0],t[1],t[2]),this.current=t,this.dirty=!1)}}class du extends hi{getDefault(){return!1}set(t){if(t===this.current&&!this.dirty)return;const G=this.gl;t?G.enable(G.STENCIL_TEST):G.disable(G.STENCIL_TEST),this.current=t,this.dirty=!1}}class qc extends hi{getDefault(){return[0,1]}set(t){const G=this.current;(t[0]!==G[0]||t[1]!==G[1]||this.dirty)&&(this.gl.depthRange(t[0],t[1]),this.current=t,this.dirty=!1)}}class Tc extends hi{getDefault(){return!1}set(t){if(t===this.current&&!this.dirty)return;const G=this.gl;t?G.enable(G.DEPTH_TEST):G.disable(G.DEPTH_TEST),this.current=t,this.dirty=!1}}class Ic extends hi{getDefault(){return this.gl.LESS}set(t){(t!==this.current||this.dirty)&&(this.gl.depthFunc(t),this.current=t,this.dirty=!1)}}class Rc extends hi{getDefault(){return!1}set(t){if(t===this.current&&!this.dirty)return;const G=this.gl;t?G.enable(G.BLEND):G.disable(G.BLEND),this.current=t,this.dirty=!1}}class Sl extends hi{getDefault(){const t=this.gl;return[t.ONE,t.ZERO]}set(t){const G=this.current;(t[0]!==G[0]||t[1]!==G[1]||this.dirty)&&(this.gl.blendFunc(t[0],t[1]),this.current=t,this.dirty=!1)}}class Ac extends hi{getDefault(){return R.be.transparent}set(t){const G=this.current;(t.r!==G.r||t.g!==G.g||t.b!==G.b||t.a!==G.a||this.dirty)&&(this.gl.blendColor(t.r,t.g,t.b,t.a),this.current=t,this.dirty=!1)}}class El extends hi{getDefault(){return this.gl.FUNC_ADD}set(t){(t!==this.current||this.dirty)&&(this.gl.blendEquation(t),this.current=t,this.dirty=!1)}}class us extends hi{getDefault(){return!1}set(t){if(t===this.current&&!this.dirty)return;const G=this.gl;t?G.enable(G.CULL_FACE):G.disable(G.CULL_FACE),this.current=t,this.dirty=!1}}class ls extends hi{getDefault(){return this.gl.BACK}set(t){(t!==this.current||this.dirty)&&(this.gl.cullFace(t),this.current=t,this.dirty=!1)}}class cs extends hi{getDefault(){return this.gl.CCW}set(t){(t!==this.current||this.dirty)&&(this.gl.frontFace(t),this.current=t,this.dirty=!1)}}class fu extends hi{getDefault(){return null}set(t){(t!==this.current||this.dirty)&&(this.gl.useProgram(t),this.current=t,this.dirty=!1)}}class Sa extends hi{getDefault(){return this.gl.TEXTURE0}set(t){(t!==this.current||this.dirty)&&(this.gl.activeTexture(t),this.current=t,this.dirty=!1)}}class So extends hi{getDefault(){const t=this.gl;return[0,0,t.drawingBufferWidth,t.drawingBufferHeight]}set(t){const G=this.current;(t[0]!==G[0]||t[1]!==G[1]||t[2]!==G[2]||t[3]!==G[3]||this.dirty)&&(this.gl.viewport(t[0],t[1],t[2],t[3]),this.current=t,this.dirty=!1)}}class Ua extends hi{getDefault(){return null}set(t){if(t===this.current&&!this.dirty)return;const G=this.gl;G.bindFramebuffer(G.FRAMEBUFFER,t),this.current=t,this.dirty=!1}}class An extends hi{getDefault(){return null}set(t){if(t===this.current&&!this.dirty)return;const G=this.gl;G.bindRenderbuffer(G.RENDERBUFFER,t),this.current=t,this.dirty=!1}}class ql extends hi{getDefault(){return null}set(t){if(t===this.current&&!this.dirty)return;const G=this.gl;G.bindTexture(G.TEXTURE_2D,t),this.current=t,this.dirty=!1}}class Tl extends hi{getDefault(){return null}set(t){if(t===this.current&&!this.dirty)return;const G=this.gl;G.bindBuffer(G.ARRAY_BUFFER,t),this.current=t,this.dirty=!1}}class pu extends hi{getDefault(){return null}set(t){const G=this.gl;G.bindBuffer(G.ELEMENT_ARRAY_BUFFER,t),this.current=t,this.dirty=!1}}class Ea extends hi{getDefault(){return null}set(t){var G;if(t===this.current&&!this.dirty)return;const J=this.gl;hn(J)?J.bindVertexArray(t):(G=J.getExtension("OES_vertex_array_object"))===null||G===void 0||G.bindVertexArrayOES(t),this.current=t,this.dirty=!1}}class hs extends hi{getDefault(){return 4}set(t){if(t===this.current&&!this.dirty)return;const G=this.gl;G.pixelStorei(G.UNPACK_ALIGNMENT,t),this.current=t,this.dirty=!1}}class ds extends hi{getDefault(){return!1}set(t){if(t===this.current&&!this.dirty)return;const G=this.gl;G.pixelStorei(G.UNPACK_PREMULTIPLY_ALPHA_WEBGL,t),this.current=t,this.dirty=!1}}class Eo extends hi{getDefault(){return!1}set(t){if(t===this.current&&!this.dirty)return;const G=this.gl;G.pixelStorei(G.UNPACK_FLIP_Y_WEBGL,t),this.current=t,this.dirty=!1}}class Ga extends hi{constructor(t,G){super(t),this.context=t,this.parent=G}getDefault(){return null}}class Il extends Ga{setDirty(){this.dirty=!0}set(t){if(t===this.current&&!this.dirty)return;this.context.bindFramebuffer.set(this.parent);const G=this.gl;G.framebufferTexture2D(G.FRAMEBUFFER,G.COLOR_ATTACHMENT0,G.TEXTURE_2D,t,0),this.current=t,this.dirty=!1}}class Va extends Ga{set(t){if(t===this.current&&!this.dirty)return;this.context.bindFramebuffer.set(this.parent);const G=this.gl;G.framebufferRenderbuffer(G.FRAMEBUFFER,G.DEPTH_ATTACHMENT,G.RENDERBUFFER,t),this.current=t,this.dirty=!1}}class $a extends Ga{set(t){if(t===this.current&&!this.dirty)return;this.context.bindFramebuffer.set(this.parent);const G=this.gl;G.framebufferRenderbuffer(G.FRAMEBUFFER,G.DEPTH_STENCIL_ATTACHMENT,G.RENDERBUFFER,t),this.current=t,this.dirty=!1}}const _u="Framebuffer is not complete";class mu{constructor(t,G,J,te,se){this.context=t,this.width=G,this.height=J;const de=t.gl,_e=this.framebuffer=de.createFramebuffer();if(this.colorAttachment=new Il(t,_e),te)this.depthAttachment=se?new $a(t,_e):new Va(t,_e);else if(se)throw new Error("Stencil cannot be set without depth");if(de.checkFramebufferStatus(de.FRAMEBUFFER)!==de.FRAMEBUFFER_COMPLETE)throw new Error(_u)}destroy(){const t=this.context.gl,G=this.colorAttachment.get();if(G&&t.deleteTexture(G),this.depthAttachment){const J=this.depthAttachment.get();J&&t.deleteRenderbuffer(J)}t.deleteFramebuffer(this.framebuffer)}}class ai{constructor(t){var G,J;if(this.gl=t,this.clearColor=new ss(this),this.clearDepth=new Kn(this),this.clearStencil=new uu(this),this.colorMask=new lu(this),this.depthMask=new cu(this),this.stencilMask=new wl(this),this.stencilFunc=new hu(this),this.stencilOp=new wa(this),this.stencilTest=new du(this),this.depthRange=new qc(this),this.depthTest=new Tc(this),this.depthFunc=new Ic(this),this.blend=new Rc(this),this.blendFunc=new Sl(this),this.blendColor=new Ac(this),this.blendEquation=new El(this),this.cullFace=new us(this),this.cullFaceSide=new ls(this),this.frontFace=new cs(this),this.program=new fu(this),this.activeTexture=new Sa(this),this.viewport=new So(this),this.bindFramebuffer=new Ua(this),this.bindRenderbuffer=new An(this),this.bindTexture=new ql(this),this.bindVertexBuffer=new Tl(this),this.bindElementBuffer=new pu(this),this.bindVertexArray=new Ea(this),this.pixelStoreUnpack=new hs(this),this.pixelStoreUnpackPremultiplyAlpha=new ds(this),this.pixelStoreUnpackFlipY=new Eo(this),this.extTextureFilterAnisotropic=t.getExtension("EXT_texture_filter_anisotropic")||t.getExtension("MOZ_EXT_texture_filter_anisotropic")||t.getExtension("WEBKIT_EXT_texture_filter_anisotropic"),this.extTextureFilterAnisotropic&&(this.extTextureFilterAnisotropicMax=t.getParameter(this.extTextureFilterAnisotropic.MAX_TEXTURE_MAX_ANISOTROPY_EXT)),this.maxTextureSize=t.getParameter(t.MAX_TEXTURE_SIZE),hn(t)){this.HALF_FLOAT=t.HALF_FLOAT;const te=t.getExtension("EXT_color_buffer_half_float");this.RGBA16F=(G=t.RGBA16F)!==null&&G!==void 0?G:te==null?void 0:te.RGBA16F_EXT,this.RGB16F=(J=t.RGB16F)!==null&&J!==void 0?J:te==null?void 0:te.RGB16F_EXT,t.getExtension("EXT_color_buffer_float")}else{t.getExtension("EXT_color_buffer_half_float"),t.getExtension("OES_texture_half_float_linear");const te=t.getExtension("OES_texture_half_float");this.HALF_FLOAT=te==null?void 0:te.HALF_FLOAT_OES}}setDefault(){this.unbindVAO(),this.clearColor.setDefault(),this.clearDepth.setDefault(),this.clearStencil.setDefault(),this.colorMask.setDefault(),this.depthMask.setDefault(),this.stencilMask.setDefault(),this.stencilFunc.setDefault(),this.stencilOp.setDefault(),this.stencilTest.setDefault(),this.depthRange.setDefault(),this.depthTest.setDefault(),this.depthFunc.setDefault(),this.blend.setDefault(),this.blendFunc.setDefault(),this.blendColor.setDefault(),this.blendEquation.setDefault(),this.cullFace.setDefault(),this.cullFaceSide.setDefault(),this.frontFace.setDefault(),this.program.setDefault(),this.activeTexture.setDefault(),this.bindFramebuffer.setDefault(),this.pixelStoreUnpack.setDefault(),this.pixelStoreUnpackPremultiplyAlpha.setDefault(),this.pixelStoreUnpackFlipY.setDefault()}setDirty(){this.clearColor.dirty=!0,this.clearDepth.dirty=!0,this.clearStencil.dirty=!0,this.colorMask.dirty=!0,this.depthMask.dirty=!0,this.stencilMask.dirty=!0,this.stencilFunc.dirty=!0,this.stencilOp.dirty=!0,this.stencilTest.dirty=!0,this.depthRange.dirty=!0,this.depthTest.dirty=!0,this.depthFunc.dirty=!0,this.blend.dirty=!0,this.blendFunc.dirty=!0,this.blendColor.dirty=!0,this.blendEquation.dirty=!0,this.cullFace.dirty=!0,this.cullFaceSide.dirty=!0,this.frontFace.dirty=!0,this.program.dirty=!0,this.activeTexture.dirty=!0,this.viewport.dirty=!0,this.bindFramebuffer.dirty=!0,this.bindRenderbuffer.dirty=!0,this.bindTexture.dirty=!0,this.bindVertexBuffer.dirty=!0,this.bindElementBuffer.dirty=!0,this.bindVertexArray.dirty=!0,this.pixelStoreUnpack.dirty=!0,this.pixelStoreUnpackPremultiplyAlpha.dirty=!0,this.pixelStoreUnpackFlipY.dirty=!0}createIndexBuffer(t,G){return new bl(this,t,G)}createVertexBuffer(t,G,J){return new su(this,t,G,J)}createRenderbuffer(t,G,J){const te=this.gl,se=te.createRenderbuffer();return this.bindRenderbuffer.set(se),te.renderbufferStorage(te.RENDERBUFFER,t,G,J),this.bindRenderbuffer.set(null),se}createFramebuffer(t,G,J,te){return new mu(this,t,G,J,te)}clear({color:t,depth:G,stencil:J}){const te=this.gl;let se=0;t&&(se|=te.COLOR_BUFFER_BIT,this.clearColor.set(t),this.colorMask.set([!0,!0,!0,!0])),G!==void 0&&(se|=te.DEPTH_BUFFER_BIT,this.depthRange.set([0,1]),this.clearDepth.set(G),this.depthMask.set(!0)),J!==void 0&&(se|=te.STENCIL_BUFFER_BIT,this.clearStencil.set(J),this.stencilMask.set(255)),te.clear(se)}setCullFace(t){t.enable===!1?this.cullFace.set(!1):(this.cullFace.set(!0),this.cullFaceSide.set(t.mode),this.frontFace.set(t.frontFace))}setDepthMode(t){t.func!==this.gl.ALWAYS||t.mask?(this.depthTest.set(!0),this.depthFunc.set(t.func),this.depthMask.set(t.mask),this.depthRange.set(t.range)):this.depthTest.set(!1)}setStencilMode(t){t.test.func!==this.gl.ALWAYS||t.mask?(this.stencilTest.set(!0),this.stencilMask.set(t.mask),this.stencilOp.set([t.fail,t.depthFail,t.pass]),this.stencilFunc.set({func:t.test.func,ref:t.ref,mask:t.test.mask})):this.stencilTest.set(!1)}setColorMode(t){R.bG(t.blendFunction,ui.Replace)?this.blend.set(!1):(this.blend.set(!0),this.blendFunc.set(t.blendFunction),this.blendColor.set(t.blendColor)),this.colorMask.set(t.mask)}createVertexArray(){var t;return hn(this.gl)?this.gl.createVertexArray():(t=this.gl.getExtension("OES_vertex_array_object"))===null||t===void 0?void 0:t.createVertexArrayOES()}deleteVertexArray(t){var G;return hn(this.gl)?this.gl.deleteVertexArray(t):(G=this.gl.getExtension("OES_vertex_array_object"))===null||G===void 0?void 0:G.deleteVertexArrayOES(t)}unbindVAO(){this.bindVertexArray.set(null)}}let qa;function Rl(oe,t,G,J,te){const se=oe.context,de=oe.transform,_e=se.gl,ge=oe.useProgram("collisionBox"),xe=[];let Se=0,Oe=0;for(let ot=0;ot<J.length;ot++){const ht=J[ot],xt=t.getTile(ht).getBucket(G);if(!xt)continue;const mt=te?xt.textCollisionBox:xt.iconCollisionBox,Tt=xt.collisionCircleArray;Tt.length>0&&(xe.push({circleArray:Tt,circleOffset:Oe,coord:ht}),Se+=Tt.length/4,Oe=Se),mt&&ge.draw(se,_e.LINES,ei.disabled,$r.disabled,oe.colorModeForRenderPass(),Xr.disabled,bo(oe.transform),oe.style.map.terrain&&oe.style.map.terrain.getTerrainData(ht),de.getProjectionData({overscaledTileID:ht,applyGlobeMatrix:!0,applyTerrainMatrix:!0}),G.id,mt.layoutVertexBuffer,mt.indexBuffer,mt.segments,null,oe.transform.zoom,null,null,mt.collisionVertexBuffer)}if(!te||!xe.length)return;const Ae=oe.useProgram("collisionCircle"),je=new R.b_;je.resize(4*Se),je._trim();let Ye=0;for(const ot of xe)for(let ht=0;ht<ot.circleArray.length/4;ht++){const xt=4*ht,mt=ot.circleArray[xt+0],Tt=ot.circleArray[xt+1],Pt=ot.circleArray[xt+2],vt=ot.circleArray[xt+3];je.emplace(Ye++,mt,Tt,Pt,vt,0),je.emplace(Ye++,mt,Tt,Pt,vt,1),je.emplace(Ye++,mt,Tt,Pt,vt,2),je.emplace(Ye++,mt,Tt,Pt,vt,3)}(!qa||qa.length<2*Se)&&(qa=function(ot){const ht=2*ot,xt=new R.c0;xt.resize(ht),xt._trim();for(let mt=0;mt<ht;mt++){const Tt=6*mt;xt.uint16[Tt+0]=4*mt+0,xt.uint16[Tt+1]=4*mt+1,xt.uint16[Tt+2]=4*mt+2,xt.uint16[Tt+3]=4*mt+2,xt.uint16[Tt+4]=4*mt+3,xt.uint16[Tt+5]=4*mt+0}return xt}(Se));const at=se.createIndexBuffer(qa,!0),nt=se.createVertexBuffer(je,R.b$.members,!0);for(const ot of xe){const ht=xo(oe.transform);Ae.draw(se,_e.TRIANGLES,ei.disabled,$r.disabled,oe.colorModeForRenderPass(),Xr.disabled,ht,oe.style.map.terrain&&oe.style.map.terrain.getTerrainData(ot.coord),null,G.id,nt,at,R.aL.simpleSegment(0,2*ot.circleOffset,ot.circleArray.length,ot.circleArray.length/2),null,oe.transform.zoom,null,null,null)}nt.destroy(),at.destroy()}const Al=R.af(new Float32Array(16));function qo(oe,t,G,J,te,se){const{horizontalAlign:de,verticalAlign:_e}=R.aG(oe);return new R.P((-(de-.5)*t/te+J[0])*se,(-(_e-.5)*G/te+J[1])*se)}function Pc(oe,t,G,J,te,se){const de=t.tileAnchorPoint.add(new R.P(t.translation[0],t.translation[1]));if(t.pitchWithMap){let _e=J.mult(se);G||(_e=_e.rotate(-te));const ge=de.add(_e);return Yr(ge.x,ge.y,t.pitchedLabelPlaneMatrix,t.getElevation).point}if(G){const _e=pr(t.tileAnchorPoint.x+1,t.tileAnchorPoint.y,t).point.sub(oe),ge=Math.atan(_e.y/_e.x)+(_e.x<0?Math.PI:0);return oe.add(J.rotate(ge))}return oe.add(J)}function Oc(oe,t,G,J,te,se,de,_e,ge,xe,Se,Oe){const Ae=oe.text.placedSymbolArray,je=oe.text.dynamicLayoutVertexArray,Ye=oe.icon.dynamicLayoutVertexArray,at={};je.clear();for(let nt=0;nt<Ae.length;nt++){const ot=Ae.get(nt),ht=ot.hidden||!ot.crossTileID||oe.allowVerticalPlacement&&!ot.placedOrientation?null:J[ot.crossTileID];if(ht){const xt=new R.P(ot.anchorX,ot.anchorY),mt={getElevation:Oe,width:te.width,height:te.height,pitchedLabelPlaneMatrix:se,pitchWithMap:G,transform:te,tileAnchorPoint:xt,translation:xe,unwrappedTileID:Se},Tt=G?Yt(xt.x,xt.y,mt):pr(xt.x,xt.y,mt),Pt=jr(te.cameraToCenterDistance,Tt.signedDistanceFromCamera);let vt=R.ao(oe.textSizeData,_e,ot)*Pt/R.aA;G&&(vt*=oe.tilePixelRatio/de);const{width:kt,height:Vt,anchor:jt,textOffset:zt,textBoxScale:$t}=ht,mr=qo(jt,kt,Vt,zt,$t,vt),_r=te.getPitchedTextCorrection(xt.x+xe[0],xt.y+xe[1],Se),er=Pc(Tt.point,mt,t,mr,-te.bearingInRadians,_r),Ar=oe.allowVerticalPlacement&&ot.placedOrientation===R.an.vertical?Math.PI/2:0;for(let ti=0;ti<ot.numGlyphs;ti++)R.au(je,er,Ar);ge&&ot.associatedIconIndex>=0&&(at[ot.associatedIconIndex]={shiftedAnchor:er,angle:Ar})}else Mr(ot.numGlyphs,je)}if(ge){Ye.clear();const nt=oe.icon.placedSymbolArray;for(let ot=0;ot<nt.length;ot++){const ht=nt.get(ot);if(ht.hidden)Mr(ht.numGlyphs,Ye);else{const xt=at[ot];if(xt)for(let mt=0;mt<ht.numGlyphs;mt++)R.au(Ye,xt.shiftedAnchor,xt.angle);else Mr(ht.numGlyphs,Ye)}}oe.icon.dynamicLayoutVertexBuffer.updateData(Ye)}oe.text.dynamicLayoutVertexBuffer.updateData(je)}function Pl(oe,t,G){return G.iconsInText&&t?"symbolTextAndIcon":oe?"symbolSDF":"symbolIcon"}function Ol(oe,t,G,J,te,se,de,_e,ge,xe,Se,Oe,Ae){const je=oe.context,Ye=je.gl,at=oe.transform,nt=_e==="map",ot=ge==="map",ht=_e!=="viewport"&&G.layout.get("symbol-placement")!=="point",xt=nt&&!ot&&!ht,mt=!G.layout.get("symbol-sort-key").isConstant();let Tt=!1;const Pt=oe.getDepthModeForSublayer(0,ei.ReadOnly),vt=G._unevaluatedLayout.hasValue("text-variable-anchor")||G._unevaluatedLayout.hasValue("text-variable-anchor-offset"),kt=[],Vt=at.getCircleRadiusCorrection();for(const jt of J){const zt=t.getTile(jt),$t=zt.getBucket(G);if(!$t)continue;const mr=te?$t.text:$t.icon;if(!mr||!mr.segments.get().length||!mr.hasVisibleVertices)continue;const _r=mr.programConfigurations.get(G.id),er=te||$t.sdfIcons,Ar=te?$t.textSizeData:$t.iconSizeData,ti=ot||at.pitch!==0,di=oe.useProgram(Pl(er,te,$t),_r),Ri=R.am(Ar,at.zoom),_i=oe.style.map.terrain&&oe.style.map.terrain.getTerrainData(jt);let Ai,gi,mi,vi,en=[0,0],li=null;if(te)gi=zt.glyphAtlasTexture,mi=Ye.LINEAR,Ai=zt.glyphAtlasTexture.size,$t.iconsInText&&(en=zt.imageAtlasTexture.size,li=zt.imageAtlasTexture,vi=ti||oe.options.rotating||oe.options.zooming||Ar.kind==="composite"||Ar.kind==="camera"?Ye.LINEAR:Ye.NEAREST);else{const ki=G.layout.get("icon-size").constantOr(0)!==1||$t.iconsNeedLinear;gi=zt.imageAtlasTexture,mi=er||oe.options.rotating||oe.options.zooming||ki||ti?Ye.LINEAR:Ye.NEAREST,Ai=zt.imageAtlasTexture.size}const Hi=R.aB(zt,1,oe.transform.zoom),tn=Gr(nt,oe.transform,Hi),ha=R.L();R.ap(ha,tn);const da=ci(ot,nt,oe.transform,Hi),fa=R.aC(at,zt,se,de),$n=at.getProjectionData({overscaledTileID:jt,applyGlobeMatrix:!Ae,applyTerrainMatrix:!0}),jo=vt&&$t.hasTextData(),No=G.layout.get("icon-text-fit")!=="none"&&jo&&$t.hasIconData();if(ht){const ki=oe.style.map.terrain?(_n,zi)=>oe.style.map.terrain.getElevation(jt,_n,zi):null,xi=G.layout.get("text-rotation-alignment")==="map";fi($t,oe,te,tn,ha,ot,xe,xi,jt.toUnwrapped(),at.width,at.height,fa,ki)}const io=te&&vt||No,wn=ht||io?Al:ot?tn:oe.transform.clipSpaceToPixelsMatrix,Fn=er&&G.paint.get(te?"text-halo-width":"icon-halo-width").constantOr(1)!==0;let pa;pa=er?$t.iconsInText?Sc(Ar.kind,Ri,xt,ot,ht,io,oe,wn,da,fa,Ai,en,Vt):za(Ar.kind,Ri,xt,ot,ht,io,oe,wn,da,fa,te,Ai,0,Vt):ou(Ar.kind,Ri,xt,ot,ht,io,oe,wn,da,fa,te,Ai,Vt);const Ra={program:di,buffers:mr,uniformValues:pa,projectionData:$n,atlasTexture:gi,atlasTextureIcon:li,atlasInterpolation:mi,atlasInterpolationIcon:vi,isSDF:er,hasHalo:Fn};if(mt&&$t.canOverlap){Tt=!0;const ki=mr.segments.get();for(const xi of ki)kt.push({segments:new R.aL([xi]),sortKey:xi.sortKey,state:Ra,terrainData:_i})}else kt.push({segments:mr.segments,sortKey:0,state:Ra,terrainData:_i})}Tt&&kt.sort((jt,zt)=>jt.sortKey-zt.sortKey);for(const jt of kt){const zt=jt.state;if(je.activeTexture.set(Ye.TEXTURE0),zt.atlasTexture.bind(zt.atlasInterpolation,Ye.CLAMP_TO_EDGE),zt.atlasTextureIcon&&(je.activeTexture.set(Ye.TEXTURE1),zt.atlasTextureIcon&&zt.atlasTextureIcon.bind(zt.atlasInterpolationIcon,Ye.CLAMP_TO_EDGE)),zt.isSDF){const $t=zt.uniformValues;zt.hasHalo&&($t.u_is_halo=1,fs(zt.buffers,jt.segments,G,oe,zt.program,Pt,Se,Oe,$t,zt.projectionData,jt.terrainData)),$t.u_is_halo=0}fs(zt.buffers,jt.segments,G,oe,zt.program,Pt,Se,Oe,zt.uniformValues,zt.projectionData,jt.terrainData)}}function fs(oe,t,G,J,te,se,de,_e,ge,xe,Se){const Oe=J.context;te.draw(Oe,Oe.gl.TRIANGLES,se,de,_e,Xr.backCCW,ge,Se,xe,G.id,oe.layoutVertexBuffer,oe.indexBuffer,t,G.paint,J.transform.zoom,oe.programConfigurations.get(G.id),oe.dynamicLayoutVertexBuffer,oe.opacityVertexBuffer)}function ps(oe,t,G,J,te){const se=oe.context,de=se.gl,_e=$r.disabled,ge=new ui([de.ONE,de.ONE],R.be.transparent,[!0,!0,!0,!0]),xe=t.getBucket(G);if(!xe)return;const Se=J.key;let Oe=G.heatmapFbos.get(Se);Oe||(Oe=To(se,t.tileSize,t.tileSize),G.heatmapFbos.set(Se,Oe)),se.bindFramebuffer.set(Oe.framebuffer),se.viewport.set([0,0,t.tileSize,t.tileSize]),se.clear({color:R.be.transparent});const Ae=xe.programConfigurations.get(G.id),je=oe.useProgram("heatmap",Ae,!te),Ye=oe.transform.getProjectionData({overscaledTileID:t.tileID,applyGlobeMatrix:!0,applyTerrainMatrix:!0}),at=oe.style.map.terrain.getTerrainData(J);je.draw(se,de.TRIANGLES,ei.disabled,_e,ge,Xr.disabled,wo(t,oe.transform.zoom,G.paint.get("heatmap-intensity"),1),at,Ye,G.id,xe.layoutVertexBuffer,xe.indexBuffer,xe.segments,G.paint,oe.transform.zoom,Ae)}function _s(oe,t,G,J,te){const se=oe.context,de=se.gl,_e=oe.transform;se.setColorMode(oe.colorModeForRenderPass());const ge=ys(se,t),xe=G.key,Se=t.heatmapFbos.get(xe);if(!Se)return;se.activeTexture.set(de.TEXTURE0),de.bindTexture(de.TEXTURE_2D,Se.colorAttachment.get()),se.activeTexture.set(de.TEXTURE1),ge.bind(de.LINEAR,de.CLAMP_TO_EDGE);const Oe=_e.getProjectionData({overscaledTileID:G,applyTerrainMatrix:te,applyGlobeMatrix:!J});oe.useProgram("heatmapTexture").draw(se,de.TRIANGLES,ei.disabled,$r.disabled,oe.colorModeForRenderPass(),Xr.disabled,fl(oe,t,0,1),null,Oe,t.id,oe.rasterBoundsBuffer,oe.quadTriangleIndexBuffer,oe.rasterBoundsSegments,t.paint,_e.zoom),Se.destroy(),t.heatmapFbos.delete(xe)}function To(oe,t,G){var J,te;const se=oe.gl,de=se.createTexture();se.bindTexture(se.TEXTURE_2D,de),se.texParameteri(se.TEXTURE_2D,se.TEXTURE_WRAP_S,se.CLAMP_TO_EDGE),se.texParameteri(se.TEXTURE_2D,se.TEXTURE_WRAP_T,se.CLAMP_TO_EDGE),se.texParameteri(se.TEXTURE_2D,se.TEXTURE_MIN_FILTER,se.LINEAR),se.texParameteri(se.TEXTURE_2D,se.TEXTURE_MAG_FILTER,se.LINEAR);const _e=(J=oe.HALF_FLOAT)!==null&&J!==void 0?J:se.UNSIGNED_BYTE,ge=(te=oe.RGBA16F)!==null&&te!==void 0?te:se.RGBA;se.texImage2D(se.TEXTURE_2D,0,ge,t,G,0,se.RGBA,_e,null);const xe=oe.createFramebuffer(t,G,!1,!1);return xe.colorAttachment.set(de),xe}function ys(oe,t){return t.colorRampTexture||(t.colorRampTexture=new R.T(oe,t.colorRamp,oe.gl.RGBA)),t.colorRampTexture}function yu(oe,t,G,J,te){if(!G||!J||!J.imageAtlas)return;const se=J.imageAtlas.patternPositions;let de=se[G.to.toString()],_e=se[G.from.toString()];if(!de&&_e&&(de=_e),!_e&&de&&(_e=de),!de||!_e){const ge=te.getPaintProperty(t);de=se[ge],_e=se[ge]}de&&_e&&oe.setConstantPatternPositions(de,_e)}function Io(oe,t,G,J,te,se,de,_e){const ge=oe.context.gl,xe="fill-pattern",Se=G.paint.get(xe),Oe=Se&&Se.constantOr(1),Ae=G.getCrossfadeParameters();let je,Ye,at,nt,ot;const ht=oe.transform,xt=G.paint.get("fill-translate"),mt=G.paint.get("fill-translate-anchor");de?(Ye=Oe&&!G.getPaintProperty("fill-outline-color")?"fillOutlinePattern":"fillOutline",je=ge.LINES):(Ye=Oe?"fillPattern":"fill",je=ge.TRIANGLES);const Tt=Se.constantOr(null);for(const Pt of J){const vt=t.getTile(Pt);if(Oe&&!vt.patternsLoaded())continue;const kt=vt.getBucket(G);if(!kt)continue;const Vt=kt.programConfigurations.get(G.id),jt=oe.useProgram(Ye,Vt),zt=oe.style.map.terrain&&oe.style.map.terrain.getTerrainData(Pt);Oe&&(oe.context.activeTexture.set(ge.TEXTURE0),vt.imageAtlasTexture.bind(ge.LINEAR,ge.CLAMP_TO_EDGE),Vt.updatePaintBuffers(Ae)),yu(Vt,xe,Tt,vt,G);const $t=ht.getProjectionData({overscaledTileID:Pt,applyGlobeMatrix:!_e,applyTerrainMatrix:!0}),mr=R.aC(ht,vt,xt,mt);if(de){nt=kt.indexBuffer2,ot=kt.segments2;const er=[ge.drawingBufferWidth,ge.drawingBufferHeight];at=Ye==="fillOutlinePattern"&&Oe?bc(oe,Ae,vt,er,mr):Un(er,mr)}else nt=kt.indexBuffer,ot=kt.segments,at=Oe?ns(oe,Ae,vt,mr):{u_fill_translate:mr};const _r=oe.stencilModeForClipping(Pt);jt.draw(oe.context,je,te,_r,se,Xr.backCCW,at,zt,$t,G.id,kt.layoutVertexBuffer,nt,ot,G.paint,oe.transform.zoom,Vt)}}function Wa(oe,t,G,J,te,se,de,_e){const ge=oe.context,xe=ge.gl,Se="fill-extrusion-pattern",Oe=G.paint.get(Se),Ae=Oe.constantOr(1),je=G.getCrossfadeParameters(),Ye=G.paint.get("fill-extrusion-opacity"),at=Oe.constantOr(null),nt=oe.transform;for(const ot of J){const ht=t.getTile(ot),xt=ht.getBucket(G);if(!xt)continue;const mt=oe.style.map.terrain&&oe.style.map.terrain.getTerrainData(ot),Tt=xt.programConfigurations.get(G.id),Pt=oe.useProgram(Ae?"fillExtrusionPattern":"fillExtrusion",Tt);Ae&&(oe.context.activeTexture.set(xe.TEXTURE0),ht.imageAtlasTexture.bind(xe.LINEAR,xe.CLAMP_TO_EDGE),Tt.updatePaintBuffers(je));const vt=nt.getProjectionData({overscaledTileID:ot,applyGlobeMatrix:!_e,applyTerrainMatrix:!0});yu(Tt,Se,at,ht,G);const kt=R.aC(nt,ht,G.paint.get("fill-extrusion-translate"),G.paint.get("fill-extrusion-translate-anchor")),Vt=G.paint.get("fill-extrusion-vertical-gradient"),jt=Ae?tu(oe,Vt,Ye,kt,ot,je,ht):vo(oe,Vt,Ye,kt);Pt.draw(ge,ge.gl.TRIANGLES,te,se,de,Xr.backCCW,jt,mt,vt,G.id,xt.layoutVertexBuffer,xt.indexBuffer,xt.segments,G.paint,oe.transform.zoom,Tt,oe.style.map.terrain&&xt.centroidVertexBuffer)}}function Ha(oe,t,G,J,te,se,de,_e,ge){var xe;const Se=oe.style.projection,Oe=oe.context,Ae=oe.transform,je=Oe.gl,Ye=[`#define NUM_ILLUMINATION_SOURCES ${G.paint.get("hillshade-highlight-color").values.length}`],at=oe.useProgram("hillshade",null,!1,Ye),nt=!oe.options.moving;for(const ot of J){const ht=t.getTile(ot),xt=ht.fbo;if(!xt)continue;const mt=Se.getMeshFromTileID(Oe,ot.canonical,_e,!0,"raster"),Tt=(xe=oe.style.map.terrain)===null||xe===void 0?void 0:xe.getTerrainData(ot);Oe.activeTexture.set(je.TEXTURE0),je.bindTexture(je.TEXTURE_2D,xt.colorAttachment.get());const Pt=Ae.getProjectionData({overscaledTileID:ot,aligned:nt,applyGlobeMatrix:!ge,applyTerrainMatrix:!0});at.draw(Oe,je.TRIANGLES,se,te[ot.overscaledZ],de,Xr.backCCW,Na(oe,ht,G),Tt,Pt,G.id,mt.vertexBuffer,mt.indexBuffer,mt.segments)}}function Ro(oe,t,G,J,te,se,de,_e,ge){var xe;const Se=oe.style.projection,Oe=oe.context,Ae=oe.transform,je=Oe.gl,Ye=oe.useProgram("colorRelief"),at=!oe.options.moving;let nt=!0,ot=0;for(const ht of J){const xt=t.getTile(ht),mt=xt.dem;if(nt){const jt=je.getParameter(je.MAX_TEXTURE_SIZE),{elevationTexture:zt,colorTexture:$t}=G.getColorRampTextures(Oe,jt,mt.getUnpackVector());Oe.activeTexture.set(je.TEXTURE1),zt.bind(je.NEAREST,je.CLAMP_TO_EDGE),Oe.activeTexture.set(je.TEXTURE4),$t.bind(je.LINEAR,je.CLAMP_TO_EDGE),nt=!1,ot=zt.size[0]}if(!mt||!mt.data)continue;const Tt=mt.stride,Pt=mt.getPixels();if(Oe.activeTexture.set(je.TEXTURE0),Oe.pixelStoreUnpackPremultiplyAlpha.set(!1),xt.demTexture=xt.demTexture||oe.getTileTexture(Tt),xt.demTexture){const jt=xt.demTexture;jt.update(Pt,{premultiply:!1}),jt.bind(je.LINEAR,je.CLAMP_TO_EDGE)}else xt.demTexture=new R.T(Oe,Pt,je.RGBA,{premultiply:!1}),xt.demTexture.bind(je.LINEAR,je.CLAMP_TO_EDGE);const vt=Se.getMeshFromTileID(Oe,ht.canonical,_e,!0,"raster"),kt=(xe=oe.style.map.terrain)===null||xe===void 0?void 0:xe.getTerrainData(ht),Vt=Ae.getProjectionData({overscaledTileID:ht,aligned:at,applyGlobeMatrix:!ge,applyTerrainMatrix:!0});Ye.draw(Oe,je.TRIANGLES,se,te[ht.overscaledZ],de,Xr.backCCW,wc(G,xt.dem,ot),kt,Vt,G.id,vt.vertexBuffer,vt.indexBuffer,vt.segments)}}const gu=[new R.P(0,0),new R.P(R.$,0),new R.P(R.$,R.$),new R.P(0,R.$)];function oa(oe,t,G,J,te,se,de,_e,ge=!1,xe=!1){const Se=J[J.length-1].overscaledZ,Oe=oe.context,Ae=Oe.gl,je=oe.useProgram("raster"),Ye=oe.transform,at=oe.style.projection,nt=oe.colorModeForRenderPass(),ot=!oe.options.moving;for(const ht of J){const xt=oe.getDepthModeForSublayer(ht.overscaledZ-Se,G.paint.get("raster-opacity")===1?ei.ReadWrite:ei.ReadOnly,Ae.LESS),mt=t.getTile(ht);mt.registerFadeDuration(G.paint.get("raster-fade-duration"));const Tt=t.findLoadedParent(ht,0),Pt=t.findLoadedSibling(ht),vt=Cc(mt,Tt||Pt||null,t,G,oe.transform,oe.style.map.terrain);let kt,Vt;const jt=G.paint.get("raster-resampling")==="nearest"?Ae.NEAREST:Ae.LINEAR;Oe.activeTexture.set(Ae.TEXTURE0),mt.texture.bind(jt,Ae.CLAMP_TO_EDGE,Ae.LINEAR_MIPMAP_NEAREST),Oe.activeTexture.set(Ae.TEXTURE1),Tt?(Tt.texture.bind(jt,Ae.CLAMP_TO_EDGE,Ae.LINEAR_MIPMAP_NEAREST),kt=Math.pow(2,Tt.tileID.overscaledZ-mt.tileID.overscaledZ),Vt=[mt.tileID.canonical.x*kt%1,mt.tileID.canonical.y*kt%1]):mt.texture.bind(jt,Ae.CLAMP_TO_EDGE,Ae.LINEAR_MIPMAP_NEAREST),mt.texture.useMipmap&&Oe.extTextureFilterAnisotropic&&oe.transform.pitch>20&&Ae.texParameterf(Ae.TEXTURE_2D,Oe.extTextureFilterAnisotropic.TEXTURE_MAX_ANISOTROPY_EXT,Oe.extTextureFilterAnisotropicMax);const zt=oe.style.map.terrain&&oe.style.map.terrain.getTerrainData(ht),$t=Ye.getProjectionData({overscaledTileID:ht,aligned:ot,applyGlobeMatrix:!xe,applyTerrainMatrix:!0}),mr=xa(Vt||[0,0],kt||1,vt,G,_e),_r=at.getMeshFromTileID(Oe,ht.canonical,se,de,"raster");je.draw(Oe,Ae.TRIANGLES,xt,te?te[ht.overscaledZ]:$r.disabled,nt,ge?Xr.frontCCW:Xr.backCCW,mr,zt,$t,G.id,_r.vertexBuffer,_r.indexBuffer,_r.segments)}}function Cc(oe,t,G,J,te,se){const de=J.paint.get("raster-fade-duration");if(!se&&de>0){const _e=pe.now(),ge=(_e-oe.timeAdded)/de,xe=t?(_e-t.timeAdded)/de:-1,Se=G.getSource(),Oe=bt(te,{tileSize:Se.tileSize,roundZoom:Se.roundZoom}),Ae=!t||Math.abs(t.tileID.overscaledZ-Oe)>Math.abs(oe.tileID.overscaledZ-Oe),je=Ae&&oe.refreshedUponExpiration?1:R.ag(Ae?ge:1-xe,0,1);return oe.refreshedUponExpiration&&ge>=1&&(oe.refreshedUponExpiration=!1),t?{opacity:1,mix:1-je}:{opacity:je,mix:0}}return{opacity:1,mix:0}}const Cl=new R.be(1,0,0,1),gs=new R.be(0,1,0,1),vu=new R.be(0,0,1,1),Ml=new R.be(1,0,1,1),Dl=new R.be(0,1,1,1);function Ao(oe,t,G,J){bs(oe,0,t+G/2,oe.transform.width,G,J)}function vs(oe,t,G,J){bs(oe,t-G/2,0,G,oe.transform.height,J)}function bs(oe,t,G,J,te,se){const de=oe.context,_e=de.gl;_e.enable(_e.SCISSOR_TEST),_e.scissor(t*oe.pixelRatio,G*oe.pixelRatio,J*oe.pixelRatio,te*oe.pixelRatio),de.clear({color:se}),_e.disable(_e.SCISSOR_TEST)}function Fl(oe,t,G){const J=oe.context,te=J.gl,se=oe.useProgram("debug"),de=ei.disabled,_e=$r.disabled,ge=oe.colorModeForRenderPass(),xe="$debug",Se=oe.style.map.terrain&&oe.style.map.terrain.getTerrainData(G);J.activeTexture.set(te.TEXTURE0);const Oe=t.getTileByID(G.key).latestRawTileData,Ae=Math.floor((Oe&&Oe.byteLength||0)/1024),je=t.getTile(G).tileSize,Ye=512/Math.min(je,512)*(G.overscaledZ/oe.transform.zoom)*.5;let at=G.canonical.toString();G.overscaledZ!==G.canonical.z&&(at+=` => ${G.overscaledZ}`),function(ot,ht){ot.initDebugOverlayCanvas();const xt=ot.debugOverlayCanvas,mt=ot.context.gl,Tt=ot.debugOverlayCanvas.getContext("2d");Tt.clearRect(0,0,xt.width,xt.height),Tt.shadowColor="white",Tt.shadowBlur=2,Tt.lineWidth=1.5,Tt.strokeStyle="white",Tt.textBaseline="top",Tt.font="bold 36px Open Sans, sans-serif",Tt.fillText(ht,5,5),Tt.strokeText(ht,5,5),ot.debugOverlayTexture.update(xt),ot.debugOverlayTexture.bind(mt.LINEAR,mt.CLAMP_TO_EDGE)}(oe,`${at} ${Ae}kB`);const nt=oe.transform.getProjectionData({overscaledTileID:G,applyGlobeMatrix:!0,applyTerrainMatrix:!0});se.draw(J,te.TRIANGLES,de,_e,ui.alphaBlended,Xr.disabled,dl(R.be.transparent,Ye),null,nt,xe,oe.debugBuffer,oe.quadTriangleIndexBuffer,oe.debugSegments),se.draw(J,te.LINE_STRIP,de,_e,ge,Xr.disabled,dl(R.be.red),Se,nt,xe,oe.debugBuffer,oe.tileBorderIndexBuffer,oe.debugSegments)}function Mi(oe,t,G,J){const{isRenderingGlobe:te}=J,se=oe.context,de=se.gl,_e=oe.transform,ge=oe.colorModeForRenderPass(),xe=oe.getDepthModeFor3D(),Se=oe.useProgram("terrain");se.bindFramebuffer.set(null),se.viewport.set([0,0,oe.width,oe.height]);for(const Oe of G){const Ae=t.getTerrainMesh(Oe.tileID),je=oe.renderToTexture.getTexture(Oe),Ye=t.getTerrainData(Oe.tileID);se.activeTexture.set(de.TEXTURE0),de.bindTexture(de.TEXTURE_2D,je.texture);const at=t.getMeshFrameDelta(_e.zoom),nt=_e.calculateFogMatrix(Oe.tileID.toUnwrapped()),ot=gc(at,nt,oe.style.sky,_e.pitch,te),ht=_e.getProjectionData({overscaledTileID:Oe.tileID,applyTerrainMatrix:!1,applyGlobeMatrix:!0});Se.draw(se,de.TRIANGLES,xe,$r.disabled,ge,Xr.backCCW,ot,Ye,ht,"terrain",Ae.vertexBuffer,Ae.indexBuffer,Ae.segments)}}function sa(oe,t){if(!t.mesh){const G=new R.aK;G.emplaceBack(-1,-1),G.emplaceBack(1,-1),G.emplaceBack(1,1),G.emplaceBack(-1,1);const J=new R.aM;J.emplaceBack(0,1,2),J.emplaceBack(0,2,3),t.mesh=new Wn(oe.createVertexBuffer(G,Hn.members),oe.createIndexBuffer(J),R.aL.simpleSegment(0,0,G.length,J.length))}return t.mesh}class Pn{constructor(t,G){this.context=new ai(t),this.transform=G,this._tileTextures={},this.terrainFacilitator={dirty:!0,matrix:R.af(new Float64Array(16)),renderTime:0},this.setup(),this.numSublayers=Nt.maxUnderzooming+Nt.maxOverzooming+1,this.depthEpsilon=1/Math.pow(2,16),this.crossTileSymbolIndex=new Xo}resize(t,G,J){if(this.width=Math.floor(t*J),this.height=Math.floor(G*J),this.pixelRatio=J,this.context.viewport.set([0,0,this.width,this.height]),this.style)for(const te of this.style._order)this.style._layers[te].resize()}setup(){const t=this.context,G=new R.aK;G.emplaceBack(0,0),G.emplaceBack(R.$,0),G.emplaceBack(0,R.$),G.emplaceBack(R.$,R.$),this.tileExtentBuffer=t.createVertexBuffer(G,Hn.members),this.tileExtentSegments=R.aL.simpleSegment(0,0,4,2);const J=new R.aK;J.emplaceBack(0,0),J.emplaceBack(R.$,0),J.emplaceBack(0,R.$),J.emplaceBack(R.$,R.$),this.debugBuffer=t.createVertexBuffer(J,Hn.members),this.debugSegments=R.aL.simpleSegment(0,0,4,5);const te=new R.c5;te.emplaceBack(0,0,0,0),te.emplaceBack(R.$,0,R.$,0),te.emplaceBack(0,R.$,0,R.$),te.emplaceBack(R.$,R.$,R.$,R.$),this.rasterBoundsBuffer=t.createVertexBuffer(te,mc.members),this.rasterBoundsSegments=R.aL.simpleSegment(0,0,4,2);const se=new R.aK;se.emplaceBack(0,0),se.emplaceBack(R.$,0),se.emplaceBack(0,R.$),se.emplaceBack(R.$,R.$),this.rasterBoundsBufferPosOnly=t.createVertexBuffer(se,Hn.members),this.rasterBoundsSegmentsPosOnly=R.aL.simpleSegment(0,0,4,5);const de=new R.aK;de.emplaceBack(0,0),de.emplaceBack(1,0),de.emplaceBack(0,1),de.emplaceBack(1,1),this.viewportBuffer=t.createVertexBuffer(de,Hn.members),this.viewportSegments=R.aL.simpleSegment(0,0,4,2);const _e=new R.c6;_e.emplaceBack(0),_e.emplaceBack(1),_e.emplaceBack(3),_e.emplaceBack(2),_e.emplaceBack(0),this.tileBorderIndexBuffer=t.createIndexBuffer(_e);const ge=new R.aM;ge.emplaceBack(1,0,2),ge.emplaceBack(1,2,3),this.quadTriangleIndexBuffer=t.createIndexBuffer(ge);const xe=this.context.gl;this.stencilClearMode=new $r({func:xe.ALWAYS,mask:0},0,255,xe.ZERO,xe.ZERO,xe.ZERO),this.tileExtentMesh=new Wn(this.tileExtentBuffer,this.quadTriangleIndexBuffer,this.tileExtentSegments)}clearStencil(){const t=this.context,G=t.gl;this.nextStencilID=1,this.currentStencilSource=void 0;const J=R.L();R.bX(J,0,this.width,this.height,0,0,1),R.N(J,J,[G.drawingBufferWidth,G.drawingBufferHeight,0]);const te={mainMatrix:J,tileMercatorCoords:[0,0,1,1],clippingPlane:[0,0,0,0],projectionTransition:0,fallbackMatrix:J};this.useProgram("clippingMask",null,!0).draw(t,G.TRIANGLES,ei.disabled,this.stencilClearMode,ui.disabled,Xr.disabled,null,null,te,"$clipping",this.viewportBuffer,this.quadTriangleIndexBuffer,this.viewportSegments)}_renderTileClippingMasks(t,G,J){if(this.currentStencilSource===t.source||!t.isTileClipped()||!G||!G.length)return;this.currentStencilSource=t.source,this.nextStencilID+G.length>256&&this.clearStencil();const te=this.context;te.setColorMode(ui.disabled),te.setDepthMode(ei.disabled);const se={};for(const de of G)se[de.key]=this.nextStencilID++;this._renderTileMasks(se,G,J,!0),this._renderTileMasks(se,G,J,!1),this._tileClippingMaskIDs=se}_renderTileMasks(t,G,J,te){const se=this.context,de=se.gl,_e=this.style.projection,ge=this.transform,xe=this.useProgram("clippingMask");for(const Se of G){const Oe=t[Se.key],Ae=this.style.map.terrain&&this.style.map.terrain.getTerrainData(Se),je=_e.getMeshFromTileID(this.context,Se.canonical,te,!0,"stencil"),Ye=ge.getProjectionData({overscaledTileID:Se,applyGlobeMatrix:!J,applyTerrainMatrix:!0});xe.draw(se,de.TRIANGLES,ei.disabled,new $r({func:de.ALWAYS,mask:0},Oe,255,de.KEEP,de.KEEP,de.REPLACE),ui.disabled,J?Xr.disabled:Xr.backCCW,null,Ae,Ye,"$clipping",je.vertexBuffer,je.indexBuffer,je.segments)}}_renderTilesDepthBuffer(){const t=this.context,G=t.gl,J=this.style.projection,te=this.transform,se=this.useProgram("depth"),de=this.getDepthModeFor3D(),_e=Mt(te,{tileSize:te.tileSize});for(const ge of _e){const xe=this.style.map.terrain&&this.style.map.terrain.getTerrainData(ge),Se=J.getMeshFromTileID(this.context,ge.canonical,!0,!0,"raster"),Oe=te.getProjectionData({overscaledTileID:ge,applyGlobeMatrix:!0,applyTerrainMatrix:!0});se.draw(t,G.TRIANGLES,de,$r.disabled,ui.disabled,Xr.backCCW,null,xe,Oe,"$clipping",Se.vertexBuffer,Se.indexBuffer,Se.segments)}}stencilModeFor3D(){this.currentStencilSource=void 0,this.nextStencilID+1>256&&this.clearStencil();const t=this.nextStencilID++,G=this.context.gl;return new $r({func:G.NOTEQUAL,mask:255},t,255,G.KEEP,G.KEEP,G.REPLACE)}stencilModeForClipping(t){const G=this.context.gl;return new $r({func:G.EQUAL,mask:255},this._tileClippingMaskIDs[t.key],0,G.KEEP,G.KEEP,G.REPLACE)}getStencilConfigForOverlapAndUpdateStencilID(t){const G=this.context.gl,J=t.sort((de,_e)=>_e.overscaledZ-de.overscaledZ),te=J[J.length-1].overscaledZ,se=J[0].overscaledZ-te+1;if(se>1){this.currentStencilSource=void 0,this.nextStencilID+se>256&&this.clearStencil();const de={};for(let _e=0;_e<se;_e++)de[_e+te]=new $r({func:G.GEQUAL,mask:255},_e+this.nextStencilID,255,G.KEEP,G.KEEP,G.REPLACE);return this.nextStencilID+=se,[de,J]}return[{[te]:$r.disabled},J]}stencilConfigForOverlapTwoPass(t){const G=this.context.gl,J=t.sort((de,_e)=>_e.overscaledZ-de.overscaledZ),te=J[J.length-1].overscaledZ,se=J[0].overscaledZ-te+1;if(this.clearStencil(),se>1){const de={},_e={};for(let ge=0;ge<se;ge++)de[ge+te]=new $r({func:G.GREATER,mask:255},se+1+ge,255,G.KEEP,G.KEEP,G.REPLACE),_e[ge+te]=new $r({func:G.GREATER,mask:255},1+ge,255,G.KEEP,G.KEEP,G.REPLACE);return this.nextStencilID=2*se+1,[de,_e,J]}return this.nextStencilID=3,[{[te]:new $r({func:G.GREATER,mask:255},2,255,G.KEEP,G.KEEP,G.REPLACE)},{[te]:new $r({func:G.GREATER,mask:255},1,255,G.KEEP,G.KEEP,G.REPLACE)},J]}colorModeForRenderPass(){const t=this.context.gl;return this._showOverdrawInspector?new ui([t.CONSTANT_COLOR,t.ONE],new R.be(.125,.125,.125,0),[!0,!0,!0,!0]):this.renderPass==="opaque"?ui.unblended:ui.alphaBlended}getDepthModeForSublayer(t,G,J){if(!this.opaquePassEnabledForLayer())return ei.disabled;const te=1-((1+this.currentLayer)*this.numSublayers+t)*this.depthEpsilon;return new ei(J||this.context.gl.LEQUAL,G,[te,te])}getDepthModeFor3D(){return new ei(this.context.gl.LEQUAL,ei.ReadWrite,this.depthRangeFor3D)}opaquePassEnabledForLayer(){return this.currentLayer<this.opaquePassCutoff}render(t,G){var J,te;this.style=t,this.options=G,this.lineAtlas=t.lineAtlas,this.imageManager=t.imageManager,this.glyphManager=t.glyphManager,this.symbolFadeChange=t.placement.symbolFadeChange(pe.now()),this.imageManager.beginFrame();const se=this.style._order,de=this.style.sourceCaches,_e={},ge={},xe={},Se={isRenderingToTexture:!1,isRenderingGlobe:((J=t.projection)===null||J===void 0?void 0:J.transitionState)>0};for(const Ae in de){const je=de[Ae];je.used&&je.prepare(this.context),_e[Ae]=je.getVisibleCoordinates(!1),ge[Ae]=_e[Ae].slice().reverse(),xe[Ae]=je.getVisibleCoordinates(!0).reverse()}this.opaquePassCutoff=1/0;for(let Ae=0;Ae<se.length;Ae++)if(this.style._layers[se[Ae]].is3D()){this.opaquePassCutoff=Ae;break}this.maybeDrawDepthAndCoords(!1),this.renderToTexture&&(this.renderToTexture.prepareForRender(this.style,this.transform.zoom),this.opaquePassCutoff=0),this.renderPass="offscreen";for(const Ae of se){const je=this.style._layers[Ae];if(!je.hasOffscreenPass()||je.isHidden(this.transform.zoom))continue;const Ye=ge[je.source];(je.type==="custom"||Ye.length)&&this.renderLayer(this,de[je.source],je,Ye,Se)}if((te=this.style.projection)===null||te===void 0||te.updateGPUdependent({context:this.context,useProgram:Ae=>this.useProgram(Ae)}),this.context.viewport.set([0,0,this.width,this.height]),this.context.bindFramebuffer.set(null),this.context.clear({color:G.showOverdrawInspector?R.be.black:R.be.transparent,depth:1}),this.clearStencil(),this.style.sky&&function(Ae,je){const Ye=Ae.context,at=Ye.gl,nt=((Pt,vt,kt)=>{const Vt=Math.cos(vt.rollInRadians),jt=Math.sin(vt.rollInRadians),zt=De(vt),$t=vt.getProjectionData({overscaledTileID:null,applyGlobeMatrix:!0,applyTerrainMatrix:!0}).projectionTransition;return{u_sky_color:Pt.properties.get("sky-color"),u_horizon_color:Pt.properties.get("horizon-color"),u_horizon:[(vt.width/2-zt*jt)*kt,(vt.height/2+zt*Vt)*kt],u_horizon_normal:[-jt,Vt],u_sky_horizon_blend:Pt.properties.get("sky-horizon-blend")*vt.height/2*kt,u_sky_blend:$t}})(je,Ae.style.map.transform,Ae.pixelRatio),ot=new ei(at.LEQUAL,ei.ReadWrite,[0,1]),ht=$r.disabled,xt=Ae.colorModeForRenderPass(),mt=Ae.useProgram("sky"),Tt=sa(Ye,je);mt.draw(Ye,at.TRIANGLES,ot,ht,xt,Xr.disabled,nt,null,void 0,"sky",Tt.vertexBuffer,Tt.indexBuffer,Tt.segments)}(this,this.style.sky),this._showOverdrawInspector=G.showOverdrawInspector,this.depthRangeFor3D=[0,1-(t._order.length+2)*this.numSublayers*this.depthEpsilon],!this.renderToTexture)for(this.renderPass="opaque",this.currentLayer=se.length-1;this.currentLayer>=0;this.currentLayer--){const Ae=this.style._layers[se[this.currentLayer]],je=de[Ae.source],Ye=_e[Ae.source];this._renderTileClippingMasks(Ae,Ye,!1),this.renderLayer(this,je,Ae,Ye,Se)}this.renderPass="translucent";let Oe=!1;for(this.currentLayer=0;this.currentLayer<se.length;this.currentLayer++){const Ae=this.style._layers[se[this.currentLayer]],je=de[Ae.source];if(this.renderToTexture&&this.renderToTexture.renderLayer(Ae,Se))continue;this.opaquePassEnabledForLayer()||Oe||(Oe=!0,Se.isRenderingGlobe&&!this.style.map.terrain&&this._renderTilesDepthBuffer());const Ye=(Ae.type==="symbol"?xe:ge)[Ae.source];this._renderTileClippingMasks(Ae,_e[Ae.source],!!this.renderToTexture),this.renderLayer(this,je,Ae,Ye,Se)}if(Se.isRenderingGlobe&&function(Ae,je,Ye){const at=Ae.context,nt=at.gl,ot=Ae.useProgram("atmosphere"),ht=new ei(nt.LEQUAL,ei.ReadOnly,[0,1]),xt=Ae.transform,mt=function($t,mr){const _r=$t.properties.get("position"),er=[-_r.x,-_r.y,-_r.z],Ar=R.af(new Float64Array(16));return $t.properties.get("anchor")==="map"&&(R.b5(Ar,Ar,mr.rollInRadians),R.b6(Ar,Ar,-mr.pitchInRadians),R.b5(Ar,Ar,mr.bearingInRadians),R.b6(Ar,Ar,mr.center.lat*Math.PI/180),R.by(Ar,Ar,-mr.center.lng*Math.PI/180)),R.c4(er,er,Ar),er}(Ye,Ae.transform),Tt=xt.getProjectionData({overscaledTileID:null,applyGlobeMatrix:!0,applyTerrainMatrix:!0}),Pt=je.properties.get("atmosphere-blend")*Tt.projectionTransition;if(Pt===0)return;const vt=Da(xt.worldSize,xt.center.lat),kt=xt.inverseProjectionMatrix,Vt=new Float64Array(4);Vt[3]=1,R.av(Vt,Vt,xt.modelViewProjectionMatrix),Vt[0]/=Vt[3],Vt[1]/=Vt[3],Vt[2]/=Vt[3],Vt[3]=1,R.av(Vt,Vt,kt),Vt[0]/=Vt[3],Vt[1]/=Vt[3],Vt[2]/=Vt[3],Vt[3]=1;const jt=(($t,mr,_r,er,Ar)=>({u_sun_pos:$t,u_atmosphere_blend:mr,u_globe_position:_r,u_globe_radius:er,u_inv_proj_matrix:Ar}))(mt,Pt,[Vt[0],Vt[1],Vt[2]],vt,kt),zt=sa(at,je);ot.draw(at,nt.TRIANGLES,ht,$r.disabled,ui.alphaBlended,Xr.disabled,jt,null,null,"atmosphere",zt.vertexBuffer,zt.indexBuffer,zt.segments)}(this,this.style.sky,this.style.light),this.options.showTileBoundaries){const Ae=function(je,Ye){let at=null;const nt=Object.values(je._layers).flatMap(mt=>mt.source&&!mt.isHidden(Ye)?[je.sourceCaches[mt.source]]:[]),ot=nt.filter(mt=>mt.getSource().type==="vector"),ht=nt.filter(mt=>mt.getSource().type!=="vector"),xt=mt=>{(!at||at.getSource().maxzoom<mt.getSource().maxzoom)&&(at=mt)};return ot.forEach(mt=>xt(mt)),at||ht.forEach(mt=>xt(mt)),at}(this.style,this.transform.zoom);Ae&&function(je,Ye,at){for(let nt=0;nt<at.length;nt++)Fl(je,Ye,at[nt])}(this,Ae,Ae.getVisibleCoordinates())}this.options.showPadding&&function(Ae){const je=Ae.transform.padding;Ao(Ae,Ae.transform.height-(je.top||0),3,Cl),Ao(Ae,je.bottom||0,3,gs),vs(Ae,je.left||0,3,vu),vs(Ae,Ae.transform.width-(je.right||0),3,Ml);const Ye=Ae.transform.centerPoint;(function(at,nt,ot,ht){bs(at,nt-1,ot-10,2,20,ht),bs(at,nt-10,ot-1,20,2,ht)})(Ae,Ye.x,Ae.transform.height-Ye.y,Dl)}(this),this.context.setDefault()}maybeDrawDepthAndCoords(t){if(!this.style||!this.style.map||!this.style.map.terrain)return;const G=this.terrainFacilitator.matrix,J=this.transform.modelViewProjectionMatrix;let te=this.terrainFacilitator.dirty;te||(te=t?!R.c7(G,J):!R.c8(G,J)),te||(te=this.style.map.terrain.sourceCache.anyTilesAfterTime(this.terrainFacilitator.renderTime)),te&&(R.c9(G,J),this.terrainFacilitator.renderTime=Date.now(),this.terrainFacilitator.dirty=!1,function(se,de){const _e=se.context,ge=_e.gl,xe=se.transform,Se=ui.unblended,Oe=new ei(ge.LEQUAL,ei.ReadWrite,[0,1]),Ae=de.sourceCache.getRenderableTiles(),je=se.useProgram("terrainDepth");_e.bindFramebuffer.set(de.getFramebuffer("depth").framebuffer),_e.viewport.set([0,0,se.width/devicePixelRatio,se.height/devicePixelRatio]),_e.clear({color:R.be.transparent,depth:1});for(const Ye of Ae){const at=de.getTerrainMesh(Ye.tileID),nt=de.getTerrainData(Ye.tileID),ot=xe.getProjectionData({overscaledTileID:Ye.tileID,applyTerrainMatrix:!1,applyGlobeMatrix:!0}),ht={u_ele_delta:de.getMeshFrameDelta(xe.zoom)};je.draw(_e,ge.TRIANGLES,Oe,$r.disabled,Se,Xr.backCCW,ht,nt,ot,"terrain",at.vertexBuffer,at.indexBuffer,at.segments)}_e.bindFramebuffer.set(null),_e.viewport.set([0,0,se.width,se.height])}(this,this.style.map.terrain),function(se,de){const _e=se.context,ge=_e.gl,xe=se.transform,Se=ui.unblended,Oe=new ei(ge.LEQUAL,ei.ReadWrite,[0,1]),Ae=de.getCoordsTexture(),je=de.sourceCache.getRenderableTiles(),Ye=se.useProgram("terrainCoords");_e.bindFramebuffer.set(de.getFramebuffer("coords").framebuffer),_e.viewport.set([0,0,se.width/devicePixelRatio,se.height/devicePixelRatio]),_e.clear({color:R.be.transparent,depth:1}),de.coordsIndex=[];for(const at of je){const nt=de.getTerrainMesh(at.tileID),ot=de.getTerrainData(at.tileID);_e.activeTexture.set(ge.TEXTURE0),ge.bindTexture(ge.TEXTURE_2D,Ae.texture);const ht={u_terrain_coords_id:(255-de.coordsIndex.length)/255,u_texture:0,u_ele_delta:de.getMeshFrameDelta(xe.zoom)},xt=xe.getProjectionData({overscaledTileID:at.tileID,applyTerrainMatrix:!1,applyGlobeMatrix:!0});Ye.draw(_e,ge.TRIANGLES,Oe,$r.disabled,Se,Xr.backCCW,ht,ot,xt,"terrain",nt.vertexBuffer,nt.indexBuffer,nt.segments),de.coordsIndex.push(at.tileID.key)}_e.bindFramebuffer.set(null),_e.viewport.set([0,0,se.width,se.height])}(this,this.style.map.terrain))}renderLayer(t,G,J,te,se){J.isHidden(this.transform.zoom)||(J.type==="background"||J.type==="custom"||(te||[]).length)&&(this.id=J.id,R.ca(J)?function(de,_e,ge,xe,Se,Oe){if(de.renderPass!=="translucent")return;const{isRenderingToTexture:Ae}=Oe,je=$r.disabled,Ye=de.colorModeForRenderPass();(ge._unevaluatedLayout.hasValue("text-variable-anchor")||ge._unevaluatedLayout.hasValue("text-variable-anchor-offset"))&&function(at,nt,ot,ht,xt,mt,Tt,Pt,vt){const kt=nt.transform,Vt=nt.style.map.terrain,jt=xt==="map",zt=mt==="map";for(const $t of at){const mr=ht.getTile($t),_r=mr.getBucket(ot);if(!_r||!_r.text||!_r.text.segments.get().length)continue;const er=R.am(_r.textSizeData,kt.zoom),Ar=R.aB(mr,1,nt.transform.zoom),ti=Gr(jt,nt.transform,Ar),di=ot.layout.get("icon-text-fit")!=="none"&&_r.hasIconData();if(er){const Ri=Math.pow(2,kt.zoom-mr.tileID.overscaledZ),_i=Vt?(Ai,gi)=>Vt.getElevation($t,Ai,gi):null;Oc(_r,jt,zt,vt,kt,ti,Ri,er,di,R.aC(kt,mr,Tt,Pt),$t.toUnwrapped(),_i)}}}(xe,de,ge,_e,ge.layout.get("text-rotation-alignment"),ge.layout.get("text-pitch-alignment"),ge.paint.get("text-translate"),ge.paint.get("text-translate-anchor"),Se),ge.paint.get("icon-opacity").constantOr(1)!==0&&Ol(de,_e,ge,xe,!1,ge.paint.get("icon-translate"),ge.paint.get("icon-translate-anchor"),ge.layout.get("icon-rotation-alignment"),ge.layout.get("icon-pitch-alignment"),ge.layout.get("icon-keep-upright"),je,Ye,Ae),ge.paint.get("text-opacity").constantOr(1)!==0&&Ol(de,_e,ge,xe,!0,ge.paint.get("text-translate"),ge.paint.get("text-translate-anchor"),ge.layout.get("text-rotation-alignment"),ge.layout.get("text-pitch-alignment"),ge.layout.get("text-keep-upright"),je,Ye,Ae),_e.map.showCollisionBoxes&&(Rl(de,_e,ge,xe,!0),Rl(de,_e,ge,xe,!1))}(t,G,J,te,this.style.placement.variableOffsets,se):R.cb(J)?function(de,_e,ge,xe,Se){if(de.renderPass!=="translucent")return;const{isRenderingToTexture:Oe}=Se,Ae=ge.paint.get("circle-opacity"),je=ge.paint.get("circle-stroke-width"),Ye=ge.paint.get("circle-stroke-opacity"),at=!ge.layout.get("circle-sort-key").isConstant();if(Ae.constantOr(1)===0&&(je.constantOr(1)===0||Ye.constantOr(1)===0))return;const nt=de.context,ot=nt.gl,ht=de.transform,xt=de.getDepthModeForSublayer(0,ei.ReadOnly),mt=$r.disabled,Tt=de.colorModeForRenderPass(),Pt=[],vt=ht.getCircleRadiusCorrection();for(let kt=0;kt<xe.length;kt++){const Vt=xe[kt],jt=_e.getTile(Vt),zt=jt.getBucket(ge);if(!zt)continue;const $t=ge.paint.get("circle-translate"),mr=ge.paint.get("circle-translate-anchor"),_r=R.aC(ht,jt,$t,mr),er=zt.programConfigurations.get(ge.id),Ar=de.useProgram("circle",er),ti=zt.layoutVertexBuffer,di=zt.indexBuffer,Ri=de.style.map.terrain&&de.style.map.terrain.getTerrainData(Vt),_i={programConfiguration:er,program:Ar,layoutVertexBuffer:ti,indexBuffer:di,uniformValues:ru(de,jt,ge,_r,vt),terrainData:Ri,projectionData:ht.getProjectionData({overscaledTileID:Vt,applyGlobeMatrix:!Oe,applyTerrainMatrix:!0})};if(at){const Ai=zt.segments.get();for(const gi of Ai)Pt.push({segments:new R.aL([gi]),sortKey:gi.sortKey,state:_i})}else Pt.push({segments:zt.segments,sortKey:0,state:_i})}at&&Pt.sort((kt,Vt)=>kt.sortKey-Vt.sortKey);for(const kt of Pt){const{programConfiguration:Vt,program:jt,layoutVertexBuffer:zt,indexBuffer:$t,uniformValues:mr,terrainData:_r,projectionData:er}=kt.state;jt.draw(nt,ot.TRIANGLES,xt,mt,Tt,Xr.backCCW,mr,_r,er,ge.id,zt,$t,kt.segments,ge.paint,de.transform.zoom,Vt)}}(t,G,J,te,se):R.cc(J)?function(de,_e,ge,xe,Se){if(ge.paint.get("heatmap-opacity")===0)return;const Oe=de.context,{isRenderingToTexture:Ae,isRenderingGlobe:je}=Se;if(de.style.map.terrain){for(const Ye of xe){const at=_e.getTile(Ye);_e.hasRenderableParent(Ye)||(de.renderPass==="offscreen"?ps(de,at,ge,Ye,je):de.renderPass==="translucent"&&_s(de,ge,Ye,Ae,je))}Oe.viewport.set([0,0,de.width,de.height])}else de.renderPass==="offscreen"?function(Ye,at,nt,ot){const ht=Ye.context,xt=ht.gl,mt=Ye.transform,Tt=$r.disabled,Pt=new ui([xt.ONE,xt.ONE],R.be.transparent,[!0,!0,!0,!0]);(function(vt,kt,Vt){const jt=vt.gl;vt.activeTexture.set(jt.TEXTURE1),vt.viewport.set([0,0,kt.width/4,kt.height/4]);let zt=Vt.heatmapFbos.get(R.c1);zt?(jt.bindTexture(jt.TEXTURE_2D,zt.colorAttachment.get()),vt.bindFramebuffer.set(zt.framebuffer)):(zt=To(vt,kt.width/4,kt.height/4),Vt.heatmapFbos.set(R.c1,zt))})(ht,Ye,nt),ht.clear({color:R.be.transparent});for(let vt=0;vt<ot.length;vt++){const kt=ot[vt];if(at.hasRenderableParent(kt))continue;const Vt=at.getTile(kt),jt=Vt.getBucket(nt);if(!jt)continue;const zt=jt.programConfigurations.get(nt.id),$t=Ye.useProgram("heatmap",zt),mr=mt.getProjectionData({overscaledTileID:kt,applyGlobeMatrix:!0,applyTerrainMatrix:!1}),_r=mt.getCircleRadiusCorrection();$t.draw(ht,xt.TRIANGLES,ei.disabled,Tt,Pt,Xr.backCCW,wo(Vt,mt.zoom,nt.paint.get("heatmap-intensity"),_r),null,mr,nt.id,jt.layoutVertexBuffer,jt.indexBuffer,jt.segments,nt.paint,mt.zoom,zt)}ht.viewport.set([0,0,Ye.width,Ye.height])}(de,_e,ge,xe):de.renderPass==="translucent"&&function(Ye,at){const nt=Ye.context,ot=nt.gl;nt.setColorMode(Ye.colorModeForRenderPass());const ht=at.heatmapFbos.get(R.c1);ht&&(nt.activeTexture.set(ot.TEXTURE0),ot.bindTexture(ot.TEXTURE_2D,ht.colorAttachment.get()),nt.activeTexture.set(ot.TEXTURE1),ys(nt,at).bind(ot.LINEAR,ot.CLAMP_TO_EDGE),Ye.useProgram("heatmapTexture").draw(nt,ot.TRIANGLES,ei.disabled,$r.disabled,Ye.colorModeForRenderPass(),Xr.disabled,fl(Ye,at,0,1),null,null,at.id,Ye.viewportBuffer,Ye.quadTriangleIndexBuffer,Ye.viewportSegments,at.paint,Ye.transform.zoom))}(de,ge)}(t,G,J,te,se):R.cd(J)?function(de,_e,ge,xe,Se){if(de.renderPass!=="translucent")return;const{isRenderingToTexture:Oe}=Se,Ae=ge.paint.get("line-opacity"),je=ge.paint.get("line-width");if(Ae.constantOr(1)===0||je.constantOr(1)===0)return;const Ye=de.getDepthModeForSublayer(0,ei.ReadOnly),at=de.colorModeForRenderPass(),nt=ge.paint.get("line-dasharray"),ot=ge.paint.get("line-pattern"),ht=ot.constantOr(1),xt=ge.paint.get("line-gradient"),mt=ge.getCrossfadeParameters(),Tt=ht?"linePattern":nt?"lineSDF":xt?"lineGradient":"line",Pt=de.context,vt=Pt.gl,kt=de.transform;let Vt=!0;for(const jt of xe){const zt=_e.getTile(jt);if(ht&&!zt.patternsLoaded())continue;const $t=zt.getBucket(ge);if(!$t)continue;const mr=$t.programConfigurations.get(ge.id),_r=de.context.program.get(),er=de.useProgram(Tt,mr),Ar=Vt||er.program!==_r,ti=de.style.map.terrain&&de.style.map.terrain.getTerrainData(jt),di=ot.constantOr(null);if(di&&zt.imageAtlas){const mi=zt.imageAtlas,vi=mi.patternPositions[di.to.toString()],en=mi.patternPositions[di.from.toString()];vi&&en&&mr.setConstantPatternPositions(vi,en)}const Ri=kt.getProjectionData({overscaledTileID:jt,applyGlobeMatrix:!Oe,applyTerrainMatrix:!0}),_i=kt.getPixelScale(),Ai=ht?_l(de,zt,ge,_i,mt):nt?ml(de,zt,ge,_i,nt,mt):xt?iu(de,zt,ge,_i,$t.lineClipsArray.length):as(de,zt,ge,_i);if(ht)Pt.activeTexture.set(vt.TEXTURE0),zt.imageAtlasTexture.bind(vt.LINEAR,vt.CLAMP_TO_EDGE),mr.updatePaintBuffers(mt);else if(nt&&(Ar||de.lineAtlas.dirty))Pt.activeTexture.set(vt.TEXTURE0),de.lineAtlas.bind(Pt);else if(xt){const mi=$t.gradients[ge.id];let vi=mi.texture;if(ge.gradientVersion!==mi.version){let en=256;if(ge.stepInterpolant){const li=_e.getSource().maxzoom,Hi=jt.canonical.z===li?Math.ceil(1<<de.transform.maxZoom-jt.canonical.z):1;en=R.ag(R.c2($t.maxLineLength/R.$*1024*Hi),256,Pt.maxTextureSize)}mi.gradient=R.c3({expression:ge.gradientExpression(),evaluationKey:"lineProgress",resolution:en,image:mi.gradient||void 0,clips:$t.lineClipsArray}),mi.texture?mi.texture.update(mi.gradient):mi.texture=new R.T(Pt,mi.gradient,vt.RGBA),mi.version=ge.gradientVersion,vi=mi.texture}Pt.activeTexture.set(vt.TEXTURE0),vi.bind(ge.stepInterpolant?vt.NEAREST:vt.LINEAR,vt.CLAMP_TO_EDGE)}const gi=de.stencilModeForClipping(jt);er.draw(Pt,vt.TRIANGLES,Ye,gi,at,Xr.disabled,Ai,ti,Ri,ge.id,$t.layoutVertexBuffer,$t.indexBuffer,$t.segments,ge.paint,de.transform.zoom,mr,$t.layoutVertexBuffer2),Vt=!1}}(t,G,J,te,se):R.ce(J)?function(de,_e,ge,xe,Se){const Oe=ge.paint.get("fill-color"),Ae=ge.paint.get("fill-opacity");if(Ae.constantOr(1)===0)return;const{isRenderingToTexture:je}=Se,Ye=de.colorModeForRenderPass(),at=ge.paint.get("fill-pattern"),nt=de.opaquePassEnabledForLayer()&&!at.constantOr(1)&&Oe.constantOr(R.be.transparent).a===1&&Ae.constantOr(0)===1?"opaque":"translucent";if(de.renderPass===nt){const ot=de.getDepthModeForSublayer(1,de.renderPass==="opaque"?ei.ReadWrite:ei.ReadOnly);Io(de,_e,ge,xe,ot,Ye,!1,je)}if(de.renderPass==="translucent"&&ge.paint.get("fill-antialias")){const ot=de.getDepthModeForSublayer(ge.getPaintProperty("fill-outline-color")?2:0,ei.ReadOnly);Io(de,_e,ge,xe,ot,Ye,!0,je)}}(t,G,J,te,se):R.cf(J)?function(de,_e,ge,xe,Se){const Oe=ge.paint.get("fill-extrusion-opacity");if(Oe===0)return;const{isRenderingToTexture:Ae}=Se;if(de.renderPass==="translucent"){const je=new ei(de.context.gl.LEQUAL,ei.ReadWrite,de.depthRangeFor3D);if(Oe!==1||ge.paint.get("fill-extrusion-pattern").constantOr(1))Wa(de,_e,ge,xe,je,$r.disabled,ui.disabled,Ae),Wa(de,_e,ge,xe,je,de.stencilModeFor3D(),de.colorModeForRenderPass(),Ae);else{const Ye=de.colorModeForRenderPass();Wa(de,_e,ge,xe,je,$r.disabled,Ye,Ae)}}}(t,G,J,te,se):R.cg(J)?function(de,_e,ge,xe,Se){if(de.renderPass!=="offscreen"&&de.renderPass!=="translucent")return;const{isRenderingToTexture:Oe}=Se,Ae=de.context,je=de.style.projection.useSubdivision,Ye=de.getDepthModeForSublayer(0,ei.ReadOnly),at=de.colorModeForRenderPass();if(de.renderPass==="offscreen")(function(nt,ot,ht,xt,mt,Tt,Pt){const vt=nt.context,kt=vt.gl;for(const Vt of ht){const jt=ot.getTile(Vt),zt=jt.dem;if(!zt||!zt.data||!jt.needsHillshadePrepare)continue;const $t=zt.dim,mr=zt.stride,_r=zt.getPixels();if(vt.activeTexture.set(kt.TEXTURE1),vt.pixelStoreUnpackPremultiplyAlpha.set(!1),jt.demTexture=jt.demTexture||nt.getTileTexture(mr),jt.demTexture){const Ar=jt.demTexture;Ar.update(_r,{premultiply:!1}),Ar.bind(kt.NEAREST,kt.CLAMP_TO_EDGE)}else jt.demTexture=new R.T(vt,_r,kt.RGBA,{premultiply:!1}),jt.demTexture.bind(kt.NEAREST,kt.CLAMP_TO_EDGE);vt.activeTexture.set(kt.TEXTURE0);let er=jt.fbo;if(!er){const Ar=new R.T(vt,{width:$t,height:$t,data:null},kt.RGBA);Ar.bind(kt.LINEAR,kt.CLAMP_TO_EDGE),er=jt.fbo=vt.createFramebuffer($t,$t,!0,!1),er.colorAttachment.set(Ar.texture)}vt.bindFramebuffer.set(er.framebuffer),vt.viewport.set([0,0,$t,$t]),nt.useProgram("hillshadePrepare").draw(vt,kt.TRIANGLES,mt,Tt,Pt,Xr.disabled,xc(jt.tileID,zt),null,null,xt.id,nt.rasterBoundsBuffer,nt.quadTriangleIndexBuffer,nt.rasterBoundsSegments),jt.needsHillshadePrepare=!1}})(de,_e,xe,ge,Ye,$r.disabled,at),Ae.viewport.set([0,0,de.width,de.height]);else if(de.renderPass==="translucent")if(je){const[nt,ot,ht]=de.stencilConfigForOverlapTwoPass(xe);Ha(de,_e,ge,ht,nt,Ye,at,!1,Oe),Ha(de,_e,ge,ht,ot,Ye,at,!0,Oe)}else{const[nt,ot]=de.getStencilConfigForOverlapAndUpdateStencilID(xe);Ha(de,_e,ge,ot,nt,Ye,at,!1,Oe)}}(t,G,J,te,se):R.ch(J)?function(de,_e,ge,xe,Se){if(de.renderPass!=="translucent"||!xe.length)return;const{isRenderingToTexture:Oe}=Se,Ae=de.style.projection.useSubdivision,je=de.getDepthModeForSublayer(0,ei.ReadOnly),Ye=de.colorModeForRenderPass();if(Ae){const[at,nt,ot]=de.stencilConfigForOverlapTwoPass(xe);Ro(de,_e,ge,ot,at,je,Ye,!1,Oe),Ro(de,_e,ge,ot,nt,je,Ye,!0,Oe)}else{const[at,nt]=de.getStencilConfigForOverlapAndUpdateStencilID(xe);Ro(de,_e,ge,nt,at,je,Ye,!1,Oe)}}(t,G,J,te,se):R.ci(J)?function(de,_e,ge,xe,Se){if(de.renderPass!=="translucent"||ge.paint.get("raster-opacity")===0||!xe.length)return;const{isRenderingToTexture:Oe}=Se,Ae=_e.getSource(),je=de.style.projection.useSubdivision;if(Ae instanceof Br)oa(de,_e,ge,xe,null,!1,!1,Ae.tileCoords,Ae.flippedWindingOrder,Oe);else if(je){const[Ye,at,nt]=de.stencilConfigForOverlapTwoPass(xe);oa(de,_e,ge,nt,Ye,!1,!0,gu,!1,Oe),oa(de,_e,ge,nt,at,!0,!0,gu,!1,Oe)}else{const[Ye,at]=de.getStencilConfigForOverlapAndUpdateStencilID(xe);oa(de,_e,ge,at,Ye,!1,!0,gu,!1,Oe)}}(t,G,J,te,se):R.cj(J)?function(de,_e,ge,xe,Se){const Oe=ge.paint.get("background-color"),Ae=ge.paint.get("background-opacity");if(Ae===0)return;const{isRenderingToTexture:je}=Se,Ye=de.context,at=Ye.gl,nt=de.style.projection,ot=de.transform,ht=ot.tileSize,xt=ge.paint.get("background-pattern");if(de.isPatternMissing(xt))return;const mt=!xt&&Oe.a===1&&Ae===1&&de.opaquePassEnabledForLayer()?"opaque":"translucent";if(de.renderPass!==mt)return;const Tt=$r.disabled,Pt=de.getDepthModeForSublayer(0,mt==="opaque"?ei.ReadWrite:ei.ReadOnly),vt=de.colorModeForRenderPass(),kt=de.useProgram(xt?"backgroundPattern":"background"),Vt=xe||Mt(ot,{tileSize:ht,terrain:de.style.map.terrain});xt&&(Ye.activeTexture.set(at.TEXTURE0),de.imageManager.bind(de.context));const jt=ge.getCrossfadeParameters();for(const zt of Vt){const $t=ot.getProjectionData({overscaledTileID:zt,applyGlobeMatrix:!je,applyTerrainMatrix:!0}),mr=xt?Ec(Ae,de,xt,{tileID:zt,tileSize:ht},jt):os(Ae,Oe),_r=de.style.map.terrain&&de.style.map.terrain.getTerrainData(zt),er=nt.getMeshFromTileID(Ye,zt.canonical,!1,!0,"raster");kt.draw(Ye,at.TRIANGLES,Pt,Tt,vt,Xr.backCCW,mr,_r,$t,ge.id,er.vertexBuffer,er.indexBuffer,er.segments)}}(t,0,J,te,se):R.ck(J)&&function(de,_e,ge,xe){const{isRenderingGlobe:Se}=xe,Oe=de.context,Ae=ge.implementation,je=de.style.projection,Ye=de.transform,at=Ye.getProjectionDataForCustomLayer(Se),nt={farZ:Ye.farZ,nearZ:Ye.nearZ,fov:Ye.fov*Math.PI/180,modelViewProjectionMatrix:Ye.modelViewProjectionMatrix,projectionMatrix:Ye.projectionMatrix,shaderData:{variantName:je.shaderVariantName,vertexShaderPrelude:`const float PI = 3.141592653589793;
uniform mat4 u_projection_matrix;
${je.shaderPreludeCode.vertexSource}`,define:je.shaderDefine},defaultProjectionData:at},ot=Ae.renderingMode?Ae.renderingMode:"2d";if(de.renderPass==="offscreen"){const ht=Ae.prerender;ht&&(de.setCustomLayerDefaults(),Oe.setColorMode(de.colorModeForRenderPass()),ht.call(Ae,Oe.gl,nt),Oe.setDirty(),de.setBaseState())}else if(de.renderPass==="translucent"){de.setCustomLayerDefaults(),Oe.setColorMode(de.colorModeForRenderPass()),Oe.setStencilMode($r.disabled);const ht=ot==="3d"?de.getDepthModeFor3D():de.getDepthModeForSublayer(0,ei.ReadOnly);Oe.setDepthMode(ht),Ae.render(Oe.gl,nt),Oe.setDirty(),de.setBaseState(),Oe.bindFramebuffer.set(null)}}(t,0,J,se))}saveTileTexture(t){const G=this._tileTextures[t.size[0]];G?G.push(t):this._tileTextures[t.size[0]]=[t]}getTileTexture(t){const G=this._tileTextures[t];return G&&G.length>0?G.pop():null}isPatternMissing(t){if(!t)return!1;if(!t.from||!t.to)return!0;const G=this.imageManager.getPattern(t.from.toString()),J=this.imageManager.getPattern(t.to.toString());return!G||!J}useProgram(t,G,J=!1,te=[]){this.cache=this.cache||{};const se=!!this.style.map.terrain,de=this.style.projection,_e=J?Nn.projectionMercator:de.shaderPreludeCode,ge=J?ga:de.shaderDefine,xe=t+(G?G.cacheKey:"")+`/${J?Zs:de.shaderVariantName}`+(this._showOverdrawInspector?"/overdraw":"")+(se?"/terrain":"")+(te?`/${te.join("/")}`:"");return this.cache[xe]||(this.cache[xe]=new rs(this.context,Nn[t],G,vl[t],this._showOverdrawInspector,se,_e,ge,te)),this.cache[xe]}setCustomLayerDefaults(){this.context.unbindVAO(),this.context.cullFace.setDefault(),this.context.activeTexture.setDefault(),this.context.pixelStoreUnpack.setDefault(),this.context.pixelStoreUnpackPremultiplyAlpha.setDefault(),this.context.pixelStoreUnpackFlipY.setDefault()}setBaseState(){const t=this.context.gl;this.context.cullFace.set(!1),this.context.viewport.set([0,0,this.width,this.height]),this.context.blendEquation.set(t.FUNC_ADD)}initDebugOverlayCanvas(){this.debugOverlayCanvas==null&&(this.debugOverlayCanvas=document.createElement("canvas"),this.debugOverlayCanvas.width=512,this.debugOverlayCanvas.height=512,this.debugOverlayTexture=new R.T(this.context,this.debugOverlayCanvas,this.context.gl.RGBA))}destroy(){this.debugOverlayTexture&&this.debugOverlayTexture.destroy()}overLimit(){const{drawingBufferWidth:t,drawingBufferHeight:G}=this.context.gl;return this.width!==t||this.height!==G}}function xs(oe,t){let G,J=!1,te=null,se=null;const de=()=>{te=null,J&&(oe.apply(se,G),te=setTimeout(de,t),J=!1)};return(..._e)=>(J=!0,se=this,G=_e,te||de(),te)}class Po{constructor(t){this._getCurrentHash=()=>{const G=window.location.hash.replace("#","");if(this._hashName){let J;return G.split("&").map(te=>te.split("=")).forEach(te=>{te[0]===this._hashName&&(J=te)}),(J&&J[1]||"").split("/")}return G.split("/")},this._onHashChange=()=>{const G=this._getCurrentHash();if(!this._isValidHash(G))return!1;const J=this._map.dragRotate.isEnabled()&&this._map.touchZoomRotate.isEnabled()?+(G[3]||0):this._map.getBearing();return this._map.jumpTo({center:[+G[2],+G[1]],zoom:+G[0],bearing:J,pitch:+(G[4]||0)}),!0},this._updateHashUnthrottled=()=>{const G=window.location.href.replace(/(#.*)?$/,this.getHashString());window.history.replaceState(window.history.state,null,G)},this._removeHash=()=>{const G=this._getCurrentHash();if(G.length===0)return;const J=G.join("/");let te=J;te.split("&").length>0&&(te=te.split("&")[0]),this._hashName&&(te=`${this._hashName}=${J}`);let se=window.location.hash.replace(te,"");se.startsWith("#&")?se=se.slice(0,1)+se.slice(2):se==="#"&&(se="");let de=window.location.href.replace(/(#.+)?$/,se);de=de.replace("&&","&"),window.history.replaceState(window.history.state,null,de)},this._updateHash=xs(this._updateHashUnthrottled,300),this._hashName=t&&encodeURIComponent(t)}addTo(t){return this._map=t,addEventListener("hashchange",this._onHashChange,!1),this._map.on("moveend",this._updateHash),this}remove(){return removeEventListener("hashchange",this._onHashChange,!1),this._map.off("moveend",this._updateHash),clearTimeout(this._updateHash()),this._removeHash(),delete this._map,this}getHashString(t){const G=this._map.getCenter(),J=Math.round(100*this._map.getZoom())/100,te=Math.ceil((J*Math.LN2+Math.log(512/360/.5))/Math.LN10),se=Math.pow(10,te),de=Math.round(G.lng*se)/se,_e=Math.round(G.lat*se)/se,ge=this._map.getBearing(),xe=this._map.getPitch();let Se="";if(Se+=t?`/${de}/${_e}/${J}`:`${J}/${_e}/${de}`,(ge||xe)&&(Se+="/"+Math.round(10*ge)/10),xe&&(Se+=`/${Math.round(xe)}`),this._hashName){const Oe=this._hashName;let Ae=!1;const je=window.location.hash.slice(1).split("&").map(Ye=>{const at=Ye.split("=")[0];return at===Oe?(Ae=!0,`${at}=${Se}`):Ye}).filter(Ye=>Ye);return Ae||je.push(`${Oe}=${Se}`),`#${je.join("&")}`}return`#${Se}`}_isValidHash(t){if(t.length<3||t.some(isNaN))return!1;try{new R.S(+t[2],+t[1])}catch{return!1}const G=+t[0],J=+(t[3]||0),te=+(t[4]||0);return G>=this._map.getMinZoom()&&G<=this._map.getMaxZoom()&&J>=-180&&J<=180&&te>=this._map.getMinPitch()&&te<=this._map.getMaxPitch()}}const Za={linearity:.3,easing:R.cl(0,0,.3,1)},Ka=R.e({deceleration:2500,maxSpeed:1400},Za),bu=R.e({deceleration:20,maxSpeed:1400},Za),Oo=R.e({deceleration:1e3,maxSpeed:360},Za),xu=R.e({deceleration:1e3,maxSpeed:90},Za),kl=R.e({deceleration:1e3,maxSpeed:360},Za);class Ll{constructor(t){this._map=t,this.clear()}clear(){this._inertiaBuffer=[]}record(t){this._drainInertiaBuffer(),this._inertiaBuffer.push({time:pe.now(),settings:t})}_drainInertiaBuffer(){const t=this._inertiaBuffer,G=pe.now();for(;t.length>0&&G-t[0].time>160;)t.shift()}_onMoveEnd(t){if(this._drainInertiaBuffer(),this._inertiaBuffer.length<2)return;const G={zoom:0,bearing:0,pitch:0,roll:0,pan:new R.P(0,0),pinchAround:void 0,around:void 0};for(const{settings:se}of this._inertiaBuffer)G.zoom+=se.zoomDelta||0,G.bearing+=se.bearingDelta||0,G.pitch+=se.pitchDelta||0,G.roll+=se.rollDelta||0,se.panDelta&&G.pan._add(se.panDelta),se.around&&(G.around=se.around),se.pinchAround&&(G.pinchAround=se.pinchAround);const J=this._inertiaBuffer[this._inertiaBuffer.length-1].time-this._inertiaBuffer[0].time,te={};if(G.pan.mag()){const se=Xa(G.pan.mag(),J,R.e({},Ka,t||{})),de=G.pan.mult(se.amount/G.pan.mag()),_e=this._map.cameraHelper.handlePanInertia(de,this._map.transform);te.center=_e.easingCenter,te.offset=_e.easingOffset,Ya(te,se)}if(G.zoom){const se=Xa(G.zoom,J,bu);te.zoom=this._map.transform.zoom+se.amount,Ya(te,se)}if(G.bearing){const se=Xa(G.bearing,J,Oo);te.bearing=this._map.transform.bearing+R.ag(se.amount,-179,179),Ya(te,se)}if(G.pitch){const se=Xa(G.pitch,J,xu);te.pitch=this._map.transform.pitch+se.amount,Ya(te,se)}if(G.roll){const se=Xa(G.roll,J,kl);te.roll=this._map.transform.roll+R.ag(se.amount,-179,179),Ya(te,se)}if(te.zoom||te.bearing){const se=G.pinchAround===void 0?G.around:G.pinchAround;te.around=se?this._map.unproject(se):this._map.getCenter()}return this.clear(),R.e(te,{noMoveStart:!0})}}function Ya(oe,t){(!oe.duration||oe.duration<t.duration)&&(oe.duration=t.duration,oe.easing=t.easing)}function Xa(oe,t,G){const{maxSpeed:J,linearity:te,deceleration:se}=G,de=R.ag(oe*te/(t/1e3),-J,J),_e=Math.abs(de)/(se*te);return{easing:G.easing,duration:1e3*_e,amount:de*(_e/2)}}class xn extends R.l{preventDefault(){this._defaultPrevented=!0}get defaultPrevented(){return this._defaultPrevented}constructor(t,G,J,te={}){J=J instanceof MouseEvent?J:new MouseEvent(t,J);const se=me.mousePos(G.getCanvas(),J),de=G.unproject(se);super(t,R.e({point:se,lngLat:de,originalEvent:J},te)),this._defaultPrevented=!1,this.target=G}}class Mn extends R.l{preventDefault(){this._defaultPrevented=!0}get defaultPrevented(){return this._defaultPrevented}constructor(t,G,J){const te=t==="touchend"?J.changedTouches:J.touches,se=me.touchPos(G.getCanvasContainer(),te),de=se.map(ge=>G.unproject(ge)),_e=se.reduce((ge,xe,Se,Oe)=>ge.add(xe.div(Oe.length)),new R.P(0,0));super(t,{points:se,point:_e,lngLats:de,lngLat:G.unproject(_e),originalEvent:J}),this._defaultPrevented=!1}}class wu extends R.l{preventDefault(){this._defaultPrevented=!0}get defaultPrevented(){return this._defaultPrevented}constructor(t,G,J){super(t,{originalEvent:J}),this._defaultPrevented=!1}}class Bl{constructor(t,G){this._map=t,this._clickTolerance=G.clickTolerance}reset(){delete this._mousedownPos}wheel(t){return this._firePreventable(new wu(t.type,this._map,t))}mousedown(t,G){return this._mousedownPos=G,this._firePreventable(new xn(t.type,this._map,t))}mouseup(t){this._map.fire(new xn(t.type,this._map,t))}click(t,G){this._mousedownPos&&this._mousedownPos.dist(G)>=this._clickTolerance||this._map.fire(new xn(t.type,this._map,t))}dblclick(t){return this._firePreventable(new xn(t.type,this._map,t))}mouseover(t){this._map.fire(new xn(t.type,this._map,t))}mouseout(t){this._map.fire(new xn(t.type,this._map,t))}touchstart(t){return this._firePreventable(new Mn(t.type,this._map,t))}touchmove(t){this._map.fire(new Mn(t.type,this._map,t))}touchend(t){this._map.fire(new Mn(t.type,this._map,t))}touchcancel(t){this._map.fire(new Mn(t.type,this._map,t))}_firePreventable(t){if(this._map.fire(t),t.defaultPrevented)return{}}isEnabled(){return!0}isActive(){return!1}enable(){}disable(){}}class jl{constructor(t){this._map=t}reset(){this._delayContextMenu=!1,this._ignoreContextMenu=!0,delete this._contextMenuEvent}mousemove(t){this._map.fire(new xn(t.type,this._map,t))}mousedown(){this._delayContextMenu=!0,this._ignoreContextMenu=!1}mouseup(){this._delayContextMenu=!1,this._contextMenuEvent&&(this._map.fire(new xn("contextmenu",this._map,this._contextMenuEvent)),delete this._contextMenuEvent)}contextmenu(t){this._delayContextMenu?this._contextMenuEvent=t:this._ignoreContextMenu||this._map.fire(new xn(t.type,this._map,t)),this._map.listens("contextmenu")&&t.preventDefault()}isEnabled(){return!0}isActive(){return!1}enable(){}disable(){}}class Ja{constructor(t){this._map=t}get transform(){return this._map._requestedCameraState||this._map.transform}get center(){return{lng:this.transform.center.lng,lat:this.transform.center.lat}}get zoom(){return this.transform.zoom}get pitch(){return this.transform.pitch}get bearing(){return this.transform.bearing}unproject(t){return this.transform.screenPointToLocation(R.P.convert(t),this._map.terrain)}}class Su{constructor(t,G){this._map=t,this._tr=new Ja(t),this._el=t.getCanvasContainer(),this._container=t.getContainer(),this._clickTolerance=G.clickTolerance||1}isEnabled(){return!!this._enabled}isActive(){return!!this._active}enable(){this.isEnabled()||(this._enabled=!0)}disable(){this.isEnabled()&&(this._enabled=!1)}mousedown(t,G){this.isEnabled()&&t.shiftKey&&t.button===0&&(me.disableDrag(),this._startPos=this._lastPos=G,this._active=!0)}mousemoveWindow(t,G){if(!this._active)return;const J=G;if(this._lastPos.equals(J)||!this._box&&J.dist(this._startPos)<this._clickTolerance)return;const te=this._startPos;this._lastPos=J,this._box||(this._box=me.create("div","maplibregl-boxzoom",this._container),this._container.classList.add("maplibregl-crosshair"),this._fireEvent("boxzoomstart",t));const se=Math.min(te.x,J.x),de=Math.max(te.x,J.x),_e=Math.min(te.y,J.y),ge=Math.max(te.y,J.y);me.setTransform(this._box,`translate(${se}px,${_e}px)`),this._box.style.width=de-se+"px",this._box.style.height=ge-_e+"px"}mouseupWindow(t,G){if(!this._active||t.button!==0)return;const J=this._startPos,te=G;if(this.reset(),me.suppressClick(),J.x!==te.x||J.y!==te.y)return this._map.fire(new R.l("boxzoomend",{originalEvent:t})),{cameraAnimation:se=>se.fitScreenCoordinates(J,te,this._tr.bearing,{linear:!0})};this._fireEvent("boxzoomcancel",t)}keydown(t){this._active&&t.keyCode===27&&(this.reset(),this._fireEvent("boxzoomcancel",t))}reset(){this._active=!1,this._container.classList.remove("maplibregl-crosshair"),this._box&&(me.remove(this._box),this._box=null),me.enableDrag(),delete this._startPos,delete this._lastPos}_fireEvent(t,G){return this._map.fire(new R.l(t,{originalEvent:G}))}}function ws(oe,t){if(oe.length!==t.length)throw new Error(`The number of touches and points are not equal - touches ${oe.length}, points ${t.length}`);const G={};for(let J=0;J<oe.length;J++)G[oe[J].identifier]=t[J];return G}class Nl{constructor(t){this.reset(),this.numTouches=t.numTouches}reset(){delete this.centroid,delete this.startTime,delete this.touches,this.aborted=!1}touchstart(t,G,J){(this.centroid||J.length>this.numTouches)&&(this.aborted=!0),this.aborted||(this.startTime===void 0&&(this.startTime=t.timeStamp),J.length===this.numTouches&&(this.centroid=function(te){const se=new R.P(0,0);for(const de of te)se._add(de);return se.div(te.length)}(G),this.touches=ws(J,G)))}touchmove(t,G,J){if(this.aborted||!this.centroid)return;const te=ws(J,G);for(const se in this.touches){const de=te[se];(!de||de.dist(this.touches[se])>30)&&(this.aborted=!0)}}touchend(t,G,J){if((!this.centroid||t.timeStamp-this.startTime>500)&&(this.aborted=!0),J.length===0){const te=!this.aborted&&this.centroid;if(this.reset(),te)return te}}}class Ss{constructor(t){this.singleTap=new Nl(t),this.numTaps=t.numTaps,this.reset()}reset(){this.lastTime=1/0,delete this.lastTap,this.count=0,this.singleTap.reset()}touchstart(t,G,J){this.singleTap.touchstart(t,G,J)}touchmove(t,G,J){this.singleTap.touchmove(t,G,J)}touchend(t,G,J){const te=this.singleTap.touchend(t,G,J);if(te){const se=t.timeStamp-this.lastTime<500,de=!this.lastTap||this.lastTap.dist(te)<30;if(se&&de||this.reset(),this.count++,this.lastTime=t.timeStamp,this.lastTap=te,this.count===this.numTaps)return this.reset(),te}}}class Es{constructor(t){this._tr=new Ja(t),this._zoomIn=new Ss({numTouches:1,numTaps:2}),this._zoomOut=new Ss({numTouches:2,numTaps:1}),this.reset()}reset(){this._active=!1,this._zoomIn.reset(),this._zoomOut.reset()}touchstart(t,G,J){this._zoomIn.touchstart(t,G,J),this._zoomOut.touchstart(t,G,J)}touchmove(t,G,J){this._zoomIn.touchmove(t,G,J),this._zoomOut.touchmove(t,G,J)}touchend(t,G,J){const te=this._zoomIn.touchend(t,G,J),se=this._zoomOut.touchend(t,G,J),de=this._tr;return te?(this._active=!0,t.preventDefault(),setTimeout(()=>this.reset(),0),{cameraAnimation:_e=>_e.easeTo({duration:300,zoom:de.zoom+1,around:de.unproject(te)},{originalEvent:t})}):se?(this._active=!0,t.preventDefault(),setTimeout(()=>this.reset(),0),{cameraAnimation:_e=>_e.easeTo({duration:300,zoom:de.zoom-1,around:de.unproject(se)},{originalEvent:t})}):void 0}touchcancel(){this.reset()}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}}class Qa{constructor(t){this._enabled=!!t.enable,this._moveStateManager=t.moveStateManager,this._clickTolerance=t.clickTolerance||1,this._moveFunction=t.move,this._activateOnStart=!!t.activateOnStart,t.assignEvents(this),this.reset()}reset(t){this._active=!1,this._moved=!1,delete this._lastPoint,this._moveStateManager.endMove(t)}_move(...t){const G=this._moveFunction(...t);if(G.bearingDelta||G.pitchDelta||G.rollDelta||G.around||G.panDelta)return this._active=!0,G}dragStart(t,G){this.isEnabled()&&!this._lastPoint&&this._moveStateManager.isValidStartEvent(t)&&(this._moveStateManager.startMove(t),this._lastPoint=Array.isArray(G)?G[0]:G,this._activateOnStart&&this._lastPoint&&(this._active=!0))}dragMove(t,G){if(!this.isEnabled())return;const J=this._lastPoint;if(!J)return;if(t.preventDefault(),!this._moveStateManager.isValidMoveEvent(t))return void this.reset(t);const te=Array.isArray(G)?G[0]:G;return!this._moved&&te.dist(J)<this._clickTolerance?void 0:(this._moved=!0,this._lastPoint=te,this._move(J,te))}dragEnd(t){this.isEnabled()&&this._lastPoint&&this._moveStateManager.isValidEndEvent(t)&&(this._moved&&me.suppressClick(),this.reset(t))}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}getClickTolerance(){return this._clickTolerance}}const On=0,Dn=2,zl={[On]:1,[Dn]:2};class fn{constructor(t){this._correctEvent=t.checkCorrectEvent}startMove(t){const G=me.mouseButton(t);this._eventButton=G}endMove(t){delete this._eventButton}isValidStartEvent(t){return this._correctEvent(t)}isValidMoveEvent(t){return!function(G,J){const te=zl[J];return G.buttons===void 0||(G.buttons&te)!==te}(t,this._eventButton)}isValidEndEvent(t){return me.mouseButton(t)===this._eventButton}}class eo{constructor(){this._firstTouch=void 0}_isOneFingerTouch(t){return t.targetTouches.length===1}_isSameTouchEvent(t){return t.targetTouches[0].identifier===this._firstTouch}startMove(t){this._firstTouch=t.targetTouches[0].identifier}endMove(t){delete this._firstTouch}isValidStartEvent(t){return this._isOneFingerTouch(t)}isValidMoveEvent(t){return this._isOneFingerTouch(t)&&this._isSameTouchEvent(t)}isValidEndEvent(t){return this._isOneFingerTouch(t)&&this._isSameTouchEvent(t)}}class Mc{constructor(t=new fn({checkCorrectEvent:()=>!0}),G=new eo){this.mouseMoveStateManager=t,this.oneFingerTouchMoveStateManager=G}_executeRelevantHandler(t,G,J){return t instanceof MouseEvent?G(t):typeof TouchEvent<"u"&&t instanceof TouchEvent?J(t):void 0}startMove(t){this._executeRelevantHandler(t,G=>this.mouseMoveStateManager.startMove(G),G=>this.oneFingerTouchMoveStateManager.startMove(G))}endMove(t){this._executeRelevantHandler(t,G=>this.mouseMoveStateManager.endMove(G),G=>this.oneFingerTouchMoveStateManager.endMove(G))}isValidStartEvent(t){return this._executeRelevantHandler(t,G=>this.mouseMoveStateManager.isValidStartEvent(G),G=>this.oneFingerTouchMoveStateManager.isValidStartEvent(G))}isValidMoveEvent(t){return this._executeRelevantHandler(t,G=>this.mouseMoveStateManager.isValidMoveEvent(G),G=>this.oneFingerTouchMoveStateManager.isValidMoveEvent(G))}isValidEndEvent(t){return this._executeRelevantHandler(t,G=>this.mouseMoveStateManager.isValidEndEvent(G),G=>this.oneFingerTouchMoveStateManager.isValidEndEvent(G))}}const qs=oe=>{oe.mousedown=oe.dragStart,oe.mousemoveWindow=oe.dragMove,oe.mouseup=oe.dragEnd,oe.contextmenu=t=>{t.preventDefault()}};class Dc{constructor(t,G){this._clickTolerance=t.clickTolerance||1,this._map=G,this.reset()}reset(){this._active=!1,this._touches={},this._sum=new R.P(0,0)}_shouldBePrevented(t){return t<(this._map.cooperativeGestures.isEnabled()?2:1)}touchstart(t,G,J){return this._calculateTransform(t,G,J)}touchmove(t,G,J){if(this._active){if(!this._shouldBePrevented(J.length))return t.preventDefault(),this._calculateTransform(t,G,J);this._map.cooperativeGestures.notifyGestureBlocked("touch_pan",t)}}touchend(t,G,J){this._calculateTransform(t,G,J),this._active&&this._shouldBePrevented(J.length)&&this.reset()}touchcancel(){this.reset()}_calculateTransform(t,G,J){J.length>0&&(this._active=!0);const te=ws(J,G),se=new R.P(0,0),de=new R.P(0,0);let _e=0;for(const xe in te){const Se=te[xe],Oe=this._touches[xe];Oe&&(se._add(Se),de._add(Se.sub(Oe)),_e++,te[xe]=Se)}if(this._touches=te,this._shouldBePrevented(_e)||!de.mag())return;const ge=de.div(_e);return this._sum._add(ge),this._sum.mag()<this._clickTolerance?void 0:{around:se.div(_e),panDelta:ge}}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}}class Eu{constructor(){this.reset()}reset(){this._active=!1,delete this._firstTwoTouches}touchstart(t,G,J){this._firstTwoTouches||J.length<2||(this._firstTwoTouches=[J[0].identifier,J[1].identifier],this._start([G[0],G[1]]))}touchmove(t,G,J){if(!this._firstTwoTouches)return;t.preventDefault();const[te,se]=this._firstTwoTouches,de=Co(J,G,te),_e=Co(J,G,se);if(!de||!_e)return;const ge=this._aroundCenter?null:de.add(_e).div(2);return this._move([de,_e],ge,t)}touchend(t,G,J){if(!this._firstTwoTouches)return;const[te,se]=this._firstTwoTouches,de=Co(J,G,te),_e=Co(J,G,se);de&&_e||(this._active&&me.suppressClick(),this.reset())}touchcancel(){this.reset()}enable(t){this._enabled=!0,this._aroundCenter=!!t&&t.around==="center"}disable(){this._enabled=!1,this.reset()}isEnabled(){return!!this._enabled}isActive(){return!!this._active}}function Co(oe,t,G){for(let J=0;J<oe.length;J++)if(oe[J].identifier===G)return t[J]}function to(oe,t){return Math.log(oe/t)/Math.LN2}class Gn extends Eu{reset(){super.reset(),delete this._distance,delete this._startDistance}_start(t){this._startDistance=this._distance=t[0].dist(t[1])}_move(t,G){const J=this._distance;if(this._distance=t[0].dist(t[1]),this._active||!(Math.abs(to(this._distance,this._startDistance))<.1))return this._active=!0,{zoomDelta:to(this._distance,J),pinchAround:G}}}function Tr(oe,t){return 180*oe.angleWith(t)/Math.PI}class qu extends Eu{reset(){super.reset(),delete this._minDiameter,delete this._startVector,delete this._vector}_start(t){this._startVector=this._vector=t[0].sub(t[1]),this._minDiameter=t[0].dist(t[1])}_move(t,G,J){const te=this._vector;if(this._vector=t[0].sub(t[1]),this._active||!this._isBelowThreshold(this._vector))return this._active=!0,{bearingDelta:Tr(this._vector,te),pinchAround:G}}_isBelowThreshold(t){this._minDiameter=Math.min(this._minDiameter,t.mag());const G=25/(Math.PI*this._minDiameter)*360,J=Tr(t,this._startVector);return Math.abs(J)<G}}function Mo(oe){return Math.abs(oe.y)>Math.abs(oe.x)}class Tu extends Eu{constructor(t){super(),this._currentTouchCount=0,this._map=t}reset(){super.reset(),this._valid=void 0,delete this._firstMove,delete this._lastPoints}touchstart(t,G,J){super.touchstart(t,G,J),this._currentTouchCount=J.length}_start(t){this._lastPoints=t,Mo(t[0].sub(t[1]))&&(this._valid=!1)}_move(t,G,J){if(this._map.cooperativeGestures.isEnabled()&&this._currentTouchCount<3)return;const te=t[0].sub(this._lastPoints[0]),se=t[1].sub(this._lastPoints[1]);return this._valid=this.gestureBeginsVertically(te,se,J.timeStamp),this._valid?(this._lastPoints=t,this._active=!0,{pitchDelta:(te.y+se.y)/2*-.5}):void 0}gestureBeginsVertically(t,G,J){if(this._valid!==void 0)return this._valid;const te=t.mag()>=2,se=G.mag()>=2;if(!te&&!se)return;if(!te||!se)return this._firstMove===void 0&&(this._firstMove=J),J-this._firstMove<100&&void 0;const de=t.y>0==G.y>0;return Mo(t)&&Mo(G)&&de}}const Do={panStep:100,bearingStep:15,pitchStep:10};class ro{constructor(t){this._tr=new Ja(t);const G=Do;this._panStep=G.panStep,this._bearingStep=G.bearingStep,this._pitchStep=G.pitchStep,this._rotationDisabled=!1}reset(){this._active=!1}keydown(t){if(t.altKey||t.ctrlKey||t.metaKey)return;let G=0,J=0,te=0,se=0,de=0;switch(t.keyCode){case 61:case 107:case 171:case 187:G=1;break;case 189:case 109:case 173:G=-1;break;case 37:t.shiftKey?J=-1:(t.preventDefault(),se=-1);break;case 39:t.shiftKey?J=1:(t.preventDefault(),se=1);break;case 38:t.shiftKey?te=1:(t.preventDefault(),de=-1);break;case 40:t.shiftKey?te=-1:(t.preventDefault(),de=1);break;default:return}return this._rotationDisabled&&(J=0,te=0),{cameraAnimation:_e=>{const ge=this._tr;_e.easeTo({duration:300,easeId:"keyboardHandler",easing:Iu,zoom:G?Math.round(ge.zoom)+G*(t.shiftKey?2:1):ge.zoom,bearing:ge.bearing+J*this._bearingStep,pitch:ge.pitch+te*this._pitchStep,offset:[-se*this._panStep,-de*this._panStep],center:ge.center},{originalEvent:t})}}}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}disableRotation(){this._rotationDisabled=!0}enableRotation(){this._rotationDisabled=!1}}function Iu(oe){return oe*(2-oe)}const oi=4.000244140625,Ru=1/450;class Ul{constructor(t,G){this._onTimeout=J=>{this._type="wheel",this._delta-=this._lastValue,this._active||this._start(J)},this._map=t,this._tr=new Ja(t),this._triggerRenderFrame=G,this._delta=0,this._defaultZoomRate=.01,this._wheelZoomRate=Ru}setZoomRate(t){this._defaultZoomRate=t}setWheelZoomRate(t){this._wheelZoomRate=t}isEnabled(){return!!this._enabled}isActive(){return!!this._active||this._finishTimeout!==void 0}isZooming(){return!!this._zooming}enable(t){this.isEnabled()||(this._enabled=!0,this._aroundCenter=!!t&&t.around==="center")}disable(){this.isEnabled()&&(this._enabled=!1)}_shouldBePrevented(t){return!!this._map.cooperativeGestures.isEnabled()&&!(t.ctrlKey||this._map.cooperativeGestures.isBypassed(t))}wheel(t){if(!this.isEnabled())return;if(this._shouldBePrevented(t))return void this._map.cooperativeGestures.notifyGestureBlocked("wheel_zoom",t);let G=t.deltaMode===WheelEvent.DOM_DELTA_LINE?40*t.deltaY:t.deltaY;const J=pe.now(),te=J-(this._lastWheelEventTime||0);this._lastWheelEventTime=J,G!==0&&G%oi==0?this._type="wheel":G!==0&&Math.abs(G)<4?this._type="trackpad":te>400?(this._type=null,this._lastValue=G,this._timeout=setTimeout(this._onTimeout,40,t)):this._type||(this._type=Math.abs(te*G)<200?"trackpad":"wheel",this._timeout&&(clearTimeout(this._timeout),this._timeout=null,G+=this._lastValue)),t.shiftKey&&G&&(G/=4),this._type&&(this._lastWheelEvent=t,this._delta-=G,this._active||this._start(t)),t.preventDefault()}_start(t){if(!this._delta)return;this._frameId&&(this._frameId=null),this._active=!0,this.isZooming()||(this._zooming=!0),this._finishTimeout&&(clearTimeout(this._finishTimeout),delete this._finishTimeout);const G=me.mousePos(this._map.getCanvas(),t),J=this._tr;this._aroundPoint=this._aroundCenter?J.transform.locationToScreenPoint(R.S.convert(J.center)):G,this._frameId||(this._frameId=!0,this._triggerRenderFrame())}renderFrame(){if(!this._frameId||(this._frameId=null,!this.isActive()))return;const t=this._tr.transform;if(typeof this._lastExpectedZoom=="number"){const _e=t.zoom-this._lastExpectedZoom;typeof this._startZoom=="number"&&(this._startZoom+=_e),typeof this._targetZoom=="number"&&(this._targetZoom+=_e)}if(this._delta!==0){const _e=this._type==="wheel"&&Math.abs(this._delta)>oi?this._wheelZoomRate:this._defaultZoomRate;let ge=2/(1+Math.exp(-Math.abs(this._delta*_e)));this._delta<0&&ge!==0&&(ge=1/ge);const xe=typeof this._targetZoom!="number"?t.scale:R.ae(this._targetZoom);this._targetZoom=t.getConstrained(t.getCameraLngLat(),R.aj(xe*ge)).zoom,this._type==="wheel"&&(this._startZoom=t.zoom,this._easing=this._smoothOutEasing(200)),this._delta=0}const G=typeof this._targetZoom!="number"?t.zoom:this._targetZoom,J=this._startZoom,te=this._easing;let se,de=!1;if(this._type==="wheel"&&J&&te){const _e=pe.now()-this._lastWheelEventTime,ge=Math.min((_e+5)/200,1),xe=te(ge);se=R.C.number(J,G,xe),ge<1?this._frameId||(this._frameId=!0):de=!0}else se=G,de=!0;return this._active=!0,de&&(this._active=!1,this._finishTimeout=setTimeout(()=>{this._zooming=!1,this._triggerRenderFrame(),delete this._targetZoom,delete this._lastExpectedZoom,delete this._finishTimeout},200)),this._lastExpectedZoom=se,{noInertia:!0,needsRenderFrame:!de,zoomDelta:se-t.zoom,around:this._aroundPoint,originalEvent:this._lastWheelEvent}}_smoothOutEasing(t){let G=R.cn;if(this._prevEase){const J=this._prevEase,te=(pe.now()-J.start)/J.duration,se=J.easing(te+.01)-J.easing(te),de=.27/Math.sqrt(se*se+1e-4)*.01,_e=Math.sqrt(.0729-de*de);G=R.cl(de,_e,.25,1)}return this._prevEase={start:pe.now(),duration:t,easing:G},G}reset(){this._active=!1,this._zooming=!1,delete this._targetZoom,delete this._lastExpectedZoom,this._finishTimeout&&(clearTimeout(this._finishTimeout),delete this._finishTimeout)}}class Ts{constructor(t,G){this._clickZoom=t,this._tapZoom=G}enable(){this._clickZoom.enable(),this._tapZoom.enable()}disable(){this._clickZoom.disable(),this._tapZoom.disable()}isEnabled(){return this._clickZoom.isEnabled()&&this._tapZoom.isEnabled()}isActive(){return this._clickZoom.isActive()||this._tapZoom.isActive()}}class Fc{constructor(t){this._tr=new Ja(t),this.reset()}reset(){this._active=!1}dblclick(t,G){return t.preventDefault(),{cameraAnimation:J=>{J.easeTo({duration:300,zoom:this._tr.zoom+(t.shiftKey?-1:1),around:this._tr.unproject(G)},{originalEvent:t})}}}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}}class kc{constructor(){this._tap=new Ss({numTouches:1,numTaps:1}),this.reset()}reset(){this._active=!1,delete this._swipePoint,delete this._swipeTouch,delete this._tapTime,delete this._tapPoint,this._tap.reset()}touchstart(t,G,J){if(!this._swipePoint)if(this._tapTime){const te=G[0],se=t.timeStamp-this._tapTime<500,de=this._tapPoint.dist(te)<30;se&&de?J.length>0&&(this._swipePoint=te,this._swipeTouch=J[0].identifier):this.reset()}else this._tap.touchstart(t,G,J)}touchmove(t,G,J){if(this._tapTime){if(this._swipePoint){if(J[0].identifier!==this._swipeTouch)return;const te=G[0],se=te.y-this._swipePoint.y;return this._swipePoint=te,t.preventDefault(),this._active=!0,{zoomDelta:se/128}}}else this._tap.touchmove(t,G,J)}touchend(t,G,J){if(this._tapTime)this._swipePoint&&J.length===0&&this.reset();else{const te=this._tap.touchend(t,G,J);te&&(this._tapTime=t.timeStamp,this._tapPoint=te)}}touchcancel(){this.reset()}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}}class Au{constructor(t,G,J){this._el=t,this._mousePan=G,this._touchPan=J}enable(t){this._inertiaOptions=t||{},this._mousePan.enable(),this._touchPan.enable(),this._el.classList.add("maplibregl-touch-drag-pan")}disable(){this._mousePan.disable(),this._touchPan.disable(),this._el.classList.remove("maplibregl-touch-drag-pan")}isEnabled(){return this._mousePan.isEnabled()&&this._touchPan.isEnabled()}isActive(){return this._mousePan.isActive()||this._touchPan.isActive()}}class Is{constructor(t,G,J,te){this._pitchWithRotate=t.pitchWithRotate,this._rollEnabled=t.rollEnabled,this._mouseRotate=G,this._mousePitch=J,this._mouseRoll=te}enable(){this._mouseRotate.enable(),this._pitchWithRotate&&this._mousePitch.enable(),this._rollEnabled&&this._mouseRoll.enable()}disable(){this._mouseRotate.disable(),this._mousePitch.disable(),this._mouseRoll.disable()}isEnabled(){return this._mouseRotate.isEnabled()&&(!this._pitchWithRotate||this._mousePitch.isEnabled())&&(!this._rollEnabled||this._mouseRoll.isEnabled())}isActive(){return this._mouseRotate.isActive()||this._mousePitch.isActive()||this._mouseRoll.isActive()}}class Pu{constructor(t,G,J,te){this._el=t,this._touchZoom=G,this._touchRotate=J,this._tapDragZoom=te,this._rotationDisabled=!1,this._enabled=!0}enable(t){this._touchZoom.enable(t),this._rotationDisabled||this._touchRotate.enable(t),this._tapDragZoom.enable(),this._el.classList.add("maplibregl-touch-zoom-rotate")}disable(){this._touchZoom.disable(),this._touchRotate.disable(),this._tapDragZoom.disable(),this._el.classList.remove("maplibregl-touch-zoom-rotate")}isEnabled(){return this._touchZoom.isEnabled()&&(this._rotationDisabled||this._touchRotate.isEnabled())&&this._tapDragZoom.isEnabled()}isActive(){return this._touchZoom.isActive()||this._touchRotate.isActive()||this._tapDragZoom.isActive()}disableRotation(){this._rotationDisabled=!0,this._touchRotate.disable()}enableRotation(){this._rotationDisabled=!1,this._touchZoom.isEnabled()&&this._touchRotate.enable()}}class Gl{constructor(t,G){this._bypassKey=navigator.userAgent.indexOf("Mac")!==-1?"metaKey":"ctrlKey",this._map=t,this._options=G,this._enabled=!1}isActive(){return!1}reset(){}_setupUI(){if(this._container)return;const t=this._map.getCanvasContainer();t.classList.add("maplibregl-cooperative-gestures"),this._container=me.create("div","maplibregl-cooperative-gesture-screen",t);let G=this._map._getUIString("CooperativeGesturesHandler.WindowsHelpText");this._bypassKey==="metaKey"&&(G=this._map._getUIString("CooperativeGesturesHandler.MacHelpText"));const J=this._map._getUIString("CooperativeGesturesHandler.MobileHelpText"),te=document.createElement("div");te.className="maplibregl-desktop-message",te.textContent=G,this._container.appendChild(te);const se=document.createElement("div");se.className="maplibregl-mobile-message",se.textContent=J,this._container.appendChild(se),this._container.setAttribute("aria-hidden","true")}_destroyUI(){this._container&&(me.remove(this._container),this._map.getCanvasContainer().classList.remove("maplibregl-cooperative-gestures")),delete this._container}enable(){this._setupUI(),this._enabled=!0}disable(){this._enabled=!1,this._destroyUI()}isEnabled(){return this._enabled}isBypassed(t){return t[this._bypassKey]}notifyGestureBlocked(t,G){this._enabled&&(this._map.fire(new R.l("cooperativegestureprevented",{gestureType:t,originalEvent:G})),this._container.classList.add("maplibregl-show"),setTimeout(()=>{this._container.classList.remove("maplibregl-show")},100))}}const Fo=oe=>oe.zoom||oe.drag||oe.roll||oe.pitch||oe.rotate;class Lc extends R.l{}function Ou(oe){return oe.panDelta&&oe.panDelta.mag()||oe.zoomDelta||oe.bearingDelta||oe.pitchDelta||oe.rollDelta}class ua{constructor(t,G){this.handleWindowEvent=te=>{this.handleEvent(te,`${te.type}Window`)},this.handleEvent=(te,se)=>{if(te.type==="blur")return void this.stop(!0);this._updatingCamera=!0;const de=te.type==="renderFrame"?void 0:te,_e={needsRenderFrame:!1},ge={},xe={};for(const{handlerName:Ae,handler:je,allowed:Ye}of this._handlers){if(!je.isEnabled())continue;let at;if(this._blockedByActive(xe,Ye,Ae))je.reset();else if(je[se||te.type]){if(R.co(te,se||te.type)){const nt=me.mousePos(this._map.getCanvas(),te);at=je[se||te.type](te,nt)}else if(R.cp(te,se||te.type)){const nt=this._getMapTouches(te.touches),ot=me.touchPos(this._map.getCanvas(),nt);at=je[se||te.type](te,ot,nt)}else R.cq(se||te.type)||(at=je[se||te.type](te));this.mergeHandlerResult(_e,ge,at,Ae,de),at&&at.needsRenderFrame&&this._triggerRenderFrame()}(at||je.isActive())&&(xe[Ae]=je)}const Se={};for(const Ae in this._previousActiveHandlers)xe[Ae]||(Se[Ae]=de);this._previousActiveHandlers=xe,(Object.keys(Se).length||Ou(_e))&&(this._changes.push([_e,ge,Se]),this._triggerRenderFrame()),(Object.keys(xe).length||Ou(_e))&&this._map._stop(!0),this._updatingCamera=!1;const{cameraAnimation:Oe}=_e;Oe&&(this._inertia.clear(),this._fireEvents({},{},!0),this._changes=[],Oe(this._map))},this._map=t,this._el=this._map.getCanvasContainer(),this._handlers=[],this._handlersById={},this._changes=[],this._inertia=new Ll(t),this._bearingSnap=G.bearingSnap,this._previousActiveHandlers={},this._eventsInProgress={},this._addDefaultHandlers(G);const J=this._el;this._listeners=[[J,"touchstart",{passive:!0}],[J,"touchmove",{passive:!1}],[J,"touchend",void 0],[J,"touchcancel",void 0],[J,"mousedown",void 0],[J,"mousemove",void 0],[J,"mouseup",void 0],[document,"mousemove",{capture:!0}],[document,"mouseup",void 0],[J,"mouseover",void 0],[J,"mouseout",void 0],[J,"dblclick",void 0],[J,"click",void 0],[J,"keydown",{capture:!1}],[J,"keyup",void 0],[J,"wheel",{passive:!1}],[J,"contextmenu",void 0],[window,"blur",void 0]];for(const[te,se,de]of this._listeners)me.addEventListener(te,se,te===document?this.handleWindowEvent:this.handleEvent,de)}destroy(){for(const[t,G,J]of this._listeners)me.removeEventListener(t,G,t===document?this.handleWindowEvent:this.handleEvent,J)}_addDefaultHandlers(t){const G=this._map,J=G.getCanvasContainer();this._add("mapEvent",new Bl(G,t));const te=G.boxZoom=new Su(G,t);this._add("boxZoom",te),t.interactive&&t.boxZoom&&te.enable();const se=G.cooperativeGestures=new Gl(G,t.cooperativeGestures);this._add("cooperativeGestures",se),t.cooperativeGestures&&se.enable();const de=new Es(G),_e=new Fc(G);G.doubleClickZoom=new Ts(_e,de),this._add("tapZoom",de),this._add("clickZoom",_e),t.interactive&&t.doubleClickZoom&&G.doubleClickZoom.enable();const ge=new kc;this._add("tapDragZoom",ge);const xe=G.touchPitch=new Tu(G);this._add("touchPitch",xe),t.interactive&&t.touchPitch&&G.touchPitch.enable(t.touchPitch);const Se=()=>G.project(G.getCenter()),Oe=function({enable:mt,clickTolerance:Tt,aroundCenter:Pt=!0,minPixelCenterThreshold:vt=100,rotateDegreesPerPixelMoved:kt=.8},Vt){const jt=new fn({checkCorrectEvent:zt=>me.mouseButton(zt)===0&&zt.ctrlKey||me.mouseButton(zt)===2&&!zt.ctrlKey});return new Qa({clickTolerance:Tt,move:(zt,$t)=>{const mr=Vt();if(Pt&&Math.abs(mr.y-zt.y)>vt)return{bearingDelta:R.cm(new R.P(zt.x,$t.y),$t,mr)};let _r=($t.x-zt.x)*kt;return Pt&&$t.y<mr.y&&(_r=-_r),{bearingDelta:_r}},moveStateManager:jt,enable:mt,assignEvents:qs})}(t,Se),Ae=function({enable:mt,clickTolerance:Tt,pitchDegreesPerPixelMoved:Pt=-.5}){const vt=new fn({checkCorrectEvent:kt=>me.mouseButton(kt)===0&&kt.ctrlKey||me.mouseButton(kt)===2});return new Qa({clickTolerance:Tt,move:(kt,Vt)=>({pitchDelta:(Vt.y-kt.y)*Pt}),moveStateManager:vt,enable:mt,assignEvents:qs})}(t),je=function({enable:mt,clickTolerance:Tt,rollDegreesPerPixelMoved:Pt=.3},vt){const kt=new fn({checkCorrectEvent:Vt=>me.mouseButton(Vt)===2&&Vt.ctrlKey});return new Qa({clickTolerance:Tt,move:(Vt,jt)=>{const zt=vt();let $t=(jt.x-Vt.x)*Pt;return jt.y<zt.y&&($t=-$t),{rollDelta:$t}},moveStateManager:kt,enable:mt,assignEvents:qs})}(t,Se);G.dragRotate=new Is(t,Oe,Ae,je),this._add("mouseRotate",Oe,["mousePitch"]),this._add("mousePitch",Ae,["mouseRotate","mouseRoll"]),this._add("mouseRoll",je,["mousePitch"]),t.interactive&&t.dragRotate&&G.dragRotate.enable();const Ye=function({enable:mt,clickTolerance:Tt}){const Pt=new fn({checkCorrectEvent:vt=>me.mouseButton(vt)===0&&!vt.ctrlKey});return new Qa({clickTolerance:Tt,move:(vt,kt)=>({around:kt,panDelta:kt.sub(vt)}),activateOnStart:!0,moveStateManager:Pt,enable:mt,assignEvents:qs})}(t),at=new Dc(t,G);G.dragPan=new Au(J,Ye,at),this._add("mousePan",Ye),this._add("touchPan",at,["touchZoom","touchRotate"]),t.interactive&&t.dragPan&&G.dragPan.enable(t.dragPan);const nt=new qu,ot=new Gn;G.touchZoomRotate=new Pu(J,ot,nt,ge),this._add("touchRotate",nt,["touchPan","touchZoom"]),this._add("touchZoom",ot,["touchPan","touchRotate"]),t.interactive&&t.touchZoomRotate&&G.touchZoomRotate.enable(t.touchZoomRotate);const ht=G.scrollZoom=new Ul(G,()=>this._triggerRenderFrame());this._add("scrollZoom",ht,["mousePan"]),t.interactive&&t.scrollZoom&&G.scrollZoom.enable(t.scrollZoom);const xt=G.keyboard=new ro(G);this._add("keyboard",xt),t.interactive&&t.keyboard&&G.keyboard.enable(),this._add("blockableMapEvent",new jl(G))}_add(t,G,J){this._handlers.push({handlerName:t,handler:G,allowed:J}),this._handlersById[t]=G}stop(t){if(!this._updatingCamera){for(const{handler:G}of this._handlers)G.reset();this._inertia.clear(),this._fireEvents({},{},t),this._changes=[]}}isActive(){for(const{handler:t}of this._handlers)if(t.isActive())return!0;return!1}isZooming(){return!!this._eventsInProgress.zoom||this._map.scrollZoom.isZooming()}isRotating(){return!!this._eventsInProgress.rotate}isMoving(){return!!Fo(this._eventsInProgress)||this.isZooming()}_blockedByActive(t,G,J){for(const te in t)if(te!==J&&(!G||G.indexOf(te)<0))return!0;return!1}_getMapTouches(t){const G=[];for(const J of t)this._el.contains(J.target)&&G.push(J);return G}mergeHandlerResult(t,G,J,te,se){if(!J)return;R.e(t,J);const de={handlerName:te,originalEvent:J.originalEvent||se};J.zoomDelta!==void 0&&(G.zoom=de),J.panDelta!==void 0&&(G.drag=de),J.rollDelta!==void 0&&(G.roll=de),J.pitchDelta!==void 0&&(G.pitch=de),J.bearingDelta!==void 0&&(G.rotate=de)}_applyChanges(){const t={},G={},J={};for(const[te,se,de]of this._changes)te.panDelta&&(t.panDelta=(t.panDelta||new R.P(0,0))._add(te.panDelta)),te.zoomDelta&&(t.zoomDelta=(t.zoomDelta||0)+te.zoomDelta),te.bearingDelta&&(t.bearingDelta=(t.bearingDelta||0)+te.bearingDelta),te.pitchDelta&&(t.pitchDelta=(t.pitchDelta||0)+te.pitchDelta),te.rollDelta&&(t.rollDelta=(t.rollDelta||0)+te.rollDelta),te.around!==void 0&&(t.around=te.around),te.pinchAround!==void 0&&(t.pinchAround=te.pinchAround),te.noInertia&&(t.noInertia=te.noInertia),R.e(G,se),R.e(J,de);this._updateMapTransform(t,G,J),this._changes=[]}_updateMapTransform(t,G,J){const te=this._map,se=te._getTransformForUpdate(),de=te.terrain;if(!(Ou(t)||de&&this._terrainMovement))return this._fireEvents(G,J,!0);te._stop(!0);let{panDelta:_e,zoomDelta:ge,bearingDelta:xe,pitchDelta:Se,rollDelta:Oe,around:Ae,pinchAround:je}=t;je!==void 0&&(Ae=je),Ae=Ae||te.transform.centerPoint,de&&!se.isPointOnMapSurface(Ae)&&(Ae=se.centerPoint);const Ye={panDelta:_e,zoomDelta:ge,rollDelta:Oe,pitchDelta:Se,bearingDelta:xe,around:Ae};this._map.cameraHelper.useGlobeControls&&!se.isPointOnMapSurface(Ae)&&(Ae=se.centerPoint);const at=Ae.distSqr(se.centerPoint)<.01?se.center:se.screenPointToLocation(_e?Ae.sub(_e):Ae);de?(this._map.cameraHelper.handleMapControlsRollPitchBearingZoom(Ye,se),this._terrainMovement||!G.drag&&!G.zoom?G.drag&&this._terrainMovement?se.setCenter(se.screenPointToLocation(se.centerPoint.sub(_e))):this._map.cameraHelper.handleMapControlsPan(Ye,se,at):(this._terrainMovement=!0,this._map._elevationFreeze=!0,this._map.cameraHelper.handleMapControlsPan(Ye,se,at))):(this._map.cameraHelper.handleMapControlsRollPitchBearingZoom(Ye,se),this._map.cameraHelper.handleMapControlsPan(Ye,se,at)),te._applyUpdatedTransform(se),this._map._update(),t.noInertia||this._inertia.record(t),this._fireEvents(G,J,!0)}_fireEvents(t,G,J){const te=Fo(this._eventsInProgress),se=Fo(t),de={};for(const Oe in t){const{originalEvent:Ae}=t[Oe];this._eventsInProgress[Oe]||(de[`${Oe}start`]=Ae),this._eventsInProgress[Oe]=t[Oe]}!te&&se&&this._fireEvent("movestart",se.originalEvent);for(const Oe in de)this._fireEvent(Oe,de[Oe]);se&&this._fireEvent("move",se.originalEvent);for(const Oe in t){const{originalEvent:Ae}=t[Oe];this._fireEvent(Oe,Ae)}const _e={};let ge;for(const Oe in this._eventsInProgress){const{handlerName:Ae,originalEvent:je}=this._eventsInProgress[Oe];this._handlersById[Ae].isActive()||(delete this._eventsInProgress[Oe],ge=G[Ae]||je,_e[`${Oe}end`]=ge)}for(const Oe in _e)this._fireEvent(Oe,_e[Oe]);const xe=Fo(this._eventsInProgress),Se=(te||se)&&!xe;if(Se&&this._terrainMovement){this._map._elevationFreeze=!1,this._terrainMovement=!1;const Oe=this._map._getTransformForUpdate();this._map.getCenterClampedToGround()&&Oe.recalculateZoomAndCenter(this._map.terrain),this._map._applyUpdatedTransform(Oe)}if(J&&Se){this._updatingCamera=!0;const Oe=this._inertia._onMoveEnd(this._map.dragPan._inertiaOptions),Ae=je=>je!==0&&-this._bearingSnap<je&&je<this._bearingSnap;!Oe||!Oe.essential&&pe.prefersReducedMotion?(this._map.fire(new R.l("moveend",{originalEvent:ge})),Ae(this._map.getBearing())&&this._map.resetNorth()):(Ae(Oe.bearing||this._map.getBearing())&&(Oe.bearing=0),Oe.freezeElevation=!0,this._map.easeTo(Oe,{originalEvent:ge})),this._updatingCamera=!1}}_fireEvent(t,G){this._map.fire(new R.l(t,G?{originalEvent:G}:{}))}_requestFrame(){return this._map.triggerRepaint(),this._map._renderTaskQueue.add(t=>{delete this._frameId,this.handleEvent(new Lc("renderFrame",{timeStamp:t})),this._applyChanges()})}_triggerRenderFrame(){this._frameId===void 0&&(this._frameId=this._requestFrame())}}class Si extends R.E{constructor(t,G,J){super(),this._renderFrameCallback=()=>{const te=Math.min((pe.now()-this._easeStart)/this._easeOptions.duration,1);this._onEaseFrame(this._easeOptions.easing(te)),te<1&&this._easeFrameId?this._easeFrameId=this._requestRenderFrame(this._renderFrameCallback):this.stop()},this._moving=!1,this._zooming=!1,this.transform=t,this._bearingSnap=J.bearingSnap,this.cameraHelper=G,this.on("moveend",()=>{delete this._requestedCameraState})}migrateProjection(t,G){t.apply(this.transform),this.transform=t,this.cameraHelper=G}getCenter(){return new R.S(this.transform.center.lng,this.transform.center.lat)}setCenter(t,G){return this.jumpTo({center:t},G)}getCenterElevation(){return this.transform.elevation}setCenterElevation(t,G){return this.jumpTo({elevation:t},G),this}getCenterClampedToGround(){return this._centerClampedToGround}setCenterClampedToGround(t){this._centerClampedToGround=t}panBy(t,G,J){return t=R.P.convert(t).mult(-1),this.panTo(this.transform.center,R.e({offset:t},G),J)}panTo(t,G,J){return this.easeTo(R.e({center:t},G),J)}getZoom(){return this.transform.zoom}setZoom(t,G){return this.jumpTo({zoom:t},G),this}zoomTo(t,G,J){return this.easeTo(R.e({zoom:t},G),J)}zoomIn(t,G){return this.zoomTo(this.getZoom()+1,t,G),this}zoomOut(t,G){return this.zoomTo(this.getZoom()-1,t,G),this}getVerticalFieldOfView(){return this.transform.fov}setVerticalFieldOfView(t,G){return t!=this.transform.fov&&(this.transform.setFov(t),this.fire(new R.l("movestart",G)).fire(new R.l("move",G)).fire(new R.l("moveend",G))),this}getBearing(){return this.transform.bearing}setBearing(t,G){return this.jumpTo({bearing:t},G),this}getPadding(){return this.transform.padding}setPadding(t,G){return this.jumpTo({padding:t},G),this}rotateTo(t,G,J){return this.easeTo(R.e({bearing:t},G),J)}resetNorth(t,G){return this.rotateTo(0,R.e({duration:1e3},t),G),this}resetNorthPitch(t,G){return this.easeTo(R.e({bearing:0,pitch:0,roll:0,duration:1e3},t),G),this}snapToNorth(t,G){return Math.abs(this.getBearing())<this._bearingSnap?this.resetNorth(t,G):this}getPitch(){return this.transform.pitch}setPitch(t,G){return this.jumpTo({pitch:t},G),this}getRoll(){return this.transform.roll}setRoll(t,G){return this.jumpTo({roll:t},G),this}cameraForBounds(t,G){t=wr.convert(t).adjustAntiMeridian();const J=G&&G.bearing||0;return this._cameraForBoxAndBearing(t.getNorthWest(),t.getSouthEast(),J,G)}_cameraForBoxAndBearing(t,G,J,te){const se={top:0,bottom:0,right:0,left:0};if(typeof(te=R.e({padding:se,offset:[0,0],maxZoom:this.transform.maxZoom},te)).padding=="number"){const xe=te.padding;te.padding={top:xe,bottom:xe,right:xe,left:xe}}const de=R.e(se,te.padding);te.padding=de;const _e=this.transform,ge=new wr(t,G);return this.cameraHelper.cameraForBoxAndBearing(te,de,ge,J,_e)}fitBounds(t,G,J){return this._fitInternal(this.cameraForBounds(t,G),G,J)}fitScreenCoordinates(t,G,J,te,se){return this._fitInternal(this._cameraForBoxAndBearing(this.transform.screenPointToLocation(R.P.convert(t)),this.transform.screenPointToLocation(R.P.convert(G)),J,te),te,se)}_fitInternal(t,G,J){return t?(delete(G=R.e(t,G)).padding,G.linear?this.easeTo(G,J):this.flyTo(G,J)):this}jumpTo(t,G){this.stop();const J=this._getTransformForUpdate();let te=!1,se=!1,de=!1;const _e=J.zoom;this.cameraHelper.handleJumpToCenterZoom(J,t);const ge=J.zoom!==_e;return"elevation"in t&&J.elevation!==+t.elevation&&J.setElevation(+t.elevation),"bearing"in t&&J.bearing!==+t.bearing&&(te=!0,J.setBearing(+t.bearing)),"pitch"in t&&J.pitch!==+t.pitch&&(se=!0,J.setPitch(+t.pitch)),"roll"in t&&J.roll!==+t.roll&&(de=!0,J.setRoll(+t.roll)),t.padding==null||J.isPaddingEqual(t.padding)||J.setPadding(t.padding),this._applyUpdatedTransform(J),this.fire(new R.l("movestart",G)).fire(new R.l("move",G)),ge&&this.fire(new R.l("zoomstart",G)).fire(new R.l("zoom",G)).fire(new R.l("zoomend",G)),te&&this.fire(new R.l("rotatestart",G)).fire(new R.l("rotate",G)).fire(new R.l("rotateend",G)),se&&this.fire(new R.l("pitchstart",G)).fire(new R.l("pitch",G)).fire(new R.l("pitchend",G)),de&&this.fire(new R.l("rollstart",G)).fire(new R.l("roll",G)).fire(new R.l("rollend",G)),this.fire(new R.l("moveend",G))}calculateCameraOptionsFromTo(t,G,J,te=0){const se=R.a0.fromLngLat(t,G),de=R.a0.fromLngLat(J,te),_e=de.x-se.x,ge=de.y-se.y,xe=de.z-se.z,Se=Math.hypot(_e,ge,xe);if(Se===0)throw new Error("Can't calculate camera options with same From and To");const Oe=Math.hypot(_e,ge),Ae=R.aj(this.transform.cameraToCenterDistance/Se/this.transform.tileSize),je=180*Math.atan2(_e,-ge)/Math.PI;let Ye=180*Math.acos(Oe/Se)/Math.PI;return Ye=xe<0?90-Ye:90+Ye,{center:de.toLngLat(),elevation:te,zoom:Ae,pitch:Ye,bearing:je}}calculateCameraOptionsFromCameraLngLatAltRotation(t,G,J,te,se){const de=this.transform.calculateCenterFromCameraLngLatAlt(t,G,J,te);return{center:de.center,elevation:de.elevation,zoom:de.zoom,bearing:J,pitch:te,roll:se}}easeTo(t,G){this._stop(!1,t.easeId),((t=R.e({offset:[0,0],duration:500,easing:R.cn},t)).animate===!1||!t.essential&&pe.prefersReducedMotion)&&(t.duration=0);const J=this._getTransformForUpdate(),te=this.getBearing(),se=J.pitch,de=J.roll,_e="bearing"in t?this._normalizeBearing(t.bearing,te):te,ge="pitch"in t?+t.pitch:se,xe="roll"in t?this._normalizeBearing(t.roll,de):de,Se="padding"in t?t.padding:J.padding,Oe=R.P.convert(t.offset);let Ae,je;t.around&&(Ae=R.S.convert(t.around),je=J.locationToScreenPoint(Ae));const Ye={moving:this._moving,zooming:this._zooming,rotating:this._rotating,pitching:this._pitching,rolling:this._rolling},at=this.cameraHelper.handleEaseTo(J,{bearing:_e,pitch:ge,roll:xe,padding:Se,around:Ae,aroundPoint:je,offsetAsPoint:Oe,offset:t.offset,zoom:t.zoom,center:t.center});return this._rotating=this._rotating||te!==_e,this._pitching=this._pitching||ge!==se,this._rolling=this._rolling||xe!==de,this._padding=!J.isPaddingEqual(Se),this._zooming=this._zooming||at.isZooming,this._easeId=t.easeId,this._prepareEase(G,t.noMoveStart,Ye),this.terrain&&this._prepareElevation(at.elevationCenter),this._ease(nt=>{at.easeFunc(nt),this.terrain&&!t.freezeElevation&&this._updateElevation(nt),this._applyUpdatedTransform(J),this._fireMoveEvents(G)},nt=>{this.terrain&&t.freezeElevation&&this._finalizeElevation(),this._afterEase(G,nt)},t),this}_prepareEase(t,G,J={}){this._moving=!0,G||J.moving||this.fire(new R.l("movestart",t)),this._zooming&&!J.zooming&&this.fire(new R.l("zoomstart",t)),this._rotating&&!J.rotating&&this.fire(new R.l("rotatestart",t)),this._pitching&&!J.pitching&&this.fire(new R.l("pitchstart",t)),this._rolling&&!J.rolling&&this.fire(new R.l("rollstart",t))}_prepareElevation(t){this._elevationCenter=t,this._elevationStart=this.transform.elevation,this._elevationTarget=this.terrain.getElevationForLngLatZoom(t,this.transform.tileZoom),this._elevationFreeze=!0}_updateElevation(t){this.transform.setMinElevationForCurrentTile(this.terrain.getMinTileElevationForLngLatZoom(this._elevationCenter,this.transform.tileZoom));const G=this.terrain.getElevationForLngLatZoom(this._elevationCenter,this.transform.tileZoom);if(t<1&&G!==this._elevationTarget){const J=this._elevationTarget-this._elevationStart;this._elevationStart+=t*(J-(G-(J*t+this._elevationStart))/(1-t)),this._elevationTarget=G}this.transform.setElevation(R.C.number(this._elevationStart,this._elevationTarget,t))}_finalizeElevation(){this._elevationFreeze=!1,this.getCenterClampedToGround()&&this.transform.recalculateZoomAndCenter(this.terrain)}_getTransformForUpdate(){return this.transformCameraUpdate||this.terrain?(this._requestedCameraState||(this._requestedCameraState=this.transform.clone()),this._requestedCameraState):this.transform}_elevateCameraIfInsideTerrain(t){if(!this.terrain&&t.elevation>=0&&t.pitch<=90)return{};const G=t.getCameraLngLat(),J=t.getCameraAltitude(),te=this.terrain?this.terrain.getElevationForLngLatZoom(G,t.zoom):0;if(J<te){const se=this.calculateCameraOptionsFromTo(G,te,t.center,t.elevation);return{pitch:se.pitch,zoom:se.zoom}}return{}}_applyUpdatedTransform(t){const G=[];if(G.push(te=>this._elevateCameraIfInsideTerrain(te)),this.transformCameraUpdate&&G.push(te=>this.transformCameraUpdate(te)),!G.length)return;const J=t.clone();for(const te of G){const se=J.clone(),{center:de,zoom:_e,roll:ge,pitch:xe,bearing:Se,elevation:Oe}=te(se);de&&se.setCenter(de),Oe!==void 0&&se.setElevation(Oe),_e!==void 0&&se.setZoom(_e),ge!==void 0&&se.setRoll(ge),xe!==void 0&&se.setPitch(xe),Se!==void 0&&se.setBearing(Se),J.apply(se)}this.transform.apply(J)}_fireMoveEvents(t){this.fire(new R.l("move",t)),this._zooming&&this.fire(new R.l("zoom",t)),this._rotating&&this.fire(new R.l("rotate",t)),this._pitching&&this.fire(new R.l("pitch",t)),this._rolling&&this.fire(new R.l("roll",t))}_afterEase(t,G){if(this._easeId&&G&&this._easeId===G)return;delete this._easeId;const J=this._zooming,te=this._rotating,se=this._pitching,de=this._rolling;this._moving=!1,this._zooming=!1,this._rotating=!1,this._pitching=!1,this._rolling=!1,this._padding=!1,J&&this.fire(new R.l("zoomend",t)),te&&this.fire(new R.l("rotateend",t)),se&&this.fire(new R.l("pitchend",t)),de&&this.fire(new R.l("rollend",t)),this.fire(new R.l("moveend",t))}flyTo(t,G){if(!t.essential&&pe.prefersReducedMotion){const $t=R.Q(t,["center","zoom","bearing","pitch","roll","elevation"]);return this.jumpTo($t,G)}this.stop(),t=R.e({offset:[0,0],speed:1.2,curve:1.42,easing:R.cn},t);const J=this._getTransformForUpdate(),te=J.bearing,se=J.pitch,de=J.roll,_e=J.padding,ge="bearing"in t?this._normalizeBearing(t.bearing,te):te,xe="pitch"in t?+t.pitch:se,Se="roll"in t?this._normalizeBearing(t.roll,de):de,Oe="padding"in t?t.padding:J.padding,Ae=R.P.convert(t.offset);let je=J.centerPoint.add(Ae);const Ye=J.screenPointToLocation(je),at=this.cameraHelper.handleFlyTo(J,{bearing:ge,pitch:xe,roll:Se,padding:Oe,locationAtOffset:Ye,offsetAsPoint:Ae,center:t.center,minZoom:t.minZoom,zoom:t.zoom});let nt=t.curve;const ot=Math.max(J.width,J.height),ht=ot/at.scaleOfZoom,xt=at.pixelPathLength;typeof at.scaleOfMinZoom=="number"&&(nt=Math.sqrt(ot/at.scaleOfMinZoom/xt*2));const mt=nt*nt;function Tt($t){const mr=(ht*ht-ot*ot+($t?-1:1)*mt*mt*xt*xt)/(2*($t?ht:ot)*mt*xt);return Math.log(Math.sqrt(mr*mr+1)-mr)}function Pt($t){return(Math.exp($t)-Math.exp(-$t))/2}function vt($t){return(Math.exp($t)+Math.exp(-$t))/2}const kt=Tt(!1);let Vt=function($t){return vt(kt)/vt(kt+nt*$t)},jt=function($t){return ot*((vt(kt)*(Pt(mr=kt+nt*$t)/vt(mr))-Pt(kt))/mt)/xt;var mr},zt=(Tt(!0)-kt)/nt;if(Math.abs(xt)<2e-6||!isFinite(zt)){if(Math.abs(ot-ht)<1e-6)return this.easeTo(t,G);const $t=ht<ot?-1:1;zt=Math.abs(Math.log(ht/ot))/nt,jt=()=>0,Vt=mr=>Math.exp($t*nt*mr)}return t.duration="duration"in t?+t.duration:1e3*zt/("screenSpeed"in t?+t.screenSpeed/nt:+t.speed),t.maxDuration&&t.duration>t.maxDuration&&(t.duration=0),this._zooming=!0,this._rotating=te!==ge,this._pitching=xe!==se,this._rolling=Se!==de,this._padding=!J.isPaddingEqual(Oe),this._prepareEase(G,!1),this.terrain&&this._prepareElevation(at.targetCenter),this._ease($t=>{const mr=$t*zt,_r=1/Vt(mr),er=jt(mr);this._rotating&&J.setBearing(R.C.number(te,ge,$t)),this._pitching&&J.setPitch(R.C.number(se,xe,$t)),this._rolling&&J.setRoll(R.C.number(de,Se,$t)),this._padding&&(J.interpolatePadding(_e,Oe,$t),je=J.centerPoint.add(Ae)),at.easeFunc($t,_r,er,je),this.terrain&&!t.freezeElevation&&this._updateElevation($t),this._applyUpdatedTransform(J),this._fireMoveEvents(G)},()=>{this.terrain&&t.freezeElevation&&this._finalizeElevation(),this._afterEase(G)},t),this}isEasing(){return!!this._easeFrameId}stop(){return this._stop()}_stop(t,G){var J;if(this._easeFrameId&&(this._cancelRenderFrame(this._easeFrameId),delete this._easeFrameId,delete this._onEaseFrame),this._onEaseEnd){const te=this._onEaseEnd;delete this._onEaseEnd,te.call(this,G)}return t||(J=this.handlers)===null||J===void 0||J.stop(!1),this}_ease(t,G,J){J.animate===!1||J.duration===0?(t(1),G()):(this._easeStart=pe.now(),this._easeOptions=J,this._onEaseFrame=t,this._onEaseEnd=G,this._easeFrameId=this._requestRenderFrame(this._renderFrameCallback))}_normalizeBearing(t,G){t=R.aN(t,-180,180);const J=Math.abs(t-G);return Math.abs(t-360-G)<J&&(t-=360),Math.abs(t+360-G)<J&&(t+=360),t}queryTerrainElevation(t){return this.terrain?this.terrain.getElevationForLngLatZoom(R.S.convert(t),this.transform.tileZoom):null}}const ko={compact:!0,customAttribution:'<a href="https://maplibre.org/" target="_blank">MapLibre</a>'};class Rs{constructor(t=ko){this._toggleAttribution=()=>{this._container.classList.contains("maplibregl-compact")&&(this._container.classList.contains("maplibregl-compact-show")?(this._container.setAttribute("open",""),this._container.classList.remove("maplibregl-compact-show")):(this._container.classList.add("maplibregl-compact-show"),this._container.removeAttribute("open")))},this._updateData=G=>{!G||G.sourceDataType!=="metadata"&&G.sourceDataType!=="visibility"&&G.dataType!=="style"&&G.type!=="terrain"||this._updateAttributions()},this._updateCompact=()=>{this._map.getCanvasContainer().offsetWidth<=640||this._compact?this._compact===!1?this._container.setAttribute("open",""):this._container.classList.contains("maplibregl-compact")||this._container.classList.contains("maplibregl-attrib-empty")||(this._container.setAttribute("open",""),this._container.classList.add("maplibregl-compact","maplibregl-compact-show")):(this._container.setAttribute("open",""),this._container.classList.contains("maplibregl-compact")&&this._container.classList.remove("maplibregl-compact","maplibregl-compact-show"))},this._updateCompactMinimize=()=>{this._container.classList.contains("maplibregl-compact")&&this._container.classList.contains("maplibregl-compact-show")&&this._container.classList.remove("maplibregl-compact-show")},this.options=t}getDefaultPosition(){return"bottom-right"}onAdd(t){return this._map=t,this._compact=this.options.compact,this._container=me.create("details","maplibregl-ctrl maplibregl-ctrl-attrib"),this._compactButton=me.create("summary","maplibregl-ctrl-attrib-button",this._container),this._compactButton.addEventListener("click",this._toggleAttribution),this._setElementTitle(this._compactButton,"ToggleAttribution"),this._innerContainer=me.create("div","maplibregl-ctrl-attrib-inner",this._container),this._updateAttributions(),this._updateCompact(),this._map.on("styledata",this._updateData),this._map.on("sourcedata",this._updateData),this._map.on("terrain",this._updateData),this._map.on("resize",this._updateCompact),this._map.on("drag",this._updateCompactMinimize),this._container}onRemove(){me.remove(this._container),this._map.off("styledata",this._updateData),this._map.off("sourcedata",this._updateData),this._map.off("terrain",this._updateData),this._map.off("resize",this._updateCompact),this._map.off("drag",this._updateCompactMinimize),this._map=void 0,this._compact=void 0,this._attribHTML=void 0}_setElementTitle(t,G){const J=this._map._getUIString(`AttributionControl.${G}`);t.title=J,t.setAttribute("aria-label",J)}_updateAttributions(){if(!this._map.style)return;let t=[];if(this.options.customAttribution&&(Array.isArray(this.options.customAttribution)?t=t.concat(this.options.customAttribution.map(te=>typeof te!="string"?"":te)):typeof this.options.customAttribution=="string"&&t.push(this.options.customAttribution)),this._map.style.stylesheet){const te=this._map.style.stylesheet;this.styleOwner=te.owner,this.styleId=te.id}const G=this._map.style.sourceCaches;for(const te in G){const se=G[te];if(se.used||se.usedForTerrain){const de=se.getSource();de.attribution&&t.indexOf(de.attribution)<0&&t.push(de.attribution)}}t=t.filter(te=>String(te).trim()),t.sort((te,se)=>te.length-se.length),t=t.filter((te,se)=>{for(let de=se+1;de<t.length;de++)if(t[de].indexOf(te)>=0)return!1;return!0});const J=t.join(" | ");J!==this._attribHTML&&(this._attribHTML=J,t.length?(this._innerContainer.innerHTML=me.sanitize(J),this._container.classList.remove("maplibregl-attrib-empty")):this._container.classList.add("maplibregl-attrib-empty"),this._updateCompact(),this._editLink=null)}}class Cu{constructor(t={}){this._updateCompact=()=>{const G=this._container.children;if(G.length){const J=G[0];this._map.getCanvasContainer().offsetWidth<=640||this._compact?this._compact!==!1&&J.classList.add("maplibregl-compact"):J.classList.remove("maplibregl-compact")}},this.options=t}getDefaultPosition(){return"bottom-left"}onAdd(t){this._map=t,this._compact=this.options&&this.options.compact,this._container=me.create("div","maplibregl-ctrl");const G=me.create("a","maplibregl-ctrl-logo");return G.target="_blank",G.rel="noopener nofollow",G.href="https://maplibre.org/",G.setAttribute("aria-label",this._map._getUIString("LogoControl.Title")),G.setAttribute("rel","noopener nofollow"),this._container.appendChild(G),this._container.style.display="block",this._map.on("resize",this._updateCompact),this._updateCompact(),this._container}onRemove(){me.remove(this._container),this._map.off("resize",this._updateCompact),this._map=void 0,this._compact=void 0}}class Vl{constructor(){this._queue=[],this._id=0,this._cleared=!1,this._currentlyRunning=!1}add(t){const G=++this._id;return this._queue.push({callback:t,id:G,cancelled:!1}),G}remove(t){const G=this._currentlyRunning,J=G?this._queue.concat(G):this._queue;for(const te of J)if(te.id===t)return void(te.cancelled=!0)}run(t=0){if(this._currentlyRunning)throw new Error("Attempting to run(), but is already running.");const G=this._currentlyRunning=this._queue;this._queue=[];for(const J of G)if(!J.cancelled&&(J.callback(t),this._cleared))break;this._cleared=!1,this._currentlyRunning=!1}clear(){this._currentlyRunning&&(this._cleared=!0),this._queue=[]}}var $l=R.aI([{name:"a_pos3d",type:"Int16",components:3}]);class Bc extends R.E{constructor(t){super(),this._lastTilesetChange=pe.now(),this.sourceCache=t,this._tiles={},this._renderableTilesKeys=[],this._sourceTileCache={},this.minzoom=0,this.maxzoom=22,this.deltaZoom=1,this.tileSize=t._source.tileSize*2**this.deltaZoom,t.usedForTerrain=!0,t.tileSize=this.tileSize}destruct(){this.sourceCache.usedForTerrain=!1,this.sourceCache.tileSize=null}update(t,G){this.sourceCache.update(t,G),this._renderableTilesKeys=[];const J={};for(const te of Mt(t,{tileSize:this.tileSize,minzoom:this.minzoom,maxzoom:this.maxzoom,reparseOverscaled:!1,terrain:G,calculateTileZoom:this.sourceCache._source.calculateTileZoom}))J[te.key]=!0,this._renderableTilesKeys.push(te.key),this._tiles[te.key]||(te.terrainRttPosMatrix32f=new Float64Array(16),R.bX(te.terrainRttPosMatrix32f,0,R.$,R.$,0,0,1),this._tiles[te.key]=new Ee(te,this.tileSize),this._lastTilesetChange=pe.now());for(const te in this._tiles)J[te]||delete this._tiles[te]}freeRtt(t){for(const G in this._tiles){const J=this._tiles[G];(!t||J.tileID.equals(t)||J.tileID.isChildOf(t)||t.isChildOf(J.tileID))&&(J.rtt=[])}}getRenderableTiles(){return this._renderableTilesKeys.map(t=>this.getTileByID(t))}getTileByID(t){return this._tiles[t]}getTerrainCoords(t,G){return G?this._getTerrainCoordsForTileRanges(t,G):this._getTerrainCoordsForRegularTile(t)}_getTerrainCoordsForRegularTile(t){const G={};for(const J of this._renderableTilesKeys){const te=this._tiles[J].tileID,se=t.clone(),de=R.b9();if(te.canonical.equals(t.canonical))R.bX(de,0,R.$,R.$,0,0,1);else if(te.canonical.isChildOf(t.canonical)){const _e=te.canonical.z-t.canonical.z,ge=te.canonical.x-(te.canonical.x>>_e<<_e),xe=te.canonical.y-(te.canonical.y>>_e<<_e),Se=R.$>>_e;R.bX(de,0,Se,Se,0,0,1),R.M(de,de,[-ge*Se,-xe*Se,0])}else{if(!t.canonical.isChildOf(te.canonical))continue;{const _e=t.canonical.z-te.canonical.z,ge=t.canonical.x-(t.canonical.x>>_e<<_e),xe=t.canonical.y-(t.canonical.y>>_e<<_e),Se=R.$>>_e;R.bX(de,0,R.$,R.$,0,0,1),R.M(de,de,[ge*Se,xe*Se,0]),R.N(de,de,[1/2**_e,1/2**_e,0])}}se.terrainRttPosMatrix32f=new Float32Array(de),G[J]=se}return G}_getTerrainCoordsForTileRanges(t,G){const J={};for(const te of this._renderableTilesKeys){const se=this._tiles[te].tileID;if(!this._isWithinTileRanges(se,G))continue;const de=t.clone(),_e=R.b9();if(se.canonical.z===t.canonical.z){const ge=t.canonical.x-se.canonical.x,xe=t.canonical.y-se.canonical.y;R.bX(_e,0,R.$,R.$,0,0,1),R.M(_e,_e,[ge*R.$,xe*R.$,0])}else if(se.canonical.z>t.canonical.z){const ge=se.canonical.z-t.canonical.z,xe=se.canonical.x-(se.canonical.x>>ge<<ge),Se=se.canonical.y-(se.canonical.y>>ge<<ge),Oe=t.canonical.x-(se.canonical.x>>ge),Ae=t.canonical.y-(se.canonical.y>>ge),je=R.$>>ge;R.bX(_e,0,je,je,0,0,1),R.M(_e,_e,[-xe*je+Oe*R.$,-Se*je+Ae*R.$,0])}else{const ge=t.canonical.z-se.canonical.z,xe=t.canonical.x-(t.canonical.x>>ge<<ge),Se=t.canonical.y-(t.canonical.y>>ge<<ge),Oe=(t.canonical.x>>ge)-se.canonical.x,Ae=(t.canonical.y>>ge)-se.canonical.y,je=R.$<<ge;R.bX(_e,0,je,je,0,0,1),R.M(_e,_e,[xe*R.$+Oe*je,Se*R.$+Ae*je,0])}de.terrainRttPosMatrix32f=new Float32Array(_e),J[te]=de}return J}getSourceTile(t,G){const J=this.sourceCache._source;let te=t.overscaledZ-this.deltaZoom;if(te>J.maxzoom&&(te=J.maxzoom),te<J.minzoom)return null;this._sourceTileCache[t.key]||(this._sourceTileCache[t.key]=t.scaledTo(te).key);let se=this.sourceCache.getTileByID(this._sourceTileCache[t.key]);if((!se||!se.dem)&&G)for(;te>=J.minzoom&&(!se||!se.dem);)se=this.sourceCache.getTileByID(t.scaledTo(te--).key);return se}anyTilesAfterTime(t=Date.now()){return this._lastTilesetChange>=t}_isWithinTileRanges(t,G){return G[t.canonical.z]&&t.canonical.x>=G[t.canonical.z].minTileX&&t.canonical.x<=G[t.canonical.z].maxTileX&&t.canonical.y>=G[t.canonical.z].minTileY&&t.canonical.y<=G[t.canonical.z].maxTileY}}class Vn{constructor(t,G,J){this._meshCache={},this.painter=t,this.sourceCache=new Bc(G),this.options=J,this.exaggeration=typeof J.exaggeration=="number"?J.exaggeration:1,this.qualityFactor=2,this.meshSize=128,this._demMatrixCache={},this.coordsIndex=[],this._coordsTextureSize=1024}getDEMElevation(t,G,J,te=R.$){var se;if(!(G>=0&&G<te&&J>=0&&J<te))return 0;const de=this.getTerrainData(t),_e=(se=de.tile)===null||se===void 0?void 0:se.dem;if(!_e)return 0;const ge=R.cr([],[G/te*R.$,J/te*R.$],de.u_terrain_matrix),xe=[ge[0]*_e.dim,ge[1]*_e.dim],Se=Math.floor(xe[0]),Oe=Math.floor(xe[1]),Ae=xe[0]-Se,je=xe[1]-Oe;return _e.get(Se,Oe)*(1-Ae)*(1-je)+_e.get(Se+1,Oe)*Ae*(1-je)+_e.get(Se,Oe+1)*(1-Ae)*je+_e.get(Se+1,Oe+1)*Ae*je}getElevationForLngLatZoom(t,G){if(!R.cs(G,t.wrap()))return 0;const{tileID:J,mercatorX:te,mercatorY:se}=this._getOverscaledTileIDFromLngLatZoom(t,G);return this.getElevation(J,te%R.$,se%R.$,R.$)}getElevation(t,G,J,te=R.$){return this.getDEMElevation(t,G,J,te)*this.exaggeration}getTerrainData(t){if(!this._emptyDemTexture){const te=this.painter.context,se=new R.R({width:1,height:1},new Uint8Array(4));this._emptyDepthTexture=new R.T(te,se,te.gl.RGBA,{premultiply:!1}),this._emptyDemUnpack=[0,0,0,0],this._emptyDemTexture=new R.T(te,new R.R({width:1,height:1}),te.gl.RGBA,{premultiply:!1}),this._emptyDemTexture.bind(te.gl.NEAREST,te.gl.CLAMP_TO_EDGE),this._emptyDemMatrix=R.af([])}const G=this.sourceCache.getSourceTile(t,!0);if(G&&G.dem&&(!G.demTexture||G.needsTerrainPrepare)){const te=this.painter.context;G.demTexture=this.painter.getTileTexture(G.dem.stride),G.demTexture?G.demTexture.update(G.dem.getPixels(),{premultiply:!1}):G.demTexture=new R.T(te,G.dem.getPixels(),te.gl.RGBA,{premultiply:!1}),G.demTexture.bind(te.gl.NEAREST,te.gl.CLAMP_TO_EDGE),G.needsTerrainPrepare=!1}const J=G&&G+G.tileID.key+t.key;if(J&&!this._demMatrixCache[J]){const te=this.sourceCache.sourceCache._source.maxzoom;let se=t.canonical.z-G.tileID.canonical.z;t.overscaledZ>t.canonical.z&&(t.canonical.z>=te?se=t.canonical.z-te:R.w("cannot calculate elevation if elevation maxzoom > source.maxzoom"));const de=t.canonical.x-(t.canonical.x>>se<<se),_e=t.canonical.y-(t.canonical.y>>se<<se),ge=R.ct(new Float64Array(16),[1/(R.$<<se),1/(R.$<<se),0]);R.M(ge,ge,[de*R.$,_e*R.$,0]),this._demMatrixCache[t.key]={matrix:ge,coord:t}}return{u_depth:2,u_terrain:3,u_terrain_dim:G&&G.dem&&G.dem.dim||1,u_terrain_matrix:J?this._demMatrixCache[t.key].matrix:this._emptyDemMatrix,u_terrain_unpack:G&&G.dem&&G.dem.getUnpackVector()||this._emptyDemUnpack,u_terrain_exaggeration:this.exaggeration,texture:(G&&G.demTexture||this._emptyDemTexture).texture,depthTexture:(this._fboDepthTexture||this._emptyDepthTexture).texture,tile:G}}getFramebuffer(t){const G=this.painter,J=G.width/devicePixelRatio,te=G.height/devicePixelRatio;return!this._fbo||this._fbo.width===J&&this._fbo.height===te||(this._fbo.destroy(),this._fboCoordsTexture.destroy(),this._fboDepthTexture.destroy(),delete this._fbo,delete this._fboDepthTexture,delete this._fboCoordsTexture),this._fboCoordsTexture||(this._fboCoordsTexture=new R.T(G.context,{width:J,height:te,data:null},G.context.gl.RGBA,{premultiply:!1}),this._fboCoordsTexture.bind(G.context.gl.NEAREST,G.context.gl.CLAMP_TO_EDGE)),this._fboDepthTexture||(this._fboDepthTexture=new R.T(G.context,{width:J,height:te,data:null},G.context.gl.RGBA,{premultiply:!1}),this._fboDepthTexture.bind(G.context.gl.NEAREST,G.context.gl.CLAMP_TO_EDGE)),this._fbo||(this._fbo=G.context.createFramebuffer(J,te,!0,!1),this._fbo.depthAttachment.set(G.context.createRenderbuffer(G.context.gl.DEPTH_COMPONENT16,J,te))),this._fbo.colorAttachment.set(t==="coords"?this._fboCoordsTexture.texture:this._fboDepthTexture.texture),this._fbo}getCoordsTexture(){const t=this.painter.context;if(this._coordsTexture)return this._coordsTexture;const G=new Uint8Array(this._coordsTextureSize*this._coordsTextureSize*4);for(let se=0,de=0;se<this._coordsTextureSize;se++)for(let _e=0;_e<this._coordsTextureSize;_e++,de+=4)G[de+0]=255&_e,G[de+1]=255&se,G[de+2]=_e>>8<<4|se>>8,G[de+3]=0;const J=new R.R({width:this._coordsTextureSize,height:this._coordsTextureSize},new Uint8Array(G.buffer)),te=new R.T(t,J,t.gl.RGBA,{premultiply:!1});return te.bind(t.gl.NEAREST,t.gl.CLAMP_TO_EDGE),this._coordsTexture=te,te}pointCoordinate(t){this.painter.maybeDrawDepthAndCoords(!0);const G=new Uint8Array(4),J=this.painter.context,te=J.gl,se=Math.round(t.x*this.painter.pixelRatio/devicePixelRatio),de=Math.round(t.y*this.painter.pixelRatio/devicePixelRatio),_e=Math.round(this.painter.height/devicePixelRatio);J.bindFramebuffer.set(this.getFramebuffer("coords").framebuffer),te.readPixels(se,_e-de-1,1,1,te.RGBA,te.UNSIGNED_BYTE,G),J.bindFramebuffer.set(null);const ge=G[0]+(G[2]>>4<<8),xe=G[1]+((15&G[2])<<8),Se=this.coordsIndex[255-G[3]],Oe=Se&&this.sourceCache.getTileByID(Se);if(!Oe)return null;const Ae=this._coordsTextureSize,je=(1<<Oe.tileID.canonical.z)*Ae;return new R.a0((Oe.tileID.canonical.x*Ae+ge)/je+Oe.tileID.wrap,(Oe.tileID.canonical.y*Ae+xe)/je,this.getElevation(Oe.tileID,ge,xe,Ae))}depthAtPoint(t){const G=new Uint8Array(4),J=this.painter.context,te=J.gl;return J.bindFramebuffer.set(this.getFramebuffer("depth").framebuffer),te.readPixels(t.x,this.painter.height/devicePixelRatio-t.y-1,1,1,te.RGBA,te.UNSIGNED_BYTE,G),J.bindFramebuffer.set(null),(G[0]/16777216+G[1]/65536+G[2]/256+G[3])/256}getTerrainMesh(t){var G;const J=((G=this.painter.style.projection)===null||G===void 0?void 0:G.transitionState)>0,te=J&&t.canonical.y===0,se=J&&t.canonical.y===(1<<t.canonical.z)-1,de=`m_${te?"n":""}_${se?"s":""}`;if(this._meshCache[de])return this._meshCache[de];const _e=this.painter.context,ge=new R.cu,xe=new R.aM,Se=this.meshSize,Oe=R.$/Se,Ae=Se*Se;for(let vt=0;vt<=Se;vt++)for(let kt=0;kt<=Se;kt++)ge.emplaceBack(kt*Oe,vt*Oe,0);for(let vt=0;vt<Ae;vt+=Se+1)for(let kt=0;kt<Se;kt++)xe.emplaceBack(kt+vt,Se+kt+vt+1,Se+kt+vt+2),xe.emplaceBack(kt+vt,Se+kt+vt+2,kt+vt+1);const je=ge.length,Ye=je+(Se+1),at=(Se+1)*Se,nt=te?R.bg:0,ot=te?0:1,ht=se?R.bh:R.$,xt=se?0:1;for(let vt=0;vt<=Se;vt++)ge.emplaceBack(vt*Oe,nt,ot);for(let vt=0;vt<=Se;vt++)ge.emplaceBack(vt*Oe,ht,xt);for(let vt=0;vt<Se;vt++)xe.emplaceBack(at+vt,Ye+vt,Ye+vt+1),xe.emplaceBack(at+vt,Ye+vt+1,at+vt+1),xe.emplaceBack(0+vt,je+vt+1,je+vt),xe.emplaceBack(0+vt,0+vt+1,je+vt+1);const mt=ge.length,Tt=mt+2*(Se+1);for(const vt of[0,1])for(let kt=0;kt<=Se;kt++)for(const Vt of[0,1])ge.emplaceBack(vt*R.$,kt*Oe,Vt);for(let vt=0;vt<2*Se;vt+=2)xe.emplaceBack(mt+vt,mt+vt+1,mt+vt+3),xe.emplaceBack(mt+vt,mt+vt+3,mt+vt+2),xe.emplaceBack(Tt+vt,Tt+vt+3,Tt+vt+1),xe.emplaceBack(Tt+vt,Tt+vt+2,Tt+vt+3);const Pt=new Wn(_e.createVertexBuffer(ge,$l.members),_e.createIndexBuffer(xe),R.aL.simpleSegment(0,0,ge.length,xe.length));return this._meshCache[de]=Pt,Pt}getMeshFrameDelta(t){return 2*Math.PI*R.bt/Math.pow(2,Math.max(t,0))/5}getMinTileElevationForLngLatZoom(t,G){var J;const{tileID:te}=this._getOverscaledTileIDFromLngLatZoom(t,G);return(J=this.getMinMaxElevation(te).minElevation)!==null&&J!==void 0?J:0}getMinMaxElevation(t){const G=this.getTerrainData(t).tile,J={minElevation:null,maxElevation:null};return G&&G.dem&&(J.minElevation=G.dem.min*this.exaggeration,J.maxElevation=G.dem.max*this.exaggeration),J}_getOverscaledTileIDFromLngLatZoom(t,G){const J=R.a0.fromLngLat(t.wrap()),te=(1<<G)*R.$,se=J.x*te,de=J.y*te,_e=Math.floor(se/R.$),ge=Math.floor(de/R.$);return{tileID:new R.Z(G,0,G,_e,ge),mercatorX:se,mercatorY:de}}}class As{constructor(t,G,J){this._context=t,this._size=G,this._tileSize=J,this._objects=[],this._recentlyUsed=[],this._stamp=0}destruct(){for(const t of this._objects)t.texture.destroy(),t.fbo.destroy()}_createObject(t){const G=this._context.createFramebuffer(this._tileSize,this._tileSize,!0,!0),J=new R.T(this._context,{width:this._tileSize,height:this._tileSize,data:null},this._context.gl.RGBA);return J.bind(this._context.gl.LINEAR,this._context.gl.CLAMP_TO_EDGE),this._context.extTextureFilterAnisotropic&&this._context.gl.texParameterf(this._context.gl.TEXTURE_2D,this._context.extTextureFilterAnisotropic.TEXTURE_MAX_ANISOTROPY_EXT,this._context.extTextureFilterAnisotropicMax),G.depthAttachment.set(this._context.createRenderbuffer(this._context.gl.DEPTH_STENCIL,this._tileSize,this._tileSize)),G.colorAttachment.set(J.texture),{id:t,fbo:G,texture:J,stamp:-1,inUse:!1}}getObjectForId(t){return this._objects[t]}useObject(t){t.inUse=!0,this._recentlyUsed=this._recentlyUsed.filter(G=>t.id!==G),this._recentlyUsed.push(t.id)}stampObject(t){t.stamp=++this._stamp}getOrCreateFreeObject(){for(const G of this._recentlyUsed)if(!this._objects[G].inUse)return this._objects[G];if(this._objects.length>=this._size)throw new Error("No free RenderPool available, call freeAllObjects() required!");const t=this._createObject(this._objects.length);return this._objects.push(t),t}freeObject(t){t.inUse=!1}freeAllObjects(){for(const t of this._objects)this.freeObject(t)}isFull(){return!(this._objects.length<this._size)&&this._objects.some(t=>!t.inUse)===!1}}const Or={background:!0,fill:!0,line:!0,raster:!0,hillshade:!0,"color-relief":!0};class Vr{constructor(t,G){this.painter=t,this.terrain=G,this.pool=new As(t.context,30,G.sourceCache.tileSize*G.qualityFactor)}destruct(){this.pool.destruct()}getTexture(t){return this.pool.getObjectForId(t.rtt[this._stacks.length-1].id).texture}prepareForRender(t,G){this._stacks=[],this._prevType=null,this._rttTiles=[],this._renderableTiles=this.terrain.sourceCache.getRenderableTiles(),this._renderableLayerIds=t._order.filter(J=>!t._layers[J].isHidden(G)),this._coordsAscending={};for(const J in t.sourceCaches){this._coordsAscending[J]={};const te=t.sourceCaches[J].getVisibleCoordinates(),se=t.sourceCaches[J].getSource(),de=se instanceof Br?se.terrainTileRanges:null;for(const _e of te){const ge=this.terrain.sourceCache.getTerrainCoords(_e,de);for(const xe in ge)this._coordsAscending[J][xe]||(this._coordsAscending[J][xe]=[]),this._coordsAscending[J][xe].push(ge[xe])}}this._coordsAscendingStr={};for(const J of t._order){const te=t._layers[J],se=te.source;if(Or[te.type]&&!this._coordsAscendingStr[se]){this._coordsAscendingStr[se]={};for(const de in this._coordsAscending[se])this._coordsAscendingStr[se][de]=this._coordsAscending[se][de].map(_e=>_e.key).sort().join()}}for(const J of this._renderableTiles)for(const te in this._coordsAscendingStr){const se=this._coordsAscendingStr[te][J.tileID.key];se&&se!==J.rttCoords[te]&&(J.rtt=[])}}renderLayer(t,G){if(t.isHidden(this.painter.transform.zoom))return!1;const J=Object.assign(Object.assign({},G),{isRenderingToTexture:!0}),te=t.type,se=this.painter,de=this._renderableLayerIds[this._renderableLayerIds.length-1]===t.id;if(Or[te]&&(this._prevType&&Or[this._prevType]||this._stacks.push([]),this._prevType=te,this._stacks[this._stacks.length-1].push(t.id),!de))return!0;if(Or[this._prevType]||Or[te]&&de){this._prevType=te;const _e=this._stacks.length-1,ge=this._stacks[_e]||[];for(const xe of this._renderableTiles){if(this.pool.isFull()&&(Mi(this.painter,this.terrain,this._rttTiles,J),this._rttTiles=[],this.pool.freeAllObjects()),this._rttTiles.push(xe),xe.rtt[_e]){const Oe=this.pool.getObjectForId(xe.rtt[_e].id);if(Oe.stamp===xe.rtt[_e].stamp){this.pool.useObject(Oe);continue}}const Se=this.pool.getOrCreateFreeObject();this.pool.useObject(Se),this.pool.stampObject(Se),xe.rtt[_e]={id:Se.id,stamp:Se.stamp},se.context.bindFramebuffer.set(Se.fbo.framebuffer),se.context.clear({color:R.be.transparent,stencil:0}),se.currentStencilSource=void 0;for(let Oe=0;Oe<ge.length;Oe++){const Ae=se.style._layers[ge[Oe]],je=Ae.source?this._coordsAscending[Ae.source][xe.tileID.key]:[xe.tileID];se.context.viewport.set([0,0,Se.fbo.width,Se.fbo.height]),se._renderTileClippingMasks(Ae,je,!0),se.renderLayer(se,se.style.sourceCaches[Ae.source],Ae,je,J),Ae.source&&(xe.rttCoords[Ae.source]=this._coordsAscendingStr[Ae.source][xe.tileID.key])}}return Mi(this.painter,this.terrain,this._rttTiles,J),this._rttTiles=[],this.pool.freeAllObjects(),Or[te]}return!1}}const Ps={"AttributionControl.ToggleAttribution":"Toggle attribution","AttributionControl.MapFeedback":"Map feedback","FullscreenControl.Enter":"Enter fullscreen","FullscreenControl.Exit":"Exit fullscreen","GeolocateControl.FindMyLocation":"Find my location","GeolocateControl.LocationNotAvailable":"Location not available","LogoControl.Title":"MapLibre logo","Map.Title":"Map","Marker.Title":"Map marker","NavigationControl.ResetBearing":"Reset bearing to north","NavigationControl.ZoomIn":"Zoom in","NavigationControl.ZoomOut":"Zoom out","Popup.Close":"Close popup","ScaleControl.Feet":"ft","ScaleControl.Meters":"m","ScaleControl.Kilometers":"km","ScaleControl.Miles":"mi","ScaleControl.NauticalMiles":"nm","GlobeControl.Enable":"Enable globe","GlobeControl.Disable":"Disable globe","TerrainControl.Enable":"Enable terrain","TerrainControl.Disable":"Disable terrain","CooperativeGesturesHandler.WindowsHelpText":"Use Ctrl + scroll to zoom the map","CooperativeGesturesHandler.MacHelpText":"Use ⌘ + scroll to zoom the map","CooperativeGesturesHandler.MobileHelpText":"Use two fingers to move the map"},Mu=U,Lo={hash:!1,interactive:!0,bearingSnap:7,attributionControl:ko,maplibreLogo:!1,refreshExpiredTiles:!0,canvasContextAttributes:{antialias:!1,preserveDrawingBuffer:!1,powerPreference:"high-performance",failIfMajorPerformanceCaveat:!1,desynchronized:!1,contextType:void 0},scrollZoom:!0,minZoom:-2,maxZoom:22,minPitch:0,maxPitch:60,boxZoom:!0,dragRotate:!0,dragPan:!0,keyboard:!0,doubleClickZoom:!0,touchZoomRotate:!0,touchPitch:!0,cooperativeGestures:!1,trackResize:!0,center:[0,0],elevation:0,zoom:0,bearing:0,pitch:0,roll:0,renderWorldCopies:!0,maxTileCacheSize:null,maxTileCacheZoomLevels:R.a.MAX_TILE_CACHE_ZOOM_LEVELS,transformRequest:null,transformCameraUpdate:null,fadeDuration:300,crossSourceCollisions:!0,clickTolerance:3,localIdeographFontFamily:"sans-serif",pitchWithRotate:!0,rollEnabled:!1,validateStyle:!0,maxCanvasSize:[4096,4096],cancelPendingTileRequestsWhileZooming:!0,centerClampedToGround:!0},pn={showCompass:!0,showZoom:!0,visualizePitch:!1,visualizeRoll:!0};class Wl{constructor(t,G,J=!1){this.mousedown=se=>{this.startMove(se,me.mousePos(this.element,se)),me.addEventListener(window,"mousemove",this.mousemove),me.addEventListener(window,"mouseup",this.mouseup)},this.mousemove=se=>{this.move(se,me.mousePos(this.element,se))},this.mouseup=se=>{this._rotatePitchHanlder.dragEnd(se),this.offTemp()},this.touchstart=se=>{se.targetTouches.length!==1?this.reset():(this._startPos=this._lastPos=me.touchPos(this.element,se.targetTouches)[0],this.startMove(se,this._startPos),me.addEventListener(window,"touchmove",this.touchmove,{passive:!1}),me.addEventListener(window,"touchend",this.touchend))},this.touchmove=se=>{se.targetTouches.length!==1?this.reset():(this._lastPos=me.touchPos(this.element,se.targetTouches)[0],this.move(se,this._lastPos))},this.touchend=se=>{se.targetTouches.length===0&&this._startPos&&this._lastPos&&this._startPos.dist(this._lastPos)<this._clickTolerance&&this.element.click(),delete this._startPos,delete this._lastPos,this.offTemp()},this.reset=()=>{this._rotatePitchHanlder.reset(),delete this._startPos,delete this._lastPos,this.offTemp()},this._clickTolerance=10,this.element=G;const te=new Mc;this._rotatePitchHanlder=new Qa({clickTolerance:3,move:(se,de)=>{const _e=G.getBoundingClientRect(),ge=new R.P((_e.bottom-_e.top)/2,(_e.right-_e.left)/2);return{bearingDelta:R.cm(new R.P(se.x,de.y),de,ge),pitchDelta:J?-.5*(de.y-se.y):void 0}},moveStateManager:te,enable:!0,assignEvents:()=>{}}),this.map=t,me.addEventListener(G,"mousedown",this.mousedown),me.addEventListener(G,"touchstart",this.touchstart,{passive:!1}),me.addEventListener(G,"touchcancel",this.reset)}startMove(t,G){this._rotatePitchHanlder.dragStart(t,G),me.disableDrag()}move(t,G){const J=this.map,{bearingDelta:te,pitchDelta:se}=this._rotatePitchHanlder.dragMove(t,G)||{};te&&J.setBearing(J.getBearing()+te),se&&J.setPitch(J.getPitch()+se)}off(){const t=this.element;me.removeEventListener(t,"mousedown",this.mousedown),me.removeEventListener(t,"touchstart",this.touchstart,{passive:!1}),me.removeEventListener(window,"touchmove",this.touchmove,{passive:!1}),me.removeEventListener(window,"touchend",this.touchend),me.removeEventListener(t,"touchcancel",this.reset),this.offTemp()}offTemp(){me.enableDrag(),me.removeEventListener(window,"mousemove",this.mousemove),me.removeEventListener(window,"mouseup",this.mouseup),me.removeEventListener(window,"touchmove",this.touchmove,{passive:!1}),me.removeEventListener(window,"touchend",this.touchend)}}let Qi;function Hl(oe,t,G,J=!1){if(J||!G.getCoveringTilesDetailsProvider().allowWorldCopies())return oe==null?void 0:oe.wrap();const te=new R.S(oe.lng,oe.lat);if(oe=new R.S(oe.lng,oe.lat),t){const se=new R.S(oe.lng-360,oe.lat),de=new R.S(oe.lng+360,oe.lat),_e=G.locationToScreenPoint(oe).distSqr(t);G.locationToScreenPoint(se).distSqr(t)<_e?oe=se:G.locationToScreenPoint(de).distSqr(t)<_e&&(oe=de)}for(;Math.abs(oe.lng-G.center.lng)>180;){const se=G.locationToScreenPoint(oe);if(se.x>=0&&se.y>=0&&se.x<=G.width&&se.y<=G.height)break;oe.lng>G.center.lng?oe.lng-=360:oe.lng+=360}return oe.lng!==te.lng&&G.isPointOnMapSurface(G.locationToScreenPoint(oe))?oe:te}const Ta={center:"translate(-50%,-50%)",top:"translate(-50%,0)","top-left":"translate(0,0)","top-right":"translate(-100%,0)",bottom:"translate(-50%,-100%)","bottom-left":"translate(0,-100%)","bottom-right":"translate(-100%,-100%)",left:"translate(0,-50%)",right:"translate(-100%,-50%)"};function Ii(oe,t,G){const J=oe.classList;for(const te in Ta)J.remove(`maplibregl-${G}-anchor-${te}`);J.add(`maplibregl-${G}-anchor-${t}`)}class Di extends R.E{constructor(t){if(super(),this._onKeyPress=G=>{const J=G.code,te=G.charCode||G.keyCode;J!=="Space"&&J!=="Enter"&&te!==32&&te!==13||this.togglePopup()},this._onMapClick=G=>{const J=G.originalEvent.target,te=this._element;this._popup&&(J===te||te.contains(J))&&this.togglePopup()},this._update=G=>{if(!this._map)return;const J=this._map.loaded()&&!this._map.isMoving();((G==null?void 0:G.type)==="terrain"||(G==null?void 0:G.type)==="render"&&!J)&&this._map.once("render",this._update),this._lngLat=Hl(this._lngLat,this._flatPos,this._map.transform),this._flatPos=this._pos=this._map.project(this._lngLat)._add(this._offset),this._map.terrain&&(this._flatPos=this._map.transform.locationToScreenPoint(this._lngLat)._add(this._offset));let te="";this._rotationAlignment==="viewport"||this._rotationAlignment==="auto"?te=`rotateZ(${this._rotation}deg)`:this._rotationAlignment==="map"&&(te=`rotateZ(${this._rotation-this._map.getBearing()}deg)`);let se="";this._pitchAlignment==="viewport"||this._pitchAlignment==="auto"?se="rotateX(0deg)":this._pitchAlignment==="map"&&(se=`rotateX(${this._map.getPitch()}deg)`),this._subpixelPositioning||G&&G.type!=="moveend"||(this._pos=this._pos.round()),me.setTransform(this._element,`${Ta[this._anchor]} translate(${this._pos.x}px, ${this._pos.y}px) ${se} ${te}`),pe.frameAsync(new AbortController).then(()=>{this._updateOpacity(G&&G.type==="moveend")}).catch(()=>{})},this._onMove=G=>{if(!this._isDragging){const J=this._clickTolerance||this._map._clickTolerance;this._isDragging=G.point.dist(this._pointerdownPos)>=J}this._isDragging&&(this._pos=G.point.sub(this._positionDelta),this._lngLat=this._map.unproject(this._pos),this.setLngLat(this._lngLat),this._element.style.pointerEvents="none",this._state==="pending"&&(this._state="active",this.fire(new R.l("dragstart"))),this.fire(new R.l("drag")))},this._onUp=()=>{this._element.style.pointerEvents="auto",this._positionDelta=null,this._pointerdownPos=null,this._isDragging=!1,this._map.off("mousemove",this._onMove),this._map.off("touchmove",this._onMove),this._state==="active"&&this.fire(new R.l("dragend")),this._state="inactive"},this._addDragHandler=G=>{this._element.contains(G.originalEvent.target)&&(G.preventDefault(),this._positionDelta=G.point.sub(this._pos).add(this._offset),this._pointerdownPos=G.point,this._state="pending",this._map.on("mousemove",this._onMove),this._map.on("touchmove",this._onMove),this._map.once("mouseup",this._onUp),this._map.once("touchend",this._onUp))},this._anchor=t&&t.anchor||"center",this._color=t&&t.color||"#3FB1CE",this._scale=t&&t.scale||1,this._draggable=t&&t.draggable||!1,this._clickTolerance=t&&t.clickTolerance||0,this._subpixelPositioning=t&&t.subpixelPositioning||!1,this._isDragging=!1,this._state="inactive",this._rotation=t&&t.rotation||0,this._rotationAlignment=t&&t.rotationAlignment||"auto",this._pitchAlignment=t&&t.pitchAlignment&&t.pitchAlignment!=="auto"?t.pitchAlignment:this._rotationAlignment,this.setOpacity(t==null?void 0:t.opacity,t==null?void 0:t.opacityWhenCovered),t&&t.element)this._element=t.element,this._offset=R.P.convert(t&&t.offset||[0,0]);else{this._defaultMarker=!0,this._element=me.create("div");const G=me.createNS("http://www.w3.org/2000/svg","svg"),J=41,te=27;G.setAttributeNS(null,"display","block"),G.setAttributeNS(null,"height",`${J}px`),G.setAttributeNS(null,"width",`${te}px`),G.setAttributeNS(null,"viewBox",`0 0 ${te} ${J}`);const se=me.createNS("http://www.w3.org/2000/svg","g");se.setAttributeNS(null,"stroke","none"),se.setAttributeNS(null,"stroke-width","1"),se.setAttributeNS(null,"fill","none"),se.setAttributeNS(null,"fill-rule","evenodd");const de=me.createNS("http://www.w3.org/2000/svg","g");de.setAttributeNS(null,"fill-rule","nonzero");const _e=me.createNS("http://www.w3.org/2000/svg","g");_e.setAttributeNS(null,"transform","translate(3.0, 29.0)"),_e.setAttributeNS(null,"fill","#000000");const ge=[{rx:"10.5",ry:"5.25002273"},{rx:"10.5",ry:"5.25002273"},{rx:"9.5",ry:"4.77275007"},{rx:"8.5",ry:"4.29549936"},{rx:"7.5",ry:"3.81822308"},{rx:"6.5",ry:"3.34094679"},{rx:"5.5",ry:"2.86367051"},{rx:"4.5",ry:"2.38636864"}];for(const ot of ge){const ht=me.createNS("http://www.w3.org/2000/svg","ellipse");ht.setAttributeNS(null,"opacity","0.04"),ht.setAttributeNS(null,"cx","10.5"),ht.setAttributeNS(null,"cy","5.80029008"),ht.setAttributeNS(null,"rx",ot.rx),ht.setAttributeNS(null,"ry",ot.ry),_e.appendChild(ht)}const xe=me.createNS("http://www.w3.org/2000/svg","g");xe.setAttributeNS(null,"fill",this._color);const Se=me.createNS("http://www.w3.org/2000/svg","path");Se.setAttributeNS(null,"d","M27,13.5 C27,19.074644 20.250001,27.000002 14.75,34.500002 C14.016665,35.500004 12.983335,35.500004 12.25,34.500002 C6.7499993,27.000002 0,19.222562 0,13.5 C0,6.0441559 6.0441559,0 13.5,0 C20.955844,0 27,6.0441559 27,13.5 Z"),xe.appendChild(Se);const Oe=me.createNS("http://www.w3.org/2000/svg","g");Oe.setAttributeNS(null,"opacity","0.25"),Oe.setAttributeNS(null,"fill","#000000");const Ae=me.createNS("http://www.w3.org/2000/svg","path");Ae.setAttributeNS(null,"d","M13.5,0 C6.0441559,0 0,6.0441559 0,13.5 C0,19.222562 6.7499993,27 12.25,34.5 C13,35.522727 14.016664,35.500004 14.75,34.5 C20.250001,27 27,19.074644 27,13.5 C27,6.0441559 20.955844,0 13.5,0 Z M13.5,1 C20.415404,1 26,6.584596 26,13.5 C26,15.898657 24.495584,19.181431 22.220703,22.738281 C19.945823,26.295132 16.705119,30.142167 13.943359,33.908203 C13.743445,34.180814 13.612715,34.322738 13.5,34.441406 C13.387285,34.322738 13.256555,34.180814 13.056641,33.908203 C10.284481,30.127985 7.4148684,26.314159 5.015625,22.773438 C2.6163816,19.232715 1,15.953538 1,13.5 C1,6.584596 6.584596,1 13.5,1 Z"),Oe.appendChild(Ae);const je=me.createNS("http://www.w3.org/2000/svg","g");je.setAttributeNS(null,"transform","translate(6.0, 7.0)"),je.setAttributeNS(null,"fill","#FFFFFF");const Ye=me.createNS("http://www.w3.org/2000/svg","g");Ye.setAttributeNS(null,"transform","translate(8.0, 8.0)");const at=me.createNS("http://www.w3.org/2000/svg","circle");at.setAttributeNS(null,"fill","#000000"),at.setAttributeNS(null,"opacity","0.25"),at.setAttributeNS(null,"cx","5.5"),at.setAttributeNS(null,"cy","5.5"),at.setAttributeNS(null,"r","5.4999962");const nt=me.createNS("http://www.w3.org/2000/svg","circle");nt.setAttributeNS(null,"fill","#FFFFFF"),nt.setAttributeNS(null,"cx","5.5"),nt.setAttributeNS(null,"cy","5.5"),nt.setAttributeNS(null,"r","5.4999962"),Ye.appendChild(at),Ye.appendChild(nt),de.appendChild(_e),de.appendChild(xe),de.appendChild(Oe),de.appendChild(je),de.appendChild(Ye),G.appendChild(de),G.setAttributeNS(null,"height",J*this._scale+"px"),G.setAttributeNS(null,"width",te*this._scale+"px"),this._element.appendChild(G),this._offset=R.P.convert(t&&t.offset||[0,-14])}if(this._element.classList.add("maplibregl-marker"),this._element.addEventListener("dragstart",G=>{G.preventDefault()}),this._element.addEventListener("mousedown",G=>{G.preventDefault()}),Ii(this._element,this._anchor,"marker"),t&&t.className)for(const G of t.className.split(" "))this._element.classList.add(G);this._popup=null}addTo(t){return this.remove(),this._map=t,this._element.hasAttribute("aria-label")||this._element.setAttribute("aria-label",t._getUIString("Marker.Title")),t.getCanvasContainer().appendChild(this._element),t.on("move",this._update),t.on("moveend",this._update),t.on("terrain",this._update),t.on("projectiontransition",this._update),this.setDraggable(this._draggable),this._update(),this._map.on("click",this._onMapClick),this}remove(){return this._opacityTimeout&&(clearTimeout(this._opacityTimeout),delete this._opacityTimeout),this._map&&(this._map.off("click",this._onMapClick),this._map.off("move",this._update),this._map.off("moveend",this._update),this._map.off("terrain",this._update),this._map.off("projectiontransition",this._update),this._map.off("mousedown",this._addDragHandler),this._map.off("touchstart",this._addDragHandler),this._map.off("mouseup",this._onUp),this._map.off("touchend",this._onUp),this._map.off("mousemove",this._onMove),this._map.off("touchmove",this._onMove),delete this._map),me.remove(this._element),this._popup&&this._popup.remove(),this}getLngLat(){return this._lngLat}setLngLat(t){return this._lngLat=R.S.convert(t),this._pos=null,this._popup&&this._popup.setLngLat(this._lngLat),this._update(),this}getElement(){return this._element}setPopup(t){if(this._popup&&(this._popup.remove(),this._popup=null,this._element.removeEventListener("keypress",this._onKeyPress),this._originalTabIndex||this._element.removeAttribute("tabindex")),t){if(!("offset"in t.options)){const te=Math.abs(13.5)/Math.SQRT2;t.options.offset=this._defaultMarker?{top:[0,0],"top-left":[0,0],"top-right":[0,0],bottom:[0,-38.1],"bottom-left":[te,-1*(38.1-13.5+te)],"bottom-right":[-te,-1*(38.1-13.5+te)],left:[13.5,-1*(38.1-13.5)],right:[-13.5,-1*(38.1-13.5)]}:this._offset}this._popup=t,this._originalTabIndex=this._element.getAttribute("tabindex"),this._originalTabIndex||this._element.setAttribute("tabindex","0"),this._element.addEventListener("keypress",this._onKeyPress)}return this}setSubpixelPositioning(t){return this._subpixelPositioning=t,this}getPopup(){return this._popup}togglePopup(){const t=this._popup;return this._element.style.opacity===this._opacityWhenCovered?this:t?(t.isOpen()?t.remove():(t.setLngLat(this._lngLat),t.addTo(this._map)),this):this}_updateOpacity(t=!1){var G,J;const te=(G=this._map)===null||G===void 0?void 0:G.terrain,se=this._map.transform.isLocationOccluded(this._lngLat);if(!te||se){const je=se?this._opacityWhenCovered:this._opacity;return void(this._element.style.opacity!==je&&(this._element.style.opacity=je))}if(t)this._opacityTimeout=null;else{if(this._opacityTimeout)return;this._opacityTimeout=setTimeout(()=>{this._opacityTimeout=null},100)}const de=this._map,_e=de.terrain.depthAtPoint(this._pos),ge=de.terrain.getElevationForLngLatZoom(this._lngLat,de.transform.tileZoom);if(de.transform.lngLatToCameraDepth(this._lngLat,ge)-_e<.006)return void(this._element.style.opacity=this._opacity);const xe=-this._offset.y/de.transform.pixelsPerMeter,Se=Math.sin(de.getPitch()*Math.PI/180)*xe,Oe=de.terrain.depthAtPoint(new R.P(this._pos.x,this._pos.y-this._offset.y)),Ae=de.transform.lngLatToCameraDepth(this._lngLat,ge+Se)-Oe>.006;!((J=this._popup)===null||J===void 0)&&J.isOpen()&&Ae&&this._popup.remove(),this._element.style.opacity=Ae?this._opacityWhenCovered:this._opacity}getOffset(){return this._offset}setOffset(t){return this._offset=R.P.convert(t),this._update(),this}addClassName(t){this._element.classList.add(t)}removeClassName(t){this._element.classList.remove(t)}toggleClassName(t){return this._element.classList.toggle(t)}setDraggable(t){return this._draggable=!!t,this._map&&(t?(this._map.on("mousedown",this._addDragHandler),this._map.on("touchstart",this._addDragHandler)):(this._map.off("mousedown",this._addDragHandler),this._map.off("touchstart",this._addDragHandler))),this}isDraggable(){return this._draggable}setRotation(t){return this._rotation=t||0,this._update(),this}getRotation(){return this._rotation}setRotationAlignment(t){return this._rotationAlignment=t||"auto",this._update(),this}getRotationAlignment(){return this._rotationAlignment}setPitchAlignment(t){return this._pitchAlignment=t&&t!=="auto"?t:this._rotationAlignment,this._update(),this}getPitchAlignment(){return this._pitchAlignment}setOpacity(t,G){return(this._opacity===void 0||t===void 0&&G===void 0)&&(this._opacity="1",this._opacityWhenCovered="0.2"),t!==void 0&&(this._opacity=t),G!==void 0&&(this._opacityWhenCovered=G),this._map&&this._updateOpacity(!0),this}}const Zl={positionOptions:{enableHighAccuracy:!1,maximumAge:0,timeout:6e3},fitBoundsOptions:{maxZoom:15},trackUserLocation:!1,showAccuracyCircle:!0,showUserLocation:!0};let la=0,ca=!1;const Du={maxWidth:100,unit:"metric"};function Os(oe,t,G){const J=G&&G.maxWidth||100,te=oe._container.clientHeight/2,se=oe._container.clientWidth/2,de=oe.unproject([se-J/2,te]),_e=oe.unproject([se+J/2,te]),ge=Math.round(oe.project(_e).x-oe.project(de).x),xe=Math.min(J,ge,oe._container.clientWidth),Se=de.distanceTo(_e);if(G&&G.unit==="imperial"){const Oe=3.2808*Se;Oe>5280?Ia(t,xe,Oe/5280,oe._getUIString("ScaleControl.Miles")):Ia(t,xe,Oe,oe._getUIString("ScaleControl.Feet"))}else G&&G.unit==="nautical"?Ia(t,xe,Se/1852,oe._getUIString("ScaleControl.NauticalMiles")):Se>=1e3?Ia(t,xe,Se/1e3,oe._getUIString("ScaleControl.Kilometers")):Ia(t,xe,Se,oe._getUIString("ScaleControl.Meters"))}function Ia(oe,t,G,J){const te=function(se){const de=Math.pow(10,`${Math.floor(se)}`.length-1);let _e=se/de;return _e=_e>=10?10:_e>=5?5:_e>=3?3:_e>=2?2:_e>=1?1:function(ge){const xe=Math.pow(10,Math.ceil(-Math.log(ge)/Math.LN10));return Math.round(ge*xe)/xe}(_e),de*_e}(G);oe.style.width=t*(te/G)+"px",oe.innerHTML=`${te}&nbsp;${J}`}const Bo={closeButton:!0,closeOnClick:!0,focusAfterOpen:!0,className:"",maxWidth:"240px",subpixelPositioning:!1,locationOccludedOpacity:void 0},Fu=["a[href]","[tabindex]:not([tabindex='-1'])","[contenteditable]:not([contenteditable='false'])","button:not([disabled])","input:not([disabled])","select:not([disabled])","textarea:not([disabled])"].join(", ");function Cs(oe){if(oe){if(typeof oe=="number"){const t=Math.round(Math.abs(oe)/Math.SQRT2);return{center:new R.P(0,0),top:new R.P(0,oe),"top-left":new R.P(t,t),"top-right":new R.P(-t,t),bottom:new R.P(0,-oe),"bottom-left":new R.P(t,-t),"bottom-right":new R.P(-t,-t),left:new R.P(oe,0),right:new R.P(-oe,0)}}if(oe instanceof R.P||Array.isArray(oe)){const t=R.P.convert(oe);return{center:t,top:t,"top-left":t,"top-right":t,bottom:t,"bottom-left":t,"bottom-right":t,left:t,right:t}}return{center:R.P.convert(oe.center||[0,0]),top:R.P.convert(oe.top||[0,0]),"top-left":R.P.convert(oe["top-left"]||[0,0]),"top-right":R.P.convert(oe["top-right"]||[0,0]),bottom:R.P.convert(oe.bottom||[0,0]),"bottom-left":R.P.convert(oe["bottom-left"]||[0,0]),"bottom-right":R.P.convert(oe["bottom-right"]||[0,0]),left:R.P.convert(oe.left||[0,0]),right:R.P.convert(oe.right||[0,0])}}return Cs(new R.P(0,0))}const ku=U;Q.AJAXError=R.cy,Q.Event=R.l,Q.Evented=R.E,Q.LngLat=R.S,Q.MercatorCoordinate=R.a0,Q.Point=R.P,Q.addProtocol=R.cz,Q.config=R.a,Q.removeProtocol=R.cA,Q.AttributionControl=Rs,Q.BoxZoomHandler=Su,Q.CanvasSource=rr,Q.CooperativeGesturesHandler=Gl,Q.DoubleClickZoomHandler=Ts,Q.DragPanHandler=Au,Q.DragRotateHandler=Is,Q.EdgeInsets=Rn,Q.FullscreenControl=class extends R.E{constructor(oe={}){super(),this._onFullscreenChange=()=>{var t;let G=window.document.fullscreenElement||window.document.mozFullScreenElement||window.document.webkitFullscreenElement||window.document.msFullscreenElement;for(;!((t=G==null?void 0:G.shadowRoot)===null||t===void 0)&&t.fullscreenElement;)G=G.shadowRoot.fullscreenElement;G===this._container!==this._fullscreen&&this._handleFullscreenChange()},this._onClickFullscreen=()=>{this._isFullscreen()?this._exitFullscreen():this._requestFullscreen()},this._fullscreen=!1,oe&&oe.container&&(oe.container instanceof HTMLElement?this._container=oe.container:R.w("Full screen control 'container' must be a DOM element.")),"onfullscreenchange"in document?this._fullscreenchange="fullscreenchange":"onmozfullscreenchange"in document?this._fullscreenchange="mozfullscreenchange":"onwebkitfullscreenchange"in document?this._fullscreenchange="webkitfullscreenchange":"onmsfullscreenchange"in document&&(this._fullscreenchange="MSFullscreenChange")}onAdd(oe){return this._map=oe,this._container||(this._container=this._map.getContainer()),this._controlContainer=me.create("div","maplibregl-ctrl maplibregl-ctrl-group"),this._setupUI(),this._controlContainer}onRemove(){me.remove(this._controlContainer),this._map=null,window.document.removeEventListener(this._fullscreenchange,this._onFullscreenChange)}_setupUI(){const oe=this._fullscreenButton=me.create("button","maplibregl-ctrl-fullscreen",this._controlContainer);me.create("span","maplibregl-ctrl-icon",oe).setAttribute("aria-hidden","true"),oe.type="button",this._updateTitle(),this._fullscreenButton.addEventListener("click",this._onClickFullscreen),window.document.addEventListener(this._fullscreenchange,this._onFullscreenChange)}_updateTitle(){const oe=this._getTitle();this._fullscreenButton.setAttribute("aria-label",oe),this._fullscreenButton.title=oe}_getTitle(){return this._map._getUIString(this._isFullscreen()?"FullscreenControl.Exit":"FullscreenControl.Enter")}_isFullscreen(){return this._fullscreen}_handleFullscreenChange(){this._fullscreen=!this._fullscreen,this._fullscreenButton.classList.toggle("maplibregl-ctrl-shrink"),this._fullscreenButton.classList.toggle("maplibregl-ctrl-fullscreen"),this._updateTitle(),this._fullscreen?(this.fire(new R.l("fullscreenstart")),this._prevCooperativeGesturesEnabled=this._map.cooperativeGestures.isEnabled(),this._map.cooperativeGestures.disable()):(this.fire(new R.l("fullscreenend")),this._prevCooperativeGesturesEnabled&&this._map.cooperativeGestures.enable())}_exitFullscreen(){window.document.exitFullscreen?window.document.exitFullscreen():window.document.mozCancelFullScreen?window.document.mozCancelFullScreen():window.document.msExitFullscreen?window.document.msExitFullscreen():window.document.webkitCancelFullScreen?window.document.webkitCancelFullScreen():this._togglePseudoFullScreen()}_requestFullscreen(){this._container.requestFullscreen?this._container.requestFullscreen():this._container.mozRequestFullScreen?this._container.mozRequestFullScreen():this._container.msRequestFullscreen?this._container.msRequestFullscreen():this._container.webkitRequestFullscreen?this._container.webkitRequestFullscreen():this._togglePseudoFullScreen()}_togglePseudoFullScreen(){this._container.classList.toggle("maplibregl-pseudo-fullscreen"),this._handleFullscreenChange(),this._map.resize()}},Q.GeoJSONSource=Lr,Q.GeolocateControl=class extends R.E{constructor(oe){super(),this._onSuccess=t=>{if(this._map){if(this._isOutOfMapMaxBounds(t))return this._setErrorState(),this.fire(new R.l("outofmaxbounds",t)),this._updateMarker(),void this._finish();if(this.options.trackUserLocation)switch(this._lastKnownPosition=t,this._watchState){case"WAITING_ACTIVE":case"ACTIVE_LOCK":case"ACTIVE_ERROR":this._watchState="ACTIVE_LOCK",this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-active-error"),this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-active");break;case"BACKGROUND":case"BACKGROUND_ERROR":this._watchState="BACKGROUND",this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-background-error"),this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-background");break;default:throw new Error(`Unexpected watchState ${this._watchState}`)}this.options.showUserLocation&&this._watchState!=="OFF"&&this._updateMarker(t),this.options.trackUserLocation&&this._watchState!=="ACTIVE_LOCK"||this._updateCamera(t),this.options.showUserLocation&&this._dotElement.classList.remove("maplibregl-user-location-dot-stale"),this.fire(new R.l("geolocate",t)),this._finish()}},this._updateCamera=t=>{const G=new R.S(t.coords.longitude,t.coords.latitude),J=t.coords.accuracy,te=this._map.getBearing(),se=R.e({bearing:te},this.options.fitBoundsOptions),de=wr.fromLngLat(G,J);this._map.fitBounds(de,se,{geolocateSource:!0})},this._updateMarker=t=>{if(t){const G=new R.S(t.coords.longitude,t.coords.latitude);this._accuracyCircleMarker.setLngLat(G).addTo(this._map),this._userLocationDotMarker.setLngLat(G).addTo(this._map),this._accuracy=t.coords.accuracy,this.options.showUserLocation&&this.options.showAccuracyCircle&&this._updateCircleRadius()}else this._userLocationDotMarker.remove(),this._accuracyCircleMarker.remove()},this._onZoom=()=>{this.options.showUserLocation&&this.options.showAccuracyCircle&&this._updateCircleRadius()},this._onError=t=>{if(this._map){if(t.code===1){this._watchState="OFF",this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-active"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-active-error"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-background"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-background-error"),this._geolocateButton.disabled=!0;const G=this._map._getUIString("GeolocateControl.LocationNotAvailable");this._geolocateButton.title=G,this._geolocateButton.setAttribute("aria-label",G),this._geolocationWatchID!==void 0&&this._clearWatch()}else{if(t.code===3&&ca)return;this.options.trackUserLocation&&this._setErrorState()}this._watchState!=="OFF"&&this.options.showUserLocation&&this._dotElement.classList.add("maplibregl-user-location-dot-stale"),this.fire(new R.l("error",t)),this._finish()}},this._finish=()=>{this._timeoutId&&clearTimeout(this._timeoutId),this._timeoutId=void 0},this._setupUI=()=>{this._map&&(this._container.addEventListener("contextmenu",t=>t.preventDefault()),this._geolocateButton=me.create("button","maplibregl-ctrl-geolocate",this._container),me.create("span","maplibregl-ctrl-icon",this._geolocateButton).setAttribute("aria-hidden","true"),this._geolocateButton.type="button",this._geolocateButton.disabled=!0)},this._finishSetupUI=t=>{if(this._map){if(t===!1){R.w("Geolocation support is not available so the GeolocateControl will be disabled.");const G=this._map._getUIString("GeolocateControl.LocationNotAvailable");this._geolocateButton.disabled=!0,this._geolocateButton.title=G,this._geolocateButton.setAttribute("aria-label",G)}else{const G=this._map._getUIString("GeolocateControl.FindMyLocation");this._geolocateButton.disabled=!1,this._geolocateButton.title=G,this._geolocateButton.setAttribute("aria-label",G)}this.options.trackUserLocation&&(this._geolocateButton.setAttribute("aria-pressed","false"),this._watchState="OFF"),this.options.showUserLocation&&(this._dotElement=me.create("div","maplibregl-user-location-dot"),this._userLocationDotMarker=new Di({element:this._dotElement}),this._circleElement=me.create("div","maplibregl-user-location-accuracy-circle"),this._accuracyCircleMarker=new Di({element:this._circleElement,pitchAlignment:"map"}),this.options.trackUserLocation&&(this._watchState="OFF"),this._map.on("zoom",this._onZoom)),this._geolocateButton.addEventListener("click",()=>this.trigger()),this._setup=!0,this.options.trackUserLocation&&this._map.on("movestart",G=>{G.geolocateSource||this._watchState!=="ACTIVE_LOCK"||G.originalEvent&&G.originalEvent.type==="resize"||(this._watchState="BACKGROUND",this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-background"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-active"),this.fire(new R.l("trackuserlocationend")),this.fire(new R.l("userlocationlostfocus")))})}},this.options=R.e({},Zl,oe)}onAdd(oe){return this._map=oe,this._container=me.create("div","maplibregl-ctrl maplibregl-ctrl-group"),this._setupUI(),function(){return R._(this,arguments,void 0,function*(t=!1){if(Qi!==void 0&&!t)return Qi;if(window.navigator.permissions===void 0)return Qi=!!window.navigator.geolocation,Qi;try{Qi=(yield window.navigator.permissions.query({name:"geolocation"})).state!=="denied"}catch{Qi=!!window.navigator.geolocation}return Qi})}().then(t=>this._finishSetupUI(t)),this._container}onRemove(){this._geolocationWatchID!==void 0&&(window.navigator.geolocation.clearWatch(this._geolocationWatchID),this._geolocationWatchID=void 0),this.options.showUserLocation&&this._userLocationDotMarker&&this._userLocationDotMarker.remove(),this.options.showAccuracyCircle&&this._accuracyCircleMarker&&this._accuracyCircleMarker.remove(),me.remove(this._container),this._map.off("zoom",this._onZoom),this._map=void 0,la=0,ca=!1}_isOutOfMapMaxBounds(oe){const t=this._map.getMaxBounds(),G=oe.coords;return t&&(G.longitude<t.getWest()||G.longitude>t.getEast()||G.latitude<t.getSouth()||G.latitude>t.getNorth())}_setErrorState(){switch(this._watchState){case"WAITING_ACTIVE":this._watchState="ACTIVE_ERROR",this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-active"),this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-active-error");break;case"ACTIVE_LOCK":this._watchState="ACTIVE_ERROR",this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-active"),this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-active-error"),this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-waiting");break;case"BACKGROUND":this._watchState="BACKGROUND_ERROR",this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-background"),this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-background-error"),this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-waiting");break;case"ACTIVE_ERROR":break;default:throw new Error(`Unexpected watchState ${this._watchState}`)}}_updateCircleRadius(){const oe=this._map.getBounds(),t=oe.getSouthEast(),G=oe.getNorthEast(),J=t.distanceTo(G),te=Math.ceil(this._accuracy/(J/this._map._container.clientHeight)*2);this._circleElement.style.width=`${te}px`,this._circleElement.style.height=`${te}px`}trigger(){if(!this._setup)return R.w("Geolocate control triggered before added to a map"),!1;if(this.options.trackUserLocation){switch(this._watchState){case"OFF":this._watchState="WAITING_ACTIVE",this.fire(new R.l("trackuserlocationstart"));break;case"WAITING_ACTIVE":case"ACTIVE_LOCK":case"ACTIVE_ERROR":case"BACKGROUND_ERROR":la--,ca=!1,this._watchState="OFF",this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-active"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-active-error"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-background"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-background-error"),this.fire(new R.l("trackuserlocationend"));break;case"BACKGROUND":this._watchState="ACTIVE_LOCK",this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-background"),this._lastKnownPosition&&this._updateCamera(this._lastKnownPosition),this.fire(new R.l("trackuserlocationstart")),this.fire(new R.l("userlocationfocus"));break;default:throw new Error(`Unexpected watchState ${this._watchState}`)}switch(this._watchState){case"WAITING_ACTIVE":this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-waiting"),this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-active");break;case"ACTIVE_LOCK":this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-active");break;case"OFF":break;default:throw new Error(`Unexpected watchState ${this._watchState}`)}if(this._watchState==="OFF"&&this._geolocationWatchID!==void 0)this._clearWatch();else if(this._geolocationWatchID===void 0){let oe;this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-waiting"),this._geolocateButton.setAttribute("aria-pressed","true"),la++,la>1?(oe={maximumAge:6e5,timeout:0},ca=!0):(oe=this.options.positionOptions,ca=!1),this._geolocationWatchID=window.navigator.geolocation.watchPosition(this._onSuccess,this._onError,oe)}}else window.navigator.geolocation.getCurrentPosition(this._onSuccess,this._onError,this.options.positionOptions),this._timeoutId=setTimeout(this._finish,1e4);return!0}_clearWatch(){window.navigator.geolocation.clearWatch(this._geolocationWatchID),this._geolocationWatchID=void 0,this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-waiting"),this._geolocateButton.setAttribute("aria-pressed","false"),this.options.showUserLocation&&this._updateMarker(null)}},Q.GlobeControl=class{constructor(){this._toggleProjection=()=>{var oe;const t=(oe=this._map.getProjection())===null||oe===void 0?void 0:oe.type;this._map.setProjection(t!=="mercator"&&t?{type:"mercator"}:{type:"globe"}),this._updateGlobeIcon()},this._updateGlobeIcon=()=>{var oe;this._globeButton.classList.remove("maplibregl-ctrl-globe"),this._globeButton.classList.remove("maplibregl-ctrl-globe-enabled"),((oe=this._map.getProjection())===null||oe===void 0?void 0:oe.type)==="globe"?(this._globeButton.classList.add("maplibregl-ctrl-globe-enabled"),this._globeButton.title=this._map._getUIString("GlobeControl.Disable")):(this._globeButton.classList.add("maplibregl-ctrl-globe"),this._globeButton.title=this._map._getUIString("GlobeControl.Enable"))}}onAdd(oe){return this._map=oe,this._container=me.create("div","maplibregl-ctrl maplibregl-ctrl-group"),this._globeButton=me.create("button","maplibregl-ctrl-globe",this._container),me.create("span","maplibregl-ctrl-icon",this._globeButton).setAttribute("aria-hidden","true"),this._globeButton.type="button",this._globeButton.addEventListener("click",this._toggleProjection),this._updateGlobeIcon(),this._map.on("styledata",this._updateGlobeIcon),this._container}onRemove(){me.remove(this._container),this._map.off("styledata",this._updateGlobeIcon),this._globeButton.removeEventListener("click",this._toggleProjection),this._map=void 0}},Q.Hash=Po,Q.ImageSource=Br,Q.KeyboardHandler=ro,Q.LngLatBounds=wr,Q.LogoControl=Cu,Q.Map=class extends Si{constructor(oe){var t,G;R.cv.mark(R.cw.create);const J=Object.assign(Object.assign(Object.assign({},Lo),oe),{canvasContextAttributes:Object.assign(Object.assign({},Lo.canvasContextAttributes),oe.canvasContextAttributes)});if(J.minZoom!=null&&J.maxZoom!=null&&J.minZoom>J.maxZoom)throw new Error("maxZoom must be greater than or equal to minZoom");if(J.minPitch!=null&&J.maxPitch!=null&&J.minPitch>J.maxPitch)throw new Error("maxPitch must be greater than or equal to minPitch");if(J.minPitch!=null&&J.minPitch<0)throw new Error("minPitch must be greater than or equal to 0");if(J.maxPitch!=null&&J.maxPitch>180)throw new Error("maxPitch must be less than or equal to 180");const te=new Bi,se=new es;if(J.minZoom!==void 0&&te.setMinZoom(J.minZoom),J.maxZoom!==void 0&&te.setMaxZoom(J.maxZoom),J.minPitch!==void 0&&te.setMinPitch(J.minPitch),J.maxPitch!==void 0&&te.setMaxPitch(J.maxPitch),J.renderWorldCopies!==void 0&&te.setRenderWorldCopies(J.renderWorldCopies),super(te,se,{bearingSnap:J.bearingSnap}),this._idleTriggered=!1,this._crossFadingFactor=1,this._renderTaskQueue=new Vl,this._controls=[],this._mapId=R.a6(),this._contextLost=_e=>{_e.preventDefault(),this._frameRequest&&(this._frameRequest.abort(),this._frameRequest=null),this.fire(new R.l("webglcontextlost",{originalEvent:_e}))},this._contextRestored=_e=>{this._setupPainter(),this.resize(),this._update(),this.fire(new R.l("webglcontextrestored",{originalEvent:_e}))},this._onMapScroll=_e=>{if(_e.target===this._container)return this._container.scrollTop=0,this._container.scrollLeft=0,!1},this._onWindowOnline=()=>{this._update()},this._interactive=J.interactive,this._maxTileCacheSize=J.maxTileCacheSize,this._maxTileCacheZoomLevels=J.maxTileCacheZoomLevels,this._canvasContextAttributes=Object.assign({},J.canvasContextAttributes),this._trackResize=J.trackResize===!0,this._bearingSnap=J.bearingSnap,this._centerClampedToGround=J.centerClampedToGround,this._refreshExpiredTiles=J.refreshExpiredTiles===!0,this._fadeDuration=J.fadeDuration,this._crossSourceCollisions=J.crossSourceCollisions===!0,this._collectResourceTiming=J.collectResourceTiming===!0,this._locale=Object.assign(Object.assign({},Ps),J.locale),this._clickTolerance=J.clickTolerance,this._overridePixelRatio=J.pixelRatio,this._maxCanvasSize=J.maxCanvasSize,this.transformCameraUpdate=J.transformCameraUpdate,this.cancelPendingTileRequestsWhileZooming=J.cancelPendingTileRequestsWhileZooming===!0,this._imageQueueHandle=Fe.addThrottleControl(()=>this.isMoving()),this._requestManager=new ke(J.transformRequest),typeof J.container=="string"){if(this._container=document.getElementById(J.container),!this._container)throw new Error(`Container '${J.container}' not found.`)}else{if(!(J.container instanceof HTMLElement))throw new Error("Invalid type: 'container' must be a String or HTMLElement.");this._container=J.container}if(J.maxBounds&&this.setMaxBounds(J.maxBounds),this._setupContainer(),this._setupPainter(),this.on("move",()=>this._update(!1)),this.on("moveend",()=>this._update(!1)),this.on("zoom",()=>this._update(!0)),this.on("terrain",()=>{this.painter.terrainFacilitator.dirty=!0,this._update(!0)}),this.once("idle",()=>{this._idleTriggered=!0}),typeof window<"u"){addEventListener("online",this._onWindowOnline,!1);let _e=!1;const ge=xs(xe=>{this._trackResize&&!this._removed&&(this.resize(xe),this.redraw())},50);this._resizeObserver=new ResizeObserver(xe=>{_e?ge(xe):_e=!0}),this._resizeObserver.observe(this._container)}this.handlers=new ua(this,J),this._hash=J.hash&&new Po(typeof J.hash=="string"&&J.hash||void 0).addTo(this),this._hash&&this._hash._onHashChange()||(this.jumpTo({center:J.center,elevation:J.elevation,zoom:J.zoom,bearing:J.bearing,pitch:J.pitch,roll:J.roll}),J.bounds&&(this.resize(),this.fitBounds(J.bounds,R.e({},J.fitBoundsOptions,{duration:0}))));const de=typeof J.style=="string"||((G=(t=J.style)===null||t===void 0?void 0:t.projection)===null||G===void 0?void 0:G.type)!=="globe";this.resize(null,de),this._localIdeographFontFamily=J.localIdeographFontFamily,this._validateStyle=J.validateStyle,J.style&&this.setStyle(J.style,{localIdeographFontFamily:J.localIdeographFontFamily}),J.attributionControl&&this.addControl(new Rs(typeof J.attributionControl=="boolean"?void 0:J.attributionControl)),J.maplibreLogo&&this.addControl(new Cu,J.logoPosition),this.on("style.load",()=>{if(de||this._resizeTransform(),this.transform.unmodified){const _e=R.Q(this.style.stylesheet,["center","zoom","bearing","pitch","roll"]);this.jumpTo(_e)}}),this.on("data",_e=>{this._update(_e.dataType==="style"),this.fire(new R.l(`${_e.dataType}data`,_e))}),this.on("dataloading",_e=>{this.fire(new R.l(`${_e.dataType}dataloading`,_e))}),this.on("dataabort",_e=>{this.fire(new R.l("sourcedataabort",_e))})}_getMapId(){return this._mapId}setGlobalStateProperty(oe,t){return this.style.setGlobalStateProperty(oe,t),this._update(!0)}getGlobalState(){return this.style.getGlobalState()}addControl(oe,t){if(t===void 0&&(t=oe.getDefaultPosition?oe.getDefaultPosition():"top-right"),!oe||!oe.onAdd)return this.fire(new R.k(new Error("Invalid argument to map.addControl(). Argument must be a control with onAdd and onRemove methods.")));const G=oe.onAdd(this);this._controls.push(oe);const J=this._controlPositions[t];return t.indexOf("bottom")!==-1?J.insertBefore(G,J.firstChild):J.appendChild(G),this}removeControl(oe){if(!oe||!oe.onRemove)return this.fire(new R.k(new Error("Invalid argument to map.removeControl(). Argument must be a control with onAdd and onRemove methods.")));const t=this._controls.indexOf(oe);return t>-1&&this._controls.splice(t,1),oe.onRemove(this),this}hasControl(oe){return this._controls.indexOf(oe)>-1}calculateCameraOptionsFromTo(oe,t,G,J){return J==null&&this.terrain&&(J=this.terrain.getElevationForLngLatZoom(G,this.transform.tileZoom)),super.calculateCameraOptionsFromTo(oe,t,G,J)}resize(oe,t=!0){const[G,J]=this._containerDimensions(),te=this._getClampedPixelRatio(G,J);if(this._resizeCanvas(G,J,te),this.painter.resize(G,J,te),this.painter.overLimit()){const de=this.painter.context.gl;this._maxCanvasSize=[de.drawingBufferWidth,de.drawingBufferHeight];const _e=this._getClampedPixelRatio(G,J);this._resizeCanvas(G,J,_e),this.painter.resize(G,J,_e)}this._resizeTransform(t);const se=!this._moving;return se&&(this.stop(),this.fire(new R.l("movestart",oe)).fire(new R.l("move",oe))),this.fire(new R.l("resize",oe)),se&&this.fire(new R.l("moveend",oe)),this}_resizeTransform(oe=!0){var t;const[G,J]=this._containerDimensions();this.transform.resize(G,J,oe),(t=this._requestedCameraState)===null||t===void 0||t.resize(G,J,oe)}_getClampedPixelRatio(oe,t){const{0:G,1:J}=this._maxCanvasSize,te=this.getPixelRatio(),se=oe*te,de=t*te;return Math.min(se>G?G/se:1,de>J?J/de:1)*te}getPixelRatio(){var oe;return(oe=this._overridePixelRatio)!==null&&oe!==void 0?oe:devicePixelRatio}setPixelRatio(oe){this._overridePixelRatio=oe,this.resize()}getBounds(){return this.transform.getBounds()}getMaxBounds(){return this.transform.getMaxBounds()}setMaxBounds(oe){return this.transform.setMaxBounds(wr.convert(oe)),this._update()}setMinZoom(oe){if((oe=oe??-2)>=-2&&oe<=this.transform.maxZoom)return this.transform.setMinZoom(oe),this._update(),this.getZoom()<oe&&this.setZoom(oe),this;throw new Error("minZoom must be between -2 and the current maxZoom, inclusive")}getMinZoom(){return this.transform.minZoom}setMaxZoom(oe){if((oe=oe??22)>=this.transform.minZoom)return this.transform.setMaxZoom(oe),this._update(),this.getZoom()>oe&&this.setZoom(oe),this;throw new Error("maxZoom must be greater than the current minZoom")}getMaxZoom(){return this.transform.maxZoom}setMinPitch(oe){if((oe=oe??0)<0)throw new Error("minPitch must be greater than or equal to 0");if(oe>=0&&oe<=this.transform.maxPitch)return this.transform.setMinPitch(oe),this._update(),this.getPitch()<oe&&this.setPitch(oe),this;throw new Error("minPitch must be between 0 and the current maxPitch, inclusive")}getMinPitch(){return this.transform.minPitch}setMaxPitch(oe){if((oe=oe??60)>180)throw new Error("maxPitch must be less than or equal to 180");if(oe>=this.transform.minPitch)return this.transform.setMaxPitch(oe),this._update(),this.getPitch()>oe&&this.setPitch(oe),this;throw new Error("maxPitch must be greater than the current minPitch")}getMaxPitch(){return this.transform.maxPitch}getRenderWorldCopies(){return this.transform.renderWorldCopies}setRenderWorldCopies(oe){return this.transform.setRenderWorldCopies(oe),this._update()}project(oe){return this.transform.locationToScreenPoint(R.S.convert(oe),this.style&&this.terrain)}unproject(oe){return this.transform.screenPointToLocation(R.P.convert(oe),this.terrain)}isMoving(){var oe;return this._moving||((oe=this.handlers)===null||oe===void 0?void 0:oe.isMoving())}isZooming(){var oe;return this._zooming||((oe=this.handlers)===null||oe===void 0?void 0:oe.isZooming())}isRotating(){var oe;return this._rotating||((oe=this.handlers)===null||oe===void 0?void 0:oe.isRotating())}_createDelegatedListener(oe,t,G){if(oe==="mouseenter"||oe==="mouseover"){let J=!1;return{layers:t,listener:G,delegates:{mousemove:se=>{const de=t.filter(ge=>this.getLayer(ge)),_e=de.length!==0?this.queryRenderedFeatures(se.point,{layers:de}):[];_e.length?J||(J=!0,G.call(this,new xn(oe,this,se.originalEvent,{features:_e}))):J=!1},mouseout:()=>{J=!1}}}}if(oe==="mouseleave"||oe==="mouseout"){let J=!1;return{layers:t,listener:G,delegates:{mousemove:de=>{const _e=t.filter(ge=>this.getLayer(ge));(_e.length!==0?this.queryRenderedFeatures(de.point,{layers:_e}):[]).length?J=!0:J&&(J=!1,G.call(this,new xn(oe,this,de.originalEvent)))},mouseout:de=>{J&&(J=!1,G.call(this,new xn(oe,this,de.originalEvent)))}}}}{const J=te=>{const se=t.filter(_e=>this.getLayer(_e)),de=se.length!==0?this.queryRenderedFeatures(te.point,{layers:se}):[];de.length&&(te.features=de,G.call(this,te),delete te.features)};return{layers:t,listener:G,delegates:{[oe]:J}}}}_saveDelegatedListener(oe,t){this._delegatedListeners=this._delegatedListeners||{},this._delegatedListeners[oe]=this._delegatedListeners[oe]||[],this._delegatedListeners[oe].push(t)}_removeDelegatedListener(oe,t,G){if(!this._delegatedListeners||!this._delegatedListeners[oe])return;const J=this._delegatedListeners[oe];for(let te=0;te<J.length;te++){const se=J[te];if(se.listener===G&&se.layers.length===t.length&&se.layers.every(de=>t.includes(de))){for(const de in se.delegates)this.off(de,se.delegates[de]);return void J.splice(te,1)}}}on(oe,t,G){if(G===void 0)return super.on(oe,t);const J=typeof t=="string"?[t]:t,te=this._createDelegatedListener(oe,J,G);this._saveDelegatedListener(oe,te);for(const se in te.delegates)this.on(se,te.delegates[se]);return{unsubscribe:()=>{this._removeDelegatedListener(oe,J,G)}}}once(oe,t,G){if(G===void 0)return super.once(oe,t);const J=typeof t=="string"?[t]:t,te=this._createDelegatedListener(oe,J,G);for(const se in te.delegates){const de=te.delegates[se];te.delegates[se]=(..._e)=>{this._removeDelegatedListener(oe,J,G),de(..._e)}}this._saveDelegatedListener(oe,te);for(const se in te.delegates)this.once(se,te.delegates[se]);return this}off(oe,t,G){return G===void 0?super.off(oe,t):(this._removeDelegatedListener(oe,typeof t=="string"?[t]:t,G),this)}queryRenderedFeatures(oe,t){if(!this.style)return[];let G;const J=oe instanceof R.P||Array.isArray(oe),te=J?oe:[[0,0],[this.transform.width,this.transform.height]];if(t=t||(J?{}:oe)||{},te instanceof R.P||typeof te[0]=="number")G=[R.P.convert(te)];else{const se=R.P.convert(te[0]),de=R.P.convert(te[1]);G=[se,new R.P(de.x,se.y),de,new R.P(se.x,de.y),se]}return this.style.queryRenderedFeatures(G,t,this.transform)}querySourceFeatures(oe,t){return this.style.querySourceFeatures(oe,t)}setStyle(oe,t){return(t=R.e({},{localIdeographFontFamily:this._localIdeographFontFamily,validate:this._validateStyle},t)).diff!==!1&&t.localIdeographFontFamily===this._localIdeographFontFamily&&this.style&&oe?(this._diffStyle(oe,t),this):(this._localIdeographFontFamily=t.localIdeographFontFamily,this._updateStyle(oe,t))}setTransformRequest(oe){return this._requestManager.setTransformRequest(oe),this}_getUIString(oe){const t=this._locale[oe];if(t==null)throw new Error(`Missing UI string '${oe}'`);return t}_updateStyle(oe,t){var G,J;if(t.transformStyle&&this.style&&!this.style._loaded)return void this.style.once("style.load",()=>this._updateStyle(oe,t));const te=this.style&&t.transformStyle?this.style.serialize():void 0;return this.style&&(this.style.setEventedParent(null),this.style._remove(!oe)),oe?(this.style=new eu(this,t||{}),this.style.setEventedParent(this,{style:this.style}),typeof oe=="string"?this.style.loadURL(oe,t,te):this.style.loadJSON(oe,t,te),this):((J=(G=this.style)===null||G===void 0?void 0:G.projection)===null||J===void 0||J.destroy(),delete this.style,this)}_lazyInitEmptyStyle(){this.style||(this.style=new eu(this,{}),this.style.setEventedParent(this,{style:this.style}),this.style.loadEmpty())}_diffStyle(oe,t){if(typeof oe=="string"){const G=this._requestManager.transformRequest(oe,"Style");R.j(G,new AbortController).then(J=>{this._updateDiff(J.data,t)}).catch(J=>{J&&this.fire(new R.k(J))})}else typeof oe=="object"&&this._updateDiff(oe,t)}_updateDiff(oe,t){try{this.style.setState(oe,t)&&this._update(!0)}catch(G){R.w(`Unable to perform style diff: ${G.message||G.error||G}.  Rebuilding the style from scratch.`),this._updateStyle(oe,t)}}getStyle(){if(this.style)return this.style.serialize()}isStyleLoaded(){return this.style?this.style.loaded():R.w("There is no style added to the map.")}addSource(oe,t){return this._lazyInitEmptyStyle(),this.style.addSource(oe,t),this._update(!0)}isSourceLoaded(oe){const t=this.style&&this.style.sourceCaches[oe];if(t!==void 0)return t.loaded();this.fire(new R.k(new Error(`There is no source with ID '${oe}'`)))}setTerrain(oe){if(this.style._checkLoaded(),this._terrainDataCallback&&this.style.off("data",this._terrainDataCallback),oe){const t=this.style.sourceCaches[oe.source];if(!t)throw new Error(`cannot load terrain, because there exists no source with ID: ${oe.source}`);this.terrain===null&&t.reload();for(const G in this.style._layers){const J=this.style._layers[G];J.type==="hillshade"&&J.source===oe.source&&R.w("You are using the same source for a hillshade layer and for 3D terrain. Please consider using two separate sources to improve rendering quality."),J.type==="color-relief"&&J.source===oe.source&&R.w("You are using the same source for a color-relief layer and for 3D terrain. Please consider using two separate sources to improve rendering quality.")}this.terrain=new Vn(this.painter,t,oe),this.painter.renderToTexture=new Vr(this.painter,this.terrain),this.transform.setMinElevationForCurrentTile(this.terrain.getMinTileElevationForLngLatZoom(this.transform.center,this.transform.tileZoom)),this.transform.setElevation(this.terrain.getElevationForLngLatZoom(this.transform.center,this.transform.tileZoom)),this._terrainDataCallback=G=>{var J;G.dataType==="style"?this.terrain.sourceCache.freeRtt():G.dataType==="source"&&G.tile&&(G.sourceId!==oe.source||this._elevationFreeze||(this.transform.setMinElevationForCurrentTile(this.terrain.getMinTileElevationForLngLatZoom(this.transform.center,this.transform.tileZoom)),this._centerClampedToGround&&this.transform.setElevation(this.terrain.getElevationForLngLatZoom(this.transform.center,this.transform.tileZoom))),((J=G.source)===null||J===void 0?void 0:J.type)==="image"?this.terrain.sourceCache.freeRtt():this.terrain.sourceCache.freeRtt(G.tile.tileID))},this.style.on("data",this._terrainDataCallback)}else this.terrain&&this.terrain.sourceCache.destruct(),this.terrain=null,this.painter.renderToTexture&&this.painter.renderToTexture.destruct(),this.painter.renderToTexture=null,this.transform.setMinElevationForCurrentTile(0),this._centerClampedToGround&&this.transform.setElevation(0);return this.fire(new R.l("terrain",{terrain:oe})),this}getTerrain(){var oe,t;return(t=(oe=this.terrain)===null||oe===void 0?void 0:oe.options)!==null&&t!==void 0?t:null}areTilesLoaded(){const oe=this.style&&this.style.sourceCaches;for(const t in oe){const G=oe[t]._tiles;for(const J in G){const te=G[J];if(te.state!=="loaded"&&te.state!=="errored")return!1}}return!0}removeSource(oe){return this.style.removeSource(oe),this._update(!0)}getSource(oe){return this.style.getSource(oe)}setSourceTileLodParams(oe,t,G){if(G){const J=this.getSource(G);if(!J)throw new Error(`There is no source with ID "${G}", cannot set LOD parameters`);J.calculateTileZoom=_t(Math.max(1,oe),Math.max(1,t))}else for(const J in this.style.sourceCaches)this.style.sourceCaches[J].getSource().calculateTileZoom=_t(Math.max(1,oe),Math.max(1,t));return this._update(!0),this}refreshTiles(oe,t){const G=this.style.sourceCaches[oe];if(!G)throw new Error(`There is no source cache with ID "${oe}", cannot refresh tile`);t===void 0?G.reload(!0):G.refreshTiles(t.map(J=>new R.a3(J.z,J.x,J.y)))}addImage(oe,t,G={}){const{pixelRatio:J=1,sdf:te=!1,stretchX:se,stretchY:de,content:_e,textFitWidth:ge,textFitHeight:xe}=G;if(this._lazyInitEmptyStyle(),!(t instanceof HTMLImageElement||R.b(t))){if(t.width===void 0||t.height===void 0)return this.fire(new R.k(new Error("Invalid arguments to map.addImage(). The second argument must be an `HTMLImageElement`, `ImageData`, `ImageBitmap`, or object with `width`, `height`, and `data` properties with the same format as `ImageData`")));{const{width:Se,height:Oe,data:Ae}=t,je=t;return this.style.addImage(oe,{data:new R.R({width:Se,height:Oe},new Uint8Array(Ae)),pixelRatio:J,stretchX:se,stretchY:de,content:_e,textFitWidth:ge,textFitHeight:xe,sdf:te,version:0,userImage:je}),je.onAdd&&je.onAdd(this,oe),this}}{const{width:Se,height:Oe,data:Ae}=pe.getImageData(t);this.style.addImage(oe,{data:new R.R({width:Se,height:Oe},Ae),pixelRatio:J,stretchX:se,stretchY:de,content:_e,textFitWidth:ge,textFitHeight:xe,sdf:te,version:0})}}updateImage(oe,t){const G=this.style.getImage(oe);if(!G)return this.fire(new R.k(new Error("The map has no image with that id. If you are adding a new image use `map.addImage(...)` instead.")));const J=t instanceof HTMLImageElement||R.b(t)?pe.getImageData(t):t,{width:te,height:se,data:de}=J;if(te===void 0||se===void 0)return this.fire(new R.k(new Error("Invalid arguments to map.updateImage(). The second argument must be an `HTMLImageElement`, `ImageData`, `ImageBitmap`, or object with `width`, `height`, and `data` properties with the same format as `ImageData`")));if(te!==G.data.width||se!==G.data.height)return this.fire(new R.k(new Error("The width and height of the updated image must be that same as the previous version of the image")));const _e=!(t instanceof HTMLImageElement||R.b(t));return G.data.replace(de,_e),this.style.updateImage(oe,G),this}getImage(oe){return this.style.getImage(oe)}hasImage(oe){return oe?!!this.style.getImage(oe):(this.fire(new R.k(new Error("Missing required image id"))),!1)}removeImage(oe){this.style.removeImage(oe)}loadImage(oe){return Fe.getImage(this._requestManager.transformRequest(oe,"Image"),new AbortController)}listImages(){return this.style.listImages()}addLayer(oe,t){return this._lazyInitEmptyStyle(),this.style.addLayer(oe,t),this._update(!0)}moveLayer(oe,t){return this.style.moveLayer(oe,t),this._update(!0)}removeLayer(oe){return this.style.removeLayer(oe),this._update(!0)}getLayer(oe){return this.style.getLayer(oe)}getLayersOrder(){return this.style.getLayersOrder()}setLayerZoomRange(oe,t,G){return this.style.setLayerZoomRange(oe,t,G),this._update(!0)}setFilter(oe,t,G={}){return this.style.setFilter(oe,t,G),this._update(!0)}getFilter(oe){return this.style.getFilter(oe)}setPaintProperty(oe,t,G,J={}){return this.style.setPaintProperty(oe,t,G,J),this._update(!0)}getPaintProperty(oe,t){return this.style.getPaintProperty(oe,t)}setLayoutProperty(oe,t,G,J={}){return this.style.setLayoutProperty(oe,t,G,J),this._update(!0)}getLayoutProperty(oe,t){return this.style.getLayoutProperty(oe,t)}setGlyphs(oe,t={}){return this._lazyInitEmptyStyle(),this.style.setGlyphs(oe,t),this._update(!0)}getGlyphs(){return this.style.getGlyphsUrl()}addSprite(oe,t,G={}){return this._lazyInitEmptyStyle(),this.style.addSprite(oe,t,G,J=>{J||this._update(!0)}),this}removeSprite(oe){return this._lazyInitEmptyStyle(),this.style.removeSprite(oe),this._update(!0)}getSprite(){return this.style.getSprite()}setSprite(oe,t={}){return this._lazyInitEmptyStyle(),this.style.setSprite(oe,t,G=>{G||this._update(!0)}),this}setLight(oe,t={}){return this._lazyInitEmptyStyle(),this.style.setLight(oe,t),this._update(!0)}getLight(){return this.style.getLight()}setSky(oe,t={}){return this._lazyInitEmptyStyle(),this.style.setSky(oe,t),this._update(!0)}getSky(){return this.style.getSky()}setFeatureState(oe,t){return this.style.setFeatureState(oe,t),this._update()}removeFeatureState(oe,t){return this.style.removeFeatureState(oe,t),this._update()}getFeatureState(oe){return this.style.getFeatureState(oe)}getContainer(){return this._container}getCanvasContainer(){return this._canvasContainer}getCanvas(){return this._canvas}_containerDimensions(){let oe=0,t=0;return this._container&&(oe=this._container.clientWidth||400,t=this._container.clientHeight||300),[oe,t]}_setupContainer(){const oe=this._container;oe.classList.add("maplibregl-map");const t=this._canvasContainer=me.create("div","maplibregl-canvas-container",oe);this._interactive&&t.classList.add("maplibregl-interactive"),this._canvas=me.create("canvas","maplibregl-canvas",t),this._canvas.addEventListener("webglcontextlost",this._contextLost,!1),this._canvas.addEventListener("webglcontextrestored",this._contextRestored,!1),this._canvas.setAttribute("tabindex",this._interactive?"0":"-1"),this._canvas.setAttribute("aria-label",this._getUIString("Map.Title")),this._canvas.setAttribute("role","region");const G=this._containerDimensions(),J=this._getClampedPixelRatio(G[0],G[1]);this._resizeCanvas(G[0],G[1],J);const te=this._controlContainer=me.create("div","maplibregl-control-container",oe),se=this._controlPositions={};["top-left","top-right","bottom-left","bottom-right"].forEach(de=>{se[de]=me.create("div",`maplibregl-ctrl-${de} `,te)}),this._container.addEventListener("scroll",this._onMapScroll,!1)}_resizeCanvas(oe,t,G){this._canvas.width=Math.floor(G*oe),this._canvas.height=Math.floor(G*t),this._canvas.style.width=`${oe}px`,this._canvas.style.height=`${t}px`}_setupPainter(){const oe=Object.assign(Object.assign({},this._canvasContextAttributes),{alpha:!0,depth:!0,stencil:!0,premultipliedAlpha:!0});let t=null;this._canvas.addEventListener("webglcontextcreationerror",J=>{t={requestedAttributes:oe},J&&(t.statusMessage=J.statusMessage,t.type=J.type)},{once:!0});let G=null;if(G=this._canvasContextAttributes.contextType?this._canvas.getContext(this._canvasContextAttributes.contextType,oe):this._canvas.getContext("webgl2",oe)||this._canvas.getContext("webgl",oe),!G){const J="Failed to initialize WebGL";throw t?(t.message=J,new Error(JSON.stringify(t))):new Error(J)}this.painter=new Pn(G,this.transform),ve.testSupport(G)}migrateProjection(oe,t){super.migrateProjection(oe,t),this.painter.transform=oe,this.fire(new R.l("projectiontransition",{newProjection:this.style.projection.name}))}loaded(){return!this._styleDirty&&!this._sourcesDirty&&!!this.style&&this.style.loaded()}_update(oe){return this.style&&this.style._loaded?(this._styleDirty=this._styleDirty||oe,this._sourcesDirty=!0,this.triggerRepaint(),this):this}_requestRenderFrame(oe){return this._update(),this._renderTaskQueue.add(oe)}_cancelRenderFrame(oe){this._renderTaskQueue.remove(oe)}_render(oe){var t,G,J,te,se;const de=this._idleTriggered?this._fadeDuration:0,_e=((t=this.style.projection)===null||t===void 0?void 0:t.transitionState)>0;if(this.painter.context.setDirty(),this.painter.setBaseState(),this._renderTaskQueue.run(oe),this._removed)return;let ge=!1;if(this.style&&this._styleDirty){this._styleDirty=!1;const Oe=this.transform.zoom,Ae=pe.now();this.style.zoomHistory.update(Oe,Ae);const je=new R.F(Oe,{now:Ae,fadeDuration:de,zoomHistory:this.style.zoomHistory,transition:this.style.getTransition(),globalState:this.style.getGlobalState()}),Ye=je.crossFadingFactor();Ye===1&&Ye===this._crossFadingFactor||(ge=!0,this._crossFadingFactor=Ye),this.style.update(je)}const xe=((G=this.style.projection)===null||G===void 0?void 0:G.transitionState)>0!==_e;(J=this.style.projection)===null||J===void 0||J.setErrorQueryLatitudeDegrees(this.transform.center.lat),this.transform.setTransitionState((te=this.style.projection)===null||te===void 0?void 0:te.transitionState,(se=this.style.projection)===null||se===void 0?void 0:se.latitudeErrorCorrectionRadians),this.style&&(this._sourcesDirty||xe)&&(this._sourcesDirty=!1,this.style._updateSources(this.transform)),this.terrain?(this.terrain.sourceCache.update(this.transform,this.terrain),this.transform.setMinElevationForCurrentTile(this.terrain.getMinTileElevationForLngLatZoom(this.transform.center,this.transform.tileZoom)),!this._elevationFreeze&&this._centerClampedToGround&&this.transform.setElevation(this.terrain.getElevationForLngLatZoom(this.transform.center,this.transform.tileZoom))):(this.transform.setMinElevationForCurrentTile(0),this._centerClampedToGround&&this.transform.setElevation(0)),this._placementDirty=this.style&&this.style._updatePlacement(this.transform,this.showCollisionBoxes,de,this._crossSourceCollisions,xe),this.painter.render(this.style,{showTileBoundaries:this.showTileBoundaries,showOverdrawInspector:this._showOverdrawInspector,rotating:this.isRotating(),zooming:this.isZooming(),moving:this.isMoving(),fadeDuration:de,showPadding:this.showPadding}),this.fire(new R.l("render")),this.loaded()&&!this._loaded&&(this._loaded=!0,R.cv.mark(R.cw.load),this.fire(new R.l("load"))),this.style&&(this.style.hasTransitions()||ge)&&(this._styleDirty=!0),this.style&&!this._placementDirty&&this.style._releaseSymbolFadeTiles();const Se=this._sourcesDirty||this._styleDirty||this._placementDirty;return Se||this._repaint?this.triggerRepaint():!this.isMoving()&&this.loaded()&&this.fire(new R.l("idle")),!this._loaded||this._fullyLoaded||Se||(this._fullyLoaded=!0,R.cv.mark(R.cw.fullLoad)),this}redraw(){return this.style&&(this._frameRequest&&(this._frameRequest.abort(),this._frameRequest=null),this._render(0)),this}remove(){var oe;this._hash&&this._hash.remove();for(const G of this._controls)G.onRemove(this);this._controls=[],this._frameRequest&&(this._frameRequest.abort(),this._frameRequest=null),this._renderTaskQueue.clear(),this.painter.destroy(),this.handlers.destroy(),delete this.handlers,this.setStyle(null),typeof window<"u"&&removeEventListener("online",this._onWindowOnline,!1),Fe.removeThrottleControl(this._imageQueueHandle),(oe=this._resizeObserver)===null||oe===void 0||oe.disconnect();const t=this.painter.context.gl.getExtension("WEBGL_lose_context");t!=null&&t.loseContext&&t.loseContext(),this._canvas.removeEventListener("webglcontextrestored",this._contextRestored,!1),this._canvas.removeEventListener("webglcontextlost",this._contextLost,!1),me.remove(this._canvasContainer),me.remove(this._controlContainer),this._container.removeEventListener("scroll",this._onMapScroll,!1),this._container.classList.remove("maplibregl-map"),R.cv.clearMetrics(),this._removed=!0,this.fire(new R.l("remove"))}triggerRepaint(){this.style&&!this._frameRequest&&(this._frameRequest=new AbortController,pe.frame(this._frameRequest,oe=>{R.cv.frame(oe),this._frameRequest=null;try{this._render(oe)}catch(t){if(!R.cx(t)&&!function(G){return G.message===_u}(t))throw t}},()=>{}))}get showTileBoundaries(){return!!this._showTileBoundaries}set showTileBoundaries(oe){this._showTileBoundaries!==oe&&(this._showTileBoundaries=oe,this._update())}get showPadding(){return!!this._showPadding}set showPadding(oe){this._showPadding!==oe&&(this._showPadding=oe,this._update())}get showCollisionBoxes(){return!!this._showCollisionBoxes}set showCollisionBoxes(oe){this._showCollisionBoxes!==oe&&(this._showCollisionBoxes=oe,oe?this.style._generateCollisionBoxes():this._update())}get showOverdrawInspector(){return!!this._showOverdrawInspector}set showOverdrawInspector(oe){this._showOverdrawInspector!==oe&&(this._showOverdrawInspector=oe,this._update())}get repaint(){return!!this._repaint}set repaint(oe){this._repaint!==oe&&(this._repaint=oe,this.triggerRepaint())}get vertices(){return!!this._vertices}set vertices(oe){this._vertices=oe,this._update()}get version(){return Mu}getCameraTargetElevation(){return this.transform.elevation}getProjection(){return this.style.getProjection()}setProjection(oe){return this._lazyInitEmptyStyle(),this.style.setProjection(oe),this._update(!0)}},Q.MapMouseEvent=xn,Q.MapTouchEvent=Mn,Q.MapWheelEvent=wu,Q.Marker=Di,Q.NavigationControl=class{constructor(oe){this._updateZoomButtons=()=>{const t=this._map.getZoom(),G=t===this._map.getMaxZoom(),J=t===this._map.getMinZoom();this._zoomInButton.disabled=G,this._zoomOutButton.disabled=J,this._zoomInButton.setAttribute("aria-disabled",G.toString()),this._zoomOutButton.setAttribute("aria-disabled",J.toString())},this._rotateCompassArrow=()=>{this._compassIcon.style.transform=this.options.visualizePitch&&this.options.visualizeRoll?`scale(${1/Math.pow(Math.cos(this._map.transform.pitchInRadians),.5)}) rotateZ(${-this._map.transform.roll}deg) rotateX(${this._map.transform.pitch}deg) rotateZ(${-this._map.transform.bearing}deg)`:this.options.visualizePitch?`scale(${1/Math.pow(Math.cos(this._map.transform.pitchInRadians),.5)}) rotateX(${this._map.transform.pitch}deg) rotateZ(${-this._map.transform.bearing}deg)`:this.options.visualizeRoll?`rotate(${-this._map.transform.bearing-this._map.transform.roll}deg)`:`rotate(${-this._map.transform.bearing}deg)`},this._setButtonTitle=(t,G)=>{const J=this._map._getUIString(`NavigationControl.${G}`);t.title=J,t.setAttribute("aria-label",J)},this.options=R.e({},pn,oe),this._container=me.create("div","maplibregl-ctrl maplibregl-ctrl-group"),this._container.addEventListener("contextmenu",t=>t.preventDefault()),this.options.showZoom&&(this._zoomInButton=this._createButton("maplibregl-ctrl-zoom-in",t=>this._map.zoomIn({},{originalEvent:t})),me.create("span","maplibregl-ctrl-icon",this._zoomInButton).setAttribute("aria-hidden","true"),this._zoomOutButton=this._createButton("maplibregl-ctrl-zoom-out",t=>this._map.zoomOut({},{originalEvent:t})),me.create("span","maplibregl-ctrl-icon",this._zoomOutButton).setAttribute("aria-hidden","true")),this.options.showCompass&&(this._compass=this._createButton("maplibregl-ctrl-compass",t=>{this.options.visualizePitch?this._map.resetNorthPitch({},{originalEvent:t}):this._map.resetNorth({},{originalEvent:t})}),this._compassIcon=me.create("span","maplibregl-ctrl-icon",this._compass),this._compassIcon.setAttribute("aria-hidden","true"))}onAdd(oe){return this._map=oe,this.options.showZoom&&(this._setButtonTitle(this._zoomInButton,"ZoomIn"),this._setButtonTitle(this._zoomOutButton,"ZoomOut"),this._map.on("zoom",this._updateZoomButtons),this._updateZoomButtons()),this.options.showCompass&&(this._setButtonTitle(this._compass,"ResetBearing"),this.options.visualizePitch&&this._map.on("pitch",this._rotateCompassArrow),this.options.visualizeRoll&&this._map.on("roll",this._rotateCompassArrow),this._map.on("rotate",this._rotateCompassArrow),this._rotateCompassArrow(),this._handler=new Wl(this._map,this._compass,this.options.visualizePitch)),this._container}onRemove(){me.remove(this._container),this.options.showZoom&&this._map.off("zoom",this._updateZoomButtons),this.options.showCompass&&(this.options.visualizePitch&&this._map.off("pitch",this._rotateCompassArrow),this.options.visualizeRoll&&this._map.off("roll",this._rotateCompassArrow),this._map.off("rotate",this._rotateCompassArrow),this._handler.off(),delete this._handler),delete this._map}_createButton(oe,t){const G=me.create("button",oe,this._container);return G.type="button",G.addEventListener("click",t),G}},Q.Popup=class extends R.E{constructor(oe){super(),this._updateOpacity=()=>{this.options.locationOccludedOpacity!==void 0&&(this._container.style.opacity=this._map.transform.isLocationOccluded(this.getLngLat())?`${this.options.locationOccludedOpacity}`:"")},this.remove=()=>(this._content&&me.remove(this._content),this._container&&(me.remove(this._container),delete this._container),this._map&&(this._map.off("move",this._update),this._map.off("move",this._onClose),this._map.off("click",this._onClose),this._map.off("remove",this.remove),this._map.off("mousemove",this._onMouseMove),this._map.off("mouseup",this._onMouseUp),this._map.off("drag",this._onDrag),this._map._canvasContainer.classList.remove("maplibregl-track-pointer"),delete this._map,this.fire(new R.l("close"))),this),this._onMouseUp=t=>{this._update(t.point)},this._onMouseMove=t=>{this._update(t.point)},this._onDrag=t=>{this._update(t.point)},this._update=t=>{if(!this._map||!this._lngLat&&!this._trackPointer||!this._content)return;if(!this._container){if(this._container=me.create("div","maplibregl-popup",this._map.getContainer()),this._tip=me.create("div","maplibregl-popup-tip",this._container),this._container.appendChild(this._content),this.options.className)for(const de of this.options.className.split(" "))this._container.classList.add(de);this._closeButton&&this._closeButton.setAttribute("aria-label",this._map._getUIString("Popup.Close")),this._trackPointer&&this._container.classList.add("maplibregl-popup-track-pointer")}if(this.options.maxWidth&&this._container.style.maxWidth!==this.options.maxWidth&&(this._container.style.maxWidth=this.options.maxWidth),this._lngLat=Hl(this._lngLat,this._flatPos,this._map.transform,this._trackPointer),this._trackPointer&&!t)return;const G=this._flatPos=this._pos=this._trackPointer&&t?t:this._map.project(this._lngLat);this._map.terrain&&(this._flatPos=this._trackPointer&&t?t:this._map.transform.locationToScreenPoint(this._lngLat));let J=this.options.anchor;const te=Cs(this.options.offset);if(!J){const de=this._container.offsetWidth,_e=this._container.offsetHeight;let ge;ge=G.y+te.bottom.y<_e?["top"]:G.y>this._map.transform.height-_e?["bottom"]:[],G.x<de/2?ge.push("left"):G.x>this._map.transform.width-de/2&&ge.push("right"),J=ge.length===0?"bottom":ge.join("-")}let se=G.add(te[J]);this.options.subpixelPositioning||(se=se.round()),me.setTransform(this._container,`${Ta[J]} translate(${se.x}px,${se.y}px)`),Ii(this._container,J,"popup"),this._updateOpacity()},this._onClose=()=>{this.remove()},this.options=R.e(Object.create(Bo),oe)}addTo(oe){return this._map&&this.remove(),this._map=oe,this.options.closeOnClick&&this._map.on("click",this._onClose),this.options.closeOnMove&&this._map.on("move",this._onClose),this._map.on("remove",this.remove),this._update(),this._focusFirstElement(),this._trackPointer?(this._map.on("mousemove",this._onMouseMove),this._map.on("mouseup",this._onMouseUp),this._container&&this._container.classList.add("maplibregl-popup-track-pointer"),this._map._canvasContainer.classList.add("maplibregl-track-pointer")):this._map.on("move",this._update),this.fire(new R.l("open")),this}isOpen(){return!!this._map}getLngLat(){return this._lngLat}setLngLat(oe){return this._lngLat=R.S.convert(oe),this._pos=null,this._flatPos=null,this._trackPointer=!1,this._update(),this._map&&(this._map.on("move",this._update),this._map.off("mousemove",this._onMouseMove),this._container&&this._container.classList.remove("maplibregl-popup-track-pointer"),this._map._canvasContainer.classList.remove("maplibregl-track-pointer")),this}trackPointer(){return this._trackPointer=!0,this._pos=null,this._flatPos=null,this._update(),this._map&&(this._map.off("move",this._update),this._map.on("mousemove",this._onMouseMove),this._map.on("drag",this._onDrag),this._container&&this._container.classList.add("maplibregl-popup-track-pointer"),this._map._canvasContainer.classList.add("maplibregl-track-pointer")),this}getElement(){return this._container}setText(oe){return this.setDOMContent(document.createTextNode(oe))}setHTML(oe){const t=document.createDocumentFragment(),G=document.createElement("body");let J;for(G.innerHTML=oe;J=G.firstChild,J;)t.appendChild(J);return this.setDOMContent(t)}getMaxWidth(){var oe;return(oe=this._container)===null||oe===void 0?void 0:oe.style.maxWidth}setMaxWidth(oe){return this.options.maxWidth=oe,this._update(),this}setDOMContent(oe){if(this._content)for(;this._content.hasChildNodes();)this._content.firstChild&&this._content.removeChild(this._content.firstChild);else this._content=me.create("div","maplibregl-popup-content",this._container);return this._content.appendChild(oe),this._createCloseButton(),this._update(),this._focusFirstElement(),this}addClassName(oe){return this._container&&this._container.classList.add(oe),this}removeClassName(oe){return this._container&&this._container.classList.remove(oe),this}setOffset(oe){return this.options.offset=oe,this._update(),this}toggleClassName(oe){if(this._container)return this._container.classList.toggle(oe)}setSubpixelPositioning(oe){this.options.subpixelPositioning=oe}_createCloseButton(){this.options.closeButton&&(this._closeButton=me.create("button","maplibregl-popup-close-button",this._content),this._closeButton.type="button",this._closeButton.innerHTML="&#215;",this._closeButton.addEventListener("click",this._onClose))}_focusFirstElement(){if(!this.options.focusAfterOpen||!this._container)return;const oe=this._container.querySelector(Fu);oe&&oe.focus()}},Q.RasterDEMTileSource=br,Q.RasterTileSource=Hr,Q.ScaleControl=class{constructor(oe){this._onMove=()=>{Os(this._map,this._container,this.options)},this.setUnit=t=>{this.options.unit=t,Os(this._map,this._container,this.options)},this.options=Object.assign(Object.assign({},Du),oe)}getDefaultPosition(){return"bottom-left"}onAdd(oe){return this._map=oe,this._container=me.create("div","maplibregl-ctrl maplibregl-ctrl-scale",oe.getContainer()),this._map.on("move",this._onMove),this._onMove(),this._container}onRemove(){me.remove(this._container),this._map.off("move",this._onMove),this._map=void 0}},Q.ScrollZoomHandler=Ul,Q.Style=eu,Q.TerrainControl=class{constructor(oe){this._toggleTerrain=()=>{this._map.getTerrain()?this._map.setTerrain(null):this._map.setTerrain(this.options),this._updateTerrainIcon()},this._updateTerrainIcon=()=>{this._terrainButton.classList.remove("maplibregl-ctrl-terrain"),this._terrainButton.classList.remove("maplibregl-ctrl-terrain-enabled"),this._map.terrain?(this._terrainButton.classList.add("maplibregl-ctrl-terrain-enabled"),this._terrainButton.title=this._map._getUIString("TerrainControl.Disable")):(this._terrainButton.classList.add("maplibregl-ctrl-terrain"),this._terrainButton.title=this._map._getUIString("TerrainControl.Enable"))},this.options=oe}onAdd(oe){return this._map=oe,this._container=me.create("div","maplibregl-ctrl maplibregl-ctrl-group"),this._terrainButton=me.create("button","maplibregl-ctrl-terrain",this._container),me.create("span","maplibregl-ctrl-icon",this._terrainButton).setAttribute("aria-hidden","true"),this._terrainButton.type="button",this._terrainButton.addEventListener("click",this._toggleTerrain),this._updateTerrainIcon(),this._map.on("terrain",this._updateTerrainIcon),this._container}onRemove(){me.remove(this._container),this._map.off("terrain",this._updateTerrainIcon),this._map=void 0}},Q.TwoFingersTouchPitchHandler=Tu,Q.TwoFingersTouchRotateHandler=qu,Q.TwoFingersTouchZoomHandler=Gn,Q.TwoFingersTouchZoomRotateHandler=Pu,Q.VectorTileSource=Kr,Q.VideoSource=zr,Q.addSourceType=(oe,t)=>R._(void 0,void 0,void 0,function*(){if(Dr(oe))throw new Error(`A source type called "${oe}" already exists.`);((G,J)=>{sr[G]=J})(oe,t)}),Q.clearPrewarmedResources=function(){const oe=Zt;oe&&(oe.isPreloaded()&&oe.numActive()===1?(oe.release(At),Zt=null):console.warn("Could not clear WebWorkers since there are active Map instances that still reference it. The pre-warmed WebWorker pool can only be cleared when all map instances have been removed with map.remove()"))},Q.createTileMesh=Xs,Q.getMaxParallelImageRequests=function(){return R.a.MAX_PARALLEL_IMAGE_REQUESTS},Q.getRTLTextPluginStatus=function(){return Ge().getRTLTextPluginStatus()},Q.getVersion=function(){return ku},Q.getWorkerCount=function(){return It.workerCount},Q.getWorkerUrl=function(){return R.a.WORKER_URL},Q.importScriptInWorkers=function(oe){return Sr().broadcast("IS",oe)},Q.prewarm=function(){Er().acquire(At)},Q.setMaxParallelImageRequests=function(oe){R.a.MAX_PARALLEL_IMAGE_REQUESTS=oe},Q.setRTLTextPlugin=function(oe,t){return Ge().setRTLTextPlugin(oe,t)},Q.setWorkerCount=function(oe){It.workerCount=oe},Q.setWorkerUrl=function(oe){R.a.WORKER_URL=oe}});var le=ee;return le})}(maplibreGl$1)),maplibreGl$1.exports}var maplibreGlExports=requireMaplibreGl();const maplibre=getDefaultExportFromCjs(maplibreGlExports),TRIP_SHAPE_ARROW_URL="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAFAAAABkCAMAAAAmJEckAAAAnFBMVEUAAAAA//+AgP9Vqv9JtttAr+9HqvFJqudDpulHo+tFp+tHqupFpepBpu1EquhFp+tDqu1EqelFqepFp+xEqOtFqetEqOxDqOxDp+pEp+tEp+tFqexEqOpEqOxEqOtEqOxEqOtEqOtEqOtEqOtEqOtDqOxEqOtEqOtEqOtEqOtEqOtEqOtEqOtEqOtEqOtEqOtEqOtEqOtEqOv///+CAFIPAAAAMnRSTlMAAQIGBxASFRcZGiQlKy00OUdKXWZoaWpudICRk6qzuLzLzNHb3+Hi5Ofo6vL29/n7/gX8zyAAAAABYktHRDM31XxeAAABlElEQVRYw+2ZWVICQRBEQWVwFBVEodVW3FHEhbz/4fxVp7eqSmL8mDzAiyDm0V2V3et16WJMNTsfMHmjJbCaEHkvALC52qXyANyPuDxgPeXyAFybv021xK88nhiBc/zJ50XfBJyhkcW+BThYNYk2JSebJtGmpEcgFiX3HkLE9ZmeePQeIlqUdEEgnsZaYP8mTPy63FESh69hIm4PiO4AAN5Ome5YlAy7Y1Ey4o5BSYd4VErG3NErGXVHrWTUHbWSPgXUKJlwR6lkwh2lki4NlCuZdEelZNIdlZJpdzRKemQjUzLjjkLJnDtyJR0KIlEy745Uybw7UiXz7kiV9EVAgZIl7siUPP4oJD5XTHcAYN4SkP2Tyz9K3Y42bLHZf73Cw2Ha2vHFPmDpV4DnybeVa5R90dNHEceTbyvjHH3gZI/EmaG9lvLYawV98WGvZqnlUVOx0ddb9gLOrgjiJUat4tFrFnYRxK6qImWavt9l133sQpJemdJLXXrtTC/G6dU9/3HhB/Hu8J8+0PCfkPiPXF26lOUbWqrC+sGueMcAAAAASUVORK5CYII=",VEHICLE_POINT_COLOR=["case",["!=",["get","delay"],null],["interpolate",["linear"],["get","delay"],0,["to-color","#2ecc71"],90,["to-color","#eebb00"],210,["to-color","#ee2200"]],"#e0e0e0"],FOCUSED_TRIP_SHAPE_OPACITY={base:.3,stops:[[9,.3],[15,.8]]};class MapView extends x{constructor(){super(),this.ref=b()}updateVehiclePositions(){const{feedData:K}=this.props.state,ne=(K.entity||[]).filter(R=>R.vehicle&&R.vehicle.position);if(ne.length===0)return;const re=this.map.getSource("vehicle-positions");if(!re)return;re.setData({type:"FeatureCollection",features:ne.map(R=>{var U,Z;return{type:"Feature",properties:{vehicleId:(U=R.vehicle.vehicle)==null?void 0:U.id,trip_id:(Z=R.vehicle.trip)==null?void 0:Z.trip_id,delay:R.vehicle.delay},geometry:{type:"Point",coordinates:[R.vehicle.position.longitude,R.vehicle.position.latitude]}}})});const le=[ne[0].vehicle.position.longitude,ne[0].vehicle.position.latitude],Q=new maplibre.LngLatBounds(le,le);for(const R of ne)Q.extend([R.vehicle.position.longitude,R.vehicle.position.latitude]);this.map.fitBounds(Q,{padding:50})}updateFocusedTripShape(){const{focusedTripShape:K}=this.props.state,ee=this.map.getSource("focused-trip-shape");ee&&(K===null?ee.setData({type:"FeatureCollection",features:[]}):ee.setData(K))}updateFocusedVehiclePosition(){const{focusedVehiclePosition:K}=this.props.state,ee=this.map.getSource("focused-vehicle-position");ee&&(K===null?ee.setData({type:"FeatureCollection",features:[]}):ee.setData(K))}updateMap(){this.map&&(this.updateVehiclePositions(),this.updateFocusedTripShape(),this.updateFocusedVehiclePosition())}componentDidMount(){const{emit:K}=this.props;this.map=new maplibre.Map({container:this.ref.current,style:"https://api.protomaps.com/styles/v5/black/en.json?key=undefined",center:[-74.5,40],zoom:9}),this.map.once("load",()=>{this.map.addSource("vehicle-positions",{type:"geojson",data:{type:"FeatureCollection",features:[]}}),this.map.addLayer({id:"vehicle-positions",source:"vehicle-positions",type:"circle",paint:{"circle-radius":{base:1.5,stops:[[1,1],[20,35]]},"circle-color":VEHICLE_POINT_COLOR}}),this.map.on("mouseenter","vehicle-positions",()=>{this.map.getCanvas().style.cursor="pointer"}),this.map.on("mouseleave","vehicle-positions",()=>{this.map.getCanvas().style.cursor=""}),this.map.on("click","vehicle-positions",ne=>{var Q,R;const re=((Q=ne.features[0])==null?void 0:Q.properties.vehicleId)||null;K("focus-vehicle-id",re);const le=((R=ne.features[0])==null?void 0:R.properties.trip_id)||null;K("focus-trip-id",le)}),this.map.addSource("focused-trip-shape",{type:"geojson",data:null}),this.map.addLayer({id:"focused-trip-shape",source:"focused-trip-shape",type:"line",paint:{"line-width":{base:1,stops:[[1,.6],[20,4]]},"line-color":"#44a8eb","line-opacity":FOCUSED_TRIP_SHAPE_OPACITY}});const ee=this.map;ee.loadImage(TRIP_SHAPE_ARROW_URL,(ne,re)=>{if(ne){console.error("failed to load trip shape arrow",ne);return}ee.addImage("focused-trip-shape-arrow",re),ee.addLayer({id:"focused-trip-shape-arrows",type:"symbol",source:"focused-trip-shape",paint:{"icon-opacity":FOCUSED_TRIP_SHAPE_OPACITY},layout:{"symbol-placement":"line","icon-ignore-placement":!0,"icon-image":"focused-trip-shape-arrow","icon-size":.15}})}),this.map.addSource("focused-vehicle-position",{type:"geojson",data:null}),this.map.addLayer({id:"focused-vehicle-position",source:"focused-vehicle-position",type:"circle",paint:{"circle-radius":{base:5,stops:[[1,5],[20,100]]},"circle-color":VEHICLE_POINT_COLOR}}),this.updateMap()})}componentDidUpdate(){this.updateMap()}componentWillUnmount(){this.map&&(this.map.remove(),this.map=null)}render(){return u("div",{class:"map",ref:this.ref})}}const __viteBrowserExternal={},__viteBrowserExternal$1=Object.freeze(Object.defineProperty({__proto__:null,default:__viteBrowserExternal},Symbol.toStringTag,{value:"Module"})),require$$0=getAugmentedNamespace(__viteBrowserExternal$1);var objectInspect,hasRequiredObjectInspect;function requireObjectInspect(){if(hasRequiredObjectInspect)return objectInspect;hasRequiredObjectInspect=1;var Y=typeof Map=="function"&&Map.prototype,K=Object.getOwnPropertyDescriptor&&Y?Object.getOwnPropertyDescriptor(Map.prototype,"size"):null,ee=Y&&K&&typeof K.get=="function"?K.get:null,ne=Y&&Map.prototype.forEach,re=typeof Set=="function"&&Set.prototype,le=Object.getOwnPropertyDescriptor&&re?Object.getOwnPropertyDescriptor(Set.prototype,"size"):null,Q=re&&le&&typeof le.get=="function"?le.get:null,R=re&&Set.prototype.forEach,U=typeof WeakMap=="function"&&WeakMap.prototype,Z=U?WeakMap.prototype.has:null,ae=typeof WeakSet=="function"&&WeakSet.prototype,he=ae?WeakSet.prototype.has:null,pe=typeof WeakRef=="function"&&WeakRef.prototype,me=pe?WeakRef.prototype.deref:null,ve=Boolean.prototype.valueOf,Re=Object.prototype.toString,Me=Function.prototype.toString,Te=String.prototype.match,Ce=String.prototype.slice,We=String.prototype.replace,Fe=String.prototype.toUpperCase,ke=String.prototype.toLowerCase,Ze=RegExp.prototype.test,Je=Array.prototype.concat,Qe=Array.prototype.join,it=Array.prototype.slice,lt=Math.floor,dt=typeof BigInt=="function"?BigInt.prototype.valueOf:null,yt=Object.getOwnPropertySymbols,gt=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?Symbol.prototype.toString:null,qt=typeof Symbol=="function"&&typeof Symbol.iterator=="object",Ft=typeof Symbol=="function"&&Symbol.toStringTag&&(typeof Symbol.toStringTag===qt||!0)?Symbol.toStringTag:null,Gt=Object.prototype.propertyIsEnumerable,ft=(typeof Reflect=="function"?Reflect.getPrototypeOf:Object.getPrototypeOf)||([].__proto__===Array.prototype?function(Le){return Le.__proto__}:null);function Rt(Le,Ke){if(Le===1/0||Le===-1/0||Le!==Le||Le&&Le>-1e3&&Le<1e3||Ze.call(/e/,Ke))return Ke;var et=/[0-9](?=(?:[0-9]{3})+(?![0-9]))/g;if(typeof Le=="number"){var _t=Le<0?-lt(-Le):lt(Le);if(_t!==Le){var st=String(_t),bt=Ce.call(Ke,st.length+1);return We.call(st,et,"$&_")+"."+We.call(We.call(bt,/([0-9]{3})/g,"$&_"),/_$/,"")}}return We.call(Ke,et,"$&_")}var pt=require$$0,At=pt.custom,It=Wr(At)?At:null,Dt={__proto__:null,double:'"',single:"'"},Zt={__proto__:null,double:/(["\\])/g,single:/(['\\])/g};objectInspect=function Le(Ke,et,_t,st){var bt=et||{};if(br(bt,"quoteStyle")&&!br(Dt,bt.quoteStyle))throw new TypeError('option "quoteStyle" must be "single" or "double"');if(br(bt,"maxStringLength")&&(typeof bt.maxStringLength=="number"?bt.maxStringLength<0&&bt.maxStringLength!==1/0:bt.maxStringLength!==null))throw new TypeError('option "maxStringLength", if provided, must be a positive integer, Infinity, or `null`');var Mt=br(bt,"customInspect")?bt.customInspect:!0;if(typeof Mt!="boolean"&&Mt!=="symbol")throw new TypeError("option \"customInspect\", if provided, must be `true`, `false`, or `'symbol'`");if(br(bt,"indent")&&bt.indent!==null&&bt.indent!=="	"&&!(parseInt(bt.indent,10)===bt.indent&&bt.indent>0))throw new TypeError('option "indent" must be "\\t", an integer > 0, or `null`');if(br(bt,"numericSeparator")&&typeof bt.numericSeparator!="boolean")throw new TypeError('option "numericSeparator", if provided, must be `true` or `false`');var Ot=bt.numericSeparator;if(typeof Ke>"u")return"undefined";if(Ke===null)return"null";if(typeof Ke=="boolean")return Ke?"true":"false";if(typeof Ke=="string")return Ge(Ke,bt);if(typeof Ke=="number"){if(Ke===0)return 1/0/Ke>0?"0":"-0";var Nt=String(Ke);return Ot?Rt(Ke,Nt):Nt}if(typeof Ke=="bigint"){var St=String(Ke)+"n";return Ot?Rt(Ke,St):St}var ar=typeof bt.depth>"u"?5:bt.depth;if(typeof _t>"u"&&(_t=0),_t>=ar&&ar>0&&typeof Ke=="object")return Sr(Ke)?"[Array]":"[Object]";var qr=qe(bt,_t);if(typeof st>"u")st=[];else if(zr(st,Ke)>=0)return"[Circular]";function fr(Ht,Bt,ir){if(Bt&&(st=it.call(st),st.push(Bt)),ir){var gr={depth:bt.depth};return br(bt,"quoteStyle")&&(gr.quoteStyle=bt.quoteStyle),Le(Ht,gr,_t+1,st)}return Le(Ht,bt,_t+1,st)}if(typeof Ke=="function"&&!or(Ke)){var Fr=Br(Ke),Gr=ze(Ke,fr);return"[Function"+(Fr?": "+Fr:" (anonymous)")+"]"+(Gr.length>0?" { "+Qe.call(Gr,", ")+" }":"")}if(Wr(Ke)){var ci=qt?We.call(String(Ke),/^(Symbol\(.*\))_[^)]*$/,"$1"):gt.call(Ke);return typeof Ke=="object"&&!qt?Pe(ci):ci}if(xr(Ke)){for(var Jr="<"+ke.call(String(Ke.nodeName)),Yr=Ke.attributes||[],jr=0;jr<Yr.length;jr++)Jr+=" "+Yr[jr].name+"="+nr(Er(Yr[jr].value),"double",bt);return Jr+=">",Ke.childNodes&&Ke.childNodes.length&&(Jr+="..."),Jr+="</"+ke.call(String(Ke.nodeName))+">",Jr}if(Sr(Ke)){if(Ke.length===0)return"[]";var Zr=ze(Ke,fr);return qr&&!Ve(Zr)?"["+De(Zr,qr)+"]":"[ "+Qe.call(Zr,", ")+" ]"}if(Ir(Ke)){var fi=ze(Ke,fr);return!("cause"in Error.prototype)&&"cause"in Ke&&!Gt.call(Ke,"cause")?"{ ["+String(Ke)+"] "+Qe.call(Je.call("[cause]: "+fr(Ke.cause),fi),", ")+" }":fi.length===0?"["+String(Ke)+"]":"{ ["+String(Ke)+"] "+Qe.call(fi,", ")+" }"}if(typeof Ke=="object"&&Mt){if(It&&typeof Ke[It]=="function"&&pt)return pt(Ke,{depth:ar-_t});if(Mt!=="symbol"&&typeof Ke.inspect=="function")return Ke.inspect()}if(rr(Ke)){var cr=[];return ne&&ne.call(Ke,function(Ht,Bt){cr.push(fr(Bt,Ke,!0)+" => "+fr(Ht,Ke))}),ut("Map",ee.call(Ke),cr,qr)}if(lr(Ke)){var bi=[];return R&&R.call(Ke,function(Ht){bi.push(fr(Ht,Ke))}),ut("Set",Q.call(Ke),bi,qr)}if(sr(Ke))return He("WeakMap");if(yr(Ke))return He("WeakSet");if(Dr(Ke))return He("WeakRef");if(Cr(Ke))return Pe(fr(Number(Ke)));if(Kr(Ke))return Pe(fr(dt.call(Ke)));if(wr(Ke))return Pe(ve.call(Ke));if(Rr(Ke))return Pe(fr(String(Ke)));if(typeof window<"u"&&Ke===window)return"{ [object Window] }";if(typeof globalThis<"u"&&Ke===globalThis||typeof commonjsGlobal<"u"&&Ke===commonjsGlobal)return"{ [object globalThis] }";if(!Qt(Ke)&&!or(Ke)){var Qr=ze(Ke,fr),Ei=ft?ft(Ke)===Object.prototype:Ke instanceof Object||Ke.constructor===Object,yn=Ke instanceof Object?"":"null prototype",pr=!Ei&&Ft&&Object(Ke)===Ke&&Ft in Ke?Ce.call(Lr(Ke),8,-1):yn?"Object":"",Lt=Ei||typeof Ke.constructor!="function"?"":Ke.constructor.name?Ke.constructor.name+" ":"",Yt=Lt+(pr||yn?"["+Qe.call(Je.call([],pr||[],yn||[]),": ")+"] ":"");return Qr.length===0?Yt+"{}":qr?Yt+"{"+De(Qr,qr)+"}":Yt+"{ "+Qe.call(Qr,", ")+" }"}return String(Ke)};function nr(Le,Ke,et){var _t=et.quoteStyle||Ke,st=Dt[_t];return st+Le+st}function Er(Le){return We.call(String(Le),/"/g,"&quot;")}function vr(Le){return!Ft||!(typeof Le=="object"&&(Ft in Le||typeof Le[Ft]<"u"))}function Sr(Le){return Lr(Le)==="[object Array]"&&vr(Le)}function Qt(Le){return Lr(Le)==="[object Date]"&&vr(Le)}function or(Le){return Lr(Le)==="[object RegExp]"&&vr(Le)}function Ir(Le){return Lr(Le)==="[object Error]"&&vr(Le)}function Rr(Le){return Lr(Le)==="[object String]"&&vr(Le)}function Cr(Le){return Lr(Le)==="[object Number]"&&vr(Le)}function wr(Le){return Lr(Le)==="[object Boolean]"&&vr(Le)}function Wr(Le){if(qt)return Le&&typeof Le=="object"&&Le instanceof Symbol;if(typeof Le=="symbol")return!0;if(!Le||typeof Le!="object"||!gt)return!1;try{return gt.call(Le),!0}catch{}return!1}function Kr(Le){if(!Le||typeof Le!="object"||!dt)return!1;try{return dt.call(Le),!0}catch{}return!1}var Hr=Object.prototype.hasOwnProperty||function(Le){return Le in this};function br(Le,Ke){return Hr.call(Le,Ke)}function Lr(Le){return Re.call(Le)}function Br(Le){if(Le.name)return Le.name;var Ke=Te.call(Me.call(Le),/^function\s*([\w$]+)/);return Ke?Ke[1]:null}function zr(Le,Ke){if(Le.indexOf)return Le.indexOf(Ke);for(var et=0,_t=Le.length;et<_t;et++)if(Le[et]===Ke)return et;return-1}function rr(Le){if(!ee||!Le||typeof Le!="object")return!1;try{ee.call(Le);try{Q.call(Le)}catch{return!0}return Le instanceof Map}catch{}return!1}function sr(Le){if(!Z||!Le||typeof Le!="object")return!1;try{Z.call(Le,Z);try{he.call(Le,he)}catch{return!0}return Le instanceof WeakMap}catch{}return!1}function Dr(Le){if(!me||!Le||typeof Le!="object")return!1;try{return me.call(Le),!0}catch{}return!1}function lr(Le){if(!Q||!Le||typeof Le!="object")return!1;try{Q.call(Le);try{ee.call(Le)}catch{return!0}return Le instanceof Set}catch{}return!1}function yr(Le){if(!he||!Le||typeof Le!="object")return!1;try{he.call(Le,he);try{Z.call(Le,Z)}catch{return!0}return Le instanceof WeakSet}catch{}return!1}function xr(Le){return!Le||typeof Le!="object"?!1:typeof HTMLElement<"u"&&Le instanceof HTMLElement?!0:typeof Le.nodeName=="string"&&typeof Le.getAttribute=="function"}function Ge(Le,Ke){if(Le.length>Ke.maxStringLength){var et=Le.length-Ke.maxStringLength,_t="... "+et+" more character"+(et>1?"s":"");return Ge(Ce.call(Le,0,Ke.maxStringLength),Ke)+_t}var st=Zt[Ke.quoteStyle||"single"];st.lastIndex=0;var bt=We.call(We.call(Le,st,"\\$1"),/[\x00-\x1f]/g,Ee);return nr(bt,"single",Ke)}function Ee(Le){var Ke=Le.charCodeAt(0),et={8:"b",9:"t",10:"n",12:"f",13:"r"}[Ke];return et?"\\"+et:"\\x"+(Ke<16?"0":"")+Fe.call(Ke.toString(16))}function Pe(Le){return"Object("+Le+")"}function He(Le){return Le+" { ? }"}function ut(Le,Ke,et,_t){var st=_t?De(et,_t):Qe.call(et,", ");return Le+" ("+Ke+") {"+st+"}"}function Ve(Le){for(var Ke=0;Ke<Le.length;Ke++)if(zr(Le[Ke],`
`)>=0)return!1;return!0}function qe(Le,Ke){var et;if(Le.indent==="	")et="	";else if(typeof Le.indent=="number"&&Le.indent>0)et=Qe.call(Array(Le.indent+1)," ");else return null;return{base:et,prev:Qe.call(Array(Ke+1),et)}}function De(Le,Ke){if(Le.length===0)return"";var et=`
`+Ke.prev+Ke.base;return et+Qe.call(Le,","+et)+`
`+Ke.prev}function ze(Le,Ke){var et=Sr(Le),_t=[];if(et){_t.length=Le.length;for(var st=0;st<Le.length;st++)_t[st]=br(Le,st)?Ke(Le[st],Le):""}var bt=typeof yt=="function"?yt(Le):[],Mt;if(qt){Mt={};for(var Ot=0;Ot<bt.length;Ot++)Mt["$"+bt[Ot]]=bt[Ot]}for(var Nt in Le)br(Le,Nt)&&(et&&String(Number(Nt))===Nt&&Nt<Le.length||qt&&Mt["$"+Nt]instanceof Symbol||(Ze.call(/[^\w$]/,Nt)?_t.push(Ke(Nt,Le)+": "+Ke(Le[Nt],Le)):_t.push(Nt+": "+Ke(Le[Nt],Le))));if(typeof yt=="function")for(var St=0;St<bt.length;St++)Gt.call(Le,bt[St])&&_t.push("["+Ke(bt[St])+"]: "+Ke(Le[bt[St]],Le));return _t}return objectInspect}var objectInspectExports=requireObjectInspect();const inspect=getDefaultExportFromCjs(objectInspectExports),errorView=({state:Y,emit:K})=>{const ee=Y.feedError,ne=("	"+ee.stack.replace(/\n/g,`	
`)).trim();return u("div",{class:"error",children:[u("h2",{children:u("code",{children:"failed to fetch the feed"})}),u("pre",{children:u("code",{children:inspect(ee)+`
`+ne})})]})},mainView=({state:Y,emit:K})=>{const ee={log:logView,inspector:inspectorView,map:MapView,raw:rawView}[Y.view]||inspectorView;return u("div",{class:"app",children:[u(barView,{state:Y,emit:K}),u("div",{class:"view",children:Y.feedData?u(ee,{state:Y,emit:K}):Y.feedError?u(errorView,{state:Y,emit:K}):null})]})},state={},bus=new EventEmitter;bus.STATE_CHANGE=Symbol("state change");const emit=bus.emit.bind(bus);viewStore(state,bus);feedStore(state,bus);feedLogStore(state,bus);inspectorStore(state,bus);focusStore(state,bus);urlStore(state,bus);const rerender=()=>{E(u(mainView,{state,emit}),document.body)};bus.on(bus.STATE_CHANGE,rerender);rerender();
