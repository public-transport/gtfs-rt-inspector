(function(){const X=document.createElement("link").relList;if(X&&X.supports&&X.supports("modulepreload"))return;for(const te of document.querySelectorAll('link[rel="modulepreload"]'))ne(te);new MutationObserver(te=>{for(const ue of te)if(ue.type==="childList")for(const se of ue.addedNodes)se.tagName==="LINK"&&se.rel==="modulepreload"&&ne(se)}).observe(document,{childList:!0,subtree:!0});function ee(te){const ue={};return te.integrity&&(ue.integrity=te.integrity),te.referrerPolicy&&(ue.referrerPolicy=te.referrerPolicy),te.crossOrigin==="use-credentials"?ue.credentials="include":te.crossOrigin==="anonymous"?ue.credentials="omit":ue.credentials="same-origin",ue}function ne(te){if(te.ep)return;te.ep=!0;const ue=ee(te);fetch(te.href,ue)}})();var n,l,u$1,i,r,o,e,f$1,c,s,a,p={},v=[],y=/acit|ex(?:s|g|n|p|$)|rph|grid|ows|mnc|ntw|ine[ch]|zoo|^ord|itera/i,w=Array.isArray;function d(Y,X){for(var ee in X)Y[ee]=X[ee];return Y}function g(Y){Y&&Y.parentNode&&Y.parentNode.removeChild(Y)}function _(Y,X,ee){var ne,te,ue,se={};for(ue in X)ue=="key"?ne=X[ue]:ue=="ref"?te=X[ue]:se[ue]=X[ue];if(arguments.length>2&&(se.children=arguments.length>3?n.call(arguments,2):ee),typeof Y=="function"&&Y.defaultProps!=null)for(ue in Y.defaultProps)se[ue]===void 0&&(se[ue]=Y.defaultProps[ue]);return m(Y,se,ne,te,null)}function m(Y,X,ee,ne,te){var ue={type:Y,props:X,key:ee,ref:ne,__k:null,__:null,__b:0,__e:null,__c:null,constructor:void 0,__v:te??++u$1,__i:-1,__u:0};return te==null&&l.vnode!=null&&l.vnode(ue),ue}function b(){return{current:null}}function k(Y){return Y.children}function x(Y,X){this.props=Y,this.context=X}function S(Y,X){if(X==null)return Y.__?S(Y.__,Y.__i+1):null;for(var ee;X<Y.__k.length;X++)if((ee=Y.__k[X])!=null&&ee.__e!=null)return ee.__e;return typeof Y.type=="function"?S(Y):null}function C(Y){var X,ee;if((Y=Y.__)!=null&&Y.__c!=null){for(Y.__e=Y.__c.base=null,X=0;X<Y.__k.length;X++)if((ee=Y.__k[X])!=null&&ee.__e!=null){Y.__e=Y.__c.base=ee.__e;break}return C(Y)}}function M(Y){(!Y.__d&&(Y.__d=!0)&&i.push(Y)&&!$.__r++||r!=l.debounceRendering)&&((r=l.debounceRendering)||o)($)}function $(){for(var Y,X,ee,ne,te,ue,se,ie=1;i.length;)i.length>ie&&i.sort(e),Y=i.shift(),ie=i.length,Y.__d&&(ee=void 0,te=(ne=(X=Y).__v).__e,ue=[],se=[],X.__P&&((ee=d({},ne)).__v=ne.__v+1,l.vnode&&l.vnode(ee),O(X.__P,ee,ne,X.__n,X.__P.namespaceURI,32&ne.__u?[te]:null,ue,te??S(ne),!!(32&ne.__u),se),ee.__v=ne.__v,ee.__.__k[ee.__i]=ee,z(ue,ee,se),ee.__e!=te&&C(ee)));$.__r=0}function I(Y,X,ee,ne,te,ue,se,ie,t,H,ae){var he,_e,ge,xe,Re,De,Ie=ne&&ne.__k||v,Ce=X.length;for(t=P(ee,X,Ie,t,Ce),he=0;he<Ce;he++)(ge=ee.__k[he])!=null&&(_e=ge.__i==-1?p:Ie[ge.__i]||p,ge.__i=he,De=O(Y,ge,_e,te,ue,se,ie,t,H,ae),xe=ge.__e,ge.ref&&_e.ref!=ge.ref&&(_e.ref&&q(_e.ref,null,ge),ae.push(ge.ref,ge.__c||xe,ge)),Re==null&&xe!=null&&(Re=xe),4&ge.__u||_e.__k===ge.__k?t=A(ge,t,Y):typeof ge.type=="function"&&De!==void 0?t=De:xe&&(t=xe.nextSibling),ge.__u&=-7);return ee.__e=Re,t}function P(Y,X,ee,ne,te){var ue,se,ie,t,H,ae=ee.length,he=ae,_e=0;for(Y.__k=new Array(te),ue=0;ue<te;ue++)(se=X[ue])!=null&&typeof se!="boolean"&&typeof se!="function"?(t=ue+_e,(se=Y.__k[ue]=typeof se=="string"||typeof se=="number"||typeof se=="bigint"||se.constructor==String?m(null,se,null,null,null):w(se)?m(k,{children:se},null,null,null):se.constructor==null&&se.__b>0?m(se.type,se.props,se.key,se.ref?se.ref:null,se.__v):se).__=Y,se.__b=Y.__b+1,ie=null,(H=se.__i=L(se,ee,t,he))!=-1&&(he--,(ie=ee[H])&&(ie.__u|=2)),ie==null||ie.__v==null?(H==-1&&(te>ae?_e--:te<ae&&_e++),typeof se.type!="function"&&(se.__u|=4)):H!=t&&(H==t-1?_e--:H==t+1?_e++:(H>t?_e--:_e++,se.__u|=4))):Y.__k[ue]=null;if(he)for(ue=0;ue<ae;ue++)(ie=ee[ue])!=null&&(2&ie.__u)==0&&(ie.__e==ne&&(ne=S(ie)),B(ie,ie));return ne}function A(Y,X,ee){var ne,te;if(typeof Y.type=="function"){for(ne=Y.__k,te=0;ne&&te<ne.length;te++)ne[te]&&(ne[te].__=Y,X=A(ne[te],X,ee));return X}Y.__e!=X&&(X&&Y.type&&!ee.contains(X)&&(X=S(Y)),ee.insertBefore(Y.__e,X||null),X=Y.__e);do X=X&&X.nextSibling;while(X!=null&&X.nodeType==8);return X}function L(Y,X,ee,ne){var te,ue,se=Y.key,ie=Y.type,t=X[ee];if(t===null&&Y.key==null||t&&se==t.key&&ie==t.type&&(2&t.__u)==0)return ee;if(ne>(t!=null&&(2&t.__u)==0?1:0))for(te=ee-1,ue=ee+1;te>=0||ue<X.length;){if(te>=0){if((t=X[te])&&(2&t.__u)==0&&se==t.key&&ie==t.type)return te;te--}if(ue<X.length){if((t=X[ue])&&(2&t.__u)==0&&se==t.key&&ie==t.type)return ue;ue++}}return-1}function T(Y,X,ee){X[0]=="-"?Y.setProperty(X,ee??""):Y[X]=ee==null?"":typeof ee!="number"||y.test(X)?ee:ee+"px"}function j(Y,X,ee,ne,te){var ue,se;e:if(X=="style")if(typeof ee=="string")Y.style.cssText=ee;else{if(typeof ne=="string"&&(Y.style.cssText=ne=""),ne)for(X in ne)ee&&X in ee||T(Y.style,X,"");if(ee)for(X in ee)ne&&ee[X]==ne[X]||T(Y.style,X,ee[X])}else if(X[0]=="o"&&X[1]=="n")ue=X!=(X=X.replace(f$1,"$1")),se=X.toLowerCase(),X=se in Y||X=="onFocusOut"||X=="onFocusIn"?se.slice(2):X.slice(2),Y.l||(Y.l={}),Y.l[X+ue]=ee,ee?ne?ee.u=ne.u:(ee.u=c,Y.addEventListener(X,ue?a:s,ue)):Y.removeEventListener(X,ue?a:s,ue);else{if(te=="http://www.w3.org/2000/svg")X=X.replace(/xlink(H|:h)/,"h").replace(/sName$/,"s");else if(X!="width"&&X!="height"&&X!="href"&&X!="list"&&X!="form"&&X!="tabIndex"&&X!="download"&&X!="rowSpan"&&X!="colSpan"&&X!="role"&&X!="popover"&&X in Y)try{Y[X]=ee??"";break e}catch{}typeof ee=="function"||(ee==null||ee===!1&&X[4]!="-"?Y.removeAttribute(X):Y.setAttribute(X,X=="popover"&&ee==1?"":ee))}}function F(Y){return function(X){if(this.l){var ee=this.l[X.type+Y];if(X.t==null)X.t=c++;else if(X.t<ee.u)return;return ee(l.event?l.event(X):X)}}}function O(Y,X,ee,ne,te,ue,se,ie,t,H){var ae,he,_e,ge,xe,Re,De,Ie,Ce,Ue,Le,ke,Ge,Ze,We,et,He,ht=X.type;if(X.constructor!=null)return null;128&ee.__u&&(t=!!(32&ee.__u),ue=[ie=X.__e=ee.__e]),(ae=l.__b)&&ae(X);e:if(typeof ht=="function")try{if(Ie=X.props,Ce="prototype"in ht&&ht.prototype.render,Ue=(ae=ht.contextType)&&ne[ae.__c],Le=ae?Ue?Ue.props.value:ae.__:ne,ee.__c?De=(he=X.__c=ee.__c).__=he.__E:(Ce?X.__c=he=new ht(Ie,Le):(X.__c=he=new x(Ie,Le),he.constructor=ht,he.render=D),Ue&&Ue.sub(he),he.props=Ie,he.state||(he.state={}),he.context=Le,he.__n=ne,_e=he.__d=!0,he.__h=[],he._sb=[]),Ce&&he.__s==null&&(he.__s=he.state),Ce&&ht.getDerivedStateFromProps!=null&&(he.__s==he.state&&(he.__s=d({},he.__s)),d(he.__s,ht.getDerivedStateFromProps(Ie,he.__s))),ge=he.props,xe=he.state,he.__v=X,_e)Ce&&ht.getDerivedStateFromProps==null&&he.componentWillMount!=null&&he.componentWillMount(),Ce&&he.componentDidMount!=null&&he.__h.push(he.componentDidMount);else{if(Ce&&ht.getDerivedStateFromProps==null&&Ie!==ge&&he.componentWillReceiveProps!=null&&he.componentWillReceiveProps(Ie,Le),!he.__e&&he.shouldComponentUpdate!=null&&he.shouldComponentUpdate(Ie,he.__s,Le)===!1||X.__v==ee.__v){for(X.__v!=ee.__v&&(he.props=Ie,he.state=he.__s,he.__d=!1),X.__e=ee.__e,X.__k=ee.__k,X.__k.some(function(_t){_t&&(_t.__=X)}),ke=0;ke<he._sb.length;ke++)he.__h.push(he._sb[ke]);he._sb=[],he.__h.length&&se.push(he);break e}he.componentWillUpdate!=null&&he.componentWillUpdate(Ie,he.__s,Le),Ce&&he.componentDidUpdate!=null&&he.__h.push(function(){he.componentDidUpdate(ge,xe,Re)})}if(he.context=Le,he.props=Ie,he.__P=Y,he.__e=!1,Ge=l.__r,Ze=0,Ce){for(he.state=he.__s,he.__d=!1,Ge&&Ge(X),ae=he.render(he.props,he.state,he.context),We=0;We<he._sb.length;We++)he.__h.push(he._sb[We]);he._sb=[]}else do he.__d=!1,Ge&&Ge(X),ae=he.render(he.props,he.state,he.context),he.state=he.__s;while(he.__d&&++Ze<25);he.state=he.__s,he.getChildContext!=null&&(ne=d(d({},ne),he.getChildContext())),Ce&&!_e&&he.getSnapshotBeforeUpdate!=null&&(Re=he.getSnapshotBeforeUpdate(ge,xe)),et=ae,ae!=null&&ae.type===k&&ae.key==null&&(et=N(ae.props.children)),ie=I(Y,w(et)?et:[et],X,ee,ne,te,ue,se,ie,t,H),he.base=X.__e,X.__u&=-161,he.__h.length&&se.push(he),De&&(he.__E=he.__=null)}catch(_t){if(X.__v=null,t||ue!=null)if(_t.then){for(X.__u|=t?160:128;ie&&ie.nodeType==8&&ie.nextSibling;)ie=ie.nextSibling;ue[ue.indexOf(ie)]=null,X.__e=ie}else for(He=ue.length;He--;)g(ue[He]);else X.__e=ee.__e,X.__k=ee.__k;l.__e(_t,X,ee)}else ue==null&&X.__v==ee.__v?(X.__k=ee.__k,X.__e=ee.__e):ie=X.__e=V(ee.__e,X,ee,ne,te,ue,se,t,H);return(ae=l.diffed)&&ae(X),128&X.__u?void 0:ie}function z(Y,X,ee){for(var ne=0;ne<ee.length;ne++)q(ee[ne],ee[++ne],ee[++ne]);l.__c&&l.__c(X,Y),Y.some(function(te){try{Y=te.__h,te.__h=[],Y.some(function(ue){ue.call(te)})}catch(ue){l.__e(ue,te.__v)}})}function N(Y){return typeof Y!="object"||Y==null||Y.__b&&Y.__b>0?Y:w(Y)?Y.map(N):d({},Y)}function V(Y,X,ee,ne,te,ue,se,ie,t){var H,ae,he,_e,ge,xe,Re,De=ee.props,Ie=X.props,Ce=X.type;if(Ce=="svg"?te="http://www.w3.org/2000/svg":Ce=="math"?te="http://www.w3.org/1998/Math/MathML":te||(te="http://www.w3.org/1999/xhtml"),ue!=null){for(H=0;H<ue.length;H++)if((ge=ue[H])&&"setAttribute"in ge==!!Ce&&(Ce?ge.localName==Ce:ge.nodeType==3)){Y=ge,ue[H]=null;break}}if(Y==null){if(Ce==null)return document.createTextNode(Ie);Y=document.createElementNS(te,Ce,Ie.is&&Ie),ie&&(l.__m&&l.__m(X,ue),ie=!1),ue=null}if(Ce==null)De===Ie||ie&&Y.data==Ie||(Y.data=Ie);else{if(ue=ue&&n.call(Y.childNodes),De=ee.props||p,!ie&&ue!=null)for(De={},H=0;H<Y.attributes.length;H++)De[(ge=Y.attributes[H]).name]=ge.value;for(H in De)if(ge=De[H],H!="children"){if(H=="dangerouslySetInnerHTML")he=ge;else if(!(H in Ie)){if(H=="value"&&"defaultValue"in Ie||H=="checked"&&"defaultChecked"in Ie)continue;j(Y,H,null,ge,te)}}for(H in Ie)ge=Ie[H],H=="children"?_e=ge:H=="dangerouslySetInnerHTML"?ae=ge:H=="value"?xe=ge:H=="checked"?Re=ge:ie&&typeof ge!="function"||De[H]===ge||j(Y,H,ge,De[H],te);if(ae)ie||he&&(ae.__html==he.__html||ae.__html==Y.innerHTML)||(Y.innerHTML=ae.__html),X.__k=[];else if(he&&(Y.innerHTML=""),I(X.type=="template"?Y.content:Y,w(_e)?_e:[_e],X,ee,ne,Ce=="foreignObject"?"http://www.w3.org/1999/xhtml":te,ue,se,ue?ue[0]:ee.__k&&S(ee,0),ie,t),ue!=null)for(H=ue.length;H--;)g(ue[H]);ie||(H="value",Ce=="progress"&&xe==null?Y.removeAttribute("value"):xe!=null&&(xe!==Y[H]||Ce=="progress"&&!xe||Ce=="option"&&xe!=De[H])&&j(Y,H,xe,De[H],te),H="checked",Re!=null&&Re!=Y[H]&&j(Y,H,Re,De[H],te))}return Y}function q(Y,X,ee){try{if(typeof Y=="function"){var ne=typeof Y.__u=="function";ne&&Y.__u(),ne&&X==null||(Y.__u=Y(X))}else Y.current=X}catch(te){l.__e(te,ee)}}function B(Y,X,ee){var ne,te;if(l.unmount&&l.unmount(Y),(ne=Y.ref)&&(ne.current&&ne.current!=Y.__e||q(ne,null,X)),(ne=Y.__c)!=null){if(ne.componentWillUnmount)try{ne.componentWillUnmount()}catch(ue){l.__e(ue,X)}ne.base=ne.__P=null}if(ne=Y.__k)for(te=0;te<ne.length;te++)ne[te]&&B(ne[te],X,ee||typeof Y.type!="function");ee||g(Y.__e),Y.__c=Y.__=Y.__e=void 0}function D(Y,X,ee){return this.constructor(Y,ee)}function E(Y,X,ee){var ne,te,ue,se;X==document&&(X=document.documentElement),l.__&&l.__(Y,X),te=(ne=!1)?null:X.__k,ue=[],se=[],O(X,Y=X.__k=_(k,null,[Y]),te||p,p,X.namespaceURI,te?null:X.firstChild?n.call(X.childNodes):null,ue,te?te.__e:X.firstChild,ne,se),z(ue,Y,se)}n=v.slice,l={__e:function(Y,X,ee,ne){for(var te,ue,se;X=X.__;)if((te=X.__c)&&!te.__)try{if((ue=te.constructor)&&ue.getDerivedStateFromError!=null&&(te.setState(ue.getDerivedStateFromError(Y)),se=te.__d),te.componentDidCatch!=null&&(te.componentDidCatch(Y,ne||{}),se=te.__d),se)return te.__E=te}catch(ie){Y=ie}throw Y}},u$1=0,x.prototype.setState=function(Y,X){var ee;ee=this.__s!=null&&this.__s!=this.state?this.__s:this.__s=d({},this.state),typeof Y=="function"&&(Y=Y(d({},ee),this.props)),Y&&d(ee,Y),Y!=null&&this.__v&&(X&&this._sb.push(X),M(this))},x.prototype.forceUpdate=function(Y){this.__v&&(this.__e=!0,Y&&this.__h.push(Y),M(this))},x.prototype.render=k,i=[],o=typeof Promise=="function"?Promise.prototype.then.bind(Promise.resolve()):setTimeout,e=function(Y,X){return Y.__v.__b-X.__v.__b},$.__r=0,f$1=/(PointerCapture)$|Capture$/i,c=0,s=F(!1),a=F(!0);var f=0;function u(Y,X,ee,ne,te,ue){X||(X={});var se,ie,t=X;if("ref"in t)for(ie in t={},X)ie=="ref"?se=X[ie]:t[ie]=X[ie];var H={type:Y,props:t,key:ee,ref:se,__k:null,__:null,__b:0,__e:null,__c:null,constructor:void 0,__v:--f,__i:-1,__u:0,__source:te,__self:ue};if(typeof Y=="function"&&(se=Y.defaultProps))for(ie in se)t[ie]===void 0&&(t[ie]=se[ie]);return l.vnode&&l.vnode(H),H}var commonjsGlobal=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};function getDefaultExportFromCjs(Y){return Y&&Y.__esModule&&Object.prototype.hasOwnProperty.call(Y,"default")?Y.default:Y}function getAugmentedNamespace(Y){if(Object.prototype.hasOwnProperty.call(Y,"__esModule"))return Y;var X=Y.default;if(typeof X=="function"){var ee=function ne(){return this instanceof ne?Reflect.construct(X,arguments,this.constructor):X.apply(this,arguments)};ee.prototype=X.prototype}else ee={};return Object.defineProperty(ee,"__esModule",{value:!0}),Object.keys(Y).forEach(function(ne){var te=Object.getOwnPropertyDescriptor(Y,ne);Object.defineProperty(ee,ne,te.get?te:{enumerable:!0,get:function(){return Y[ne]}})}),ee}var es_symbol={},es_symbol_constructor={},globalThis_1,hasRequiredGlobalThis;function requireGlobalThis(){if(hasRequiredGlobalThis)return globalThis_1;hasRequiredGlobalThis=1;var Y=function(X){return X&&X.Math===Math&&X};return globalThis_1=Y(typeof globalThis=="object"&&globalThis)||Y(typeof window=="object"&&window)||Y(typeof self=="object"&&self)||Y(typeof commonjsGlobal=="object"&&commonjsGlobal)||Y(typeof globalThis_1=="object"&&globalThis_1)||function(){return this}()||Function("return this")(),globalThis_1}var objectGetOwnPropertyDescriptor={},fails,hasRequiredFails;function requireFails(){return hasRequiredFails||(hasRequiredFails=1,fails=function(Y){try{return!!Y()}catch{return!0}}),fails}var descriptors,hasRequiredDescriptors;function requireDescriptors(){if(hasRequiredDescriptors)return descriptors;hasRequiredDescriptors=1;var Y=requireFails();return descriptors=!Y(function(){return Object.defineProperty({},1,{get:function(){return 7}})[1]!==7}),descriptors}var functionBindNative,hasRequiredFunctionBindNative;function requireFunctionBindNative(){if(hasRequiredFunctionBindNative)return functionBindNative;hasRequiredFunctionBindNative=1;var Y=requireFails();return functionBindNative=!Y(function(){var X=(function(){}).bind();return typeof X!="function"||X.hasOwnProperty("prototype")}),functionBindNative}var functionCall,hasRequiredFunctionCall;function requireFunctionCall(){if(hasRequiredFunctionCall)return functionCall;hasRequiredFunctionCall=1;var Y=requireFunctionBindNative(),X=Function.prototype.call;return functionCall=Y?X.bind(X):function(){return X.apply(X,arguments)},functionCall}var objectPropertyIsEnumerable={},hasRequiredObjectPropertyIsEnumerable;function requireObjectPropertyIsEnumerable(){if(hasRequiredObjectPropertyIsEnumerable)return objectPropertyIsEnumerable;hasRequiredObjectPropertyIsEnumerable=1;var Y={}.propertyIsEnumerable,X=Object.getOwnPropertyDescriptor,ee=X&&!Y.call({1:2},1);return objectPropertyIsEnumerable.f=ee?function(te){var ue=X(this,te);return!!ue&&ue.enumerable}:Y,objectPropertyIsEnumerable}var createPropertyDescriptor,hasRequiredCreatePropertyDescriptor;function requireCreatePropertyDescriptor(){return hasRequiredCreatePropertyDescriptor||(hasRequiredCreatePropertyDescriptor=1,createPropertyDescriptor=function(Y,X){return{enumerable:!(Y&1),configurable:!(Y&2),writable:!(Y&4),value:X}}),createPropertyDescriptor}var functionUncurryThis,hasRequiredFunctionUncurryThis;function requireFunctionUncurryThis(){if(hasRequiredFunctionUncurryThis)return functionUncurryThis;hasRequiredFunctionUncurryThis=1;var Y=requireFunctionBindNative(),X=Function.prototype,ee=X.call,ne=Y&&X.bind.bind(ee,ee);return functionUncurryThis=Y?ne:function(te){return function(){return ee.apply(te,arguments)}},functionUncurryThis}var classofRaw,hasRequiredClassofRaw;function requireClassofRaw(){if(hasRequiredClassofRaw)return classofRaw;hasRequiredClassofRaw=1;var Y=requireFunctionUncurryThis(),X=Y({}.toString),ee=Y("".slice);return classofRaw=function(ne){return ee(X(ne),8,-1)},classofRaw}var indexedObject,hasRequiredIndexedObject;function requireIndexedObject(){if(hasRequiredIndexedObject)return indexedObject;hasRequiredIndexedObject=1;var Y=requireFunctionUncurryThis(),X=requireFails(),ee=requireClassofRaw(),ne=Object,te=Y("".split);return indexedObject=X(function(){return!ne("z").propertyIsEnumerable(0)})?function(ue){return ee(ue)==="String"?te(ue,""):ne(ue)}:ne,indexedObject}var isNullOrUndefined$1,hasRequiredIsNullOrUndefined;function requireIsNullOrUndefined(){return hasRequiredIsNullOrUndefined||(hasRequiredIsNullOrUndefined=1,isNullOrUndefined$1=function(Y){return Y==null}),isNullOrUndefined$1}var requireObjectCoercible,hasRequiredRequireObjectCoercible;function requireRequireObjectCoercible(){if(hasRequiredRequireObjectCoercible)return requireObjectCoercible;hasRequiredRequireObjectCoercible=1;var Y=requireIsNullOrUndefined(),X=TypeError;return requireObjectCoercible=function(ee){if(Y(ee))throw new X("Can't call method on "+ee);return ee},requireObjectCoercible}var toIndexedObject,hasRequiredToIndexedObject;function requireToIndexedObject(){if(hasRequiredToIndexedObject)return toIndexedObject;hasRequiredToIndexedObject=1;var Y=requireIndexedObject(),X=requireRequireObjectCoercible();return toIndexedObject=function(ee){return Y(X(ee))},toIndexedObject}var isCallable,hasRequiredIsCallable;function requireIsCallable(){if(hasRequiredIsCallable)return isCallable;hasRequiredIsCallable=1;var Y=typeof document=="object"&&document.all;return isCallable=typeof Y>"u"&&Y!==void 0?function(X){return typeof X=="function"||X===Y}:function(X){return typeof X=="function"},isCallable}var isObject,hasRequiredIsObject$1;function requireIsObject$1(){if(hasRequiredIsObject$1)return isObject;hasRequiredIsObject$1=1;var Y=requireIsCallable();return isObject=function(X){return typeof X=="object"?X!==null:Y(X)},isObject}var getBuiltIn,hasRequiredGetBuiltIn;function requireGetBuiltIn(){if(hasRequiredGetBuiltIn)return getBuiltIn;hasRequiredGetBuiltIn=1;var Y=requireGlobalThis(),X=requireIsCallable(),ee=function(ne){return X(ne)?ne:void 0};return getBuiltIn=function(ne,te){return arguments.length<2?ee(Y[ne]):Y[ne]&&Y[ne][te]},getBuiltIn}var objectIsPrototypeOf,hasRequiredObjectIsPrototypeOf;function requireObjectIsPrototypeOf(){if(hasRequiredObjectIsPrototypeOf)return objectIsPrototypeOf;hasRequiredObjectIsPrototypeOf=1;var Y=requireFunctionUncurryThis();return objectIsPrototypeOf=Y({}.isPrototypeOf),objectIsPrototypeOf}var environmentUserAgent,hasRequiredEnvironmentUserAgent;function requireEnvironmentUserAgent(){if(hasRequiredEnvironmentUserAgent)return environmentUserAgent;hasRequiredEnvironmentUserAgent=1;var Y=requireGlobalThis(),X=Y.navigator,ee=X&&X.userAgent;return environmentUserAgent=ee?String(ee):"",environmentUserAgent}var environmentV8Version,hasRequiredEnvironmentV8Version;function requireEnvironmentV8Version(){if(hasRequiredEnvironmentV8Version)return environmentV8Version;hasRequiredEnvironmentV8Version=1;var Y=requireGlobalThis(),X=requireEnvironmentUserAgent(),ee=Y.process,ne=Y.Deno,te=ee&&ee.versions||ne&&ne.version,ue=te&&te.v8,se,ie;return ue&&(se=ue.split("."),ie=se[0]>0&&se[0]<4?1:+(se[0]+se[1])),!ie&&X&&(se=X.match(/Edge\/(\d+)/),(!se||se[1]>=74)&&(se=X.match(/Chrome\/(\d+)/),se&&(ie=+se[1]))),environmentV8Version=ie,environmentV8Version}var symbolConstructorDetection,hasRequiredSymbolConstructorDetection;function requireSymbolConstructorDetection(){if(hasRequiredSymbolConstructorDetection)return symbolConstructorDetection;hasRequiredSymbolConstructorDetection=1;var Y=requireEnvironmentV8Version(),X=requireFails(),ee=requireGlobalThis(),ne=ee.String;return symbolConstructorDetection=!!Object.getOwnPropertySymbols&&!X(function(){var te=Symbol("symbol detection");return!ne(te)||!(Object(te)instanceof Symbol)||!Symbol.sham&&Y&&Y<41}),symbolConstructorDetection}var useSymbolAsUid,hasRequiredUseSymbolAsUid;function requireUseSymbolAsUid(){if(hasRequiredUseSymbolAsUid)return useSymbolAsUid;hasRequiredUseSymbolAsUid=1;var Y=requireSymbolConstructorDetection();return useSymbolAsUid=Y&&!Symbol.sham&&typeof Symbol.iterator=="symbol",useSymbolAsUid}var isSymbol,hasRequiredIsSymbol$1;function requireIsSymbol$1(){if(hasRequiredIsSymbol$1)return isSymbol;hasRequiredIsSymbol$1=1;var Y=requireGetBuiltIn(),X=requireIsCallable(),ee=requireObjectIsPrototypeOf(),ne=requireUseSymbolAsUid(),te=Object;return isSymbol=ne?function(ue){return typeof ue=="symbol"}:function(ue){var se=Y("Symbol");return X(se)&&ee(se.prototype,te(ue))},isSymbol}var tryToString,hasRequiredTryToString;function requireTryToString(){if(hasRequiredTryToString)return tryToString;hasRequiredTryToString=1;var Y=String;return tryToString=function(X){try{return Y(X)}catch{return"Object"}},tryToString}var aCallable,hasRequiredACallable;function requireACallable(){if(hasRequiredACallable)return aCallable;hasRequiredACallable=1;var Y=requireIsCallable(),X=requireTryToString(),ee=TypeError;return aCallable=function(ne){if(Y(ne))return ne;throw new ee(X(ne)+" is not a function")},aCallable}var getMethod,hasRequiredGetMethod;function requireGetMethod(){if(hasRequiredGetMethod)return getMethod;hasRequiredGetMethod=1;var Y=requireACallable(),X=requireIsNullOrUndefined();return getMethod=function(ee,ne){var te=ee[ne];return X(te)?void 0:Y(te)},getMethod}var ordinaryToPrimitive,hasRequiredOrdinaryToPrimitive;function requireOrdinaryToPrimitive(){if(hasRequiredOrdinaryToPrimitive)return ordinaryToPrimitive;hasRequiredOrdinaryToPrimitive=1;var Y=requireFunctionCall(),X=requireIsCallable(),ee=requireIsObject$1(),ne=TypeError;return ordinaryToPrimitive=function(te,ue){var se,ie;if(ue==="string"&&X(se=te.toString)&&!ee(ie=Y(se,te))||X(se=te.valueOf)&&!ee(ie=Y(se,te))||ue!=="string"&&X(se=te.toString)&&!ee(ie=Y(se,te)))return ie;throw new ne("Can't convert object to primitive value")},ordinaryToPrimitive}var sharedStore={exports:{}},isPure,hasRequiredIsPure;function requireIsPure(){return hasRequiredIsPure||(hasRequiredIsPure=1,isPure=!1),isPure}var defineGlobalProperty,hasRequiredDefineGlobalProperty;function requireDefineGlobalProperty(){if(hasRequiredDefineGlobalProperty)return defineGlobalProperty;hasRequiredDefineGlobalProperty=1;var Y=requireGlobalThis(),X=Object.defineProperty;return defineGlobalProperty=function(ee,ne){try{X(Y,ee,{value:ne,configurable:!0,writable:!0})}catch{Y[ee]=ne}return ne},defineGlobalProperty}var hasRequiredSharedStore;function requireSharedStore(){if(hasRequiredSharedStore)return sharedStore.exports;hasRequiredSharedStore=1;var Y=requireIsPure(),X=requireGlobalThis(),ee=requireDefineGlobalProperty(),ne="__core-js_shared__",te=sharedStore.exports=X[ne]||ee(ne,{});return(te.versions||(te.versions=[])).push({version:"3.44.0",mode:Y?"pure":"global",copyright:"© 2014-2025 Denis Pushkarev (zloirock.ru)",license:"https://github.com/zloirock/core-js/blob/v3.44.0/LICENSE",source:"https://github.com/zloirock/core-js"}),sharedStore.exports}var shared,hasRequiredShared;function requireShared(){if(hasRequiredShared)return shared;hasRequiredShared=1;var Y=requireSharedStore();return shared=function(X,ee){return Y[X]||(Y[X]=ee||{})},shared}var toObject,hasRequiredToObject;function requireToObject(){if(hasRequiredToObject)return toObject;hasRequiredToObject=1;var Y=requireRequireObjectCoercible(),X=Object;return toObject=function(ee){return X(Y(ee))},toObject}var hasOwnProperty_1,hasRequiredHasOwnProperty;function requireHasOwnProperty(){if(hasRequiredHasOwnProperty)return hasOwnProperty_1;hasRequiredHasOwnProperty=1;var Y=requireFunctionUncurryThis(),X=requireToObject(),ee=Y({}.hasOwnProperty);return hasOwnProperty_1=Object.hasOwn||function(te,ue){return ee(X(te),ue)},hasOwnProperty_1}var uid,hasRequiredUid;function requireUid(){if(hasRequiredUid)return uid;hasRequiredUid=1;var Y=requireFunctionUncurryThis(),X=0,ee=Math.random(),ne=Y(1.1.toString);return uid=function(te){return"Symbol("+(te===void 0?"":te)+")_"+ne(++X+ee,36)},uid}var wellKnownSymbol,hasRequiredWellKnownSymbol;function requireWellKnownSymbol(){if(hasRequiredWellKnownSymbol)return wellKnownSymbol;hasRequiredWellKnownSymbol=1;var Y=requireGlobalThis(),X=requireShared(),ee=requireHasOwnProperty(),ne=requireUid(),te=requireSymbolConstructorDetection(),ue=requireUseSymbolAsUid(),se=Y.Symbol,ie=X("wks"),t=ue?se.for||se:se&&se.withoutSetter||ne;return wellKnownSymbol=function(H){return ee(ie,H)||(ie[H]=te&&ee(se,H)?se[H]:t("Symbol."+H)),ie[H]},wellKnownSymbol}var toPrimitive,hasRequiredToPrimitive;function requireToPrimitive(){if(hasRequiredToPrimitive)return toPrimitive;hasRequiredToPrimitive=1;var Y=requireFunctionCall(),X=requireIsObject$1(),ee=requireIsSymbol$1(),ne=requireGetMethod(),te=requireOrdinaryToPrimitive(),ue=requireWellKnownSymbol(),se=TypeError,ie=ue("toPrimitive");return toPrimitive=function(t,H){if(!X(t)||ee(t))return t;var ae=ne(t,ie),he;if(ae){if(H===void 0&&(H="default"),he=Y(ae,t,H),!X(he)||ee(he))return he;throw new se("Can't convert object to primitive value")}return H===void 0&&(H="number"),te(t,H)},toPrimitive}var toPropertyKey,hasRequiredToPropertyKey;function requireToPropertyKey(){if(hasRequiredToPropertyKey)return toPropertyKey;hasRequiredToPropertyKey=1;var Y=requireToPrimitive(),X=requireIsSymbol$1();return toPropertyKey=function(ee){var ne=Y(ee,"string");return X(ne)?ne:ne+""},toPropertyKey}var documentCreateElement,hasRequiredDocumentCreateElement;function requireDocumentCreateElement(){if(hasRequiredDocumentCreateElement)return documentCreateElement;hasRequiredDocumentCreateElement=1;var Y=requireGlobalThis(),X=requireIsObject$1(),ee=Y.document,ne=X(ee)&&X(ee.createElement);return documentCreateElement=function(te){return ne?ee.createElement(te):{}},documentCreateElement}var ie8DomDefine,hasRequiredIe8DomDefine;function requireIe8DomDefine(){if(hasRequiredIe8DomDefine)return ie8DomDefine;hasRequiredIe8DomDefine=1;var Y=requireDescriptors(),X=requireFails(),ee=requireDocumentCreateElement();return ie8DomDefine=!Y&&!X(function(){return Object.defineProperty(ee("div"),"a",{get:function(){return 7}}).a!==7}),ie8DomDefine}var hasRequiredObjectGetOwnPropertyDescriptor;function requireObjectGetOwnPropertyDescriptor(){if(hasRequiredObjectGetOwnPropertyDescriptor)return objectGetOwnPropertyDescriptor;hasRequiredObjectGetOwnPropertyDescriptor=1;var Y=requireDescriptors(),X=requireFunctionCall(),ee=requireObjectPropertyIsEnumerable(),ne=requireCreatePropertyDescriptor(),te=requireToIndexedObject(),ue=requireToPropertyKey(),se=requireHasOwnProperty(),ie=requireIe8DomDefine(),t=Object.getOwnPropertyDescriptor;return objectGetOwnPropertyDescriptor.f=Y?t:function(ae,he){if(ae=te(ae),he=ue(he),ie)try{return t(ae,he)}catch{}if(se(ae,he))return ne(!X(ee.f,ae,he),ae[he])},objectGetOwnPropertyDescriptor}var objectDefineProperty={},v8PrototypeDefineBug,hasRequiredV8PrototypeDefineBug;function requireV8PrototypeDefineBug(){if(hasRequiredV8PrototypeDefineBug)return v8PrototypeDefineBug;hasRequiredV8PrototypeDefineBug=1;var Y=requireDescriptors(),X=requireFails();return v8PrototypeDefineBug=Y&&X(function(){return Object.defineProperty(function(){},"prototype",{value:42,writable:!1}).prototype!==42}),v8PrototypeDefineBug}var anObject,hasRequiredAnObject;function requireAnObject(){if(hasRequiredAnObject)return anObject;hasRequiredAnObject=1;var Y=requireIsObject$1(),X=String,ee=TypeError;return anObject=function(ne){if(Y(ne))return ne;throw new ee(X(ne)+" is not an object")},anObject}var hasRequiredObjectDefineProperty;function requireObjectDefineProperty(){if(hasRequiredObjectDefineProperty)return objectDefineProperty;hasRequiredObjectDefineProperty=1;var Y=requireDescriptors(),X=requireIe8DomDefine(),ee=requireV8PrototypeDefineBug(),ne=requireAnObject(),te=requireToPropertyKey(),ue=TypeError,se=Object.defineProperty,ie=Object.getOwnPropertyDescriptor,t="enumerable",H="configurable",ae="writable";return objectDefineProperty.f=Y?ee?function(_e,ge,xe){if(ne(_e),ge=te(ge),ne(xe),typeof _e=="function"&&ge==="prototype"&&"value"in xe&&ae in xe&&!xe[ae]){var Re=ie(_e,ge);Re&&Re[ae]&&(_e[ge]=xe.value,xe={configurable:H in xe?xe[H]:Re[H],enumerable:t in xe?xe[t]:Re[t],writable:!1})}return se(_e,ge,xe)}:se:function(_e,ge,xe){if(ne(_e),ge=te(ge),ne(xe),X)try{return se(_e,ge,xe)}catch{}if("get"in xe||"set"in xe)throw new ue("Accessors not supported");return"value"in xe&&(_e[ge]=xe.value),_e},objectDefineProperty}var createNonEnumerableProperty,hasRequiredCreateNonEnumerableProperty;function requireCreateNonEnumerableProperty(){if(hasRequiredCreateNonEnumerableProperty)return createNonEnumerableProperty;hasRequiredCreateNonEnumerableProperty=1;var Y=requireDescriptors(),X=requireObjectDefineProperty(),ee=requireCreatePropertyDescriptor();return createNonEnumerableProperty=Y?function(ne,te,ue){return X.f(ne,te,ee(1,ue))}:function(ne,te,ue){return ne[te]=ue,ne},createNonEnumerableProperty}var makeBuiltIn={exports:{}},functionName,hasRequiredFunctionName;function requireFunctionName(){if(hasRequiredFunctionName)return functionName;hasRequiredFunctionName=1;var Y=requireDescriptors(),X=requireHasOwnProperty(),ee=Function.prototype,ne=Y&&Object.getOwnPropertyDescriptor,te=X(ee,"name"),ue=te&&(function(){}).name==="something",se=te&&(!Y||Y&&ne(ee,"name").configurable);return functionName={EXISTS:te,PROPER:ue,CONFIGURABLE:se},functionName}var inspectSource,hasRequiredInspectSource;function requireInspectSource(){if(hasRequiredInspectSource)return inspectSource;hasRequiredInspectSource=1;var Y=requireFunctionUncurryThis(),X=requireIsCallable(),ee=requireSharedStore(),ne=Y(Function.toString);return X(ee.inspectSource)||(ee.inspectSource=function(te){return ne(te)}),inspectSource=ee.inspectSource,inspectSource}var weakMapBasicDetection,hasRequiredWeakMapBasicDetection;function requireWeakMapBasicDetection(){if(hasRequiredWeakMapBasicDetection)return weakMapBasicDetection;hasRequiredWeakMapBasicDetection=1;var Y=requireGlobalThis(),X=requireIsCallable(),ee=Y.WeakMap;return weakMapBasicDetection=X(ee)&&/native code/.test(String(ee)),weakMapBasicDetection}var sharedKey,hasRequiredSharedKey;function requireSharedKey(){if(hasRequiredSharedKey)return sharedKey;hasRequiredSharedKey=1;var Y=requireShared(),X=requireUid(),ee=Y("keys");return sharedKey=function(ne){return ee[ne]||(ee[ne]=X(ne))},sharedKey}var hiddenKeys,hasRequiredHiddenKeys;function requireHiddenKeys(){return hasRequiredHiddenKeys||(hasRequiredHiddenKeys=1,hiddenKeys={}),hiddenKeys}var internalState,hasRequiredInternalState;function requireInternalState(){if(hasRequiredInternalState)return internalState;hasRequiredInternalState=1;var Y=requireWeakMapBasicDetection(),X=requireGlobalThis(),ee=requireIsObject$1(),ne=requireCreateNonEnumerableProperty(),te=requireHasOwnProperty(),ue=requireSharedStore(),se=requireSharedKey(),ie=requireHiddenKeys(),t="Object already initialized",H=X.TypeError,ae=X.WeakMap,he,_e,ge,xe=function(Ce){return ge(Ce)?_e(Ce):he(Ce,{})},Re=function(Ce){return function(Ue){var Le;if(!ee(Ue)||(Le=_e(Ue)).type!==Ce)throw new H("Incompatible receiver, "+Ce+" required");return Le}};if(Y||ue.state){var De=ue.state||(ue.state=new ae);De.get=De.get,De.has=De.has,De.set=De.set,he=function(Ce,Ue){if(De.has(Ce))throw new H(t);return Ue.facade=Ce,De.set(Ce,Ue),Ue},_e=function(Ce){return De.get(Ce)||{}},ge=function(Ce){return De.has(Ce)}}else{var Ie=se("state");ie[Ie]=!0,he=function(Ce,Ue){if(te(Ce,Ie))throw new H(t);return Ue.facade=Ce,ne(Ce,Ie,Ue),Ue},_e=function(Ce){return te(Ce,Ie)?Ce[Ie]:{}},ge=function(Ce){return te(Ce,Ie)}}return internalState={set:he,get:_e,has:ge,enforce:xe,getterFor:Re},internalState}var hasRequiredMakeBuiltIn;function requireMakeBuiltIn(){if(hasRequiredMakeBuiltIn)return makeBuiltIn.exports;hasRequiredMakeBuiltIn=1;var Y=requireFunctionUncurryThis(),X=requireFails(),ee=requireIsCallable(),ne=requireHasOwnProperty(),te=requireDescriptors(),ue=requireFunctionName().CONFIGURABLE,se=requireInspectSource(),ie=requireInternalState(),t=ie.enforce,H=ie.get,ae=String,he=Object.defineProperty,_e=Y("".slice),ge=Y("".replace),xe=Y([].join),Re=te&&!X(function(){return he(function(){},"length",{value:8}).length!==8}),De=String(String).split("String"),Ie=makeBuiltIn.exports=function(Ce,Ue,Le){_e(ae(Ue),0,7)==="Symbol("&&(Ue="["+ge(ae(Ue),/^Symbol\(([^)]*)\).*$/,"$1")+"]"),Le&&Le.getter&&(Ue="get "+Ue),Le&&Le.setter&&(Ue="set "+Ue),(!ne(Ce,"name")||ue&&Ce.name!==Ue)&&(te?he(Ce,"name",{value:Ue,configurable:!0}):Ce.name=Ue),Re&&Le&&ne(Le,"arity")&&Ce.length!==Le.arity&&he(Ce,"length",{value:Le.arity});try{Le&&ne(Le,"constructor")&&Le.constructor?te&&he(Ce,"prototype",{writable:!1}):Ce.prototype&&(Ce.prototype=void 0)}catch{}var ke=t(Ce);return ne(ke,"source")||(ke.source=xe(De,typeof Ue=="string"?Ue:"")),Ce};return Function.prototype.toString=Ie(function(){return ee(this)&&H(this).source||se(this)},"toString"),makeBuiltIn.exports}var defineBuiltIn,hasRequiredDefineBuiltIn;function requireDefineBuiltIn(){if(hasRequiredDefineBuiltIn)return defineBuiltIn;hasRequiredDefineBuiltIn=1;var Y=requireIsCallable(),X=requireObjectDefineProperty(),ee=requireMakeBuiltIn(),ne=requireDefineGlobalProperty();return defineBuiltIn=function(te,ue,se,ie){ie||(ie={});var t=ie.enumerable,H=ie.name!==void 0?ie.name:ue;if(Y(se)&&ee(se,H,ie),ie.global)t?te[ue]=se:ne(ue,se);else{try{ie.unsafe?te[ue]&&(t=!0):delete te[ue]}catch{}t?te[ue]=se:X.f(te,ue,{value:se,enumerable:!1,configurable:!ie.nonConfigurable,writable:!ie.nonWritable})}return te},defineBuiltIn}var objectGetOwnPropertyNames={},mathTrunc,hasRequiredMathTrunc;function requireMathTrunc(){if(hasRequiredMathTrunc)return mathTrunc;hasRequiredMathTrunc=1;var Y=Math.ceil,X=Math.floor;return mathTrunc=Math.trunc||function(ne){var te=+ne;return(te>0?X:Y)(te)},mathTrunc}var toIntegerOrInfinity,hasRequiredToIntegerOrInfinity;function requireToIntegerOrInfinity(){if(hasRequiredToIntegerOrInfinity)return toIntegerOrInfinity;hasRequiredToIntegerOrInfinity=1;var Y=requireMathTrunc();return toIntegerOrInfinity=function(X){var ee=+X;return ee!==ee||ee===0?0:Y(ee)},toIntegerOrInfinity}var toAbsoluteIndex,hasRequiredToAbsoluteIndex;function requireToAbsoluteIndex(){if(hasRequiredToAbsoluteIndex)return toAbsoluteIndex;hasRequiredToAbsoluteIndex=1;var Y=requireToIntegerOrInfinity(),X=Math.max,ee=Math.min;return toAbsoluteIndex=function(ne,te){var ue=Y(ne);return ue<0?X(ue+te,0):ee(ue,te)},toAbsoluteIndex}var toLength,hasRequiredToLength;function requireToLength(){if(hasRequiredToLength)return toLength;hasRequiredToLength=1;var Y=requireToIntegerOrInfinity(),X=Math.min;return toLength=function(ee){var ne=Y(ee);return ne>0?X(ne,9007199254740991):0},toLength}var lengthOfArrayLike,hasRequiredLengthOfArrayLike;function requireLengthOfArrayLike(){if(hasRequiredLengthOfArrayLike)return lengthOfArrayLike;hasRequiredLengthOfArrayLike=1;var Y=requireToLength();return lengthOfArrayLike=function(X){return Y(X.length)},lengthOfArrayLike}var arrayIncludes,hasRequiredArrayIncludes;function requireArrayIncludes(){if(hasRequiredArrayIncludes)return arrayIncludes;hasRequiredArrayIncludes=1;var Y=requireToIndexedObject(),X=requireToAbsoluteIndex(),ee=requireLengthOfArrayLike(),ne=function(te){return function(ue,se,ie){var t=Y(ue),H=ee(t);if(H===0)return!te&&-1;var ae=X(ie,H),he;if(te&&se!==se){for(;H>ae;)if(he=t[ae++],he!==he)return!0}else for(;H>ae;ae++)if((te||ae in t)&&t[ae]===se)return te||ae||0;return!te&&-1}};return arrayIncludes={includes:ne(!0),indexOf:ne(!1)},arrayIncludes}var objectKeysInternal,hasRequiredObjectKeysInternal;function requireObjectKeysInternal(){if(hasRequiredObjectKeysInternal)return objectKeysInternal;hasRequiredObjectKeysInternal=1;var Y=requireFunctionUncurryThis(),X=requireHasOwnProperty(),ee=requireToIndexedObject(),ne=requireArrayIncludes().indexOf,te=requireHiddenKeys(),ue=Y([].push);return objectKeysInternal=function(se,ie){var t=ee(se),H=0,ae=[],he;for(he in t)!X(te,he)&&X(t,he)&&ue(ae,he);for(;ie.length>H;)X(t,he=ie[H++])&&(~ne(ae,he)||ue(ae,he));return ae},objectKeysInternal}var enumBugKeys,hasRequiredEnumBugKeys;function requireEnumBugKeys(){return hasRequiredEnumBugKeys||(hasRequiredEnumBugKeys=1,enumBugKeys=["constructor","hasOwnProperty","isPrototypeOf","propertyIsEnumerable","toLocaleString","toString","valueOf"]),enumBugKeys}var hasRequiredObjectGetOwnPropertyNames;function requireObjectGetOwnPropertyNames(){if(hasRequiredObjectGetOwnPropertyNames)return objectGetOwnPropertyNames;hasRequiredObjectGetOwnPropertyNames=1;var Y=requireObjectKeysInternal(),X=requireEnumBugKeys(),ee=X.concat("length","prototype");return objectGetOwnPropertyNames.f=Object.getOwnPropertyNames||function(te){return Y(te,ee)},objectGetOwnPropertyNames}var objectGetOwnPropertySymbols={},hasRequiredObjectGetOwnPropertySymbols;function requireObjectGetOwnPropertySymbols(){return hasRequiredObjectGetOwnPropertySymbols||(hasRequiredObjectGetOwnPropertySymbols=1,objectGetOwnPropertySymbols.f=Object.getOwnPropertySymbols),objectGetOwnPropertySymbols}var ownKeys,hasRequiredOwnKeys;function requireOwnKeys(){if(hasRequiredOwnKeys)return ownKeys;hasRequiredOwnKeys=1;var Y=requireGetBuiltIn(),X=requireFunctionUncurryThis(),ee=requireObjectGetOwnPropertyNames(),ne=requireObjectGetOwnPropertySymbols(),te=requireAnObject(),ue=X([].concat);return ownKeys=Y("Reflect","ownKeys")||function(ie){var t=ee.f(te(ie)),H=ne.f;return H?ue(t,H(ie)):t},ownKeys}var copyConstructorProperties,hasRequiredCopyConstructorProperties;function requireCopyConstructorProperties(){if(hasRequiredCopyConstructorProperties)return copyConstructorProperties;hasRequiredCopyConstructorProperties=1;var Y=requireHasOwnProperty(),X=requireOwnKeys(),ee=requireObjectGetOwnPropertyDescriptor(),ne=requireObjectDefineProperty();return copyConstructorProperties=function(te,ue,se){for(var ie=X(ue),t=ne.f,H=ee.f,ae=0;ae<ie.length;ae++){var he=ie[ae];!Y(te,he)&&!(se&&Y(se,he))&&t(te,he,H(ue,he))}},copyConstructorProperties}var isForced_1,hasRequiredIsForced;function requireIsForced(){if(hasRequiredIsForced)return isForced_1;hasRequiredIsForced=1;var Y=requireFails(),X=requireIsCallable(),ee=/#|\.prototype\./,ne=function(t,H){var ae=ue[te(t)];return ae===ie?!0:ae===se?!1:X(H)?Y(H):!!H},te=ne.normalize=function(t){return String(t).replace(ee,".").toLowerCase()},ue=ne.data={},se=ne.NATIVE="N",ie=ne.POLYFILL="P";return isForced_1=ne,isForced_1}var _export,hasRequired_export;function require_export(){if(hasRequired_export)return _export;hasRequired_export=1;var Y=requireGlobalThis(),X=requireObjectGetOwnPropertyDescriptor().f,ee=requireCreateNonEnumerableProperty(),ne=requireDefineBuiltIn(),te=requireDefineGlobalProperty(),ue=requireCopyConstructorProperties(),se=requireIsForced();return _export=function(ie,t){var H=ie.target,ae=ie.global,he=ie.stat,_e,ge,xe,Re,De,Ie;if(ae?ge=Y:he?ge=Y[H]||te(H,{}):ge=Y[H]&&Y[H].prototype,ge)for(xe in t){if(De=t[xe],ie.dontCallGetSet?(Ie=X(ge,xe),Re=Ie&&Ie.value):Re=ge[xe],_e=se(ae?xe:H+(he?".":"#")+xe,ie.forced),!_e&&Re!==void 0){if(typeof De==typeof Re)continue;ue(De,Re)}(ie.sham||Re&&Re.sham)&&ee(De,"sham",!0),ne(ge,xe,De,ie)}},_export}var toStringTagSupport,hasRequiredToStringTagSupport;function requireToStringTagSupport(){if(hasRequiredToStringTagSupport)return toStringTagSupport;hasRequiredToStringTagSupport=1;var Y=requireWellKnownSymbol(),X=Y("toStringTag"),ee={};return ee[X]="z",toStringTagSupport=String(ee)==="[object z]",toStringTagSupport}var classof,hasRequiredClassof;function requireClassof(){if(hasRequiredClassof)return classof;hasRequiredClassof=1;var Y=requireToStringTagSupport(),X=requireIsCallable(),ee=requireClassofRaw(),ne=requireWellKnownSymbol(),te=ne("toStringTag"),ue=Object,se=ee(function(){return arguments}())==="Arguments",ie=function(t,H){try{return t[H]}catch{}};return classof=Y?ee:function(t){var H,ae,he;return t===void 0?"Undefined":t===null?"Null":typeof(ae=ie(H=ue(t),te))=="string"?ae:se?ee(H):(he=ee(H))==="Object"&&X(H.callee)?"Arguments":he},classof}var toString,hasRequiredToString$1;function requireToString$1(){if(hasRequiredToString$1)return toString;hasRequiredToString$1=1;var Y=requireClassof(),X=String;return toString=function(ee){if(Y(ee)==="Symbol")throw new TypeError("Cannot convert a Symbol value to a string");return X(ee)},toString}var objectDefineProperties={},objectKeys,hasRequiredObjectKeys;function requireObjectKeys(){if(hasRequiredObjectKeys)return objectKeys;hasRequiredObjectKeys=1;var Y=requireObjectKeysInternal(),X=requireEnumBugKeys();return objectKeys=Object.keys||function(ne){return Y(ne,X)},objectKeys}var hasRequiredObjectDefineProperties;function requireObjectDefineProperties(){if(hasRequiredObjectDefineProperties)return objectDefineProperties;hasRequiredObjectDefineProperties=1;var Y=requireDescriptors(),X=requireV8PrototypeDefineBug(),ee=requireObjectDefineProperty(),ne=requireAnObject(),te=requireToIndexedObject(),ue=requireObjectKeys();return objectDefineProperties.f=Y&&!X?Object.defineProperties:function(ie,t){ne(ie);for(var H=te(t),ae=ue(t),he=ae.length,_e=0,ge;he>_e;)ee.f(ie,ge=ae[_e++],H[ge]);return ie},objectDefineProperties}var html,hasRequiredHtml;function requireHtml(){if(hasRequiredHtml)return html;hasRequiredHtml=1;var Y=requireGetBuiltIn();return html=Y("document","documentElement"),html}var objectCreate,hasRequiredObjectCreate;function requireObjectCreate(){if(hasRequiredObjectCreate)return objectCreate;hasRequiredObjectCreate=1;var Y=requireAnObject(),X=requireObjectDefineProperties(),ee=requireEnumBugKeys(),ne=requireHiddenKeys(),te=requireHtml(),ue=requireDocumentCreateElement(),se=requireSharedKey(),ie=">",t="<",H="prototype",ae="script",he=se("IE_PROTO"),_e=function(){},ge=function(Ce){return t+ae+ie+Ce+t+"/"+ae+ie},xe=function(Ce){Ce.write(ge("")),Ce.close();var Ue=Ce.parentWindow.Object;return Ce=null,Ue},Re=function(){var Ce=ue("iframe"),Ue="java"+ae+":",Le;return Ce.style.display="none",te.appendChild(Ce),Ce.src=String(Ue),Le=Ce.contentWindow.document,Le.open(),Le.write(ge("document.F=Object")),Le.close(),Le.F},De,Ie=function(){try{De=new ActiveXObject("htmlfile")}catch{}Ie=typeof document<"u"?document.domain&&De?xe(De):Re():xe(De);for(var Ce=ee.length;Ce--;)delete Ie[H][ee[Ce]];return Ie()};return ne[he]=!0,objectCreate=Object.create||function(Ue,Le){var ke;return Ue!==null?(_e[H]=Y(Ue),ke=new _e,_e[H]=null,ke[he]=Ue):ke=Ie(),Le===void 0?ke:X.f(ke,Le)},objectCreate}var objectGetOwnPropertyNamesExternal={},arraySlice,hasRequiredArraySlice;function requireArraySlice(){if(hasRequiredArraySlice)return arraySlice;hasRequiredArraySlice=1;var Y=requireFunctionUncurryThis();return arraySlice=Y([].slice),arraySlice}var hasRequiredObjectGetOwnPropertyNamesExternal;function requireObjectGetOwnPropertyNamesExternal(){if(hasRequiredObjectGetOwnPropertyNamesExternal)return objectGetOwnPropertyNamesExternal;hasRequiredObjectGetOwnPropertyNamesExternal=1;var Y=requireClassofRaw(),X=requireToIndexedObject(),ee=requireObjectGetOwnPropertyNames().f,ne=requireArraySlice(),te=typeof window=="object"&&window&&Object.getOwnPropertyNames?Object.getOwnPropertyNames(window):[],ue=function(se){try{return ee(se)}catch{return ne(te)}};return objectGetOwnPropertyNamesExternal.f=function(ie){return te&&Y(ie)==="Window"?ue(ie):ee(X(ie))},objectGetOwnPropertyNamesExternal}var defineBuiltInAccessor,hasRequiredDefineBuiltInAccessor;function requireDefineBuiltInAccessor(){if(hasRequiredDefineBuiltInAccessor)return defineBuiltInAccessor;hasRequiredDefineBuiltInAccessor=1;var Y=requireMakeBuiltIn(),X=requireObjectDefineProperty();return defineBuiltInAccessor=function(ee,ne,te){return te.get&&Y(te.get,ne,{getter:!0}),te.set&&Y(te.set,ne,{setter:!0}),X.f(ee,ne,te)},defineBuiltInAccessor}var wellKnownSymbolWrapped={},hasRequiredWellKnownSymbolWrapped;function requireWellKnownSymbolWrapped(){if(hasRequiredWellKnownSymbolWrapped)return wellKnownSymbolWrapped;hasRequiredWellKnownSymbolWrapped=1;var Y=requireWellKnownSymbol();return wellKnownSymbolWrapped.f=Y,wellKnownSymbolWrapped}var path,hasRequiredPath;function requirePath(){if(hasRequiredPath)return path;hasRequiredPath=1;var Y=requireGlobalThis();return path=Y,path}var wellKnownSymbolDefine,hasRequiredWellKnownSymbolDefine;function requireWellKnownSymbolDefine(){if(hasRequiredWellKnownSymbolDefine)return wellKnownSymbolDefine;hasRequiredWellKnownSymbolDefine=1;var Y=requirePath(),X=requireHasOwnProperty(),ee=requireWellKnownSymbolWrapped(),ne=requireObjectDefineProperty().f;return wellKnownSymbolDefine=function(te){var ue=Y.Symbol||(Y.Symbol={});X(ue,te)||ne(ue,te,{value:ee.f(te)})},wellKnownSymbolDefine}var symbolDefineToPrimitive,hasRequiredSymbolDefineToPrimitive;function requireSymbolDefineToPrimitive(){if(hasRequiredSymbolDefineToPrimitive)return symbolDefineToPrimitive;hasRequiredSymbolDefineToPrimitive=1;var Y=requireFunctionCall(),X=requireGetBuiltIn(),ee=requireWellKnownSymbol(),ne=requireDefineBuiltIn();return symbolDefineToPrimitive=function(){var te=X("Symbol"),ue=te&&te.prototype,se=ue&&ue.valueOf,ie=ee("toPrimitive");ue&&!ue[ie]&&ne(ue,ie,function(t){return Y(se,this)},{arity:1})},symbolDefineToPrimitive}var setToStringTag,hasRequiredSetToStringTag;function requireSetToStringTag(){if(hasRequiredSetToStringTag)return setToStringTag;hasRequiredSetToStringTag=1;var Y=requireObjectDefineProperty().f,X=requireHasOwnProperty(),ee=requireWellKnownSymbol(),ne=ee("toStringTag");return setToStringTag=function(te,ue,se){te&&!se&&(te=te.prototype),te&&!X(te,ne)&&Y(te,ne,{configurable:!0,value:ue})},setToStringTag}var functionUncurryThisClause,hasRequiredFunctionUncurryThisClause;function requireFunctionUncurryThisClause(){if(hasRequiredFunctionUncurryThisClause)return functionUncurryThisClause;hasRequiredFunctionUncurryThisClause=1;var Y=requireClassofRaw(),X=requireFunctionUncurryThis();return functionUncurryThisClause=function(ee){if(Y(ee)==="Function")return X(ee)},functionUncurryThisClause}var functionBindContext,hasRequiredFunctionBindContext;function requireFunctionBindContext(){if(hasRequiredFunctionBindContext)return functionBindContext;hasRequiredFunctionBindContext=1;var Y=requireFunctionUncurryThisClause(),X=requireACallable(),ee=requireFunctionBindNative(),ne=Y(Y.bind);return functionBindContext=function(te,ue){return X(te),ue===void 0?te:ee?ne(te,ue):function(){return te.apply(ue,arguments)}},functionBindContext}var isArray,hasRequiredIsArray$1;function requireIsArray$1(){if(hasRequiredIsArray$1)return isArray;hasRequiredIsArray$1=1;var Y=requireClassofRaw();return isArray=Array.isArray||function(ee){return Y(ee)==="Array"},isArray}var isConstructor,hasRequiredIsConstructor;function requireIsConstructor(){if(hasRequiredIsConstructor)return isConstructor;hasRequiredIsConstructor=1;var Y=requireFunctionUncurryThis(),X=requireFails(),ee=requireIsCallable(),ne=requireClassof(),te=requireGetBuiltIn(),ue=requireInspectSource(),se=function(){},ie=te("Reflect","construct"),t=/^\s*(?:class|function)\b/,H=Y(t.exec),ae=!t.test(se),he=function(xe){if(!ee(xe))return!1;try{return ie(se,[],xe),!0}catch{return!1}},_e=function(xe){if(!ee(xe))return!1;switch(ne(xe)){case"AsyncFunction":case"GeneratorFunction":case"AsyncGeneratorFunction":return!1}try{return ae||!!H(t,ue(xe))}catch{return!0}};return _e.sham=!0,isConstructor=!ie||X(function(){var ge;return he(he.call)||!he(Object)||!he(function(){ge=!0})||ge})?_e:he,isConstructor}var arraySpeciesConstructor,hasRequiredArraySpeciesConstructor;function requireArraySpeciesConstructor(){if(hasRequiredArraySpeciesConstructor)return arraySpeciesConstructor;hasRequiredArraySpeciesConstructor=1;var Y=requireIsArray$1(),X=requireIsConstructor(),ee=requireIsObject$1(),ne=requireWellKnownSymbol(),te=ne("species"),ue=Array;return arraySpeciesConstructor=function(se){var ie;return Y(se)&&(ie=se.constructor,X(ie)&&(ie===ue||Y(ie.prototype))?ie=void 0:ee(ie)&&(ie=ie[te],ie===null&&(ie=void 0))),ie===void 0?ue:ie},arraySpeciesConstructor}var arraySpeciesCreate,hasRequiredArraySpeciesCreate;function requireArraySpeciesCreate(){if(hasRequiredArraySpeciesCreate)return arraySpeciesCreate;hasRequiredArraySpeciesCreate=1;var Y=requireArraySpeciesConstructor();return arraySpeciesCreate=function(X,ee){return new(Y(X))(ee===0?0:ee)},arraySpeciesCreate}var arrayIteration,hasRequiredArrayIteration;function requireArrayIteration(){if(hasRequiredArrayIteration)return arrayIteration;hasRequiredArrayIteration=1;var Y=requireFunctionBindContext(),X=requireFunctionUncurryThis(),ee=requireIndexedObject(),ne=requireToObject(),te=requireLengthOfArrayLike(),ue=requireArraySpeciesCreate(),se=X([].push),ie=function(t){var H=t===1,ae=t===2,he=t===3,_e=t===4,ge=t===6,xe=t===7,Re=t===5||ge;return function(De,Ie,Ce,Ue){for(var Le=ne(De),ke=ee(Le),Ge=te(ke),Ze=Y(Ie,Ce),We=0,et=Ue||ue,He=H?et(De,Ge):ae||xe?et(De,0):void 0,ht,_t;Ge>We;We++)if((Re||We in ke)&&(ht=ke[We],_t=Ze(ht,We,Le),t))if(H)He[We]=_t;else if(_t)switch(t){case 3:return!0;case 5:return ht;case 6:return We;case 2:se(He,ht)}else switch(t){case 4:return!1;case 7:se(He,ht)}return ge?-1:he||_e?_e:He}};return arrayIteration={forEach:ie(0),map:ie(1),filter:ie(2),some:ie(3),every:ie(4),find:ie(5),findIndex:ie(6),filterReject:ie(7)},arrayIteration}var hasRequiredEs_symbol_constructor;function requireEs_symbol_constructor(){if(hasRequiredEs_symbol_constructor)return es_symbol_constructor;hasRequiredEs_symbol_constructor=1;var Y=require_export(),X=requireGlobalThis(),ee=requireFunctionCall(),ne=requireFunctionUncurryThis(),te=requireIsPure(),ue=requireDescriptors(),se=requireSymbolConstructorDetection(),ie=requireFails(),t=requireHasOwnProperty(),H=requireObjectIsPrototypeOf(),ae=requireAnObject(),he=requireToIndexedObject(),_e=requireToPropertyKey(),ge=requireToString$1(),xe=requireCreatePropertyDescriptor(),Re=requireObjectCreate(),De=requireObjectKeys(),Ie=requireObjectGetOwnPropertyNames(),Ce=requireObjectGetOwnPropertyNamesExternal(),Ue=requireObjectGetOwnPropertySymbols(),Le=requireObjectGetOwnPropertyDescriptor(),ke=requireObjectDefineProperty(),Ge=requireObjectDefineProperties(),Ze=requireObjectPropertyIsEnumerable(),We=requireDefineBuiltIn(),et=requireDefineBuiltInAccessor(),He=requireShared(),ht=requireSharedKey(),_t=requireHiddenKeys(),ut=requireUid(),yt=requireWellKnownSymbol(),Lt=requireWellKnownSymbolWrapped(),Kt=requireWellKnownSymbolDefine(),ft=requireSymbolDefineToPrimitive(),qt=requireSetToStringTag(),nt=requireInternalState(),At=requireArrayIteration().forEach,wt=ht("hidden"),Ft="Symbol",er="prototype",lr=nt.set,jr=nt.getterFor(Ft),Mr=Object[er],Lr=X.Symbol,sr=Lr&&Lr[er],Rr=X.RangeError,Ur=X.TypeError,Wr=X.QObject,Er=Le.f,Kr=ke.f,ui=Ce.f,Ei=Ze.f,Hr=ne([].push),Br=He("symbols"),li=He("op-symbols"),si=He("wks"),Qr=!Wr||!Wr[er]||!Wr[er].findChild,_r=function(st,gt,Ot){var tr=Er(Mr,gt);tr&&delete Mr[gt],Kr(st,gt,Ot),tr&&st!==Mr&&Kr(Mr,gt,tr)},vr=ue&&ie(function(){return Re(Kr({},"a",{get:function(){return Kr(this,"a",{value:7}).a}})).a!==7})?_r:Kr,Xr=function(st,gt){var Ot=Br[st]=Re(sr);return lr(Ot,{type:Ft,tag:st,description:gt}),ue||(Ot.description=gt),Ot},Ir=function(gt,Ot,tr){gt===Mr&&Ir(li,Ot,tr),ae(gt);var Qt=_e(Ot);return ae(tr),t(Br,Qt)?(tr.enumerable?(t(gt,wt)&&gt[wt][Qt]&&(gt[wt][Qt]=!1),tr=Re(tr,{enumerable:xe(0,!1)})):(t(gt,wt)||Kr(gt,wt,xe(1,Re(null))),gt[wt][Qt]=!0),vr(gt,Qt,tr)):Kr(gt,Qt,tr)},Or=function(gt,Ot){ae(gt);var tr=he(Ot),Qt=De(tr).concat(Ve(tr));return At(Qt,function(xt){(!ue||ee(je,tr,xt))&&Ir(gt,xt,tr[xt])}),gt},Nr=function(gt,Ot){return Ot===void 0?Re(gt):Or(Re(gt),Ot)},je=function(gt){var Ot=_e(gt),tr=ee(Ei,this,Ot);return this===Mr&&t(Br,Ot)&&!t(li,Ot)?!1:tr||!t(this,Ot)||!t(Br,Ot)||t(this,wt)&&this[wt][Ot]?tr:!0},Se=function(gt,Ot){var tr=he(gt),Qt=_e(Ot);if(!(tr===Mr&&t(Br,Qt)&&!t(li,Qt))){var xt=Er(tr,Qt);return xt&&t(Br,Qt)&&!(t(tr,wt)&&tr[wt][Qt])&&(xt.enumerable=!0),xt}},Oe=function(gt){var Ot=ui(he(gt)),tr=[];return At(Ot,function(Qt){!t(Br,Qt)&&!t(_t,Qt)&&Hr(tr,Qt)}),tr},Ve=function(st){var gt=st===Mr,Ot=ui(gt?li:he(st)),tr=[];return At(Ot,function(Qt){t(Br,Qt)&&(!gt||t(Mr,Qt))&&Hr(tr,Br[Qt])}),tr};return se||(Lr=function(){if(H(sr,this))throw new Ur("Symbol is not a constructor");var gt=!arguments.length||arguments[0]===void 0?void 0:ge(arguments[0]),Ot=ut(gt),tr=function(Qt){var xt=this===void 0?X:this;xt===Mr&&ee(tr,li,Qt),t(xt,wt)&&t(xt[wt],Ot)&&(xt[wt][Ot]=!1);var Ct=xe(1,Qt);try{vr(xt,Ot,Ct)}catch(Nt){if(!(Nt instanceof Rr))throw Nt;_r(xt,Ot,Ct)}};return ue&&Qr&&vr(Mr,Ot,{configurable:!0,set:tr}),Xr(Ot,gt)},sr=Lr[er],We(sr,"toString",function(){return jr(this).tag}),We(Lr,"withoutSetter",function(st){return Xr(ut(st),st)}),Ze.f=je,ke.f=Ir,Ge.f=Or,Le.f=Se,Ie.f=Ce.f=Oe,Ue.f=Ve,Lt.f=function(st){return Xr(yt(st),st)},ue&&(et(sr,"description",{configurable:!0,get:function(){return jr(this).description}}),te||We(Mr,"propertyIsEnumerable",je,{unsafe:!0}))),Y({global:!0,constructor:!0,wrap:!0,forced:!se,sham:!se},{Symbol:Lr}),At(De(si),function(st){Kt(st)}),Y({target:Ft,stat:!0,forced:!se},{useSetter:function(){Qr=!0},useSimple:function(){Qr=!1}}),Y({target:"Object",stat:!0,forced:!se,sham:!ue},{create:Nr,defineProperty:Ir,defineProperties:Or,getOwnPropertyDescriptor:Se}),Y({target:"Object",stat:!0,forced:!se},{getOwnPropertyNames:Oe}),ft(),qt(Lr,Ft),_t[wt]=!0,es_symbol_constructor}var es_symbol_for={},symbolRegistryDetection,hasRequiredSymbolRegistryDetection;function requireSymbolRegistryDetection(){if(hasRequiredSymbolRegistryDetection)return symbolRegistryDetection;hasRequiredSymbolRegistryDetection=1;var Y=requireSymbolConstructorDetection();return symbolRegistryDetection=Y&&!!Symbol.for&&!!Symbol.keyFor,symbolRegistryDetection}var hasRequiredEs_symbol_for;function requireEs_symbol_for(){if(hasRequiredEs_symbol_for)return es_symbol_for;hasRequiredEs_symbol_for=1;var Y=require_export(),X=requireGetBuiltIn(),ee=requireHasOwnProperty(),ne=requireToString$1(),te=requireShared(),ue=requireSymbolRegistryDetection(),se=te("string-to-symbol-registry"),ie=te("symbol-to-string-registry");return Y({target:"Symbol",stat:!0,forced:!ue},{for:function(t){var H=ne(t);if(ee(se,H))return se[H];var ae=X("Symbol")(H);return se[H]=ae,ie[ae]=H,ae}}),es_symbol_for}var es_symbol_keyFor={},hasRequiredEs_symbol_keyFor;function requireEs_symbol_keyFor(){if(hasRequiredEs_symbol_keyFor)return es_symbol_keyFor;hasRequiredEs_symbol_keyFor=1;var Y=require_export(),X=requireHasOwnProperty(),ee=requireIsSymbol$1(),ne=requireTryToString(),te=requireShared(),ue=requireSymbolRegistryDetection(),se=te("symbol-to-string-registry");return Y({target:"Symbol",stat:!0,forced:!ue},{keyFor:function(t){if(!ee(t))throw new TypeError(ne(t)+" is not a symbol");if(X(se,t))return se[t]}}),es_symbol_keyFor}var es_json_stringify={},functionApply,hasRequiredFunctionApply;function requireFunctionApply(){if(hasRequiredFunctionApply)return functionApply;hasRequiredFunctionApply=1;var Y=requireFunctionBindNative(),X=Function.prototype,ee=X.apply,ne=X.call;return functionApply=typeof Reflect=="object"&&Reflect.apply||(Y?ne.bind(ee):function(){return ne.apply(ee,arguments)}),functionApply}var getJsonReplacerFunction,hasRequiredGetJsonReplacerFunction;function requireGetJsonReplacerFunction(){if(hasRequiredGetJsonReplacerFunction)return getJsonReplacerFunction;hasRequiredGetJsonReplacerFunction=1;var Y=requireFunctionUncurryThis(),X=requireIsArray$1(),ee=requireIsCallable(),ne=requireClassofRaw(),te=requireToString$1(),ue=Y([].push);return getJsonReplacerFunction=function(se){if(ee(se))return se;if(X(se)){for(var ie=se.length,t=[],H=0;H<ie;H++){var ae=se[H];typeof ae=="string"?ue(t,ae):(typeof ae=="number"||ne(ae)==="Number"||ne(ae)==="String")&&ue(t,te(ae))}var he=t.length,_e=!0;return function(ge,xe){if(_e)return _e=!1,xe;if(X(this))return xe;for(var Re=0;Re<he;Re++)if(t[Re]===ge)return xe}}},getJsonReplacerFunction}var hasRequiredEs_json_stringify;function requireEs_json_stringify(){if(hasRequiredEs_json_stringify)return es_json_stringify;hasRequiredEs_json_stringify=1;var Y=require_export(),X=requireGetBuiltIn(),ee=requireFunctionApply(),ne=requireFunctionCall(),te=requireFunctionUncurryThis(),ue=requireFails(),se=requireIsCallable(),ie=requireIsSymbol$1(),t=requireArraySlice(),H=requireGetJsonReplacerFunction(),ae=requireSymbolConstructorDetection(),he=String,_e=X("JSON","stringify"),ge=te(/./.exec),xe=te("".charAt),Re=te("".charCodeAt),De=te("".replace),Ie=te(1.1.toString),Ce=/[\uD800-\uDFFF]/g,Ue=/^[\uD800-\uDBFF]$/,Le=/^[\uDC00-\uDFFF]$/,ke=!ae||ue(function(){var et=X("Symbol")("stringify detection");return _e([et])!=="[null]"||_e({a:et})!=="{}"||_e(Object(et))!=="{}"}),Ge=ue(function(){return _e("\uDF06\uD834")!=='"\\udf06\\ud834"'||_e("\uDEAD")!=='"\\udead"'}),Ze=function(et,He){var ht=t(arguments),_t=H(He);if(!(!se(_t)&&(et===void 0||ie(et))))return ht[1]=function(ut,yt){if(se(_t)&&(yt=ne(_t,this,he(ut),yt)),!ie(yt))return yt},ee(_e,null,ht)},We=function(et,He,ht){var _t=xe(ht,He-1),ut=xe(ht,He+1);return ge(Ue,et)&&!ge(Le,ut)||ge(Le,et)&&!ge(Ue,_t)?"\\u"+Ie(Re(et,0),16):et};return _e&&Y({target:"JSON",stat:!0,arity:3,forced:ke||Ge},{stringify:function(He,ht,_t){var ut=t(arguments),yt=ee(ke?Ze:_e,null,ut);return Ge&&typeof yt=="string"?De(yt,Ce,We):yt}}),es_json_stringify}var es_object_getOwnPropertySymbols={},hasRequiredEs_object_getOwnPropertySymbols;function requireEs_object_getOwnPropertySymbols(){if(hasRequiredEs_object_getOwnPropertySymbols)return es_object_getOwnPropertySymbols;hasRequiredEs_object_getOwnPropertySymbols=1;var Y=require_export(),X=requireSymbolConstructorDetection(),ee=requireFails(),ne=requireObjectGetOwnPropertySymbols(),te=requireToObject(),ue=!X||ee(function(){ne.f(1)});return Y({target:"Object",stat:!0,forced:ue},{getOwnPropertySymbols:function(ie){var t=ne.f;return t?t(te(ie)):[]}}),es_object_getOwnPropertySymbols}var hasRequiredEs_symbol;function requireEs_symbol(){return hasRequiredEs_symbol||(hasRequiredEs_symbol=1,requireEs_symbol_constructor(),requireEs_symbol_for(),requireEs_symbol_keyFor(),requireEs_json_stringify(),requireEs_object_getOwnPropertySymbols()),es_symbol}var es_symbol_description={},hasRequiredEs_symbol_description;function requireEs_symbol_description(){if(hasRequiredEs_symbol_description)return es_symbol_description;hasRequiredEs_symbol_description=1;var Y=require_export(),X=requireDescriptors(),ee=requireGlobalThis(),ne=requireFunctionUncurryThis(),te=requireHasOwnProperty(),ue=requireIsCallable(),se=requireObjectIsPrototypeOf(),ie=requireToString$1(),t=requireDefineBuiltInAccessor(),H=requireCopyConstructorProperties(),ae=ee.Symbol,he=ae&&ae.prototype;if(X&&ue(ae)&&(!("description"in he)||ae().description!==void 0)){var _e={},ge=function(){var ke=arguments.length<1||arguments[0]===void 0?void 0:ie(arguments[0]),Ge=se(he,this)?new ae(ke):ke===void 0?ae():ae(ke);return ke===""&&(_e[Ge]=!0),Ge};H(ge,ae),ge.prototype=he,he.constructor=ge;var xe=String(ae("description detection"))==="Symbol(description detection)",Re=ne(he.valueOf),De=ne(he.toString),Ie=/^Symbol\((.*)\)[^)]+$/,Ce=ne("".replace),Ue=ne("".slice);t(he,"description",{configurable:!0,get:function(){var ke=Re(this);if(te(_e,ke))return"";var Ge=De(ke),Ze=xe?Ue(Ge,7,-1):Ce(Ge,Ie,"$1");return Ze===""?void 0:Ze}}),Y({global:!0,constructor:!0,forced:!0},{Symbol:ge})}return es_symbol_description}var es_symbol_asyncDispose={},hasRequiredEs_symbol_asyncDispose;function requireEs_symbol_asyncDispose(){if(hasRequiredEs_symbol_asyncDispose)return es_symbol_asyncDispose;hasRequiredEs_symbol_asyncDispose=1;var Y=requireGlobalThis(),X=requireWellKnownSymbolDefine(),ee=requireObjectDefineProperty().f,ne=requireObjectGetOwnPropertyDescriptor().f,te=Y.Symbol;if(X("asyncDispose"),te){var ue=ne(te,"asyncDispose");ue.enumerable&&ue.configurable&&ue.writable&&ee(te,"asyncDispose",{value:ue.value,enumerable:!1,configurable:!1,writable:!1})}return es_symbol_asyncDispose}var es_symbol_asyncIterator={},hasRequiredEs_symbol_asyncIterator;function requireEs_symbol_asyncIterator(){if(hasRequiredEs_symbol_asyncIterator)return es_symbol_asyncIterator;hasRequiredEs_symbol_asyncIterator=1;var Y=requireWellKnownSymbolDefine();return Y("asyncIterator"),es_symbol_asyncIterator}var es_symbol_dispose={},hasRequiredEs_symbol_dispose;function requireEs_symbol_dispose(){if(hasRequiredEs_symbol_dispose)return es_symbol_dispose;hasRequiredEs_symbol_dispose=1;var Y=requireGlobalThis(),X=requireWellKnownSymbolDefine(),ee=requireObjectDefineProperty().f,ne=requireObjectGetOwnPropertyDescriptor().f,te=Y.Symbol;if(X("dispose"),te){var ue=ne(te,"dispose");ue.enumerable&&ue.configurable&&ue.writable&&ee(te,"dispose",{value:ue.value,enumerable:!1,configurable:!1,writable:!1})}return es_symbol_dispose}var es_symbol_hasInstance={},hasRequiredEs_symbol_hasInstance;function requireEs_symbol_hasInstance(){if(hasRequiredEs_symbol_hasInstance)return es_symbol_hasInstance;hasRequiredEs_symbol_hasInstance=1;var Y=requireWellKnownSymbolDefine();return Y("hasInstance"),es_symbol_hasInstance}var es_symbol_isConcatSpreadable={},hasRequiredEs_symbol_isConcatSpreadable;function requireEs_symbol_isConcatSpreadable(){if(hasRequiredEs_symbol_isConcatSpreadable)return es_symbol_isConcatSpreadable;hasRequiredEs_symbol_isConcatSpreadable=1;var Y=requireWellKnownSymbolDefine();return Y("isConcatSpreadable"),es_symbol_isConcatSpreadable}var es_symbol_iterator={},hasRequiredEs_symbol_iterator;function requireEs_symbol_iterator(){if(hasRequiredEs_symbol_iterator)return es_symbol_iterator;hasRequiredEs_symbol_iterator=1;var Y=requireWellKnownSymbolDefine();return Y("iterator"),es_symbol_iterator}var es_symbol_match={},hasRequiredEs_symbol_match;function requireEs_symbol_match(){if(hasRequiredEs_symbol_match)return es_symbol_match;hasRequiredEs_symbol_match=1;var Y=requireWellKnownSymbolDefine();return Y("match"),es_symbol_match}var es_symbol_matchAll={},hasRequiredEs_symbol_matchAll;function requireEs_symbol_matchAll(){if(hasRequiredEs_symbol_matchAll)return es_symbol_matchAll;hasRequiredEs_symbol_matchAll=1;var Y=requireWellKnownSymbolDefine();return Y("matchAll"),es_symbol_matchAll}var es_symbol_replace={},hasRequiredEs_symbol_replace;function requireEs_symbol_replace(){if(hasRequiredEs_symbol_replace)return es_symbol_replace;hasRequiredEs_symbol_replace=1;var Y=requireWellKnownSymbolDefine();return Y("replace"),es_symbol_replace}var es_symbol_search={},hasRequiredEs_symbol_search;function requireEs_symbol_search(){if(hasRequiredEs_symbol_search)return es_symbol_search;hasRequiredEs_symbol_search=1;var Y=requireWellKnownSymbolDefine();return Y("search"),es_symbol_search}var es_symbol_species={},hasRequiredEs_symbol_species;function requireEs_symbol_species(){if(hasRequiredEs_symbol_species)return es_symbol_species;hasRequiredEs_symbol_species=1;var Y=requireWellKnownSymbolDefine();return Y("species"),es_symbol_species}var es_symbol_split={},hasRequiredEs_symbol_split;function requireEs_symbol_split(){if(hasRequiredEs_symbol_split)return es_symbol_split;hasRequiredEs_symbol_split=1;var Y=requireWellKnownSymbolDefine();return Y("split"),es_symbol_split}var es_symbol_toPrimitive={},hasRequiredEs_symbol_toPrimitive;function requireEs_symbol_toPrimitive(){if(hasRequiredEs_symbol_toPrimitive)return es_symbol_toPrimitive;hasRequiredEs_symbol_toPrimitive=1;var Y=requireWellKnownSymbolDefine(),X=requireSymbolDefineToPrimitive();return Y("toPrimitive"),X(),es_symbol_toPrimitive}var es_symbol_toStringTag={},hasRequiredEs_symbol_toStringTag;function requireEs_symbol_toStringTag(){if(hasRequiredEs_symbol_toStringTag)return es_symbol_toStringTag;hasRequiredEs_symbol_toStringTag=1;var Y=requireGetBuiltIn(),X=requireWellKnownSymbolDefine(),ee=requireSetToStringTag();return X("toStringTag"),ee(Y("Symbol"),"Symbol"),es_symbol_toStringTag}var es_symbol_unscopables={},hasRequiredEs_symbol_unscopables;function requireEs_symbol_unscopables(){if(hasRequiredEs_symbol_unscopables)return es_symbol_unscopables;hasRequiredEs_symbol_unscopables=1;var Y=requireWellKnownSymbolDefine();return Y("unscopables"),es_symbol_unscopables}var es_error_cause={},functionUncurryThisAccessor,hasRequiredFunctionUncurryThisAccessor;function requireFunctionUncurryThisAccessor(){if(hasRequiredFunctionUncurryThisAccessor)return functionUncurryThisAccessor;hasRequiredFunctionUncurryThisAccessor=1;var Y=requireFunctionUncurryThis(),X=requireACallable();return functionUncurryThisAccessor=function(ee,ne,te){try{return Y(X(Object.getOwnPropertyDescriptor(ee,ne)[te]))}catch{}},functionUncurryThisAccessor}var isPossiblePrototype,hasRequiredIsPossiblePrototype;function requireIsPossiblePrototype(){if(hasRequiredIsPossiblePrototype)return isPossiblePrototype;hasRequiredIsPossiblePrototype=1;var Y=requireIsObject$1();return isPossiblePrototype=function(X){return Y(X)||X===null},isPossiblePrototype}var aPossiblePrototype,hasRequiredAPossiblePrototype;function requireAPossiblePrototype(){if(hasRequiredAPossiblePrototype)return aPossiblePrototype;hasRequiredAPossiblePrototype=1;var Y=requireIsPossiblePrototype(),X=String,ee=TypeError;return aPossiblePrototype=function(ne){if(Y(ne))return ne;throw new ee("Can't set "+X(ne)+" as a prototype")},aPossiblePrototype}var objectSetPrototypeOf,hasRequiredObjectSetPrototypeOf;function requireObjectSetPrototypeOf(){if(hasRequiredObjectSetPrototypeOf)return objectSetPrototypeOf;hasRequiredObjectSetPrototypeOf=1;var Y=requireFunctionUncurryThisAccessor(),X=requireIsObject$1(),ee=requireRequireObjectCoercible(),ne=requireAPossiblePrototype();return objectSetPrototypeOf=Object.setPrototypeOf||("__proto__"in{}?function(){var te=!1,ue={},se;try{se=Y(Object.prototype,"__proto__","set"),se(ue,[]),te=ue instanceof Array}catch{}return function(t,H){return ee(t),ne(H),X(t)&&(te?se(t,H):t.__proto__=H),t}}():void 0),objectSetPrototypeOf}var proxyAccessor,hasRequiredProxyAccessor;function requireProxyAccessor(){if(hasRequiredProxyAccessor)return proxyAccessor;hasRequiredProxyAccessor=1;var Y=requireObjectDefineProperty().f;return proxyAccessor=function(X,ee,ne){ne in X||Y(X,ne,{configurable:!0,get:function(){return ee[ne]},set:function(te){ee[ne]=te}})},proxyAccessor}var inheritIfRequired,hasRequiredInheritIfRequired;function requireInheritIfRequired(){if(hasRequiredInheritIfRequired)return inheritIfRequired;hasRequiredInheritIfRequired=1;var Y=requireIsCallable(),X=requireIsObject$1(),ee=requireObjectSetPrototypeOf();return inheritIfRequired=function(ne,te,ue){var se,ie;return ee&&Y(se=te.constructor)&&se!==ue&&X(ie=se.prototype)&&ie!==ue.prototype&&ee(ne,ie),ne},inheritIfRequired}var normalizeStringArgument,hasRequiredNormalizeStringArgument;function requireNormalizeStringArgument(){if(hasRequiredNormalizeStringArgument)return normalizeStringArgument;hasRequiredNormalizeStringArgument=1;var Y=requireToString$1();return normalizeStringArgument=function(X,ee){return X===void 0?arguments.length<2?"":ee:Y(X)},normalizeStringArgument}var installErrorCause,hasRequiredInstallErrorCause;function requireInstallErrorCause(){if(hasRequiredInstallErrorCause)return installErrorCause;hasRequiredInstallErrorCause=1;var Y=requireIsObject$1(),X=requireCreateNonEnumerableProperty();return installErrorCause=function(ee,ne){Y(ne)&&"cause"in ne&&X(ee,"cause",ne.cause)},installErrorCause}var errorStackClear,hasRequiredErrorStackClear;function requireErrorStackClear(){if(hasRequiredErrorStackClear)return errorStackClear;hasRequiredErrorStackClear=1;var Y=requireFunctionUncurryThis(),X=Error,ee=Y("".replace),ne=function(se){return String(new X(se).stack)}("zxcasd"),te=/\n\s*at [^:]*:[^\n]*/,ue=te.test(ne);return errorStackClear=function(se,ie){if(ue&&typeof se=="string"&&!X.prepareStackTrace)for(;ie--;)se=ee(se,te,"");return se},errorStackClear}var errorStackInstallable,hasRequiredErrorStackInstallable;function requireErrorStackInstallable(){if(hasRequiredErrorStackInstallable)return errorStackInstallable;hasRequiredErrorStackInstallable=1;var Y=requireFails(),X=requireCreatePropertyDescriptor();return errorStackInstallable=!Y(function(){var ee=new Error("a");return"stack"in ee?(Object.defineProperty(ee,"stack",X(1,7)),ee.stack!==7):!0}),errorStackInstallable}var errorStackInstall,hasRequiredErrorStackInstall;function requireErrorStackInstall(){if(hasRequiredErrorStackInstall)return errorStackInstall;hasRequiredErrorStackInstall=1;var Y=requireCreateNonEnumerableProperty(),X=requireErrorStackClear(),ee=requireErrorStackInstallable(),ne=Error.captureStackTrace;return errorStackInstall=function(te,ue,se,ie){ee&&(ne?ne(te,ue):Y(te,"stack",X(se,ie)))},errorStackInstall}var wrapErrorConstructorWithCause,hasRequiredWrapErrorConstructorWithCause;function requireWrapErrorConstructorWithCause(){if(hasRequiredWrapErrorConstructorWithCause)return wrapErrorConstructorWithCause;hasRequiredWrapErrorConstructorWithCause=1;var Y=requireGetBuiltIn(),X=requireHasOwnProperty(),ee=requireCreateNonEnumerableProperty(),ne=requireObjectIsPrototypeOf(),te=requireObjectSetPrototypeOf(),ue=requireCopyConstructorProperties(),se=requireProxyAccessor(),ie=requireInheritIfRequired(),t=requireNormalizeStringArgument(),H=requireInstallErrorCause(),ae=requireErrorStackInstall(),he=requireDescriptors(),_e=requireIsPure();return wrapErrorConstructorWithCause=function(ge,xe,Re,De){var Ie="stackTraceLimit",Ce=De?2:1,Ue=ge.split("."),Le=Ue[Ue.length-1],ke=Y.apply(null,Ue);if(ke){var Ge=ke.prototype;if(!_e&&X(Ge,"cause")&&delete Ge.cause,!Re)return ke;var Ze=Y("Error"),We=xe(function(et,He){var ht=t(De?He:et,void 0),_t=De?new ke(et):new ke;return ht!==void 0&&ee(_t,"message",ht),ae(_t,We,_t.stack,2),this&&ne(Ge,this)&&ie(_t,this,We),arguments.length>Ce&&H(_t,arguments[Ce]),_t});if(We.prototype=Ge,Le!=="Error"?te?te(We,Ze):ue(We,Ze,{name:!0}):he&&Ie in ke&&(se(We,ke,Ie),se(We,ke,"prepareStackTrace")),ue(We,ke),!_e)try{Ge.name!==Le&&ee(Ge,"name",Le),Ge.constructor=We}catch{}return We}},wrapErrorConstructorWithCause}var hasRequiredEs_error_cause;function requireEs_error_cause(){if(hasRequiredEs_error_cause)return es_error_cause;hasRequiredEs_error_cause=1;var Y=require_export(),X=requireGlobalThis(),ee=requireFunctionApply(),ne=requireWrapErrorConstructorWithCause(),te="WebAssembly",ue=X[te],se=new Error("e",{cause:7}).cause!==7,ie=function(H,ae){var he={};he[H]=ne(H,ae,se),Y({global:!0,constructor:!0,arity:1,forced:se},he)},t=function(H,ae){if(ue&&ue[H]){var he={};he[H]=ne(te+"."+H,ae,se),Y({target:te,stat:!0,constructor:!0,arity:1,forced:se},he)}};return ie("Error",function(H){return function(he){return ee(H,this,arguments)}}),ie("EvalError",function(H){return function(he){return ee(H,this,arguments)}}),ie("RangeError",function(H){return function(he){return ee(H,this,arguments)}}),ie("ReferenceError",function(H){return function(he){return ee(H,this,arguments)}}),ie("SyntaxError",function(H){return function(he){return ee(H,this,arguments)}}),ie("TypeError",function(H){return function(he){return ee(H,this,arguments)}}),ie("URIError",function(H){return function(he){return ee(H,this,arguments)}}),t("CompileError",function(H){return function(he){return ee(H,this,arguments)}}),t("LinkError",function(H){return function(he){return ee(H,this,arguments)}}),t("RuntimeError",function(H){return function(he){return ee(H,this,arguments)}}),es_error_cause}var es_error_isError={},hasRequiredEs_error_isError;function requireEs_error_isError(){if(hasRequiredEs_error_isError)return es_error_isError;hasRequiredEs_error_isError=1;var Y=require_export(),X=requireGetBuiltIn(),ee=requireIsObject$1(),ne=requireClassof(),te=requireFails(),ue="Error",se="DOMException",ie=Object.setPrototypeOf||{}.__proto__,t=X(se),H=Error,ae=H.isError,he=!ae||!ie||te(function(){return t&&!ae(new t(se))||!ae(new H(ue,{cause:function(){}}))||ae(X("Object","create")(H.prototype))});return Y({target:"Error",stat:!0,sham:!0,forced:he},{isError:function(ge){if(!ee(ge))return!1;var xe=ne(ge);return xe===ue||xe===se}}),es_error_isError}var es_error_toString={},errorToString,hasRequiredErrorToString;function requireErrorToString(){if(hasRequiredErrorToString)return errorToString;hasRequiredErrorToString=1;var Y=requireDescriptors(),X=requireFails(),ee=requireAnObject(),ne=requireNormalizeStringArgument(),te=Error.prototype.toString,ue=X(function(){if(Y){var se=Object.create(Object.defineProperty({},"name",{get:function(){return this===se}}));if(te.call(se)!=="true")return!0}return te.call({message:1,name:2})!=="2: 1"||te.call({})!=="Error"});return errorToString=ue?function(){var ie=ee(this),t=ne(ie.name,"Error"),H=ne(ie.message);return t?H?t+": "+H:t:H}:te,errorToString}var hasRequiredEs_error_toString;function requireEs_error_toString(){if(hasRequiredEs_error_toString)return es_error_toString;hasRequiredEs_error_toString=1;var Y=requireDefineBuiltIn(),X=requireErrorToString(),ee=Error.prototype;return ee.toString!==X&&Y(ee,"toString",X),es_error_toString}var es_aggregateError={},es_aggregateError_constructor={},correctPrototypeGetter,hasRequiredCorrectPrototypeGetter;function requireCorrectPrototypeGetter(){if(hasRequiredCorrectPrototypeGetter)return correctPrototypeGetter;hasRequiredCorrectPrototypeGetter=1;var Y=requireFails();return correctPrototypeGetter=!Y(function(){function X(){}return X.prototype.constructor=null,Object.getPrototypeOf(new X)!==X.prototype}),correctPrototypeGetter}var objectGetPrototypeOf,hasRequiredObjectGetPrototypeOf;function requireObjectGetPrototypeOf(){if(hasRequiredObjectGetPrototypeOf)return objectGetPrototypeOf;hasRequiredObjectGetPrototypeOf=1;var Y=requireHasOwnProperty(),X=requireIsCallable(),ee=requireToObject(),ne=requireSharedKey(),te=requireCorrectPrototypeGetter(),ue=ne("IE_PROTO"),se=Object,ie=se.prototype;return objectGetPrototypeOf=te?se.getPrototypeOf:function(t){var H=ee(t);if(Y(H,ue))return H[ue];var ae=H.constructor;return X(ae)&&H instanceof ae?ae.prototype:H instanceof se?ie:null},objectGetPrototypeOf}var iterators,hasRequiredIterators;function requireIterators(){return hasRequiredIterators||(hasRequiredIterators=1,iterators={}),iterators}var isArrayIteratorMethod,hasRequiredIsArrayIteratorMethod;function requireIsArrayIteratorMethod(){if(hasRequiredIsArrayIteratorMethod)return isArrayIteratorMethod;hasRequiredIsArrayIteratorMethod=1;var Y=requireWellKnownSymbol(),X=requireIterators(),ee=Y("iterator"),ne=Array.prototype;return isArrayIteratorMethod=function(te){return te!==void 0&&(X.Array===te||ne[ee]===te)},isArrayIteratorMethod}var getIteratorMethod,hasRequiredGetIteratorMethod;function requireGetIteratorMethod(){if(hasRequiredGetIteratorMethod)return getIteratorMethod;hasRequiredGetIteratorMethod=1;var Y=requireClassof(),X=requireGetMethod(),ee=requireIsNullOrUndefined(),ne=requireIterators(),te=requireWellKnownSymbol(),ue=te("iterator");return getIteratorMethod=function(se){if(!ee(se))return X(se,ue)||X(se,"@@iterator")||ne[Y(se)]},getIteratorMethod}var getIterator,hasRequiredGetIterator;function requireGetIterator(){if(hasRequiredGetIterator)return getIterator;hasRequiredGetIterator=1;var Y=requireFunctionCall(),X=requireACallable(),ee=requireAnObject(),ne=requireTryToString(),te=requireGetIteratorMethod(),ue=TypeError;return getIterator=function(se,ie){var t=arguments.length<2?te(se):ie;if(X(t))return ee(Y(t,se));throw new ue(ne(se)+" is not iterable")},getIterator}var iteratorClose,hasRequiredIteratorClose;function requireIteratorClose(){if(hasRequiredIteratorClose)return iteratorClose;hasRequiredIteratorClose=1;var Y=requireFunctionCall(),X=requireAnObject(),ee=requireGetMethod();return iteratorClose=function(ne,te,ue){var se,ie;X(ne);try{if(se=ee(ne,"return"),!se){if(te==="throw")throw ue;return ue}se=Y(se,ne)}catch(t){ie=!0,se=t}if(te==="throw")throw ue;if(ie)throw se;return X(se),ue},iteratorClose}var iterate,hasRequiredIterate;function requireIterate(){if(hasRequiredIterate)return iterate;hasRequiredIterate=1;var Y=requireFunctionBindContext(),X=requireFunctionCall(),ee=requireAnObject(),ne=requireTryToString(),te=requireIsArrayIteratorMethod(),ue=requireLengthOfArrayLike(),se=requireObjectIsPrototypeOf(),ie=requireGetIterator(),t=requireGetIteratorMethod(),H=requireIteratorClose(),ae=TypeError,he=function(ge,xe){this.stopped=ge,this.result=xe},_e=he.prototype;return iterate=function(ge,xe,Re){var De=Re&&Re.that,Ie=!!(Re&&Re.AS_ENTRIES),Ce=!!(Re&&Re.IS_RECORD),Ue=!!(Re&&Re.IS_ITERATOR),Le=!!(Re&&Re.INTERRUPTED),ke=Y(xe,De),Ge,Ze,We,et,He,ht,_t,ut=function(Lt){return Ge&&H(Ge,"normal"),new he(!0,Lt)},yt=function(Lt){return Ie?(ee(Lt),Le?ke(Lt[0],Lt[1],ut):ke(Lt[0],Lt[1])):Le?ke(Lt,ut):ke(Lt)};if(Ce)Ge=ge.iterator;else if(Ue)Ge=ge;else{if(Ze=t(ge),!Ze)throw new ae(ne(ge)+" is not iterable");if(te(Ze)){for(We=0,et=ue(ge);et>We;We++)if(He=yt(ge[We]),He&&se(_e,He))return He;return new he(!1)}Ge=ie(ge,Ze)}for(ht=Ce?ge.next:Ge.next;!(_t=X(ht,Ge)).done;){try{He=yt(_t.value)}catch(Lt){H(Ge,"throw",Lt)}if(typeof He=="object"&&He&&se(_e,He))return He}return new he(!1)},iterate}var hasRequiredEs_aggregateError_constructor;function requireEs_aggregateError_constructor(){if(hasRequiredEs_aggregateError_constructor)return es_aggregateError_constructor;hasRequiredEs_aggregateError_constructor=1;var Y=require_export(),X=requireObjectIsPrototypeOf(),ee=requireObjectGetPrototypeOf(),ne=requireObjectSetPrototypeOf(),te=requireCopyConstructorProperties(),ue=requireObjectCreate(),se=requireCreateNonEnumerableProperty(),ie=requireCreatePropertyDescriptor(),t=requireInstallErrorCause(),H=requireErrorStackInstall(),ae=requireIterate(),he=requireNormalizeStringArgument(),_e=requireWellKnownSymbol(),ge=_e("toStringTag"),xe=Error,Re=[].push,De=function(Ue,Le){var ke=X(Ie,this),Ge;ne?Ge=ne(new xe,ke?ee(this):Ie):(Ge=ke?this:ue(Ie),se(Ge,ge,"Error")),Le!==void 0&&se(Ge,"message",he(Le)),H(Ge,De,Ge.stack,1),arguments.length>2&&t(Ge,arguments[2]);var Ze=[];return ae(Ue,Re,{that:Ze}),se(Ge,"errors",Ze),Ge};ne?ne(De,xe):te(De,xe,{name:!0});var Ie=De.prototype=ue(xe.prototype,{constructor:ie(1,De),message:ie(1,""),name:ie(1,"AggregateError")});return Y({global:!0,constructor:!0,arity:2},{AggregateError:De}),es_aggregateError_constructor}var hasRequiredEs_aggregateError;function requireEs_aggregateError(){return hasRequiredEs_aggregateError||(hasRequiredEs_aggregateError=1,requireEs_aggregateError_constructor()),es_aggregateError}var es_aggregateError_cause={},hasRequiredEs_aggregateError_cause;function requireEs_aggregateError_cause(){if(hasRequiredEs_aggregateError_cause)return es_aggregateError_cause;hasRequiredEs_aggregateError_cause=1;var Y=require_export(),X=requireGetBuiltIn(),ee=requireFunctionApply(),ne=requireFails(),te=requireWrapErrorConstructorWithCause(),ue="AggregateError",se=X(ue),ie=!ne(function(){return se([1]).errors[0]!==1})&&ne(function(){return se([1],ue,{cause:7}).cause!==7});return Y({global:!0,constructor:!0,arity:2,forced:ie},{AggregateError:te(ue,function(t){return function(ae,he){return ee(t,this,arguments)}},ie,!0)}),es_aggregateError_cause}var es_suppressedError_constructor={},hasRequiredEs_suppressedError_constructor;function requireEs_suppressedError_constructor(){if(hasRequiredEs_suppressedError_constructor)return es_suppressedError_constructor;hasRequiredEs_suppressedError_constructor=1;var Y=require_export(),X=requireGlobalThis(),ee=requireObjectIsPrototypeOf(),ne=requireObjectGetPrototypeOf(),te=requireObjectSetPrototypeOf(),ue=requireCopyConstructorProperties(),se=requireObjectCreate(),ie=requireCreateNonEnumerableProperty(),t=requireCreatePropertyDescriptor(),H=requireErrorStackInstall(),ae=requireNormalizeStringArgument(),he=requireWellKnownSymbol(),_e=requireFails(),ge=requireIsPure(),xe=X.SuppressedError,Re=he("toStringTag"),De=Error,Ie=!!xe&&xe.length!==3,Ce=!!xe&&_e(function(){return new xe(1,2,3,{cause:4}).cause===4}),Ue=Ie||Ce,Le=function(Ze,We,et){var He=ee(ke,this),ht;return te?ht=Ue&&(!He||ne(this)===ke)?new xe:te(new De,He?ne(this):ke):(ht=He?this:se(ke),ie(ht,Re,"Error")),et!==void 0&&ie(ht,"message",ae(et)),H(ht,Le,ht.stack,1),ie(ht,"error",Ze),ie(ht,"suppressed",We),ht};te?te(Le,De):ue(Le,De,{name:!0});var ke=Le.prototype=Ue?xe.prototype:se(De.prototype,{constructor:t(1,Le),message:t(1,""),name:t(1,"SuppressedError")});return Ue&&!ge&&(ke.constructor=Le),Y({global:!0,constructor:!0,arity:3,forced:Ue},{SuppressedError:Le}),es_suppressedError_constructor}var es_array_at={},addToUnscopables,hasRequiredAddToUnscopables;function requireAddToUnscopables(){if(hasRequiredAddToUnscopables)return addToUnscopables;hasRequiredAddToUnscopables=1;var Y=requireWellKnownSymbol(),X=requireObjectCreate(),ee=requireObjectDefineProperty().f,ne=Y("unscopables"),te=Array.prototype;return te[ne]===void 0&&ee(te,ne,{configurable:!0,value:X(null)}),addToUnscopables=function(ue){te[ne][ue]=!0},addToUnscopables}var hasRequiredEs_array_at;function requireEs_array_at(){if(hasRequiredEs_array_at)return es_array_at;hasRequiredEs_array_at=1;var Y=require_export(),X=requireToObject(),ee=requireLengthOfArrayLike(),ne=requireToIntegerOrInfinity(),te=requireAddToUnscopables();return Y({target:"Array",proto:!0},{at:function(se){var ie=X(this),t=ee(ie),H=ne(se),ae=H>=0?H:t+H;return ae<0||ae>=t?void 0:ie[ae]}}),te("at"),es_array_at}var es_array_concat={},doesNotExceedSafeInteger,hasRequiredDoesNotExceedSafeInteger;function requireDoesNotExceedSafeInteger(){if(hasRequiredDoesNotExceedSafeInteger)return doesNotExceedSafeInteger;hasRequiredDoesNotExceedSafeInteger=1;var Y=TypeError,X=9007199254740991;return doesNotExceedSafeInteger=function(ee){if(ee>X)throw Y("Maximum allowed index exceeded");return ee},doesNotExceedSafeInteger}var createProperty,hasRequiredCreateProperty;function requireCreateProperty(){if(hasRequiredCreateProperty)return createProperty;hasRequiredCreateProperty=1;var Y=requireDescriptors(),X=requireObjectDefineProperty(),ee=requireCreatePropertyDescriptor();return createProperty=function(ne,te,ue){Y?X.f(ne,te,ee(0,ue)):ne[te]=ue},createProperty}var arrayMethodHasSpeciesSupport,hasRequiredArrayMethodHasSpeciesSupport;function requireArrayMethodHasSpeciesSupport(){if(hasRequiredArrayMethodHasSpeciesSupport)return arrayMethodHasSpeciesSupport;hasRequiredArrayMethodHasSpeciesSupport=1;var Y=requireFails(),X=requireWellKnownSymbol(),ee=requireEnvironmentV8Version(),ne=X("species");return arrayMethodHasSpeciesSupport=function(te){return ee>=51||!Y(function(){var ue=[],se=ue.constructor={};return se[ne]=function(){return{foo:1}},ue[te](Boolean).foo!==1})},arrayMethodHasSpeciesSupport}var hasRequiredEs_array_concat;function requireEs_array_concat(){if(hasRequiredEs_array_concat)return es_array_concat;hasRequiredEs_array_concat=1;var Y=require_export(),X=requireFails(),ee=requireIsArray$1(),ne=requireIsObject$1(),te=requireToObject(),ue=requireLengthOfArrayLike(),se=requireDoesNotExceedSafeInteger(),ie=requireCreateProperty(),t=requireArraySpeciesCreate(),H=requireArrayMethodHasSpeciesSupport(),ae=requireWellKnownSymbol(),he=requireEnvironmentV8Version(),_e=ae("isConcatSpreadable"),ge=he>=51||!X(function(){var De=[];return De[_e]=!1,De.concat()[0]!==De}),xe=function(De){if(!ne(De))return!1;var Ie=De[_e];return Ie!==void 0?!!Ie:ee(De)},Re=!ge||!H("concat");return Y({target:"Array",proto:!0,arity:1,forced:Re},{concat:function(Ie){var Ce=te(this),Ue=t(Ce,0),Le=0,ke,Ge,Ze,We,et;for(ke=-1,Ze=arguments.length;ke<Ze;ke++)if(et=ke===-1?Ce:arguments[ke],xe(et))for(We=ue(et),se(Le+We),Ge=0;Ge<We;Ge++,Le++)Ge in et&&ie(Ue,Le,et[Ge]);else se(Le+1),ie(Ue,Le++,et);return Ue.length=Le,Ue}}),es_array_concat}var es_array_copyWithin={},deletePropertyOrThrow,hasRequiredDeletePropertyOrThrow;function requireDeletePropertyOrThrow(){if(hasRequiredDeletePropertyOrThrow)return deletePropertyOrThrow;hasRequiredDeletePropertyOrThrow=1;var Y=requireTryToString(),X=TypeError;return deletePropertyOrThrow=function(ee,ne){if(!delete ee[ne])throw new X("Cannot delete property "+Y(ne)+" of "+Y(ee))},deletePropertyOrThrow}var arrayCopyWithin,hasRequiredArrayCopyWithin;function requireArrayCopyWithin(){if(hasRequiredArrayCopyWithin)return arrayCopyWithin;hasRequiredArrayCopyWithin=1;var Y=requireToObject(),X=requireToAbsoluteIndex(),ee=requireLengthOfArrayLike(),ne=requireDeletePropertyOrThrow(),te=Math.min;return arrayCopyWithin=[].copyWithin||function(se,ie){var t=Y(this),H=ee(t),ae=X(se,H),he=X(ie,H),_e=arguments.length>2?arguments[2]:void 0,ge=te((_e===void 0?H:X(_e,H))-he,H-ae),xe=1;for(he<ae&&ae<he+ge&&(xe=-1,he+=ge-1,ae+=ge-1);ge-- >0;)he in t?t[ae]=t[he]:ne(t,ae),ae+=xe,he+=xe;return t},arrayCopyWithin}var hasRequiredEs_array_copyWithin;function requireEs_array_copyWithin(){if(hasRequiredEs_array_copyWithin)return es_array_copyWithin;hasRequiredEs_array_copyWithin=1;var Y=require_export(),X=requireArrayCopyWithin(),ee=requireAddToUnscopables();return Y({target:"Array",proto:!0},{copyWithin:X}),ee("copyWithin"),es_array_copyWithin}var es_array_every={},arrayMethodIsStrict,hasRequiredArrayMethodIsStrict;function requireArrayMethodIsStrict(){if(hasRequiredArrayMethodIsStrict)return arrayMethodIsStrict;hasRequiredArrayMethodIsStrict=1;var Y=requireFails();return arrayMethodIsStrict=function(X,ee){var ne=[][X];return!!ne&&Y(function(){ne.call(null,ee||function(){return 1},1)})},arrayMethodIsStrict}var hasRequiredEs_array_every;function requireEs_array_every(){if(hasRequiredEs_array_every)return es_array_every;hasRequiredEs_array_every=1;var Y=require_export(),X=requireArrayIteration().every,ee=requireArrayMethodIsStrict(),ne=ee("every");return Y({target:"Array",proto:!0,forced:!ne},{every:function(ue){return X(this,ue,arguments.length>1?arguments[1]:void 0)}}),es_array_every}var es_array_fill={},arrayFill,hasRequiredArrayFill;function requireArrayFill(){if(hasRequiredArrayFill)return arrayFill;hasRequiredArrayFill=1;var Y=requireToObject(),X=requireToAbsoluteIndex(),ee=requireLengthOfArrayLike();return arrayFill=function(te){for(var ue=Y(this),se=ee(ue),ie=arguments.length,t=X(ie>1?arguments[1]:void 0,se),H=ie>2?arguments[2]:void 0,ae=H===void 0?se:X(H,se);ae>t;)ue[t++]=te;return ue},arrayFill}var hasRequiredEs_array_fill;function requireEs_array_fill(){if(hasRequiredEs_array_fill)return es_array_fill;hasRequiredEs_array_fill=1;var Y=require_export(),X=requireArrayFill(),ee=requireAddToUnscopables();return Y({target:"Array",proto:!0},{fill:X}),ee("fill"),es_array_fill}var es_array_filter={},hasRequiredEs_array_filter;function requireEs_array_filter(){if(hasRequiredEs_array_filter)return es_array_filter;hasRequiredEs_array_filter=1;var Y=require_export(),X=requireArrayIteration().filter,ee=requireArrayMethodHasSpeciesSupport(),ne=ee("filter");return Y({target:"Array",proto:!0,forced:!ne},{filter:function(ue){return X(this,ue,arguments.length>1?arguments[1]:void 0)}}),es_array_filter}var es_array_find={},hasRequiredEs_array_find;function requireEs_array_find(){if(hasRequiredEs_array_find)return es_array_find;hasRequiredEs_array_find=1;var Y=require_export(),X=requireArrayIteration().find,ee=requireAddToUnscopables(),ne="find",te=!0;return ne in[]&&Array(1)[ne](function(){te=!1}),Y({target:"Array",proto:!0,forced:te},{find:function(se){return X(this,se,arguments.length>1?arguments[1]:void 0)}}),ee(ne),es_array_find}var es_array_findIndex={},hasRequiredEs_array_findIndex;function requireEs_array_findIndex(){if(hasRequiredEs_array_findIndex)return es_array_findIndex;hasRequiredEs_array_findIndex=1;var Y=require_export(),X=requireArrayIteration().findIndex,ee=requireAddToUnscopables(),ne="findIndex",te=!0;return ne in[]&&Array(1)[ne](function(){te=!1}),Y({target:"Array",proto:!0,forced:te},{findIndex:function(se){return X(this,se,arguments.length>1?arguments[1]:void 0)}}),ee(ne),es_array_findIndex}var es_array_findLast={},arrayIterationFromLast,hasRequiredArrayIterationFromLast;function requireArrayIterationFromLast(){if(hasRequiredArrayIterationFromLast)return arrayIterationFromLast;hasRequiredArrayIterationFromLast=1;var Y=requireFunctionBindContext(),X=requireIndexedObject(),ee=requireToObject(),ne=requireLengthOfArrayLike(),te=function(ue){var se=ue===1;return function(ie,t,H){for(var ae=ee(ie),he=X(ae),_e=ne(he),ge=Y(t,H),xe,Re;_e-- >0;)if(xe=he[_e],Re=ge(xe,_e,ae),Re)switch(ue){case 0:return xe;case 1:return _e}return se?-1:void 0}};return arrayIterationFromLast={findLast:te(0),findLastIndex:te(1)},arrayIterationFromLast}var hasRequiredEs_array_findLast;function requireEs_array_findLast(){if(hasRequiredEs_array_findLast)return es_array_findLast;hasRequiredEs_array_findLast=1;var Y=require_export(),X=requireArrayIterationFromLast().findLast,ee=requireAddToUnscopables();return Y({target:"Array",proto:!0},{findLast:function(te){return X(this,te,arguments.length>1?arguments[1]:void 0)}}),ee("findLast"),es_array_findLast}var es_array_findLastIndex={},hasRequiredEs_array_findLastIndex;function requireEs_array_findLastIndex(){if(hasRequiredEs_array_findLastIndex)return es_array_findLastIndex;hasRequiredEs_array_findLastIndex=1;var Y=require_export(),X=requireArrayIterationFromLast().findLastIndex,ee=requireAddToUnscopables();return Y({target:"Array",proto:!0},{findLastIndex:function(te){return X(this,te,arguments.length>1?arguments[1]:void 0)}}),ee("findLastIndex"),es_array_findLastIndex}var es_array_flat={},flattenIntoArray_1,hasRequiredFlattenIntoArray;function requireFlattenIntoArray(){if(hasRequiredFlattenIntoArray)return flattenIntoArray_1;hasRequiredFlattenIntoArray=1;var Y=requireIsArray$1(),X=requireLengthOfArrayLike(),ee=requireDoesNotExceedSafeInteger(),ne=requireFunctionBindContext(),te=function(ue,se,ie,t,H,ae,he,_e){for(var ge=H,xe=0,Re=he?ne(he,_e):!1,De,Ie;xe<t;)xe in ie&&(De=Re?Re(ie[xe],xe,se):ie[xe],ae>0&&Y(De)?(Ie=X(De),ge=te(ue,se,De,Ie,ge,ae-1)-1):(ee(ge+1),ue[ge]=De),ge++),xe++;return ge};return flattenIntoArray_1=te,flattenIntoArray_1}var hasRequiredEs_array_flat;function requireEs_array_flat(){if(hasRequiredEs_array_flat)return es_array_flat;hasRequiredEs_array_flat=1;var Y=require_export(),X=requireFlattenIntoArray(),ee=requireToObject(),ne=requireLengthOfArrayLike(),te=requireToIntegerOrInfinity(),ue=requireArraySpeciesCreate();return Y({target:"Array",proto:!0},{flat:function(){var ie=arguments.length?arguments[0]:void 0,t=ee(this),H=ne(t),ae=ue(t,0);return ae.length=X(ae,t,t,H,0,ie===void 0?1:te(ie)),ae}}),es_array_flat}var es_array_flatMap={},hasRequiredEs_array_flatMap;function requireEs_array_flatMap(){if(hasRequiredEs_array_flatMap)return es_array_flatMap;hasRequiredEs_array_flatMap=1;var Y=require_export(),X=requireFlattenIntoArray(),ee=requireACallable(),ne=requireToObject(),te=requireLengthOfArrayLike(),ue=requireArraySpeciesCreate();return Y({target:"Array",proto:!0},{flatMap:function(ie){var t=ne(this),H=te(t),ae;return ee(ie),ae=ue(t,0),ae.length=X(ae,t,t,H,0,1,ie,arguments.length>1?arguments[1]:void 0),ae}}),es_array_flatMap}var es_array_forEach={},arrayForEach,hasRequiredArrayForEach;function requireArrayForEach(){if(hasRequiredArrayForEach)return arrayForEach;hasRequiredArrayForEach=1;var Y=requireArrayIteration().forEach,X=requireArrayMethodIsStrict(),ee=X("forEach");return arrayForEach=ee?[].forEach:function(te){return Y(this,te,arguments.length>1?arguments[1]:void 0)},arrayForEach}var hasRequiredEs_array_forEach;function requireEs_array_forEach(){if(hasRequiredEs_array_forEach)return es_array_forEach;hasRequiredEs_array_forEach=1;var Y=require_export(),X=requireArrayForEach();return Y({target:"Array",proto:!0,forced:[].forEach!==X},{forEach:X}),es_array_forEach}var es_array_from={},callWithSafeIterationClosing,hasRequiredCallWithSafeIterationClosing;function requireCallWithSafeIterationClosing(){if(hasRequiredCallWithSafeIterationClosing)return callWithSafeIterationClosing;hasRequiredCallWithSafeIterationClosing=1;var Y=requireAnObject(),X=requireIteratorClose();return callWithSafeIterationClosing=function(ee,ne,te,ue){try{return ue?ne(Y(te)[0],te[1]):ne(te)}catch(se){X(ee,"throw",se)}},callWithSafeIterationClosing}var arrayFrom,hasRequiredArrayFrom;function requireArrayFrom(){if(hasRequiredArrayFrom)return arrayFrom;hasRequiredArrayFrom=1;var Y=requireFunctionBindContext(),X=requireFunctionCall(),ee=requireToObject(),ne=requireCallWithSafeIterationClosing(),te=requireIsArrayIteratorMethod(),ue=requireIsConstructor(),se=requireLengthOfArrayLike(),ie=requireCreateProperty(),t=requireGetIterator(),H=requireGetIteratorMethod(),ae=Array;return arrayFrom=function(_e){var ge=ee(_e),xe=ue(this),Re=arguments.length,De=Re>1?arguments[1]:void 0,Ie=De!==void 0;Ie&&(De=Y(De,Re>2?arguments[2]:void 0));var Ce=H(ge),Ue=0,Le,ke,Ge,Ze,We,et;if(Ce&&!(this===ae&&te(Ce)))for(ke=xe?new this:[],Ze=t(ge,Ce),We=Ze.next;!(Ge=X(We,Ze)).done;Ue++)et=Ie?ne(Ze,De,[Ge.value,Ue],!0):Ge.value,ie(ke,Ue,et);else for(Le=se(ge),ke=xe?new this(Le):ae(Le);Le>Ue;Ue++)et=Ie?De(ge[Ue],Ue):ge[Ue],ie(ke,Ue,et);return ke.length=Ue,ke},arrayFrom}var checkCorrectnessOfIteration,hasRequiredCheckCorrectnessOfIteration;function requireCheckCorrectnessOfIteration(){if(hasRequiredCheckCorrectnessOfIteration)return checkCorrectnessOfIteration;hasRequiredCheckCorrectnessOfIteration=1;var Y=requireWellKnownSymbol(),X=Y("iterator"),ee=!1;try{var ne=0,te={next:function(){return{done:!!ne++}},return:function(){ee=!0}};te[X]=function(){return this},Array.from(te,function(){throw 2})}catch{}return checkCorrectnessOfIteration=function(ue,se){try{if(!se&&!ee)return!1}catch{return!1}var ie=!1;try{var t={};t[X]=function(){return{next:function(){return{done:ie=!0}}}},ue(t)}catch{}return ie},checkCorrectnessOfIteration}var hasRequiredEs_array_from;function requireEs_array_from(){if(hasRequiredEs_array_from)return es_array_from;hasRequiredEs_array_from=1;var Y=require_export(),X=requireArrayFrom(),ee=requireCheckCorrectnessOfIteration(),ne=!ee(function(te){Array.from(te)});return Y({target:"Array",stat:!0,forced:ne},{from:X}),es_array_from}var es_array_includes={},hasRequiredEs_array_includes;function requireEs_array_includes(){if(hasRequiredEs_array_includes)return es_array_includes;hasRequiredEs_array_includes=1;var Y=require_export(),X=requireArrayIncludes().includes,ee=requireFails(),ne=requireAddToUnscopables(),te=ee(function(){return!Array(1).includes()});return Y({target:"Array",proto:!0,forced:te},{includes:function(se){return X(this,se,arguments.length>1?arguments[1]:void 0)}}),ne("includes"),es_array_includes}var es_array_indexOf={},hasRequiredEs_array_indexOf;function requireEs_array_indexOf(){if(hasRequiredEs_array_indexOf)return es_array_indexOf;hasRequiredEs_array_indexOf=1;var Y=require_export(),X=requireFunctionUncurryThisClause(),ee=requireArrayIncludes().indexOf,ne=requireArrayMethodIsStrict(),te=X([].indexOf),ue=!!te&&1/te([1],1,-0)<0,se=ue||!ne("indexOf");return Y({target:"Array",proto:!0,forced:se},{indexOf:function(t){var H=arguments.length>1?arguments[1]:void 0;return ue?te(this,t,H)||0:ee(this,t,H)}}),es_array_indexOf}var es_array_isArray={},hasRequiredEs_array_isArray;function requireEs_array_isArray(){if(hasRequiredEs_array_isArray)return es_array_isArray;hasRequiredEs_array_isArray=1;var Y=require_export(),X=requireIsArray$1();return Y({target:"Array",stat:!0},{isArray:X}),es_array_isArray}var iteratorsCore,hasRequiredIteratorsCore;function requireIteratorsCore(){if(hasRequiredIteratorsCore)return iteratorsCore;hasRequiredIteratorsCore=1;var Y=requireFails(),X=requireIsCallable(),ee=requireIsObject$1(),ne=requireObjectCreate(),te=requireObjectGetPrototypeOf(),ue=requireDefineBuiltIn(),se=requireWellKnownSymbol(),ie=requireIsPure(),t=se("iterator"),H=!1,ae,he,_e;[].keys&&(_e=[].keys(),"next"in _e?(he=te(te(_e)),he!==Object.prototype&&(ae=he)):H=!0);var ge=!ee(ae)||Y(function(){var xe={};return ae[t].call(xe)!==xe});return ge?ae={}:ie&&(ae=ne(ae)),X(ae[t])||ue(ae,t,function(){return this}),iteratorsCore={IteratorPrototype:ae,BUGGY_SAFARI_ITERATORS:H},iteratorsCore}var iteratorCreateConstructor,hasRequiredIteratorCreateConstructor;function requireIteratorCreateConstructor(){if(hasRequiredIteratorCreateConstructor)return iteratorCreateConstructor;hasRequiredIteratorCreateConstructor=1;var Y=requireIteratorsCore().IteratorPrototype,X=requireObjectCreate(),ee=requireCreatePropertyDescriptor(),ne=requireSetToStringTag(),te=requireIterators(),ue=function(){return this};return iteratorCreateConstructor=function(se,ie,t,H){var ae=ie+" Iterator";return se.prototype=X(Y,{next:ee(+!H,t)}),ne(se,ae,!1,!0),te[ae]=ue,se},iteratorCreateConstructor}var iteratorDefine,hasRequiredIteratorDefine;function requireIteratorDefine(){if(hasRequiredIteratorDefine)return iteratorDefine;hasRequiredIteratorDefine=1;var Y=require_export(),X=requireFunctionCall(),ee=requireIsPure(),ne=requireFunctionName(),te=requireIsCallable(),ue=requireIteratorCreateConstructor(),se=requireObjectGetPrototypeOf(),ie=requireObjectSetPrototypeOf(),t=requireSetToStringTag(),H=requireCreateNonEnumerableProperty(),ae=requireDefineBuiltIn(),he=requireWellKnownSymbol(),_e=requireIterators(),ge=requireIteratorsCore(),xe=ne.PROPER,Re=ne.CONFIGURABLE,De=ge.IteratorPrototype,Ie=ge.BUGGY_SAFARI_ITERATORS,Ce=he("iterator"),Ue="keys",Le="values",ke="entries",Ge=function(){return this};return iteratorDefine=function(Ze,We,et,He,ht,_t,ut){ue(et,We,He);var yt=function(lr){if(lr===ht&&nt)return nt;if(!Ie&&lr&&lr in ft)return ft[lr];switch(lr){case Ue:return function(){return new et(this,lr)};case Le:return function(){return new et(this,lr)};case ke:return function(){return new et(this,lr)}}return function(){return new et(this)}},Lt=We+" Iterator",Kt=!1,ft=Ze.prototype,qt=ft[Ce]||ft["@@iterator"]||ht&&ft[ht],nt=!Ie&&qt||yt(ht),At=We==="Array"&&ft.entries||qt,wt,Ft,er;if(At&&(wt=se(At.call(new Ze)),wt!==Object.prototype&&wt.next&&(!ee&&se(wt)!==De&&(ie?ie(wt,De):te(wt[Ce])||ae(wt,Ce,Ge)),t(wt,Lt,!0,!0),ee&&(_e[Lt]=Ge))),xe&&ht===Le&&qt&&qt.name!==Le&&(!ee&&Re?H(ft,"name",Le):(Kt=!0,nt=function(){return X(qt,this)})),ht)if(Ft={values:yt(Le),keys:_t?nt:yt(Ue),entries:yt(ke)},ut)for(er in Ft)(Ie||Kt||!(er in ft))&&ae(ft,er,Ft[er]);else Y({target:We,proto:!0,forced:Ie||Kt},Ft);return(!ee||ut)&&ft[Ce]!==nt&&ae(ft,Ce,nt,{name:ht}),_e[We]=nt,Ft},iteratorDefine}var createIterResultObject,hasRequiredCreateIterResultObject;function requireCreateIterResultObject(){return hasRequiredCreateIterResultObject||(hasRequiredCreateIterResultObject=1,createIterResultObject=function(Y,X){return{value:Y,done:X}}),createIterResultObject}var es_array_iterator,hasRequiredEs_array_iterator;function requireEs_array_iterator(){if(hasRequiredEs_array_iterator)return es_array_iterator;hasRequiredEs_array_iterator=1;var Y=requireToIndexedObject(),X=requireAddToUnscopables(),ee=requireIterators(),ne=requireInternalState(),te=requireObjectDefineProperty().f,ue=requireIteratorDefine(),se=requireCreateIterResultObject(),ie=requireIsPure(),t=requireDescriptors(),H="Array Iterator",ae=ne.set,he=ne.getterFor(H);es_array_iterator=ue(Array,"Array",function(ge,xe){ae(this,{type:H,target:Y(ge),index:0,kind:xe})},function(){var ge=he(this),xe=ge.target,Re=ge.index++;if(!xe||Re>=xe.length)return ge.target=null,se(void 0,!0);switch(ge.kind){case"keys":return se(Re,!1);case"values":return se(xe[Re],!1)}return se([Re,xe[Re]],!1)},"values");var _e=ee.Arguments=ee.Array;if(X("keys"),X("values"),X("entries"),!ie&&t&&_e.name!=="values")try{te(_e,"name",{value:"values"})}catch{}return es_array_iterator}var es_array_join={},hasRequiredEs_array_join;function requireEs_array_join(){if(hasRequiredEs_array_join)return es_array_join;hasRequiredEs_array_join=1;var Y=require_export(),X=requireFunctionUncurryThis(),ee=requireIndexedObject(),ne=requireToIndexedObject(),te=requireArrayMethodIsStrict(),ue=X([].join),se=ee!==Object,ie=se||!te("join",",");return Y({target:"Array",proto:!0,forced:ie},{join:function(H){return ue(ne(this),H===void 0?",":H)}}),es_array_join}var es_array_lastIndexOf={},arrayLastIndexOf,hasRequiredArrayLastIndexOf;function requireArrayLastIndexOf(){if(hasRequiredArrayLastIndexOf)return arrayLastIndexOf;hasRequiredArrayLastIndexOf=1;var Y=requireFunctionApply(),X=requireToIndexedObject(),ee=requireToIntegerOrInfinity(),ne=requireLengthOfArrayLike(),te=requireArrayMethodIsStrict(),ue=Math.min,se=[].lastIndexOf,ie=!!se&&1/[1].lastIndexOf(1,-0)<0,t=te("lastIndexOf"),H=ie||!t;return arrayLastIndexOf=H?function(he){if(ie)return Y(se,this,arguments)||0;var _e=X(this),ge=ne(_e);if(ge===0)return-1;var xe=ge-1;for(arguments.length>1&&(xe=ue(xe,ee(arguments[1]))),xe<0&&(xe=ge+xe);xe>=0;xe--)if(xe in _e&&_e[xe]===he)return xe||0;return-1}:se,arrayLastIndexOf}var hasRequiredEs_array_lastIndexOf;function requireEs_array_lastIndexOf(){if(hasRequiredEs_array_lastIndexOf)return es_array_lastIndexOf;hasRequiredEs_array_lastIndexOf=1;var Y=require_export(),X=requireArrayLastIndexOf();return Y({target:"Array",proto:!0,forced:X!==[].lastIndexOf},{lastIndexOf:X}),es_array_lastIndexOf}var es_array_map={},hasRequiredEs_array_map;function requireEs_array_map(){if(hasRequiredEs_array_map)return es_array_map;hasRequiredEs_array_map=1;var Y=require_export(),X=requireArrayIteration().map,ee=requireArrayMethodHasSpeciesSupport(),ne=ee("map");return Y({target:"Array",proto:!0,forced:!ne},{map:function(ue){return X(this,ue,arguments.length>1?arguments[1]:void 0)}}),es_array_map}var es_array_of={},hasRequiredEs_array_of;function requireEs_array_of(){if(hasRequiredEs_array_of)return es_array_of;hasRequiredEs_array_of=1;var Y=require_export(),X=requireFails(),ee=requireIsConstructor(),ne=requireCreateProperty(),te=Array,ue=X(function(){function se(){}return!(te.of.call(se)instanceof se)});return Y({target:"Array",stat:!0,forced:ue},{of:function(){for(var ie=0,t=arguments.length,H=new(ee(this)?this:te)(t);t>ie;)ne(H,ie,arguments[ie++]);return H.length=t,H}}),es_array_of}var es_array_push={},arraySetLength,hasRequiredArraySetLength;function requireArraySetLength(){if(hasRequiredArraySetLength)return arraySetLength;hasRequiredArraySetLength=1;var Y=requireDescriptors(),X=requireIsArray$1(),ee=TypeError,ne=Object.getOwnPropertyDescriptor,te=Y&&!function(){if(this!==void 0)return!0;try{Object.defineProperty([],"length",{writable:!1}).length=1}catch(ue){return ue instanceof TypeError}}();return arraySetLength=te?function(ue,se){if(X(ue)&&!ne(ue,"length").writable)throw new ee("Cannot set read only .length");return ue.length=se}:function(ue,se){return ue.length=se},arraySetLength}var hasRequiredEs_array_push;function requireEs_array_push(){if(hasRequiredEs_array_push)return es_array_push;hasRequiredEs_array_push=1;var Y=require_export(),X=requireToObject(),ee=requireLengthOfArrayLike(),ne=requireArraySetLength(),te=requireDoesNotExceedSafeInteger(),ue=requireFails(),se=ue(function(){return[].push.call({length:4294967296},1)!==4294967297}),ie=function(){try{Object.defineProperty([],"length",{writable:!1}).push()}catch(H){return H instanceof TypeError}},t=se||!ie();return Y({target:"Array",proto:!0,arity:1,forced:t},{push:function(ae){var he=X(this),_e=ee(he),ge=arguments.length;te(_e+ge);for(var xe=0;xe<ge;xe++)he[_e]=arguments[xe],_e++;return ne(he,_e),_e}}),es_array_push}var es_array_reduce={},arrayReduce,hasRequiredArrayReduce;function requireArrayReduce(){if(hasRequiredArrayReduce)return arrayReduce;hasRequiredArrayReduce=1;var Y=requireACallable(),X=requireToObject(),ee=requireIndexedObject(),ne=requireLengthOfArrayLike(),te=TypeError,ue="Reduce of empty array with no initial value",se=function(ie){return function(t,H,ae,he){var _e=X(t),ge=ee(_e),xe=ne(_e);if(Y(H),xe===0&&ae<2)throw new te(ue);var Re=ie?xe-1:0,De=ie?-1:1;if(ae<2)for(;;){if(Re in ge){he=ge[Re],Re+=De;break}if(Re+=De,ie?Re<0:xe<=Re)throw new te(ue)}for(;ie?Re>=0:xe>Re;Re+=De)Re in ge&&(he=H(he,ge[Re],Re,_e));return he}};return arrayReduce={left:se(!1),right:se(!0)},arrayReduce}var environment,hasRequiredEnvironment;function requireEnvironment(){if(hasRequiredEnvironment)return environment;hasRequiredEnvironment=1;var Y=requireGlobalThis(),X=requireEnvironmentUserAgent(),ee=requireClassofRaw(),ne=function(te){return X.slice(0,te.length)===te};return environment=function(){return ne("Bun/")?"BUN":ne("Cloudflare-Workers")?"CLOUDFLARE":ne("Deno/")?"DENO":ne("Node.js/")?"NODE":Y.Bun&&typeof Bun.version=="string"?"BUN":Y.Deno&&typeof Deno.version=="object"?"DENO":ee(Y.process)==="process"?"NODE":Y.window&&Y.document?"BROWSER":"REST"}(),environment}var environmentIsNode,hasRequiredEnvironmentIsNode;function requireEnvironmentIsNode(){if(hasRequiredEnvironmentIsNode)return environmentIsNode;hasRequiredEnvironmentIsNode=1;var Y=requireEnvironment();return environmentIsNode=Y==="NODE",environmentIsNode}var hasRequiredEs_array_reduce;function requireEs_array_reduce(){if(hasRequiredEs_array_reduce)return es_array_reduce;hasRequiredEs_array_reduce=1;var Y=require_export(),X=requireArrayReduce().left,ee=requireArrayMethodIsStrict(),ne=requireEnvironmentV8Version(),te=requireEnvironmentIsNode(),ue=!te&&ne>79&&ne<83,se=ue||!ee("reduce");return Y({target:"Array",proto:!0,forced:se},{reduce:function(t){var H=arguments.length;return X(this,t,H,H>1?arguments[1]:void 0)}}),es_array_reduce}var es_array_reduceRight={},hasRequiredEs_array_reduceRight;function requireEs_array_reduceRight(){if(hasRequiredEs_array_reduceRight)return es_array_reduceRight;hasRequiredEs_array_reduceRight=1;var Y=require_export(),X=requireArrayReduce().right,ee=requireArrayMethodIsStrict(),ne=requireEnvironmentV8Version(),te=requireEnvironmentIsNode(),ue=!te&&ne>79&&ne<83,se=ue||!ee("reduceRight");return Y({target:"Array",proto:!0,forced:se},{reduceRight:function(t){return X(this,t,arguments.length,arguments.length>1?arguments[1]:void 0)}}),es_array_reduceRight}var es_array_reverse={},hasRequiredEs_array_reverse;function requireEs_array_reverse(){if(hasRequiredEs_array_reverse)return es_array_reverse;hasRequiredEs_array_reverse=1;var Y=require_export(),X=requireFunctionUncurryThis(),ee=requireIsArray$1(),ne=X([].reverse),te=[1,2];return Y({target:"Array",proto:!0,forced:String(te)===String(te.reverse())},{reverse:function(){return ee(this)&&(this.length=this.length),ne(this)}}),es_array_reverse}var es_array_slice={},hasRequiredEs_array_slice;function requireEs_array_slice(){if(hasRequiredEs_array_slice)return es_array_slice;hasRequiredEs_array_slice=1;var Y=require_export(),X=requireIsArray$1(),ee=requireIsConstructor(),ne=requireIsObject$1(),te=requireToAbsoluteIndex(),ue=requireLengthOfArrayLike(),se=requireToIndexedObject(),ie=requireCreateProperty(),t=requireWellKnownSymbol(),H=requireArrayMethodHasSpeciesSupport(),ae=requireArraySlice(),he=H("slice"),_e=t("species"),ge=Array,xe=Math.max;return Y({target:"Array",proto:!0,forced:!he},{slice:function(De,Ie){var Ce=se(this),Ue=ue(Ce),Le=te(De,Ue),ke=te(Ie===void 0?Ue:Ie,Ue),Ge,Ze,We;if(X(Ce)&&(Ge=Ce.constructor,ee(Ge)&&(Ge===ge||X(Ge.prototype))?Ge=void 0:ne(Ge)&&(Ge=Ge[_e],Ge===null&&(Ge=void 0)),Ge===ge||Ge===void 0))return ae(Ce,Le,ke);for(Ze=new(Ge===void 0?ge:Ge)(xe(ke-Le,0)),We=0;Le<ke;Le++,We++)Le in Ce&&ie(Ze,We,Ce[Le]);return Ze.length=We,Ze}}),es_array_slice}var es_array_some={},hasRequiredEs_array_some;function requireEs_array_some(){if(hasRequiredEs_array_some)return es_array_some;hasRequiredEs_array_some=1;var Y=require_export(),X=requireArrayIteration().some,ee=requireArrayMethodIsStrict(),ne=ee("some");return Y({target:"Array",proto:!0,forced:!ne},{some:function(ue){return X(this,ue,arguments.length>1?arguments[1]:void 0)}}),es_array_some}var es_array_sort={},arraySort,hasRequiredArraySort;function requireArraySort(){if(hasRequiredArraySort)return arraySort;hasRequiredArraySort=1;var Y=requireArraySlice(),X=Math.floor,ee=function(ne,te){var ue=ne.length;if(ue<8)for(var se=1,ie,t;se<ue;){for(t=se,ie=ne[se];t&&te(ne[t-1],ie)>0;)ne[t]=ne[--t];t!==se++&&(ne[t]=ie)}else for(var H=X(ue/2),ae=ee(Y(ne,0,H),te),he=ee(Y(ne,H),te),_e=ae.length,ge=he.length,xe=0,Re=0;xe<_e||Re<ge;)ne[xe+Re]=xe<_e&&Re<ge?te(ae[xe],he[Re])<=0?ae[xe++]:he[Re++]:xe<_e?ae[xe++]:he[Re++];return ne};return arraySort=ee,arraySort}var environmentFfVersion,hasRequiredEnvironmentFfVersion;function requireEnvironmentFfVersion(){if(hasRequiredEnvironmentFfVersion)return environmentFfVersion;hasRequiredEnvironmentFfVersion=1;var Y=requireEnvironmentUserAgent(),X=Y.match(/firefox\/(\d+)/i);return environmentFfVersion=!!X&&+X[1],environmentFfVersion}var environmentIsIeOrEdge,hasRequiredEnvironmentIsIeOrEdge;function requireEnvironmentIsIeOrEdge(){if(hasRequiredEnvironmentIsIeOrEdge)return environmentIsIeOrEdge;hasRequiredEnvironmentIsIeOrEdge=1;var Y=requireEnvironmentUserAgent();return environmentIsIeOrEdge=/MSIE|Trident/.test(Y),environmentIsIeOrEdge}var environmentWebkitVersion,hasRequiredEnvironmentWebkitVersion;function requireEnvironmentWebkitVersion(){if(hasRequiredEnvironmentWebkitVersion)return environmentWebkitVersion;hasRequiredEnvironmentWebkitVersion=1;var Y=requireEnvironmentUserAgent(),X=Y.match(/AppleWebKit\/(\d+)\./);return environmentWebkitVersion=!!X&&+X[1],environmentWebkitVersion}var hasRequiredEs_array_sort;function requireEs_array_sort(){if(hasRequiredEs_array_sort)return es_array_sort;hasRequiredEs_array_sort=1;var Y=require_export(),X=requireFunctionUncurryThis(),ee=requireACallable(),ne=requireToObject(),te=requireLengthOfArrayLike(),ue=requireDeletePropertyOrThrow(),se=requireToString$1(),ie=requireFails(),t=requireArraySort(),H=requireArrayMethodIsStrict(),ae=requireEnvironmentFfVersion(),he=requireEnvironmentIsIeOrEdge(),_e=requireEnvironmentV8Version(),ge=requireEnvironmentWebkitVersion(),xe=[],Re=X(xe.sort),De=X(xe.push),Ie=ie(function(){xe.sort(void 0)}),Ce=ie(function(){xe.sort(null)}),Ue=H("sort"),Le=!ie(function(){if(_e)return _e<70;if(!(ae&&ae>3)){if(he)return!0;if(ge)return ge<603;var Ze="",We,et,He,ht;for(We=65;We<76;We++){switch(et=String.fromCharCode(We),We){case 66:case 69:case 70:case 72:He=3;break;case 68:case 71:He=4;break;default:He=2}for(ht=0;ht<47;ht++)xe.push({k:et+ht,v:He})}for(xe.sort(function(_t,ut){return ut.v-_t.v}),ht=0;ht<xe.length;ht++)et=xe[ht].k.charAt(0),Ze.charAt(Ze.length-1)!==et&&(Ze+=et);return Ze!=="DGBEFHACIJK"}}),ke=Ie||!Ce||!Ue||!Le,Ge=function(Ze){return function(We,et){return et===void 0?-1:We===void 0?1:Ze!==void 0?+Ze(We,et)||0:se(We)>se(et)?1:-1}};return Y({target:"Array",proto:!0,forced:ke},{sort:function(We){We!==void 0&&ee(We);var et=ne(this);if(Le)return We===void 0?Re(et):Re(et,We);var He=[],ht=te(et),_t,ut;for(ut=0;ut<ht;ut++)ut in et&&De(He,et[ut]);for(t(He,Ge(We)),_t=te(He),ut=0;ut<_t;)et[ut]=He[ut++];for(;ut<ht;)ue(et,ut++);return et}}),es_array_sort}var es_array_species={},setSpecies,hasRequiredSetSpecies;function requireSetSpecies(){if(hasRequiredSetSpecies)return setSpecies;hasRequiredSetSpecies=1;var Y=requireGetBuiltIn(),X=requireDefineBuiltInAccessor(),ee=requireWellKnownSymbol(),ne=requireDescriptors(),te=ee("species");return setSpecies=function(ue){var se=Y(ue);ne&&se&&!se[te]&&X(se,te,{configurable:!0,get:function(){return this}})},setSpecies}var hasRequiredEs_array_species;function requireEs_array_species(){if(hasRequiredEs_array_species)return es_array_species;hasRequiredEs_array_species=1;var Y=requireSetSpecies();return Y("Array"),es_array_species}var es_array_splice={},hasRequiredEs_array_splice;function requireEs_array_splice(){if(hasRequiredEs_array_splice)return es_array_splice;hasRequiredEs_array_splice=1;var Y=require_export(),X=requireToObject(),ee=requireToAbsoluteIndex(),ne=requireToIntegerOrInfinity(),te=requireLengthOfArrayLike(),ue=requireArraySetLength(),se=requireDoesNotExceedSafeInteger(),ie=requireArraySpeciesCreate(),t=requireCreateProperty(),H=requireDeletePropertyOrThrow(),ae=requireArrayMethodHasSpeciesSupport(),he=ae("splice"),_e=Math.max,ge=Math.min;return Y({target:"Array",proto:!0,forced:!he},{splice:function(Re,De){var Ie=X(this),Ce=te(Ie),Ue=ee(Re,Ce),Le=arguments.length,ke,Ge,Ze,We,et,He;for(Le===0?ke=Ge=0:Le===1?(ke=0,Ge=Ce-Ue):(ke=Le-2,Ge=ge(_e(ne(De),0),Ce-Ue)),se(Ce+ke-Ge),Ze=ie(Ie,Ge),We=0;We<Ge;We++)et=Ue+We,et in Ie&&t(Ze,We,Ie[et]);if(Ze.length=Ge,ke<Ge){for(We=Ue;We<Ce-Ge;We++)et=We+Ge,He=We+ke,et in Ie?Ie[He]=Ie[et]:H(Ie,He);for(We=Ce;We>Ce-Ge+ke;We--)H(Ie,We-1)}else if(ke>Ge)for(We=Ce-Ge;We>Ue;We--)et=We+Ge-1,He=We+ke-1,et in Ie?Ie[He]=Ie[et]:H(Ie,He);for(We=0;We<ke;We++)Ie[We+Ue]=arguments[We+2];return ue(Ie,Ce-Ge+ke),Ze}}),es_array_splice}var es_array_toReversed={},arrayToReversed,hasRequiredArrayToReversed;function requireArrayToReversed(){if(hasRequiredArrayToReversed)return arrayToReversed;hasRequiredArrayToReversed=1;var Y=requireLengthOfArrayLike();return arrayToReversed=function(X,ee){for(var ne=Y(X),te=new ee(ne),ue=0;ue<ne;ue++)te[ue]=X[ne-ue-1];return te},arrayToReversed}var hasRequiredEs_array_toReversed;function requireEs_array_toReversed(){if(hasRequiredEs_array_toReversed)return es_array_toReversed;hasRequiredEs_array_toReversed=1;var Y=require_export(),X=requireArrayToReversed(),ee=requireToIndexedObject(),ne=requireAddToUnscopables(),te=Array;return Y({target:"Array",proto:!0},{toReversed:function(){return X(ee(this),te)}}),ne("toReversed"),es_array_toReversed}var es_array_toSorted={},arrayFromConstructorAndList,hasRequiredArrayFromConstructorAndList;function requireArrayFromConstructorAndList(){if(hasRequiredArrayFromConstructorAndList)return arrayFromConstructorAndList;hasRequiredArrayFromConstructorAndList=1;var Y=requireLengthOfArrayLike();return arrayFromConstructorAndList=function(X,ee,ne){for(var te=0,ue=arguments.length>2?ne:Y(ee),se=new X(ue);ue>te;)se[te]=ee[te++];return se},arrayFromConstructorAndList}var getBuiltInPrototypeMethod,hasRequiredGetBuiltInPrototypeMethod;function requireGetBuiltInPrototypeMethod(){if(hasRequiredGetBuiltInPrototypeMethod)return getBuiltInPrototypeMethod;hasRequiredGetBuiltInPrototypeMethod=1;var Y=requireGlobalThis();return getBuiltInPrototypeMethod=function(X,ee){var ne=Y[X],te=ne&&ne.prototype;return te&&te[ee]},getBuiltInPrototypeMethod}var hasRequiredEs_array_toSorted;function requireEs_array_toSorted(){if(hasRequiredEs_array_toSorted)return es_array_toSorted;hasRequiredEs_array_toSorted=1;var Y=require_export(),X=requireFunctionUncurryThis(),ee=requireACallable(),ne=requireToIndexedObject(),te=requireArrayFromConstructorAndList(),ue=requireGetBuiltInPrototypeMethod(),se=requireAddToUnscopables(),ie=Array,t=X(ue("Array","sort"));return Y({target:"Array",proto:!0},{toSorted:function(ae){ae!==void 0&&ee(ae);var he=ne(this),_e=te(ie,he);return t(_e,ae)}}),se("toSorted"),es_array_toSorted}var es_array_toSpliced={},hasRequiredEs_array_toSpliced;function requireEs_array_toSpliced(){if(hasRequiredEs_array_toSpliced)return es_array_toSpliced;hasRequiredEs_array_toSpliced=1;var Y=require_export(),X=requireAddToUnscopables(),ee=requireDoesNotExceedSafeInteger(),ne=requireLengthOfArrayLike(),te=requireToAbsoluteIndex(),ue=requireToIndexedObject(),se=requireToIntegerOrInfinity(),ie=Array,t=Math.max,H=Math.min;return Y({target:"Array",proto:!0},{toSpliced:function(he,_e){var ge=ue(this),xe=ne(ge),Re=te(he,xe),De=arguments.length,Ie=0,Ce,Ue,Le,ke;for(De===0?Ce=Ue=0:De===1?(Ce=0,Ue=xe-Re):(Ce=De-2,Ue=H(t(se(_e),0),xe-Re)),Le=ee(xe+Ce-Ue),ke=ie(Le);Ie<Re;Ie++)ke[Ie]=ge[Ie];for(;Ie<Re+Ce;Ie++)ke[Ie]=arguments[Ie-Re+2];for(;Ie<Le;Ie++)ke[Ie]=ge[Ie+Ue-Ce];return ke}}),X("toSpliced"),es_array_toSpliced}var es_array_unscopables_flat={},hasRequiredEs_array_unscopables_flat;function requireEs_array_unscopables_flat(){if(hasRequiredEs_array_unscopables_flat)return es_array_unscopables_flat;hasRequiredEs_array_unscopables_flat=1;var Y=requireAddToUnscopables();return Y("flat"),es_array_unscopables_flat}var es_array_unscopables_flatMap={},hasRequiredEs_array_unscopables_flatMap;function requireEs_array_unscopables_flatMap(){if(hasRequiredEs_array_unscopables_flatMap)return es_array_unscopables_flatMap;hasRequiredEs_array_unscopables_flatMap=1;var Y=requireAddToUnscopables();return Y("flatMap"),es_array_unscopables_flatMap}var es_array_unshift={},hasRequiredEs_array_unshift;function requireEs_array_unshift(){if(hasRequiredEs_array_unshift)return es_array_unshift;hasRequiredEs_array_unshift=1;var Y=require_export(),X=requireToObject(),ee=requireLengthOfArrayLike(),ne=requireArraySetLength(),te=requireDeletePropertyOrThrow(),ue=requireDoesNotExceedSafeInteger(),se=[].unshift(0)!==1,ie=function(){try{Object.defineProperty([],"length",{writable:!1}).unshift()}catch(H){return H instanceof TypeError}},t=se||!ie();return Y({target:"Array",proto:!0,arity:1,forced:t},{unshift:function(ae){var he=X(this),_e=ee(he),ge=arguments.length;if(ge){ue(_e+ge);for(var xe=_e;xe--;){var Re=xe+ge;xe in he?he[Re]=he[xe]:te(he,Re)}for(var De=0;De<ge;De++)he[De]=arguments[De]}return ne(he,_e+ge)}}),es_array_unshift}var es_array_with={},arrayWith,hasRequiredArrayWith;function requireArrayWith(){if(hasRequiredArrayWith)return arrayWith;hasRequiredArrayWith=1;var Y=requireLengthOfArrayLike(),X=requireToIntegerOrInfinity(),ee=RangeError;return arrayWith=function(ne,te,ue,se){var ie=Y(ne),t=X(ue),H=t<0?ie+t:t;if(H>=ie||H<0)throw new ee("Incorrect index");for(var ae=new te(ie),he=0;he<ie;he++)ae[he]=he===H?se:ne[he];return ae},arrayWith}var hasRequiredEs_array_with;function requireEs_array_with(){if(hasRequiredEs_array_with)return es_array_with;hasRequiredEs_array_with=1;var Y=require_export(),X=requireArrayWith(),ee=requireToIndexedObject(),ne=Array,te=function(){try{[].with({valueOf:function(){throw 4}},null)}catch(ue){return ue!==4}}();return Y({target:"Array",proto:!0,forced:te},{with:function(ue,se){return X(ee(this),ne,ue,se)}}),es_array_with}var es_arrayBuffer_constructor={},arrayBufferBasicDetection,hasRequiredArrayBufferBasicDetection;function requireArrayBufferBasicDetection(){return hasRequiredArrayBufferBasicDetection||(hasRequiredArrayBufferBasicDetection=1,arrayBufferBasicDetection=typeof ArrayBuffer<"u"&&typeof DataView<"u"),arrayBufferBasicDetection}var defineBuiltIns,hasRequiredDefineBuiltIns;function requireDefineBuiltIns(){if(hasRequiredDefineBuiltIns)return defineBuiltIns;hasRequiredDefineBuiltIns=1;var Y=requireDefineBuiltIn();return defineBuiltIns=function(X,ee,ne){for(var te in ee)Y(X,te,ee[te],ne);return X},defineBuiltIns}var anInstance,hasRequiredAnInstance;function requireAnInstance(){if(hasRequiredAnInstance)return anInstance;hasRequiredAnInstance=1;var Y=requireObjectIsPrototypeOf(),X=TypeError;return anInstance=function(ee,ne){if(Y(ne,ee))return ee;throw new X("Incorrect invocation")},anInstance}var toIndex,hasRequiredToIndex;function requireToIndex(){if(hasRequiredToIndex)return toIndex;hasRequiredToIndex=1;var Y=requireToIntegerOrInfinity(),X=requireToLength(),ee=RangeError;return toIndex=function(ne){if(ne===void 0)return 0;var te=Y(ne),ue=X(te);if(te!==ue)throw new ee("Wrong length or index");return ue},toIndex}var mathSign,hasRequiredMathSign;function requireMathSign(){return hasRequiredMathSign||(hasRequiredMathSign=1,mathSign=Math.sign||function(X){var ee=+X;return ee===0||ee!==ee?ee:ee<0?-1:1}),mathSign}var mathRoundTiesToEven,hasRequiredMathRoundTiesToEven;function requireMathRoundTiesToEven(){if(hasRequiredMathRoundTiesToEven)return mathRoundTiesToEven;hasRequiredMathRoundTiesToEven=1;var Y=2220446049250313e-31,X=1/Y;return mathRoundTiesToEven=function(ee){return ee+X-X},mathRoundTiesToEven}var mathFloatRound,hasRequiredMathFloatRound;function requireMathFloatRound(){if(hasRequiredMathFloatRound)return mathFloatRound;hasRequiredMathFloatRound=1;var Y=requireMathSign(),X=requireMathRoundTiesToEven(),ee=Math.abs,ne=2220446049250313e-31;return mathFloatRound=function(te,ue,se,ie){var t=+te,H=ee(t),ae=Y(t);if(H<ie)return ae*X(H/ie/ue)*ie*ue;var he=(1+ue/ne)*H,_e=he-(he-H);return _e>se||_e!==_e?ae*(1/0):ae*_e},mathFloatRound}var mathFround,hasRequiredMathFround;function requireMathFround(){if(hasRequiredMathFround)return mathFround;hasRequiredMathFround=1;var Y=requireMathFloatRound(),X=11920928955078125e-23,ee=34028234663852886e22,ne=11754943508222875e-54;return mathFround=Math.fround||function(ue){return Y(ue,X,ee,ne)},mathFround}var ieee754$1,hasRequiredIeee754$1;function requireIeee754$1(){if(hasRequiredIeee754$1)return ieee754$1;hasRequiredIeee754$1=1;var Y=Array,X=Math.abs,ee=Math.pow,ne=Math.floor,te=Math.log,ue=Math.LN2,se=function(t,H,ae){var he=Y(ae),_e=ae*8-H-1,ge=(1<<_e)-1,xe=ge>>1,Re=H===23?ee(2,-24)-ee(2,-77):0,De=t<0||t===0&&1/t<0?1:0,Ie=0,Ce,Ue,Le;for(t=X(t),t!==t||t===1/0?(Ue=t!==t?1:0,Ce=ge):(Ce=ne(te(t)/ue),Le=ee(2,-Ce),t*Le<1&&(Ce--,Le*=2),Ce+xe>=1?t+=Re/Le:t+=Re*ee(2,1-xe),t*Le>=2&&(Ce++,Le/=2),Ce+xe>=ge?(Ue=0,Ce=ge):Ce+xe>=1?(Ue=(t*Le-1)*ee(2,H),Ce+=xe):(Ue=t*ee(2,xe-1)*ee(2,H),Ce=0));H>=8;)he[Ie++]=Ue&255,Ue/=256,H-=8;for(Ce=Ce<<H|Ue,_e+=H;_e>0;)he[Ie++]=Ce&255,Ce/=256,_e-=8;return he[Ie-1]|=De*128,he},ie=function(t,H){var ae=t.length,he=ae*8-H-1,_e=(1<<he)-1,ge=_e>>1,xe=he-7,Re=ae-1,De=t[Re--],Ie=De&127,Ce;for(De>>=7;xe>0;)Ie=Ie*256+t[Re--],xe-=8;for(Ce=Ie&(1<<-xe)-1,Ie>>=-xe,xe+=H;xe>0;)Ce=Ce*256+t[Re--],xe-=8;if(Ie===0)Ie=1-ge;else{if(Ie===_e)return Ce?NaN:De?-1/0:1/0;Ce+=ee(2,H),Ie-=ge}return(De?-1:1)*Ce*ee(2,Ie-H)};return ieee754$1={pack:se,unpack:ie},ieee754$1}var arrayBuffer,hasRequiredArrayBuffer;function requireArrayBuffer(){if(hasRequiredArrayBuffer)return arrayBuffer;hasRequiredArrayBuffer=1;var Y=requireGlobalThis(),X=requireFunctionUncurryThis(),ee=requireDescriptors(),ne=requireArrayBufferBasicDetection(),te=requireFunctionName(),ue=requireCreateNonEnumerableProperty(),se=requireDefineBuiltInAccessor(),ie=requireDefineBuiltIns(),t=requireFails(),H=requireAnInstance(),ae=requireToIntegerOrInfinity(),he=requireToLength(),_e=requireToIndex(),ge=requireMathFround(),xe=requireIeee754$1(),Re=requireObjectGetPrototypeOf(),De=requireObjectSetPrototypeOf(),Ie=requireArrayFill(),Ce=requireArraySlice(),Ue=requireInheritIfRequired(),Le=requireCopyConstructorProperties(),ke=requireSetToStringTag(),Ge=requireInternalState(),Ze=te.PROPER,We=te.CONFIGURABLE,et="ArrayBuffer",He="DataView",ht="prototype",_t="Wrong length",ut="Wrong index",yt=Ge.getterFor(et),Lt=Ge.getterFor(He),Kt=Ge.set,ft=Y[et],qt=ft,nt=qt&&qt[ht],At=Y[He],wt=At&&At[ht],Ft=Object.prototype,er=Y.Array,lr=Y.RangeError,jr=X(Ie),Mr=X([].reverse),Lr=xe.pack,sr=xe.unpack,Rr=function(_r){return[_r&255]},Ur=function(_r){return[_r&255,_r>>8&255]},Wr=function(_r){return[_r&255,_r>>8&255,_r>>16&255,_r>>24&255]},Er=function(_r){return _r[3]<<24|_r[2]<<16|_r[1]<<8|_r[0]},Kr=function(_r){return Lr(ge(_r),23,4)},ui=function(_r){return Lr(_r,52,8)},Ei=function(_r,vr,Xr){se(_r[ht],vr,{configurable:!0,get:function(){return Xr(this)[vr]}})},Hr=function(_r,vr,Xr,Ir){var Or=Lt(_r),Nr=_e(Xr),je=!!Ir;if(Nr+vr>Or.byteLength)throw new lr(ut);var Se=Or.bytes,Oe=Nr+Or.byteOffset,Ve=Ce(Se,Oe,Oe+vr);return je?Ve:Mr(Ve)},Br=function(_r,vr,Xr,Ir,Or,Nr){var je=Lt(_r),Se=_e(Xr),Oe=Ir(+Or),Ve=!!Nr;if(Se+vr>je.byteLength)throw new lr(ut);for(var st=je.bytes,gt=Se+je.byteOffset,Ot=0;Ot<vr;Ot++)st[gt+Ot]=Oe[Ve?Ot:vr-Ot-1]};if(!ne)qt=function(vr){H(this,nt);var Xr=_e(vr);Kt(this,{type:et,bytes:jr(er(Xr),0),byteLength:Xr}),ee||(this.byteLength=Xr,this.detached=!1)},nt=qt[ht],At=function(vr,Xr,Ir){H(this,wt),H(vr,nt);var Or=yt(vr),Nr=Or.byteLength,je=ae(Xr);if(je<0||je>Nr)throw new lr("Wrong offset");if(Ir=Ir===void 0?Nr-je:he(Ir),je+Ir>Nr)throw new lr(_t);Kt(this,{type:He,buffer:vr,byteLength:Ir,byteOffset:je,bytes:Or.bytes}),ee||(this.buffer=vr,this.byteLength=Ir,this.byteOffset=je)},wt=At[ht],ee&&(Ei(qt,"byteLength",yt),Ei(At,"buffer",Lt),Ei(At,"byteLength",Lt),Ei(At,"byteOffset",Lt)),ie(wt,{getInt8:function(vr){return Hr(this,1,vr)[0]<<24>>24},getUint8:function(vr){return Hr(this,1,vr)[0]},getInt16:function(vr){var Xr=Hr(this,2,vr,arguments.length>1?arguments[1]:!1);return(Xr[1]<<8|Xr[0])<<16>>16},getUint16:function(vr){var Xr=Hr(this,2,vr,arguments.length>1?arguments[1]:!1);return Xr[1]<<8|Xr[0]},getInt32:function(vr){return Er(Hr(this,4,vr,arguments.length>1?arguments[1]:!1))},getUint32:function(vr){return Er(Hr(this,4,vr,arguments.length>1?arguments[1]:!1))>>>0},getFloat32:function(vr){return sr(Hr(this,4,vr,arguments.length>1?arguments[1]:!1),23)},getFloat64:function(vr){return sr(Hr(this,8,vr,arguments.length>1?arguments[1]:!1),52)},setInt8:function(vr,Xr){Br(this,1,vr,Rr,Xr)},setUint8:function(vr,Xr){Br(this,1,vr,Rr,Xr)},setInt16:function(vr,Xr){Br(this,2,vr,Ur,Xr,arguments.length>2?arguments[2]:!1)},setUint16:function(vr,Xr){Br(this,2,vr,Ur,Xr,arguments.length>2?arguments[2]:!1)},setInt32:function(vr,Xr){Br(this,4,vr,Wr,Xr,arguments.length>2?arguments[2]:!1)},setUint32:function(vr,Xr){Br(this,4,vr,Wr,Xr,arguments.length>2?arguments[2]:!1)},setFloat32:function(vr,Xr){Br(this,4,vr,Kr,Xr,arguments.length>2?arguments[2]:!1)},setFloat64:function(vr,Xr){Br(this,8,vr,ui,Xr,arguments.length>2?arguments[2]:!1)}});else{var li=Ze&&ft.name!==et;!t(function(){ft(1)})||!t(function(){new ft(-1)})||t(function(){return new ft,new ft(1.5),new ft(NaN),ft.length!==1||li&&!We})?(qt=function(vr){return H(this,nt),Ue(new ft(_e(vr)),this,qt)},qt[ht]=nt,nt.constructor=qt,Le(qt,ft)):li&&We&&ue(ft,"name",et),De&&Re(wt)!==Ft&&De(wt,Ft);var si=new At(new qt(2)),Qr=X(wt.setInt8);si.setInt8(0,2147483648),si.setInt8(1,2147483649),(si.getInt8(0)||!si.getInt8(1))&&ie(wt,{setInt8:function(vr,Xr){Qr(this,vr,Xr<<24>>24)},setUint8:function(vr,Xr){Qr(this,vr,Xr<<24>>24)}},{unsafe:!0})}return ke(qt,et),ke(At,He),arrayBuffer={ArrayBuffer:qt,DataView:At},arrayBuffer}var hasRequiredEs_arrayBuffer_constructor;function requireEs_arrayBuffer_constructor(){if(hasRequiredEs_arrayBuffer_constructor)return es_arrayBuffer_constructor;hasRequiredEs_arrayBuffer_constructor=1;var Y=require_export(),X=requireGlobalThis(),ee=requireArrayBuffer(),ne=requireSetSpecies(),te="ArrayBuffer",ue=ee[te],se=X[te];return Y({global:!0,constructor:!0,forced:se!==ue},{ArrayBuffer:ue}),ne(te),es_arrayBuffer_constructor}var es_arrayBuffer_isView={},arrayBufferViewCore,hasRequiredArrayBufferViewCore;function requireArrayBufferViewCore(){if(hasRequiredArrayBufferViewCore)return arrayBufferViewCore;hasRequiredArrayBufferViewCore=1;var Y=requireArrayBufferBasicDetection(),X=requireDescriptors(),ee=requireGlobalThis(),ne=requireIsCallable(),te=requireIsObject$1(),ue=requireHasOwnProperty(),se=requireClassof(),ie=requireTryToString(),t=requireCreateNonEnumerableProperty(),H=requireDefineBuiltIn(),ae=requireDefineBuiltInAccessor(),he=requireObjectIsPrototypeOf(),_e=requireObjectGetPrototypeOf(),ge=requireObjectSetPrototypeOf(),xe=requireWellKnownSymbol(),Re=requireUid(),De=requireInternalState(),Ie=De.enforce,Ce=De.get,Ue=ee.Int8Array,Le=Ue&&Ue.prototype,ke=ee.Uint8ClampedArray,Ge=ke&&ke.prototype,Ze=Ue&&_e(Ue),We=Le&&_e(Le),et=Object.prototype,He=ee.TypeError,ht=xe("toStringTag"),_t=Re("TYPED_ARRAY_TAG"),ut="TypedArrayConstructor",yt=Y&&!!ge&&se(ee.opera)!=="Opera",Lt=!1,Kt,ft,qt,nt={Int8Array:1,Uint8Array:1,Uint8ClampedArray:1,Int16Array:2,Uint16Array:2,Int32Array:4,Uint32Array:4,Float32Array:4,Float64Array:8},At={BigInt64Array:8,BigUint64Array:8},wt=function(Rr){if(!te(Rr))return!1;var Ur=se(Rr);return Ur==="DataView"||ue(nt,Ur)||ue(At,Ur)},Ft=function(sr){var Rr=_e(sr);if(te(Rr)){var Ur=Ce(Rr);return Ur&&ue(Ur,ut)?Ur[ut]:Ft(Rr)}},er=function(sr){if(!te(sr))return!1;var Rr=se(sr);return ue(nt,Rr)||ue(At,Rr)},lr=function(sr){if(er(sr))return sr;throw new He("Target is not a typed array")},jr=function(sr){if(ne(sr)&&(!ge||he(Ze,sr)))return sr;throw new He(ie(sr)+" is not a typed array constructor")},Mr=function(sr,Rr,Ur,Wr){if(X){if(Ur)for(var Er in nt){var Kr=ee[Er];if(Kr&&ue(Kr.prototype,sr))try{delete Kr.prototype[sr]}catch{try{Kr.prototype[sr]=Rr}catch{}}}(!We[sr]||Ur)&&H(We,sr,Ur?Rr:yt&&Le[sr]||Rr,Wr)}},Lr=function(sr,Rr,Ur){var Wr,Er;if(X){if(ge){if(Ur){for(Wr in nt)if(Er=ee[Wr],Er&&ue(Er,sr))try{delete Er[sr]}catch{}}if(!Ze[sr]||Ur)try{return H(Ze,sr,Ur?Rr:yt&&Ze[sr]||Rr)}catch{}else return}for(Wr in nt)Er=ee[Wr],Er&&(!Er[sr]||Ur)&&H(Er,sr,Rr)}};for(Kt in nt)ft=ee[Kt],qt=ft&&ft.prototype,qt?Ie(qt)[ut]=ft:yt=!1;for(Kt in At)ft=ee[Kt],qt=ft&&ft.prototype,qt&&(Ie(qt)[ut]=ft);if((!yt||!ne(Ze)||Ze===Function.prototype)&&(Ze=function(){throw new He("Incorrect invocation")},yt))for(Kt in nt)ee[Kt]&&ge(ee[Kt],Ze);if((!yt||!We||We===et)&&(We=Ze.prototype,yt))for(Kt in nt)ee[Kt]&&ge(ee[Kt].prototype,We);if(yt&&_e(Ge)!==We&&ge(Ge,We),X&&!ue(We,ht)){Lt=!0,ae(We,ht,{configurable:!0,get:function(){return te(this)?this[_t]:void 0}});for(Kt in nt)ee[Kt]&&t(ee[Kt],_t,Kt)}return arrayBufferViewCore={NATIVE_ARRAY_BUFFER_VIEWS:yt,TYPED_ARRAY_TAG:Lt&&_t,aTypedArray:lr,aTypedArrayConstructor:jr,exportTypedArrayMethod:Mr,exportTypedArrayStaticMethod:Lr,getTypedArrayConstructor:Ft,isView:wt,isTypedArray:er,TypedArray:Ze,TypedArrayPrototype:We},arrayBufferViewCore}var hasRequiredEs_arrayBuffer_isView;function requireEs_arrayBuffer_isView(){if(hasRequiredEs_arrayBuffer_isView)return es_arrayBuffer_isView;hasRequiredEs_arrayBuffer_isView=1;var Y=require_export(),X=requireArrayBufferViewCore(),ee=X.NATIVE_ARRAY_BUFFER_VIEWS;return Y({target:"ArrayBuffer",stat:!0,forced:!ee},{isView:X.isView}),es_arrayBuffer_isView}var es_arrayBuffer_slice={},hasRequiredEs_arrayBuffer_slice;function requireEs_arrayBuffer_slice(){if(hasRequiredEs_arrayBuffer_slice)return es_arrayBuffer_slice;hasRequiredEs_arrayBuffer_slice=1;var Y=require_export(),X=requireFunctionUncurryThisClause(),ee=requireFails(),ne=requireArrayBuffer(),te=requireAnObject(),ue=requireToAbsoluteIndex(),se=requireToLength(),ie=ne.ArrayBuffer,t=ne.DataView,H=t.prototype,ae=X(ie.prototype.slice),he=X(H.getUint8),_e=X(H.setUint8),ge=ee(function(){return!new ie(2).slice(1,void 0).byteLength});return Y({target:"ArrayBuffer",proto:!0,unsafe:!0,forced:ge},{slice:function(Re,De){if(ae&&De===void 0)return ae(te(this),Re);for(var Ie=te(this).byteLength,Ce=ue(Re,Ie),Ue=ue(De===void 0?Ie:De,Ie),Le=new ie(se(Ue-Ce)),ke=new t(this),Ge=new t(Le),Ze=0;Ce<Ue;)_e(Ge,Ze++,he(ke,Ce++));return Le}}),es_arrayBuffer_slice}var es_dataView={},es_dataView_constructor={},hasRequiredEs_dataView_constructor;function requireEs_dataView_constructor(){if(hasRequiredEs_dataView_constructor)return es_dataView_constructor;hasRequiredEs_dataView_constructor=1;var Y=require_export(),X=requireArrayBuffer(),ee=requireArrayBufferBasicDetection();return Y({global:!0,constructor:!0,forced:!ee},{DataView:X.DataView}),es_dataView_constructor}var hasRequiredEs_dataView;function requireEs_dataView(){return hasRequiredEs_dataView||(hasRequiredEs_dataView=1,requireEs_dataView_constructor()),es_dataView}var es_dataView_getFloat16={},hasRequiredEs_dataView_getFloat16;function requireEs_dataView_getFloat16(){if(hasRequiredEs_dataView_getFloat16)return es_dataView_getFloat16;hasRequiredEs_dataView_getFloat16=1;var Y=require_export(),X=requireFunctionUncurryThis(),ee=Math.pow,ne=31,te=1023,ue=ee(2,-24),se=.0009765625,ie=function(H){var ae=H>>>15,he=H>>>10&ne,_e=H&te;return he===ne?_e===0?ae===0?1/0:-1/0:NaN:he===0?_e*(ae===0?ue:-ue):ee(2,he-15)*(ae===0?1+_e*se:-1-_e*se)},t=X(DataView.prototype.getUint16);return Y({target:"DataView",proto:!0},{getFloat16:function(ae){return ie(t(this,ae,arguments.length>1?arguments[1]:!1))}}),es_dataView_getFloat16}var es_dataView_setFloat16={},aDataView,hasRequiredADataView;function requireADataView(){if(hasRequiredADataView)return aDataView;hasRequiredADataView=1;var Y=requireClassof(),X=TypeError;return aDataView=function(ee){if(Y(ee)==="DataView")return ee;throw new X("Argument is not a DataView")},aDataView}var mathLog2,hasRequiredMathLog2;function requireMathLog2(){if(hasRequiredMathLog2)return mathLog2;hasRequiredMathLog2=1;var Y=Math.log,X=Math.LN2;return mathLog2=Math.log2||function(ne){return Y(ne)/X},mathLog2}var hasRequiredEs_dataView_setFloat16;function requireEs_dataView_setFloat16(){if(hasRequiredEs_dataView_setFloat16)return es_dataView_setFloat16;hasRequiredEs_dataView_setFloat16=1;var Y=require_export(),X=requireFunctionUncurryThis(),ee=requireADataView(),ne=requireToIndex(),te=requireMathLog2(),ue=requireMathRoundTiesToEven(),se=Math.pow,ie=65520,t=61005353927612305e-21,H=16777216,ae=1024,he=function(ge){if(ge!==ge)return 32256;if(ge===0)return(1/ge===-1/0)<<15;var xe=ge<0;if(xe&&(ge=-ge),ge>=ie)return xe<<15|31744;if(ge<t)return xe<<15|ue(ge*H);var Re=te(ge)|0;if(Re===-15)return xe<<15|ae;var De=ue((ge*se(2,-Re)-1)*ae);return De===ae?xe<<15|Re+16<<10:xe<<15|Re+15<<10|De},_e=X(DataView.prototype.setUint16);return Y({target:"DataView",proto:!0},{setFloat16:function(xe,Re){_e(ee(this),ne(xe),he(+Re),arguments.length>2?arguments[2]:!1)}}),es_dataView_setFloat16}var es_arrayBuffer_detached={},arrayBufferByteLength,hasRequiredArrayBufferByteLength;function requireArrayBufferByteLength(){if(hasRequiredArrayBufferByteLength)return arrayBufferByteLength;hasRequiredArrayBufferByteLength=1;var Y=requireGlobalThis(),X=requireFunctionUncurryThisAccessor(),ee=requireClassofRaw(),ne=Y.ArrayBuffer,te=Y.TypeError;return arrayBufferByteLength=ne&&X(ne.prototype,"byteLength","get")||function(ue){if(ee(ue)!=="ArrayBuffer")throw new te("ArrayBuffer expected");return ue.byteLength},arrayBufferByteLength}var arrayBufferIsDetached,hasRequiredArrayBufferIsDetached;function requireArrayBufferIsDetached(){if(hasRequiredArrayBufferIsDetached)return arrayBufferIsDetached;hasRequiredArrayBufferIsDetached=1;var Y=requireGlobalThis(),X=requireArrayBufferBasicDetection(),ee=requireArrayBufferByteLength(),ne=Y.DataView;return arrayBufferIsDetached=function(te){if(!X||ee(te)!==0)return!1;try{return new ne(te),!1}catch{return!0}},arrayBufferIsDetached}var hasRequiredEs_arrayBuffer_detached;function requireEs_arrayBuffer_detached(){if(hasRequiredEs_arrayBuffer_detached)return es_arrayBuffer_detached;hasRequiredEs_arrayBuffer_detached=1;var Y=requireDescriptors(),X=requireDefineBuiltInAccessor(),ee=requireArrayBufferIsDetached(),ne=ArrayBuffer.prototype;return Y&&!("detached"in ne)&&X(ne,"detached",{configurable:!0,get:function(){return ee(this)}}),es_arrayBuffer_detached}var es_arrayBuffer_transfer={},arrayBufferNotDetached,hasRequiredArrayBufferNotDetached;function requireArrayBufferNotDetached(){if(hasRequiredArrayBufferNotDetached)return arrayBufferNotDetached;hasRequiredArrayBufferNotDetached=1;var Y=requireArrayBufferIsDetached(),X=TypeError;return arrayBufferNotDetached=function(ee){if(Y(ee))throw new X("ArrayBuffer is detached");return ee},arrayBufferNotDetached}var getBuiltInNodeModule,hasRequiredGetBuiltInNodeModule;function requireGetBuiltInNodeModule(){if(hasRequiredGetBuiltInNodeModule)return getBuiltInNodeModule;hasRequiredGetBuiltInNodeModule=1;var Y=requireGlobalThis(),X=requireEnvironmentIsNode();return getBuiltInNodeModule=function(ee){if(X){try{return Y.process.getBuiltinModule(ee)}catch{}try{return Function('return require("'+ee+'")')()}catch{}}},getBuiltInNodeModule}var structuredCloneProperTransfer,hasRequiredStructuredCloneProperTransfer;function requireStructuredCloneProperTransfer(){if(hasRequiredStructuredCloneProperTransfer)return structuredCloneProperTransfer;hasRequiredStructuredCloneProperTransfer=1;var Y=requireGlobalThis(),X=requireFails(),ee=requireEnvironmentV8Version(),ne=requireEnvironment(),te=Y.structuredClone;return structuredCloneProperTransfer=!!te&&!X(function(){if(ne==="DENO"&&ee>92||ne==="NODE"&&ee>94||ne==="BROWSER"&&ee>97)return!1;var ue=new ArrayBuffer(8),se=te(ue,{transfer:[ue]});return ue.byteLength!==0||se.byteLength!==8}),structuredCloneProperTransfer}var detachTransferable,hasRequiredDetachTransferable;function requireDetachTransferable(){if(hasRequiredDetachTransferable)return detachTransferable;hasRequiredDetachTransferable=1;var Y=requireGlobalThis(),X=requireGetBuiltInNodeModule(),ee=requireStructuredCloneProperTransfer(),ne=Y.structuredClone,te=Y.ArrayBuffer,ue=Y.MessageChannel,se=!1,ie,t,H,ae;if(ee)se=function(he){ne(he,{transfer:[he]})};else if(te)try{ue||(ie=X("worker_threads"),ie&&(ue=ie.MessageChannel)),ue&&(t=new ue,H=new te(2),ae=function(he){t.port1.postMessage(null,[he])},H.byteLength===2&&(ae(H),H.byteLength===0&&(se=ae)))}catch{}return detachTransferable=se,detachTransferable}var arrayBufferTransfer,hasRequiredArrayBufferTransfer;function requireArrayBufferTransfer(){if(hasRequiredArrayBufferTransfer)return arrayBufferTransfer;hasRequiredArrayBufferTransfer=1;var Y=requireGlobalThis(),X=requireFunctionUncurryThis(),ee=requireFunctionUncurryThisAccessor(),ne=requireToIndex(),te=requireArrayBufferNotDetached(),ue=requireArrayBufferByteLength(),se=requireDetachTransferable(),ie=requireStructuredCloneProperTransfer(),t=Y.structuredClone,H=Y.ArrayBuffer,ae=Y.DataView,he=Math.min,_e=H.prototype,ge=ae.prototype,xe=X(_e.slice),Re=ee(_e,"resizable","get"),De=ee(_e,"maxByteLength","get"),Ie=X(ge.getInt8),Ce=X(ge.setInt8);return arrayBufferTransfer=(ie||se)&&function(Ue,Le,ke){var Ge=ue(Ue),Ze=Le===void 0?Ge:ne(Le),We=!Re||!Re(Ue),et;if(te(Ue),ie&&(Ue=t(Ue,{transfer:[Ue]}),Ge===Ze&&(ke||We)))return Ue;if(Ge>=Ze&&(!ke||We))et=xe(Ue,0,Ze);else{var He=ke&&!We&&De?{maxByteLength:De(Ue)}:void 0;et=new H(Ze,He);for(var ht=new ae(Ue),_t=new ae(et),ut=he(Ze,Ge),yt=0;yt<ut;yt++)Ce(_t,yt,Ie(ht,yt))}return ie||se(Ue),et},arrayBufferTransfer}var hasRequiredEs_arrayBuffer_transfer;function requireEs_arrayBuffer_transfer(){if(hasRequiredEs_arrayBuffer_transfer)return es_arrayBuffer_transfer;hasRequiredEs_arrayBuffer_transfer=1;var Y=require_export(),X=requireArrayBufferTransfer();return X&&Y({target:"ArrayBuffer",proto:!0},{transfer:function(){return X(this,arguments.length?arguments[0]:void 0,!0)}}),es_arrayBuffer_transfer}var es_arrayBuffer_transferToFixedLength={},hasRequiredEs_arrayBuffer_transferToFixedLength;function requireEs_arrayBuffer_transferToFixedLength(){if(hasRequiredEs_arrayBuffer_transferToFixedLength)return es_arrayBuffer_transferToFixedLength;hasRequiredEs_arrayBuffer_transferToFixedLength=1;var Y=require_export(),X=requireArrayBufferTransfer();return X&&Y({target:"ArrayBuffer",proto:!0},{transferToFixedLength:function(){return X(this,arguments.length?arguments[0]:void 0,!1)}}),es_arrayBuffer_transferToFixedLength}var es_date_getYear={},hasRequiredEs_date_getYear;function requireEs_date_getYear(){if(hasRequiredEs_date_getYear)return es_date_getYear;hasRequiredEs_date_getYear=1;var Y=require_export(),X=requireFunctionUncurryThis(),ee=requireFails(),ne=ee(function(){return new Date(16e11).getYear()!==120}),te=X(Date.prototype.getFullYear);return Y({target:"Date",proto:!0,forced:ne},{getYear:function(){return te(this)-1900}}),es_date_getYear}var es_date_now={},hasRequiredEs_date_now;function requireEs_date_now(){if(hasRequiredEs_date_now)return es_date_now;hasRequiredEs_date_now=1;var Y=require_export(),X=requireFunctionUncurryThis(),ee=Date,ne=X(ee.prototype.getTime);return Y({target:"Date",stat:!0},{now:function(){return ne(new ee)}}),es_date_now}var es_date_setYear={},hasRequiredEs_date_setYear;function requireEs_date_setYear(){if(hasRequiredEs_date_setYear)return es_date_setYear;hasRequiredEs_date_setYear=1;var Y=require_export(),X=requireFunctionUncurryThis(),ee=requireToIntegerOrInfinity(),ne=Date.prototype,te=X(ne.getTime),ue=X(ne.setFullYear);return Y({target:"Date",proto:!0},{setYear:function(ie){te(this);var t=ee(ie),H=t>=0&&t<=99?t+1900:t;return ue(this,H)}}),es_date_setYear}var es_date_toGmtString={},hasRequiredEs_date_toGmtString;function requireEs_date_toGmtString(){if(hasRequiredEs_date_toGmtString)return es_date_toGmtString;hasRequiredEs_date_toGmtString=1;var Y=require_export();return Y({target:"Date",proto:!0},{toGMTString:Date.prototype.toUTCString}),es_date_toGmtString}var es_date_toIsoString={},stringRepeat,hasRequiredStringRepeat;function requireStringRepeat(){if(hasRequiredStringRepeat)return stringRepeat;hasRequiredStringRepeat=1;var Y=requireToIntegerOrInfinity(),X=requireToString$1(),ee=requireRequireObjectCoercible(),ne=RangeError;return stringRepeat=function(ue){var se=X(ee(this)),ie="",t=Y(ue);if(t<0||t===1/0)throw new ne("Wrong number of repetitions");for(;t>0;(t>>>=1)&&(se+=se))t&1&&(ie+=se);return ie},stringRepeat}var stringPad,hasRequiredStringPad;function requireStringPad(){if(hasRequiredStringPad)return stringPad;hasRequiredStringPad=1;var Y=requireFunctionUncurryThis(),X=requireToLength(),ee=requireToString$1(),ne=requireStringRepeat(),te=requireRequireObjectCoercible(),ue=Y(ne),se=Y("".slice),ie=Math.ceil,t=function(H){return function(ae,he,_e){var ge=ee(te(ae)),xe=X(he),Re=ge.length,De=_e===void 0?" ":ee(_e),Ie,Ce;return xe<=Re||De===""?ge:(Ie=xe-Re,Ce=ue(De,ie(Ie/De.length)),Ce.length>Ie&&(Ce=se(Ce,0,Ie)),H?ge+Ce:Ce+ge)}};return stringPad={start:t(!1),end:t(!0)},stringPad}var dateToIsoString,hasRequiredDateToIsoString;function requireDateToIsoString(){if(hasRequiredDateToIsoString)return dateToIsoString;hasRequiredDateToIsoString=1;var Y=requireFunctionUncurryThis(),X=requireFails(),ee=requireStringPad().start,ne=RangeError,te=isFinite,ue=Math.abs,se=Date.prototype,ie=se.toISOString,t=Y(se.getTime),H=Y(se.getUTCDate),ae=Y(se.getUTCFullYear),he=Y(se.getUTCHours),_e=Y(se.getUTCMilliseconds),ge=Y(se.getUTCMinutes),xe=Y(se.getUTCMonth),Re=Y(se.getUTCSeconds);return dateToIsoString=X(function(){return ie.call(new Date(-5e13-1))!=="0385-07-25T07:06:39.999Z"})||!X(function(){ie.call(new Date(NaN))})?function(){if(!te(t(this)))throw new ne("Invalid time value");var Ie=this,Ce=ae(Ie),Ue=_e(Ie),Le=Ce<0?"-":Ce>9999?"+":"";return Le+ee(ue(Ce),Le?6:4,0)+"-"+ee(xe(Ie)+1,2,0)+"-"+ee(H(Ie),2,0)+"T"+ee(he(Ie),2,0)+":"+ee(ge(Ie),2,0)+":"+ee(Re(Ie),2,0)+"."+ee(Ue,3,0)+"Z"}:ie,dateToIsoString}var hasRequiredEs_date_toIsoString;function requireEs_date_toIsoString(){if(hasRequiredEs_date_toIsoString)return es_date_toIsoString;hasRequiredEs_date_toIsoString=1;var Y=require_export(),X=requireDateToIsoString();return Y({target:"Date",proto:!0,forced:Date.prototype.toISOString!==X},{toISOString:X}),es_date_toIsoString}var es_date_toJson={},hasRequiredEs_date_toJson;function requireEs_date_toJson(){if(hasRequiredEs_date_toJson)return es_date_toJson;hasRequiredEs_date_toJson=1;var Y=require_export(),X=requireFails(),ee=requireToObject(),ne=requireToPrimitive(),te=X(function(){return new Date(NaN).toJSON()!==null||Date.prototype.toJSON.call({toISOString:function(){return 1}})!==1});return Y({target:"Date",proto:!0,arity:1,forced:te},{toJSON:function(se){var ie=ee(this),t=ne(ie,"number");return typeof t=="number"&&!isFinite(t)?null:ie.toISOString()}}),es_date_toJson}var es_date_toPrimitive={},dateToPrimitive,hasRequiredDateToPrimitive;function requireDateToPrimitive(){if(hasRequiredDateToPrimitive)return dateToPrimitive;hasRequiredDateToPrimitive=1;var Y=requireAnObject(),X=requireOrdinaryToPrimitive(),ee=TypeError;return dateToPrimitive=function(ne){if(Y(this),ne==="string"||ne==="default")ne="string";else if(ne!=="number")throw new ee("Incorrect hint");return X(this,ne)},dateToPrimitive}var hasRequiredEs_date_toPrimitive;function requireEs_date_toPrimitive(){if(hasRequiredEs_date_toPrimitive)return es_date_toPrimitive;hasRequiredEs_date_toPrimitive=1;var Y=requireHasOwnProperty(),X=requireDefineBuiltIn(),ee=requireDateToPrimitive(),ne=requireWellKnownSymbol(),te=ne("toPrimitive"),ue=Date.prototype;return Y(ue,te)||X(ue,te,ee),es_date_toPrimitive}var es_date_toString={},hasRequiredEs_date_toString;function requireEs_date_toString(){if(hasRequiredEs_date_toString)return es_date_toString;hasRequiredEs_date_toString=1;var Y=requireFunctionUncurryThis(),X=requireDefineBuiltIn(),ee=Date.prototype,ne="Invalid Date",te="toString",ue=Y(ee[te]),se=Y(ee.getTime);return String(new Date(NaN))!==ne&&X(ee,te,function(){var t=se(this);return t===t?ue(this):ne}),es_date_toString}var es_disposableStack_constructor={},addDisposableResource,hasRequiredAddDisposableResource;function requireAddDisposableResource(){if(hasRequiredAddDisposableResource)return addDisposableResource;hasRequiredAddDisposableResource=1;var Y=requireGetBuiltIn(),X=requireFunctionCall(),ee=requireFunctionUncurryThis(),ne=requireFunctionBindContext(),te=requireAnObject(),ue=requireACallable(),se=requireIsNullOrUndefined(),ie=requireGetMethod(),t=requireWellKnownSymbol(),H=t("asyncDispose"),ae=t("dispose"),he=ee([].push),_e=function(xe,Re){if(Re==="async-dispose"){var De=ie(xe,H);return De!==void 0||(De=ie(xe,ae),De===void 0)?De:function(){var Ie=this,Ce=Y("Promise");return new Ce(function(Ue){X(De,Ie),Ue(void 0)})}}return ie(xe,ae)},ge=function(xe,Re,De){return arguments.length<3&&!se(xe)&&(De=ue(_e(te(xe),Re))),De===void 0?function(){}:ne(De,xe)};return addDisposableResource=function(xe,Re,De,Ie){var Ce;if(arguments.length<4){if(se(Re)&&De==="sync-dispose")return;Ce=ge(Re,De)}else Ce=ge(void 0,De,Ie);he(xe.stack,Ce)},addDisposableResource}var hasRequiredEs_disposableStack_constructor;function requireEs_disposableStack_constructor(){if(hasRequiredEs_disposableStack_constructor)return es_disposableStack_constructor;hasRequiredEs_disposableStack_constructor=1;var Y=require_export(),X=requireDescriptors(),ee=requireGetBuiltIn(),ne=requireACallable(),te=requireAnInstance(),ue=requireDefineBuiltIn(),se=requireDefineBuiltIns(),ie=requireDefineBuiltInAccessor(),t=requireWellKnownSymbol(),H=requireInternalState(),ae=requireAddDisposableResource(),he=ee("SuppressedError"),_e=ReferenceError,ge=t("dispose"),xe=t("toStringTag"),Re="DisposableStack",De=H.set,Ie=H.getterFor(Re),Ce="sync-dispose",Ue="disposed",Le="pending",ke=function(We){var et=Ie(We);if(et.state===Ue)throw new _e(Re+" already disposed");return et},Ge=function(){De(te(this,Ze),{type:Re,state:Le,stack:[]}),X||(this.disposed=!1)},Ze=Ge.prototype;return se(Ze,{dispose:function(){var et=Ie(this);if(et.state!==Ue){et.state=Ue,X||(this.disposed=!0);for(var He=et.stack,ht=He.length,_t=!1,ut;ht;){var yt=He[--ht];He[ht]=null;try{yt()}catch(Lt){_t?ut=new he(Lt,ut):(_t=!0,ut=Lt)}}if(et.stack=null,_t)throw ut}},use:function(et){return ae(ke(this),et,Ce),et},adopt:function(et,He){var ht=ke(this);return ne(He),ae(ht,void 0,Ce,function(){He(et)}),et},defer:function(et){var He=ke(this);ne(et),ae(He,void 0,Ce,et)},move:function(){var et=ke(this),He=new Ge;return Ie(He).stack=et.stack,et.stack=[],et.state=Ue,X||(this.disposed=!0),He}}),X&&ie(Ze,"disposed",{configurable:!0,get:function(){return Ie(this).state===Ue}}),ue(Ze,ge,Ze.dispose,{name:"dispose"}),ue(Ze,xe,Re,{nonWritable:!0}),Y({global:!0,constructor:!0},{DisposableStack:Ge}),es_disposableStack_constructor}var es_escape={},hasRequiredEs_escape;function requireEs_escape(){if(hasRequiredEs_escape)return es_escape;hasRequiredEs_escape=1;var Y=require_export(),X=requireFunctionUncurryThis(),ee=requireToString$1(),ne=X("".charAt),te=X("".charCodeAt),ue=X(/./.exec),se=X(1.1.toString),ie=X("".toUpperCase),t=/[\w*+\-./@]/,H=function(ae,he){for(var _e=se(ae,16);_e.length<he;)_e="0"+_e;return _e};return Y({global:!0},{escape:function(he){for(var _e=ee(he),ge="",xe=_e.length,Re=0,De,Ie;Re<xe;)De=ne(_e,Re++),ue(t,De)?ge+=De:(Ie=te(De,0),Ie<256?ge+="%"+H(Ie,2):ge+="%u"+ie(H(Ie,4)));return ge}}),es_escape}var es_function_bind={},functionBind,hasRequiredFunctionBind;function requireFunctionBind(){if(hasRequiredFunctionBind)return functionBind;hasRequiredFunctionBind=1;var Y=requireFunctionUncurryThis(),X=requireACallable(),ee=requireIsObject$1(),ne=requireHasOwnProperty(),te=requireArraySlice(),ue=requireFunctionBindNative(),se=Function,ie=Y([].concat),t=Y([].join),H={},ae=function(he,_e,ge){if(!ne(H,_e)){for(var xe=[],Re=0;Re<_e;Re++)xe[Re]="a["+Re+"]";H[_e]=se("C,a","return new C("+t(xe,",")+")")}return H[_e](he,ge)};return functionBind=ue?se.bind:function(_e){var ge=X(this),xe=ge.prototype,Re=te(arguments,1),De=function(){var Ce=ie(Re,te(arguments));return this instanceof De?ae(ge,Ce.length,Ce):ge.apply(_e,Ce)};return ee(xe)&&(De.prototype=xe),De},functionBind}var hasRequiredEs_function_bind;function requireEs_function_bind(){if(hasRequiredEs_function_bind)return es_function_bind;hasRequiredEs_function_bind=1;var Y=require_export(),X=requireFunctionBind();return Y({target:"Function",proto:!0,forced:Function.bind!==X},{bind:X}),es_function_bind}var es_function_hasInstance={},hasRequiredEs_function_hasInstance;function requireEs_function_hasInstance(){if(hasRequiredEs_function_hasInstance)return es_function_hasInstance;hasRequiredEs_function_hasInstance=1;var Y=requireIsCallable(),X=requireIsObject$1(),ee=requireObjectDefineProperty(),ne=requireObjectIsPrototypeOf(),te=requireWellKnownSymbol(),ue=requireMakeBuiltIn(),se=te("hasInstance"),ie=Function.prototype;return se in ie||ee.f(ie,se,{value:ue(function(t){if(!Y(this)||!X(t))return!1;var H=this.prototype;return X(H)?ne(H,t):t instanceof this},se)}),es_function_hasInstance}var es_function_name={},hasRequiredEs_function_name;function requireEs_function_name(){if(hasRequiredEs_function_name)return es_function_name;hasRequiredEs_function_name=1;var Y=requireDescriptors(),X=requireFunctionName().EXISTS,ee=requireFunctionUncurryThis(),ne=requireDefineBuiltInAccessor(),te=Function.prototype,ue=ee(te.toString),se=/function\b(?:\s|\/\*[\S\s]*?\*\/|\/\/[^\n\r]*[\n\r]+)*([^\s(/]*)/,ie=ee(se.exec),t="name";return Y&&!X&&ne(te,t,{configurable:!0,get:function(){try{return ie(se,ue(this))[1]}catch{return""}}}),es_function_name}var es_globalThis={},hasRequiredEs_globalThis;function requireEs_globalThis(){if(hasRequiredEs_globalThis)return es_globalThis;hasRequiredEs_globalThis=1;var Y=require_export(),X=requireGlobalThis();return Y({global:!0,forced:X.globalThis!==X},{globalThis:X}),es_globalThis}var es_iterator_constructor={},hasRequiredEs_iterator_constructor;function requireEs_iterator_constructor(){if(hasRequiredEs_iterator_constructor)return es_iterator_constructor;hasRequiredEs_iterator_constructor=1;var Y=require_export(),X=requireGlobalThis(),ee=requireAnInstance(),ne=requireAnObject(),te=requireIsCallable(),ue=requireObjectGetPrototypeOf(),se=requireDefineBuiltInAccessor(),ie=requireCreateProperty(),t=requireFails(),H=requireHasOwnProperty(),ae=requireWellKnownSymbol(),he=requireIteratorsCore().IteratorPrototype,_e=requireDescriptors(),ge=requireIsPure(),xe="constructor",Re="Iterator",De=ae("toStringTag"),Ie=TypeError,Ce=X[Re],Ue=ge||!te(Ce)||Ce.prototype!==he||!t(function(){Ce({})}),Le=function(){if(ee(this,he),ue(this)===he)throw new Ie("Abstract class Iterator not directly constructable")},ke=function(Ge,Ze){_e?se(he,Ge,{configurable:!0,get:function(){return Ze},set:function(We){if(ne(this),this===he)throw new Ie("You can't redefine this property");H(this,Ge)?this[Ge]=We:ie(this,Ge,We)}}):he[Ge]=Ze};return H(he,De)||ke(De,Re),(Ue||!H(he,xe)||he[xe]===Object)&&ke(xe,Le),Le.prototype=he,Y({global:!0,constructor:!0,forced:Ue},{Iterator:Le}),es_iterator_constructor}var es_iterator_dispose={},hasRequiredEs_iterator_dispose;function requireEs_iterator_dispose(){if(hasRequiredEs_iterator_dispose)return es_iterator_dispose;hasRequiredEs_iterator_dispose=1;var Y=requireFunctionCall(),X=requireDefineBuiltIn(),ee=requireGetMethod(),ne=requireHasOwnProperty(),te=requireWellKnownSymbol(),ue=requireIteratorsCore().IteratorPrototype,se=te("dispose");return ne(ue,se)||X(ue,se,function(){var ie=ee(this,"return");ie&&Y(ie,this)}),es_iterator_dispose}var es_iterator_drop={},getIteratorDirect,hasRequiredGetIteratorDirect;function requireGetIteratorDirect(){return hasRequiredGetIteratorDirect||(hasRequiredGetIteratorDirect=1,getIteratorDirect=function(Y){return{iterator:Y,next:Y.next,done:!1}}),getIteratorDirect}var notANan,hasRequiredNotANan;function requireNotANan(){if(hasRequiredNotANan)return notANan;hasRequiredNotANan=1;var Y=RangeError;return notANan=function(X){if(X===X)return X;throw new Y("NaN is not allowed")},notANan}var toPositiveInteger,hasRequiredToPositiveInteger;function requireToPositiveInteger(){if(hasRequiredToPositiveInteger)return toPositiveInteger;hasRequiredToPositiveInteger=1;var Y=requireToIntegerOrInfinity(),X=RangeError;return toPositiveInteger=function(ee){var ne=Y(ee);if(ne<0)throw new X("The argument can't be less than 0");return ne},toPositiveInteger}var iteratorCloseAll,hasRequiredIteratorCloseAll;function requireIteratorCloseAll(){if(hasRequiredIteratorCloseAll)return iteratorCloseAll;hasRequiredIteratorCloseAll=1;var Y=requireIteratorClose();return iteratorCloseAll=function(X,ee,ne){for(var te=X.length-1;te>=0;te--)if(X[te]!==void 0)try{ne=Y(X[te].iterator,ee,ne)}catch(ue){ee="throw",ne=ue}if(ee==="throw")throw ne;return ne},iteratorCloseAll}var iteratorCreateProxy,hasRequiredIteratorCreateProxy;function requireIteratorCreateProxy(){if(hasRequiredIteratorCreateProxy)return iteratorCreateProxy;hasRequiredIteratorCreateProxy=1;var Y=requireFunctionCall(),X=requireObjectCreate(),ee=requireCreateNonEnumerableProperty(),ne=requireDefineBuiltIns(),te=requireWellKnownSymbol(),ue=requireInternalState(),se=requireGetMethod(),ie=requireIteratorsCore().IteratorPrototype,t=requireCreateIterResultObject(),H=requireIteratorClose(),ae=requireIteratorCloseAll(),he=te("toStringTag"),_e="IteratorHelper",ge="WrapForValidIterator",xe="normal",Re="throw",De=ue.set,Ie=function(Le){var ke=ue.getterFor(Le?ge:_e);return ne(X(ie),{next:function(){var Ze=ke(this);if(Le)return Ze.nextHandler();if(Ze.done)return t(void 0,!0);try{var We=Ze.nextHandler();return Ze.returnHandlerResult?We:t(We,Ze.done)}catch(et){throw Ze.done=!0,et}},return:function(){var Ge=ke(this),Ze=Ge.iterator;if(Ge.done=!0,Le){var We=se(Ze,"return");return We?Y(We,Ze):t(void 0,!0)}if(Ge.inner)try{H(Ge.inner.iterator,xe)}catch(et){return H(Ze,Re,et)}if(Ge.openIters)try{ae(Ge.openIters,xe)}catch(et){return H(Ze,Re,et)}return Ze&&H(Ze,xe),t(void 0,!0)}})},Ce=Ie(!0),Ue=Ie(!1);return ee(Ue,he,"Iterator Helper"),iteratorCreateProxy=function(Le,ke,Ge){var Ze=function(et,He){He?(He.iterator=et.iterator,He.next=et.next):He=et,He.type=ke?ge:_e,He.returnHandlerResult=!!Ge,He.nextHandler=Le,He.counter=0,He.done=!1,De(this,He)};return Ze.prototype=ke?Ce:Ue,Ze},iteratorCreateProxy}var iteratorHelperThrowsOnInvalidIterator,hasRequiredIteratorHelperThrowsOnInvalidIterator;function requireIteratorHelperThrowsOnInvalidIterator(){return hasRequiredIteratorHelperThrowsOnInvalidIterator||(hasRequiredIteratorHelperThrowsOnInvalidIterator=1,iteratorHelperThrowsOnInvalidIterator=function(Y,X){var ee=typeof Iterator=="function"&&Iterator.prototype[Y];if(ee)try{ee.call({next:null},X).next()}catch{return!0}}),iteratorHelperThrowsOnInvalidIterator}var iteratorHelperWithoutClosingOnEarlyError,hasRequiredIteratorHelperWithoutClosingOnEarlyError;function requireIteratorHelperWithoutClosingOnEarlyError(){if(hasRequiredIteratorHelperWithoutClosingOnEarlyError)return iteratorHelperWithoutClosingOnEarlyError;hasRequiredIteratorHelperWithoutClosingOnEarlyError=1;var Y=requireGlobalThis();return iteratorHelperWithoutClosingOnEarlyError=function(X,ee){var ne=Y.Iterator,te=ne&&ne.prototype,ue=te&&te[X],se=!1;if(ue)try{ue.call({next:function(){return{done:!0}},return:function(){se=!0}},-1)}catch(ie){ie instanceof ee||(se=!1)}if(!se)return ue},iteratorHelperWithoutClosingOnEarlyError}var hasRequiredEs_iterator_drop;function requireEs_iterator_drop(){if(hasRequiredEs_iterator_drop)return es_iterator_drop;hasRequiredEs_iterator_drop=1;var Y=require_export(),X=requireFunctionCall(),ee=requireAnObject(),ne=requireGetIteratorDirect(),te=requireNotANan(),ue=requireToPositiveInteger(),se=requireIteratorClose(),ie=requireIteratorCreateProxy(),t=requireIteratorHelperThrowsOnInvalidIterator(),H=requireIteratorHelperWithoutClosingOnEarlyError(),ae=requireIsPure(),he=!ae&&!t("drop",0),_e=!ae&&!he&&H("drop",RangeError),ge=ae||he||_e,xe=ie(function(){for(var Re=this.iterator,De=this.next,Ie,Ce;this.remaining;)if(this.remaining--,Ie=ee(X(De,Re)),Ce=this.done=!!Ie.done,Ce)return;if(Ie=ee(X(De,Re)),Ce=this.done=!!Ie.done,!Ce)return Ie.value});return Y({target:"Iterator",proto:!0,real:!0,forced:ge},{drop:function(De){ee(this);var Ie;try{Ie=ue(te(+De))}catch(Ce){se(this,"throw",Ce)}return _e?X(_e,this,Ie):new xe(ne(this),{remaining:Ie})}}),es_iterator_drop}var es_iterator_every={},hasRequiredEs_iterator_every;function requireEs_iterator_every(){if(hasRequiredEs_iterator_every)return es_iterator_every;hasRequiredEs_iterator_every=1;var Y=require_export(),X=requireFunctionCall(),ee=requireIterate(),ne=requireACallable(),te=requireAnObject(),ue=requireGetIteratorDirect(),se=requireIteratorClose(),ie=requireIteratorHelperWithoutClosingOnEarlyError(),t=ie("every",TypeError);return Y({target:"Iterator",proto:!0,real:!0,forced:t},{every:function(ae){te(this);try{ne(ae)}catch(ge){se(this,"throw",ge)}if(t)return X(t,this,ae);var he=ue(this),_e=0;return!ee(he,function(ge,xe){if(!ae(ge,_e++))return xe()},{IS_RECORD:!0,INTERRUPTED:!0}).stopped}}),es_iterator_every}var es_iterator_filter={},hasRequiredEs_iterator_filter;function requireEs_iterator_filter(){if(hasRequiredEs_iterator_filter)return es_iterator_filter;hasRequiredEs_iterator_filter=1;var Y=require_export(),X=requireFunctionCall(),ee=requireACallable(),ne=requireAnObject(),te=requireGetIteratorDirect(),ue=requireIteratorCreateProxy(),se=requireCallWithSafeIterationClosing(),ie=requireIsPure(),t=requireIteratorClose(),H=requireIteratorHelperThrowsOnInvalidIterator(),ae=requireIteratorHelperWithoutClosingOnEarlyError(),he=!ie&&!H("filter",function(){}),_e=!ie&&!he&&ae("filter",TypeError),ge=ie||he||_e,xe=ue(function(){for(var Re=this.iterator,De=this.predicate,Ie=this.next,Ce,Ue,Le;;){if(Ce=ne(X(Ie,Re)),Ue=this.done=!!Ce.done,Ue)return;if(Le=Ce.value,se(Re,De,[Le,this.counter++],!0))return Le}});return Y({target:"Iterator",proto:!0,real:!0,forced:ge},{filter:function(De){ne(this);try{ee(De)}catch(Ie){t(this,"throw",Ie)}return _e?X(_e,this,De):new xe(te(this),{predicate:De})}}),es_iterator_filter}var es_iterator_find={},hasRequiredEs_iterator_find;function requireEs_iterator_find(){if(hasRequiredEs_iterator_find)return es_iterator_find;hasRequiredEs_iterator_find=1;var Y=require_export(),X=requireFunctionCall(),ee=requireIterate(),ne=requireACallable(),te=requireAnObject(),ue=requireGetIteratorDirect(),se=requireIteratorClose(),ie=requireIteratorHelperWithoutClosingOnEarlyError(),t=ie("find",TypeError);return Y({target:"Iterator",proto:!0,real:!0,forced:t},{find:function(ae){te(this);try{ne(ae)}catch(ge){se(this,"throw",ge)}if(t)return X(t,this,ae);var he=ue(this),_e=0;return ee(he,function(ge,xe){if(ae(ge,_e++))return xe(ge)},{IS_RECORD:!0,INTERRUPTED:!0}).result}}),es_iterator_find}var es_iterator_flatMap={},getIteratorFlattenable,hasRequiredGetIteratorFlattenable;function requireGetIteratorFlattenable(){if(hasRequiredGetIteratorFlattenable)return getIteratorFlattenable;hasRequiredGetIteratorFlattenable=1;var Y=requireFunctionCall(),X=requireAnObject(),ee=requireGetIteratorDirect(),ne=requireGetIteratorMethod();return getIteratorFlattenable=function(te,ue){(!ue||typeof te!="string")&&X(te);var se=ne(te);return ee(X(se!==void 0?Y(se,te):te))},getIteratorFlattenable}var hasRequiredEs_iterator_flatMap;function requireEs_iterator_flatMap(){if(hasRequiredEs_iterator_flatMap)return es_iterator_flatMap;hasRequiredEs_iterator_flatMap=1;var Y=require_export(),X=requireFunctionCall(),ee=requireACallable(),ne=requireAnObject(),te=requireGetIteratorDirect(),ue=requireGetIteratorFlattenable(),se=requireIteratorCreateProxy(),ie=requireIteratorClose(),t=requireIsPure(),H=requireIteratorHelperThrowsOnInvalidIterator(),ae=requireIteratorHelperWithoutClosingOnEarlyError(),he=!t&&!H("flatMap",function(){}),_e=!t&&!he&&ae("flatMap",TypeError),ge=t||he||_e,xe=se(function(){for(var Re=this.iterator,De=this.mapper,Ie,Ce;;){if(Ce=this.inner)try{if(Ie=ne(X(Ce.next,Ce.iterator)),!Ie.done)return Ie.value;this.inner=null}catch(Ue){ie(Re,"throw",Ue)}if(Ie=ne(X(this.next,Re)),this.done=!!Ie.done)return;try{this.inner=ue(De(Ie.value,this.counter++),!1)}catch(Ue){ie(Re,"throw",Ue)}}});return Y({target:"Iterator",proto:!0,real:!0,forced:ge},{flatMap:function(De){ne(this);try{ee(De)}catch(Ie){ie(this,"throw",Ie)}return _e?X(_e,this,De):new xe(te(this),{mapper:De,inner:null})}}),es_iterator_flatMap}var es_iterator_forEach={},hasRequiredEs_iterator_forEach;function requireEs_iterator_forEach(){if(hasRequiredEs_iterator_forEach)return es_iterator_forEach;hasRequiredEs_iterator_forEach=1;var Y=require_export(),X=requireFunctionCall(),ee=requireIterate(),ne=requireACallable(),te=requireAnObject(),ue=requireGetIteratorDirect(),se=requireIteratorClose(),ie=requireIteratorHelperWithoutClosingOnEarlyError(),t=ie("forEach",TypeError);return Y({target:"Iterator",proto:!0,real:!0,forced:t},{forEach:function(ae){te(this);try{ne(ae)}catch(ge){se(this,"throw",ge)}if(t)return X(t,this,ae);var he=ue(this),_e=0;ee(he,function(ge){ae(ge,_e++)},{IS_RECORD:!0})}}),es_iterator_forEach}var es_iterator_from={},hasRequiredEs_iterator_from;function requireEs_iterator_from(){if(hasRequiredEs_iterator_from)return es_iterator_from;hasRequiredEs_iterator_from=1;var Y=require_export(),X=requireFunctionCall(),ee=requireToObject(),ne=requireObjectIsPrototypeOf(),te=requireIteratorsCore().IteratorPrototype,ue=requireIteratorCreateProxy(),se=requireGetIteratorFlattenable(),ie=requireIsPure(),t=ie||function(){try{Iterator.from({return:null}).return()}catch{return!0}}(),H=ue(function(){return X(this.next,this.iterator)},!0);return Y({target:"Iterator",stat:!0,forced:t},{from:function(he){var _e=se(typeof he=="string"?ee(he):he,!0);return ne(te,_e.iterator)?_e.iterator:new H(_e)}}),es_iterator_from}var es_iterator_map={},hasRequiredEs_iterator_map;function requireEs_iterator_map(){if(hasRequiredEs_iterator_map)return es_iterator_map;hasRequiredEs_iterator_map=1;var Y=require_export(),X=requireFunctionCall(),ee=requireACallable(),ne=requireAnObject(),te=requireGetIteratorDirect(),ue=requireIteratorCreateProxy(),se=requireCallWithSafeIterationClosing(),ie=requireIteratorClose(),t=requireIteratorHelperThrowsOnInvalidIterator(),H=requireIteratorHelperWithoutClosingOnEarlyError(),ae=requireIsPure(),he=!ae&&!t("map",function(){}),_e=!ae&&!he&&H("map",TypeError),ge=ae||he||_e,xe=ue(function(){var Re=this.iterator,De=ne(X(this.next,Re)),Ie=this.done=!!De.done;if(!Ie)return se(Re,this.mapper,[De.value,this.counter++],!0)});return Y({target:"Iterator",proto:!0,real:!0,forced:ge},{map:function(De){ne(this);try{ee(De)}catch(Ie){ie(this,"throw",Ie)}return _e?X(_e,this,De):new xe(te(this),{mapper:De})}}),es_iterator_map}var es_iterator_reduce={},hasRequiredEs_iterator_reduce;function requireEs_iterator_reduce(){if(hasRequiredEs_iterator_reduce)return es_iterator_reduce;hasRequiredEs_iterator_reduce=1;var Y=require_export(),X=requireIterate(),ee=requireACallable(),ne=requireAnObject(),te=requireGetIteratorDirect(),ue=requireIteratorClose(),se=requireIteratorHelperWithoutClosingOnEarlyError(),ie=requireFunctionApply(),t=requireFails(),H=TypeError,ae=t(function(){[].keys().reduce(function(){},void 0)}),he=!ae&&se("reduce",H);return Y({target:"Iterator",proto:!0,real:!0,forced:ae||he},{reduce:function(ge){ne(this);try{ee(ge)}catch(Ce){ue(this,"throw",Ce)}var xe=arguments.length<2,Re=xe?void 0:arguments[1];if(he)return ie(he,this,xe?[ge]:[ge,Re]);var De=te(this),Ie=0;if(X(De,function(Ce){xe?(xe=!1,Re=Ce):Re=ge(Re,Ce,Ie),Ie++},{IS_RECORD:!0}),xe)throw new H("Reduce of empty iterator with no initial value");return Re}}),es_iterator_reduce}var es_iterator_some={},hasRequiredEs_iterator_some;function requireEs_iterator_some(){if(hasRequiredEs_iterator_some)return es_iterator_some;hasRequiredEs_iterator_some=1;var Y=require_export(),X=requireFunctionCall(),ee=requireIterate(),ne=requireACallable(),te=requireAnObject(),ue=requireGetIteratorDirect(),se=requireIteratorClose(),ie=requireIteratorHelperWithoutClosingOnEarlyError(),t=ie("some",TypeError);return Y({target:"Iterator",proto:!0,real:!0,forced:t},{some:function(ae){te(this);try{ne(ae)}catch(ge){se(this,"throw",ge)}if(t)return X(t,this,ae);var he=ue(this),_e=0;return ee(he,function(ge,xe){if(ae(ge,_e++))return xe()},{IS_RECORD:!0,INTERRUPTED:!0}).stopped}}),es_iterator_some}var es_iterator_take={},hasRequiredEs_iterator_take;function requireEs_iterator_take(){if(hasRequiredEs_iterator_take)return es_iterator_take;hasRequiredEs_iterator_take=1;var Y=require_export(),X=requireFunctionCall(),ee=requireAnObject(),ne=requireGetIteratorDirect(),te=requireNotANan(),ue=requireToPositiveInteger(),se=requireIteratorCreateProxy(),ie=requireIteratorClose(),t=requireIteratorHelperWithoutClosingOnEarlyError(),H=requireIsPure(),ae=!H&&t("take",RangeError),he=se(function(){var _e=this.iterator;if(!this.remaining--)return this.done=!0,ie(_e,"normal",void 0);var ge=ee(X(this.next,_e)),xe=this.done=!!ge.done;if(!xe)return ge.value});return Y({target:"Iterator",proto:!0,real:!0,forced:H||ae},{take:function(ge){ee(this);var xe;try{xe=ue(te(+ge))}catch(Re){ie(this,"throw",Re)}return ae?X(ae,this,xe):new he(ne(this),{remaining:xe})}}),es_iterator_take}var es_iterator_toArray={},hasRequiredEs_iterator_toArray;function requireEs_iterator_toArray(){if(hasRequiredEs_iterator_toArray)return es_iterator_toArray;hasRequiredEs_iterator_toArray=1;var Y=require_export(),X=requireAnObject(),ee=requireIterate(),ne=requireGetIteratorDirect(),te=[].push;return Y({target:"Iterator",proto:!0,real:!0},{toArray:function(){var se=[];return ee(ne(X(this)),te,{that:se,IS_RECORD:!0}),se}}),es_iterator_toArray}var es_json_toStringTag={},hasRequiredEs_json_toStringTag;function requireEs_json_toStringTag(){if(hasRequiredEs_json_toStringTag)return es_json_toStringTag;hasRequiredEs_json_toStringTag=1;var Y=requireGlobalThis(),X=requireSetToStringTag();return X(Y.JSON,"JSON",!0),es_json_toStringTag}var es_map={},es_map_constructor={},internalMetadata={exports:{}},arrayBufferNonExtensible,hasRequiredArrayBufferNonExtensible;function requireArrayBufferNonExtensible(){if(hasRequiredArrayBufferNonExtensible)return arrayBufferNonExtensible;hasRequiredArrayBufferNonExtensible=1;var Y=requireFails();return arrayBufferNonExtensible=Y(function(){if(typeof ArrayBuffer=="function"){var X=new ArrayBuffer(8);Object.isExtensible(X)&&Object.defineProperty(X,"a",{value:8})}}),arrayBufferNonExtensible}var objectIsExtensible,hasRequiredObjectIsExtensible;function requireObjectIsExtensible(){if(hasRequiredObjectIsExtensible)return objectIsExtensible;hasRequiredObjectIsExtensible=1;var Y=requireFails(),X=requireIsObject$1(),ee=requireClassofRaw(),ne=requireArrayBufferNonExtensible(),te=Object.isExtensible,ue=Y(function(){});return objectIsExtensible=ue||ne?function(ie){return!X(ie)||ne&&ee(ie)==="ArrayBuffer"?!1:te?te(ie):!0}:te,objectIsExtensible}var freezing,hasRequiredFreezing;function requireFreezing(){if(hasRequiredFreezing)return freezing;hasRequiredFreezing=1;var Y=requireFails();return freezing=!Y(function(){return Object.isExtensible(Object.preventExtensions({}))}),freezing}var hasRequiredInternalMetadata;function requireInternalMetadata(){if(hasRequiredInternalMetadata)return internalMetadata.exports;hasRequiredInternalMetadata=1;var Y=require_export(),X=requireFunctionUncurryThis(),ee=requireHiddenKeys(),ne=requireIsObject$1(),te=requireHasOwnProperty(),ue=requireObjectDefineProperty().f,se=requireObjectGetOwnPropertyNames(),ie=requireObjectGetOwnPropertyNamesExternal(),t=requireObjectIsExtensible(),H=requireUid(),ae=requireFreezing(),he=!1,_e=H("meta"),ge=0,xe=function(Le){ue(Le,_e,{value:{objectID:"O"+ge++,weakData:{}}})},Re=function(Le,ke){if(!ne(Le))return typeof Le=="symbol"?Le:(typeof Le=="string"?"S":"P")+Le;if(!te(Le,_e)){if(!t(Le))return"F";if(!ke)return"E";xe(Le)}return Le[_e].objectID},De=function(Le,ke){if(!te(Le,_e)){if(!t(Le))return!0;if(!ke)return!1;xe(Le)}return Le[_e].weakData},Ie=function(Le){return ae&&he&&t(Le)&&!te(Le,_e)&&xe(Le),Le},Ce=function(){Ue.enable=function(){},he=!0;var Le=se.f,ke=X([].splice),Ge={};Ge[_e]=1,Le(Ge).length&&(se.f=function(Ze){for(var We=Le(Ze),et=0,He=We.length;et<He;et++)if(We[et]===_e){ke(We,et,1);break}return We},Y({target:"Object",stat:!0,forced:!0},{getOwnPropertyNames:ie.f}))},Ue=internalMetadata.exports={enable:Ce,fastKey:Re,getWeakData:De,onFreeze:Ie};return ee[_e]=!0,internalMetadata.exports}var collection,hasRequiredCollection;function requireCollection(){if(hasRequiredCollection)return collection;hasRequiredCollection=1;var Y=require_export(),X=requireGlobalThis(),ee=requireFunctionUncurryThis(),ne=requireIsForced(),te=requireDefineBuiltIn(),ue=requireInternalMetadata(),se=requireIterate(),ie=requireAnInstance(),t=requireIsCallable(),H=requireIsNullOrUndefined(),ae=requireIsObject$1(),he=requireFails(),_e=requireCheckCorrectnessOfIteration(),ge=requireSetToStringTag(),xe=requireInheritIfRequired();return collection=function(Re,De,Ie){var Ce=Re.indexOf("Map")!==-1,Ue=Re.indexOf("Weak")!==-1,Le=Ce?"set":"add",ke=X[Re],Ge=ke&&ke.prototype,Ze=ke,We={},et=function(Kt){var ft=ee(Ge[Kt]);te(Ge,Kt,Kt==="add"?function(nt){return ft(this,nt===0?0:nt),this}:Kt==="delete"?function(qt){return Ue&&!ae(qt)?!1:ft(this,qt===0?0:qt)}:Kt==="get"?function(nt){return Ue&&!ae(nt)?void 0:ft(this,nt===0?0:nt)}:Kt==="has"?function(nt){return Ue&&!ae(nt)?!1:ft(this,nt===0?0:nt)}:function(nt,At){return ft(this,nt===0?0:nt,At),this})},He=ne(Re,!t(ke)||!(Ue||Ge.forEach&&!he(function(){new ke().entries().next()})));if(He)Ze=Ie.getConstructor(De,Re,Ce,Le),ue.enable();else if(ne(Re,!0)){var ht=new Ze,_t=ht[Le](Ue?{}:-0,1)!==ht,ut=he(function(){ht.has(1)}),yt=_e(function(Kt){new ke(Kt)}),Lt=!Ue&&he(function(){for(var Kt=new ke,ft=5;ft--;)Kt[Le](ft,ft);return!Kt.has(-0)});yt||(Ze=De(function(Kt,ft){ie(Kt,Ge);var qt=xe(new ke,Kt,Ze);return H(ft)||se(ft,qt[Le],{that:qt,AS_ENTRIES:Ce}),qt}),Ze.prototype=Ge,Ge.constructor=Ze),(ut||Lt)&&(et("delete"),et("has"),Ce&&et("get")),(Lt||_t)&&et(Le),Ue&&Ge.clear&&delete Ge.clear}return We[Re]=Ze,Y({global:!0,constructor:!0,forced:Ze!==ke},We),ge(Ze,Re),Ue||Ie.setStrong(Ze,Re,Ce),Ze},collection}var collectionStrong,hasRequiredCollectionStrong;function requireCollectionStrong(){if(hasRequiredCollectionStrong)return collectionStrong;hasRequiredCollectionStrong=1;var Y=requireObjectCreate(),X=requireDefineBuiltInAccessor(),ee=requireDefineBuiltIns(),ne=requireFunctionBindContext(),te=requireAnInstance(),ue=requireIsNullOrUndefined(),se=requireIterate(),ie=requireIteratorDefine(),t=requireCreateIterResultObject(),H=requireSetSpecies(),ae=requireDescriptors(),he=requireInternalMetadata().fastKey,_e=requireInternalState(),ge=_e.set,xe=_e.getterFor;return collectionStrong={getConstructor:function(Re,De,Ie,Ce){var Ue=Re(function(We,et){te(We,Le),ge(We,{type:De,index:Y(null),first:null,last:null,size:0}),ae||(We.size=0),ue(et)||se(et,We[Ce],{that:We,AS_ENTRIES:Ie})}),Le=Ue.prototype,ke=xe(De),Ge=function(We,et,He){var ht=ke(We),_t=Ze(We,et),ut,yt;return _t?_t.value=He:(ht.last=_t={index:yt=he(et,!0),key:et,value:He,previous:ut=ht.last,next:null,removed:!1},ht.first||(ht.first=_t),ut&&(ut.next=_t),ae?ht.size++:We.size++,yt!=="F"&&(ht.index[yt]=_t)),We},Ze=function(We,et){var He=ke(We),ht=he(et),_t;if(ht!=="F")return He.index[ht];for(_t=He.first;_t;_t=_t.next)if(_t.key===et)return _t};return ee(Le,{clear:function(){for(var et=this,He=ke(et),ht=He.first;ht;)ht.removed=!0,ht.previous&&(ht.previous=ht.previous.next=null),ht=ht.next;He.first=He.last=null,He.index=Y(null),ae?He.size=0:et.size=0},delete:function(We){var et=this,He=ke(et),ht=Ze(et,We);if(ht){var _t=ht.next,ut=ht.previous;delete He.index[ht.index],ht.removed=!0,ut&&(ut.next=_t),_t&&(_t.previous=ut),He.first===ht&&(He.first=_t),He.last===ht&&(He.last=ut),ae?He.size--:et.size--}return!!ht},forEach:function(et){for(var He=ke(this),ht=ne(et,arguments.length>1?arguments[1]:void 0),_t;_t=_t?_t.next:He.first;)for(ht(_t.value,_t.key,this);_t&&_t.removed;)_t=_t.previous},has:function(et){return!!Ze(this,et)}}),ee(Le,Ie?{get:function(et){var He=Ze(this,et);return He&&He.value},set:function(et,He){return Ge(this,et===0?0:et,He)}}:{add:function(et){return Ge(this,et=et===0?0:et,et)}}),ae&&X(Le,"size",{configurable:!0,get:function(){return ke(this).size}}),Ue},setStrong:function(Re,De,Ie){var Ce=De+" Iterator",Ue=xe(De),Le=xe(Ce);ie(Re,De,function(ke,Ge){ge(this,{type:Ce,target:ke,state:Ue(ke),kind:Ge,last:null})},function(){for(var ke=Le(this),Ge=ke.kind,Ze=ke.last;Ze&&Ze.removed;)Ze=Ze.previous;return!ke.target||!(ke.last=Ze=Ze?Ze.next:ke.state.first)?(ke.target=null,t(void 0,!0)):t(Ge==="keys"?Ze.key:Ge==="values"?Ze.value:[Ze.key,Ze.value],!1)},Ie?"entries":"values",!Ie,!0),H(De)}},collectionStrong}var hasRequiredEs_map_constructor;function requireEs_map_constructor(){if(hasRequiredEs_map_constructor)return es_map_constructor;hasRequiredEs_map_constructor=1;var Y=requireCollection(),X=requireCollectionStrong();return Y("Map",function(ee){return function(){return ee(this,arguments.length?arguments[0]:void 0)}},X),es_map_constructor}var hasRequiredEs_map;function requireEs_map(){return hasRequiredEs_map||(hasRequiredEs_map=1,requireEs_map_constructor()),es_map}var es_map_groupBy={},mapHelpers,hasRequiredMapHelpers;function requireMapHelpers(){if(hasRequiredMapHelpers)return mapHelpers;hasRequiredMapHelpers=1;var Y=requireFunctionUncurryThis(),X=Map.prototype;return mapHelpers={Map,set:Y(X.set),get:Y(X.get),has:Y(X.has),remove:Y(X.delete),proto:X},mapHelpers}var hasRequiredEs_map_groupBy;function requireEs_map_groupBy(){if(hasRequiredEs_map_groupBy)return es_map_groupBy;hasRequiredEs_map_groupBy=1;var Y=require_export(),X=requireFunctionUncurryThis(),ee=requireACallable(),ne=requireRequireObjectCoercible(),te=requireIterate(),ue=requireMapHelpers(),se=requireIsPure(),ie=requireFails(),t=ue.Map,H=ue.has,ae=ue.get,he=ue.set,_e=X([].push),ge=se||ie(function(){return t.groupBy("ab",function(xe){return xe}).get("a").length!==1});return Y({target:"Map",stat:!0,forced:se||ge},{groupBy:function(Re,De){ne(Re),ee(De);var Ie=new t,Ce=0;return te(Re,function(Ue){var Le=De(Ue,Ce++);H(Ie,Le)?_e(ae(Ie,Le),Ue):he(Ie,Le,[Ue])}),Ie}}),es_map_groupBy}var es_math_acosh={},mathLog1p,hasRequiredMathLog1p;function requireMathLog1p(){if(hasRequiredMathLog1p)return mathLog1p;hasRequiredMathLog1p=1;var Y=Math.log;return mathLog1p=Math.log1p||function(ee){var ne=+ee;return ne>-1e-8&&ne<1e-8?ne-ne*ne/2:Y(1+ne)},mathLog1p}var hasRequiredEs_math_acosh;function requireEs_math_acosh(){if(hasRequiredEs_math_acosh)return es_math_acosh;hasRequiredEs_math_acosh=1;var Y=require_export(),X=requireMathLog1p(),ee=Math.acosh,ne=Math.log,te=Math.sqrt,ue=Math.LN2,se=!ee||Math.floor(ee(Number.MAX_VALUE))!==710||ee(1/0)!==1/0;return Y({target:"Math",stat:!0,forced:se},{acosh:function(t){var H=+t;return H<1?NaN:H>9490626562425156e-8?ne(H)+ue:X(H-1+te(H-1)*te(H+1))}}),es_math_acosh}var es_math_asinh={},hasRequiredEs_math_asinh;function requireEs_math_asinh(){if(hasRequiredEs_math_asinh)return es_math_asinh;hasRequiredEs_math_asinh=1;var Y=require_export(),X=Math.asinh,ee=Math.log,ne=Math.sqrt;function te(se){var ie=+se;return!isFinite(ie)||ie===0?ie:ie<0?-te(-ie):ee(ie+ne(ie*ie+1))}var ue=!(X&&1/X(0)>0);return Y({target:"Math",stat:!0,forced:ue},{asinh:te}),es_math_asinh}var es_math_atanh={},hasRequiredEs_math_atanh;function requireEs_math_atanh(){if(hasRequiredEs_math_atanh)return es_math_atanh;hasRequiredEs_math_atanh=1;var Y=require_export(),X=Math.atanh,ee=Math.log,ne=!(X&&1/X(-0)<0);return Y({target:"Math",stat:!0,forced:ne},{atanh:function(ue){var se=+ue;return se===0?se:ee((1+se)/(1-se))/2}}),es_math_atanh}var es_math_cbrt={},hasRequiredEs_math_cbrt;function requireEs_math_cbrt(){if(hasRequiredEs_math_cbrt)return es_math_cbrt;hasRequiredEs_math_cbrt=1;var Y=require_export(),X=requireMathSign(),ee=Math.abs,ne=Math.pow;return Y({target:"Math",stat:!0},{cbrt:function(ue){var se=+ue;return X(se)*ne(ee(se),1/3)}}),es_math_cbrt}var es_math_clz32={},hasRequiredEs_math_clz32;function requireEs_math_clz32(){if(hasRequiredEs_math_clz32)return es_math_clz32;hasRequiredEs_math_clz32=1;var Y=require_export(),X=Math.floor,ee=Math.log,ne=Math.LOG2E;return Y({target:"Math",stat:!0},{clz32:function(ue){var se=ue>>>0;return se?31-X(ee(se+.5)*ne):32}}),es_math_clz32}var es_math_cosh={},mathExpm1,hasRequiredMathExpm1;function requireMathExpm1(){if(hasRequiredMathExpm1)return mathExpm1;hasRequiredMathExpm1=1;var Y=Math.expm1,X=Math.exp;return mathExpm1=!Y||Y(10)>22025.465794806718||Y(10)<22025.465794806718||Y(-2e-17)!==-2e-17?function(ne){var te=+ne;return te===0?te:te>-1e-6&&te<1e-6?te+te*te/2:X(te)-1}:Y,mathExpm1}var hasRequiredEs_math_cosh;function requireEs_math_cosh(){if(hasRequiredEs_math_cosh)return es_math_cosh;hasRequiredEs_math_cosh=1;var Y=require_export(),X=requireMathExpm1(),ee=Math.cosh,ne=Math.abs,te=Math.E,ue=!ee||ee(710)===1/0;return Y({target:"Math",stat:!0,forced:ue},{cosh:function(ie){var t=X(ne(ie)-1)+1;return(t+1/(t*te*te))*(te/2)}}),es_math_cosh}var es_math_expm1={},hasRequiredEs_math_expm1;function requireEs_math_expm1(){if(hasRequiredEs_math_expm1)return es_math_expm1;hasRequiredEs_math_expm1=1;var Y=require_export(),X=requireMathExpm1();return Y({target:"Math",stat:!0,forced:X!==Math.expm1},{expm1:X}),es_math_expm1}var es_math_fround={},hasRequiredEs_math_fround;function requireEs_math_fround(){if(hasRequiredEs_math_fround)return es_math_fround;hasRequiredEs_math_fround=1;var Y=require_export(),X=requireMathFround();return Y({target:"Math",stat:!0},{fround:X}),es_math_fround}var es_math_f16round={},hasRequiredEs_math_f16round;function requireEs_math_f16round(){if(hasRequiredEs_math_f16round)return es_math_f16round;hasRequiredEs_math_f16round=1;var Y=require_export(),X=requireMathFloatRound(),ee=.0009765625,ne=65504,te=6103515625e-14;return Y({target:"Math",stat:!0},{f16round:function(se){return X(se,ee,ne,te)}}),es_math_f16round}var es_math_hypot={},hasRequiredEs_math_hypot;function requireEs_math_hypot(){if(hasRequiredEs_math_hypot)return es_math_hypot;hasRequiredEs_math_hypot=1;var Y=require_export(),X=Math.hypot,ee=Math.abs,ne=Math.sqrt,te=!!X&&X(1/0,NaN)!==1/0;return Y({target:"Math",stat:!0,arity:2,forced:te},{hypot:function(se,ie){for(var t=0,H=0,ae=arguments.length,he=0,_e,ge;H<ae;)_e=ee(arguments[H++]),he<_e?(ge=he/_e,t=t*ge*ge+1,he=_e):_e>0?(ge=_e/he,t+=ge*ge):t+=_e;return he===1/0?1/0:he*ne(t)}}),es_math_hypot}var es_math_imul={},hasRequiredEs_math_imul;function requireEs_math_imul(){if(hasRequiredEs_math_imul)return es_math_imul;hasRequiredEs_math_imul=1;var Y=require_export(),X=requireFails(),ee=Math.imul,ne=X(function(){return ee(4294967295,5)!==-5||ee.length!==2});return Y({target:"Math",stat:!0,forced:ne},{imul:function(ue,se){var ie=65535,t=+ue,H=+se,ae=ie&t,he=ie&H;return 0|ae*he+((ie&t>>>16)*he+ae*(ie&H>>>16)<<16>>>0)}}),es_math_imul}var es_math_log10={},mathLog10,hasRequiredMathLog10;function requireMathLog10(){if(hasRequiredMathLog10)return mathLog10;hasRequiredMathLog10=1;var Y=Math.log,X=Math.LOG10E;return mathLog10=Math.log10||function(ne){return Y(ne)*X},mathLog10}var hasRequiredEs_math_log10;function requireEs_math_log10(){if(hasRequiredEs_math_log10)return es_math_log10;hasRequiredEs_math_log10=1;var Y=require_export(),X=requireMathLog10();return Y({target:"Math",stat:!0},{log10:X}),es_math_log10}var es_math_log1p={},hasRequiredEs_math_log1p;function requireEs_math_log1p(){if(hasRequiredEs_math_log1p)return es_math_log1p;hasRequiredEs_math_log1p=1;var Y=require_export(),X=requireMathLog1p();return Y({target:"Math",stat:!0},{log1p:X}),es_math_log1p}var es_math_log2={},hasRequiredEs_math_log2;function requireEs_math_log2(){if(hasRequiredEs_math_log2)return es_math_log2;hasRequiredEs_math_log2=1;var Y=require_export(),X=requireMathLog2();return Y({target:"Math",stat:!0},{log2:X}),es_math_log2}var es_math_sign={},hasRequiredEs_math_sign;function requireEs_math_sign(){if(hasRequiredEs_math_sign)return es_math_sign;hasRequiredEs_math_sign=1;var Y=require_export(),X=requireMathSign();return Y({target:"Math",stat:!0},{sign:X}),es_math_sign}var es_math_sinh={},hasRequiredEs_math_sinh;function requireEs_math_sinh(){if(hasRequiredEs_math_sinh)return es_math_sinh;hasRequiredEs_math_sinh=1;var Y=require_export(),X=requireFails(),ee=requireMathExpm1(),ne=Math.abs,te=Math.exp,ue=Math.E,se=X(function(){return Math.sinh(-2e-17)!==-2e-17});return Y({target:"Math",stat:!0,forced:se},{sinh:function(t){var H=+t;return ne(H)<1?(ee(H)-ee(-H))/2:(te(H-1)-te(-H-1))*(ue/2)}}),es_math_sinh}var es_math_tanh={},hasRequiredEs_math_tanh;function requireEs_math_tanh(){if(hasRequiredEs_math_tanh)return es_math_tanh;hasRequiredEs_math_tanh=1;var Y=require_export(),X=requireMathExpm1(),ee=Math.exp;return Y({target:"Math",stat:!0},{tanh:function(te){var ue=+te,se=X(ue),ie=X(-ue);return se===1/0?1:ie===1/0?-1:(se-ie)/(ee(ue)+ee(-ue))}}),es_math_tanh}var es_math_toStringTag={},hasRequiredEs_math_toStringTag;function requireEs_math_toStringTag(){if(hasRequiredEs_math_toStringTag)return es_math_toStringTag;hasRequiredEs_math_toStringTag=1;var Y=requireSetToStringTag();return Y(Math,"Math",!0),es_math_toStringTag}var es_math_trunc={},hasRequiredEs_math_trunc;function requireEs_math_trunc(){if(hasRequiredEs_math_trunc)return es_math_trunc;hasRequiredEs_math_trunc=1;var Y=require_export(),X=requireMathTrunc();return Y({target:"Math",stat:!0},{trunc:X}),es_math_trunc}var es_number_constructor={},thisNumberValue,hasRequiredThisNumberValue;function requireThisNumberValue(){if(hasRequiredThisNumberValue)return thisNumberValue;hasRequiredThisNumberValue=1;var Y=requireFunctionUncurryThis();return thisNumberValue=Y(1.1.valueOf),thisNumberValue}var whitespaces,hasRequiredWhitespaces;function requireWhitespaces(){return hasRequiredWhitespaces||(hasRequiredWhitespaces=1,whitespaces=`	
\v\f\r                　\u2028\u2029\uFEFF`),whitespaces}var stringTrim,hasRequiredStringTrim;function requireStringTrim(){if(hasRequiredStringTrim)return stringTrim;hasRequiredStringTrim=1;var Y=requireFunctionUncurryThis(),X=requireRequireObjectCoercible(),ee=requireToString$1(),ne=requireWhitespaces(),te=Y("".replace),ue=RegExp("^["+ne+"]+"),se=RegExp("(^|[^"+ne+"])["+ne+"]+$"),ie=function(t){return function(H){var ae=ee(X(H));return t&1&&(ae=te(ae,ue,"")),t&2&&(ae=te(ae,se,"$1")),ae}};return stringTrim={start:ie(1),end:ie(2),trim:ie(3)},stringTrim}var hasRequiredEs_number_constructor;function requireEs_number_constructor(){if(hasRequiredEs_number_constructor)return es_number_constructor;hasRequiredEs_number_constructor=1;var Y=require_export(),X=requireIsPure(),ee=requireDescriptors(),ne=requireGlobalThis(),te=requirePath(),ue=requireFunctionUncurryThis(),se=requireIsForced(),ie=requireHasOwnProperty(),t=requireInheritIfRequired(),H=requireObjectIsPrototypeOf(),ae=requireIsSymbol$1(),he=requireToPrimitive(),_e=requireFails(),ge=requireObjectGetOwnPropertyNames().f,xe=requireObjectGetOwnPropertyDescriptor().f,Re=requireObjectDefineProperty().f,De=requireThisNumberValue(),Ie=requireStringTrim().trim,Ce="Number",Ue=ne[Ce],Le=te[Ce],ke=Ue.prototype,Ge=ne.TypeError,Ze=ue("".slice),We=ue("".charCodeAt),et=function(Lt){var Kt=he(Lt,"number");return typeof Kt=="bigint"?Kt:He(Kt)},He=function(Lt){var Kt=he(Lt,"number"),ft,qt,nt,At,wt,Ft,er,lr;if(ae(Kt))throw new Ge("Cannot convert a Symbol value to a number");if(typeof Kt=="string"&&Kt.length>2){if(Kt=Ie(Kt),ft=We(Kt,0),ft===43||ft===45){if(qt=We(Kt,2),qt===88||qt===120)return NaN}else if(ft===48){switch(We(Kt,1)){case 66:case 98:nt=2,At=49;break;case 79:case 111:nt=8,At=55;break;default:return+Kt}for(wt=Ze(Kt,2),Ft=wt.length,er=0;er<Ft;er++)if(lr=We(wt,er),lr<48||lr>At)return NaN;return parseInt(wt,nt)}}return+Kt},ht=se(Ce,!Ue(" 0o1")||!Ue("0b1")||Ue("+0x1")),_t=function(Lt){return H(ke,Lt)&&_e(function(){De(Lt)})},ut=function(Kt){var ft=arguments.length<1?0:Ue(et(Kt));return _t(this)?t(Object(ft),this,ut):ft};ut.prototype=ke,ht&&!X&&(ke.constructor=ut),Y({global:!0,constructor:!0,wrap:!0,forced:ht},{Number:ut});var yt=function(Lt,Kt){for(var ft=ee?ge(Kt):"MAX_VALUE,MIN_VALUE,NaN,NEGATIVE_INFINITY,POSITIVE_INFINITY,EPSILON,MAX_SAFE_INTEGER,MIN_SAFE_INTEGER,isFinite,isInteger,isNaN,isSafeInteger,parseFloat,parseInt,fromString,range".split(","),qt=0,nt;ft.length>qt;qt++)ie(Kt,nt=ft[qt])&&!ie(Lt,nt)&&Re(Lt,nt,xe(Kt,nt))};return X&&Le&&yt(te[Ce],Le),(ht||X)&&yt(te[Ce],Ue),es_number_constructor}var es_number_epsilon={},hasRequiredEs_number_epsilon;function requireEs_number_epsilon(){if(hasRequiredEs_number_epsilon)return es_number_epsilon;hasRequiredEs_number_epsilon=1;var Y=require_export();return Y({target:"Number",stat:!0,nonConfigurable:!0,nonWritable:!0},{EPSILON:Math.pow(2,-52)}),es_number_epsilon}var es_number_isFinite={},numberIsFinite,hasRequiredNumberIsFinite;function requireNumberIsFinite(){if(hasRequiredNumberIsFinite)return numberIsFinite;hasRequiredNumberIsFinite=1;var Y=requireGlobalThis(),X=Y.isFinite;return numberIsFinite=Number.isFinite||function(ne){return typeof ne=="number"&&X(ne)},numberIsFinite}var hasRequiredEs_number_isFinite;function requireEs_number_isFinite(){if(hasRequiredEs_number_isFinite)return es_number_isFinite;hasRequiredEs_number_isFinite=1;var Y=require_export(),X=requireNumberIsFinite();return Y({target:"Number",stat:!0},{isFinite:X}),es_number_isFinite}var es_number_isInteger={},isIntegralNumber,hasRequiredIsIntegralNumber;function requireIsIntegralNumber(){if(hasRequiredIsIntegralNumber)return isIntegralNumber;hasRequiredIsIntegralNumber=1;var Y=requireIsObject$1(),X=Math.floor;return isIntegralNumber=Number.isInteger||function(ne){return!Y(ne)&&isFinite(ne)&&X(ne)===ne},isIntegralNumber}var hasRequiredEs_number_isInteger;function requireEs_number_isInteger(){if(hasRequiredEs_number_isInteger)return es_number_isInteger;hasRequiredEs_number_isInteger=1;var Y=require_export(),X=requireIsIntegralNumber();return Y({target:"Number",stat:!0},{isInteger:X}),es_number_isInteger}var es_number_isNan={},hasRequiredEs_number_isNan;function requireEs_number_isNan(){if(hasRequiredEs_number_isNan)return es_number_isNan;hasRequiredEs_number_isNan=1;var Y=require_export();return Y({target:"Number",stat:!0},{isNaN:function(ee){return ee!==ee}}),es_number_isNan}var es_number_isSafeInteger={},hasRequiredEs_number_isSafeInteger;function requireEs_number_isSafeInteger(){if(hasRequiredEs_number_isSafeInteger)return es_number_isSafeInteger;hasRequiredEs_number_isSafeInteger=1;var Y=require_export(),X=requireIsIntegralNumber(),ee=Math.abs;return Y({target:"Number",stat:!0},{isSafeInteger:function(te){return X(te)&&ee(te)<=9007199254740991}}),es_number_isSafeInteger}var es_number_maxSafeInteger={},hasRequiredEs_number_maxSafeInteger;function requireEs_number_maxSafeInteger(){if(hasRequiredEs_number_maxSafeInteger)return es_number_maxSafeInteger;hasRequiredEs_number_maxSafeInteger=1;var Y=require_export();return Y({target:"Number",stat:!0,nonConfigurable:!0,nonWritable:!0},{MAX_SAFE_INTEGER:9007199254740991}),es_number_maxSafeInteger}var es_number_minSafeInteger={},hasRequiredEs_number_minSafeInteger;function requireEs_number_minSafeInteger(){if(hasRequiredEs_number_minSafeInteger)return es_number_minSafeInteger;hasRequiredEs_number_minSafeInteger=1;var Y=require_export();return Y({target:"Number",stat:!0,nonConfigurable:!0,nonWritable:!0},{MIN_SAFE_INTEGER:-9007199254740991}),es_number_minSafeInteger}var es_number_parseFloat={},numberParseFloat,hasRequiredNumberParseFloat;function requireNumberParseFloat(){if(hasRequiredNumberParseFloat)return numberParseFloat;hasRequiredNumberParseFloat=1;var Y=requireGlobalThis(),X=requireFails(),ee=requireFunctionUncurryThis(),ne=requireToString$1(),te=requireStringTrim().trim,ue=requireWhitespaces(),se=ee("".charAt),ie=Y.parseFloat,t=Y.Symbol,H=t&&t.iterator,ae=1/ie(ue+"-0")!==-1/0||H&&!X(function(){ie(Object(H))});return numberParseFloat=ae?function(_e){var ge=te(ne(_e)),xe=ie(ge);return xe===0&&se(ge,0)==="-"?-0:xe}:ie,numberParseFloat}var hasRequiredEs_number_parseFloat;function requireEs_number_parseFloat(){if(hasRequiredEs_number_parseFloat)return es_number_parseFloat;hasRequiredEs_number_parseFloat=1;var Y=require_export(),X=requireNumberParseFloat();return Y({target:"Number",stat:!0,forced:Number.parseFloat!==X},{parseFloat:X}),es_number_parseFloat}var es_number_parseInt={},numberParseInt,hasRequiredNumberParseInt;function requireNumberParseInt(){if(hasRequiredNumberParseInt)return numberParseInt;hasRequiredNumberParseInt=1;var Y=requireGlobalThis(),X=requireFails(),ee=requireFunctionUncurryThis(),ne=requireToString$1(),te=requireStringTrim().trim,ue=requireWhitespaces(),se=Y.parseInt,ie=Y.Symbol,t=ie&&ie.iterator,H=/^[+-]?0x/i,ae=ee(H.exec),he=se(ue+"08")!==8||se(ue+"0x16")!==22||t&&!X(function(){se(Object(t))});return numberParseInt=he?function(ge,xe){var Re=te(ne(ge));return se(Re,xe>>>0||(ae(H,Re)?16:10))}:se,numberParseInt}var hasRequiredEs_number_parseInt;function requireEs_number_parseInt(){if(hasRequiredEs_number_parseInt)return es_number_parseInt;hasRequiredEs_number_parseInt=1;var Y=require_export(),X=requireNumberParseInt();return Y({target:"Number",stat:!0,forced:Number.parseInt!==X},{parseInt:X}),es_number_parseInt}var es_number_toExponential={},hasRequiredEs_number_toExponential;function requireEs_number_toExponential(){if(hasRequiredEs_number_toExponential)return es_number_toExponential;hasRequiredEs_number_toExponential=1;var Y=require_export(),X=requireFunctionUncurryThis(),ee=requireToIntegerOrInfinity(),ne=requireThisNumberValue(),te=requireStringRepeat(),ue=requireMathLog10(),se=requireFails(),ie=RangeError,t=String,H=isFinite,ae=Math.abs,he=Math.floor,_e=Math.pow,ge=Math.round,xe=X(1.1.toExponential),Re=X(te),De=X("".slice),Ie=xe(-69e-12,4)==="-6.9000e-11"&&xe(1.255,2)==="1.25e+0"&&xe(12345,3)==="1.235e+4"&&xe(25,0)==="3e+1",Ce=function(){return se(function(){xe(1,1/0)})&&se(function(){xe(1,-1/0)})},Ue=function(){return!se(function(){xe(1/0,1/0),xe(NaN,1/0)})},Le=!Ie||!Ce()||!Ue();return Y({target:"Number",proto:!0,forced:Le},{toExponential:function(Ge){var Ze=ne(this);if(Ge===void 0)return xe(Ze);var We=ee(Ge);if(!H(Ze))return String(Ze);if(We<0||We>20)throw new ie("Incorrect fraction digits");if(Ie)return xe(Ze,We);var et="",He,ht,_t,ut;if(Ze<0&&(et="-",Ze=-Ze),Ze===0)ht=0,He=Re("0",We+1);else{var yt=ue(Ze);ht=he(yt);var Lt=_e(10,ht-We),Kt=ge(Ze/Lt);2*Ze>=(2*Kt+1)*Lt&&(Kt+=1),Kt>=_e(10,We+1)&&(Kt/=10,ht+=1),He=t(Kt)}return We!==0&&(He=De(He,0,1)+"."+De(He,1)),ht===0?(_t="+",ut="0"):(_t=ht>0?"+":"-",ut=t(ae(ht))),He+="e"+_t+ut,et+He}}),es_number_toExponential}var es_number_toFixed={},hasRequiredEs_number_toFixed;function requireEs_number_toFixed(){if(hasRequiredEs_number_toFixed)return es_number_toFixed;hasRequiredEs_number_toFixed=1;var Y=require_export(),X=requireFunctionUncurryThis(),ee=requireToIntegerOrInfinity(),ne=requireThisNumberValue(),te=requireStringRepeat(),ue=requireFails(),se=RangeError,ie=String,t=Math.floor,H=X(te),ae=X("".slice),he=X(1.1.toFixed),_e=function(Ce,Ue,Le){return Ue===0?Le:Ue%2===1?_e(Ce,Ue-1,Le*Ce):_e(Ce*Ce,Ue/2,Le)},ge=function(Ce){for(var Ue=0,Le=Ce;Le>=4096;)Ue+=12,Le/=4096;for(;Le>=2;)Ue+=1,Le/=2;return Ue},xe=function(Ce,Ue,Le){for(var ke=-1,Ge=Le;++ke<6;)Ge+=Ue*Ce[ke],Ce[ke]=Ge%1e7,Ge=t(Ge/1e7)},Re=function(Ce,Ue){for(var Le=6,ke=0;--Le>=0;)ke+=Ce[Le],Ce[Le]=t(ke/Ue),ke=ke%Ue*1e7},De=function(Ce){for(var Ue=6,Le="";--Ue>=0;)if(Le!==""||Ue===0||Ce[Ue]!==0){var ke=ie(Ce[Ue]);Le=Le===""?ke:Le+H("0",7-ke.length)+ke}return Le},Ie=ue(function(){return he(8e-5,3)!=="0.000"||he(.9,0)!=="1"||he(1.255,2)!=="1.25"||he(0xde0b6b3a7640080,0)!=="1000000000000000128"})||!ue(function(){he({})});return Y({target:"Number",proto:!0,forced:Ie},{toFixed:function(Ue){var Le=ne(this),ke=ee(Ue),Ge=[0,0,0,0,0,0],Ze="",We="0",et,He,ht,_t;if(ke<0||ke>20)throw new se("Incorrect fraction digits");if(Le!==Le)return"NaN";if(Le<=-1e21||Le>=1e21)return ie(Le);if(Le<0&&(Ze="-",Le=-Le),Le>1e-21)if(et=ge(Le*_e(2,69,1))-69,He=et<0?Le*_e(2,-et,1):Le/_e(2,et,1),He*=4503599627370496,et=52-et,et>0){for(xe(Ge,0,He),ht=ke;ht>=7;)xe(Ge,1e7,0),ht-=7;for(xe(Ge,_e(10,ht,1),0),ht=et-1;ht>=23;)Re(Ge,1<<23),ht-=23;Re(Ge,1<<ht),xe(Ge,1,1),Re(Ge,2),We=De(Ge)}else xe(Ge,0,He),xe(Ge,1<<-et,0),We=De(Ge)+H("0",ke);return ke>0?(_t=We.length,We=Ze+(_t<=ke?"0."+H("0",ke-_t)+We:ae(We,0,_t-ke)+"."+ae(We,_t-ke))):We=Ze+We,We}}),es_number_toFixed}var es_number_toPrecision={},hasRequiredEs_number_toPrecision;function requireEs_number_toPrecision(){if(hasRequiredEs_number_toPrecision)return es_number_toPrecision;hasRequiredEs_number_toPrecision=1;var Y=require_export(),X=requireFunctionUncurryThis(),ee=requireFails(),ne=requireThisNumberValue(),te=X(1.1.toPrecision),ue=ee(function(){return te(1,void 0)!=="1"})||!ee(function(){te({})});return Y({target:"Number",proto:!0,forced:ue},{toPrecision:function(ie){return ie===void 0?te(ne(this)):te(ne(this),ie)}}),es_number_toPrecision}var es_object_assign={},objectAssign,hasRequiredObjectAssign;function requireObjectAssign(){if(hasRequiredObjectAssign)return objectAssign;hasRequiredObjectAssign=1;var Y=requireDescriptors(),X=requireFunctionUncurryThis(),ee=requireFunctionCall(),ne=requireFails(),te=requireObjectKeys(),ue=requireObjectGetOwnPropertySymbols(),se=requireObjectPropertyIsEnumerable(),ie=requireToObject(),t=requireIndexedObject(),H=Object.assign,ae=Object.defineProperty,he=X([].concat);return objectAssign=!H||ne(function(){if(Y&&H({b:1},H(ae({},"a",{enumerable:!0,get:function(){ae(this,"b",{value:3,enumerable:!1})}}),{b:2})).b!==1)return!0;var _e={},ge={},xe=Symbol("assign detection"),Re="abcdefghijklmnopqrst";return _e[xe]=7,Re.split("").forEach(function(De){ge[De]=De}),H({},_e)[xe]!==7||te(H({},ge)).join("")!==Re})?function(ge,xe){for(var Re=ie(ge),De=arguments.length,Ie=1,Ce=ue.f,Ue=se.f;De>Ie;)for(var Le=t(arguments[Ie++]),ke=Ce?he(te(Le),Ce(Le)):te(Le),Ge=ke.length,Ze=0,We;Ge>Ze;)We=ke[Ze++],(!Y||ee(Ue,Le,We))&&(Re[We]=Le[We]);return Re}:H,objectAssign}var hasRequiredEs_object_assign;function requireEs_object_assign(){if(hasRequiredEs_object_assign)return es_object_assign;hasRequiredEs_object_assign=1;var Y=require_export(),X=requireObjectAssign();return Y({target:"Object",stat:!0,arity:2,forced:Object.assign!==X},{assign:X}),es_object_assign}var es_object_create={},hasRequiredEs_object_create;function requireEs_object_create(){if(hasRequiredEs_object_create)return es_object_create;hasRequiredEs_object_create=1;var Y=require_export(),X=requireDescriptors(),ee=requireObjectCreate();return Y({target:"Object",stat:!0,sham:!X},{create:ee}),es_object_create}var es_object_defineGetter={},objectPrototypeAccessorsForced,hasRequiredObjectPrototypeAccessorsForced;function requireObjectPrototypeAccessorsForced(){if(hasRequiredObjectPrototypeAccessorsForced)return objectPrototypeAccessorsForced;hasRequiredObjectPrototypeAccessorsForced=1;var Y=requireIsPure(),X=requireGlobalThis(),ee=requireFails(),ne=requireEnvironmentWebkitVersion();return objectPrototypeAccessorsForced=Y||!ee(function(){if(!(ne&&ne<535)){var te=Math.random();__defineSetter__.call(null,te,function(){}),delete X[te]}}),objectPrototypeAccessorsForced}var hasRequiredEs_object_defineGetter;function requireEs_object_defineGetter(){if(hasRequiredEs_object_defineGetter)return es_object_defineGetter;hasRequiredEs_object_defineGetter=1;var Y=require_export(),X=requireDescriptors(),ee=requireObjectPrototypeAccessorsForced(),ne=requireACallable(),te=requireToObject(),ue=requireObjectDefineProperty();return X&&Y({target:"Object",proto:!0,forced:ee},{__defineGetter__:function(ie,t){ue.f(te(this),ie,{get:ne(t),enumerable:!0,configurable:!0})}}),es_object_defineGetter}var es_object_defineProperties={},hasRequiredEs_object_defineProperties;function requireEs_object_defineProperties(){if(hasRequiredEs_object_defineProperties)return es_object_defineProperties;hasRequiredEs_object_defineProperties=1;var Y=require_export(),X=requireDescriptors(),ee=requireObjectDefineProperties().f;return Y({target:"Object",stat:!0,forced:Object.defineProperties!==ee,sham:!X},{defineProperties:ee}),es_object_defineProperties}var es_object_defineProperty={},hasRequiredEs_object_defineProperty;function requireEs_object_defineProperty(){if(hasRequiredEs_object_defineProperty)return es_object_defineProperty;hasRequiredEs_object_defineProperty=1;var Y=require_export(),X=requireDescriptors(),ee=requireObjectDefineProperty().f;return Y({target:"Object",stat:!0,forced:Object.defineProperty!==ee,sham:!X},{defineProperty:ee}),es_object_defineProperty}var es_object_defineSetter={},hasRequiredEs_object_defineSetter;function requireEs_object_defineSetter(){if(hasRequiredEs_object_defineSetter)return es_object_defineSetter;hasRequiredEs_object_defineSetter=1;var Y=require_export(),X=requireDescriptors(),ee=requireObjectPrototypeAccessorsForced(),ne=requireACallable(),te=requireToObject(),ue=requireObjectDefineProperty();return X&&Y({target:"Object",proto:!0,forced:ee},{__defineSetter__:function(ie,t){ue.f(te(this),ie,{set:ne(t),enumerable:!0,configurable:!0})}}),es_object_defineSetter}var es_object_entries={},objectToArray,hasRequiredObjectToArray;function requireObjectToArray(){if(hasRequiredObjectToArray)return objectToArray;hasRequiredObjectToArray=1;var Y=requireDescriptors(),X=requireFails(),ee=requireFunctionUncurryThis(),ne=requireObjectGetPrototypeOf(),te=requireObjectKeys(),ue=requireToIndexedObject(),se=requireObjectPropertyIsEnumerable().f,ie=ee(se),t=ee([].push),H=Y&&X(function(){var he=Object.create(null);return he[2]=2,!ie(he,2)}),ae=function(he){return function(_e){for(var ge=ue(_e),xe=te(ge),Re=H&&ne(ge)===null,De=xe.length,Ie=0,Ce=[],Ue;De>Ie;)Ue=xe[Ie++],(!Y||(Re?Ue in ge:ie(ge,Ue)))&&t(Ce,he?[Ue,ge[Ue]]:ge[Ue]);return Ce}};return objectToArray={entries:ae(!0),values:ae(!1)},objectToArray}var hasRequiredEs_object_entries;function requireEs_object_entries(){if(hasRequiredEs_object_entries)return es_object_entries;hasRequiredEs_object_entries=1;var Y=require_export(),X=requireObjectToArray().entries;return Y({target:"Object",stat:!0},{entries:function(ne){return X(ne)}}),es_object_entries}var es_object_freeze={},hasRequiredEs_object_freeze;function requireEs_object_freeze(){if(hasRequiredEs_object_freeze)return es_object_freeze;hasRequiredEs_object_freeze=1;var Y=require_export(),X=requireFreezing(),ee=requireFails(),ne=requireIsObject$1(),te=requireInternalMetadata().onFreeze,ue=Object.freeze,se=ee(function(){ue(1)});return Y({target:"Object",stat:!0,forced:se,sham:!X},{freeze:function(t){return ue&&ne(t)?ue(te(t)):t}}),es_object_freeze}var es_object_fromEntries={},hasRequiredEs_object_fromEntries;function requireEs_object_fromEntries(){if(hasRequiredEs_object_fromEntries)return es_object_fromEntries;hasRequiredEs_object_fromEntries=1;var Y=require_export(),X=requireIterate(),ee=requireCreateProperty();return Y({target:"Object",stat:!0},{fromEntries:function(te){var ue={};return X(te,function(se,ie){ee(ue,se,ie)},{AS_ENTRIES:!0}),ue}}),es_object_fromEntries}var es_object_getOwnPropertyDescriptor={},hasRequiredEs_object_getOwnPropertyDescriptor;function requireEs_object_getOwnPropertyDescriptor(){if(hasRequiredEs_object_getOwnPropertyDescriptor)return es_object_getOwnPropertyDescriptor;hasRequiredEs_object_getOwnPropertyDescriptor=1;var Y=require_export(),X=requireFails(),ee=requireToIndexedObject(),ne=requireObjectGetOwnPropertyDescriptor().f,te=requireDescriptors(),ue=!te||X(function(){ne(1)});return Y({target:"Object",stat:!0,forced:ue,sham:!te},{getOwnPropertyDescriptor:function(ie,t){return ne(ee(ie),t)}}),es_object_getOwnPropertyDescriptor}var es_object_getOwnPropertyDescriptors={},hasRequiredEs_object_getOwnPropertyDescriptors;function requireEs_object_getOwnPropertyDescriptors(){if(hasRequiredEs_object_getOwnPropertyDescriptors)return es_object_getOwnPropertyDescriptors;hasRequiredEs_object_getOwnPropertyDescriptors=1;var Y=require_export(),X=requireDescriptors(),ee=requireOwnKeys(),ne=requireToIndexedObject(),te=requireObjectGetOwnPropertyDescriptor(),ue=requireCreateProperty();return Y({target:"Object",stat:!0,sham:!X},{getOwnPropertyDescriptors:function(ie){for(var t=ne(ie),H=te.f,ae=ee(t),he={},_e=0,ge,xe;ae.length>_e;)xe=H(t,ge=ae[_e++]),xe!==void 0&&ue(he,ge,xe);return he}}),es_object_getOwnPropertyDescriptors}var es_object_getOwnPropertyNames={},hasRequiredEs_object_getOwnPropertyNames;function requireEs_object_getOwnPropertyNames(){if(hasRequiredEs_object_getOwnPropertyNames)return es_object_getOwnPropertyNames;hasRequiredEs_object_getOwnPropertyNames=1;var Y=require_export(),X=requireFails(),ee=requireObjectGetOwnPropertyNamesExternal().f,ne=X(function(){return!Object.getOwnPropertyNames(1)});return Y({target:"Object",stat:!0,forced:ne},{getOwnPropertyNames:ee}),es_object_getOwnPropertyNames}var es_object_getPrototypeOf={},hasRequiredEs_object_getPrototypeOf;function requireEs_object_getPrototypeOf(){if(hasRequiredEs_object_getPrototypeOf)return es_object_getPrototypeOf;hasRequiredEs_object_getPrototypeOf=1;var Y=require_export(),X=requireFails(),ee=requireToObject(),ne=requireObjectGetPrototypeOf(),te=requireCorrectPrototypeGetter(),ue=X(function(){ne(1)});return Y({target:"Object",stat:!0,forced:ue,sham:!te},{getPrototypeOf:function(ie){return ne(ee(ie))}}),es_object_getPrototypeOf}var es_object_groupBy={},hasRequiredEs_object_groupBy;function requireEs_object_groupBy(){if(hasRequiredEs_object_groupBy)return es_object_groupBy;hasRequiredEs_object_groupBy=1;var Y=require_export(),X=requireGetBuiltIn(),ee=requireFunctionUncurryThis(),ne=requireACallable(),te=requireRequireObjectCoercible(),ue=requireToPropertyKey(),se=requireIterate(),ie=requireFails(),t=Object.groupBy,H=X("Object","create"),ae=ee([].push),he=!t||ie(function(){return t("ab",function(_e){return _e}).a.length!==1});return Y({target:"Object",stat:!0,forced:he},{groupBy:function(ge,xe){te(ge),ne(xe);var Re=H(null),De=0;return se(ge,function(Ie){var Ce=ue(xe(Ie,De++));Ce in Re?ae(Re[Ce],Ie):Re[Ce]=[Ie]}),Re}}),es_object_groupBy}var es_object_hasOwn={},hasRequiredEs_object_hasOwn;function requireEs_object_hasOwn(){if(hasRequiredEs_object_hasOwn)return es_object_hasOwn;hasRequiredEs_object_hasOwn=1;var Y=require_export(),X=requireHasOwnProperty();return Y({target:"Object",stat:!0},{hasOwn:X}),es_object_hasOwn}var es_object_is={},sameValue,hasRequiredSameValue;function requireSameValue(){return hasRequiredSameValue||(hasRequiredSameValue=1,sameValue=Object.is||function(X,ee){return X===ee?X!==0||1/X===1/ee:X!==X&&ee!==ee}),sameValue}var hasRequiredEs_object_is;function requireEs_object_is(){if(hasRequiredEs_object_is)return es_object_is;hasRequiredEs_object_is=1;var Y=require_export(),X=requireSameValue();return Y({target:"Object",stat:!0},{is:X}),es_object_is}var es_object_isExtensible={},hasRequiredEs_object_isExtensible;function requireEs_object_isExtensible(){if(hasRequiredEs_object_isExtensible)return es_object_isExtensible;hasRequiredEs_object_isExtensible=1;var Y=require_export(),X=requireObjectIsExtensible();return Y({target:"Object",stat:!0,forced:Object.isExtensible!==X},{isExtensible:X}),es_object_isExtensible}var es_object_isFrozen={},hasRequiredEs_object_isFrozen;function requireEs_object_isFrozen(){if(hasRequiredEs_object_isFrozen)return es_object_isFrozen;hasRequiredEs_object_isFrozen=1;var Y=require_export(),X=requireFails(),ee=requireIsObject$1(),ne=requireClassofRaw(),te=requireArrayBufferNonExtensible(),ue=Object.isFrozen,se=te||X(function(){});return Y({target:"Object",stat:!0,forced:se},{isFrozen:function(t){return!ee(t)||te&&ne(t)==="ArrayBuffer"?!0:ue?ue(t):!1}}),es_object_isFrozen}var es_object_isSealed={},hasRequiredEs_object_isSealed;function requireEs_object_isSealed(){if(hasRequiredEs_object_isSealed)return es_object_isSealed;hasRequiredEs_object_isSealed=1;var Y=require_export(),X=requireFails(),ee=requireIsObject$1(),ne=requireClassofRaw(),te=requireArrayBufferNonExtensible(),ue=Object.isSealed,se=te||X(function(){});return Y({target:"Object",stat:!0,forced:se},{isSealed:function(t){return!ee(t)||te&&ne(t)==="ArrayBuffer"?!0:ue?ue(t):!1}}),es_object_isSealed}var es_object_keys={},hasRequiredEs_object_keys;function requireEs_object_keys(){if(hasRequiredEs_object_keys)return es_object_keys;hasRequiredEs_object_keys=1;var Y=require_export(),X=requireToObject(),ee=requireObjectKeys(),ne=requireFails(),te=ne(function(){ee(1)});return Y({target:"Object",stat:!0,forced:te},{keys:function(se){return ee(X(se))}}),es_object_keys}var es_object_lookupGetter={},hasRequiredEs_object_lookupGetter;function requireEs_object_lookupGetter(){if(hasRequiredEs_object_lookupGetter)return es_object_lookupGetter;hasRequiredEs_object_lookupGetter=1;var Y=require_export(),X=requireDescriptors(),ee=requireObjectPrototypeAccessorsForced(),ne=requireToObject(),te=requireToPropertyKey(),ue=requireObjectGetPrototypeOf(),se=requireObjectGetOwnPropertyDescriptor().f;return X&&Y({target:"Object",proto:!0,forced:ee},{__lookupGetter__:function(t){var H=ne(this),ae=te(t),he;do if(he=se(H,ae))return he.get;while(H=ue(H))}}),es_object_lookupGetter}var es_object_lookupSetter={},hasRequiredEs_object_lookupSetter;function requireEs_object_lookupSetter(){if(hasRequiredEs_object_lookupSetter)return es_object_lookupSetter;hasRequiredEs_object_lookupSetter=1;var Y=require_export(),X=requireDescriptors(),ee=requireObjectPrototypeAccessorsForced(),ne=requireToObject(),te=requireToPropertyKey(),ue=requireObjectGetPrototypeOf(),se=requireObjectGetOwnPropertyDescriptor().f;return X&&Y({target:"Object",proto:!0,forced:ee},{__lookupSetter__:function(t){var H=ne(this),ae=te(t),he;do if(he=se(H,ae))return he.set;while(H=ue(H))}}),es_object_lookupSetter}var es_object_preventExtensions={},hasRequiredEs_object_preventExtensions;function requireEs_object_preventExtensions(){if(hasRequiredEs_object_preventExtensions)return es_object_preventExtensions;hasRequiredEs_object_preventExtensions=1;var Y=require_export(),X=requireIsObject$1(),ee=requireInternalMetadata().onFreeze,ne=requireFreezing(),te=requireFails(),ue=Object.preventExtensions,se=te(function(){ue(1)});return Y({target:"Object",stat:!0,forced:se,sham:!ne},{preventExtensions:function(t){return ue&&X(t)?ue(ee(t)):t}}),es_object_preventExtensions}var es_object_proto={},hasRequiredEs_object_proto;function requireEs_object_proto(){if(hasRequiredEs_object_proto)return es_object_proto;hasRequiredEs_object_proto=1;var Y=requireDescriptors(),X=requireDefineBuiltInAccessor(),ee=requireIsObject$1(),ne=requireIsPossiblePrototype(),te=requireToObject(),ue=requireRequireObjectCoercible(),se=Object.getPrototypeOf,ie=Object.setPrototypeOf,t=Object.prototype,H="__proto__";if(Y&&se&&ie&&!(H in t))try{X(t,H,{configurable:!0,get:function(){return se(te(this))},set:function(he){var _e=ue(this);ne(he)&&ee(_e)&&ie(_e,he)}})}catch{}return es_object_proto}var es_object_seal={},hasRequiredEs_object_seal;function requireEs_object_seal(){if(hasRequiredEs_object_seal)return es_object_seal;hasRequiredEs_object_seal=1;var Y=require_export(),X=requireIsObject$1(),ee=requireInternalMetadata().onFreeze,ne=requireFreezing(),te=requireFails(),ue=Object.seal,se=te(function(){ue(1)});return Y({target:"Object",stat:!0,forced:se,sham:!ne},{seal:function(t){return ue&&X(t)?ue(ee(t)):t}}),es_object_seal}var es_object_setPrototypeOf={},hasRequiredEs_object_setPrototypeOf;function requireEs_object_setPrototypeOf(){if(hasRequiredEs_object_setPrototypeOf)return es_object_setPrototypeOf;hasRequiredEs_object_setPrototypeOf=1;var Y=require_export(),X=requireObjectSetPrototypeOf();return Y({target:"Object",stat:!0},{setPrototypeOf:X}),es_object_setPrototypeOf}var es_object_toString={},objectToString,hasRequiredObjectToString;function requireObjectToString(){if(hasRequiredObjectToString)return objectToString;hasRequiredObjectToString=1;var Y=requireToStringTagSupport(),X=requireClassof();return objectToString=Y?{}.toString:function(){return"[object "+X(this)+"]"},objectToString}var hasRequiredEs_object_toString;function requireEs_object_toString(){if(hasRequiredEs_object_toString)return es_object_toString;hasRequiredEs_object_toString=1;var Y=requireToStringTagSupport(),X=requireDefineBuiltIn(),ee=requireObjectToString();return Y||X(Object.prototype,"toString",ee,{unsafe:!0}),es_object_toString}var es_object_values={},hasRequiredEs_object_values;function requireEs_object_values(){if(hasRequiredEs_object_values)return es_object_values;hasRequiredEs_object_values=1;var Y=require_export(),X=requireObjectToArray().values;return Y({target:"Object",stat:!0},{values:function(ne){return X(ne)}}),es_object_values}var es_parseFloat={},hasRequiredEs_parseFloat;function requireEs_parseFloat(){if(hasRequiredEs_parseFloat)return es_parseFloat;hasRequiredEs_parseFloat=1;var Y=require_export(),X=requireNumberParseFloat();return Y({global:!0,forced:parseFloat!==X},{parseFloat:X}),es_parseFloat}var es_parseInt={},hasRequiredEs_parseInt;function requireEs_parseInt(){if(hasRequiredEs_parseInt)return es_parseInt;hasRequiredEs_parseInt=1;var Y=require_export(),X=requireNumberParseInt();return Y({global:!0,forced:parseInt!==X},{parseInt:X}),es_parseInt}var es_promise={},es_promise_constructor={},aConstructor,hasRequiredAConstructor;function requireAConstructor(){if(hasRequiredAConstructor)return aConstructor;hasRequiredAConstructor=1;var Y=requireIsConstructor(),X=requireTryToString(),ee=TypeError;return aConstructor=function(ne){if(Y(ne))return ne;throw new ee(X(ne)+" is not a constructor")},aConstructor}var speciesConstructor,hasRequiredSpeciesConstructor;function requireSpeciesConstructor(){if(hasRequiredSpeciesConstructor)return speciesConstructor;hasRequiredSpeciesConstructor=1;var Y=requireAnObject(),X=requireAConstructor(),ee=requireIsNullOrUndefined(),ne=requireWellKnownSymbol(),te=ne("species");return speciesConstructor=function(ue,se){var ie=Y(ue).constructor,t;return ie===void 0||ee(t=Y(ie)[te])?se:X(t)},speciesConstructor}var validateArgumentsLength,hasRequiredValidateArgumentsLength;function requireValidateArgumentsLength(){if(hasRequiredValidateArgumentsLength)return validateArgumentsLength;hasRequiredValidateArgumentsLength=1;var Y=TypeError;return validateArgumentsLength=function(X,ee){if(X<ee)throw new Y("Not enough arguments");return X},validateArgumentsLength}var environmentIsIos,hasRequiredEnvironmentIsIos;function requireEnvironmentIsIos(){if(hasRequiredEnvironmentIsIos)return environmentIsIos;hasRequiredEnvironmentIsIos=1;var Y=requireEnvironmentUserAgent();return environmentIsIos=/(?:ipad|iphone|ipod).*applewebkit/i.test(Y),environmentIsIos}var task,hasRequiredTask;function requireTask(){if(hasRequiredTask)return task;hasRequiredTask=1;var Y=requireGlobalThis(),X=requireFunctionApply(),ee=requireFunctionBindContext(),ne=requireIsCallable(),te=requireHasOwnProperty(),ue=requireFails(),se=requireHtml(),ie=requireArraySlice(),t=requireDocumentCreateElement(),H=requireValidateArgumentsLength(),ae=requireEnvironmentIsIos(),he=requireEnvironmentIsNode(),_e=Y.setImmediate,ge=Y.clearImmediate,xe=Y.process,Re=Y.Dispatch,De=Y.Function,Ie=Y.MessageChannel,Ce=Y.String,Ue=0,Le={},ke="onreadystatechange",Ge,Ze,We,et;ue(function(){Ge=Y.location});var He=function(yt){if(te(Le,yt)){var Lt=Le[yt];delete Le[yt],Lt()}},ht=function(yt){return function(){He(yt)}},_t=function(yt){He(yt.data)},ut=function(yt){Y.postMessage(Ce(yt),Ge.protocol+"//"+Ge.host)};return(!_e||!ge)&&(_e=function(Lt){H(arguments.length,1);var Kt=ne(Lt)?Lt:De(Lt),ft=ie(arguments,1);return Le[++Ue]=function(){X(Kt,void 0,ft)},Ze(Ue),Ue},ge=function(Lt){delete Le[Lt]},he?Ze=function(yt){xe.nextTick(ht(yt))}:Re&&Re.now?Ze=function(yt){Re.now(ht(yt))}:Ie&&!ae?(We=new Ie,et=We.port2,We.port1.onmessage=_t,Ze=ee(et.postMessage,et)):Y.addEventListener&&ne(Y.postMessage)&&!Y.importScripts&&Ge&&Ge.protocol!=="file:"&&!ue(ut)?(Ze=ut,Y.addEventListener("message",_t,!1)):ke in t("script")?Ze=function(yt){se.appendChild(t("script"))[ke]=function(){se.removeChild(this),He(yt)}}:Ze=function(yt){setTimeout(ht(yt),0)}),task={set:_e,clear:ge},task}var safeGetBuiltIn,hasRequiredSafeGetBuiltIn;function requireSafeGetBuiltIn(){if(hasRequiredSafeGetBuiltIn)return safeGetBuiltIn;hasRequiredSafeGetBuiltIn=1;var Y=requireGlobalThis(),X=requireDescriptors(),ee=Object.getOwnPropertyDescriptor;return safeGetBuiltIn=function(ne){if(!X)return Y[ne];var te=ee(Y,ne);return te&&te.value},safeGetBuiltIn}var queue,hasRequiredQueue;function requireQueue(){if(hasRequiredQueue)return queue;hasRequiredQueue=1;var Y=function(){this.head=null,this.tail=null};return Y.prototype={add:function(X){var ee={item:X,next:null},ne=this.tail;ne?ne.next=ee:this.head=ee,this.tail=ee},get:function(){var X=this.head;if(X){var ee=this.head=X.next;return ee===null&&(this.tail=null),X.item}}},queue=Y,queue}var environmentIsIosPebble,hasRequiredEnvironmentIsIosPebble;function requireEnvironmentIsIosPebble(){if(hasRequiredEnvironmentIsIosPebble)return environmentIsIosPebble;hasRequiredEnvironmentIsIosPebble=1;var Y=requireEnvironmentUserAgent();return environmentIsIosPebble=/ipad|iphone|ipod/i.test(Y)&&typeof Pebble<"u",environmentIsIosPebble}var environmentIsWebosWebkit,hasRequiredEnvironmentIsWebosWebkit;function requireEnvironmentIsWebosWebkit(){if(hasRequiredEnvironmentIsWebosWebkit)return environmentIsWebosWebkit;hasRequiredEnvironmentIsWebosWebkit=1;var Y=requireEnvironmentUserAgent();return environmentIsWebosWebkit=/web0s(?!.*chrome)/i.test(Y),environmentIsWebosWebkit}var microtask_1,hasRequiredMicrotask;function requireMicrotask(){if(hasRequiredMicrotask)return microtask_1;hasRequiredMicrotask=1;var Y=requireGlobalThis(),X=requireSafeGetBuiltIn(),ee=requireFunctionBindContext(),ne=requireTask().set,te=requireQueue(),ue=requireEnvironmentIsIos(),se=requireEnvironmentIsIosPebble(),ie=requireEnvironmentIsWebosWebkit(),t=requireEnvironmentIsNode(),H=Y.MutationObserver||Y.WebKitMutationObserver,ae=Y.document,he=Y.process,_e=Y.Promise,ge=X("queueMicrotask"),xe,Re,De,Ie,Ce;if(!ge){var Ue=new te,Le=function(){var ke,Ge;for(t&&(ke=he.domain)&&ke.exit();Ge=Ue.get();)try{Ge()}catch(Ze){throw Ue.head&&xe(),Ze}ke&&ke.enter()};!ue&&!t&&!ie&&H&&ae?(Re=!0,De=ae.createTextNode(""),new H(Le).observe(De,{characterData:!0}),xe=function(){De.data=Re=!Re}):!se&&_e&&_e.resolve?(Ie=_e.resolve(void 0),Ie.constructor=_e,Ce=ee(Ie.then,Ie),xe=function(){Ce(Le)}):t?xe=function(){he.nextTick(Le)}:(ne=ee(ne,Y),xe=function(){ne(Le)}),ge=function(ke){Ue.head||xe(),Ue.add(ke)}}return microtask_1=ge,microtask_1}var hostReportErrors,hasRequiredHostReportErrors;function requireHostReportErrors(){return hasRequiredHostReportErrors||(hasRequiredHostReportErrors=1,hostReportErrors=function(Y,X){try{arguments.length===1?console.error(Y):console.error(Y,X)}catch{}}),hostReportErrors}var perform,hasRequiredPerform;function requirePerform(){return hasRequiredPerform||(hasRequiredPerform=1,perform=function(Y){try{return{error:!1,value:Y()}}catch(X){return{error:!0,value:X}}}),perform}var promiseNativeConstructor,hasRequiredPromiseNativeConstructor;function requirePromiseNativeConstructor(){if(hasRequiredPromiseNativeConstructor)return promiseNativeConstructor;hasRequiredPromiseNativeConstructor=1;var Y=requireGlobalThis();return promiseNativeConstructor=Y.Promise,promiseNativeConstructor}var promiseConstructorDetection,hasRequiredPromiseConstructorDetection;function requirePromiseConstructorDetection(){if(hasRequiredPromiseConstructorDetection)return promiseConstructorDetection;hasRequiredPromiseConstructorDetection=1;var Y=requireGlobalThis(),X=requirePromiseNativeConstructor(),ee=requireIsCallable(),ne=requireIsForced(),te=requireInspectSource(),ue=requireWellKnownSymbol(),se=requireEnvironment(),ie=requireIsPure(),t=requireEnvironmentV8Version(),H=X&&X.prototype,ae=ue("species"),he=!1,_e=ee(Y.PromiseRejectionEvent),ge=ne("Promise",function(){var xe=te(X),Re=xe!==String(X);if(!Re&&t===66||ie&&!(H.catch&&H.finally))return!0;if(!t||t<51||!/native code/.test(xe)){var De=new X(function(Ue){Ue(1)}),Ie=function(Ue){Ue(function(){},function(){})},Ce=De.constructor={};if(Ce[ae]=Ie,he=De.then(function(){})instanceof Ie,!he)return!0}return!Re&&(se==="BROWSER"||se==="DENO")&&!_e});return promiseConstructorDetection={CONSTRUCTOR:ge,REJECTION_EVENT:_e,SUBCLASSING:he},promiseConstructorDetection}var newPromiseCapability={},hasRequiredNewPromiseCapability;function requireNewPromiseCapability(){if(hasRequiredNewPromiseCapability)return newPromiseCapability;hasRequiredNewPromiseCapability=1;var Y=requireACallable(),X=TypeError,ee=function(ne){var te,ue;this.promise=new ne(function(se,ie){if(te!==void 0||ue!==void 0)throw new X("Bad Promise constructor");te=se,ue=ie}),this.resolve=Y(te),this.reject=Y(ue)};return newPromiseCapability.f=function(ne){return new ee(ne)},newPromiseCapability}var hasRequiredEs_promise_constructor;function requireEs_promise_constructor(){if(hasRequiredEs_promise_constructor)return es_promise_constructor;hasRequiredEs_promise_constructor=1;var Y=require_export(),X=requireIsPure(),ee=requireEnvironmentIsNode(),ne=requireGlobalThis(),te=requirePath(),ue=requireFunctionCall(),se=requireDefineBuiltIn(),ie=requireObjectSetPrototypeOf(),t=requireSetToStringTag(),H=requireSetSpecies(),ae=requireACallable(),he=requireIsCallable(),_e=requireIsObject$1(),ge=requireAnInstance(),xe=requireSpeciesConstructor(),Re=requireTask().set,De=requireMicrotask(),Ie=requireHostReportErrors(),Ce=requirePerform(),Ue=requireQueue(),Le=requireInternalState(),ke=requirePromiseNativeConstructor(),Ge=requirePromiseConstructorDetection(),Ze=requireNewPromiseCapability(),We="Promise",et=Ge.CONSTRUCTOR,He=Ge.REJECTION_EVENT,ht=Ge.SUBCLASSING,_t=Le.getterFor(We),ut=Le.set,yt=ke&&ke.prototype,Lt=ke,Kt=yt,ft=ne.TypeError,qt=ne.document,nt=ne.process,At=Ze.f,wt=At,Ft=!!(qt&&qt.createEvent&&ne.dispatchEvent),er="unhandledrejection",lr="rejectionhandled",jr=0,Mr=1,Lr=2,sr=1,Rr=2,Ur,Wr,Er,Kr,ui=function(Ir){var Or;return _e(Ir)&&he(Or=Ir.then)?Or:!1},Ei=function(Ir,Or){var Nr=Or.value,je=Or.state===Mr,Se=je?Ir.ok:Ir.fail,Oe=Ir.resolve,Ve=Ir.reject,st=Ir.domain,gt,Ot,tr;try{Se?(je||(Or.rejection===Rr&&Qr(Or),Or.rejection=sr),Se===!0?gt=Nr:(st&&st.enter(),gt=Se(Nr),st&&(st.exit(),tr=!0)),gt===Ir.promise?Ve(new ft("Promise-chain cycle")):(Ot=ui(gt))?ue(Ot,gt,Oe,Ve):Oe(gt)):Ve(Nr)}catch(Qt){st&&!tr&&st.exit(),Ve(Qt)}},Hr=function(Ir,Or){Ir.notified||(Ir.notified=!0,De(function(){for(var Nr=Ir.reactions,je;je=Nr.get();)Ei(je,Ir);Ir.notified=!1,Or&&!Ir.rejection&&li(Ir)}))},Br=function(Ir,Or,Nr){var je,Se;Ft?(je=qt.createEvent("Event"),je.promise=Or,je.reason=Nr,je.initEvent(Ir,!1,!0),ne.dispatchEvent(je)):je={promise:Or,reason:Nr},!He&&(Se=ne["on"+Ir])?Se(je):Ir===er&&Ie("Unhandled promise rejection",Nr)},li=function(Ir){ue(Re,ne,function(){var Or=Ir.facade,Nr=Ir.value,je=si(Ir),Se;if(je&&(Se=Ce(function(){ee?nt.emit("unhandledRejection",Nr,Or):Br(er,Or,Nr)}),Ir.rejection=ee||si(Ir)?Rr:sr,Se.error))throw Se.value})},si=function(Ir){return Ir.rejection!==sr&&!Ir.parent},Qr=function(Ir){ue(Re,ne,function(){var Or=Ir.facade;ee?nt.emit("rejectionHandled",Or):Br(lr,Or,Ir.value)})},_r=function(Ir,Or,Nr){return function(je){Ir(Or,je,Nr)}},vr=function(Ir,Or,Nr){Ir.done||(Ir.done=!0,Nr&&(Ir=Nr),Ir.value=Or,Ir.state=Lr,Hr(Ir,!0))},Xr=function(Ir,Or,Nr){if(!Ir.done){Ir.done=!0,Nr&&(Ir=Nr);try{if(Ir.facade===Or)throw new ft("Promise can't be resolved itself");var je=ui(Or);je?De(function(){var Se={done:!1};try{ue(je,Or,_r(Xr,Se,Ir),_r(vr,Se,Ir))}catch(Oe){vr(Se,Oe,Ir)}}):(Ir.value=Or,Ir.state=Mr,Hr(Ir,!1))}catch(Se){vr({done:!1},Se,Ir)}}};if(et&&(Lt=function(Or){ge(this,Kt),ae(Or),ue(Ur,this);var Nr=_t(this);try{Or(_r(Xr,Nr),_r(vr,Nr))}catch(je){vr(Nr,je)}},Kt=Lt.prototype,Ur=function(Or){ut(this,{type:We,done:!1,notified:!1,parent:!1,reactions:new Ue,rejection:!1,state:jr,value:null})},Ur.prototype=se(Kt,"then",function(Or,Nr){var je=_t(this),Se=At(xe(this,Lt));return je.parent=!0,Se.ok=he(Or)?Or:!0,Se.fail=he(Nr)&&Nr,Se.domain=ee?nt.domain:void 0,je.state===jr?je.reactions.add(Se):De(function(){Ei(Se,je)}),Se.promise}),Wr=function(){var Ir=new Ur,Or=_t(Ir);this.promise=Ir,this.resolve=_r(Xr,Or),this.reject=_r(vr,Or)},Ze.f=At=function(Ir){return Ir===Lt||Ir===Er?new Wr(Ir):wt(Ir)},!X&&he(ke)&&yt!==Object.prototype)){Kr=yt.then,ht||se(yt,"then",function(Or,Nr){var je=this;return new Lt(function(Se,Oe){ue(Kr,je,Se,Oe)}).then(Or,Nr)},{unsafe:!0});try{delete yt.constructor}catch{}ie&&ie(yt,Kt)}return Y({global:!0,constructor:!0,wrap:!0,forced:et},{Promise:Lt}),Er=te.Promise,t(Lt,We,!1,!0),H(We),es_promise_constructor}var es_promise_all={},promiseStaticsIncorrectIteration,hasRequiredPromiseStaticsIncorrectIteration;function requirePromiseStaticsIncorrectIteration(){if(hasRequiredPromiseStaticsIncorrectIteration)return promiseStaticsIncorrectIteration;hasRequiredPromiseStaticsIncorrectIteration=1;var Y=requirePromiseNativeConstructor(),X=requireCheckCorrectnessOfIteration(),ee=requirePromiseConstructorDetection().CONSTRUCTOR;return promiseStaticsIncorrectIteration=ee||!X(function(ne){Y.all(ne).then(void 0,function(){})}),promiseStaticsIncorrectIteration}var hasRequiredEs_promise_all;function requireEs_promise_all(){if(hasRequiredEs_promise_all)return es_promise_all;hasRequiredEs_promise_all=1;var Y=require_export(),X=requireFunctionCall(),ee=requireACallable(),ne=requireNewPromiseCapability(),te=requirePerform(),ue=requireIterate(),se=requirePromiseStaticsIncorrectIteration();return Y({target:"Promise",stat:!0,forced:se},{all:function(t){var H=this,ae=ne.f(H),he=ae.resolve,_e=ae.reject,ge=te(function(){var xe=ee(H.resolve),Re=[],De=0,Ie=1;ue(t,function(Ce){var Ue=De++,Le=!1;Ie++,X(xe,H,Ce).then(function(ke){Le||(Le=!0,Re[Ue]=ke,--Ie||he(Re))},_e)}),--Ie||he(Re)});return ge.error&&_e(ge.value),ae.promise}}),es_promise_all}var es_promise_catch={},hasRequiredEs_promise_catch;function requireEs_promise_catch(){if(hasRequiredEs_promise_catch)return es_promise_catch;hasRequiredEs_promise_catch=1;var Y=require_export(),X=requireIsPure(),ee=requirePromiseConstructorDetection().CONSTRUCTOR,ne=requirePromiseNativeConstructor(),te=requireGetBuiltIn(),ue=requireIsCallable(),se=requireDefineBuiltIn(),ie=ne&&ne.prototype;if(Y({target:"Promise",proto:!0,forced:ee,real:!0},{catch:function(H){return this.then(void 0,H)}}),!X&&ue(ne)){var t=te("Promise").prototype.catch;ie.catch!==t&&se(ie,"catch",t,{unsafe:!0})}return es_promise_catch}var es_promise_race={},hasRequiredEs_promise_race;function requireEs_promise_race(){if(hasRequiredEs_promise_race)return es_promise_race;hasRequiredEs_promise_race=1;var Y=require_export(),X=requireFunctionCall(),ee=requireACallable(),ne=requireNewPromiseCapability(),te=requirePerform(),ue=requireIterate(),se=requirePromiseStaticsIncorrectIteration();return Y({target:"Promise",stat:!0,forced:se},{race:function(t){var H=this,ae=ne.f(H),he=ae.reject,_e=te(function(){var ge=ee(H.resolve);ue(t,function(xe){X(ge,H,xe).then(ae.resolve,he)})});return _e.error&&he(_e.value),ae.promise}}),es_promise_race}var es_promise_reject={},hasRequiredEs_promise_reject;function requireEs_promise_reject(){if(hasRequiredEs_promise_reject)return es_promise_reject;hasRequiredEs_promise_reject=1;var Y=require_export(),X=requireNewPromiseCapability(),ee=requirePromiseConstructorDetection().CONSTRUCTOR;return Y({target:"Promise",stat:!0,forced:ee},{reject:function(te){var ue=X.f(this),se=ue.reject;return se(te),ue.promise}}),es_promise_reject}var es_promise_resolve={},promiseResolve,hasRequiredPromiseResolve;function requirePromiseResolve(){if(hasRequiredPromiseResolve)return promiseResolve;hasRequiredPromiseResolve=1;var Y=requireAnObject(),X=requireIsObject$1(),ee=requireNewPromiseCapability();return promiseResolve=function(ne,te){if(Y(ne),X(te)&&te.constructor===ne)return te;var ue=ee.f(ne),se=ue.resolve;return se(te),ue.promise},promiseResolve}var hasRequiredEs_promise_resolve;function requireEs_promise_resolve(){if(hasRequiredEs_promise_resolve)return es_promise_resolve;hasRequiredEs_promise_resolve=1;var Y=require_export(),X=requireGetBuiltIn(),ee=requireIsPure(),ne=requirePromiseNativeConstructor(),te=requirePromiseConstructorDetection().CONSTRUCTOR,ue=requirePromiseResolve(),se=X("Promise"),ie=ee&&!te;return Y({target:"Promise",stat:!0,forced:ee||te},{resolve:function(H){return ue(ie&&this===se?ne:this,H)}}),es_promise_resolve}var hasRequiredEs_promise;function requireEs_promise(){return hasRequiredEs_promise||(hasRequiredEs_promise=1,requireEs_promise_constructor(),requireEs_promise_all(),requireEs_promise_catch(),requireEs_promise_race(),requireEs_promise_reject(),requireEs_promise_resolve()),es_promise}var es_promise_allSettled={},hasRequiredEs_promise_allSettled;function requireEs_promise_allSettled(){if(hasRequiredEs_promise_allSettled)return es_promise_allSettled;hasRequiredEs_promise_allSettled=1;var Y=require_export(),X=requireFunctionCall(),ee=requireACallable(),ne=requireNewPromiseCapability(),te=requirePerform(),ue=requireIterate(),se=requirePromiseStaticsIncorrectIteration();return Y({target:"Promise",stat:!0,forced:se},{allSettled:function(t){var H=this,ae=ne.f(H),he=ae.resolve,_e=ae.reject,ge=te(function(){var xe=ee(H.resolve),Re=[],De=0,Ie=1;ue(t,function(Ce){var Ue=De++,Le=!1;Ie++,X(xe,H,Ce).then(function(ke){Le||(Le=!0,Re[Ue]={status:"fulfilled",value:ke},--Ie||he(Re))},function(ke){Le||(Le=!0,Re[Ue]={status:"rejected",reason:ke},--Ie||he(Re))})}),--Ie||he(Re)});return ge.error&&_e(ge.value),ae.promise}}),es_promise_allSettled}var es_promise_any={},hasRequiredEs_promise_any;function requireEs_promise_any(){if(hasRequiredEs_promise_any)return es_promise_any;hasRequiredEs_promise_any=1;var Y=require_export(),X=requireFunctionCall(),ee=requireACallable(),ne=requireGetBuiltIn(),te=requireNewPromiseCapability(),ue=requirePerform(),se=requireIterate(),ie=requirePromiseStaticsIncorrectIteration(),t="No one promise resolved";return Y({target:"Promise",stat:!0,forced:ie},{any:function(ae){var he=this,_e=ne("AggregateError"),ge=te.f(he),xe=ge.resolve,Re=ge.reject,De=ue(function(){var Ie=ee(he.resolve),Ce=[],Ue=0,Le=1,ke=!1;se(ae,function(Ge){var Ze=Ue++,We=!1;Le++,X(Ie,he,Ge).then(function(et){We||ke||(ke=!0,xe(et))},function(et){We||ke||(We=!0,Ce[Ze]=et,--Le||Re(new _e(Ce,t)))})}),--Le||Re(new _e(Ce,t))});return De.error&&Re(De.value),ge.promise}}),es_promise_any}var es_promise_finally={},hasRequiredEs_promise_finally;function requireEs_promise_finally(){if(hasRequiredEs_promise_finally)return es_promise_finally;hasRequiredEs_promise_finally=1;var Y=require_export(),X=requireIsPure(),ee=requirePromiseNativeConstructor(),ne=requireFails(),te=requireGetBuiltIn(),ue=requireIsCallable(),se=requireSpeciesConstructor(),ie=requirePromiseResolve(),t=requireDefineBuiltIn(),H=ee&&ee.prototype,ae=!!ee&&ne(function(){H.finally.call({then:function(){}},function(){})});if(Y({target:"Promise",proto:!0,real:!0,forced:ae},{finally:function(_e){var ge=se(this,te("Promise")),xe=ue(_e);return this.then(xe?function(Re){return ie(ge,_e()).then(function(){return Re})}:_e,xe?function(Re){return ie(ge,_e()).then(function(){throw Re})}:_e)}}),!X&&ue(ee)){var he=te("Promise").prototype.finally;H.finally!==he&&t(H,"finally",he,{unsafe:!0})}return es_promise_finally}var es_promise_try={},hasRequiredEs_promise_try;function requireEs_promise_try(){if(hasRequiredEs_promise_try)return es_promise_try;hasRequiredEs_promise_try=1;var Y=require_export(),X=requireGlobalThis(),ee=requireFunctionApply(),ne=requireArraySlice(),te=requireNewPromiseCapability(),ue=requireACallable(),se=requirePerform(),ie=X.Promise,t=!1,H=!ie||!ie.try||se(function(){ie.try(function(ae){t=ae===8},8)}).error||!t;return Y({target:"Promise",stat:!0,forced:H},{try:function(ae){var he=arguments.length>1?ne(arguments,1):[],_e=te.f(this),ge=se(function(){return ee(ue(ae),void 0,he)});return(ge.error?_e.reject:_e.resolve)(ge.value),_e.promise}}),es_promise_try}var es_promise_withResolvers={},hasRequiredEs_promise_withResolvers;function requireEs_promise_withResolvers(){if(hasRequiredEs_promise_withResolvers)return es_promise_withResolvers;hasRequiredEs_promise_withResolvers=1;var Y=require_export(),X=requireNewPromiseCapability();return Y({target:"Promise",stat:!0},{withResolvers:function(){var ne=X.f(this);return{promise:ne.promise,resolve:ne.resolve,reject:ne.reject}}}),es_promise_withResolvers}var es_array_fromAsync={},asyncIteratorPrototype,hasRequiredAsyncIteratorPrototype;function requireAsyncIteratorPrototype(){if(hasRequiredAsyncIteratorPrototype)return asyncIteratorPrototype;hasRequiredAsyncIteratorPrototype=1;var Y=requireGlobalThis(),X=requireSharedStore(),ee=requireIsCallable(),ne=requireObjectCreate(),te=requireObjectGetPrototypeOf(),ue=requireDefineBuiltIn(),se=requireWellKnownSymbol(),ie=requireIsPure(),t="USE_FUNCTION_CONSTRUCTOR",H=se("asyncIterator"),ae=Y.AsyncIterator,he=X.AsyncIteratorPrototype,_e,ge;if(he)_e=he;else if(ee(ae))_e=ae.prototype;else if(X[t]||Y[t])try{ge=te(te(te(Function("return async function*(){}()")()))),te(ge)===Object.prototype&&(_e=ge)}catch{}return _e?ie&&(_e=ne(_e)):_e={},ee(_e[H])||ue(_e,H,function(){return this}),asyncIteratorPrototype=_e,asyncIteratorPrototype}var asyncFromSyncIterator,hasRequiredAsyncFromSyncIterator;function requireAsyncFromSyncIterator(){if(hasRequiredAsyncFromSyncIterator)return asyncFromSyncIterator;hasRequiredAsyncFromSyncIterator=1;var Y=requireFunctionCall(),X=requireAnObject(),ee=requireObjectCreate(),ne=requireGetMethod(),te=requireDefineBuiltIns(),ue=requireInternalState(),se=requireIteratorClose(),ie=requireGetBuiltIn(),t=requireAsyncIteratorPrototype(),H=requireCreateIterResultObject(),ae=ie("Promise"),he="AsyncFromSyncIterator",_e=ue.set,ge=ue.getterFor(he),xe=function(De,Ie,Ce,Ue,Le){var ke=De.done;ae.resolve(De.value).then(function(Ge){Ie(H(Ge,ke))},function(Ge){if(!ke&&Le)try{se(Ue,"throw",Ge)}catch(Ze){Ge=Ze}Ce(Ge)})},Re=function(Ie){Ie.type=he,_e(this,Ie)};return Re.prototype=te(ee(t),{next:function(){var Ie=ge(this);return new ae(function(Ce,Ue){var Le=X(Y(Ie.next,Ie.iterator));xe(Le,Ce,Ue,Ie.iterator,!0)})},return:function(){var De=ge(this).iterator;return new ae(function(Ie,Ce){var Ue=ne(De,"return");if(Ue===void 0)return Ie(H(void 0,!0));var Le=X(Y(Ue,De));xe(Le,Ie,Ce,De)})}}),asyncFromSyncIterator=Re,asyncFromSyncIterator}var getAsyncIterator,hasRequiredGetAsyncIterator;function requireGetAsyncIterator(){if(hasRequiredGetAsyncIterator)return getAsyncIterator;hasRequiredGetAsyncIterator=1;var Y=requireFunctionCall(),X=requireAsyncFromSyncIterator(),ee=requireAnObject(),ne=requireGetIterator(),te=requireGetIteratorDirect(),ue=requireGetMethod(),se=requireWellKnownSymbol(),ie=se("asyncIterator");return getAsyncIterator=function(t,H){var ae=arguments.length<2?ue(t,ie):H;return ae?ee(Y(ae,t)):new X(te(ne(t)))},getAsyncIterator}var asyncIteratorClose,hasRequiredAsyncIteratorClose;function requireAsyncIteratorClose(){if(hasRequiredAsyncIteratorClose)return asyncIteratorClose;hasRequiredAsyncIteratorClose=1;var Y=requireFunctionCall(),X=requireGetBuiltIn(),ee=requireGetMethod();return asyncIteratorClose=function(ne,te,ue,se){try{var ie=ee(ne,"return");if(ie)return X("Promise").resolve(Y(ie,ne)).then(function(){te(ue)},function(t){se(t)})}catch(t){return se(t)}te(ue)},asyncIteratorClose}var asyncIteratorIteration,hasRequiredAsyncIteratorIteration;function requireAsyncIteratorIteration(){if(hasRequiredAsyncIteratorIteration)return asyncIteratorIteration;hasRequiredAsyncIteratorIteration=1;var Y=requireFunctionCall(),X=requireACallable(),ee=requireAnObject(),ne=requireIsObject$1(),te=requireDoesNotExceedSafeInteger(),ue=requireGetBuiltIn(),se=requireGetIteratorDirect(),ie=requireAsyncIteratorClose(),t=function(H){var ae=H===0,he=H===1,_e=H===2,ge=H===3;return function(xe,Re,De){ee(xe);var Ie=Re!==void 0;(Ie||!ae)&&X(Re);var Ce=se(xe),Ue=ue("Promise"),Le=Ce.iterator,ke=Ce.next,Ge=0;return new Ue(function(Ze,We){var et=function(ht){ie(Le,We,ht,We)},He=function(){try{if(Ie)try{te(Ge)}catch(ht){et(ht)}Ue.resolve(ee(Y(ke,Le))).then(function(ht){try{if(ee(ht).done)ae?(De.length=Ge,Ze(De)):Ze(ge?!1:_e||void 0);else{var _t=ht.value;try{if(Ie){var ut=Re(_t,Ge),yt=function(Lt){if(he)He();else if(_e)Lt?He():ie(Le,Ze,!1,We);else if(ae)try{De[Ge++]=Lt,He()}catch(Kt){et(Kt)}else Lt?ie(Le,Ze,ge||_t,We):He()};ne(ut)?Ue.resolve(ut).then(yt,et):yt(ut)}else De[Ge++]=_t,He()}catch(Lt){et(Lt)}}}catch(Lt){We(Lt)}},We)}catch(ht){We(ht)}};He()})}};return asyncIteratorIteration={toArray:t(0),forEach:t(1),every:t(2),some:t(3),find:t(4)},asyncIteratorIteration}var arrayFromAsync,hasRequiredArrayFromAsync;function requireArrayFromAsync(){if(hasRequiredArrayFromAsync)return arrayFromAsync;hasRequiredArrayFromAsync=1;var Y=requireFunctionBindContext(),X=requireFunctionUncurryThis(),ee=requireToObject(),ne=requireIsConstructor(),te=requireGetAsyncIterator(),ue=requireGetIterator(),se=requireGetIteratorDirect(),ie=requireGetIteratorMethod(),t=requireGetMethod(),H=requireGetBuiltIn(),ae=requireGetBuiltInPrototypeMethod(),he=requireWellKnownSymbol(),_e=requireAsyncFromSyncIterator(),ge=requireAsyncIteratorIteration().toArray,xe=he("asyncIterator"),Re=X(ae("Array","values")),De=X(Re([]).next),Ie=function(){return new Ce(this)},Ce=function(Ue){this.iterator=Re(Ue)};return Ce.prototype.next=function(){return De(this.iterator)},arrayFromAsync=function(Le){var ke=this,Ge=arguments.length,Ze=Ge>1?arguments[1]:void 0,We=Ge>2?arguments[2]:void 0;return new(H("Promise"))(function(et){var He=ee(Le);Ze!==void 0&&(Ze=Y(Ze,We));var ht=t(He,xe),_t=ht?void 0:ie(He)||Ie,ut=ne(ke)?new ke:[],yt=ht?te(He,ht):new _e(se(ue(He,_t)));et(ge(yt,Ze,ut))})},arrayFromAsync}var hasRequiredEs_array_fromAsync;function requireEs_array_fromAsync(){if(hasRequiredEs_array_fromAsync)return es_array_fromAsync;hasRequiredEs_array_fromAsync=1;var Y=require_export(),X=requireArrayFromAsync(),ee=requireFails(),ne=Array.fromAsync,te=!ne||ee(function(){var ue=0;return ne.call(function(){return ue++,[]},{length:0}),ue!==1});return Y({target:"Array",stat:!0,forced:te},{fromAsync:X}),es_array_fromAsync}var es_asyncDisposableStack_constructor={},hasRequiredEs_asyncDisposableStack_constructor;function requireEs_asyncDisposableStack_constructor(){if(hasRequiredEs_asyncDisposableStack_constructor)return es_asyncDisposableStack_constructor;hasRequiredEs_asyncDisposableStack_constructor=1;var Y=require_export(),X=requireDescriptors(),ee=requireGetBuiltIn(),ne=requireACallable(),te=requireAnInstance(),ue=requireDefineBuiltIn(),se=requireDefineBuiltIns(),ie=requireDefineBuiltInAccessor(),t=requireWellKnownSymbol(),H=requireInternalState(),ae=requireAddDisposableResource(),he=requireEnvironmentV8Version(),_e=ee("Promise"),ge=ee("SuppressedError"),xe=ReferenceError,Re=t("asyncDispose"),De=t("toStringTag"),Ie="AsyncDisposableStack",Ce=H.set,Ue=H.getterFor(Ie),Le="async-dispose",ke="disposed",Ge="pending",Ze=function(ht){var _t=Ue(ht);if(_t.state===ke)throw new xe(Ie+" already disposed");return _t},We=function(){Ce(te(this,et),{type:Ie,state:Ge,stack:[]}),X||(this.disposed=!1)},et=We.prototype;se(et,{disposeAsync:function(){var _t=this;return new _e(function(ut,yt){var Lt=Ue(_t);if(Lt.state===ke)return ut(void 0);Lt.state=ke,X||(_t.disposed=!0);var Kt=Lt.stack,ft=Kt.length,qt=!1,nt,At=function(Ft){qt?nt=new ge(Ft,nt):(qt=!0,nt=Ft),wt()},wt=function(){if(ft){var Ft=Kt[--ft];Kt[ft]=null;try{_e.resolve(Ft()).then(wt,At)}catch(er){At(er)}}else Lt.stack=null,qt?yt(nt):ut(void 0)};wt()})},use:function(_t){return ae(Ze(this),_t,Le),_t},adopt:function(_t,ut){var yt=Ze(this);return ne(ut),ae(yt,void 0,Le,function(){return ut(_t)}),_t},defer:function(_t){var ut=Ze(this);ne(_t),ae(ut,void 0,Le,_t)},move:function(){var _t=Ze(this),ut=new We;return Ue(ut).stack=_t.stack,_t.stack=[],_t.state=ke,X||(this.disposed=!0),ut}}),X&&ie(et,"disposed",{configurable:!0,get:function(){return Ue(this).state===ke}}),ue(et,Re,et.disposeAsync,{name:"disposeAsync"}),ue(et,De,Ie,{nonWritable:!0});var He=he&&he<136;return Y({global:!0,constructor:!0,forced:He},{AsyncDisposableStack:We}),es_asyncDisposableStack_constructor}var es_asyncIterator_asyncDispose={},hasRequiredEs_asyncIterator_asyncDispose;function requireEs_asyncIterator_asyncDispose(){if(hasRequiredEs_asyncIterator_asyncDispose)return es_asyncIterator_asyncDispose;hasRequiredEs_asyncIterator_asyncDispose=1;var Y=requireFunctionCall(),X=requireDefineBuiltIn(),ee=requireGetBuiltIn(),ne=requireGetMethod(),te=requireHasOwnProperty(),ue=requireWellKnownSymbol(),se=requireAsyncIteratorPrototype(),ie=ue("asyncDispose"),t=ee("Promise");return te(se,ie)||X(se,ie,function(){var H=this;return new t(function(ae,he){var _e=ne(H,"return");_e?t.resolve(Y(_e,H)).then(function(){ae(void 0)},he):ae(void 0)})}),es_asyncIterator_asyncDispose}var es_reflect_apply={},hasRequiredEs_reflect_apply;function requireEs_reflect_apply(){if(hasRequiredEs_reflect_apply)return es_reflect_apply;hasRequiredEs_reflect_apply=1;var Y=require_export(),X=requireFunctionApply(),ee=requireACallable(),ne=requireAnObject(),te=requireFails(),ue=!te(function(){Reflect.apply(function(){})});return Y({target:"Reflect",stat:!0,forced:ue},{apply:function(ie,t,H){return X(ee(ie),t,ne(H))}}),es_reflect_apply}var es_reflect_construct={},hasRequiredEs_reflect_construct;function requireEs_reflect_construct(){if(hasRequiredEs_reflect_construct)return es_reflect_construct;hasRequiredEs_reflect_construct=1;var Y=require_export(),X=requireGetBuiltIn(),ee=requireFunctionApply(),ne=requireFunctionBind(),te=requireAConstructor(),ue=requireAnObject(),se=requireIsObject$1(),ie=requireObjectCreate(),t=requireFails(),H=X("Reflect","construct"),ae=Object.prototype,he=[].push,_e=t(function(){function Re(){}return!(H(function(){},[],Re)instanceof Re)}),ge=!t(function(){H(function(){})}),xe=_e||ge;return Y({target:"Reflect",stat:!0,forced:xe,sham:xe},{construct:function(De,Ie){te(De),ue(Ie);var Ce=arguments.length<3?De:te(arguments[2]);if(ge&&!_e)return H(De,Ie,Ce);if(De===Ce){switch(Ie.length){case 0:return new De;case 1:return new De(Ie[0]);case 2:return new De(Ie[0],Ie[1]);case 3:return new De(Ie[0],Ie[1],Ie[2]);case 4:return new De(Ie[0],Ie[1],Ie[2],Ie[3])}var Ue=[null];return ee(he,Ue,Ie),new(ee(ne,De,Ue))}var Le=Ce.prototype,ke=ie(se(Le)?Le:ae),Ge=ee(De,ke,Ie);return se(Ge)?Ge:ke}}),es_reflect_construct}var es_reflect_defineProperty={},hasRequiredEs_reflect_defineProperty;function requireEs_reflect_defineProperty(){if(hasRequiredEs_reflect_defineProperty)return es_reflect_defineProperty;hasRequiredEs_reflect_defineProperty=1;var Y=require_export(),X=requireDescriptors(),ee=requireAnObject(),ne=requireToPropertyKey(),te=requireObjectDefineProperty(),ue=requireFails(),se=ue(function(){Reflect.defineProperty(te.f({},1,{value:1}),1,{value:2})});return Y({target:"Reflect",stat:!0,forced:se,sham:!X},{defineProperty:function(t,H,ae){ee(t);var he=ne(H);ee(ae);try{return te.f(t,he,ae),!0}catch{return!1}}}),es_reflect_defineProperty}var es_reflect_deleteProperty={},hasRequiredEs_reflect_deleteProperty;function requireEs_reflect_deleteProperty(){if(hasRequiredEs_reflect_deleteProperty)return es_reflect_deleteProperty;hasRequiredEs_reflect_deleteProperty=1;var Y=require_export(),X=requireAnObject(),ee=requireObjectGetOwnPropertyDescriptor().f;return Y({target:"Reflect",stat:!0},{deleteProperty:function(te,ue){var se=ee(X(te),ue);return se&&!se.configurable?!1:delete te[ue]}}),es_reflect_deleteProperty}var es_reflect_get={},isDataDescriptor,hasRequiredIsDataDescriptor;function requireIsDataDescriptor(){if(hasRequiredIsDataDescriptor)return isDataDescriptor;hasRequiredIsDataDescriptor=1;var Y=requireHasOwnProperty();return isDataDescriptor=function(X){return X!==void 0&&(Y(X,"value")||Y(X,"writable"))},isDataDescriptor}var hasRequiredEs_reflect_get;function requireEs_reflect_get(){if(hasRequiredEs_reflect_get)return es_reflect_get;hasRequiredEs_reflect_get=1;var Y=require_export(),X=requireFunctionCall(),ee=requireIsObject$1(),ne=requireAnObject(),te=requireIsDataDescriptor(),ue=requireObjectGetOwnPropertyDescriptor(),se=requireObjectGetPrototypeOf();function ie(t,H){var ae=arguments.length<3?t:arguments[2],he,_e;if(ne(t)===ae)return t[H];if(he=ue.f(t,H),he)return te(he)?he.value:he.get===void 0?void 0:X(he.get,ae);if(ee(_e=se(t)))return ie(_e,H,ae)}return Y({target:"Reflect",stat:!0},{get:ie}),es_reflect_get}var es_reflect_getOwnPropertyDescriptor={},hasRequiredEs_reflect_getOwnPropertyDescriptor;function requireEs_reflect_getOwnPropertyDescriptor(){if(hasRequiredEs_reflect_getOwnPropertyDescriptor)return es_reflect_getOwnPropertyDescriptor;hasRequiredEs_reflect_getOwnPropertyDescriptor=1;var Y=require_export(),X=requireDescriptors(),ee=requireAnObject(),ne=requireObjectGetOwnPropertyDescriptor();return Y({target:"Reflect",stat:!0,sham:!X},{getOwnPropertyDescriptor:function(ue,se){return ne.f(ee(ue),se)}}),es_reflect_getOwnPropertyDescriptor}var es_reflect_getPrototypeOf={},hasRequiredEs_reflect_getPrototypeOf;function requireEs_reflect_getPrototypeOf(){if(hasRequiredEs_reflect_getPrototypeOf)return es_reflect_getPrototypeOf;hasRequiredEs_reflect_getPrototypeOf=1;var Y=require_export(),X=requireAnObject(),ee=requireObjectGetPrototypeOf(),ne=requireCorrectPrototypeGetter();return Y({target:"Reflect",stat:!0,sham:!ne},{getPrototypeOf:function(ue){return ee(X(ue))}}),es_reflect_getPrototypeOf}var es_reflect_has={},hasRequiredEs_reflect_has;function requireEs_reflect_has(){if(hasRequiredEs_reflect_has)return es_reflect_has;hasRequiredEs_reflect_has=1;var Y=require_export();return Y({target:"Reflect",stat:!0},{has:function(ee,ne){return ne in ee}}),es_reflect_has}var es_reflect_isExtensible={},hasRequiredEs_reflect_isExtensible;function requireEs_reflect_isExtensible(){if(hasRequiredEs_reflect_isExtensible)return es_reflect_isExtensible;hasRequiredEs_reflect_isExtensible=1;var Y=require_export(),X=requireAnObject(),ee=requireObjectIsExtensible();return Y({target:"Reflect",stat:!0},{isExtensible:function(te){return X(te),ee(te)}}),es_reflect_isExtensible}var es_reflect_ownKeys={},hasRequiredEs_reflect_ownKeys;function requireEs_reflect_ownKeys(){if(hasRequiredEs_reflect_ownKeys)return es_reflect_ownKeys;hasRequiredEs_reflect_ownKeys=1;var Y=require_export(),X=requireOwnKeys();return Y({target:"Reflect",stat:!0},{ownKeys:X}),es_reflect_ownKeys}var es_reflect_preventExtensions={},hasRequiredEs_reflect_preventExtensions;function requireEs_reflect_preventExtensions(){if(hasRequiredEs_reflect_preventExtensions)return es_reflect_preventExtensions;hasRequiredEs_reflect_preventExtensions=1;var Y=require_export(),X=requireGetBuiltIn(),ee=requireAnObject(),ne=requireFreezing();return Y({target:"Reflect",stat:!0,sham:!ne},{preventExtensions:function(ue){ee(ue);try{var se=X("Object","preventExtensions");return se&&se(ue),!0}catch{return!1}}}),es_reflect_preventExtensions}var es_reflect_set={},hasRequiredEs_reflect_set;function requireEs_reflect_set(){if(hasRequiredEs_reflect_set)return es_reflect_set;hasRequiredEs_reflect_set=1;var Y=require_export(),X=requireFunctionCall(),ee=requireAnObject(),ne=requireIsObject$1(),te=requireIsDataDescriptor(),ue=requireFails(),se=requireObjectDefineProperty(),ie=requireObjectGetOwnPropertyDescriptor(),t=requireObjectGetPrototypeOf(),H=requireCreatePropertyDescriptor();function ae(_e,ge,xe){var Re=arguments.length<4?_e:arguments[3],De=ie.f(ee(_e),ge),Ie,Ce,Ue;if(!De){if(ne(Ce=t(_e)))return ae(Ce,ge,xe,Re);De=H(0)}if(te(De)){if(De.writable===!1||!ne(Re))return!1;if(Ie=ie.f(Re,ge)){if(Ie.get||Ie.set||Ie.writable===!1)return!1;Ie.value=xe,se.f(Re,ge,Ie)}else se.f(Re,ge,H(0,xe))}else{if(Ue=De.set,Ue===void 0)return!1;X(Ue,Re,xe)}return!0}var he=ue(function(){var _e=function(){},ge=se.f(new _e,"a",{configurable:!0});return Reflect.set(_e.prototype,"a",1,ge)!==!1});return Y({target:"Reflect",stat:!0,forced:he},{set:ae}),es_reflect_set}var es_reflect_setPrototypeOf={},hasRequiredEs_reflect_setPrototypeOf;function requireEs_reflect_setPrototypeOf(){if(hasRequiredEs_reflect_setPrototypeOf)return es_reflect_setPrototypeOf;hasRequiredEs_reflect_setPrototypeOf=1;var Y=require_export(),X=requireAnObject(),ee=requireAPossiblePrototype(),ne=requireObjectSetPrototypeOf();return ne&&Y({target:"Reflect",stat:!0},{setPrototypeOf:function(ue,se){X(ue),ee(se);try{return ne(ue,se),!0}catch{return!1}}}),es_reflect_setPrototypeOf}var es_reflect_toStringTag={},hasRequiredEs_reflect_toStringTag;function requireEs_reflect_toStringTag(){if(hasRequiredEs_reflect_toStringTag)return es_reflect_toStringTag;hasRequiredEs_reflect_toStringTag=1;var Y=require_export(),X=requireGlobalThis(),ee=requireSetToStringTag();return Y({global:!0},{Reflect:{}}),ee(X.Reflect,"Reflect",!0),es_reflect_toStringTag}var es_regexp_constructor={},isRegexp,hasRequiredIsRegexp;function requireIsRegexp(){if(hasRequiredIsRegexp)return isRegexp;hasRequiredIsRegexp=1;var Y=requireIsObject$1(),X=requireClassofRaw(),ee=requireWellKnownSymbol(),ne=ee("match");return isRegexp=function(te){var ue;return Y(te)&&((ue=te[ne])!==void 0?!!ue:X(te)==="RegExp")},isRegexp}var regexpFlagsDetection,hasRequiredRegexpFlagsDetection;function requireRegexpFlagsDetection(){if(hasRequiredRegexpFlagsDetection)return regexpFlagsDetection;hasRequiredRegexpFlagsDetection=1;var Y=requireGlobalThis(),X=requireFails(),ee=Y.RegExp,ne=!X(function(){var te=!0;try{ee(".","d")}catch{te=!1}var ue={},se="",ie=te?"dgimsy":"gimsy",t=function(_e,ge){Object.defineProperty(ue,_e,{get:function(){return se+=ge,!0}})},H={dotAll:"s",global:"g",ignoreCase:"i",multiline:"m",sticky:"y"};te&&(H.hasIndices="d");for(var ae in H)t(ae,H[ae]);var he=Object.getOwnPropertyDescriptor(ee.prototype,"flags").get.call(ue);return he!==ie||se!==ie});return regexpFlagsDetection={correct:ne},regexpFlagsDetection}var regexpFlags,hasRequiredRegexpFlags;function requireRegexpFlags(){if(hasRequiredRegexpFlags)return regexpFlags;hasRequiredRegexpFlags=1;var Y=requireAnObject();return regexpFlags=function(){var X=Y(this),ee="";return X.hasIndices&&(ee+="d"),X.global&&(ee+="g"),X.ignoreCase&&(ee+="i"),X.multiline&&(ee+="m"),X.dotAll&&(ee+="s"),X.unicode&&(ee+="u"),X.unicodeSets&&(ee+="v"),X.sticky&&(ee+="y"),ee},regexpFlags}var regexpGetFlags,hasRequiredRegexpGetFlags;function requireRegexpGetFlags(){if(hasRequiredRegexpGetFlags)return regexpGetFlags;hasRequiredRegexpGetFlags=1;var Y=requireFunctionCall(),X=requireHasOwnProperty(),ee=requireObjectIsPrototypeOf(),ne=requireRegexpFlagsDetection(),te=requireRegexpFlags(),ue=RegExp.prototype;return regexpGetFlags=ne.correct?function(se){return se.flags}:function(se){return!ne.correct&&ee(ue,se)&&!X(se,"flags")?Y(te,se):se.flags},regexpGetFlags}var regexpStickyHelpers,hasRequiredRegexpStickyHelpers;function requireRegexpStickyHelpers(){if(hasRequiredRegexpStickyHelpers)return regexpStickyHelpers;hasRequiredRegexpStickyHelpers=1;var Y=requireFails(),X=requireGlobalThis(),ee=X.RegExp,ne=Y(function(){var se=ee("a","y");return se.lastIndex=2,se.exec("abcd")!==null}),te=ne||Y(function(){return!ee("a","y").sticky}),ue=ne||Y(function(){var se=ee("^r","gy");return se.lastIndex=2,se.exec("str")!==null});return regexpStickyHelpers={BROKEN_CARET:ue,MISSED_STICKY:te,UNSUPPORTED_Y:ne},regexpStickyHelpers}var regexpUnsupportedDotAll,hasRequiredRegexpUnsupportedDotAll;function requireRegexpUnsupportedDotAll(){if(hasRequiredRegexpUnsupportedDotAll)return regexpUnsupportedDotAll;hasRequiredRegexpUnsupportedDotAll=1;var Y=requireFails(),X=requireGlobalThis(),ee=X.RegExp;return regexpUnsupportedDotAll=Y(function(){var ne=ee(".","s");return!(ne.dotAll&&ne.test(`
`)&&ne.flags==="s")}),regexpUnsupportedDotAll}var regexpUnsupportedNcg,hasRequiredRegexpUnsupportedNcg;function requireRegexpUnsupportedNcg(){if(hasRequiredRegexpUnsupportedNcg)return regexpUnsupportedNcg;hasRequiredRegexpUnsupportedNcg=1;var Y=requireFails(),X=requireGlobalThis(),ee=X.RegExp;return regexpUnsupportedNcg=Y(function(){var ne=ee("(?<a>b)","g");return ne.exec("b").groups.a!=="b"||"b".replace(ne,"$<a>c")!=="bc"}),regexpUnsupportedNcg}var hasRequiredEs_regexp_constructor;function requireEs_regexp_constructor(){if(hasRequiredEs_regexp_constructor)return es_regexp_constructor;hasRequiredEs_regexp_constructor=1;var Y=requireDescriptors(),X=requireGlobalThis(),ee=requireFunctionUncurryThis(),ne=requireIsForced(),te=requireInheritIfRequired(),ue=requireCreateNonEnumerableProperty(),se=requireObjectCreate(),ie=requireObjectGetOwnPropertyNames().f,t=requireObjectIsPrototypeOf(),H=requireIsRegexp(),ae=requireToString$1(),he=requireRegexpGetFlags(),_e=requireRegexpStickyHelpers(),ge=requireProxyAccessor(),xe=requireDefineBuiltIn(),Re=requireFails(),De=requireHasOwnProperty(),Ie=requireInternalState().enforce,Ce=requireSetSpecies(),Ue=requireWellKnownSymbol(),Le=requireRegexpUnsupportedDotAll(),ke=requireRegexpUnsupportedNcg(),Ge=Ue("match"),Ze=X.RegExp,We=Ze.prototype,et=X.SyntaxError,He=ee(We.exec),ht=ee("".charAt),_t=ee("".replace),ut=ee("".indexOf),yt=ee("".slice),Lt=/^\?<[^\s\d!#%&*+<=>@^][^\s!#%&*+<=>@^]*>/,Kt=/a/g,ft=/a/g,qt=new Ze(Kt)!==Kt,nt=_e.MISSED_STICKY,At=_e.UNSUPPORTED_Y,wt=Y&&(!qt||nt||Le||ke||Re(function(){return ft[Ge]=!1,Ze(Kt)!==Kt||Ze(ft)===ft||String(Ze(Kt,"i"))!=="/a/i"})),Ft=function(Lr){for(var sr=Lr.length,Rr=0,Ur="",Wr=!1,Er;Rr<=sr;Rr++){if(Er=ht(Lr,Rr),Er==="\\"){Ur+=Er+ht(Lr,++Rr);continue}!Wr&&Er==="."?Ur+="[\\s\\S]":(Er==="["?Wr=!0:Er==="]"&&(Wr=!1),Ur+=Er)}return Ur},er=function(Lr){for(var sr=Lr.length,Rr=0,Ur="",Wr=[],Er=se(null),Kr=!1,ui=!1,Ei=0,Hr="",Br;Rr<=sr;Rr++){if(Br=ht(Lr,Rr),Br==="\\")Br+=ht(Lr,++Rr);else if(Br==="]")Kr=!1;else if(!Kr)switch(!0){case Br==="[":Kr=!0;break;case Br==="(":if(Ur+=Br,yt(Lr,Rr+1,Rr+3)==="?:")continue;He(Lt,yt(Lr,Rr+1))&&(Rr+=2,ui=!0),Ei++;continue;case(Br===">"&&ui):if(Hr===""||De(Er,Hr))throw new et("Invalid capture group name");Er[Hr]=!0,Wr[Wr.length]=[Hr,Ei],ui=!1,Hr="";continue}ui?Hr+=Br:Ur+=Br}return[Ur,Wr]};if(ne("RegExp",wt)){for(var lr=function(sr,Rr){var Ur=t(We,this),Wr=H(sr),Er=Rr===void 0,Kr=[],ui=sr,Ei,Hr,Br,li,si,Qr;if(!Ur&&Wr&&Er&&sr.constructor===lr)return sr;if((Wr||t(We,sr))&&(sr=sr.source,Er&&(Rr=he(ui))),sr=sr===void 0?"":ae(sr),Rr=Rr===void 0?"":ae(Rr),ui=sr,Le&&"dotAll"in Kt&&(Hr=!!Rr&&ut(Rr,"s")>-1,Hr&&(Rr=_t(Rr,/s/g,""))),Ei=Rr,nt&&"sticky"in Kt&&(Br=!!Rr&&ut(Rr,"y")>-1,Br&&At&&(Rr=_t(Rr,/y/g,""))),ke&&(li=er(sr),sr=li[0],Kr=li[1]),si=te(Ze(sr,Rr),Ur?this:We,lr),(Hr||Br||Kr.length)&&(Qr=Ie(si),Hr&&(Qr.dotAll=!0,Qr.raw=lr(Ft(sr),Ei)),Br&&(Qr.sticky=!0),Kr.length&&(Qr.groups=Kr)),sr!==ui)try{ue(si,"source",ui===""?"(?:)":ui)}catch{}return si},jr=ie(Ze),Mr=0;jr.length>Mr;)ge(lr,Ze,jr[Mr++]);We.constructor=lr,lr.prototype=We,xe(X,"RegExp",lr,{constructor:!0})}return Ce("RegExp"),es_regexp_constructor}var es_regexp_escape={},aString,hasRequiredAString;function requireAString(){if(hasRequiredAString)return aString;hasRequiredAString=1;var Y=TypeError;return aString=function(X){if(typeof X=="string")return X;throw new Y("Argument is not a string")},aString}var hasRequiredEs_regexp_escape;function requireEs_regexp_escape(){if(hasRequiredEs_regexp_escape)return es_regexp_escape;hasRequiredEs_regexp_escape=1;var Y=require_export(),X=requireFunctionUncurryThis(),ee=requireAString(),ne=requireHasOwnProperty(),te=requireStringPad().start,ue=requireWhitespaces(),se=Array,ie=RegExp.escape,t=X("".charAt),H=X("".charCodeAt),ae=X(1.1.toString),he=X([].join),_e=/^[0-9a-z]/i,ge=/^[$()*+./?[\\\]^{|}]/,xe=RegExp("^[!\"#%&',\\-:;<=>@`~"+ue+"]"),Re=X(_e.exec),De={"	":"t","\n":"n","\v":"v","\f":"f","\r":"r"},Ie=function(Ue){var Le=ae(H(Ue,0),16);return Le.length<3?"\\x"+te(Le,2,"0"):"\\u"+te(Le,4,"0")},Ce=!ie||ie("ab")!=="\\x61b";return Y({target:"RegExp",stat:!0,forced:Ce},{escape:function(Le){ee(Le);for(var ke=Le.length,Ge=se(ke),Ze=0;Ze<ke;Ze++){var We=t(Le,Ze);if(Ze===0&&Re(_e,We))Ge[Ze]=Ie(We);else if(ne(De,We))Ge[Ze]="\\"+De[We];else if(Re(ge,We))Ge[Ze]="\\"+We;else if(Re(xe,We))Ge[Ze]=Ie(We);else{var et=H(We,0);(et&63488)!==55296?Ge[Ze]=We:et>=56320||Ze+1>=ke||(H(Le,Ze+1)&64512)!==56320?Ge[Ze]=Ie(We):(Ge[Ze]=We,Ge[++Ze]=t(Le,Ze))}}return he(Ge,"")}}),es_regexp_escape}var es_regexp_dotAll={},hasRequiredEs_regexp_dotAll;function requireEs_regexp_dotAll(){if(hasRequiredEs_regexp_dotAll)return es_regexp_dotAll;hasRequiredEs_regexp_dotAll=1;var Y=requireDescriptors(),X=requireRegexpUnsupportedDotAll(),ee=requireClassofRaw(),ne=requireDefineBuiltInAccessor(),te=requireInternalState().get,ue=RegExp.prototype,se=TypeError;return Y&&X&&ne(ue,"dotAll",{configurable:!0,get:function(){if(this!==ue){if(ee(this)==="RegExp")return!!te(this).dotAll;throw new se("Incompatible receiver, RegExp required")}}}),es_regexp_dotAll}var es_regexp_exec={},regexpExec,hasRequiredRegexpExec;function requireRegexpExec(){if(hasRequiredRegexpExec)return regexpExec;hasRequiredRegexpExec=1;var Y=requireFunctionCall(),X=requireFunctionUncurryThis(),ee=requireToString$1(),ne=requireRegexpFlags(),te=requireRegexpStickyHelpers(),ue=requireShared(),se=requireObjectCreate(),ie=requireInternalState().get,t=requireRegexpUnsupportedDotAll(),H=requireRegexpUnsupportedNcg(),ae=ue("native-string-replace",String.prototype.replace),he=RegExp.prototype.exec,_e=he,ge=X("".charAt),xe=X("".indexOf),Re=X("".replace),De=X("".slice),Ie=function(){var ke=/a/,Ge=/b*/g;return Y(he,ke,"a"),Y(he,Ge,"a"),ke.lastIndex!==0||Ge.lastIndex!==0}(),Ce=te.BROKEN_CARET,Ue=/()??/.exec("")[1]!==void 0,Le=Ie||Ue||Ce||t||H;return Le&&(_e=function(Ge){var Ze=this,We=ie(Ze),et=ee(Ge),He=We.raw,ht,_t,ut,yt,Lt,Kt,ft;if(He)return He.lastIndex=Ze.lastIndex,ht=Y(_e,He,et),Ze.lastIndex=He.lastIndex,ht;var qt=We.groups,nt=Ce&&Ze.sticky,At=Y(ne,Ze),wt=Ze.source,Ft=0,er=et;if(nt&&(At=Re(At,"y",""),xe(At,"g")===-1&&(At+="g"),er=De(et,Ze.lastIndex),Ze.lastIndex>0&&(!Ze.multiline||Ze.multiline&&ge(et,Ze.lastIndex-1)!==`
`)&&(wt="(?: "+wt+")",er=" "+er,Ft++),_t=new RegExp("^(?:"+wt+")",At)),Ue&&(_t=new RegExp("^"+wt+"$(?!\\s)",At)),Ie&&(ut=Ze.lastIndex),yt=Y(he,nt?_t:Ze,er),nt?yt?(yt.input=De(yt.input,Ft),yt[0]=De(yt[0],Ft),yt.index=Ze.lastIndex,Ze.lastIndex+=yt[0].length):Ze.lastIndex=0:Ie&&yt&&(Ze.lastIndex=Ze.global?yt.index+yt[0].length:ut),Ue&&yt&&yt.length>1&&Y(ae,yt[0],_t,function(){for(Lt=1;Lt<arguments.length-2;Lt++)arguments[Lt]===void 0&&(yt[Lt]=void 0)}),yt&&qt)for(yt.groups=Kt=se(null),Lt=0;Lt<qt.length;Lt++)ft=qt[Lt],Kt[ft[0]]=yt[ft[1]];return yt}),regexpExec=_e,regexpExec}var hasRequiredEs_regexp_exec;function requireEs_regexp_exec(){if(hasRequiredEs_regexp_exec)return es_regexp_exec;hasRequiredEs_regexp_exec=1;var Y=require_export(),X=requireRegexpExec();return Y({target:"RegExp",proto:!0,forced:/./.exec!==X},{exec:X}),es_regexp_exec}var es_regexp_flags={},hasRequiredEs_regexp_flags;function requireEs_regexp_flags(){if(hasRequiredEs_regexp_flags)return es_regexp_flags;hasRequiredEs_regexp_flags=1;var Y=requireDescriptors(),X=requireDefineBuiltInAccessor(),ee=requireRegexpFlagsDetection(),ne=requireRegexpFlags();return Y&&!ee.correct&&(X(RegExp.prototype,"flags",{configurable:!0,get:ne}),ee.correct=!0),es_regexp_flags}var es_regexp_sticky={},hasRequiredEs_regexp_sticky;function requireEs_regexp_sticky(){if(hasRequiredEs_regexp_sticky)return es_regexp_sticky;hasRequiredEs_regexp_sticky=1;var Y=requireDescriptors(),X=requireRegexpStickyHelpers().MISSED_STICKY,ee=requireClassofRaw(),ne=requireDefineBuiltInAccessor(),te=requireInternalState().get,ue=RegExp.prototype,se=TypeError;return Y&&X&&ne(ue,"sticky",{configurable:!0,get:function(){if(this!==ue){if(ee(this)==="RegExp")return!!te(this).sticky;throw new se("Incompatible receiver, RegExp required")}}}),es_regexp_sticky}var es_regexp_test={},hasRequiredEs_regexp_test;function requireEs_regexp_test(){if(hasRequiredEs_regexp_test)return es_regexp_test;hasRequiredEs_regexp_test=1,requireEs_regexp_exec();var Y=require_export(),X=requireFunctionCall(),ee=requireIsCallable(),ne=requireAnObject(),te=requireToString$1(),ue=function(){var ie=!1,t=/[ac]/;return t.exec=function(){return ie=!0,/./.exec.apply(this,arguments)},t.test("abc")===!0&&ie}(),se=/./.test;return Y({target:"RegExp",proto:!0,forced:!ue},{test:function(ie){var t=ne(this),H=te(ie),ae=t.exec;if(!ee(ae))return X(se,t,H);var he=X(ae,t,H);return he===null?!1:(ne(he),!0)}}),es_regexp_test}var es_regexp_toString={},hasRequiredEs_regexp_toString;function requireEs_regexp_toString(){if(hasRequiredEs_regexp_toString)return es_regexp_toString;hasRequiredEs_regexp_toString=1;var Y=requireFunctionName().PROPER,X=requireDefineBuiltIn(),ee=requireAnObject(),ne=requireToString$1(),te=requireFails(),ue=requireRegexpGetFlags(),se="toString",ie=RegExp.prototype,t=ie[se],H=te(function(){return t.call({source:"a",flags:"b"})!=="/a/b"}),ae=Y&&t.name!==se;return(H||ae)&&X(ie,se,function(){var _e=ee(this),ge=ne(_e.source),xe=ne(ue(_e));return"/"+ge+"/"+xe},{unsafe:!0}),es_regexp_toString}var es_set={},es_set_constructor={},hasRequiredEs_set_constructor;function requireEs_set_constructor(){if(hasRequiredEs_set_constructor)return es_set_constructor;hasRequiredEs_set_constructor=1;var Y=requireCollection(),X=requireCollectionStrong();return Y("Set",function(ee){return function(){return ee(this,arguments.length?arguments[0]:void 0)}},X),es_set_constructor}var hasRequiredEs_set;function requireEs_set(){return hasRequiredEs_set||(hasRequiredEs_set=1,requireEs_set_constructor()),es_set}var es_set_difference_v2={},setHelpers,hasRequiredSetHelpers;function requireSetHelpers(){if(hasRequiredSetHelpers)return setHelpers;hasRequiredSetHelpers=1;var Y=requireFunctionUncurryThis(),X=Set.prototype;return setHelpers={Set,add:Y(X.add),has:Y(X.has),remove:Y(X.delete),proto:X},setHelpers}var aSet,hasRequiredASet;function requireASet(){if(hasRequiredASet)return aSet;hasRequiredASet=1;var Y=requireSetHelpers().has;return aSet=function(X){return Y(X),X},aSet}var iterateSimple,hasRequiredIterateSimple;function requireIterateSimple(){if(hasRequiredIterateSimple)return iterateSimple;hasRequiredIterateSimple=1;var Y=requireFunctionCall();return iterateSimple=function(X,ee,ne){for(var te=ne?X:X.iterator,ue=X.next,se,ie;!(se=Y(ue,te)).done;)if(ie=ee(se.value),ie!==void 0)return ie},iterateSimple}var setIterate,hasRequiredSetIterate;function requireSetIterate(){if(hasRequiredSetIterate)return setIterate;hasRequiredSetIterate=1;var Y=requireFunctionUncurryThis(),X=requireIterateSimple(),ee=requireSetHelpers(),ne=ee.Set,te=ee.proto,ue=Y(te.forEach),se=Y(te.keys),ie=se(new ne).next;return setIterate=function(t,H,ae){return ae?X({iterator:se(t),next:ie},H):ue(t,H)},setIterate}var setClone,hasRequiredSetClone;function requireSetClone(){if(hasRequiredSetClone)return setClone;hasRequiredSetClone=1;var Y=requireSetHelpers(),X=requireSetIterate(),ee=Y.Set,ne=Y.add;return setClone=function(te){var ue=new ee;return X(te,function(se){ne(ue,se)}),ue},setClone}var setSize,hasRequiredSetSize;function requireSetSize(){if(hasRequiredSetSize)return setSize;hasRequiredSetSize=1;var Y=requireFunctionUncurryThisAccessor(),X=requireSetHelpers();return setSize=Y(X.proto,"size","get")||function(ee){return ee.size},setSize}var getSetRecord,hasRequiredGetSetRecord;function requireGetSetRecord(){if(hasRequiredGetSetRecord)return getSetRecord;hasRequiredGetSetRecord=1;var Y=requireACallable(),X=requireAnObject(),ee=requireFunctionCall(),ne=requireToIntegerOrInfinity(),te=requireGetIteratorDirect(),ue="Invalid size",se=RangeError,ie=TypeError,t=Math.max,H=function(ae,he){this.set=ae,this.size=t(he,0),this.has=Y(ae.has),this.keys=Y(ae.keys)};return H.prototype={getIterator:function(){return te(X(ee(this.keys,this.set)))},includes:function(ae){return ee(this.has,this.set,ae)}},getSetRecord=function(ae){X(ae);var he=+ae.size;if(he!==he)throw new ie(ue);var _e=ne(he);if(_e<0)throw new se(ue);return new H(ae,_e)},getSetRecord}var setDifference,hasRequiredSetDifference;function requireSetDifference(){if(hasRequiredSetDifference)return setDifference;hasRequiredSetDifference=1;var Y=requireASet(),X=requireSetHelpers(),ee=requireSetClone(),ne=requireSetSize(),te=requireGetSetRecord(),ue=requireSetIterate(),se=requireIterateSimple(),ie=X.has,t=X.remove;return setDifference=function(ae){var he=Y(this),_e=te(ae),ge=ee(he);return ne(he)<=_e.size?ue(he,function(xe){_e.includes(xe)&&t(ge,xe)}):se(_e.getIterator(),function(xe){ie(ge,xe)&&t(ge,xe)}),ge},setDifference}var setMethodAcceptSetLike,hasRequiredSetMethodAcceptSetLike;function requireSetMethodAcceptSetLike(){if(hasRequiredSetMethodAcceptSetLike)return setMethodAcceptSetLike;hasRequiredSetMethodAcceptSetLike=1;var Y=requireGetBuiltIn(),X=function(ne){return{size:ne,has:function(){return!1},keys:function(){return{next:function(){return{done:!0}}}}}},ee=function(ne){return{size:ne,has:function(){return!0},keys:function(){throw new Error("e")}}};return setMethodAcceptSetLike=function(ne,te){var ue=Y("Set");try{new ue()[ne](X(0));try{return new ue()[ne](X(-1)),!1}catch{if(!te)return!0;try{return new ue()[ne](ee(-1/0)),!1}catch{var se=new ue;return se.add(1),se.add(2),te(se[ne](ee(1/0)))}}}catch{return!1}},setMethodAcceptSetLike}var hasRequiredEs_set_difference_v2;function requireEs_set_difference_v2(){if(hasRequiredEs_set_difference_v2)return es_set_difference_v2;hasRequiredEs_set_difference_v2=1;var Y=require_export(),X=requireSetDifference(),ee=requireFails(),ne=requireSetMethodAcceptSetLike(),te=!ne("difference",function(se){return se.size===0}),ue=te||ee(function(){var se={size:1,has:function(){return!0},keys:function(){var t=0;return{next:function(){var H=t++>1;return ie.has(1)&&ie.clear(),{done:H,value:2}}}}},ie=new Set([1,2,3,4]);return ie.difference(se).size!==3});return Y({target:"Set",proto:!0,real:!0,forced:ue},{difference:X}),es_set_difference_v2}var es_set_intersection_v2={},setIntersection,hasRequiredSetIntersection;function requireSetIntersection(){if(hasRequiredSetIntersection)return setIntersection;hasRequiredSetIntersection=1;var Y=requireASet(),X=requireSetHelpers(),ee=requireSetSize(),ne=requireGetSetRecord(),te=requireSetIterate(),ue=requireIterateSimple(),se=X.Set,ie=X.add,t=X.has;return setIntersection=function(ae){var he=Y(this),_e=ne(ae),ge=new se;return ee(he)>_e.size?ue(_e.getIterator(),function(xe){t(he,xe)&&ie(ge,xe)}):te(he,function(xe){_e.includes(xe)&&ie(ge,xe)}),ge},setIntersection}var hasRequiredEs_set_intersection_v2;function requireEs_set_intersection_v2(){if(hasRequiredEs_set_intersection_v2)return es_set_intersection_v2;hasRequiredEs_set_intersection_v2=1;var Y=require_export(),X=requireFails(),ee=requireSetIntersection(),ne=requireSetMethodAcceptSetLike(),te=!ne("intersection",function(ue){return ue.size===2&&ue.has(1)&&ue.has(2)})||X(function(){return String(Array.from(new Set([1,2,3]).intersection(new Set([3,2]))))!=="3,2"});return Y({target:"Set",proto:!0,real:!0,forced:te},{intersection:ee}),es_set_intersection_v2}var es_set_isDisjointFrom_v2={},setIsDisjointFrom,hasRequiredSetIsDisjointFrom;function requireSetIsDisjointFrom(){if(hasRequiredSetIsDisjointFrom)return setIsDisjointFrom;hasRequiredSetIsDisjointFrom=1;var Y=requireASet(),X=requireSetHelpers().has,ee=requireSetSize(),ne=requireGetSetRecord(),te=requireSetIterate(),ue=requireIterateSimple(),se=requireIteratorClose();return setIsDisjointFrom=function(t){var H=Y(this),ae=ne(t);if(ee(H)<=ae.size)return te(H,function(_e){if(ae.includes(_e))return!1},!0)!==!1;var he=ae.getIterator();return ue(he,function(_e){if(X(H,_e))return se(he,"normal",!1)})!==!1},setIsDisjointFrom}var hasRequiredEs_set_isDisjointFrom_v2;function requireEs_set_isDisjointFrom_v2(){if(hasRequiredEs_set_isDisjointFrom_v2)return es_set_isDisjointFrom_v2;hasRequiredEs_set_isDisjointFrom_v2=1;var Y=require_export(),X=requireSetIsDisjointFrom(),ee=requireSetMethodAcceptSetLike(),ne=!ee("isDisjointFrom",function(te){return!te});return Y({target:"Set",proto:!0,real:!0,forced:ne},{isDisjointFrom:X}),es_set_isDisjointFrom_v2}var es_set_isSubsetOf_v2={},setIsSubsetOf,hasRequiredSetIsSubsetOf;function requireSetIsSubsetOf(){if(hasRequiredSetIsSubsetOf)return setIsSubsetOf;hasRequiredSetIsSubsetOf=1;var Y=requireASet(),X=requireSetSize(),ee=requireSetIterate(),ne=requireGetSetRecord();return setIsSubsetOf=function(ue){var se=Y(this),ie=ne(ue);return X(se)>ie.size?!1:ee(se,function(t){if(!ie.includes(t))return!1},!0)!==!1},setIsSubsetOf}var hasRequiredEs_set_isSubsetOf_v2;function requireEs_set_isSubsetOf_v2(){if(hasRequiredEs_set_isSubsetOf_v2)return es_set_isSubsetOf_v2;hasRequiredEs_set_isSubsetOf_v2=1;var Y=require_export(),X=requireSetIsSubsetOf(),ee=requireSetMethodAcceptSetLike(),ne=!ee("isSubsetOf",function(te){return te});return Y({target:"Set",proto:!0,real:!0,forced:ne},{isSubsetOf:X}),es_set_isSubsetOf_v2}var es_set_isSupersetOf_v2={},setIsSupersetOf,hasRequiredSetIsSupersetOf;function requireSetIsSupersetOf(){if(hasRequiredSetIsSupersetOf)return setIsSupersetOf;hasRequiredSetIsSupersetOf=1;var Y=requireASet(),X=requireSetHelpers().has,ee=requireSetSize(),ne=requireGetSetRecord(),te=requireIterateSimple(),ue=requireIteratorClose();return setIsSupersetOf=function(ie){var t=Y(this),H=ne(ie);if(ee(t)<H.size)return!1;var ae=H.getIterator();return te(ae,function(he){if(!X(t,he))return ue(ae,"normal",!1)})!==!1},setIsSupersetOf}var hasRequiredEs_set_isSupersetOf_v2;function requireEs_set_isSupersetOf_v2(){if(hasRequiredEs_set_isSupersetOf_v2)return es_set_isSupersetOf_v2;hasRequiredEs_set_isSupersetOf_v2=1;var Y=require_export(),X=requireSetIsSupersetOf(),ee=requireSetMethodAcceptSetLike(),ne=!ee("isSupersetOf",function(te){return!te});return Y({target:"Set",proto:!0,real:!0,forced:ne},{isSupersetOf:X}),es_set_isSupersetOf_v2}var es_set_symmetricDifference_v2={},setSymmetricDifference,hasRequiredSetSymmetricDifference;function requireSetSymmetricDifference(){if(hasRequiredSetSymmetricDifference)return setSymmetricDifference;hasRequiredSetSymmetricDifference=1;var Y=requireASet(),X=requireSetHelpers(),ee=requireSetClone(),ne=requireGetSetRecord(),te=requireIterateSimple(),ue=X.add,se=X.has,ie=X.remove;return setSymmetricDifference=function(H){var ae=Y(this),he=ne(H).getIterator(),_e=ee(ae);return te(he,function(ge){se(ae,ge)?ie(_e,ge):ue(_e,ge)}),_e},setSymmetricDifference}var setMethodGetKeysBeforeCloningDetection,hasRequiredSetMethodGetKeysBeforeCloningDetection;function requireSetMethodGetKeysBeforeCloningDetection(){return hasRequiredSetMethodGetKeysBeforeCloningDetection||(hasRequiredSetMethodGetKeysBeforeCloningDetection=1,setMethodGetKeysBeforeCloningDetection=function(Y){try{var X=new Set,ee={size:0,has:function(){return!0},keys:function(){return Object.defineProperty({},"next",{get:function(){return X.clear(),X.add(4),function(){return{done:!0}}}})}},ne=X[Y](ee);return ne.size===1&&ne.values().next().value===4}catch{return!1}}),setMethodGetKeysBeforeCloningDetection}var hasRequiredEs_set_symmetricDifference_v2;function requireEs_set_symmetricDifference_v2(){if(hasRequiredEs_set_symmetricDifference_v2)return es_set_symmetricDifference_v2;hasRequiredEs_set_symmetricDifference_v2=1;var Y=require_export(),X=requireSetSymmetricDifference(),ee=requireSetMethodGetKeysBeforeCloningDetection(),ne=requireSetMethodAcceptSetLike(),te=!ne("symmetricDifference")||!ee("symmetricDifference");return Y({target:"Set",proto:!0,real:!0,forced:te},{symmetricDifference:X}),es_set_symmetricDifference_v2}var es_set_union_v2={},setUnion,hasRequiredSetUnion;function requireSetUnion(){if(hasRequiredSetUnion)return setUnion;hasRequiredSetUnion=1;var Y=requireASet(),X=requireSetHelpers().add,ee=requireSetClone(),ne=requireGetSetRecord(),te=requireIterateSimple();return setUnion=function(se){var ie=Y(this),t=ne(se).getIterator(),H=ee(ie);return te(t,function(ae){X(H,ae)}),H},setUnion}var hasRequiredEs_set_union_v2;function requireEs_set_union_v2(){if(hasRequiredEs_set_union_v2)return es_set_union_v2;hasRequiredEs_set_union_v2=1;var Y=require_export(),X=requireSetUnion(),ee=requireSetMethodGetKeysBeforeCloningDetection(),ne=requireSetMethodAcceptSetLike(),te=!ne("union")||!ee("union");return Y({target:"Set",proto:!0,real:!0,forced:te},{union:X}),es_set_union_v2}var es_string_atAlternative={},hasRequiredEs_string_atAlternative;function requireEs_string_atAlternative(){if(hasRequiredEs_string_atAlternative)return es_string_atAlternative;hasRequiredEs_string_atAlternative=1;var Y=require_export(),X=requireFunctionUncurryThis(),ee=requireRequireObjectCoercible(),ne=requireToIntegerOrInfinity(),te=requireToString$1(),ue=requireFails(),se=X("".charAt),ie=ue(function(){return"𠮷".at(-2)!=="\uD842"});return Y({target:"String",proto:!0,forced:ie},{at:function(H){var ae=te(ee(this)),he=ae.length,_e=ne(H),ge=_e>=0?_e:he+_e;return ge<0||ge>=he?void 0:se(ae,ge)}}),es_string_atAlternative}var es_string_codePointAt={},stringMultibyte,hasRequiredStringMultibyte;function requireStringMultibyte(){if(hasRequiredStringMultibyte)return stringMultibyte;hasRequiredStringMultibyte=1;var Y=requireFunctionUncurryThis(),X=requireToIntegerOrInfinity(),ee=requireToString$1(),ne=requireRequireObjectCoercible(),te=Y("".charAt),ue=Y("".charCodeAt),se=Y("".slice),ie=function(t){return function(H,ae){var he=ee(ne(H)),_e=X(ae),ge=he.length,xe,Re;return _e<0||_e>=ge?t?"":void 0:(xe=ue(he,_e),xe<55296||xe>56319||_e+1===ge||(Re=ue(he,_e+1))<56320||Re>57343?t?te(he,_e):xe:t?se(he,_e,_e+2):(xe-55296<<10)+(Re-56320)+65536)}};return stringMultibyte={codeAt:ie(!1),charAt:ie(!0)},stringMultibyte}var hasRequiredEs_string_codePointAt;function requireEs_string_codePointAt(){if(hasRequiredEs_string_codePointAt)return es_string_codePointAt;hasRequiredEs_string_codePointAt=1;var Y=require_export(),X=requireStringMultibyte().codeAt;return Y({target:"String",proto:!0},{codePointAt:function(ne){return X(this,ne)}}),es_string_codePointAt}var es_string_endsWith={},notARegexp,hasRequiredNotARegexp;function requireNotARegexp(){if(hasRequiredNotARegexp)return notARegexp;hasRequiredNotARegexp=1;var Y=requireIsRegexp(),X=TypeError;return notARegexp=function(ee){if(Y(ee))throw new X("The method doesn't accept regular expressions");return ee},notARegexp}var correctIsRegexpLogic,hasRequiredCorrectIsRegexpLogic;function requireCorrectIsRegexpLogic(){if(hasRequiredCorrectIsRegexpLogic)return correctIsRegexpLogic;hasRequiredCorrectIsRegexpLogic=1;var Y=requireWellKnownSymbol(),X=Y("match");return correctIsRegexpLogic=function(ee){var ne=/./;try{"/./"[ee](ne)}catch{try{return ne[X]=!1,"/./"[ee](ne)}catch{}}return!1},correctIsRegexpLogic}var hasRequiredEs_string_endsWith;function requireEs_string_endsWith(){if(hasRequiredEs_string_endsWith)return es_string_endsWith;hasRequiredEs_string_endsWith=1;var Y=require_export(),X=requireFunctionUncurryThisClause(),ee=requireObjectGetOwnPropertyDescriptor().f,ne=requireToLength(),te=requireToString$1(),ue=requireNotARegexp(),se=requireRequireObjectCoercible(),ie=requireCorrectIsRegexpLogic(),t=requireIsPure(),H=X("".slice),ae=Math.min,he=ie("endsWith"),_e=!t&&!he&&!!function(){var ge=ee(String.prototype,"endsWith");return ge&&!ge.writable}();return Y({target:"String",proto:!0,forced:!_e&&!he},{endsWith:function(xe){var Re=te(se(this));ue(xe);var De=arguments.length>1?arguments[1]:void 0,Ie=Re.length,Ce=De===void 0?Ie:ae(ne(De),Ie),Ue=te(xe);return H(Re,Ce-Ue.length,Ce)===Ue}}),es_string_endsWith}var es_string_fromCodePoint={},hasRequiredEs_string_fromCodePoint;function requireEs_string_fromCodePoint(){if(hasRequiredEs_string_fromCodePoint)return es_string_fromCodePoint;hasRequiredEs_string_fromCodePoint=1;var Y=require_export(),X=requireFunctionUncurryThis(),ee=requireToAbsoluteIndex(),ne=RangeError,te=String.fromCharCode,ue=String.fromCodePoint,se=X([].join),ie=!!ue&&ue.length!==1;return Y({target:"String",stat:!0,arity:1,forced:ie},{fromCodePoint:function(H){for(var ae=[],he=arguments.length,_e=0,ge;he>_e;){if(ge=+arguments[_e++],ee(ge,1114111)!==ge)throw new ne(ge+" is not a valid code point");ae[_e]=ge<65536?te(ge):te(((ge-=65536)>>10)+55296,ge%1024+56320)}return se(ae,"")}}),es_string_fromCodePoint}var es_string_includes={},hasRequiredEs_string_includes;function requireEs_string_includes(){if(hasRequiredEs_string_includes)return es_string_includes;hasRequiredEs_string_includes=1;var Y=require_export(),X=requireFunctionUncurryThis(),ee=requireNotARegexp(),ne=requireRequireObjectCoercible(),te=requireToString$1(),ue=requireCorrectIsRegexpLogic(),se=X("".indexOf);return Y({target:"String",proto:!0,forced:!ue("includes")},{includes:function(t){return!!~se(te(ne(this)),te(ee(t)),arguments.length>1?arguments[1]:void 0)}}),es_string_includes}var es_string_isWellFormed={},hasRequiredEs_string_isWellFormed;function requireEs_string_isWellFormed(){if(hasRequiredEs_string_isWellFormed)return es_string_isWellFormed;hasRequiredEs_string_isWellFormed=1;var Y=require_export(),X=requireFunctionUncurryThis(),ee=requireRequireObjectCoercible(),ne=requireToString$1(),te=X("".charCodeAt);return Y({target:"String",proto:!0},{isWellFormed:function(){for(var se=ne(ee(this)),ie=se.length,t=0;t<ie;t++){var H=te(se,t);if((H&63488)===55296&&(H>=56320||++t>=ie||(te(se,t)&64512)!==56320))return!1}return!0}}),es_string_isWellFormed}var es_string_iterator={},hasRequiredEs_string_iterator;function requireEs_string_iterator(){if(hasRequiredEs_string_iterator)return es_string_iterator;hasRequiredEs_string_iterator=1;var Y=requireStringMultibyte().charAt,X=requireToString$1(),ee=requireInternalState(),ne=requireIteratorDefine(),te=requireCreateIterResultObject(),ue="String Iterator",se=ee.set,ie=ee.getterFor(ue);return ne(String,"String",function(t){se(this,{type:ue,string:X(t),index:0})},function(){var H=ie(this),ae=H.string,he=H.index,_e;return he>=ae.length?te(void 0,!0):(_e=Y(ae,he),H.index+=_e.length,te(_e,!1))}),es_string_iterator}var es_string_match={},fixRegexpWellKnownSymbolLogic,hasRequiredFixRegexpWellKnownSymbolLogic;function requireFixRegexpWellKnownSymbolLogic(){if(hasRequiredFixRegexpWellKnownSymbolLogic)return fixRegexpWellKnownSymbolLogic;hasRequiredFixRegexpWellKnownSymbolLogic=1,requireEs_regexp_exec();var Y=requireFunctionCall(),X=requireDefineBuiltIn(),ee=requireRegexpExec(),ne=requireFails(),te=requireWellKnownSymbol(),ue=requireCreateNonEnumerableProperty(),se=te("species"),ie=RegExp.prototype;return fixRegexpWellKnownSymbolLogic=function(t,H,ae,he){var _e=te(t),ge=!ne(function(){var Ie={};return Ie[_e]=function(){return 7},""[t](Ie)!==7}),xe=ge&&!ne(function(){var Ie=!1,Ce=/a/;return t==="split"&&(Ce={},Ce.constructor={},Ce.constructor[se]=function(){return Ce},Ce.flags="",Ce[_e]=/./[_e]),Ce.exec=function(){return Ie=!0,null},Ce[_e](""),!Ie});if(!ge||!xe||ae){var Re=/./[_e],De=H(_e,""[t],function(Ie,Ce,Ue,Le,ke){var Ge=Ce.exec;return Ge===ee||Ge===ie.exec?ge&&!ke?{done:!0,value:Y(Re,Ce,Ue,Le)}:{done:!0,value:Y(Ie,Ue,Ce,Le)}:{done:!1}});X(String.prototype,t,De[0]),X(ie,_e,De[1])}he&&ue(ie[_e],"sham",!0)},fixRegexpWellKnownSymbolLogic}var advanceStringIndex,hasRequiredAdvanceStringIndex;function requireAdvanceStringIndex(){if(hasRequiredAdvanceStringIndex)return advanceStringIndex;hasRequiredAdvanceStringIndex=1;var Y=requireStringMultibyte().charAt;return advanceStringIndex=function(X,ee,ne){return ee+(ne?Y(X,ee).length:1)},advanceStringIndex}var regexpExecAbstract,hasRequiredRegexpExecAbstract;function requireRegexpExecAbstract(){if(hasRequiredRegexpExecAbstract)return regexpExecAbstract;hasRequiredRegexpExecAbstract=1;var Y=requireFunctionCall(),X=requireAnObject(),ee=requireIsCallable(),ne=requireClassofRaw(),te=requireRegexpExec(),ue=TypeError;return regexpExecAbstract=function(se,ie){var t=se.exec;if(ee(t)){var H=Y(t,se,ie);return H!==null&&X(H),H}if(ne(se)==="RegExp")return Y(te,se,ie);throw new ue("RegExp#exec called on incompatible receiver")},regexpExecAbstract}var hasRequiredEs_string_match;function requireEs_string_match(){if(hasRequiredEs_string_match)return es_string_match;hasRequiredEs_string_match=1;var Y=requireFunctionCall(),X=requireFunctionUncurryThis(),ee=requireFixRegexpWellKnownSymbolLogic(),ne=requireAnObject(),te=requireIsObject$1(),ue=requireToLength(),se=requireToString$1(),ie=requireRequireObjectCoercible(),t=requireGetMethod(),H=requireAdvanceStringIndex(),ae=requireRegexpGetFlags(),he=requireRegexpExecAbstract(),_e=X("".indexOf);return ee("match",function(ge,xe,Re){return[function(Ie){var Ce=ie(this),Ue=te(Ie)?t(Ie,ge):void 0;return Ue?Y(Ue,Ie,Ce):new RegExp(Ie)[ge](se(Ce))},function(De){var Ie=ne(this),Ce=se(De),Ue=Re(xe,Ie,Ce);if(Ue.done)return Ue.value;var Le=se(ae(Ie));if(_e(Le,"g")===-1)return he(Ie,Ce);var ke=_e(Le,"u")!==-1;Ie.lastIndex=0;for(var Ge=[],Ze=0,We;(We=he(Ie,Ce))!==null;){var et=se(We[0]);Ge[Ze]=et,et===""&&(Ie.lastIndex=H(Ce,ue(Ie.lastIndex),ke)),Ze++}return Ze===0?null:Ge}]}),es_string_match}var es_string_matchAll={},hasRequiredEs_string_matchAll;function requireEs_string_matchAll(){if(hasRequiredEs_string_matchAll)return es_string_matchAll;hasRequiredEs_string_matchAll=1;var Y=require_export(),X=requireFunctionCall(),ee=requireFunctionUncurryThisClause(),ne=requireIteratorCreateConstructor(),te=requireCreateIterResultObject(),ue=requireRequireObjectCoercible(),se=requireToLength(),ie=requireToString$1(),t=requireAnObject(),H=requireIsObject$1(),ae=requireClassofRaw(),he=requireIsRegexp(),_e=requireRegexpGetFlags(),ge=requireGetMethod(),xe=requireDefineBuiltIn(),Re=requireFails(),De=requireWellKnownSymbol(),Ie=requireSpeciesConstructor(),Ce=requireAdvanceStringIndex(),Ue=requireRegexpExecAbstract(),Le=requireInternalState(),ke=requireIsPure(),Ge=De("matchAll"),Ze="RegExp String",We=Ze+" Iterator",et=Le.set,He=Le.getterFor(We),ht=RegExp.prototype,_t=TypeError,ut=ee("".indexOf),yt=ee("".matchAll),Lt=!!yt&&!Re(function(){yt("a",/./)}),Kt=ne(function(nt,At,wt,Ft){et(this,{type:We,regexp:nt,string:At,global:wt,unicode:Ft,done:!1})},Ze,function(){var nt=He(this);if(nt.done)return te(void 0,!0);var At=nt.regexp,wt=nt.string,Ft=Ue(At,wt);return Ft===null?(nt.done=!0,te(void 0,!0)):nt.global?(ie(Ft[0])===""&&(At.lastIndex=Ce(wt,se(At.lastIndex),nt.unicode)),te(Ft,!1)):(nt.done=!0,te(Ft,!1))}),ft=function(qt){var nt=t(this),At=ie(qt),wt=Ie(nt,RegExp),Ft=ie(_e(nt)),er,lr,jr;return er=new wt(wt===RegExp?nt.source:nt,Ft),lr=!!~ut(Ft,"g"),jr=!!~ut(Ft,"u"),er.lastIndex=se(nt.lastIndex),new Kt(er,At,lr,jr)};return Y({target:"String",proto:!0,forced:Lt},{matchAll:function(nt){var At=ue(this),wt,Ft,er,lr;if(H(nt)){if(he(nt)&&(wt=ie(ue(_e(nt))),!~ut(wt,"g")))throw new _t("`.matchAll` does not allow non-global regexes");if(Lt)return yt(At,nt);if(er=ge(nt,Ge),er===void 0&&ke&&ae(nt)==="RegExp"&&(er=ft),er)return X(er,nt,At)}else if(Lt)return yt(At,nt);return Ft=ie(At),lr=new RegExp(nt,"g"),ke?X(ft,lr,Ft):lr[Ge](Ft)}}),ke||Ge in ht||xe(ht,Ge,ft),es_string_matchAll}var es_string_padEnd={},stringPadWebkitBug,hasRequiredStringPadWebkitBug;function requireStringPadWebkitBug(){if(hasRequiredStringPadWebkitBug)return stringPadWebkitBug;hasRequiredStringPadWebkitBug=1;var Y=requireEnvironmentUserAgent();return stringPadWebkitBug=/Version\/10(?:\.\d+){1,2}(?: [\w./]+)?(?: Mobile\/\w+)? Safari\//.test(Y),stringPadWebkitBug}var hasRequiredEs_string_padEnd;function requireEs_string_padEnd(){if(hasRequiredEs_string_padEnd)return es_string_padEnd;hasRequiredEs_string_padEnd=1;var Y=require_export(),X=requireStringPad().end,ee=requireStringPadWebkitBug();return Y({target:"String",proto:!0,forced:ee},{padEnd:function(te){return X(this,te,arguments.length>1?arguments[1]:void 0)}}),es_string_padEnd}var es_string_padStart={},hasRequiredEs_string_padStart;function requireEs_string_padStart(){if(hasRequiredEs_string_padStart)return es_string_padStart;hasRequiredEs_string_padStart=1;var Y=require_export(),X=requireStringPad().start,ee=requireStringPadWebkitBug();return Y({target:"String",proto:!0,forced:ee},{padStart:function(te){return X(this,te,arguments.length>1?arguments[1]:void 0)}}),es_string_padStart}var es_string_raw={},hasRequiredEs_string_raw;function requireEs_string_raw(){if(hasRequiredEs_string_raw)return es_string_raw;hasRequiredEs_string_raw=1;var Y=require_export(),X=requireFunctionUncurryThis(),ee=requireToIndexedObject(),ne=requireToObject(),te=requireToString$1(),ue=requireLengthOfArrayLike(),se=X([].push),ie=X([].join);return Y({target:"String",stat:!0},{raw:function(H){var ae=ee(ne(H).raw),he=ue(ae);if(!he)return"";for(var _e=arguments.length,ge=[],xe=0;;){if(se(ge,te(ae[xe++])),xe===he)return ie(ge,"");xe<_e&&se(ge,te(arguments[xe]))}}}),es_string_raw}var es_string_repeat={},hasRequiredEs_string_repeat;function requireEs_string_repeat(){if(hasRequiredEs_string_repeat)return es_string_repeat;hasRequiredEs_string_repeat=1;var Y=require_export(),X=requireStringRepeat();return Y({target:"String",proto:!0},{repeat:X}),es_string_repeat}var es_string_replace={},getSubstitution,hasRequiredGetSubstitution;function requireGetSubstitution(){if(hasRequiredGetSubstitution)return getSubstitution;hasRequiredGetSubstitution=1;var Y=requireFunctionUncurryThis(),X=requireToObject(),ee=Math.floor,ne=Y("".charAt),te=Y("".replace),ue=Y("".slice),se=/\$([$&'`]|\d{1,2}|<[^>]*>)/g,ie=/\$([$&'`]|\d{1,2})/g;return getSubstitution=function(t,H,ae,he,_e,ge){var xe=ae+t.length,Re=he.length,De=ie;return _e!==void 0&&(_e=X(_e),De=se),te(ge,De,function(Ie,Ce){var Ue;switch(ne(Ce,0)){case"$":return"$";case"&":return t;case"`":return ue(H,0,ae);case"'":return ue(H,xe);case"<":Ue=_e[ue(Ce,1,-1)];break;default:var Le=+Ce;if(Le===0)return Ie;if(Le>Re){var ke=ee(Le/10);return ke===0?Ie:ke<=Re?he[ke-1]===void 0?ne(Ce,1):he[ke-1]+ne(Ce,1):Ie}Ue=he[Le-1]}return Ue===void 0?"":Ue})},getSubstitution}var hasRequiredEs_string_replace;function requireEs_string_replace(){if(hasRequiredEs_string_replace)return es_string_replace;hasRequiredEs_string_replace=1;var Y=requireFunctionApply(),X=requireFunctionCall(),ee=requireFunctionUncurryThis(),ne=requireFixRegexpWellKnownSymbolLogic(),te=requireFails(),ue=requireAnObject(),se=requireIsCallable(),ie=requireIsObject$1(),t=requireToIntegerOrInfinity(),H=requireToLength(),ae=requireToString$1(),he=requireRequireObjectCoercible(),_e=requireAdvanceStringIndex(),ge=requireGetMethod(),xe=requireGetSubstitution(),Re=requireRegexpGetFlags(),De=requireRegexpExecAbstract(),Ie=requireWellKnownSymbol(),Ce=Ie("replace"),Ue=Math.max,Le=Math.min,ke=ee([].concat),Ge=ee([].push),Ze=ee("".indexOf),We=ee("".slice),et=function(ut){return ut===void 0?ut:String(ut)},He=function(){return"a".replace(/./,"$0")==="$0"}(),ht=function(){return/./[Ce]?/./[Ce]("a","$0")==="":!1}(),_t=!te(function(){var ut=/./;return ut.exec=function(){var yt=[];return yt.groups={a:"7"},yt},"".replace(ut,"$<a>")!=="7"});return ne("replace",function(ut,yt,Lt){var Kt=ht?"$":"$0";return[function(qt,nt){var At=he(this),wt=ie(qt)?ge(qt,Ce):void 0;return wt?X(wt,qt,At,nt):X(yt,ae(At),qt,nt)},function(ft,qt){var nt=ue(this),At=ae(ft);if(typeof qt=="string"&&Ze(qt,Kt)===-1&&Ze(qt,"$<")===-1){var wt=Lt(yt,nt,At,qt);if(wt.done)return wt.value}var Ft=se(qt);Ft||(qt=ae(qt));var er=ae(Re(nt)),lr=Ze(er,"g")!==-1,jr;lr&&(jr=Ze(er,"u")!==-1,nt.lastIndex=0);for(var Mr=[],Lr;Lr=De(nt,At),!(Lr===null||(Ge(Mr,Lr),!lr));){var sr=ae(Lr[0]);sr===""&&(nt.lastIndex=_e(At,H(nt.lastIndex),jr))}for(var Rr="",Ur=0,Wr=0;Wr<Mr.length;Wr++){Lr=Mr[Wr];for(var Er=ae(Lr[0]),Kr=Ue(Le(t(Lr.index),At.length),0),ui=[],Ei,Hr=1;Hr<Lr.length;Hr++)Ge(ui,et(Lr[Hr]));var Br=Lr.groups;if(Ft){var li=ke([Er],ui,Kr,At);Br!==void 0&&Ge(li,Br),Ei=ae(Y(qt,void 0,li))}else Ei=xe(Er,At,Kr,ui,Br,qt);Kr>=Ur&&(Rr+=We(At,Ur,Kr)+Ei,Ur=Kr+Er.length)}return Rr+We(At,Ur)}]},!_t||!He||ht),es_string_replace}var es_string_replaceAll={},hasRequiredEs_string_replaceAll;function requireEs_string_replaceAll(){if(hasRequiredEs_string_replaceAll)return es_string_replaceAll;hasRequiredEs_string_replaceAll=1;var Y=require_export(),X=requireFunctionCall(),ee=requireFunctionUncurryThis(),ne=requireRequireObjectCoercible(),te=requireIsCallable(),ue=requireIsObject$1(),se=requireIsRegexp(),ie=requireToString$1(),t=requireGetMethod(),H=requireRegexpGetFlags(),ae=requireGetSubstitution(),he=requireWellKnownSymbol(),_e=requireIsPure(),ge=he("replace"),xe=TypeError,Re=ee("".indexOf),De=ee("".replace),Ie=ee("".slice),Ce=Math.max;return Y({target:"String",proto:!0},{replaceAll:function(Le,ke){var Ge=ne(this),Ze,We,et,He,ht,_t,ut,yt,Lt,Kt,ft=0,qt="";if(ue(Le)){if(Ze=se(Le),Ze&&(We=ie(ne(H(Le))),!~Re(We,"g")))throw new xe("`.replaceAll` does not allow non-global regexes");if(et=t(Le,ge),et)return X(et,Le,Ge,ke);if(_e&&Ze)return De(ie(Ge),Le,ke)}for(He=ie(Ge),ht=ie(Le),_t=te(ke),_t||(ke=ie(ke)),ut=ht.length,yt=Ce(1,ut),Lt=Re(He,ht);Lt!==-1;)Kt=_t?ie(ke(ht,Lt,He)):ae(ht,He,Lt,[],void 0,ke),qt+=Ie(He,ft,Lt)+Kt,ft=Lt+ut,Lt=Lt+yt>He.length?-1:Re(He,ht,Lt+yt);return ft<He.length&&(qt+=Ie(He,ft)),qt}}),es_string_replaceAll}var es_string_search={},hasRequiredEs_string_search;function requireEs_string_search(){if(hasRequiredEs_string_search)return es_string_search;hasRequiredEs_string_search=1;var Y=requireFunctionCall(),X=requireFixRegexpWellKnownSymbolLogic(),ee=requireAnObject(),ne=requireIsObject$1(),te=requireRequireObjectCoercible(),ue=requireSameValue(),se=requireToString$1(),ie=requireGetMethod(),t=requireRegexpExecAbstract();return X("search",function(H,ae,he){return[function(ge){var xe=te(this),Re=ne(ge)?ie(ge,H):void 0;return Re?Y(Re,ge,xe):new RegExp(ge)[H](se(xe))},function(_e){var ge=ee(this),xe=se(_e),Re=he(ae,ge,xe);if(Re.done)return Re.value;var De=ge.lastIndex;ue(De,0)||(ge.lastIndex=0);var Ie=t(ge,xe);return ue(ge.lastIndex,De)||(ge.lastIndex=De),Ie===null?-1:Ie.index}]}),es_string_search}var es_string_split={},hasRequiredEs_string_split;function requireEs_string_split(){if(hasRequiredEs_string_split)return es_string_split;hasRequiredEs_string_split=1;var Y=requireFunctionCall(),X=requireFunctionUncurryThis(),ee=requireFixRegexpWellKnownSymbolLogic(),ne=requireAnObject(),te=requireIsObject$1(),ue=requireRequireObjectCoercible(),se=requireSpeciesConstructor(),ie=requireAdvanceStringIndex(),t=requireToLength(),H=requireToString$1(),ae=requireGetMethod(),he=requireRegexpExecAbstract(),_e=requireRegexpStickyHelpers(),ge=requireFails(),xe=_e.UNSUPPORTED_Y,Re=4294967295,De=Math.min,Ie=X([].push),Ce=X("".slice),Ue=!ge(function(){var ke=/(?:)/,Ge=ke.exec;ke.exec=function(){return Ge.apply(this,arguments)};var Ze="ab".split(ke);return Ze.length!==2||Ze[0]!=="a"||Ze[1]!=="b"}),Le="abbc".split(/(b)*/)[1]==="c"||"test".split(/(?:)/,-1).length!==4||"ab".split(/(?:ab)*/).length!==2||".".split(/(.?)(.?)/).length!==4||".".split(/()()/).length>1||"".split(/.?/).length;return ee("split",function(ke,Ge,Ze){var We="0".split(void 0,0).length?function(et,He){return et===void 0&&He===0?[]:Y(Ge,this,et,He)}:Ge;return[function(He,ht){var _t=ue(this),ut=te(He)?ae(He,ke):void 0;return ut?Y(ut,He,_t,ht):Y(We,H(_t),He,ht)},function(et,He){var ht=ne(this),_t=H(et);if(!Le){var ut=Ze(We,ht,_t,He,We!==Ge);if(ut.done)return ut.value}var yt=se(ht,RegExp),Lt=ht.unicode,Kt=(ht.ignoreCase?"i":"")+(ht.multiline?"m":"")+(ht.unicode?"u":"")+(xe?"g":"y"),ft=new yt(xe?"^(?:"+ht.source+")":ht,Kt),qt=He===void 0?Re:He>>>0;if(qt===0)return[];if(_t.length===0)return he(ft,_t)===null?[_t]:[];for(var nt=0,At=0,wt=[];At<_t.length;){ft.lastIndex=xe?0:At;var Ft=he(ft,xe?Ce(_t,At):_t),er;if(Ft===null||(er=De(t(ft.lastIndex+(xe?At:0)),_t.length))===nt)At=ie(_t,At,Lt);else{if(Ie(wt,Ce(_t,nt,At)),wt.length===qt)return wt;for(var lr=1;lr<=Ft.length-1;lr++)if(Ie(wt,Ft[lr]),wt.length===qt)return wt;At=nt=er}}return Ie(wt,Ce(_t,nt)),wt}]},Le||!Ue,xe),es_string_split}var es_string_startsWith={},hasRequiredEs_string_startsWith;function requireEs_string_startsWith(){if(hasRequiredEs_string_startsWith)return es_string_startsWith;hasRequiredEs_string_startsWith=1;var Y=require_export(),X=requireFunctionUncurryThisClause(),ee=requireObjectGetOwnPropertyDescriptor().f,ne=requireToLength(),te=requireToString$1(),ue=requireNotARegexp(),se=requireRequireObjectCoercible(),ie=requireCorrectIsRegexpLogic(),t=requireIsPure(),H=X("".slice),ae=Math.min,he=ie("startsWith"),_e=!t&&!he&&!!function(){var ge=ee(String.prototype,"startsWith");return ge&&!ge.writable}();return Y({target:"String",proto:!0,forced:!_e&&!he},{startsWith:function(xe){var Re=te(se(this));ue(xe);var De=ne(ae(arguments.length>1?arguments[1]:void 0,Re.length)),Ie=te(xe);return H(Re,De,De+Ie.length)===Ie}}),es_string_startsWith}var es_string_substr={},hasRequiredEs_string_substr;function requireEs_string_substr(){if(hasRequiredEs_string_substr)return es_string_substr;hasRequiredEs_string_substr=1;var Y=require_export(),X=requireFunctionUncurryThis(),ee=requireRequireObjectCoercible(),ne=requireToIntegerOrInfinity(),te=requireToString$1(),ue=X("".slice),se=Math.max,ie=Math.min,t=!"".substr||"ab".substr(-1)!=="b";return Y({target:"String",proto:!0,forced:t},{substr:function(ae,he){var _e=te(ee(this)),ge=_e.length,xe=ne(ae),Re,De;return xe===1/0&&(xe=0),xe<0&&(xe=se(ge+xe,0)),Re=he===void 0?ge:ne(he),Re<=0||Re===1/0?"":(De=ie(xe+Re,ge),xe>=De?"":ue(_e,xe,De))}}),es_string_substr}var es_string_toWellFormed={},hasRequiredEs_string_toWellFormed;function requireEs_string_toWellFormed(){if(hasRequiredEs_string_toWellFormed)return es_string_toWellFormed;hasRequiredEs_string_toWellFormed=1;var Y=require_export(),X=requireFunctionCall(),ee=requireFunctionUncurryThis(),ne=requireRequireObjectCoercible(),te=requireToString$1(),ue=requireFails(),se=Array,ie=ee("".charAt),t=ee("".charCodeAt),H=ee([].join),ae="".toWellFormed,he="�",_e=ae&&ue(function(){return X(ae,1)!=="1"});return Y({target:"String",proto:!0,forced:_e},{toWellFormed:function(){var xe=te(ne(this));if(_e)return X(ae,xe);for(var Re=xe.length,De=se(Re),Ie=0;Ie<Re;Ie++){var Ce=t(xe,Ie);(Ce&63488)!==55296?De[Ie]=ie(xe,Ie):Ce>=56320||Ie+1>=Re||(t(xe,Ie+1)&64512)!==56320?De[Ie]=he:(De[Ie]=ie(xe,Ie),De[++Ie]=ie(xe,Ie))}return H(De,"")}}),es_string_toWellFormed}var es_string_trim={},stringTrimForced,hasRequiredStringTrimForced;function requireStringTrimForced(){if(hasRequiredStringTrimForced)return stringTrimForced;hasRequiredStringTrimForced=1;var Y=requireFunctionName().PROPER,X=requireFails(),ee=requireWhitespaces(),ne="​᠎";return stringTrimForced=function(te){return X(function(){return!!ee[te]()||ne[te]()!==ne||Y&&ee[te].name!==te})},stringTrimForced}var hasRequiredEs_string_trim;function requireEs_string_trim(){if(hasRequiredEs_string_trim)return es_string_trim;hasRequiredEs_string_trim=1;var Y=require_export(),X=requireStringTrim().trim,ee=requireStringTrimForced();return Y({target:"String",proto:!0,forced:ee("trim")},{trim:function(){return X(this)}}),es_string_trim}var es_string_trimEnd={},es_string_trimRight={},stringTrimEnd,hasRequiredStringTrimEnd;function requireStringTrimEnd(){if(hasRequiredStringTrimEnd)return stringTrimEnd;hasRequiredStringTrimEnd=1;var Y=requireStringTrim().end,X=requireStringTrimForced();return stringTrimEnd=X("trimEnd")?function(){return Y(this)}:"".trimEnd,stringTrimEnd}var hasRequiredEs_string_trimRight;function requireEs_string_trimRight(){if(hasRequiredEs_string_trimRight)return es_string_trimRight;hasRequiredEs_string_trimRight=1;var Y=require_export(),X=requireStringTrimEnd();return Y({target:"String",proto:!0,name:"trimEnd",forced:"".trimRight!==X},{trimRight:X}),es_string_trimRight}var hasRequiredEs_string_trimEnd;function requireEs_string_trimEnd(){if(hasRequiredEs_string_trimEnd)return es_string_trimEnd;hasRequiredEs_string_trimEnd=1,requireEs_string_trimRight();var Y=require_export(),X=requireStringTrimEnd();return Y({target:"String",proto:!0,name:"trimEnd",forced:"".trimEnd!==X},{trimEnd:X}),es_string_trimEnd}var es_string_trimStart={},es_string_trimLeft={},stringTrimStart,hasRequiredStringTrimStart;function requireStringTrimStart(){if(hasRequiredStringTrimStart)return stringTrimStart;hasRequiredStringTrimStart=1;var Y=requireStringTrim().start,X=requireStringTrimForced();return stringTrimStart=X("trimStart")?function(){return Y(this)}:"".trimStart,stringTrimStart}var hasRequiredEs_string_trimLeft;function requireEs_string_trimLeft(){if(hasRequiredEs_string_trimLeft)return es_string_trimLeft;hasRequiredEs_string_trimLeft=1;var Y=require_export(),X=requireStringTrimStart();return Y({target:"String",proto:!0,name:"trimStart",forced:"".trimLeft!==X},{trimLeft:X}),es_string_trimLeft}var hasRequiredEs_string_trimStart;function requireEs_string_trimStart(){if(hasRequiredEs_string_trimStart)return es_string_trimStart;hasRequiredEs_string_trimStart=1,requireEs_string_trimLeft();var Y=require_export(),X=requireStringTrimStart();return Y({target:"String",proto:!0,name:"trimStart",forced:"".trimStart!==X},{trimStart:X}),es_string_trimStart}var es_string_anchor={},createHtml,hasRequiredCreateHtml;function requireCreateHtml(){if(hasRequiredCreateHtml)return createHtml;hasRequiredCreateHtml=1;var Y=requireFunctionUncurryThis(),X=requireRequireObjectCoercible(),ee=requireToString$1(),ne=/"/g,te=Y("".replace);return createHtml=function(ue,se,ie,t){var H=ee(X(ue)),ae="<"+se;return ie!==""&&(ae+=" "+ie+'="'+te(ee(t),ne,"&quot;")+'"'),ae+">"+H+"</"+se+">"},createHtml}var stringHtmlForced,hasRequiredStringHtmlForced;function requireStringHtmlForced(){if(hasRequiredStringHtmlForced)return stringHtmlForced;hasRequiredStringHtmlForced=1;var Y=requireFails();return stringHtmlForced=function(X){return Y(function(){var ee=""[X]('"');return ee!==ee.toLowerCase()||ee.split('"').length>3})},stringHtmlForced}var hasRequiredEs_string_anchor;function requireEs_string_anchor(){if(hasRequiredEs_string_anchor)return es_string_anchor;hasRequiredEs_string_anchor=1;var Y=require_export(),X=requireCreateHtml(),ee=requireStringHtmlForced();return Y({target:"String",proto:!0,forced:ee("anchor")},{anchor:function(te){return X(this,"a","name",te)}}),es_string_anchor}var es_string_big={},hasRequiredEs_string_big;function requireEs_string_big(){if(hasRequiredEs_string_big)return es_string_big;hasRequiredEs_string_big=1;var Y=require_export(),X=requireCreateHtml(),ee=requireStringHtmlForced();return Y({target:"String",proto:!0,forced:ee("big")},{big:function(){return X(this,"big","","")}}),es_string_big}var es_string_blink={},hasRequiredEs_string_blink;function requireEs_string_blink(){if(hasRequiredEs_string_blink)return es_string_blink;hasRequiredEs_string_blink=1;var Y=require_export(),X=requireCreateHtml(),ee=requireStringHtmlForced();return Y({target:"String",proto:!0,forced:ee("blink")},{blink:function(){return X(this,"blink","","")}}),es_string_blink}var es_string_bold={},hasRequiredEs_string_bold;function requireEs_string_bold(){if(hasRequiredEs_string_bold)return es_string_bold;hasRequiredEs_string_bold=1;var Y=require_export(),X=requireCreateHtml(),ee=requireStringHtmlForced();return Y({target:"String",proto:!0,forced:ee("bold")},{bold:function(){return X(this,"b","","")}}),es_string_bold}var es_string_fixed={},hasRequiredEs_string_fixed;function requireEs_string_fixed(){if(hasRequiredEs_string_fixed)return es_string_fixed;hasRequiredEs_string_fixed=1;var Y=require_export(),X=requireCreateHtml(),ee=requireStringHtmlForced();return Y({target:"String",proto:!0,forced:ee("fixed")},{fixed:function(){return X(this,"tt","","")}}),es_string_fixed}var es_string_fontcolor={},hasRequiredEs_string_fontcolor;function requireEs_string_fontcolor(){if(hasRequiredEs_string_fontcolor)return es_string_fontcolor;hasRequiredEs_string_fontcolor=1;var Y=require_export(),X=requireCreateHtml(),ee=requireStringHtmlForced();return Y({target:"String",proto:!0,forced:ee("fontcolor")},{fontcolor:function(te){return X(this,"font","color",te)}}),es_string_fontcolor}var es_string_fontsize={},hasRequiredEs_string_fontsize;function requireEs_string_fontsize(){if(hasRequiredEs_string_fontsize)return es_string_fontsize;hasRequiredEs_string_fontsize=1;var Y=require_export(),X=requireCreateHtml(),ee=requireStringHtmlForced();return Y({target:"String",proto:!0,forced:ee("fontsize")},{fontsize:function(te){return X(this,"font","size",te)}}),es_string_fontsize}var es_string_italics={},hasRequiredEs_string_italics;function requireEs_string_italics(){if(hasRequiredEs_string_italics)return es_string_italics;hasRequiredEs_string_italics=1;var Y=require_export(),X=requireCreateHtml(),ee=requireStringHtmlForced();return Y({target:"String",proto:!0,forced:ee("italics")},{italics:function(){return X(this,"i","","")}}),es_string_italics}var es_string_link={},hasRequiredEs_string_link;function requireEs_string_link(){if(hasRequiredEs_string_link)return es_string_link;hasRequiredEs_string_link=1;var Y=require_export(),X=requireCreateHtml(),ee=requireStringHtmlForced();return Y({target:"String",proto:!0,forced:ee("link")},{link:function(te){return X(this,"a","href",te)}}),es_string_link}var es_string_small={},hasRequiredEs_string_small;function requireEs_string_small(){if(hasRequiredEs_string_small)return es_string_small;hasRequiredEs_string_small=1;var Y=require_export(),X=requireCreateHtml(),ee=requireStringHtmlForced();return Y({target:"String",proto:!0,forced:ee("small")},{small:function(){return X(this,"small","","")}}),es_string_small}var es_string_strike={},hasRequiredEs_string_strike;function requireEs_string_strike(){if(hasRequiredEs_string_strike)return es_string_strike;hasRequiredEs_string_strike=1;var Y=require_export(),X=requireCreateHtml(),ee=requireStringHtmlForced();return Y({target:"String",proto:!0,forced:ee("strike")},{strike:function(){return X(this,"strike","","")}}),es_string_strike}var es_string_sub={},hasRequiredEs_string_sub;function requireEs_string_sub(){if(hasRequiredEs_string_sub)return es_string_sub;hasRequiredEs_string_sub=1;var Y=require_export(),X=requireCreateHtml(),ee=requireStringHtmlForced();return Y({target:"String",proto:!0,forced:ee("sub")},{sub:function(){return X(this,"sub","","")}}),es_string_sub}var es_string_sup={},hasRequiredEs_string_sup;function requireEs_string_sup(){if(hasRequiredEs_string_sup)return es_string_sup;hasRequiredEs_string_sup=1;var Y=require_export(),X=requireCreateHtml(),ee=requireStringHtmlForced();return Y({target:"String",proto:!0,forced:ee("sup")},{sup:function(){return X(this,"sup","","")}}),es_string_sup}var es_typedArray_float32Array={},typedArrayConstructor={exports:{}},typedArrayConstructorsRequireWrappers,hasRequiredTypedArrayConstructorsRequireWrappers;function requireTypedArrayConstructorsRequireWrappers(){if(hasRequiredTypedArrayConstructorsRequireWrappers)return typedArrayConstructorsRequireWrappers;hasRequiredTypedArrayConstructorsRequireWrappers=1;var Y=requireGlobalThis(),X=requireFails(),ee=requireCheckCorrectnessOfIteration(),ne=requireArrayBufferViewCore().NATIVE_ARRAY_BUFFER_VIEWS,te=Y.ArrayBuffer,ue=Y.Int8Array;return typedArrayConstructorsRequireWrappers=!ne||!X(function(){ue(1)})||!X(function(){new ue(-1)})||!ee(function(se){new ue,new ue(null),new ue(1.5),new ue(se)},!0)||X(function(){return new ue(new te(2),1,void 0).length!==1}),typedArrayConstructorsRequireWrappers}var toOffset,hasRequiredToOffset;function requireToOffset(){if(hasRequiredToOffset)return toOffset;hasRequiredToOffset=1;var Y=requireToPositiveInteger(),X=RangeError;return toOffset=function(ee,ne){var te=Y(ee);if(te%ne)throw new X("Wrong offset");return te},toOffset}var toUint8Clamped,hasRequiredToUint8Clamped;function requireToUint8Clamped(){if(hasRequiredToUint8Clamped)return toUint8Clamped;hasRequiredToUint8Clamped=1;var Y=Math.round;return toUint8Clamped=function(X){var ee=Y(X);return ee<0?0:ee>255?255:ee&255},toUint8Clamped}var isBigIntArray,hasRequiredIsBigIntArray;function requireIsBigIntArray(){if(hasRequiredIsBigIntArray)return isBigIntArray;hasRequiredIsBigIntArray=1;var Y=requireClassof();return isBigIntArray=function(X){var ee=Y(X);return ee==="BigInt64Array"||ee==="BigUint64Array"},isBigIntArray}var toBigInt,hasRequiredToBigInt;function requireToBigInt(){if(hasRequiredToBigInt)return toBigInt;hasRequiredToBigInt=1;var Y=requireToPrimitive(),X=TypeError;return toBigInt=function(ee){var ne=Y(ee,"number");if(typeof ne=="number")throw new X("Can't convert number to bigint");return BigInt(ne)},toBigInt}var typedArrayFrom,hasRequiredTypedArrayFrom;function requireTypedArrayFrom(){if(hasRequiredTypedArrayFrom)return typedArrayFrom;hasRequiredTypedArrayFrom=1;var Y=requireFunctionBindContext(),X=requireFunctionCall(),ee=requireAConstructor(),ne=requireToObject(),te=requireLengthOfArrayLike(),ue=requireGetIterator(),se=requireGetIteratorMethod(),ie=requireIsArrayIteratorMethod(),t=requireIsBigIntArray(),H=requireArrayBufferViewCore().aTypedArrayConstructor,ae=requireToBigInt();return typedArrayFrom=function(_e){var ge=ee(this),xe=ne(_e),Re=arguments.length,De=Re>1?arguments[1]:void 0,Ie=De!==void 0,Ce=se(xe),Ue,Le,ke,Ge,Ze,We,et,He;if(Ce&&!ie(Ce))for(et=ue(xe,Ce),He=et.next,xe=[];!(We=X(He,et)).done;)xe.push(We.value);for(Ie&&Re>2&&(De=Y(De,arguments[2])),Le=te(xe),ke=new(H(ge))(Le),Ge=t(ke),Ue=0;Le>Ue;Ue++)Ze=Ie?De(xe[Ue],Ue):xe[Ue],ke[Ue]=Ge?ae(Ze):+Ze;return ke},typedArrayFrom}var hasRequiredTypedArrayConstructor;function requireTypedArrayConstructor(){if(hasRequiredTypedArrayConstructor)return typedArrayConstructor.exports;hasRequiredTypedArrayConstructor=1;var Y=require_export(),X=requireGlobalThis(),ee=requireFunctionCall(),ne=requireDescriptors(),te=requireTypedArrayConstructorsRequireWrappers(),ue=requireArrayBufferViewCore(),se=requireArrayBuffer(),ie=requireAnInstance(),t=requireCreatePropertyDescriptor(),H=requireCreateNonEnumerableProperty(),ae=requireIsIntegralNumber(),he=requireToLength(),_e=requireToIndex(),ge=requireToOffset(),xe=requireToUint8Clamped(),Re=requireToPropertyKey(),De=requireHasOwnProperty(),Ie=requireClassof(),Ce=requireIsObject$1(),Ue=requireIsSymbol$1(),Le=requireObjectCreate(),ke=requireObjectIsPrototypeOf(),Ge=requireObjectSetPrototypeOf(),Ze=requireObjectGetOwnPropertyNames().f,We=requireTypedArrayFrom(),et=requireArrayIteration().forEach,He=requireSetSpecies(),ht=requireDefineBuiltInAccessor(),_t=requireObjectDefineProperty(),ut=requireObjectGetOwnPropertyDescriptor(),yt=requireArrayFromConstructorAndList(),Lt=requireInternalState(),Kt=requireInheritIfRequired(),ft=Lt.get,qt=Lt.set,nt=Lt.enforce,At=_t.f,wt=ut.f,Ft=X.RangeError,er=se.ArrayBuffer,lr=er.prototype,jr=se.DataView,Mr=ue.NATIVE_ARRAY_BUFFER_VIEWS,Lr=ue.TYPED_ARRAY_TAG,sr=ue.TypedArray,Rr=ue.TypedArrayPrototype,Ur=ue.isTypedArray,Wr="BYTES_PER_ELEMENT",Er="Wrong length",Kr=function(li,si){ht(li,si,{configurable:!0,get:function(){return ft(this)[si]}})},ui=function(li){var si;return ke(lr,li)||(si=Ie(li))==="ArrayBuffer"||si==="SharedArrayBuffer"},Ei=function(li,si){return Ur(li)&&!Ue(si)&&si in li&&ae(+si)&&si>=0},Hr=function(si,Qr){return Qr=Re(Qr),Ei(si,Qr)?t(2,si[Qr]):wt(si,Qr)},Br=function(si,Qr,_r){return Qr=Re(Qr),Ei(si,Qr)&&Ce(_r)&&De(_r,"value")&&!De(_r,"get")&&!De(_r,"set")&&!_r.configurable&&(!De(_r,"writable")||_r.writable)&&(!De(_r,"enumerable")||_r.enumerable)?(si[Qr]=_r.value,si):At(si,Qr,_r)};return ne?(Mr||(ut.f=Hr,_t.f=Br,Kr(Rr,"buffer"),Kr(Rr,"byteOffset"),Kr(Rr,"byteLength"),Kr(Rr,"length")),Y({target:"Object",stat:!0,forced:!Mr},{getOwnPropertyDescriptor:Hr,defineProperty:Br}),typedArrayConstructor.exports=function(li,si,Qr){var _r=li.match(/\d+/)[0]/8,vr=li+(Qr?"Clamped":"")+"Array",Xr="get"+li,Ir="set"+li,Or=X[vr],Nr=Or,je=Nr&&Nr.prototype,Se={},Oe=function(Ot,tr){var Qt=ft(Ot);return Qt.view[Xr](tr*_r+Qt.byteOffset,!0)},Ve=function(Ot,tr,Qt){var xt=ft(Ot);xt.view[Ir](tr*_r+xt.byteOffset,Qr?xe(Qt):Qt,!0)},st=function(Ot,tr){At(Ot,tr,{get:function(){return Oe(this,tr)},set:function(Qt){return Ve(this,tr,Qt)},enumerable:!0})};Mr?te&&(Nr=si(function(Ot,tr,Qt,xt){return ie(Ot,je),Kt(function(){return Ce(tr)?ui(tr)?xt!==void 0?new Or(tr,ge(Qt,_r),xt):Qt!==void 0?new Or(tr,ge(Qt,_r)):new Or(tr):Ur(tr)?yt(Nr,tr):ee(We,Nr,tr):new Or(_e(tr))}(),Ot,Nr)}),Ge&&Ge(Nr,sr),et(Ze(Or),function(Ot){Ot in Nr||H(Nr,Ot,Or[Ot])}),Nr.prototype=je):(Nr=si(function(Ot,tr,Qt,xt){ie(Ot,je);var Ct=0,Nt=0,dr,Ke,Me;if(!Ce(tr))Me=_e(tr),Ke=Me*_r,dr=new er(Ke);else if(ui(tr)){dr=tr,Nt=ge(Qt,_r);var Ne=tr.byteLength;if(xt===void 0){if(Ne%_r)throw new Ft(Er);if(Ke=Ne-Nt,Ke<0)throw new Ft(Er)}else if(Ke=he(xt)*_r,Ke+Nt>Ne)throw new Ft(Er);Me=Ke/_r}else return Ur(tr)?yt(Nr,tr):ee(We,Nr,tr);for(qt(Ot,{buffer:dr,byteOffset:Nt,byteLength:Ke,length:Me,view:new jr(dr)});Ct<Me;)st(Ot,Ct++)}),Ge&&Ge(Nr,sr),je=Nr.prototype=Le(Rr)),je.constructor!==Nr&&H(je,"constructor",Nr),nt(je).TypedArrayConstructor=Nr,Lr&&H(je,Lr,vr);var gt=Nr!==Or;Se[vr]=Nr,Y({global:!0,constructor:!0,forced:gt,sham:!Mr},Se),Wr in Nr||H(Nr,Wr,_r),Wr in je||H(je,Wr,_r),He(vr)}):typedArrayConstructor.exports=function(){},typedArrayConstructor.exports}var hasRequiredEs_typedArray_float32Array;function requireEs_typedArray_float32Array(){if(hasRequiredEs_typedArray_float32Array)return es_typedArray_float32Array;hasRequiredEs_typedArray_float32Array=1;var Y=requireTypedArrayConstructor();return Y("Float32",function(X){return function(ne,te,ue){return X(this,ne,te,ue)}}),es_typedArray_float32Array}var es_typedArray_float64Array={},hasRequiredEs_typedArray_float64Array;function requireEs_typedArray_float64Array(){if(hasRequiredEs_typedArray_float64Array)return es_typedArray_float64Array;hasRequiredEs_typedArray_float64Array=1;var Y=requireTypedArrayConstructor();return Y("Float64",function(X){return function(ne,te,ue){return X(this,ne,te,ue)}}),es_typedArray_float64Array}var es_typedArray_int8Array={},hasRequiredEs_typedArray_int8Array;function requireEs_typedArray_int8Array(){if(hasRequiredEs_typedArray_int8Array)return es_typedArray_int8Array;hasRequiredEs_typedArray_int8Array=1;var Y=requireTypedArrayConstructor();return Y("Int8",function(X){return function(ne,te,ue){return X(this,ne,te,ue)}}),es_typedArray_int8Array}var es_typedArray_int16Array={},hasRequiredEs_typedArray_int16Array;function requireEs_typedArray_int16Array(){if(hasRequiredEs_typedArray_int16Array)return es_typedArray_int16Array;hasRequiredEs_typedArray_int16Array=1;var Y=requireTypedArrayConstructor();return Y("Int16",function(X){return function(ne,te,ue){return X(this,ne,te,ue)}}),es_typedArray_int16Array}var es_typedArray_int32Array={},hasRequiredEs_typedArray_int32Array;function requireEs_typedArray_int32Array(){if(hasRequiredEs_typedArray_int32Array)return es_typedArray_int32Array;hasRequiredEs_typedArray_int32Array=1;var Y=requireTypedArrayConstructor();return Y("Int32",function(X){return function(ne,te,ue){return X(this,ne,te,ue)}}),es_typedArray_int32Array}var es_typedArray_uint8Array={},hasRequiredEs_typedArray_uint8Array;function requireEs_typedArray_uint8Array(){if(hasRequiredEs_typedArray_uint8Array)return es_typedArray_uint8Array;hasRequiredEs_typedArray_uint8Array=1;var Y=requireTypedArrayConstructor();return Y("Uint8",function(X){return function(ne,te,ue){return X(this,ne,te,ue)}}),es_typedArray_uint8Array}var es_typedArray_uint8ClampedArray={},hasRequiredEs_typedArray_uint8ClampedArray;function requireEs_typedArray_uint8ClampedArray(){if(hasRequiredEs_typedArray_uint8ClampedArray)return es_typedArray_uint8ClampedArray;hasRequiredEs_typedArray_uint8ClampedArray=1;var Y=requireTypedArrayConstructor();return Y("Uint8",function(X){return function(ne,te,ue){return X(this,ne,te,ue)}},!0),es_typedArray_uint8ClampedArray}var es_typedArray_uint16Array={},hasRequiredEs_typedArray_uint16Array;function requireEs_typedArray_uint16Array(){if(hasRequiredEs_typedArray_uint16Array)return es_typedArray_uint16Array;hasRequiredEs_typedArray_uint16Array=1;var Y=requireTypedArrayConstructor();return Y("Uint16",function(X){return function(ne,te,ue){return X(this,ne,te,ue)}}),es_typedArray_uint16Array}var es_typedArray_uint32Array={},hasRequiredEs_typedArray_uint32Array;function requireEs_typedArray_uint32Array(){if(hasRequiredEs_typedArray_uint32Array)return es_typedArray_uint32Array;hasRequiredEs_typedArray_uint32Array=1;var Y=requireTypedArrayConstructor();return Y("Uint32",function(X){return function(ne,te,ue){return X(this,ne,te,ue)}}),es_typedArray_uint32Array}var es_typedArray_at={},hasRequiredEs_typedArray_at;function requireEs_typedArray_at(){if(hasRequiredEs_typedArray_at)return es_typedArray_at;hasRequiredEs_typedArray_at=1;var Y=requireArrayBufferViewCore(),X=requireLengthOfArrayLike(),ee=requireToIntegerOrInfinity(),ne=Y.aTypedArray,te=Y.exportTypedArrayMethod;return te("at",function(se){var ie=ne(this),t=X(ie),H=ee(se),ae=H>=0?H:t+H;return ae<0||ae>=t?void 0:ie[ae]}),es_typedArray_at}var es_typedArray_copyWithin={},hasRequiredEs_typedArray_copyWithin;function requireEs_typedArray_copyWithin(){if(hasRequiredEs_typedArray_copyWithin)return es_typedArray_copyWithin;hasRequiredEs_typedArray_copyWithin=1;var Y=requireFunctionUncurryThis(),X=requireArrayBufferViewCore(),ee=requireArrayCopyWithin(),ne=Y(ee),te=X.aTypedArray,ue=X.exportTypedArrayMethod;return ue("copyWithin",function(ie,t){return ne(te(this),ie,t,arguments.length>2?arguments[2]:void 0)}),es_typedArray_copyWithin}var es_typedArray_every={},hasRequiredEs_typedArray_every;function requireEs_typedArray_every(){if(hasRequiredEs_typedArray_every)return es_typedArray_every;hasRequiredEs_typedArray_every=1;var Y=requireArrayBufferViewCore(),X=requireArrayIteration().every,ee=Y.aTypedArray,ne=Y.exportTypedArrayMethod;return ne("every",function(ue){return X(ee(this),ue,arguments.length>1?arguments[1]:void 0)}),es_typedArray_every}var es_typedArray_fill={},hasRequiredEs_typedArray_fill;function requireEs_typedArray_fill(){if(hasRequiredEs_typedArray_fill)return es_typedArray_fill;hasRequiredEs_typedArray_fill=1;var Y=requireArrayBufferViewCore(),X=requireArrayFill(),ee=requireToBigInt(),ne=requireClassof(),te=requireFunctionCall(),ue=requireFunctionUncurryThis(),se=requireFails(),ie=Y.aTypedArray,t=Y.exportTypedArrayMethod,H=ue("".slice),ae=se(function(){var he=0;return new Int8Array(2).fill({valueOf:function(){return he++}}),he!==1});return t("fill",function(_e){var ge=arguments.length;ie(this);var xe=H(ne(this),0,3)==="Big"?ee(_e):+_e;return te(X,this,xe,ge>1?arguments[1]:void 0,ge>2?arguments[2]:void 0)},ae),es_typedArray_fill}var es_typedArray_filter={},typedArrayFromSameTypeAndList,hasRequiredTypedArrayFromSameTypeAndList;function requireTypedArrayFromSameTypeAndList(){if(hasRequiredTypedArrayFromSameTypeAndList)return typedArrayFromSameTypeAndList;hasRequiredTypedArrayFromSameTypeAndList=1;var Y=requireArrayFromConstructorAndList(),X=requireArrayBufferViewCore().getTypedArrayConstructor;return typedArrayFromSameTypeAndList=function(ee,ne){return Y(X(ee),ne)},typedArrayFromSameTypeAndList}var hasRequiredEs_typedArray_filter;function requireEs_typedArray_filter(){if(hasRequiredEs_typedArray_filter)return es_typedArray_filter;hasRequiredEs_typedArray_filter=1;var Y=requireArrayBufferViewCore(),X=requireArrayIteration().filter,ee=requireTypedArrayFromSameTypeAndList(),ne=Y.aTypedArray,te=Y.exportTypedArrayMethod;return te("filter",function(se){var ie=X(ne(this),se,arguments.length>1?arguments[1]:void 0);return ee(this,ie)}),es_typedArray_filter}var es_typedArray_find={},hasRequiredEs_typedArray_find;function requireEs_typedArray_find(){if(hasRequiredEs_typedArray_find)return es_typedArray_find;hasRequiredEs_typedArray_find=1;var Y=requireArrayBufferViewCore(),X=requireArrayIteration().find,ee=Y.aTypedArray,ne=Y.exportTypedArrayMethod;return ne("find",function(ue){return X(ee(this),ue,arguments.length>1?arguments[1]:void 0)}),es_typedArray_find}var es_typedArray_findIndex={},hasRequiredEs_typedArray_findIndex;function requireEs_typedArray_findIndex(){if(hasRequiredEs_typedArray_findIndex)return es_typedArray_findIndex;hasRequiredEs_typedArray_findIndex=1;var Y=requireArrayBufferViewCore(),X=requireArrayIteration().findIndex,ee=Y.aTypedArray,ne=Y.exportTypedArrayMethod;return ne("findIndex",function(ue){return X(ee(this),ue,arguments.length>1?arguments[1]:void 0)}),es_typedArray_findIndex}var es_typedArray_findLast={},hasRequiredEs_typedArray_findLast;function requireEs_typedArray_findLast(){if(hasRequiredEs_typedArray_findLast)return es_typedArray_findLast;hasRequiredEs_typedArray_findLast=1;var Y=requireArrayBufferViewCore(),X=requireArrayIterationFromLast().findLast,ee=Y.aTypedArray,ne=Y.exportTypedArrayMethod;return ne("findLast",function(ue){return X(ee(this),ue,arguments.length>1?arguments[1]:void 0)}),es_typedArray_findLast}var es_typedArray_findLastIndex={},hasRequiredEs_typedArray_findLastIndex;function requireEs_typedArray_findLastIndex(){if(hasRequiredEs_typedArray_findLastIndex)return es_typedArray_findLastIndex;hasRequiredEs_typedArray_findLastIndex=1;var Y=requireArrayBufferViewCore(),X=requireArrayIterationFromLast().findLastIndex,ee=Y.aTypedArray,ne=Y.exportTypedArrayMethod;return ne("findLastIndex",function(ue){return X(ee(this),ue,arguments.length>1?arguments[1]:void 0)}),es_typedArray_findLastIndex}var es_typedArray_forEach={},hasRequiredEs_typedArray_forEach;function requireEs_typedArray_forEach(){if(hasRequiredEs_typedArray_forEach)return es_typedArray_forEach;hasRequiredEs_typedArray_forEach=1;var Y=requireArrayBufferViewCore(),X=requireArrayIteration().forEach,ee=Y.aTypedArray,ne=Y.exportTypedArrayMethod;return ne("forEach",function(ue){X(ee(this),ue,arguments.length>1?arguments[1]:void 0)}),es_typedArray_forEach}var es_typedArray_from={},hasRequiredEs_typedArray_from;function requireEs_typedArray_from(){if(hasRequiredEs_typedArray_from)return es_typedArray_from;hasRequiredEs_typedArray_from=1;var Y=requireTypedArrayConstructorsRequireWrappers(),X=requireArrayBufferViewCore().exportTypedArrayStaticMethod,ee=requireTypedArrayFrom();return X("from",ee,Y),es_typedArray_from}var es_typedArray_includes={},hasRequiredEs_typedArray_includes;function requireEs_typedArray_includes(){if(hasRequiredEs_typedArray_includes)return es_typedArray_includes;hasRequiredEs_typedArray_includes=1;var Y=requireArrayBufferViewCore(),X=requireArrayIncludes().includes,ee=Y.aTypedArray,ne=Y.exportTypedArrayMethod;return ne("includes",function(ue){return X(ee(this),ue,arguments.length>1?arguments[1]:void 0)}),es_typedArray_includes}var es_typedArray_indexOf={},hasRequiredEs_typedArray_indexOf;function requireEs_typedArray_indexOf(){if(hasRequiredEs_typedArray_indexOf)return es_typedArray_indexOf;hasRequiredEs_typedArray_indexOf=1;var Y=requireArrayBufferViewCore(),X=requireArrayIncludes().indexOf,ee=Y.aTypedArray,ne=Y.exportTypedArrayMethod;return ne("indexOf",function(ue){return X(ee(this),ue,arguments.length>1?arguments[1]:void 0)}),es_typedArray_indexOf}var es_typedArray_iterator={},hasRequiredEs_typedArray_iterator;function requireEs_typedArray_iterator(){if(hasRequiredEs_typedArray_iterator)return es_typedArray_iterator;hasRequiredEs_typedArray_iterator=1;var Y=requireGlobalThis(),X=requireFails(),ee=requireFunctionUncurryThis(),ne=requireArrayBufferViewCore(),te=requireEs_array_iterator(),ue=requireWellKnownSymbol(),se=ue("iterator"),ie=Y.Uint8Array,t=ee(te.values),H=ee(te.keys),ae=ee(te.entries),he=ne.aTypedArray,_e=ne.exportTypedArrayMethod,ge=ie&&ie.prototype,xe=!X(function(){ge[se].call([1])}),Re=!!ge&&ge.values&&ge[se]===ge.values&&ge.values.name==="values",De=function(){return t(he(this))};return _e("entries",function(){return ae(he(this))},xe),_e("keys",function(){return H(he(this))},xe),_e("values",De,xe||!Re,{name:"values"}),_e(se,De,xe||!Re,{name:"values"}),es_typedArray_iterator}var es_typedArray_join={},hasRequiredEs_typedArray_join;function requireEs_typedArray_join(){if(hasRequiredEs_typedArray_join)return es_typedArray_join;hasRequiredEs_typedArray_join=1;var Y=requireArrayBufferViewCore(),X=requireFunctionUncurryThis(),ee=Y.aTypedArray,ne=Y.exportTypedArrayMethod,te=X([].join);return ne("join",function(se){return te(ee(this),se)}),es_typedArray_join}var es_typedArray_lastIndexOf={},hasRequiredEs_typedArray_lastIndexOf;function requireEs_typedArray_lastIndexOf(){if(hasRequiredEs_typedArray_lastIndexOf)return es_typedArray_lastIndexOf;hasRequiredEs_typedArray_lastIndexOf=1;var Y=requireArrayBufferViewCore(),X=requireFunctionApply(),ee=requireArrayLastIndexOf(),ne=Y.aTypedArray,te=Y.exportTypedArrayMethod;return te("lastIndexOf",function(se){var ie=arguments.length;return X(ee,ne(this),ie>1?[se,arguments[1]]:[se])}),es_typedArray_lastIndexOf}var es_typedArray_map={},hasRequiredEs_typedArray_map;function requireEs_typedArray_map(){if(hasRequiredEs_typedArray_map)return es_typedArray_map;hasRequiredEs_typedArray_map=1;var Y=requireArrayBufferViewCore(),X=requireArrayIteration().map,ee=Y.aTypedArray,ne=Y.getTypedArrayConstructor,te=Y.exportTypedArrayMethod;return te("map",function(se){return X(ee(this),se,arguments.length>1?arguments[1]:void 0,function(ie,t){return new(ne(ie))(t)})}),es_typedArray_map}var es_typedArray_of={},hasRequiredEs_typedArray_of;function requireEs_typedArray_of(){if(hasRequiredEs_typedArray_of)return es_typedArray_of;hasRequiredEs_typedArray_of=1;var Y=requireArrayBufferViewCore(),X=requireTypedArrayConstructorsRequireWrappers(),ee=Y.aTypedArrayConstructor,ne=Y.exportTypedArrayStaticMethod;return ne("of",function(){for(var ue=0,se=arguments.length,ie=new(ee(this))(se);se>ue;)ie[ue]=arguments[ue++];return ie},X),es_typedArray_of}var es_typedArray_reduce={},hasRequiredEs_typedArray_reduce;function requireEs_typedArray_reduce(){if(hasRequiredEs_typedArray_reduce)return es_typedArray_reduce;hasRequiredEs_typedArray_reduce=1;var Y=requireArrayBufferViewCore(),X=requireArrayReduce().left,ee=Y.aTypedArray,ne=Y.exportTypedArrayMethod;return ne("reduce",function(ue){var se=arguments.length;return X(ee(this),ue,se,se>1?arguments[1]:void 0)}),es_typedArray_reduce}var es_typedArray_reduceRight={},hasRequiredEs_typedArray_reduceRight;function requireEs_typedArray_reduceRight(){if(hasRequiredEs_typedArray_reduceRight)return es_typedArray_reduceRight;hasRequiredEs_typedArray_reduceRight=1;var Y=requireArrayBufferViewCore(),X=requireArrayReduce().right,ee=Y.aTypedArray,ne=Y.exportTypedArrayMethod;return ne("reduceRight",function(ue){var se=arguments.length;return X(ee(this),ue,se,se>1?arguments[1]:void 0)}),es_typedArray_reduceRight}var es_typedArray_reverse={},hasRequiredEs_typedArray_reverse;function requireEs_typedArray_reverse(){if(hasRequiredEs_typedArray_reverse)return es_typedArray_reverse;hasRequiredEs_typedArray_reverse=1;var Y=requireArrayBufferViewCore(),X=Y.aTypedArray,ee=Y.exportTypedArrayMethod,ne=Math.floor;return ee("reverse",function(){for(var ue=this,se=X(ue).length,ie=ne(se/2),t=0,H;t<ie;)H=ue[t],ue[t++]=ue[--se],ue[se]=H;return ue}),es_typedArray_reverse}var es_typedArray_set={},hasRequiredEs_typedArray_set;function requireEs_typedArray_set(){if(hasRequiredEs_typedArray_set)return es_typedArray_set;hasRequiredEs_typedArray_set=1;var Y=requireGlobalThis(),X=requireFunctionCall(),ee=requireArrayBufferViewCore(),ne=requireLengthOfArrayLike(),te=requireToOffset(),ue=requireToObject(),se=requireFails(),ie=Y.RangeError,t=Y.Int8Array,H=t&&t.prototype,ae=H&&H.set,he=ee.aTypedArray,_e=ee.exportTypedArrayMethod,ge=!se(function(){var Re=new Uint8ClampedArray(2);return X(ae,Re,{length:1,0:3},1),Re[1]!==3}),xe=ge&&ee.NATIVE_ARRAY_BUFFER_VIEWS&&se(function(){var Re=new t(2);return Re.set(1),Re.set("2",1),Re[0]!==0||Re[1]!==2});return _e("set",function(De){he(this);var Ie=te(arguments.length>1?arguments[1]:void 0,1),Ce=ue(De);if(ge)return X(ae,this,Ce,Ie);var Ue=this.length,Le=ne(Ce),ke=0;if(Le+Ie>Ue)throw new ie("Wrong length");for(;ke<Le;)this[Ie+ke]=Ce[ke++]},!ge||xe),es_typedArray_set}var es_typedArray_slice={},hasRequiredEs_typedArray_slice;function requireEs_typedArray_slice(){if(hasRequiredEs_typedArray_slice)return es_typedArray_slice;hasRequiredEs_typedArray_slice=1;var Y=requireArrayBufferViewCore(),X=requireFails(),ee=requireArraySlice(),ne=Y.aTypedArray,te=Y.getTypedArrayConstructor,ue=Y.exportTypedArrayMethod,se=X(function(){new Int8Array(1).slice()});return ue("slice",function(t,H){for(var ae=ee(ne(this),t,H),he=te(this),_e=0,ge=ae.length,xe=new he(ge);ge>_e;)xe[_e]=ae[_e++];return xe},se),es_typedArray_slice}var es_typedArray_some={},hasRequiredEs_typedArray_some;function requireEs_typedArray_some(){if(hasRequiredEs_typedArray_some)return es_typedArray_some;hasRequiredEs_typedArray_some=1;var Y=requireArrayBufferViewCore(),X=requireArrayIteration().some,ee=Y.aTypedArray,ne=Y.exportTypedArrayMethod;return ne("some",function(ue){return X(ee(this),ue,arguments.length>1?arguments[1]:void 0)}),es_typedArray_some}var es_typedArray_sort={},hasRequiredEs_typedArray_sort;function requireEs_typedArray_sort(){if(hasRequiredEs_typedArray_sort)return es_typedArray_sort;hasRequiredEs_typedArray_sort=1;var Y=requireGlobalThis(),X=requireFunctionUncurryThisClause(),ee=requireFails(),ne=requireACallable(),te=requireArraySort(),ue=requireArrayBufferViewCore(),se=requireEnvironmentFfVersion(),ie=requireEnvironmentIsIeOrEdge(),t=requireEnvironmentV8Version(),H=requireEnvironmentWebkitVersion(),ae=ue.aTypedArray,he=ue.exportTypedArrayMethod,_e=Y.Uint16Array,ge=_e&&X(_e.prototype.sort),xe=!!ge&&!(ee(function(){ge(new _e(2),null)})&&ee(function(){ge(new _e(2),{})})),Re=!!ge&&!ee(function(){if(t)return t<74;if(se)return se<67;if(ie)return!0;if(H)return H<602;var Ie=new _e(516),Ce=Array(516),Ue,Le;for(Ue=0;Ue<516;Ue++)Le=Ue%4,Ie[Ue]=515-Ue,Ce[Ue]=Ue-2*Le+3;for(ge(Ie,function(ke,Ge){return(ke/4|0)-(Ge/4|0)}),Ue=0;Ue<516;Ue++)if(Ie[Ue]!==Ce[Ue])return!0}),De=function(Ie){return function(Ce,Ue){return Ie!==void 0?+Ie(Ce,Ue)||0:Ue!==Ue?-1:Ce!==Ce?1:Ce===0&&Ue===0?1/Ce>0&&1/Ue<0?1:-1:Ce>Ue}};return he("sort",function(Ce){return Ce!==void 0&&ne(Ce),Re?ge(this,Ce):te(ae(this),De(Ce))},!Re||xe),es_typedArray_sort}var es_typedArray_subarray={},hasRequiredEs_typedArray_subarray;function requireEs_typedArray_subarray(){if(hasRequiredEs_typedArray_subarray)return es_typedArray_subarray;hasRequiredEs_typedArray_subarray=1;var Y=requireArrayBufferViewCore(),X=requireToLength(),ee=requireToAbsoluteIndex(),ne=Y.aTypedArray,te=Y.getTypedArrayConstructor,ue=Y.exportTypedArrayMethod;return ue("subarray",function(ie,t){var H=ne(this),ae=H.length,he=ee(ie,ae),_e=te(H);return new _e(H.buffer,H.byteOffset+he*H.BYTES_PER_ELEMENT,X((t===void 0?ae:ee(t,ae))-he))}),es_typedArray_subarray}var es_typedArray_toLocaleString={},hasRequiredEs_typedArray_toLocaleString;function requireEs_typedArray_toLocaleString(){if(hasRequiredEs_typedArray_toLocaleString)return es_typedArray_toLocaleString;hasRequiredEs_typedArray_toLocaleString=1;var Y=requireGlobalThis(),X=requireFunctionApply(),ee=requireArrayBufferViewCore(),ne=requireFails(),te=requireArraySlice(),ue=Y.Int8Array,se=ee.aTypedArray,ie=ee.exportTypedArrayMethod,t=[].toLocaleString,H=!!ue&&ne(function(){t.call(new ue(1))}),ae=ne(function(){return[1,2].toLocaleString()!==new ue([1,2]).toLocaleString()})||!ne(function(){ue.prototype.toLocaleString.call([1,2])});return ie("toLocaleString",function(){return X(t,H?te(se(this)):se(this),te(arguments))},ae),es_typedArray_toLocaleString}var es_typedArray_toReversed={},hasRequiredEs_typedArray_toReversed;function requireEs_typedArray_toReversed(){if(hasRequiredEs_typedArray_toReversed)return es_typedArray_toReversed;hasRequiredEs_typedArray_toReversed=1;var Y=requireArrayToReversed(),X=requireArrayBufferViewCore(),ee=X.aTypedArray,ne=X.exportTypedArrayMethod,te=X.getTypedArrayConstructor;return ne("toReversed",function(){return Y(ee(this),te(this))}),es_typedArray_toReversed}var es_typedArray_toSorted={},hasRequiredEs_typedArray_toSorted;function requireEs_typedArray_toSorted(){if(hasRequiredEs_typedArray_toSorted)return es_typedArray_toSorted;hasRequiredEs_typedArray_toSorted=1;var Y=requireArrayBufferViewCore(),X=requireFunctionUncurryThis(),ee=requireACallable(),ne=requireArrayFromConstructorAndList(),te=Y.aTypedArray,ue=Y.getTypedArrayConstructor,se=Y.exportTypedArrayMethod,ie=X(Y.TypedArrayPrototype.sort);return se("toSorted",function(H){H!==void 0&&ee(H);var ae=te(this),he=ne(ue(ae),ae);return ie(he,H)}),es_typedArray_toSorted}var es_typedArray_toString={},hasRequiredEs_typedArray_toString;function requireEs_typedArray_toString(){if(hasRequiredEs_typedArray_toString)return es_typedArray_toString;hasRequiredEs_typedArray_toString=1;var Y=requireArrayBufferViewCore().exportTypedArrayMethod,X=requireFails(),ee=requireGlobalThis(),ne=requireFunctionUncurryThis(),te=ee.Uint8Array,ue=te&&te.prototype||{},se=[].toString,ie=ne([].join);X(function(){se.call({})})&&(se=function(){return ie(this)});var t=ue.toString!==se;return Y("toString",se,t),es_typedArray_toString}var es_typedArray_with={},hasRequiredEs_typedArray_with;function requireEs_typedArray_with(){if(hasRequiredEs_typedArray_with)return es_typedArray_with;hasRequiredEs_typedArray_with=1;var Y=requireArrayWith(),X=requireArrayBufferViewCore(),ee=requireIsBigIntArray(),ne=requireToIntegerOrInfinity(),te=requireToBigInt(),ue=X.aTypedArray,se=X.getTypedArrayConstructor,ie=X.exportTypedArrayMethod,t=function(){try{new Int8Array(1).with(2,{valueOf:function(){throw 8}})}catch(ae){return ae===8}}(),H=t&&function(){try{new Int8Array(1).with(-.5,1)}catch{return!0}}();return ie("with",function(ae,he){var _e=ue(this),ge=ne(ae),xe=ee(_e)?te(he):+he;return Y(_e,se(_e),ge,xe)},!t||H),es_typedArray_with}var es_unescape={},hasRequiredEs_unescape;function requireEs_unescape(){if(hasRequiredEs_unescape)return es_unescape;hasRequiredEs_unescape=1;var Y=require_export(),X=requireFunctionUncurryThis(),ee=requireToString$1(),ne=String.fromCharCode,te=X("".charAt),ue=X(/./.exec),se=X("".slice),ie=/^[\da-f]{2}$/i,t=/^[\da-f]{4}$/i;return Y({global:!0},{unescape:function(ae){for(var he=ee(ae),_e="",ge=he.length,xe=0,Re,De;xe<ge;){if(Re=te(he,xe++),Re==="%"){if(te(he,xe)==="u"){if(De=se(he,xe+1,xe+5),ue(t,De)){_e+=ne(parseInt(De,16)),xe+=5;continue}}else if(De=se(he,xe,xe+2),ue(ie,De)){_e+=ne(parseInt(De,16)),xe+=2;continue}}_e+=Re}return _e}}),es_unescape}var es_weakMap={},es_weakMap_constructor={},collectionWeak,hasRequiredCollectionWeak;function requireCollectionWeak(){if(hasRequiredCollectionWeak)return collectionWeak;hasRequiredCollectionWeak=1;var Y=requireFunctionUncurryThis(),X=requireDefineBuiltIns(),ee=requireInternalMetadata().getWeakData,ne=requireAnInstance(),te=requireAnObject(),ue=requireIsNullOrUndefined(),se=requireIsObject$1(),ie=requireIterate(),t=requireArrayIteration(),H=requireHasOwnProperty(),ae=requireInternalState(),he=ae.set,_e=ae.getterFor,ge=t.find,xe=t.findIndex,Re=Y([].splice),De=0,Ie=function(Le){return Le.frozen||(Le.frozen=new Ce)},Ce=function(){this.entries=[]},Ue=function(Le,ke){return ge(Le.entries,function(Ge){return Ge[0]===ke})};return Ce.prototype={get:function(Le){var ke=Ue(this,Le);if(ke)return ke[1]},has:function(Le){return!!Ue(this,Le)},set:function(Le,ke){var Ge=Ue(this,Le);Ge?Ge[1]=ke:this.entries.push([Le,ke])},delete:function(Le){var ke=xe(this.entries,function(Ge){return Ge[0]===Le});return~ke&&Re(this.entries,ke,1),!!~ke}},collectionWeak={getConstructor:function(Le,ke,Ge,Ze){var We=Le(function(_t,ut){ne(_t,et),he(_t,{type:ke,id:De++,frozen:null}),ue(ut)||ie(ut,_t[Ze],{that:_t,AS_ENTRIES:Ge})}),et=We.prototype,He=_e(ke),ht=function(_t,ut,yt){var Lt=He(_t),Kt=ee(te(ut),!0);return Kt===!0?Ie(Lt).set(ut,yt):Kt[Lt.id]=yt,_t};return X(et,{delete:function(_t){var ut=He(this);if(!se(_t))return!1;var yt=ee(_t);return yt===!0?Ie(ut).delete(_t):yt&&H(yt,ut.id)&&delete yt[ut.id]},has:function(ut){var yt=He(this);if(!se(ut))return!1;var Lt=ee(ut);return Lt===!0?Ie(yt).has(ut):Lt&&H(Lt,yt.id)}}),X(et,Ge?{get:function(ut){var yt=He(this);if(se(ut)){var Lt=ee(ut);if(Lt===!0)return Ie(yt).get(ut);if(Lt)return Lt[yt.id]}},set:function(ut,yt){return ht(this,ut,yt)}}:{add:function(ut){return ht(this,ut,!0)}}),We}},collectionWeak}var hasRequiredEs_weakMap_constructor;function requireEs_weakMap_constructor(){if(hasRequiredEs_weakMap_constructor)return es_weakMap_constructor;hasRequiredEs_weakMap_constructor=1;var Y=requireFreezing(),X=requireGlobalThis(),ee=requireFunctionUncurryThis(),ne=requireDefineBuiltIns(),te=requireInternalMetadata(),ue=requireCollection(),se=requireCollectionWeak(),ie=requireIsObject$1(),t=requireInternalState().enforce,H=requireFails(),ae=requireWeakMapBasicDetection(),he=Object,_e=Array.isArray,ge=he.isExtensible,xe=he.isFrozen,Re=he.isSealed,De=he.freeze,Ie=he.seal,Ce=!X.ActiveXObject&&"ActiveXObject"in X,Ue,Le=function(_t){return function(){return _t(this,arguments.length?arguments[0]:void 0)}},ke=ue("WeakMap",Le,se),Ge=ke.prototype,Ze=ee(Ge.set),We=function(){return Y&&H(function(){var _t=De([]);return Ze(new ke,_t,1),!xe(_t)})};if(ae)if(Ce){Ue=se.getConstructor(Le,"WeakMap",!0),te.enable();var et=ee(Ge.delete),He=ee(Ge.has),ht=ee(Ge.get);ne(Ge,{delete:function(_t){if(ie(_t)&&!ge(_t)){var ut=t(this);return ut.frozen||(ut.frozen=new Ue),et(this,_t)||ut.frozen.delete(_t)}return et(this,_t)},has:function(ut){if(ie(ut)&&!ge(ut)){var yt=t(this);return yt.frozen||(yt.frozen=new Ue),He(this,ut)||yt.frozen.has(ut)}return He(this,ut)},get:function(ut){if(ie(ut)&&!ge(ut)){var yt=t(this);return yt.frozen||(yt.frozen=new Ue),He(this,ut)?ht(this,ut):yt.frozen.get(ut)}return ht(this,ut)},set:function(ut,yt){if(ie(ut)&&!ge(ut)){var Lt=t(this);Lt.frozen||(Lt.frozen=new Ue),He(this,ut)?Ze(this,ut,yt):Lt.frozen.set(ut,yt)}else Ze(this,ut,yt);return this}})}else We()&&ne(Ge,{set:function(ut,yt){var Lt;return _e(ut)&&(xe(ut)?Lt=De:Re(ut)&&(Lt=Ie)),Ze(this,ut,yt),Lt&&Lt(ut),this}});return es_weakMap_constructor}var hasRequiredEs_weakMap;function requireEs_weakMap(){return hasRequiredEs_weakMap||(hasRequiredEs_weakMap=1,requireEs_weakMap_constructor()),es_weakMap}var es_weakSet={},es_weakSet_constructor={},hasRequiredEs_weakSet_constructor;function requireEs_weakSet_constructor(){if(hasRequiredEs_weakSet_constructor)return es_weakSet_constructor;hasRequiredEs_weakSet_constructor=1;var Y=requireCollection(),X=requireCollectionWeak();return Y("WeakSet",function(ee){return function(){return ee(this,arguments.length?arguments[0]:void 0)}},X),es_weakSet_constructor}var hasRequiredEs_weakSet;function requireEs_weakSet(){return hasRequiredEs_weakSet||(hasRequiredEs_weakSet=1,requireEs_weakSet_constructor()),es_weakSet}var web_atob={},base64Map,hasRequiredBase64Map;function requireBase64Map(){if(hasRequiredBase64Map)return base64Map;hasRequiredBase64Map=1;var Y="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",X=Y+"+/",ee=Y+"-_",ne=function(te){for(var ue={},se=0;se<64;se++)ue[te.charAt(se)]=se;return ue};return base64Map={i2c:X,c2i:ne(X),i2cUrl:ee,c2iUrl:ne(ee)},base64Map}var hasRequiredWeb_atob;function requireWeb_atob(){if(hasRequiredWeb_atob)return web_atob;hasRequiredWeb_atob=1;var Y=require_export(),X=requireGlobalThis(),ee=requireGetBuiltIn(),ne=requireFunctionUncurryThis(),te=requireFunctionCall(),ue=requireFails(),se=requireToString$1(),ie=requireValidateArgumentsLength(),t=requireBase64Map().c2i,H=/[^\d+/a-z]/i,ae=/[\t\n\f\r ]+/g,he=/[=]{1,2}$/,_e=ee("atob"),ge=String.fromCharCode,xe=ne("".charAt),Re=ne("".replace),De=ne(H.exec),Ie=!!_e&&!ue(function(){return _e("aGk=")!=="hi"}),Ce=Ie&&ue(function(){return _e(" ")!==""}),Ue=Ie&&!ue(function(){_e("a")}),Le=Ie&&!ue(function(){_e()}),ke=Ie&&_e.length!==1,Ge=!Ie||Ce||Ue||Le||ke;return Y({global:!0,bind:!0,enumerable:!0,forced:Ge},{atob:function(We){if(ie(arguments.length,1),Ie&&!Ce&&!Ue)return te(_e,X,We);var et=Re(se(We),ae,""),He="",ht=0,_t=0,ut,yt,Lt;if(et.length%4===0&&(et=Re(et,he,"")),ut=et.length,ut%4===1||De(H,et))throw new(ee("DOMException"))("The string is not correctly encoded","InvalidCharacterError");for(;ht<ut;)yt=xe(et,ht++),Lt=_t%4?Lt*64+t[yt]:t[yt],_t++%4&&(He+=ge(255&Lt>>(-2*_t&6)));return He}}),web_atob}var web_btoa={},hasRequiredWeb_btoa;function requireWeb_btoa(){if(hasRequiredWeb_btoa)return web_btoa;hasRequiredWeb_btoa=1;var Y=require_export(),X=requireGlobalThis(),ee=requireGetBuiltIn(),ne=requireFunctionUncurryThis(),te=requireFunctionCall(),ue=requireFails(),se=requireToString$1(),ie=requireValidateArgumentsLength(),t=requireBase64Map().i2c,H=ee("btoa"),ae=ne("".charAt),he=ne("".charCodeAt),_e=!!H&&!ue(function(){return H("hi")!=="aGk="}),ge=_e&&!ue(function(){H()}),xe=_e&&ue(function(){return H(null)!=="bnVsbA=="}),Re=_e&&H.length!==1;return Y({global:!0,bind:!0,enumerable:!0,forced:!_e||ge||xe||Re},{btoa:function(Ie){if(ie(arguments.length,1),_e)return te(H,X,se(Ie));for(var Ce=se(Ie),Ue="",Le=0,ke=t,Ge,Ze;ae(Ce,Le)||(ke="=",Le%1);){if(Ze=he(Ce,Le+=3/4),Ze>255)throw new(ee("DOMException"))("The string contains characters outside of the Latin1 range","InvalidCharacterError");Ge=Ge<<8|Ze,Ue+=ae(ke,63&Ge>>8-Le%1*8)}return Ue}}),web_btoa}var web_domCollections_forEach={},domIterables,hasRequiredDomIterables;function requireDomIterables(){return hasRequiredDomIterables||(hasRequiredDomIterables=1,domIterables={CSSRuleList:0,CSSStyleDeclaration:0,CSSValueList:0,ClientRectList:0,DOMRectList:0,DOMStringList:0,DOMTokenList:1,DataTransferItemList:0,FileList:0,HTMLAllCollection:0,HTMLCollection:0,HTMLFormElement:0,HTMLSelectElement:0,MediaList:0,MimeTypeArray:0,NamedNodeMap:0,NodeList:1,PaintRequestList:0,Plugin:0,PluginArray:0,SVGLengthList:0,SVGNumberList:0,SVGPathSegList:0,SVGPointList:0,SVGStringList:0,SVGTransformList:0,SourceBufferList:0,StyleSheetList:0,TextTrackCueList:0,TextTrackList:0,TouchList:0}),domIterables}var domTokenListPrototype,hasRequiredDomTokenListPrototype;function requireDomTokenListPrototype(){if(hasRequiredDomTokenListPrototype)return domTokenListPrototype;hasRequiredDomTokenListPrototype=1;var Y=requireDocumentCreateElement(),X=Y("span").classList,ee=X&&X.constructor&&X.constructor.prototype;return domTokenListPrototype=ee===Object.prototype?void 0:ee,domTokenListPrototype}var hasRequiredWeb_domCollections_forEach;function requireWeb_domCollections_forEach(){if(hasRequiredWeb_domCollections_forEach)return web_domCollections_forEach;hasRequiredWeb_domCollections_forEach=1;var Y=requireGlobalThis(),X=requireDomIterables(),ee=requireDomTokenListPrototype(),ne=requireArrayForEach(),te=requireCreateNonEnumerableProperty(),ue=function(ie){if(ie&&ie.forEach!==ne)try{te(ie,"forEach",ne)}catch{ie.forEach=ne}};for(var se in X)X[se]&&ue(Y[se]&&Y[se].prototype);return ue(ee),web_domCollections_forEach}var web_domCollections_iterator={},hasRequiredWeb_domCollections_iterator;function requireWeb_domCollections_iterator(){if(hasRequiredWeb_domCollections_iterator)return web_domCollections_iterator;hasRequiredWeb_domCollections_iterator=1;var Y=requireGlobalThis(),X=requireDomIterables(),ee=requireDomTokenListPrototype(),ne=requireEs_array_iterator(),te=requireCreateNonEnumerableProperty(),ue=requireSetToStringTag(),se=requireWellKnownSymbol(),ie=se("iterator"),t=ne.values,H=function(he,_e){if(he){if(he[ie]!==t)try{te(he,ie,t)}catch{he[ie]=t}if(ue(he,_e,!0),X[_e]){for(var ge in ne)if(he[ge]!==ne[ge])try{te(he,ge,ne[ge])}catch{he[ge]=ne[ge]}}}};for(var ae in X)H(Y[ae]&&Y[ae].prototype,ae);return H(ee,"DOMTokenList"),web_domCollections_iterator}var web_domException_constructor={},domExceptionConstants,hasRequiredDomExceptionConstants;function requireDomExceptionConstants(){return hasRequiredDomExceptionConstants||(hasRequiredDomExceptionConstants=1,domExceptionConstants={IndexSizeError:{s:"INDEX_SIZE_ERR",c:1,m:1},DOMStringSizeError:{s:"DOMSTRING_SIZE_ERR",c:2,m:0},HierarchyRequestError:{s:"HIERARCHY_REQUEST_ERR",c:3,m:1},WrongDocumentError:{s:"WRONG_DOCUMENT_ERR",c:4,m:1},InvalidCharacterError:{s:"INVALID_CHARACTER_ERR",c:5,m:1},NoDataAllowedError:{s:"NO_DATA_ALLOWED_ERR",c:6,m:0},NoModificationAllowedError:{s:"NO_MODIFICATION_ALLOWED_ERR",c:7,m:1},NotFoundError:{s:"NOT_FOUND_ERR",c:8,m:1},NotSupportedError:{s:"NOT_SUPPORTED_ERR",c:9,m:1},InUseAttributeError:{s:"INUSE_ATTRIBUTE_ERR",c:10,m:1},InvalidStateError:{s:"INVALID_STATE_ERR",c:11,m:1},SyntaxError:{s:"SYNTAX_ERR",c:12,m:1},InvalidModificationError:{s:"INVALID_MODIFICATION_ERR",c:13,m:1},NamespaceError:{s:"NAMESPACE_ERR",c:14,m:1},InvalidAccessError:{s:"INVALID_ACCESS_ERR",c:15,m:1},ValidationError:{s:"VALIDATION_ERR",c:16,m:0},TypeMismatchError:{s:"TYPE_MISMATCH_ERR",c:17,m:1},SecurityError:{s:"SECURITY_ERR",c:18,m:1},NetworkError:{s:"NETWORK_ERR",c:19,m:1},AbortError:{s:"ABORT_ERR",c:20,m:1},URLMismatchError:{s:"URL_MISMATCH_ERR",c:21,m:1},QuotaExceededError:{s:"QUOTA_EXCEEDED_ERR",c:22,m:1},TimeoutError:{s:"TIMEOUT_ERR",c:23,m:1},InvalidNodeTypeError:{s:"INVALID_NODE_TYPE_ERR",c:24,m:1},DataCloneError:{s:"DATA_CLONE_ERR",c:25,m:1}}),domExceptionConstants}var hasRequiredWeb_domException_constructor;function requireWeb_domException_constructor(){if(hasRequiredWeb_domException_constructor)return web_domException_constructor;hasRequiredWeb_domException_constructor=1;var Y=require_export(),X=requireGetBuiltIn(),ee=requireGetBuiltInNodeModule(),ne=requireFails(),te=requireObjectCreate(),ue=requireCreatePropertyDescriptor(),se=requireObjectDefineProperty().f,ie=requireDefineBuiltIn(),t=requireDefineBuiltInAccessor(),H=requireHasOwnProperty(),ae=requireAnInstance(),he=requireAnObject(),_e=requireErrorToString(),ge=requireNormalizeStringArgument(),xe=requireDomExceptionConstants(),Re=requireErrorStackClear(),De=requireInternalState(),Ie=requireDescriptors(),Ce=requireIsPure(),Ue="DOMException",Le="DATA_CLONE_ERR",ke=X("Error"),Ge=X(Ue)||function(){try{var sr=X("MessageChannel")||ee("worker_threads").MessageChannel;new sr().port1.postMessage(new WeakMap)}catch(Rr){if(Rr.name===Le&&Rr.code===25)return Rr.constructor}}(),Ze=Ge&&Ge.prototype,We=ke.prototype,et=De.set,He=De.getterFor(Ue),ht="stack"in new ke(Ue),_t=function(sr){return H(xe,sr)&&xe[sr].m?xe[sr].c:0},ut=function(){ae(this,yt);var Rr=arguments.length,Ur=ge(Rr<1?void 0:arguments[0]),Wr=ge(Rr<2?void 0:arguments[1],"Error"),Er=_t(Wr);if(et(this,{type:Ue,name:Wr,message:Ur,code:Er}),Ie||(this.name=Wr,this.message=Ur,this.code=Er),ht){var Kr=new ke(Ur);Kr.name=Ue,se(this,"stack",ue(1,Re(Kr.stack,1)))}},yt=ut.prototype=te(We),Lt=function(sr){return{enumerable:!0,configurable:!0,get:sr}},Kt=function(sr){return Lt(function(){return He(this)[sr]})};Ie&&(t(yt,"code",Kt("code")),t(yt,"message",Kt("message")),t(yt,"name",Kt("name"))),se(yt,"constructor",ue(1,ut));var ft=ne(function(){return!(new Ge instanceof ke)}),qt=ft||ne(function(){return We.toString!==_e||String(new Ge(1,2))!=="2: 1"}),nt=ft||ne(function(){return new Ge(1,"DataCloneError").code!==25}),At=ft||Ge[Le]!==25||Ze[Le]!==25,wt=Ce?qt||nt||At:ft;Y({global:!0,constructor:!0,forced:wt},{DOMException:wt?ut:Ge});var Ft=X(Ue),er=Ft.prototype;qt&&(Ce||Ge===Ft)&&ie(er,"toString",_e),nt&&Ie&&Ge===Ft&&t(er,"code",Lt(function(){return _t(he(this).name)}));for(var lr in xe)if(H(xe,lr)){var jr=xe[lr],Mr=jr.s,Lr=ue(6,jr.c);H(Ft,Mr)||se(Ft,Mr,Lr),H(er,Mr)||se(er,Mr,Lr)}return web_domException_constructor}var web_domException_stack={},hasRequiredWeb_domException_stack;function requireWeb_domException_stack(){if(hasRequiredWeb_domException_stack)return web_domException_stack;hasRequiredWeb_domException_stack=1;var Y=require_export(),X=requireGlobalThis(),ee=requireGetBuiltIn(),ne=requireCreatePropertyDescriptor(),te=requireObjectDefineProperty().f,ue=requireHasOwnProperty(),se=requireAnInstance(),ie=requireInheritIfRequired(),t=requireNormalizeStringArgument(),H=requireDomExceptionConstants(),ae=requireErrorStackClear(),he=requireDescriptors(),_e=requireIsPure(),ge="DOMException",xe=ee("Error"),Re=ee(ge),De=function(){se(this,Ie);var ut=arguments.length,yt=t(ut<1?void 0:arguments[0]),Lt=t(ut<2?void 0:arguments[1],"Error"),Kt=new Re(yt,Lt),ft=new xe(yt);return ft.name=ge,te(Kt,"stack",ne(1,ae(ft.stack,1))),ie(Kt,this,De),Kt},Ie=De.prototype=Re.prototype,Ce="stack"in new xe(ge),Ue="stack"in new Re(1,2),Le=Re&&he&&Object.getOwnPropertyDescriptor(X,ge),ke=!!Le&&!(Le.writable&&Le.configurable),Ge=Ce&&!ke&&!Ue;Y({global:!0,constructor:!0,forced:_e||Ge},{DOMException:Ge?De:Re});var Ze=ee(ge),We=Ze.prototype;if(We.constructor!==Ze){_e||te(We,"constructor",ne(1,Ze));for(var et in H)if(ue(H,et)){var He=H[et],ht=He.s;ue(Ze,ht)||te(Ze,ht,ne(6,He.c))}}return web_domException_stack}var web_domException_toStringTag={},hasRequiredWeb_domException_toStringTag;function requireWeb_domException_toStringTag(){if(hasRequiredWeb_domException_toStringTag)return web_domException_toStringTag;hasRequiredWeb_domException_toStringTag=1;var Y=requireGetBuiltIn(),X=requireSetToStringTag(),ee="DOMException";return X(Y(ee),ee),web_domException_toStringTag}var web_immediate={},web_clearImmediate={},hasRequiredWeb_clearImmediate;function requireWeb_clearImmediate(){if(hasRequiredWeb_clearImmediate)return web_clearImmediate;hasRequiredWeb_clearImmediate=1;var Y=require_export(),X=requireGlobalThis(),ee=requireTask().clear;return Y({global:!0,bind:!0,enumerable:!0,forced:X.clearImmediate!==ee},{clearImmediate:ee}),web_clearImmediate}var web_setImmediate={},schedulersFix,hasRequiredSchedulersFix;function requireSchedulersFix(){if(hasRequiredSchedulersFix)return schedulersFix;hasRequiredSchedulersFix=1;var Y=requireGlobalThis(),X=requireFunctionApply(),ee=requireIsCallable(),ne=requireEnvironment(),te=requireEnvironmentUserAgent(),ue=requireArraySlice(),se=requireValidateArgumentsLength(),ie=Y.Function,t=/MSIE .\./.test(te)||ne==="BUN"&&function(){var H=Y.Bun.version.split(".");return H.length<3||H[0]==="0"&&(H[1]<3||H[1]==="3"&&H[2]==="0")}();return schedulersFix=function(H,ae){var he=ae?2:1;return t?function(_e,ge){var xe=se(arguments.length,1)>he,Re=ee(_e)?_e:ie(_e),De=xe?ue(arguments,he):[],Ie=xe?function(){X(Re,this,De)}:Re;return ae?H(Ie,ge):H(Ie)}:H},schedulersFix}var hasRequiredWeb_setImmediate;function requireWeb_setImmediate(){if(hasRequiredWeb_setImmediate)return web_setImmediate;hasRequiredWeb_setImmediate=1;var Y=require_export(),X=requireGlobalThis(),ee=requireTask().set,ne=requireSchedulersFix(),te=X.setImmediate?ne(ee,!1):ee;return Y({global:!0,bind:!0,enumerable:!0,forced:X.setImmediate!==te},{setImmediate:te}),web_setImmediate}var hasRequiredWeb_immediate;function requireWeb_immediate(){return hasRequiredWeb_immediate||(hasRequiredWeb_immediate=1,requireWeb_clearImmediate(),requireWeb_setImmediate()),web_immediate}var web_queueMicrotask={},hasRequiredWeb_queueMicrotask;function requireWeb_queueMicrotask(){if(hasRequiredWeb_queueMicrotask)return web_queueMicrotask;hasRequiredWeb_queueMicrotask=1;var Y=require_export(),X=requireGlobalThis(),ee=requireMicrotask(),ne=requireACallable(),te=requireValidateArgumentsLength(),ue=requireFails(),se=requireDescriptors(),ie=ue(function(){return se&&Object.getOwnPropertyDescriptor(X,"queueMicrotask").value.length!==1});return Y({global:!0,enumerable:!0,dontCallGetSet:!0,forced:ie},{queueMicrotask:function(H){te(arguments.length,1),ee(ne(H))}}),web_queueMicrotask}var web_self={},hasRequiredWeb_self;function requireWeb_self(){if(hasRequiredWeb_self)return web_self;hasRequiredWeb_self=1;var Y=require_export(),X=requireGlobalThis(),ee=requireDefineBuiltInAccessor(),ne=requireDescriptors(),te=TypeError,ue=Object.defineProperty,se=X.self!==X;try{if(ne){var ie=Object.getOwnPropertyDescriptor(X,"self");(se||!ie||!ie.get||!ie.enumerable)&&ee(X,"self",{get:function(){return X},set:function(H){if(this!==X)throw new te("Illegal invocation");ue(X,"self",{value:H,writable:!0,configurable:!0,enumerable:!0})},configurable:!0,enumerable:!0})}else Y({global:!0,simple:!0,forced:se},{self:X})}catch{}return web_self}var web_structuredClone={},hasRequiredWeb_structuredClone;function requireWeb_structuredClone(){if(hasRequiredWeb_structuredClone)return web_structuredClone;hasRequiredWeb_structuredClone=1;var Y=requireIsPure(),X=require_export(),ee=requireGlobalThis(),ne=requireGetBuiltIn(),te=requireFunctionUncurryThis(),ue=requireFails(),se=requireUid(),ie=requireIsCallable(),t=requireIsConstructor(),H=requireIsNullOrUndefined(),ae=requireIsObject$1(),he=requireIsSymbol$1(),_e=requireIterate(),ge=requireAnObject(),xe=requireClassof(),Re=requireHasOwnProperty(),De=requireCreateProperty(),Ie=requireCreateNonEnumerableProperty(),Ce=requireLengthOfArrayLike(),Ue=requireValidateArgumentsLength(),Le=requireRegexpGetFlags(),ke=requireMapHelpers(),Ge=requireSetHelpers(),Ze=requireSetIterate(),We=requireDetachTransferable(),et=requireErrorStackInstallable(),He=requireStructuredCloneProperTransfer(),ht=ee.Object,_t=ee.Array,ut=ee.Date,yt=ee.Error,Lt=ee.TypeError,Kt=ee.PerformanceMark,ft=ne("DOMException"),qt=ke.Map,nt=ke.has,At=ke.get,wt=ke.set,Ft=Ge.Set,er=Ge.add,lr=Ge.has,jr=ne("Object","keys"),Mr=te([].push),Lr=te((!0).valueOf),sr=te(1.1.valueOf),Rr=te("".valueOf),Ur=te(ut.prototype.getTime),Wr=se("structuredClone"),Er="DataCloneError",Kr="Transferring",ui=function(Ve){return!ue(function(){var st=new ee.Set([7]),gt=Ve(st),Ot=Ve(ht(7));return gt===st||!gt.has(7)||!ae(Ot)||+Ot!=7})&&Ve},Ei=function(Ve,st){return!ue(function(){var gt=new st,Ot=Ve({a:gt,b:gt});return!(Ot&&Ot.a===Ot.b&&Ot.a instanceof st&&Ot.a.stack===gt.stack)})},Hr=function(Ve){return!ue(function(){var st=Ve(new ee.AggregateError([1],Wr,{cause:3}));return st.name!=="AggregateError"||st.errors[0]!==1||st.message!==Wr||st.cause!==3})},Br=ee.structuredClone,li=Y||!Ei(Br,yt)||!Ei(Br,ft)||!Hr(Br),si=!Br&&ui(function(Ve){return new Kt(Wr,{detail:Ve}).detail}),Qr=ui(Br)||si,_r=function(Ve){throw new ft("Uncloneable type: "+Ve,Er)},vr=function(Ve,st){throw new ft((st||"Cloning")+" of "+Ve+" cannot be properly polyfilled in this engine",Er)},Xr=function(Ve,st){return Qr||vr(st),Qr(Ve)},Ir=function(){var Ve;try{Ve=new ee.DataTransfer}catch{try{Ve=new ee.ClipboardEvent("").clipboardData}catch{}}return Ve&&Ve.items&&Ve.files?Ve:null},Or=function(Ve,st,gt){if(nt(st,Ve))return At(st,Ve);var Ot=gt||xe(Ve),tr,Qt,xt,Ct,Nt,dr;if(Ot==="SharedArrayBuffer")Qr?tr=Qr(Ve):tr=Ve;else{var Ke=ee.DataView;!Ke&&!ie(Ve.slice)&&vr("ArrayBuffer");try{if(ie(Ve.slice)&&!Ve.resizable)tr=Ve.slice(0);else for(Qt=Ve.byteLength,xt=("maxByteLength"in Ve)?{maxByteLength:Ve.maxByteLength}:void 0,tr=new ArrayBuffer(Qt,xt),Ct=new Ke(Ve),Nt=new Ke(tr),dr=0;dr<Qt;dr++)Nt.setUint8(dr,Ct.getUint8(dr))}catch{throw new ft("ArrayBuffer is detached",Er)}}return wt(st,Ve,tr),tr},Nr=function(Ve,st,gt,Ot,tr){var Qt=ee[st];return ae(Qt)||vr(st),new Qt(Or(Ve.buffer,tr),gt,Ot)},je=function(Ve,st){if(he(Ve)&&_r("Symbol"),!ae(Ve))return Ve;if(st){if(nt(st,Ve))return At(st,Ve)}else st=new qt;var gt=xe(Ve),Ot,tr,Qt,xt,Ct,Nt,dr,Ke;switch(gt){case"Array":Qt=_t(Ce(Ve));break;case"Object":Qt={};break;case"Map":Qt=new qt;break;case"Set":Qt=new Ft;break;case"RegExp":Qt=new RegExp(Ve.source,Le(Ve));break;case"Error":switch(tr=Ve.name,tr){case"AggregateError":Qt=new(ne(tr))([]);break;case"EvalError":case"RangeError":case"ReferenceError":case"SuppressedError":case"SyntaxError":case"TypeError":case"URIError":Qt=new(ne(tr));break;case"CompileError":case"LinkError":case"RuntimeError":Qt=new(ne("WebAssembly",tr));break;default:Qt=new yt}break;case"DOMException":Qt=new ft(Ve.message,Ve.name);break;case"ArrayBuffer":case"SharedArrayBuffer":Qt=Or(Ve,st,gt);break;case"DataView":case"Int8Array":case"Uint8Array":case"Uint8ClampedArray":case"Int16Array":case"Uint16Array":case"Int32Array":case"Uint32Array":case"Float16Array":case"Float32Array":case"Float64Array":case"BigInt64Array":case"BigUint64Array":Nt=gt==="DataView"?Ve.byteLength:Ve.length,Qt=Nr(Ve,gt,Ve.byteOffset,Nt,st);break;case"DOMQuad":try{Qt=new DOMQuad(je(Ve.p1,st),je(Ve.p2,st),je(Ve.p3,st),je(Ve.p4,st))}catch{Qt=Xr(Ve,gt)}break;case"File":if(Qr)try{Qt=Qr(Ve),xe(Qt)!==gt&&(Qt=void 0)}catch{}if(!Qt)try{Qt=new File([Ve],Ve.name,Ve)}catch{}Qt||vr(gt);break;case"FileList":if(xt=Ir(),xt){for(Ct=0,Nt=Ce(Ve);Ct<Nt;Ct++)xt.items.add(je(Ve[Ct],st));Qt=xt.files}else Qt=Xr(Ve,gt);break;case"ImageData":try{Qt=new ImageData(je(Ve.data,st),Ve.width,Ve.height,{colorSpace:Ve.colorSpace})}catch{Qt=Xr(Ve,gt)}break;default:if(Qr)Qt=Qr(Ve);else switch(gt){case"BigInt":Qt=ht(Ve.valueOf());break;case"Boolean":Qt=ht(Lr(Ve));break;case"Number":Qt=ht(sr(Ve));break;case"String":Qt=ht(Rr(Ve));break;case"Date":Qt=new ut(Ur(Ve));break;case"Blob":try{Qt=Ve.slice(0,Ve.size,Ve.type)}catch{vr(gt)}break;case"DOMPoint":case"DOMPointReadOnly":Ot=ee[gt];try{Qt=Ot.fromPoint?Ot.fromPoint(Ve):new Ot(Ve.x,Ve.y,Ve.z,Ve.w)}catch{vr(gt)}break;case"DOMRect":case"DOMRectReadOnly":Ot=ee[gt];try{Qt=Ot.fromRect?Ot.fromRect(Ve):new Ot(Ve.x,Ve.y,Ve.width,Ve.height)}catch{vr(gt)}break;case"DOMMatrix":case"DOMMatrixReadOnly":Ot=ee[gt];try{Qt=Ot.fromMatrix?Ot.fromMatrix(Ve):new Ot(Ve)}catch{vr(gt)}break;case"AudioData":case"VideoFrame":ie(Ve.clone)||vr(gt);try{Qt=Ve.clone()}catch{_r(gt)}break;case"CropTarget":case"CryptoKey":case"FileSystemDirectoryHandle":case"FileSystemFileHandle":case"FileSystemHandle":case"GPUCompilationInfo":case"GPUCompilationMessage":case"ImageBitmap":case"RTCCertificate":case"WebAssembly.Module":vr(gt);default:_r(gt)}}switch(wt(st,Ve,Qt),gt){case"Array":case"Object":for(dr=jr(Ve),Ct=0,Nt=Ce(dr);Ct<Nt;Ct++)Ke=dr[Ct],De(Qt,Ke,je(Ve[Ke],st));break;case"Map":Ve.forEach(function(Me,Ne){wt(Qt,je(Ne,st),je(Me,st))});break;case"Set":Ve.forEach(function(Me){er(Qt,je(Me,st))});break;case"Error":Ie(Qt,"message",je(Ve.message,st)),Re(Ve,"cause")&&Ie(Qt,"cause",je(Ve.cause,st)),tr==="AggregateError"?Qt.errors=je(Ve.errors,st):tr==="SuppressedError"&&(Qt.error=je(Ve.error,st),Qt.suppressed=je(Ve.suppressed,st));case"DOMException":et&&Ie(Qt,"stack",je(Ve.stack,st))}return Qt},Se=function(Ve,st){if(!ae(Ve))throw new Lt("Transfer option cannot be converted to a sequence");var gt=[];_e(Ve,function(Ne){Mr(gt,ge(Ne))});for(var Ot=0,tr=Ce(gt),Qt=new Ft,xt,Ct,Nt,dr,Ke,Me;Ot<tr;){if(xt=gt[Ot++],Ct=xe(xt),Ct==="ArrayBuffer"?lr(Qt,xt):nt(st,xt))throw new ft("Duplicate transferable",Er);if(Ct==="ArrayBuffer"){er(Qt,xt);continue}if(He)dr=Br(xt,{transfer:[xt]});else switch(Ct){case"ImageBitmap":Nt=ee.OffscreenCanvas,t(Nt)||vr(Ct,Kr);try{Ke=new Nt(xt.width,xt.height),Me=Ke.getContext("bitmaprenderer"),Me.transferFromImageBitmap(xt),dr=Ke.transferToImageBitmap()}catch{}break;case"AudioData":case"VideoFrame":(!ie(xt.clone)||!ie(xt.close))&&vr(Ct,Kr);try{dr=xt.clone(),xt.close()}catch{}break;case"MediaSourceHandle":case"MessagePort":case"MIDIAccess":case"OffscreenCanvas":case"ReadableStream":case"RTCDataChannel":case"TransformStream":case"WebTransportReceiveStream":case"WebTransportSendStream":case"WritableStream":vr(Ct,Kr)}if(dr===void 0)throw new ft("This object cannot be transferred: "+Ct,Er);wt(st,xt,dr)}return Qt},Oe=function(Ve){Ze(Ve,function(st){He?Qr(st,{transfer:[st]}):ie(st.transfer)?st.transfer():We?We(st):vr("ArrayBuffer",Kr)})};return X({global:!0,enumerable:!0,sham:!He,forced:li},{structuredClone:function(st){var gt=Ue(arguments.length,1)>1&&!H(arguments[1])?ge(arguments[1]):void 0,Ot=gt?gt.transfer:void 0,tr,Qt;Ot!==void 0&&(tr=new qt,Qt=Se(Ot,tr));var xt=je(st,tr);return Qt&&Oe(Qt),xt}}),web_structuredClone}var web_timers={},web_setInterval={},hasRequiredWeb_setInterval;function requireWeb_setInterval(){if(hasRequiredWeb_setInterval)return web_setInterval;hasRequiredWeb_setInterval=1;var Y=require_export(),X=requireGlobalThis(),ee=requireSchedulersFix(),ne=ee(X.setInterval,!0);return Y({global:!0,bind:!0,forced:X.setInterval!==ne},{setInterval:ne}),web_setInterval}var web_setTimeout={},hasRequiredWeb_setTimeout;function requireWeb_setTimeout(){if(hasRequiredWeb_setTimeout)return web_setTimeout;hasRequiredWeb_setTimeout=1;var Y=require_export(),X=requireGlobalThis(),ee=requireSchedulersFix(),ne=ee(X.setTimeout,!0);return Y({global:!0,bind:!0,forced:X.setTimeout!==ne},{setTimeout:ne}),web_setTimeout}var hasRequiredWeb_timers;function requireWeb_timers(){return hasRequiredWeb_timers||(hasRequiredWeb_timers=1,requireWeb_setInterval(),requireWeb_setTimeout()),web_timers}var web_url={},web_url_constructor={},urlConstructorDetection,hasRequiredUrlConstructorDetection;function requireUrlConstructorDetection(){if(hasRequiredUrlConstructorDetection)return urlConstructorDetection;hasRequiredUrlConstructorDetection=1;var Y=requireFails(),X=requireWellKnownSymbol(),ee=requireDescriptors(),ne=requireIsPure(),te=X("iterator");return urlConstructorDetection=!Y(function(){var ue=new URL("b?a=1&b=2&c=3","https://a"),se=ue.searchParams,ie=new URLSearchParams("a=1&a=2&b=3"),t="";return ue.pathname="c%20d",se.forEach(function(H,ae){se.delete("b"),t+=ae+H}),ie.delete("a",2),ie.delete("b",void 0),ne&&(!ue.toJSON||!ie.has("a",1)||ie.has("a",2)||!ie.has("a",void 0)||ie.has("b"))||!se.size&&(ne||!ee)||!se.sort||ue.href!=="https://a/c%20d?a=1&c=3"||se.get("c")!=="3"||String(new URLSearchParams("?a=1"))!=="a=1"||!se[te]||new URL("https://a@b").username!=="a"||new URLSearchParams(new URLSearchParams("a=b")).get("a")!=="b"||new URL("https://тест").host!=="xn--e1aybc"||new URL("https://a#б").hash!=="#%D0%B1"||t!=="a1c3"||new URL("https://x",void 0).host!=="x"}),urlConstructorDetection}var stringPunycodeToAscii,hasRequiredStringPunycodeToAscii;function requireStringPunycodeToAscii(){if(hasRequiredStringPunycodeToAscii)return stringPunycodeToAscii;hasRequiredStringPunycodeToAscii=1;var Y=requireFunctionUncurryThis(),X=2147483647,ee=36,ne=1,te=26,ue=38,se=700,ie=72,t=128,H="-",ae=/[^\0-\u007E]/,he=/[.\u3002\uFF0E\uFF61]/g,_e="Overflow: input needs wider integers to process",ge=ee-ne,xe=RangeError,Re=Y(he.exec),De=Math.floor,Ie=String.fromCharCode,Ce=Y("".charCodeAt),Ue=Y([].join),Le=Y([].push),ke=Y("".replace),Ge=Y("".split),Ze=Y("".toLowerCase),We=function(_t){for(var ut=[],yt=0,Lt=_t.length;yt<Lt;){var Kt=Ce(_t,yt++);if(Kt>=55296&&Kt<=56319&&yt<Lt){var ft=Ce(_t,yt++);(ft&64512)===56320?Le(ut,((Kt&1023)<<10)+(ft&1023)+65536):(Le(ut,Kt),yt--)}else Le(ut,Kt)}return ut},et=function(_t){return _t+22+75*(_t<26)},He=function(_t,ut,yt){var Lt=0;for(_t=yt?De(_t/se):_t>>1,_t+=De(_t/ut);_t>ge*te>>1;)_t=De(_t/ge),Lt+=ee;return De(Lt+(ge+1)*_t/(_t+ue))},ht=function(_t){var ut=[];_t=We(_t);var yt=_t.length,Lt=t,Kt=0,ft=ie,qt,nt;for(qt=0;qt<_t.length;qt++)nt=_t[qt],nt<128&&Le(ut,Ie(nt));var At=ut.length,wt=At;for(At&&Le(ut,H);wt<yt;){var Ft=X;for(qt=0;qt<_t.length;qt++)nt=_t[qt],nt>=Lt&&nt<Ft&&(Ft=nt);var er=wt+1;if(Ft-Lt>De((X-Kt)/er))throw new xe(_e);for(Kt+=(Ft-Lt)*er,Lt=Ft,qt=0;qt<_t.length;qt++){if(nt=_t[qt],nt<Lt&&++Kt>X)throw new xe(_e);if(nt===Lt){for(var lr=Kt,jr=ee;;){var Mr=jr<=ft?ne:jr>=ft+te?te:jr-ft;if(lr<Mr)break;var Lr=lr-Mr,sr=ee-Mr;Le(ut,Ie(et(Mr+Lr%sr))),lr=De(Lr/sr),jr+=ee}Le(ut,Ie(et(lr))),ft=He(Kt,er,wt===At),Kt=0,wt++}}Kt++,Lt++}return Ue(ut,"")};return stringPunycodeToAscii=function(_t){var ut=[],yt=Ge(ke(Ze(_t),he,"."),"."),Lt,Kt;for(Lt=0;Lt<yt.length;Lt++)Kt=yt[Lt],Le(ut,Re(ae,Kt)?"xn--"+ht(Kt):Kt);return Ue(ut,".")},stringPunycodeToAscii}var web_urlSearchParams_constructor,hasRequiredWeb_urlSearchParams_constructor;function requireWeb_urlSearchParams_constructor(){if(hasRequiredWeb_urlSearchParams_constructor)return web_urlSearchParams_constructor;hasRequiredWeb_urlSearchParams_constructor=1,requireEs_array_iterator(),requireEs_string_fromCodePoint();var Y=require_export(),X=requireGlobalThis(),ee=requireSafeGetBuiltIn(),ne=requireGetBuiltIn(),te=requireFunctionCall(),ue=requireFunctionUncurryThis(),se=requireDescriptors(),ie=requireUrlConstructorDetection(),t=requireDefineBuiltIn(),H=requireDefineBuiltInAccessor(),ae=requireDefineBuiltIns(),he=requireSetToStringTag(),_e=requireIteratorCreateConstructor(),ge=requireInternalState(),xe=requireAnInstance(),Re=requireIsCallable(),De=requireHasOwnProperty(),Ie=requireFunctionBindContext(),Ce=requireClassof(),Ue=requireAnObject(),Le=requireIsObject$1(),ke=requireToString$1(),Ge=requireObjectCreate(),Ze=requireCreatePropertyDescriptor(),We=requireGetIterator(),et=requireGetIteratorMethod(),He=requireCreateIterResultObject(),ht=requireValidateArgumentsLength(),_t=requireWellKnownSymbol(),ut=requireArraySort(),yt=_t("iterator"),Lt="URLSearchParams",Kt=Lt+"Iterator",ft=ge.set,qt=ge.getterFor(Lt),nt=ge.getterFor(Kt),At=ee("fetch"),wt=ee("Request"),Ft=ee("Headers"),er=wt&&wt.prototype,lr=Ft&&Ft.prototype,jr=X.TypeError,Mr=X.encodeURIComponent,Lr=String.fromCharCode,sr=ne("String","fromCodePoint"),Rr=parseInt,Ur=ue("".charAt),Wr=ue([].join),Er=ue([].push),Kr=ue("".replace),ui=ue([].shift),Ei=ue([].splice),Hr=ue("".split),Br=ue("".slice),li=ue(/./.exec),si=/\+/g,Qr="�",_r=/^[0-9a-f]+$/i,vr=function(Nt,dr){var Ke=Br(Nt,dr,dr+2);return li(_r,Ke)?Rr(Ke,16):NaN},Xr=function(Nt){for(var dr=0,Ke=128;Ke>0&&(Nt&Ke)!==0;Ke>>=1)dr++;return dr},Ir=function(Nt){var dr=null;switch(Nt.length){case 1:dr=Nt[0];break;case 2:dr=(Nt[0]&31)<<6|Nt[1]&63;break;case 3:dr=(Nt[0]&15)<<12|(Nt[1]&63)<<6|Nt[2]&63;break;case 4:dr=(Nt[0]&7)<<18|(Nt[1]&63)<<12|(Nt[2]&63)<<6|Nt[3]&63;break}return dr>1114111?null:dr},Or=function(Nt){Nt=Kr(Nt,si," ");for(var dr=Nt.length,Ke="",Me=0;Me<dr;){var Ne=Ur(Nt,Me);if(Ne==="%"){if(Ur(Nt,Me+1)==="%"||Me+3>dr){Ke+="%",Me++;continue}var rt=vr(Nt,Me+1);if(rt!==rt){Ke+=Ne,Me++;continue}Me+=2;var dt=Xr(rt);if(dt===0)Ne=Lr(rt);else{if(dt===1||dt>4){Ke+=Qr,Me++;continue}for(var vt=[rt],Mt=1;Mt<dt&&(Me++,!(Me+3>dr||Ur(Nt,Me)!=="%"));){var Pt=vr(Nt,Me+1);if(Pt!==Pt){Me+=3;break}if(Pt>191||Pt<128)break;Er(vt,Pt),Me+=2,Mt++}if(vt.length!==dt){Ke+=Qr;continue}var St=Ir(vt);St===null?Ke+=Qr:Ne=sr(St)}}Ke+=Ne,Me++}return Ke},Nr=/[!'()~]|%20/g,je={"!":"%21","'":"%27","(":"%28",")":"%29","~":"%7E","%20":"+"},Se=function(Nt){return je[Nt]},Oe=function(Nt){return Kr(Mr(Nt),Nr,Se)},Ve=_e(function(dr,Ke){ft(this,{type:Kt,target:qt(dr).entries,index:0,kind:Ke})},Lt,function(){var dr=nt(this),Ke=dr.target,Me=dr.index++;if(!Ke||Me>=Ke.length)return dr.target=null,He(void 0,!0);var Ne=Ke[Me];switch(dr.kind){case"keys":return He(Ne.key,!1);case"values":return He(Ne.value,!1)}return He([Ne.key,Ne.value],!1)},!0),st=function(Nt){this.entries=[],this.url=null,Nt!==void 0&&(Le(Nt)?this.parseObject(Nt):this.parseQuery(typeof Nt=="string"?Ur(Nt,0)==="?"?Br(Nt,1):Nt:ke(Nt)))};st.prototype={type:Lt,bindURL:function(Nt){this.url=Nt,this.update()},parseObject:function(Nt){var dr=this.entries,Ke=et(Nt),Me,Ne,rt,dt,vt,Mt,Pt;if(Ke)for(Me=We(Nt,Ke),Ne=Me.next;!(rt=te(Ne,Me)).done;){if(dt=We(Ue(rt.value)),vt=dt.next,(Mt=te(vt,dt)).done||(Pt=te(vt,dt)).done||!te(vt,dt).done)throw new jr("Expected sequence with length 2");Er(dr,{key:ke(Mt.value),value:ke(Pt.value)})}else for(var St in Nt)De(Nt,St)&&Er(dr,{key:St,value:ke(Nt[St])})},parseQuery:function(Nt){if(Nt)for(var dr=this.entries,Ke=Hr(Nt,"&"),Me=0,Ne,rt;Me<Ke.length;)Ne=Ke[Me++],Ne.length&&(rt=Hr(Ne,"="),Er(dr,{key:Or(ui(rt)),value:Or(Wr(rt,"="))}))},serialize:function(){for(var Nt=this.entries,dr=[],Ke=0,Me;Ke<Nt.length;)Me=Nt[Ke++],Er(dr,Oe(Me.key)+"="+Oe(Me.value));return Wr(dr,"&")},update:function(){this.entries.length=0,this.parseQuery(this.url.query)},updateURL:function(){this.url&&this.url.update()}};var gt=function(){xe(this,Ot);var dr=arguments.length>0?arguments[0]:void 0,Ke=ft(this,new st(dr));se||(this.size=Ke.entries.length)},Ot=gt.prototype;if(ae(Ot,{append:function(dr,Ke){var Me=qt(this);ht(arguments.length,2),Er(Me.entries,{key:ke(dr),value:ke(Ke)}),se||this.length++,Me.updateURL()},delete:function(Nt){for(var dr=qt(this),Ke=ht(arguments.length,1),Me=dr.entries,Ne=ke(Nt),rt=Ke<2?void 0:arguments[1],dt=rt===void 0?rt:ke(rt),vt=0;vt<Me.length;){var Mt=Me[vt];if(Mt.key===Ne&&(dt===void 0||Mt.value===dt)){if(Ei(Me,vt,1),dt!==void 0)break}else vt++}se||(this.size=Me.length),dr.updateURL()},get:function(dr){var Ke=qt(this).entries;ht(arguments.length,1);for(var Me=ke(dr),Ne=0;Ne<Ke.length;Ne++)if(Ke[Ne].key===Me)return Ke[Ne].value;return null},getAll:function(dr){var Ke=qt(this).entries;ht(arguments.length,1);for(var Me=ke(dr),Ne=[],rt=0;rt<Ke.length;rt++)Ke[rt].key===Me&&Er(Ne,Ke[rt].value);return Ne},has:function(dr){for(var Ke=qt(this).entries,Me=ht(arguments.length,1),Ne=ke(dr),rt=Me<2?void 0:arguments[1],dt=rt===void 0?rt:ke(rt),vt=0;vt<Ke.length;){var Mt=Ke[vt++];if(Mt.key===Ne&&(dt===void 0||Mt.value===dt))return!0}return!1},set:function(dr,Ke){var Me=qt(this);ht(arguments.length,1);for(var Ne=Me.entries,rt=!1,dt=ke(dr),vt=ke(Ke),Mt=0,Pt;Mt<Ne.length;Mt++)Pt=Ne[Mt],Pt.key===dt&&(rt?Ei(Ne,Mt--,1):(rt=!0,Pt.value=vt));rt||Er(Ne,{key:dt,value:vt}),se||(this.size=Ne.length),Me.updateURL()},sort:function(){var dr=qt(this);ut(dr.entries,function(Ke,Me){return Ke.key>Me.key?1:-1}),dr.updateURL()},forEach:function(dr){for(var Ke=qt(this).entries,Me=Ie(dr,arguments.length>1?arguments[1]:void 0),Ne=0,rt;Ne<Ke.length;)rt=Ke[Ne++],Me(rt.value,rt.key,this)},keys:function(){return new Ve(this,"keys")},values:function(){return new Ve(this,"values")},entries:function(){return new Ve(this,"entries")}},{enumerable:!0}),t(Ot,yt,Ot.entries,{name:"entries"}),t(Ot,"toString",function(){return qt(this).serialize()},{enumerable:!0}),se&&H(Ot,"size",{get:function(){return qt(this).entries.length},configurable:!0,enumerable:!0}),he(gt,Lt),Y({global:!0,constructor:!0,forced:!ie},{URLSearchParams:gt}),!ie&&Re(Ft)){var tr=ue(lr.has),Qt=ue(lr.set),xt=function(Nt){if(Le(Nt)){var dr=Nt.body,Ke;if(Ce(dr)===Lt)return Ke=Nt.headers?new Ft(Nt.headers):new Ft,tr(Ke,"content-type")||Qt(Ke,"content-type","application/x-www-form-urlencoded;charset=UTF-8"),Ge(Nt,{body:Ze(0,ke(dr)),headers:Ze(0,Ke)})}return Nt};if(Re(At)&&Y({global:!0,enumerable:!0,dontCallGetSet:!0,forced:!0},{fetch:function(dr){return At(dr,arguments.length>1?xt(arguments[1]):{})}}),Re(wt)){var Ct=function(dr){return xe(this,er),new wt(dr,arguments.length>1?xt(arguments[1]):{})};er.constructor=Ct,Ct.prototype=er,Y({global:!0,constructor:!0,dontCallGetSet:!0,forced:!0},{Request:Ct})}}return web_urlSearchParams_constructor={URLSearchParams:gt,getState:qt},web_urlSearchParams_constructor}var hasRequiredWeb_url_constructor;function requireWeb_url_constructor(){if(hasRequiredWeb_url_constructor)return web_url_constructor;hasRequiredWeb_url_constructor=1,requireEs_string_iterator();var Y=require_export(),X=requireDescriptors(),ee=requireUrlConstructorDetection(),ne=requireGlobalThis(),te=requireFunctionBindContext(),ue=requireFunctionUncurryThis(),se=requireDefineBuiltIn(),ie=requireDefineBuiltInAccessor(),t=requireAnInstance(),H=requireHasOwnProperty(),ae=requireObjectAssign(),he=requireArrayFrom(),_e=requireArraySlice(),ge=requireStringMultibyte().codeAt,xe=requireStringPunycodeToAscii(),Re=requireToString$1(),De=requireSetToStringTag(),Ie=requireValidateArgumentsLength(),Ce=requireWeb_urlSearchParams_constructor(),Ue=requireInternalState(),Le=Ue.set,ke=Ue.getterFor("URL"),Ge=Ce.URLSearchParams,Ze=Ce.getState,We=ne.URL,et=ne.TypeError,He=ne.parseInt,ht=Math.floor,_t=Math.pow,ut=ue("".charAt),yt=ue(/./.exec),Lt=ue([].join),Kt=ue(1.1.toString),ft=ue([].pop),qt=ue([].push),nt=ue("".replace),At=ue([].shift),wt=ue("".split),Ft=ue("".slice),er=ue("".toLowerCase),lr=ue([].unshift),jr="Invalid authority",Mr="Invalid scheme",Lr="Invalid host",sr="Invalid port",Rr=/[a-z]/i,Ur=/[\d+-.a-z]/i,Wr=/\d/,Er=/^0x/i,Kr=/^[0-7]+$/,ui=/^\d+$/,Ei=/^[\da-f]+$/i,Hr=/[\0\t\n\r #%/:<>?@[\\\]^|]/,Br=/[\0\t\n\r #/:<>?@[\\\]^|]/,li=/^[\u0000-\u0020]+/,si=/(^|[^\u0000-\u0020])[\u0000-\u0020]+$/,Qr=/[\t\n\r]/g,_r,vr=function(Gt){var fr=wt(Gt,"."),Xt,Ut,wr,zr,Yr,Zi,en;if(fr.length&&fr[fr.length-1]===""&&fr.length--,Xt=fr.length,Xt>4)return Gt;for(Ut=[],wr=0;wr<Xt;wr++){if(zr=fr[wr],zr==="")return Gt;if(Yr=10,zr.length>1&&ut(zr,0)==="0"&&(Yr=yt(Er,zr)?16:8,zr=Ft(zr,Yr===8?1:2)),zr==="")Zi=0;else{if(!yt(Yr===10?ui:Yr===8?Kr:Ei,zr))return Gt;Zi=He(zr,Yr)}qt(Ut,Zi)}for(wr=0;wr<Xt;wr++)if(Zi=Ut[wr],wr===Xt-1){if(Zi>=_t(256,5-Xt))return null}else if(Zi>255)return null;for(en=ft(Ut),wr=0;wr<Ut.length;wr++)en+=Ut[wr]*_t(256,3-wr);return en},Xr=function(Gt){var fr=[0,0,0,0,0,0,0,0],Xt=0,Ut=null,wr=0,zr,Yr,Zi,en,an,tn,qr,on=function(){return ut(Gt,wr)};if(on()===":"){if(ut(Gt,1)!==":")return;wr+=2,Xt++,Ut=Xt}for(;on();){if(Xt===8)return;if(on()===":"){if(Ut!==null)return;wr++,Xt++,Ut=Xt;continue}for(zr=Yr=0;Yr<4&&yt(Ei,on());)zr=zr*16+He(on(),16),wr++,Yr++;if(on()==="."){if(Yr===0||(wr-=Yr,Xt>6))return;for(Zi=0;on();){if(en=null,Zi>0)if(on()==="."&&Zi<4)wr++;else return;if(!yt(Wr,on()))return;for(;yt(Wr,on());){if(an=He(on(),10),en===null)en=an;else{if(en===0)return;en=en*10+an}if(en>255)return;wr++}fr[Xt]=fr[Xt]*256+en,Zi++,(Zi===2||Zi===4)&&Xt++}if(Zi!==4)return;break}else if(on()===":"){if(wr++,!on())return}else if(on())return;fr[Xt++]=zr}if(Ut!==null)for(tn=Xt-Ut,Xt=7;Xt!==0&&tn>0;)qr=fr[Xt],fr[Xt--]=fr[Ut+tn-1],fr[Ut+--tn]=qr;else if(Xt!==8)return;return fr},Ir=function(Gt){for(var fr=null,Xt=1,Ut=null,wr=0,zr=0;zr<8;zr++)Gt[zr]!==0?(wr>Xt&&(fr=Ut,Xt=wr),Ut=null,wr=0):(Ut===null&&(Ut=zr),++wr);return wr>Xt?Ut:fr},Or=function(Gt){var fr,Xt,Ut,wr;if(typeof Gt=="number"){for(fr=[],Xt=0;Xt<4;Xt++)lr(fr,Gt%256),Gt=ht(Gt/256);return Lt(fr,".")}if(typeof Gt=="object"){for(fr="",Ut=Ir(Gt),Xt=0;Xt<8;Xt++)wr&&Gt[Xt]===0||(wr&&(wr=!1),Ut===Xt?(fr+=Xt?":":"::",wr=!0):(fr+=Kt(Gt[Xt],16),Xt<7&&(fr+=":")));return"["+fr+"]"}return Gt},Nr={},je=ae({},Nr,{" ":1,'"':1,"<":1,">":1,"`":1}),Se=ae({},je,{"#":1,"?":1,"{":1,"}":1}),Oe=ae({},Se,{"/":1,":":1,";":1,"=":1,"@":1,"[":1,"\\":1,"]":1,"^":1,"|":1}),Ve=function(Gt,fr){var Xt=ge(Gt,0);return Xt>32&&Xt<127&&!H(fr,Gt)?Gt:encodeURIComponent(Gt)},st={ftp:21,file:null,http:80,https:443,ws:80,wss:443},gt=function(Gt,fr){var Xt;return Gt.length===2&&yt(Rr,ut(Gt,0))&&((Xt=ut(Gt,1))===":"||!fr&&Xt==="|")},Ot=function(Gt){var fr;return Gt.length>1&&gt(Ft(Gt,0,2))&&(Gt.length===2||(fr=ut(Gt,2))==="/"||fr==="\\"||fr==="?"||fr==="#")},tr=function(Gt){return Gt==="."||er(Gt)==="%2e"},Qt=function(Gt){return Gt=er(Gt),Gt===".."||Gt==="%2e."||Gt===".%2e"||Gt==="%2e%2e"},xt={},Ct={},Nt={},dr={},Ke={},Me={},Ne={},rt={},dt={},vt={},Mt={},Pt={},St={},Wt={},br={},Ar={},cr={},ti={},ci={},ni={},oi={},yi=function(Gt,fr,Xt){var Ut=Re(Gt),wr,zr,Yr;if(fr){if(zr=this.parse(Ut),zr)throw new et(zr);this.searchParams=null}else{if(Xt!==void 0&&(wr=new yi(Xt,!0)),zr=this.parse(Ut,null,wr),zr)throw new et(zr);Yr=Ze(new Ge),Yr.bindURL(this),this.searchParams=Yr}};yi.prototype={type:"URL",parse:function(Gt,fr,Xt){var Ut=this,wr=fr||xt,zr=0,Yr="",Zi=!1,en=!1,an=!1,tn,qr,on,Nn;for(Gt=Re(Gt),fr||(Ut.scheme="",Ut.username="",Ut.password="",Ut.host=null,Ut.port=null,Ut.path=[],Ut.query=null,Ut.fragment=null,Ut.cannotBeABaseURL=!1,Gt=nt(Gt,li,""),Gt=nt(Gt,si,"$1")),Gt=nt(Gt,Qr,""),tn=he(Gt);zr<=tn.length;){switch(qr=tn[zr],wr){case xt:if(qr&&yt(Rr,qr))Yr+=er(qr),wr=Ct;else{if(fr)return Mr;wr=Nt;continue}break;case Ct:if(qr&&(yt(Ur,qr)||qr==="+"||qr==="-"||qr==="."))Yr+=er(qr);else if(qr===":"){if(fr&&(Ut.isSpecial()!==H(st,Yr)||Yr==="file"&&(Ut.includesCredentials()||Ut.port!==null)||Ut.scheme==="file"&&!Ut.host))return;if(Ut.scheme=Yr,fr){Ut.isSpecial()&&st[Ut.scheme]===Ut.port&&(Ut.port=null);return}Yr="",Ut.scheme==="file"?wr=Wt:Ut.isSpecial()&&Xt&&Xt.scheme===Ut.scheme?wr=dr:Ut.isSpecial()?wr=rt:tn[zr+1]==="/"?(wr=Ke,zr++):(Ut.cannotBeABaseURL=!0,qt(Ut.path,""),wr=ci)}else{if(fr)return Mr;Yr="",wr=Nt,zr=0;continue}break;case Nt:if(!Xt||Xt.cannotBeABaseURL&&qr!=="#")return Mr;if(Xt.cannotBeABaseURL&&qr==="#"){Ut.scheme=Xt.scheme,Ut.path=_e(Xt.path),Ut.query=Xt.query,Ut.fragment="",Ut.cannotBeABaseURL=!0,wr=oi;break}wr=Xt.scheme==="file"?Wt:Me;continue;case dr:if(qr==="/"&&tn[zr+1]==="/")wr=dt,zr++;else{wr=Me;continue}break;case Ke:if(qr==="/"){wr=vt;break}else{wr=ti;continue}case Me:if(Ut.scheme=Xt.scheme,qr===_r)Ut.username=Xt.username,Ut.password=Xt.password,Ut.host=Xt.host,Ut.port=Xt.port,Ut.path=_e(Xt.path),Ut.query=Xt.query;else if(qr==="/"||qr==="\\"&&Ut.isSpecial())wr=Ne;else if(qr==="?")Ut.username=Xt.username,Ut.password=Xt.password,Ut.host=Xt.host,Ut.port=Xt.port,Ut.path=_e(Xt.path),Ut.query="",wr=ni;else if(qr==="#")Ut.username=Xt.username,Ut.password=Xt.password,Ut.host=Xt.host,Ut.port=Xt.port,Ut.path=_e(Xt.path),Ut.query=Xt.query,Ut.fragment="",wr=oi;else{Ut.username=Xt.username,Ut.password=Xt.password,Ut.host=Xt.host,Ut.port=Xt.port,Ut.path=_e(Xt.path),Ut.path.length--,wr=ti;continue}break;case Ne:if(Ut.isSpecial()&&(qr==="/"||qr==="\\"))wr=dt;else if(qr==="/")wr=vt;else{Ut.username=Xt.username,Ut.password=Xt.password,Ut.host=Xt.host,Ut.port=Xt.port,wr=ti;continue}break;case rt:if(wr=dt,qr!=="/"||ut(Yr,zr+1)!=="/")continue;zr++;break;case dt:if(qr!=="/"&&qr!=="\\"){wr=vt;continue}break;case vt:if(qr==="@"){Zi&&(Yr="%40"+Yr),Zi=!0,on=he(Yr);for(var ea=0;ea<on.length;ea++){var Gn=on[ea];if(Gn===":"&&!an){an=!0;continue}var Da=Ve(Gn,Oe);an?Ut.password+=Da:Ut.username+=Da}Yr=""}else if(qr===_r||qr==="/"||qr==="?"||qr==="#"||qr==="\\"&&Ut.isSpecial()){if(Zi&&Yr==="")return jr;zr-=he(Yr).length+1,Yr="",wr=Mt}else Yr+=qr;break;case Mt:case Pt:if(fr&&Ut.scheme==="file"){wr=Ar;continue}else if(qr===":"&&!en){if(Yr==="")return Lr;if(Nn=Ut.parseHost(Yr),Nn)return Nn;if(Yr="",wr=St,fr===Pt)return}else if(qr===_r||qr==="/"||qr==="?"||qr==="#"||qr==="\\"&&Ut.isSpecial()){if(Ut.isSpecial()&&Yr==="")return Lr;if(fr&&Yr===""&&(Ut.includesCredentials()||Ut.port!==null))return;if(Nn=Ut.parseHost(Yr),Nn)return Nn;if(Yr="",wr=cr,fr)return;continue}else qr==="["?en=!0:qr==="]"&&(en=!1),Yr+=qr;break;case St:if(yt(Wr,qr))Yr+=qr;else if(qr===_r||qr==="/"||qr==="?"||qr==="#"||qr==="\\"&&Ut.isSpecial()||fr){if(Yr!==""){var Yt=He(Yr,10);if(Yt>65535)return sr;Ut.port=Ut.isSpecial()&&Yt===st[Ut.scheme]?null:Yt,Yr=""}if(fr)return;wr=cr;continue}else return sr;break;case Wt:if(Ut.scheme="file",qr==="/"||qr==="\\")wr=br;else if(Xt&&Xt.scheme==="file")switch(qr){case _r:Ut.host=Xt.host,Ut.path=_e(Xt.path),Ut.query=Xt.query;break;case"?":Ut.host=Xt.host,Ut.path=_e(Xt.path),Ut.query="",wr=ni;break;case"#":Ut.host=Xt.host,Ut.path=_e(Xt.path),Ut.query=Xt.query,Ut.fragment="",wr=oi;break;default:Ot(Lt(_e(tn,zr),""))||(Ut.host=Xt.host,Ut.path=_e(Xt.path),Ut.shortenPath()),wr=ti;continue}else{wr=ti;continue}break;case br:if(qr==="/"||qr==="\\"){wr=Ar;break}Xt&&Xt.scheme==="file"&&!Ot(Lt(_e(tn,zr),""))&&(gt(Xt.path[0],!0)?qt(Ut.path,Xt.path[0]):Ut.host=Xt.host),wr=ti;continue;case Ar:if(qr===_r||qr==="/"||qr==="\\"||qr==="?"||qr==="#"){if(!fr&&gt(Yr))wr=ti;else if(Yr===""){if(Ut.host="",fr)return;wr=cr}else{if(Nn=Ut.parseHost(Yr),Nn)return Nn;if(Ut.host==="localhost"&&(Ut.host=""),fr)return;Yr="",wr=cr}continue}else Yr+=qr;break;case cr:if(Ut.isSpecial()){if(wr=ti,qr!=="/"&&qr!=="\\")continue}else if(!fr&&qr==="?")Ut.query="",wr=ni;else if(!fr&&qr==="#")Ut.fragment="",wr=oi;else if(qr!==_r&&(wr=ti,qr!=="/"))continue;break;case ti:if(qr===_r||qr==="/"||qr==="\\"&&Ut.isSpecial()||!fr&&(qr==="?"||qr==="#")){if(Qt(Yr)?(Ut.shortenPath(),qr!=="/"&&!(qr==="\\"&&Ut.isSpecial())&&qt(Ut.path,"")):tr(Yr)?qr!=="/"&&!(qr==="\\"&&Ut.isSpecial())&&qt(Ut.path,""):(Ut.scheme==="file"&&!Ut.path.length&&gt(Yr)&&(Ut.host&&(Ut.host=""),Yr=ut(Yr,0)+":"),qt(Ut.path,Yr)),Yr="",Ut.scheme==="file"&&(qr===_r||qr==="?"||qr==="#"))for(;Ut.path.length>1&&Ut.path[0]==="";)At(Ut.path);qr==="?"?(Ut.query="",wr=ni):qr==="#"&&(Ut.fragment="",wr=oi)}else Yr+=Ve(qr,Se);break;case ci:qr==="?"?(Ut.query="",wr=ni):qr==="#"?(Ut.fragment="",wr=oi):qr!==_r&&(Ut.path[0]+=Ve(qr,Nr));break;case ni:!fr&&qr==="#"?(Ut.fragment="",wr=oi):qr!==_r&&(qr==="'"&&Ut.isSpecial()?Ut.query+="%27":qr==="#"?Ut.query+="%23":Ut.query+=Ve(qr,Nr));break;case oi:qr!==_r&&(Ut.fragment+=Ve(qr,je));break}zr++}},parseHost:function(Gt){var fr,Xt,Ut;if(ut(Gt,0)==="["){if(ut(Gt,Gt.length-1)!=="]"||(fr=Xr(Ft(Gt,1,-1)),!fr))return Lr;this.host=fr}else if(this.isSpecial()){if(Gt=xe(Gt),yt(Hr,Gt)||(fr=vr(Gt),fr===null))return Lr;this.host=fr}else{if(yt(Br,Gt))return Lr;for(fr="",Xt=he(Gt),Ut=0;Ut<Xt.length;Ut++)fr+=Ve(Xt[Ut],Nr);this.host=fr}},cannotHaveUsernamePasswordPort:function(){return!this.host||this.cannotBeABaseURL||this.scheme==="file"},includesCredentials:function(){return this.username!==""||this.password!==""},isSpecial:function(){return H(st,this.scheme)},shortenPath:function(){var Gt=this.path,fr=Gt.length;fr&&(this.scheme!=="file"||fr!==1||!gt(Gt[0],!0))&&Gt.length--},serialize:function(){var Gt=this,fr=Gt.scheme,Xt=Gt.username,Ut=Gt.password,wr=Gt.host,zr=Gt.port,Yr=Gt.path,Zi=Gt.query,en=Gt.fragment,an=fr+":";return wr!==null?(an+="//",Gt.includesCredentials()&&(an+=Xt+(Ut?":"+Ut:"")+"@"),an+=Or(wr),zr!==null&&(an+=":"+zr)):fr==="file"&&(an+="//"),an+=Gt.cannotBeABaseURL?Yr[0]:Yr.length?"/"+Lt(Yr,"/"):"",Zi!==null&&(an+="?"+Zi),en!==null&&(an+="#"+en),an},setHref:function(Gt){var fr=this.parse(Gt);if(fr)throw new et(fr);this.searchParams.update()},getOrigin:function(){var Gt=this.scheme,fr=this.port;if(Gt==="blob")try{return new Ai(Gt.path[0]).origin}catch{return"null"}return Gt==="file"||!this.isSpecial()?"null":Gt+"://"+Or(this.host)+(fr!==null?":"+fr:"")},getProtocol:function(){return this.scheme+":"},setProtocol:function(Gt){this.parse(Re(Gt)+":",xt)},getUsername:function(){return this.username},setUsername:function(Gt){var fr=he(Re(Gt));if(!this.cannotHaveUsernamePasswordPort()){this.username="";for(var Xt=0;Xt<fr.length;Xt++)this.username+=Ve(fr[Xt],Oe)}},getPassword:function(){return this.password},setPassword:function(Gt){var fr=he(Re(Gt));if(!this.cannotHaveUsernamePasswordPort()){this.password="";for(var Xt=0;Xt<fr.length;Xt++)this.password+=Ve(fr[Xt],Oe)}},getHost:function(){var Gt=this.host,fr=this.port;return Gt===null?"":fr===null?Or(Gt):Or(Gt)+":"+fr},setHost:function(Gt){this.cannotBeABaseURL||this.parse(Gt,Mt)},getHostname:function(){var Gt=this.host;return Gt===null?"":Or(Gt)},setHostname:function(Gt){this.cannotBeABaseURL||this.parse(Gt,Pt)},getPort:function(){var Gt=this.port;return Gt===null?"":Re(Gt)},setPort:function(Gt){this.cannotHaveUsernamePasswordPort()||(Gt=Re(Gt),Gt===""?this.port=null:this.parse(Gt,St))},getPathname:function(){var Gt=this.path;return this.cannotBeABaseURL?Gt[0]:Gt.length?"/"+Lt(Gt,"/"):""},setPathname:function(Gt){this.cannotBeABaseURL||(this.path=[],this.parse(Gt,cr))},getSearch:function(){var Gt=this.query;return Gt?"?"+Gt:""},setSearch:function(Gt){Gt=Re(Gt),Gt===""?this.query=null:(ut(Gt,0)==="?"&&(Gt=Ft(Gt,1)),this.query="",this.parse(Gt,ni)),this.searchParams.update()},getSearchParams:function(){return this.searchParams.facade},getHash:function(){var Gt=this.fragment;return Gt?"#"+Gt:""},setHash:function(Gt){if(Gt=Re(Gt),Gt===""){this.fragment=null;return}ut(Gt,0)==="#"&&(Gt=Ft(Gt,1)),this.fragment="",this.parse(Gt,oi)},update:function(){this.query=this.searchParams.serialize()||null}};var Ai=function(fr){var Xt=t(this,wi),Ut=Ie(arguments.length,1)>1?arguments[1]:void 0,wr=Le(Xt,new yi(fr,!1,Ut));X||(Xt.href=wr.serialize(),Xt.origin=wr.getOrigin(),Xt.protocol=wr.getProtocol(),Xt.username=wr.getUsername(),Xt.password=wr.getPassword(),Xt.host=wr.getHost(),Xt.hostname=wr.getHostname(),Xt.port=wr.getPort(),Xt.pathname=wr.getPathname(),Xt.search=wr.getSearch(),Xt.searchParams=wr.getSearchParams(),Xt.hash=wr.getHash())},wi=Ai.prototype,Mi=function(Gt,fr){return{get:function(){return ke(this)[Gt]()},set:fr&&function(Xt){return ke(this)[fr](Xt)},configurable:!0,enumerable:!0}};if(X&&(ie(wi,"href",Mi("serialize","setHref")),ie(wi,"origin",Mi("getOrigin")),ie(wi,"protocol",Mi("getProtocol","setProtocol")),ie(wi,"username",Mi("getUsername","setUsername")),ie(wi,"password",Mi("getPassword","setPassword")),ie(wi,"host",Mi("getHost","setHost")),ie(wi,"hostname",Mi("getHostname","setHostname")),ie(wi,"port",Mi("getPort","setPort")),ie(wi,"pathname",Mi("getPathname","setPathname")),ie(wi,"search",Mi("getSearch","setSearch")),ie(wi,"searchParams",Mi("getSearchParams")),ie(wi,"hash",Mi("getHash","setHash"))),se(wi,"toJSON",function(){return ke(this).serialize()},{enumerable:!0}),se(wi,"toString",function(){return ke(this).serialize()},{enumerable:!0}),We){var Hi=We.createObjectURL,qn=We.revokeObjectURL;Hi&&se(Ai,"createObjectURL",te(Hi,We)),qn&&se(Ai,"revokeObjectURL",te(qn,We))}return De(Ai,"URL"),Y({global:!0,constructor:!0,forced:!ee,sham:!X},{URL:Ai}),web_url_constructor}var hasRequiredWeb_url;function requireWeb_url(){return hasRequiredWeb_url||(hasRequiredWeb_url=1,requireWeb_url_constructor()),web_url}var web_url_canParse={},hasRequiredWeb_url_canParse;function requireWeb_url_canParse(){if(hasRequiredWeb_url_canParse)return web_url_canParse;hasRequiredWeb_url_canParse=1;var Y=require_export(),X=requireGetBuiltIn(),ee=requireFails(),ne=requireValidateArgumentsLength(),te=requireToString$1(),ue=requireUrlConstructorDetection(),se=X("URL"),ie=ue&&ee(function(){se.canParse()}),t=ee(function(){return se.canParse.length!==1});return Y({target:"URL",stat:!0,forced:!ie||t},{canParse:function(ae){var he=ne(arguments.length,1),_e=te(ae),ge=he<2||arguments[1]===void 0?void 0:te(arguments[1]);try{return!!new se(_e,ge)}catch{return!1}}}),web_url_canParse}var web_url_parse={},hasRequiredWeb_url_parse;function requireWeb_url_parse(){if(hasRequiredWeb_url_parse)return web_url_parse;hasRequiredWeb_url_parse=1;var Y=require_export(),X=requireGetBuiltIn(),ee=requireValidateArgumentsLength(),ne=requireToString$1(),te=requireUrlConstructorDetection(),ue=X("URL");return Y({target:"URL",stat:!0,forced:!te},{parse:function(ie){var t=ee(arguments.length,1),H=ne(ie),ae=t<2||arguments[1]===void 0?void 0:ne(arguments[1]);try{return new ue(H,ae)}catch{return null}}}),web_url_parse}var web_url_toJson={},hasRequiredWeb_url_toJson;function requireWeb_url_toJson(){if(hasRequiredWeb_url_toJson)return web_url_toJson;hasRequiredWeb_url_toJson=1;var Y=require_export(),X=requireFunctionCall();return Y({target:"URL",proto:!0,enumerable:!0},{toJSON:function(){return X(URL.prototype.toString,this)}}),web_url_toJson}var web_urlSearchParams={},hasRequiredWeb_urlSearchParams;function requireWeb_urlSearchParams(){return hasRequiredWeb_urlSearchParams||(hasRequiredWeb_urlSearchParams=1,requireWeb_urlSearchParams_constructor()),web_urlSearchParams}var web_urlSearchParams_delete={},hasRequiredWeb_urlSearchParams_delete;function requireWeb_urlSearchParams_delete(){if(hasRequiredWeb_urlSearchParams_delete)return web_urlSearchParams_delete;hasRequiredWeb_urlSearchParams_delete=1;var Y=requireDefineBuiltIn(),X=requireFunctionUncurryThis(),ee=requireToString$1(),ne=requireValidateArgumentsLength(),te=URLSearchParams,ue=te.prototype,se=X(ue.append),ie=X(ue.delete),t=X(ue.forEach),H=X([].push),ae=new te("a=1&a=2&b=3");return ae.delete("a",1),ae.delete("b",void 0),ae+""!="a=2"&&Y(ue,"delete",function(he){var _e=arguments.length,ge=_e<2?void 0:arguments[1];if(_e&&ge===void 0)return ie(this,he);var xe=[];t(this,function(Ge,Ze){H(xe,{key:Ze,value:Ge})}),ne(_e,1);for(var Re=ee(he),De=ee(ge),Ie=0,Ce=0,Ue=!1,Le=xe.length,ke;Ie<Le;)ke=xe[Ie++],Ue||ke.key===Re?(Ue=!0,ie(this,ke.key)):Ce++;for(;Ce<Le;)ke=xe[Ce++],ke.key===Re&&ke.value===De||se(this,ke.key,ke.value)},{enumerable:!0,unsafe:!0}),web_urlSearchParams_delete}var web_urlSearchParams_has={},hasRequiredWeb_urlSearchParams_has;function requireWeb_urlSearchParams_has(){if(hasRequiredWeb_urlSearchParams_has)return web_urlSearchParams_has;hasRequiredWeb_urlSearchParams_has=1;var Y=requireDefineBuiltIn(),X=requireFunctionUncurryThis(),ee=requireToString$1(),ne=requireValidateArgumentsLength(),te=URLSearchParams,ue=te.prototype,se=X(ue.getAll),ie=X(ue.has),t=new te("a=1");return(t.has("a",2)||!t.has("a",void 0))&&Y(ue,"has",function(ae){var he=arguments.length,_e=he<2?void 0:arguments[1];if(he&&_e===void 0)return ie(this,ae);var ge=se(this,ae);ne(he,1);for(var xe=ee(_e),Re=0;Re<ge.length;)if(ge[Re++]===xe)return!0;return!1},{enumerable:!0,unsafe:!0}),web_urlSearchParams_has}var web_urlSearchParams_size={},hasRequiredWeb_urlSearchParams_size;function requireWeb_urlSearchParams_size(){if(hasRequiredWeb_urlSearchParams_size)return web_urlSearchParams_size;hasRequiredWeb_urlSearchParams_size=1;var Y=requireDescriptors(),X=requireFunctionUncurryThis(),ee=requireDefineBuiltInAccessor(),ne=URLSearchParams.prototype,te=X(ne.forEach);return Y&&!("size"in ne)&&ee(ne,"size",{get:function(){var se=0;return te(this,function(){se++}),se},configurable:!0,enumerable:!0}),web_urlSearchParams_size}var stable,hasRequiredStable;function requireStable(){return hasRequiredStable||(hasRequiredStable=1,requireEs_symbol(),requireEs_symbol_description(),requireEs_symbol_asyncDispose(),requireEs_symbol_asyncIterator(),requireEs_symbol_dispose(),requireEs_symbol_hasInstance(),requireEs_symbol_isConcatSpreadable(),requireEs_symbol_iterator(),requireEs_symbol_match(),requireEs_symbol_matchAll(),requireEs_symbol_replace(),requireEs_symbol_search(),requireEs_symbol_species(),requireEs_symbol_split(),requireEs_symbol_toPrimitive(),requireEs_symbol_toStringTag(),requireEs_symbol_unscopables(),requireEs_error_cause(),requireEs_error_isError(),requireEs_error_toString(),requireEs_aggregateError(),requireEs_aggregateError_cause(),requireEs_suppressedError_constructor(),requireEs_array_at(),requireEs_array_concat(),requireEs_array_copyWithin(),requireEs_array_every(),requireEs_array_fill(),requireEs_array_filter(),requireEs_array_find(),requireEs_array_findIndex(),requireEs_array_findLast(),requireEs_array_findLastIndex(),requireEs_array_flat(),requireEs_array_flatMap(),requireEs_array_forEach(),requireEs_array_from(),requireEs_array_includes(),requireEs_array_indexOf(),requireEs_array_isArray(),requireEs_array_iterator(),requireEs_array_join(),requireEs_array_lastIndexOf(),requireEs_array_map(),requireEs_array_of(),requireEs_array_push(),requireEs_array_reduce(),requireEs_array_reduceRight(),requireEs_array_reverse(),requireEs_array_slice(),requireEs_array_some(),requireEs_array_sort(),requireEs_array_species(),requireEs_array_splice(),requireEs_array_toReversed(),requireEs_array_toSorted(),requireEs_array_toSpliced(),requireEs_array_unscopables_flat(),requireEs_array_unscopables_flatMap(),requireEs_array_unshift(),requireEs_array_with(),requireEs_arrayBuffer_constructor(),requireEs_arrayBuffer_isView(),requireEs_arrayBuffer_slice(),requireEs_dataView(),requireEs_dataView_getFloat16(),requireEs_dataView_setFloat16(),requireEs_arrayBuffer_detached(),requireEs_arrayBuffer_transfer(),requireEs_arrayBuffer_transferToFixedLength(),requireEs_date_getYear(),requireEs_date_now(),requireEs_date_setYear(),requireEs_date_toGmtString(),requireEs_date_toIsoString(),requireEs_date_toJson(),requireEs_date_toPrimitive(),requireEs_date_toString(),requireEs_disposableStack_constructor(),requireEs_escape(),requireEs_function_bind(),requireEs_function_hasInstance(),requireEs_function_name(),requireEs_globalThis(),requireEs_iterator_constructor(),requireEs_iterator_dispose(),requireEs_iterator_drop(),requireEs_iterator_every(),requireEs_iterator_filter(),requireEs_iterator_find(),requireEs_iterator_flatMap(),requireEs_iterator_forEach(),requireEs_iterator_from(),requireEs_iterator_map(),requireEs_iterator_reduce(),requireEs_iterator_some(),requireEs_iterator_take(),requireEs_iterator_toArray(),requireEs_json_stringify(),requireEs_json_toStringTag(),requireEs_map(),requireEs_map_groupBy(),requireEs_math_acosh(),requireEs_math_asinh(),requireEs_math_atanh(),requireEs_math_cbrt(),requireEs_math_clz32(),requireEs_math_cosh(),requireEs_math_expm1(),requireEs_math_fround(),requireEs_math_f16round(),requireEs_math_hypot(),requireEs_math_imul(),requireEs_math_log10(),requireEs_math_log1p(),requireEs_math_log2(),requireEs_math_sign(),requireEs_math_sinh(),requireEs_math_tanh(),requireEs_math_toStringTag(),requireEs_math_trunc(),requireEs_number_constructor(),requireEs_number_epsilon(),requireEs_number_isFinite(),requireEs_number_isInteger(),requireEs_number_isNan(),requireEs_number_isSafeInteger(),requireEs_number_maxSafeInteger(),requireEs_number_minSafeInteger(),requireEs_number_parseFloat(),requireEs_number_parseInt(),requireEs_number_toExponential(),requireEs_number_toFixed(),requireEs_number_toPrecision(),requireEs_object_assign(),requireEs_object_create(),requireEs_object_defineGetter(),requireEs_object_defineProperties(),requireEs_object_defineProperty(),requireEs_object_defineSetter(),requireEs_object_entries(),requireEs_object_freeze(),requireEs_object_fromEntries(),requireEs_object_getOwnPropertyDescriptor(),requireEs_object_getOwnPropertyDescriptors(),requireEs_object_getOwnPropertyNames(),requireEs_object_getPrototypeOf(),requireEs_object_groupBy(),requireEs_object_hasOwn(),requireEs_object_is(),requireEs_object_isExtensible(),requireEs_object_isFrozen(),requireEs_object_isSealed(),requireEs_object_keys(),requireEs_object_lookupGetter(),requireEs_object_lookupSetter(),requireEs_object_preventExtensions(),requireEs_object_proto(),requireEs_object_seal(),requireEs_object_setPrototypeOf(),requireEs_object_toString(),requireEs_object_values(),requireEs_parseFloat(),requireEs_parseInt(),requireEs_promise(),requireEs_promise_allSettled(),requireEs_promise_any(),requireEs_promise_finally(),requireEs_promise_try(),requireEs_promise_withResolvers(),requireEs_array_fromAsync(),requireEs_asyncDisposableStack_constructor(),requireEs_asyncIterator_asyncDispose(),requireEs_reflect_apply(),requireEs_reflect_construct(),requireEs_reflect_defineProperty(),requireEs_reflect_deleteProperty(),requireEs_reflect_get(),requireEs_reflect_getOwnPropertyDescriptor(),requireEs_reflect_getPrototypeOf(),requireEs_reflect_has(),requireEs_reflect_isExtensible(),requireEs_reflect_ownKeys(),requireEs_reflect_preventExtensions(),requireEs_reflect_set(),requireEs_reflect_setPrototypeOf(),requireEs_reflect_toStringTag(),requireEs_regexp_constructor(),requireEs_regexp_escape(),requireEs_regexp_dotAll(),requireEs_regexp_exec(),requireEs_regexp_flags(),requireEs_regexp_sticky(),requireEs_regexp_test(),requireEs_regexp_toString(),requireEs_set(),requireEs_set_difference_v2(),requireEs_set_intersection_v2(),requireEs_set_isDisjointFrom_v2(),requireEs_set_isSubsetOf_v2(),requireEs_set_isSupersetOf_v2(),requireEs_set_symmetricDifference_v2(),requireEs_set_union_v2(),requireEs_string_atAlternative(),requireEs_string_codePointAt(),requireEs_string_endsWith(),requireEs_string_fromCodePoint(),requireEs_string_includes(),requireEs_string_isWellFormed(),requireEs_string_iterator(),requireEs_string_match(),requireEs_string_matchAll(),requireEs_string_padEnd(),requireEs_string_padStart(),requireEs_string_raw(),requireEs_string_repeat(),requireEs_string_replace(),requireEs_string_replaceAll(),requireEs_string_search(),requireEs_string_split(),requireEs_string_startsWith(),requireEs_string_substr(),requireEs_string_toWellFormed(),requireEs_string_trim(),requireEs_string_trimEnd(),requireEs_string_trimStart(),requireEs_string_anchor(),requireEs_string_big(),requireEs_string_blink(),requireEs_string_bold(),requireEs_string_fixed(),requireEs_string_fontcolor(),requireEs_string_fontsize(),requireEs_string_italics(),requireEs_string_link(),requireEs_string_small(),requireEs_string_strike(),requireEs_string_sub(),requireEs_string_sup(),requireEs_typedArray_float32Array(),requireEs_typedArray_float64Array(),requireEs_typedArray_int8Array(),requireEs_typedArray_int16Array(),requireEs_typedArray_int32Array(),requireEs_typedArray_uint8Array(),requireEs_typedArray_uint8ClampedArray(),requireEs_typedArray_uint16Array(),requireEs_typedArray_uint32Array(),requireEs_typedArray_at(),requireEs_typedArray_copyWithin(),requireEs_typedArray_every(),requireEs_typedArray_fill(),requireEs_typedArray_filter(),requireEs_typedArray_find(),requireEs_typedArray_findIndex(),requireEs_typedArray_findLast(),requireEs_typedArray_findLastIndex(),requireEs_typedArray_forEach(),requireEs_typedArray_from(),requireEs_typedArray_includes(),requireEs_typedArray_indexOf(),requireEs_typedArray_iterator(),requireEs_typedArray_join(),requireEs_typedArray_lastIndexOf(),requireEs_typedArray_map(),requireEs_typedArray_of(),requireEs_typedArray_reduce(),requireEs_typedArray_reduceRight(),requireEs_typedArray_reverse(),requireEs_typedArray_set(),requireEs_typedArray_slice(),requireEs_typedArray_some(),requireEs_typedArray_sort(),requireEs_typedArray_subarray(),requireEs_typedArray_toLocaleString(),requireEs_typedArray_toReversed(),requireEs_typedArray_toSorted(),requireEs_typedArray_toString(),requireEs_typedArray_with(),requireEs_unescape(),requireEs_weakMap(),requireEs_weakSet(),requireWeb_atob(),requireWeb_btoa(),requireWeb_domCollections_forEach(),requireWeb_domCollections_iterator(),requireWeb_domException_constructor(),requireWeb_domException_stack(),requireWeb_domException_toStringTag(),requireWeb_immediate(),requireWeb_queueMicrotask(),requireWeb_self(),requireWeb_structuredClone(),requireWeb_timers(),requireWeb_url(),requireWeb_url_canParse(),requireWeb_url_parse(),requireWeb_url_toJson(),requireWeb_urlSearchParams(),requireWeb_urlSearchParams_delete(),requireWeb_urlSearchParams_has(),requireWeb_urlSearchParams_size(),stable=requirePath()),stable}requireStable();var runtime={exports:{}},hasRequiredRuntime;function requireRuntime(){return hasRequiredRuntime||(hasRequiredRuntime=1,function(Y){var X=function(ee){var ne=Object.prototype,te=ne.hasOwnProperty,ue=Object.defineProperty||function(nt,At,wt){nt[At]=wt.value},se,ie=typeof Symbol=="function"?Symbol:{},t=ie.iterator||"@@iterator",H=ie.asyncIterator||"@@asyncIterator",ae=ie.toStringTag||"@@toStringTag";function he(nt,At,wt){return Object.defineProperty(nt,At,{value:wt,enumerable:!0,configurable:!0,writable:!0}),nt[At]}try{he({},"")}catch{he=function(At,wt,Ft){return At[wt]=Ft}}function _e(nt,At,wt,Ft){var er=At&&At.prototype instanceof Ue?At:Ue,lr=Object.create(er.prototype),jr=new Kt(Ft||[]);return ue(lr,"_invoke",{value:_t(nt,wt,jr)}),lr}ee.wrap=_e;function ge(nt,At,wt){try{return{type:"normal",arg:nt.call(At,wt)}}catch(Ft){return{type:"throw",arg:Ft}}}var xe="suspendedStart",Re="suspendedYield",De="executing",Ie="completed",Ce={};function Ue(){}function Le(){}function ke(){}var Ge={};he(Ge,t,function(){return this});var Ze=Object.getPrototypeOf,We=Ze&&Ze(Ze(ft([])));We&&We!==ne&&te.call(We,t)&&(Ge=We);var et=ke.prototype=Ue.prototype=Object.create(Ge);Le.prototype=ke,ue(et,"constructor",{value:ke,configurable:!0}),ue(ke,"constructor",{value:Le,configurable:!0}),Le.displayName=he(ke,ae,"GeneratorFunction");function He(nt){["next","throw","return"].forEach(function(At){he(nt,At,function(wt){return this._invoke(At,wt)})})}ee.isGeneratorFunction=function(nt){var At=typeof nt=="function"&&nt.constructor;return At?At===Le||(At.displayName||At.name)==="GeneratorFunction":!1},ee.mark=function(nt){return Object.setPrototypeOf?Object.setPrototypeOf(nt,ke):(nt.__proto__=ke,he(nt,ae,"GeneratorFunction")),nt.prototype=Object.create(et),nt},ee.awrap=function(nt){return{__await:nt}};function ht(nt,At){function wt(lr,jr,Mr,Lr){var sr=ge(nt[lr],nt,jr);if(sr.type==="throw")Lr(sr.arg);else{var Rr=sr.arg,Ur=Rr.value;return Ur&&typeof Ur=="object"&&te.call(Ur,"__await")?At.resolve(Ur.__await).then(function(Wr){wt("next",Wr,Mr,Lr)},function(Wr){wt("throw",Wr,Mr,Lr)}):At.resolve(Ur).then(function(Wr){Rr.value=Wr,Mr(Rr)},function(Wr){return wt("throw",Wr,Mr,Lr)})}}var Ft;function er(lr,jr){function Mr(){return new At(function(Lr,sr){wt(lr,jr,Lr,sr)})}return Ft=Ft?Ft.then(Mr,Mr):Mr()}ue(this,"_invoke",{value:er})}He(ht.prototype),he(ht.prototype,H,function(){return this}),ee.AsyncIterator=ht,ee.async=function(nt,At,wt,Ft,er){er===void 0&&(er=Promise);var lr=new ht(_e(nt,At,wt,Ft),er);return ee.isGeneratorFunction(At)?lr:lr.next().then(function(jr){return jr.done?jr.value:lr.next()})};function _t(nt,At,wt){var Ft=xe;return function(lr,jr){if(Ft===De)throw new Error("Generator is already running");if(Ft===Ie){if(lr==="throw")throw jr;return qt()}for(wt.method=lr,wt.arg=jr;;){var Mr=wt.delegate;if(Mr){var Lr=ut(Mr,wt);if(Lr){if(Lr===Ce)continue;return Lr}}if(wt.method==="next")wt.sent=wt._sent=wt.arg;else if(wt.method==="throw"){if(Ft===xe)throw Ft=Ie,wt.arg;wt.dispatchException(wt.arg)}else wt.method==="return"&&wt.abrupt("return",wt.arg);Ft=De;var sr=ge(nt,At,wt);if(sr.type==="normal"){if(Ft=wt.done?Ie:Re,sr.arg===Ce)continue;return{value:sr.arg,done:wt.done}}else sr.type==="throw"&&(Ft=Ie,wt.method="throw",wt.arg=sr.arg)}}}function ut(nt,At){var wt=At.method,Ft=nt.iterator[wt];if(Ft===se)return At.delegate=null,wt==="throw"&&nt.iterator.return&&(At.method="return",At.arg=se,ut(nt,At),At.method==="throw")||wt!=="return"&&(At.method="throw",At.arg=new TypeError("The iterator does not provide a '"+wt+"' method")),Ce;var er=ge(Ft,nt.iterator,At.arg);if(er.type==="throw")return At.method="throw",At.arg=er.arg,At.delegate=null,Ce;var lr=er.arg;if(!lr)return At.method="throw",At.arg=new TypeError("iterator result is not an object"),At.delegate=null,Ce;if(lr.done)At[nt.resultName]=lr.value,At.next=nt.nextLoc,At.method!=="return"&&(At.method="next",At.arg=se);else return lr;return At.delegate=null,Ce}He(et),he(et,ae,"Generator"),he(et,t,function(){return this}),he(et,"toString",function(){return"[object Generator]"});function yt(nt){var At={tryLoc:nt[0]};1 in nt&&(At.catchLoc=nt[1]),2 in nt&&(At.finallyLoc=nt[2],At.afterLoc=nt[3]),this.tryEntries.push(At)}function Lt(nt){var At=nt.completion||{};At.type="normal",delete At.arg,nt.completion=At}function Kt(nt){this.tryEntries=[{tryLoc:"root"}],nt.forEach(yt,this),this.reset(!0)}ee.keys=function(nt){var At=Object(nt),wt=[];for(var Ft in At)wt.push(Ft);return wt.reverse(),function er(){for(;wt.length;){var lr=wt.pop();if(lr in At)return er.value=lr,er.done=!1,er}return er.done=!0,er}};function ft(nt){if(nt!=null){var At=nt[t];if(At)return At.call(nt);if(typeof nt.next=="function")return nt;if(!isNaN(nt.length)){var wt=-1,Ft=function er(){for(;++wt<nt.length;)if(te.call(nt,wt))return er.value=nt[wt],er.done=!1,er;return er.value=se,er.done=!0,er};return Ft.next=Ft}}throw new TypeError(typeof nt+" is not iterable")}ee.values=ft;function qt(){return{value:se,done:!0}}return Kt.prototype={constructor:Kt,reset:function(nt){if(this.prev=0,this.next=0,this.sent=this._sent=se,this.done=!1,this.delegate=null,this.method="next",this.arg=se,this.tryEntries.forEach(Lt),!nt)for(var At in this)At.charAt(0)==="t"&&te.call(this,At)&&!isNaN(+At.slice(1))&&(this[At]=se)},stop:function(){this.done=!0;var nt=this.tryEntries[0],At=nt.completion;if(At.type==="throw")throw At.arg;return this.rval},dispatchException:function(nt){if(this.done)throw nt;var At=this;function wt(Lr,sr){return lr.type="throw",lr.arg=nt,At.next=Lr,sr&&(At.method="next",At.arg=se),!!sr}for(var Ft=this.tryEntries.length-1;Ft>=0;--Ft){var er=this.tryEntries[Ft],lr=er.completion;if(er.tryLoc==="root")return wt("end");if(er.tryLoc<=this.prev){var jr=te.call(er,"catchLoc"),Mr=te.call(er,"finallyLoc");if(jr&&Mr){if(this.prev<er.catchLoc)return wt(er.catchLoc,!0);if(this.prev<er.finallyLoc)return wt(er.finallyLoc)}else if(jr){if(this.prev<er.catchLoc)return wt(er.catchLoc,!0)}else if(Mr){if(this.prev<er.finallyLoc)return wt(er.finallyLoc)}else throw new Error("try statement without catch or finally")}}},abrupt:function(nt,At){for(var wt=this.tryEntries.length-1;wt>=0;--wt){var Ft=this.tryEntries[wt];if(Ft.tryLoc<=this.prev&&te.call(Ft,"finallyLoc")&&this.prev<Ft.finallyLoc){var er=Ft;break}}er&&(nt==="break"||nt==="continue")&&er.tryLoc<=At&&At<=er.finallyLoc&&(er=null);var lr=er?er.completion:{};return lr.type=nt,lr.arg=At,er?(this.method="next",this.next=er.finallyLoc,Ce):this.complete(lr)},complete:function(nt,At){if(nt.type==="throw")throw nt.arg;return nt.type==="break"||nt.type==="continue"?this.next=nt.arg:nt.type==="return"?(this.rval=this.arg=nt.arg,this.method="return",this.next="end"):nt.type==="normal"&&At&&(this.next=At),Ce},finish:function(nt){for(var At=this.tryEntries.length-1;At>=0;--At){var wt=this.tryEntries[At];if(wt.finallyLoc===nt)return this.complete(wt.completion,wt.afterLoc),Lt(wt),Ce}},catch:function(nt){for(var At=this.tryEntries.length-1;At>=0;--At){var wt=this.tryEntries[At];if(wt.tryLoc===nt){var Ft=wt.completion;if(Ft.type==="throw"){var er=Ft.arg;Lt(wt)}return er}}throw new Error("illegal catch attempt")},delegateYield:function(nt,At,wt){return this.delegate={iterator:ft(nt),resultName:At,nextLoc:wt},this.method==="next"&&(this.arg=se),Ce}},ee}(Y.exports);try{regeneratorRuntime=X}catch{typeof globalThis=="object"?globalThis.regeneratorRuntime=X:Function("r","regeneratorRuntime = r")(X)}}(runtime)),runtime.exports}requireRuntime();var events={exports:{}},hasRequiredEvents;function requireEvents(){if(hasRequiredEvents)return events.exports;hasRequiredEvents=1;var Y=typeof Reflect=="object"?Reflect:null,X=Y&&typeof Y.apply=="function"?Y.apply:function(ke,Ge,Ze){return Function.prototype.apply.call(ke,Ge,Ze)},ee;Y&&typeof Y.ownKeys=="function"?ee=Y.ownKeys:Object.getOwnPropertySymbols?ee=function(ke){return Object.getOwnPropertyNames(ke).concat(Object.getOwnPropertySymbols(ke))}:ee=function(ke){return Object.getOwnPropertyNames(ke)};function ne(Le){console&&console.warn&&console.warn(Le)}var te=Number.isNaN||function(ke){return ke!==ke};function ue(){ue.init.call(this)}events.exports=ue,events.exports.once=Ie,ue.EventEmitter=ue,ue.prototype._events=void 0,ue.prototype._eventsCount=0,ue.prototype._maxListeners=void 0;var se=10;function ie(Le){if(typeof Le!="function")throw new TypeError('The "listener" argument must be of type Function. Received type '+typeof Le)}Object.defineProperty(ue,"defaultMaxListeners",{enumerable:!0,get:function(){return se},set:function(Le){if(typeof Le!="number"||Le<0||te(Le))throw new RangeError('The value of "defaultMaxListeners" is out of range. It must be a non-negative number. Received '+Le+".");se=Le}}),ue.init=function(){(this._events===void 0||this._events===Object.getPrototypeOf(this)._events)&&(this._events=Object.create(null),this._eventsCount=0),this._maxListeners=this._maxListeners||void 0},ue.prototype.setMaxListeners=function(ke){if(typeof ke!="number"||ke<0||te(ke))throw new RangeError('The value of "n" is out of range. It must be a non-negative number. Received '+ke+".");return this._maxListeners=ke,this};function t(Le){return Le._maxListeners===void 0?ue.defaultMaxListeners:Le._maxListeners}ue.prototype.getMaxListeners=function(){return t(this)},ue.prototype.emit=function(ke){for(var Ge=[],Ze=1;Ze<arguments.length;Ze++)Ge.push(arguments[Ze]);var We=ke==="error",et=this._events;if(et!==void 0)We=We&&et.error===void 0;else if(!We)return!1;if(We){var He;if(Ge.length>0&&(He=Ge[0]),He instanceof Error)throw He;var ht=new Error("Unhandled error."+(He?" ("+He.message+")":""));throw ht.context=He,ht}var _t=et[ke];if(_t===void 0)return!1;if(typeof _t=="function")X(_t,this,Ge);else for(var ut=_t.length,yt=xe(_t,ut),Ze=0;Ze<ut;++Ze)X(yt[Ze],this,Ge);return!0};function H(Le,ke,Ge,Ze){var We,et,He;if(ie(Ge),et=Le._events,et===void 0?(et=Le._events=Object.create(null),Le._eventsCount=0):(et.newListener!==void 0&&(Le.emit("newListener",ke,Ge.listener?Ge.listener:Ge),et=Le._events),He=et[ke]),He===void 0)He=et[ke]=Ge,++Le._eventsCount;else if(typeof He=="function"?He=et[ke]=Ze?[Ge,He]:[He,Ge]:Ze?He.unshift(Ge):He.push(Ge),We=t(Le),We>0&&He.length>We&&!He.warned){He.warned=!0;var ht=new Error("Possible EventEmitter memory leak detected. "+He.length+" "+String(ke)+" listeners added. Use emitter.setMaxListeners() to increase limit");ht.name="MaxListenersExceededWarning",ht.emitter=Le,ht.type=ke,ht.count=He.length,ne(ht)}return Le}ue.prototype.addListener=function(ke,Ge){return H(this,ke,Ge,!1)},ue.prototype.on=ue.prototype.addListener,ue.prototype.prependListener=function(ke,Ge){return H(this,ke,Ge,!0)};function ae(){if(!this.fired)return this.target.removeListener(this.type,this.wrapFn),this.fired=!0,arguments.length===0?this.listener.call(this.target):this.listener.apply(this.target,arguments)}function he(Le,ke,Ge){var Ze={fired:!1,wrapFn:void 0,target:Le,type:ke,listener:Ge},We=ae.bind(Ze);return We.listener=Ge,Ze.wrapFn=We,We}ue.prototype.once=function(ke,Ge){return ie(Ge),this.on(ke,he(this,ke,Ge)),this},ue.prototype.prependOnceListener=function(ke,Ge){return ie(Ge),this.prependListener(ke,he(this,ke,Ge)),this},ue.prototype.removeListener=function(ke,Ge){var Ze,We,et,He,ht;if(ie(Ge),We=this._events,We===void 0)return this;if(Ze=We[ke],Ze===void 0)return this;if(Ze===Ge||Ze.listener===Ge)--this._eventsCount===0?this._events=Object.create(null):(delete We[ke],We.removeListener&&this.emit("removeListener",ke,Ze.listener||Ge));else if(typeof Ze!="function"){for(et=-1,He=Ze.length-1;He>=0;He--)if(Ze[He]===Ge||Ze[He].listener===Ge){ht=Ze[He].listener,et=He;break}if(et<0)return this;et===0?Ze.shift():Re(Ze,et),Ze.length===1&&(We[ke]=Ze[0]),We.removeListener!==void 0&&this.emit("removeListener",ke,ht||Ge)}return this},ue.prototype.off=ue.prototype.removeListener,ue.prototype.removeAllListeners=function(ke){var Ge,Ze,We;if(Ze=this._events,Ze===void 0)return this;if(Ze.removeListener===void 0)return arguments.length===0?(this._events=Object.create(null),this._eventsCount=0):Ze[ke]!==void 0&&(--this._eventsCount===0?this._events=Object.create(null):delete Ze[ke]),this;if(arguments.length===0){var et=Object.keys(Ze),He;for(We=0;We<et.length;++We)He=et[We],He!=="removeListener"&&this.removeAllListeners(He);return this.removeAllListeners("removeListener"),this._events=Object.create(null),this._eventsCount=0,this}if(Ge=Ze[ke],typeof Ge=="function")this.removeListener(ke,Ge);else if(Ge!==void 0)for(We=Ge.length-1;We>=0;We--)this.removeListener(ke,Ge[We]);return this};function _e(Le,ke,Ge){var Ze=Le._events;if(Ze===void 0)return[];var We=Ze[ke];return We===void 0?[]:typeof We=="function"?Ge?[We.listener||We]:[We]:Ge?De(We):xe(We,We.length)}ue.prototype.listeners=function(ke){return _e(this,ke,!0)},ue.prototype.rawListeners=function(ke){return _e(this,ke,!1)},ue.listenerCount=function(Le,ke){return typeof Le.listenerCount=="function"?Le.listenerCount(ke):ge.call(Le,ke)},ue.prototype.listenerCount=ge;function ge(Le){var ke=this._events;if(ke!==void 0){var Ge=ke[Le];if(typeof Ge=="function")return 1;if(Ge!==void 0)return Ge.length}return 0}ue.prototype.eventNames=function(){return this._eventsCount>0?ee(this._events):[]};function xe(Le,ke){for(var Ge=new Array(ke),Ze=0;Ze<ke;++Ze)Ge[Ze]=Le[Ze];return Ge}function Re(Le,ke){for(;ke+1<Le.length;ke++)Le[ke]=Le[ke+1];Le.pop()}function De(Le){for(var ke=new Array(Le.length),Ge=0;Ge<ke.length;++Ge)ke[Ge]=Le[Ge].listener||Le[Ge];return ke}function Ie(Le,ke){return new Promise(function(Ge,Ze){function We(He){Le.removeListener(ke,et),Ze(He)}function et(){typeof Le.removeListener=="function"&&Le.removeListener("error",We),Ge([].slice.call(arguments))}Ue(Le,ke,et,{once:!0}),ke!=="error"&&Ce(Le,We,{once:!0})})}function Ce(Le,ke,Ge){typeof Le.on=="function"&&Ue(Le,"error",ke,Ge)}function Ue(Le,ke,Ge,Ze){if(typeof Le.on=="function")Ze.once?Le.once(ke,Ge):Le.on(ke,Ge);else if(typeof Le.addEventListener=="function")Le.addEventListener(ke,function We(et){Ze.once&&Le.removeEventListener(ke,We),Ge(et)});else throw new TypeError('The "emitter" argument must be of type EventEmitter. Received type '+typeof Le)}return events.exports}var eventsExports=requireEvents();const EventEmitter=getDefaultExportFromCjs(eventsExports),viewStore=(Y,X)=>{Y.view="log",X.on("view:set",ee=>{ee!==Y.view&&(Y.view=ee,X.emit(X.STATE_CHANGE))})};var isObject_1,hasRequiredIsObject;function requireIsObject(){if(hasRequiredIsObject)return isObject_1;hasRequiredIsObject=1;function Y(X){var ee=typeof X;return X!=null&&(ee=="object"||ee=="function")}return isObject_1=Y,isObject_1}var _freeGlobal,hasRequired_freeGlobal;function require_freeGlobal(){if(hasRequired_freeGlobal)return _freeGlobal;hasRequired_freeGlobal=1;var Y=typeof commonjsGlobal=="object"&&commonjsGlobal&&commonjsGlobal.Object===Object&&commonjsGlobal;return _freeGlobal=Y,_freeGlobal}var _root,hasRequired_root;function require_root(){if(hasRequired_root)return _root;hasRequired_root=1;var Y=require_freeGlobal(),X=typeof self=="object"&&self&&self.Object===Object&&self,ee=Y||X||Function("return this")();return _root=ee,_root}var now_1,hasRequiredNow;function requireNow(){if(hasRequiredNow)return now_1;hasRequiredNow=1;var Y=require_root(),X=function(){return Y.Date.now()};return now_1=X,now_1}var _trimmedEndIndex,hasRequired_trimmedEndIndex;function require_trimmedEndIndex(){if(hasRequired_trimmedEndIndex)return _trimmedEndIndex;hasRequired_trimmedEndIndex=1;var Y=/\s/;function X(ee){for(var ne=ee.length;ne--&&Y.test(ee.charAt(ne)););return ne}return _trimmedEndIndex=X,_trimmedEndIndex}var _baseTrim,hasRequired_baseTrim;function require_baseTrim(){if(hasRequired_baseTrim)return _baseTrim;hasRequired_baseTrim=1;var Y=require_trimmedEndIndex(),X=/^\s+/;function ee(ne){return ne&&ne.slice(0,Y(ne)+1).replace(X,"")}return _baseTrim=ee,_baseTrim}var _Symbol,hasRequired_Symbol;function require_Symbol(){if(hasRequired_Symbol)return _Symbol;hasRequired_Symbol=1;var Y=require_root(),X=Y.Symbol;return _Symbol=X,_Symbol}var _getRawTag,hasRequired_getRawTag;function require_getRawTag(){if(hasRequired_getRawTag)return _getRawTag;hasRequired_getRawTag=1;var Y=require_Symbol(),X=Object.prototype,ee=X.hasOwnProperty,ne=X.toString,te=Y?Y.toStringTag:void 0;function ue(se){var ie=ee.call(se,te),t=se[te];try{se[te]=void 0;var H=!0}catch{}var ae=ne.call(se);return H&&(ie?se[te]=t:delete se[te]),ae}return _getRawTag=ue,_getRawTag}var _objectToString,hasRequired_objectToString;function require_objectToString(){if(hasRequired_objectToString)return _objectToString;hasRequired_objectToString=1;var Y=Object.prototype,X=Y.toString;function ee(ne){return X.call(ne)}return _objectToString=ee,_objectToString}var _baseGetTag,hasRequired_baseGetTag;function require_baseGetTag(){if(hasRequired_baseGetTag)return _baseGetTag;hasRequired_baseGetTag=1;var Y=require_Symbol(),X=require_getRawTag(),ee=require_objectToString(),ne="[object Null]",te="[object Undefined]",ue=Y?Y.toStringTag:void 0;function se(ie){return ie==null?ie===void 0?te:ne:ue&&ue in Object(ie)?X(ie):ee(ie)}return _baseGetTag=se,_baseGetTag}var isObjectLike_1,hasRequiredIsObjectLike;function requireIsObjectLike(){if(hasRequiredIsObjectLike)return isObjectLike_1;hasRequiredIsObjectLike=1;function Y(X){return X!=null&&typeof X=="object"}return isObjectLike_1=Y,isObjectLike_1}var isSymbol_1,hasRequiredIsSymbol;function requireIsSymbol(){if(hasRequiredIsSymbol)return isSymbol_1;hasRequiredIsSymbol=1;var Y=require_baseGetTag(),X=requireIsObjectLike(),ee="[object Symbol]";function ne(te){return typeof te=="symbol"||X(te)&&Y(te)==ee}return isSymbol_1=ne,isSymbol_1}var toNumber_1,hasRequiredToNumber;function requireToNumber(){if(hasRequiredToNumber)return toNumber_1;hasRequiredToNumber=1;var Y=require_baseTrim(),X=requireIsObject(),ee=requireIsSymbol(),ne=NaN,te=/^[-+]0x[0-9a-f]+$/i,ue=/^0b[01]+$/i,se=/^0o[0-7]+$/i,ie=parseInt;function t(H){if(typeof H=="number")return H;if(ee(H))return ne;if(X(H)){var ae=typeof H.valueOf=="function"?H.valueOf():H;H=X(ae)?ae+"":ae}if(typeof H!="string")return H===0?H:+H;H=Y(H);var he=ue.test(H);return he||se.test(H)?ie(H.slice(2),he?2:8):te.test(H)?ne:+H}return toNumber_1=t,toNumber_1}var debounce_1,hasRequiredDebounce;function requireDebounce(){if(hasRequiredDebounce)return debounce_1;hasRequiredDebounce=1;var Y=requireIsObject(),X=requireNow(),ee=requireToNumber(),ne="Expected a function",te=Math.max,ue=Math.min;function se(ie,t,H){var ae,he,_e,ge,xe,Re,De=0,Ie=!1,Ce=!1,Ue=!0;if(typeof ie!="function")throw new TypeError(ne);t=ee(t)||0,Y(H)&&(Ie=!!H.leading,Ce="maxWait"in H,_e=Ce?te(ee(H.maxWait)||0,t):_e,Ue="trailing"in H?!!H.trailing:Ue);function Le(ut){var yt=ae,Lt=he;return ae=he=void 0,De=ut,ge=ie.apply(Lt,yt),ge}function ke(ut){return De=ut,xe=setTimeout(We,t),Ie?Le(ut):ge}function Ge(ut){var yt=ut-Re,Lt=ut-De,Kt=t-yt;return Ce?ue(Kt,_e-Lt):Kt}function Ze(ut){var yt=ut-Re,Lt=ut-De;return Re===void 0||yt>=t||yt<0||Ce&&Lt>=_e}function We(){var ut=X();if(Ze(ut))return et(ut);xe=setTimeout(We,Ge(ut))}function et(ut){return xe=void 0,Ue&&ae?Le(ut):(ae=he=void 0,ge)}function He(){xe!==void 0&&clearTimeout(xe),De=0,ae=Re=he=xe=void 0}function ht(){return xe===void 0?ge:et(X())}function _t(){var ut=X(),yt=Ze(ut);if(ae=arguments,he=this,Re=ut,yt){if(xe===void 0)return ke(Re);if(Ce)return clearTimeout(xe),xe=setTimeout(We,t),Le(Re)}return xe===void 0&&(xe=setTimeout(We,t)),ge}return _t.cancel=He,_t.flush=ht,_t}return debounce_1=se,debounce_1}var debounceExports=requireDebounce();const debounce=getDefaultExportFromCjs(debounceExports);var contentType={};/*!
 * content-type
 * Copyright(c) 2015 Douglas Christopher Wilson
 * MIT Licensed
 */var hasRequiredContentType;function requireContentType(){if(hasRequiredContentType)return contentType;hasRequiredContentType=1;var Y=/; *([!#$%&'*+.^_`|~0-9A-Za-z-]+) *= *("(?:[\u000b\u0020\u0021\u0023-\u005b\u005d-\u007e\u0080-\u00ff]|\\[\u000b\u0020-\u00ff])*"|[!#$%&'*+.^_`|~0-9A-Za-z-]+) */g,X=/^[\u000b\u0020-\u007e\u0080-\u00ff]+$/,ee=/^[!#$%&'*+.^_`|~0-9A-Za-z-]+$/,ne=/\\([\u000b\u0020-\u00ff])/g,te=/([\\"])/g,ue=/^[!#$%&'*+.^_`|~0-9A-Za-z-]+\/[!#$%&'*+.^_`|~0-9A-Za-z-]+$/;contentType.format=se,contentType.parse=ie;function se(he){if(!he||typeof he!="object")throw new TypeError("argument obj is required");var _e=he.parameters,ge=he.type;if(!ge||!ue.test(ge))throw new TypeError("invalid type");var xe=ge;if(_e&&typeof _e=="object")for(var Re,De=Object.keys(_e).sort(),Ie=0;Ie<De.length;Ie++){if(Re=De[Ie],!ee.test(Re))throw new TypeError("invalid parameter name");xe+="; "+Re+"="+H(_e[Re])}return xe}function ie(he){if(!he)throw new TypeError("argument string is required");var _e=typeof he=="object"?t(he):he;if(typeof _e!="string")throw new TypeError("argument string is required to be a string");var ge=_e.indexOf(";"),xe=ge!==-1?_e.slice(0,ge).trim():_e.trim();if(!ue.test(xe))throw new TypeError("invalid media type");var Re=new ae(xe.toLowerCase());if(ge!==-1){var De,Ie,Ce;for(Y.lastIndex=ge;Ie=Y.exec(_e);){if(Ie.index!==ge)throw new TypeError("invalid parameter format");ge+=Ie[0].length,De=Ie[1].toLowerCase(),Ce=Ie[2],Ce.charCodeAt(0)===34&&(Ce=Ce.slice(1,-1),Ce.indexOf("\\")!==-1&&(Ce=Ce.replace(ne,"$1"))),Re.parameters[De]=Ce}if(ge!==_e.length)throw new TypeError("invalid parameter format")}return Re}function t(he){var _e;if(typeof he.getHeader=="function"?_e=he.getHeader("content-type"):typeof he.headers=="object"&&(_e=he.headers&&he.headers["content-type"]),typeof _e!="string")throw new TypeError("content-type header is missing from object");return _e}function H(he){var _e=String(he);if(ee.test(_e))return _e;if(_e.length>0&&!X.test(_e))throw new TypeError("invalid parameter value");return'"'+_e.replace(te,"\\$1")+'"'}function ae(he){this.parameters=Object.create(null),this.type=he}return contentType}var contentTypeExports=requireContentType(),buffer={},base64Js={},hasRequiredBase64Js;function requireBase64Js(){if(hasRequiredBase64Js)return base64Js;hasRequiredBase64Js=1,base64Js.byteLength=ie,base64Js.toByteArray=H,base64Js.fromByteArray=_e;for(var Y=[],X=[],ee=typeof Uint8Array<"u"?Uint8Array:Array,ne="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",te=0,ue=ne.length;te<ue;++te)Y[te]=ne[te],X[ne.charCodeAt(te)]=te;X[45]=62,X[95]=63;function se(ge){var xe=ge.length;if(xe%4>0)throw new Error("Invalid string. Length must be a multiple of 4");var Re=ge.indexOf("=");Re===-1&&(Re=xe);var De=Re===xe?0:4-Re%4;return[Re,De]}function ie(ge){var xe=se(ge),Re=xe[0],De=xe[1];return(Re+De)*3/4-De}function t(ge,xe,Re){return(xe+Re)*3/4-Re}function H(ge){var xe,Re=se(ge),De=Re[0],Ie=Re[1],Ce=new ee(t(ge,De,Ie)),Ue=0,Le=Ie>0?De-4:De,ke;for(ke=0;ke<Le;ke+=4)xe=X[ge.charCodeAt(ke)]<<18|X[ge.charCodeAt(ke+1)]<<12|X[ge.charCodeAt(ke+2)]<<6|X[ge.charCodeAt(ke+3)],Ce[Ue++]=xe>>16&255,Ce[Ue++]=xe>>8&255,Ce[Ue++]=xe&255;return Ie===2&&(xe=X[ge.charCodeAt(ke)]<<2|X[ge.charCodeAt(ke+1)]>>4,Ce[Ue++]=xe&255),Ie===1&&(xe=X[ge.charCodeAt(ke)]<<10|X[ge.charCodeAt(ke+1)]<<4|X[ge.charCodeAt(ke+2)]>>2,Ce[Ue++]=xe>>8&255,Ce[Ue++]=xe&255),Ce}function ae(ge){return Y[ge>>18&63]+Y[ge>>12&63]+Y[ge>>6&63]+Y[ge&63]}function he(ge,xe,Re){for(var De,Ie=[],Ce=xe;Ce<Re;Ce+=3)De=(ge[Ce]<<16&16711680)+(ge[Ce+1]<<8&65280)+(ge[Ce+2]&255),Ie.push(ae(De));return Ie.join("")}function _e(ge){for(var xe,Re=ge.length,De=Re%3,Ie=[],Ce=16383,Ue=0,Le=Re-De;Ue<Le;Ue+=Ce)Ie.push(he(ge,Ue,Ue+Ce>Le?Le:Ue+Ce));return De===1?(xe=ge[Re-1],Ie.push(Y[xe>>2]+Y[xe<<4&63]+"==")):De===2&&(xe=(ge[Re-2]<<8)+ge[Re-1],Ie.push(Y[xe>>10]+Y[xe>>4&63]+Y[xe<<2&63]+"=")),Ie.join("")}return base64Js}var ieee754={};/*! ieee754. BSD-3-Clause License. Feross Aboukhadijeh <https://feross.org/opensource> */var hasRequiredIeee754;function requireIeee754(){return hasRequiredIeee754||(hasRequiredIeee754=1,ieee754.read=function(Y,X,ee,ne,te){var ue,se,ie=te*8-ne-1,t=(1<<ie)-1,H=t>>1,ae=-7,he=ee?te-1:0,_e=ee?-1:1,ge=Y[X+he];for(he+=_e,ue=ge&(1<<-ae)-1,ge>>=-ae,ae+=ie;ae>0;ue=ue*256+Y[X+he],he+=_e,ae-=8);for(se=ue&(1<<-ae)-1,ue>>=-ae,ae+=ne;ae>0;se=se*256+Y[X+he],he+=_e,ae-=8);if(ue===0)ue=1-H;else{if(ue===t)return se?NaN:(ge?-1:1)*(1/0);se=se+Math.pow(2,ne),ue=ue-H}return(ge?-1:1)*se*Math.pow(2,ue-ne)},ieee754.write=function(Y,X,ee,ne,te,ue){var se,ie,t,H=ue*8-te-1,ae=(1<<H)-1,he=ae>>1,_e=te===23?Math.pow(2,-24)-Math.pow(2,-77):0,ge=ne?0:ue-1,xe=ne?1:-1,Re=X<0||X===0&&1/X<0?1:0;for(X=Math.abs(X),isNaN(X)||X===1/0?(ie=isNaN(X)?1:0,se=ae):(se=Math.floor(Math.log(X)/Math.LN2),X*(t=Math.pow(2,-se))<1&&(se--,t*=2),se+he>=1?X+=_e/t:X+=_e*Math.pow(2,1-he),X*t>=2&&(se++,t/=2),se+he>=ae?(ie=0,se=ae):se+he>=1?(ie=(X*t-1)*Math.pow(2,te),se=se+he):(ie=X*Math.pow(2,he-1)*Math.pow(2,te),se=0));te>=8;Y[ee+ge]=ie&255,ge+=xe,ie/=256,te-=8);for(se=se<<te|ie,H+=te;H>0;Y[ee+ge]=se&255,ge+=xe,se/=256,H-=8);Y[ee+ge-xe]|=Re*128}),ieee754}/*!
 * The buffer module from node.js, for the browser.
 *
 * @author   Feross Aboukhadijeh <https://feross.org>
 * @license  MIT
 */var hasRequiredBuffer;function requireBuffer(){return hasRequiredBuffer||(hasRequiredBuffer=1,function(Y){const X=requireBase64Js(),ee=requireIeee754(),ne=typeof Symbol=="function"&&typeof Symbol.for=="function"?Symbol.for("nodejs.util.inspect.custom"):null;Y.Buffer=ie,Y.SlowBuffer=Ce,Y.INSPECT_MAX_BYTES=50;const te=2147483647;Y.kMaxLength=te,ie.TYPED_ARRAY_SUPPORT=ue(),!ie.TYPED_ARRAY_SUPPORT&&typeof console<"u"&&typeof console.error=="function"&&console.error("This browser lacks typed array (Uint8Array) support which is required by `buffer` v5.x. Use `buffer` v4.x if you require old browser support.");function ue(){try{const je=new Uint8Array(1),Se={foo:function(){return 42}};return Object.setPrototypeOf(Se,Uint8Array.prototype),Object.setPrototypeOf(je,Se),je.foo()===42}catch{return!1}}Object.defineProperty(ie.prototype,"parent",{enumerable:!0,get:function(){if(ie.isBuffer(this))return this.buffer}}),Object.defineProperty(ie.prototype,"offset",{enumerable:!0,get:function(){if(ie.isBuffer(this))return this.byteOffset}});function se(je){if(je>te)throw new RangeError('The value "'+je+'" is invalid for option "size"');const Se=new Uint8Array(je);return Object.setPrototypeOf(Se,ie.prototype),Se}function ie(je,Se,Oe){if(typeof je=="number"){if(typeof Se=="string")throw new TypeError('The "string" argument must be of type string. Received type number');return he(je)}return t(je,Se,Oe)}ie.poolSize=8192;function t(je,Se,Oe){if(typeof je=="string")return _e(je,Se);if(ArrayBuffer.isView(je))return xe(je);if(je==null)throw new TypeError("The first argument must be one of type string, Buffer, ArrayBuffer, Array, or Array-like Object. Received type "+typeof je);if(vr(je,ArrayBuffer)||je&&vr(je.buffer,ArrayBuffer)||typeof SharedArrayBuffer<"u"&&(vr(je,SharedArrayBuffer)||je&&vr(je.buffer,SharedArrayBuffer)))return Re(je,Se,Oe);if(typeof je=="number")throw new TypeError('The "value" argument must not be of type number. Received type number');const Ve=je.valueOf&&je.valueOf();if(Ve!=null&&Ve!==je)return ie.from(Ve,Se,Oe);const st=De(je);if(st)return st;if(typeof Symbol<"u"&&Symbol.toPrimitive!=null&&typeof je[Symbol.toPrimitive]=="function")return ie.from(je[Symbol.toPrimitive]("string"),Se,Oe);throw new TypeError("The first argument must be one of type string, Buffer, ArrayBuffer, Array, or Array-like Object. Received type "+typeof je)}ie.from=function(je,Se,Oe){return t(je,Se,Oe)},Object.setPrototypeOf(ie.prototype,Uint8Array.prototype),Object.setPrototypeOf(ie,Uint8Array);function H(je){if(typeof je!="number")throw new TypeError('"size" argument must be of type number');if(je<0)throw new RangeError('The value "'+je+'" is invalid for option "size"')}function ae(je,Se,Oe){return H(je),je<=0?se(je):Se!==void 0?typeof Oe=="string"?se(je).fill(Se,Oe):se(je).fill(Se):se(je)}ie.alloc=function(je,Se,Oe){return ae(je,Se,Oe)};function he(je){return H(je),se(je<0?0:Ie(je)|0)}ie.allocUnsafe=function(je){return he(je)},ie.allocUnsafeSlow=function(je){return he(je)};function _e(je,Se){if((typeof Se!="string"||Se==="")&&(Se="utf8"),!ie.isEncoding(Se))throw new TypeError("Unknown encoding: "+Se);const Oe=Ue(je,Se)|0;let Ve=se(Oe);const st=Ve.write(je,Se);return st!==Oe&&(Ve=Ve.slice(0,st)),Ve}function ge(je){const Se=je.length<0?0:Ie(je.length)|0,Oe=se(Se);for(let Ve=0;Ve<Se;Ve+=1)Oe[Ve]=je[Ve]&255;return Oe}function xe(je){if(vr(je,Uint8Array)){const Se=new Uint8Array(je);return Re(Se.buffer,Se.byteOffset,Se.byteLength)}return ge(je)}function Re(je,Se,Oe){if(Se<0||je.byteLength<Se)throw new RangeError('"offset" is outside of buffer bounds');if(je.byteLength<Se+(Oe||0))throw new RangeError('"length" is outside of buffer bounds');let Ve;return Se===void 0&&Oe===void 0?Ve=new Uint8Array(je):Oe===void 0?Ve=new Uint8Array(je,Se):Ve=new Uint8Array(je,Se,Oe),Object.setPrototypeOf(Ve,ie.prototype),Ve}function De(je){if(ie.isBuffer(je)){const Se=Ie(je.length)|0,Oe=se(Se);return Oe.length===0||je.copy(Oe,0,0,Se),Oe}if(je.length!==void 0)return typeof je.length!="number"||Xr(je.length)?se(0):ge(je);if(je.type==="Buffer"&&Array.isArray(je.data))return ge(je.data)}function Ie(je){if(je>=te)throw new RangeError("Attempt to allocate Buffer larger than maximum size: 0x"+te.toString(16)+" bytes");return je|0}function Ce(je){return+je!=je&&(je=0),ie.alloc(+je)}ie.isBuffer=function(Se){return Se!=null&&Se._isBuffer===!0&&Se!==ie.prototype},ie.compare=function(Se,Oe){if(vr(Se,Uint8Array)&&(Se=ie.from(Se,Se.offset,Se.byteLength)),vr(Oe,Uint8Array)&&(Oe=ie.from(Oe,Oe.offset,Oe.byteLength)),!ie.isBuffer(Se)||!ie.isBuffer(Oe))throw new TypeError('The "buf1", "buf2" arguments must be one of type Buffer or Uint8Array');if(Se===Oe)return 0;let Ve=Se.length,st=Oe.length;for(let gt=0,Ot=Math.min(Ve,st);gt<Ot;++gt)if(Se[gt]!==Oe[gt]){Ve=Se[gt],st=Oe[gt];break}return Ve<st?-1:st<Ve?1:0},ie.isEncoding=function(Se){switch(String(Se).toLowerCase()){case"hex":case"utf8":case"utf-8":case"ascii":case"latin1":case"binary":case"base64":case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return!0;default:return!1}},ie.concat=function(Se,Oe){if(!Array.isArray(Se))throw new TypeError('"list" argument must be an Array of Buffers');if(Se.length===0)return ie.alloc(0);let Ve;if(Oe===void 0)for(Oe=0,Ve=0;Ve<Se.length;++Ve)Oe+=Se[Ve].length;const st=ie.allocUnsafe(Oe);let gt=0;for(Ve=0;Ve<Se.length;++Ve){let Ot=Se[Ve];if(vr(Ot,Uint8Array))gt+Ot.length>st.length?(ie.isBuffer(Ot)||(Ot=ie.from(Ot)),Ot.copy(st,gt)):Uint8Array.prototype.set.call(st,Ot,gt);else if(ie.isBuffer(Ot))Ot.copy(st,gt);else throw new TypeError('"list" argument must be an Array of Buffers');gt+=Ot.length}return st};function Ue(je,Se){if(ie.isBuffer(je))return je.length;if(ArrayBuffer.isView(je)||vr(je,ArrayBuffer))return je.byteLength;if(typeof je!="string")throw new TypeError('The "string" argument must be one of type string, Buffer, or ArrayBuffer. Received type '+typeof je);const Oe=je.length,Ve=arguments.length>2&&arguments[2]===!0;if(!Ve&&Oe===0)return 0;let st=!1;for(;;)switch(Se){case"ascii":case"latin1":case"binary":return Oe;case"utf8":case"utf-8":return Br(je).length;case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return Oe*2;case"hex":return Oe>>>1;case"base64":return Qr(je).length;default:if(st)return Ve?-1:Br(je).length;Se=(""+Se).toLowerCase(),st=!0}}ie.byteLength=Ue;function Le(je,Se,Oe){let Ve=!1;if((Se===void 0||Se<0)&&(Se=0),Se>this.length||((Oe===void 0||Oe>this.length)&&(Oe=this.length),Oe<=0)||(Oe>>>=0,Se>>>=0,Oe<=Se))return"";for(je||(je="utf8");;)switch(je){case"hex":return nt(this,Se,Oe);case"utf8":case"utf-8":return yt(this,Se,Oe);case"ascii":return ft(this,Se,Oe);case"latin1":case"binary":return qt(this,Se,Oe);case"base64":return ut(this,Se,Oe);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return At(this,Se,Oe);default:if(Ve)throw new TypeError("Unknown encoding: "+je);je=(je+"").toLowerCase(),Ve=!0}}ie.prototype._isBuffer=!0;function ke(je,Se,Oe){const Ve=je[Se];je[Se]=je[Oe],je[Oe]=Ve}ie.prototype.swap16=function(){const Se=this.length;if(Se%2!==0)throw new RangeError("Buffer size must be a multiple of 16-bits");for(let Oe=0;Oe<Se;Oe+=2)ke(this,Oe,Oe+1);return this},ie.prototype.swap32=function(){const Se=this.length;if(Se%4!==0)throw new RangeError("Buffer size must be a multiple of 32-bits");for(let Oe=0;Oe<Se;Oe+=4)ke(this,Oe,Oe+3),ke(this,Oe+1,Oe+2);return this},ie.prototype.swap64=function(){const Se=this.length;if(Se%8!==0)throw new RangeError("Buffer size must be a multiple of 64-bits");for(let Oe=0;Oe<Se;Oe+=8)ke(this,Oe,Oe+7),ke(this,Oe+1,Oe+6),ke(this,Oe+2,Oe+5),ke(this,Oe+3,Oe+4);return this},ie.prototype.toString=function(){const Se=this.length;return Se===0?"":arguments.length===0?yt(this,0,Se):Le.apply(this,arguments)},ie.prototype.toLocaleString=ie.prototype.toString,ie.prototype.equals=function(Se){if(!ie.isBuffer(Se))throw new TypeError("Argument must be a Buffer");return this===Se?!0:ie.compare(this,Se)===0},ie.prototype.inspect=function(){let Se="";const Oe=Y.INSPECT_MAX_BYTES;return Se=this.toString("hex",0,Oe).replace(/(.{2})/g,"$1 ").trim(),this.length>Oe&&(Se+=" ... "),"<Buffer "+Se+">"},ne&&(ie.prototype[ne]=ie.prototype.inspect),ie.prototype.compare=function(Se,Oe,Ve,st,gt){if(vr(Se,Uint8Array)&&(Se=ie.from(Se,Se.offset,Se.byteLength)),!ie.isBuffer(Se))throw new TypeError('The "target" argument must be one of type Buffer or Uint8Array. Received type '+typeof Se);if(Oe===void 0&&(Oe=0),Ve===void 0&&(Ve=Se?Se.length:0),st===void 0&&(st=0),gt===void 0&&(gt=this.length),Oe<0||Ve>Se.length||st<0||gt>this.length)throw new RangeError("out of range index");if(st>=gt&&Oe>=Ve)return 0;if(st>=gt)return-1;if(Oe>=Ve)return 1;if(Oe>>>=0,Ve>>>=0,st>>>=0,gt>>>=0,this===Se)return 0;let Ot=gt-st,tr=Ve-Oe;const Qt=Math.min(Ot,tr),xt=this.slice(st,gt),Ct=Se.slice(Oe,Ve);for(let Nt=0;Nt<Qt;++Nt)if(xt[Nt]!==Ct[Nt]){Ot=xt[Nt],tr=Ct[Nt];break}return Ot<tr?-1:tr<Ot?1:0};function Ge(je,Se,Oe,Ve,st){if(je.length===0)return-1;if(typeof Oe=="string"?(Ve=Oe,Oe=0):Oe>2147483647?Oe=2147483647:Oe<-2147483648&&(Oe=-2147483648),Oe=+Oe,Xr(Oe)&&(Oe=st?0:je.length-1),Oe<0&&(Oe=je.length+Oe),Oe>=je.length){if(st)return-1;Oe=je.length-1}else if(Oe<0)if(st)Oe=0;else return-1;if(typeof Se=="string"&&(Se=ie.from(Se,Ve)),ie.isBuffer(Se))return Se.length===0?-1:Ze(je,Se,Oe,Ve,st);if(typeof Se=="number")return Se=Se&255,typeof Uint8Array.prototype.indexOf=="function"?st?Uint8Array.prototype.indexOf.call(je,Se,Oe):Uint8Array.prototype.lastIndexOf.call(je,Se,Oe):Ze(je,[Se],Oe,Ve,st);throw new TypeError("val must be string, number or Buffer")}function Ze(je,Se,Oe,Ve,st){let gt=1,Ot=je.length,tr=Se.length;if(Ve!==void 0&&(Ve=String(Ve).toLowerCase(),Ve==="ucs2"||Ve==="ucs-2"||Ve==="utf16le"||Ve==="utf-16le")){if(je.length<2||Se.length<2)return-1;gt=2,Ot/=2,tr/=2,Oe/=2}function Qt(Ct,Nt){return gt===1?Ct[Nt]:Ct.readUInt16BE(Nt*gt)}let xt;if(st){let Ct=-1;for(xt=Oe;xt<Ot;xt++)if(Qt(je,xt)===Qt(Se,Ct===-1?0:xt-Ct)){if(Ct===-1&&(Ct=xt),xt-Ct+1===tr)return Ct*gt}else Ct!==-1&&(xt-=xt-Ct),Ct=-1}else for(Oe+tr>Ot&&(Oe=Ot-tr),xt=Oe;xt>=0;xt--){let Ct=!0;for(let Nt=0;Nt<tr;Nt++)if(Qt(je,xt+Nt)!==Qt(Se,Nt)){Ct=!1;break}if(Ct)return xt}return-1}ie.prototype.includes=function(Se,Oe,Ve){return this.indexOf(Se,Oe,Ve)!==-1},ie.prototype.indexOf=function(Se,Oe,Ve){return Ge(this,Se,Oe,Ve,!0)},ie.prototype.lastIndexOf=function(Se,Oe,Ve){return Ge(this,Se,Oe,Ve,!1)};function We(je,Se,Oe,Ve){Oe=Number(Oe)||0;const st=je.length-Oe;Ve?(Ve=Number(Ve),Ve>st&&(Ve=st)):Ve=st;const gt=Se.length;Ve>gt/2&&(Ve=gt/2);let Ot;for(Ot=0;Ot<Ve;++Ot){const tr=parseInt(Se.substr(Ot*2,2),16);if(Xr(tr))return Ot;je[Oe+Ot]=tr}return Ot}function et(je,Se,Oe,Ve){return _r(Br(Se,je.length-Oe),je,Oe,Ve)}function He(je,Se,Oe,Ve){return _r(li(Se),je,Oe,Ve)}function ht(je,Se,Oe,Ve){return _r(Qr(Se),je,Oe,Ve)}function _t(je,Se,Oe,Ve){return _r(si(Se,je.length-Oe),je,Oe,Ve)}ie.prototype.write=function(Se,Oe,Ve,st){if(Oe===void 0)st="utf8",Ve=this.length,Oe=0;else if(Ve===void 0&&typeof Oe=="string")st=Oe,Ve=this.length,Oe=0;else if(isFinite(Oe))Oe=Oe>>>0,isFinite(Ve)?(Ve=Ve>>>0,st===void 0&&(st="utf8")):(st=Ve,Ve=void 0);else throw new Error("Buffer.write(string, encoding, offset[, length]) is no longer supported");const gt=this.length-Oe;if((Ve===void 0||Ve>gt)&&(Ve=gt),Se.length>0&&(Ve<0||Oe<0)||Oe>this.length)throw new RangeError("Attempt to write outside buffer bounds");st||(st="utf8");let Ot=!1;for(;;)switch(st){case"hex":return We(this,Se,Oe,Ve);case"utf8":case"utf-8":return et(this,Se,Oe,Ve);case"ascii":case"latin1":case"binary":return He(this,Se,Oe,Ve);case"base64":return ht(this,Se,Oe,Ve);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return _t(this,Se,Oe,Ve);default:if(Ot)throw new TypeError("Unknown encoding: "+st);st=(""+st).toLowerCase(),Ot=!0}},ie.prototype.toJSON=function(){return{type:"Buffer",data:Array.prototype.slice.call(this._arr||this,0)}};function ut(je,Se,Oe){return Se===0&&Oe===je.length?X.fromByteArray(je):X.fromByteArray(je.slice(Se,Oe))}function yt(je,Se,Oe){Oe=Math.min(je.length,Oe);const Ve=[];let st=Se;for(;st<Oe;){const gt=je[st];let Ot=null,tr=gt>239?4:gt>223?3:gt>191?2:1;if(st+tr<=Oe){let Qt,xt,Ct,Nt;switch(tr){case 1:gt<128&&(Ot=gt);break;case 2:Qt=je[st+1],(Qt&192)===128&&(Nt=(gt&31)<<6|Qt&63,Nt>127&&(Ot=Nt));break;case 3:Qt=je[st+1],xt=je[st+2],(Qt&192)===128&&(xt&192)===128&&(Nt=(gt&15)<<12|(Qt&63)<<6|xt&63,Nt>2047&&(Nt<55296||Nt>57343)&&(Ot=Nt));break;case 4:Qt=je[st+1],xt=je[st+2],Ct=je[st+3],(Qt&192)===128&&(xt&192)===128&&(Ct&192)===128&&(Nt=(gt&15)<<18|(Qt&63)<<12|(xt&63)<<6|Ct&63,Nt>65535&&Nt<1114112&&(Ot=Nt))}}Ot===null?(Ot=65533,tr=1):Ot>65535&&(Ot-=65536,Ve.push(Ot>>>10&1023|55296),Ot=56320|Ot&1023),Ve.push(Ot),st+=tr}return Kt(Ve)}const Lt=4096;function Kt(je){const Se=je.length;if(Se<=Lt)return String.fromCharCode.apply(String,je);let Oe="",Ve=0;for(;Ve<Se;)Oe+=String.fromCharCode.apply(String,je.slice(Ve,Ve+=Lt));return Oe}function ft(je,Se,Oe){let Ve="";Oe=Math.min(je.length,Oe);for(let st=Se;st<Oe;++st)Ve+=String.fromCharCode(je[st]&127);return Ve}function qt(je,Se,Oe){let Ve="";Oe=Math.min(je.length,Oe);for(let st=Se;st<Oe;++st)Ve+=String.fromCharCode(je[st]);return Ve}function nt(je,Se,Oe){const Ve=je.length;(!Se||Se<0)&&(Se=0),(!Oe||Oe<0||Oe>Ve)&&(Oe=Ve);let st="";for(let gt=Se;gt<Oe;++gt)st+=Ir[je[gt]];return st}function At(je,Se,Oe){const Ve=je.slice(Se,Oe);let st="";for(let gt=0;gt<Ve.length-1;gt+=2)st+=String.fromCharCode(Ve[gt]+Ve[gt+1]*256);return st}ie.prototype.slice=function(Se,Oe){const Ve=this.length;Se=~~Se,Oe=Oe===void 0?Ve:~~Oe,Se<0?(Se+=Ve,Se<0&&(Se=0)):Se>Ve&&(Se=Ve),Oe<0?(Oe+=Ve,Oe<0&&(Oe=0)):Oe>Ve&&(Oe=Ve),Oe<Se&&(Oe=Se);const st=this.subarray(Se,Oe);return Object.setPrototypeOf(st,ie.prototype),st};function wt(je,Se,Oe){if(je%1!==0||je<0)throw new RangeError("offset is not uint");if(je+Se>Oe)throw new RangeError("Trying to access beyond buffer length")}ie.prototype.readUintLE=ie.prototype.readUIntLE=function(Se,Oe,Ve){Se=Se>>>0,Oe=Oe>>>0,Ve||wt(Se,Oe,this.length);let st=this[Se],gt=1,Ot=0;for(;++Ot<Oe&&(gt*=256);)st+=this[Se+Ot]*gt;return st},ie.prototype.readUintBE=ie.prototype.readUIntBE=function(Se,Oe,Ve){Se=Se>>>0,Oe=Oe>>>0,Ve||wt(Se,Oe,this.length);let st=this[Se+--Oe],gt=1;for(;Oe>0&&(gt*=256);)st+=this[Se+--Oe]*gt;return st},ie.prototype.readUint8=ie.prototype.readUInt8=function(Se,Oe){return Se=Se>>>0,Oe||wt(Se,1,this.length),this[Se]},ie.prototype.readUint16LE=ie.prototype.readUInt16LE=function(Se,Oe){return Se=Se>>>0,Oe||wt(Se,2,this.length),this[Se]|this[Se+1]<<8},ie.prototype.readUint16BE=ie.prototype.readUInt16BE=function(Se,Oe){return Se=Se>>>0,Oe||wt(Se,2,this.length),this[Se]<<8|this[Se+1]},ie.prototype.readUint32LE=ie.prototype.readUInt32LE=function(Se,Oe){return Se=Se>>>0,Oe||wt(Se,4,this.length),(this[Se]|this[Se+1]<<8|this[Se+2]<<16)+this[Se+3]*16777216},ie.prototype.readUint32BE=ie.prototype.readUInt32BE=function(Se,Oe){return Se=Se>>>0,Oe||wt(Se,4,this.length),this[Se]*16777216+(this[Se+1]<<16|this[Se+2]<<8|this[Se+3])},ie.prototype.readBigUInt64LE=Or(function(Se){Se=Se>>>0,Kr(Se,"offset");const Oe=this[Se],Ve=this[Se+7];(Oe===void 0||Ve===void 0)&&ui(Se,this.length-8);const st=Oe+this[++Se]*2**8+this[++Se]*2**16+this[++Se]*2**24,gt=this[++Se]+this[++Se]*2**8+this[++Se]*2**16+Ve*2**24;return BigInt(st)+(BigInt(gt)<<BigInt(32))}),ie.prototype.readBigUInt64BE=Or(function(Se){Se=Se>>>0,Kr(Se,"offset");const Oe=this[Se],Ve=this[Se+7];(Oe===void 0||Ve===void 0)&&ui(Se,this.length-8);const st=Oe*2**24+this[++Se]*2**16+this[++Se]*2**8+this[++Se],gt=this[++Se]*2**24+this[++Se]*2**16+this[++Se]*2**8+Ve;return(BigInt(st)<<BigInt(32))+BigInt(gt)}),ie.prototype.readIntLE=function(Se,Oe,Ve){Se=Se>>>0,Oe=Oe>>>0,Ve||wt(Se,Oe,this.length);let st=this[Se],gt=1,Ot=0;for(;++Ot<Oe&&(gt*=256);)st+=this[Se+Ot]*gt;return gt*=128,st>=gt&&(st-=Math.pow(2,8*Oe)),st},ie.prototype.readIntBE=function(Se,Oe,Ve){Se=Se>>>0,Oe=Oe>>>0,Ve||wt(Se,Oe,this.length);let st=Oe,gt=1,Ot=this[Se+--st];for(;st>0&&(gt*=256);)Ot+=this[Se+--st]*gt;return gt*=128,Ot>=gt&&(Ot-=Math.pow(2,8*Oe)),Ot},ie.prototype.readInt8=function(Se,Oe){return Se=Se>>>0,Oe||wt(Se,1,this.length),this[Se]&128?(255-this[Se]+1)*-1:this[Se]},ie.prototype.readInt16LE=function(Se,Oe){Se=Se>>>0,Oe||wt(Se,2,this.length);const Ve=this[Se]|this[Se+1]<<8;return Ve&32768?Ve|4294901760:Ve},ie.prototype.readInt16BE=function(Se,Oe){Se=Se>>>0,Oe||wt(Se,2,this.length);const Ve=this[Se+1]|this[Se]<<8;return Ve&32768?Ve|4294901760:Ve},ie.prototype.readInt32LE=function(Se,Oe){return Se=Se>>>0,Oe||wt(Se,4,this.length),this[Se]|this[Se+1]<<8|this[Se+2]<<16|this[Se+3]<<24},ie.prototype.readInt32BE=function(Se,Oe){return Se=Se>>>0,Oe||wt(Se,4,this.length),this[Se]<<24|this[Se+1]<<16|this[Se+2]<<8|this[Se+3]},ie.prototype.readBigInt64LE=Or(function(Se){Se=Se>>>0,Kr(Se,"offset");const Oe=this[Se],Ve=this[Se+7];(Oe===void 0||Ve===void 0)&&ui(Se,this.length-8);const st=this[Se+4]+this[Se+5]*2**8+this[Se+6]*2**16+(Ve<<24);return(BigInt(st)<<BigInt(32))+BigInt(Oe+this[++Se]*2**8+this[++Se]*2**16+this[++Se]*2**24)}),ie.prototype.readBigInt64BE=Or(function(Se){Se=Se>>>0,Kr(Se,"offset");const Oe=this[Se],Ve=this[Se+7];(Oe===void 0||Ve===void 0)&&ui(Se,this.length-8);const st=(Oe<<24)+this[++Se]*2**16+this[++Se]*2**8+this[++Se];return(BigInt(st)<<BigInt(32))+BigInt(this[++Se]*2**24+this[++Se]*2**16+this[++Se]*2**8+Ve)}),ie.prototype.readFloatLE=function(Se,Oe){return Se=Se>>>0,Oe||wt(Se,4,this.length),ee.read(this,Se,!0,23,4)},ie.prototype.readFloatBE=function(Se,Oe){return Se=Se>>>0,Oe||wt(Se,4,this.length),ee.read(this,Se,!1,23,4)},ie.prototype.readDoubleLE=function(Se,Oe){return Se=Se>>>0,Oe||wt(Se,8,this.length),ee.read(this,Se,!0,52,8)},ie.prototype.readDoubleBE=function(Se,Oe){return Se=Se>>>0,Oe||wt(Se,8,this.length),ee.read(this,Se,!1,52,8)};function Ft(je,Se,Oe,Ve,st,gt){if(!ie.isBuffer(je))throw new TypeError('"buffer" argument must be a Buffer instance');if(Se>st||Se<gt)throw new RangeError('"value" argument is out of bounds');if(Oe+Ve>je.length)throw new RangeError("Index out of range")}ie.prototype.writeUintLE=ie.prototype.writeUIntLE=function(Se,Oe,Ve,st){if(Se=+Se,Oe=Oe>>>0,Ve=Ve>>>0,!st){const tr=Math.pow(2,8*Ve)-1;Ft(this,Se,Oe,Ve,tr,0)}let gt=1,Ot=0;for(this[Oe]=Se&255;++Ot<Ve&&(gt*=256);)this[Oe+Ot]=Se/gt&255;return Oe+Ve},ie.prototype.writeUintBE=ie.prototype.writeUIntBE=function(Se,Oe,Ve,st){if(Se=+Se,Oe=Oe>>>0,Ve=Ve>>>0,!st){const tr=Math.pow(2,8*Ve)-1;Ft(this,Se,Oe,Ve,tr,0)}let gt=Ve-1,Ot=1;for(this[Oe+gt]=Se&255;--gt>=0&&(Ot*=256);)this[Oe+gt]=Se/Ot&255;return Oe+Ve},ie.prototype.writeUint8=ie.prototype.writeUInt8=function(Se,Oe,Ve){return Se=+Se,Oe=Oe>>>0,Ve||Ft(this,Se,Oe,1,255,0),this[Oe]=Se&255,Oe+1},ie.prototype.writeUint16LE=ie.prototype.writeUInt16LE=function(Se,Oe,Ve){return Se=+Se,Oe=Oe>>>0,Ve||Ft(this,Se,Oe,2,65535,0),this[Oe]=Se&255,this[Oe+1]=Se>>>8,Oe+2},ie.prototype.writeUint16BE=ie.prototype.writeUInt16BE=function(Se,Oe,Ve){return Se=+Se,Oe=Oe>>>0,Ve||Ft(this,Se,Oe,2,65535,0),this[Oe]=Se>>>8,this[Oe+1]=Se&255,Oe+2},ie.prototype.writeUint32LE=ie.prototype.writeUInt32LE=function(Se,Oe,Ve){return Se=+Se,Oe=Oe>>>0,Ve||Ft(this,Se,Oe,4,4294967295,0),this[Oe+3]=Se>>>24,this[Oe+2]=Se>>>16,this[Oe+1]=Se>>>8,this[Oe]=Se&255,Oe+4},ie.prototype.writeUint32BE=ie.prototype.writeUInt32BE=function(Se,Oe,Ve){return Se=+Se,Oe=Oe>>>0,Ve||Ft(this,Se,Oe,4,4294967295,0),this[Oe]=Se>>>24,this[Oe+1]=Se>>>16,this[Oe+2]=Se>>>8,this[Oe+3]=Se&255,Oe+4};function er(je,Se,Oe,Ve,st){Er(Se,Ve,st,je,Oe,7);let gt=Number(Se&BigInt(4294967295));je[Oe++]=gt,gt=gt>>8,je[Oe++]=gt,gt=gt>>8,je[Oe++]=gt,gt=gt>>8,je[Oe++]=gt;let Ot=Number(Se>>BigInt(32)&BigInt(4294967295));return je[Oe++]=Ot,Ot=Ot>>8,je[Oe++]=Ot,Ot=Ot>>8,je[Oe++]=Ot,Ot=Ot>>8,je[Oe++]=Ot,Oe}function lr(je,Se,Oe,Ve,st){Er(Se,Ve,st,je,Oe,7);let gt=Number(Se&BigInt(4294967295));je[Oe+7]=gt,gt=gt>>8,je[Oe+6]=gt,gt=gt>>8,je[Oe+5]=gt,gt=gt>>8,je[Oe+4]=gt;let Ot=Number(Se>>BigInt(32)&BigInt(4294967295));return je[Oe+3]=Ot,Ot=Ot>>8,je[Oe+2]=Ot,Ot=Ot>>8,je[Oe+1]=Ot,Ot=Ot>>8,je[Oe]=Ot,Oe+8}ie.prototype.writeBigUInt64LE=Or(function(Se,Oe=0){return er(this,Se,Oe,BigInt(0),BigInt("0xffffffffffffffff"))}),ie.prototype.writeBigUInt64BE=Or(function(Se,Oe=0){return lr(this,Se,Oe,BigInt(0),BigInt("0xffffffffffffffff"))}),ie.prototype.writeIntLE=function(Se,Oe,Ve,st){if(Se=+Se,Oe=Oe>>>0,!st){const Qt=Math.pow(2,8*Ve-1);Ft(this,Se,Oe,Ve,Qt-1,-Qt)}let gt=0,Ot=1,tr=0;for(this[Oe]=Se&255;++gt<Ve&&(Ot*=256);)Se<0&&tr===0&&this[Oe+gt-1]!==0&&(tr=1),this[Oe+gt]=(Se/Ot>>0)-tr&255;return Oe+Ve},ie.prototype.writeIntBE=function(Se,Oe,Ve,st){if(Se=+Se,Oe=Oe>>>0,!st){const Qt=Math.pow(2,8*Ve-1);Ft(this,Se,Oe,Ve,Qt-1,-Qt)}let gt=Ve-1,Ot=1,tr=0;for(this[Oe+gt]=Se&255;--gt>=0&&(Ot*=256);)Se<0&&tr===0&&this[Oe+gt+1]!==0&&(tr=1),this[Oe+gt]=(Se/Ot>>0)-tr&255;return Oe+Ve},ie.prototype.writeInt8=function(Se,Oe,Ve){return Se=+Se,Oe=Oe>>>0,Ve||Ft(this,Se,Oe,1,127,-128),Se<0&&(Se=255+Se+1),this[Oe]=Se&255,Oe+1},ie.prototype.writeInt16LE=function(Se,Oe,Ve){return Se=+Se,Oe=Oe>>>0,Ve||Ft(this,Se,Oe,2,32767,-32768),this[Oe]=Se&255,this[Oe+1]=Se>>>8,Oe+2},ie.prototype.writeInt16BE=function(Se,Oe,Ve){return Se=+Se,Oe=Oe>>>0,Ve||Ft(this,Se,Oe,2,32767,-32768),this[Oe]=Se>>>8,this[Oe+1]=Se&255,Oe+2},ie.prototype.writeInt32LE=function(Se,Oe,Ve){return Se=+Se,Oe=Oe>>>0,Ve||Ft(this,Se,Oe,4,2147483647,-2147483648),this[Oe]=Se&255,this[Oe+1]=Se>>>8,this[Oe+2]=Se>>>16,this[Oe+3]=Se>>>24,Oe+4},ie.prototype.writeInt32BE=function(Se,Oe,Ve){return Se=+Se,Oe=Oe>>>0,Ve||Ft(this,Se,Oe,4,2147483647,-2147483648),Se<0&&(Se=4294967295+Se+1),this[Oe]=Se>>>24,this[Oe+1]=Se>>>16,this[Oe+2]=Se>>>8,this[Oe+3]=Se&255,Oe+4},ie.prototype.writeBigInt64LE=Or(function(Se,Oe=0){return er(this,Se,Oe,-BigInt("0x8000000000000000"),BigInt("0x7fffffffffffffff"))}),ie.prototype.writeBigInt64BE=Or(function(Se,Oe=0){return lr(this,Se,Oe,-BigInt("0x8000000000000000"),BigInt("0x7fffffffffffffff"))});function jr(je,Se,Oe,Ve,st,gt){if(Oe+Ve>je.length)throw new RangeError("Index out of range");if(Oe<0)throw new RangeError("Index out of range")}function Mr(je,Se,Oe,Ve,st){return Se=+Se,Oe=Oe>>>0,st||jr(je,Se,Oe,4),ee.write(je,Se,Oe,Ve,23,4),Oe+4}ie.prototype.writeFloatLE=function(Se,Oe,Ve){return Mr(this,Se,Oe,!0,Ve)},ie.prototype.writeFloatBE=function(Se,Oe,Ve){return Mr(this,Se,Oe,!1,Ve)};function Lr(je,Se,Oe,Ve,st){return Se=+Se,Oe=Oe>>>0,st||jr(je,Se,Oe,8),ee.write(je,Se,Oe,Ve,52,8),Oe+8}ie.prototype.writeDoubleLE=function(Se,Oe,Ve){return Lr(this,Se,Oe,!0,Ve)},ie.prototype.writeDoubleBE=function(Se,Oe,Ve){return Lr(this,Se,Oe,!1,Ve)},ie.prototype.copy=function(Se,Oe,Ve,st){if(!ie.isBuffer(Se))throw new TypeError("argument should be a Buffer");if(Ve||(Ve=0),!st&&st!==0&&(st=this.length),Oe>=Se.length&&(Oe=Se.length),Oe||(Oe=0),st>0&&st<Ve&&(st=Ve),st===Ve||Se.length===0||this.length===0)return 0;if(Oe<0)throw new RangeError("targetStart out of bounds");if(Ve<0||Ve>=this.length)throw new RangeError("Index out of range");if(st<0)throw new RangeError("sourceEnd out of bounds");st>this.length&&(st=this.length),Se.length-Oe<st-Ve&&(st=Se.length-Oe+Ve);const gt=st-Ve;return this===Se&&typeof Uint8Array.prototype.copyWithin=="function"?this.copyWithin(Oe,Ve,st):Uint8Array.prototype.set.call(Se,this.subarray(Ve,st),Oe),gt},ie.prototype.fill=function(Se,Oe,Ve,st){if(typeof Se=="string"){if(typeof Oe=="string"?(st=Oe,Oe=0,Ve=this.length):typeof Ve=="string"&&(st=Ve,Ve=this.length),st!==void 0&&typeof st!="string")throw new TypeError("encoding must be a string");if(typeof st=="string"&&!ie.isEncoding(st))throw new TypeError("Unknown encoding: "+st);if(Se.length===1){const Ot=Se.charCodeAt(0);(st==="utf8"&&Ot<128||st==="latin1")&&(Se=Ot)}}else typeof Se=="number"?Se=Se&255:typeof Se=="boolean"&&(Se=Number(Se));if(Oe<0||this.length<Oe||this.length<Ve)throw new RangeError("Out of range index");if(Ve<=Oe)return this;Oe=Oe>>>0,Ve=Ve===void 0?this.length:Ve>>>0,Se||(Se=0);let gt;if(typeof Se=="number")for(gt=Oe;gt<Ve;++gt)this[gt]=Se;else{const Ot=ie.isBuffer(Se)?Se:ie.from(Se,st),tr=Ot.length;if(tr===0)throw new TypeError('The value "'+Se+'" is invalid for argument "value"');for(gt=0;gt<Ve-Oe;++gt)this[gt+Oe]=Ot[gt%tr]}return this};const sr={};function Rr(je,Se,Oe){sr[je]=class extends Oe{constructor(){super(),Object.defineProperty(this,"message",{value:Se.apply(this,arguments),writable:!0,configurable:!0}),this.name=`${this.name} [${je}]`,this.stack,delete this.name}get code(){return je}set code(st){Object.defineProperty(this,"code",{configurable:!0,enumerable:!0,value:st,writable:!0})}toString(){return`${this.name} [${je}]: ${this.message}`}}}Rr("ERR_BUFFER_OUT_OF_BOUNDS",function(je){return je?`${je} is outside of buffer bounds`:"Attempt to access memory outside buffer bounds"},RangeError),Rr("ERR_INVALID_ARG_TYPE",function(je,Se){return`The "${je}" argument must be of type number. Received type ${typeof Se}`},TypeError),Rr("ERR_OUT_OF_RANGE",function(je,Se,Oe){let Ve=`The value of "${je}" is out of range.`,st=Oe;return Number.isInteger(Oe)&&Math.abs(Oe)>2**32?st=Ur(String(Oe)):typeof Oe=="bigint"&&(st=String(Oe),(Oe>BigInt(2)**BigInt(32)||Oe<-(BigInt(2)**BigInt(32)))&&(st=Ur(st)),st+="n"),Ve+=` It must be ${Se}. Received ${st}`,Ve},RangeError);function Ur(je){let Se="",Oe=je.length;const Ve=je[0]==="-"?1:0;for(;Oe>=Ve+4;Oe-=3)Se=`_${je.slice(Oe-3,Oe)}${Se}`;return`${je.slice(0,Oe)}${Se}`}function Wr(je,Se,Oe){Kr(Se,"offset"),(je[Se]===void 0||je[Se+Oe]===void 0)&&ui(Se,je.length-(Oe+1))}function Er(je,Se,Oe,Ve,st,gt){if(je>Oe||je<Se){const Ot=typeof Se=="bigint"?"n":"";let tr;throw Se===0||Se===BigInt(0)?tr=`>= 0${Ot} and < 2${Ot} ** ${(gt+1)*8}${Ot}`:tr=`>= -(2${Ot} ** ${(gt+1)*8-1}${Ot}) and < 2 ** ${(gt+1)*8-1}${Ot}`,new sr.ERR_OUT_OF_RANGE("value",tr,je)}Wr(Ve,st,gt)}function Kr(je,Se){if(typeof je!="number")throw new sr.ERR_INVALID_ARG_TYPE(Se,"number",je)}function ui(je,Se,Oe){throw Math.floor(je)!==je?(Kr(je,Oe),new sr.ERR_OUT_OF_RANGE("offset","an integer",je)):Se<0?new sr.ERR_BUFFER_OUT_OF_BOUNDS:new sr.ERR_OUT_OF_RANGE("offset",`>= 0 and <= ${Se}`,je)}const Ei=/[^+/0-9A-Za-z-_]/g;function Hr(je){if(je=je.split("=")[0],je=je.trim().replace(Ei,""),je.length<2)return"";for(;je.length%4!==0;)je=je+"=";return je}function Br(je,Se){Se=Se||1/0;let Oe;const Ve=je.length;let st=null;const gt=[];for(let Ot=0;Ot<Ve;++Ot){if(Oe=je.charCodeAt(Ot),Oe>55295&&Oe<57344){if(!st){if(Oe>56319){(Se-=3)>-1&&gt.push(239,191,189);continue}else if(Ot+1===Ve){(Se-=3)>-1&&gt.push(239,191,189);continue}st=Oe;continue}if(Oe<56320){(Se-=3)>-1&&gt.push(239,191,189),st=Oe;continue}Oe=(st-55296<<10|Oe-56320)+65536}else st&&(Se-=3)>-1&&gt.push(239,191,189);if(st=null,Oe<128){if((Se-=1)<0)break;gt.push(Oe)}else if(Oe<2048){if((Se-=2)<0)break;gt.push(Oe>>6|192,Oe&63|128)}else if(Oe<65536){if((Se-=3)<0)break;gt.push(Oe>>12|224,Oe>>6&63|128,Oe&63|128)}else if(Oe<1114112){if((Se-=4)<0)break;gt.push(Oe>>18|240,Oe>>12&63|128,Oe>>6&63|128,Oe&63|128)}else throw new Error("Invalid code point")}return gt}function li(je){const Se=[];for(let Oe=0;Oe<je.length;++Oe)Se.push(je.charCodeAt(Oe)&255);return Se}function si(je,Se){let Oe,Ve,st;const gt=[];for(let Ot=0;Ot<je.length&&!((Se-=2)<0);++Ot)Oe=je.charCodeAt(Ot),Ve=Oe>>8,st=Oe%256,gt.push(st),gt.push(Ve);return gt}function Qr(je){return X.toByteArray(Hr(je))}function _r(je,Se,Oe,Ve){let st;for(st=0;st<Ve&&!(st+Oe>=Se.length||st>=je.length);++st)Se[st+Oe]=je[st];return st}function vr(je,Se){return je instanceof Se||je!=null&&je.constructor!=null&&je.constructor.name!=null&&je.constructor.name===Se.name}function Xr(je){return je!==je}const Ir=function(){const je="0123456789abcdef",Se=new Array(256);for(let Oe=0;Oe<16;++Oe){const Ve=Oe*16;for(let st=0;st<16;++st)Se[Ve+st]=je[Oe]+je[st]}return Se}();function Or(je){return typeof BigInt>"u"?Nr:je}function Nr(){throw new Error("BigInt not supported")}}(buffer)),buffer}var bufferExports=requireBuffer(),indexMinimal={},minimal$1={},aspromise,hasRequiredAspromise;function requireAspromise(){if(hasRequiredAspromise)return aspromise;hasRequiredAspromise=1,aspromise=Y;function Y(X,ee){for(var ne=new Array(arguments.length-1),te=0,ue=2,se=!0;ue<arguments.length;)ne[te++]=arguments[ue++];return new Promise(function(t,H){ne[te]=function(he){if(se)if(se=!1,he)H(he);else{for(var _e=new Array(arguments.length-1),ge=0;ge<_e.length;)_e[ge++]=arguments[ge];t.apply(null,_e)}};try{X.apply(ee||null,ne)}catch(ae){se&&(se=!1,H(ae))}})}return aspromise}var base64={},hasRequiredBase64;function requireBase64(){return hasRequiredBase64||(hasRequiredBase64=1,function(Y){var X=Y;X.length=function(ie){var t=ie.length;if(!t)return 0;for(var H=0;--t%4>1&&ie.charAt(t)==="=";)++H;return Math.ceil(ie.length*3)/4-H};for(var ee=new Array(64),ne=new Array(123),te=0;te<64;)ne[ee[te]=te<26?te+65:te<52?te+71:te<62?te-4:te-59|43]=te++;X.encode=function(ie,t,H){for(var ae=null,he=[],_e=0,ge=0,xe;t<H;){var Re=ie[t++];switch(ge){case 0:he[_e++]=ee[Re>>2],xe=(Re&3)<<4,ge=1;break;case 1:he[_e++]=ee[xe|Re>>4],xe=(Re&15)<<2,ge=2;break;case 2:he[_e++]=ee[xe|Re>>6],he[_e++]=ee[Re&63],ge=0;break}_e>8191&&((ae||(ae=[])).push(String.fromCharCode.apply(String,he)),_e=0)}return ge&&(he[_e++]=ee[xe],he[_e++]=61,ge===1&&(he[_e++]=61)),ae?(_e&&ae.push(String.fromCharCode.apply(String,he.slice(0,_e))),ae.join("")):String.fromCharCode.apply(String,he.slice(0,_e))};var ue="invalid encoding";X.decode=function(ie,t,H){for(var ae=H,he=0,_e,ge=0;ge<ie.length;){var xe=ie.charCodeAt(ge++);if(xe===61&&he>1)break;if((xe=ne[xe])===void 0)throw Error(ue);switch(he){case 0:_e=xe,he=1;break;case 1:t[H++]=_e<<2|(xe&48)>>4,_e=xe,he=2;break;case 2:t[H++]=(_e&15)<<4|(xe&60)>>2,_e=xe,he=3;break;case 3:t[H++]=(_e&3)<<6|xe,he=0;break}}if(he===1)throw Error(ue);return H-ae},X.test=function(ie){return/^(?:[A-Za-z0-9+/]{4})*(?:[A-Za-z0-9+/]{2}==|[A-Za-z0-9+/]{3}=)?$/.test(ie)}}(base64)),base64}var eventemitter,hasRequiredEventemitter;function requireEventemitter(){if(hasRequiredEventemitter)return eventemitter;hasRequiredEventemitter=1,eventemitter=Y;function Y(){this._listeners={}}return Y.prototype.on=function(ee,ne,te){return(this._listeners[ee]||(this._listeners[ee]=[])).push({fn:ne,ctx:te||this}),this},Y.prototype.off=function(ee,ne){if(ee===void 0)this._listeners={};else if(ne===void 0)this._listeners[ee]=[];else for(var te=this._listeners[ee],ue=0;ue<te.length;)te[ue].fn===ne?te.splice(ue,1):++ue;return this},Y.prototype.emit=function(ee){var ne=this._listeners[ee];if(ne){for(var te=[],ue=1;ue<arguments.length;)te.push(arguments[ue++]);for(ue=0;ue<ne.length;)ne[ue].fn.apply(ne[ue++].ctx,te)}return this},eventemitter}var float,hasRequiredFloat;function requireFloat(){if(hasRequiredFloat)return float;hasRequiredFloat=1,float=Y(Y);function Y(ue){return typeof Float32Array<"u"?function(){var se=new Float32Array([-0]),ie=new Uint8Array(se.buffer),t=ie[3]===128;function H(ge,xe,Re){se[0]=ge,xe[Re]=ie[0],xe[Re+1]=ie[1],xe[Re+2]=ie[2],xe[Re+3]=ie[3]}function ae(ge,xe,Re){se[0]=ge,xe[Re]=ie[3],xe[Re+1]=ie[2],xe[Re+2]=ie[1],xe[Re+3]=ie[0]}ue.writeFloatLE=t?H:ae,ue.writeFloatBE=t?ae:H;function he(ge,xe){return ie[0]=ge[xe],ie[1]=ge[xe+1],ie[2]=ge[xe+2],ie[3]=ge[xe+3],se[0]}function _e(ge,xe){return ie[3]=ge[xe],ie[2]=ge[xe+1],ie[1]=ge[xe+2],ie[0]=ge[xe+3],se[0]}ue.readFloatLE=t?he:_e,ue.readFloatBE=t?_e:he}():function(){function se(t,H,ae,he){var _e=H<0?1:0;if(_e&&(H=-H),H===0)t(1/H>0?0:2147483648,ae,he);else if(isNaN(H))t(2143289344,ae,he);else if(H>34028234663852886e22)t((_e<<31|2139095040)>>>0,ae,he);else if(H<11754943508222875e-54)t((_e<<31|Math.round(H/1401298464324817e-60))>>>0,ae,he);else{var ge=Math.floor(Math.log(H)/Math.LN2),xe=Math.round(H*Math.pow(2,-ge)*8388608)&8388607;t((_e<<31|ge+127<<23|xe)>>>0,ae,he)}}ue.writeFloatLE=se.bind(null,X),ue.writeFloatBE=se.bind(null,ee);function ie(t,H,ae){var he=t(H,ae),_e=(he>>31)*2+1,ge=he>>>23&255,xe=he&8388607;return ge===255?xe?NaN:_e*(1/0):ge===0?_e*1401298464324817e-60*xe:_e*Math.pow(2,ge-150)*(xe+8388608)}ue.readFloatLE=ie.bind(null,ne),ue.readFloatBE=ie.bind(null,te)}(),typeof Float64Array<"u"?function(){var se=new Float64Array([-0]),ie=new Uint8Array(se.buffer),t=ie[7]===128;function H(ge,xe,Re){se[0]=ge,xe[Re]=ie[0],xe[Re+1]=ie[1],xe[Re+2]=ie[2],xe[Re+3]=ie[3],xe[Re+4]=ie[4],xe[Re+5]=ie[5],xe[Re+6]=ie[6],xe[Re+7]=ie[7]}function ae(ge,xe,Re){se[0]=ge,xe[Re]=ie[7],xe[Re+1]=ie[6],xe[Re+2]=ie[5],xe[Re+3]=ie[4],xe[Re+4]=ie[3],xe[Re+5]=ie[2],xe[Re+6]=ie[1],xe[Re+7]=ie[0]}ue.writeDoubleLE=t?H:ae,ue.writeDoubleBE=t?ae:H;function he(ge,xe){return ie[0]=ge[xe],ie[1]=ge[xe+1],ie[2]=ge[xe+2],ie[3]=ge[xe+3],ie[4]=ge[xe+4],ie[5]=ge[xe+5],ie[6]=ge[xe+6],ie[7]=ge[xe+7],se[0]}function _e(ge,xe){return ie[7]=ge[xe],ie[6]=ge[xe+1],ie[5]=ge[xe+2],ie[4]=ge[xe+3],ie[3]=ge[xe+4],ie[2]=ge[xe+5],ie[1]=ge[xe+6],ie[0]=ge[xe+7],se[0]}ue.readDoubleLE=t?he:_e,ue.readDoubleBE=t?_e:he}():function(){function se(t,H,ae,he,_e,ge){var xe=he<0?1:0;if(xe&&(he=-he),he===0)t(0,_e,ge+H),t(1/he>0?0:2147483648,_e,ge+ae);else if(isNaN(he))t(0,_e,ge+H),t(2146959360,_e,ge+ae);else if(he>17976931348623157e292)t(0,_e,ge+H),t((xe<<31|2146435072)>>>0,_e,ge+ae);else{var Re;if(he<22250738585072014e-324)Re=he/5e-324,t(Re>>>0,_e,ge+H),t((xe<<31|Re/4294967296)>>>0,_e,ge+ae);else{var De=Math.floor(Math.log(he)/Math.LN2);De===1024&&(De=1023),Re=he*Math.pow(2,-De),t(Re*4503599627370496>>>0,_e,ge+H),t((xe<<31|De+1023<<20|Re*1048576&1048575)>>>0,_e,ge+ae)}}}ue.writeDoubleLE=se.bind(null,X,0,4),ue.writeDoubleBE=se.bind(null,ee,4,0);function ie(t,H,ae,he,_e){var ge=t(he,_e+H),xe=t(he,_e+ae),Re=(xe>>31)*2+1,De=xe>>>20&2047,Ie=4294967296*(xe&1048575)+ge;return De===2047?Ie?NaN:Re*(1/0):De===0?Re*5e-324*Ie:Re*Math.pow(2,De-1075)*(Ie+4503599627370496)}ue.readDoubleLE=ie.bind(null,ne,0,4),ue.readDoubleBE=ie.bind(null,te,4,0)}(),ue}function X(ue,se,ie){se[ie]=ue&255,se[ie+1]=ue>>>8&255,se[ie+2]=ue>>>16&255,se[ie+3]=ue>>>24}function ee(ue,se,ie){se[ie]=ue>>>24,se[ie+1]=ue>>>16&255,se[ie+2]=ue>>>8&255,se[ie+3]=ue&255}function ne(ue,se){return(ue[se]|ue[se+1]<<8|ue[se+2]<<16|ue[se+3]<<24)>>>0}function te(ue,se){return(ue[se]<<24|ue[se+1]<<16|ue[se+2]<<8|ue[se+3])>>>0}return float}var inquire_1,hasRequiredInquire;function requireInquire(){if(hasRequiredInquire)return inquire_1;hasRequiredInquire=1,inquire_1=inquire;function inquire(moduleName){try{var mod=eval("quire".replace(/^/,"re"))(moduleName);if(mod&&(mod.length||Object.keys(mod).length))return mod}catch(Y){}return null}return inquire_1}var utf8={},hasRequiredUtf8;function requireUtf8(){return hasRequiredUtf8||(hasRequiredUtf8=1,function(Y){var X=Y;X.length=function(ne){for(var te=0,ue=0,se=0;se<ne.length;++se)ue=ne.charCodeAt(se),ue<128?te+=1:ue<2048?te+=2:(ue&64512)===55296&&(ne.charCodeAt(se+1)&64512)===56320?(++se,te+=4):te+=3;return te},X.read=function(ne,te,ue){var se=ue-te;if(se<1)return"";for(var ie=null,t=[],H=0,ae;te<ue;)ae=ne[te++],ae<128?t[H++]=ae:ae>191&&ae<224?t[H++]=(ae&31)<<6|ne[te++]&63:ae>239&&ae<365?(ae=((ae&7)<<18|(ne[te++]&63)<<12|(ne[te++]&63)<<6|ne[te++]&63)-65536,t[H++]=55296+(ae>>10),t[H++]=56320+(ae&1023)):t[H++]=(ae&15)<<12|(ne[te++]&63)<<6|ne[te++]&63,H>8191&&((ie||(ie=[])).push(String.fromCharCode.apply(String,t)),H=0);return ie?(H&&ie.push(String.fromCharCode.apply(String,t.slice(0,H))),ie.join("")):String.fromCharCode.apply(String,t.slice(0,H))},X.write=function(ne,te,ue){for(var se=ue,ie,t,H=0;H<ne.length;++H)ie=ne.charCodeAt(H),ie<128?te[ue++]=ie:ie<2048?(te[ue++]=ie>>6|192,te[ue++]=ie&63|128):(ie&64512)===55296&&((t=ne.charCodeAt(H+1))&64512)===56320?(ie=65536+((ie&1023)<<10)+(t&1023),++H,te[ue++]=ie>>18|240,te[ue++]=ie>>12&63|128,te[ue++]=ie>>6&63|128,te[ue++]=ie&63|128):(te[ue++]=ie>>12|224,te[ue++]=ie>>6&63|128,te[ue++]=ie&63|128);return ue-se}}(utf8)),utf8}var pool_1,hasRequiredPool;function requirePool(){if(hasRequiredPool)return pool_1;hasRequiredPool=1,pool_1=Y;function Y(X,ee,ne){var te=ne||8192,ue=te>>>1,se=null,ie=te;return function(H){if(H<1||H>ue)return X(H);ie+H>te&&(se=X(te),ie=0);var ae=ee.call(se,ie,ie+=H);return ie&7&&(ie=(ie|7)+1),ae}}return pool_1}var longbits,hasRequiredLongbits;function requireLongbits(){if(hasRequiredLongbits)return longbits;hasRequiredLongbits=1,longbits=X;var Y=requireMinimal$1();function X(ue,se){this.lo=ue>>>0,this.hi=se>>>0}var ee=X.zero=new X(0,0);ee.toNumber=function(){return 0},ee.zzEncode=ee.zzDecode=function(){return this},ee.length=function(){return 1};var ne=X.zeroHash="\0\0\0\0\0\0\0\0";X.fromNumber=function(se){if(se===0)return ee;var ie=se<0;ie&&(se=-se);var t=se>>>0,H=(se-t)/4294967296>>>0;return ie&&(H=~H>>>0,t=~t>>>0,++t>4294967295&&(t=0,++H>4294967295&&(H=0))),new X(t,H)},X.from=function(se){if(typeof se=="number")return X.fromNumber(se);if(Y.isString(se))if(Y.Long)se=Y.Long.fromString(se);else return X.fromNumber(parseInt(se,10));return se.low||se.high?new X(se.low>>>0,se.high>>>0):ee},X.prototype.toNumber=function(se){if(!se&&this.hi>>>31){var ie=~this.lo+1>>>0,t=~this.hi>>>0;return ie||(t=t+1>>>0),-(ie+t*4294967296)}return this.lo+this.hi*4294967296},X.prototype.toLong=function(se){return Y.Long?new Y.Long(this.lo|0,this.hi|0,!!se):{low:this.lo|0,high:this.hi|0,unsigned:!!se}};var te=String.prototype.charCodeAt;return X.fromHash=function(se){return se===ne?ee:new X((te.call(se,0)|te.call(se,1)<<8|te.call(se,2)<<16|te.call(se,3)<<24)>>>0,(te.call(se,4)|te.call(se,5)<<8|te.call(se,6)<<16|te.call(se,7)<<24)>>>0)},X.prototype.toHash=function(){return String.fromCharCode(this.lo&255,this.lo>>>8&255,this.lo>>>16&255,this.lo>>>24,this.hi&255,this.hi>>>8&255,this.hi>>>16&255,this.hi>>>24)},X.prototype.zzEncode=function(){var se=this.hi>>31;return this.hi=((this.hi<<1|this.lo>>>31)^se)>>>0,this.lo=(this.lo<<1^se)>>>0,this},X.prototype.zzDecode=function(){var se=-(this.lo&1);return this.lo=((this.lo>>>1|this.hi<<31)^se)>>>0,this.hi=(this.hi>>>1^se)>>>0,this},X.prototype.length=function(){var se=this.lo,ie=(this.lo>>>28|this.hi<<4)>>>0,t=this.hi>>>24;return t===0?ie===0?se<16384?se<128?1:2:se<2097152?3:4:ie<16384?ie<128?5:6:ie<2097152?7:8:t<128?9:10},longbits}var hasRequiredMinimal$1;function requireMinimal$1(){return hasRequiredMinimal$1||(hasRequiredMinimal$1=1,function(Y){var X=Y;X.asPromise=requireAspromise(),X.base64=requireBase64(),X.EventEmitter=requireEventemitter(),X.float=requireFloat(),X.inquire=requireInquire(),X.utf8=requireUtf8(),X.pool=requirePool(),X.LongBits=requireLongbits(),X.isNode=!!(typeof commonjsGlobal<"u"&&commonjsGlobal&&commonjsGlobal.process&&commonjsGlobal.process.versions&&commonjsGlobal.process.versions.node),X.global=X.isNode&&commonjsGlobal||typeof window<"u"&&window||typeof self<"u"&&self||minimal$1,X.emptyArray=Object.freeze?Object.freeze([]):[],X.emptyObject=Object.freeze?Object.freeze({}):{},X.isInteger=Number.isInteger||function(ue){return typeof ue=="number"&&isFinite(ue)&&Math.floor(ue)===ue},X.isString=function(ue){return typeof ue=="string"||ue instanceof String},X.isObject=function(ue){return ue&&typeof ue=="object"},X.isset=X.isSet=function(ue,se){var ie=ue[se];return ie!=null&&ue.hasOwnProperty(se)?typeof ie!="object"||(Array.isArray(ie)?ie.length:Object.keys(ie).length)>0:!1},X.Buffer=function(){try{var te=X.inquire("buffer").Buffer;return te.prototype.utf8Write?te:null}catch{return null}}(),X._Buffer_from=null,X._Buffer_allocUnsafe=null,X.newBuffer=function(ue){return typeof ue=="number"?X.Buffer?X._Buffer_allocUnsafe(ue):new X.Array(ue):X.Buffer?X._Buffer_from(ue):typeof Uint8Array>"u"?ue:new Uint8Array(ue)},X.Array=typeof Uint8Array<"u"?Uint8Array:Array,X.Long=X.global.dcodeIO&&X.global.dcodeIO.Long||X.global.Long||X.inquire("long"),X.key2Re=/^true|false|0|1$/,X.key32Re=/^-?(?:0|[1-9][0-9]*)$/,X.key64Re=/^(?:[\\x00-\\xff]{8}|-?(?:0|[1-9][0-9]*))$/,X.longToHash=function(ue){return ue?X.LongBits.from(ue).toHash():X.LongBits.zeroHash},X.longFromHash=function(ue,se){var ie=X.LongBits.fromHash(ue);return X.Long?X.Long.fromBits(ie.lo,ie.hi,se):ie.toNumber(!!se)};function ee(te,ue,se){for(var ie=Object.keys(ue),t=0;t<ie.length;++t)(te[ie[t]]===void 0||!se)&&(te[ie[t]]=ue[ie[t]]);return te}X.merge=ee,X.lcFirst=function(ue){return ue.charAt(0).toLowerCase()+ue.substring(1)};function ne(te){function ue(se,ie){if(!(this instanceof ue))return new ue(se,ie);Object.defineProperty(this,"message",{get:function(){return se}}),Error.captureStackTrace?Error.captureStackTrace(this,ue):Object.defineProperty(this,"stack",{value:new Error().stack||""}),ie&&ee(this,ie)}return ue.prototype=Object.create(Error.prototype,{constructor:{value:ue,writable:!0,enumerable:!1,configurable:!0},name:{get:function(){return te},set:void 0,enumerable:!1,configurable:!0},toString:{value:function(){return this.name+": "+this.message},writable:!0,enumerable:!1,configurable:!0}}),ue}X.newError=ne,X.ProtocolError=ne("ProtocolError"),X.oneOfGetter=function(ue){for(var se={},ie=0;ie<ue.length;++ie)se[ue[ie]]=1;return function(){for(var t=Object.keys(this),H=t.length-1;H>-1;--H)if(se[t[H]]===1&&this[t[H]]!==void 0&&this[t[H]]!==null)return t[H]}},X.oneOfSetter=function(ue){return function(se){for(var ie=0;ie<ue.length;++ie)ue[ie]!==se&&delete this[ue[ie]]}},X.toJSONOptions={longs:String,enums:String,bytes:String,json:!0},X._configure=function(){var te=X.Buffer;if(!te){X._Buffer_from=X._Buffer_allocUnsafe=null;return}X._Buffer_from=te.from!==Uint8Array.from&&te.from||function(se,ie){return new te(se,ie)},X._Buffer_allocUnsafe=te.allocUnsafe||function(se){return new te(se)}}}(minimal$1)),minimal$1}var writer,hasRequiredWriter;function requireWriter(){if(hasRequiredWriter)return writer;hasRequiredWriter=1,writer=t;var Y=requireMinimal$1(),X,ee=Y.LongBits,ne=Y.base64,te=Y.utf8;function ue(De,Ie,Ce){this.fn=De,this.len=Ie,this.next=void 0,this.val=Ce}function se(){}function ie(De){this.head=De.head,this.tail=De.tail,this.len=De.len,this.next=De.states}function t(){this.len=0,this.head=new ue(se,0,0),this.tail=this.head,this.states=null}var H=function(){return Y.Buffer?function(){return(t.create=function(){return new X})()}:function(){return new t}};t.create=H(),t.alloc=function(Ie){return new Y.Array(Ie)},Y.Array!==Array&&(t.alloc=Y.pool(t.alloc,Y.Array.prototype.subarray)),t.prototype._push=function(Ie,Ce,Ue){return this.tail=this.tail.next=new ue(Ie,Ce,Ue),this.len+=Ce,this};function ae(De,Ie,Ce){Ie[Ce]=De&255}function he(De,Ie,Ce){for(;De>127;)Ie[Ce++]=De&127|128,De>>>=7;Ie[Ce]=De}function _e(De,Ie){this.len=De,this.next=void 0,this.val=Ie}_e.prototype=Object.create(ue.prototype),_e.prototype.fn=he,t.prototype.uint32=function(Ie){return this.len+=(this.tail=this.tail.next=new _e((Ie=Ie>>>0)<128?1:Ie<16384?2:Ie<2097152?3:Ie<268435456?4:5,Ie)).len,this},t.prototype.int32=function(Ie){return Ie<0?this._push(ge,10,ee.fromNumber(Ie)):this.uint32(Ie)},t.prototype.sint32=function(Ie){return this.uint32((Ie<<1^Ie>>31)>>>0)};function ge(De,Ie,Ce){for(;De.hi;)Ie[Ce++]=De.lo&127|128,De.lo=(De.lo>>>7|De.hi<<25)>>>0,De.hi>>>=7;for(;De.lo>127;)Ie[Ce++]=De.lo&127|128,De.lo=De.lo>>>7;Ie[Ce++]=De.lo}t.prototype.uint64=function(Ie){var Ce=ee.from(Ie);return this._push(ge,Ce.length(),Ce)},t.prototype.int64=t.prototype.uint64,t.prototype.sint64=function(Ie){var Ce=ee.from(Ie).zzEncode();return this._push(ge,Ce.length(),Ce)},t.prototype.bool=function(Ie){return this._push(ae,1,Ie?1:0)};function xe(De,Ie,Ce){Ie[Ce]=De&255,Ie[Ce+1]=De>>>8&255,Ie[Ce+2]=De>>>16&255,Ie[Ce+3]=De>>>24}t.prototype.fixed32=function(Ie){return this._push(xe,4,Ie>>>0)},t.prototype.sfixed32=t.prototype.fixed32,t.prototype.fixed64=function(Ie){var Ce=ee.from(Ie);return this._push(xe,4,Ce.lo)._push(xe,4,Ce.hi)},t.prototype.sfixed64=t.prototype.fixed64,t.prototype.float=function(Ie){return this._push(Y.float.writeFloatLE,4,Ie)},t.prototype.double=function(Ie){return this._push(Y.float.writeDoubleLE,8,Ie)};var Re=Y.Array.prototype.set?function(Ie,Ce,Ue){Ce.set(Ie,Ue)}:function(Ie,Ce,Ue){for(var Le=0;Le<Ie.length;++Le)Ce[Ue+Le]=Ie[Le]};return t.prototype.bytes=function(Ie){var Ce=Ie.length>>>0;if(!Ce)return this._push(ae,1,0);if(Y.isString(Ie)){var Ue=t.alloc(Ce=ne.length(Ie));ne.decode(Ie,Ue,0),Ie=Ue}return this.uint32(Ce)._push(Re,Ce,Ie)},t.prototype.string=function(Ie){var Ce=te.length(Ie);return Ce?this.uint32(Ce)._push(te.write,Ce,Ie):this._push(ae,1,0)},t.prototype.fork=function(){return this.states=new ie(this),this.head=this.tail=new ue(se,0,0),this.len=0,this},t.prototype.reset=function(){return this.states?(this.head=this.states.head,this.tail=this.states.tail,this.len=this.states.len,this.states=this.states.next):(this.head=this.tail=new ue(se,0,0),this.len=0),this},t.prototype.ldelim=function(){var Ie=this.head,Ce=this.tail,Ue=this.len;return this.reset().uint32(Ue),Ue&&(this.tail.next=Ie.next,this.tail=Ce,this.len+=Ue),this},t.prototype.finish=function(){for(var Ie=this.head.next,Ce=this.constructor.alloc(this.len),Ue=0;Ie;)Ie.fn(Ie.val,Ce,Ue),Ue+=Ie.len,Ie=Ie.next;return Ce},t._configure=function(De){X=De,t.create=H(),X._configure()},writer}var writer_buffer,hasRequiredWriter_buffer;function requireWriter_buffer(){if(hasRequiredWriter_buffer)return writer_buffer;hasRequiredWriter_buffer=1,writer_buffer=ee;var Y=requireWriter();(ee.prototype=Object.create(Y.prototype)).constructor=ee;var X=requireMinimal$1();function ee(){Y.call(this)}ee._configure=function(){ee.alloc=X._Buffer_allocUnsafe,ee.writeBytesBuffer=X.Buffer&&X.Buffer.prototype instanceof Uint8Array&&X.Buffer.prototype.set.name==="set"?function(ue,se,ie){se.set(ue,ie)}:function(ue,se,ie){if(ue.copy)ue.copy(se,ie,0,ue.length);else for(var t=0;t<ue.length;)se[ie++]=ue[t++]}},ee.prototype.bytes=function(ue){X.isString(ue)&&(ue=X._Buffer_from(ue,"base64"));var se=ue.length>>>0;return this.uint32(se),se&&this._push(ee.writeBytesBuffer,se,ue),this};function ne(te,ue,se){te.length<40?X.utf8.write(te,ue,se):ue.utf8Write?ue.utf8Write(te,se):ue.write(te,se)}return ee.prototype.string=function(ue){var se=X.Buffer.byteLength(ue);return this.uint32(se),se&&this._push(ne,se,ue),this},ee._configure(),writer_buffer}var reader,hasRequiredReader;function requireReader(){if(hasRequiredReader)return reader;hasRequiredReader=1,reader=ue;var Y=requireMinimal$1(),X,ee=Y.LongBits,ne=Y.utf8;function te(he,_e){return RangeError("index out of range: "+he.pos+" + "+(_e||1)+" > "+he.len)}function ue(he){this.buf=he,this.pos=0,this.len=he.length}var se=typeof Uint8Array<"u"?function(_e){if(_e instanceof Uint8Array||Array.isArray(_e))return new ue(_e);throw Error("illegal buffer")}:function(_e){if(Array.isArray(_e))return new ue(_e);throw Error("illegal buffer")},ie=function(){return Y.Buffer?function(ge){return(ue.create=function(Re){return Y.Buffer.isBuffer(Re)?new X(Re):se(Re)})(ge)}:se};ue.create=ie(),ue.prototype._slice=Y.Array.prototype.subarray||Y.Array.prototype.slice,ue.prototype.uint32=function(){var _e=4294967295;return function(){if(_e=(this.buf[this.pos]&127)>>>0,this.buf[this.pos++]<128||(_e=(_e|(this.buf[this.pos]&127)<<7)>>>0,this.buf[this.pos++]<128)||(_e=(_e|(this.buf[this.pos]&127)<<14)>>>0,this.buf[this.pos++]<128)||(_e=(_e|(this.buf[this.pos]&127)<<21)>>>0,this.buf[this.pos++]<128)||(_e=(_e|(this.buf[this.pos]&15)<<28)>>>0,this.buf[this.pos++]<128))return _e;if((this.pos+=5)>this.len)throw this.pos=this.len,te(this,10);return _e}}(),ue.prototype.int32=function(){return this.uint32()|0},ue.prototype.sint32=function(){var _e=this.uint32();return _e>>>1^-(_e&1)|0};function t(){var he=new ee(0,0),_e=0;if(this.len-this.pos>4){for(;_e<4;++_e)if(he.lo=(he.lo|(this.buf[this.pos]&127)<<_e*7)>>>0,this.buf[this.pos++]<128)return he;if(he.lo=(he.lo|(this.buf[this.pos]&127)<<28)>>>0,he.hi=(he.hi|(this.buf[this.pos]&127)>>4)>>>0,this.buf[this.pos++]<128)return he;_e=0}else{for(;_e<3;++_e){if(this.pos>=this.len)throw te(this);if(he.lo=(he.lo|(this.buf[this.pos]&127)<<_e*7)>>>0,this.buf[this.pos++]<128)return he}return he.lo=(he.lo|(this.buf[this.pos++]&127)<<_e*7)>>>0,he}if(this.len-this.pos>4){for(;_e<5;++_e)if(he.hi=(he.hi|(this.buf[this.pos]&127)<<_e*7+3)>>>0,this.buf[this.pos++]<128)return he}else for(;_e<5;++_e){if(this.pos>=this.len)throw te(this);if(he.hi=(he.hi|(this.buf[this.pos]&127)<<_e*7+3)>>>0,this.buf[this.pos++]<128)return he}throw Error("invalid varint encoding")}ue.prototype.bool=function(){return this.uint32()!==0};function H(he,_e){return(he[_e-4]|he[_e-3]<<8|he[_e-2]<<16|he[_e-1]<<24)>>>0}ue.prototype.fixed32=function(){if(this.pos+4>this.len)throw te(this,4);return H(this.buf,this.pos+=4)},ue.prototype.sfixed32=function(){if(this.pos+4>this.len)throw te(this,4);return H(this.buf,this.pos+=4)|0};function ae(){if(this.pos+8>this.len)throw te(this,8);return new ee(H(this.buf,this.pos+=4),H(this.buf,this.pos+=4))}return ue.prototype.float=function(){if(this.pos+4>this.len)throw te(this,4);var _e=Y.float.readFloatLE(this.buf,this.pos);return this.pos+=4,_e},ue.prototype.double=function(){if(this.pos+8>this.len)throw te(this,4);var _e=Y.float.readDoubleLE(this.buf,this.pos);return this.pos+=8,_e},ue.prototype.bytes=function(){var _e=this.uint32(),ge=this.pos,xe=this.pos+_e;if(xe>this.len)throw te(this,_e);if(this.pos+=_e,Array.isArray(this.buf))return this.buf.slice(ge,xe);if(ge===xe){var Re=Y.Buffer;return Re?Re.alloc(0):new this.buf.constructor(0)}return this._slice.call(this.buf,ge,xe)},ue.prototype.string=function(){var _e=this.bytes();return ne.read(_e,0,_e.length)},ue.prototype.skip=function(_e){if(typeof _e=="number"){if(this.pos+_e>this.len)throw te(this,_e);this.pos+=_e}else do if(this.pos>=this.len)throw te(this);while(this.buf[this.pos++]&128);return this},ue.prototype.skipType=function(he){switch(he){case 0:this.skip();break;case 1:this.skip(8);break;case 2:this.skip(this.uint32());break;case 3:for(;(he=this.uint32()&7)!==4;)this.skipType(he);break;case 5:this.skip(4);break;default:throw Error("invalid wire type "+he+" at offset "+this.pos)}return this},ue._configure=function(he){X=he,ue.create=ie(),X._configure();var _e=Y.Long?"toLong":"toNumber";Y.merge(ue.prototype,{int64:function(){return t.call(this)[_e](!1)},uint64:function(){return t.call(this)[_e](!0)},sint64:function(){return t.call(this).zzDecode()[_e](!1)},fixed64:function(){return ae.call(this)[_e](!0)},sfixed64:function(){return ae.call(this)[_e](!1)}})},reader}var reader_buffer,hasRequiredReader_buffer;function requireReader_buffer(){if(hasRequiredReader_buffer)return reader_buffer;hasRequiredReader_buffer=1,reader_buffer=ee;var Y=requireReader();(ee.prototype=Object.create(Y.prototype)).constructor=ee;var X=requireMinimal$1();function ee(ne){Y.call(this,ne)}return ee._configure=function(){X.Buffer&&(ee.prototype._slice=X.Buffer.prototype.slice)},ee.prototype.string=function(){var te=this.uint32();return this.buf.utf8Slice?this.buf.utf8Slice(this.pos,this.pos=Math.min(this.pos+te,this.len)):this.buf.toString("utf-8",this.pos,this.pos=Math.min(this.pos+te,this.len))},ee._configure(),reader_buffer}var rpc={},service,hasRequiredService;function requireService(){if(hasRequiredService)return service;hasRequiredService=1,service=X;var Y=requireMinimal$1();(X.prototype=Object.create(Y.EventEmitter.prototype)).constructor=X;function X(ee,ne,te){if(typeof ee!="function")throw TypeError("rpcImpl must be a function");Y.EventEmitter.call(this),this.rpcImpl=ee,this.requestDelimited=!!ne,this.responseDelimited=!!te}return X.prototype.rpcCall=function ee(ne,te,ue,se,ie){if(!se)throw TypeError("request must be specified");var t=this;if(!ie)return Y.asPromise(ee,t,ne,te,ue,se);if(!t.rpcImpl){setTimeout(function(){ie(Error("already ended"))},0);return}try{return t.rpcImpl(ne,te[t.requestDelimited?"encodeDelimited":"encode"](se).finish(),function(ae,he){if(ae)return t.emit("error",ae,ne),ie(ae);if(he===null){t.end(!0);return}if(!(he instanceof ue))try{he=ue[t.responseDelimited?"decodeDelimited":"decode"](he)}catch(_e){return t.emit("error",_e,ne),ie(_e)}return t.emit("data",he,ne),ie(null,he)})}catch(H){t.emit("error",H,ne),setTimeout(function(){ie(H)},0);return}},X.prototype.end=function(ne){return this.rpcImpl&&(ne||this.rpcImpl(null,null,null),this.rpcImpl=null,this.emit("end").off()),this},service}var hasRequiredRpc;function requireRpc(){return hasRequiredRpc||(hasRequiredRpc=1,function(Y){var X=Y;X.Service=requireService()}(rpc)),rpc}var roots,hasRequiredRoots;function requireRoots(){return hasRequiredRoots||(hasRequiredRoots=1,roots={}),roots}var hasRequiredIndexMinimal;function requireIndexMinimal(){return hasRequiredIndexMinimal||(hasRequiredIndexMinimal=1,function(Y){var X=Y;X.build="minimal",X.Writer=requireWriter(),X.BufferWriter=requireWriter_buffer(),X.Reader=requireReader(),X.BufferReader=requireReader_buffer(),X.util=requireMinimal$1(),X.rpc=requireRpc(),X.roots=requireRoots(),X.configure=ee;function ee(){X.util._configure(),X.Writer._configure(X.BufferWriter),X.Reader._configure(X.BufferReader)}ee()}(indexMinimal)),indexMinimal}var minimal,hasRequiredMinimal;function requireMinimal(){return hasRequiredMinimal||(hasRequiredMinimal=1,minimal=requireIndexMinimal()),minimal}var gtfsRealtime_pbf,hasRequiredGtfsRealtime_pbf;function requireGtfsRealtime_pbf(){if(hasRequiredGtfsRealtime_pbf)return gtfsRealtime_pbf;hasRequiredGtfsRealtime_pbf=1;var Y=requireMinimal(),X=Y.Reader,ee=Y.Writer,ne=Y.util,te=Y.roots.default||(Y.roots.default={});return te.transit_realtime=function(){var ue={};return ue.FeedMessage=function(){function se(ie){if(this.entity=[],ie)for(var t=Object.keys(ie),H=0;H<t.length;++H)ie[t[H]]!=null&&(this[t[H]]=ie[t[H]])}return se.prototype.header=null,se.prototype.entity=ne.emptyArray,se.create=function(t){return new se(t)},se.encode=function(t,H){if(H||(H=ee.create()),te.transit_realtime.FeedHeader.encode(t.header,H.uint32(10).fork()).ldelim(),t.entity!=null&&t.entity.length)for(var ae=0;ae<t.entity.length;++ae)te.transit_realtime.FeedEntity.encode(t.entity[ae],H.uint32(18).fork()).ldelim();return H},se.encodeDelimited=function(t,H){return this.encode(t,H).ldelim()},se.decode=function(t,H){t instanceof X||(t=X.create(t));for(var ae=H===void 0?t.len:t.pos+H,he=new te.transit_realtime.FeedMessage;t.pos<ae;){var _e=t.uint32();switch(_e>>>3){case 1:{he.header=te.transit_realtime.FeedHeader.decode(t,t.uint32());break}case 2:{he.entity&&he.entity.length||(he.entity=[]),he.entity.push(te.transit_realtime.FeedEntity.decode(t,t.uint32()));break}default:t.skipType(_e&7);break}}if(!he.hasOwnProperty("header"))throw ne.ProtocolError("missing required 'header'",{instance:he});return he},se.decodeDelimited=function(t){return t instanceof X||(t=new X(t)),this.decode(t,t.uint32())},se.verify=function(t){if(typeof t!="object"||t===null)return"object expected";{var H=te.transit_realtime.FeedHeader.verify(t.header);if(H)return"header."+H}if(t.entity!=null&&t.hasOwnProperty("entity")){if(!Array.isArray(t.entity))return"entity: array expected";for(var ae=0;ae<t.entity.length;++ae){var H=te.transit_realtime.FeedEntity.verify(t.entity[ae]);if(H)return"entity."+H}}return null},se.fromObject=function(t){if(t instanceof te.transit_realtime.FeedMessage)return t;var H=new te.transit_realtime.FeedMessage;if(t.header!=null){if(typeof t.header!="object")throw TypeError(".transit_realtime.FeedMessage.header: object expected");H.header=te.transit_realtime.FeedHeader.fromObject(t.header)}if(t.entity){if(!Array.isArray(t.entity))throw TypeError(".transit_realtime.FeedMessage.entity: array expected");H.entity=[];for(var ae=0;ae<t.entity.length;++ae){if(typeof t.entity[ae]!="object")throw TypeError(".transit_realtime.FeedMessage.entity: object expected");H.entity[ae]=te.transit_realtime.FeedEntity.fromObject(t.entity[ae])}}return H},se.toObject=function(t,H){H||(H={});var ae={};if((H.arrays||H.defaults)&&(ae.entity=[]),H.defaults&&(ae.header=null),t.header!=null&&t.hasOwnProperty("header")&&(ae.header=te.transit_realtime.FeedHeader.toObject(t.header,H)),t.entity&&t.entity.length){ae.entity=[];for(var he=0;he<t.entity.length;++he)ae.entity[he]=te.transit_realtime.FeedEntity.toObject(t.entity[he],H)}return ae},se.prototype.toJSON=function(){return this.constructor.toObject(this,Y.util.toJSONOptions)},se.getTypeUrl=function(t){return t===void 0&&(t="type.googleapis.com"),t+"/transit_realtime.FeedMessage"},se}(),ue.FeedHeader=function(){function se(ie){if(ie)for(var t=Object.keys(ie),H=0;H<t.length;++H)ie[t[H]]!=null&&(this[t[H]]=ie[t[H]])}return se.prototype.gtfs_realtime_version="",se.prototype.incrementality=0,se.prototype.timestamp=ne.Long?ne.Long.fromBits(0,0,!0):0,se.prototype.feed_version="",se.create=function(t){return new se(t)},se.encode=function(t,H){return H||(H=ee.create()),H.uint32(10).string(t.gtfs_realtime_version),t.incrementality!=null&&Object.hasOwnProperty.call(t,"incrementality")&&H.uint32(16).int32(t.incrementality),t.timestamp!=null&&Object.hasOwnProperty.call(t,"timestamp")&&H.uint32(24).uint64(t.timestamp),t.feed_version!=null&&Object.hasOwnProperty.call(t,"feed_version")&&H.uint32(34).string(t.feed_version),H},se.encodeDelimited=function(t,H){return this.encode(t,H).ldelim()},se.decode=function(t,H){t instanceof X||(t=X.create(t));for(var ae=H===void 0?t.len:t.pos+H,he=new te.transit_realtime.FeedHeader;t.pos<ae;){var _e=t.uint32();switch(_e>>>3){case 1:{he.gtfs_realtime_version=t.string();break}case 2:{he.incrementality=t.int32();break}case 3:{he.timestamp=t.uint64();break}case 4:{he.feed_version=t.string();break}default:t.skipType(_e&7);break}}if(!he.hasOwnProperty("gtfs_realtime_version"))throw ne.ProtocolError("missing required 'gtfs_realtime_version'",{instance:he});return he},se.decodeDelimited=function(t){return t instanceof X||(t=new X(t)),this.decode(t,t.uint32())},se.verify=function(t){if(typeof t!="object"||t===null)return"object expected";if(!ne.isString(t.gtfs_realtime_version))return"gtfs_realtime_version: string expected";if(t.incrementality!=null&&t.hasOwnProperty("incrementality"))switch(t.incrementality){default:return"incrementality: enum value expected";case 0:case 1:break}return t.timestamp!=null&&t.hasOwnProperty("timestamp")&&!ne.isInteger(t.timestamp)&&!(t.timestamp&&ne.isInteger(t.timestamp.low)&&ne.isInteger(t.timestamp.high))?"timestamp: integer|Long expected":t.feed_version!=null&&t.hasOwnProperty("feed_version")&&!ne.isString(t.feed_version)?"feed_version: string expected":null},se.fromObject=function(t){if(t instanceof te.transit_realtime.FeedHeader)return t;var H=new te.transit_realtime.FeedHeader;switch(t.gtfs_realtime_version!=null&&(H.gtfs_realtime_version=String(t.gtfs_realtime_version)),t.incrementality){default:if(typeof t.incrementality=="number"){H.incrementality=t.incrementality;break}break;case"FULL_DATASET":case 0:H.incrementality=0;break;case"DIFFERENTIAL":case 1:H.incrementality=1;break}return t.timestamp!=null&&(ne.Long?(H.timestamp=ne.Long.fromValue(t.timestamp)).unsigned=!0:typeof t.timestamp=="string"?H.timestamp=parseInt(t.timestamp,10):typeof t.timestamp=="number"?H.timestamp=t.timestamp:typeof t.timestamp=="object"&&(H.timestamp=new ne.LongBits(t.timestamp.low>>>0,t.timestamp.high>>>0).toNumber(!0))),t.feed_version!=null&&(H.feed_version=String(t.feed_version)),H},se.toObject=function(t,H){H||(H={});var ae={};if(H.defaults){if(ae.gtfs_realtime_version="",ae.incrementality=H.enums===String?"FULL_DATASET":0,ne.Long){var he=new ne.Long(0,0,!0);ae.timestamp=H.longs===String?he.toString():H.longs===Number?he.toNumber():he}else ae.timestamp=H.longs===String?"0":0;ae.feed_version=""}return t.gtfs_realtime_version!=null&&t.hasOwnProperty("gtfs_realtime_version")&&(ae.gtfs_realtime_version=t.gtfs_realtime_version),t.incrementality!=null&&t.hasOwnProperty("incrementality")&&(ae.incrementality=H.enums===String?te.transit_realtime.FeedHeader.Incrementality[t.incrementality]===void 0?t.incrementality:te.transit_realtime.FeedHeader.Incrementality[t.incrementality]:t.incrementality),t.timestamp!=null&&t.hasOwnProperty("timestamp")&&(typeof t.timestamp=="number"?ae.timestamp=H.longs===String?String(t.timestamp):t.timestamp:ae.timestamp=H.longs===String?ne.Long.prototype.toString.call(t.timestamp):H.longs===Number?new ne.LongBits(t.timestamp.low>>>0,t.timestamp.high>>>0).toNumber(!0):t.timestamp),t.feed_version!=null&&t.hasOwnProperty("feed_version")&&(ae.feed_version=t.feed_version),ae},se.prototype.toJSON=function(){return this.constructor.toObject(this,Y.util.toJSONOptions)},se.getTypeUrl=function(t){return t===void 0&&(t="type.googleapis.com"),t+"/transit_realtime.FeedHeader"},se.Incrementality=function(){var ie={},t=Object.create(ie);return t[ie[0]="FULL_DATASET"]=0,t[ie[1]="DIFFERENTIAL"]=1,t}(),se}(),ue.FeedEntity=function(){function se(ie){if(ie)for(var t=Object.keys(ie),H=0;H<t.length;++H)ie[t[H]]!=null&&(this[t[H]]=ie[t[H]])}return se.prototype.id="",se.prototype.is_deleted=!1,se.prototype.trip_update=null,se.prototype.vehicle=null,se.prototype.alert=null,se.prototype.shape=null,se.prototype.stop=null,se.prototype.trip_modifications=null,se.create=function(t){return new se(t)},se.encode=function(t,H){return H||(H=ee.create()),H.uint32(10).string(t.id),t.is_deleted!=null&&Object.hasOwnProperty.call(t,"is_deleted")&&H.uint32(16).bool(t.is_deleted),t.trip_update!=null&&Object.hasOwnProperty.call(t,"trip_update")&&te.transit_realtime.TripUpdate.encode(t.trip_update,H.uint32(26).fork()).ldelim(),t.vehicle!=null&&Object.hasOwnProperty.call(t,"vehicle")&&te.transit_realtime.VehiclePosition.encode(t.vehicle,H.uint32(34).fork()).ldelim(),t.alert!=null&&Object.hasOwnProperty.call(t,"alert")&&te.transit_realtime.Alert.encode(t.alert,H.uint32(42).fork()).ldelim(),t.shape!=null&&Object.hasOwnProperty.call(t,"shape")&&te.transit_realtime.Shape.encode(t.shape,H.uint32(50).fork()).ldelim(),t.stop!=null&&Object.hasOwnProperty.call(t,"stop")&&te.transit_realtime.Stop.encode(t.stop,H.uint32(58).fork()).ldelim(),t.trip_modifications!=null&&Object.hasOwnProperty.call(t,"trip_modifications")&&te.transit_realtime.TripModifications.encode(t.trip_modifications,H.uint32(66).fork()).ldelim(),H},se.encodeDelimited=function(t,H){return this.encode(t,H).ldelim()},se.decode=function(t,H){t instanceof X||(t=X.create(t));for(var ae=H===void 0?t.len:t.pos+H,he=new te.transit_realtime.FeedEntity;t.pos<ae;){var _e=t.uint32();switch(_e>>>3){case 1:{he.id=t.string();break}case 2:{he.is_deleted=t.bool();break}case 3:{he.trip_update=te.transit_realtime.TripUpdate.decode(t,t.uint32());break}case 4:{he.vehicle=te.transit_realtime.VehiclePosition.decode(t,t.uint32());break}case 5:{he.alert=te.transit_realtime.Alert.decode(t,t.uint32());break}case 6:{he.shape=te.transit_realtime.Shape.decode(t,t.uint32());break}case 7:{he.stop=te.transit_realtime.Stop.decode(t,t.uint32());break}case 8:{he.trip_modifications=te.transit_realtime.TripModifications.decode(t,t.uint32());break}default:t.skipType(_e&7);break}}if(!he.hasOwnProperty("id"))throw ne.ProtocolError("missing required 'id'",{instance:he});return he},se.decodeDelimited=function(t){return t instanceof X||(t=new X(t)),this.decode(t,t.uint32())},se.verify=function(t){if(typeof t!="object"||t===null)return"object expected";if(!ne.isString(t.id))return"id: string expected";if(t.is_deleted!=null&&t.hasOwnProperty("is_deleted")&&typeof t.is_deleted!="boolean")return"is_deleted: boolean expected";if(t.trip_update!=null&&t.hasOwnProperty("trip_update")){var H=te.transit_realtime.TripUpdate.verify(t.trip_update);if(H)return"trip_update."+H}if(t.vehicle!=null&&t.hasOwnProperty("vehicle")){var H=te.transit_realtime.VehiclePosition.verify(t.vehicle);if(H)return"vehicle."+H}if(t.alert!=null&&t.hasOwnProperty("alert")){var H=te.transit_realtime.Alert.verify(t.alert);if(H)return"alert."+H}if(t.shape!=null&&t.hasOwnProperty("shape")){var H=te.transit_realtime.Shape.verify(t.shape);if(H)return"shape."+H}if(t.stop!=null&&t.hasOwnProperty("stop")){var H=te.transit_realtime.Stop.verify(t.stop);if(H)return"stop."+H}if(t.trip_modifications!=null&&t.hasOwnProperty("trip_modifications")){var H=te.transit_realtime.TripModifications.verify(t.trip_modifications);if(H)return"trip_modifications."+H}return null},se.fromObject=function(t){if(t instanceof te.transit_realtime.FeedEntity)return t;var H=new te.transit_realtime.FeedEntity;if(t.id!=null&&(H.id=String(t.id)),t.is_deleted!=null&&(H.is_deleted=!!t.is_deleted),t.trip_update!=null){if(typeof t.trip_update!="object")throw TypeError(".transit_realtime.FeedEntity.trip_update: object expected");H.trip_update=te.transit_realtime.TripUpdate.fromObject(t.trip_update)}if(t.vehicle!=null){if(typeof t.vehicle!="object")throw TypeError(".transit_realtime.FeedEntity.vehicle: object expected");H.vehicle=te.transit_realtime.VehiclePosition.fromObject(t.vehicle)}if(t.alert!=null){if(typeof t.alert!="object")throw TypeError(".transit_realtime.FeedEntity.alert: object expected");H.alert=te.transit_realtime.Alert.fromObject(t.alert)}if(t.shape!=null){if(typeof t.shape!="object")throw TypeError(".transit_realtime.FeedEntity.shape: object expected");H.shape=te.transit_realtime.Shape.fromObject(t.shape)}if(t.stop!=null){if(typeof t.stop!="object")throw TypeError(".transit_realtime.FeedEntity.stop: object expected");H.stop=te.transit_realtime.Stop.fromObject(t.stop)}if(t.trip_modifications!=null){if(typeof t.trip_modifications!="object")throw TypeError(".transit_realtime.FeedEntity.trip_modifications: object expected");H.trip_modifications=te.transit_realtime.TripModifications.fromObject(t.trip_modifications)}return H},se.toObject=function(t,H){H||(H={});var ae={};return H.defaults&&(ae.id="",ae.is_deleted=!1,ae.trip_update=null,ae.vehicle=null,ae.alert=null,ae.shape=null,ae.stop=null,ae.trip_modifications=null),t.id!=null&&t.hasOwnProperty("id")&&(ae.id=t.id),t.is_deleted!=null&&t.hasOwnProperty("is_deleted")&&(ae.is_deleted=t.is_deleted),t.trip_update!=null&&t.hasOwnProperty("trip_update")&&(ae.trip_update=te.transit_realtime.TripUpdate.toObject(t.trip_update,H)),t.vehicle!=null&&t.hasOwnProperty("vehicle")&&(ae.vehicle=te.transit_realtime.VehiclePosition.toObject(t.vehicle,H)),t.alert!=null&&t.hasOwnProperty("alert")&&(ae.alert=te.transit_realtime.Alert.toObject(t.alert,H)),t.shape!=null&&t.hasOwnProperty("shape")&&(ae.shape=te.transit_realtime.Shape.toObject(t.shape,H)),t.stop!=null&&t.hasOwnProperty("stop")&&(ae.stop=te.transit_realtime.Stop.toObject(t.stop,H)),t.trip_modifications!=null&&t.hasOwnProperty("trip_modifications")&&(ae.trip_modifications=te.transit_realtime.TripModifications.toObject(t.trip_modifications,H)),ae},se.prototype.toJSON=function(){return this.constructor.toObject(this,Y.util.toJSONOptions)},se.getTypeUrl=function(t){return t===void 0&&(t="type.googleapis.com"),t+"/transit_realtime.FeedEntity"},se}(),ue.TripUpdate=function(){function se(ie){if(this.stop_time_update=[],ie)for(var t=Object.keys(ie),H=0;H<t.length;++H)ie[t[H]]!=null&&(this[t[H]]=ie[t[H]])}return se.prototype.trip=null,se.prototype.vehicle=null,se.prototype.stop_time_update=ne.emptyArray,se.prototype.timestamp=ne.Long?ne.Long.fromBits(0,0,!0):0,se.prototype.delay=0,se.prototype.trip_properties=null,se.create=function(t){return new se(t)},se.encode=function(t,H){if(H||(H=ee.create()),te.transit_realtime.TripDescriptor.encode(t.trip,H.uint32(10).fork()).ldelim(),t.stop_time_update!=null&&t.stop_time_update.length)for(var ae=0;ae<t.stop_time_update.length;++ae)te.transit_realtime.TripUpdate.StopTimeUpdate.encode(t.stop_time_update[ae],H.uint32(18).fork()).ldelim();return t.vehicle!=null&&Object.hasOwnProperty.call(t,"vehicle")&&te.transit_realtime.VehicleDescriptor.encode(t.vehicle,H.uint32(26).fork()).ldelim(),t.timestamp!=null&&Object.hasOwnProperty.call(t,"timestamp")&&H.uint32(32).uint64(t.timestamp),t.delay!=null&&Object.hasOwnProperty.call(t,"delay")&&H.uint32(40).int32(t.delay),t.trip_properties!=null&&Object.hasOwnProperty.call(t,"trip_properties")&&te.transit_realtime.TripUpdate.TripProperties.encode(t.trip_properties,H.uint32(50).fork()).ldelim(),H},se.encodeDelimited=function(t,H){return this.encode(t,H).ldelim()},se.decode=function(t,H){t instanceof X||(t=X.create(t));for(var ae=H===void 0?t.len:t.pos+H,he=new te.transit_realtime.TripUpdate;t.pos<ae;){var _e=t.uint32();switch(_e>>>3){case 1:{he.trip=te.transit_realtime.TripDescriptor.decode(t,t.uint32());break}case 3:{he.vehicle=te.transit_realtime.VehicleDescriptor.decode(t,t.uint32());break}case 2:{he.stop_time_update&&he.stop_time_update.length||(he.stop_time_update=[]),he.stop_time_update.push(te.transit_realtime.TripUpdate.StopTimeUpdate.decode(t,t.uint32()));break}case 4:{he.timestamp=t.uint64();break}case 5:{he.delay=t.int32();break}case 6:{he.trip_properties=te.transit_realtime.TripUpdate.TripProperties.decode(t,t.uint32());break}default:t.skipType(_e&7);break}}if(!he.hasOwnProperty("trip"))throw ne.ProtocolError("missing required 'trip'",{instance:he});return he},se.decodeDelimited=function(t){return t instanceof X||(t=new X(t)),this.decode(t,t.uint32())},se.verify=function(t){if(typeof t!="object"||t===null)return"object expected";{var H=te.transit_realtime.TripDescriptor.verify(t.trip);if(H)return"trip."+H}if(t.vehicle!=null&&t.hasOwnProperty("vehicle")){var H=te.transit_realtime.VehicleDescriptor.verify(t.vehicle);if(H)return"vehicle."+H}if(t.stop_time_update!=null&&t.hasOwnProperty("stop_time_update")){if(!Array.isArray(t.stop_time_update))return"stop_time_update: array expected";for(var ae=0;ae<t.stop_time_update.length;++ae){var H=te.transit_realtime.TripUpdate.StopTimeUpdate.verify(t.stop_time_update[ae]);if(H)return"stop_time_update."+H}}if(t.timestamp!=null&&t.hasOwnProperty("timestamp")&&!ne.isInteger(t.timestamp)&&!(t.timestamp&&ne.isInteger(t.timestamp.low)&&ne.isInteger(t.timestamp.high)))return"timestamp: integer|Long expected";if(t.delay!=null&&t.hasOwnProperty("delay")&&!ne.isInteger(t.delay))return"delay: integer expected";if(t.trip_properties!=null&&t.hasOwnProperty("trip_properties")){var H=te.transit_realtime.TripUpdate.TripProperties.verify(t.trip_properties);if(H)return"trip_properties."+H}return null},se.fromObject=function(t){if(t instanceof te.transit_realtime.TripUpdate)return t;var H=new te.transit_realtime.TripUpdate;if(t.trip!=null){if(typeof t.trip!="object")throw TypeError(".transit_realtime.TripUpdate.trip: object expected");H.trip=te.transit_realtime.TripDescriptor.fromObject(t.trip)}if(t.vehicle!=null){if(typeof t.vehicle!="object")throw TypeError(".transit_realtime.TripUpdate.vehicle: object expected");H.vehicle=te.transit_realtime.VehicleDescriptor.fromObject(t.vehicle)}if(t.stop_time_update){if(!Array.isArray(t.stop_time_update))throw TypeError(".transit_realtime.TripUpdate.stop_time_update: array expected");H.stop_time_update=[];for(var ae=0;ae<t.stop_time_update.length;++ae){if(typeof t.stop_time_update[ae]!="object")throw TypeError(".transit_realtime.TripUpdate.stop_time_update: object expected");H.stop_time_update[ae]=te.transit_realtime.TripUpdate.StopTimeUpdate.fromObject(t.stop_time_update[ae])}}if(t.timestamp!=null&&(ne.Long?(H.timestamp=ne.Long.fromValue(t.timestamp)).unsigned=!0:typeof t.timestamp=="string"?H.timestamp=parseInt(t.timestamp,10):typeof t.timestamp=="number"?H.timestamp=t.timestamp:typeof t.timestamp=="object"&&(H.timestamp=new ne.LongBits(t.timestamp.low>>>0,t.timestamp.high>>>0).toNumber(!0))),t.delay!=null&&(H.delay=t.delay|0),t.trip_properties!=null){if(typeof t.trip_properties!="object")throw TypeError(".transit_realtime.TripUpdate.trip_properties: object expected");H.trip_properties=te.transit_realtime.TripUpdate.TripProperties.fromObject(t.trip_properties)}return H},se.toObject=function(t,H){H||(H={});var ae={};if((H.arrays||H.defaults)&&(ae.stop_time_update=[]),H.defaults){if(ae.trip=null,ae.vehicle=null,ne.Long){var he=new ne.Long(0,0,!0);ae.timestamp=H.longs===String?he.toString():H.longs===Number?he.toNumber():he}else ae.timestamp=H.longs===String?"0":0;ae.delay=0,ae.trip_properties=null}if(t.trip!=null&&t.hasOwnProperty("trip")&&(ae.trip=te.transit_realtime.TripDescriptor.toObject(t.trip,H)),t.stop_time_update&&t.stop_time_update.length){ae.stop_time_update=[];for(var _e=0;_e<t.stop_time_update.length;++_e)ae.stop_time_update[_e]=te.transit_realtime.TripUpdate.StopTimeUpdate.toObject(t.stop_time_update[_e],H)}return t.vehicle!=null&&t.hasOwnProperty("vehicle")&&(ae.vehicle=te.transit_realtime.VehicleDescriptor.toObject(t.vehicle,H)),t.timestamp!=null&&t.hasOwnProperty("timestamp")&&(typeof t.timestamp=="number"?ae.timestamp=H.longs===String?String(t.timestamp):t.timestamp:ae.timestamp=H.longs===String?ne.Long.prototype.toString.call(t.timestamp):H.longs===Number?new ne.LongBits(t.timestamp.low>>>0,t.timestamp.high>>>0).toNumber(!0):t.timestamp),t.delay!=null&&t.hasOwnProperty("delay")&&(ae.delay=t.delay),t.trip_properties!=null&&t.hasOwnProperty("trip_properties")&&(ae.trip_properties=te.transit_realtime.TripUpdate.TripProperties.toObject(t.trip_properties,H)),ae},se.prototype.toJSON=function(){return this.constructor.toObject(this,Y.util.toJSONOptions)},se.getTypeUrl=function(t){return t===void 0&&(t="type.googleapis.com"),t+"/transit_realtime.TripUpdate"},se.StopTimeEvent=function(){function ie(t){if(t)for(var H=Object.keys(t),ae=0;ae<H.length;++ae)t[H[ae]]!=null&&(this[H[ae]]=t[H[ae]])}return ie.prototype.delay=0,ie.prototype.time=ne.Long?ne.Long.fromBits(0,0,!1):0,ie.prototype.uncertainty=0,ie.create=function(H){return new ie(H)},ie.encode=function(H,ae){return ae||(ae=ee.create()),H.delay!=null&&Object.hasOwnProperty.call(H,"delay")&&ae.uint32(8).int32(H.delay),H.time!=null&&Object.hasOwnProperty.call(H,"time")&&ae.uint32(16).int64(H.time),H.uncertainty!=null&&Object.hasOwnProperty.call(H,"uncertainty")&&ae.uint32(24).int32(H.uncertainty),ae},ie.encodeDelimited=function(H,ae){return this.encode(H,ae).ldelim()},ie.decode=function(H,ae){H instanceof X||(H=X.create(H));for(var he=ae===void 0?H.len:H.pos+ae,_e=new te.transit_realtime.TripUpdate.StopTimeEvent;H.pos<he;){var ge=H.uint32();switch(ge>>>3){case 1:{_e.delay=H.int32();break}case 2:{_e.time=H.int64();break}case 3:{_e.uncertainty=H.int32();break}default:H.skipType(ge&7);break}}return _e},ie.decodeDelimited=function(H){return H instanceof X||(H=new X(H)),this.decode(H,H.uint32())},ie.verify=function(H){return typeof H!="object"||H===null?"object expected":H.delay!=null&&H.hasOwnProperty("delay")&&!ne.isInteger(H.delay)?"delay: integer expected":H.time!=null&&H.hasOwnProperty("time")&&!ne.isInteger(H.time)&&!(H.time&&ne.isInteger(H.time.low)&&ne.isInteger(H.time.high))?"time: integer|Long expected":H.uncertainty!=null&&H.hasOwnProperty("uncertainty")&&!ne.isInteger(H.uncertainty)?"uncertainty: integer expected":null},ie.fromObject=function(H){if(H instanceof te.transit_realtime.TripUpdate.StopTimeEvent)return H;var ae=new te.transit_realtime.TripUpdate.StopTimeEvent;return H.delay!=null&&(ae.delay=H.delay|0),H.time!=null&&(ne.Long?(ae.time=ne.Long.fromValue(H.time)).unsigned=!1:typeof H.time=="string"?ae.time=parseInt(H.time,10):typeof H.time=="number"?ae.time=H.time:typeof H.time=="object"&&(ae.time=new ne.LongBits(H.time.low>>>0,H.time.high>>>0).toNumber())),H.uncertainty!=null&&(ae.uncertainty=H.uncertainty|0),ae},ie.toObject=function(H,ae){ae||(ae={});var he={};if(ae.defaults){if(he.delay=0,ne.Long){var _e=new ne.Long(0,0,!1);he.time=ae.longs===String?_e.toString():ae.longs===Number?_e.toNumber():_e}else he.time=ae.longs===String?"0":0;he.uncertainty=0}return H.delay!=null&&H.hasOwnProperty("delay")&&(he.delay=H.delay),H.time!=null&&H.hasOwnProperty("time")&&(typeof H.time=="number"?he.time=ae.longs===String?String(H.time):H.time:he.time=ae.longs===String?ne.Long.prototype.toString.call(H.time):ae.longs===Number?new ne.LongBits(H.time.low>>>0,H.time.high>>>0).toNumber():H.time),H.uncertainty!=null&&H.hasOwnProperty("uncertainty")&&(he.uncertainty=H.uncertainty),he},ie.prototype.toJSON=function(){return this.constructor.toObject(this,Y.util.toJSONOptions)},ie.getTypeUrl=function(H){return H===void 0&&(H="type.googleapis.com"),H+"/transit_realtime.TripUpdate.StopTimeEvent"},ie}(),se.StopTimeUpdate=function(){function ie(t){if(t)for(var H=Object.keys(t),ae=0;ae<H.length;++ae)t[H[ae]]!=null&&(this[H[ae]]=t[H[ae]])}return ie.prototype.stop_sequence=0,ie.prototype.stop_id="",ie.prototype.arrival=null,ie.prototype.departure=null,ie.prototype.departure_occupancy_status=0,ie.prototype.schedule_relationship=0,ie.prototype.stop_time_properties=null,ie.create=function(H){return new ie(H)},ie.encode=function(H,ae){return ae||(ae=ee.create()),H.stop_sequence!=null&&Object.hasOwnProperty.call(H,"stop_sequence")&&ae.uint32(8).uint32(H.stop_sequence),H.arrival!=null&&Object.hasOwnProperty.call(H,"arrival")&&te.transit_realtime.TripUpdate.StopTimeEvent.encode(H.arrival,ae.uint32(18).fork()).ldelim(),H.departure!=null&&Object.hasOwnProperty.call(H,"departure")&&te.transit_realtime.TripUpdate.StopTimeEvent.encode(H.departure,ae.uint32(26).fork()).ldelim(),H.stop_id!=null&&Object.hasOwnProperty.call(H,"stop_id")&&ae.uint32(34).string(H.stop_id),H.schedule_relationship!=null&&Object.hasOwnProperty.call(H,"schedule_relationship")&&ae.uint32(40).int32(H.schedule_relationship),H.stop_time_properties!=null&&Object.hasOwnProperty.call(H,"stop_time_properties")&&te.transit_realtime.TripUpdate.StopTimeUpdate.StopTimeProperties.encode(H.stop_time_properties,ae.uint32(50).fork()).ldelim(),H.departure_occupancy_status!=null&&Object.hasOwnProperty.call(H,"departure_occupancy_status")&&ae.uint32(56).int32(H.departure_occupancy_status),ae},ie.encodeDelimited=function(H,ae){return this.encode(H,ae).ldelim()},ie.decode=function(H,ae){H instanceof X||(H=X.create(H));for(var he=ae===void 0?H.len:H.pos+ae,_e=new te.transit_realtime.TripUpdate.StopTimeUpdate;H.pos<he;){var ge=H.uint32();switch(ge>>>3){case 1:{_e.stop_sequence=H.uint32();break}case 4:{_e.stop_id=H.string();break}case 2:{_e.arrival=te.transit_realtime.TripUpdate.StopTimeEvent.decode(H,H.uint32());break}case 3:{_e.departure=te.transit_realtime.TripUpdate.StopTimeEvent.decode(H,H.uint32());break}case 7:{_e.departure_occupancy_status=H.int32();break}case 5:{_e.schedule_relationship=H.int32();break}case 6:{_e.stop_time_properties=te.transit_realtime.TripUpdate.StopTimeUpdate.StopTimeProperties.decode(H,H.uint32());break}default:H.skipType(ge&7);break}}return _e},ie.decodeDelimited=function(H){return H instanceof X||(H=new X(H)),this.decode(H,H.uint32())},ie.verify=function(H){if(typeof H!="object"||H===null)return"object expected";if(H.stop_sequence!=null&&H.hasOwnProperty("stop_sequence")&&!ne.isInteger(H.stop_sequence))return"stop_sequence: integer expected";if(H.stop_id!=null&&H.hasOwnProperty("stop_id")&&!ne.isString(H.stop_id))return"stop_id: string expected";if(H.arrival!=null&&H.hasOwnProperty("arrival")){var ae=te.transit_realtime.TripUpdate.StopTimeEvent.verify(H.arrival);if(ae)return"arrival."+ae}if(H.departure!=null&&H.hasOwnProperty("departure")){var ae=te.transit_realtime.TripUpdate.StopTimeEvent.verify(H.departure);if(ae)return"departure."+ae}if(H.departure_occupancy_status!=null&&H.hasOwnProperty("departure_occupancy_status"))switch(H.departure_occupancy_status){default:return"departure_occupancy_status: enum value expected";case 0:case 1:case 2:case 3:case 4:case 5:case 6:case 7:case 8:break}if(H.schedule_relationship!=null&&H.hasOwnProperty("schedule_relationship"))switch(H.schedule_relationship){default:return"schedule_relationship: enum value expected";case 0:case 1:case 2:case 3:break}if(H.stop_time_properties!=null&&H.hasOwnProperty("stop_time_properties")){var ae=te.transit_realtime.TripUpdate.StopTimeUpdate.StopTimeProperties.verify(H.stop_time_properties);if(ae)return"stop_time_properties."+ae}return null},ie.fromObject=function(H){if(H instanceof te.transit_realtime.TripUpdate.StopTimeUpdate)return H;var ae=new te.transit_realtime.TripUpdate.StopTimeUpdate;if(H.stop_sequence!=null&&(ae.stop_sequence=H.stop_sequence>>>0),H.stop_id!=null&&(ae.stop_id=String(H.stop_id)),H.arrival!=null){if(typeof H.arrival!="object")throw TypeError(".transit_realtime.TripUpdate.StopTimeUpdate.arrival: object expected");ae.arrival=te.transit_realtime.TripUpdate.StopTimeEvent.fromObject(H.arrival)}if(H.departure!=null){if(typeof H.departure!="object")throw TypeError(".transit_realtime.TripUpdate.StopTimeUpdate.departure: object expected");ae.departure=te.transit_realtime.TripUpdate.StopTimeEvent.fromObject(H.departure)}switch(H.departure_occupancy_status){default:if(typeof H.departure_occupancy_status=="number"){ae.departure_occupancy_status=H.departure_occupancy_status;break}break;case"EMPTY":case 0:ae.departure_occupancy_status=0;break;case"MANY_SEATS_AVAILABLE":case 1:ae.departure_occupancy_status=1;break;case"FEW_SEATS_AVAILABLE":case 2:ae.departure_occupancy_status=2;break;case"STANDING_ROOM_ONLY":case 3:ae.departure_occupancy_status=3;break;case"CRUSHED_STANDING_ROOM_ONLY":case 4:ae.departure_occupancy_status=4;break;case"FULL":case 5:ae.departure_occupancy_status=5;break;case"NOT_ACCEPTING_PASSENGERS":case 6:ae.departure_occupancy_status=6;break;case"NO_DATA_AVAILABLE":case 7:ae.departure_occupancy_status=7;break;case"NOT_BOARDABLE":case 8:ae.departure_occupancy_status=8;break}switch(H.schedule_relationship){default:if(typeof H.schedule_relationship=="number"){ae.schedule_relationship=H.schedule_relationship;break}break;case"SCHEDULED":case 0:ae.schedule_relationship=0;break;case"SKIPPED":case 1:ae.schedule_relationship=1;break;case"NO_DATA":case 2:ae.schedule_relationship=2;break;case"UNSCHEDULED":case 3:ae.schedule_relationship=3;break}if(H.stop_time_properties!=null){if(typeof H.stop_time_properties!="object")throw TypeError(".transit_realtime.TripUpdate.StopTimeUpdate.stop_time_properties: object expected");ae.stop_time_properties=te.transit_realtime.TripUpdate.StopTimeUpdate.StopTimeProperties.fromObject(H.stop_time_properties)}return ae},ie.toObject=function(H,ae){ae||(ae={});var he={};return ae.defaults&&(he.stop_sequence=0,he.arrival=null,he.departure=null,he.stop_id="",he.schedule_relationship=ae.enums===String?"SCHEDULED":0,he.stop_time_properties=null,he.departure_occupancy_status=ae.enums===String?"EMPTY":0),H.stop_sequence!=null&&H.hasOwnProperty("stop_sequence")&&(he.stop_sequence=H.stop_sequence),H.arrival!=null&&H.hasOwnProperty("arrival")&&(he.arrival=te.transit_realtime.TripUpdate.StopTimeEvent.toObject(H.arrival,ae)),H.departure!=null&&H.hasOwnProperty("departure")&&(he.departure=te.transit_realtime.TripUpdate.StopTimeEvent.toObject(H.departure,ae)),H.stop_id!=null&&H.hasOwnProperty("stop_id")&&(he.stop_id=H.stop_id),H.schedule_relationship!=null&&H.hasOwnProperty("schedule_relationship")&&(he.schedule_relationship=ae.enums===String?te.transit_realtime.TripUpdate.StopTimeUpdate.ScheduleRelationship[H.schedule_relationship]===void 0?H.schedule_relationship:te.transit_realtime.TripUpdate.StopTimeUpdate.ScheduleRelationship[H.schedule_relationship]:H.schedule_relationship),H.stop_time_properties!=null&&H.hasOwnProperty("stop_time_properties")&&(he.stop_time_properties=te.transit_realtime.TripUpdate.StopTimeUpdate.StopTimeProperties.toObject(H.stop_time_properties,ae)),H.departure_occupancy_status!=null&&H.hasOwnProperty("departure_occupancy_status")&&(he.departure_occupancy_status=ae.enums===String?te.transit_realtime.VehiclePosition.OccupancyStatus[H.departure_occupancy_status]===void 0?H.departure_occupancy_status:te.transit_realtime.VehiclePosition.OccupancyStatus[H.departure_occupancy_status]:H.departure_occupancy_status),he},ie.prototype.toJSON=function(){return this.constructor.toObject(this,Y.util.toJSONOptions)},ie.getTypeUrl=function(H){return H===void 0&&(H="type.googleapis.com"),H+"/transit_realtime.TripUpdate.StopTimeUpdate"},ie.ScheduleRelationship=function(){var t={},H=Object.create(t);return H[t[0]="SCHEDULED"]=0,H[t[1]="SKIPPED"]=1,H[t[2]="NO_DATA"]=2,H[t[3]="UNSCHEDULED"]=3,H}(),ie.StopTimeProperties=function(){function t(H){if(H)for(var ae=Object.keys(H),he=0;he<ae.length;++he)H[ae[he]]!=null&&(this[ae[he]]=H[ae[he]])}return t.prototype.assigned_stop_id="",t.create=function(ae){return new t(ae)},t.encode=function(ae,he){return he||(he=ee.create()),ae.assigned_stop_id!=null&&Object.hasOwnProperty.call(ae,"assigned_stop_id")&&he.uint32(10).string(ae.assigned_stop_id),he},t.encodeDelimited=function(ae,he){return this.encode(ae,he).ldelim()},t.decode=function(ae,he){ae instanceof X||(ae=X.create(ae));for(var _e=he===void 0?ae.len:ae.pos+he,ge=new te.transit_realtime.TripUpdate.StopTimeUpdate.StopTimeProperties;ae.pos<_e;){var xe=ae.uint32();switch(xe>>>3){case 1:{ge.assigned_stop_id=ae.string();break}default:ae.skipType(xe&7);break}}return ge},t.decodeDelimited=function(ae){return ae instanceof X||(ae=new X(ae)),this.decode(ae,ae.uint32())},t.verify=function(ae){return typeof ae!="object"||ae===null?"object expected":ae.assigned_stop_id!=null&&ae.hasOwnProperty("assigned_stop_id")&&!ne.isString(ae.assigned_stop_id)?"assigned_stop_id: string expected":null},t.fromObject=function(ae){if(ae instanceof te.transit_realtime.TripUpdate.StopTimeUpdate.StopTimeProperties)return ae;var he=new te.transit_realtime.TripUpdate.StopTimeUpdate.StopTimeProperties;return ae.assigned_stop_id!=null&&(he.assigned_stop_id=String(ae.assigned_stop_id)),he},t.toObject=function(ae,he){he||(he={});var _e={};return he.defaults&&(_e.assigned_stop_id=""),ae.assigned_stop_id!=null&&ae.hasOwnProperty("assigned_stop_id")&&(_e.assigned_stop_id=ae.assigned_stop_id),_e},t.prototype.toJSON=function(){return this.constructor.toObject(this,Y.util.toJSONOptions)},t.getTypeUrl=function(ae){return ae===void 0&&(ae="type.googleapis.com"),ae+"/transit_realtime.TripUpdate.StopTimeUpdate.StopTimeProperties"},t}(),ie}(),se.TripProperties=function(){function ie(t){if(t)for(var H=Object.keys(t),ae=0;ae<H.length;++ae)t[H[ae]]!=null&&(this[H[ae]]=t[H[ae]])}return ie.prototype.trip_id="",ie.prototype.start_date="",ie.prototype.start_time="",ie.prototype.shape_id="",ie.create=function(H){return new ie(H)},ie.encode=function(H,ae){return ae||(ae=ee.create()),H.trip_id!=null&&Object.hasOwnProperty.call(H,"trip_id")&&ae.uint32(10).string(H.trip_id),H.start_date!=null&&Object.hasOwnProperty.call(H,"start_date")&&ae.uint32(18).string(H.start_date),H.start_time!=null&&Object.hasOwnProperty.call(H,"start_time")&&ae.uint32(26).string(H.start_time),H.shape_id!=null&&Object.hasOwnProperty.call(H,"shape_id")&&ae.uint32(34).string(H.shape_id),ae},ie.encodeDelimited=function(H,ae){return this.encode(H,ae).ldelim()},ie.decode=function(H,ae){H instanceof X||(H=X.create(H));for(var he=ae===void 0?H.len:H.pos+ae,_e=new te.transit_realtime.TripUpdate.TripProperties;H.pos<he;){var ge=H.uint32();switch(ge>>>3){case 1:{_e.trip_id=H.string();break}case 2:{_e.start_date=H.string();break}case 3:{_e.start_time=H.string();break}case 4:{_e.shape_id=H.string();break}default:H.skipType(ge&7);break}}return _e},ie.decodeDelimited=function(H){return H instanceof X||(H=new X(H)),this.decode(H,H.uint32())},ie.verify=function(H){return typeof H!="object"||H===null?"object expected":H.trip_id!=null&&H.hasOwnProperty("trip_id")&&!ne.isString(H.trip_id)?"trip_id: string expected":H.start_date!=null&&H.hasOwnProperty("start_date")&&!ne.isString(H.start_date)?"start_date: string expected":H.start_time!=null&&H.hasOwnProperty("start_time")&&!ne.isString(H.start_time)?"start_time: string expected":H.shape_id!=null&&H.hasOwnProperty("shape_id")&&!ne.isString(H.shape_id)?"shape_id: string expected":null},ie.fromObject=function(H){if(H instanceof te.transit_realtime.TripUpdate.TripProperties)return H;var ae=new te.transit_realtime.TripUpdate.TripProperties;return H.trip_id!=null&&(ae.trip_id=String(H.trip_id)),H.start_date!=null&&(ae.start_date=String(H.start_date)),H.start_time!=null&&(ae.start_time=String(H.start_time)),H.shape_id!=null&&(ae.shape_id=String(H.shape_id)),ae},ie.toObject=function(H,ae){ae||(ae={});var he={};return ae.defaults&&(he.trip_id="",he.start_date="",he.start_time="",he.shape_id=""),H.trip_id!=null&&H.hasOwnProperty("trip_id")&&(he.trip_id=H.trip_id),H.start_date!=null&&H.hasOwnProperty("start_date")&&(he.start_date=H.start_date),H.start_time!=null&&H.hasOwnProperty("start_time")&&(he.start_time=H.start_time),H.shape_id!=null&&H.hasOwnProperty("shape_id")&&(he.shape_id=H.shape_id),he},ie.prototype.toJSON=function(){return this.constructor.toObject(this,Y.util.toJSONOptions)},ie.getTypeUrl=function(H){return H===void 0&&(H="type.googleapis.com"),H+"/transit_realtime.TripUpdate.TripProperties"},ie}(),se}(),ue.VehiclePosition=function(){function se(ie){if(this.multi_carriage_details=[],ie)for(var t=Object.keys(ie),H=0;H<t.length;++H)ie[t[H]]!=null&&(this[t[H]]=ie[t[H]])}return se.prototype.trip=null,se.prototype.vehicle=null,se.prototype.position=null,se.prototype.current_stop_sequence=0,se.prototype.stop_id="",se.prototype.current_status=2,se.prototype.timestamp=ne.Long?ne.Long.fromBits(0,0,!0):0,se.prototype.congestion_level=0,se.prototype.occupancy_status=0,se.prototype.occupancy_percentage=0,se.prototype.multi_carriage_details=ne.emptyArray,se.create=function(t){return new se(t)},se.encode=function(t,H){if(H||(H=ee.create()),t.trip!=null&&Object.hasOwnProperty.call(t,"trip")&&te.transit_realtime.TripDescriptor.encode(t.trip,H.uint32(10).fork()).ldelim(),t.position!=null&&Object.hasOwnProperty.call(t,"position")&&te.transit_realtime.Position.encode(t.position,H.uint32(18).fork()).ldelim(),t.current_stop_sequence!=null&&Object.hasOwnProperty.call(t,"current_stop_sequence")&&H.uint32(24).uint32(t.current_stop_sequence),t.current_status!=null&&Object.hasOwnProperty.call(t,"current_status")&&H.uint32(32).int32(t.current_status),t.timestamp!=null&&Object.hasOwnProperty.call(t,"timestamp")&&H.uint32(40).uint64(t.timestamp),t.congestion_level!=null&&Object.hasOwnProperty.call(t,"congestion_level")&&H.uint32(48).int32(t.congestion_level),t.stop_id!=null&&Object.hasOwnProperty.call(t,"stop_id")&&H.uint32(58).string(t.stop_id),t.vehicle!=null&&Object.hasOwnProperty.call(t,"vehicle")&&te.transit_realtime.VehicleDescriptor.encode(t.vehicle,H.uint32(66).fork()).ldelim(),t.occupancy_status!=null&&Object.hasOwnProperty.call(t,"occupancy_status")&&H.uint32(72).int32(t.occupancy_status),t.occupancy_percentage!=null&&Object.hasOwnProperty.call(t,"occupancy_percentage")&&H.uint32(80).uint32(t.occupancy_percentage),t.multi_carriage_details!=null&&t.multi_carriage_details.length)for(var ae=0;ae<t.multi_carriage_details.length;++ae)te.transit_realtime.VehiclePosition.CarriageDetails.encode(t.multi_carriage_details[ae],H.uint32(90).fork()).ldelim();return H},se.encodeDelimited=function(t,H){return this.encode(t,H).ldelim()},se.decode=function(t,H){t instanceof X||(t=X.create(t));for(var ae=H===void 0?t.len:t.pos+H,he=new te.transit_realtime.VehiclePosition;t.pos<ae;){var _e=t.uint32();switch(_e>>>3){case 1:{he.trip=te.transit_realtime.TripDescriptor.decode(t,t.uint32());break}case 8:{he.vehicle=te.transit_realtime.VehicleDescriptor.decode(t,t.uint32());break}case 2:{he.position=te.transit_realtime.Position.decode(t,t.uint32());break}case 3:{he.current_stop_sequence=t.uint32();break}case 7:{he.stop_id=t.string();break}case 4:{he.current_status=t.int32();break}case 5:{he.timestamp=t.uint64();break}case 6:{he.congestion_level=t.int32();break}case 9:{he.occupancy_status=t.int32();break}case 10:{he.occupancy_percentage=t.uint32();break}case 11:{he.multi_carriage_details&&he.multi_carriage_details.length||(he.multi_carriage_details=[]),he.multi_carriage_details.push(te.transit_realtime.VehiclePosition.CarriageDetails.decode(t,t.uint32()));break}default:t.skipType(_e&7);break}}return he},se.decodeDelimited=function(t){return t instanceof X||(t=new X(t)),this.decode(t,t.uint32())},se.verify=function(t){if(typeof t!="object"||t===null)return"object expected";if(t.trip!=null&&t.hasOwnProperty("trip")){var H=te.transit_realtime.TripDescriptor.verify(t.trip);if(H)return"trip."+H}if(t.vehicle!=null&&t.hasOwnProperty("vehicle")){var H=te.transit_realtime.VehicleDescriptor.verify(t.vehicle);if(H)return"vehicle."+H}if(t.position!=null&&t.hasOwnProperty("position")){var H=te.transit_realtime.Position.verify(t.position);if(H)return"position."+H}if(t.current_stop_sequence!=null&&t.hasOwnProperty("current_stop_sequence")&&!ne.isInteger(t.current_stop_sequence))return"current_stop_sequence: integer expected";if(t.stop_id!=null&&t.hasOwnProperty("stop_id")&&!ne.isString(t.stop_id))return"stop_id: string expected";if(t.current_status!=null&&t.hasOwnProperty("current_status"))switch(t.current_status){default:return"current_status: enum value expected";case 0:case 1:case 2:break}if(t.timestamp!=null&&t.hasOwnProperty("timestamp")&&!ne.isInteger(t.timestamp)&&!(t.timestamp&&ne.isInteger(t.timestamp.low)&&ne.isInteger(t.timestamp.high)))return"timestamp: integer|Long expected";if(t.congestion_level!=null&&t.hasOwnProperty("congestion_level"))switch(t.congestion_level){default:return"congestion_level: enum value expected";case 0:case 1:case 2:case 3:case 4:break}if(t.occupancy_status!=null&&t.hasOwnProperty("occupancy_status"))switch(t.occupancy_status){default:return"occupancy_status: enum value expected";case 0:case 1:case 2:case 3:case 4:case 5:case 6:case 7:case 8:break}if(t.occupancy_percentage!=null&&t.hasOwnProperty("occupancy_percentage")&&!ne.isInteger(t.occupancy_percentage))return"occupancy_percentage: integer expected";if(t.multi_carriage_details!=null&&t.hasOwnProperty("multi_carriage_details")){if(!Array.isArray(t.multi_carriage_details))return"multi_carriage_details: array expected";for(var ae=0;ae<t.multi_carriage_details.length;++ae){var H=te.transit_realtime.VehiclePosition.CarriageDetails.verify(t.multi_carriage_details[ae]);if(H)return"multi_carriage_details."+H}}return null},se.fromObject=function(t){if(t instanceof te.transit_realtime.VehiclePosition)return t;var H=new te.transit_realtime.VehiclePosition;if(t.trip!=null){if(typeof t.trip!="object")throw TypeError(".transit_realtime.VehiclePosition.trip: object expected");H.trip=te.transit_realtime.TripDescriptor.fromObject(t.trip)}if(t.vehicle!=null){if(typeof t.vehicle!="object")throw TypeError(".transit_realtime.VehiclePosition.vehicle: object expected");H.vehicle=te.transit_realtime.VehicleDescriptor.fromObject(t.vehicle)}if(t.position!=null){if(typeof t.position!="object")throw TypeError(".transit_realtime.VehiclePosition.position: object expected");H.position=te.transit_realtime.Position.fromObject(t.position)}switch(t.current_stop_sequence!=null&&(H.current_stop_sequence=t.current_stop_sequence>>>0),t.stop_id!=null&&(H.stop_id=String(t.stop_id)),t.current_status){case"INCOMING_AT":case 0:H.current_status=0;break;case"STOPPED_AT":case 1:H.current_status=1;break;default:if(typeof t.current_status=="number"){H.current_status=t.current_status;break}break;case"IN_TRANSIT_TO":case 2:H.current_status=2;break}switch(t.timestamp!=null&&(ne.Long?(H.timestamp=ne.Long.fromValue(t.timestamp)).unsigned=!0:typeof t.timestamp=="string"?H.timestamp=parseInt(t.timestamp,10):typeof t.timestamp=="number"?H.timestamp=t.timestamp:typeof t.timestamp=="object"&&(H.timestamp=new ne.LongBits(t.timestamp.low>>>0,t.timestamp.high>>>0).toNumber(!0))),t.congestion_level){default:if(typeof t.congestion_level=="number"){H.congestion_level=t.congestion_level;break}break;case"UNKNOWN_CONGESTION_LEVEL":case 0:H.congestion_level=0;break;case"RUNNING_SMOOTHLY":case 1:H.congestion_level=1;break;case"STOP_AND_GO":case 2:H.congestion_level=2;break;case"CONGESTION":case 3:H.congestion_level=3;break;case"SEVERE_CONGESTION":case 4:H.congestion_level=4;break}switch(t.occupancy_status){default:if(typeof t.occupancy_status=="number"){H.occupancy_status=t.occupancy_status;break}break;case"EMPTY":case 0:H.occupancy_status=0;break;case"MANY_SEATS_AVAILABLE":case 1:H.occupancy_status=1;break;case"FEW_SEATS_AVAILABLE":case 2:H.occupancy_status=2;break;case"STANDING_ROOM_ONLY":case 3:H.occupancy_status=3;break;case"CRUSHED_STANDING_ROOM_ONLY":case 4:H.occupancy_status=4;break;case"FULL":case 5:H.occupancy_status=5;break;case"NOT_ACCEPTING_PASSENGERS":case 6:H.occupancy_status=6;break;case"NO_DATA_AVAILABLE":case 7:H.occupancy_status=7;break;case"NOT_BOARDABLE":case 8:H.occupancy_status=8;break}if(t.occupancy_percentage!=null&&(H.occupancy_percentage=t.occupancy_percentage>>>0),t.multi_carriage_details){if(!Array.isArray(t.multi_carriage_details))throw TypeError(".transit_realtime.VehiclePosition.multi_carriage_details: array expected");H.multi_carriage_details=[];for(var ae=0;ae<t.multi_carriage_details.length;++ae){if(typeof t.multi_carriage_details[ae]!="object")throw TypeError(".transit_realtime.VehiclePosition.multi_carriage_details: object expected");H.multi_carriage_details[ae]=te.transit_realtime.VehiclePosition.CarriageDetails.fromObject(t.multi_carriage_details[ae])}}return H},se.toObject=function(t,H){H||(H={});var ae={};if((H.arrays||H.defaults)&&(ae.multi_carriage_details=[]),H.defaults){if(ae.trip=null,ae.position=null,ae.current_stop_sequence=0,ae.current_status=H.enums===String?"IN_TRANSIT_TO":2,ne.Long){var he=new ne.Long(0,0,!0);ae.timestamp=H.longs===String?he.toString():H.longs===Number?he.toNumber():he}else ae.timestamp=H.longs===String?"0":0;ae.congestion_level=H.enums===String?"UNKNOWN_CONGESTION_LEVEL":0,ae.stop_id="",ae.vehicle=null,ae.occupancy_status=H.enums===String?"EMPTY":0,ae.occupancy_percentage=0}if(t.trip!=null&&t.hasOwnProperty("trip")&&(ae.trip=te.transit_realtime.TripDescriptor.toObject(t.trip,H)),t.position!=null&&t.hasOwnProperty("position")&&(ae.position=te.transit_realtime.Position.toObject(t.position,H)),t.current_stop_sequence!=null&&t.hasOwnProperty("current_stop_sequence")&&(ae.current_stop_sequence=t.current_stop_sequence),t.current_status!=null&&t.hasOwnProperty("current_status")&&(ae.current_status=H.enums===String?te.transit_realtime.VehiclePosition.VehicleStopStatus[t.current_status]===void 0?t.current_status:te.transit_realtime.VehiclePosition.VehicleStopStatus[t.current_status]:t.current_status),t.timestamp!=null&&t.hasOwnProperty("timestamp")&&(typeof t.timestamp=="number"?ae.timestamp=H.longs===String?String(t.timestamp):t.timestamp:ae.timestamp=H.longs===String?ne.Long.prototype.toString.call(t.timestamp):H.longs===Number?new ne.LongBits(t.timestamp.low>>>0,t.timestamp.high>>>0).toNumber(!0):t.timestamp),t.congestion_level!=null&&t.hasOwnProperty("congestion_level")&&(ae.congestion_level=H.enums===String?te.transit_realtime.VehiclePosition.CongestionLevel[t.congestion_level]===void 0?t.congestion_level:te.transit_realtime.VehiclePosition.CongestionLevel[t.congestion_level]:t.congestion_level),t.stop_id!=null&&t.hasOwnProperty("stop_id")&&(ae.stop_id=t.stop_id),t.vehicle!=null&&t.hasOwnProperty("vehicle")&&(ae.vehicle=te.transit_realtime.VehicleDescriptor.toObject(t.vehicle,H)),t.occupancy_status!=null&&t.hasOwnProperty("occupancy_status")&&(ae.occupancy_status=H.enums===String?te.transit_realtime.VehiclePosition.OccupancyStatus[t.occupancy_status]===void 0?t.occupancy_status:te.transit_realtime.VehiclePosition.OccupancyStatus[t.occupancy_status]:t.occupancy_status),t.occupancy_percentage!=null&&t.hasOwnProperty("occupancy_percentage")&&(ae.occupancy_percentage=t.occupancy_percentage),t.multi_carriage_details&&t.multi_carriage_details.length){ae.multi_carriage_details=[];for(var _e=0;_e<t.multi_carriage_details.length;++_e)ae.multi_carriage_details[_e]=te.transit_realtime.VehiclePosition.CarriageDetails.toObject(t.multi_carriage_details[_e],H)}return ae},se.prototype.toJSON=function(){return this.constructor.toObject(this,Y.util.toJSONOptions)},se.getTypeUrl=function(t){return t===void 0&&(t="type.googleapis.com"),t+"/transit_realtime.VehiclePosition"},se.VehicleStopStatus=function(){var ie={},t=Object.create(ie);return t[ie[0]="INCOMING_AT"]=0,t[ie[1]="STOPPED_AT"]=1,t[ie[2]="IN_TRANSIT_TO"]=2,t}(),se.CongestionLevel=function(){var ie={},t=Object.create(ie);return t[ie[0]="UNKNOWN_CONGESTION_LEVEL"]=0,t[ie[1]="RUNNING_SMOOTHLY"]=1,t[ie[2]="STOP_AND_GO"]=2,t[ie[3]="CONGESTION"]=3,t[ie[4]="SEVERE_CONGESTION"]=4,t}(),se.OccupancyStatus=function(){var ie={},t=Object.create(ie);return t[ie[0]="EMPTY"]=0,t[ie[1]="MANY_SEATS_AVAILABLE"]=1,t[ie[2]="FEW_SEATS_AVAILABLE"]=2,t[ie[3]="STANDING_ROOM_ONLY"]=3,t[ie[4]="CRUSHED_STANDING_ROOM_ONLY"]=4,t[ie[5]="FULL"]=5,t[ie[6]="NOT_ACCEPTING_PASSENGERS"]=6,t[ie[7]="NO_DATA_AVAILABLE"]=7,t[ie[8]="NOT_BOARDABLE"]=8,t}(),se.CarriageDetails=function(){function ie(t){if(t)for(var H=Object.keys(t),ae=0;ae<H.length;++ae)t[H[ae]]!=null&&(this[H[ae]]=t[H[ae]])}return ie.prototype.id="",ie.prototype.label="",ie.prototype.occupancy_status=7,ie.prototype.occupancy_percentage=-1,ie.prototype.carriage_sequence=0,ie.create=function(H){return new ie(H)},ie.encode=function(H,ae){return ae||(ae=ee.create()),H.id!=null&&Object.hasOwnProperty.call(H,"id")&&ae.uint32(10).string(H.id),H.label!=null&&Object.hasOwnProperty.call(H,"label")&&ae.uint32(18).string(H.label),H.occupancy_status!=null&&Object.hasOwnProperty.call(H,"occupancy_status")&&ae.uint32(24).int32(H.occupancy_status),H.occupancy_percentage!=null&&Object.hasOwnProperty.call(H,"occupancy_percentage")&&ae.uint32(32).int32(H.occupancy_percentage),H.carriage_sequence!=null&&Object.hasOwnProperty.call(H,"carriage_sequence")&&ae.uint32(40).uint32(H.carriage_sequence),ae},ie.encodeDelimited=function(H,ae){return this.encode(H,ae).ldelim()},ie.decode=function(H,ae){H instanceof X||(H=X.create(H));for(var he=ae===void 0?H.len:H.pos+ae,_e=new te.transit_realtime.VehiclePosition.CarriageDetails;H.pos<he;){var ge=H.uint32();switch(ge>>>3){case 1:{_e.id=H.string();break}case 2:{_e.label=H.string();break}case 3:{_e.occupancy_status=H.int32();break}case 4:{_e.occupancy_percentage=H.int32();break}case 5:{_e.carriage_sequence=H.uint32();break}default:H.skipType(ge&7);break}}return _e},ie.decodeDelimited=function(H){return H instanceof X||(H=new X(H)),this.decode(H,H.uint32())},ie.verify=function(H){if(typeof H!="object"||H===null)return"object expected";if(H.id!=null&&H.hasOwnProperty("id")&&!ne.isString(H.id))return"id: string expected";if(H.label!=null&&H.hasOwnProperty("label")&&!ne.isString(H.label))return"label: string expected";if(H.occupancy_status!=null&&H.hasOwnProperty("occupancy_status"))switch(H.occupancy_status){default:return"occupancy_status: enum value expected";case 0:case 1:case 2:case 3:case 4:case 5:case 6:case 7:case 8:break}return H.occupancy_percentage!=null&&H.hasOwnProperty("occupancy_percentage")&&!ne.isInteger(H.occupancy_percentage)?"occupancy_percentage: integer expected":H.carriage_sequence!=null&&H.hasOwnProperty("carriage_sequence")&&!ne.isInteger(H.carriage_sequence)?"carriage_sequence: integer expected":null},ie.fromObject=function(H){if(H instanceof te.transit_realtime.VehiclePosition.CarriageDetails)return H;var ae=new te.transit_realtime.VehiclePosition.CarriageDetails;switch(H.id!=null&&(ae.id=String(H.id)),H.label!=null&&(ae.label=String(H.label)),H.occupancy_status){case"EMPTY":case 0:ae.occupancy_status=0;break;case"MANY_SEATS_AVAILABLE":case 1:ae.occupancy_status=1;break;case"FEW_SEATS_AVAILABLE":case 2:ae.occupancy_status=2;break;case"STANDING_ROOM_ONLY":case 3:ae.occupancy_status=3;break;case"CRUSHED_STANDING_ROOM_ONLY":case 4:ae.occupancy_status=4;break;case"FULL":case 5:ae.occupancy_status=5;break;case"NOT_ACCEPTING_PASSENGERS":case 6:ae.occupancy_status=6;break;default:if(typeof H.occupancy_status=="number"){ae.occupancy_status=H.occupancy_status;break}break;case"NO_DATA_AVAILABLE":case 7:ae.occupancy_status=7;break;case"NOT_BOARDABLE":case 8:ae.occupancy_status=8;break}return H.occupancy_percentage!=null&&(ae.occupancy_percentage=H.occupancy_percentage|0),H.carriage_sequence!=null&&(ae.carriage_sequence=H.carriage_sequence>>>0),ae},ie.toObject=function(H,ae){ae||(ae={});var he={};return ae.defaults&&(he.id="",he.label="",he.occupancy_status=ae.enums===String?"NO_DATA_AVAILABLE":7,he.occupancy_percentage=-1,he.carriage_sequence=0),H.id!=null&&H.hasOwnProperty("id")&&(he.id=H.id),H.label!=null&&H.hasOwnProperty("label")&&(he.label=H.label),H.occupancy_status!=null&&H.hasOwnProperty("occupancy_status")&&(he.occupancy_status=ae.enums===String?te.transit_realtime.VehiclePosition.OccupancyStatus[H.occupancy_status]===void 0?H.occupancy_status:te.transit_realtime.VehiclePosition.OccupancyStatus[H.occupancy_status]:H.occupancy_status),H.occupancy_percentage!=null&&H.hasOwnProperty("occupancy_percentage")&&(he.occupancy_percentage=H.occupancy_percentage),H.carriage_sequence!=null&&H.hasOwnProperty("carriage_sequence")&&(he.carriage_sequence=H.carriage_sequence),he},ie.prototype.toJSON=function(){return this.constructor.toObject(this,Y.util.toJSONOptions)},ie.getTypeUrl=function(H){return H===void 0&&(H="type.googleapis.com"),H+"/transit_realtime.VehiclePosition.CarriageDetails"},ie}(),se}(),ue.Alert=function(){function se(ie){if(this.active_period=[],this.informed_entity=[],ie)for(var t=Object.keys(ie),H=0;H<t.length;++H)ie[t[H]]!=null&&(this[t[H]]=ie[t[H]])}return se.prototype.active_period=ne.emptyArray,se.prototype.informed_entity=ne.emptyArray,se.prototype.cause=1,se.prototype.effect=8,se.prototype.url=null,se.prototype.header_text=null,se.prototype.description_text=null,se.prototype.tts_header_text=null,se.prototype.tts_description_text=null,se.prototype.severity_level=1,se.prototype.image=null,se.prototype.image_alternative_text=null,se.prototype.cause_detail=null,se.prototype.effect_detail=null,se.create=function(t){return new se(t)},se.encode=function(t,H){if(H||(H=ee.create()),t.active_period!=null&&t.active_period.length)for(var ae=0;ae<t.active_period.length;++ae)te.transit_realtime.TimeRange.encode(t.active_period[ae],H.uint32(10).fork()).ldelim();if(t.informed_entity!=null&&t.informed_entity.length)for(var ae=0;ae<t.informed_entity.length;++ae)te.transit_realtime.EntitySelector.encode(t.informed_entity[ae],H.uint32(42).fork()).ldelim();return t.cause!=null&&Object.hasOwnProperty.call(t,"cause")&&H.uint32(48).int32(t.cause),t.effect!=null&&Object.hasOwnProperty.call(t,"effect")&&H.uint32(56).int32(t.effect),t.url!=null&&Object.hasOwnProperty.call(t,"url")&&te.transit_realtime.TranslatedString.encode(t.url,H.uint32(66).fork()).ldelim(),t.header_text!=null&&Object.hasOwnProperty.call(t,"header_text")&&te.transit_realtime.TranslatedString.encode(t.header_text,H.uint32(82).fork()).ldelim(),t.description_text!=null&&Object.hasOwnProperty.call(t,"description_text")&&te.transit_realtime.TranslatedString.encode(t.description_text,H.uint32(90).fork()).ldelim(),t.tts_header_text!=null&&Object.hasOwnProperty.call(t,"tts_header_text")&&te.transit_realtime.TranslatedString.encode(t.tts_header_text,H.uint32(98).fork()).ldelim(),t.tts_description_text!=null&&Object.hasOwnProperty.call(t,"tts_description_text")&&te.transit_realtime.TranslatedString.encode(t.tts_description_text,H.uint32(106).fork()).ldelim(),t.severity_level!=null&&Object.hasOwnProperty.call(t,"severity_level")&&H.uint32(112).int32(t.severity_level),t.image!=null&&Object.hasOwnProperty.call(t,"image")&&te.transit_realtime.TranslatedImage.encode(t.image,H.uint32(122).fork()).ldelim(),t.image_alternative_text!=null&&Object.hasOwnProperty.call(t,"image_alternative_text")&&te.transit_realtime.TranslatedString.encode(t.image_alternative_text,H.uint32(130).fork()).ldelim(),t.cause_detail!=null&&Object.hasOwnProperty.call(t,"cause_detail")&&te.transit_realtime.TranslatedString.encode(t.cause_detail,H.uint32(138).fork()).ldelim(),t.effect_detail!=null&&Object.hasOwnProperty.call(t,"effect_detail")&&te.transit_realtime.TranslatedString.encode(t.effect_detail,H.uint32(146).fork()).ldelim(),H},se.encodeDelimited=function(t,H){return this.encode(t,H).ldelim()},se.decode=function(t,H){t instanceof X||(t=X.create(t));for(var ae=H===void 0?t.len:t.pos+H,he=new te.transit_realtime.Alert;t.pos<ae;){var _e=t.uint32();switch(_e>>>3){case 1:{he.active_period&&he.active_period.length||(he.active_period=[]),he.active_period.push(te.transit_realtime.TimeRange.decode(t,t.uint32()));break}case 5:{he.informed_entity&&he.informed_entity.length||(he.informed_entity=[]),he.informed_entity.push(te.transit_realtime.EntitySelector.decode(t,t.uint32()));break}case 6:{he.cause=t.int32();break}case 7:{he.effect=t.int32();break}case 8:{he.url=te.transit_realtime.TranslatedString.decode(t,t.uint32());break}case 10:{he.header_text=te.transit_realtime.TranslatedString.decode(t,t.uint32());break}case 11:{he.description_text=te.transit_realtime.TranslatedString.decode(t,t.uint32());break}case 12:{he.tts_header_text=te.transit_realtime.TranslatedString.decode(t,t.uint32());break}case 13:{he.tts_description_text=te.transit_realtime.TranslatedString.decode(t,t.uint32());break}case 14:{he.severity_level=t.int32();break}case 15:{he.image=te.transit_realtime.TranslatedImage.decode(t,t.uint32());break}case 16:{he.image_alternative_text=te.transit_realtime.TranslatedString.decode(t,t.uint32());break}case 17:{he.cause_detail=te.transit_realtime.TranslatedString.decode(t,t.uint32());break}case 18:{he.effect_detail=te.transit_realtime.TranslatedString.decode(t,t.uint32());break}default:t.skipType(_e&7);break}}return he},se.decodeDelimited=function(t){return t instanceof X||(t=new X(t)),this.decode(t,t.uint32())},se.verify=function(t){if(typeof t!="object"||t===null)return"object expected";if(t.active_period!=null&&t.hasOwnProperty("active_period")){if(!Array.isArray(t.active_period))return"active_period: array expected";for(var H=0;H<t.active_period.length;++H){var ae=te.transit_realtime.TimeRange.verify(t.active_period[H]);if(ae)return"active_period."+ae}}if(t.informed_entity!=null&&t.hasOwnProperty("informed_entity")){if(!Array.isArray(t.informed_entity))return"informed_entity: array expected";for(var H=0;H<t.informed_entity.length;++H){var ae=te.transit_realtime.EntitySelector.verify(t.informed_entity[H]);if(ae)return"informed_entity."+ae}}if(t.cause!=null&&t.hasOwnProperty("cause"))switch(t.cause){default:return"cause: enum value expected";case 1:case 2:case 3:case 4:case 5:case 6:case 7:case 8:case 9:case 10:case 11:case 12:break}if(t.effect!=null&&t.hasOwnProperty("effect"))switch(t.effect){default:return"effect: enum value expected";case 1:case 2:case 3:case 4:case 5:case 6:case 7:case 8:case 9:case 10:case 11:break}if(t.url!=null&&t.hasOwnProperty("url")){var ae=te.transit_realtime.TranslatedString.verify(t.url);if(ae)return"url."+ae}if(t.header_text!=null&&t.hasOwnProperty("header_text")){var ae=te.transit_realtime.TranslatedString.verify(t.header_text);if(ae)return"header_text."+ae}if(t.description_text!=null&&t.hasOwnProperty("description_text")){var ae=te.transit_realtime.TranslatedString.verify(t.description_text);if(ae)return"description_text."+ae}if(t.tts_header_text!=null&&t.hasOwnProperty("tts_header_text")){var ae=te.transit_realtime.TranslatedString.verify(t.tts_header_text);if(ae)return"tts_header_text."+ae}if(t.tts_description_text!=null&&t.hasOwnProperty("tts_description_text")){var ae=te.transit_realtime.TranslatedString.verify(t.tts_description_text);if(ae)return"tts_description_text."+ae}if(t.severity_level!=null&&t.hasOwnProperty("severity_level"))switch(t.severity_level){default:return"severity_level: enum value expected";case 1:case 2:case 3:case 4:break}if(t.image!=null&&t.hasOwnProperty("image")){var ae=te.transit_realtime.TranslatedImage.verify(t.image);if(ae)return"image."+ae}if(t.image_alternative_text!=null&&t.hasOwnProperty("image_alternative_text")){var ae=te.transit_realtime.TranslatedString.verify(t.image_alternative_text);if(ae)return"image_alternative_text."+ae}if(t.cause_detail!=null&&t.hasOwnProperty("cause_detail")){var ae=te.transit_realtime.TranslatedString.verify(t.cause_detail);if(ae)return"cause_detail."+ae}if(t.effect_detail!=null&&t.hasOwnProperty("effect_detail")){var ae=te.transit_realtime.TranslatedString.verify(t.effect_detail);if(ae)return"effect_detail."+ae}return null},se.fromObject=function(t){if(t instanceof te.transit_realtime.Alert)return t;var H=new te.transit_realtime.Alert;if(t.active_period){if(!Array.isArray(t.active_period))throw TypeError(".transit_realtime.Alert.active_period: array expected");H.active_period=[];for(var ae=0;ae<t.active_period.length;++ae){if(typeof t.active_period[ae]!="object")throw TypeError(".transit_realtime.Alert.active_period: object expected");H.active_period[ae]=te.transit_realtime.TimeRange.fromObject(t.active_period[ae])}}if(t.informed_entity){if(!Array.isArray(t.informed_entity))throw TypeError(".transit_realtime.Alert.informed_entity: array expected");H.informed_entity=[];for(var ae=0;ae<t.informed_entity.length;++ae){if(typeof t.informed_entity[ae]!="object")throw TypeError(".transit_realtime.Alert.informed_entity: object expected");H.informed_entity[ae]=te.transit_realtime.EntitySelector.fromObject(t.informed_entity[ae])}}switch(t.cause){default:if(typeof t.cause=="number"){H.cause=t.cause;break}break;case"UNKNOWN_CAUSE":case 1:H.cause=1;break;case"OTHER_CAUSE":case 2:H.cause=2;break;case"TECHNICAL_PROBLEM":case 3:H.cause=3;break;case"STRIKE":case 4:H.cause=4;break;case"DEMONSTRATION":case 5:H.cause=5;break;case"ACCIDENT":case 6:H.cause=6;break;case"HOLIDAY":case 7:H.cause=7;break;case"WEATHER":case 8:H.cause=8;break;case"MAINTENANCE":case 9:H.cause=9;break;case"CONSTRUCTION":case 10:H.cause=10;break;case"POLICE_ACTIVITY":case 11:H.cause=11;break;case"MEDICAL_EMERGENCY":case 12:H.cause=12;break}switch(t.effect){case"NO_SERVICE":case 1:H.effect=1;break;case"REDUCED_SERVICE":case 2:H.effect=2;break;case"SIGNIFICANT_DELAYS":case 3:H.effect=3;break;case"DETOUR":case 4:H.effect=4;break;case"ADDITIONAL_SERVICE":case 5:H.effect=5;break;case"MODIFIED_SERVICE":case 6:H.effect=6;break;case"OTHER_EFFECT":case 7:H.effect=7;break;default:if(typeof t.effect=="number"){H.effect=t.effect;break}break;case"UNKNOWN_EFFECT":case 8:H.effect=8;break;case"STOP_MOVED":case 9:H.effect=9;break;case"NO_EFFECT":case 10:H.effect=10;break;case"ACCESSIBILITY_ISSUE":case 11:H.effect=11;break}if(t.url!=null){if(typeof t.url!="object")throw TypeError(".transit_realtime.Alert.url: object expected");H.url=te.transit_realtime.TranslatedString.fromObject(t.url)}if(t.header_text!=null){if(typeof t.header_text!="object")throw TypeError(".transit_realtime.Alert.header_text: object expected");H.header_text=te.transit_realtime.TranslatedString.fromObject(t.header_text)}if(t.description_text!=null){if(typeof t.description_text!="object")throw TypeError(".transit_realtime.Alert.description_text: object expected");H.description_text=te.transit_realtime.TranslatedString.fromObject(t.description_text)}if(t.tts_header_text!=null){if(typeof t.tts_header_text!="object")throw TypeError(".transit_realtime.Alert.tts_header_text: object expected");H.tts_header_text=te.transit_realtime.TranslatedString.fromObject(t.tts_header_text)}if(t.tts_description_text!=null){if(typeof t.tts_description_text!="object")throw TypeError(".transit_realtime.Alert.tts_description_text: object expected");H.tts_description_text=te.transit_realtime.TranslatedString.fromObject(t.tts_description_text)}switch(t.severity_level){default:if(typeof t.severity_level=="number"){H.severity_level=t.severity_level;break}break;case"UNKNOWN_SEVERITY":case 1:H.severity_level=1;break;case"INFO":case 2:H.severity_level=2;break;case"WARNING":case 3:H.severity_level=3;break;case"SEVERE":case 4:H.severity_level=4;break}if(t.image!=null){if(typeof t.image!="object")throw TypeError(".transit_realtime.Alert.image: object expected");H.image=te.transit_realtime.TranslatedImage.fromObject(t.image)}if(t.image_alternative_text!=null){if(typeof t.image_alternative_text!="object")throw TypeError(".transit_realtime.Alert.image_alternative_text: object expected");H.image_alternative_text=te.transit_realtime.TranslatedString.fromObject(t.image_alternative_text)}if(t.cause_detail!=null){if(typeof t.cause_detail!="object")throw TypeError(".transit_realtime.Alert.cause_detail: object expected");H.cause_detail=te.transit_realtime.TranslatedString.fromObject(t.cause_detail)}if(t.effect_detail!=null){if(typeof t.effect_detail!="object")throw TypeError(".transit_realtime.Alert.effect_detail: object expected");H.effect_detail=te.transit_realtime.TranslatedString.fromObject(t.effect_detail)}return H},se.toObject=function(t,H){H||(H={});var ae={};if((H.arrays||H.defaults)&&(ae.active_period=[],ae.informed_entity=[]),H.defaults&&(ae.cause=H.enums===String?"UNKNOWN_CAUSE":1,ae.effect=H.enums===String?"UNKNOWN_EFFECT":8,ae.url=null,ae.header_text=null,ae.description_text=null,ae.tts_header_text=null,ae.tts_description_text=null,ae.severity_level=H.enums===String?"UNKNOWN_SEVERITY":1,ae.image=null,ae.image_alternative_text=null,ae.cause_detail=null,ae.effect_detail=null),t.active_period&&t.active_period.length){ae.active_period=[];for(var he=0;he<t.active_period.length;++he)ae.active_period[he]=te.transit_realtime.TimeRange.toObject(t.active_period[he],H)}if(t.informed_entity&&t.informed_entity.length){ae.informed_entity=[];for(var he=0;he<t.informed_entity.length;++he)ae.informed_entity[he]=te.transit_realtime.EntitySelector.toObject(t.informed_entity[he],H)}return t.cause!=null&&t.hasOwnProperty("cause")&&(ae.cause=H.enums===String?te.transit_realtime.Alert.Cause[t.cause]===void 0?t.cause:te.transit_realtime.Alert.Cause[t.cause]:t.cause),t.effect!=null&&t.hasOwnProperty("effect")&&(ae.effect=H.enums===String?te.transit_realtime.Alert.Effect[t.effect]===void 0?t.effect:te.transit_realtime.Alert.Effect[t.effect]:t.effect),t.url!=null&&t.hasOwnProperty("url")&&(ae.url=te.transit_realtime.TranslatedString.toObject(t.url,H)),t.header_text!=null&&t.hasOwnProperty("header_text")&&(ae.header_text=te.transit_realtime.TranslatedString.toObject(t.header_text,H)),t.description_text!=null&&t.hasOwnProperty("description_text")&&(ae.description_text=te.transit_realtime.TranslatedString.toObject(t.description_text,H)),t.tts_header_text!=null&&t.hasOwnProperty("tts_header_text")&&(ae.tts_header_text=te.transit_realtime.TranslatedString.toObject(t.tts_header_text,H)),t.tts_description_text!=null&&t.hasOwnProperty("tts_description_text")&&(ae.tts_description_text=te.transit_realtime.TranslatedString.toObject(t.tts_description_text,H)),t.severity_level!=null&&t.hasOwnProperty("severity_level")&&(ae.severity_level=H.enums===String?te.transit_realtime.Alert.SeverityLevel[t.severity_level]===void 0?t.severity_level:te.transit_realtime.Alert.SeverityLevel[t.severity_level]:t.severity_level),t.image!=null&&t.hasOwnProperty("image")&&(ae.image=te.transit_realtime.TranslatedImage.toObject(t.image,H)),t.image_alternative_text!=null&&t.hasOwnProperty("image_alternative_text")&&(ae.image_alternative_text=te.transit_realtime.TranslatedString.toObject(t.image_alternative_text,H)),t.cause_detail!=null&&t.hasOwnProperty("cause_detail")&&(ae.cause_detail=te.transit_realtime.TranslatedString.toObject(t.cause_detail,H)),t.effect_detail!=null&&t.hasOwnProperty("effect_detail")&&(ae.effect_detail=te.transit_realtime.TranslatedString.toObject(t.effect_detail,H)),ae},se.prototype.toJSON=function(){return this.constructor.toObject(this,Y.util.toJSONOptions)},se.getTypeUrl=function(t){return t===void 0&&(t="type.googleapis.com"),t+"/transit_realtime.Alert"},se.Cause=function(){var ie={},t=Object.create(ie);return t[ie[1]="UNKNOWN_CAUSE"]=1,t[ie[2]="OTHER_CAUSE"]=2,t[ie[3]="TECHNICAL_PROBLEM"]=3,t[ie[4]="STRIKE"]=4,t[ie[5]="DEMONSTRATION"]=5,t[ie[6]="ACCIDENT"]=6,t[ie[7]="HOLIDAY"]=7,t[ie[8]="WEATHER"]=8,t[ie[9]="MAINTENANCE"]=9,t[ie[10]="CONSTRUCTION"]=10,t[ie[11]="POLICE_ACTIVITY"]=11,t[ie[12]="MEDICAL_EMERGENCY"]=12,t}(),se.Effect=function(){var ie={},t=Object.create(ie);return t[ie[1]="NO_SERVICE"]=1,t[ie[2]="REDUCED_SERVICE"]=2,t[ie[3]="SIGNIFICANT_DELAYS"]=3,t[ie[4]="DETOUR"]=4,t[ie[5]="ADDITIONAL_SERVICE"]=5,t[ie[6]="MODIFIED_SERVICE"]=6,t[ie[7]="OTHER_EFFECT"]=7,t[ie[8]="UNKNOWN_EFFECT"]=8,t[ie[9]="STOP_MOVED"]=9,t[ie[10]="NO_EFFECT"]=10,t[ie[11]="ACCESSIBILITY_ISSUE"]=11,t}(),se.SeverityLevel=function(){var ie={},t=Object.create(ie);return t[ie[1]="UNKNOWN_SEVERITY"]=1,t[ie[2]="INFO"]=2,t[ie[3]="WARNING"]=3,t[ie[4]="SEVERE"]=4,t}(),se}(),ue.TimeRange=function(){function se(ie){if(ie)for(var t=Object.keys(ie),H=0;H<t.length;++H)ie[t[H]]!=null&&(this[t[H]]=ie[t[H]])}return se.prototype.start=ne.Long?ne.Long.fromBits(0,0,!0):0,se.prototype.end=ne.Long?ne.Long.fromBits(0,0,!0):0,se.create=function(t){return new se(t)},se.encode=function(t,H){return H||(H=ee.create()),t.start!=null&&Object.hasOwnProperty.call(t,"start")&&H.uint32(8).uint64(t.start),t.end!=null&&Object.hasOwnProperty.call(t,"end")&&H.uint32(16).uint64(t.end),H},se.encodeDelimited=function(t,H){return this.encode(t,H).ldelim()},se.decode=function(t,H){t instanceof X||(t=X.create(t));for(var ae=H===void 0?t.len:t.pos+H,he=new te.transit_realtime.TimeRange;t.pos<ae;){var _e=t.uint32();switch(_e>>>3){case 1:{he.start=t.uint64();break}case 2:{he.end=t.uint64();break}default:t.skipType(_e&7);break}}return he},se.decodeDelimited=function(t){return t instanceof X||(t=new X(t)),this.decode(t,t.uint32())},se.verify=function(t){return typeof t!="object"||t===null?"object expected":t.start!=null&&t.hasOwnProperty("start")&&!ne.isInteger(t.start)&&!(t.start&&ne.isInteger(t.start.low)&&ne.isInteger(t.start.high))?"start: integer|Long expected":t.end!=null&&t.hasOwnProperty("end")&&!ne.isInteger(t.end)&&!(t.end&&ne.isInteger(t.end.low)&&ne.isInteger(t.end.high))?"end: integer|Long expected":null},se.fromObject=function(t){if(t instanceof te.transit_realtime.TimeRange)return t;var H=new te.transit_realtime.TimeRange;return t.start!=null&&(ne.Long?(H.start=ne.Long.fromValue(t.start)).unsigned=!0:typeof t.start=="string"?H.start=parseInt(t.start,10):typeof t.start=="number"?H.start=t.start:typeof t.start=="object"&&(H.start=new ne.LongBits(t.start.low>>>0,t.start.high>>>0).toNumber(!0))),t.end!=null&&(ne.Long?(H.end=ne.Long.fromValue(t.end)).unsigned=!0:typeof t.end=="string"?H.end=parseInt(t.end,10):typeof t.end=="number"?H.end=t.end:typeof t.end=="object"&&(H.end=new ne.LongBits(t.end.low>>>0,t.end.high>>>0).toNumber(!0))),H},se.toObject=function(t,H){H||(H={});var ae={};if(H.defaults){if(ne.Long){var he=new ne.Long(0,0,!0);ae.start=H.longs===String?he.toString():H.longs===Number?he.toNumber():he}else ae.start=H.longs===String?"0":0;if(ne.Long){var he=new ne.Long(0,0,!0);ae.end=H.longs===String?he.toString():H.longs===Number?he.toNumber():he}else ae.end=H.longs===String?"0":0}return t.start!=null&&t.hasOwnProperty("start")&&(typeof t.start=="number"?ae.start=H.longs===String?String(t.start):t.start:ae.start=H.longs===String?ne.Long.prototype.toString.call(t.start):H.longs===Number?new ne.LongBits(t.start.low>>>0,t.start.high>>>0).toNumber(!0):t.start),t.end!=null&&t.hasOwnProperty("end")&&(typeof t.end=="number"?ae.end=H.longs===String?String(t.end):t.end:ae.end=H.longs===String?ne.Long.prototype.toString.call(t.end):H.longs===Number?new ne.LongBits(t.end.low>>>0,t.end.high>>>0).toNumber(!0):t.end),ae},se.prototype.toJSON=function(){return this.constructor.toObject(this,Y.util.toJSONOptions)},se.getTypeUrl=function(t){return t===void 0&&(t="type.googleapis.com"),t+"/transit_realtime.TimeRange"},se}(),ue.Position=function(){function se(ie){if(ie)for(var t=Object.keys(ie),H=0;H<t.length;++H)ie[t[H]]!=null&&(this[t[H]]=ie[t[H]])}return se.prototype.latitude=0,se.prototype.longitude=0,se.prototype.bearing=0,se.prototype.odometer=0,se.prototype.speed=0,se.create=function(t){return new se(t)},se.encode=function(t,H){return H||(H=ee.create()),H.uint32(13).float(t.latitude),H.uint32(21).float(t.longitude),t.bearing!=null&&Object.hasOwnProperty.call(t,"bearing")&&H.uint32(29).float(t.bearing),t.odometer!=null&&Object.hasOwnProperty.call(t,"odometer")&&H.uint32(33).double(t.odometer),t.speed!=null&&Object.hasOwnProperty.call(t,"speed")&&H.uint32(45).float(t.speed),H},se.encodeDelimited=function(t,H){return this.encode(t,H).ldelim()},se.decode=function(t,H){t instanceof X||(t=X.create(t));for(var ae=H===void 0?t.len:t.pos+H,he=new te.transit_realtime.Position;t.pos<ae;){var _e=t.uint32();switch(_e>>>3){case 1:{he.latitude=t.float();break}case 2:{he.longitude=t.float();break}case 3:{he.bearing=t.float();break}case 4:{he.odometer=t.double();break}case 5:{he.speed=t.float();break}default:t.skipType(_e&7);break}}if(!he.hasOwnProperty("latitude"))throw ne.ProtocolError("missing required 'latitude'",{instance:he});if(!he.hasOwnProperty("longitude"))throw ne.ProtocolError("missing required 'longitude'",{instance:he});return he},se.decodeDelimited=function(t){return t instanceof X||(t=new X(t)),this.decode(t,t.uint32())},se.verify=function(t){return typeof t!="object"||t===null?"object expected":typeof t.latitude!="number"?"latitude: number expected":typeof t.longitude!="number"?"longitude: number expected":t.bearing!=null&&t.hasOwnProperty("bearing")&&typeof t.bearing!="number"?"bearing: number expected":t.odometer!=null&&t.hasOwnProperty("odometer")&&typeof t.odometer!="number"?"odometer: number expected":t.speed!=null&&t.hasOwnProperty("speed")&&typeof t.speed!="number"?"speed: number expected":null},se.fromObject=function(t){if(t instanceof te.transit_realtime.Position)return t;var H=new te.transit_realtime.Position;return t.latitude!=null&&(H.latitude=Number(t.latitude)),t.longitude!=null&&(H.longitude=Number(t.longitude)),t.bearing!=null&&(H.bearing=Number(t.bearing)),t.odometer!=null&&(H.odometer=Number(t.odometer)),t.speed!=null&&(H.speed=Number(t.speed)),H},se.toObject=function(t,H){H||(H={});var ae={};return H.defaults&&(ae.latitude=0,ae.longitude=0,ae.bearing=0,ae.odometer=0,ae.speed=0),t.latitude!=null&&t.hasOwnProperty("latitude")&&(ae.latitude=H.json&&!isFinite(t.latitude)?String(t.latitude):t.latitude),t.longitude!=null&&t.hasOwnProperty("longitude")&&(ae.longitude=H.json&&!isFinite(t.longitude)?String(t.longitude):t.longitude),t.bearing!=null&&t.hasOwnProperty("bearing")&&(ae.bearing=H.json&&!isFinite(t.bearing)?String(t.bearing):t.bearing),t.odometer!=null&&t.hasOwnProperty("odometer")&&(ae.odometer=H.json&&!isFinite(t.odometer)?String(t.odometer):t.odometer),t.speed!=null&&t.hasOwnProperty("speed")&&(ae.speed=H.json&&!isFinite(t.speed)?String(t.speed):t.speed),ae},se.prototype.toJSON=function(){return this.constructor.toObject(this,Y.util.toJSONOptions)},se.getTypeUrl=function(t){return t===void 0&&(t="type.googleapis.com"),t+"/transit_realtime.Position"},se}(),ue.TripDescriptor=function(){function se(ie){if(ie)for(var t=Object.keys(ie),H=0;H<t.length;++H)ie[t[H]]!=null&&(this[t[H]]=ie[t[H]])}return se.prototype.trip_id="",se.prototype.route_id="",se.prototype.direction_id=0,se.prototype.start_time="",se.prototype.start_date="",se.prototype.schedule_relationship=0,se.prototype.modified_trip=null,se.create=function(t){return new se(t)},se.encode=function(t,H){return H||(H=ee.create()),t.trip_id!=null&&Object.hasOwnProperty.call(t,"trip_id")&&H.uint32(10).string(t.trip_id),t.start_time!=null&&Object.hasOwnProperty.call(t,"start_time")&&H.uint32(18).string(t.start_time),t.start_date!=null&&Object.hasOwnProperty.call(t,"start_date")&&H.uint32(26).string(t.start_date),t.schedule_relationship!=null&&Object.hasOwnProperty.call(t,"schedule_relationship")&&H.uint32(32).int32(t.schedule_relationship),t.route_id!=null&&Object.hasOwnProperty.call(t,"route_id")&&H.uint32(42).string(t.route_id),t.direction_id!=null&&Object.hasOwnProperty.call(t,"direction_id")&&H.uint32(48).uint32(t.direction_id),t.modified_trip!=null&&Object.hasOwnProperty.call(t,"modified_trip")&&te.transit_realtime.TripDescriptor.ModifiedTripSelector.encode(t.modified_trip,H.uint32(58).fork()).ldelim(),H},se.encodeDelimited=function(t,H){return this.encode(t,H).ldelim()},se.decode=function(t,H){t instanceof X||(t=X.create(t));for(var ae=H===void 0?t.len:t.pos+H,he=new te.transit_realtime.TripDescriptor;t.pos<ae;){var _e=t.uint32();switch(_e>>>3){case 1:{he.trip_id=t.string();break}case 5:{he.route_id=t.string();break}case 6:{he.direction_id=t.uint32();break}case 2:{he.start_time=t.string();break}case 3:{he.start_date=t.string();break}case 4:{he.schedule_relationship=t.int32();break}case 7:{he.modified_trip=te.transit_realtime.TripDescriptor.ModifiedTripSelector.decode(t,t.uint32());break}default:t.skipType(_e&7);break}}return he},se.decodeDelimited=function(t){return t instanceof X||(t=new X(t)),this.decode(t,t.uint32())},se.verify=function(t){if(typeof t!="object"||t===null)return"object expected";if(t.trip_id!=null&&t.hasOwnProperty("trip_id")&&!ne.isString(t.trip_id))return"trip_id: string expected";if(t.route_id!=null&&t.hasOwnProperty("route_id")&&!ne.isString(t.route_id))return"route_id: string expected";if(t.direction_id!=null&&t.hasOwnProperty("direction_id")&&!ne.isInteger(t.direction_id))return"direction_id: integer expected";if(t.start_time!=null&&t.hasOwnProperty("start_time")&&!ne.isString(t.start_time))return"start_time: string expected";if(t.start_date!=null&&t.hasOwnProperty("start_date")&&!ne.isString(t.start_date))return"start_date: string expected";if(t.schedule_relationship!=null&&t.hasOwnProperty("schedule_relationship"))switch(t.schedule_relationship){default:return"schedule_relationship: enum value expected";case 0:case 1:case 2:case 3:case 5:case 6:case 7:break}if(t.modified_trip!=null&&t.hasOwnProperty("modified_trip")){var H=te.transit_realtime.TripDescriptor.ModifiedTripSelector.verify(t.modified_trip);if(H)return"modified_trip."+H}return null},se.fromObject=function(t){if(t instanceof te.transit_realtime.TripDescriptor)return t;var H=new te.transit_realtime.TripDescriptor;switch(t.trip_id!=null&&(H.trip_id=String(t.trip_id)),t.route_id!=null&&(H.route_id=String(t.route_id)),t.direction_id!=null&&(H.direction_id=t.direction_id>>>0),t.start_time!=null&&(H.start_time=String(t.start_time)),t.start_date!=null&&(H.start_date=String(t.start_date)),t.schedule_relationship){default:if(typeof t.schedule_relationship=="number"){H.schedule_relationship=t.schedule_relationship;break}break;case"SCHEDULED":case 0:H.schedule_relationship=0;break;case"ADDED":case 1:H.schedule_relationship=1;break;case"UNSCHEDULED":case 2:H.schedule_relationship=2;break;case"CANCELED":case 3:H.schedule_relationship=3;break;case"REPLACEMENT":case 5:H.schedule_relationship=5;break;case"DUPLICATED":case 6:H.schedule_relationship=6;break;case"DELETED":case 7:H.schedule_relationship=7;break}if(t.modified_trip!=null){if(typeof t.modified_trip!="object")throw TypeError(".transit_realtime.TripDescriptor.modified_trip: object expected");H.modified_trip=te.transit_realtime.TripDescriptor.ModifiedTripSelector.fromObject(t.modified_trip)}return H},se.toObject=function(t,H){H||(H={});var ae={};return H.defaults&&(ae.trip_id="",ae.start_time="",ae.start_date="",ae.schedule_relationship=H.enums===String?"SCHEDULED":0,ae.route_id="",ae.direction_id=0,ae.modified_trip=null),t.trip_id!=null&&t.hasOwnProperty("trip_id")&&(ae.trip_id=t.trip_id),t.start_time!=null&&t.hasOwnProperty("start_time")&&(ae.start_time=t.start_time),t.start_date!=null&&t.hasOwnProperty("start_date")&&(ae.start_date=t.start_date),t.schedule_relationship!=null&&t.hasOwnProperty("schedule_relationship")&&(ae.schedule_relationship=H.enums===String?te.transit_realtime.TripDescriptor.ScheduleRelationship[t.schedule_relationship]===void 0?t.schedule_relationship:te.transit_realtime.TripDescriptor.ScheduleRelationship[t.schedule_relationship]:t.schedule_relationship),t.route_id!=null&&t.hasOwnProperty("route_id")&&(ae.route_id=t.route_id),t.direction_id!=null&&t.hasOwnProperty("direction_id")&&(ae.direction_id=t.direction_id),t.modified_trip!=null&&t.hasOwnProperty("modified_trip")&&(ae.modified_trip=te.transit_realtime.TripDescriptor.ModifiedTripSelector.toObject(t.modified_trip,H)),ae},se.prototype.toJSON=function(){return this.constructor.toObject(this,Y.util.toJSONOptions)},se.getTypeUrl=function(t){return t===void 0&&(t="type.googleapis.com"),t+"/transit_realtime.TripDescriptor"},se.ScheduleRelationship=function(){var ie={},t=Object.create(ie);return t[ie[0]="SCHEDULED"]=0,t[ie[1]="ADDED"]=1,t[ie[2]="UNSCHEDULED"]=2,t[ie[3]="CANCELED"]=3,t[ie[5]="REPLACEMENT"]=5,t[ie[6]="DUPLICATED"]=6,t[ie[7]="DELETED"]=7,t}(),se.ModifiedTripSelector=function(){function ie(t){if(t)for(var H=Object.keys(t),ae=0;ae<H.length;++ae)t[H[ae]]!=null&&(this[H[ae]]=t[H[ae]])}return ie.prototype.modifications_id="",ie.prototype.affected_trip_id="",ie.prototype.start_time="",ie.prototype.start_date="",ie.create=function(H){return new ie(H)},ie.encode=function(H,ae){return ae||(ae=ee.create()),H.modifications_id!=null&&Object.hasOwnProperty.call(H,"modifications_id")&&ae.uint32(10).string(H.modifications_id),H.affected_trip_id!=null&&Object.hasOwnProperty.call(H,"affected_trip_id")&&ae.uint32(18).string(H.affected_trip_id),H.start_time!=null&&Object.hasOwnProperty.call(H,"start_time")&&ae.uint32(26).string(H.start_time),H.start_date!=null&&Object.hasOwnProperty.call(H,"start_date")&&ae.uint32(34).string(H.start_date),ae},ie.encodeDelimited=function(H,ae){return this.encode(H,ae).ldelim()},ie.decode=function(H,ae){H instanceof X||(H=X.create(H));for(var he=ae===void 0?H.len:H.pos+ae,_e=new te.transit_realtime.TripDescriptor.ModifiedTripSelector;H.pos<he;){var ge=H.uint32();switch(ge>>>3){case 1:{_e.modifications_id=H.string();break}case 2:{_e.affected_trip_id=H.string();break}case 3:{_e.start_time=H.string();break}case 4:{_e.start_date=H.string();break}default:H.skipType(ge&7);break}}return _e},ie.decodeDelimited=function(H){return H instanceof X||(H=new X(H)),this.decode(H,H.uint32())},ie.verify=function(H){return typeof H!="object"||H===null?"object expected":H.modifications_id!=null&&H.hasOwnProperty("modifications_id")&&!ne.isString(H.modifications_id)?"modifications_id: string expected":H.affected_trip_id!=null&&H.hasOwnProperty("affected_trip_id")&&!ne.isString(H.affected_trip_id)?"affected_trip_id: string expected":H.start_time!=null&&H.hasOwnProperty("start_time")&&!ne.isString(H.start_time)?"start_time: string expected":H.start_date!=null&&H.hasOwnProperty("start_date")&&!ne.isString(H.start_date)?"start_date: string expected":null},ie.fromObject=function(H){if(H instanceof te.transit_realtime.TripDescriptor.ModifiedTripSelector)return H;var ae=new te.transit_realtime.TripDescriptor.ModifiedTripSelector;return H.modifications_id!=null&&(ae.modifications_id=String(H.modifications_id)),H.affected_trip_id!=null&&(ae.affected_trip_id=String(H.affected_trip_id)),H.start_time!=null&&(ae.start_time=String(H.start_time)),H.start_date!=null&&(ae.start_date=String(H.start_date)),ae},ie.toObject=function(H,ae){ae||(ae={});var he={};return ae.defaults&&(he.modifications_id="",he.affected_trip_id="",he.start_time="",he.start_date=""),H.modifications_id!=null&&H.hasOwnProperty("modifications_id")&&(he.modifications_id=H.modifications_id),H.affected_trip_id!=null&&H.hasOwnProperty("affected_trip_id")&&(he.affected_trip_id=H.affected_trip_id),H.start_time!=null&&H.hasOwnProperty("start_time")&&(he.start_time=H.start_time),H.start_date!=null&&H.hasOwnProperty("start_date")&&(he.start_date=H.start_date),he},ie.prototype.toJSON=function(){return this.constructor.toObject(this,Y.util.toJSONOptions)},ie.getTypeUrl=function(H){return H===void 0&&(H="type.googleapis.com"),H+"/transit_realtime.TripDescriptor.ModifiedTripSelector"},ie}(),se}(),ue.VehicleDescriptor=function(){function se(ie){if(ie)for(var t=Object.keys(ie),H=0;H<t.length;++H)ie[t[H]]!=null&&(this[t[H]]=ie[t[H]])}return se.prototype.id="",se.prototype.label="",se.prototype.license_plate="",se.prototype.wheelchair_accessible=0,se.create=function(t){return new se(t)},se.encode=function(t,H){return H||(H=ee.create()),t.id!=null&&Object.hasOwnProperty.call(t,"id")&&H.uint32(10).string(t.id),t.label!=null&&Object.hasOwnProperty.call(t,"label")&&H.uint32(18).string(t.label),t.license_plate!=null&&Object.hasOwnProperty.call(t,"license_plate")&&H.uint32(26).string(t.license_plate),t.wheelchair_accessible!=null&&Object.hasOwnProperty.call(t,"wheelchair_accessible")&&H.uint32(32).int32(t.wheelchair_accessible),H},se.encodeDelimited=function(t,H){return this.encode(t,H).ldelim()},se.decode=function(t,H){t instanceof X||(t=X.create(t));for(var ae=H===void 0?t.len:t.pos+H,he=new te.transit_realtime.VehicleDescriptor;t.pos<ae;){var _e=t.uint32();switch(_e>>>3){case 1:{he.id=t.string();break}case 2:{he.label=t.string();break}case 3:{he.license_plate=t.string();break}case 4:{he.wheelchair_accessible=t.int32();break}default:t.skipType(_e&7);break}}return he},se.decodeDelimited=function(t){return t instanceof X||(t=new X(t)),this.decode(t,t.uint32())},se.verify=function(t){if(typeof t!="object"||t===null)return"object expected";if(t.id!=null&&t.hasOwnProperty("id")&&!ne.isString(t.id))return"id: string expected";if(t.label!=null&&t.hasOwnProperty("label")&&!ne.isString(t.label))return"label: string expected";if(t.license_plate!=null&&t.hasOwnProperty("license_plate")&&!ne.isString(t.license_plate))return"license_plate: string expected";if(t.wheelchair_accessible!=null&&t.hasOwnProperty("wheelchair_accessible"))switch(t.wheelchair_accessible){default:return"wheelchair_accessible: enum value expected";case 0:case 1:case 2:case 3:break}return null},se.fromObject=function(t){if(t instanceof te.transit_realtime.VehicleDescriptor)return t;var H=new te.transit_realtime.VehicleDescriptor;switch(t.id!=null&&(H.id=String(t.id)),t.label!=null&&(H.label=String(t.label)),t.license_plate!=null&&(H.license_plate=String(t.license_plate)),t.wheelchair_accessible){default:if(typeof t.wheelchair_accessible=="number"){H.wheelchair_accessible=t.wheelchair_accessible;break}break;case"NO_VALUE":case 0:H.wheelchair_accessible=0;break;case"UNKNOWN":case 1:H.wheelchair_accessible=1;break;case"WHEELCHAIR_ACCESSIBLE":case 2:H.wheelchair_accessible=2;break;case"WHEELCHAIR_INACCESSIBLE":case 3:H.wheelchair_accessible=3;break}return H},se.toObject=function(t,H){H||(H={});var ae={};return H.defaults&&(ae.id="",ae.label="",ae.license_plate="",ae.wheelchair_accessible=H.enums===String?"NO_VALUE":0),t.id!=null&&t.hasOwnProperty("id")&&(ae.id=t.id),t.label!=null&&t.hasOwnProperty("label")&&(ae.label=t.label),t.license_plate!=null&&t.hasOwnProperty("license_plate")&&(ae.license_plate=t.license_plate),t.wheelchair_accessible!=null&&t.hasOwnProperty("wheelchair_accessible")&&(ae.wheelchair_accessible=H.enums===String?te.transit_realtime.VehicleDescriptor.WheelchairAccessible[t.wheelchair_accessible]===void 0?t.wheelchair_accessible:te.transit_realtime.VehicleDescriptor.WheelchairAccessible[t.wheelchair_accessible]:t.wheelchair_accessible),ae},se.prototype.toJSON=function(){return this.constructor.toObject(this,Y.util.toJSONOptions)},se.getTypeUrl=function(t){return t===void 0&&(t="type.googleapis.com"),t+"/transit_realtime.VehicleDescriptor"},se.WheelchairAccessible=function(){var ie={},t=Object.create(ie);return t[ie[0]="NO_VALUE"]=0,t[ie[1]="UNKNOWN"]=1,t[ie[2]="WHEELCHAIR_ACCESSIBLE"]=2,t[ie[3]="WHEELCHAIR_INACCESSIBLE"]=3,t}(),se}(),ue.EntitySelector=function(){function se(ie){if(ie)for(var t=Object.keys(ie),H=0;H<t.length;++H)ie[t[H]]!=null&&(this[t[H]]=ie[t[H]])}return se.prototype.agency_id="",se.prototype.route_id="",se.prototype.route_type=0,se.prototype.trip=null,se.prototype.stop_id="",se.prototype.direction_id=0,se.create=function(t){return new se(t)},se.encode=function(t,H){return H||(H=ee.create()),t.agency_id!=null&&Object.hasOwnProperty.call(t,"agency_id")&&H.uint32(10).string(t.agency_id),t.route_id!=null&&Object.hasOwnProperty.call(t,"route_id")&&H.uint32(18).string(t.route_id),t.route_type!=null&&Object.hasOwnProperty.call(t,"route_type")&&H.uint32(24).int32(t.route_type),t.trip!=null&&Object.hasOwnProperty.call(t,"trip")&&te.transit_realtime.TripDescriptor.encode(t.trip,H.uint32(34).fork()).ldelim(),t.stop_id!=null&&Object.hasOwnProperty.call(t,"stop_id")&&H.uint32(42).string(t.stop_id),t.direction_id!=null&&Object.hasOwnProperty.call(t,"direction_id")&&H.uint32(48).uint32(t.direction_id),H},se.encodeDelimited=function(t,H){return this.encode(t,H).ldelim()},se.decode=function(t,H){t instanceof X||(t=X.create(t));for(var ae=H===void 0?t.len:t.pos+H,he=new te.transit_realtime.EntitySelector;t.pos<ae;){var _e=t.uint32();switch(_e>>>3){case 1:{he.agency_id=t.string();break}case 2:{he.route_id=t.string();break}case 3:{he.route_type=t.int32();break}case 4:{he.trip=te.transit_realtime.TripDescriptor.decode(t,t.uint32());break}case 5:{he.stop_id=t.string();break}case 6:{he.direction_id=t.uint32();break}default:t.skipType(_e&7);break}}return he},se.decodeDelimited=function(t){return t instanceof X||(t=new X(t)),this.decode(t,t.uint32())},se.verify=function(t){if(typeof t!="object"||t===null)return"object expected";if(t.agency_id!=null&&t.hasOwnProperty("agency_id")&&!ne.isString(t.agency_id))return"agency_id: string expected";if(t.route_id!=null&&t.hasOwnProperty("route_id")&&!ne.isString(t.route_id))return"route_id: string expected";if(t.route_type!=null&&t.hasOwnProperty("route_type")&&!ne.isInteger(t.route_type))return"route_type: integer expected";if(t.trip!=null&&t.hasOwnProperty("trip")){var H=te.transit_realtime.TripDescriptor.verify(t.trip);if(H)return"trip."+H}return t.stop_id!=null&&t.hasOwnProperty("stop_id")&&!ne.isString(t.stop_id)?"stop_id: string expected":t.direction_id!=null&&t.hasOwnProperty("direction_id")&&!ne.isInteger(t.direction_id)?"direction_id: integer expected":null},se.fromObject=function(t){if(t instanceof te.transit_realtime.EntitySelector)return t;var H=new te.transit_realtime.EntitySelector;if(t.agency_id!=null&&(H.agency_id=String(t.agency_id)),t.route_id!=null&&(H.route_id=String(t.route_id)),t.route_type!=null&&(H.route_type=t.route_type|0),t.trip!=null){if(typeof t.trip!="object")throw TypeError(".transit_realtime.EntitySelector.trip: object expected");H.trip=te.transit_realtime.TripDescriptor.fromObject(t.trip)}return t.stop_id!=null&&(H.stop_id=String(t.stop_id)),t.direction_id!=null&&(H.direction_id=t.direction_id>>>0),H},se.toObject=function(t,H){H||(H={});var ae={};return H.defaults&&(ae.agency_id="",ae.route_id="",ae.route_type=0,ae.trip=null,ae.stop_id="",ae.direction_id=0),t.agency_id!=null&&t.hasOwnProperty("agency_id")&&(ae.agency_id=t.agency_id),t.route_id!=null&&t.hasOwnProperty("route_id")&&(ae.route_id=t.route_id),t.route_type!=null&&t.hasOwnProperty("route_type")&&(ae.route_type=t.route_type),t.trip!=null&&t.hasOwnProperty("trip")&&(ae.trip=te.transit_realtime.TripDescriptor.toObject(t.trip,H)),t.stop_id!=null&&t.hasOwnProperty("stop_id")&&(ae.stop_id=t.stop_id),t.direction_id!=null&&t.hasOwnProperty("direction_id")&&(ae.direction_id=t.direction_id),ae},se.prototype.toJSON=function(){return this.constructor.toObject(this,Y.util.toJSONOptions)},se.getTypeUrl=function(t){return t===void 0&&(t="type.googleapis.com"),t+"/transit_realtime.EntitySelector"},se}(),ue.TranslatedString=function(){function se(ie){if(this.translation=[],ie)for(var t=Object.keys(ie),H=0;H<t.length;++H)ie[t[H]]!=null&&(this[t[H]]=ie[t[H]])}return se.prototype.translation=ne.emptyArray,se.create=function(t){return new se(t)},se.encode=function(t,H){if(H||(H=ee.create()),t.translation!=null&&t.translation.length)for(var ae=0;ae<t.translation.length;++ae)te.transit_realtime.TranslatedString.Translation.encode(t.translation[ae],H.uint32(10).fork()).ldelim();return H},se.encodeDelimited=function(t,H){return this.encode(t,H).ldelim()},se.decode=function(t,H){t instanceof X||(t=X.create(t));for(var ae=H===void 0?t.len:t.pos+H,he=new te.transit_realtime.TranslatedString;t.pos<ae;){var _e=t.uint32();switch(_e>>>3){case 1:{he.translation&&he.translation.length||(he.translation=[]),he.translation.push(te.transit_realtime.TranslatedString.Translation.decode(t,t.uint32()));break}default:t.skipType(_e&7);break}}return he},se.decodeDelimited=function(t){return t instanceof X||(t=new X(t)),this.decode(t,t.uint32())},se.verify=function(t){if(typeof t!="object"||t===null)return"object expected";if(t.translation!=null&&t.hasOwnProperty("translation")){if(!Array.isArray(t.translation))return"translation: array expected";for(var H=0;H<t.translation.length;++H){var ae=te.transit_realtime.TranslatedString.Translation.verify(t.translation[H]);if(ae)return"translation."+ae}}return null},se.fromObject=function(t){if(t instanceof te.transit_realtime.TranslatedString)return t;var H=new te.transit_realtime.TranslatedString;if(t.translation){if(!Array.isArray(t.translation))throw TypeError(".transit_realtime.TranslatedString.translation: array expected");H.translation=[];for(var ae=0;ae<t.translation.length;++ae){if(typeof t.translation[ae]!="object")throw TypeError(".transit_realtime.TranslatedString.translation: object expected");H.translation[ae]=te.transit_realtime.TranslatedString.Translation.fromObject(t.translation[ae])}}return H},se.toObject=function(t,H){H||(H={});var ae={};if((H.arrays||H.defaults)&&(ae.translation=[]),t.translation&&t.translation.length){ae.translation=[];for(var he=0;he<t.translation.length;++he)ae.translation[he]=te.transit_realtime.TranslatedString.Translation.toObject(t.translation[he],H)}return ae},se.prototype.toJSON=function(){return this.constructor.toObject(this,Y.util.toJSONOptions)},se.getTypeUrl=function(t){return t===void 0&&(t="type.googleapis.com"),t+"/transit_realtime.TranslatedString"},se.Translation=function(){function ie(t){if(t)for(var H=Object.keys(t),ae=0;ae<H.length;++ae)t[H[ae]]!=null&&(this[H[ae]]=t[H[ae]])}return ie.prototype.text="",ie.prototype.language="",ie.create=function(H){return new ie(H)},ie.encode=function(H,ae){return ae||(ae=ee.create()),ae.uint32(10).string(H.text),H.language!=null&&Object.hasOwnProperty.call(H,"language")&&ae.uint32(18).string(H.language),ae},ie.encodeDelimited=function(H,ae){return this.encode(H,ae).ldelim()},ie.decode=function(H,ae){H instanceof X||(H=X.create(H));for(var he=ae===void 0?H.len:H.pos+ae,_e=new te.transit_realtime.TranslatedString.Translation;H.pos<he;){var ge=H.uint32();switch(ge>>>3){case 1:{_e.text=H.string();break}case 2:{_e.language=H.string();break}default:H.skipType(ge&7);break}}if(!_e.hasOwnProperty("text"))throw ne.ProtocolError("missing required 'text'",{instance:_e});return _e},ie.decodeDelimited=function(H){return H instanceof X||(H=new X(H)),this.decode(H,H.uint32())},ie.verify=function(H){return typeof H!="object"||H===null?"object expected":ne.isString(H.text)?H.language!=null&&H.hasOwnProperty("language")&&!ne.isString(H.language)?"language: string expected":null:"text: string expected"},ie.fromObject=function(H){if(H instanceof te.transit_realtime.TranslatedString.Translation)return H;var ae=new te.transit_realtime.TranslatedString.Translation;return H.text!=null&&(ae.text=String(H.text)),H.language!=null&&(ae.language=String(H.language)),ae},ie.toObject=function(H,ae){ae||(ae={});var he={};return ae.defaults&&(he.text="",he.language=""),H.text!=null&&H.hasOwnProperty("text")&&(he.text=H.text),H.language!=null&&H.hasOwnProperty("language")&&(he.language=H.language),he},ie.prototype.toJSON=function(){return this.constructor.toObject(this,Y.util.toJSONOptions)},ie.getTypeUrl=function(H){return H===void 0&&(H="type.googleapis.com"),H+"/transit_realtime.TranslatedString.Translation"},ie}(),se}(),ue.TranslatedImage=function(){function se(ie){if(this.localized_image=[],ie)for(var t=Object.keys(ie),H=0;H<t.length;++H)ie[t[H]]!=null&&(this[t[H]]=ie[t[H]])}return se.prototype.localized_image=ne.emptyArray,se.create=function(t){return new se(t)},se.encode=function(t,H){if(H||(H=ee.create()),t.localized_image!=null&&t.localized_image.length)for(var ae=0;ae<t.localized_image.length;++ae)te.transit_realtime.TranslatedImage.LocalizedImage.encode(t.localized_image[ae],H.uint32(10).fork()).ldelim();return H},se.encodeDelimited=function(t,H){return this.encode(t,H).ldelim()},se.decode=function(t,H){t instanceof X||(t=X.create(t));for(var ae=H===void 0?t.len:t.pos+H,he=new te.transit_realtime.TranslatedImage;t.pos<ae;){var _e=t.uint32();switch(_e>>>3){case 1:{he.localized_image&&he.localized_image.length||(he.localized_image=[]),he.localized_image.push(te.transit_realtime.TranslatedImage.LocalizedImage.decode(t,t.uint32()));break}default:t.skipType(_e&7);break}}return he},se.decodeDelimited=function(t){return t instanceof X||(t=new X(t)),this.decode(t,t.uint32())},se.verify=function(t){if(typeof t!="object"||t===null)return"object expected";if(t.localized_image!=null&&t.hasOwnProperty("localized_image")){if(!Array.isArray(t.localized_image))return"localized_image: array expected";for(var H=0;H<t.localized_image.length;++H){var ae=te.transit_realtime.TranslatedImage.LocalizedImage.verify(t.localized_image[H]);if(ae)return"localized_image."+ae}}return null},se.fromObject=function(t){if(t instanceof te.transit_realtime.TranslatedImage)return t;var H=new te.transit_realtime.TranslatedImage;if(t.localized_image){if(!Array.isArray(t.localized_image))throw TypeError(".transit_realtime.TranslatedImage.localized_image: array expected");H.localized_image=[];for(var ae=0;ae<t.localized_image.length;++ae){if(typeof t.localized_image[ae]!="object")throw TypeError(".transit_realtime.TranslatedImage.localized_image: object expected");H.localized_image[ae]=te.transit_realtime.TranslatedImage.LocalizedImage.fromObject(t.localized_image[ae])}}return H},se.toObject=function(t,H){H||(H={});var ae={};if((H.arrays||H.defaults)&&(ae.localized_image=[]),t.localized_image&&t.localized_image.length){ae.localized_image=[];for(var he=0;he<t.localized_image.length;++he)ae.localized_image[he]=te.transit_realtime.TranslatedImage.LocalizedImage.toObject(t.localized_image[he],H)}return ae},se.prototype.toJSON=function(){return this.constructor.toObject(this,Y.util.toJSONOptions)},se.getTypeUrl=function(t){return t===void 0&&(t="type.googleapis.com"),t+"/transit_realtime.TranslatedImage"},se.LocalizedImage=function(){function ie(t){if(t)for(var H=Object.keys(t),ae=0;ae<H.length;++ae)t[H[ae]]!=null&&(this[H[ae]]=t[H[ae]])}return ie.prototype.url="",ie.prototype.media_type="",ie.prototype.language="",ie.create=function(H){return new ie(H)},ie.encode=function(H,ae){return ae||(ae=ee.create()),ae.uint32(10).string(H.url),ae.uint32(18).string(H.media_type),H.language!=null&&Object.hasOwnProperty.call(H,"language")&&ae.uint32(26).string(H.language),ae},ie.encodeDelimited=function(H,ae){return this.encode(H,ae).ldelim()},ie.decode=function(H,ae){H instanceof X||(H=X.create(H));for(var he=ae===void 0?H.len:H.pos+ae,_e=new te.transit_realtime.TranslatedImage.LocalizedImage;H.pos<he;){var ge=H.uint32();switch(ge>>>3){case 1:{_e.url=H.string();break}case 2:{_e.media_type=H.string();break}case 3:{_e.language=H.string();break}default:H.skipType(ge&7);break}}if(!_e.hasOwnProperty("url"))throw ne.ProtocolError("missing required 'url'",{instance:_e});if(!_e.hasOwnProperty("media_type"))throw ne.ProtocolError("missing required 'media_type'",{instance:_e});return _e},ie.decodeDelimited=function(H){return H instanceof X||(H=new X(H)),this.decode(H,H.uint32())},ie.verify=function(H){return typeof H!="object"||H===null?"object expected":ne.isString(H.url)?ne.isString(H.media_type)?H.language!=null&&H.hasOwnProperty("language")&&!ne.isString(H.language)?"language: string expected":null:"media_type: string expected":"url: string expected"},ie.fromObject=function(H){if(H instanceof te.transit_realtime.TranslatedImage.LocalizedImage)return H;var ae=new te.transit_realtime.TranslatedImage.LocalizedImage;return H.url!=null&&(ae.url=String(H.url)),H.media_type!=null&&(ae.media_type=String(H.media_type)),H.language!=null&&(ae.language=String(H.language)),ae},ie.toObject=function(H,ae){ae||(ae={});var he={};return ae.defaults&&(he.url="",he.media_type="",he.language=""),H.url!=null&&H.hasOwnProperty("url")&&(he.url=H.url),H.media_type!=null&&H.hasOwnProperty("media_type")&&(he.media_type=H.media_type),H.language!=null&&H.hasOwnProperty("language")&&(he.language=H.language),he},ie.prototype.toJSON=function(){return this.constructor.toObject(this,Y.util.toJSONOptions)},ie.getTypeUrl=function(H){return H===void 0&&(H="type.googleapis.com"),H+"/transit_realtime.TranslatedImage.LocalizedImage"},ie}(),se}(),ue.Shape=function(){function se(ie){if(ie)for(var t=Object.keys(ie),H=0;H<t.length;++H)ie[t[H]]!=null&&(this[t[H]]=ie[t[H]])}return se.prototype.shape_id="",se.prototype.encoded_polyline="",se.create=function(t){return new se(t)},se.encode=function(t,H){return H||(H=ee.create()),t.shape_id!=null&&Object.hasOwnProperty.call(t,"shape_id")&&H.uint32(10).string(t.shape_id),t.encoded_polyline!=null&&Object.hasOwnProperty.call(t,"encoded_polyline")&&H.uint32(18).string(t.encoded_polyline),H},se.encodeDelimited=function(t,H){return this.encode(t,H).ldelim()},se.decode=function(t,H){t instanceof X||(t=X.create(t));for(var ae=H===void 0?t.len:t.pos+H,he=new te.transit_realtime.Shape;t.pos<ae;){var _e=t.uint32();switch(_e>>>3){case 1:{he.shape_id=t.string();break}case 2:{he.encoded_polyline=t.string();break}default:t.skipType(_e&7);break}}return he},se.decodeDelimited=function(t){return t instanceof X||(t=new X(t)),this.decode(t,t.uint32())},se.verify=function(t){return typeof t!="object"||t===null?"object expected":t.shape_id!=null&&t.hasOwnProperty("shape_id")&&!ne.isString(t.shape_id)?"shape_id: string expected":t.encoded_polyline!=null&&t.hasOwnProperty("encoded_polyline")&&!ne.isString(t.encoded_polyline)?"encoded_polyline: string expected":null},se.fromObject=function(t){if(t instanceof te.transit_realtime.Shape)return t;var H=new te.transit_realtime.Shape;return t.shape_id!=null&&(H.shape_id=String(t.shape_id)),t.encoded_polyline!=null&&(H.encoded_polyline=String(t.encoded_polyline)),H},se.toObject=function(t,H){H||(H={});var ae={};return H.defaults&&(ae.shape_id="",ae.encoded_polyline=""),t.shape_id!=null&&t.hasOwnProperty("shape_id")&&(ae.shape_id=t.shape_id),t.encoded_polyline!=null&&t.hasOwnProperty("encoded_polyline")&&(ae.encoded_polyline=t.encoded_polyline),ae},se.prototype.toJSON=function(){return this.constructor.toObject(this,Y.util.toJSONOptions)},se.getTypeUrl=function(t){return t===void 0&&(t="type.googleapis.com"),t+"/transit_realtime.Shape"},se}(),ue.Stop=function(){function se(ie){if(ie)for(var t=Object.keys(ie),H=0;H<t.length;++H)ie[t[H]]!=null&&(this[t[H]]=ie[t[H]])}return se.prototype.stop_id="",se.prototype.stop_code=null,se.prototype.stop_name=null,se.prototype.tts_stop_name=null,se.prototype.stop_desc=null,se.prototype.stop_lat=0,se.prototype.stop_lon=0,se.prototype.zone_id="",se.prototype.stop_url=null,se.prototype.parent_station="",se.prototype.stop_timezone="",se.prototype.wheelchair_boarding=0,se.prototype.level_id="",se.prototype.platform_code=null,se.create=function(t){return new se(t)},se.encode=function(t,H){return H||(H=ee.create()),t.stop_id!=null&&Object.hasOwnProperty.call(t,"stop_id")&&H.uint32(10).string(t.stop_id),t.stop_code!=null&&Object.hasOwnProperty.call(t,"stop_code")&&te.transit_realtime.TranslatedString.encode(t.stop_code,H.uint32(18).fork()).ldelim(),t.stop_name!=null&&Object.hasOwnProperty.call(t,"stop_name")&&te.transit_realtime.TranslatedString.encode(t.stop_name,H.uint32(26).fork()).ldelim(),t.tts_stop_name!=null&&Object.hasOwnProperty.call(t,"tts_stop_name")&&te.transit_realtime.TranslatedString.encode(t.tts_stop_name,H.uint32(34).fork()).ldelim(),t.stop_desc!=null&&Object.hasOwnProperty.call(t,"stop_desc")&&te.transit_realtime.TranslatedString.encode(t.stop_desc,H.uint32(42).fork()).ldelim(),t.stop_lat!=null&&Object.hasOwnProperty.call(t,"stop_lat")&&H.uint32(53).float(t.stop_lat),t.stop_lon!=null&&Object.hasOwnProperty.call(t,"stop_lon")&&H.uint32(61).float(t.stop_lon),t.zone_id!=null&&Object.hasOwnProperty.call(t,"zone_id")&&H.uint32(66).string(t.zone_id),t.stop_url!=null&&Object.hasOwnProperty.call(t,"stop_url")&&te.transit_realtime.TranslatedString.encode(t.stop_url,H.uint32(74).fork()).ldelim(),t.parent_station!=null&&Object.hasOwnProperty.call(t,"parent_station")&&H.uint32(90).string(t.parent_station),t.stop_timezone!=null&&Object.hasOwnProperty.call(t,"stop_timezone")&&H.uint32(98).string(t.stop_timezone),t.wheelchair_boarding!=null&&Object.hasOwnProperty.call(t,"wheelchair_boarding")&&H.uint32(104).int32(t.wheelchair_boarding),t.level_id!=null&&Object.hasOwnProperty.call(t,"level_id")&&H.uint32(114).string(t.level_id),t.platform_code!=null&&Object.hasOwnProperty.call(t,"platform_code")&&te.transit_realtime.TranslatedString.encode(t.platform_code,H.uint32(122).fork()).ldelim(),H},se.encodeDelimited=function(t,H){return this.encode(t,H).ldelim()},se.decode=function(t,H){t instanceof X||(t=X.create(t));for(var ae=H===void 0?t.len:t.pos+H,he=new te.transit_realtime.Stop;t.pos<ae;){var _e=t.uint32();switch(_e>>>3){case 1:{he.stop_id=t.string();break}case 2:{he.stop_code=te.transit_realtime.TranslatedString.decode(t,t.uint32());break}case 3:{he.stop_name=te.transit_realtime.TranslatedString.decode(t,t.uint32());break}case 4:{he.tts_stop_name=te.transit_realtime.TranslatedString.decode(t,t.uint32());break}case 5:{he.stop_desc=te.transit_realtime.TranslatedString.decode(t,t.uint32());break}case 6:{he.stop_lat=t.float();break}case 7:{he.stop_lon=t.float();break}case 8:{he.zone_id=t.string();break}case 9:{he.stop_url=te.transit_realtime.TranslatedString.decode(t,t.uint32());break}case 11:{he.parent_station=t.string();break}case 12:{he.stop_timezone=t.string();break}case 13:{he.wheelchair_boarding=t.int32();break}case 14:{he.level_id=t.string();break}case 15:{he.platform_code=te.transit_realtime.TranslatedString.decode(t,t.uint32());break}default:t.skipType(_e&7);break}}return he},se.decodeDelimited=function(t){return t instanceof X||(t=new X(t)),this.decode(t,t.uint32())},se.verify=function(t){if(typeof t!="object"||t===null)return"object expected";if(t.stop_id!=null&&t.hasOwnProperty("stop_id")&&!ne.isString(t.stop_id))return"stop_id: string expected";if(t.stop_code!=null&&t.hasOwnProperty("stop_code")){var H=te.transit_realtime.TranslatedString.verify(t.stop_code);if(H)return"stop_code."+H}if(t.stop_name!=null&&t.hasOwnProperty("stop_name")){var H=te.transit_realtime.TranslatedString.verify(t.stop_name);if(H)return"stop_name."+H}if(t.tts_stop_name!=null&&t.hasOwnProperty("tts_stop_name")){var H=te.transit_realtime.TranslatedString.verify(t.tts_stop_name);if(H)return"tts_stop_name."+H}if(t.stop_desc!=null&&t.hasOwnProperty("stop_desc")){var H=te.transit_realtime.TranslatedString.verify(t.stop_desc);if(H)return"stop_desc."+H}if(t.stop_lat!=null&&t.hasOwnProperty("stop_lat")&&typeof t.stop_lat!="number")return"stop_lat: number expected";if(t.stop_lon!=null&&t.hasOwnProperty("stop_lon")&&typeof t.stop_lon!="number")return"stop_lon: number expected";if(t.zone_id!=null&&t.hasOwnProperty("zone_id")&&!ne.isString(t.zone_id))return"zone_id: string expected";if(t.stop_url!=null&&t.hasOwnProperty("stop_url")){var H=te.transit_realtime.TranslatedString.verify(t.stop_url);if(H)return"stop_url."+H}if(t.parent_station!=null&&t.hasOwnProperty("parent_station")&&!ne.isString(t.parent_station))return"parent_station: string expected";if(t.stop_timezone!=null&&t.hasOwnProperty("stop_timezone")&&!ne.isString(t.stop_timezone))return"stop_timezone: string expected";if(t.wheelchair_boarding!=null&&t.hasOwnProperty("wheelchair_boarding"))switch(t.wheelchair_boarding){default:return"wheelchair_boarding: enum value expected";case 0:case 1:case 2:break}if(t.level_id!=null&&t.hasOwnProperty("level_id")&&!ne.isString(t.level_id))return"level_id: string expected";if(t.platform_code!=null&&t.hasOwnProperty("platform_code")){var H=te.transit_realtime.TranslatedString.verify(t.platform_code);if(H)return"platform_code."+H}return null},se.fromObject=function(t){if(t instanceof te.transit_realtime.Stop)return t;var H=new te.transit_realtime.Stop;if(t.stop_id!=null&&(H.stop_id=String(t.stop_id)),t.stop_code!=null){if(typeof t.stop_code!="object")throw TypeError(".transit_realtime.Stop.stop_code: object expected");H.stop_code=te.transit_realtime.TranslatedString.fromObject(t.stop_code)}if(t.stop_name!=null){if(typeof t.stop_name!="object")throw TypeError(".transit_realtime.Stop.stop_name: object expected");H.stop_name=te.transit_realtime.TranslatedString.fromObject(t.stop_name)}if(t.tts_stop_name!=null){if(typeof t.tts_stop_name!="object")throw TypeError(".transit_realtime.Stop.tts_stop_name: object expected");H.tts_stop_name=te.transit_realtime.TranslatedString.fromObject(t.tts_stop_name)}if(t.stop_desc!=null){if(typeof t.stop_desc!="object")throw TypeError(".transit_realtime.Stop.stop_desc: object expected");H.stop_desc=te.transit_realtime.TranslatedString.fromObject(t.stop_desc)}if(t.stop_lat!=null&&(H.stop_lat=Number(t.stop_lat)),t.stop_lon!=null&&(H.stop_lon=Number(t.stop_lon)),t.zone_id!=null&&(H.zone_id=String(t.zone_id)),t.stop_url!=null){if(typeof t.stop_url!="object")throw TypeError(".transit_realtime.Stop.stop_url: object expected");H.stop_url=te.transit_realtime.TranslatedString.fromObject(t.stop_url)}switch(t.parent_station!=null&&(H.parent_station=String(t.parent_station)),t.stop_timezone!=null&&(H.stop_timezone=String(t.stop_timezone)),t.wheelchair_boarding){default:if(typeof t.wheelchair_boarding=="number"){H.wheelchair_boarding=t.wheelchair_boarding;break}break;case"UNKNOWN":case 0:H.wheelchair_boarding=0;break;case"AVAILABLE":case 1:H.wheelchair_boarding=1;break;case"NOT_AVAILABLE":case 2:H.wheelchair_boarding=2;break}if(t.level_id!=null&&(H.level_id=String(t.level_id)),t.platform_code!=null){if(typeof t.platform_code!="object")throw TypeError(".transit_realtime.Stop.platform_code: object expected");H.platform_code=te.transit_realtime.TranslatedString.fromObject(t.platform_code)}return H},se.toObject=function(t,H){H||(H={});var ae={};return H.defaults&&(ae.stop_id="",ae.stop_code=null,ae.stop_name=null,ae.tts_stop_name=null,ae.stop_desc=null,ae.stop_lat=0,ae.stop_lon=0,ae.zone_id="",ae.stop_url=null,ae.parent_station="",ae.stop_timezone="",ae.wheelchair_boarding=H.enums===String?"UNKNOWN":0,ae.level_id="",ae.platform_code=null),t.stop_id!=null&&t.hasOwnProperty("stop_id")&&(ae.stop_id=t.stop_id),t.stop_code!=null&&t.hasOwnProperty("stop_code")&&(ae.stop_code=te.transit_realtime.TranslatedString.toObject(t.stop_code,H)),t.stop_name!=null&&t.hasOwnProperty("stop_name")&&(ae.stop_name=te.transit_realtime.TranslatedString.toObject(t.stop_name,H)),t.tts_stop_name!=null&&t.hasOwnProperty("tts_stop_name")&&(ae.tts_stop_name=te.transit_realtime.TranslatedString.toObject(t.tts_stop_name,H)),t.stop_desc!=null&&t.hasOwnProperty("stop_desc")&&(ae.stop_desc=te.transit_realtime.TranslatedString.toObject(t.stop_desc,H)),t.stop_lat!=null&&t.hasOwnProperty("stop_lat")&&(ae.stop_lat=H.json&&!isFinite(t.stop_lat)?String(t.stop_lat):t.stop_lat),t.stop_lon!=null&&t.hasOwnProperty("stop_lon")&&(ae.stop_lon=H.json&&!isFinite(t.stop_lon)?String(t.stop_lon):t.stop_lon),t.zone_id!=null&&t.hasOwnProperty("zone_id")&&(ae.zone_id=t.zone_id),t.stop_url!=null&&t.hasOwnProperty("stop_url")&&(ae.stop_url=te.transit_realtime.TranslatedString.toObject(t.stop_url,H)),t.parent_station!=null&&t.hasOwnProperty("parent_station")&&(ae.parent_station=t.parent_station),t.stop_timezone!=null&&t.hasOwnProperty("stop_timezone")&&(ae.stop_timezone=t.stop_timezone),t.wheelchair_boarding!=null&&t.hasOwnProperty("wheelchair_boarding")&&(ae.wheelchair_boarding=H.enums===String?te.transit_realtime.Stop.WheelchairBoarding[t.wheelchair_boarding]===void 0?t.wheelchair_boarding:te.transit_realtime.Stop.WheelchairBoarding[t.wheelchair_boarding]:t.wheelchair_boarding),t.level_id!=null&&t.hasOwnProperty("level_id")&&(ae.level_id=t.level_id),t.platform_code!=null&&t.hasOwnProperty("platform_code")&&(ae.platform_code=te.transit_realtime.TranslatedString.toObject(t.platform_code,H)),ae},se.prototype.toJSON=function(){return this.constructor.toObject(this,Y.util.toJSONOptions)},se.getTypeUrl=function(t){return t===void 0&&(t="type.googleapis.com"),t+"/transit_realtime.Stop"},se.WheelchairBoarding=function(){var ie={},t=Object.create(ie);return t[ie[0]="UNKNOWN"]=0,t[ie[1]="AVAILABLE"]=1,t[ie[2]="NOT_AVAILABLE"]=2,t}(),se}(),ue.TripModifications=function(){function se(ie){if(this.selected_trips=[],this.start_times=[],this.service_dates=[],this.modifications=[],ie)for(var t=Object.keys(ie),H=0;H<t.length;++H)ie[t[H]]!=null&&(this[t[H]]=ie[t[H]])}return se.prototype.selected_trips=ne.emptyArray,se.prototype.start_times=ne.emptyArray,se.prototype.service_dates=ne.emptyArray,se.prototype.modifications=ne.emptyArray,se.create=function(t){return new se(t)},se.encode=function(t,H){if(H||(H=ee.create()),t.selected_trips!=null&&t.selected_trips.length)for(var ae=0;ae<t.selected_trips.length;++ae)te.transit_realtime.TripModifications.SelectedTrips.encode(t.selected_trips[ae],H.uint32(10).fork()).ldelim();if(t.start_times!=null&&t.start_times.length)for(var ae=0;ae<t.start_times.length;++ae)H.uint32(18).string(t.start_times[ae]);if(t.service_dates!=null&&t.service_dates.length)for(var ae=0;ae<t.service_dates.length;++ae)H.uint32(26).string(t.service_dates[ae]);if(t.modifications!=null&&t.modifications.length)for(var ae=0;ae<t.modifications.length;++ae)te.transit_realtime.TripModifications.Modification.encode(t.modifications[ae],H.uint32(34).fork()).ldelim();return H},se.encodeDelimited=function(t,H){return this.encode(t,H).ldelim()},se.decode=function(t,H){t instanceof X||(t=X.create(t));for(var ae=H===void 0?t.len:t.pos+H,he=new te.transit_realtime.TripModifications;t.pos<ae;){var _e=t.uint32();switch(_e>>>3){case 1:{he.selected_trips&&he.selected_trips.length||(he.selected_trips=[]),he.selected_trips.push(te.transit_realtime.TripModifications.SelectedTrips.decode(t,t.uint32()));break}case 2:{he.start_times&&he.start_times.length||(he.start_times=[]),he.start_times.push(t.string());break}case 3:{he.service_dates&&he.service_dates.length||(he.service_dates=[]),he.service_dates.push(t.string());break}case 4:{he.modifications&&he.modifications.length||(he.modifications=[]),he.modifications.push(te.transit_realtime.TripModifications.Modification.decode(t,t.uint32()));break}default:t.skipType(_e&7);break}}return he},se.decodeDelimited=function(t){return t instanceof X||(t=new X(t)),this.decode(t,t.uint32())},se.verify=function(t){if(typeof t!="object"||t===null)return"object expected";if(t.selected_trips!=null&&t.hasOwnProperty("selected_trips")){if(!Array.isArray(t.selected_trips))return"selected_trips: array expected";for(var H=0;H<t.selected_trips.length;++H){var ae=te.transit_realtime.TripModifications.SelectedTrips.verify(t.selected_trips[H]);if(ae)return"selected_trips."+ae}}if(t.start_times!=null&&t.hasOwnProperty("start_times")){if(!Array.isArray(t.start_times))return"start_times: array expected";for(var H=0;H<t.start_times.length;++H)if(!ne.isString(t.start_times[H]))return"start_times: string[] expected"}if(t.service_dates!=null&&t.hasOwnProperty("service_dates")){if(!Array.isArray(t.service_dates))return"service_dates: array expected";for(var H=0;H<t.service_dates.length;++H)if(!ne.isString(t.service_dates[H]))return"service_dates: string[] expected"}if(t.modifications!=null&&t.hasOwnProperty("modifications")){if(!Array.isArray(t.modifications))return"modifications: array expected";for(var H=0;H<t.modifications.length;++H){var ae=te.transit_realtime.TripModifications.Modification.verify(t.modifications[H]);if(ae)return"modifications."+ae}}return null},se.fromObject=function(t){if(t instanceof te.transit_realtime.TripModifications)return t;var H=new te.transit_realtime.TripModifications;if(t.selected_trips){if(!Array.isArray(t.selected_trips))throw TypeError(".transit_realtime.TripModifications.selected_trips: array expected");H.selected_trips=[];for(var ae=0;ae<t.selected_trips.length;++ae){if(typeof t.selected_trips[ae]!="object")throw TypeError(".transit_realtime.TripModifications.selected_trips: object expected");H.selected_trips[ae]=te.transit_realtime.TripModifications.SelectedTrips.fromObject(t.selected_trips[ae])}}if(t.start_times){if(!Array.isArray(t.start_times))throw TypeError(".transit_realtime.TripModifications.start_times: array expected");H.start_times=[];for(var ae=0;ae<t.start_times.length;++ae)H.start_times[ae]=String(t.start_times[ae])}if(t.service_dates){if(!Array.isArray(t.service_dates))throw TypeError(".transit_realtime.TripModifications.service_dates: array expected");H.service_dates=[];for(var ae=0;ae<t.service_dates.length;++ae)H.service_dates[ae]=String(t.service_dates[ae])}if(t.modifications){if(!Array.isArray(t.modifications))throw TypeError(".transit_realtime.TripModifications.modifications: array expected");H.modifications=[];for(var ae=0;ae<t.modifications.length;++ae){if(typeof t.modifications[ae]!="object")throw TypeError(".transit_realtime.TripModifications.modifications: object expected");H.modifications[ae]=te.transit_realtime.TripModifications.Modification.fromObject(t.modifications[ae])}}return H},se.toObject=function(t,H){H||(H={});var ae={};if((H.arrays||H.defaults)&&(ae.selected_trips=[],ae.start_times=[],ae.service_dates=[],ae.modifications=[]),t.selected_trips&&t.selected_trips.length){ae.selected_trips=[];for(var he=0;he<t.selected_trips.length;++he)ae.selected_trips[he]=te.transit_realtime.TripModifications.SelectedTrips.toObject(t.selected_trips[he],H)}if(t.start_times&&t.start_times.length){ae.start_times=[];for(var he=0;he<t.start_times.length;++he)ae.start_times[he]=t.start_times[he]}if(t.service_dates&&t.service_dates.length){ae.service_dates=[];for(var he=0;he<t.service_dates.length;++he)ae.service_dates[he]=t.service_dates[he]}if(t.modifications&&t.modifications.length){ae.modifications=[];for(var he=0;he<t.modifications.length;++he)ae.modifications[he]=te.transit_realtime.TripModifications.Modification.toObject(t.modifications[he],H)}return ae},se.prototype.toJSON=function(){return this.constructor.toObject(this,Y.util.toJSONOptions)},se.getTypeUrl=function(t){return t===void 0&&(t="type.googleapis.com"),t+"/transit_realtime.TripModifications"},se.Modification=function(){function ie(t){if(this.replacement_stops=[],t)for(var H=Object.keys(t),ae=0;ae<H.length;++ae)t[H[ae]]!=null&&(this[H[ae]]=t[H[ae]])}return ie.prototype.start_stop_selector=null,ie.prototype.end_stop_selector=null,ie.prototype.propagated_modification_delay=0,ie.prototype.replacement_stops=ne.emptyArray,ie.prototype.service_alert_id="",ie.prototype.last_modified_time=ne.Long?ne.Long.fromBits(0,0,!0):0,ie.create=function(H){return new ie(H)},ie.encode=function(H,ae){if(ae||(ae=ee.create()),H.start_stop_selector!=null&&Object.hasOwnProperty.call(H,"start_stop_selector")&&te.transit_realtime.StopSelector.encode(H.start_stop_selector,ae.uint32(10).fork()).ldelim(),H.end_stop_selector!=null&&Object.hasOwnProperty.call(H,"end_stop_selector")&&te.transit_realtime.StopSelector.encode(H.end_stop_selector,ae.uint32(18).fork()).ldelim(),H.propagated_modification_delay!=null&&Object.hasOwnProperty.call(H,"propagated_modification_delay")&&ae.uint32(24).int32(H.propagated_modification_delay),H.replacement_stops!=null&&H.replacement_stops.length)for(var he=0;he<H.replacement_stops.length;++he)te.transit_realtime.ReplacementStop.encode(H.replacement_stops[he],ae.uint32(34).fork()).ldelim();return H.service_alert_id!=null&&Object.hasOwnProperty.call(H,"service_alert_id")&&ae.uint32(42).string(H.service_alert_id),H.last_modified_time!=null&&Object.hasOwnProperty.call(H,"last_modified_time")&&ae.uint32(48).uint64(H.last_modified_time),ae},ie.encodeDelimited=function(H,ae){return this.encode(H,ae).ldelim()},ie.decode=function(H,ae){H instanceof X||(H=X.create(H));for(var he=ae===void 0?H.len:H.pos+ae,_e=new te.transit_realtime.TripModifications.Modification;H.pos<he;){var ge=H.uint32();switch(ge>>>3){case 1:{_e.start_stop_selector=te.transit_realtime.StopSelector.decode(H,H.uint32());break}case 2:{_e.end_stop_selector=te.transit_realtime.StopSelector.decode(H,H.uint32());break}case 3:{_e.propagated_modification_delay=H.int32();break}case 4:{_e.replacement_stops&&_e.replacement_stops.length||(_e.replacement_stops=[]),_e.replacement_stops.push(te.transit_realtime.ReplacementStop.decode(H,H.uint32()));break}case 5:{_e.service_alert_id=H.string();break}case 6:{_e.last_modified_time=H.uint64();break}default:H.skipType(ge&7);break}}return _e},ie.decodeDelimited=function(H){return H instanceof X||(H=new X(H)),this.decode(H,H.uint32())},ie.verify=function(H){if(typeof H!="object"||H===null)return"object expected";if(H.start_stop_selector!=null&&H.hasOwnProperty("start_stop_selector")){var ae=te.transit_realtime.StopSelector.verify(H.start_stop_selector);if(ae)return"start_stop_selector."+ae}if(H.end_stop_selector!=null&&H.hasOwnProperty("end_stop_selector")){var ae=te.transit_realtime.StopSelector.verify(H.end_stop_selector);if(ae)return"end_stop_selector."+ae}if(H.propagated_modification_delay!=null&&H.hasOwnProperty("propagated_modification_delay")&&!ne.isInteger(H.propagated_modification_delay))return"propagated_modification_delay: integer expected";if(H.replacement_stops!=null&&H.hasOwnProperty("replacement_stops")){if(!Array.isArray(H.replacement_stops))return"replacement_stops: array expected";for(var he=0;he<H.replacement_stops.length;++he){var ae=te.transit_realtime.ReplacementStop.verify(H.replacement_stops[he]);if(ae)return"replacement_stops."+ae}}return H.service_alert_id!=null&&H.hasOwnProperty("service_alert_id")&&!ne.isString(H.service_alert_id)?"service_alert_id: string expected":H.last_modified_time!=null&&H.hasOwnProperty("last_modified_time")&&!ne.isInteger(H.last_modified_time)&&!(H.last_modified_time&&ne.isInteger(H.last_modified_time.low)&&ne.isInteger(H.last_modified_time.high))?"last_modified_time: integer|Long expected":null},ie.fromObject=function(H){if(H instanceof te.transit_realtime.TripModifications.Modification)return H;var ae=new te.transit_realtime.TripModifications.Modification;if(H.start_stop_selector!=null){if(typeof H.start_stop_selector!="object")throw TypeError(".transit_realtime.TripModifications.Modification.start_stop_selector: object expected");ae.start_stop_selector=te.transit_realtime.StopSelector.fromObject(H.start_stop_selector)}if(H.end_stop_selector!=null){if(typeof H.end_stop_selector!="object")throw TypeError(".transit_realtime.TripModifications.Modification.end_stop_selector: object expected");ae.end_stop_selector=te.transit_realtime.StopSelector.fromObject(H.end_stop_selector)}if(H.propagated_modification_delay!=null&&(ae.propagated_modification_delay=H.propagated_modification_delay|0),H.replacement_stops){if(!Array.isArray(H.replacement_stops))throw TypeError(".transit_realtime.TripModifications.Modification.replacement_stops: array expected");ae.replacement_stops=[];for(var he=0;he<H.replacement_stops.length;++he){if(typeof H.replacement_stops[he]!="object")throw TypeError(".transit_realtime.TripModifications.Modification.replacement_stops: object expected");ae.replacement_stops[he]=te.transit_realtime.ReplacementStop.fromObject(H.replacement_stops[he])}}return H.service_alert_id!=null&&(ae.service_alert_id=String(H.service_alert_id)),H.last_modified_time!=null&&(ne.Long?(ae.last_modified_time=ne.Long.fromValue(H.last_modified_time)).unsigned=!0:typeof H.last_modified_time=="string"?ae.last_modified_time=parseInt(H.last_modified_time,10):typeof H.last_modified_time=="number"?ae.last_modified_time=H.last_modified_time:typeof H.last_modified_time=="object"&&(ae.last_modified_time=new ne.LongBits(H.last_modified_time.low>>>0,H.last_modified_time.high>>>0).toNumber(!0))),ae},ie.toObject=function(H,ae){ae||(ae={});var he={};if((ae.arrays||ae.defaults)&&(he.replacement_stops=[]),ae.defaults)if(he.start_stop_selector=null,he.end_stop_selector=null,he.propagated_modification_delay=0,he.service_alert_id="",ne.Long){var _e=new ne.Long(0,0,!0);he.last_modified_time=ae.longs===String?_e.toString():ae.longs===Number?_e.toNumber():_e}else he.last_modified_time=ae.longs===String?"0":0;if(H.start_stop_selector!=null&&H.hasOwnProperty("start_stop_selector")&&(he.start_stop_selector=te.transit_realtime.StopSelector.toObject(H.start_stop_selector,ae)),H.end_stop_selector!=null&&H.hasOwnProperty("end_stop_selector")&&(he.end_stop_selector=te.transit_realtime.StopSelector.toObject(H.end_stop_selector,ae)),H.propagated_modification_delay!=null&&H.hasOwnProperty("propagated_modification_delay")&&(he.propagated_modification_delay=H.propagated_modification_delay),H.replacement_stops&&H.replacement_stops.length){he.replacement_stops=[];for(var ge=0;ge<H.replacement_stops.length;++ge)he.replacement_stops[ge]=te.transit_realtime.ReplacementStop.toObject(H.replacement_stops[ge],ae)}return H.service_alert_id!=null&&H.hasOwnProperty("service_alert_id")&&(he.service_alert_id=H.service_alert_id),H.last_modified_time!=null&&H.hasOwnProperty("last_modified_time")&&(typeof H.last_modified_time=="number"?he.last_modified_time=ae.longs===String?String(H.last_modified_time):H.last_modified_time:he.last_modified_time=ae.longs===String?ne.Long.prototype.toString.call(H.last_modified_time):ae.longs===Number?new ne.LongBits(H.last_modified_time.low>>>0,H.last_modified_time.high>>>0).toNumber(!0):H.last_modified_time),he},ie.prototype.toJSON=function(){return this.constructor.toObject(this,Y.util.toJSONOptions)},ie.getTypeUrl=function(H){return H===void 0&&(H="type.googleapis.com"),H+"/transit_realtime.TripModifications.Modification"},ie}(),se.SelectedTrips=function(){function ie(t){if(this.trip_ids=[],t)for(var H=Object.keys(t),ae=0;ae<H.length;++ae)t[H[ae]]!=null&&(this[H[ae]]=t[H[ae]])}return ie.prototype.trip_ids=ne.emptyArray,ie.prototype.shape_id="",ie.create=function(H){return new ie(H)},ie.encode=function(H,ae){if(ae||(ae=ee.create()),H.trip_ids!=null&&H.trip_ids.length)for(var he=0;he<H.trip_ids.length;++he)ae.uint32(10).string(H.trip_ids[he]);return H.shape_id!=null&&Object.hasOwnProperty.call(H,"shape_id")&&ae.uint32(18).string(H.shape_id),ae},ie.encodeDelimited=function(H,ae){return this.encode(H,ae).ldelim()},ie.decode=function(H,ae){H instanceof X||(H=X.create(H));for(var he=ae===void 0?H.len:H.pos+ae,_e=new te.transit_realtime.TripModifications.SelectedTrips;H.pos<he;){var ge=H.uint32();switch(ge>>>3){case 1:{_e.trip_ids&&_e.trip_ids.length||(_e.trip_ids=[]),_e.trip_ids.push(H.string());break}case 2:{_e.shape_id=H.string();break}default:H.skipType(ge&7);break}}return _e},ie.decodeDelimited=function(H){return H instanceof X||(H=new X(H)),this.decode(H,H.uint32())},ie.verify=function(H){if(typeof H!="object"||H===null)return"object expected";if(H.trip_ids!=null&&H.hasOwnProperty("trip_ids")){if(!Array.isArray(H.trip_ids))return"trip_ids: array expected";for(var ae=0;ae<H.trip_ids.length;++ae)if(!ne.isString(H.trip_ids[ae]))return"trip_ids: string[] expected"}return H.shape_id!=null&&H.hasOwnProperty("shape_id")&&!ne.isString(H.shape_id)?"shape_id: string expected":null},ie.fromObject=function(H){if(H instanceof te.transit_realtime.TripModifications.SelectedTrips)return H;var ae=new te.transit_realtime.TripModifications.SelectedTrips;if(H.trip_ids){if(!Array.isArray(H.trip_ids))throw TypeError(".transit_realtime.TripModifications.SelectedTrips.trip_ids: array expected");ae.trip_ids=[];for(var he=0;he<H.trip_ids.length;++he)ae.trip_ids[he]=String(H.trip_ids[he])}return H.shape_id!=null&&(ae.shape_id=String(H.shape_id)),ae},ie.toObject=function(H,ae){ae||(ae={});var he={};if((ae.arrays||ae.defaults)&&(he.trip_ids=[]),ae.defaults&&(he.shape_id=""),H.trip_ids&&H.trip_ids.length){he.trip_ids=[];for(var _e=0;_e<H.trip_ids.length;++_e)he.trip_ids[_e]=H.trip_ids[_e]}return H.shape_id!=null&&H.hasOwnProperty("shape_id")&&(he.shape_id=H.shape_id),he},ie.prototype.toJSON=function(){return this.constructor.toObject(this,Y.util.toJSONOptions)},ie.getTypeUrl=function(H){return H===void 0&&(H="type.googleapis.com"),H+"/transit_realtime.TripModifications.SelectedTrips"},ie}(),se}(),ue.StopSelector=function(){function se(ie){if(ie)for(var t=Object.keys(ie),H=0;H<t.length;++H)ie[t[H]]!=null&&(this[t[H]]=ie[t[H]])}return se.prototype.stop_sequence=0,se.prototype.stop_id="",se.create=function(t){return new se(t)},se.encode=function(t,H){return H||(H=ee.create()),t.stop_sequence!=null&&Object.hasOwnProperty.call(t,"stop_sequence")&&H.uint32(8).uint32(t.stop_sequence),t.stop_id!=null&&Object.hasOwnProperty.call(t,"stop_id")&&H.uint32(18).string(t.stop_id),H},se.encodeDelimited=function(t,H){return this.encode(t,H).ldelim()},se.decode=function(t,H){t instanceof X||(t=X.create(t));for(var ae=H===void 0?t.len:t.pos+H,he=new te.transit_realtime.StopSelector;t.pos<ae;){var _e=t.uint32();switch(_e>>>3){case 1:{he.stop_sequence=t.uint32();break}case 2:{he.stop_id=t.string();break}default:t.skipType(_e&7);break}}return he},se.decodeDelimited=function(t){return t instanceof X||(t=new X(t)),this.decode(t,t.uint32())},se.verify=function(t){return typeof t!="object"||t===null?"object expected":t.stop_sequence!=null&&t.hasOwnProperty("stop_sequence")&&!ne.isInteger(t.stop_sequence)?"stop_sequence: integer expected":t.stop_id!=null&&t.hasOwnProperty("stop_id")&&!ne.isString(t.stop_id)?"stop_id: string expected":null},se.fromObject=function(t){if(t instanceof te.transit_realtime.StopSelector)return t;var H=new te.transit_realtime.StopSelector;return t.stop_sequence!=null&&(H.stop_sequence=t.stop_sequence>>>0),t.stop_id!=null&&(H.stop_id=String(t.stop_id)),H},se.toObject=function(t,H){H||(H={});var ae={};return H.defaults&&(ae.stop_sequence=0,ae.stop_id=""),t.stop_sequence!=null&&t.hasOwnProperty("stop_sequence")&&(ae.stop_sequence=t.stop_sequence),t.stop_id!=null&&t.hasOwnProperty("stop_id")&&(ae.stop_id=t.stop_id),ae},se.prototype.toJSON=function(){return this.constructor.toObject(this,Y.util.toJSONOptions)},se.getTypeUrl=function(t){return t===void 0&&(t="type.googleapis.com"),t+"/transit_realtime.StopSelector"},se}(),ue.ReplacementStop=function(){function se(ie){if(ie)for(var t=Object.keys(ie),H=0;H<t.length;++H)ie[t[H]]!=null&&(this[t[H]]=ie[t[H]])}return se.prototype.travel_time_to_stop=0,se.prototype.stop_id="",se.create=function(t){return new se(t)},se.encode=function(t,H){return H||(H=ee.create()),t.travel_time_to_stop!=null&&Object.hasOwnProperty.call(t,"travel_time_to_stop")&&H.uint32(8).int32(t.travel_time_to_stop),t.stop_id!=null&&Object.hasOwnProperty.call(t,"stop_id")&&H.uint32(18).string(t.stop_id),H},se.encodeDelimited=function(t,H){return this.encode(t,H).ldelim()},se.decode=function(t,H){t instanceof X||(t=X.create(t));for(var ae=H===void 0?t.len:t.pos+H,he=new te.transit_realtime.ReplacementStop;t.pos<ae;){var _e=t.uint32();switch(_e>>>3){case 1:{he.travel_time_to_stop=t.int32();break}case 2:{he.stop_id=t.string();break}default:t.skipType(_e&7);break}}return he},se.decodeDelimited=function(t){return t instanceof X||(t=new X(t)),this.decode(t,t.uint32())},se.verify=function(t){return typeof t!="object"||t===null?"object expected":t.travel_time_to_stop!=null&&t.hasOwnProperty("travel_time_to_stop")&&!ne.isInteger(t.travel_time_to_stop)?"travel_time_to_stop: integer expected":t.stop_id!=null&&t.hasOwnProperty("stop_id")&&!ne.isString(t.stop_id)?"stop_id: string expected":null},se.fromObject=function(t){if(t instanceof te.transit_realtime.ReplacementStop)return t;var H=new te.transit_realtime.ReplacementStop;return t.travel_time_to_stop!=null&&(H.travel_time_to_stop=t.travel_time_to_stop|0),t.stop_id!=null&&(H.stop_id=String(t.stop_id)),H},se.toObject=function(t,H){H||(H={});var ae={};return H.defaults&&(ae.travel_time_to_stop=0,ae.stop_id=""),t.travel_time_to_stop!=null&&t.hasOwnProperty("travel_time_to_stop")&&(ae.travel_time_to_stop=t.travel_time_to_stop),t.stop_id!=null&&t.hasOwnProperty("stop_id")&&(ae.stop_id=t.stop_id),ae},se.prototype.toJSON=function(){return this.constructor.toObject(this,Y.util.toJSONOptions)},se.getTypeUrl=function(t){return t===void 0&&(t="type.googleapis.com"),t+"/transit_realtime.ReplacementStop"},se}(),ue}(),gtfsRealtime_pbf=te,gtfsRealtime_pbf}var gtfsRtBindings,hasRequiredGtfsRtBindings;function requireGtfsRtBindings(){if(hasRequiredGtfsRtBindings)return gtfsRtBindings;hasRequiredGtfsRtBindings=1;const{transit_realtime:Y}=requireGtfsRealtime_pbf();return gtfsRtBindings=Y,gtfsRtBindings}var gtfsRtBindingsExports=requireGtfsRtBindings(),fetchBrowser$1={exports:{}},fetchBrowser=fetchBrowser$1.exports,hasRequiredFetchBrowser;function requireFetchBrowser(){return hasRequiredFetchBrowser||(hasRequiredFetchBrowser=1,function(Y,X){(function(ee){function ne(te){var ue=te&&te.Promise||ee.Promise,se=te&&te.XMLHttpRequest||ee.XMLHttpRequest;return function(){var ie=Object.create(ee,{fetch:{value:void 0,writable:!0}});return function(t,H){H(X)}(this,function(t){var H=typeof ie<"u"&&ie||typeof self<"u"&&self||typeof H<"u"&&H,ae={searchParams:"URLSearchParams"in H,iterable:"Symbol"in H&&"iterator"in Symbol,blob:"FileReader"in H&&"Blob"in H&&function(){try{return new Blob,!0}catch{return!1}}(),formData:"FormData"in H,arrayBuffer:"ArrayBuffer"in H};function he(ft){return ft&&DataView.prototype.isPrototypeOf(ft)}if(ae.arrayBuffer)var _e=["[object Int8Array]","[object Uint8Array]","[object Uint8ClampedArray]","[object Int16Array]","[object Uint16Array]","[object Int32Array]","[object Uint32Array]","[object Float32Array]","[object Float64Array]"],ge=ArrayBuffer.isView||function(ft){return ft&&_e.indexOf(Object.prototype.toString.call(ft))>-1};function xe(ft){if(typeof ft!="string"&&(ft=String(ft)),/[^a-z0-9\-#$%&'*+.^_`|~!]/i.test(ft)||ft==="")throw new TypeError("Invalid character in header field name");return ft.toLowerCase()}function Re(ft){return typeof ft!="string"&&(ft=String(ft)),ft}function De(ft){var qt={next:function(){var nt=ft.shift();return{done:nt===void 0,value:nt}}};return ae.iterable&&(qt[Symbol.iterator]=function(){return qt}),qt}function Ie(ft){this.map={},ft instanceof Ie?ft.forEach(function(qt,nt){this.append(nt,qt)},this):Array.isArray(ft)?ft.forEach(function(qt){this.append(qt[0],qt[1])},this):ft&&Object.getOwnPropertyNames(ft).forEach(function(qt){this.append(qt,ft[qt])},this)}Ie.prototype.append=function(ft,qt){ft=xe(ft),qt=Re(qt);var nt=this.map[ft];this.map[ft]=nt?nt+", "+qt:qt},Ie.prototype.delete=function(ft){delete this.map[xe(ft)]},Ie.prototype.get=function(ft){return ft=xe(ft),this.has(ft)?this.map[ft]:null},Ie.prototype.has=function(ft){return this.map.hasOwnProperty(xe(ft))},Ie.prototype.set=function(ft,qt){this.map[xe(ft)]=Re(qt)},Ie.prototype.forEach=function(ft,qt){for(var nt in this.map)this.map.hasOwnProperty(nt)&&ft.call(qt,this.map[nt],nt,this)},Ie.prototype.keys=function(){var ft=[];return this.forEach(function(qt,nt){ft.push(nt)}),De(ft)},Ie.prototype.values=function(){var ft=[];return this.forEach(function(qt){ft.push(qt)}),De(ft)},Ie.prototype.entries=function(){var ft=[];return this.forEach(function(qt,nt){ft.push([nt,qt])}),De(ft)},ae.iterable&&(Ie.prototype[Symbol.iterator]=Ie.prototype.entries);function Ce(ft){if(ft.bodyUsed)return ue.reject(new TypeError("Already read"));ft.bodyUsed=!0}function Ue(ft){return new ue(function(qt,nt){ft.onload=function(){qt(ft.result)},ft.onerror=function(){nt(ft.error)}})}function Le(ft){var qt=new FileReader,nt=Ue(qt);return qt.readAsArrayBuffer(ft),nt}function ke(ft){var qt=new FileReader,nt=Ue(qt);return qt.readAsText(ft),nt}function Ge(ft){for(var qt=new Uint8Array(ft),nt=new Array(qt.length),At=0;At<qt.length;At++)nt[At]=String.fromCharCode(qt[At]);return nt.join("")}function Ze(ft){if(ft.slice)return ft.slice(0);var qt=new Uint8Array(ft.byteLength);return qt.set(new Uint8Array(ft)),qt.buffer}function We(){return this.bodyUsed=!1,this._initBody=function(ft){this.bodyUsed=this.bodyUsed,this._bodyInit=ft,ft?typeof ft=="string"?this._bodyText=ft:ae.blob&&Blob.prototype.isPrototypeOf(ft)?this._bodyBlob=ft:ae.formData&&FormData.prototype.isPrototypeOf(ft)?this._bodyFormData=ft:ae.searchParams&&URLSearchParams.prototype.isPrototypeOf(ft)?this._bodyText=ft.toString():ae.arrayBuffer&&ae.blob&&he(ft)?(this._bodyArrayBuffer=Ze(ft.buffer),this._bodyInit=new Blob([this._bodyArrayBuffer])):ae.arrayBuffer&&(ArrayBuffer.prototype.isPrototypeOf(ft)||ge(ft))?this._bodyArrayBuffer=Ze(ft):this._bodyText=ft=Object.prototype.toString.call(ft):this._bodyText="",this.headers.get("content-type")||(typeof ft=="string"?this.headers.set("content-type","text/plain;charset=UTF-8"):this._bodyBlob&&this._bodyBlob.type?this.headers.set("content-type",this._bodyBlob.type):ae.searchParams&&URLSearchParams.prototype.isPrototypeOf(ft)&&this.headers.set("content-type","application/x-www-form-urlencoded;charset=UTF-8"))},ae.blob&&(this.blob=function(){var ft=Ce(this);if(ft)return ft;if(this._bodyBlob)return ue.resolve(this._bodyBlob);if(this._bodyArrayBuffer)return ue.resolve(new Blob([this._bodyArrayBuffer]));if(this._bodyFormData)throw new Error("could not read FormData body as blob");return ue.resolve(new Blob([this._bodyText]))},this.arrayBuffer=function(){if(this._bodyArrayBuffer){var ft=Ce(this);return ft||(ArrayBuffer.isView(this._bodyArrayBuffer)?ue.resolve(this._bodyArrayBuffer.buffer.slice(this._bodyArrayBuffer.byteOffset,this._bodyArrayBuffer.byteOffset+this._bodyArrayBuffer.byteLength)):ue.resolve(this._bodyArrayBuffer))}else return this.blob().then(Le)}),this.text=function(){var ft=Ce(this);if(ft)return ft;if(this._bodyBlob)return ke(this._bodyBlob);if(this._bodyArrayBuffer)return ue.resolve(Ge(this._bodyArrayBuffer));if(this._bodyFormData)throw new Error("could not read FormData body as text");return ue.resolve(this._bodyText)},ae.formData&&(this.formData=function(){return this.text().then(_t)}),this.json=function(){return this.text().then(JSON.parse)},this}var et=["DELETE","GET","HEAD","OPTIONS","POST","PUT"];function He(ft){var qt=ft.toUpperCase();return et.indexOf(qt)>-1?qt:ft}function ht(ft,qt){if(!(this instanceof ht))throw new TypeError('Please use the "new" operator, this DOM object constructor cannot be called as a function.');qt=qt||{};var nt=qt.body;if(ft instanceof ht){if(ft.bodyUsed)throw new TypeError("Already read");this.url=ft.url,this.credentials=ft.credentials,qt.headers||(this.headers=new Ie(ft.headers)),this.method=ft.method,this.mode=ft.mode,this.signal=ft.signal,!nt&&ft._bodyInit!=null&&(nt=ft._bodyInit,ft.bodyUsed=!0)}else this.url=String(ft);if(this.credentials=qt.credentials||this.credentials||"same-origin",(qt.headers||!this.headers)&&(this.headers=new Ie(qt.headers)),this.method=He(qt.method||this.method||"GET"),this.mode=qt.mode||this.mode||null,this.signal=qt.signal||this.signal,this.referrer=null,(this.method==="GET"||this.method==="HEAD")&&nt)throw new TypeError("Body not allowed for GET or HEAD requests");if(this._initBody(nt),(this.method==="GET"||this.method==="HEAD")&&(qt.cache==="no-store"||qt.cache==="no-cache")){var At=/([?&])_=[^&]*/;if(At.test(this.url))this.url=this.url.replace(At,"$1_="+new Date().getTime());else{var wt=/\?/;this.url+=(wt.test(this.url)?"&":"?")+"_="+new Date().getTime()}}}ht.prototype.clone=function(){return new ht(this,{body:this._bodyInit})};function _t(ft){var qt=new FormData;return ft.trim().split("&").forEach(function(nt){if(nt){var At=nt.split("="),wt=At.shift().replace(/\+/g," "),Ft=At.join("=").replace(/\+/g," ");qt.append(decodeURIComponent(wt),decodeURIComponent(Ft))}}),qt}function ut(ft){var qt=new Ie,nt=ft.replace(/\r?\n[\t ]+/g," ");return nt.split("\r").map(function(At){return At.indexOf(`
`)===0?At.substr(1,At.length):At}).forEach(function(At){var wt=At.split(":"),Ft=wt.shift().trim();if(Ft){var er=wt.join(":").trim();qt.append(Ft,er)}}),qt}We.call(ht.prototype);function yt(ft,qt){if(!(this instanceof yt))throw new TypeError('Please use the "new" operator, this DOM object constructor cannot be called as a function.');qt||(qt={}),this.type="default",this.status=qt.status===void 0?200:qt.status,this.ok=this.status>=200&&this.status<300,this.statusText="statusText"in qt?qt.statusText:"",this.headers=new Ie(qt.headers),this.url=qt.url||"",this._initBody(ft)}We.call(yt.prototype),yt.prototype.clone=function(){return new yt(this._bodyInit,{status:this.status,statusText:this.statusText,headers:new Ie(this.headers),url:this.url})},yt.error=function(){var ft=new yt(null,{status:0,statusText:""});return ft.type="error",ft};var Lt=[301,302,303,307,308];yt.redirect=function(ft,qt){if(Lt.indexOf(qt)===-1)throw new RangeError("Invalid status code");return new yt(null,{status:qt,headers:{location:ft}})},t.DOMException=H.DOMException;try{new t.DOMException}catch{t.DOMException=function(qt,nt){this.message=qt,this.name=nt;var At=Error(qt);this.stack=At.stack},t.DOMException.prototype=Object.create(Error.prototype),t.DOMException.prototype.constructor=t.DOMException}function Kt(ft,qt){return new ue(function(nt,At){var wt=new ht(ft,qt);if(wt.signal&&wt.signal.aborted)return At(new t.DOMException("Aborted","AbortError"));var Ft=new se;function er(){Ft.abort()}Ft.onload=function(){var jr={status:Ft.status,statusText:Ft.statusText,headers:ut(Ft.getAllResponseHeaders()||"")};jr.url="responseURL"in Ft?Ft.responseURL:jr.headers.get("X-Request-URL");var Mr="response"in Ft?Ft.response:Ft.responseText;setTimeout(function(){nt(new yt(Mr,jr))},0)},Ft.onerror=function(){setTimeout(function(){At(new TypeError("Network request failed"))},0)},Ft.ontimeout=function(){setTimeout(function(){At(new TypeError("Network request failed"))},0)},Ft.onabort=function(){setTimeout(function(){At(new t.DOMException("Aborted","AbortError"))},0)};function lr(jr){try{return jr===""&&H.location.href?H.location.href:jr}catch{return jr}}Ft.open(wt.method,lr(wt.url),!0),wt.credentials==="include"?Ft.withCredentials=!0:wt.credentials==="omit"&&(Ft.withCredentials=!1),"responseType"in Ft&&(ae.blob?Ft.responseType="blob":ae.arrayBuffer&&wt.headers.get("Content-Type")&&wt.headers.get("Content-Type").indexOf("application/octet-stream")!==-1&&(Ft.responseType="arraybuffer")),qt&&typeof qt.headers=="object"&&!(qt.headers instanceof Ie)?Object.getOwnPropertyNames(qt.headers).forEach(function(jr){Ft.setRequestHeader(jr,Re(qt.headers[jr]))}):wt.headers.forEach(function(jr,Mr){Ft.setRequestHeader(Mr,jr)}),wt.signal&&(wt.signal.addEventListener("abort",er),Ft.onreadystatechange=function(){Ft.readyState===4&&wt.signal.removeEventListener("abort",er)}),Ft.send(typeof wt._bodyInit>"u"?null:wt._bodyInit)})}Kt.polyfill=!0,H.fetch||(H.fetch=Kt,H.Headers=Ie,H.Request=ht,H.Response=yt),t.Headers=Ie,t.Request=ht,t.Response=yt,t.fetch=Kt,Object.defineProperty(t,"__esModule",{value:!0})}),{fetch:ie.fetch,Headers:ie.Headers,Request:ie.Request,Response:ie.Response,DOMException:ie.DOMException}}()}Y.exports=ne})(typeof globalThis<"u"?globalThis:typeof self<"u"?self:typeof commonjsGlobal<"u"?commonjsGlobal:fetchBrowser)}(fetchBrowser$1,fetchBrowser$1.exports)),fetchBrowser$1.exports}var fetchPeriodicSync,hasRequiredFetchPeriodicSync;function requireFetchPeriodicSync(){if(hasRequiredFetchPeriodicSync)return fetchPeriodicSync;hasRequiredFetchPeriodicSync=1;const{EventEmitter:Y}=requireEvents(),{fetch:X}=requireFetchBrowser()();return fetchPeriodicSync=(ne,te={})=>{const{interval:ue,respectDataSaving:se,respectPageVisibility:ie,fetchOpts:t,setTimer:H,clearTimer:ae}={interval:3e4,respectDataSaving:!0,respectPageVisibility:!0,fetchOpts:{},setTimer:setTimeout,clearTimer:clearTimeout,...te},he="minInterval"in te?te.minInterval:ue*3,_e=new Y;let ge=null;const xe=async()=>{const He={};ge!==null&&(He["if-none-match"]=ge);const ht=await X(ne,{...t,headers:{...t.headers,...He}});if(!ht.ok&&ht.status!==304){const yt=new Error(ht.statusText);throw yt.response=ht,yt}let _t=!0;ht.status===304&&(_t=!1);const ut=ht.headers.get("etag");return ut&&(ut===ge&&(_t=!1),ge=ut),ht.headers.get("last-modified"),{changed:_t,response:ht}};let Re=null;const De=()=>(Re!==null||(_e.emit("fetch"),Re=xe().then(({changed:He,response:ht})=>(Re=null,_e.emit("fetch-done"),He&&_e.emit("change",ht),ht),He=>{throw Re=null,_e.emit("fetch-done"),_e.emit("error",He),He})),Re),Ie=globalThis.document,Ce=()=>!ie||!Ie?!1:typeof Ie.hidden=="boolean"?Ie.hidden:!1,Ue=globalThis.navigator&&globalThis.navigator.connection,Le=()=>se&&Ue?Ue.saveData:!1;let ke=!1,Ge=null;const Ze=()=>{De().catch(()=>{}).then(()=>{if(!ke)return;const He=Ce()||Le()?he:ue;Ge=H(Ze,He)})},We=()=>{ke||(ke=!0,Ze(),_e.emit("start"))},et=()=>{ke&&(Ge===null&&(ae(Ge),Ge=null),ke=!1,_e.emit("stop"))};return We(),_e.url=()=>ne,_e.start=We,_e.stop=et,_e.isActive=()=>!!ke,_e.refetch=De,_e.isFetching=()=>!!Re,_e},fetchPeriodicSync}var fetchPeriodicSyncExports=requireFetchPeriodicSync();const syncViaPeriodicFetch=getDefaultExportFromCjs(fetchPeriodicSyncExports),MAX_FEED_SIZE=128*1024*1024,CONTENT_TYPES=["application/octet-stream","application/x-protobuf","application/grtfeed"],feedStore=(Y,X)=>{Y.feedUrl=null,Y.feedSyncStopped=!1,Y.feedSyncInterval=30,Y.feedSyncing=!1,Y.feedError=null,Y.feedRawData=null,Y.feedData=null;let ee=null;const ne=async se=>{const ie=se.headers.get("content-type"),t=ie?contentTypeExports.parse(ie):{};if(t.type&&!CONTENT_TYPES.includes(t.type)){const _e=new Error(`invalid content-type \`${t.type}\`, only ${CONTENT_TYPES.join(", ")} are supported`);throw _e.response=se,_e}const H=se.headers.get("content-length");if(H&&parseInt(H)>MAX_FEED_SIZE){const _e=new Error("response is too large");throw _e.response=se,_e}const ae=bufferExports.Buffer.from(await se.arrayBuffer()),he=gtfsRtBindingsExports.FeedMessage.toObject(gtfsRtBindingsExports.FeedMessage.decode(ae));if(!he||!he.header||!Array.isArray(he.entity)){const _e=new Error("couldn't parse feed");throw _e.rawFeed=ae,_e.response=se,_e}Y.feedError=null,Y.feedRawData=ae,Y.feedData=he,X.emit("feed:data-change"),X.emit(X.STATE_CHANGE)},te=se=>{Y.feedSyncing=se,X.emit(X.STATE_CHANGE)},ue=debounce(()=>{ee=syncViaPeriodicFetch(Y.feedUrl,{interval:Y.feedSyncInterval*1e3}),ee.on("fetch",()=>te(!0)),ee.on("fetch-done",()=>te(!1)),ee.on("change",se=>{ne(se).catch(ie=>{Y.feedError=ie,X.emit(X.STATE_CHANGE)})}),ee.on("error",se=>{Y.feedError=se,X.emit(X.STATE_CHANGE)}),Y.feedSyncStopped&&ee.stop()},300);X.on("feed:set-url",se=>{se!==Y.feedUrl&&(ee&&(ee.stop(),ee=null),Y.feedUrl=se,Y.feedSyncing=!1,Y.feedRawData=null,Y.feedData=null,se!==null&&ue(),X.emit("feed:data-change"),X.emit(X.STATE_CHANGE))}),X.on("feed:sync",()=>{ee&&ee.refetch()}),X.on("feed:stop-sync",()=>{Y.feedSyncStopped=!0,ee&&ee.stop(),X.emit(X.STATE_CHANGE)}),X.on("feed:start-sync",()=>{Y.feedSyncStopped=!1,ee&&ee.start(),X.emit(X.STATE_CHANGE)}),X.on("feed:set-sync-interval",se=>{se=Math.max(se,1),se!==Y.feedSyncInterval&&(ee&&(ee.stop(),ee=null),Y.feedSyncInterval=se,Y.feedUrl!==null&&ue(),X.emit(X.STATE_CHANGE))})},MAX_LOG_ITEMS=1e3,feedLogStore=(Y,X)=>{Y.feedLogFilter=null,Y.unfilteredFeedLog=[],Y.feedLog=[];const ee=()=>{if(!Y.feedData){Y.unfilteredFeedLog=[],Y.feedLog=[];return}const ne=Date.now()/1e3|0,te=Y.feedData.header||{},ue=(Y.feedData.entity||[]).filter(H=>!!H.trip_update).flatMap(H=>(H.trip_update.stop_time_update||[]).map(ae=>{var he,_e,ge,xe,Re,De,Ie,Ce;return{entityId:H.id,timestamp:H.trip_update.timestamp||te.timestamp||null,routeId:(he=H.trip_update.trip)==null?void 0:he.route_id,directionId:(_e=H.trip_update.trip)==null?void 0:_e.direction_id,tripId:(ge=H.trip_update.trip)==null?void 0:ge.trip_id,vehicleId:(xe=H.trip_update.vehicle)==null?void 0:xe.id,vehicleLabel:(Re=H.trip_update.vehicle)==null?void 0:Re.label,stopId:ae.stop_id,scheduleRelationship:ae.schedule_relationship,tArrival:((De=ae.arrival)==null?void 0:De.time)??null,delay:((Ie=ae.arrival)==null?void 0:Ie.delay)??((Ce=ae.departure)==null?void 0:Ce.delay)}})).filter(({tArrival:H,delay:ae})=>H!==null?H>=ne:ae!==null).sort((H,ae)=>{const he=typeof H.tArrival=="number"?H.tArrival-ne:Number.MAX_SAFE_INTEGER,_e=typeof ae.tArrival=="number"?ae.tArrival-ne:Number.MAX_SAFE_INTEGER,ge=typeof H.delay=="number"?H.delay:0,xe=typeof ae.delay=="number"?ae.delay:0;return he/30===_e/30?Math.abs(xe)-Math.abs(ge):he-_e}),se=Y.feedLogFilter??"",t=(se?ue.filter(H=>JSON.stringify(H).toLowerCase().includes(se)):ue).slice(0,MAX_LOG_ITEMS);Y.unfilteredFeedLog=ue,Y.feedLog=t,X.emit(X.STATE_CHANGE)};X.on("feed-log:set-filter",ne=>{Y.feedLogFilter!==ne&&(Y.feedLogFilter=ne,ee())}),X.on("feed:data-change",ee)},MAX_TRIP_UPDATES=1e3,MAX_VEHICLE_POSITIONS=1e3,inspectorStore=(Y,X)=>{Y.inspectorFilter=null,Y.unfilteredTripUpdates=[],Y.tripUpdates=[],Y.unfilteredVehiclePositions=[],Y.vehiclePositions=[];const ee=()=>{var he;if(!Y.feedData){Y.unfilteredTripUpdates=[],Y.tripUpdates=[];return}const ne=((he=Y.feedData)==null?void 0:he.entity)??[],te=Y.inspectorFilter??"",ue=ne.filter(_e=>!!_e.trip_update),ie=(te?ue.filter(_e=>JSON.stringify(_e).toLowerCase().includes(te)):ue).slice(0,MAX_TRIP_UPDATES),t=ne.filter(_e=>!!_e.vehicle),ae=(te?t.filter(_e=>JSON.stringify(_e).toLowerCase().includes(te)):t).slice(0,MAX_VEHICLE_POSITIONS);Y.unfilteredTripUpdates=ue,Y.tripUpdates=ie,Y.unfilteredVehiclePositions=t,Y.vehiclePositions=ae,X.emit(X.STATE_CHANGE)};X.on("inspector:set-filter",ne=>{Y.inspectorFilter!==ne&&(Y.inspectorFilter=ne,ee())}),X.on("feed:data-change",ee)};var browser={exports:{}},hasRequiredBrowser;function requireBrowser(){if(hasRequiredBrowser)return browser.exports;hasRequiredBrowser=1;const{AbortController:Y,AbortSignal:X}=typeof self<"u"?self:typeof window<"u"?window:void 0;return browser.exports=Y,browser.exports.AbortSignal=X,browser.exports.default=Y,browser.exports}var browserExports=requireBrowser();const AbortController=getDefaultExportFromCjs(browserExports);var fetchBrowserExports=requireFetchBrowser();const createFetch=getDefaultExportFromCjs(fetchBrowserExports);function encodeReserved(Y){return Y.split(/(%[0-9A-Fa-f]{2})/g).map(function(X){return/%[0-9A-Fa-f]/.test(X)||(X=encodeURI(X).replace(/%5B/g,"[").replace(/%5D/g,"]")),X}).join("")}function encodeUnreserved(Y){return encodeURIComponent(Y).replace(/[!'()*]/g,function(X){return"%"+X.charCodeAt(0).toString(16).toUpperCase()})}function encodeValue(Y,X,ee){return X=Y==="+"||Y==="#"?encodeReserved(X):encodeUnreserved(X),ee?encodeUnreserved(ee)+"="+X:X}function isDefined(Y){return Y!=null}function isKeyOperator(Y){return Y===";"||Y==="&"||Y==="?"}function getValues(Y,X,ee,ne){var te=Y[ee],ue=[];if(isDefined(te)&&te!=="")if(typeof te=="string"||typeof te=="number"||typeof te=="boolean")te=te.toString(),ne&&ne!=="*"&&(te=te.substring(0,parseInt(ne,10))),ue.push(encodeValue(X,te,isKeyOperator(X)?ee:null));else if(ne==="*")Array.isArray(te)?te.filter(isDefined).forEach(function(ie){ue.push(encodeValue(X,ie,isKeyOperator(X)?ee:null))}):Object.keys(te).forEach(function(ie){isDefined(te[ie])&&ue.push(encodeValue(X,te[ie],ie))});else{var se=[];Array.isArray(te)?te.filter(isDefined).forEach(function(ie){se.push(encodeValue(X,ie))}):Object.keys(te).forEach(function(ie){isDefined(te[ie])&&(se.push(encodeUnreserved(ie)),se.push(encodeValue(X,te[ie].toString())))}),isKeyOperator(X)?ue.push(encodeUnreserved(ee)+"="+se.join(",")):se.length!==0&&ue.push(se.join(","))}else X===";"?isDefined(te)&&ue.push(encodeUnreserved(ee)):te===""&&(X==="&"||X==="?")?ue.push(encodeUnreserved(ee)+"="):te===""&&ue.push("");return ue}function parseTemplate(Y){var X=["+","#",".","/",";","?","&"];return{expand:function(ee){return Y.replace(/\{([^\{\}]+)\}|([^\{\}]+)/g,function(ne,te,ue){if(te){var se=null,ie=[];if(X.indexOf(te.charAt(0))!==-1&&(se=te.charAt(0),te=te.substr(1)),te.split(/,/g).forEach(function(H){var ae=/([^:\*]*)(?::(\d+)|(\*))?/.exec(H);ie.push.apply(ie,getValues(ee,se,ae[1],ae[2]||ae[3]))}),se&&se!=="+"){var t=",";return se==="?"?t="&":se!=="#"&&(t=se),(ie.length!==0?se:"")+ie.join(t)}else return ie.join(",")}else return encodeReserved(ue)})}}}const{Request,fetch:fetch$1}=createFetch(),hasProp=(Y,X)=>Object.prototype.hasOwnProperty.call(Y,X),checkIfFeedContainsFocusedVehicleId=(Y,X)=>{const ee=Y==null?void 0:Y.entity;return Array.isArray(ee)?ee.some(ne=>{var te,ue;return((ue=(te=ne.vehicle)==null?void 0:te.vehicle)==null?void 0:ue.id)===X}):!1},checkIfFeedContainsFocusedTripId=(Y,X)=>{const ee=Y==null?void 0:Y.entity;if(Array.isArray(ee))return ee.some(ne=>{var te,ue,se,ie;return((ue=(te=ne.vehicle)==null?void 0:te.trip)==null?void 0:ue.trip_id)===X||((ie=(se=ne.trip_update)==null?void 0:se.trip)==null?void 0:ie.trip_id)===X})},focusStore=(Y,X)=>{const ee=async(ge,xe={})=>{const Re=new Request(ge,{mode:"cors",redirect:"follow",headers:{accept:"application/json"},...xe}),De=await fetch$1(Re);if(!De.ok){const Ie=new Error(`${De.url}: ${De.status} ${De.statusText}`);throw Ie.req=Re,Ie.res=De,Ie}return await De.json()};Y.shapeIdsByTripIdUrl="/shape-ids-by-trip-id.json",X.on("shape-ids-by-trip-id-url:set",ge=>{Y.shapeIdsByTripIdUrl!==ge&&(Y.shapeIdsByTripIdUrl=ge,se(),X.emit(X.STATE_CHANGE))});let ne=new AbortController;const te=async()=>(ne=new AbortController,console.debug(`fetching shape IDs from ${Y.shapeIdsByTripIdUrl}`),await ee(Y.shapeIdsByTripIdUrl,{signal:ne.signal}));let ue={};const se=()=>{ne.abort(),te().then(ge=>{ue=ge,_e()}).catch(ge=>{console.error("failed to fetch shape IDs",ge)})};Y.shapeUrl="/shapes/{shape_id}.geo.json";let ie=parseTemplate(Y.shapeUrl);X.on("shape-url:set",ge=>{Y.shapeUrl!==ge&&(Y.shapeUrl=ge,ie=parseTemplate(Y.shapeUrl),_e(),X.emit(X.STATE_CHANGE))}),Y.focusedVehicleId=null,Y.focusedVehiclePosition=null;const t=()=>{var xe;if(Y.focusedVehicleId===null)return;if(checkIfFeedContainsFocusedVehicleId(Y.feedData,Y.focusedVehicleId)){const Re=Y.focusedVehicleId,Ie=(((xe=Y.feedData)==null?void 0:xe.entity)||[]).find(Ce=>{var Ue,Le;return((Le=(Ue=Ce.vehicle)==null?void 0:Ue.vehicle)==null?void 0:Le.id)===Re});Ie?Y.focusedVehiclePosition={type:"Feature",properties:{vehicleId:Re},geometry:{type:"Point",coordinates:[Ie.vehicle.position.longitude,Ie.vehicle.position.latitude]}}:Y.focusedVehiclePosition=null,X.emit(X.STATE_CHANGE)}};X.on("feed:data-change",t),X.on("focus-vehicle-id",ge=>{ge!==Y.focusedVehicleId&&(Y.focusedVehicleId=ge,Y.focusedVehiclePosition=null,t(),X.emit(X.STATE_CHANGE))}),Y.focusedTripId=null,Y.focusedTripShape=null;const H=()=>{Y.focusedTripId!==null&&checkIfFeedContainsFocusedTripId(Y.feedData,Y.focusedTripId)};X.on("feed:data-change",H);let ae=new AbortController;const he=async(ge,xe)=>{ae=new AbortController;const Re=ie.expand({shape_id:ge});console.debug(`fetching shape ${ge} for trip ${xe} from ${Re}`);const De=Date.now(),Ie=await ee(Re,{signal:ae.signal});return console.debug(`fetched shape ${ge} in ${Date.now()-De}ms`),Ie},_e=()=>{const ge=Y.focusedTripId;if(ge!==null&&(ae.abort(),ge!==null&&hasProp(ue,ge))){const xe=ue[ge];he(xe,ge).then(Re=>{Y.focusedTripShape=Re,X.emit(X.STATE_CHANGE)}).catch(Re=>{console.error(`failed to fetch shape ${xe} for trip ${ge}`,Re)})}};X.on("focus-trip-id",ge=>{ge!==Y.focusedTripId&&(Y.focusedTripId=ge,Y.focusedTripShape=null,H(),_e(),X.emit(X.STATE_CHANGE))})};var isFunction_1,hasRequiredIsFunction;function requireIsFunction(){if(hasRequiredIsFunction)return isFunction_1;hasRequiredIsFunction=1;var Y=require_baseGetTag(),X=requireIsObject(),ee="[object AsyncFunction]",ne="[object Function]",te="[object GeneratorFunction]",ue="[object Proxy]";function se(ie){if(!X(ie))return!1;var t=Y(ie);return t==ne||t==te||t==ee||t==ue}return isFunction_1=se,isFunction_1}var _coreJsData,hasRequired_coreJsData;function require_coreJsData(){if(hasRequired_coreJsData)return _coreJsData;hasRequired_coreJsData=1;var Y=require_root(),X=Y["__core-js_shared__"];return _coreJsData=X,_coreJsData}var _isMasked,hasRequired_isMasked;function require_isMasked(){if(hasRequired_isMasked)return _isMasked;hasRequired_isMasked=1;var Y=require_coreJsData(),X=function(){var ne=/[^.]+$/.exec(Y&&Y.keys&&Y.keys.IE_PROTO||"");return ne?"Symbol(src)_1."+ne:""}();function ee(ne){return!!X&&X in ne}return _isMasked=ee,_isMasked}var _toSource,hasRequired_toSource;function require_toSource(){if(hasRequired_toSource)return _toSource;hasRequired_toSource=1;var Y=Function.prototype,X=Y.toString;function ee(ne){if(ne!=null){try{return X.call(ne)}catch{}try{return ne+""}catch{}}return""}return _toSource=ee,_toSource}var _baseIsNative,hasRequired_baseIsNative;function require_baseIsNative(){if(hasRequired_baseIsNative)return _baseIsNative;hasRequired_baseIsNative=1;var Y=requireIsFunction(),X=require_isMasked(),ee=requireIsObject(),ne=require_toSource(),te=/[\\^$.*+?()[\]{}|]/g,ue=/^\[object .+?Constructor\]$/,se=Function.prototype,ie=Object.prototype,t=se.toString,H=ie.hasOwnProperty,ae=RegExp("^"+t.call(H).replace(te,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$");function he(_e){if(!ee(_e)||X(_e))return!1;var ge=Y(_e)?ae:ue;return ge.test(ne(_e))}return _baseIsNative=he,_baseIsNative}var _getValue,hasRequired_getValue;function require_getValue(){if(hasRequired_getValue)return _getValue;hasRequired_getValue=1;function Y(X,ee){return X==null?void 0:X[ee]}return _getValue=Y,_getValue}var _getNative,hasRequired_getNative;function require_getNative(){if(hasRequired_getNative)return _getNative;hasRequired_getNative=1;var Y=require_baseIsNative(),X=require_getValue();function ee(ne,te){var ue=X(ne,te);return Y(ue)?ue:void 0}return _getNative=ee,_getNative}var _nativeCreate,hasRequired_nativeCreate;function require_nativeCreate(){if(hasRequired_nativeCreate)return _nativeCreate;hasRequired_nativeCreate=1;var Y=require_getNative(),X=Y(Object,"create");return _nativeCreate=X,_nativeCreate}var _hashClear,hasRequired_hashClear;function require_hashClear(){if(hasRequired_hashClear)return _hashClear;hasRequired_hashClear=1;var Y=require_nativeCreate();function X(){this.__data__=Y?Y(null):{},this.size=0}return _hashClear=X,_hashClear}var _hashDelete,hasRequired_hashDelete;function require_hashDelete(){if(hasRequired_hashDelete)return _hashDelete;hasRequired_hashDelete=1;function Y(X){var ee=this.has(X)&&delete this.__data__[X];return this.size-=ee?1:0,ee}return _hashDelete=Y,_hashDelete}var _hashGet,hasRequired_hashGet;function require_hashGet(){if(hasRequired_hashGet)return _hashGet;hasRequired_hashGet=1;var Y=require_nativeCreate(),X="__lodash_hash_undefined__",ee=Object.prototype,ne=ee.hasOwnProperty;function te(ue){var se=this.__data__;if(Y){var ie=se[ue];return ie===X?void 0:ie}return ne.call(se,ue)?se[ue]:void 0}return _hashGet=te,_hashGet}var _hashHas,hasRequired_hashHas;function require_hashHas(){if(hasRequired_hashHas)return _hashHas;hasRequired_hashHas=1;var Y=require_nativeCreate(),X=Object.prototype,ee=X.hasOwnProperty;function ne(te){var ue=this.__data__;return Y?ue[te]!==void 0:ee.call(ue,te)}return _hashHas=ne,_hashHas}var _hashSet,hasRequired_hashSet;function require_hashSet(){if(hasRequired_hashSet)return _hashSet;hasRequired_hashSet=1;var Y=require_nativeCreate(),X="__lodash_hash_undefined__";function ee(ne,te){var ue=this.__data__;return this.size+=this.has(ne)?0:1,ue[ne]=Y&&te===void 0?X:te,this}return _hashSet=ee,_hashSet}var _Hash,hasRequired_Hash;function require_Hash(){if(hasRequired_Hash)return _Hash;hasRequired_Hash=1;var Y=require_hashClear(),X=require_hashDelete(),ee=require_hashGet(),ne=require_hashHas(),te=require_hashSet();function ue(se){var ie=-1,t=se==null?0:se.length;for(this.clear();++ie<t;){var H=se[ie];this.set(H[0],H[1])}}return ue.prototype.clear=Y,ue.prototype.delete=X,ue.prototype.get=ee,ue.prototype.has=ne,ue.prototype.set=te,_Hash=ue,_Hash}var _listCacheClear,hasRequired_listCacheClear;function require_listCacheClear(){if(hasRequired_listCacheClear)return _listCacheClear;hasRequired_listCacheClear=1;function Y(){this.__data__=[],this.size=0}return _listCacheClear=Y,_listCacheClear}var eq_1,hasRequiredEq;function requireEq(){if(hasRequiredEq)return eq_1;hasRequiredEq=1;function Y(X,ee){return X===ee||X!==X&&ee!==ee}return eq_1=Y,eq_1}var _assocIndexOf,hasRequired_assocIndexOf;function require_assocIndexOf(){if(hasRequired_assocIndexOf)return _assocIndexOf;hasRequired_assocIndexOf=1;var Y=requireEq();function X(ee,ne){for(var te=ee.length;te--;)if(Y(ee[te][0],ne))return te;return-1}return _assocIndexOf=X,_assocIndexOf}var _listCacheDelete,hasRequired_listCacheDelete;function require_listCacheDelete(){if(hasRequired_listCacheDelete)return _listCacheDelete;hasRequired_listCacheDelete=1;var Y=require_assocIndexOf(),X=Array.prototype,ee=X.splice;function ne(te){var ue=this.__data__,se=Y(ue,te);if(se<0)return!1;var ie=ue.length-1;return se==ie?ue.pop():ee.call(ue,se,1),--this.size,!0}return _listCacheDelete=ne,_listCacheDelete}var _listCacheGet,hasRequired_listCacheGet;function require_listCacheGet(){if(hasRequired_listCacheGet)return _listCacheGet;hasRequired_listCacheGet=1;var Y=require_assocIndexOf();function X(ee){var ne=this.__data__,te=Y(ne,ee);return te<0?void 0:ne[te][1]}return _listCacheGet=X,_listCacheGet}var _listCacheHas,hasRequired_listCacheHas;function require_listCacheHas(){if(hasRequired_listCacheHas)return _listCacheHas;hasRequired_listCacheHas=1;var Y=require_assocIndexOf();function X(ee){return Y(this.__data__,ee)>-1}return _listCacheHas=X,_listCacheHas}var _listCacheSet,hasRequired_listCacheSet;function require_listCacheSet(){if(hasRequired_listCacheSet)return _listCacheSet;hasRequired_listCacheSet=1;var Y=require_assocIndexOf();function X(ee,ne){var te=this.__data__,ue=Y(te,ee);return ue<0?(++this.size,te.push([ee,ne])):te[ue][1]=ne,this}return _listCacheSet=X,_listCacheSet}var _ListCache,hasRequired_ListCache;function require_ListCache(){if(hasRequired_ListCache)return _ListCache;hasRequired_ListCache=1;var Y=require_listCacheClear(),X=require_listCacheDelete(),ee=require_listCacheGet(),ne=require_listCacheHas(),te=require_listCacheSet();function ue(se){var ie=-1,t=se==null?0:se.length;for(this.clear();++ie<t;){var H=se[ie];this.set(H[0],H[1])}}return ue.prototype.clear=Y,ue.prototype.delete=X,ue.prototype.get=ee,ue.prototype.has=ne,ue.prototype.set=te,_ListCache=ue,_ListCache}var _Map,hasRequired_Map;function require_Map(){if(hasRequired_Map)return _Map;hasRequired_Map=1;var Y=require_getNative(),X=require_root(),ee=Y(X,"Map");return _Map=ee,_Map}var _mapCacheClear,hasRequired_mapCacheClear;function require_mapCacheClear(){if(hasRequired_mapCacheClear)return _mapCacheClear;hasRequired_mapCacheClear=1;var Y=require_Hash(),X=require_ListCache(),ee=require_Map();function ne(){this.size=0,this.__data__={hash:new Y,map:new(ee||X),string:new Y}}return _mapCacheClear=ne,_mapCacheClear}var _isKeyable,hasRequired_isKeyable;function require_isKeyable(){if(hasRequired_isKeyable)return _isKeyable;hasRequired_isKeyable=1;function Y(X){var ee=typeof X;return ee=="string"||ee=="number"||ee=="symbol"||ee=="boolean"?X!=="__proto__":X===null}return _isKeyable=Y,_isKeyable}var _getMapData,hasRequired_getMapData;function require_getMapData(){if(hasRequired_getMapData)return _getMapData;hasRequired_getMapData=1;var Y=require_isKeyable();function X(ee,ne){var te=ee.__data__;return Y(ne)?te[typeof ne=="string"?"string":"hash"]:te.map}return _getMapData=X,_getMapData}var _mapCacheDelete,hasRequired_mapCacheDelete;function require_mapCacheDelete(){if(hasRequired_mapCacheDelete)return _mapCacheDelete;hasRequired_mapCacheDelete=1;var Y=require_getMapData();function X(ee){var ne=Y(this,ee).delete(ee);return this.size-=ne?1:0,ne}return _mapCacheDelete=X,_mapCacheDelete}var _mapCacheGet,hasRequired_mapCacheGet;function require_mapCacheGet(){if(hasRequired_mapCacheGet)return _mapCacheGet;hasRequired_mapCacheGet=1;var Y=require_getMapData();function X(ee){return Y(this,ee).get(ee)}return _mapCacheGet=X,_mapCacheGet}var _mapCacheHas,hasRequired_mapCacheHas;function require_mapCacheHas(){if(hasRequired_mapCacheHas)return _mapCacheHas;hasRequired_mapCacheHas=1;var Y=require_getMapData();function X(ee){return Y(this,ee).has(ee)}return _mapCacheHas=X,_mapCacheHas}var _mapCacheSet,hasRequired_mapCacheSet;function require_mapCacheSet(){if(hasRequired_mapCacheSet)return _mapCacheSet;hasRequired_mapCacheSet=1;var Y=require_getMapData();function X(ee,ne){var te=Y(this,ee),ue=te.size;return te.set(ee,ne),this.size+=te.size==ue?0:1,this}return _mapCacheSet=X,_mapCacheSet}var _MapCache,hasRequired_MapCache;function require_MapCache(){if(hasRequired_MapCache)return _MapCache;hasRequired_MapCache=1;var Y=require_mapCacheClear(),X=require_mapCacheDelete(),ee=require_mapCacheGet(),ne=require_mapCacheHas(),te=require_mapCacheSet();function ue(se){var ie=-1,t=se==null?0:se.length;for(this.clear();++ie<t;){var H=se[ie];this.set(H[0],H[1])}}return ue.prototype.clear=Y,ue.prototype.delete=X,ue.prototype.get=ee,ue.prototype.has=ne,ue.prototype.set=te,_MapCache=ue,_MapCache}var memoize_1,hasRequiredMemoize;function requireMemoize(){if(hasRequiredMemoize)return memoize_1;hasRequiredMemoize=1;var Y=require_MapCache(),X="Expected a function";function ee(ne,te){if(typeof ne!="function"||te!=null&&typeof te!="function")throw new TypeError(X);var ue=function(){var se=arguments,ie=te?te.apply(this,se):se[0],t=ue.cache;if(t.has(ie))return t.get(ie);var H=ne.apply(this,se);return ue.cache=t.set(ie,H)||t,H};return ue.cache=new(ee.Cache||Y),ue}return ee.Cache=Y,memoize_1=ee,memoize_1}var memoizeExports=requireMemoize();const memoize=getDefaultExportFromCjs(memoizeExports);var isArray_1,hasRequiredIsArray;function requireIsArray(){if(hasRequiredIsArray)return isArray_1;hasRequiredIsArray=1;var Y=Array.isArray;return isArray_1=Y,isArray_1}var _isKey,hasRequired_isKey;function require_isKey(){if(hasRequired_isKey)return _isKey;hasRequired_isKey=1;var Y=requireIsArray(),X=requireIsSymbol(),ee=/\.|\[(?:[^[\]]*|(["'])(?:(?!\1)[^\\]|\\.)*?\1)\]/,ne=/^\w*$/;function te(ue,se){if(Y(ue))return!1;var ie=typeof ue;return ie=="number"||ie=="symbol"||ie=="boolean"||ue==null||X(ue)?!0:ne.test(ue)||!ee.test(ue)||se!=null&&ue in Object(se)}return _isKey=te,_isKey}var _memoizeCapped,hasRequired_memoizeCapped;function require_memoizeCapped(){if(hasRequired_memoizeCapped)return _memoizeCapped;hasRequired_memoizeCapped=1;var Y=requireMemoize(),X=500;function ee(ne){var te=Y(ne,function(se){return ue.size===X&&ue.clear(),se}),ue=te.cache;return te}return _memoizeCapped=ee,_memoizeCapped}var _stringToPath,hasRequired_stringToPath;function require_stringToPath(){if(hasRequired_stringToPath)return _stringToPath;hasRequired_stringToPath=1;var Y=require_memoizeCapped(),X=/[^.[\]]+|\[(?:(-?\d+(?:\.\d+)?)|(["'])((?:(?!\2)[^\\]|\\.)*?)\2)\]|(?=(?:\.|\[\])(?:\.|\[\]|$))/g,ee=/\\(\\)?/g,ne=Y(function(te){var ue=[];return te.charCodeAt(0)===46&&ue.push(""),te.replace(X,function(se,ie,t,H){ue.push(t?H.replace(ee,"$1"):ie||se)}),ue});return _stringToPath=ne,_stringToPath}var _arrayMap,hasRequired_arrayMap;function require_arrayMap(){if(hasRequired_arrayMap)return _arrayMap;hasRequired_arrayMap=1;function Y(X,ee){for(var ne=-1,te=X==null?0:X.length,ue=Array(te);++ne<te;)ue[ne]=ee(X[ne],ne,X);return ue}return _arrayMap=Y,_arrayMap}var _baseToString,hasRequired_baseToString;function require_baseToString(){if(hasRequired_baseToString)return _baseToString;hasRequired_baseToString=1;var Y=require_Symbol(),X=require_arrayMap(),ee=requireIsArray(),ne=requireIsSymbol(),te=Y?Y.prototype:void 0,ue=te?te.toString:void 0;function se(ie){if(typeof ie=="string")return ie;if(ee(ie))return X(ie,se)+"";if(ne(ie))return ue?ue.call(ie):"";var t=ie+"";return t=="0"&&1/ie==-1/0?"-0":t}return _baseToString=se,_baseToString}var toString_1,hasRequiredToString;function requireToString(){if(hasRequiredToString)return toString_1;hasRequiredToString=1;var Y=require_baseToString();function X(ee){return ee==null?"":Y(ee)}return toString_1=X,toString_1}var _castPath,hasRequired_castPath;function require_castPath(){if(hasRequired_castPath)return _castPath;hasRequired_castPath=1;var Y=requireIsArray(),X=require_isKey(),ee=require_stringToPath(),ne=requireToString();function te(ue,se){return Y(ue)?ue:X(ue,se)?[ue]:ee(ne(ue))}return _castPath=te,_castPath}var _toKey,hasRequired_toKey;function require_toKey(){if(hasRequired_toKey)return _toKey;hasRequired_toKey=1;var Y=requireIsSymbol();function X(ee){if(typeof ee=="string"||Y(ee))return ee;var ne=ee+"";return ne=="0"&&1/ee==-1/0?"-0":ne}return _toKey=X,_toKey}var _baseGet,hasRequired_baseGet;function require_baseGet(){if(hasRequired_baseGet)return _baseGet;hasRequired_baseGet=1;var Y=require_castPath(),X=require_toKey();function ee(ne,te){te=Y(te,ne);for(var ue=0,se=te.length;ne!=null&&ue<se;)ne=ne[X(te[ue++])];return ue&&ue==se?ne:void 0}return _baseGet=ee,_baseGet}var _defineProperty,hasRequired_defineProperty;function require_defineProperty(){if(hasRequired_defineProperty)return _defineProperty;hasRequired_defineProperty=1;var Y=require_getNative(),X=function(){try{var ee=Y(Object,"defineProperty");return ee({},"",{}),ee}catch{}}();return _defineProperty=X,_defineProperty}var _baseAssignValue,hasRequired_baseAssignValue;function require_baseAssignValue(){if(hasRequired_baseAssignValue)return _baseAssignValue;hasRequired_baseAssignValue=1;var Y=require_defineProperty();function X(ee,ne,te){ne=="__proto__"&&Y?Y(ee,ne,{configurable:!0,enumerable:!0,value:te,writable:!0}):ee[ne]=te}return _baseAssignValue=X,_baseAssignValue}var _assignValue,hasRequired_assignValue;function require_assignValue(){if(hasRequired_assignValue)return _assignValue;hasRequired_assignValue=1;var Y=require_baseAssignValue(),X=requireEq(),ee=Object.prototype,ne=ee.hasOwnProperty;function te(ue,se,ie){var t=ue[se];(!(ne.call(ue,se)&&X(t,ie))||ie===void 0&&!(se in ue))&&Y(ue,se,ie)}return _assignValue=te,_assignValue}var _isIndex,hasRequired_isIndex;function require_isIndex(){if(hasRequired_isIndex)return _isIndex;hasRequired_isIndex=1;var Y=9007199254740991,X=/^(?:0|[1-9]\d*)$/;function ee(ne,te){var ue=typeof ne;return te=te??Y,!!te&&(ue=="number"||ue!="symbol"&&X.test(ne))&&ne>-1&&ne%1==0&&ne<te}return _isIndex=ee,_isIndex}var _baseSet,hasRequired_baseSet;function require_baseSet(){if(hasRequired_baseSet)return _baseSet;hasRequired_baseSet=1;var Y=require_assignValue(),X=require_castPath(),ee=require_isIndex(),ne=requireIsObject(),te=require_toKey();function ue(se,ie,t,H){if(!ne(se))return se;ie=X(ie,se);for(var ae=-1,he=ie.length,_e=he-1,ge=se;ge!=null&&++ae<he;){var xe=te(ie[ae]),Re=t;if(xe==="__proto__"||xe==="constructor"||xe==="prototype")return se;if(ae!=_e){var De=ge[xe];Re=H?H(De,xe,ge):void 0,Re===void 0&&(Re=ne(De)?De:ee(ie[ae+1])?[]:{})}Y(ge,xe,Re),ge=ge[xe]}return se}return _baseSet=ue,_baseSet}var _basePickBy,hasRequired_basePickBy;function require_basePickBy(){if(hasRequired_basePickBy)return _basePickBy;hasRequired_basePickBy=1;var Y=require_baseGet(),X=require_baseSet(),ee=require_castPath();function ne(te,ue,se){for(var ie=-1,t=ue.length,H={};++ie<t;){var ae=ue[ie],he=Y(te,ae);se(he,ae)&&X(H,ee(ae,te),he)}return H}return _basePickBy=ne,_basePickBy}var _baseHasIn,hasRequired_baseHasIn;function require_baseHasIn(){if(hasRequired_baseHasIn)return _baseHasIn;hasRequired_baseHasIn=1;function Y(X,ee){return X!=null&&ee in Object(X)}return _baseHasIn=Y,_baseHasIn}var _baseIsArguments,hasRequired_baseIsArguments;function require_baseIsArguments(){if(hasRequired_baseIsArguments)return _baseIsArguments;hasRequired_baseIsArguments=1;var Y=require_baseGetTag(),X=requireIsObjectLike(),ee="[object Arguments]";function ne(te){return X(te)&&Y(te)==ee}return _baseIsArguments=ne,_baseIsArguments}var isArguments_1,hasRequiredIsArguments;function requireIsArguments(){if(hasRequiredIsArguments)return isArguments_1;hasRequiredIsArguments=1;var Y=require_baseIsArguments(),X=requireIsObjectLike(),ee=Object.prototype,ne=ee.hasOwnProperty,te=ee.propertyIsEnumerable,ue=Y(function(){return arguments}())?Y:function(se){return X(se)&&ne.call(se,"callee")&&!te.call(se,"callee")};return isArguments_1=ue,isArguments_1}var isLength_1,hasRequiredIsLength;function requireIsLength(){if(hasRequiredIsLength)return isLength_1;hasRequiredIsLength=1;var Y=9007199254740991;function X(ee){return typeof ee=="number"&&ee>-1&&ee%1==0&&ee<=Y}return isLength_1=X,isLength_1}var _hasPath,hasRequired_hasPath;function require_hasPath(){if(hasRequired_hasPath)return _hasPath;hasRequired_hasPath=1;var Y=require_castPath(),X=requireIsArguments(),ee=requireIsArray(),ne=require_isIndex(),te=requireIsLength(),ue=require_toKey();function se(ie,t,H){t=Y(t,ie);for(var ae=-1,he=t.length,_e=!1;++ae<he;){var ge=ue(t[ae]);if(!(_e=ie!=null&&H(ie,ge)))break;ie=ie[ge]}return _e||++ae!=he?_e:(he=ie==null?0:ie.length,!!he&&te(he)&&ne(ge,he)&&(ee(ie)||X(ie)))}return _hasPath=se,_hasPath}var hasIn_1,hasRequiredHasIn;function requireHasIn(){if(hasRequiredHasIn)return hasIn_1;hasRequiredHasIn=1;var Y=require_baseHasIn(),X=require_hasPath();function ee(ne,te){return ne!=null&&X(ne,te,Y)}return hasIn_1=ee,hasIn_1}var _basePick,hasRequired_basePick;function require_basePick(){if(hasRequired_basePick)return _basePick;hasRequired_basePick=1;var Y=require_basePickBy(),X=requireHasIn();function ee(ne,te){return Y(ne,te,function(ue,se){return X(ne,se)})}return _basePick=ee,_basePick}var _arrayPush,hasRequired_arrayPush;function require_arrayPush(){if(hasRequired_arrayPush)return _arrayPush;hasRequired_arrayPush=1;function Y(X,ee){for(var ne=-1,te=ee.length,ue=X.length;++ne<te;)X[ue+ne]=ee[ne];return X}return _arrayPush=Y,_arrayPush}var _isFlattenable,hasRequired_isFlattenable;function require_isFlattenable(){if(hasRequired_isFlattenable)return _isFlattenable;hasRequired_isFlattenable=1;var Y=require_Symbol(),X=requireIsArguments(),ee=requireIsArray(),ne=Y?Y.isConcatSpreadable:void 0;function te(ue){return ee(ue)||X(ue)||!!(ne&&ue&&ue[ne])}return _isFlattenable=te,_isFlattenable}var _baseFlatten,hasRequired_baseFlatten;function require_baseFlatten(){if(hasRequired_baseFlatten)return _baseFlatten;hasRequired_baseFlatten=1;var Y=require_arrayPush(),X=require_isFlattenable();function ee(ne,te,ue,se,ie){var t=-1,H=ne.length;for(ue||(ue=X),ie||(ie=[]);++t<H;){var ae=ne[t];te>0&&ue(ae)?te>1?ee(ae,te-1,ue,se,ie):Y(ie,ae):se||(ie[ie.length]=ae)}return ie}return _baseFlatten=ee,_baseFlatten}var flatten_1,hasRequiredFlatten;function requireFlatten(){if(hasRequiredFlatten)return flatten_1;hasRequiredFlatten=1;var Y=require_baseFlatten();function X(ee){var ne=ee==null?0:ee.length;return ne?Y(ee,1):[]}return flatten_1=X,flatten_1}var _apply,hasRequired_apply;function require_apply(){if(hasRequired_apply)return _apply;hasRequired_apply=1;function Y(X,ee,ne){switch(ne.length){case 0:return X.call(ee);case 1:return X.call(ee,ne[0]);case 2:return X.call(ee,ne[0],ne[1]);case 3:return X.call(ee,ne[0],ne[1],ne[2])}return X.apply(ee,ne)}return _apply=Y,_apply}var _overRest,hasRequired_overRest;function require_overRest(){if(hasRequired_overRest)return _overRest;hasRequired_overRest=1;var Y=require_apply(),X=Math.max;function ee(ne,te,ue){return te=X(te===void 0?ne.length-1:te,0),function(){for(var se=arguments,ie=-1,t=X(se.length-te,0),H=Array(t);++ie<t;)H[ie]=se[te+ie];ie=-1;for(var ae=Array(te+1);++ie<te;)ae[ie]=se[ie];return ae[te]=ue(H),Y(ne,this,ae)}}return _overRest=ee,_overRest}var constant_1,hasRequiredConstant;function requireConstant(){if(hasRequiredConstant)return constant_1;hasRequiredConstant=1;function Y(X){return function(){return X}}return constant_1=Y,constant_1}var identity_1,hasRequiredIdentity;function requireIdentity(){if(hasRequiredIdentity)return identity_1;hasRequiredIdentity=1;function Y(X){return X}return identity_1=Y,identity_1}var _baseSetToString,hasRequired_baseSetToString;function require_baseSetToString(){if(hasRequired_baseSetToString)return _baseSetToString;hasRequired_baseSetToString=1;var Y=requireConstant(),X=require_defineProperty(),ee=requireIdentity(),ne=X?function(te,ue){return X(te,"toString",{configurable:!0,enumerable:!1,value:Y(ue),writable:!0})}:ee;return _baseSetToString=ne,_baseSetToString}var _shortOut,hasRequired_shortOut;function require_shortOut(){if(hasRequired_shortOut)return _shortOut;hasRequired_shortOut=1;var Y=800,X=16,ee=Date.now;function ne(te){var ue=0,se=0;return function(){var ie=ee(),t=X-(ie-se);if(se=ie,t>0){if(++ue>=Y)return arguments[0]}else ue=0;return te.apply(void 0,arguments)}}return _shortOut=ne,_shortOut}var _setToString,hasRequired_setToString;function require_setToString(){if(hasRequired_setToString)return _setToString;hasRequired_setToString=1;var Y=require_baseSetToString(),X=require_shortOut(),ee=X(Y);return _setToString=ee,_setToString}var _flatRest,hasRequired_flatRest;function require_flatRest(){if(hasRequired_flatRest)return _flatRest;hasRequired_flatRest=1;var Y=requireFlatten(),X=require_overRest(),ee=require_setToString();function ne(te){return ee(X(te,void 0,Y),te+"")}return _flatRest=ne,_flatRest}var pick_1,hasRequiredPick;function requirePick(){if(hasRequiredPick)return pick_1;hasRequiredPick=1;var Y=require_basePick(),X=require_flatRest(),ee=X(function(ne,te){return ne==null?{}:Y(ne,te)});return pick_1=ee,pick_1}var pickExports=requirePick();const pick$1=getDefaultExportFromCjs(pickExports),token="%[a-f0-9]{2}",singleMatcher=new RegExp("("+token+")|([^%]+?)","gi"),multiMatcher=new RegExp("("+token+")+","gi");function decodeComponents(Y,X){try{return[decodeURIComponent(Y.join(""))]}catch{}if(Y.length===1)return Y;X=X||1;const ee=Y.slice(0,X),ne=Y.slice(X);return Array.prototype.concat.call([],decodeComponents(ee),decodeComponents(ne))}function decode$1(Y){try{return decodeURIComponent(Y)}catch{let X=Y.match(singleMatcher)||[];for(let ee=1;ee<X.length;ee++)Y=decodeComponents(X,ee).join(""),X=Y.match(singleMatcher)||[];return Y}}function customDecodeURIComponent(Y){const X={"%FE%FF":"��","%FF%FE":"��"};let ee=multiMatcher.exec(Y);for(;ee;){try{X[ee[0]]=decodeURIComponent(ee[0])}catch{const te=decode$1(ee[0]);te!==ee[0]&&(X[ee[0]]=te)}ee=multiMatcher.exec(Y)}X["%C2"]="�";const ne=Object.keys(X);for(const te of ne)Y=Y.replace(new RegExp(te,"g"),X[te]);return Y}function decodeUriComponent(Y){if(typeof Y!="string")throw new TypeError("Expected `encodedURI` to be of type `string`, got `"+typeof Y+"`");try{return decodeURIComponent(Y)}catch{return customDecodeURIComponent(Y)}}function includeKeys(Y,X){const ee={};if(Array.isArray(X))for(const ne of X){const te=Object.getOwnPropertyDescriptor(Y,ne);te!=null&&te.enumerable&&Object.defineProperty(ee,ne,te)}else for(const ne of Reflect.ownKeys(Y)){const te=Object.getOwnPropertyDescriptor(Y,ne);if(te.enumerable){const ue=Y[ne];X(ne,ue,Y)&&Object.defineProperty(ee,ne,te)}}return ee}function splitOnFirst(Y,X){if(!(typeof Y=="string"&&typeof X=="string"))throw new TypeError("Expected the arguments to be of type `string`");if(Y===""||X==="")return[];const ee=Y.indexOf(X);return ee===-1?[]:[Y.slice(0,ee),Y.slice(ee+X.length)]}const isNullOrUndefined=Y=>Y==null,strictUriEncode=Y=>encodeURIComponent(Y).replaceAll(/[!'()*]/g,X=>`%${X.charCodeAt(0).toString(16).toUpperCase()}`),encodeFragmentIdentifier=Symbol("encodeFragmentIdentifier");function encoderForArrayFormat(Y){switch(Y.arrayFormat){case"index":return X=>(ee,ne)=>{const te=ee.length;return ne===void 0||Y.skipNull&&ne===null||Y.skipEmptyString&&ne===""?ee:ne===null?[...ee,[encode(X,Y),"[",te,"]"].join("")]:[...ee,[encode(X,Y),"[",encode(te,Y),"]=",encode(ne,Y)].join("")]};case"bracket":return X=>(ee,ne)=>ne===void 0||Y.skipNull&&ne===null||Y.skipEmptyString&&ne===""?ee:ne===null?[...ee,[encode(X,Y),"[]"].join("")]:[...ee,[encode(X,Y),"[]=",encode(ne,Y)].join("")];case"colon-list-separator":return X=>(ee,ne)=>ne===void 0||Y.skipNull&&ne===null||Y.skipEmptyString&&ne===""?ee:ne===null?[...ee,[encode(X,Y),":list="].join("")]:[...ee,[encode(X,Y),":list=",encode(ne,Y)].join("")];case"comma":case"separator":case"bracket-separator":{const X=Y.arrayFormat==="bracket-separator"?"[]=":"=";return ee=>(ne,te)=>te===void 0||Y.skipNull&&te===null||Y.skipEmptyString&&te===""?ne:(te=te===null?"":te,ne.length===0?[[encode(ee,Y),X,encode(te,Y)].join("")]:[[ne,encode(te,Y)].join(Y.arrayFormatSeparator)])}default:return X=>(ee,ne)=>ne===void 0||Y.skipNull&&ne===null||Y.skipEmptyString&&ne===""?ee:ne===null?[...ee,encode(X,Y)]:[...ee,[encode(X,Y),"=",encode(ne,Y)].join("")]}}function parserForArrayFormat(Y){let X;switch(Y.arrayFormat){case"index":return(ee,ne,te)=>{if(X=/\[(\d*)]$/.exec(ee),ee=ee.replace(/\[\d*]$/,""),!X){te[ee]=ne;return}te[ee]===void 0&&(te[ee]={}),te[ee][X[1]]=ne};case"bracket":return(ee,ne,te)=>{if(X=/(\[])$/.exec(ee),ee=ee.replace(/\[]$/,""),!X){te[ee]=ne;return}if(te[ee]===void 0){te[ee]=[ne];return}te[ee]=[...te[ee],ne]};case"colon-list-separator":return(ee,ne,te)=>{if(X=/(:list)$/.exec(ee),ee=ee.replace(/:list$/,""),!X){te[ee]=ne;return}if(te[ee]===void 0){te[ee]=[ne];return}te[ee]=[...te[ee],ne]};case"comma":case"separator":return(ee,ne,te)=>{const ue=typeof ne=="string"&&ne.includes(Y.arrayFormatSeparator),se=typeof ne=="string"&&!ue&&decode(ne,Y).includes(Y.arrayFormatSeparator);ne=se?decode(ne,Y):ne;const ie=ue||se?ne.split(Y.arrayFormatSeparator).map(t=>decode(t,Y)):ne===null?ne:decode(ne,Y);te[ee]=ie};case"bracket-separator":return(ee,ne,te)=>{const ue=/(\[])$/.test(ee);if(ee=ee.replace(/\[]$/,""),!ue){te[ee]=ne&&decode(ne,Y);return}const se=ne===null?[]:decode(ne,Y).split(Y.arrayFormatSeparator);if(te[ee]===void 0){te[ee]=se;return}te[ee]=[...te[ee],...se]};default:return(ee,ne,te)=>{if(te[ee]===void 0){te[ee]=ne;return}te[ee]=[...[te[ee]].flat(),ne]}}}function validateArrayFormatSeparator(Y){if(typeof Y!="string"||Y.length!==1)throw new TypeError("arrayFormatSeparator must be single character string")}function encode(Y,X){return X.encode?X.strict?strictUriEncode(Y):encodeURIComponent(Y):Y}function decode(Y,X){return X.decode?decodeUriComponent(Y):Y}function keysSorter(Y){return Array.isArray(Y)?Y.sort():typeof Y=="object"?keysSorter(Object.keys(Y)).sort((X,ee)=>Number(X)-Number(ee)).map(X=>Y[X]):Y}function removeHash(Y){const X=Y.indexOf("#");return X!==-1&&(Y=Y.slice(0,X)),Y}function getHash(Y){let X="";const ee=Y.indexOf("#");return ee!==-1&&(X=Y.slice(ee)),X}function parseValue(Y,X,ee){return ee==="string"&&typeof Y=="string"?Y:typeof ee=="function"&&typeof Y=="string"?ee(Y):ee==="boolean"&&Y===null?!0:ee==="boolean"&&Y!==null&&(Y.toLowerCase()==="true"||Y.toLowerCase()==="false")?Y.toLowerCase()==="true":ee==="boolean"&&Y!==null&&(Y.toLowerCase()==="1"||Y.toLowerCase()==="0")?Y.toLowerCase()==="1":ee==="string[]"&&X.arrayFormat!=="none"&&typeof Y=="string"?[Y]:ee==="number[]"&&X.arrayFormat!=="none"&&!Number.isNaN(Number(Y))&&typeof Y=="string"&&Y.trim()!==""?[Number(Y)]:ee==="number"&&!Number.isNaN(Number(Y))&&typeof Y=="string"&&Y.trim()!==""?Number(Y):X.parseBooleans&&Y!==null&&(Y.toLowerCase()==="true"||Y.toLowerCase()==="false")?Y.toLowerCase()==="true":X.parseNumbers&&!Number.isNaN(Number(Y))&&typeof Y=="string"&&Y.trim()!==""?Number(Y):Y}function extract(Y){Y=removeHash(Y);const X=Y.indexOf("?");return X===-1?"":Y.slice(X+1)}function parse(Y,X){X={decode:!0,sort:!0,arrayFormat:"none",arrayFormatSeparator:",",parseNumbers:!1,parseBooleans:!1,types:Object.create(null),...X},validateArrayFormatSeparator(X.arrayFormatSeparator);const ee=parserForArrayFormat(X),ne=Object.create(null);if(typeof Y!="string"||(Y=Y.trim().replace(/^[?#&]/,""),!Y))return ne;for(const te of Y.split("&")){if(te==="")continue;const ue=X.decode?te.replaceAll("+"," "):te;let[se,ie]=splitOnFirst(ue,"=");se===void 0&&(se=ue),ie=ie===void 0?null:["comma","separator","bracket-separator"].includes(X.arrayFormat)?ie:decode(ie,X),ee(decode(se,X),ie,ne)}for(const[te,ue]of Object.entries(ne))if(typeof ue=="object"&&ue!==null&&X.types[te]!=="string")for(const[se,ie]of Object.entries(ue)){const t=X.types[te]?X.types[te].replace("[]",""):void 0;ue[se]=parseValue(ie,X,t)}else typeof ue=="object"&&ue!==null&&X.types[te]==="string"?ne[te]=Object.values(ue).join(X.arrayFormatSeparator):ne[te]=parseValue(ue,X,X.types[te]);return X.sort===!1?ne:(X.sort===!0?Object.keys(ne).sort():Object.keys(ne).sort(X.sort)).reduce((te,ue)=>{const se=ne[ue];return te[ue]=se&&typeof se=="object"&&!Array.isArray(se)?keysSorter(se):se,te},Object.create(null))}function stringify(Y,X){if(!Y)return"";X={encode:!0,strict:!0,arrayFormat:"none",arrayFormatSeparator:",",...X},validateArrayFormatSeparator(X.arrayFormatSeparator);const ee=se=>X.skipNull&&isNullOrUndefined(Y[se])||X.skipEmptyString&&Y[se]==="",ne=encoderForArrayFormat(X),te={};for(const[se,ie]of Object.entries(Y))ee(se)||(te[se]=ie);const ue=Object.keys(te);return X.sort!==!1&&ue.sort(X.sort),ue.map(se=>{const ie=Y[se];return ie===void 0?"":ie===null?encode(se,X):Array.isArray(ie)?ie.length===0&&X.arrayFormat==="bracket-separator"?encode(se,X)+"[]":ie.reduce(ne(se),[]).join("&"):encode(se,X)+"="+encode(ie,X)}).filter(se=>se.length>0).join("&")}function parseUrl(Y,X){var te;X={decode:!0,...X};let[ee,ne]=splitOnFirst(Y,"#");return ee===void 0&&(ee=Y),{url:((te=ee==null?void 0:ee.split("?"))==null?void 0:te[0])??"",query:parse(extract(Y),X),...X&&X.parseFragmentIdentifier&&ne?{fragmentIdentifier:decode(ne,X)}:{}}}function stringifyUrl(Y,X){X={encode:!0,strict:!0,[encodeFragmentIdentifier]:!0,...X};const ee=removeHash(Y.url).split("?")[0]||"",ne=extract(Y.url),te={...parse(ne,{sort:!1,...X}),...Y.query};let ue=stringify(te,X);ue&&(ue=`?${ue}`);let se=getHash(Y.url);if(typeof Y.fragmentIdentifier=="string"){const ie=new URL(ee);ie.hash=Y.fragmentIdentifier,se=X[encodeFragmentIdentifier]?ie.hash:`#${Y.fragmentIdentifier}`}return`${ee}${ue}${se}`}function pick(Y,X,ee){ee={parseFragmentIdentifier:!0,[encodeFragmentIdentifier]:!1,...ee};const{url:ne,query:te,fragmentIdentifier:ue}=parseUrl(Y,ee);return stringifyUrl({url:ne,query:includeKeys(te,X),fragmentIdentifier:ue},ee)}function exclude(Y,X,ee){const ne=Array.isArray(X)?te=>!X.includes(te):(te,ue)=>!X(te,ue);return pick(Y,ne,ee)}const queryString=Object.freeze(Object.defineProperty({__proto__:null,exclude,extract,parse,parseUrl,pick,stringify,stringifyUrl},Symbol.toStringTag,{value:"Module"})),{parse:_qsParse,stringify:qsStringify}=queryString,qsParse=memoize(_qsParse),decodeString=Y=>Y,decodeBoolean=Y=>Y==="true",decodeInteger=Y=>parseInt(Y),PERSISTED_STATE_FIELDS={feedUrl:{decode:decodeString,apply:(Y,X)=>X.emit("feed:set-url",Y)},feedSyncStopped:{decode:decodeBoolean,apply:(Y,X)=>{X.emit(`feed:${Y?"stop":"start"}-sync`)}},feedSyncInterval:{decode:decodeInteger,apply:(Y,X)=>{X.emit("feed:set-sync-interval",Y)}},feedLogFilter:{decode:decodeString,apply:(Y,X)=>X.emit("feed-log:set-filter",Y)},inspectorFilter:{decode:decodeString,apply:(Y,X)=>X.emit("inspector:set-filter",Y)},view:{decode:decodeString,apply:(Y,X)=>X.emit("view:set",Y)},shapeIdsByTripIdUrl:{decode:decodeString,apply:(Y,X)=>X.emit("shape-ids-by-trip-id-url:set",Y)},shapeUrl:{decode:decodeString,apply:(Y,X)=>X.emit("shape-url:set",Y)},focusedTripId:{decode:decodeString,apply:(Y,X)=>X.emit("focus-trip-id",Y)},focusedVehicleId:{decode:decodeString,apply:(Y,X)=>X.emit("focus-vehicle-id",Y)}},pluckState=Y=>pick$1(Y,Object.keys(PERSISTED_STATE_FIELDS)),urlStore=(Y,X)=>{const ee=ue=>{for(const[se,ie]of Object.entries(ue)){const{decode:t,apply:H}=PERSISTED_STATE_FIELDS[se];H(t(ie),X)}X.emit(X.STATE_CHANGE)};window.addEventListener("popstate",ue=>{const se=pluckState(ue.state||{});ee(se)});const ne=debounce(()=>{const ue=pluckState(Y),se={...qsParse(location.search.slice(1)),...ue},ie="?"+qsStringify(se);ie!==location.search&&history.replaceState(ue,"_",ie)},500,{leading:!0});X.on(X.STATE_CHANGE,ne);const te=pluckState(qsParse(location.search.slice(1)));setTimeout(ee,1,te)},homepage="https://github.com/derhuerst/gtfs-rt-inspector",pkg={homepage},barView=({state:Y,emit:X})=>{const ee=(H,ae)=>{const he=_e=>{_e.metaKey||_e.ctrlKey||(_e.preventDefault(),X("view:set",H))};return u("li",{class:ae?"active":null,children:u("a",{href:"?view="+H,onClick:he,children:H})})},ne=u("ul",{class:"nav",children:[ee("log",Y.view==="log"),ee("inspector",Y.view==="inspector"),ee("map",Y.view==="map"),ee("raw",Y.view==="raw"),u("li",{children:u("a",{href:pkg.homepage,target:"_parent",title:name+" homepage",children:"?"})})]}),te=H=>{X("feed:set-url",H.target.value)},ue=()=>{X("feed:sync")},se=()=>{Y.feedSyncStopped?X("feed:start-sync"):X("feed:stop-sync")},ie=H=>{const ae=parseInt(H.target.value);X("feed:set-sync-interval",ae)},t=u("div",{class:"feed",children:[u("input",{onInput:te,value:Y.feedUrl}),u("input",{class:"interval",type:"number",min:"1",step:"10",onChange:ie,value:Y.feedSyncInterval}),u("button",{class:Y.feedSyncing?"sync syncing":"sync",onClick:ue,disabled:!Y.feedUrl||!!Y.feedSyncing,children:u("span",{children:"↻"})}),u("button",{onClick:se,disabled:!Y.feedUrl,children:Y.feedSyncStopped?"▶️":"⏸"})]});return u("div",{class:"bar",children:[u("div",{class:"logo",children:"🚂🔍"}),ne,t]})};var ms$1,hasRequiredMs;function requireMs(){if(hasRequiredMs)return ms$1;hasRequiredMs=1;var Y=1e3,X=Y*60,ee=X*60,ne=ee*24,te=ne*7,ue=ne*365.25;ms$1=function(ae,he){he=he||{};var _e=typeof ae;if(_e==="string"&&ae.length>0)return se(ae);if(_e==="number"&&isFinite(ae))return he.long?t(ae):ie(ae);throw new Error("val is not a non-empty string or a valid number. val="+JSON.stringify(ae))};function se(ae){if(ae=String(ae),!(ae.length>100)){var he=/^(-?(?:\d+)?\.?\d+) *(milliseconds?|msecs?|ms|seconds?|secs?|s|minutes?|mins?|m|hours?|hrs?|h|days?|d|weeks?|w|years?|yrs?|y)?$/i.exec(ae);if(he){var _e=parseFloat(he[1]),ge=(he[2]||"ms").toLowerCase();switch(ge){case"years":case"year":case"yrs":case"yr":case"y":return _e*ue;case"weeks":case"week":case"w":return _e*te;case"days":case"day":case"d":return _e*ne;case"hours":case"hour":case"hrs":case"hr":case"h":return _e*ee;case"minutes":case"minute":case"mins":case"min":case"m":return _e*X;case"seconds":case"second":case"secs":case"sec":case"s":return _e*Y;case"milliseconds":case"millisecond":case"msecs":case"msec":case"ms":return _e;default:return}}}}function ie(ae){var he=Math.abs(ae);return he>=ne?Math.round(ae/ne)+"d":he>=ee?Math.round(ae/ee)+"h":he>=X?Math.round(ae/X)+"m":he>=Y?Math.round(ae/Y)+"s":ae+"ms"}function t(ae){var he=Math.abs(ae);return he>=ne?H(ae,he,ne,"day"):he>=ee?H(ae,he,ee,"hour"):he>=X?H(ae,he,X,"minute"):he>=Y?H(ae,he,Y,"second"):ae+" ms"}function H(ae,he,_e,ge){var xe=he>=_e*1.5;return Math.round(ae/_e)+" "+ge+(xe?"s":"")}return ms$1}var msExports=requireMs();const ms=getDefaultExportFromCjs(msExports),renderDelay=Y=>typeof Y!="number"?"?":Y===0?"0s":ms(Y*1e3),renderMaxItemsMsg=(Y,X)=>Y<X?null:u("p",{children:["Only ",X," items are displayed. Use the filter search box above to get fewer items."]}),renderFilterInput=(Y,X)=>u("p",{children:u("input",{value:Y??"",onChange:ee=>X(ee.target.value),placeholder:"filter by text"})}),renderTimestamp=Y=>Y?new Date(Y*1e3).toISOString():"?",{SCHEDULED:SCHEDULED$1,SKIPPED,NO_DATA}=gtfsRtBindingsExports.TripUpdate.StopTimeUpdate.ScheduleRelationship,renderStopTimeUpdateScheduleRelationship=Y=>Y===SCHEDULED$1?u("code",{children:u("abbr",{title:"SCHEDULED",children:"SCHED"})}):Y===SKIPPED?u("code",{children:u("abbr",{title:"SKIPPED",children:"SKIP"})}):Y===NO_DATA?u("code",{children:u("abbr",{title:"NO_DATA",children:"NO_DATA"})}):"?",renderFeedLogEntry=Y=>{const{entityId:X,timestamp:ee,routeId:ne,directionId:te,tripId:ue,vehicleId:se,vehicleLabel:ie,stopId:t,scheduleRelationship:H,tArrival:ae,delay:he}=Y;return u("tr",{id:"entity-"+X,children:[u("td",{children:u("code",{children:X})}),u("td",{children:renderTimestamp(ee)}),u("td",{children:u("code",{children:ne})}),u("td",{children:u("code",{children:te})}),u("td",{children:u("code",{children:ue})}),u("td",{children:u("code",{children:se})}),u("td",{children:u("code",{children:ie})}),u("td",{children:u("code",{children:t})}),u("td",{children:renderStopTimeUpdateScheduleRelationship(H)}),u("td",{children:renderTimestamp(ae)}),u("td",{children:renderDelay(he)})]})},logView=({state:Y,emit:X})=>{const{feedLogFilter:ee,feedLog:ne,unfilteredFeedLog:te}=Y,ue=se=>{X("feed-log:set-filter",se)};return u("div",{class:"log",children:[u("h2",{children:["Upcoming ",u("code",{children:"StopTimeUpdate"}),"s (",ne.length," of ",te.length,")"]}),renderFilterInput(ee,ue),renderMaxItemsMsg(ne.length,MAX_LOG_ITEMS),u("table",{children:[u("thead",{children:[u("tr",{children:[u("th",{rowspan:"2",children:u("code",{children:u("abbr",{title:"entity.id",children:"e_id"})})}),u("th",{rowspan:"2",children:u("abbr",{title:"stop_time_update[].timestamp or feed timestamp",children:u("code",{children:"t"})})}),u("th",{colspan:"2",children:u("code",{children:"trip"})}),u("th",{colspan:"3",children:u("code",{children:"vehicle"})}),u("th",{colspan:"4",children:u("code",{children:"stop_time_update"})})]}),u("tr",{children:[u("th",{children:u("code",{children:"route_id"})}),u("th",{children:u("code",{children:u("abbr",{title:"trip.direction_id",children:"dir_id"})})}),u("th",{children:u("code",{children:"trip_id"})}),u("th",{children:u("code",{children:"id"})}),u("th",{children:u("code",{children:"label"})}),u("th",{children:u("code",{children:"stop_id"})}),u("th",{children:u("abbr",{title:"stop_time_update[].schedule_relationship",children:"s_rel"})}),u("th",{children:u("code",{children:u("abbr",{title:"stop_time_update[].arrival.time",children:"arr"})})}),u("th",{children:u("code",{children:u("abbr",{title:"stop_time_update[].arrival.delay",children:"delay"})})})]})]}),u("tbody",{children:ne.map(renderFeedLogEntry)})]})]})},renderStartDate=Y=>typeof Y!="string"||!Y?"?":u("code",{children:u("abbr",{title:Y,children:[Y.slice(4,6),"-",Y.slice(6,8)]})}),renderStartTime=Y=>typeof Y!="string"||!Y?"?":u("code",{children:Y}),{SCHEDULED,ADDED,UNSCHEDULED,CANCELED,DUPLICATED,DELETED}=gtfsRtBindingsExports.TripDescriptor.ScheduleRelationship,renderTripScheduleRelationship=Y=>Y===SCHEDULED?u("code",{children:u("abbr",{title:"SCHEDULED",children:"SCHED"})}):Y===ADDED?u("code",{children:u("abbr",{title:"ADDED",children:"ADD"})}):Y===UNSCHEDULED?u("code",{children:u("abbr",{title:"UNSCHEDULED",children:"UNSCHED"})}):Y===CANCELED?u("code",{children:u("abbr",{title:"CANCELED",children:"CNCL"})}):Y===DUPLICATED?u("code",{children:u("abbr",{title:"DUPLICATED",children:"DUPL"})}):Y===DELETED?u("code",{children:u("abbr",{title:"DELETED",children:"DEL"})}):"?",{INCOMING_AT,STOPPED_AT,IN_TRANSIT_TO}=gtfsRtBindingsExports.VehiclePosition.VehicleStopStatus,renderVehicleStopStatus=Y=>Y===INCOMING_AT?u("code",{children:u("abbr",{title:"INCOMING_AT",children:"INC_AT"})}):Y===STOPPED_AT?u("code",{children:u("abbr",{title:"STOPPED_AT",children:"STOP_AT"})}):Y===IN_TRANSIT_TO?u("code",{children:u("abbr",{title:"IN_TRANSIT_TO",children:"IN_TR_TO"})}):"?",renderPosition=Y=>{if(!Y)return"?";const X=[typeof Y.latitude=="number"?Y.latitude:"?",typeof Y.longitude=="number"?Y.longitude:"?"].join(" | "),ee=typeof Y.latitude=="number"?u("code",{children:Y.latitude.toFixed(3)}):"?",ne=typeof Y.longitude=="number"?u("code",{children:Y.longitude.toFixed(3)}):"?";return u("abbr",{title:X,children:[ee," ",ne]})},{RUNNING_SMOOTHLY,STOP_AND_GO,CONGESTION,SEVERE_CONGESTION}=gtfsRtBindingsExports.VehiclePosition.CongestionLevel,renderCongestionLevel=Y=>Y===1?u("code",{children:u("abbr",{title:"RUNNING_SMOOTHLY",children:"SMOOTH"})}):Y===2?u("code",{children:u("abbr",{title:"STOP_AND_GO",children:"STOP_GO"})}):Y===3?u("code",{children:u("abbr",{title:"CONGESTION",children:"CONG"})}):Y===4?u("code",{children:u("abbr",{title:"SEVERE_CONGESTION",children:"SEV_CONG"})}):"?",{EMPTY,MANY_SEATS_AVAILABLE,FEW_SEATS_AVAILABLE,STANDING_ROOM_ONLY,CRUSHED_STANDING_ROOM_ONLY,FULL,NOT_ACCEPTING_PASSENGERS}=gtfsRtBindingsExports.VehiclePosition.OccupancyStatus,renderOccupancyStatus=Y=>Y===0?u("code",{children:u("abbr",{title:"EMPTY",children:"EMPTY"})}):Y===1?u("code",{children:u("abbr",{title:"MANY_SEATS_AVAILABLE",children:"MANY_SEATS"})}):Y===2?u("code",{children:u("abbr",{title:"FEW_SEATS_AVAILABLE",children:"FEW_SEATS"})}):Y===3?u("code",{children:u("abbr",{title:"STANDING_ROOM_ONLY",children:"STANDING"})}):Y===4?u("code",{children:u("abbr",{title:"CRUSHED_STANDING_ROOM_ONLY",children:"CRUSHED"})}):Y===5?u("code",{children:u("abbr",{title:"FULL",children:"FULL"})}):Y===6?u("code",{children:u("abbr",{title:"NOT_ACCEPTING_PASSENGERS",children:"NOT_ACCEPT"})}):"?",renderVehicleId=(Y,X,ee)=>u("a",{href:"#",onClick:te=>{ee("focus-vehicle-id",Y),ee("focus-trip-id",X.trip.trip_id),ee("view:set","map"),te.preventDefault()},alt:"show vehicle on the map",children:u("code",{children:Y})}),renderTripUpdate=(Y,X)=>{const ee=Y.trip_update.trip||{},ne=Y.trip_update.vehicle||{};return u("tr",{id:"entity-"+Y.id,children:[u("td",{children:u("code",{children:Y.id})}),u("td",{children:u("code",{children:ee.route_id})}),u("td",{children:u("code",{children:ee.direction_id})}),u("td",{children:u("code",{children:ee.trip_id})}),u("td",{children:renderStartDate(ee.start_date)}),u("td",{children:renderStartTime(ee.start_time)}),u("td",{children:renderTripScheduleRelationship(ee.schedule_relationship)}),u("td",{children:u("code",{children:ne.id})}),u("td",{children:u("code",{children:ne.label})}),u("td",{children:u("code",{children:ne.license_plate})}),u("td",{children:renderDelay(Y.trip_update.delay)})]})},renderTripUpdates=(Y,X)=>{const{tripUpdates:ee,unfilteredTripUpdates:ne}=Y;return u("div",{children:[u("h2",{children:[u("code",{children:"TripUpdate"}),"s (",ee.length," of ",ne.length,")"]}),renderMaxItemsMsg(ee.length,MAX_LOG_ITEMS),u("table",{class:"trip-updates",children:[u("thead",{children:[u("tr",{children:[u("th",{rowspan:"2",children:u("code",{children:u("abbr",{title:"entity_id",children:"e_id"})})}),u("th",{colspan:"5",children:u("code",{children:"trip"})}),u("th",{rowspan:"2",children:u("code",{children:u("abbr",{title:"schedule_relationship",children:"s_rel"})})}),u("th",{colspan:"3",children:u("code",{children:"vehicle"})}),u("th",{rowspan:"2",children:u("code",{children:"delay"})})]}),u("tr",{children:[u("th",{children:u("code",{children:"route_id"})}),u("th",{children:u("code",{children:u("abbr",{title:"direction_id",children:"dir_id"})})}),u("th",{children:u("code",{children:"trip_id"})}),u("th",{children:u("code",{children:u("abbr",{title:"start_date",children:"st_date"})})}),u("th",{children:u("code",{children:u("abbr",{title:"start_time",children:"st_time"})})}),u("th",{children:u("code",{children:"id"})}),u("th",{children:u("code",{children:"label"})}),u("th",{children:u("abbr",{title:"license_plate",children:u("code",{children:"lic_pl"})})})]})]}),u("tbody",{children:ee.map(renderTripUpdate)})]})]})},renderVehiclePosition=(Y,X)=>{const ee=Y.vehicle.trip||{},ne=Y.vehicle.vehicle||{};return u("tr",{id:"entity-"+Y.id,children:[u("td",{children:u("code",{children:Y.id})}),u("td",{children:u("code",{children:ee.route_id})}),u("td",{children:u("code",{children:ee.direction_id})}),u("td",{children:u("code",{children:ee.trip_id})}),u("td",{children:renderStartDate(ee.start_date)}),u("td",{children:renderStartTime(ee.start_time)}),u("td",{children:renderVehicleId(ne.id,Y.vehicle,X)}),u("td",{children:u("code",{children:ne.label})}),u("td",{children:u("code",{children:ne.license_plate})}),u("td",{children:u("code",{children:Y.vehicle.current_stop_sequence})}),u("td",{children:u("code",{children:Y.vehicle.stop_id})}),u("td",{children:renderVehicleStopStatus(Y.vehicle.current_status)}),u("td",{children:renderPosition(Y.vehicle.position)}),u("td",{children:renderCongestionLevel(Y.vehicle.congestion_level)}),u("td",{children:renderOccupancyStatus(Y.vehicle.occupancy_status)})]})},renderVehiclePositions=(Y,X)=>{const{vehiclePositions:ee,unfilteredVehiclePositions:ne}=Y;return u("div",{children:[u("h2",{children:[u("code",{children:"VehiclePosition"}),"s (",ee.length," of ",ne.length,")"]}),renderMaxItemsMsg(ee.length,MAX_LOG_ITEMS),u("table",{class:"vehicle-positions",children:[u("thead",{children:[u("tr",{children:[u("th",{rowspan:"2",children:u("code",{children:u("abbr",{title:"entity_id",children:"e_id"})})}),u("th",{colspan:"5",children:u("code",{children:"trip"})}),u("th",{colspan:"3",children:u("code",{children:"vehicle"})}),u("th",{rowspan:"2",children:u("code",{children:u("abbr",{title:"current_stop_sequence",children:"st_seq"})})}),u("th",{rowspan:"2",children:u("code",{children:"stop_id"})}),u("th",{rowspan:"2",children:u("code",{children:u("abbr",{title:"current_status",children:"status"})})}),u("th",{rowspan:"2",children:u("code",{children:"position"})}),u("th",{rowspan:"2",children:u("code",{children:u("abbr",{title:"congestion_level",children:"cong_lvl"})})}),u("th",{rowspan:"2",children:u("code",{children:u("abbr",{title:"occupancy_status",children:"occu"})})})]}),u("tr",{children:[u("th",{children:u("code",{children:"route_id"})}),u("th",{children:u("code",{children:u("abbr",{title:"direction_id",children:"dir_id"})})}),u("th",{children:u("code",{children:"trip_id"})}),u("th",{children:u("code",{children:u("abbr",{title:"start_date",children:"st_date"})})}),u("th",{children:u("code",{children:u("abbr",{title:"start_time",children:"st_time"})})}),u("th",{children:u("code",{children:"id"})}),u("th",{children:u("code",{children:"label"})}),u("th",{children:u("abbr",{title:"license_plate",children:u("code",{children:"lic_plate"})})})]})]}),u("tbody",{children:ee.map(te=>renderVehiclePosition(te,X))})]})]})},inspectorView=({state:Y,emit:X})=>{const ee=Y.feedData;if(!Array.isArray(ee.entity)||ee.entity.length===0)return u("p",{children:["The feed has no ",u("code",{children:"FeedEntity"}),"s."]});const{inspectorFilter:ne}=Y;return u("div",{class:"inspector",children:[renderFilterInput(ne,ue=>{X("inspector:set-filter",ue)}),renderTripUpdates(Y),renderVehiclePositions(Y,X)]})},MAX_BYTES=1024*1024,feedAsJsonCache=new WeakMap,downloadBlob=(Y,X)=>{const ee=window.document.createElement("a");ee.href=URL.createObjectURL(Y),ee.download=X,document.body.appendChild(ee),ee.click(),document.body.removeChild(ee),setTimeout(()=>{URL.revokeObjectURL(ee.href)},1e3)},rawView=({state:Y})=>{const X=Y.feedData,ee=Y.feedRawData;let ne;feedAsJsonCache.has(X)?ne=feedAsJsonCache.get(X):(ne=JSON.stringify(X,null,2),feedAsJsonCache.set(X,ne));const te=new URL(Y.feedUrl).pathname.split("/"),se=`${te[te.length-1]||"gtfs-rt"}-${new Date().toISOString()}.json`,ie=()=>{const H=new Blob([ne],{type:"application/json"});downloadBlob(H,se)},t=()=>{const H=new Blob([ee],{type:"application/vnd.google.protobuf"});downloadBlob(H,se)};return u("div",{class:"raw",children:[ne.length>MAX_BYTES?u("p",{children:["Truncated to ",MAX_BYTES," of ",ne.length," characters."]}):null,u("p",{children:[u("button",{onClick:ie,children:"download JSON-encoded feed"}),u("button",{onClick:t,children:"download raw Protocol-Buffers-encoded feed"})]}),u("pre",{children:ne.substring(0,MAX_BYTES)})]})};var mapboxGl$1={exports:{}},mapboxGl=mapboxGl$1.exports,hasRequiredMapboxGl;function requireMapboxGl(){return hasRequiredMapboxGl||(hasRequiredMapboxGl=1,function(Y,X){var ee={};(function(ne,te){Y.exports=te()})(mapboxGl,function(){var ne,te,ue;function se(t,H){if(!ne)ne=H;else if(!te)te=H;else{var ae="self.onerror = function() { console.error('An error occurred while parsing the WebWorker bundle. This is most likely due to improper transpilation by Babel; please see https://docs.mapbox.com/mapbox-gl-js/guides/install/#transpiling'); }; var sharedChunk = {}; ("+ne+")(sharedChunk); ("+te+")(sharedChunk); self.onerror = null;",he={};ne(he),ue=H(he),typeof window<"u"&&window&&window.URL&&window.URL.createObjectURL&&(ue.workerUrl=window.URL.createObjectURL(new Blob([ae],{type:"text/javascript"})))}}se(["exports"],function(t){var H=typeof self<"u"?self:{},ae="2.15.0";let he;const _e={API_URL:"https://api.mapbox.com",get API_URL_REGEX(){if(he==null){const R=/^((https?:)?\/\/)?([^\/]+\.)?mapbox\.c(n|om)(\/|\?|$)/i;try{he=ee.API_URL_REGEX!=null?new RegExp(ee.API_URL_REGEX):R}catch{he=R}}return he},get API_TILEJSON_REGEX(){return/^((https?:)?\/\/)?([^\/]+\.)?mapbox\.c(n|om)(\/v[0-9]*\/.*\.json.*$)/i},get API_SPRITE_REGEX(){return/^((https?:)?\/\/)?([^\/]+\.)?mapbox\.c(n|om)(\/styles\/v[0-9]*\/)(.*\/sprite.*\..*$)/i},get API_FONTS_REGEX(){return/^((https?:)?\/\/)?([^\/]+\.)?mapbox\.c(n|om)(\/fonts\/v[0-9]*\/)(.*\.pbf.*$)/i},get API_STYLE_REGEX(){return/^((https?:)?\/\/)?([^\/]+\.)?mapbox\.c(n|om)(\/styles\/v[0-9]*\/)(.*$)/i},get API_CDN_URL_REGEX(){return/^((https?:)?\/\/)?api\.mapbox\.c(n|om)(\/mapbox-gl-js\/)(.*$)/i},get EVENTS_URL(){if(!_e.API_URL)return null;try{const R=new URL(_e.API_URL);return R.hostname==="api.mapbox.cn"?"https://events.mapbox.cn/events/v2":R.hostname==="api.mapbox.com"?"https://events.mapbox.com/events/v2":null}catch{return null}},SESSION_PATH:"/map-sessions/v1",FEEDBACK_URL:"https://apps.mapbox.com/feedback",TILE_URL_VERSION:"v4",RASTER_URL_PREFIX:"raster/v1",REQUIRE_ACCESS_TOKEN:!0,ACCESS_TOKEN:null,MAX_PARALLEL_IMAGE_REQUESTS:16},ge={supported:!1,testSupport:function(R){!De&&Re&&(Ie?Ce(R):xe=R)}};let xe,Re,De=!1,Ie=!1;function Ce(R){const h=R.createTexture();R.bindTexture(R.TEXTURE_2D,h);try{if(R.texImage2D(R.TEXTURE_2D,0,R.RGBA,R.RGBA,R.UNSIGNED_BYTE,Re),R.isContextLost())return;ge.supported=!0}catch{}R.deleteTexture(h),De=!0}H.document&&(Re=H.document.createElement("img"),Re.onload=function(){xe&&Ce(xe),xe=null,Ie=!0},Re.onerror=function(){De=!0,xe=null},Re.src="data:image/webp;base64,UklGRh4AAABXRUJQVlA4TBEAAAAvAQAAAAfQ//73v/+BiOh/AAA=");const Ue="01";function Le(R){return R&&R.__esModule&&Object.prototype.hasOwnProperty.call(R,"default")?R.default:R}var ke=Ge;function Ge(R,h,U,W){this.cx=3*R,this.bx=3*(U-R)-this.cx,this.ax=1-this.cx-this.bx,this.cy=3*h,this.by=3*(W-h)-this.cy,this.ay=1-this.cy-this.by,this.p1x=R,this.p1y=h,this.p2x=U,this.p2y=W}Ge.prototype={sampleCurveX:function(R){return((this.ax*R+this.bx)*R+this.cx)*R},sampleCurveY:function(R){return((this.ay*R+this.by)*R+this.cy)*R},sampleCurveDerivativeX:function(R){return(3*this.ax*R+2*this.bx)*R+this.cx},solveCurveX:function(R,h){if(h===void 0&&(h=1e-6),R<0)return 0;if(R>1)return 1;for(var U=R,W=0;W<8;W++){var K=this.sampleCurveX(U)-R;if(Math.abs(K)<h)return U;var Q=this.sampleCurveDerivativeX(U);if(Math.abs(Q)<1e-6)break;U-=K/Q}var oe=0,ce=1;for(U=R,W=0;W<20&&(K=this.sampleCurveX(U),!(Math.abs(K-R)<h));W++)R>K?oe=U:ce=U,U=.5*(ce-oe)+oe;return U},solve:function(R,h){return this.sampleCurveY(this.solveCurveX(R,h))}};var Ze=Le(ke),We=et;function et(R,h){this.x=R,this.y=h}et.prototype={clone:function(){return new et(this.x,this.y)},add:function(R){return this.clone()._add(R)},sub:function(R){return this.clone()._sub(R)},multByPoint:function(R){return this.clone()._multByPoint(R)},divByPoint:function(R){return this.clone()._divByPoint(R)},mult:function(R){return this.clone()._mult(R)},div:function(R){return this.clone()._div(R)},rotate:function(R){return this.clone()._rotate(R)},rotateAround:function(R,h){return this.clone()._rotateAround(R,h)},matMult:function(R){return this.clone()._matMult(R)},unit:function(){return this.clone()._unit()},perp:function(){return this.clone()._perp()},round:function(){return this.clone()._round()},mag:function(){return Math.sqrt(this.x*this.x+this.y*this.y)},equals:function(R){return this.x===R.x&&this.y===R.y},dist:function(R){return Math.sqrt(this.distSqr(R))},distSqr:function(R){var h=R.x-this.x,U=R.y-this.y;return h*h+U*U},angle:function(){return Math.atan2(this.y,this.x)},angleTo:function(R){return Math.atan2(this.y-R.y,this.x-R.x)},angleWith:function(R){return this.angleWithSep(R.x,R.y)},angleWithSep:function(R,h){return Math.atan2(this.x*h-this.y*R,this.x*R+this.y*h)},_matMult:function(R){var h=R[2]*this.x+R[3]*this.y;return this.x=R[0]*this.x+R[1]*this.y,this.y=h,this},_add:function(R){return this.x+=R.x,this.y+=R.y,this},_sub:function(R){return this.x-=R.x,this.y-=R.y,this},_mult:function(R){return this.x*=R,this.y*=R,this},_div:function(R){return this.x/=R,this.y/=R,this},_multByPoint:function(R){return this.x*=R.x,this.y*=R.y,this},_divByPoint:function(R){return this.x/=R.x,this.y/=R.y,this},_unit:function(){return this._div(this.mag()),this},_perp:function(){var R=this.y;return this.y=this.x,this.x=-R,this},_rotate:function(R){var h=Math.cos(R),U=Math.sin(R),W=U*this.x+h*this.y;return this.x=h*this.x-U*this.y,this.y=W,this},_rotateAround:function(R,h){var U=Math.cos(R),W=Math.sin(R),K=h.y+W*(this.x-h.x)+U*(this.y-h.y);return this.x=h.x+U*(this.x-h.x)-W*(this.y-h.y),this.y=K,this},_round:function(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this}},et.convert=function(R){return R instanceof et?R:Array.isArray(R)?new et(R[0],R[1]):R};var He=Le(We);const ht=Math.PI/180,_t=180/Math.PI;function ut(R){return R*ht}function yt(R){return R*_t}const Lt=[[0,0],[1,0],[1,1],[0,1]];function Kt(R){if(R<=0)return 0;if(R>=1)return 1;const h=R*R,U=h*R;return 4*(R<.5?U:3*(R-h)+U-.75)}function ft(R,h,U,W){const K=new Ze(R,h,U,W);return function(Q){return K.solve(Q)}}const qt=ft(.25,.1,.25,1);function nt(R,h,U){return Math.min(U,Math.max(h,R))}function At(R,h,U){return(U=nt((U-R)/(h-R),0,1))*U*(3-2*U)}function wt(R,h,U){const W=U-h,K=((R-h)%W+W)%W+h;return K===h?U:K}function Ft(R,h,U){if(!R.length)return U(null,[]);let W=R.length;const K=new Array(R.length);let Q=null;R.forEach((oe,ce)=>{h(oe,(fe,pe)=>{fe&&(Q=fe),K[ce]=pe,--W==0&&U(Q,K)})})}function er(R){const h=[];for(const U in R)h.push(R[U]);return h}function lr(R,...h){for(const U of h)for(const W in U)R[W]=U[W];return R}let jr=1;function Mr(){return jr++}function Lr(){return function R(h){return h?(h^Math.random()*(16>>h/4)).toString(16):([1e7]+-[1e3]+-4e3+-8e3+-1e11).replace(/[018]/g,R)}()}function sr(R){return R<=1?1:Math.pow(2,Math.ceil(Math.log(R)/Math.LN2))}function Rr(R){return!!R&&/^[0-9a-f]{8}-[0-9a-f]{4}-[4][0-9a-f]{3}-[89ab][0-9a-f]{3}-[0-9a-f]{12}$/i.test(R)}function Ur(R,h){R.forEach(U=>{h[U]&&(h[U]=h[U].bind(h))})}function Wr(R,h){return R.indexOf(h,R.length-h.length)!==-1}function Er(R,h,U){const W={};for(const K in R)W[K]=h.call(this,R[K],K,R);return W}function Kr(R,h,U){const W={};for(const K in R)h.call(U||this,R[K],K,R)&&(W[K]=R[K]);return W}function ui(R){return Array.isArray(R)?R.map(ui):typeof R=="object"&&R?Er(R,ui):R}const Ei={};function Hr(R){Ei[R]||(typeof console<"u"&&console.warn(R),Ei[R]=!0)}function Br(R,h,U){return(U.y-R.y)*(h.x-R.x)>(h.y-R.y)*(U.x-R.x)}function li(R){let h=0;for(let U,W,K=0,Q=R.length,oe=Q-1;K<Q;oe=K++)U=R[K],W=R[oe],h+=(W.x-U.x)*(U.y+W.y);return h}function si(){return typeof WorkerGlobalScope<"u"&&typeof self<"u"&&self instanceof WorkerGlobalScope}function Qr(R){const h={};if(R.replace(/(?:^|(?:\s*\,\s*))([^\x00-\x20\(\)<>@\,;\:\\"\/\[\]\?\=\{\}\x7F]+)(?:\=(?:([^\x00-\x20\(\)<>@\,;\:\\"\/\[\]\?\=\{\}\x7F]+)|(?:\"((?:[^"\\]|\\.)*)\")))?/g,(U,W,K,Q)=>{const oe=K||Q;return h[W]=!oe||oe.toLowerCase(),""}),h["max-age"]){const U=parseInt(h["max-age"],10);isNaN(U)?delete h["max-age"]:h["max-age"]=U}return h}let _r=null;function vr(R){if(_r==null){const h=R.navigator?R.navigator.userAgent:null;_r=!!R.safari||!(!h||!(/\b(iPad|iPhone|iPod)\b/.test(h)||h.match("Safari")&&!h.match("Chrome")))}return _r}function Xr(R){try{const h=H[R];return h.setItem("_mapbox_test_",1),h.removeItem("_mapbox_test_"),!0}catch{return!1}}function Ir(R,h){return[R[4*h],R[4*h+1],R[4*h+2],R[4*h+3]]}const Or="mapbox-tiles";let Nr=500,je=50,Se,Oe;function Ve(){try{return H.caches}catch{}}function st(){Ve()&&!Se&&(Se=H.caches.open(Or))}function gt(R){const h=R.indexOf("?");if(h<0)return R;const U=function(K){const Q=K.indexOf("?");return Q>0?K.slice(Q+1).split("&"):[]}(R),W=U.filter(K=>{const Q=K.split("=");return Q[0]==="language"||Q[0]==="worldview"});return W.length?`${R.slice(0,h)}?${W.join("&")}`:R.slice(0,h)}let Ot=1/0;const tr={Unknown:"Unknown",Style:"Style",Source:"Source",Tile:"Tile",Glyphs:"Glyphs",SpriteImage:"SpriteImage",SpriteJSON:"SpriteJSON",Image:"Image"};typeof Object.freeze=="function"&&Object.freeze(tr);class Qt extends Error{constructor(h,U,W){U===401&&Mt(W)&&(h+=": you may have provided an invalid Mapbox access token. See https://docs.mapbox.com/api/overview/#access-tokens-and-token-scopes"),super(h),this.status=U,this.url=W}toString(){return`${this.name}: ${this.message} (${this.status}): ${this.url}`}}const xt=si()?()=>self.worker&&self.worker.referrer:()=>(H.location.protocol==="blob:"?H.parent:H).location.href,Ct=function(R,h){if(!(/^file:/.test(U=R.url)||/^file:/.test(xt())&&!/^\w+:/.test(U))){if(H.fetch&&H.Request&&H.AbortController&&H.Request.prototype.hasOwnProperty("signal"))return function(W,K){const Q=new H.AbortController,oe=new H.Request(W.url,{method:W.method||"GET",body:W.body,credentials:W.credentials,headers:W.headers,referrer:xt(),referrerPolicy:W.referrerPolicy,signal:Q.signal});let ce=!1,fe=!1;const pe=(ve=oe.url).indexOf("sku=")>0&&Mt(ve);var ve;W.type==="json"&&oe.headers.set("Accept","application/json");const Ee=(Ae,Pe,ze)=>{if(fe)return;if(Ae&&Ae.message!=="SecurityError"&&Hr(Ae.toString()),Pe&&ze)return we(Pe);const Xe=Date.now();H.fetch(oe).then(at=>{if(at.ok){const mt=pe?at.clone():null;return we(at,mt,Xe)}return K(new Qt(at.statusText,at.status,W.url))}).catch(at=>{at.name!=="AbortError"&&K(new Error(`${at.message} ${W.url}`))})},we=(Ae,Pe,ze)=>{(W.type==="arrayBuffer"?Ae.arrayBuffer():W.type==="json"?Ae.json():Ae.text()).then(Xe=>{fe||(Pe&&ze&&function(at,mt,ot){if(st(),!Se)return;const pt={status:mt.status,statusText:mt.statusText,headers:new H.Headers};mt.headers.forEach(($t,zt)=>pt.headers.set(zt,$t));const Et=Qr(mt.headers.get("Cache-Control")||"");if(Et["no-store"])return;Et["max-age"]&&pt.headers.set("Expires",new Date(ot+1e3*Et["max-age"]).toUTCString());const bt=pt.headers.get("Expires");bt&&(new Date(bt).getTime()-ot<42e4||function($t,zt){if(Oe===void 0)try{new Response(new ReadableStream),Oe=!0}catch{Oe=!1}Oe?zt($t.body):$t.blob().then(zt)}(mt,$t=>{const zt=new H.Response($t,pt);st(),Se&&Se.then(rr=>rr.put(gt(at.url),zt)).catch(rr=>Hr(rr.message))}))}(oe,Pe,ze),ce=!0,K(null,Xe,Ae.headers.get("Cache-Control"),Ae.headers.get("Expires")))}).catch(Xe=>{fe||K(new Error(Xe.message))})};return pe?function(Ae,Pe){if(st(),!Se)return Pe(null);const ze=gt(Ae.url);Se.then(Xe=>{Xe.match(ze).then(at=>{const mt=function(ot){if(!ot)return!1;const pt=new Date(ot.headers.get("Expires")||0),Et=Qr(ot.headers.get("Cache-Control")||"");return pt>Date.now()&&!Et["no-cache"]}(at);Xe.delete(ze),mt&&Xe.put(ze,at.clone()),Pe(null,at,mt)}).catch(Pe)}).catch(Pe)}(oe,Ee):Ee(null,null),{cancel:()=>{fe=!0,ce||Q.abort()}}}(R,h);if(si()&&self.worker&&self.worker.actor)return self.worker.actor.send("getResource",R,h,void 0,!0)}var U;return function(W,K){const Q=new H.XMLHttpRequest;Q.open(W.method||"GET",W.url,!0),W.type==="arrayBuffer"&&(Q.responseType="arraybuffer");for(const oe in W.headers)Q.setRequestHeader(oe,W.headers[oe]);return W.type==="json"&&(Q.responseType="text",Q.setRequestHeader("Accept","application/json")),Q.withCredentials=W.credentials==="include",Q.onerror=()=>{K(new Error(Q.statusText))},Q.onload=()=>{if((Q.status>=200&&Q.status<300||Q.status===0)&&Q.response!==null){let oe=Q.response;if(W.type==="json")try{oe=JSON.parse(Q.response)}catch(ce){return K(ce)}K(null,oe,Q.getResponseHeader("Cache-Control"),Q.getResponseHeader("Expires"))}else K(new Qt(Q.statusText,Q.status,W.url))},Q.send(W.body),{cancel:()=>Q.abort()}}(R,h)},Nt=function(R,h){return Ct(lr(R,{type:"arrayBuffer"}),h)};function dr(R){const h=H.document.createElement("a");return h.href=R,h.protocol===H.document.location.protocol&&h.host===H.document.location.host}const Ke="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAAC0lEQVQYV2NgAAIAAAUAAarVyFEAAAAASUVORK5CYII=";let Me,Ne;Me=[],Ne=0;const rt=function(R,h){if(ge.supported&&(R.headers||(R.headers={}),R.headers.accept="image/webp,*/*"),Ne>=_e.MAX_PARALLEL_IMAGE_REQUESTS){const Q={requestParameters:R,callback:h,cancelled:!1,cancel(){this.cancelled=!0}};return Me.push(Q),Q}Ne++;let U=!1;const W=()=>{if(!U)for(U=!0,Ne--;Me.length&&Ne<_e.MAX_PARALLEL_IMAGE_REQUESTS;){const Q=Me.shift(),{requestParameters:oe,callback:ce,cancelled:fe}=Q;fe||(Q.cancel=rt(oe,ce).cancel)}},K=Nt(R,(Q,oe,ce,fe)=>{W(),Q?h(Q):oe&&(H.createImageBitmap?function(pe,ve){const Ee=new H.Blob([new Uint8Array(pe)],{type:"image/png"});H.createImageBitmap(Ee).then(we=>{ve(null,we)}).catch(we=>{ve(new Error(`Could not load image because of ${we.message}. Please make sure to use a supported image type such as PNG or JPEG. Note that SVGs are not supported.`))})}(oe,(pe,ve)=>h(pe,ve,ce,fe)):function(pe,ve){const Ee=new H.Image,we=H.URL;Ee.onload=()=>{ve(null,Ee),we.revokeObjectURL(Ee.src),Ee.onload=null,H.requestAnimationFrame(()=>{Ee.src=Ke})},Ee.onerror=()=>ve(new Error("Could not load image. Please make sure to use a supported image type such as PNG or JPEG. Note that SVGs are not supported."));const Ae=new H.Blob([new Uint8Array(pe)],{type:"image/png"});Ee.src=pe.byteLength?we.createObjectURL(Ae):Ke}(oe,(pe,ve)=>h(pe,ve,ce,fe)))});return{cancel:()=>{K.cancel(),W()}}},dt="NO_ACCESS_TOKEN";function vt(R){return R.indexOf("mapbox:")===0}function Mt(R){return _e.API_URL_REGEX.test(R)}function Pt(R){return _e.API_CDN_URL_REGEX.test(R)}function St(R){return _e.API_STYLE_REGEX.test(R)&&!Wt(R)}function Wt(R){return _e.API_SPRITE_REGEX.test(R)}const br=/^(\w+):\/\/([^/?]*)(\/[^?]+)?\??(.+)?/;function Ar(R){const h=R.match(br);if(!h)throw new Error("Unable to parse URL object");return{protocol:h[1],authority:h[2],path:h[3]||"/",params:h[4]?h[4].split("&"):[]}}function cr(R){const h=R.params.length?`?${R.params.join("&")}`:"";return`${R.protocol}://${R.authority}${R.path}${h}`}const ti="mapbox.eventData";function ci(R){if(!R)return null;const h=R.split(".");if(!h||h.length!==3)return null;try{return JSON.parse(decodeURIComponent(H.atob(h[1]).split("").map(U=>"%"+("00"+U.charCodeAt(0).toString(16)).slice(-2)).join("")))}catch{return null}}class ni{constructor(h){this.type=h,this.anonId=null,this.eventData={},this.queue=[],this.pendingRequest=null}getStorageKey(h){const U=ci(_e.ACCESS_TOKEN);let W="";return W=U&&U.u?H.btoa(encodeURIComponent(U.u).replace(/%([0-9A-F]{2})/g,(K,Q)=>String.fromCharCode(+("0x"+Q)))):_e.ACCESS_TOKEN||"",h?`${ti}.${h}:${W}`:`${ti}:${W}`}fetchEventData(){const h=Xr("localStorage"),U=this.getStorageKey(),W=this.getStorageKey("uuid");if(h)try{const K=H.localStorage.getItem(U);K&&(this.eventData=JSON.parse(K));const Q=H.localStorage.getItem(W);Q&&(this.anonId=Q)}catch{Hr("Unable to read from LocalStorage")}}saveEventData(){const h=Xr("localStorage"),U=this.getStorageKey(),W=this.getStorageKey("uuid");if(h)try{H.localStorage.setItem(W,this.anonId),Object.keys(this.eventData).length>=1&&H.localStorage.setItem(U,JSON.stringify(this.eventData))}catch{Hr("Unable to write to LocalStorage")}}processRequests(h){}postEvent(h,U,W,K){if(!_e.EVENTS_URL)return;const Q=Ar(_e.EVENTS_URL);Q.params.push(`access_token=${K||_e.ACCESS_TOKEN||""}`);const oe={event:this.type,created:new Date(h).toISOString()},ce=U?lr(oe,U):oe,fe={url:cr(Q),headers:{"Content-Type":"text/plain"},body:JSON.stringify([ce])};this.pendingRequest=function(pe,ve){return Ct(lr(pe,{method:"POST"}),ve)}(fe,pe=>{this.pendingRequest=null,W(pe),this.saveEventData(),this.processRequests(K)})}queueRequest(h,U){this.queue.push(h),this.processRequests(U)}}const oi=new class extends ni{constructor(R){super("appUserTurnstile"),this._customAccessToken=R}postTurnstileEvent(R,h){_e.EVENTS_URL&&_e.ACCESS_TOKEN&&Array.isArray(R)&&R.some(U=>vt(U)||Mt(U))&&this.queueRequest(Date.now(),h)}processRequests(R){if(this.pendingRequest||this.queue.length===0)return;this.anonId&&this.eventData.lastSuccess&&this.eventData.tokenU||this.fetchEventData();const h=ci(_e.ACCESS_TOKEN),U=h?h.u:_e.ACCESS_TOKEN;let W=U!==this.eventData.tokenU;Rr(this.anonId)||(this.anonId=Lr(),W=!0);const K=this.queue.shift();if(this.eventData.lastSuccess){const Q=new Date(this.eventData.lastSuccess),oe=new Date(K),ce=(K-this.eventData.lastSuccess)/864e5;W=W||ce>=1||ce<-1||Q.getDate()!==oe.getDate()}else W=!0;W?this.postEvent(K,{sdkIdentifier:"mapbox-gl-js",sdkVersion:ae,skuId:Ue,"enabled.telemetry":!1,userId:this.anonId},Q=>{Q||(this.eventData.lastSuccess=K,this.eventData.tokenU=U)},R):this.processRequests()}},yi=oi.postTurnstileEvent.bind(oi),Ai=new class extends ni{constructor(){super("map.load"),this.success={},this.skuToken=""}postMapLoadEvent(R,h,U,W){this.skuToken=h,this.errorCb=W,_e.EVENTS_URL&&(U||_e.ACCESS_TOKEN?this.queueRequest({id:R,timestamp:Date.now()},U):this.errorCb(new Error(dt)))}processRequests(R){if(this.pendingRequest||this.queue.length===0)return;const{id:h,timestamp:U}=this.queue.shift();h&&this.success[h]||(this.anonId||this.fetchEventData(),Rr(this.anonId)||(this.anonId=Lr()),this.postEvent(U,{sdkIdentifier:"mapbox-gl-js",sdkVersion:ae,skuId:Ue,skuToken:this.skuToken,userId:this.anonId},W=>{W?this.errorCb(W):h&&(this.success[h]=!0)},R))}},wi=Ai.postMapLoadEvent.bind(Ai),Mi=new class extends ni{constructor(){super("gljs.performance")}postPerformanceEvent(R,h){_e.EVENTS_URL&&(R||_e.ACCESS_TOKEN)&&this.queueRequest({timestamp:Date.now(),performanceData:h},R)}processRequests(R){if(this.pendingRequest||this.queue.length===0)return;const{timestamp:h,performanceData:U}=this.queue.shift(),W=function(K){const Q=H.performance.getEntriesByType("resource"),oe=H.performance.getEntriesByType("mark"),ce=function(we){const Ae={};if(we){for(const Pe in we)if(Pe!=="other")for(const ze of we[Pe]){const Xe=`${Pe}ResolveRangeMin`,at=`${Pe}ResolveRangeMax`,mt=`${Pe}RequestCount`,ot=`${Pe}RequestCachedCount`;Ae[Xe]=Math.min(Ae[Xe]||1/0,ze.startTime),Ae[at]=Math.max(Ae[at]||-1/0,ze.responseEnd);const pt=Et=>{Ae[Et]===void 0&&(Ae[Et]=0),++Ae[Et]};ze.transferSize!==void 0&&ze.transferSize===0&&pt(ot),pt(mt)}}return Ae}(function(we,Ae){const Pe={};if(we)for(const ze of we){const Xe=Ae(ze);Pe[Xe]===void 0&&(Pe[Xe]=[]),Pe[Xe].push(ze)}return Pe}(Q,wr)),fe=H.devicePixelRatio,pe=H.navigator.connection||H.navigator.mozConnection||H.navigator.webkitConnection,ve={counters:[],metadata:[],attributes:[]},Ee=(we,Ae,Pe)=>{Pe!=null&&we.push({name:Ae,value:Pe.toString()})};for(const we in ce)Ee(ve.counters,we,ce[we]);if(K.interactionRange[0]!==1/0&&K.interactionRange[1]!==-1/0&&(Ee(ve.counters,"interactionRangeMin",K.interactionRange[0]),Ee(ve.counters,"interactionRangeMax",K.interactionRange[1])),oe)for(const we of Object.keys(Xt)){const Ae=Xt[we],Pe=oe.find(ze=>ze.name===Ae);Pe&&Ee(ve.counters,Ae,Pe.startTime)}return Ee(ve.counters,"visibilityHidden",K.visibilityHidden),Ee(ve.attributes,"style",function(we){if(we)for(const Ae of we){const Pe=Ae.name.split("?")[0];if(St(Pe)){const ze=Pe.split("/").slice(-2);if(ze.length===2)return`mapbox://styles/${ze[0]}/${ze[1]}`}}}(Q)),Ee(ve.attributes,"terrainEnabled",K.terrainEnabled?"true":"false"),Ee(ve.attributes,"fogEnabled",K.fogEnabled?"true":"false"),Ee(ve.attributes,"projection",K.projection),Ee(ve.attributes,"zoom",K.zoom),Ee(ve.metadata,"devicePixelRatio",fe),Ee(ve.metadata,"connectionEffectiveType",pe?pe.effectiveType:void 0),Ee(ve.metadata,"navigatorUserAgent",H.navigator.userAgent),Ee(ve.metadata,"screenWidth",H.screen.width),Ee(ve.metadata,"screenHeight",H.screen.height),Ee(ve.metadata,"windowWidth",H.innerWidth),Ee(ve.metadata,"windowHeight",H.innerHeight),Ee(ve.metadata,"mapWidth",K.width/fe),Ee(ve.metadata,"mapHeight",K.height/fe),Ee(ve.metadata,"webglRenderer",K.renderer),Ee(ve.metadata,"webglVendor",K.vendor),Ee(ve.metadata,"sdkVersion",ae),Ee(ve.metadata,"sdkIdentifier","mapbox-gl-js"),ve}(U);for(const K of W.metadata);for(const K of W.counters);for(const K of W.attributes);this.postEvent(h,W,()=>{},R)}},Hi=Mi.postPerformanceEvent.bind(Mi),qn=new class extends ni{constructor(){super("map.auth"),this.success={},this.skuToken=""}getSession(R,h,U,W){if(!_e.API_URL||!_e.SESSION_PATH)return;const K=Ar(_e.API_URL+_e.SESSION_PATH);K.params.push(`sku=${h||""}`),K.params.push(`access_token=${W||_e.ACCESS_TOKEN||""}`);const Q={url:cr(K),headers:{"Content-Type":"text/plain"}};this.pendingRequest=function(oe,ce){return Ct(lr(oe,{method:"GET"}),ce)}(Q,oe=>{this.pendingRequest=null,U(oe),this.saveEventData(),this.processRequests(W)})}getSessionAPI(R,h,U,W){this.skuToken=h,this.errorCb=W,_e.SESSION_PATH&&_e.API_URL&&(U||_e.ACCESS_TOKEN?this.queueRequest({id:R,timestamp:Date.now()},U):this.errorCb(new Error(dt)))}processRequests(R){if(this.pendingRequest||this.queue.length===0)return;const{id:h,timestamp:U}=this.queue.shift();h&&this.success[h]||this.getSession(U,this.skuToken,W=>{W?this.errorCb(W):h&&(this.success[h]=!0)},R)}},Gt=qn.getSessionAPI.bind(qn),fr=new Set,Xt={create:"create",load:"load",fullLoad:"fullLoad"},Ut={mark(R){H.performance.mark(R)},measure(R,h,U){H.performance.measure(R,h,U)}};function wr(R){const h=R.name.split("?")[0];return Pt(h)&&h.includes("mapbox-gl.js")?"javascript":Pt(h)&&h.includes("mapbox-gl.css")?"css":function(U){return _e.API_FONTS_REGEX.test(U)}(h)?"fontRange":Wt(h)?"sprite":St(h)?"style":function(U){return _e.API_TILEJSON_REGEX.test(U)}(h)?"tilejson":"other"}const zr=H.performance;function Yr(R){const h=R?R.url.toString():void 0;return zr.getEntriesByName(h)}let Zi,en,an,tn;const qr={now:()=>an!==void 0?an:H.performance.now(),setNow(R){an=R},restoreNow(){an=void 0},frame(R){const h=H.requestAnimationFrame(R);return{cancel:()=>H.cancelAnimationFrame(h)}},getImageData(R,h=0){const{width:U,height:W}=R;tn||(tn=H.document.createElement("canvas"));const K=tn.getContext("2d",{willReadFrequently:!0});if(!K)throw new Error("failed to create canvas 2d context");return(U>tn.width||W>tn.height)&&(tn.width=U,tn.height=W),K.clearRect(-h,-h,U+2*h,W+2*h),K.drawImage(R,0,0,U,W),K.getImageData(-h,-h,U+2*h,W+2*h)},resolveURL:R=>(Zi||(Zi=H.document.createElement("a")),Zi.href=R,Zi.href),get devicePixelRatio(){return H.devicePixelRatio},get prefersReducedMotion(){return!!H.matchMedia&&(en==null&&(en=H.matchMedia("(prefers-reduced-motion: reduce)")),en.matches)}};function on(R,h,U){U[R]&&U[R].indexOf(h)!==-1||(U[R]=U[R]||[],U[R].push(h))}function Nn(R,h,U){if(U&&U[R]){const W=U[R].indexOf(h);W!==-1&&U[R].splice(W,1)}}class ea{constructor(h,U={}){lr(this,U),this.type=h}}class Gn extends ea{constructor(h,U={}){super("error",lr({error:h},U))}}class Da{on(h,U){return this._listeners=this._listeners||{},on(h,U,this._listeners),this}off(h,U){return Nn(h,U,this._listeners),Nn(h,U,this._oneTimeListeners),this}once(h,U){return U?(this._oneTimeListeners=this._oneTimeListeners||{},on(h,U,this._oneTimeListeners),this):new Promise(W=>this.once(h,W))}fire(h,U){typeof h=="string"&&(h=new ea(h,U||{}));const W=h.type;if(this.listens(W)){h.target=this;const K=this._listeners&&this._listeners[W]?this._listeners[W].slice():[];for(const ce of K)ce.call(this,h);const Q=this._oneTimeListeners&&this._oneTimeListeners[W]?this._oneTimeListeners[W].slice():[];for(const ce of Q)Nn(W,ce,this._oneTimeListeners),ce.call(this,h);const oe=this._eventedParent;oe&&(lr(h,typeof this._eventedParentData=="function"?this._eventedParentData():this._eventedParentData),oe.fire(h))}else h instanceof Gn&&console.error(h.error);return this}listens(h){return!!(this._listeners&&this._listeners[h]&&this._listeners[h].length>0||this._oneTimeListeners&&this._oneTimeListeners[h]&&this._oneTimeListeners[h].length>0||this._eventedParent&&this._eventedParent.listens(h))}setEventedParent(h,U){return this._eventedParent=h,this._eventedParentData=U,this}}var Yt=JSON.parse('{"$version":8,"$root":{"version":{"required":true,"type":"enum","values":[8]},"name":{"type":"string"},"metadata":{"type":"*"},"center":{"type":"array","value":"number"},"zoom":{"type":"number"},"bearing":{"type":"number","default":0,"period":360,"units":"degrees"},"pitch":{"type":"number","default":0,"units":"degrees"},"light":{"type":"light"},"terrain":{"type":"terrain"},"fog":{"type":"fog"},"sources":{"required":true,"type":"sources"},"sprite":{"type":"string"},"glyphs":{"type":"string"},"transition":{"type":"transition"},"projection":{"type":"projection"},"layers":{"required":true,"type":"array","value":"layer"}},"sources":{"*":{"type":"source"}},"source":["source_vector","source_raster","source_raster_dem","source_geojson","source_video","source_image"],"source_vector":{"type":{"required":true,"type":"enum","values":{"vector":{}}},"url":{"type":"string"},"tiles":{"type":"array","value":"string"},"bounds":{"type":"array","value":"number","length":4,"default":[-180,-85.051129,180,85.051129]},"scheme":{"type":"enum","values":{"xyz":{},"tms":{}},"default":"xyz"},"minzoom":{"type":"number","default":0},"maxzoom":{"type":"number","default":22},"attribution":{"type":"string"},"promoteId":{"type":"promoteId"},"volatile":{"type":"boolean","default":false},"*":{"type":"*"}},"source_raster":{"type":{"required":true,"type":"enum","values":{"raster":{}}},"url":{"type":"string"},"tiles":{"type":"array","value":"string"},"bounds":{"type":"array","value":"number","length":4,"default":[-180,-85.051129,180,85.051129]},"minzoom":{"type":"number","default":0},"maxzoom":{"type":"number","default":22},"tileSize":{"type":"number","default":512,"units":"pixels"},"scheme":{"type":"enum","values":{"xyz":{},"tms":{}},"default":"xyz"},"attribution":{"type":"string"},"volatile":{"type":"boolean","default":false},"*":{"type":"*"}},"source_raster_dem":{"type":{"required":true,"type":"enum","values":{"raster-dem":{}}},"url":{"type":"string"},"tiles":{"type":"array","value":"string"},"bounds":{"type":"array","value":"number","length":4,"default":[-180,-85.051129,180,85.051129]},"minzoom":{"type":"number","default":0},"maxzoom":{"type":"number","default":22},"tileSize":{"type":"number","default":512,"units":"pixels"},"attribution":{"type":"string"},"encoding":{"type":"enum","values":{"terrarium":{},"mapbox":{}},"default":"mapbox"},"volatile":{"type":"boolean","default":false},"*":{"type":"*"}},"source_geojson":{"type":{"required":true,"type":"enum","values":{"geojson":{}}},"data":{"type":"*"},"maxzoom":{"type":"number","default":18},"attribution":{"type":"string"},"buffer":{"type":"number","default":128,"maximum":512,"minimum":0},"filter":{"type":"*"},"tolerance":{"type":"number","default":0.375},"cluster":{"type":"boolean","default":false},"clusterRadius":{"type":"number","default":50,"minimum":0},"clusterMaxZoom":{"type":"number"},"clusterMinPoints":{"type":"number"},"clusterProperties":{"type":"*"},"lineMetrics":{"type":"boolean","default":false},"generateId":{"type":"boolean","default":false},"promoteId":{"type":"promoteId"}},"source_video":{"type":{"required":true,"type":"enum","values":{"video":{}}},"urls":{"required":true,"type":"array","value":"string"},"coordinates":{"required":true,"type":"array","length":4,"value":{"type":"array","length":2,"value":"number"}}},"source_image":{"type":{"required":true,"type":"enum","values":{"image":{}}},"url":{"required":true,"type":"string"},"coordinates":{"required":true,"type":"array","length":4,"value":{"type":"array","length":2,"value":"number"}}},"layer":{"id":{"type":"string","required":true},"type":{"type":"enum","values":{"fill":{},"line":{},"symbol":{},"circle":{},"heatmap":{},"fill-extrusion":{},"raster":{},"hillshade":{},"background":{},"sky":{}},"required":true},"metadata":{"type":"*"},"source":{"type":"string"},"source-layer":{"type":"string"},"minzoom":{"type":"number","minimum":0,"maximum":24},"maxzoom":{"type":"number","minimum":0,"maximum":24},"filter":{"type":"filter"},"layout":{"type":"layout"},"paint":{"type":"paint"}},"layout":["layout_fill","layout_line","layout_circle","layout_heatmap","layout_fill-extrusion","layout_symbol","layout_raster","layout_hillshade","layout_background","layout_sky"],"layout_background":{"visibility":{"type":"enum","values":{"visible":{},"none":{}},"default":"visible","property-type":"constant"}},"layout_sky":{"visibility":{"type":"enum","values":{"visible":{},"none":{}},"default":"visible","property-type":"constant"}},"layout_fill":{"fill-sort-key":{"type":"number","expression":{"interpolated":false,"parameters":["zoom","feature"]},"property-type":"data-driven"},"visibility":{"type":"enum","values":{"visible":{},"none":{}},"default":"visible","property-type":"constant"}},"layout_circle":{"circle-sort-key":{"type":"number","expression":{"interpolated":false,"parameters":["zoom","feature"]},"property-type":"data-driven"},"visibility":{"type":"enum","values":{"visible":{},"none":{}},"default":"visible","property-type":"constant"}},"layout_heatmap":{"visibility":{"type":"enum","values":{"visible":{},"none":{}},"default":"visible","property-type":"constant"}},"layout_fill-extrusion":{"visibility":{"type":"enum","values":{"visible":{},"none":{}},"default":"visible","property-type":"constant"},"fill-extrusion-edge-radius":{"type":"number","private":true,"default":0,"minimum":0,"maximum":1,"property-type":"constant"}},"layout_line":{"line-cap":{"type":"enum","values":{"butt":{},"round":{},"square":{}},"default":"butt","expression":{"interpolated":false,"parameters":["zoom","feature"]},"property-type":"data-driven"},"line-join":{"type":"enum","values":{"bevel":{},"round":{},"miter":{}},"default":"miter","expression":{"interpolated":false,"parameters":["zoom","feature"]},"property-type":"data-driven"},"line-miter-limit":{"type":"number","default":2,"requires":[{"line-join":"miter"}],"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"line-round-limit":{"type":"number","default":1.05,"requires":[{"line-join":"round"}],"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"line-sort-key":{"type":"number","expression":{"interpolated":false,"parameters":["zoom","feature"]},"property-type":"data-driven"},"visibility":{"type":"enum","values":{"visible":{},"none":{}},"default":"visible","property-type":"constant"}},"layout_symbol":{"symbol-placement":{"type":"enum","values":{"point":{},"line":{},"line-center":{}},"default":"point","expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"symbol-spacing":{"type":"number","default":250,"minimum":1,"units":"pixels","requires":[{"symbol-placement":"line"}],"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"symbol-avoid-edges":{"type":"boolean","default":false,"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"symbol-sort-key":{"type":"number","expression":{"interpolated":false,"parameters":["zoom","feature"]},"property-type":"data-driven"},"symbol-z-order":{"type":"enum","values":{"auto":{},"viewport-y":{},"source":{}},"default":"auto","expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"icon-allow-overlap":{"type":"boolean","default":false,"requires":["icon-image"],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"icon-ignore-placement":{"type":"boolean","default":false,"requires":["icon-image"],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"icon-optional":{"type":"boolean","default":false,"requires":["icon-image","text-field"],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"icon-rotation-alignment":{"type":"enum","values":{"map":{},"viewport":{},"auto":{}},"default":"auto","requires":["icon-image"],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"icon-size":{"type":"number","default":1,"minimum":0,"units":"factor of the original icon size","requires":["icon-image"],"expression":{"interpolated":true,"parameters":["zoom","feature"]},"property-type":"data-driven"},"icon-text-fit":{"type":"enum","values":{"none":{},"width":{},"height":{},"both":{}},"default":"none","requires":["icon-image","text-field"],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"icon-text-fit-padding":{"type":"array","value":"number","length":4,"default":[0,0,0,0],"units":"pixels","requires":["icon-image","text-field",{"icon-text-fit":["both","width","height"]}],"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"icon-image":{"type":"resolvedImage","tokens":true,"expression":{"interpolated":false,"parameters":["zoom","feature"]},"property-type":"data-driven"},"icon-rotate":{"type":"number","default":0,"period":360,"units":"degrees","requires":["icon-image"],"expression":{"interpolated":true,"parameters":["zoom","feature"]},"property-type":"data-driven"},"icon-padding":{"type":"number","default":2,"minimum":0,"units":"pixels","requires":["icon-image"],"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"icon-keep-upright":{"type":"boolean","default":false,"requires":["icon-image",{"icon-rotation-alignment":"map"},{"symbol-placement":["line","line-center"]}],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"icon-offset":{"type":"array","value":"number","length":2,"default":[0,0],"requires":["icon-image"],"expression":{"interpolated":true,"parameters":["zoom","feature"]},"property-type":"data-driven"},"icon-anchor":{"type":"enum","values":{"center":{},"left":{},"right":{},"top":{},"bottom":{},"top-left":{},"top-right":{},"bottom-left":{},"bottom-right":{}},"default":"center","requires":["icon-image"],"expression":{"interpolated":false,"parameters":["zoom","feature"]},"property-type":"data-driven"},"icon-pitch-alignment":{"type":"enum","values":{"map":{},"viewport":{},"auto":{}},"default":"auto","requires":["icon-image"],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"text-pitch-alignment":{"type":"enum","values":{"map":{},"viewport":{},"auto":{}},"default":"auto","requires":["text-field"],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"text-rotation-alignment":{"type":"enum","values":{"map":{},"viewport":{},"auto":{}},"default":"auto","requires":["text-field"],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"text-field":{"type":"formatted","default":"","tokens":true,"expression":{"interpolated":false,"parameters":["zoom","feature"]},"property-type":"data-driven"},"text-font":{"type":"array","value":"string","default":["Open Sans Regular","Arial Unicode MS Regular"],"requires":["text-field"],"expression":{"interpolated":false,"parameters":["zoom","feature"]},"property-type":"data-driven"},"text-size":{"type":"number","default":16,"minimum":0,"units":"pixels","requires":["text-field"],"expression":{"interpolated":true,"parameters":["zoom","feature"]},"property-type":"data-driven"},"text-max-width":{"type":"number","default":10,"minimum":0,"units":"ems","requires":["text-field",{"symbol-placement":["point"]}],"expression":{"interpolated":true,"parameters":["zoom","feature"]},"property-type":"data-driven"},"text-line-height":{"type":"number","default":1.2,"units":"ems","requires":["text-field"],"expression":{"interpolated":true,"parameters":["zoom","feature"]},"property-type":"data-driven"},"text-letter-spacing":{"type":"number","default":0,"units":"ems","requires":["text-field"],"expression":{"interpolated":true,"parameters":["zoom","feature"]},"property-type":"data-driven"},"text-justify":{"type":"enum","values":{"auto":{},"left":{},"center":{},"right":{}},"default":"center","requires":["text-field"],"expression":{"interpolated":false,"parameters":["zoom","feature"]},"property-type":"data-driven"},"text-radial-offset":{"type":"number","units":"ems","default":0,"requires":["text-field"],"property-type":"data-driven","expression":{"interpolated":true,"parameters":["zoom","feature"]}},"text-variable-anchor":{"type":"array","value":"enum","values":{"center":{},"left":{},"right":{},"top":{},"bottom":{},"top-left":{},"top-right":{},"bottom-left":{},"bottom-right":{}},"requires":["text-field",{"symbol-placement":["point"]}],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"text-anchor":{"type":"enum","values":{"center":{},"left":{},"right":{},"top":{},"bottom":{},"top-left":{},"top-right":{},"bottom-left":{},"bottom-right":{}},"default":"center","requires":["text-field",{"!":"text-variable-anchor"}],"expression":{"interpolated":false,"parameters":["zoom","feature"]},"property-type":"data-driven"},"text-max-angle":{"type":"number","default":45,"units":"degrees","requires":["text-field",{"symbol-placement":["line","line-center"]}],"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"text-writing-mode":{"type":"array","value":"enum","values":{"horizontal":{},"vertical":{}},"requires":["text-field"],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"text-rotate":{"type":"number","default":0,"period":360,"units":"degrees","requires":["text-field"],"expression":{"interpolated":true,"parameters":["zoom","feature"]},"property-type":"data-driven"},"text-padding":{"type":"number","default":2,"minimum":0,"units":"pixels","requires":["text-field"],"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"text-keep-upright":{"type":"boolean","default":true,"requires":["text-field",{"text-rotation-alignment":"map"},{"symbol-placement":["line","line-center"]}],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"text-transform":{"type":"enum","values":{"none":{},"uppercase":{},"lowercase":{}},"default":"none","requires":["text-field"],"expression":{"interpolated":false,"parameters":["zoom","feature"]},"property-type":"data-driven"},"text-offset":{"type":"array","value":"number","units":"ems","length":2,"default":[0,0],"requires":["text-field",{"!":"text-radial-offset"}],"expression":{"interpolated":true,"parameters":["zoom","feature"]},"property-type":"data-driven"},"text-allow-overlap":{"type":"boolean","default":false,"requires":["text-field"],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"text-ignore-placement":{"type":"boolean","default":false,"requires":["text-field"],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"text-optional":{"type":"boolean","default":false,"requires":["text-field","icon-image"],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"visibility":{"type":"enum","values":{"visible":{},"none":{}},"default":"visible","property-type":"constant"}},"layout_raster":{"visibility":{"type":"enum","values":{"visible":{},"none":{}},"default":"visible","property-type":"constant"}},"layout_hillshade":{"visibility":{"type":"enum","values":{"visible":{},"none":{}},"default":"visible","property-type":"constant"}},"filter":{"type":"array","value":"*"},"filter_symbol":{"type":"boolean","default":false,"transition":false,"property-type":"data-driven","expression":{"interpolated":false,"parameters":["zoom","feature","pitch","distance-from-center"]}},"filter_fill":{"type":"boolean","default":false,"transition":false,"property-type":"data-driven","expression":{"interpolated":false,"parameters":["zoom","feature"]}},"filter_line":{"type":"boolean","default":false,"transition":false,"property-type":"data-driven","expression":{"interpolated":false,"parameters":["zoom","feature"]}},"filter_circle":{"type":"boolean","default":false,"transition":false,"property-type":"data-driven","expression":{"interpolated":false,"parameters":["zoom","feature"]}},"filter_fill-extrusion":{"type":"boolean","default":false,"transition":false,"property-type":"data-driven","expression":{"interpolated":false,"parameters":["zoom","feature"]}},"filter_heatmap":{"type":"boolean","default":false,"transition":false,"property-type":"data-driven","expression":{"interpolated":false,"parameters":["zoom","feature"]}},"filter_operator":{"type":"enum","values":{"==":{},"!=":{},">":{},">=":{},"<":{},"<=":{},"in":{},"!in":{},"all":{},"any":{},"none":{},"has":{},"!has":{},"within":{}}},"geometry_type":{"type":"enum","values":{"Point":{},"LineString":{},"Polygon":{}}},"function":{"expression":{"type":"expression"},"stops":{"type":"array","value":"function_stop"},"base":{"type":"number","default":1,"minimum":0},"property":{"type":"string","default":"$zoom"},"type":{"type":"enum","values":{"identity":{},"exponential":{},"interval":{},"categorical":{}},"default":"exponential"},"colorSpace":{"type":"enum","values":{"rgb":{},"lab":{},"hcl":{}},"default":"rgb"},"default":{"type":"*","required":false}},"function_stop":{"type":"array","minimum":0,"maximum":24,"value":["number","color"],"length":2},"expression":{"type":"array","value":"*","minimum":1},"fog":{"range":{"type":"array","default":[0.5,10],"minimum":-20,"maximum":20,"length":2,"value":"number","property-type":"data-constant","transition":true,"expression":{"interpolated":true,"parameters":["zoom"]}},"color":{"type":"color","property-type":"data-constant","default":"#ffffff","expression":{"interpolated":true,"parameters":["zoom"]},"transition":true},"high-color":{"type":"color","property-type":"data-constant","default":"#245cdf","expression":{"interpolated":true,"parameters":["zoom"]},"transition":true},"space-color":{"type":"color","property-type":"data-constant","default":["interpolate",["linear"],["zoom"],4,"#010b19",7,"#367ab9"],"expression":{"interpolated":true,"parameters":["zoom"]},"transition":true},"horizon-blend":{"type":"number","property-type":"data-constant","default":["interpolate",["linear"],["zoom"],4,0.2,7,0.1],"minimum":0,"maximum":1,"expression":{"interpolated":true,"parameters":["zoom"]},"transition":true},"star-intensity":{"type":"number","property-type":"data-constant","default":["interpolate",["linear"],["zoom"],5,0.35,6,0],"minimum":0,"maximum":1,"expression":{"interpolated":true,"parameters":["zoom"]},"transition":true}},"light":{"anchor":{"type":"enum","default":"viewport","values":{"map":{},"viewport":{}},"property-type":"data-constant","transition":false,"expression":{"interpolated":false,"parameters":["zoom"]}},"position":{"type":"array","default":[1.15,210,30],"length":3,"value":"number","property-type":"data-constant","transition":true,"expression":{"interpolated":true,"parameters":["zoom"]}},"color":{"type":"color","property-type":"data-constant","default":"#ffffff","expression":{"interpolated":true,"parameters":["zoom"]},"transition":true},"intensity":{"type":"number","property-type":"data-constant","default":0.5,"minimum":0,"maximum":1,"expression":{"interpolated":true,"parameters":["zoom"]},"transition":true}},"projection":{"name":{"type":"enum","values":{"albers":{},"equalEarth":{},"equirectangular":{},"lambertConformalConic":{},"mercator":{},"naturalEarth":{},"winkelTripel":{},"globe":{}},"default":"mercator","required":true},"center":{"type":"array","length":2,"value":"number","property-type":"data-constant","minimum":[-180,-90],"maximum":[180,90],"transition":false,"requires":[{"name":["albers","lambertConformalConic"]}]},"parallels":{"type":"array","length":2,"value":"number","property-type":"data-constant","minimum":[-90,-90],"maximum":[90,90],"transition":false,"requires":[{"name":["albers","lambertConformalConic"]}]}},"terrain":{"source":{"type":"string","required":true},"exaggeration":{"type":"number","property-type":"data-constant","default":1,"minimum":0,"maximum":1000,"expression":{"interpolated":true,"parameters":["zoom"]},"transition":true,"requires":["source"]}},"paint":["paint_fill","paint_line","paint_circle","paint_heatmap","paint_fill-extrusion","paint_symbol","paint_raster","paint_hillshade","paint_background","paint_sky"],"paint_fill":{"fill-antialias":{"type":"boolean","default":true,"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"fill-opacity":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-color":{"type":"color","default":"#000000","transition":true,"requires":[{"!":"fill-pattern"}],"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-outline-color":{"type":"color","transition":true,"requires":[{"!":"fill-pattern"},{"fill-antialias":true}],"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-translate":{"type":"array","value":"number","length":2,"default":[0,0],"transition":true,"units":"pixels","expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"fill-translate-anchor":{"type":"enum","values":{"map":{},"viewport":{}},"default":"map","requires":["fill-translate"],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"fill-pattern":{"type":"resolvedImage","transition":false,"expression":{"interpolated":false,"parameters":["zoom","feature"]},"property-type":"data-driven"}},"paint_fill-extrusion":{"fill-extrusion-opacity":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"fill-extrusion-color":{"type":"color","default":"#000000","transition":true,"requires":[{"!":"fill-extrusion-pattern"}],"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-extrusion-translate":{"type":"array","value":"number","length":2,"default":[0,0],"transition":true,"units":"pixels","expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"fill-extrusion-translate-anchor":{"type":"enum","values":{"map":{},"viewport":{}},"default":"map","requires":["fill-extrusion-translate"],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"fill-extrusion-pattern":{"type":"resolvedImage","transition":false,"expression":{"interpolated":false,"parameters":["zoom","feature"]},"property-type":"data-driven"},"fill-extrusion-height":{"type":"number","default":0,"minimum":0,"units":"meters","transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-extrusion-base":{"type":"number","default":0,"minimum":0,"units":"meters","transition":true,"requires":["fill-extrusion-height"],"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-extrusion-vertical-gradient":{"type":"boolean","default":true,"transition":false,"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"fill-extrusion-ambient-occlusion-intensity":{"property-type":"data-constant","type":"number","private":true,"default":0,"minimum":0,"maximum":1,"expression":{"interpolated":true,"parameters":["zoom"]},"transition":true},"fill-extrusion-ambient-occlusion-radius":{"property-type":"data-constant","type":"number","private":true,"default":3,"minimum":0,"expression":{"interpolated":true,"parameters":["zoom"]},"transition":true,"requires":["fill-extrusion-edge-radius"]},"fill-extrusion-rounded-roof":{"type":"boolean","default":true,"requires":["fill-extrusion-edge-radius"],"transition":false,"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"}},"paint_line":{"line-opacity":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-color":{"type":"color","default":"#000000","transition":true,"requires":[{"!":"line-pattern"}],"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-translate":{"type":"array","value":"number","length":2,"default":[0,0],"transition":true,"units":"pixels","expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"line-translate-anchor":{"type":"enum","values":{"map":{},"viewport":{}},"default":"map","requires":["line-translate"],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"line-width":{"type":"number","default":1,"minimum":0,"transition":true,"units":"pixels","expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-gap-width":{"type":"number","default":0,"minimum":0,"transition":true,"units":"pixels","expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-offset":{"type":"number","default":0,"transition":true,"units":"pixels","expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-blur":{"type":"number","default":0,"minimum":0,"transition":true,"units":"pixels","expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-dasharray":{"type":"array","value":"number","minimum":0,"transition":false,"units":"line widths","requires":[{"!":"line-pattern"}],"expression":{"interpolated":false,"parameters":["zoom","feature"]},"property-type":"data-driven"},"line-pattern":{"type":"resolvedImage","transition":false,"expression":{"interpolated":false,"parameters":["zoom","feature"]},"property-type":"data-driven"},"line-gradient":{"type":"color","transition":false,"requires":[{"!":"line-pattern"},{"source":"geojson","has":{"lineMetrics":true}}],"expression":{"interpolated":true,"parameters":["line-progress"]},"property-type":"color-ramp"},"line-trim-offset":{"type":"array","value":"number","length":2,"default":[0,0],"minimum":[0,0],"maximum":[1,1],"transition":false,"requires":[{"source":"geojson","has":{"lineMetrics":true}}],"property-type":"constant"}},"paint_circle":{"circle-radius":{"type":"number","default":5,"minimum":0,"transition":true,"units":"pixels","expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-color":{"type":"color","default":"#000000","transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-blur":{"type":"number","default":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-opacity":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-translate":{"type":"array","value":"number","length":2,"default":[0,0],"transition":true,"units":"pixels","expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"circle-translate-anchor":{"type":"enum","values":{"map":{},"viewport":{}},"default":"map","requires":["circle-translate"],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"circle-pitch-scale":{"type":"enum","values":{"map":{},"viewport":{}},"default":"map","expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"circle-pitch-alignment":{"type":"enum","values":{"map":{},"viewport":{}},"default":"viewport","expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"circle-stroke-width":{"type":"number","default":0,"minimum":0,"transition":true,"units":"pixels","expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-stroke-color":{"type":"color","default":"#000000","transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-stroke-opacity":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"}},"paint_heatmap":{"heatmap-radius":{"type":"number","default":30,"minimum":1,"transition":true,"units":"pixels","expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"heatmap-weight":{"type":"number","default":1,"minimum":0,"transition":false,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"heatmap-intensity":{"type":"number","default":1,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"heatmap-color":{"type":"color","default":["interpolate",["linear"],["heatmap-density"],0,"rgba(0, 0, 255, 0)",0.1,"royalblue",0.3,"cyan",0.5,"lime",0.7,"yellow",1,"red"],"transition":false,"expression":{"interpolated":true,"parameters":["heatmap-density"]},"property-type":"color-ramp"},"heatmap-opacity":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"}},"paint_symbol":{"icon-opacity":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"requires":["icon-image"],"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-color":{"type":"color","default":"#000000","transition":true,"requires":["icon-image"],"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-halo-color":{"type":"color","default":"rgba(0, 0, 0, 0)","transition":true,"requires":["icon-image"],"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-halo-width":{"type":"number","default":0,"minimum":0,"transition":true,"units":"pixels","requires":["icon-image"],"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-halo-blur":{"type":"number","default":0,"minimum":0,"transition":true,"units":"pixels","requires":["icon-image"],"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-translate":{"type":"array","value":"number","length":2,"default":[0,0],"transition":true,"units":"pixels","requires":["icon-image"],"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"icon-translate-anchor":{"type":"enum","values":{"map":{},"viewport":{}},"default":"map","requires":["icon-image","icon-translate"],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"text-opacity":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"requires":["text-field"],"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-color":{"type":"color","default":"#000000","transition":true,"overridable":true,"requires":["text-field"],"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-halo-color":{"type":"color","default":"rgba(0, 0, 0, 0)","transition":true,"requires":["text-field"],"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-halo-width":{"type":"number","default":0,"minimum":0,"transition":true,"units":"pixels","requires":["text-field"],"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-halo-blur":{"type":"number","default":0,"minimum":0,"transition":true,"units":"pixels","requires":["text-field"],"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-translate":{"type":"array","value":"number","length":2,"default":[0,0],"transition":true,"units":"pixels","requires":["text-field"],"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"text-translate-anchor":{"type":"enum","values":{"map":{},"viewport":{}},"default":"map","requires":["text-field","text-translate"],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"}},"paint_raster":{"raster-opacity":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"raster-hue-rotate":{"type":"number","default":0,"period":360,"transition":true,"units":"degrees","expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"raster-brightness-min":{"type":"number","default":0,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"raster-brightness-max":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"raster-saturation":{"type":"number","default":0,"minimum":-1,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"raster-contrast":{"type":"number","default":0,"minimum":-1,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"raster-resampling":{"type":"enum","values":{"linear":{},"nearest":{}},"default":"linear","expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"raster-fade-duration":{"type":"number","default":300,"minimum":0,"transition":false,"units":"milliseconds","expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"}},"paint_hillshade":{"hillshade-illumination-direction":{"type":"number","default":335,"minimum":0,"maximum":359,"transition":false,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"hillshade-illumination-anchor":{"type":"enum","values":{"map":{},"viewport":{}},"default":"viewport","expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"hillshade-exaggeration":{"type":"number","default":0.5,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"hillshade-shadow-color":{"type":"color","default":"#000000","transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"hillshade-highlight-color":{"type":"color","default":"#FFFFFF","transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"hillshade-accent-color":{"type":"color","default":"#000000","transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"}},"paint_background":{"background-color":{"type":"color","default":"#000000","transition":true,"requires":[{"!":"background-pattern"}],"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"background-pattern":{"type":"resolvedImage","transition":false,"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"background-opacity":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"}},"paint_sky":{"sky-type":{"type":"enum","values":{"gradient":{},"atmosphere":{}},"default":"atmosphere","expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"sky-atmosphere-sun":{"type":"array","value":"number","length":2,"units":"degrees","minimum":[0,0],"maximum":[360,180],"transition":false,"requires":[{"sky-type":"atmosphere"}],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"sky-atmosphere-sun-intensity":{"type":"number","requires":[{"sky-type":"atmosphere"}],"default":10,"minimum":0,"maximum":100,"transition":false,"property-type":"data-constant"},"sky-gradient-center":{"type":"array","requires":[{"sky-type":"gradient"}],"value":"number","default":[0,0],"length":2,"units":"degrees","minimum":[0,0],"maximum":[360,180],"transition":false,"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"sky-gradient-radius":{"type":"number","requires":[{"sky-type":"gradient"}],"default":90,"minimum":0,"maximum":180,"transition":false,"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"sky-gradient":{"type":"color","default":["interpolate",["linear"],["sky-radial-progress"],0.8,"#87ceeb",1,"white"],"transition":false,"requires":[{"sky-type":"gradient"}],"expression":{"interpolated":true,"parameters":["sky-radial-progress"]},"property-type":"color-ramp"},"sky-atmosphere-halo-color":{"type":"color","default":"white","transition":false,"requires":[{"sky-type":"atmosphere"}],"property-type":"data-constant"},"sky-atmosphere-color":{"type":"color","default":"white","transition":false,"requires":[{"sky-type":"atmosphere"}],"property-type":"data-constant"},"sky-opacity":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"}},"transition":{"duration":{"type":"number","default":300,"minimum":0,"units":"milliseconds"},"delay":{"type":"number","default":0,"minimum":0,"units":"milliseconds"}},"property-type":{"data-driven":{"type":"property-type"},"color-ramp":{"type":"property-type"},"data-constant":{"type":"property-type"},"constant":{"type":"property-type"}},"promoteId":{"*":{"type":"string"}}}');function ma(R,...h){for(const U of h)for(const W in U)R[W]=U[W];return R}function ln(R){return R instanceof Number||R instanceof String||R instanceof Boolean?R.valueOf():R}function gn(R){if(Array.isArray(R))return R.map(gn);if(R instanceof Object&&!(R instanceof Number||R instanceof String||R instanceof Boolean)){const h={};for(const U in R)h[U]=gn(R[U]);return h}return ln(R)}class Zl extends Error{constructor(h,U){super(U),this.message=U,this.key=h}}var sa=Zl;class xu{constructor(h,U=[]){this.parent=h,this.bindings={};for(const[W,K]of U)this.bindings[W]=K}concat(h){return new xu(this,h)}get(h){if(this.bindings[h])return this.bindings[h];if(this.parent)return this.parent.get(h);throw new Error(`${h} not found in scope.`)}has(h){return!!this.bindings[h]||!!this.parent&&this.parent.has(h)}}var Kl=xu;const lo={kind:"null"},Fr={kind:"number"},Si={kind:"string"},vi={kind:"boolean"},jn={kind:"color"},ta={kind:"object"},bi={kind:"value"},Un={kind:"collator"},zo={kind:"formatted"},Wa={kind:"resolvedImage"};function $n(R,h){return{kind:"array",itemType:R,N:h}}function Xi(R){if(R.kind==="array"){const h=Xi(R.itemType);return typeof R.N=="number"?`array<${h}, ${R.N}>`:R.itemType.kind==="value"?"array":`array<${h}>`}return R.kind}const Xl=[lo,Fr,Si,vi,jn,zo,ta,$n(bi),Wa];function ya(R,h){if(h.kind==="error")return null;if(R.kind==="array"){if(h.kind==="array"&&(h.N===0&&h.itemType.kind==="value"||!ya(R.itemType,h.itemType))&&(typeof R.N!="number"||R.N===h.N))return null}else{if(R.kind===h.kind)return null;if(R.kind==="value"){for(const U of Xl)if(!ya(U,h))return null}}return`Expected ${Xi(R)} but found ${Xi(h)} instead.`}function No(R,h){return h.some(U=>U.kind===R.kind)}function jo(R,h){return h.some(U=>U==="null"?R===null:U==="array"?Array.isArray(R):U==="object"?R&&!Array.isArray(R)&&typeof R=="object":U===typeof R)}var Eu,Yl={transparent:[0,0,0,0],aliceblue:[240,248,255,1],antiquewhite:[250,235,215,1],aqua:[0,255,255,1],aquamarine:[127,255,212,1],azure:[240,255,255,1],beige:[245,245,220,1],bisque:[255,228,196,1],black:[0,0,0,1],blanchedalmond:[255,235,205,1],blue:[0,0,255,1],blueviolet:[138,43,226,1],brown:[165,42,42,1],burlywood:[222,184,135,1],cadetblue:[95,158,160,1],chartreuse:[127,255,0,1],chocolate:[210,105,30,1],coral:[255,127,80,1],cornflowerblue:[100,149,237,1],cornsilk:[255,248,220,1],crimson:[220,20,60,1],cyan:[0,255,255,1],darkblue:[0,0,139,1],darkcyan:[0,139,139,1],darkgoldenrod:[184,134,11,1],darkgray:[169,169,169,1],darkgreen:[0,100,0,1],darkgrey:[169,169,169,1],darkkhaki:[189,183,107,1],darkmagenta:[139,0,139,1],darkolivegreen:[85,107,47,1],darkorange:[255,140,0,1],darkorchid:[153,50,204,1],darkred:[139,0,0,1],darksalmon:[233,150,122,1],darkseagreen:[143,188,143,1],darkslateblue:[72,61,139,1],darkslategray:[47,79,79,1],darkslategrey:[47,79,79,1],darkturquoise:[0,206,209,1],darkviolet:[148,0,211,1],deeppink:[255,20,147,1],deepskyblue:[0,191,255,1],dimgray:[105,105,105,1],dimgrey:[105,105,105,1],dodgerblue:[30,144,255,1],firebrick:[178,34,34,1],floralwhite:[255,250,240,1],forestgreen:[34,139,34,1],fuchsia:[255,0,255,1],gainsboro:[220,220,220,1],ghostwhite:[248,248,255,1],gold:[255,215,0,1],goldenrod:[218,165,32,1],gray:[128,128,128,1],green:[0,128,0,1],greenyellow:[173,255,47,1],grey:[128,128,128,1],honeydew:[240,255,240,1],hotpink:[255,105,180,1],indianred:[205,92,92,1],indigo:[75,0,130,1],ivory:[255,255,240,1],khaki:[240,230,140,1],lavender:[230,230,250,1],lavenderblush:[255,240,245,1],lawngreen:[124,252,0,1],lemonchiffon:[255,250,205,1],lightblue:[173,216,230,1],lightcoral:[240,128,128,1],lightcyan:[224,255,255,1],lightgoldenrodyellow:[250,250,210,1],lightgray:[211,211,211,1],lightgreen:[144,238,144,1],lightgrey:[211,211,211,1],lightpink:[255,182,193,1],lightsalmon:[255,160,122,1],lightseagreen:[32,178,170,1],lightskyblue:[135,206,250,1],lightslategray:[119,136,153,1],lightslategrey:[119,136,153,1],lightsteelblue:[176,196,222,1],lightyellow:[255,255,224,1],lime:[0,255,0,1],limegreen:[50,205,50,1],linen:[250,240,230,1],magenta:[255,0,255,1],maroon:[128,0,0,1],mediumaquamarine:[102,205,170,1],mediumblue:[0,0,205,1],mediumorchid:[186,85,211,1],mediumpurple:[147,112,219,1],mediumseagreen:[60,179,113,1],mediumslateblue:[123,104,238,1],mediumspringgreen:[0,250,154,1],mediumturquoise:[72,209,204,1],mediumvioletred:[199,21,133,1],midnightblue:[25,25,112,1],mintcream:[245,255,250,1],mistyrose:[255,228,225,1],moccasin:[255,228,181,1],navajowhite:[255,222,173,1],navy:[0,0,128,1],oldlace:[253,245,230,1],olive:[128,128,0,1],olivedrab:[107,142,35,1],orange:[255,165,0,1],orangered:[255,69,0,1],orchid:[218,112,214,1],palegoldenrod:[238,232,170,1],palegreen:[152,251,152,1],paleturquoise:[175,238,238,1],palevioletred:[219,112,147,1],papayawhip:[255,239,213,1],peachpuff:[255,218,185,1],peru:[205,133,63,1],pink:[255,192,203,1],plum:[221,160,221,1],powderblue:[176,224,230,1],purple:[128,0,128,1],rebeccapurple:[102,51,153,1],red:[255,0,0,1],rosybrown:[188,143,143,1],royalblue:[65,105,225,1],saddlebrown:[139,69,19,1],salmon:[250,128,114,1],sandybrown:[244,164,96,1],seagreen:[46,139,87,1],seashell:[255,245,238,1],sienna:[160,82,45,1],silver:[192,192,192,1],skyblue:[135,206,235,1],slateblue:[106,90,205,1],slategray:[112,128,144,1],slategrey:[112,128,144,1],snow:[255,250,250,1],springgreen:[0,255,127,1],steelblue:[70,130,180,1],tan:[210,180,140,1],teal:[0,128,128,1],thistle:[216,191,216,1],tomato:[255,99,71,1],turquoise:[64,224,208,1],violet:[238,130,238,1],wheat:[245,222,179,1],white:[255,255,255,1],whitesmoke:[245,245,245,1],yellow:[255,255,0,1],yellowgreen:[154,205,50,1]};function Uo(R){return(R=Math.round(R))<0?0:R>255?255:R}function Vo(R){return Uo(R[R.length-1]==="%"?parseFloat(R)/100*255:parseInt(R))}function Ts(R){return(h=R[R.length-1]==="%"?parseFloat(R)/100:parseFloat(R))<0?0:h>1?1:h;var h}function co(R,h,U){return U<0?U+=1:U>1&&(U-=1),6*U<1?R+(h-R)*U*6:2*U<1?h:3*U<2?R+(h-R)*(2/3-U)*6:R}try{Eu={}.parseCSSColor=function(R){var h,U=R.replace(/ /g,"").toLowerCase();if(U in Yl)return Yl[U].slice();if(U[0]==="#")return U.length===4?(h=parseInt(U.substr(1),16))>=0&&h<=4095?[(3840&h)>>4|(3840&h)>>8,240&h|(240&h)>>4,15&h|(15&h)<<4,1]:null:U.length===7&&(h=parseInt(U.substr(1),16))>=0&&h<=16777215?[(16711680&h)>>16,(65280&h)>>8,255&h,1]:null;var W=U.indexOf("("),K=U.indexOf(")");if(W!==-1&&K+1===U.length){var Q=U.substr(0,W),oe=U.substr(W+1,K-(W+1)).split(","),ce=1;switch(Q){case"rgba":if(oe.length!==4)return null;ce=Ts(oe.pop());case"rgb":return oe.length!==3?null:[Vo(oe[0]),Vo(oe[1]),Vo(oe[2]),ce];case"hsla":if(oe.length!==4)return null;ce=Ts(oe.pop());case"hsl":if(oe.length!==3)return null;var fe=(parseFloat(oe[0])%360+360)%360/360,pe=Ts(oe[1]),ve=Ts(oe[2]),Ee=ve<=.5?ve*(pe+1):ve+pe-ve*pe,we=2*ve-Ee;return[Uo(255*co(we,Ee,fe+1/3)),Uo(255*co(we,Ee,fe)),Uo(255*co(we,Ee,fe-1/3)),ce];default:return null}}return null}}catch{}class Pn{constructor(h,U,W,K=1){this.r=h,this.g=U,this.b=W,this.a=K}static parse(h){if(!h)return;if(h instanceof Pn)return h;if(typeof h!="string")return;const U=Eu(h);return U?new Pn(U[0]/255*U[3],U[1]/255*U[3],U[2]/255*U[3],U[3]):void 0}toString(){const[h,U,W,K]=this.toArray();return`rgba(${Math.round(h)},${Math.round(U)},${Math.round(W)},${K})`}toArray(){const{r:h,g:U,b:W,a:K}=this;return K===0?[0,0,0,0]:[255*h/K,255*U/K,255*W/K,K]}toArray01(){const{r:h,g:U,b:W,a:K}=this;return K===0?[0,0,0,0]:[h/K,U/K,W/K,K]}toArray01PremultipliedAlpha(){const{r:h,g:U,b:W,a:K}=this;return[h,U,W,K]}}Pn.black=new Pn(0,0,0,1),Pn.white=new Pn(1,1,1,1),Pn.transparent=new Pn(0,0,0,0),Pn.red=new Pn(1,0,0,1),Pn.blue=new Pn(0,0,1,1);var sn=Pn;class wu{constructor(h,U,W){this.sensitivity=h?U?"variant":"case":U?"accent":"base",this.locale=W,this.collator=new Intl.Collator(this.locale?this.locale:[],{sensitivity:this.sensitivity,usage:"search"})}compare(h,U){return this.collator.compare(h,U)}resolvedLocale(){return new Intl.Collator(this.locale?this.locale:[]).resolvedOptions().locale}}class Su{constructor(h,U,W,K,Q){this.text=h.normalize?h.normalize():h,this.image=U,this.scale=W,this.fontStack=K,this.textColor=Q}}class Mn{constructor(h){this.sections=h}static fromString(h){return new Mn([new Su(h,null,null,null,null)])}isEmpty(){return this.sections.length===0||!this.sections.some(h=>h.text.length!==0||h.image&&h.image.name.length!==0)}static factory(h){return h instanceof Mn?h:Mn.fromString(h)}toString(){return this.sections.length===0?"":this.sections.map(h=>h.text).join("")}serialize(){const h=["format"];for(const U of this.sections){if(U.image){h.push(["image",U.image.name]);continue}h.push(U.text);const W={};U.fontStack&&(W["text-font"]=["literal",U.fontStack.split(",")]),U.scale&&(W["font-scale"]=U.scale),U.textColor&&(W["text-color"]=["rgba"].concat(U.textColor.toArray())),h.push(W)}return h}}class Wn{constructor(h){this.name=h.name,this.available=h.available}toString(){return this.name}static fromString(h){return h?new Wn({name:h,available:!1}):null}serialize(){return["image",this.name]}}function Jl(R,h,U,W){return typeof R=="number"&&R>=0&&R<=255&&typeof h=="number"&&h>=0&&h<=255&&typeof U=="number"&&U>=0&&U<=255?W===void 0||typeof W=="number"&&W>=0&&W<=1?null:`Invalid rgba value [${[R,h,U,W].join(", ")}]: 'a' must be between 0 and 1.`:`Invalid rgba value [${(typeof W=="number"?[R,h,U,W]:[R,h,U]).join(", ")}]: 'r', 'g', and 'b' must be between 0 and 255.`}function Go(R){if(R===null||typeof R=="string"||typeof R=="boolean"||typeof R=="number"||R instanceof sn||R instanceof wu||R instanceof Mn||R instanceof Wn)return!0;if(Array.isArray(R)){for(const h of R)if(!Go(h))return!1;return!0}if(typeof R=="object"){for(const h in R)if(!Go(R[h]))return!1;return!0}return!1}function rn(R){if(R===null)return lo;if(typeof R=="string")return Si;if(typeof R=="boolean")return vi;if(typeof R=="number")return Fr;if(R instanceof sn)return jn;if(R instanceof wu)return Un;if(R instanceof Mn)return zo;if(R instanceof Wn)return Wa;if(Array.isArray(R)){const h=R.length;let U;for(const W of R){const K=rn(W);if(U){if(U===K)continue;U=bi;break}U=K}return $n(U||bi,h)}return ta}function $o(R){const h=typeof R;return R===null?"":h==="string"||h==="number"||h==="boolean"?String(R):R instanceof sn||R instanceof Mn||R instanceof Wn?R.toString():JSON.stringify(R)}class Tu{constructor(h,U){this.type=h,this.value=U}static parse(h,U){if(h.length!==2)return U.error(`'literal' expression requires exactly one argument, but found ${h.length-1} instead.`);if(!Go(h[1]))return U.error("invalid value");const W=h[1];let K=rn(W);const Q=U.expectedType;return K.kind!=="array"||K.N!==0||!Q||Q.kind!=="array"||typeof Q.N=="number"&&Q.N!==0||(K=Q),new Tu(K,W)}evaluate(){return this.value}eachChild(){}outputDefined(){return!0}serialize(){return this.type.kind==="array"||this.type.kind==="object"?["literal",this.value]:this.value instanceof sn?["rgba"].concat(this.value.toArray()):this.value instanceof Mn?this.value.serialize():this.value}}var Ha=Tu,wn=class{constructor(R){this.name="ExpressionEvaluationError",this.message=R}toJSON(){return this.message}};const qu={string:Si,number:Fr,boolean:vi,object:ta};class Iu{constructor(h,U){this.type=h,this.args=U}static parse(h,U){if(h.length<2)return U.error("Expected at least one argument.");let W,K=1;const Q=h[0];if(Q==="array"){let ce,fe;if(h.length>2){const pe=h[1];if(typeof pe!="string"||!(pe in qu)||pe==="object")return U.error('The item type argument of "array" must be one of string, number, boolean',1);ce=qu[pe],K++}else ce=bi;if(h.length>3){if(h[2]!==null&&(typeof h[2]!="number"||h[2]<0||h[2]!==Math.floor(h[2])))return U.error('The length argument to "array" must be a positive integer literal',2);fe=h[2],K++}W=$n(ce,fe)}else W=qu[Q];const oe=[];for(;K<h.length;K++){const ce=U.parse(h[K],K,bi);if(!ce)return null;oe.push(ce)}return new Iu(W,oe)}evaluate(h){for(let U=0;U<this.args.length;U++){const W=this.args[U].evaluate(h);if(!ya(this.type,rn(W)))return W;if(U===this.args.length-1)throw new wn(`Expected value to be of type ${Xi(this.type)}, but found ${Xi(rn(W))} instead.`)}return null}eachChild(h){this.args.forEach(h)}outputDefined(){return this.args.every(h=>h.outputDefined())}serialize(){const h=this.type,U=[h.kind];if(h.kind==="array"){const W=h.itemType;if(W.kind==="string"||W.kind==="number"||W.kind==="boolean"){U.push(W.kind);const K=h.N;(typeof K=="number"||this.args.length>1)&&U.push(K)}}return U.concat(this.args.map(W=>W.serialize()))}}var ga=Iu;class La{constructor(h){this.type=zo,this.sections=h}static parse(h,U){if(h.length<2)return U.error("Expected at least one argument.");const W=h[1];if(!Array.isArray(W)&&typeof W=="object")return U.error("First argument must be an image or text section.");const K=[];let Q=!1;for(let oe=1;oe<=h.length-1;++oe){const ce=h[oe];if(Q&&typeof ce=="object"&&!Array.isArray(ce)){Q=!1;let fe=null;if(ce["font-scale"]&&(fe=U.parse(ce["font-scale"],1,Fr),!fe))return null;let pe=null;if(ce["text-font"]&&(pe=U.parse(ce["text-font"],1,$n(Si)),!pe))return null;let ve=null;if(ce["text-color"]&&(ve=U.parse(ce["text-color"],1,jn),!ve))return null;const Ee=K[K.length-1];Ee.scale=fe,Ee.font=pe,Ee.textColor=ve}else{const fe=U.parse(h[oe],1,bi);if(!fe)return null;const pe=fe.type.kind;if(pe!=="string"&&pe!=="value"&&pe!=="null"&&pe!=="resolvedImage")return U.error("Formatted text type must be 'string', 'value', 'image' or 'null'.");Q=!0,K.push({content:fe,scale:null,font:null,textColor:null})}}return new La(K)}evaluate(h){return new Mn(this.sections.map(U=>{const W=U.content.evaluate(h);return rn(W)===Wa?new Su("",W,null,null,null):new Su($o(W),null,U.scale?U.scale.evaluate(h):null,U.font?U.font.evaluate(h).join(","):null,U.textColor?U.textColor.evaluate(h):null)}))}eachChild(h){for(const U of this.sections)h(U.content),U.scale&&h(U.scale),U.font&&h(U.font),U.textColor&&h(U.textColor)}outputDefined(){return!1}serialize(){const h=["format"];for(const U of this.sections){h.push(U.content.serialize());const W={};U.scale&&(W["font-scale"]=U.scale.serialize()),U.font&&(W["text-font"]=U.font.serialize()),U.textColor&&(W["text-color"]=U.textColor.serialize()),h.push(W)}return h}}class qs{constructor(h){this.type=Wa,this.input=h}static parse(h,U){if(h.length!==2)return U.error("Expected two arguments.");const W=U.parse(h[1],1,Si);return W?new qs(W):U.error("No image name provided.")}evaluate(h){const U=this.input.evaluate(h),W=Wn.fromString(U);return W&&h.availableImages&&(W.available=h.availableImages.indexOf(U)>-1),W}eachChild(h){h(this.input)}outputDefined(){return!1}serialize(){return["image",this.input.serialize()]}}const gh={"to-boolean":vi,"to-color":jn,"to-number":Fr,"to-string":Si};class Au{constructor(h,U){this.type=h,this.args=U}static parse(h,U){if(h.length<2)return U.error("Expected at least one argument.");const W=h[0];if((W==="to-boolean"||W==="to-string")&&h.length!==2)return U.error("Expected one argument.");const K=gh[W],Q=[];for(let oe=1;oe<h.length;oe++){const ce=U.parse(h[oe],oe,bi);if(!ce)return null;Q.push(ce)}return new Au(K,Q)}evaluate(h){if(this.type.kind==="boolean")return!!this.args[0].evaluate(h);if(this.type.kind==="color"){let U,W;for(const K of this.args){if(U=K.evaluate(h),W=null,U instanceof sn)return U;if(typeof U=="string"){const Q=h.parseColor(U);if(Q)return Q}else if(Array.isArray(U)&&(W=U.length<3||U.length>4?`Invalid rbga value ${JSON.stringify(U)}: expected an array containing either three or four numeric values.`:Jl(U[0],U[1],U[2],U[3]),!W))return new sn(U[0]/255,U[1]/255,U[2]/255,U[3])}throw new wn(W||`Could not parse color from value '${typeof U=="string"?U:String(JSON.stringify(U))}'`)}if(this.type.kind==="number"){let U=null;for(const W of this.args){if(U=W.evaluate(h),U===null)return 0;const K=Number(U);if(!isNaN(K))return K}throw new wn(`Could not convert ${JSON.stringify(U)} to number.`)}return this.type.kind==="formatted"?Mn.fromString($o(this.args[0].evaluate(h))):this.type.kind==="resolvedImage"?Wn.fromString($o(this.args[0].evaluate(h))):$o(this.args[0].evaluate(h))}eachChild(h){this.args.forEach(h)}outputDefined(){return this.args.every(h=>h.outputDefined())}serialize(){if(this.type.kind==="formatted")return new La([{content:this.args[0],scale:null,font:null,textColor:null}]).serialize();if(this.type.kind==="resolvedImage")return new qs(this.args[0]).serialize();const h=[`to-${this.type.kind}`];return this.eachChild(U=>{h.push(U.serialize())}),h}}var ho=Au;const ua=["Unknown","Point","LineString","Polygon"];var Ru=class{constructor(){this.globals=null,this.feature=null,this.featureState=null,this.formattedSection=null,this._parseColorCache={},this.availableImages=null,this.canonical=null,this.featureTileCoord=null,this.featureDistanceData=null}id(){return this.feature&&this.feature.id!==void 0?this.feature.id:null}geometryType(){return this.feature?typeof this.feature.type=="number"?ua[this.feature.type]:this.feature.type:null}geometry(){return this.feature&&"geometry"in this.feature?this.feature.geometry:null}canonicalID(){return this.canonical}properties(){return this.feature&&this.feature.properties||{}}distanceFromCenter(){if(this.featureTileCoord&&this.featureDistanceData){const R=this.featureDistanceData.center,h=this.featureDistanceData.scale,{x:U,y:W}=this.featureTileCoord;return this.featureDistanceData.bearing[0]*(U*h-R[0])+this.featureDistanceData.bearing[1]*(W*h-R[1])}return 0}parseColor(R){let h=this._parseColorCache[R];return h||(h=this._parseColorCache[R]=sn.parse(R)),h}};class Za{constructor(h,U,W,K){this.name=h,this.type=U,this._evaluate=W,this.args=K}evaluate(h){return this._evaluate(h,this.args)}eachChild(h){this.args.forEach(h)}outputDefined(){return!1}serialize(){return[this.name].concat(this.args.map(h=>h.serialize()))}static parse(h,U){const W=h[0],K=Za.definitions[W];if(!K)return U.error(`Unknown expression "${W}". If you wanted a literal array, use ["literal", [...]].`,0);const Q=Array.isArray(K)?K[0]:K.type,oe=Array.isArray(K)?[[K[1],K[2]]]:K.overloads,ce=oe.filter(([pe])=>!Array.isArray(pe)||pe.length===h.length-1);let fe=null;for(const[pe,ve]of ce){fe=new Lu(U.registry,U.path,null,U.scope);const Ee=[];let we=!1;for(let Ae=1;Ae<h.length;Ae++){const Pe=h[Ae],ze=Array.isArray(pe)?pe[Ae-1]:pe.type,Xe=fe.parse(Pe,1+Ee.length,ze);if(!Xe){we=!0;break}Ee.push(Xe)}if(!we)if(Array.isArray(pe)&&pe.length!==Ee.length)fe.error(`Expected ${pe.length} arguments, but found ${Ee.length} instead.`);else{for(let Ae=0;Ae<Ee.length;Ae++){const Pe=Array.isArray(pe)?pe[Ae]:pe.type,ze=Ee[Ae];fe.concat(Ae+1).checkSubtype(Pe,ze.type)}if(fe.errors.length===0)return new Za(W,Q,ve,Ee)}}if(ce.length===1)U.errors.push(...fe.errors);else{const pe=(ce.length?ce:oe).map(([Ee])=>{return we=Ee,Array.isArray(we)?`(${we.map(Xi).join(", ")})`:`(${Xi(we.type)}...)`;var we}).join(" | "),ve=[];for(let Ee=1;Ee<h.length;Ee++){const we=U.parse(h[Ee],1+ve.length);if(!we)return null;ve.push(Xi(we.type))}U.error(`Expected arguments of type ${pe}, but found (${ve.join(", ")}) instead.`)}return null}static register(h,U){Za.definitions=U;for(const W in U)h[W]=Za}}var va=Za;class Wo{constructor(h,U,W){this.type=Un,this.locale=W,this.caseSensitive=h,this.diacriticSensitive=U}static parse(h,U){if(h.length!==2)return U.error("Expected one argument.");const W=h[1];if(typeof W!="object"||Array.isArray(W))return U.error("Collator options argument must be an object.");const K=U.parse(W["case-sensitive"]!==void 0&&W["case-sensitive"],1,vi);if(!K)return null;const Q=U.parse(W["diacritic-sensitive"]!==void 0&&W["diacritic-sensitive"],1,vi);if(!Q)return null;let oe=null;return W.locale&&(oe=U.parse(W.locale,1,Si),!oe)?null:new Wo(K,Q,oe)}evaluate(h){return new wu(this.caseSensitive.evaluate(h),this.diacriticSensitive.evaluate(h),this.locale?this.locale.evaluate(h):null)}eachChild(h){h(this.caseSensitive),h(this.diacriticSensitive),this.locale&&h(this.locale)}outputDefined(){return!1}serialize(){const h={};return h["case-sensitive"]=this.caseSensitive.serialize(),h["diacritic-sensitive"]=this.diacriticSensitive.serialize(),this.locale&&(h.locale=this.locale.serialize()),["collator",h]}}const ba=8192;function Is(R,h){R[0]=Math.min(R[0],h[0]),R[1]=Math.min(R[1],h[1]),R[2]=Math.max(R[2],h[0]),R[3]=Math.max(R[3],h[1])}function fo(R,h){return!(R[0]<=h[0]||R[2]>=h[2]||R[1]<=h[1]||R[3]>=h[3])}function Ho(R,h){const U=(180+R[0])/360,W=(180-180/Math.PI*Math.log(Math.tan(Math.PI/4+R[1]*Math.PI/360)))/360,K=Math.pow(2,h.z);return[Math.round(U*K*ba),Math.round(W*K*ba)]}function Ql(R,h,U){const W=R[0]-h[0],K=R[1]-h[1],Q=R[0]-U[0],oe=R[1]-U[1];return W*oe-Q*K==0&&W*Q<=0&&K*oe<=0}function As(R,h){let U=!1;for(let oe=0,ce=h.length;oe<ce;oe++){const fe=h[oe];for(let pe=0,ve=fe.length;pe<ve-1;pe++){if(Ql(R,fe[pe],fe[pe+1]))return!1;(K=fe[pe])[1]>(W=R)[1]!=(Q=fe[pe+1])[1]>W[1]&&W[0]<(Q[0]-K[0])*(W[1]-K[1])/(Q[1]-K[1])+K[0]&&(U=!U)}}var W,K,Q;return U}function Ou(R,h){for(let U=0;U<h.length;U++)if(As(R,h[U]))return!0;return!1}function Cu(R,h,U,W){const K=W[0]-U[0],Q=W[1]-U[1],oe=(R[0]-U[0])*Q-K*(R[1]-U[1]),ce=(h[0]-U[0])*Q-K*(h[1]-U[1]);return oe>0&&ce<0||oe<0&&ce>0}function po(R,h,U){for(const pe of U)for(let ve=0;ve<pe.length-1;++ve)if((ce=[(oe=pe[ve+1])[0]-(Q=pe[ve])[0],oe[1]-Q[1]])[0]*(fe=[(K=h)[0]-(W=R)[0],K[1]-W[1]])[1]-ce[1]*fe[0]!=0&&Cu(W,K,Q,oe)&&Cu(Q,oe,W,K))return!0;var W,K,Q,oe,ce,fe;return!1}function Ci(R,h){for(let U=0;U<R.length;++U)if(!As(R[U],h))return!1;for(let U=0;U<R.length-1;++U)if(po(R[U],R[U+1],h))return!1;return!0}function vh(R,h){for(let U=0;U<h.length;U++)if(Ci(R,h[U]))return!0;return!1}function Pu(R,h,U){const W=[];for(let K=0;K<R.length;K++){const Q=[];for(let oe=0;oe<R[K].length;oe++){const ce=Ho(R[K][oe],U);Is(h,ce),Q.push(ce)}W.push(Q)}return W}function ec(R,h,U){const W=[];for(let K=0;K<R.length;K++){const Q=Pu(R[K],h,U);W.push(Q)}return W}function Mu(R,h,U,W){if(R[0]<U[0]||R[0]>U[2]){const K=.5*W;let Q=R[0]-U[0]>K?-W:U[0]-R[0]>K?W:0;Q===0&&(Q=R[0]-U[2]>K?-W:U[2]-R[0]>K?W:0),R[0]+=Q}Is(h,R)}function tc(R,h,U,W){const K=Math.pow(2,W.z)*ba,Q=[W.x*ba,W.y*ba],oe=[];if(!R)return oe;for(const ce of R)for(const fe of ce){const pe=[fe.x+Q[0],fe.y+Q[1]];Mu(pe,h,U,K),oe.push(pe)}return oe}function Du(R,h,U,W){const K=Math.pow(2,W.z)*ba,Q=[W.x*ba,W.y*ba],oe=[];if(!R)return oe;for(const fe of R){const pe=[];for(const ve of fe){const Ee=[ve.x+Q[0],ve.y+Q[1]];Is(h,Ee),pe.push(Ee)}oe.push(pe)}if(h[2]-h[0]<=K/2){(ce=h)[0]=ce[1]=1/0,ce[2]=ce[3]=-1/0;for(const fe of oe)for(const pe of fe)Mu(pe,h,U,K)}var ce;return oe}class _o{constructor(h,U){this.type=vi,this.geojson=h,this.geometries=U}static parse(h,U){if(h.length!==2)return U.error(`'within' expression requires exactly one argument, but found ${h.length-1} instead.`);if(Go(h[1])){const W=h[1];if(W.type==="FeatureCollection")for(let K=0;K<W.features.length;++K){const Q=W.features[K].geometry.type;if(Q==="Polygon"||Q==="MultiPolygon")return new _o(W,W.features[K].geometry)}else if(W.type==="Feature"){const K=W.geometry.type;if(K==="Polygon"||K==="MultiPolygon")return new _o(W,W.geometry)}else if(W.type==="Polygon"||W.type==="MultiPolygon")return new _o(W,W)}return U.error("'within' expression requires valid geojson object that contains polygon geometry type.")}evaluate(h){if(h.geometry()!=null&&h.canonicalID()!=null){if(h.geometryType()==="Point")return function(U,W){const K=[1/0,1/0,-1/0,-1/0],Q=[1/0,1/0,-1/0,-1/0],oe=U.canonicalID();if(!oe)return!1;if(W.type==="Polygon"){const ce=Pu(W.coordinates,Q,oe),fe=tc(U.geometry(),K,Q,oe);if(!fo(K,Q))return!1;for(const pe of fe)if(!As(pe,ce))return!1}if(W.type==="MultiPolygon"){const ce=ec(W.coordinates,Q,oe),fe=tc(U.geometry(),K,Q,oe);if(!fo(K,Q))return!1;for(const pe of fe)if(!Ou(pe,ce))return!1}return!0}(h,this.geometries);if(h.geometryType()==="LineString")return function(U,W){const K=[1/0,1/0,-1/0,-1/0],Q=[1/0,1/0,-1/0,-1/0],oe=U.canonicalID();if(!oe)return!1;if(W.type==="Polygon"){const ce=Pu(W.coordinates,Q,oe),fe=Du(U.geometry(),K,Q,oe);if(!fo(K,Q))return!1;for(const pe of fe)if(!Ci(pe,ce))return!1}if(W.type==="MultiPolygon"){const ce=ec(W.coordinates,Q,oe),fe=Du(U.geometry(),K,Q,oe);if(!fo(K,Q))return!1;for(const pe of fe)if(!vh(pe,ce))return!1}return!0}(h,this.geometries)}return!1}eachChild(){}outputDefined(){return!0}serialize(){return["within",this.geojson]}}var Rs=_o;function mo(R){if(R instanceof va&&(R.name==="get"&&R.args.length===1||R.name==="feature-state"||R.name==="has"&&R.args.length===1||R.name==="properties"||R.name==="geometry-type"||R.name==="id"||/^filter-/.test(R.name))||R instanceof Rs)return!1;let h=!0;return R.eachChild(U=>{h&&!mo(U)&&(h=!1)}),h}function xa(R){if(R instanceof va&&R.name==="feature-state")return!1;let h=!0;return R.eachChild(U=>{h&&!xa(U)&&(h=!1)}),h}function Ka(R,h){if(R instanceof va&&h.indexOf(R.name)>=0)return!1;let U=!0;return R.eachChild(W=>{U&&!Ka(W,h)&&(U=!1)}),U}class Os{constructor(h,U){this.type=U.type,this.name=h,this.boundExpression=U}static parse(h,U){if(h.length!==2||typeof h[1]!="string")return U.error("'var' expression requires exactly one string literal argument.");const W=h[1];return U.scope.has(W)?new Os(W,U.scope.get(W)):U.error(`Unknown variable "${W}". Make sure "${W}" has been bound in an enclosing "let" expression before using it.`,1)}evaluate(h){return this.boundExpression.evaluate(h)}eachChild(){}outputDefined(){return!1}serialize(){return["var",this.name]}}var rc=Os;class Zo{constructor(h,U=[],W,K=new Kl,Q=[]){this.registry=h,this.path=U,this.key=U.map(oe=>`[${oe}]`).join(""),this.scope=K,this.errors=Q,this.expectedType=W}parse(h,U,W,K,Q={}){return U?this.concat(U,W,K)._parse(h,Q):this._parse(h,Q)}_parse(h,U){function W(K,Q,oe){return oe==="assert"?new ga(Q,[K]):oe==="coerce"?new ho(Q,[K]):K}if(h!==null&&typeof h!="string"&&typeof h!="boolean"&&typeof h!="number"||(h=["literal",h]),Array.isArray(h)){if(h.length===0)return this.error('Expected an array with at least one element. If you wanted a literal array, use ["literal", []].');const K=h[0];if(typeof K!="string")return this.error(`Expression name must be a string, but found ${typeof K} instead. If you wanted a literal array, use ["literal", [...]].`,0),null;const Q=this.registry[K];if(Q){let oe=Q.parse(h,this);if(!oe)return null;if(this.expectedType){const ce=this.expectedType,fe=oe.type;if(ce.kind!=="string"&&ce.kind!=="number"&&ce.kind!=="boolean"&&ce.kind!=="object"&&ce.kind!=="array"||fe.kind!=="value")if(ce.kind!=="color"&&ce.kind!=="formatted"&&ce.kind!=="resolvedImage"||fe.kind!=="value"&&fe.kind!=="string"){if(this.checkSubtype(ce,fe))return null}else oe=W(oe,ce,U.typeAnnotation||"coerce");else oe=W(oe,ce,U.typeAnnotation||"assert")}if(!(oe instanceof Ha)&&oe.type.kind!=="resolvedImage"&&Fu(oe)){const ce=new Ru;try{oe=new Ha(oe.type,oe.evaluate(ce))}catch(fe){return this.error(fe.message),null}}return oe}return this.error(`Unknown expression "${K}". If you wanted a literal array, use ["literal", [...]].`,0)}return this.error(h===void 0?"'undefined' value invalid. Use null instead.":typeof h=="object"?'Bare objects invalid. Use ["literal", {...}] instead.':`Expected an array, but found ${typeof h} instead.`)}concat(h,U,W){const K=typeof h=="number"?this.path.concat(h):this.path,Q=W?this.scope.concat(W):this.scope;return new Zo(this.registry,K,U||null,Q,this.errors)}error(h,...U){const W=`${this.key}${U.map(K=>`[${K}]`).join("")}`;this.errors.push(new sa(W,h))}checkSubtype(h,U){const W=ya(h,U);return W&&this.error(W),W}}var Lu=Zo;function Fu(R){if(R instanceof rc)return Fu(R.boundExpression);if(R instanceof va&&R.name==="error"||R instanceof Wo||R instanceof Rs)return!1;const h=R instanceof ho||R instanceof ga;let U=!0;return R.eachChild(W=>{U=h?U&&Fu(W):U&&W instanceof Ha}),!!U&&mo(R)&&Ka(R,["zoom","heatmap-density","line-progress","sky-radial-progress","accumulated","is-supported-script","pitch","distance-from-center"])}function Cs(R,h){const U=R.length-1;let W,K,Q=0,oe=U,ce=0;for(;Q<=oe;)if(ce=Math.floor((Q+oe)/2),W=R[ce],K=R[ce+1],W<=h){if(ce===U||h<K)return ce;Q=ce+1}else{if(!(W>h))throw new wn("Input is not a number.");oe=ce-1}return 0}class Ps{constructor(h,U,W){this.type=h,this.input=U,this.labels=[],this.outputs=[];for(const[K,Q]of W)this.labels.push(K),this.outputs.push(Q)}static parse(h,U){if(h.length-1<4)return U.error(`Expected at least 4 arguments, but found only ${h.length-1}.`);if((h.length-1)%2!=0)return U.error("Expected an even number of arguments.");const W=U.parse(h[1],1,Fr);if(!W)return null;const K=[];let Q=null;U.expectedType&&U.expectedType.kind!=="value"&&(Q=U.expectedType);for(let oe=1;oe<h.length;oe+=2){const ce=oe===1?-1/0:h[oe],fe=h[oe+1],pe=oe,ve=oe+1;if(typeof ce!="number")return U.error('Input/output pairs for "step" expressions must be defined using literal numeric values (not computed expressions) for the input values.',pe);if(K.length&&K[K.length-1][0]>=ce)return U.error('Input/output pairs for "step" expressions must be arranged with input values in strictly ascending order.',pe);const Ee=U.parse(fe,ve,Q);if(!Ee)return null;Q=Q||Ee.type,K.push([ce,Ee])}return new Ps(Q,W,K)}evaluate(h){const U=this.labels,W=this.outputs;if(U.length===1)return W[0].evaluate(h);const K=this.input.evaluate(h);if(K<=U[0])return W[0].evaluate(h);const Q=U.length;return K>=U[Q-1]?W[Q-1].evaluate(h):W[Cs(U,K)].evaluate(h)}eachChild(h){h(this.input);for(const U of this.outputs)h(U)}outputDefined(){return this.outputs.every(h=>h.outputDefined())}serialize(){const h=["step",this.input.serialize()];for(let U=0;U<this.labels.length;U++)U>0&&h.push(this.labels[U]),h.push(this.outputs[U].serialize());return h}}var ku=Ps;function Ti(R,h,U){return R*(1-U)+h*U}var Ko=Object.freeze({__proto__:null,array:function(R,h,U){return R.map((W,K)=>Ti(W,h[K],U))},color:function(R,h,U){return new sn(Ti(R.r,h.r,U),Ti(R.g,h.g,U),Ti(R.b,h.b,U),Ti(R.a,h.a,U))},number:Ti});const ic=.95047,Bu=1.08883,nc=4/29,Xa=6/29,zu=3*Xa*Xa,bh=Xa*Xa*Xa,xh=Math.PI/180,Eh=180/Math.PI;function Nu(R){return R>bh?Math.pow(R,1/3):R/zu+nc}function ju(R){return R>Xa?R*R*R:zu*(R-nc)}function Uu(R){return 255*(R<=.0031308?12.92*R:1.055*Math.pow(R,1/2.4)-.055)}function Ms(R){return(R/=255)<=.04045?R/12.92:Math.pow((R+.055)/1.055,2.4)}function ac(R){const h=Ms(R.r),U=Ms(R.g),W=Ms(R.b),K=Nu((.4124564*h+.3575761*U+.1804375*W)/ic),Q=Nu((.2126729*h+.7151522*U+.072175*W)/1);return{l:116*Q-16,a:500*(K-Q),b:200*(Q-Nu((.0193339*h+.119192*U+.9503041*W)/Bu)),alpha:R.a}}function oc(R){let h=(R.l+16)/116,U=isNaN(R.a)?h:h+R.a/500,W=isNaN(R.b)?h:h-R.b/200;return h=1*ju(h),U=ic*ju(U),W=Bu*ju(W),new sn(Uu(3.2404542*U-1.5371385*h-.4985314*W),Uu(-.969266*U+1.8760108*h+.041556*W),Uu(.0556434*U-.2040259*h+1.0572252*W),R.alpha)}function wh(R,h,U){const W=h-R;return R+U*(W>180||W<-180?W-360*Math.round(W/360):W)}const Xo={forward:ac,reverse:oc,interpolate:function(R,h,U){return{l:Ti(R.l,h.l,U),a:Ti(R.a,h.a,U),b:Ti(R.b,h.b,U),alpha:Ti(R.alpha,h.alpha,U)}}},yo={forward:function(R){const{l:h,a:U,b:W}=ac(R),K=Math.atan2(W,U)*Eh;return{h:K<0?K+360:K,c:Math.sqrt(U*U+W*W),l:h,alpha:R.a}},reverse:function(R){const h=R.h*xh,U=R.c;return oc({l:R.l,a:Math.cos(h)*U,b:Math.sin(h)*U,alpha:R.alpha})},interpolate:function(R,h,U){return{h:wh(R.h,h.h,U),c:Ti(R.c,h.c,U),l:Ti(R.l,h.l,U),alpha:Ti(R.alpha,h.alpha,U)}}};var Vu=Object.freeze({__proto__:null,hcl:yo,lab:Xo});class Yo{constructor(h,U,W,K,Q){this.type=h,this.operator=U,this.interpolation=W,this.input=K,this.labels=[],this.outputs=[];for(const[oe,ce]of Q)this.labels.push(oe),this.outputs.push(ce)}static interpolationFactor(h,U,W,K){let Q=0;if(h.name==="exponential")Q=Gu(U,h.base,W,K);else if(h.name==="linear")Q=Gu(U,1,W,K);else if(h.name==="cubic-bezier"){const oe=h.controlPoints;Q=new Ze(oe[0],oe[1],oe[2],oe[3]).solve(Gu(U,1,W,K))}return Q}static parse(h,U){let[W,K,Q,...oe]=h;if(!Array.isArray(K)||K.length===0)return U.error("Expected an interpolation type expression.",1);if(K[0]==="linear")K={name:"linear"};else if(K[0]==="exponential"){const pe=K[1];if(typeof pe!="number")return U.error("Exponential interpolation requires a numeric base.",1,1);K={name:"exponential",base:pe}}else{if(K[0]!=="cubic-bezier")return U.error(`Unknown interpolation type ${String(K[0])}`,1,0);{const pe=K.slice(1);if(pe.length!==4||pe.some(ve=>typeof ve!="number"||ve<0||ve>1))return U.error("Cubic bezier interpolation requires four numeric arguments with values between 0 and 1.",1);K={name:"cubic-bezier",controlPoints:pe}}}if(h.length-1<4)return U.error(`Expected at least 4 arguments, but found only ${h.length-1}.`);if((h.length-1)%2!=0)return U.error("Expected an even number of arguments.");if(Q=U.parse(Q,2,Fr),!Q)return null;const ce=[];let fe=null;W==="interpolate-hcl"||W==="interpolate-lab"?fe=jn:U.expectedType&&U.expectedType.kind!=="value"&&(fe=U.expectedType);for(let pe=0;pe<oe.length;pe+=2){const ve=oe[pe],Ee=oe[pe+1],we=pe+3,Ae=pe+4;if(typeof ve!="number")return U.error('Input/output pairs for "interpolate" expressions must be defined using literal numeric values (not computed expressions) for the input values.',we);if(ce.length&&ce[ce.length-1][0]>=ve)return U.error('Input/output pairs for "interpolate" expressions must be arranged with input values in strictly ascending order.',we);const Pe=U.parse(Ee,Ae,fe);if(!Pe)return null;fe=fe||Pe.type,ce.push([ve,Pe])}return fe.kind==="number"||fe.kind==="color"||fe.kind==="array"&&fe.itemType.kind==="number"&&typeof fe.N=="number"?new Yo(fe,W,K,Q,ce):U.error(`Type ${Xi(fe)} is not interpolatable.`)}evaluate(h){const U=this.labels,W=this.outputs;if(U.length===1)return W[0].evaluate(h);const K=this.input.evaluate(h);if(K<=U[0])return W[0].evaluate(h);const Q=U.length;if(K>=U[Q-1])return W[Q-1].evaluate(h);const oe=Cs(U,K),ce=Yo.interpolationFactor(this.interpolation,K,U[oe],U[oe+1]),fe=W[oe].evaluate(h),pe=W[oe+1].evaluate(h);return this.operator==="interpolate"?Ko[this.type.kind.toLowerCase()](fe,pe,ce):this.operator==="interpolate-hcl"?yo.reverse(yo.interpolate(yo.forward(fe),yo.forward(pe),ce)):Xo.reverse(Xo.interpolate(Xo.forward(fe),Xo.forward(pe),ce))}eachChild(h){h(this.input);for(const U of this.outputs)h(U)}outputDefined(){return this.outputs.every(h=>h.outputDefined())}serialize(){let h;h=this.interpolation.name==="linear"?["linear"]:this.interpolation.name==="exponential"?this.interpolation.base===1?["linear"]:["exponential",this.interpolation.base]:["cubic-bezier"].concat(this.interpolation.controlPoints);const U=[this.operator,h,this.input.serialize()];for(let W=0;W<this.labels.length;W++)U.push(this.labels[W],this.outputs[W].serialize());return U}}function Gu(R,h,U,W){const K=W-U,Q=R-U;return K===0?0:h===1?Q/K:(Math.pow(h,Q)-1)/(Math.pow(h,K)-1)}var la=Yo;class Ds{constructor(h,U){this.type=h,this.args=U}static parse(h,U){if(h.length<2)return U.error("Expectected at least one argument.");let W=null;const K=U.expectedType;K&&K.kind!=="value"&&(W=K);const Q=[];for(const ce of h.slice(1)){const fe=U.parse(ce,1+Q.length,W,void 0,{typeAnnotation:"omit"});if(!fe)return null;W=W||fe.type,Q.push(fe)}const oe=K&&Q.some(ce=>ya(K,ce.type));return new Ds(oe?bi:W,Q)}evaluate(h){let U,W=null,K=0;for(const Q of this.args){if(K++,W=Q.evaluate(h),W&&W instanceof Wn&&!W.available&&(U||(U=W),W=null,K===this.args.length))return U;if(W!==null)break}return W}eachChild(h){this.args.forEach(h)}outputDefined(){return this.args.every(h=>h.outputDefined())}serialize(){const h=["coalesce"];return this.eachChild(U=>{h.push(U.serialize())}),h}}var $u=Ds;class Ls{constructor(h,U){this.type=U.type,this.bindings=[].concat(h),this.result=U}evaluate(h){return this.result.evaluate(h)}eachChild(h){for(const U of this.bindings)h(U[1]);h(this.result)}static parse(h,U){if(h.length<4)return U.error(`Expected at least 3 arguments, but found ${h.length-1} instead.`);const W=[];for(let Q=1;Q<h.length-1;Q+=2){const oe=h[Q];if(typeof oe!="string")return U.error(`Expected string, but found ${typeof oe} instead.`,Q);if(/[^a-zA-Z0-9_]/.test(oe))return U.error("Variable names must contain only alphanumeric characters or '_'.",Q);const ce=U.parse(h[Q+1],Q+1);if(!ce)return null;W.push([oe,ce])}const K=U.parse(h[h.length-1],h.length-1,U.expectedType,W);return K?new Ls(W,K):null}outputDefined(){return this.result.outputDefined()}serialize(){const h=["let"];for(const[U,W]of this.bindings)h.push(U,W.serialize());return h.push(this.result.serialize()),h}}var sc=Ls;class Wu{constructor(h,U,W){this.type=h,this.index=U,this.input=W}static parse(h,U){if(h.length!==3)return U.error(`Expected 2 arguments, but found ${h.length-1} instead.`);const W=U.parse(h[1],1,Fr),K=U.parse(h[2],2,$n(U.expectedType||bi));return W&&K?new Wu(K.type.itemType,W,K):null}evaluate(h){const U=this.index.evaluate(h),W=this.input.evaluate(h);if(U<0)throw new wn(`Array index out of bounds: ${U} < 0.`);if(U>=W.length)throw new wn(`Array index out of bounds: ${U} > ${W.length-1}.`);if(U!==Math.floor(U))throw new wn(`Array index must be an integer, but found ${U} instead.`);return W[U]}eachChild(h){h(this.index),h(this.input)}outputDefined(){return!1}serialize(){return["at",this.index.serialize(),this.input.serialize()]}}var Sh=Wu;class Hu{constructor(h,U){this.type=vi,this.needle=h,this.haystack=U}static parse(h,U){if(h.length!==3)return U.error(`Expected 2 arguments, but found ${h.length-1} instead.`);const W=U.parse(h[1],1,bi),K=U.parse(h[2],2,bi);return W&&K?No(W.type,[vi,Si,Fr,lo,bi])?new Hu(W,K):U.error(`Expected first argument to be of type boolean, string, number or null, but found ${Xi(W.type)} instead`):null}evaluate(h){const U=this.needle.evaluate(h),W=this.haystack.evaluate(h);if(W==null)return!1;if(!jo(U,["boolean","string","number","null"]))throw new wn(`Expected first argument to be of type boolean, string, number or null, but found ${Xi(rn(U))} instead.`);if(!jo(W,["string","array"]))throw new wn(`Expected second argument to be of type array or string, but found ${Xi(rn(W))} instead.`);return W.indexOf(U)>=0}eachChild(h){h(this.needle),h(this.haystack)}outputDefined(){return!0}serialize(){return["in",this.needle.serialize(),this.haystack.serialize()]}}var Fs=Hu;class Jo{constructor(h,U,W){this.type=Fr,this.needle=h,this.haystack=U,this.fromIndex=W}static parse(h,U){if(h.length<=2||h.length>=5)return U.error(`Expected 3 or 4 arguments, but found ${h.length-1} instead.`);const W=U.parse(h[1],1,bi),K=U.parse(h[2],2,bi);if(!W||!K)return null;if(!No(W.type,[vi,Si,Fr,lo,bi]))return U.error(`Expected first argument to be of type boolean, string, number or null, but found ${Xi(W.type)} instead`);if(h.length===4){const Q=U.parse(h[3],3,Fr);return Q?new Jo(W,K,Q):null}return new Jo(W,K)}evaluate(h){const U=this.needle.evaluate(h),W=this.haystack.evaluate(h);if(!jo(U,["boolean","string","number","null"]))throw new wn(`Expected first argument to be of type boolean, string, number or null, but found ${Xi(rn(U))} instead.`);if(!jo(W,["string","array"]))throw new wn(`Expected second argument to be of type array or string, but found ${Xi(rn(W))} instead.`);if(this.fromIndex){const K=this.fromIndex.evaluate(h);return W.indexOf(U,K)}return W.indexOf(U)}eachChild(h){h(this.needle),h(this.haystack),this.fromIndex&&h(this.fromIndex)}outputDefined(){return!1}serialize(){if(this.fromIndex!=null&&this.fromIndex!==void 0){const h=this.fromIndex.serialize();return["index-of",this.needle.serialize(),this.haystack.serialize(),h]}return["index-of",this.needle.serialize(),this.haystack.serialize()]}}var uc=Jo;class Zu{constructor(h,U,W,K,Q,oe){this.inputType=h,this.type=U,this.input=W,this.cases=K,this.outputs=Q,this.otherwise=oe}static parse(h,U){if(h.length<5)return U.error(`Expected at least 4 arguments, but found only ${h.length-1}.`);if(h.length%2!=1)return U.error("Expected an even number of arguments.");let W,K;U.expectedType&&U.expectedType.kind!=="value"&&(K=U.expectedType);const Q={},oe=[];for(let pe=2;pe<h.length-1;pe+=2){let ve=h[pe];const Ee=h[pe+1];Array.isArray(ve)||(ve=[ve]);const we=U.concat(pe);if(ve.length===0)return we.error("Expected at least one branch label.");for(const Pe of ve){if(typeof Pe!="number"&&typeof Pe!="string")return we.error("Branch labels must be numbers or strings.");if(typeof Pe=="number"&&Math.abs(Pe)>Number.MAX_SAFE_INTEGER)return we.error(`Branch labels must be integers no larger than ${Number.MAX_SAFE_INTEGER}.`);if(typeof Pe=="number"&&Math.floor(Pe)!==Pe)return we.error("Numeric branch labels must be integer values.");if(W){if(we.checkSubtype(W,rn(Pe)))return null}else W=rn(Pe);if(Q[String(Pe)]!==void 0)return we.error("Branch labels must be unique.");Q[String(Pe)]=oe.length}const Ae=U.parse(Ee,pe,K);if(!Ae)return null;K=K||Ae.type,oe.push(Ae)}const ce=U.parse(h[1],1,bi);if(!ce)return null;const fe=U.parse(h[h.length-1],h.length-1,K);return fe?ce.type.kind!=="value"&&U.concat(1).checkSubtype(W,ce.type)?null:new Zu(W,K,ce,Q,oe,fe):null}evaluate(h){const U=this.input.evaluate(h);return(rn(U)===this.inputType&&this.outputs[this.cases[U]]||this.otherwise).evaluate(h)}eachChild(h){h(this.input),this.outputs.forEach(h),h(this.otherwise)}outputDefined(){return this.outputs.every(h=>h.outputDefined())&&this.otherwise.outputDefined()}serialize(){const h=["match",this.input.serialize()],U=Object.keys(this.cases).sort(),W=[],K={};for(const oe of U){const ce=K[this.cases[oe]];ce===void 0?(K[this.cases[oe]]=W.length,W.push([this.cases[oe],[oe]])):W[ce][1].push(oe)}const Q=oe=>this.inputType.kind==="number"?Number(oe):oe;for(const[oe,ce]of W)h.push(ce.length===1?Q(ce[0]):ce.map(Q)),h.push(this.outputs[oe].serialize());return h.push(this.otherwise.serialize()),h}}var Th=Zu;class Ku{constructor(h,U,W){this.type=h,this.branches=U,this.otherwise=W}static parse(h,U){if(h.length<4)return U.error(`Expected at least 3 arguments, but found only ${h.length-1}.`);if(h.length%2!=0)return U.error("Expected an odd number of arguments.");let W;U.expectedType&&U.expectedType.kind!=="value"&&(W=U.expectedType);const K=[];for(let oe=1;oe<h.length-1;oe+=2){const ce=U.parse(h[oe],oe,vi);if(!ce)return null;const fe=U.parse(h[oe+1],oe+1,W);if(!fe)return null;K.push([ce,fe]),W=W||fe.type}const Q=U.parse(h[h.length-1],h.length-1,W);return Q?new Ku(W,K,Q):null}evaluate(h){for(const[U,W]of this.branches)if(U.evaluate(h))return W.evaluate(h);return this.otherwise.evaluate(h)}eachChild(h){for(const[U,W]of this.branches)h(U),h(W);h(this.otherwise)}outputDefined(){return this.branches.every(([h,U])=>U.outputDefined())&&this.otherwise.outputDefined()}serialize(){const h=["case"];return this.eachChild(U=>{h.push(U.serialize())}),h}}var lc=Ku;class Qo{constructor(h,U,W,K){this.type=h,this.input=U,this.beginIndex=W,this.endIndex=K}static parse(h,U){if(h.length<=2||h.length>=5)return U.error(`Expected 3 or 4 arguments, but found ${h.length-1} instead.`);const W=U.parse(h[1],1,bi),K=U.parse(h[2],2,Fr);if(!W||!K)return null;if(!No(W.type,[$n(bi),Si,bi]))return U.error(`Expected first argument to be of type array or string, but found ${Xi(W.type)} instead`);if(h.length===4){const Q=U.parse(h[3],3,Fr);return Q?new Qo(W.type,W,K,Q):null}return new Qo(W.type,W,K)}evaluate(h){const U=this.input.evaluate(h),W=this.beginIndex.evaluate(h);if(!jo(U,["string","array"]))throw new wn(`Expected first argument to be of type array or string, but found ${Xi(rn(U))} instead.`);if(this.endIndex){const K=this.endIndex.evaluate(h);return U.slice(W,K)}return U.slice(W)}eachChild(h){h(this.input),h(this.beginIndex),this.endIndex&&h(this.endIndex)}outputDefined(){return!1}serialize(){if(this.endIndex!=null&&this.endIndex!==void 0){const h=this.endIndex.serialize();return["slice",this.input.serialize(),this.beginIndex.serialize(),h]}return["slice",this.input.serialize(),this.beginIndex.serialize()]}}var cc=Qo;function ks(R,h){return R==="=="||R==="!="?h.kind==="boolean"||h.kind==="string"||h.kind==="number"||h.kind==="null"||h.kind==="value":h.kind==="string"||h.kind==="number"||h.kind==="value"}function hc(R,h,U,W){return W.compare(h,U)===0}function go(R,h,U){const W=R!=="=="&&R!=="!=";return class I_{constructor(Q,oe,ce){this.type=vi,this.lhs=Q,this.rhs=oe,this.collator=ce,this.hasUntypedArgument=Q.type.kind==="value"||oe.type.kind==="value"}static parse(Q,oe){if(Q.length!==3&&Q.length!==4)return oe.error("Expected two or three arguments.");const ce=Q[0];let fe=oe.parse(Q[1],1,bi);if(!fe)return null;if(!ks(ce,fe.type))return oe.concat(1).error(`"${ce}" comparisons are not supported for type '${Xi(fe.type)}'.`);let pe=oe.parse(Q[2],2,bi);if(!pe)return null;if(!ks(ce,pe.type))return oe.concat(2).error(`"${ce}" comparisons are not supported for type '${Xi(pe.type)}'.`);if(fe.type.kind!==pe.type.kind&&fe.type.kind!=="value"&&pe.type.kind!=="value")return oe.error(`Cannot compare types '${Xi(fe.type)}' and '${Xi(pe.type)}'.`);W&&(fe.type.kind==="value"&&pe.type.kind!=="value"?fe=new ga(pe.type,[fe]):fe.type.kind!=="value"&&pe.type.kind==="value"&&(pe=new ga(fe.type,[pe])));let ve=null;if(Q.length===4){if(fe.type.kind!=="string"&&pe.type.kind!=="string"&&fe.type.kind!=="value"&&pe.type.kind!=="value")return oe.error("Cannot use collator to compare non-string types.");if(ve=oe.parse(Q[3],3,Un),!ve)return null}return new I_(fe,pe,ve)}evaluate(Q){const oe=this.lhs.evaluate(Q),ce=this.rhs.evaluate(Q);if(W&&this.hasUntypedArgument){const fe=rn(oe),pe=rn(ce);if(fe.kind!==pe.kind||fe.kind!=="string"&&fe.kind!=="number")throw new wn(`Expected arguments for "${R}" to be (string, string) or (number, number), but found (${fe.kind}, ${pe.kind}) instead.`)}if(this.collator&&!W&&this.hasUntypedArgument){const fe=rn(oe),pe=rn(ce);if(fe.kind!=="string"||pe.kind!=="string")return h(Q,oe,ce)}return this.collator?U(Q,oe,ce,this.collator.evaluate(Q)):h(Q,oe,ce)}eachChild(Q){Q(this.lhs),Q(this.rhs),this.collator&&Q(this.collator)}outputDefined(){return!0}serialize(){const Q=[R];return this.eachChild(oe=>{Q.push(oe.serialize())}),Q}}}const qh=go("==",function(R,h,U){return h===U},hc),Ih=go("!=",function(R,h,U){return h!==U},function(R,h,U,W){return!hc(0,h,U,W)}),Ah=go("<",function(R,h,U){return h<U},function(R,h,U,W){return W.compare(h,U)<0}),Rh=go(">",function(R,h,U){return h>U},function(R,h,U,W){return W.compare(h,U)>0}),Oh=go("<=",function(R,h,U){return h<=U},function(R,h,U,W){return W.compare(h,U)<=0}),dc=go(">=",function(R,h,U){return h>=U},function(R,h,U,W){return W.compare(h,U)>=0});class Bs{constructor(h,U,W,K,Q,oe){this.type=Si,this.number=h,this.locale=U,this.currency=W,this.unit=K,this.minFractionDigits=Q,this.maxFractionDigits=oe}static parse(h,U){if(h.length!==3)return U.error("Expected two arguments.");const W=U.parse(h[1],1,Fr);if(!W)return null;const K=h[2];if(typeof K!="object"||Array.isArray(K))return U.error("NumberFormat options argument must be an object.");let Q=null;if(K.locale&&(Q=U.parse(K.locale,1,Si),!Q))return null;let oe=null;if(K.currency&&(oe=U.parse(K.currency,1,Si),!oe))return null;let ce=null;if(K.unit&&(ce=U.parse(K.unit,1,Si),!ce))return null;let fe=null;if(K["min-fraction-digits"]&&(fe=U.parse(K["min-fraction-digits"],1,Fr),!fe))return null;let pe=null;return K["max-fraction-digits"]&&(pe=U.parse(K["max-fraction-digits"],1,Fr),!pe)?null:new Bs(W,Q,oe,ce,fe,pe)}evaluate(h){return new Intl.NumberFormat(this.locale?this.locale.evaluate(h):[],{style:(this.currency?"currency":this.unit&&"unit")||"decimal",currency:this.currency?this.currency.evaluate(h):void 0,unit:this.unit?this.unit.evaluate(h):void 0,minimumFractionDigits:this.minFractionDigits?this.minFractionDigits.evaluate(h):void 0,maximumFractionDigits:this.maxFractionDigits?this.maxFractionDigits.evaluate(h):void 0}).format(this.number.evaluate(h))}eachChild(h){h(this.number),this.locale&&h(this.locale),this.currency&&h(this.currency),this.unit&&h(this.unit),this.minFractionDigits&&h(this.minFractionDigits),this.maxFractionDigits&&h(this.maxFractionDigits)}outputDefined(){return!1}serialize(){const h={};return this.locale&&(h.locale=this.locale.serialize()),this.currency&&(h.currency=this.currency.serialize()),this.unit&&(h.unit=this.unit.serialize()),this.minFractionDigits&&(h["min-fraction-digits"]=this.minFractionDigits.serialize()),this.maxFractionDigits&&(h["max-fraction-digits"]=this.maxFractionDigits.serialize()),["number-format",this.number.serialize(),h]}}class vo{constructor(h){this.type=Fr,this.input=h}static parse(h,U){if(h.length!==2)return U.error(`Expected 1 argument, but found ${h.length-1} instead.`);const W=U.parse(h[1],1);return W?W.type.kind!=="array"&&W.type.kind!=="string"&&W.type.kind!=="value"?U.error(`Expected argument of type string or array, but found ${Xi(W.type)} instead.`):new vo(W):null}evaluate(h){const U=this.input.evaluate(h);if(typeof U=="string"||Array.isArray(U))return U.length;throw new wn(`Expected value to be of type string or array, but found ${Xi(rn(U))} instead.`)}eachChild(h){h(this.input)}outputDefined(){return!1}serialize(){const h=["length"];return this.eachChild(U=>{h.push(U.serialize())}),h}}const fc={"==":qh,"!=":Ih,">":Rh,"<":Ah,">=":dc,"<=":Oh,array:ga,at:Sh,boolean:ga,case:lc,coalesce:$u,collator:Wo,format:La,image:qs,in:Fs,"index-of":uc,interpolate:la,"interpolate-hcl":la,"interpolate-lab":la,length:vo,let:sc,literal:Ha,match:Th,number:ga,"number-format":Bs,object:ga,slice:cc,step:ku,string:ga,"to-boolean":ho,"to-color":ho,"to-number":ho,"to-string":ho,var:rc,within:Rs};function pc(R,[h,U,W,K]){h=h.evaluate(R),U=U.evaluate(R),W=W.evaluate(R);const Q=K?K.evaluate(R):1,oe=Jl(h,U,W,Q);if(oe)throw new wn(oe);return new sn(h/255*Q,U/255*Q,W/255*Q,Q)}function Ea(R,h){return R in h}function zs(R,h){const U=h[R];return U===void 0?null:U}function Hn(R){return{type:R}}va.register(fc,{error:[{kind:"error"},[Si],(R,[h])=>{throw new wn(h.evaluate(R))}],typeof:[Si,[bi],(R,[h])=>Xi(rn(h.evaluate(R)))],"to-rgba":[$n(Fr,4),[jn],(R,[h])=>h.evaluate(R).toArray()],rgb:[jn,[Fr,Fr,Fr],pc],rgba:[jn,[Fr,Fr,Fr,Fr],pc],has:{type:vi,overloads:[[[Si],(R,[h])=>Ea(h.evaluate(R),R.properties())],[[Si,ta],(R,[h,U])=>Ea(h.evaluate(R),U.evaluate(R))]]},get:{type:bi,overloads:[[[Si],(R,[h])=>zs(h.evaluate(R),R.properties())],[[Si,ta],(R,[h,U])=>zs(h.evaluate(R),U.evaluate(R))]]},"feature-state":[bi,[Si],(R,[h])=>zs(h.evaluate(R),R.featureState||{})],properties:[ta,[],R=>R.properties()],"geometry-type":[Si,[],R=>R.geometryType()],id:[bi,[],R=>R.id()],zoom:[Fr,[],R=>R.globals.zoom],pitch:[Fr,[],R=>R.globals.pitch||0],"distance-from-center":[Fr,[],R=>R.distanceFromCenter()],"heatmap-density":[Fr,[],R=>R.globals.heatmapDensity||0],"line-progress":[Fr,[],R=>R.globals.lineProgress||0],"sky-radial-progress":[Fr,[],R=>R.globals.skyRadialProgress||0],accumulated:[bi,[],R=>R.globals.accumulated===void 0?null:R.globals.accumulated],"+":[Fr,Hn(Fr),(R,h)=>{let U=0;for(const W of h)U+=W.evaluate(R);return U}],"*":[Fr,Hn(Fr),(R,h)=>{let U=1;for(const W of h)U*=W.evaluate(R);return U}],"-":{type:Fr,overloads:[[[Fr,Fr],(R,[h,U])=>h.evaluate(R)-U.evaluate(R)],[[Fr],(R,[h])=>-h.evaluate(R)]]},"/":[Fr,[Fr,Fr],(R,[h,U])=>h.evaluate(R)/U.evaluate(R)],"%":[Fr,[Fr,Fr],(R,[h,U])=>h.evaluate(R)%U.evaluate(R)],ln2:[Fr,[],()=>Math.LN2],pi:[Fr,[],()=>Math.PI],e:[Fr,[],()=>Math.E],"^":[Fr,[Fr,Fr],(R,[h,U])=>Math.pow(h.evaluate(R),U.evaluate(R))],sqrt:[Fr,[Fr],(R,[h])=>Math.sqrt(h.evaluate(R))],log10:[Fr,[Fr],(R,[h])=>Math.log(h.evaluate(R))/Math.LN10],ln:[Fr,[Fr],(R,[h])=>Math.log(h.evaluate(R))],log2:[Fr,[Fr],(R,[h])=>Math.log(h.evaluate(R))/Math.LN2],sin:[Fr,[Fr],(R,[h])=>Math.sin(h.evaluate(R))],cos:[Fr,[Fr],(R,[h])=>Math.cos(h.evaluate(R))],tan:[Fr,[Fr],(R,[h])=>Math.tan(h.evaluate(R))],asin:[Fr,[Fr],(R,[h])=>Math.asin(h.evaluate(R))],acos:[Fr,[Fr],(R,[h])=>Math.acos(h.evaluate(R))],atan:[Fr,[Fr],(R,[h])=>Math.atan(h.evaluate(R))],min:[Fr,Hn(Fr),(R,h)=>Math.min(...h.map(U=>U.evaluate(R)))],max:[Fr,Hn(Fr),(R,h)=>Math.max(...h.map(U=>U.evaluate(R)))],abs:[Fr,[Fr],(R,[h])=>Math.abs(h.evaluate(R))],round:[Fr,[Fr],(R,[h])=>{const U=h.evaluate(R);return U<0?-Math.round(-U):Math.round(U)}],floor:[Fr,[Fr],(R,[h])=>Math.floor(h.evaluate(R))],ceil:[Fr,[Fr],(R,[h])=>Math.ceil(h.evaluate(R))],"filter-==":[vi,[Si,bi],(R,[h,U])=>R.properties()[h.value]===U.value],"filter-id-==":[vi,[bi],(R,[h])=>R.id()===h.value],"filter-type-==":[vi,[Si],(R,[h])=>R.geometryType()===h.value],"filter-<":[vi,[Si,bi],(R,[h,U])=>{const W=R.properties()[h.value],K=U.value;return typeof W==typeof K&&W<K}],"filter-id-<":[vi,[bi],(R,[h])=>{const U=R.id(),W=h.value;return typeof U==typeof W&&U<W}],"filter->":[vi,[Si,bi],(R,[h,U])=>{const W=R.properties()[h.value],K=U.value;return typeof W==typeof K&&W>K}],"filter-id->":[vi,[bi],(R,[h])=>{const U=R.id(),W=h.value;return typeof U==typeof W&&U>W}],"filter-<=":[vi,[Si,bi],(R,[h,U])=>{const W=R.properties()[h.value],K=U.value;return typeof W==typeof K&&W<=K}],"filter-id-<=":[vi,[bi],(R,[h])=>{const U=R.id(),W=h.value;return typeof U==typeof W&&U<=W}],"filter->=":[vi,[Si,bi],(R,[h,U])=>{const W=R.properties()[h.value],K=U.value;return typeof W==typeof K&&W>=K}],"filter-id->=":[vi,[bi],(R,[h])=>{const U=R.id(),W=h.value;return typeof U==typeof W&&U>=W}],"filter-has":[vi,[bi],(R,[h])=>h.value in R.properties()],"filter-has-id":[vi,[],R=>R.id()!==null&&R.id()!==void 0],"filter-type-in":[vi,[$n(Si)],(R,[h])=>h.value.indexOf(R.geometryType())>=0],"filter-id-in":[vi,[$n(bi)],(R,[h])=>h.value.indexOf(R.id())>=0],"filter-in-small":[vi,[Si,$n(bi)],(R,[h,U])=>U.value.indexOf(R.properties()[h.value])>=0],"filter-in-large":[vi,[Si,$n(bi)],(R,[h,U])=>function(W,K,Q,oe){for(;Q<=oe;){const ce=Q+oe>>1;if(K[ce]===W)return!0;K[ce]>W?oe=ce-1:Q=ce+1}return!1}(R.properties()[h.value],U.value,0,U.value.length-1)],all:{type:vi,overloads:[[[vi,vi],(R,[h,U])=>h.evaluate(R)&&U.evaluate(R)],[Hn(vi),(R,h)=>{for(const U of h)if(!U.evaluate(R))return!1;return!0}]]},any:{type:vi,overloads:[[[vi,vi],(R,[h,U])=>h.evaluate(R)||U.evaluate(R)],[Hn(vi),(R,h)=>{for(const U of h)if(U.evaluate(R))return!0;return!1}]]},"!":[vi,[vi],(R,[h])=>!h.evaluate(R)],"is-supported-script":[vi,[Si],(R,[h])=>{const U=R.globals&&R.globals.isSupportedScript;return!U||U(h.evaluate(R))}],upcase:[Si,[Si],(R,[h])=>h.evaluate(R).toUpperCase()],downcase:[Si,[Si],(R,[h])=>h.evaluate(R).toLowerCase()],concat:[Si,Hn(bi),(R,h)=>h.map(U=>$o(U.evaluate(R))).join("")],"resolved-locale":[Si,[Un],(R,[h])=>h.evaluate(R).resolvedLocale()]});var es=fc;function _c(R){return{result:"success",value:R}}function Ya(R){return{result:"error",value:R}}function bo(R){return R["property-type"]==="data-driven"}function Ns(R){return!!R.expression&&R.expression.parameters.indexOf("zoom")>-1}function js(R){return!!R.expression&&R.expression.interpolated}function qi(R){return R instanceof Number?"number":R instanceof String?"string":R instanceof Boolean?"boolean":Array.isArray(R)?"array":R===null?"null":typeof R}function ts(R){return typeof R=="object"&&R!==null&&!Array.isArray(R)}function mc(R){return R}function Us(R,h){const U=h.type==="color",W=R.stops&&typeof R.stops[0][0]=="object",K=W||!(W||R.property!==void 0),Q=R.type||(js(h)?"exponential":"interval");if(U&&((R=ma({},R)).stops&&(R.stops=R.stops.map(pe=>[pe[0],sn.parse(pe[1])])),R.default=sn.parse(R.default?R.default:h.default)),R.colorSpace&&R.colorSpace!=="rgb"&&!Vu[R.colorSpace])throw new Error(`Unknown color space: ${R.colorSpace}`);let oe,ce,fe;if(Q==="exponential")oe=wa;else if(Q==="interval")oe=Vs;else if(Q==="categorical"){oe=yc,ce=Object.create(null);for(const pe of R.stops)ce[pe[0]]=pe[1];fe=typeof R.stops[0][0]}else{if(Q!=="identity")throw new Error(`Unknown function type "${Q}"`);oe=gc}if(W){const pe={},ve=[];for(let Ae=0;Ae<R.stops.length;Ae++){const Pe=R.stops[Ae],ze=Pe[0].zoom;pe[ze]===void 0&&(pe[ze]={zoom:ze,type:R.type,property:R.property,default:R.default,stops:[]},ve.push(ze)),pe[ze].stops.push([Pe[0].value,Pe[1]])}const Ee=[];for(const Ae of ve)Ee.push([pe[Ae].zoom,Us(pe[Ae],h)]);const we={name:"linear"};return{kind:"composite",interpolationType:we,interpolationFactor:la.interpolationFactor.bind(void 0,we),zoomStops:Ee.map(Ae=>Ae[0]),evaluate:({zoom:Ae},Pe)=>wa({stops:Ee,base:R.base},h,Ae).evaluate(Ae,Pe)}}if(K){const pe=Q==="exponential"?{name:"exponential",base:R.base!==void 0?R.base:1}:null;return{kind:"camera",interpolationType:pe,interpolationFactor:la.interpolationFactor.bind(void 0,pe),zoomStops:R.stops.map(ve=>ve[0]),evaluate:({zoom:ve})=>oe(R,h,ve,ce,fe)}}return{kind:"source",evaluate(pe,ve){const Ee=ve&&ve.properties?ve.properties[R.property]:void 0;return Ee===void 0?xo(R.default,h.default):oe(R,h,Ee,ce,fe)}}}function xo(R,h,U){return R!==void 0?R:h!==void 0?h:U!==void 0?U:void 0}function yc(R,h,U,W,K){return xo(typeof U===K?W[U]:void 0,R.default,h.default)}function Vs(R,h,U){if(qi(U)!=="number")return xo(R.default,h.default);const W=R.stops.length;if(W===1||U<=R.stops[0][0])return R.stops[0][1];if(U>=R.stops[W-1][0])return R.stops[W-1][1];const K=Cs(R.stops.map(Q=>Q[0]),U);return R.stops[K][1]}function wa(R,h,U){const W=R.base!==void 0?R.base:1;if(qi(U)!=="number")return xo(R.default,h.default);const K=R.stops.length;if(K===1||U<=R.stops[0][0])return R.stops[0][1];if(U>=R.stops[K-1][0])return R.stops[K-1][1];const Q=Cs(R.stops.map(ve=>ve[0]),U),oe=function(ve,Ee,we,Ae){const Pe=Ae-we,ze=ve-we;return Pe===0?0:Ee===1?ze/Pe:(Math.pow(Ee,ze)-1)/(Math.pow(Ee,Pe)-1)}(U,W,R.stops[Q][0],R.stops[Q+1][0]),ce=R.stops[Q][1],fe=R.stops[Q+1][1];let pe=Ko[h.type]||mc;if(R.colorSpace&&R.colorSpace!=="rgb"){const ve=Vu[R.colorSpace];pe=(Ee,we)=>ve.reverse(ve.interpolate(ve.forward(Ee),ve.forward(we),oe))}return typeof ce.evaluate=="function"?{evaluate(...ve){const Ee=ce.evaluate.apply(void 0,ve),we=fe.evaluate.apply(void 0,ve);if(Ee!==void 0&&we!==void 0)return pe(Ee,we,oe)}}:pe(ce,fe,oe)}function gc(R,h,U){return h.type==="color"?U=sn.parse(U):h.type==="formatted"?U=Mn.fromString(U.toString()):h.type==="resolvedImage"?U=Wn.fromString(U.toString()):qi(U)===h.type||h.type==="enum"&&h.values[U]||(U=void 0),xo(U,R.default,h.default)}class Gs{constructor(h,U){this.expression=h,this._warningHistory={},this._evaluator=new Ru,this._defaultValue=U?function(W){return W.type==="color"&&(ts(W.default)||Array.isArray(W.default))?new sn(0,0,0,0):W.type==="color"?sn.parse(W.default)||null:W.default===void 0?null:W.default}(U):null,this._enumValues=U&&U.type==="enum"?U.values:null}evaluateWithoutErrorHandling(h,U,W,K,Q,oe,ce,fe){return this._evaluator.globals=h,this._evaluator.feature=U,this._evaluator.featureState=W,this._evaluator.canonical=K||null,this._evaluator.availableImages=Q||null,this._evaluator.formattedSection=oe,this._evaluator.featureTileCoord=ce||null,this._evaluator.featureDistanceData=fe||null,this.expression.evaluate(this._evaluator)}evaluate(h,U,W,K,Q,oe,ce,fe){this._evaluator.globals=h,this._evaluator.feature=U||null,this._evaluator.featureState=W||null,this._evaluator.canonical=K||null,this._evaluator.availableImages=Q||null,this._evaluator.formattedSection=oe||null,this._evaluator.featureTileCoord=ce||null,this._evaluator.featureDistanceData=fe||null;try{const pe=this.expression.evaluate(this._evaluator);if(pe==null||typeof pe=="number"&&pe!=pe)return this._defaultValue;if(this._enumValues&&!(pe in this._enumValues))throw new wn(`Expected value to be one of ${Object.keys(this._enumValues).map(ve=>JSON.stringify(ve)).join(", ")}, but found ${JSON.stringify(pe)} instead.`);return pe}catch(pe){return this._warningHistory[pe.message]||(this._warningHistory[pe.message]=!0,typeof console<"u"&&console.warn(pe.message)),this._defaultValue}}}function Eo(R){return Array.isArray(R)&&R.length>0&&typeof R[0]=="string"&&R[0]in es}function wo(R,h){const U=new Lu(es,[],h?function(K){const Q={color:jn,string:Si,number:Fr,enum:Si,boolean:vi,formatted:zo,resolvedImage:Wa};return K.type==="array"?$n(Q[K.value]||bi,K.length):Q[K.type]}(h):void 0),W=U.parse(R,void 0,void 0,void 0,h&&h.type==="string"?{typeAnnotation:"coerce"}:void 0);return W?_c(new Gs(W,h)):Ya(U.errors)}class Xu{constructor(h,U){this.kind=h,this._styleExpression=U,this.isStateDependent=h!=="constant"&&!xa(U.expression)}evaluateWithoutErrorHandling(h,U,W,K,Q,oe){return this._styleExpression.evaluateWithoutErrorHandling(h,U,W,K,Q,oe)}evaluate(h,U,W,K,Q,oe){return this._styleExpression.evaluate(h,U,W,K,Q,oe)}}class rs{constructor(h,U,W,K){this.kind=h,this.zoomStops=W,this._styleExpression=U,this.isStateDependent=h!=="camera"&&!xa(U.expression),this.interpolationType=K}evaluateWithoutErrorHandling(h,U,W,K,Q,oe){return this._styleExpression.evaluateWithoutErrorHandling(h,U,W,K,Q,oe)}evaluate(h,U,W,K,Q,oe){return this._styleExpression.evaluate(h,U,W,K,Q,oe)}interpolationFactor(h,U,W){return this.interpolationType?la.interpolationFactor(this.interpolationType,h,U,W):0}}function is(R,h){if((R=wo(R,h)).result==="error")return R;const U=R.value.expression,W=mo(U);if(!W&&!bo(h))return Ya([new sa("","data expressions not supported")]);const K=Ka(U,["zoom","pitch","distance-from-center"]);if(!K&&!Ns(h))return Ya([new sa("","zoom expressions not supported")]);const Q=Ws(U);return Q||K?Q instanceof sa?Ya([Q]):Q instanceof la&&!js(h)?Ya([new sa("",'"interpolate" expressions cannot be used with this property')]):_c(Q?new rs(W?"camera":"composite",R.value,Q.labels,Q instanceof la?Q.interpolation:void 0):new Xu(W?"constant":"source",R.value)):Ya([new sa("",'"zoom" expression may only be used as input to a top-level "step" or "interpolate" expression.')])}class $s{constructor(h,U){this._parameters=h,this._specification=U,ma(this,Us(this._parameters,this._specification))}static deserialize(h){return new $s(h._parameters,h._specification)}static serialize(h){return{_parameters:h._parameters,_specification:h._specification}}}function Ws(R){let h=null;if(R instanceof sc)h=Ws(R.result);else if(R instanceof $u){for(const U of R.args)if(h=Ws(U),h)break}else(R instanceof ku||R instanceof la)&&R.input instanceof va&&R.input.name==="zoom"&&(h=R);return h instanceof sa||R.eachChild(U=>{const W=Ws(U);W instanceof sa?h=W:!h&&W?h=new sa("",'"zoom" expression may only be used as input to a top-level "step" or "interpolate" expression.'):h&&W&&h!==W&&(h=new sa("",'Only one zoom-based "step" or "interpolate" subexpression may be used in an expression.'))}),h}class kr{constructor(h,U,W,K){this.message=(h?`${h}: `:"")+W,K&&(this.identifier=K),U!=null&&U.__line__&&(this.line=U.__line__)}}function ra(R){const h=R.key,U=R.value,W=R.valueSpec||{},K=R.objectElementValidators||{},Q=R.style,oe=R.styleSpec;let ce=[];const fe=qi(U);if(fe!=="object")return[new kr(h,U,`object expected, ${fe} found`)];for(const pe in U){const ve=pe.split(".")[0];let Ee;K[ve]?Ee=K[ve]:W[ve]?Ee=In:K["*"]?Ee=K["*"]:W["*"]&&(Ee=In),Ee?ce=ce.concat(Ee({key:(h&&`${h}.`)+pe,value:U[pe],valueSpec:W[ve]||W["*"],style:Q,styleSpec:oe,object:U,objectKey:pe},U)):ce.push(new kr(h,U[pe],`unknown property "${pe}"`))}for(const pe in W)K[pe]||W[pe].required&&W[pe].default===void 0&&U[pe]===void 0&&ce.push(new kr(h,U,`missing required property "${pe}"`));return ce}function vc(R){const h=R.value,U=R.valueSpec,W=R.style,K=R.styleSpec,Q=R.key,oe=R.arrayElementValidator||In;if(qi(h)!=="array")return[new kr(Q,h,`array expected, ${qi(h)} found`)];if(U.length&&h.length!==U.length)return[new kr(Q,h,`array length ${U.length} expected, length ${h.length} found`)];if(U["min-length"]&&h.length<U["min-length"])return[new kr(Q,h,`array length at least ${U["min-length"]} expected, length ${h.length} found`)];let ce={type:U.value,values:U.values,minimum:U.minimum,maximum:U.maximum,function:void 0};K.$version<7&&(ce.function=U.function),qi(U.value)==="object"&&(ce=U.value);let fe=[];for(let pe=0;pe<h.length;pe++)fe=fe.concat(oe({array:h,arrayIndex:pe,value:h[pe],valueSpec:ce,style:W,styleSpec:K,key:`${Q}[${pe}]`}));return fe}function ns(R){const h=R.key,U=R.value,W=R.valueSpec;let K=qi(U);if(K==="number"&&U!=U&&(K="NaN"),K!=="number")return[new kr(h,U,`number expected, ${K} found`)];if("minimum"in W){let Q=W.minimum;if(qi(W.minimum)==="array"&&(Q=W.minimum[R.arrayIndex]),U<Q)return[new kr(h,U,`${U} is less than the minimum value ${Q}`)]}if("maximum"in W){let Q=W.maximum;if(qi(W.maximum)==="array"&&(Q=W.maximum[R.arrayIndex]),U>Q)return[new kr(h,U,`${U} is greater than the maximum value ${Q}`)]}return[]}function as(R){const h=R.valueSpec,U=ln(R.value.type);let W,K,Q,oe={};const ce=U!=="categorical"&&R.value.property===void 0,fe=!ce,pe=qi(R.value.stops)==="array"&&qi(R.value.stops[0])==="array"&&qi(R.value.stops[0][0])==="object",ve=ra({key:R.key,value:R.value,valueSpec:R.styleSpec.function,style:R.style,styleSpec:R.styleSpec,objectElementValidators:{stops:function(Ae){if(U==="identity")return[new kr(Ae.key,Ae.value,'identity function may not have a "stops" property')];let Pe=[];const ze=Ae.value;return Pe=Pe.concat(vc({key:Ae.key,value:ze,valueSpec:Ae.valueSpec,style:Ae.style,styleSpec:Ae.styleSpec,arrayElementValidator:Ee})),qi(ze)==="array"&&ze.length===0&&Pe.push(new kr(Ae.key,ze,"array must have at least one stop")),Pe},default:function(Ae){return In({key:Ae.key,value:Ae.value,valueSpec:h,style:Ae.style,styleSpec:Ae.styleSpec})}}});return U==="identity"&&ce&&ve.push(new kr(R.key,R.value,'missing required property "property"')),U==="identity"||R.value.stops||ve.push(new kr(R.key,R.value,'missing required property "stops"')),U==="exponential"&&R.valueSpec.expression&&!js(R.valueSpec)&&ve.push(new kr(R.key,R.value,"exponential functions not supported")),R.styleSpec.$version>=8&&(fe&&!bo(R.valueSpec)?ve.push(new kr(R.key,R.value,"property functions not supported")):ce&&!Ns(R.valueSpec)&&ve.push(new kr(R.key,R.value,"zoom functions not supported"))),U!=="categorical"&&!pe||R.value.property!==void 0||ve.push(new kr(R.key,R.value,'"property" property is required')),ve;function Ee(Ae){let Pe=[];const ze=Ae.value,Xe=Ae.key;if(qi(ze)!=="array")return[new kr(Xe,ze,`array expected, ${qi(ze)} found`)];if(ze.length!==2)return[new kr(Xe,ze,`array length 2 expected, length ${ze.length} found`)];if(pe){if(qi(ze[0])!=="object")return[new kr(Xe,ze,`object expected, ${qi(ze[0])} found`)];if(ze[0].zoom===void 0)return[new kr(Xe,ze,"object stop key must have zoom")];if(ze[0].value===void 0)return[new kr(Xe,ze,"object stop key must have value")];const at=ln(ze[0].zoom);if(typeof at!="number")return[new kr(Xe,ze[0].zoom,"stop zoom values must be numbers")];if(Q&&Q>at)return[new kr(Xe,ze[0].zoom,"stop zoom values must appear in ascending order")];at!==Q&&(Q=at,K=void 0,oe={}),Pe=Pe.concat(ra({key:`${Xe}[0]`,value:ze[0],valueSpec:{zoom:{}},style:Ae.style,styleSpec:Ae.styleSpec,objectElementValidators:{zoom:ns,value:we}}))}else Pe=Pe.concat(we({key:`${Xe}[0]`,value:ze[0],style:Ae.style,styleSpec:Ae.styleSpec},ze));return Eo(gn(ze[1]))?Pe.concat([new kr(`${Xe}[1]`,ze[1],"expressions are not allowed in function stops.")]):Pe.concat(In({key:`${Xe}[1]`,value:ze[1],valueSpec:h,style:Ae.style,styleSpec:Ae.styleSpec}))}function we(Ae,Pe){const ze=qi(Ae.value),Xe=ln(Ae.value),at=Ae.value!==null?Ae.value:Pe;if(W){if(ze!==W)return[new kr(Ae.key,at,`${ze} stop domain type must match previous stop domain type ${W}`)]}else W=ze;if(ze!=="number"&&ze!=="string"&&ze!=="boolean"&&typeof Xe!="number"&&typeof Xe!="string"&&typeof Xe!="boolean")return[new kr(Ae.key,at,"stop domain value must be a number, string, or boolean")];if(ze!=="number"&&U!=="categorical"){let mt=`number expected, ${ze} found`;return bo(h)&&U===void 0&&(mt+='\nIf you intended to use a categorical function, specify `"type": "categorical"`.'),[new kr(Ae.key,at,mt)]}return U!=="categorical"||ze!=="number"||typeof Xe=="number"&&isFinite(Xe)&&Math.floor(Xe)===Xe?U!=="categorical"&&ze==="number"&&typeof Xe=="number"&&typeof K=="number"&&K!==void 0&&Xe<K?[new kr(Ae.key,at,"stop domain values must appear in ascending order")]:(K=Xe,U==="categorical"&&Xe in oe?[new kr(Ae.key,at,"stop domain values must be unique")]:(oe[Xe]=!0,[])):[new kr(Ae.key,at,`integer expected, found ${String(Xe)}`)]}}function vn(R){const h=(R.expressionContext==="property"?is:wo)(gn(R.value),R.valueSpec);if(h.result==="error")return h.value.map(W=>new kr(`${R.key}${W.key}`,R.value,W.message));const U=h.value.expression||h.value._styleExpression.expression;if(R.expressionContext==="property"&&R.propertyKey==="text-font"&&!U.outputDefined())return[new kr(R.key,R.value,`Invalid data expression for "${R.propertyKey}". Output values must be contained as literals within the expression.`)];if(R.expressionContext==="property"&&R.propertyType==="layout"&&!xa(U))return[new kr(R.key,R.value,'"feature-state" data expressions are not supported with layout properties.')];if(R.expressionContext==="filter")return os(U,R);if(R.expressionContext&&R.expressionContext.indexOf("cluster")===0){if(!Ka(U,["zoom","feature-state"]))return[new kr(R.key,R.value,'"zoom" and "feature-state" expressions are not supported with cluster properties.')];if(R.expressionContext==="cluster-initial"&&!mo(U))return[new kr(R.key,R.value,"Feature data expressions are not supported with initial expression part of cluster properties.")]}return[]}function os(R,h){const U=new Set(["zoom","feature-state","pitch","distance-from-center"]);if(h.valueSpec&&h.valueSpec.expression)for(const K of h.valueSpec.expression.parameters)U.delete(K);if(U.size===0)return[];const W=[];return R instanceof va&&U.has(R.name)?[new kr(h.key,h.value,`["${R.name}"] expression is not supported in a filter for a ${h.object.type} layer with id: ${h.object.id}`)]:(R.eachChild(K=>{W.push(...os(K,h))}),W)}function Hs(R){const h=R.key,U=R.value,W=R.valueSpec,K=[];return Array.isArray(W.values)?W.values.indexOf(ln(U))===-1&&K.push(new kr(h,U,`expected one of [${W.values.join(", ")}], ${JSON.stringify(U)} found`)):Object.keys(W.values).indexOf(ln(U))===-1&&K.push(new kr(h,U,`expected one of [${Object.keys(W.values).join(", ")}], ${JSON.stringify(U)} found`)),K}function Yu(R){if(R===!0||R===!1)return!0;if(!Array.isArray(R)||R.length===0)return!1;switch(R[0]){case"has":return R.length>=2&&R[1]!=="$id"&&R[1]!=="$type";case"in":return R.length>=3&&(typeof R[1]!="string"||Array.isArray(R[2]));case"!in":case"!has":case"none":return!1;case"==":case"!=":case">":case">=":case"<":case"<=":return R.length!==3||Array.isArray(R[1])||Array.isArray(R[2]);case"any":case"all":for(const h of R.slice(1))if(!Yu(h)&&typeof h!="boolean")return!1;return!0;default:return!0}}function Zs(R,h="fill"){if(R==null)return{filter:()=>!0,needGeometry:!1,needFeature:!1};Yu(R)||(R=To(R));const U=R;let W=!0;try{W=function(pe){if(!So(pe))return pe;let ve=gn(pe);return Ks(ve),ve=bc(ve),ve}(U)}catch{console.warn(`Failed to extract static filter. Filter will continue working, but at higher memory usage and slower framerate.
This is most likely a bug, please report this via https://github.com/mapbox/mapbox-gl-js/issues/new?assignees=&labels=&template=Bug_report.md
and paste the contents of this message in the report.
Thank you!
Filter Expression:
${JSON.stringify(U,null,2)}
        `)}const K=Yt[`filter_${h}`],Q=wo(W,K);let oe=null;if(Q.result==="error")throw new Error(Q.value.map(pe=>`${pe.key}: ${pe.message}`).join(", "));oe=(pe,ve,Ee)=>Q.value.evaluate(pe,ve,{},Ee);let ce=null,fe=null;if(W!==U){const pe=wo(U,K);if(pe.result==="error")throw new Error(pe.value.map(ve=>`${ve.key}: ${ve.message}`).join(", "));ce=(ve,Ee,we,Ae,Pe)=>pe.value.evaluate(ve,Ee,{},we,void 0,void 0,Ae,Pe),fe=!mo(pe.value.expression)}return{filter:oe,dynamicFilter:ce||void 0,needGeometry:xc(W),needFeature:!!fe}}function bc(R){if(!Array.isArray(R))return R;const h=function(U){if(Ju.has(U[0])){for(let W=1;W<U.length;W++)if(So(U[W]))return!0}return U}(R);return h===!0?h:h.map(U=>bc(U))}function Ks(R){let h=!1;const U=[];if(R[0]==="case"){for(let W=1;W<R.length-1;W+=2)h=h||So(R[W]),U.push(R[W+1]);U.push(R[R.length-1])}else if(R[0]==="match"){h=h||So(R[1]);for(let W=2;W<R.length-1;W+=2)U.push(R[W+1]);U.push(R[R.length-1])}else if(R[0]==="step"){h=h||So(R[1]);for(let W=1;W<R.length-1;W+=2)U.push(R[W+1])}h&&(R.length=0,R.push("any",...U));for(let W=1;W<R.length;W++)Ks(R[W])}function So(R){if(!Array.isArray(R))return!1;if((h=R[0])==="pitch"||h==="distance-from-center")return!0;var h;for(let U=1;U<R.length;U++)if(So(R[U]))return!0;return!1}const Ju=new Set(["in","==","!=",">",">=","<","<=","to-boolean"]);function Ch(R,h){return R<h?-1:R>h?1:0}function xc(R){if(!Array.isArray(R))return!1;if(R[0]==="within")return!0;for(let h=1;h<R.length;h++)if(xc(R[h]))return!0;return!1}function To(R){if(!R)return!0;const h=R[0];return R.length<=1?h!=="any":h==="=="?Qu(R[1],R[2],"=="):h==="!="?Xs(Qu(R[1],R[2],"==")):h==="<"||h===">"||h==="<="||h===">="?Qu(R[1],R[2],h):h==="any"?(U=R.slice(1),["any"].concat(U.map(To))):h==="all"?["all"].concat(R.slice(1).map(To)):h==="none"?["all"].concat(R.slice(1).map(To).map(Xs)):h==="in"?el(R[1],R.slice(2)):h==="!in"?Xs(el(R[1],R.slice(2))):h==="has"?tl(R[1]):h==="!has"?Xs(tl(R[1])):h!=="within"||R;var U}function Qu(R,h,U){switch(R){case"$type":return[`filter-type-${U}`,h];case"$id":return[`filter-id-${U}`,h];default:return[`filter-${U}`,R,h]}}function el(R,h){if(h.length===0)return!1;switch(R){case"$type":return["filter-type-in",["literal",h]];case"$id":return["filter-id-in",["literal",h]];default:return h.length>200&&!h.some(U=>typeof U!=typeof h[0])?["filter-in-large",R,["literal",h.sort(Ch)]]:["filter-in-small",R,["literal",h]]}}function tl(R){switch(R){case"$type":return!0;case"$id":return["filter-has-id"];default:return["filter-has",R]}}function Xs(R){return["!",R]}function ss(R){return Yu(gn(R.value))?vn(ma({},R,{expressionContext:"filter",valueSpec:R.styleSpec[`filter_${R.layerType||"fill"}`]})):us(R)}function us(R){const h=R.value,U=R.key;if(qi(h)!=="array")return[new kr(U,h,`array expected, ${qi(h)} found`)];const W=R.styleSpec;let K,Q=[];if(h.length<1)return[new kr(U,h,"filter array must have at least 1 element")];switch(Q=Q.concat(Hs({key:`${U}[0]`,value:h[0],valueSpec:W.filter_operator,style:R.style,styleSpec:R.styleSpec})),ln(h[0])){case"<":case"<=":case">":case">=":h.length>=2&&ln(h[1])==="$type"&&Q.push(new kr(U,h,`"$type" cannot be use with operator "${h[0]}"`));case"==":case"!=":h.length!==3&&Q.push(new kr(U,h,`filter array for operator "${h[0]}" must have 3 elements`));case"in":case"!in":h.length>=2&&(K=qi(h[1]),K!=="string"&&Q.push(new kr(`${U}[1]`,h[1],`string expected, ${K} found`)));for(let oe=2;oe<h.length;oe++)K=qi(h[oe]),ln(h[1])==="$type"?Q=Q.concat(Hs({key:`${U}[${oe}]`,value:h[oe],valueSpec:W.geometry_type,style:R.style,styleSpec:R.styleSpec})):K!=="string"&&K!=="number"&&K!=="boolean"&&Q.push(new kr(`${U}[${oe}]`,h[oe],`string, number, or boolean expected, ${K} found`));break;case"any":case"all":case"none":for(let oe=1;oe<h.length;oe++)Q=Q.concat(us({key:`${U}[${oe}]`,value:h[oe],style:R.style,styleSpec:R.styleSpec}));break;case"has":case"!has":K=qi(h[1]),h.length!==2?Q.push(new kr(U,h,`filter array for "${h[0]}" operator must have 2 elements`)):K!=="string"&&Q.push(new kr(`${U}[1]`,h[1],`string expected, ${K} found`));break;case"within":K=qi(h[1]),h.length!==2?Q.push(new kr(U,h,`filter array for "${h[0]}" operator must have 2 elements`)):K!=="object"&&Q.push(new kr(`${U}[1]`,h[1],`object expected, ${K} found`))}return Q}function rl(R,h){const U=R.key,W=R.style,K=R.styleSpec,Q=R.value,oe=R.objectKey,ce=K[`${h}_${R.layerType}`];if(!ce)return[];const fe=oe.match(/^(.*)-transition$/);if(h==="paint"&&fe&&ce[fe[1]]&&ce[fe[1]].transition)return In({key:U,value:Q,valueSpec:K.transition,style:W,styleSpec:K});const pe=R.valueSpec||ce[oe];if(!pe)return[new kr(U,Q,`unknown property "${oe}"`)];let ve;if(qi(Q)==="string"&&bo(pe)&&!pe.tokens&&(ve=/^{([^}]+)}$/.exec(Q))){const we=`\`{ "type": "identity", "property": ${ve?JSON.stringify(ve[1]):'"_"'} }\``;return[new kr(U,Q,`"${oe}" does not support interpolation syntax
Use an identity property function instead: ${we}.`)]}const Ee=[];return R.layerType==="symbol"&&(oe==="text-field"&&W&&!W.glyphs&&Ee.push(new kr(U,Q,'use of "text-field" requires a style "glyphs" property')),oe==="text-font"&&ts(gn(Q))&&ln(Q.type)==="identity"&&Ee.push(new kr(U,Q,'"text-font" does not support identity functions'))),Ee.concat(In({key:R.key,value:Q,valueSpec:pe,style:W,styleSpec:K,expressionContext:"property",propertyType:h,propertyKey:oe}))}function Ec(R){return rl(R,"paint")}function il(R){return rl(R,"layout")}function wc(R){let h=[];const U=R.value,W=R.key,K=R.style,Q=R.styleSpec;U.type||U.ref||h.push(new kr(W,U,'either "type" or "ref" is required'));let oe=ln(U.type);const ce=ln(U.ref);if(U.id){const fe=ln(U.id);for(let pe=0;pe<R.arrayIndex;pe++){const ve=K.layers[pe];ln(ve.id)===fe&&h.push(new kr(W,U.id,`duplicate layer id "${U.id}", previously used at line ${ve.id.__line__}`))}}if("ref"in U){let fe;["type","source","source-layer","filter","layout"].forEach(pe=>{pe in U&&h.push(new kr(W,U[pe],`"${pe}" is prohibited for ref layers`))}),K.layers.forEach(pe=>{ln(pe.id)===ce&&(fe=pe)}),fe?fe.ref?h.push(new kr(W,U.ref,"ref cannot reference another ref layer")):oe=ln(fe.type):typeof ce=="string"&&h.push(new kr(W,U.ref,`ref layer "${ce}" not found`))}else if(oe!=="background"&&oe!=="sky")if(U.source){const fe=K.sources&&K.sources[U.source],pe=fe&&ln(fe.type);fe?pe==="vector"&&oe==="raster"?h.push(new kr(W,U.source,`layer "${U.id}" requires a raster source`)):pe==="raster"&&oe!=="raster"?h.push(new kr(W,U.source,`layer "${U.id}" requires a vector source`)):pe!=="vector"||U["source-layer"]?pe==="raster-dem"&&oe!=="hillshade"?h.push(new kr(W,U.source,"raster-dem source can only be used with layer type 'hillshade'.")):oe!=="line"||!U.paint||!U.paint["line-gradient"]&&!U.paint["line-trim-offset"]||pe==="geojson"&&fe.lineMetrics||h.push(new kr(W,U,`layer "${U.id}" specifies a line-gradient, which requires a GeoJSON source with \`lineMetrics\` enabled.`)):h.push(new kr(W,U,`layer "${U.id}" must specify a "source-layer"`)):h.push(new kr(W,U.source,`source "${U.source}" not found`))}else h.push(new kr(W,U,'missing required property "source"'));return h=h.concat(ra({key:W,value:U,valueSpec:Q.layer,style:R.style,styleSpec:R.styleSpec,objectElementValidators:{"*":()=>[],type:()=>In({key:`${W}.type`,value:U.type,valueSpec:Q.layer.type,style:R.style,styleSpec:R.styleSpec,object:U,objectKey:"type"}),filter:fe=>ss(ma({layerType:oe},fe)),layout:fe=>ra({layer:U,key:fe.key,value:fe.value,valueSpec:{},style:fe.style,styleSpec:fe.styleSpec,objectElementValidators:{"*":pe=>il(ma({layerType:oe},pe))}}),paint:fe=>ra({layer:U,key:fe.key,value:fe.value,valueSpec:{},style:fe.style,styleSpec:fe.styleSpec,objectElementValidators:{"*":pe=>Ec(ma({layerType:oe},pe))}})}})),h}function Fa(R){const h=R.value,U=R.key,W=qi(h);return W!=="string"?[new kr(U,h,`string expected, ${W} found`)]:[]}const Sc={promoteId:function({key:R,value:h}){if(qi(h)==="string")return Fa({key:R,value:h});{const U=[];for(const W in h)U.push(...Fa({key:`${R}.${W}`,value:h[W]}));return U}}};function Tc(R){const h=R.value,U=R.key,W=R.styleSpec,K=R.style;if(!h.type)return[new kr(U,h,'"type" is required')];const Q=ln(h.type);let oe;switch(Q){case"vector":case"raster":case"raster-dem":return oe=ra({key:U,value:h,valueSpec:W[`source_${Q.replace("-","_")}`],style:R.style,styleSpec:W,objectElementValidators:Sc}),oe;case"geojson":if(oe=ra({key:U,value:h,valueSpec:W.source_geojson,style:K,styleSpec:W,objectElementValidators:Sc}),h.cluster)for(const ce in h.clusterProperties){const[fe,pe]=h.clusterProperties[ce],ve=typeof fe=="string"?[fe,["accumulated"],["get",ce]]:fe;oe.push(...vn({key:`${U}.${ce}.map`,value:pe,expressionContext:"cluster-map"})),oe.push(...vn({key:`${U}.${ce}.reduce`,value:ve,expressionContext:"cluster-reduce"}))}return oe;case"video":return ra({key:U,value:h,valueSpec:W.source_video,style:K,styleSpec:W});case"image":return ra({key:U,value:h,valueSpec:W.source_image,style:K,styleSpec:W});case"canvas":return[new kr(U,null,"Please use runtime APIs to add canvas sources, rather than including them in stylesheets.","source.canvas")];default:return Hs({key:`${U}.type`,value:h.type,valueSpec:{values:Ph(W)}})}}function Ph(R){return R.source.reduce((h,U)=>{const W=R[U];return W.type.type==="enum"&&(h=h.concat(Object.keys(W.type.values))),h},[])}function qc(R){const h=R.value,U=R.styleSpec,W=U.light,K=R.style;let Q=[];const oe=qi(h);if(h===void 0)return Q;if(oe!=="object")return Q=Q.concat([new kr("light",h,`object expected, ${oe} found`)]),Q;for(const ce in h){const fe=ce.match(/^(.*)-transition$/);Q=Q.concat(fe&&W[fe[1]]&&W[fe[1]].transition?In({key:ce,value:h[ce],valueSpec:U.transition,style:K,styleSpec:U}):W[ce]?In({key:ce,value:h[ce],valueSpec:W[ce],style:K,styleSpec:U}):[new kr(ce,h[ce],`unknown property "${ce}"`)])}return Q}function nl(R){const h=R.value,U=R.key,W=R.style,K=R.styleSpec,Q=K.terrain;let oe=[];const ce=qi(h);if(h===void 0)return oe;if(ce!=="object")return oe=oe.concat([new kr("terrain",h,`object expected, ${ce} found`)]),oe;for(const fe in h){const pe=fe.match(/^(.*)-transition$/);oe=oe.concat(pe&&Q[pe[1]]&&Q[pe[1]].transition?In({key:fe,value:h[fe],valueSpec:K.transition,style:W,styleSpec:K}):Q[fe]?In({key:fe,value:h[fe],valueSpec:Q[fe],style:W,styleSpec:K}):[new kr(fe,h[fe],`unknown property "${fe}"`)])}if(h.source){const fe=W.sources&&W.sources[h.source],pe=fe&&ln(fe.type);fe?pe!=="raster-dem"&&oe.push(new kr(U,h.source,`terrain cannot be used with a source of type ${String(pe)}, it only be used with a "raster-dem" source type`)):oe.push(new kr(U,h.source,`source "${h.source}" not found`))}else oe.push(new kr(U,h,'terrain is missing required property "source"'));return oe}function Ic(R){const h=R.value,U=R.style,W=R.styleSpec,K=W.fog;let Q=[];const oe=qi(h);if(h===void 0)return Q;if(oe!=="object")return Q=Q.concat([new kr("fog",h,`object expected, ${oe} found`)]),Q;for(const ce in h){const fe=ce.match(/^(.*)-transition$/);Q=Q.concat(fe&&K[fe[1]]&&K[fe[1]].transition?In({key:ce,value:h[ce],valueSpec:W.transition,style:U,styleSpec:W}):K[ce]?In({key:ce,value:h[ce],valueSpec:K[ce],style:U,styleSpec:W}):[new kr(ce,h[ce],`unknown property "${ce}"`)])}return Q}const Ac={"*":()=>[],array:vc,boolean:function(R){const h=R.value,U=R.key,W=qi(h);return W!=="boolean"?[new kr(U,h,`boolean expected, ${W} found`)]:[]},number:ns,color:function(R){const h=R.key,U=R.value,W=qi(U);return W!=="string"?[new kr(h,U,`color expected, ${W} found`)]:Eu(U)===null?[new kr(h,U,`color expected, "${U}" found`)]:[]},enum:Hs,filter:ss,function:as,layer:wc,object:ra,source:Tc,light:qc,terrain:nl,fog:Ic,string:Fa,formatted:function(R){return Fa(R).length===0?[]:vn(R)},resolvedImage:function(R){return Fa(R).length===0?[]:vn(R)},projection:function(R){const h=R.value,U=R.styleSpec,W=U.projection,K=R.style;let Q=[];const oe=qi(h);if(oe==="object")for(const ce in h)Q=Q.concat(In({key:ce,value:h[ce],valueSpec:W[ce],style:K,styleSpec:U}));else oe!=="string"&&(Q=Q.concat([new kr("projection",h,`object or string expected, ${oe} found`)]));return Q}};function In(R){const h=R.value,U=R.valueSpec,W=R.styleSpec;return U.expression&&ts(ln(h))?as(R):U.expression&&Eo(gn(h))?vn(R):U.type&&Ac[U.type]?Ac[U.type](R):ra(ma({},R,{valueSpec:U.type?W[U.type]:U}))}function Mh(R){const h=R.value,U=R.key,W=Fa(R);return W.length||(h.indexOf("{fontstack}")===-1&&W.push(new kr(U,h,'"glyphs" url must include a "{fontstack}" token')),h.indexOf("{range}")===-1&&W.push(new kr(U,h,'"glyphs" url must include a "{range}" token'))),W}function Rc(R,h=Yt){return Zn(In({key:"",value:R,valueSpec:h.$root,styleSpec:h,style:R,objectElementValidators:{glyphs:Mh,"*":()=>[]}}))}const Dh=R=>Zn(Ec(R)),Lh=R=>Zn(il(R));function Zn(R){return R.slice().sort((h,U)=>h.line&&U.line?h.line-U.line:0)}function Oc(R,h){let U=!1;if(h&&h.length)for(const W of h)R.fire(new Gn(new Error(W.message))),U=!0;return U}var Fh=ca,ia=3;function ca(R,h,U){var W=this.cells=[];if(R instanceof ArrayBuffer){this.arrayBuffer=R;var K=new Int32Array(this.arrayBuffer);R=K[0],this.d=(h=K[1])+2*(U=K[2]);for(var Q=0;Q<this.d*this.d;Q++){var oe=K[ia+Q],ce=K[ia+Q+1];W.push(oe===ce?null:K.subarray(oe,ce))}var fe=K[ia+W.length+1];this.keys=K.subarray(K[ia+W.length],fe),this.bboxes=K.subarray(fe),this.insert=this._insertReadonly}else{this.d=h+2*U;for(var pe=0;pe<this.d*this.d;pe++)W.push([]);this.keys=[],this.bboxes=[]}this.n=h,this.extent=R,this.padding=U,this.scale=h/R,this.uid=0;var ve=U/h*R;this.min=-ve,this.max=R+ve}ca.prototype.insert=function(R,h,U,W,K){this._forEachCell(h,U,W,K,this._insertCell,this.uid++),this.keys.push(R),this.bboxes.push(h),this.bboxes.push(U),this.bboxes.push(W),this.bboxes.push(K)},ca.prototype._insertReadonly=function(){throw"Cannot insert into a GridIndex created from an ArrayBuffer."},ca.prototype._insertCell=function(R,h,U,W,K,Q){this.cells[K].push(Q)},ca.prototype.query=function(R,h,U,W,K){var Q=this.min,oe=this.max;if(R<=Q&&h<=Q&&oe<=U&&oe<=W&&!K)return Array.prototype.slice.call(this.keys);var ce=[];return this._forEachCell(R,h,U,W,this._queryCell,ce,{},K),ce},ca.prototype._queryCell=function(R,h,U,W,K,Q,oe,ce){var fe=this.cells[K];if(fe!==null)for(var pe=this.keys,ve=this.bboxes,Ee=0;Ee<fe.length;Ee++){var we=fe[Ee];if(oe[we]===void 0){var Ae=4*we;(ce?ce(ve[Ae+0],ve[Ae+1],ve[Ae+2],ve[Ae+3]):R<=ve[Ae+2]&&h<=ve[Ae+3]&&U>=ve[Ae+0]&&W>=ve[Ae+1])?(oe[we]=!0,Q.push(pe[we])):oe[we]=!1}}},ca.prototype._forEachCell=function(R,h,U,W,K,Q,oe,ce){for(var fe=this._convertToCellCoord(R),pe=this._convertToCellCoord(h),ve=this._convertToCellCoord(U),Ee=this._convertToCellCoord(W),we=fe;we<=ve;we++)for(var Ae=pe;Ae<=Ee;Ae++){var Pe=this.d*Ae+we;if((!ce||ce(this._convertFromCellCoord(we),this._convertFromCellCoord(Ae),this._convertFromCellCoord(we+1),this._convertFromCellCoord(Ae+1)))&&K.call(this,R,h,U,W,Pe,Q,oe,ce))return}},ca.prototype._convertFromCellCoord=function(R){return(R-this.padding)/this.scale},ca.prototype._convertToCellCoord=function(R){return Math.max(0,Math.min(this.d-1,Math.floor(R*this.scale)+this.padding))},ca.prototype.toArrayBuffer=function(){if(this.arrayBuffer)return this.arrayBuffer;for(var R=this.cells,h=ia+this.cells.length+1+1,U=0,W=0;W<this.cells.length;W++)U+=this.cells[W].length;var K=new Int32Array(h+U+this.keys.length+this.bboxes.length);K[0]=this.extent,K[1]=this.n,K[2]=this.padding;for(var Q=h,oe=0;oe<R.length;oe++){var ce=R[oe];K[ia+oe]=Q,K.set(ce,Q),Q+=ce.length}return K[ia+R.length]=Q,K.set(this.keys,Q),K[ia+R.length+1]=Q+=this.keys.length,K.set(this.bboxes,Q),Q+=this.bboxes.length,K.buffer};var Ja=Le(Fh);const Ys={};function Vr(R,h,U={}){Object.defineProperty(R,"_classRegistryKey",{value:h,writeable:!1}),Ys[h]={klass:R,omit:U.omit||[]}}Vr(Object,"Object"),Ja.serialize=function(R,h){const U=R.toArrayBuffer();return h&&h.push(U),{buffer:U}},Ja.deserialize=function(R){return new Ja(R.buffer)},Object.defineProperty(Ja,"name",{value:"Grid"}),Vr(Ja,"Grid"),Vr(sn,"Color"),Vr(Error,"Error"),Vr(Qt,"AJAXError"),Vr(Wn,"ResolvedImage"),Vr($s,"StylePropertyFunction"),Vr(Gs,"StyleExpression",{omit:["_evaluator"]}),Vr(rs,"ZoomDependentExpression"),Vr(Xu,"ZoomConstantExpression"),Vr(va,"CompoundExpression",{omit:["_evaluate"]});for(const R in es)Ys[es[R]._classRegistryKey]||Vr(es[R],`Expression${R}`);function al(R){return R&&typeof ArrayBuffer<"u"&&(R instanceof ArrayBuffer||R.constructor&&R.constructor.name==="ArrayBuffer")}function ol(R){return H.ImageBitmap&&R instanceof H.ImageBitmap}function qo(R,h){if(R==null||typeof R=="boolean"||typeof R=="number"||typeof R=="string"||R instanceof Boolean||R instanceof Number||R instanceof String||R instanceof Date||R instanceof RegExp)return R;if(al(R)||ol(R))return h&&h.push(R),R;if(ArrayBuffer.isView(R)){const U=R;return h&&h.push(U.buffer),U}if(R instanceof H.ImageData)return h&&h.push(R.data.buffer),R;if(Array.isArray(R)){const U=[];for(const W of R)U.push(qo(W,h));return U}if(typeof R=="object"){const U=R.constructor,W=U._classRegistryKey;if(!W)throw new Error(`can't serialize object of unregistered class ${W}`);const K=U.serialize?U.serialize(R,h):{};if(!U.serialize){for(const Q in R)R.hasOwnProperty(Q)&&(Ys[W].omit.indexOf(Q)>=0||(K[Q]=qo(R[Q],h)));R instanceof Error&&(K.message=R.message)}if(K.$name)throw new Error("$name property is reserved for worker serialization logic.");return W!=="Object"&&(K.$name=W),K}throw new Error("can't serialize object of type "+typeof R)}function Qa(R){if(R==null||typeof R=="boolean"||typeof R=="number"||typeof R=="string"||R instanceof Boolean||R instanceof Number||R instanceof String||R instanceof Date||R instanceof RegExp||al(R)||ol(R)||ArrayBuffer.isView(R)||R instanceof H.ImageData)return R;if(Array.isArray(R))return R.map(Qa);if(typeof R=="object"){const h=R.$name||"Object",{klass:U}=Ys[h];if(!U)throw new Error(`can't deserialize unregistered class ${h}`);if(U.deserialize)return U.deserialize(R);const W=Object.create(U.prototype);for(const K of Object.keys(R))K!=="$name"&&(W[K]=Qa(R[K]));return W}throw new Error("can't deserialize object of type "+typeof R)}const Dr={"Latin-1 Supplement":R=>R>=128&&R<=255,Arabic:R=>R>=1536&&R<=1791,"Arabic Supplement":R=>R>=1872&&R<=1919,"Arabic Extended-A":R=>R>=2208&&R<=2303,"Hangul Jamo":R=>R>=4352&&R<=4607,"Unified Canadian Aboriginal Syllabics":R=>R>=5120&&R<=5759,Khmer:R=>R>=6016&&R<=6143,"Unified Canadian Aboriginal Syllabics Extended":R=>R>=6320&&R<=6399,"General Punctuation":R=>R>=8192&&R<=8303,"Letterlike Symbols":R=>R>=8448&&R<=8527,"Number Forms":R=>R>=8528&&R<=8591,"Miscellaneous Technical":R=>R>=8960&&R<=9215,"Control Pictures":R=>R>=9216&&R<=9279,"Optical Character Recognition":R=>R>=9280&&R<=9311,"Enclosed Alphanumerics":R=>R>=9312&&R<=9471,"Geometric Shapes":R=>R>=9632&&R<=9727,"Miscellaneous Symbols":R=>R>=9728&&R<=9983,"Miscellaneous Symbols and Arrows":R=>R>=11008&&R<=11263,"CJK Radicals Supplement":R=>R>=11904&&R<=12031,"Kangxi Radicals":R=>R>=12032&&R<=12255,"Ideographic Description Characters":R=>R>=12272&&R<=12287,"CJK Symbols and Punctuation":R=>R>=12288&&R<=12351,Hiragana:R=>R>=12352&&R<=12447,Katakana:R=>R>=12448&&R<=12543,Bopomofo:R=>R>=12544&&R<=12591,"Hangul Compatibility Jamo":R=>R>=12592&&R<=12687,Kanbun:R=>R>=12688&&R<=12703,"Bopomofo Extended":R=>R>=12704&&R<=12735,"CJK Strokes":R=>R>=12736&&R<=12783,"Katakana Phonetic Extensions":R=>R>=12784&&R<=12799,"Enclosed CJK Letters and Months":R=>R>=12800&&R<=13055,"CJK Compatibility":R=>R>=13056&&R<=13311,"CJK Unified Ideographs Extension A":R=>R>=13312&&R<=19903,"Yijing Hexagram Symbols":R=>R>=19904&&R<=19967,"CJK Unified Ideographs":R=>R>=19968&&R<=40959,"Yi Syllables":R=>R>=40960&&R<=42127,"Yi Radicals":R=>R>=42128&&R<=42191,"Hangul Jamo Extended-A":R=>R>=43360&&R<=43391,"Hangul Syllables":R=>R>=44032&&R<=55215,"Hangul Jamo Extended-B":R=>R>=55216&&R<=55295,"Private Use Area":R=>R>=57344&&R<=63743,"CJK Compatibility Ideographs":R=>R>=63744&&R<=64255,"Arabic Presentation Forms-A":R=>R>=64336&&R<=65023,"Vertical Forms":R=>R>=65040&&R<=65055,"CJK Compatibility Forms":R=>R>=65072&&R<=65103,"Small Form Variants":R=>R>=65104&&R<=65135,"Arabic Presentation Forms-B":R=>R>=65136&&R<=65279,"Halfwidth and Fullwidth Forms":R=>R>=65280&&R<=65519};function sl(R){for(const h of R)if(ul(h.charCodeAt(0)))return!0;return!1}function kh(R){for(const h of R)if(!Cc(h.charCodeAt(0)))return!1;return!0}function Cc(R){return!(Dr.Arabic(R)||Dr["Arabic Supplement"](R)||Dr["Arabic Extended-A"](R)||Dr["Arabic Presentation Forms-A"](R)||Dr["Arabic Presentation Forms-B"](R))}function ul(R){return!(R!==746&&R!==747&&(R<4352||!(Dr["Bopomofo Extended"](R)||Dr.Bopomofo(R)||Dr["CJK Compatibility Forms"](R)&&!(R>=65097&&R<=65103)||Dr["CJK Compatibility Ideographs"](R)||Dr["CJK Compatibility"](R)||Dr["CJK Radicals Supplement"](R)||Dr["CJK Strokes"](R)||!(!Dr["CJK Symbols and Punctuation"](R)||R>=12296&&R<=12305||R>=12308&&R<=12319||R===12336)||Dr["CJK Unified Ideographs Extension A"](R)||Dr["CJK Unified Ideographs"](R)||Dr["Enclosed CJK Letters and Months"](R)||Dr["Hangul Compatibility Jamo"](R)||Dr["Hangul Jamo Extended-A"](R)||Dr["Hangul Jamo Extended-B"](R)||Dr["Hangul Jamo"](R)||Dr["Hangul Syllables"](R)||Dr.Hiragana(R)||Dr["Ideographic Description Characters"](R)||Dr.Kanbun(R)||Dr["Kangxi Radicals"](R)||Dr["Katakana Phonetic Extensions"](R)||Dr.Katakana(R)&&R!==12540||!(!Dr["Halfwidth and Fullwidth Forms"](R)||R===65288||R===65289||R===65293||R>=65306&&R<=65310||R===65339||R===65341||R===65343||R>=65371&&R<=65503||R===65507||R>=65512&&R<=65519)||!(!Dr["Small Form Variants"](R)||R>=65112&&R<=65118||R>=65123&&R<=65126)||Dr["Unified Canadian Aboriginal Syllabics"](R)||Dr["Unified Canadian Aboriginal Syllabics Extended"](R)||Dr["Vertical Forms"](R)||Dr["Yijing Hexagram Symbols"](R)||Dr["Yi Syllables"](R)||Dr["Yi Radicals"](R))))}function Pc(R){return!(ul(R)||function(h){return!!(Dr["Latin-1 Supplement"](h)&&(h===167||h===169||h===174||h===177||h===188||h===189||h===190||h===215||h===247)||Dr["General Punctuation"](h)&&(h===8214||h===8224||h===8225||h===8240||h===8241||h===8251||h===8252||h===8258||h===8263||h===8264||h===8265||h===8273)||Dr["Letterlike Symbols"](h)||Dr["Number Forms"](h)||Dr["Miscellaneous Technical"](h)&&(h>=8960&&h<=8967||h>=8972&&h<=8991||h>=8996&&h<=9e3||h===9003||h>=9085&&h<=9114||h>=9150&&h<=9165||h===9167||h>=9169&&h<=9179||h>=9186&&h<=9215)||Dr["Control Pictures"](h)&&h!==9251||Dr["Optical Character Recognition"](h)||Dr["Enclosed Alphanumerics"](h)||Dr["Geometric Shapes"](h)||Dr["Miscellaneous Symbols"](h)&&!(h>=9754&&h<=9759)||Dr["Miscellaneous Symbols and Arrows"](h)&&(h>=11026&&h<=11055||h>=11088&&h<=11097||h>=11192&&h<=11243)||Dr["CJK Symbols and Punctuation"](h)||Dr.Katakana(h)||Dr["Private Use Area"](h)||Dr["CJK Compatibility Forms"](h)||Dr["Small Form Variants"](h)||Dr["Halfwidth and Fullwidth Forms"](h)||h===8734||h===8756||h===8757||h>=9984&&h<=10087||h>=10102&&h<=10131||h===65532||h===65533)}(R))}function Mc(R){return R>=1424&&R<=2303||Dr["Arabic Presentation Forms-A"](R)||Dr["Arabic Presentation Forms-B"](R)}function Bh(R,h){return!(!h&&Mc(R)||R>=2304&&R<=3583||R>=3840&&R<=4255||Dr.Khmer(R))}function zh(R){for(const h of R)if(Mc(h.charCodeAt(0)))return!0;return!1}const ll="deferred",cl="loading",hl="loaded";let Io=null,J="unavailable",G=null;const Z=function(R){R&&typeof R=="string"&&R.indexOf("NetworkError")>-1&&(J="error"),Io&&Io(R)};function re(){le.fire(new ea("pluginStateChange",{pluginStatus:J,pluginURL:G}))}const le=new Da,de=function(){return J},me=function(){if(J!==ll||!G)throw new Error("rtl-text-plugin cannot be downloaded unless a pluginURL is specified");J=cl,re(),G&&Nt({url:G},R=>{R?Z(R):(J=hl,re())})},ye={applyArabicShaping:null,processBidirectionalText:null,processStyledBidirectionalText:null,isLoaded:()=>J===hl||ye.applyArabicShaping!=null,isLoading:()=>J===cl,setState(R){J=R.pluginStatus,G=R.pluginURL},isParsed:()=>ye.applyArabicShaping!=null&&ye.processBidirectionalText!=null&&ye.processStyledBidirectionalText!=null,getPluginURL:()=>G};class be{constructor(h,U){this.zoom=h,U?(this.now=U.now,this.fadeDuration=U.fadeDuration,this.transition=U.transition,this.pitch=U.pitch):(this.now=0,this.fadeDuration=0,this.transition={},this.pitch=0)}isSupportedScript(h){return function(U,W){for(const K of U)if(!Bh(K.charCodeAt(0),W))return!1;return!0}(h,ye.isLoaded())}}class qe{constructor(h,U){this.property=h,this.value=U,this.expression=function(W,K){if(ts(W))return new $s(W,K);if(Eo(W)){const Q=is(W,K);if(Q.result==="error")throw new Error(Q.value.map(oe=>`${oe.key}: ${oe.message}`).join(", "));return Q.value}{let Q=W;return typeof W=="string"&&K.type==="color"&&(Q=sn.parse(W)),{kind:"constant",evaluate:()=>Q}}}(U===void 0?h.specification.default:U,h.specification)}isDataDriven(){return this.expression.kind==="source"||this.expression.kind==="composite"}possiblyEvaluate(h,U,W){return this.property.possiblyEvaluate(this,h,U,W)}}class Te{constructor(h){this.property=h,this.value=new qe(h,void 0)}transitioned(h,U){return new $e(this.property,this.value,U,lr({},h.transition,this.transition),h.now)}untransitioned(){return new $e(this.property,this.value,null,{},0)}}class Fe{constructor(h){this._properties=h,this._values=Object.create(h.defaultTransitionablePropertyValues)}getValue(h){return ui(this._values[h].value.value)}setValue(h,U){this._values.hasOwnProperty(h)||(this._values[h]=new Te(this._values[h].property)),this._values[h].value=new qe(this._values[h].property,U===null?void 0:ui(U))}getTransition(h){return ui(this._values[h].transition)}setTransition(h,U){this._values.hasOwnProperty(h)||(this._values[h]=new Te(this._values[h].property)),this._values[h].transition=ui(U)||void 0}serialize(){const h={};for(const U of Object.keys(this._values)){const W=this.getValue(U);W!==void 0&&(h[U]=W);const K=this.getTransition(U);K!==void 0&&(h[`${U}-transition`]=K)}return h}transitioned(h,U){const W=new Je(this._properties);for(const K of Object.keys(this._values))W._values[K]=this._values[K].transitioned(h,U._values[K]);return W}untransitioned(){const h=new Je(this._properties);for(const U of Object.keys(this._values))h._values[U]=this._values[U].untransitioned();return h}}class $e{constructor(h,U,W,K,Q){const oe=K.delay||0,ce=K.duration||0;Q=Q||0,this.property=h,this.value=U,this.begin=Q+oe,this.end=this.begin+ce,h.specification.transition&&(K.delay||K.duration)&&(this.prior=W)}possiblyEvaluate(h,U,W){const K=h.now||0,Q=this.value.possiblyEvaluate(h,U,W),oe=this.prior;if(oe){if(K>this.end)return this.prior=null,Q;if(this.value.isDataDriven())return this.prior=null,Q;if(K<this.begin)return oe.possiblyEvaluate(h,U,W);{const ce=(K-this.begin)/(this.end-this.begin);return this.property.interpolate(oe.possiblyEvaluate(h,U,W),Q,Kt(ce))}}return Q}}class Je{constructor(h){this._properties=h,this._values=Object.create(h.defaultTransitioningPropertyValues)}possiblyEvaluate(h,U,W){const K=new it(this._properties);for(const Q of Object.keys(this._values))K._values[Q]=this._values[Q].possiblyEvaluate(h,U,W);return K}hasTransition(){for(const h of Object.keys(this._values))if(this._values[h].prior)return!0;return!1}}class tt{constructor(h){this._properties=h,this._values=Object.create(h.defaultPropertyValues)}getValue(h){return ui(this._values[h].value)}setValue(h,U){this._values[h]=new qe(this._values[h].property,U===null?void 0:ui(U))}serialize(){const h={};for(const U of Object.keys(this._values)){const W=this.getValue(U);W!==void 0&&(h[U]=W)}return h}possiblyEvaluate(h,U,W){const K=new it(this._properties);for(const Q of Object.keys(this._values))K._values[Q]=this._values[Q].possiblyEvaluate(h,U,W);return K}}class Qe{constructor(h,U,W){this.property=h,this.value=U,this.parameters=W}isConstant(){return this.value.kind==="constant"}constantOr(h){return this.value.kind==="constant"?this.value.value:h}evaluate(h,U,W,K){return this.property.evaluate(this.value,this.parameters,h,U,W,K)}}class it{constructor(h){this._properties=h,this._values=Object.create(h.defaultPossiblyEvaluatedValues)}get(h){return this._values[h]}}class Be{constructor(h){this.specification=h}possiblyEvaluate(h,U){return h.expression.evaluate(U)}interpolate(h,U,W){const K=Ko[this.specification.type];return K?K(h,U,W):h}}class Ye{constructor(h,U){this.specification=h,this.overrides=U}possiblyEvaluate(h,U,W,K){return new Qe(this,h.expression.kind==="constant"||h.expression.kind==="camera"?{kind:"constant",value:h.expression.evaluate(U,null,{},W,K)}:h.expression,U)}interpolate(h,U,W){if(h.value.kind!=="constant"||U.value.kind!=="constant")return h;if(h.value.value===void 0||U.value.value===void 0)return new Qe(this,{kind:"constant",value:void 0},h.parameters);const K=Ko[this.specification.type];return K?new Qe(this,{kind:"constant",value:K(h.value.value,U.value.value,W)},h.parameters):h}evaluate(h,U,W,K,Q,oe){return h.kind==="constant"?h.value:h.evaluate(U,W,K,Q,oe)}}class lt{constructor(h){this.specification=h}possiblyEvaluate(h,U,W,K){return!!h.expression.evaluate(U,null,{},W,K)}interpolate(){return!1}}class ct{constructor(h){this.properties=h,this.defaultPropertyValues={},this.defaultTransitionablePropertyValues={},this.defaultTransitioningPropertyValues={},this.defaultPossiblyEvaluatedValues={},this.overridableProperties=[];const U=new be(0,{});for(const W in h){const K=h[W];K.specification.overridable&&this.overridableProperties.push(W);const Q=this.defaultPropertyValues[W]=new qe(K,void 0),oe=this.defaultTransitionablePropertyValues[W]=new Te(K);this.defaultTransitioningPropertyValues[W]=oe.untransitioned(),this.defaultPossiblyEvaluatedValues[W]=Q.possiblyEvaluate(U)}}}function Tt(R,h){return 256*(R=nt(Math.floor(R),0,255))+nt(Math.floor(h),0,255)}Vr(Ye,"DataDrivenProperty"),Vr(Be,"DataConstantProperty"),Vr(lt,"ColorRampProperty");const Rt={Int8:Int8Array,Uint8:Uint8Array,Int16:Int16Array,Uint16:Uint16Array,Int32:Int32Array,Uint32:Uint32Array,Float32:Float32Array};class It{constructor(h,U){this._structArray=h,this._pos1=U*this.size,this._pos2=this._pos1/2,this._pos4=this._pos1/4,this._pos8=this._pos1/8}}class kt{constructor(){this.isTransferred=!1,this.capacity=-1,this.resize(0)}static serialize(h,U){return h._trim(),U&&(h.isTransferred=!0,U.push(h.arrayBuffer)),{length:h.length,arrayBuffer:h.arrayBuffer}}static deserialize(h){const U=Object.create(this.prototype);return U.arrayBuffer=h.arrayBuffer,U.length=h.length,U.capacity=h.arrayBuffer.byteLength/U.bytesPerElement,U._refreshViews(),U}_trim(){this.length!==this.capacity&&(this.capacity=this.length,this.arrayBuffer=this.arrayBuffer.slice(0,this.length*this.bytesPerElement),this._refreshViews())}clear(){this.length=0}resize(h){this.reserve(h),this.length=h}reserve(h){if(h>this.capacity){this.capacity=Math.max(h,Math.floor(5*this.capacity),128),this.arrayBuffer=new ArrayBuffer(this.capacity*this.bytesPerElement);const U=this.uint8;this._refreshViews(),U&&this.uint8.set(U)}}_refreshViews(){throw new Error("_refreshViews() must be implemented by each concrete StructArray layout")}destroy(){this.int8=this.uint8=this.int16=this.uint16=this.int32=this.uint32=this.float32=null,this.arrayBuffer=null}}function Dt(R,h=1){let U=0,W=0;return{members:R.map(K=>{const Q=Rt[K.type].BYTES_PER_ELEMENT,oe=U=Vt(U,Math.max(h,Q)),ce=K.components||1;return W=Math.max(W,Q),U+=Q*ce,{name:K.name,type:K.type,components:ce,offset:oe}}),size:Vt(U,Math.max(W,h)),alignment:h}}function Vt(R,h){return Math.ceil(R/h)*h}class mr extends kt{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(h,U){const W=this.length;return this.resize(W+1),this.emplace(W,h,U)}emplace(h,U,W){const K=2*h;return this.int16[K+0]=U,this.int16[K+1]=W,h}}mr.prototype.bytesPerElement=4,Vr(mr,"StructArrayLayout2i4");class Bt extends kt{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(h,U,W){const K=this.length;return this.resize(K+1),this.emplace(K,h,U,W)}emplace(h,U,W,K){const Q=3*h;return this.int16[Q+0]=U,this.int16[Q+1]=W,this.int16[Q+2]=K,h}}Bt.prototype.bytesPerElement=6,Vr(Bt,"StructArrayLayout3i6");class nr extends kt{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(h,U,W,K){const Q=this.length;return this.resize(Q+1),this.emplace(Q,h,U,W,K)}emplace(h,U,W,K,Q){const oe=4*h;return this.int16[oe+0]=U,this.int16[oe+1]=W,this.int16[oe+2]=K,this.int16[oe+3]=Q,h}}nr.prototype.bytesPerElement=8,Vr(nr,"StructArrayLayout4i8");class Ht extends kt{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(h,U,W,K,Q,oe,ce){const fe=this.length;return this.resize(fe+1),this.emplace(fe,h,U,W,K,Q,oe,ce)}emplace(h,U,W,K,Q,oe,ce,fe){const pe=6*h,ve=12*h,Ee=3*h;return this.int16[pe+0]=U,this.int16[pe+1]=W,this.uint8[ve+4]=K,this.uint8[ve+5]=Q,this.uint8[ve+6]=oe,this.uint8[ve+7]=ce,this.float32[Ee+2]=fe,h}}Ht.prototype.bytesPerElement=12,Vr(Ht,"StructArrayLayout2i4ub1f12");class pr extends kt{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(h,U,W,K){const Q=this.length;return this.resize(Q+1),this.emplace(Q,h,U,W,K)}emplace(h,U,W,K,Q){const oe=4*h;return this.float32[oe+0]=U,this.float32[oe+1]=W,this.float32[oe+2]=K,this.float32[oe+3]=Q,h}}pr.prototype.bytesPerElement=16,Vr(pr,"StructArrayLayout4f16");class jt extends kt{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(h,U,W,K,Q){const oe=this.length;return this.resize(oe+1),this.emplace(oe,h,U,W,K,Q)}emplace(h,U,W,K,Q,oe){const ce=6*h,fe=3*h;return this.uint16[ce+0]=U,this.uint16[ce+1]=W,this.uint16[ce+2]=K,this.uint16[ce+3]=Q,this.float32[fe+2]=oe,h}}jt.prototype.bytesPerElement=12,Vr(jt,"StructArrayLayout4ui1f12");class ir extends kt{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(h,U,W,K){const Q=this.length;return this.resize(Q+1),this.emplace(Q,h,U,W,K)}emplace(h,U,W,K,Q){const oe=4*h;return this.uint16[oe+0]=U,this.uint16[oe+1]=W,this.uint16[oe+2]=K,this.uint16[oe+3]=Q,h}}ir.prototype.bytesPerElement=8,Vr(ir,"StructArrayLayout4ui8");class gr extends kt{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(h,U,W,K,Q,oe){const ce=this.length;return this.resize(ce+1),this.emplace(ce,h,U,W,K,Q,oe)}emplace(h,U,W,K,Q,oe,ce){const fe=6*h;return this.int16[fe+0]=U,this.int16[fe+1]=W,this.int16[fe+2]=K,this.int16[fe+3]=Q,this.int16[fe+4]=oe,this.int16[fe+5]=ce,h}}gr.prototype.bytesPerElement=12,Vr(gr,"StructArrayLayout6i12");class ur extends kt{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(h,U,W,K,Q,oe,ce,fe,pe,ve,Ee,we){const Ae=this.length;return this.resize(Ae+1),this.emplace(Ae,h,U,W,K,Q,oe,ce,fe,pe,ve,Ee,we)}emplace(h,U,W,K,Q,oe,ce,fe,pe,ve,Ee,we,Ae){const Pe=12*h;return this.int16[Pe+0]=U,this.int16[Pe+1]=W,this.int16[Pe+2]=K,this.int16[Pe+3]=Q,this.uint16[Pe+4]=oe,this.uint16[Pe+5]=ce,this.uint16[Pe+6]=fe,this.uint16[Pe+7]=pe,this.int16[Pe+8]=ve,this.int16[Pe+9]=Ee,this.int16[Pe+10]=we,this.int16[Pe+11]=Ae,h}}ur.prototype.bytesPerElement=24,Vr(ur,"StructArrayLayout4i4ui4i24");class xr extends kt{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(h,U,W,K,Q,oe){const ce=this.length;return this.resize(ce+1),this.emplace(ce,h,U,W,K,Q,oe)}emplace(h,U,W,K,Q,oe,ce){const fe=10*h,pe=5*h;return this.int16[fe+0]=U,this.int16[fe+1]=W,this.int16[fe+2]=K,this.float32[pe+2]=Q,this.float32[pe+3]=oe,this.float32[pe+4]=ce,h}}xr.prototype.bytesPerElement=20,Vr(xr,"StructArrayLayout3i3f20");class Jr extends kt{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer)}emplaceBack(h){const U=this.length;return this.resize(U+1),this.emplace(U,h)}emplace(h,U){return this.uint32[1*h+0]=U,h}}Jr.prototype.bytesPerElement=4,Vr(Jr,"StructArrayLayout1ul4");class hi extends kt{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(h,U,W,K,Q,oe,ce,fe,pe,ve,Ee,we,Ae){const Pe=this.length;return this.resize(Pe+1),this.emplace(Pe,h,U,W,K,Q,oe,ce,fe,pe,ve,Ee,we,Ae)}emplace(h,U,W,K,Q,oe,ce,fe,pe,ve,Ee,we,Ae,Pe){const ze=20*h,Xe=10*h;return this.int16[ze+0]=U,this.int16[ze+1]=W,this.int16[ze+2]=K,this.int16[ze+3]=Q,this.int16[ze+4]=oe,this.float32[Xe+3]=ce,this.float32[Xe+4]=fe,this.float32[Xe+5]=pe,this.float32[Xe+6]=ve,this.int16[ze+14]=Ee,this.uint32[Xe+8]=we,this.uint16[ze+18]=Ae,this.uint16[ze+19]=Pe,h}}hi.prototype.bytesPerElement=40,Vr(hi,"StructArrayLayout5i4f1i1ul2ui40");class Gr extends kt{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(h,U,W,K,Q,oe,ce){const fe=this.length;return this.resize(fe+1),this.emplace(fe,h,U,W,K,Q,oe,ce)}emplace(h,U,W,K,Q,oe,ce,fe){const pe=8*h;return this.int16[pe+0]=U,this.int16[pe+1]=W,this.int16[pe+2]=K,this.int16[pe+4]=Q,this.int16[pe+5]=oe,this.int16[pe+6]=ce,this.int16[pe+7]=fe,h}}Gr.prototype.bytesPerElement=16,Vr(Gr,"StructArrayLayout3i2i2i16");class ii extends kt{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(h,U,W,K,Q){const oe=this.length;return this.resize(oe+1),this.emplace(oe,h,U,W,K,Q)}emplace(h,U,W,K,Q,oe){const ce=4*h,fe=8*h;return this.float32[ce+0]=U,this.float32[ce+1]=W,this.float32[ce+2]=K,this.int16[fe+6]=Q,this.int16[fe+7]=oe,h}}ii.prototype.bytesPerElement=16,Vr(ii,"StructArrayLayout2f1f2i16");class xi extends kt{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(h,U,W,K){const Q=this.length;return this.resize(Q+1),this.emplace(Q,h,U,W,K)}emplace(h,U,W,K,Q){const oe=12*h,ce=3*h;return this.uint8[oe+0]=U,this.uint8[oe+1]=W,this.float32[ce+1]=K,this.float32[ce+2]=Q,h}}xi.prototype.bytesPerElement=12,Vr(xi,"StructArrayLayout2ub2f12");class gi extends kt{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(h,U,W){const K=this.length;return this.resize(K+1),this.emplace(K,h,U,W)}emplace(h,U,W,K){const Q=3*h;return this.float32[Q+0]=U,this.float32[Q+1]=W,this.float32[Q+2]=K,h}}gi.prototype.bytesPerElement=12,Vr(gi,"StructArrayLayout3f12");class Zr extends kt{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(h,U,W){const K=this.length;return this.resize(K+1),this.emplace(K,h,U,W)}emplace(h,U,W,K){const Q=3*h;return this.uint16[Q+0]=U,this.uint16[Q+1]=W,this.uint16[Q+2]=K,h}}Zr.prototype.bytesPerElement=6,Vr(Zr,"StructArrayLayout3ui6");class Pi extends kt{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer)}emplaceBack(h,U,W,K,Q,oe,ce,fe,pe,ve,Ee,we,Ae,Pe,ze,Xe,at,mt,ot,pt,Et){const bt=this.length;return this.resize(bt+1),this.emplace(bt,h,U,W,K,Q,oe,ce,fe,pe,ve,Ee,we,Ae,Pe,ze,Xe,at,mt,ot,pt,Et)}emplace(h,U,W,K,Q,oe,ce,fe,pe,ve,Ee,we,Ae,Pe,ze,Xe,at,mt,ot,pt,Et,bt){const $t=30*h,zt=15*h,rr=60*h;return this.int16[$t+0]=U,this.int16[$t+1]=W,this.int16[$t+2]=K,this.float32[zt+2]=Q,this.float32[zt+3]=oe,this.uint16[$t+8]=ce,this.uint16[$t+9]=fe,this.uint32[zt+5]=pe,this.uint32[zt+6]=ve,this.uint32[zt+7]=Ee,this.uint16[$t+16]=we,this.uint16[$t+17]=Ae,this.uint16[$t+18]=Pe,this.float32[zt+10]=ze,this.float32[zt+11]=Xe,this.uint8[rr+48]=at,this.uint8[rr+49]=mt,this.uint8[rr+50]=ot,this.uint32[zt+13]=pt,this.int16[$t+28]=Et,this.uint8[rr+58]=bt,h}}Pi.prototype.bytesPerElement=60,Vr(Pi,"StructArrayLayout3i2f2ui3ul3ui2f3ub1ul1i1ub60");class Di extends kt{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer)}emplaceBack(h,U,W,K,Q,oe,ce,fe,pe,ve,Ee,we,Ae,Pe,ze,Xe,at,mt,ot,pt,Et,bt,$t,zt,rr,yr,Zt,ar,or,hr){const Sr=this.length;return this.resize(Sr+1),this.emplace(Sr,h,U,W,K,Q,oe,ce,fe,pe,ve,Ee,we,Ae,Pe,ze,Xe,at,mt,ot,pt,Et,bt,$t,zt,rr,yr,Zt,ar,or,hr)}emplace(h,U,W,K,Q,oe,ce,fe,pe,ve,Ee,we,Ae,Pe,ze,Xe,at,mt,ot,pt,Et,bt,$t,zt,rr,yr,Zt,ar,or,hr,Sr){const Jt=38*h,Cr=19*h;return this.int16[Jt+0]=U,this.int16[Jt+1]=W,this.int16[Jt+2]=K,this.float32[Cr+2]=Q,this.float32[Cr+3]=oe,this.int16[Jt+8]=ce,this.int16[Jt+9]=fe,this.int16[Jt+10]=pe,this.int16[Jt+11]=ve,this.int16[Jt+12]=Ee,this.int16[Jt+13]=we,this.uint16[Jt+14]=Ae,this.uint16[Jt+15]=Pe,this.uint16[Jt+16]=ze,this.uint16[Jt+17]=Xe,this.uint16[Jt+18]=at,this.uint16[Jt+19]=mt,this.uint16[Jt+20]=ot,this.uint16[Jt+21]=pt,this.uint16[Jt+22]=Et,this.uint16[Jt+23]=bt,this.uint16[Jt+24]=$t,this.uint16[Jt+25]=zt,this.uint16[Jt+26]=rr,this.uint16[Jt+27]=yr,this.uint16[Jt+28]=Zt,this.uint32[Cr+15]=ar,this.float32[Cr+16]=or,this.float32[Cr+17]=hr,this.float32[Cr+18]=Sr,h}}Di.prototype.bytesPerElement=76,Vr(Di,"StructArrayLayout3i2f6i15ui1ul3f76");class Li extends kt{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(h){const U=this.length;return this.resize(U+1),this.emplace(U,h)}emplace(h,U){return this.float32[1*h+0]=U,h}}Li.prototype.bytesPerElement=4,Vr(Li,"StructArrayLayout1f4");class Fi extends kt{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(h,U,W,K,Q){const oe=this.length;return this.resize(oe+1),this.emplace(oe,h,U,W,K,Q)}emplace(h,U,W,K,Q,oe){const ce=5*h;return this.float32[ce+0]=U,this.float32[ce+1]=W,this.float32[ce+2]=K,this.float32[ce+3]=Q,this.float32[ce+4]=oe,h}}Fi.prototype.bytesPerElement=20,Vr(Fi,"StructArrayLayout5f20");class An extends kt{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(h,U,W,K){const Q=this.length;return this.resize(Q+1),this.emplace(Q,h,U,W,K)}emplace(h,U,W,K,Q){const oe=6*h;return this.uint32[3*h+0]=U,this.uint16[oe+2]=W,this.uint16[oe+3]=K,this.uint16[oe+4]=Q,h}}An.prototype.bytesPerElement=12,Vr(An,"StructArrayLayout1ul3ui12");class bn extends kt{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(h,U){const W=this.length;return this.resize(W+1),this.emplace(W,h,U)}emplace(h,U,W){const K=2*h;return this.uint16[K+0]=U,this.uint16[K+1]=W,h}}bn.prototype.bytesPerElement=4,Vr(bn,"StructArrayLayout2ui4");class Kn extends kt{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(h){const U=this.length;return this.resize(U+1),this.emplace(U,h)}emplace(h,U){return this.uint16[1*h+0]=U,h}}Kn.prototype.bytesPerElement=2,Vr(Kn,"StructArrayLayout1ui2");class ha extends kt{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(h,U){const W=this.length;return this.resize(W+1),this.emplace(W,h,U)}emplace(h,U,W){const K=2*h;return this.float32[K+0]=U,this.float32[K+1]=W,h}}ha.prototype.bytesPerElement=8,Vr(ha,"StructArrayLayout2f8");class Yi extends It{get projectedAnchorX(){return this._structArray.int16[this._pos2+0]}get projectedAnchorY(){return this._structArray.int16[this._pos2+1]}get projectedAnchorZ(){return this._structArray.int16[this._pos2+2]}get tileAnchorX(){return this._structArray.int16[this._pos2+3]}get tileAnchorY(){return this._structArray.int16[this._pos2+4]}get x1(){return this._structArray.float32[this._pos4+3]}get y1(){return this._structArray.float32[this._pos4+4]}get x2(){return this._structArray.float32[this._pos4+5]}get y2(){return this._structArray.float32[this._pos4+6]}get padding(){return this._structArray.int16[this._pos2+14]}get featureIndex(){return this._structArray.uint32[this._pos4+8]}get sourceLayerIndex(){return this._structArray.uint16[this._pos2+18]}get bucketIndex(){return this._structArray.uint16[this._pos2+19]}}Yi.prototype.size=40;class ki extends hi{get(h){return new Yi(this,h)}}Vr(ki,"CollisionBoxArray");class Ri extends It{get projectedAnchorX(){return this._structArray.int16[this._pos2+0]}get projectedAnchorY(){return this._structArray.int16[this._pos2+1]}get projectedAnchorZ(){return this._structArray.int16[this._pos2+2]}get tileAnchorX(){return this._structArray.float32[this._pos4+2]}get tileAnchorY(){return this._structArray.float32[this._pos4+3]}get glyphStartIndex(){return this._structArray.uint16[this._pos2+8]}get numGlyphs(){return this._structArray.uint16[this._pos2+9]}get vertexStartIndex(){return this._structArray.uint32[this._pos4+5]}get lineStartIndex(){return this._structArray.uint32[this._pos4+6]}get lineLength(){return this._structArray.uint32[this._pos4+7]}get segment(){return this._structArray.uint16[this._pos2+16]}get lowerSize(){return this._structArray.uint16[this._pos2+17]}get upperSize(){return this._structArray.uint16[this._pos2+18]}get lineOffsetX(){return this._structArray.float32[this._pos4+10]}get lineOffsetY(){return this._structArray.float32[this._pos4+11]}get writingMode(){return this._structArray.uint8[this._pos1+48]}get placedOrientation(){return this._structArray.uint8[this._pos1+49]}set placedOrientation(h){this._structArray.uint8[this._pos1+49]=h}get hidden(){return this._structArray.uint8[this._pos1+50]}set hidden(h){this._structArray.uint8[this._pos1+50]=h}get crossTileID(){return this._structArray.uint32[this._pos4+13]}set crossTileID(h){this._structArray.uint32[this._pos4+13]=h}get associatedIconIndex(){return this._structArray.int16[this._pos2+28]}get flipState(){return this._structArray.uint8[this._pos1+58]}set flipState(h){this._structArray.uint8[this._pos1+58]=h}}Ri.prototype.size=60;class cn extends Pi{get(h){return new Ri(this,h)}}Vr(cn,"PlacedSymbolArray");class Cn extends It{get projectedAnchorX(){return this._structArray.int16[this._pos2+0]}get projectedAnchorY(){return this._structArray.int16[this._pos2+1]}get projectedAnchorZ(){return this._structArray.int16[this._pos2+2]}get tileAnchorX(){return this._structArray.float32[this._pos4+2]}get tileAnchorY(){return this._structArray.float32[this._pos4+3]}get rightJustifiedTextSymbolIndex(){return this._structArray.int16[this._pos2+8]}get centerJustifiedTextSymbolIndex(){return this._structArray.int16[this._pos2+9]}get leftJustifiedTextSymbolIndex(){return this._structArray.int16[this._pos2+10]}get verticalPlacedTextSymbolIndex(){return this._structArray.int16[this._pos2+11]}get placedIconSymbolIndex(){return this._structArray.int16[this._pos2+12]}get verticalPlacedIconSymbolIndex(){return this._structArray.int16[this._pos2+13]}get key(){return this._structArray.uint16[this._pos2+14]}get textBoxStartIndex(){return this._structArray.uint16[this._pos2+15]}get textBoxEndIndex(){return this._structArray.uint16[this._pos2+16]}get verticalTextBoxStartIndex(){return this._structArray.uint16[this._pos2+17]}get verticalTextBoxEndIndex(){return this._structArray.uint16[this._pos2+18]}get iconBoxStartIndex(){return this._structArray.uint16[this._pos2+19]}get iconBoxEndIndex(){return this._structArray.uint16[this._pos2+20]}get verticalIconBoxStartIndex(){return this._structArray.uint16[this._pos2+21]}get verticalIconBoxEndIndex(){return this._structArray.uint16[this._pos2+22]}get featureIndex(){return this._structArray.uint16[this._pos2+23]}get numHorizontalGlyphVertices(){return this._structArray.uint16[this._pos2+24]}get numVerticalGlyphVertices(){return this._structArray.uint16[this._pos2+25]}get numIconVertices(){return this._structArray.uint16[this._pos2+26]}get numVerticalIconVertices(){return this._structArray.uint16[this._pos2+27]}get useRuntimeCollisionCircles(){return this._structArray.uint16[this._pos2+28]}get crossTileID(){return this._structArray.uint32[this._pos4+15]}set crossTileID(h){this._structArray.uint32[this._pos4+15]=h}get textOffset0(){return this._structArray.float32[this._pos4+16]}get textOffset1(){return this._structArray.float32[this._pos4+17]}get collisionCircleDiameter(){return this._structArray.float32[this._pos4+18]}}Cn.prototype.size=76;class Ki extends Di{get(h){return new Cn(this,h)}}Vr(Ki,"SymbolInstanceArray");class Dn extends Li{getoffsetX(h){return this.float32[1*h+0]}}Vr(Dn,"GlyphOffsetArray");class Js extends mr{getx(h){return this.int16[2*h+0]}gety(h){return this.int16[2*h+1]}}Vr(Js,"SymbolLineVertexArray");class eo extends It{get featureIndex(){return this._structArray.uint32[this._pos4+0]}get sourceLayerIndex(){return this._structArray.uint16[this._pos2+2]}get bucketIndex(){return this._structArray.uint16[this._pos2+3]}get layoutVertexArrayOffset(){return this._structArray.uint16[this._pos2+4]}}eo.prototype.size=12;class ls extends An{get(h){return new eo(this,h)}}Vr(ls,"FeatureIndexArray");class Sa extends bn{geta_centroid_pos0(h){return this.uint16[2*h+0]}geta_centroid_pos1(h){return this.uint16[2*h+1]}}Vr(Sa,"FillExtrusionCentroidArray");const ka=Dt([{name:"a_pattern",components:4,type:"Uint16"},{name:"a_pixel_ratio",components:1,type:"Float32"}]),to=Dt([{name:"a_dash",components:4,type:"Uint16"}]);var Qs={exports:{}},cs={exports:{}};cs.exports=function(R,h){var U,W,K,Q,oe,ce,fe,pe;for(W=R.length-(U=3&R.length),K=h,oe=3432918353,ce=461845907,pe=0;pe<W;)fe=255&R.charCodeAt(pe)|(255&R.charCodeAt(++pe))<<8|(255&R.charCodeAt(++pe))<<16|(255&R.charCodeAt(++pe))<<24,++pe,K=27492+(65535&(Q=5*(65535&(K=(K^=fe=(65535&(fe=(fe=(65535&fe)*oe+(((fe>>>16)*oe&65535)<<16)&4294967295)<<15|fe>>>17))*ce+(((fe>>>16)*ce&65535)<<16)&4294967295)<<13|K>>>19))+((5*(K>>>16)&65535)<<16)&4294967295))+((58964+(Q>>>16)&65535)<<16);switch(fe=0,U){case 3:fe^=(255&R.charCodeAt(pe+2))<<16;case 2:fe^=(255&R.charCodeAt(pe+1))<<8;case 1:K^=fe=(65535&(fe=(fe=(65535&(fe^=255&R.charCodeAt(pe)))*oe+(((fe>>>16)*oe&65535)<<16)&4294967295)<<15|fe>>>17))*ce+(((fe>>>16)*ce&65535)<<16)&4294967295}return K^=R.length,K=2246822507*(65535&(K^=K>>>16))+((2246822507*(K>>>16)&65535)<<16)&4294967295,K=3266489909*(65535&(K^=K>>>13))+((3266489909*(K>>>16)&65535)<<16)&4294967295,(K^=K>>>16)>>>0};var dl=cs.exports,Xd={exports:{}};Xd.exports=function(R,h){for(var U,W=R.length,K=h^W,Q=0;W>=4;)U=1540483477*(65535&(U=255&R.charCodeAt(Q)|(255&R.charCodeAt(++Q))<<8|(255&R.charCodeAt(++Q))<<16|(255&R.charCodeAt(++Q))<<24))+((1540483477*(U>>>16)&65535)<<16),K=1540483477*(65535&K)+((1540483477*(K>>>16)&65535)<<16)^(U=1540483477*(65535&(U^=U>>>24))+((1540483477*(U>>>16)&65535)<<16)),W-=4,++Q;switch(W){case 3:K^=(255&R.charCodeAt(Q+2))<<16;case 2:K^=(255&R.charCodeAt(Q+1))<<8;case 1:K=1540483477*(65535&(K^=255&R.charCodeAt(Q)))+((1540483477*(K>>>16)&65535)<<16)}return K=1540483477*(65535&(K^=K>>>13))+((1540483477*(K>>>16)&65535)<<16),(K^=K>>>15)>>>0};var Yd=dl,A_=Xd.exports;Qs.exports=Yd,Qs.exports.murmur3=Yd,Qs.exports.murmur2=A_;var Nh=Le(Qs.exports);class Dc{constructor(){this.ids=[],this.positions=[],this.indexed=!1}add(h,U,W,K){this.ids.push(Jd(h)),this.positions.push(U,W,K)}getPositions(h){const U=Jd(h);let W=0,K=this.ids.length-1;for(;W<K;){const oe=W+K>>1;this.ids[oe]>=U?K=oe:W=oe+1}const Q=[];for(;this.ids[W]===U;)Q.push({index:this.positions[3*W],start:this.positions[3*W+1],end:this.positions[3*W+2]}),W++;return Q}static serialize(h,U){const W=new Float64Array(h.ids),K=new Uint32Array(h.positions);return jh(W,K,0,W.length-1),U&&U.push(W.buffer,K.buffer),{ids:W,positions:K}}static deserialize(h){const U=new Dc;return U.ids=h.ids,U.positions=h.positions,U.indexed=!0,U}}function Jd(R){const h=+R;return!isNaN(h)&&Number.MIN_SAFE_INTEGER<=h&&h<=Number.MAX_SAFE_INTEGER?h:Nh(String(R))}function jh(R,h,U,W){for(;U<W;){const K=R[U+W>>1];let Q=U-1,oe=W+1;for(;;){do Q++;while(R[Q]<K);do oe--;while(R[oe]>K);if(Q>=oe)break;Lc(R,Q,oe),Lc(h,3*Q,3*oe),Lc(h,3*Q+1,3*oe+1),Lc(h,3*Q+2,3*oe+2)}oe-U<W-oe?(jh(R,h,U,oe),U=oe+1):(jh(R,h,oe+1,W),W=oe)}}function Lc(R,h,U){const W=R[h];R[h]=R[U],R[U]=W}Vr(Dc,"FeaturePositionMap");class ro{constructor(h){this.gl=h.gl,this.initialized=!1}fetchUniformLocation(h,U){return this.location||this.initialized||(this.location=this.gl.getUniformLocation(h,U),this.initialized=!0),!!this.location}}class Fc extends ro{constructor(h){super(h),this.current=0}set(h,U,W){this.fetchUniformLocation(h,U)&&this.current!==W&&(this.current=W,this.gl.uniform1f(this.location,W))}}class Qd extends ro{constructor(h){super(h),this.current=[0,0,0,0]}set(h,U,W){this.fetchUniformLocation(h,U)&&(W[0]===this.current[0]&&W[1]===this.current[1]&&W[2]===this.current[2]&&W[3]===this.current[3]||(this.current=W,this.gl.uniform4f(this.location,W[0],W[1],W[2],W[3])))}}class ef extends ro{constructor(h){super(h),this.current=sn.transparent}set(h,U,W){this.fetchUniformLocation(h,U)&&(W.r===this.current.r&&W.g===this.current.g&&W.b===this.current.b&&W.a===this.current.a||(this.current=W,this.gl.uniform4f(this.location,W.r,W.g,W.b,W.a)))}}const R_=new Float32Array(16),O_=new Float32Array(9),C_=new Float32Array(4);function Uh(R){return[Tt(255*R.r,255*R.g),Tt(255*R.b,255*R.a)]}class fl{constructor(h,U,W){this.value=h,this.uniformNames=U.map(K=>`u_${K}`),this.type=W}setUniform(h,U,W,K,Q){U.set(h,Q,K.constantOr(this.value))}getBinding(h,U){return this.type==="color"?new ef(h):new Fc(h)}}class eu{constructor(h,U){this.uniformNames=U.map(W=>`u_${W}`),this.pattern=null,this.pixelRatio=1}setConstantPatternPositions(h){this.pixelRatio=h.pixelRatio||1,this.pattern=h.tl.concat(h.br)}setUniform(h,U,W,K,Q){const oe=Q==="u_pattern"||Q==="u_dash"?this.pattern:Q==="u_pixel_ratio"?this.pixelRatio:null;oe&&U.set(h,Q,oe)}getBinding(h,U){return U==="u_pattern"||U==="u_dash"?new Qd(h):new Fc(h)}}class io{constructor(h,U,W,K){this.expression=h,this.type=W,this.maxValue=0,this.paintVertexAttributes=U.map(Q=>({name:`a_${Q}`,type:"Float32",components:W==="color"?2:1,offset:0})),this.paintVertexArray=new K}populatePaintArray(h,U,W,K,Q,oe){const ce=this.paintVertexArray.length,fe=this.expression.evaluate(new be(0),U,{},Q,K,oe);this.paintVertexArray.resize(h),this._setPaintValue(ce,h,fe)}updatePaintArray(h,U,W,K,Q){const oe=this.expression.evaluate({zoom:0},W,K,void 0,Q);this._setPaintValue(h,U,oe)}_setPaintValue(h,U,W){if(this.type==="color"){const K=Uh(W);for(let Q=h;Q<U;Q++)this.paintVertexArray.emplace(Q,K[0],K[1])}else{for(let K=h;K<U;K++)this.paintVertexArray.emplace(K,W);this.maxValue=Math.max(this.maxValue,Math.abs(W))}}upload(h){this.paintVertexArray&&this.paintVertexArray.arrayBuffer&&(this.paintVertexBuffer&&this.paintVertexBuffer.buffer?this.paintVertexBuffer.updateData(this.paintVertexArray):this.paintVertexBuffer=h.createVertexBuffer(this.paintVertexArray,this.paintVertexAttributes,this.expression.isStateDependent))}destroy(){this.paintVertexBuffer&&this.paintVertexBuffer.destroy()}}class Ta{constructor(h,U,W,K,Q,oe){this.expression=h,this.uniformNames=U.map(ce=>`u_${ce}_t`),this.type=W,this.useIntegerZoom=K,this.zoom=Q,this.maxValue=0,this.paintVertexAttributes=U.map(ce=>({name:`a_${ce}`,type:"Float32",components:W==="color"?4:2,offset:0})),this.paintVertexArray=new oe}populatePaintArray(h,U,W,K,Q,oe){const ce=this.expression.evaluate(new be(this.zoom),U,{},Q,K,oe),fe=this.expression.evaluate(new be(this.zoom+1),U,{},Q,K,oe),pe=this.paintVertexArray.length;this.paintVertexArray.resize(h),this._setPaintValue(pe,h,ce,fe)}updatePaintArray(h,U,W,K,Q){const oe=this.expression.evaluate({zoom:this.zoom},W,K,void 0,Q),ce=this.expression.evaluate({zoom:this.zoom+1},W,K,void 0,Q);this._setPaintValue(h,U,oe,ce)}_setPaintValue(h,U,W,K){if(this.type==="color"){const Q=Uh(W),oe=Uh(K);for(let ce=h;ce<U;ce++)this.paintVertexArray.emplace(ce,Q[0],Q[1],oe[0],oe[1])}else{for(let Q=h;Q<U;Q++)this.paintVertexArray.emplace(Q,W,K);this.maxValue=Math.max(this.maxValue,Math.abs(W),Math.abs(K))}}upload(h){this.paintVertexArray&&this.paintVertexArray.arrayBuffer&&(this.paintVertexBuffer&&this.paintVertexBuffer.buffer?this.paintVertexBuffer.updateData(this.paintVertexArray):this.paintVertexBuffer=h.createVertexBuffer(this.paintVertexArray,this.paintVertexAttributes,this.expression.isStateDependent))}destroy(){this.paintVertexBuffer&&this.paintVertexBuffer.destroy()}setUniform(h,U,W,K,Q){const oe=this.useIntegerZoom?Math.floor(W.zoom):W.zoom,ce=nt(this.expression.interpolationFactor(oe,this.zoom,this.zoom+1),0,1);U.set(h,Q,ce)}getBinding(h,U){return new Fc(h)}}class Ao{constructor(h,U,W,K,Q){this.expression=h,this.layerId=Q,this.paintVertexAttributes=(W==="array"?to:ka).members;for(let oe=0;oe<U.length;++oe);this.paintVertexArray=new K}populatePaintArray(h,U,W){const K=this.paintVertexArray.length;this.paintVertexArray.resize(h),this._setPaintValues(K,h,U.patterns&&U.patterns[this.layerId],W)}updatePaintArray(h,U,W,K,Q,oe){this._setPaintValues(h,U,W.patterns&&W.patterns[this.layerId],oe)}_setPaintValues(h,U,W,K){if(!K||!W)return;const Q=K[W];if(!Q)return;const{tl:oe,br:ce,pixelRatio:fe}=Q;for(let pe=h;pe<U;pe++)this.paintVertexArray.emplace(pe,oe[0],oe[1],ce[0],ce[1],fe)}upload(h){this.paintVertexArray&&this.paintVertexArray.arrayBuffer&&(this.paintVertexBuffer=h.createVertexBuffer(this.paintVertexArray,this.paintVertexAttributes,this.expression.isStateDependent))}destroy(){this.paintVertexBuffer&&this.paintVertexBuffer.destroy()}}class Ro{constructor(h,U,W=()=>!0){this.binders={},this._buffers=[];const K=[];for(const Q in h.paint._values){if(!W(Q))continue;const oe=h.paint.get(Q);if(!(oe instanceof Qe&&bo(oe.property.specification)))continue;const ce=M_(Q,h.type),fe=oe.value,pe=oe.property.specification.type,ve=!!oe.property.useIntegerZoom,Ee=Q==="line-dasharray"||Q.endsWith("pattern"),we=Q==="line-dasharray"&&h.layout.get("line-cap").value.kind!=="constant";if(fe.kind!=="constant"||we)if(fe.kind==="source"||we||Ee){const Ae=tf(Q,pe,"source");this.binders[Q]=Ee?new Ao(fe,ce,pe,Ae,h.id):new io(fe,ce,pe,Ae),K.push(`/a_${Q}`)}else{const Ae=tf(Q,pe,"composite");this.binders[Q]=new Ta(fe,ce,pe,ve,U,Ae),K.push(`/z_${Q}`)}else this.binders[Q]=Ee?new eu(fe.value,ce):new fl(fe.value,ce,pe),K.push(`/u_${Q}`)}this.cacheKey=K.sort().join("")}getMaxValue(h){const U=this.binders[h];return U instanceof io||U instanceof Ta?U.maxValue:0}populatePaintArrays(h,U,W,K,Q,oe){for(const ce in this.binders){const fe=this.binders[ce];(fe instanceof io||fe instanceof Ta||fe instanceof Ao)&&fe.populatePaintArray(h,U,W,K,Q,oe)}}setConstantPatternPositions(h){for(const U in this.binders){const W=this.binders[U];W instanceof eu&&W.setConstantPatternPositions(h)}}updatePaintArrays(h,U,W,K,Q,oe){let ce=!1;for(const fe in h){const pe=U.getPositions(fe);for(const ve of pe){const Ee=W.feature(ve.index);for(const we in this.binders){const Ae=this.binders[we];if((Ae instanceof io||Ae instanceof Ta||Ae instanceof Ao)&&Ae.expression.isStateDependent===!0){const Pe=K.paint.get(we);Ae.expression=Pe.value,Ae.updatePaintArray(ve.start,ve.end,Ee,h[fe],Q,oe),ce=!0}}}}return ce}defines(){const h=[];for(const U in this.binders){const W=this.binders[U];(W instanceof fl||W instanceof eu)&&h.push(...W.uniformNames.map(K=>`#define HAS_UNIFORM_${K}`))}return h}getBinderAttributes(){const h=[];for(const U in this.binders){const W=this.binders[U];if(W instanceof io||W instanceof Ta||W instanceof Ao)for(let K=0;K<W.paintVertexAttributes.length;K++)h.push(W.paintVertexAttributes[K].name)}return h}getBinderUniforms(){const h=[];for(const U in this.binders){const W=this.binders[U];if(W instanceof fl||W instanceof eu||W instanceof Ta)for(const K of W.uniformNames)h.push(K)}return h}getPaintVertexBuffers(){return this._buffers}getUniforms(h){const U=[];for(const W in this.binders){const K=this.binders[W];if(K instanceof fl||K instanceof eu||K instanceof Ta)for(const Q of K.uniformNames)U.push({name:Q,property:W,binding:K.getBinding(h,Q)})}return U}setUniforms(h,U,W,K,Q){for(const{name:oe,property:ce,binding:fe}of W)this.binders[ce].setUniform(h,fe,Q,K.get(ce),oe)}updatePaintBuffers(){this._buffers=[];for(const h in this.binders){const U=this.binders[h];(U instanceof io||U instanceof Ta||U instanceof Ao)&&U.paintVertexBuffer&&this._buffers.push(U.paintVertexBuffer)}}upload(h){for(const U in this.binders){const W=this.binders[U];(W instanceof io||W instanceof Ta||W instanceof Ao)&&W.upload(h)}this.updatePaintBuffers()}destroy(){for(const h in this.binders){const U=this.binders[h];(U instanceof io||U instanceof Ta||U instanceof Ao)&&U.destroy()}}}class hs{constructor(h,U,W=()=>!0){this.programConfigurations={};for(const K of h)this.programConfigurations[K.id]=new Ro(K,U,W);this.needsUpload=!1,this._featureMap=new Dc,this._bufferOffset=0}populatePaintArrays(h,U,W,K,Q,oe,ce){for(const fe in this.programConfigurations)this.programConfigurations[fe].populatePaintArrays(h,U,K,Q,oe,ce);U.id!==void 0&&this._featureMap.add(U.id,W,this._bufferOffset,h),this._bufferOffset=h,this.needsUpload=!0}updatePaintArrays(h,U,W,K,Q){for(const oe of W)this.needsUpload=this.programConfigurations[oe.id].updatePaintArrays(h,this._featureMap,U,oe,K,Q)||this.needsUpload}get(h){return this.programConfigurations[h]}upload(h){if(this.needsUpload){for(const U in this.programConfigurations)this.programConfigurations[U].upload(h);this.needsUpload=!1}}destroy(){for(const h in this.programConfigurations)this.programConfigurations[h].destroy()}}const P_={"text-opacity":["opacity"],"icon-opacity":["opacity"],"text-color":["fill_color"],"icon-color":["fill_color"],"text-halo-color":["halo_color"],"icon-halo-color":["halo_color"],"text-halo-blur":["halo_blur"],"icon-halo-blur":["halo_blur"],"text-halo-width":["halo_width"],"icon-halo-width":["halo_width"],"line-gap-width":["gapwidth"],"line-pattern":["pattern","pixel_ratio"],"fill-pattern":["pattern","pixel_ratio"],"fill-extrusion-pattern":["pattern","pixel_ratio"],"line-dasharray":["dash"]};function M_(R,h){return P_[R]||[R.replace(`${h}-`,"").replace(/-/g,"_")]}const D_={"line-pattern":{source:jt,composite:jt},"fill-pattern":{source:jt,composite:jt},"fill-extrusion-pattern":{source:jt,composite:jt},"line-dasharray":{source:ir,composite:ir}},L_={color:{source:ha,composite:pr},number:{source:Li,composite:ha}};function tf(R,h,U){const W=D_[R];return W&&W[U]||L_[h][U]}Vr(fl,"ConstantBinder"),Vr(eu,"PatternConstantBinder"),Vr(io,"SourceExpressionBinder"),Vr(Ao,"PatternCompositeBinder"),Vr(Ta,"CompositeExpressionBinder"),Vr(Ro,"ProgramConfiguration",{omit:["_buffers"]}),Vr(hs,"ProgramConfigurationSet");const rf="-transition";class qa extends Da{constructor(h,U){if(super(),this.id=h.id,this.type=h.type,this._featureFilter={filter:()=>!0,needGeometry:!1,needFeature:!1},this._filterCompiled=!1,h.type!=="custom"&&(this.metadata=h.metadata,this.minzoom=h.minzoom,this.maxzoom=h.maxzoom,h.type!=="background"&&h.type!=="sky"&&(this.source=h.source,this.sourceLayer=h["source-layer"],this.filter=h.filter),U.layout&&(this._unevaluatedLayout=new tt(U.layout)),U.paint)){this._transitionablePaint=new Fe(U.paint);for(const W in h.paint)this.setPaintProperty(W,h.paint[W],{validate:!1});for(const W in h.layout)this.setLayoutProperty(W,h.layout[W],{validate:!1});this._transitioningPaint=this._transitionablePaint.untransitioned(),this.paint=new it(U.paint)}}getLayoutProperty(h){return h==="visibility"?this.visibility:this._unevaluatedLayout.getValue(h)}setLayoutProperty(h,U,W={}){U!=null&&this._validate(Lh,`layers.${this.id}.layout.${h}`,h,U,W)||(h!=="visibility"?this._unevaluatedLayout.setValue(h,U):this.visibility=U)}getPaintProperty(h){return Wr(h,rf)?this._transitionablePaint.getTransition(h.slice(0,-11)):this._transitionablePaint.getValue(h)}setPaintProperty(h,U,W={}){if(U!=null&&this._validate(Dh,`layers.${this.id}.paint.${h}`,h,U,W))return!1;if(Wr(h,rf))return this._transitionablePaint.setTransition(h.slice(0,-11),U||void 0),!1;{const K=this._transitionablePaint._values[h],Q=K.value.isDataDriven(),oe=K.value;this._transitionablePaint.setValue(h,U),this._handleSpecialPaintPropertyUpdate(h);const ce=this._transitionablePaint._values[h].value,fe=ce.isDataDriven(),pe=Wr(h,"pattern")||h==="line-dasharray";return fe||Q||pe||this._handleOverridablePaintPropertyUpdate(h,oe,ce)}}_handleSpecialPaintPropertyUpdate(h){}getProgramIds(){return null}getProgramConfiguration(h){return null}_handleOverridablePaintPropertyUpdate(h,U,W){return!1}isHidden(h){return!!(this.minzoom&&h<this.minzoom)||!!(this.maxzoom&&h>=this.maxzoom)||this.visibility==="none"}updateTransitions(h){this._transitioningPaint=this._transitionablePaint.transitioned(h,this._transitioningPaint)}hasTransition(){return this._transitioningPaint.hasTransition()}recalculate(h,U){this._unevaluatedLayout&&(this.layout=this._unevaluatedLayout.possiblyEvaluate(h,void 0,U)),this.paint=this._transitioningPaint.possiblyEvaluate(h,void 0,U)}serialize(){const h={id:this.id,type:this.type,source:this.source,"source-layer":this.sourceLayer,metadata:this.metadata,minzoom:this.minzoom,maxzoom:this.maxzoom,filter:this.filter,layout:this._unevaluatedLayout&&this._unevaluatedLayout.serialize(),paint:this._transitionablePaint&&this._transitionablePaint.serialize()};return this.visibility&&(h.layout=h.layout||{},h.layout.visibility=this.visibility),Kr(h,(U,W)=>!(U===void 0||W==="layout"&&!Object.keys(U).length||W==="paint"&&!Object.keys(U).length))}_validate(h,U,W,K,Q={}){return(!Q||Q.validate!==!1)&&Oc(this,h.call(Rc,{key:U,layerType:this.type,objectKey:W,value:K,styleSpec:Yt,style:{glyphs:!0,sprite:!0}}))}is3D(){return!1}isSky(){return!1}isTileClipped(){return!1}hasOffscreenPass(){return!1}resize(){}isStateDependent(){for(const h in this.paint._values){const U=this.paint.get(h);if(U instanceof Qe&&bo(U.property.specification)&&(U.value.kind==="source"||U.value.kind==="composite")&&U.value.isStateDependent)return!0}return!1}compileFilter(){this._filterCompiled||(this._featureFilter=Zs(this.filter),this._filterCompiled=!0)}invalidateCompiledFilter(){this._filterCompiled=!1}dynamicFilter(){return this._featureFilter.dynamicFilter}dynamicFilterNeedsFeature(){return this._featureFilter.needFeature}}const F_=Dt([{name:"a_pos",components:2,type:"Int16"}],4),k_=Dt([{name:"a_pos_3",components:3,type:"Int16"},{name:"a_pos_normal_3",components:3,type:"Int16"}]);class hn{constructor(h=[]){this.segments=h}prepareSegment(h,U,W,K){let Q=this.segments[this.segments.length-1];return h>hn.MAX_VERTEX_ARRAY_LENGTH&&Hr(`Max vertices per segment is ${hn.MAX_VERTEX_ARRAY_LENGTH}: bucket requested ${h}`),(!Q||Q.vertexLength+h>hn.MAX_VERTEX_ARRAY_LENGTH||Q.sortKey!==K)&&(Q={vertexOffset:U.length,primitiveOffset:W.length,vertexLength:0,primitiveLength:0},K!==void 0&&(Q.sortKey=K),this.segments.push(Q)),Q}get(){return this.segments}destroy(){for(const h of this.segments)for(const U in h.vaos)h.vaos[U].destroy()}static simpleSegment(h,U,W,K){return new hn([{vertexOffset:h,primitiveOffset:U,vertexLength:W,primitiveLength:K,vaos:{},sortKey:0}])}}hn.MAX_VERTEX_ARRAY_LENGTH=Math.pow(2,16)-1,Vr(hn,"SegmentVector");var ri=8192;class Oo{constructor(h,U){h&&(U?this.setSouthWest(h).setNorthEast(U):h.length===4?this.setSouthWest([h[0],h[1]]).setNorthEast([h[2],h[3]]):this.setSouthWest(h[0]).setNorthEast(h[1]))}setNorthEast(h){return this._ne=h instanceof Bi?new Bi(h.lng,h.lat):Bi.convert(h),this}setSouthWest(h){return this._sw=h instanceof Bi?new Bi(h.lng,h.lat):Bi.convert(h),this}extend(h){const U=this._sw,W=this._ne;let K,Q;if(h instanceof Bi)K=h,Q=h;else{if(!(h instanceof Oo))return Array.isArray(h)?h.length===4||h.every(Array.isArray)?this.extend(Oo.convert(h)):this.extend(Bi.convert(h)):typeof h=="object"&&h!==null&&h.hasOwnProperty("lat")&&(h.hasOwnProperty("lon")||h.hasOwnProperty("lng"))?this.extend(Bi.convert(h)):this;if(K=h._sw,Q=h._ne,!K||!Q)return this}return U||W?(U.lng=Math.min(K.lng,U.lng),U.lat=Math.min(K.lat,U.lat),W.lng=Math.max(Q.lng,W.lng),W.lat=Math.max(Q.lat,W.lat)):(this._sw=new Bi(K.lng,K.lat),this._ne=new Bi(Q.lng,Q.lat)),this}getCenter(){return new Bi((this._sw.lng+this._ne.lng)/2,(this._sw.lat+this._ne.lat)/2)}getSouthWest(){return this._sw}getNorthEast(){return this._ne}getNorthWest(){return new Bi(this.getWest(),this.getNorth())}getSouthEast(){return new Bi(this.getEast(),this.getSouth())}getWest(){return this._sw.lng}getSouth(){return this._sw.lat}getEast(){return this._ne.lng}getNorth(){return this._ne.lat}toArray(){return[this._sw.toArray(),this._ne.toArray()]}toString(){return`LngLatBounds(${this._sw.toString()}, ${this._ne.toString()})`}isEmpty(){return!(this._sw&&this._ne)}contains(h){const{lng:U,lat:W}=Bi.convert(h);let K=this._sw.lng<=U&&U<=this._ne.lng;return this._sw.lng>this._ne.lng&&(K=this._sw.lng>=U&&U>=this._ne.lng),this._sw.lat<=W&&W<=this._ne.lat&&K}static convert(h){return!h||h instanceof Oo?h:new Oo(h)}}var kc=1e-6,Xn=typeof Float32Array<"u"?Float32Array:Array;function nf(){var R=new Xn(9);return Xn!=Float32Array&&(R[1]=0,R[2]=0,R[3]=0,R[5]=0,R[6]=0,R[7]=0),R[0]=1,R[4]=1,R[8]=1,R}function af(R,h,U){var W=h[0],K=h[1],Q=h[2],oe=h[3],ce=h[4],fe=h[5],pe=h[6],ve=h[7],Ee=h[8],we=U[0],Ae=U[1],Pe=U[2],ze=U[3],Xe=U[4],at=U[5],mt=U[6],ot=U[7],pt=U[8];return R[0]=we*W+Ae*oe+Pe*pe,R[1]=we*K+Ae*ce+Pe*ve,R[2]=we*Q+Ae*fe+Pe*Ee,R[3]=ze*W+Xe*oe+at*pe,R[4]=ze*K+Xe*ce+at*ve,R[5]=ze*Q+Xe*fe+at*Ee,R[6]=mt*W+ot*oe+pt*pe,R[7]=mt*K+ot*ce+pt*ve,R[8]=mt*Q+ot*fe+pt*Ee,R}function Ia(R){return R[0]=1,R[1]=0,R[2]=0,R[3]=0,R[4]=0,R[5]=1,R[6]=0,R[7]=0,R[8]=0,R[9]=0,R[10]=1,R[11]=0,R[12]=0,R[13]=0,R[14]=0,R[15]=1,R}function Vh(R,h){var U=h[0],W=h[1],K=h[2],Q=h[3],oe=h[4],ce=h[5],fe=h[6],pe=h[7],ve=h[8],Ee=h[9],we=h[10],Ae=h[11],Pe=h[12],ze=h[13],Xe=h[14],at=h[15],mt=U*ce-W*oe,ot=U*fe-K*oe,pt=U*pe-Q*oe,Et=W*fe-K*ce,bt=W*pe-Q*ce,$t=K*pe-Q*fe,zt=ve*ze-Ee*Pe,rr=ve*Xe-we*Pe,yr=ve*at-Ae*Pe,Zt=Ee*Xe-we*ze,ar=Ee*at-Ae*ze,or=we*at-Ae*Xe,hr=mt*or-ot*ar+pt*Zt+Et*yr-bt*rr+$t*zt;return hr?(R[0]=(ce*or-fe*ar+pe*Zt)*(hr=1/hr),R[1]=(K*ar-W*or-Q*Zt)*hr,R[2]=(ze*$t-Xe*bt+at*Et)*hr,R[3]=(we*bt-Ee*$t-Ae*Et)*hr,R[4]=(fe*yr-oe*or-pe*rr)*hr,R[5]=(U*or-K*yr+Q*rr)*hr,R[6]=(Xe*pt-Pe*$t-at*ot)*hr,R[7]=(ve*$t-we*pt+Ae*ot)*hr,R[8]=(oe*ar-ce*yr+pe*zt)*hr,R[9]=(W*yr-U*ar-Q*zt)*hr,R[10]=(Pe*bt-ze*pt+at*mt)*hr,R[11]=(Ee*pt-ve*bt-Ae*mt)*hr,R[12]=(ce*rr-oe*Zt-fe*zt)*hr,R[13]=(U*Zt-W*rr+K*zt)*hr,R[14]=(ze*ot-Pe*Et-Xe*mt)*hr,R[15]=(ve*Et-Ee*ot+we*mt)*hr,R):null}function ds(R,h,U){var W=h[0],K=h[1],Q=h[2],oe=h[3],ce=h[4],fe=h[5],pe=h[6],ve=h[7],Ee=h[8],we=h[9],Ae=h[10],Pe=h[11],ze=h[12],Xe=h[13],at=h[14],mt=h[15],ot=U[0],pt=U[1],Et=U[2],bt=U[3];return R[0]=ot*W+pt*ce+Et*Ee+bt*ze,R[1]=ot*K+pt*fe+Et*we+bt*Xe,R[2]=ot*Q+pt*pe+Et*Ae+bt*at,R[3]=ot*oe+pt*ve+Et*Pe+bt*mt,R[4]=(ot=U[4])*W+(pt=U[5])*ce+(Et=U[6])*Ee+(bt=U[7])*ze,R[5]=ot*K+pt*fe+Et*we+bt*Xe,R[6]=ot*Q+pt*pe+Et*Ae+bt*at,R[7]=ot*oe+pt*ve+Et*Pe+bt*mt,R[8]=(ot=U[8])*W+(pt=U[9])*ce+(Et=U[10])*Ee+(bt=U[11])*ze,R[9]=ot*K+pt*fe+Et*we+bt*Xe,R[10]=ot*Q+pt*pe+Et*Ae+bt*at,R[11]=ot*oe+pt*ve+Et*Pe+bt*mt,R[12]=(ot=U[12])*W+(pt=U[13])*ce+(Et=U[14])*Ee+(bt=U[15])*ze,R[13]=ot*K+pt*fe+Et*we+bt*Xe,R[14]=ot*Q+pt*pe+Et*Ae+bt*at,R[15]=ot*oe+pt*ve+Et*Pe+bt*mt,R}function pl(R,h,U){var W,K,Q,oe,ce,fe,pe,ve,Ee,we,Ae,Pe,ze=U[0],Xe=U[1],at=U[2];return h===R?(R[12]=h[0]*ze+h[4]*Xe+h[8]*at+h[12],R[13]=h[1]*ze+h[5]*Xe+h[9]*at+h[13],R[14]=h[2]*ze+h[6]*Xe+h[10]*at+h[14],R[15]=h[3]*ze+h[7]*Xe+h[11]*at+h[15]):(K=h[1],Q=h[2],oe=h[3],ce=h[4],fe=h[5],pe=h[6],ve=h[7],Ee=h[8],we=h[9],Ae=h[10],Pe=h[11],R[0]=W=h[0],R[1]=K,R[2]=Q,R[3]=oe,R[4]=ce,R[5]=fe,R[6]=pe,R[7]=ve,R[8]=Ee,R[9]=we,R[10]=Ae,R[11]=Pe,R[12]=W*ze+ce*Xe+Ee*at+h[12],R[13]=K*ze+fe*Xe+we*at+h[13],R[14]=Q*ze+pe*Xe+Ae*at+h[14],R[15]=oe*ze+ve*Xe+Pe*at+h[15]),R}function fs(R,h,U){var W=U[0],K=U[1],Q=U[2];return R[0]=h[0]*W,R[1]=h[1]*W,R[2]=h[2]*W,R[3]=h[3]*W,R[4]=h[4]*K,R[5]=h[5]*K,R[6]=h[6]*K,R[7]=h[7]*K,R[8]=h[8]*Q,R[9]=h[9]*Q,R[10]=h[10]*Q,R[11]=h[11]*Q,R[12]=h[12],R[13]=h[13],R[14]=h[14],R[15]=h[15],R}function Gh(R,h,U){var W=Math.sin(U),K=Math.cos(U),Q=h[4],oe=h[5],ce=h[6],fe=h[7],pe=h[8],ve=h[9],Ee=h[10],we=h[11];return h!==R&&(R[0]=h[0],R[1]=h[1],R[2]=h[2],R[3]=h[3],R[12]=h[12],R[13]=h[13],R[14]=h[14],R[15]=h[15]),R[4]=Q*K+pe*W,R[5]=oe*K+ve*W,R[6]=ce*K+Ee*W,R[7]=fe*K+we*W,R[8]=pe*K-Q*W,R[9]=ve*K-oe*W,R[10]=Ee*K-ce*W,R[11]=we*K-fe*W,R}function Bc(R,h,U){var W=Math.sin(U),K=Math.cos(U),Q=h[0],oe=h[1],ce=h[2],fe=h[3],pe=h[8],ve=h[9],Ee=h[10],we=h[11];return h!==R&&(R[4]=h[4],R[5]=h[5],R[6]=h[6],R[7]=h[7],R[12]=h[12],R[13]=h[13],R[14]=h[14],R[15]=h[15]),R[0]=Q*K-pe*W,R[1]=oe*K-ve*W,R[2]=ce*K-Ee*W,R[3]=fe*K-we*W,R[8]=Q*W+pe*K,R[9]=oe*W+ve*K,R[10]=ce*W+Ee*K,R[11]=fe*W+we*K,R}function of(R,h){return R[0]=h[0],R[1]=0,R[2]=0,R[3]=0,R[4]=0,R[5]=h[1],R[6]=0,R[7]=0,R[8]=0,R[9]=0,R[10]=h[2],R[11]=0,R[12]=0,R[13]=0,R[14]=0,R[15]=1,R}function sf(R,h,U){var W,K,Q,oe=U[0],ce=U[1],fe=U[2],pe=Math.hypot(oe,ce,fe);return pe<kc?null:(oe*=pe=1/pe,ce*=pe,fe*=pe,W=Math.sin(h),K=Math.cos(h),R[0]=oe*oe*(Q=1-K)+K,R[1]=ce*oe*Q+fe*W,R[2]=fe*oe*Q-ce*W,R[3]=0,R[4]=oe*ce*Q-fe*W,R[5]=ce*ce*Q+K,R[6]=fe*ce*Q+oe*W,R[7]=0,R[8]=oe*fe*Q+ce*W,R[9]=ce*fe*Q-oe*W,R[10]=fe*fe*Q+K,R[11]=0,R[12]=0,R[13]=0,R[14]=0,R[15]=1,R)}Math.hypot||(Math.hypot=function(){for(var R=0,h=arguments.length;h--;)R+=arguments[h]*arguments[h];return Math.sqrt(R)});var B_=ds;function $h(){var R=new Xn(3);return Xn!=Float32Array&&(R[0]=0,R[1]=0,R[2]=0),R}function uf(R){var h=new Xn(3);return h[0]=R[0],h[1]=R[1],h[2]=R[2],h}function _l(R){return Math.hypot(R[0],R[1],R[2])}function tu(R,h,U){var W=new Xn(3);return W[0]=R,W[1]=h,W[2]=U,W}function no(R,h,U){return R[0]=h[0]+U[0],R[1]=h[1]+U[1],R[2]=h[2]+U[2],R}function Wh(R,h,U){return R[0]=h[0]-U[0],R[1]=h[1]-U[1],R[2]=h[2]-U[2],R}function lf(R,h,U){return R[0]=h[0]*U[0],R[1]=h[1]*U[1],R[2]=h[2]*U[2],R}function ml(R,h,U){return R[0]=Math.min(h[0],U[0]),R[1]=Math.min(h[1],U[1]),R[2]=Math.min(h[2],U[2]),R}function yl(R,h,U){return R[0]=Math.max(h[0],U[0]),R[1]=Math.max(h[1],U[1]),R[2]=Math.max(h[2],U[2]),R}function na(R,h,U){return R[0]=h[0]*U,R[1]=h[1]*U,R[2]=h[2]*U,R}function gl(R,h,U,W){return R[0]=h[0]+U[0]*W,R[1]=h[1]+U[1]*W,R[2]=h[2]+U[2]*W,R}function Ln(R,h){var U=h[0],W=h[1],K=h[2],Q=U*U+W*W+K*K;return Q>0&&(Q=1/Math.sqrt(Q)),R[0]=h[0]*Q,R[1]=h[1]*Q,R[2]=h[2]*Q,R}function da(R,h){return R[0]*h[0]+R[1]*h[1]+R[2]*h[2]}function Hh(R,h,U){var W=h[0],K=h[1],Q=h[2],oe=U[0],ce=U[1],fe=U[2];return R[0]=K*fe-Q*ce,R[1]=Q*oe-W*fe,R[2]=W*ce-K*oe,R}function un(R,h,U){var W=h[0],K=h[1],Q=h[2],oe=U[3]*W+U[7]*K+U[11]*Q+U[15];return R[0]=(U[0]*W+U[4]*K+U[8]*Q+U[12])/(oe=oe||1),R[1]=(U[1]*W+U[5]*K+U[9]*Q+U[13])/oe,R[2]=(U[2]*W+U[6]*K+U[10]*Q+U[14])/oe,R}function cf(R,h,U){var W=U[0],K=U[1],Q=U[2],oe=h[0],ce=h[1],fe=h[2],pe=K*fe-Q*ce,ve=Q*oe-W*fe,Ee=W*ce-K*oe,we=K*Ee-Q*ve,Ae=Q*pe-W*Ee,Pe=W*ve-K*pe,ze=2*U[3];return ve*=ze,Ee*=ze,Ae*=2,Pe*=2,R[0]=oe+(pe*=ze)+(we*=2),R[1]=ce+ve+Ae,R[2]=fe+Ee+Pe,R}var vl,Aa=Wh,z_=lf,N_=_l;function hf(R,h,U){return R[0]=h[0]*U,R[1]=h[1]*U,R[2]=h[2]*U,R[3]=h[3]*U,R}function df(R,h){var U=h[0],W=h[1],K=h[2],Q=h[3],oe=U*U+W*W+K*K+Q*Q;return oe>0&&(oe=1/Math.sqrt(oe)),R[0]=U*oe,R[1]=W*oe,R[2]=K*oe,R[3]=Q*oe,R}function ps(R,h,U){var W=h[0],K=h[1],Q=h[2],oe=h[3];return R[0]=U[0]*W+U[4]*K+U[8]*Q+U[12]*oe,R[1]=U[1]*W+U[5]*K+U[9]*Q+U[13]*oe,R[2]=U[2]*W+U[6]*K+U[10]*Q+U[14]*oe,R[3]=U[3]*W+U[7]*K+U[11]*Q+U[15]*oe,R}function ff(){var R=new Xn(4);return Xn!=Float32Array&&(R[0]=0,R[1]=0,R[2]=0),R[3]=1,R}function pf(R){return R[0]=0,R[1]=0,R[2]=0,R[3]=1,R}function _f(R,h,U){U*=.5;var W=h[0],K=h[1],Q=h[2],oe=h[3],ce=Math.sin(U),fe=Math.cos(U);return R[0]=W*fe+oe*ce,R[1]=K*fe+Q*ce,R[2]=Q*fe-K*ce,R[3]=oe*fe-W*ce,R}function mf(R,h,U){U*=.5;var W=h[0],K=h[1],Q=h[2],oe=h[3],ce=Math.sin(U),fe=Math.cos(U);return R[0]=W*fe-Q*ce,R[1]=K*fe+oe*ce,R[2]=Q*fe+W*ce,R[3]=oe*fe-K*ce,R}$h(),vl=new Xn(4),Xn!=Float32Array&&(vl[0]=0,vl[1]=0,vl[2]=0,vl[3]=0);var j_=df;$h(),tu(1,0,0),tu(0,1,0),ff(),ff(),nf();const U_=Dt([{type:"Float32",name:"a_globe_pos",components:3},{type:"Float32",name:"a_uv",components:2}]),{members:yf}=U_,gf=Dt([{name:"a_pos_3",components:3,type:"Int16"}]);var bl=Dt([{name:"a_pos",type:"Int16",components:2}]);class Zh{constructor(h,U){this.pos=h,this.dir=U}intersectsPlane(h,U,W){const K=da(U,this.dir);if(Math.abs(K)<1e-6)return!1;const Q=((h[0]-this.pos[0])*U[0]+(h[1]-this.pos[1])*U[1]+(h[2]-this.pos[2])*U[2])/K;return W[0]=this.pos[0]+this.dir[0]*Q,W[1]=this.pos[1]+this.dir[1]*Q,W[2]=this.pos[2]+this.dir[2]*Q,!0}closestPointOnSphere(h,U,W){if(function(Ae,Pe){var ze=Ae[0],Xe=Ae[1],at=Ae[2],mt=Pe[0],ot=Pe[1],pt=Pe[2];return Math.abs(ze-mt)<=kc*Math.max(1,Math.abs(ze),Math.abs(mt))&&Math.abs(Xe-ot)<=kc*Math.max(1,Math.abs(Xe),Math.abs(ot))&&Math.abs(at-pt)<=kc*Math.max(1,Math.abs(at),Math.abs(pt))}(this.pos,h)||U===0)return W[0]=W[1]=W[2]=0,!1;const[K,Q,oe]=this.dir,ce=this.pos[0]-h[0],fe=this.pos[1]-h[1],pe=this.pos[2]-h[2],ve=K*K+Q*Q+oe*oe,Ee=2*(ce*K+fe*Q+pe*oe),we=Ee*Ee-4*ve*(ce*ce+fe*fe+pe*pe-U*U);if(we<0){const Ae=Math.max(-Ee/2,0),Pe=ce+K*Ae,ze=fe+Q*Ae,Xe=pe+oe*Ae,at=Math.hypot(Pe,ze,Xe);return W[0]=Pe*U/at,W[1]=ze*U/at,W[2]=Xe*U/at,!1}{const Ae=(-Ee-Math.sqrt(we))/(2*ve);if(Ae<0){const Pe=Math.hypot(ce,fe,pe);return W[0]=ce*U/Pe,W[1]=fe*U/Pe,W[2]=pe*U/Pe,!1}return W[0]=ce+K*Ae,W[1]=fe+Q*Ae,W[2]=pe+oe*Ae,!0}}}class Kh{constructor(h,U,W,K,Q){this.TL=h,this.TR=U,this.BR=W,this.BL=K,this.horizon=Q}static fromInvProjectionMatrix(h,U,W){const K=[-1,1,1],Q=[1,1,1],oe=[1,-1,1],ce=[-1,-1,1],fe=un(K,K,h),pe=un(Q,Q,h),ve=un(oe,oe,h),Ee=un(ce,ce,h);return new Kh(fe,pe,ve,Ee,U/W)}}class Xh{constructor(h,U){this.points=h,this.planes=U}static fromInvProjectionMatrix(h,U,W,K){const Q=Math.pow(2,W),oe=[[-1,1,-1,1],[1,1,-1,1],[1,-1,-1,1],[-1,-1,-1,1],[-1,1,1,1],[1,1,1,1],[1,-1,1,1],[-1,-1,1,1]].map(fe=>{const pe=ps([],fe,h),ve=1/pe[3]/U*Q;return function(Ee,we,Ae){return Ee[0]=we[0]*Ae[0],Ee[1]=we[1]*Ae[1],Ee[2]=we[2]*Ae[2],Ee[3]=we[3]*Ae[3],Ee}(pe,pe,[ve,ve,K?1/pe[3]:ve,ve])}),ce=[[0,1,2],[6,5,4],[0,3,7],[2,1,5],[3,2,6],[0,4,5]].map(fe=>{const pe=Ln([],Hh([],Aa([],oe[fe[0]],oe[fe[1]]),Aa([],oe[fe[2]],oe[fe[1]]))),ve=-da(pe,oe[fe[1]]);return pe.concat(ve)});return new Xh(oe,ce)}}class Fn{static fromPoints(h){const U=[1/0,1/0,1/0],W=[-1/0,-1/0,-1/0];for(const K of h)ml(U,U,K),yl(W,W,K);return new Fn(U,W)}static applyTransform(h,U){const W=h.getCorners();for(let K=0;K<W.length;++K)un(W[K],W[K],U);return Fn.fromPoints(W)}constructor(h,U){this.min=h,this.max=U,this.center=na([],no([],this.min,this.max),.5)}quadrant(h){const U=[h%2==0,h<2],W=uf(this.min),K=uf(this.max);for(let Q=0;Q<U.length;Q++)W[Q]=U[Q]?this.min[Q]:this.center[Q],K[Q]=U[Q]?this.center[Q]:this.max[Q];return K[2]=this.max[2],new Fn(W,K)}distanceX(h){return Math.max(Math.min(this.max[0],h[0]),this.min[0])-h[0]}distanceY(h){return Math.max(Math.min(this.max[1],h[1]),this.min[1])-h[1]}distanceZ(h){return Math.max(Math.min(this.max[2],h[2]),this.min[2])-h[2]}getCorners(){const h=this.min,U=this.max;return[[h[0],h[1],h[2]],[U[0],h[1],h[2]],[U[0],U[1],h[2]],[h[0],U[1],h[2]],[h[0],h[1],U[2]],[U[0],h[1],U[2]],[U[0],U[1],U[2]],[h[0],U[1],U[2]]]}intersects(h){const U=this.getCorners();let W=!0;for(let K=0;K<h.planes.length;K++){const Q=h.planes[K];let oe=0;for(let ce=0;ce<U.length;ce++)oe+=da(Q,U[ce])+Q[3]>=0;if(oe===0)return 0;oe!==U.length&&(W=!1)}if(W)return 2;for(let K=0;K<3;K++){let Q=Number.MAX_VALUE,oe=-Number.MAX_VALUE;for(let ce=0;ce<h.points.length;ce++){const fe=h.points[ce][K]-this.min[K];Q=Math.min(Q,fe),oe=Math.max(oe,fe)}if(oe<0||Q>this.max[K]-this.min[K])return 0}return 1}}const Yh=5,vf=6,Ba=ri/Math.PI/2,V_=16383,_s=64,xl=[_s,32,16],fa=-Ba,pa=Ba,G_=[new Fn([fa,fa,fa],[pa,pa,pa]),new Fn([fa,fa,fa],[0,0,pa]),new Fn([0,fa,fa],[pa,0,pa]),new Fn([fa,0,fa],[0,pa,pa]),new Fn([0,0,fa],[pa,pa,pa])];function zc(R){return R*Ba/Sl}function bf(R,h,U,W=!0){const K=na([],R._camera.position,R.worldSize),Q=[h,U,1,1];ps(Q,Q,R.pixelMatrixInverse),hf(Q,Q,1/Q[3]);const oe=Ln([],Aa([],Q,K)),ce=R.globeMatrix,fe=[ce[12],ce[13],ce[14]],pe=Aa([],fe,K),ve=_l(pe),Ee=Ln([],pe),we=R.worldSize/(2*Math.PI),Ae=da(Ee,oe),Pe=Math.asin(we/ve);if(Pe<Math.acos(Ae)){if(!W)return null;const yr=[],Zt=[];na(yr,oe,ve/Ae),Ln(Zt,Aa(Zt,yr,pe)),Ln(oe,no(oe,pe,na(oe,Zt,Math.tan(Pe)*ve)))}const ze=[];new Zh(K,oe).closestPointOnSphere(fe,we,ze);const Xe=Ln([],Ir(ce,0)),at=Ln([],Ir(ce,1)),mt=Ln([],Ir(ce,2)),ot=da(Xe,ze),pt=da(at,ze),Et=da(mt,ze),bt=yt(Math.asin(-pt/we));let $t=yt(Math.atan2(ot,Et));$t=R.center.lng+function(yr,Zt){const ar=(Zt-yr+180)%360-180;return ar<-180?ar+360:ar}(R.center.lng,$t);const zt=Na($t),rr=nt(ja(bt),0,1);return new au(zt,rr)}class $_{constructor(h,U,W){this.a=Aa([],h,W),this.b=Aa([],U,W),this.center=W;const K=Ln([],this.a),Q=Ln([],this.b);this.angle=Math.acos(da(K,Q))}}function Jh(R,h){if(R.angle===0)return null;let U;return U=R.a[h]===0?1/R.angle*.5*Math.PI:1/R.angle*Math.atan(R.b[h]/R.a[h]/Math.sin(R.angle)-1/Math.tan(R.angle)),U<0||U>1?null:function(W,K,Q,oe){const ce=Math.sin(Q);return W*(Math.sin((1-oe)*Q)/ce)+K*(Math.sin(oe*Q)/ce)}(R.a[h],R.b[h],R.angle,nt(U,0,1))+R.center[h]}function za(R){if(R.z<=1)return G_[R.z+2*R.y+R.x];const h=Qh(Nc(R));return Fn.fromPoints(h)}function ys(R,h,U){return na(R,R,1-U),gl(R,R,h,U)}function xf(R,h){const U=nu(h.zoom);if(U===0)return za(R);const W=Nc(R),K=Qh(W),Q=Na(W.getWest())*h.worldSize,oe=Na(W.getEast())*h.worldSize,ce=ja(W.getNorth())*h.worldSize,fe=ja(W.getSouth())*h.worldSize,pe=[Q,ce,0],ve=[oe,ce,0],Ee=[Q,fe,0],we=[oe,fe,0],Ae=Vh([],h.globeMatrix);return un(pe,pe,Ae),un(ve,ve,Ae),un(Ee,Ee,Ae),un(we,we,Ae),K[0]=ys(K[0],Ee,U),K[1]=ys(K[1],we,U),K[2]=ys(K[2],ve,U),K[3]=ys(K[3],pe,U),Fn.fromPoints(K)}function Ef(R,h,U){for(const W of R)un(W,W,h),na(W,W,U)}function W_(R,h,U){const W=h/R.worldSize,K=R.globeMatrix;if(U.z<=1){const zt=za(U).getCorners();return Ef(zt,K,W),Fn.fromPoints(zt)}const Q=Nc(U),oe=Qh(Q);Ef(oe,K,W);const ce=Number.MAX_VALUE,fe=[-ce,-ce,-ce],pe=[ce,ce,ce];if(Q.contains(R.center)){for(const yr of oe)ml(pe,pe,yr),yl(fe,fe,yr);fe[2]=0;const zt=R.point,rr=[zt.x*W,zt.y*W,0];return ml(pe,pe,rr),yl(fe,fe,rr),new Fn(pe,fe)}const ve=[K[12]*W,K[13]*W,K[14]*W],Ee=Q.getCenter(),we=nt(R.center.lat,-On,On),Ae=nt(Ee.lat,-On,On),Pe=Na(R.center.lng),ze=ja(we);let Xe=Pe-Na(Ee.lng);const at=ze-ja(Ae);Xe>.5?Xe-=1:Xe<-.5&&(Xe+=1);let mt=0;Math.abs(Xe)>Math.abs(at)?mt=Xe>=0?1:3:(mt=at>=0?0:2,gl(ve,ve,[K[4]*W,K[5]*W,K[6]*W],-Math.sin(ut(at>=0?Q.getSouth():Q.getNorth()))*Ba));const ot=oe[mt],pt=oe[(mt+1)%4],Et=new $_(ot,pt,ve),bt=[Jh(Et,0)||ot[0],Jh(Et,1)||ot[1],Jh(Et,2)||ot[2]],$t=nu(R.zoom);if($t>0){const zt=function({x:yr,y:Zt,z:ar},or,hr,Sr,Jt){const Cr=1/(1<<ar);let $r=yr*Cr,Pr=$r+Cr,di=Zt*Cr,Tr=di+Cr,ei=0;const fi=($r+Pr)/2-Sr;return fi>.5?ei=-1:fi<-.5&&(ei=1),$r=(($r+ei)*or-(Sr*=or))*hr+Sr,Pr=((Pr+ei)*or-Sr)*hr+Sr,di=(di*or-(Jt*=or))*hr+Jt,Tr=(Tr*or-Jt)*hr+Jt,[[$r,Tr,0],[Pr,Tr,0],[Pr,di,0],[$r,di,0]]}(U,h,R._pixelsPerMercatorPixel,Pe,ze);for(let yr=0;yr<oe.length;yr++)ys(oe[yr],zt[yr],$t);const rr=no([],zt[mt],zt[(mt+1)%4]);na(rr,rr,.5),ys(bt,rr,$t)}for(const zt of oe)ml(pe,pe,zt),yl(fe,fe,zt);return pe[2]=Math.min(ot[2],pt[2]),ml(pe,pe,bt),yl(fe,fe,bt),new Fn(pe,fe)}function Nc({x:R,y:h,z:U}){const W=1/(1<<U),K=new Bi(aa(R*W),Rn((h+1)*W)),Q=new Bi(aa((R+1)*W),Rn(h*W));return new Oo(K,Q)}function Qh(R){const h=ut(R.getNorth()),U=ut(R.getSouth()),W=Math.cos(h),K=Math.cos(U),Q=Math.sin(h),oe=Math.sin(U),ce=R.getWest(),fe=R.getEast();return[ru(K,oe,ce),ru(K,oe,fe),ru(W,Q,fe),ru(W,Q,ce)]}function ru(R,h,U,W=Ba){return U=ut(U),[R*Math.sin(U)*W,-h*W,R*Math.cos(U)*W]}function iu(R,h,U){return ru(Math.cos(ut(R)),Math.sin(ut(R)),h,U)}function El(R,h,U,W){const K=1<<U.z,Q=(R/ri+U.x)/K;return iu(Rn((h/ri+U.y)/K),aa(Q),W)}function jc({min:R,max:h}){return V_/Math.max(h[0]-R[0],h[1]-R[1],h[2]-R[2])}const wf=new Float64Array(16);function wl(R){const h=jc(R),U=of(wf,[h,h,h]);return pl(U,U,((W=[])[0]=-(K=R.min)[0],W[1]=-K[1],W[2]=-K[2],W));var W,K}function ed(R){const h=(W=R.min,(U=wf)[0]=1,U[1]=0,U[2]=0,U[3]=0,U[4]=0,U[5]=1,U[6]=0,U[7]=0,U[8]=0,U[9]=0,U[10]=1,U[11]=0,U[12]=W[0],U[13]=W[1],U[14]=W[2],U[15]=1,U);var U,W;const K=1/jc(R);return fs(h,h,[K,K,K])}function Sf(R,h,U,W,K){const Q=function(fe){const pe=ri/(2*Math.PI);return fe/(2*Math.PI)/pe}(U),oe=[R,h,-U/(2*Math.PI)],ce=Ia(new Float64Array(16));return pl(ce,ce,oe),fs(ce,ce,[Q,Q,Q]),Gh(ce,ce,ut(-K)),Bc(ce,ce,ut(-W)),ce}function nu(R){return At(Yh,vf,R)}function Tf(R,h){const U=iu(h.lat,h.lng),W=function(Pe){const ze=iu(Pe._center.lat,Pe._center.lng);let Xe=Hh([],tu(0,1,0),ze);const at=sf([],-Pe.angle,ze);Xe=un(Xe,Xe,at),sf(at,-Pe._pitch,Xe);const mt=Ln([],ze);return na(mt,mt,zc(Pe.cameraToCenterDistance/Pe.pixelsPerMeter)),un(mt,mt,at),no([],ze,mt)}(R);return oe=(K=Wh([],W,U))[0],ce=K[1],fe=K[2],pe=(Q=U)[0],ve=Q[1],Ee=Q[2],Ae=(we=Math.sqrt(oe*oe+ce*ce+fe*fe)*Math.sqrt(pe*pe+ve*ve+Ee*Ee))&&da(K,Q)/we,Math.acos(Math.min(Math.max(Ae,-1),1));var K,Q,oe,ce,fe,pe,ve,Ee,we,Ae}function td(R,h){return Tf(R,h)>Math.PI/2*1.01}const qf=ut(85),H_=Math.cos(qf),Z_=Math.sin(qf),Sl=63710088e-1,If=2*Math.PI*Sl;class Co{constructor(h,U){if(isNaN(h)||isNaN(U))throw new Error(`Invalid LngLat object: (${h}, ${U})`);if(this.lng=+h,this.lat=+U,this.lat>90||this.lat<-90)throw new Error("Invalid LngLat latitude value: must be between -90 and 90")}wrap(){return new Co(wt(this.lng,-180,180),this.lat)}toArray(){return[this.lng,this.lat]}toString(){return`LngLat(${this.lng}, ${this.lat})`}distanceTo(h){const U=Math.PI/180,W=this.lat*U,K=h.lat*U,Q=Math.sin(W)*Math.sin(K)+Math.cos(W)*Math.cos(K)*Math.cos((h.lng-this.lng)*U);return Sl*Math.acos(Math.min(Q,1))}toBounds(h=0){const U=360*h/40075017,W=U/Math.cos(Math.PI/180*this.lat);return new Oo(new Co(this.lng-W,this.lat-U),new Co(this.lng+W,this.lat+U))}toEcef(h){const U=zc(h);return iu(this.lat,this.lng,Ba+U)}static convert(h){if(h instanceof Co)return h;if(Array.isArray(h)&&(h.length===2||h.length===3))return new Co(Number(h[0]),Number(h[1]));if(!Array.isArray(h)&&typeof h=="object"&&h!==null)return new Co(Number("lng"in h?h.lng:h.lon),Number(h.lat));throw new Error("`LngLatLike` argument must be specified as a LngLat instance, an object {lng: <lng>, lat: <lat>}, an object {lon: <lng>, lat: <lat>}, or an array of [<lng>, <lat>]")}}var Bi=Co;function rd(R){return If*Math.cos(R*Math.PI/180)}function Na(R){return(180+R)/360}function ja(R){return(180-180/Math.PI*Math.log(Math.tan(Math.PI/4+R*Math.PI/360)))/360}function Ra(R,h){return R/rd(h)}function aa(R){return 360*R-180}function Rn(R){return 360/Math.PI*Math.atan(Math.exp((180-360*R)*Math.PI/180))-90}function Af(R,h){return R*rd(Rn(h))}const On=85.051129;function Rf(R){return 1/Math.cos(R*Math.PI/180)}class au{constructor(h,U,W=0){this.x=+h,this.y=+U,this.z=+W}static fromLngLat(h,U=0){const W=Bi.convert(h);return new au(Na(W.lng),ja(W.lat),Ra(U,W.lat))}toLngLat(){return new Bi(aa(this.x),Rn(this.y))}toAltitude(){return Af(this.z,this.y)}meterInMercatorCoordinateUnits(){return 1/If*Rf(Rn(this.y))}}function id(R,h,U,W,K,Q,oe,ce,fe){const pe=(h+W)/2,ve=(U+K)/2,Ee=new He(pe,ve);ce(Ee),function(we,Ae,Pe,ze,Xe,at){const mt=Pe-Xe,ot=ze-at;return Math.abs((ze-Ae)*mt-(Pe-we)*ot)/Math.hypot(mt,ot)}(Ee.x,Ee.y,Q.x,Q.y,oe.x,oe.y)>=fe?(id(R,h,U,pe,ve,Q,Ee,ce,fe),id(R,pe,ve,W,K,Ee,oe,ce,fe)):R.push(oe)}function Of(R,h,U){let W=R[0],K=W.x,Q=W.y;h(W);const oe=[W];for(let ce=1;ce<R.length;ce++){const fe=R[ce],{x:pe,y:ve}=fe;h(fe),id(oe,K,Q,pe,ve,W,fe,h,U),K=pe,Q=ve,W=fe}return oe}function nd(R,h,U,W){if(W(h,U)){const K=h.add(U)._mult(.5);nd(R,h,K,W),nd(R,K,U,W)}else R.push(U)}function K_(R,h){let U=R[0];const W=[U];for(let K=1;K<R.length;K++){const Q=R[K];nd(W,U,Q,h),U=Q}return W}const ad=Math.pow(2,14)-1,Cf=-ad-1;function X_(R,h){const U=Math.round(R.x*h),W=Math.round(R.y*h);return R.x=nt(U,Cf,ad),R.y=nt(W,Cf,ad),(U<R.x||U>R.x+1||W<R.y||W>R.y+1)&&Hr("Geometry exceeds allowed extent, reduce your vector tile buffer size"),R}function ao(R,h,U){const W=R.loadGeometry(),K=R.extent,Q=ri/K;if(h&&U&&U.projection.isReprojectedInTileSpace){const oe=1<<h.z,{scale:ce,x:fe,y:pe,projection:ve}=U,Ee=we=>{const Ae=aa((h.x+we.x/K)/oe),Pe=Rn((h.y+we.y/K)/oe),ze=ve.project(Ae,Pe);we.x=(ze.x*ce-fe)*K,we.y=(ze.y*ce-pe)*K};for(let we=0;we<W.length;we++)if(R.type!==1)W[we]=Of(W[we],Ee,1);else{const Ae=[];for(const Pe of W[we])Pe.x<0||Pe.x>=K||Pe.y<0||Pe.y>=K||(Ee(Pe),Ae.push(Pe));W[we]=Ae}}for(const oe of W)for(const ce of oe)X_(ce,Q);return W}function gs(R,h){return{type:R.type,id:R.id,properties:R.properties,geometry:h?ao(R):[]}}function Uc(R,h,U,W,K){R.emplaceBack(2*h+(W+1)/2,2*U+(K+1)/2)}function Vc(R,h,U){R.emplaceBack(h.x,h.y,h.z,U[0]*16384,U[1]*16384,U[2]*16384)}class od{constructor(h){this.zoom=h.zoom,this.overscaling=h.overscaling,this.layers=h.layers,this.layerIds=this.layers.map(U=>U.id),this.index=h.index,this.hasPattern=!1,this.projection=h.projection,this.layoutVertexArray=new mr,this.indexArray=new Zr,this.segments=new hn,this.programConfigurations=new hs(h.layers,h.zoom),this.stateDependentLayerIds=this.layers.filter(U=>U.isStateDependent()).map(U=>U.id)}populate(h,U,W,K){const Q=this.layers[0],oe=[];let ce=null;Q.type==="circle"&&(ce=Q.layout.get("circle-sort-key"));for(const{feature:pe,id:ve,index:Ee,sourceLayerIndex:we}of h){const Ae=this.layers[0]._featureFilter.needGeometry,Pe=gs(pe,Ae);if(!this.layers[0]._featureFilter.filter(new be(this.zoom),Pe,W))continue;const ze=ce?ce.evaluate(Pe,{},W):void 0,Xe={id:ve,properties:pe.properties,type:pe.type,sourceLayerIndex:we,index:Ee,geometry:Ae?Pe.geometry:ao(pe,W,K),patterns:{},sortKey:ze};oe.push(Xe)}ce&&oe.sort((pe,ve)=>pe.sortKey-ve.sortKey);let fe=null;K.projection.name==="globe"&&(this.globeExtVertexArray=new gr,fe=K.projection);for(const pe of oe){const{geometry:ve,index:Ee,sourceLayerIndex:we}=pe,Ae=h[Ee].feature;this.addFeature(pe,ve,Ee,U.availableImages,W,fe),U.featureIndex.insert(Ae,ve,Ee,we,this.index)}}update(h,U,W,K){this.stateDependentLayers.length&&this.programConfigurations.updatePaintArrays(h,U,this.stateDependentLayers,W,K)}isEmpty(){return this.layoutVertexArray.length===0}uploadPending(){return!this.uploaded||this.programConfigurations.needsUpload}upload(h){this.uploaded||(this.layoutVertexBuffer=h.createVertexBuffer(this.layoutVertexArray,F_.members),this.indexBuffer=h.createIndexBuffer(this.indexArray),this.globeExtVertexArray&&(this.globeExtVertexBuffer=h.createVertexBuffer(this.globeExtVertexArray,k_.members))),this.programConfigurations.upload(h),this.uploaded=!0}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy(),this.globeExtVertexBuffer&&this.globeExtVertexBuffer.destroy())}addFeature(h,U,W,K,Q,oe){for(const ce of U)for(const fe of ce){const pe=fe.x,ve=fe.y;if(pe<0||pe>=ri||ve<0||ve>=ri)continue;if(oe){const Ae=oe.projectTilePoint(pe,ve,Q),Pe=oe.upVector(Q,pe,ve),ze=this.globeExtVertexArray;Vc(ze,Ae,Pe),Vc(ze,Ae,Pe),Vc(ze,Ae,Pe),Vc(ze,Ae,Pe)}const Ee=this.segments.prepareSegment(4,this.layoutVertexArray,this.indexArray,h.sortKey),we=Ee.vertexLength;Uc(this.layoutVertexArray,pe,ve,-1,-1),Uc(this.layoutVertexArray,pe,ve,1,-1),Uc(this.layoutVertexArray,pe,ve,1,1),Uc(this.layoutVertexArray,pe,ve,-1,1),this.indexArray.emplaceBack(we,we+1,we+2),this.indexArray.emplaceBack(we,we+2,we+3),Ee.vertexLength+=4,Ee.primitiveLength+=2}this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,h,W,{},K,Q)}}function Pf(R,h){for(let U=0;U<R.length;U++)if(vs(h,R[U]))return!0;for(let U=0;U<h.length;U++)if(vs(R,h[U]))return!0;return!!sd(R,h)}function Y_(R,h,U){return!!vs(R,h)||!!ud(h,R,U)}function Mf(R,h){if(R.length===1)return Lf(h,R[0]);for(let U=0;U<h.length;U++){const W=h[U];for(let K=0;K<W.length;K++)if(vs(R,W[K]))return!0}for(let U=0;U<R.length;U++)if(Lf(h,R[U]))return!0;for(let U=0;U<h.length;U++)if(sd(R,h[U]))return!0;return!1}function J_(R,h,U){if(R.length>1){if(sd(R,h))return!0;for(let W=0;W<h.length;W++)if(ud(h[W],R,U))return!0}for(let W=0;W<R.length;W++)if(ud(R[W],h,U))return!0;return!1}function sd(R,h){if(R.length===0||h.length===0)return!1;for(let U=0;U<R.length-1;U++){const W=R[U],K=R[U+1];for(let Q=0;Q<h.length-1;Q++)if(Q_(W,K,h[Q],h[Q+1]))return!0}return!1}function Q_(R,h,U,W){return Br(R,U,W)!==Br(h,U,W)&&Br(R,h,U)!==Br(R,h,W)}function ud(R,h,U){const W=U*U;if(h.length===1)return R.distSqr(h[0])<W;for(let K=1;K<h.length;K++)if(Df(R,h[K-1],h[K])<W)return!0;return!1}function Df(R,h,U){const W=h.distSqr(U);if(W===0)return R.distSqr(h);const K=((R.x-h.x)*(U.x-h.x)+(R.y-h.y)*(U.y-h.y))/W;return R.distSqr(K<0?h:K>1?U:U.sub(h)._mult(K)._add(h))}function Lf(R,h){let U,W,K,Q=!1;for(let oe=0;oe<R.length;oe++){U=R[oe];for(let ce=0,fe=U.length-1;ce<U.length;fe=ce++)W=U[ce],K=U[fe],W.y>h.y!=K.y>h.y&&h.x<(K.x-W.x)*(h.y-W.y)/(K.y-W.y)+W.x&&(Q=!Q)}return Q}function vs(R,h){let U=!1;for(let W=0,K=R.length-1;W<R.length;K=W++){const Q=R[W],oe=R[K];Q.y>h.y!=oe.y>h.y&&h.x<(oe.x-Q.x)*(h.y-Q.y)/(oe.y-Q.y)+Q.x&&(U=!U)}return U}function Ff(R,h,U,W,K){for(const oe of R)if(h<=oe.x&&U<=oe.y&&W>=oe.x&&K>=oe.y)return!0;const Q=[new He(h,U),new He(h,K),new He(W,K),new He(W,U)];if(R.length>2){for(const oe of Q)if(vs(R,oe))return!0}for(let oe=0;oe<R.length-1;oe++)if(em(R[oe],R[oe+1],Q))return!0;return!1}function em(R,h,U){const W=U[0],K=U[2];if(R.x<W.x&&h.x<W.x||R.x>K.x&&h.x>K.x||R.y<W.y&&h.y<W.y||R.y>K.y&&h.y>K.y)return!1;const Q=Br(R,h,U[0]);return Q!==Br(R,h,U[1])||Q!==Br(R,h,U[2])||Q!==Br(R,h,U[3])}function ou(R,h,U){const W=h.paint.get(R).value;return W.kind==="constant"?W.value:U.programConfigurations.get(h.id).getMaxValue(R)}function Gc(R){return Math.sqrt(R[0]*R[0]+R[1]*R[1])}function kf(R,h,U,W,K){if(!h[0]&&!h[1])return R;const Q=He.convert(h)._mult(K);U==="viewport"&&Q._rotate(-W);const oe=[];for(let ce=0;ce<R.length;ce++)oe.push(R[ce].sub(Q));return oe}function Bf(R,h,U,W){const K=He.convert(R)._mult(W);return h==="viewport"&&K._rotate(-U),K}Vr(od,"CircleBucket",{omit:["layers"]});const tm=new ct({"circle-sort-key":new Ye(Yt.layout_circle["circle-sort-key"])});var rm={paint:new ct({"circle-radius":new Ye(Yt.paint_circle["circle-radius"]),"circle-color":new Ye(Yt.paint_circle["circle-color"]),"circle-blur":new Ye(Yt.paint_circle["circle-blur"]),"circle-opacity":new Ye(Yt.paint_circle["circle-opacity"]),"circle-translate":new Be(Yt.paint_circle["circle-translate"]),"circle-translate-anchor":new Be(Yt.paint_circle["circle-translate-anchor"]),"circle-pitch-scale":new Be(Yt.paint_circle["circle-pitch-scale"]),"circle-pitch-alignment":new Be(Yt.paint_circle["circle-pitch-alignment"]),"circle-stroke-width":new Ye(Yt.paint_circle["circle-stroke-width"]),"circle-stroke-color":new Ye(Yt.paint_circle["circle-stroke-color"]),"circle-stroke-opacity":new Ye(Yt.paint_circle["circle-stroke-opacity"])}),layout:tm};function zf(R,h,U,W,K,Q,oe,ce,fe){if(Q&&R.queryGeometry.isAboveHorizon)return!1;Q&&(fe*=R.pixelToTileUnitsFactor);const pe=R.tileID.canonical,ve=U.projection.upVectorScale(pe,U.center.lat,U.worldSize).metersToTile;for(const Ee of h)for(const we of Ee){const Ae=we.add(ce),Pe=K&&U.elevation?U.elevation.exaggeration()*K.getElevationAt(Ae.x,Ae.y,!0):0,ze=U.projection.projectTilePoint(Ae.x,Ae.y,pe);if(Pe>0){const ot=U.projection.upVector(pe,Ae.x,Ae.y);ze.x+=ot[0]*ve*Pe,ze.y+=ot[1]*ve*Pe,ze.z+=ot[2]*ve*Pe}const Xe=Q?Ae:im(ze.x,ze.y,ze.z,W),at=Q?R.tilespaceRays.map(ot=>am(ot,Pe)):R.queryGeometry.screenGeometry,mt=ps([],[ze.x,ze.y,ze.z,1],W);if(!oe&&Q?fe*=mt[3]/U.cameraToCenterDistance:oe&&!Q&&(fe*=U.cameraToCenterDistance/mt[3]),Q){const ot=Rn((we.y/ri+pe.y)/(1<<pe.z));fe/=U.projection.pixelsPerMeter(ot,1)/Ra(1,ot)}if(Y_(at,Xe,fe))return!0}return!1}function im(R,h,U,W){const K=ps([],[R,h,U,1],W);return new He(K[0]/K[3],K[1]/K[3])}const Nf=tu(0,0,0),nm=tu(0,0,1);function am(R,h){const U=$h();return Nf[2]=h,R.intersectsPlane(Nf,nm,U),new He(U[0],U[1])}class jf extends od{}function Uf(R,{width:h,height:U},W,K){if(K){if(K instanceof Uint8ClampedArray)K=new Uint8Array(K.buffer);else if(K.length!==h*U*W)throw new RangeError("mismatched image size")}else K=new Uint8Array(h*U*W);return R.width=h,R.height=U,R.data=K,R}function Vf(R,h,U){const{width:W,height:K}=h;W===R.width&&K===R.height||(ld(R,h,{x:0,y:0},{x:0,y:0},{width:Math.min(R.width,W),height:Math.min(R.height,K)},U),R.width=W,R.height=K,R.data=h.data)}function ld(R,h,U,W,K,Q){if(K.width===0||K.height===0)return h;if(K.width>R.width||K.height>R.height||U.x>R.width-K.width||U.y>R.height-K.height)throw new RangeError("out of range source coordinates for image copy");if(K.width>h.width||K.height>h.height||W.x>h.width-K.width||W.y>h.height-K.height)throw new RangeError("out of range destination coordinates for image copy");const oe=R.data,ce=h.data;for(let fe=0;fe<K.height;fe++){const pe=((U.y+fe)*R.width+U.x)*Q,ve=((W.y+fe)*h.width+W.x)*Q;for(let Ee=0;Ee<K.width*Q;Ee++)ce[ve+Ee]=oe[pe+Ee]}return h}Vr(jf,"HeatmapBucket",{omit:["layers"]});class oo{constructor(h,U){Uf(this,h,1,U)}resize(h){Vf(this,new oo(h),1)}clone(){return new oo({width:this.width,height:this.height},new Uint8Array(this.data))}static copy(h,U,W,K,Q){ld(h,U,W,K,Q,1)}}class Yn{constructor(h,U){Uf(this,h,4,U)}resize(h){Vf(this,new Yn(h),4)}replace(h,U){U?this.data.set(h):this.data=h instanceof Uint8ClampedArray?new Uint8Array(h.buffer):h}clone(){return new Yn({width:this.width,height:this.height},new Uint8Array(this.data))}static copy(h,U,W,K,Q){ld(h,U,W,K,Q,4)}}Vr(oo,"AlphaImage"),Vr(Yn,"RGBAImage");var om={paint:new ct({"heatmap-radius":new Ye(Yt.paint_heatmap["heatmap-radius"]),"heatmap-weight":new Ye(Yt.paint_heatmap["heatmap-weight"]),"heatmap-intensity":new Be(Yt.paint_heatmap["heatmap-intensity"]),"heatmap-color":new lt(Yt.paint_heatmap["heatmap-color"]),"heatmap-opacity":new Be(Yt.paint_heatmap["heatmap-opacity"])})};function cd(R){const h={},U=R.resolution||256,W=R.clips?R.clips.length:1,K=R.image||new Yn({width:U,height:W}),Q=(oe,ce,fe)=>{h[R.evaluationKey]=fe;const pe=R.expression.evaluate(h);K.data[oe+ce+0]=Math.floor(255*pe.r/pe.a),K.data[oe+ce+1]=Math.floor(255*pe.g/pe.a),K.data[oe+ce+2]=Math.floor(255*pe.b/pe.a),K.data[oe+ce+3]=Math.floor(255*pe.a)};if(R.clips)for(let oe=0,ce=0;oe<W;++oe,ce+=4*U)for(let fe=0,pe=0;fe<U;fe++,pe+=4){const ve=fe/(U-1),{start:Ee,end:we}=R.clips[oe];Q(ce,pe,Ee*(1-ve)+we*ve)}else for(let oe=0,ce=0;oe<U;oe++,ce+=4)Q(0,ce,oe/(U-1));return K}var sm={paint:new ct({"hillshade-illumination-direction":new Be(Yt.paint_hillshade["hillshade-illumination-direction"]),"hillshade-illumination-anchor":new Be(Yt.paint_hillshade["hillshade-illumination-anchor"]),"hillshade-exaggeration":new Be(Yt.paint_hillshade["hillshade-exaggeration"]),"hillshade-shadow-color":new Be(Yt.paint_hillshade["hillshade-shadow-color"]),"hillshade-highlight-color":new Be(Yt.paint_hillshade["hillshade-highlight-color"]),"hillshade-accent-color":new Be(Yt.paint_hillshade["hillshade-accent-color"])})};const um=Dt([{name:"a_pos",components:2,type:"Int16"}],4),{members:lm}=um;var hd={exports:{}};function $c(R,h,U){U=U||2;var W,K,Q,oe,ce,fe,pe,ve=h&&h.length,Ee=ve?h[0]*U:R.length,we=Gf(R,0,Ee,U,!0),Ae=[];if(!we||we.next===we.prev)return Ae;if(ve&&(we=function(ze,Xe,at,mt){var ot,pt,Et,bt=[];for(ot=0,pt=Xe.length;ot<pt;ot++)(Et=Gf(ze,Xe[ot]*mt,ot<pt-1?Xe[ot+1]*mt:ze.length,mt,!1))===Et.next&&(Et.steiner=!0),bt.push(ym(Et));for(bt.sort(pm),ot=0;ot<bt.length;ot++)at=_m(bt[ot],at);return at}(R,h,we,U)),R.length>80*U){W=Q=R[0],K=oe=R[1];for(var Pe=U;Pe<Ee;Pe+=U)(ce=R[Pe])<W&&(W=ce),(fe=R[Pe+1])<K&&(K=fe),ce>Q&&(Q=ce),fe>oe&&(oe=fe);pe=(pe=Math.max(Q-W,oe-K))!==0?32767/pe:0}return Tl(we,Ae,U,W,K,pe,0),Ae}function Gf(R,h,U,W,K){var Q,oe;if(K===pd(R,h,U,W)>0)for(Q=h;Q<U;Q+=W)oe=Hf(Q,R[Q],R[Q+1],oe);else for(Q=U-W;Q>=h;Q-=W)oe=Hf(Q,R[Q],R[Q+1],oe);return oe&&Wc(oe,oe.next)&&(Il(oe),oe=oe.next),oe}function bs(R,h){if(!R)return R;h||(h=R);var U,W=R;do if(U=!1,W.steiner||!Wc(W,W.next)&&dn(W.prev,W,W.next)!==0)W=W.next;else{if(Il(W),(W=h=W.prev)===W.next)break;U=!0}while(U||W!==h);return h}function Tl(R,h,U,W,K,Q,oe){if(R){!oe&&Q&&function(ve,Ee,we,Ae){var Pe=ve;do Pe.z===0&&(Pe.z=dd(Pe.x,Pe.y,Ee,we,Ae)),Pe.prevZ=Pe.prev,Pe.nextZ=Pe.next,Pe=Pe.next;while(Pe!==ve);Pe.prevZ.nextZ=null,Pe.prevZ=null,function(ze){var Xe,at,mt,ot,pt,Et,bt,$t,zt=1;do{for(at=ze,ze=null,pt=null,Et=0;at;){for(Et++,mt=at,bt=0,Xe=0;Xe<zt&&(bt++,mt=mt.nextZ);Xe++);for($t=zt;bt>0||$t>0&&mt;)bt!==0&&($t===0||!mt||at.z<=mt.z)?(ot=at,at=at.nextZ,bt--):(ot=mt,mt=mt.nextZ,$t--),pt?pt.nextZ=ot:ze=ot,ot.prevZ=pt,pt=ot;at=mt}pt.nextZ=null,zt*=2}while(Et>1)}(Pe)}(R,W,K,Q);for(var ce,fe,pe=R;R.prev!==R.next;)if(ce=R.prev,fe=R.next,Q?hm(R,W,K,Q):cm(R))h.push(ce.i/U|0),h.push(R.i/U|0),h.push(fe.i/U|0),Il(R),R=fe.next,pe=fe.next;else if((R=fe)===pe){oe?oe===1?Tl(R=dm(bs(R),h,U),h,U,W,K,Q,2):oe===2&&fm(R,h,U,W,K,Q):Tl(bs(R),h,U,W,K,Q,1);break}}}function cm(R){var h=R.prev,U=R,W=R.next;if(dn(h,U,W)>=0)return!1;for(var K=h.x,Q=U.x,oe=W.x,ce=h.y,fe=U.y,pe=W.y,ve=K<Q?K<oe?K:oe:Q<oe?Q:oe,Ee=ce<fe?ce<pe?ce:pe:fe<pe?fe:pe,we=K>Q?K>oe?K:oe:Q>oe?Q:oe,Ae=ce>fe?ce>pe?ce:pe:fe>pe?fe:pe,Pe=W.next;Pe!==h;){if(Pe.x>=ve&&Pe.x<=we&&Pe.y>=Ee&&Pe.y<=Ae&&su(K,ce,Q,fe,oe,pe,Pe.x,Pe.y)&&dn(Pe.prev,Pe,Pe.next)>=0)return!1;Pe=Pe.next}return!0}function hm(R,h,U,W){var K=R.prev,Q=R,oe=R.next;if(dn(K,Q,oe)>=0)return!1;for(var ce=K.x,fe=Q.x,pe=oe.x,ve=K.y,Ee=Q.y,we=oe.y,Ae=ce<fe?ce<pe?ce:pe:fe<pe?fe:pe,Pe=ve<Ee?ve<we?ve:we:Ee<we?Ee:we,ze=ce>fe?ce>pe?ce:pe:fe>pe?fe:pe,Xe=ve>Ee?ve>we?ve:we:Ee>we?Ee:we,at=dd(Ae,Pe,h,U,W),mt=dd(ze,Xe,h,U,W),ot=R.prevZ,pt=R.nextZ;ot&&ot.z>=at&&pt&&pt.z<=mt;){if(ot.x>=Ae&&ot.x<=ze&&ot.y>=Pe&&ot.y<=Xe&&ot!==K&&ot!==oe&&su(ce,ve,fe,Ee,pe,we,ot.x,ot.y)&&dn(ot.prev,ot,ot.next)>=0||(ot=ot.prevZ,pt.x>=Ae&&pt.x<=ze&&pt.y>=Pe&&pt.y<=Xe&&pt!==K&&pt!==oe&&su(ce,ve,fe,Ee,pe,we,pt.x,pt.y)&&dn(pt.prev,pt,pt.next)>=0))return!1;pt=pt.nextZ}for(;ot&&ot.z>=at;){if(ot.x>=Ae&&ot.x<=ze&&ot.y>=Pe&&ot.y<=Xe&&ot!==K&&ot!==oe&&su(ce,ve,fe,Ee,pe,we,ot.x,ot.y)&&dn(ot.prev,ot,ot.next)>=0)return!1;ot=ot.prevZ}for(;pt&&pt.z<=mt;){if(pt.x>=Ae&&pt.x<=ze&&pt.y>=Pe&&pt.y<=Xe&&pt!==K&&pt!==oe&&su(ce,ve,fe,Ee,pe,we,pt.x,pt.y)&&dn(pt.prev,pt,pt.next)>=0)return!1;pt=pt.nextZ}return!0}function dm(R,h,U){var W=R;do{var K=W.prev,Q=W.next.next;!Wc(K,Q)&&$f(K,W,W.next,Q)&&ql(K,Q)&&ql(Q,K)&&(h.push(K.i/U|0),h.push(W.i/U|0),h.push(Q.i/U|0),Il(W),Il(W.next),W=R=Q),W=W.next}while(W!==R);return bs(W)}function fm(R,h,U,W,K,Q){var oe=R;do{for(var ce=oe.next.next;ce!==oe.prev;){if(oe.i!==ce.i&&gm(oe,ce)){var fe=Wf(oe,ce);return oe=bs(oe,oe.next),fe=bs(fe,fe.next),Tl(oe,h,U,W,K,Q,0),void Tl(fe,h,U,W,K,Q,0)}ce=ce.next}oe=oe.next}while(oe!==R)}function pm(R,h){return R.x-h.x}function _m(R,h){var U=function(K,Q){var oe,ce=Q,fe=K.x,pe=K.y,ve=-1/0;do{if(pe<=ce.y&&pe>=ce.next.y&&ce.next.y!==ce.y){var Ee=ce.x+(pe-ce.y)*(ce.next.x-ce.x)/(ce.next.y-ce.y);if(Ee<=fe&&Ee>ve&&(ve=Ee,oe=ce.x<ce.next.x?ce:ce.next,Ee===fe))return oe}ce=ce.next}while(ce!==Q);if(!oe)return null;var we,Ae=oe,Pe=oe.x,ze=oe.y,Xe=1/0;ce=oe;do fe>=ce.x&&ce.x>=Pe&&fe!==ce.x&&su(pe<ze?fe:ve,pe,Pe,ze,pe<ze?ve:fe,pe,ce.x,ce.y)&&(we=Math.abs(pe-ce.y)/(fe-ce.x),ql(ce,K)&&(we<Xe||we===Xe&&(ce.x>oe.x||ce.x===oe.x&&mm(oe,ce)))&&(oe=ce,Xe=we)),ce=ce.next;while(ce!==Ae);return oe}(R,h);if(!U)return h;var W=Wf(U,R);return bs(W,W.next),bs(U,U.next)}function mm(R,h){return dn(R.prev,R,h.prev)<0&&dn(h.next,R,R.next)<0}function dd(R,h,U,W,K){return(R=1431655765&((R=858993459&((R=252645135&((R=16711935&((R=(R-U)*K|0)|R<<8))|R<<4))|R<<2))|R<<1))|(h=1431655765&((h=858993459&((h=252645135&((h=16711935&((h=(h-W)*K|0)|h<<8))|h<<4))|h<<2))|h<<1))<<1}function ym(R){var h=R,U=R;do(h.x<U.x||h.x===U.x&&h.y<U.y)&&(U=h),h=h.next;while(h!==R);return U}function su(R,h,U,W,K,Q,oe,ce){return(K-oe)*(h-ce)>=(R-oe)*(Q-ce)&&(R-oe)*(W-ce)>=(U-oe)*(h-ce)&&(U-oe)*(Q-ce)>=(K-oe)*(W-ce)}function gm(R,h){return R.next.i!==h.i&&R.prev.i!==h.i&&!function(U,W){var K=U;do{if(K.i!==U.i&&K.next.i!==U.i&&K.i!==W.i&&K.next.i!==W.i&&$f(K,K.next,U,W))return!0;K=K.next}while(K!==U);return!1}(R,h)&&(ql(R,h)&&ql(h,R)&&function(U,W){var K=U,Q=!1,oe=(U.x+W.x)/2,ce=(U.y+W.y)/2;do K.y>ce!=K.next.y>ce&&K.next.y!==K.y&&oe<(K.next.x-K.x)*(ce-K.y)/(K.next.y-K.y)+K.x&&(Q=!Q),K=K.next;while(K!==U);return Q}(R,h)&&(dn(R.prev,R,h.prev)||dn(R,h.prev,h))||Wc(R,h)&&dn(R.prev,R,R.next)>0&&dn(h.prev,h,h.next)>0)}function dn(R,h,U){return(h.y-R.y)*(U.x-h.x)-(h.x-R.x)*(U.y-h.y)}function Wc(R,h){return R.x===h.x&&R.y===h.y}function $f(R,h,U,W){var K=Zc(dn(R,h,U)),Q=Zc(dn(R,h,W)),oe=Zc(dn(U,W,R)),ce=Zc(dn(U,W,h));return K!==Q&&oe!==ce||!(K!==0||!Hc(R,U,h))||!(Q!==0||!Hc(R,W,h))||!(oe!==0||!Hc(U,R,W))||!(ce!==0||!Hc(U,h,W))}function Hc(R,h,U){return h.x<=Math.max(R.x,U.x)&&h.x>=Math.min(R.x,U.x)&&h.y<=Math.max(R.y,U.y)&&h.y>=Math.min(R.y,U.y)}function Zc(R){return R>0?1:R<0?-1:0}function ql(R,h){return dn(R.prev,R,R.next)<0?dn(R,h,R.next)>=0&&dn(R,R.prev,h)>=0:dn(R,h,R.prev)<0||dn(R,R.next,h)<0}function Wf(R,h){var U=new fd(R.i,R.x,R.y),W=new fd(h.i,h.x,h.y),K=R.next,Q=h.prev;return R.next=h,h.prev=R,U.next=K,K.prev=U,W.next=U,U.prev=W,Q.next=W,W.prev=Q,W}function Hf(R,h,U,W){var K=new fd(R,h,U);return W?(K.next=W.next,K.prev=W,W.next.prev=K,W.next=K):(K.prev=K,K.next=K),K}function Il(R){R.next.prev=R.prev,R.prev.next=R.next,R.prevZ&&(R.prevZ.nextZ=R.nextZ),R.nextZ&&(R.nextZ.prevZ=R.prevZ)}function fd(R,h,U){this.i=R,this.x=h,this.y=U,this.prev=null,this.next=null,this.z=0,this.prevZ=null,this.nextZ=null,this.steiner=!1}function pd(R,h,U,W){for(var K=0,Q=h,oe=U-W;Q<U;Q+=W)K+=(R[oe]-R[Q])*(R[Q+1]+R[oe+1]),oe=Q;return K}hd.exports=$c,hd.exports.default=$c,$c.deviation=function(R,h,U,W){var K=h&&h.length,Q=Math.abs(pd(R,0,K?h[0]*U:R.length,U));if(K)for(var oe=0,ce=h.length;oe<ce;oe++)Q-=Math.abs(pd(R,h[oe]*U,oe<ce-1?h[oe+1]*U:R.length,U));var fe=0;for(oe=0;oe<W.length;oe+=3){var pe=W[oe]*U,ve=W[oe+1]*U,Ee=W[oe+2]*U;fe+=Math.abs((R[pe]-R[Ee])*(R[ve+1]-R[pe+1])-(R[pe]-R[ve])*(R[Ee+1]-R[pe+1]))}return Q===0&&fe===0?0:Math.abs((fe-Q)/Q)},$c.flatten=function(R){for(var h=R[0][0].length,U={vertices:[],holes:[],dimensions:h},W=0,K=0;K<R.length;K++){for(var Q=0;Q<R[K].length;Q++)for(var oe=0;oe<h;oe++)U.vertices.push(R[K][Q][oe]);K>0&&U.holes.push(W+=R[K-1].length)}return U};var _d=Le(hd.exports);function vm(R,h,U,W,K){Zf(R,h,U,W||R.length-1,K||bm)}function Zf(R,h,U,W,K){for(;W>U;){if(W-U>600){var Q=W-U+1,oe=h-U+1,ce=Math.log(Q),fe=.5*Math.exp(2*ce/3),pe=.5*Math.sqrt(ce*fe*(Q-fe)/Q)*(oe-Q/2<0?-1:1);Zf(R,h,Math.max(U,Math.floor(h-oe*fe/Q+pe)),Math.min(W,Math.floor(h+(Q-oe)*fe/Q+pe)),K)}var ve=R[h],Ee=U,we=W;for(Al(R,U,h),K(R[W],ve)>0&&Al(R,U,W);Ee<we;){for(Al(R,Ee,we),Ee++,we--;K(R[Ee],ve)<0;)Ee++;for(;K(R[we],ve)>0;)we--}K(R[U],ve)===0?Al(R,U,we):Al(R,++we,W),we<=h&&(U=we+1),h<=we&&(W=we-1)}}function Al(R,h,U){var W=R[h];R[h]=R[U],R[U]=W}function bm(R,h){return R<h?-1:R>h?1:0}function md(R,h){const U=R.length;if(U<=1)return[R];const W=[];let K,Q;for(let oe=0;oe<U;oe++){const ce=li(R[oe]);ce!==0&&(R[oe].area=Math.abs(ce),Q===void 0&&(Q=ce<0),Q===ce<0?(K&&W.push(K),K=[R[oe]]):K.push(R[oe]))}if(K&&W.push(K),h>1)for(let oe=0;oe<W.length;oe++)W[oe].length<=h||(vm(W[oe],h,1,W[oe].length-1,xm),W[oe]=W[oe].slice(0,h));return W}function xm(R,h){return h.area-R.area}function yd(R,h,U){const W=U.patternDependencies;let K=!1;for(const Q of h){const oe=Q.paint.get(`${R}-pattern`);oe.isConstant()||(K=!0);const ce=oe.constantOr(null);ce&&(K=!0,W[ce]=!0)}return K}function gd(R,h,U,W,K){const Q=K.patternDependencies;for(const oe of h){const ce=oe.paint.get(`${R}-pattern`).value;if(ce.kind!=="constant"){let fe=ce.evaluate({zoom:W},U,{},K.availableImages);fe=fe&&fe.name?fe.name:fe,Q[fe]=!0,U.patterns[oe.id]=fe}}return U}class Kc{constructor(h){this.zoom=h.zoom,this.overscaling=h.overscaling,this.layers=h.layers,this.layerIds=this.layers.map(U=>U.id),this.index=h.index,this.hasPattern=!1,this.patternFeatures=[],this.layoutVertexArray=new mr,this.indexArray=new Zr,this.indexArray2=new bn,this.programConfigurations=new hs(h.layers,h.zoom),this.segments=new hn,this.segments2=new hn,this.stateDependentLayerIds=this.layers.filter(U=>U.isStateDependent()).map(U=>U.id),this.projection=h.projection}populate(h,U,W,K){this.hasPattern=yd("fill",this.layers,U);const Q=this.layers[0].layout.get("fill-sort-key"),oe=[];for(const{feature:ce,id:fe,index:pe,sourceLayerIndex:ve}of h){const Ee=this.layers[0]._featureFilter.needGeometry,we=gs(ce,Ee);if(!this.layers[0]._featureFilter.filter(new be(this.zoom),we,W))continue;const Ae=Q?Q.evaluate(we,{},W,U.availableImages):void 0,Pe={id:fe,properties:ce.properties,type:ce.type,sourceLayerIndex:ve,index:pe,geometry:Ee?we.geometry:ao(ce,W,K),patterns:{},sortKey:Ae};oe.push(Pe)}Q&&oe.sort((ce,fe)=>ce.sortKey-fe.sortKey);for(const ce of oe){const{geometry:fe,index:pe,sourceLayerIndex:ve}=ce;if(this.hasPattern){const Ee=gd("fill",this.layers,ce,this.zoom,U);this.patternFeatures.push(Ee)}else this.addFeature(ce,fe,pe,W,{},U.availableImages);U.featureIndex.insert(h[pe].feature,fe,pe,ve,this.index)}}update(h,U,W,K){this.stateDependentLayers.length&&this.programConfigurations.updatePaintArrays(h,U,this.stateDependentLayers,W,K)}addFeatures(h,U,W,K,Q){for(const oe of this.patternFeatures)this.addFeature(oe,oe.geometry,oe.index,U,W,K)}isEmpty(){return this.layoutVertexArray.length===0}uploadPending(){return!this.uploaded||this.programConfigurations.needsUpload}upload(h){this.uploaded||(this.layoutVertexBuffer=h.createVertexBuffer(this.layoutVertexArray,lm),this.indexBuffer=h.createIndexBuffer(this.indexArray),this.indexBuffer2=h.createIndexBuffer(this.indexArray2)),this.programConfigurations.upload(h),this.uploaded=!0}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.indexBuffer2.destroy(),this.programConfigurations.destroy(),this.segments.destroy(),this.segments2.destroy())}addFeature(h,U,W,K,Q,oe=[]){for(const ce of md(U,500)){let fe=0;for(const Pe of ce)fe+=Pe.length;const pe=this.segments.prepareSegment(fe,this.layoutVertexArray,this.indexArray),ve=pe.vertexLength,Ee=[],we=[];for(const Pe of ce){if(Pe.length===0)continue;Pe!==ce[0]&&we.push(Ee.length/2);const ze=this.segments2.prepareSegment(Pe.length,this.layoutVertexArray,this.indexArray2),Xe=ze.vertexLength;this.layoutVertexArray.emplaceBack(Pe[0].x,Pe[0].y),this.indexArray2.emplaceBack(Xe+Pe.length-1,Xe),Ee.push(Pe[0].x),Ee.push(Pe[0].y);for(let at=1;at<Pe.length;at++)this.layoutVertexArray.emplaceBack(Pe[at].x,Pe[at].y),this.indexArray2.emplaceBack(Xe+at-1,Xe+at),Ee.push(Pe[at].x),Ee.push(Pe[at].y);ze.vertexLength+=Pe.length,ze.primitiveLength+=Pe.length}const Ae=_d(Ee,we);for(let Pe=0;Pe<Ae.length;Pe+=3)this.indexArray.emplaceBack(ve+Ae[Pe],ve+Ae[Pe+1],ve+Ae[Pe+2]);pe.vertexLength+=fe,pe.primitiveLength+=Ae.length/3}this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,h,W,Q,oe,K)}}Vr(Kc,"FillBucket",{omit:["layers","patternFeatures"]});const Em=new ct({"fill-sort-key":new Ye(Yt.layout_fill["fill-sort-key"])});var wm={paint:new ct({"fill-antialias":new Be(Yt.paint_fill["fill-antialias"]),"fill-opacity":new Ye(Yt.paint_fill["fill-opacity"]),"fill-color":new Ye(Yt.paint_fill["fill-color"]),"fill-outline-color":new Ye(Yt.paint_fill["fill-outline-color"]),"fill-translate":new Be(Yt.paint_fill["fill-translate"]),"fill-translate-anchor":new Be(Yt.paint_fill["fill-translate-anchor"]),"fill-pattern":new Ye(Yt.paint_fill["fill-pattern"])}),layout:Em};const Sm=Dt([{name:"a_pos_normal_ed",components:4,type:"Int16"}]),Tm=Dt([{name:"a_centroid_pos",components:2,type:"Uint16"}]),qm=Dt([{name:"a_pos_3",components:3,type:"Int16"},{name:"a_pos_normal_3",components:3,type:"Int16"}]),{members:Im}=Sm;var Xc={},Am=We,Kf=uu;function uu(R,h,U,W,K){this.properties={},this.extent=U,this.type=0,this._pbf=R,this._geometry=-1,this._keys=W,this._values=K,R.readFields(Rm,this,h)}function Rm(R,h,U){R==1?h.id=U.readVarint():R==2?function(W,K){for(var Q=W.readVarint()+W.pos;W.pos<Q;){var oe=K._keys[W.readVarint()],ce=K._values[W.readVarint()];K.properties[oe]=ce}}(U,h):R==3?h.type=U.readVarint():R==4&&(h._geometry=U.pos)}function Om(R){for(var h,U,W=0,K=0,Q=R.length,oe=Q-1;K<Q;oe=K++)W+=((U=R[oe]).x-(h=R[K]).x)*(h.y+U.y);return W}uu.types=["Unknown","Point","LineString","Polygon"],uu.prototype.loadGeometry=function(){var R=this._pbf;R.pos=this._geometry;for(var h,U=R.readVarint()+R.pos,W=1,K=0,Q=0,oe=0,ce=[];R.pos<U;){if(K<=0){var fe=R.readVarint();W=7&fe,K=fe>>3}if(K--,W===1||W===2)Q+=R.readSVarint(),oe+=R.readSVarint(),W===1&&(h&&ce.push(h),h=[]),h.push(new Am(Q,oe));else{if(W!==7)throw new Error("unknown command "+W);h&&h.push(h[0].clone())}}return h&&ce.push(h),ce},uu.prototype.bbox=function(){var R=this._pbf;R.pos=this._geometry;for(var h=R.readVarint()+R.pos,U=1,W=0,K=0,Q=0,oe=1/0,ce=-1/0,fe=1/0,pe=-1/0;R.pos<h;){if(W<=0){var ve=R.readVarint();U=7&ve,W=ve>>3}if(W--,U===1||U===2)(K+=R.readSVarint())<oe&&(oe=K),K>ce&&(ce=K),(Q+=R.readSVarint())<fe&&(fe=Q),Q>pe&&(pe=Q);else if(U!==7)throw new Error("unknown command "+U)}return[oe,fe,ce,pe]},uu.prototype.toGeoJSON=function(R,h,U){var W,K,Q=this.extent*Math.pow(2,U),oe=this.extent*R,ce=this.extent*h,fe=this.loadGeometry(),pe=uu.types[this.type];function ve(Ae){for(var Pe=0;Pe<Ae.length;Pe++){var ze=Ae[Pe];Ae[Pe]=[360*(ze.x+oe)/Q-180,360/Math.PI*Math.atan(Math.exp((180-360*(ze.y+ce)/Q)*Math.PI/180))-90]}}switch(this.type){case 1:var Ee=[];for(W=0;W<fe.length;W++)Ee[W]=fe[W][0];ve(fe=Ee);break;case 2:for(W=0;W<fe.length;W++)ve(fe[W]);break;case 3:for(fe=function(Ae){var Pe=Ae.length;if(Pe<=1)return[Ae];for(var ze,Xe,at=[],mt=0;mt<Pe;mt++){var ot=Om(Ae[mt]);ot!==0&&(Xe===void 0&&(Xe=ot<0),Xe===ot<0?(ze&&at.push(ze),ze=[Ae[mt]]):ze.push(Ae[mt]))}return ze&&at.push(ze),at}(fe),W=0;W<fe.length;W++)for(K=0;K<fe[W].length;K++)ve(fe[W][K])}fe.length===1?fe=fe[0]:pe="Multi"+pe;var we={type:"Feature",geometry:{type:pe,coordinates:fe},properties:this.properties};return"id"in this&&(we.id=this.id),we};var Cm=Kf,Xf=Yf;function Yf(R,h){this.version=1,this.name=null,this.extent=4096,this.length=0,this._pbf=R,this._keys=[],this._values=[],this._features=[],R.readFields(Pm,this,h),this.length=this._features.length}function Pm(R,h,U){R===15?h.version=U.readVarint():R===1?h.name=U.readString():R===5?h.extent=U.readVarint():R===2?h._features.push(U.pos):R===3?h._keys.push(U.readString()):R===4&&h._values.push(function(W){for(var K=null,Q=W.readVarint()+W.pos;W.pos<Q;){var oe=W.readVarint()>>3;K=oe===1?W.readString():oe===2?W.readFloat():oe===3?W.readDouble():oe===4?W.readVarint64():oe===5?W.readVarint():oe===6?W.readSVarint():oe===7?W.readBoolean():null}return K}(U))}Yf.prototype.feature=function(R){if(R<0||R>=this._features.length)throw new Error("feature index out of bounds");this._pbf.pos=this._features[R];var h=this._pbf.readVarint()+this._pbf.pos;return new Cm(this._pbf,h,this.extent,this._keys,this._values)};var Mm=Xf;function Dm(R,h,U){if(R===3){var W=new Mm(U,U.readVarint()+U.pos);W.length&&(h[W.name]=W)}}var vd=Xc.VectorTile=function(R,h){this.layers=R.readFields(Dm,{},h)},Yc=Xc.VectorTileFeature=Kf;function Jc(R,h,U,W){const K=[],Q=W===0?(oe,ce,fe,pe,ve,Ee)=>{oe.push(new He(Ee,fe+(Ee-ce)/(pe-ce)*(ve-fe)))}:(oe,ce,fe,pe,ve,Ee)=>{oe.push(new He(ce+(Ee-fe)/(ve-fe)*(pe-ce),Ee))};for(const oe of R){const ce=[];for(const fe of oe){if(fe.length<=2)continue;const pe=[];for(let we=0;we<fe.length-1;we++){const Ae=fe[we].x,Pe=fe[we].y,ze=fe[we+1].x,Xe=fe[we+1].y,at=W===0?Ae:Pe,mt=W===0?ze:Xe;at<h?mt>h&&Q(pe,Ae,Pe,ze,Xe,h):at>U?mt<U&&Q(pe,Ae,Pe,ze,Xe,U):pe.push(fe[we]),mt<h&&at>=h&&Q(pe,Ae,Pe,ze,Xe,h),mt>U&&at<=U&&Q(pe,Ae,Pe,ze,Xe,U)}let ve=fe[fe.length-1];const Ee=W===0?ve.x:ve.y;Ee>=h&&Ee<=U&&pe.push(ve),pe.length&&(ve=pe[pe.length-1],pe[0].x===ve.x&&pe[0].y===ve.y||pe.push(pe[0]),ce.push(pe))}ce.length&&K.push(ce)}return K}Xc.VectorTileLayer=Xf;const Lm=Yc.types,Fm=Math.pow(2,13);function Rl(R,h,U,W,K,Q,oe,ce){R.emplaceBack((h<<1)+oe,(U<<1)+Q,(Math.floor(W*Fm)<<1)+K,Math.round(ce))}function Ol(R,h,U){R.emplaceBack(h.x,h.y,h.z,U[0]*16384,U[1]*16384,U[2]*16384)}class Jf{constructor(){this.acc=new He(0,0),this.polyCount=[]}startRing(h){this.currentPolyCount={edges:0,top:0},this.polyCount.push(this.currentPolyCount),this.min||(this.min=new He(h.x,h.y),this.max=new He(h.x,h.y))}append(h,U){this.currentPolyCount.edges++,this.acc._add(h);const W=this.min,K=this.max;h.x<W.x?W.x=h.x:h.x>K.x&&(K.x=h.x),h.y<W.y?W.y=h.y:h.y>K.y&&(K.y=h.y),((h.x===0||h.x===ri)&&h.x===U.x)!=((h.y===0||h.y===ri)&&h.y===U.y)&&this.processBorderOverlap(h,U),U.x<0!=h.x<0&&this.addBorderIntersection(0,Ti(U.y,h.y,(0-U.x)/(h.x-U.x))),U.x>ri!=h.x>ri&&this.addBorderIntersection(1,Ti(U.y,h.y,(ri-U.x)/(h.x-U.x))),U.y<0!=h.y<0&&this.addBorderIntersection(2,Ti(U.x,h.x,(0-U.y)/(h.y-U.y))),U.y>ri!=h.y>ri&&this.addBorderIntersection(3,Ti(U.x,h.x,(ri-U.y)/(h.y-U.y)))}addBorderIntersection(h,U){this.borders||(this.borders=[[Number.MAX_VALUE,-Number.MAX_VALUE],[Number.MAX_VALUE,-Number.MAX_VALUE],[Number.MAX_VALUE,-Number.MAX_VALUE],[Number.MAX_VALUE,-Number.MAX_VALUE]]);const W=this.borders[h];U<W[0]&&(W[0]=U),U>W[1]&&(W[1]=U)}processBorderOverlap(h,U){if(h.x===U.x){if(h.y===U.y)return;const W=h.x===0?0:1;this.addBorderIntersection(W,U.y),this.addBorderIntersection(W,h.y)}else{const W=h.y===0?2:3;this.addBorderIntersection(W,U.x),this.addBorderIntersection(W,h.x)}}centroid(){const h=this.polyCount.reduce((U,W)=>U+W.edges,0);return h!==0?this.acc.div(h)._round():new He(0,0)}span(){return new He(this.max.x-this.min.x,this.max.y-this.min.y)}intersectsCount(){return this.borders.reduce((h,U)=>h+ +(U[0]!==Number.MAX_VALUE),0)}}class Cl{constructor(h){this.zoom=h.zoom,this.canonical=h.canonical,this.overscaling=h.overscaling,this.layers=h.layers,this.layerIds=this.layers.map(U=>U.id),this.index=h.index,this.hasPattern=!1,this.edgeRadius=0,this.projection=h.projection,this.layoutVertexArray=new nr,this.centroidVertexArray=new Sa,this.indexArray=new Zr,this.programConfigurations=new hs(h.layers,h.zoom),this.segments=new hn,this.stateDependentLayerIds=this.layers.filter(U=>U.isStateDependent()).map(U=>U.id),this.enableTerrain=h.enableTerrain}populate(h,U,W,K){this.features=[],this.hasPattern=yd("fill-extrusion",this.layers,U),this.featuresOnBorder=[],this.borders=[[],[],[],[]],this.borderDoneWithNeighborZ=[-1,-1,-1,-1],this.tileToMeter=function(Q){const oe=Math.exp(Math.PI*(1-Q.y/(1<<Q.z)*2));return 80150034*oe/(oe*oe+1)/ri/(1<<Q.z)}(W),this.edgeRadius=this.layers[0].layout.get("fill-extrusion-edge-radius")/this.tileToMeter;for(const{feature:Q,id:oe,index:ce,sourceLayerIndex:fe}of h){const pe=this.layers[0]._featureFilter.needGeometry,ve=gs(Q,pe);if(!this.layers[0]._featureFilter.filter(new be(this.zoom),ve,W))continue;const Ee={id:oe,sourceLayerIndex:fe,index:ce,geometry:pe?ve.geometry:ao(Q,W,K),properties:Q.properties,type:Q.type,patterns:{}},we=this.layoutVertexArray.length;this.hasPattern?this.features.push(gd("fill-extrusion",this.layers,Ee,this.zoom,U)):this.addFeature(Ee,Ee.geometry,ce,W,{},U.availableImages,K),U.featureIndex.insert(Q,Ee.geometry,ce,fe,this.index,we)}this.sortBorders()}addFeatures(h,U,W,K,Q){for(const oe of this.features){const{geometry:ce}=oe;this.addFeature(oe,ce,oe.index,U,W,K,Q)}this.sortBorders()}update(h,U,W,K){this.stateDependentLayers.length&&this.programConfigurations.updatePaintArrays(h,U,this.stateDependentLayers,W,K)}isEmpty(){return this.layoutVertexArray.length===0}uploadPending(){return!this.uploaded||this.programConfigurations.needsUpload}upload(h){this.uploaded||(this.layoutVertexBuffer=h.createVertexBuffer(this.layoutVertexArray,Im),this.indexBuffer=h.createIndexBuffer(this.indexArray),this.layoutVertexExtArray&&(this.layoutVertexExtBuffer=h.createVertexBuffer(this.layoutVertexExtArray,qm.members,!0))),this.programConfigurations.upload(h),this.uploaded=!0}uploadCentroid(h){this.centroidVertexArray.length!==0&&(this.centroidVertexBuffer?this.needsCentroidUpdate&&this.centroidVertexBuffer.updateData(this.centroidVertexArray):this.centroidVertexBuffer=h.createVertexBuffer(this.centroidVertexArray,Tm.members,!0),this.needsCentroidUpdate=!1)}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.centroidVertexBuffer&&this.centroidVertexBuffer.destroy(),this.layoutVertexExtBuffer&&this.layoutVertexExtBuffer.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy())}addFeature(h,U,W,K,Q,oe,ce){const fe=[new He(0,0),new He(ri,ri)],pe=ce.projection,ve=pe.name==="globe",Ee=this.enableTerrain&&!ve?new Jf:null,we=Lm[h.type]==="Polygon";ve&&!this.layoutVertexExtArray&&(this.layoutVertexExtArray=new gr);const Ae=md(U,500);for(let at=Ae.length-1;at>=0;at--){const mt=Ae[at];(mt.length===0||(Pe=mt[0]).every(ot=>ot.x<=0)||Pe.every(ot=>ot.x>=ri)||Pe.every(ot=>ot.y<=0)||Pe.every(ot=>ot.y>=ri))&&Ae.splice(at,1)}var Pe;let ze;if(ve)ze=ap(Ae,fe,K);else{ze=[];for(const at of Ae)ze.push({polygon:at,bounds:fe})}const Xe=we?this.edgeRadius:0;for(const{polygon:at,bounds:mt}of ze){let ot=0,pt=0;for(const bt of at)we&&!bt[0].equals(bt[bt.length-1])&&bt.push(bt[0]),pt+=we?bt.length-1:bt.length;const Et=this.segments.prepareSegment((we?5:4)*pt,this.layoutVertexArray,this.indexArray);if(we){const bt=[],$t=[];ot=Et.vertexLength;for(const rr of at){let yr,Zt;rr.length&&rr!==at[0]&&$t.push(bt.length/2),yr=rr[1].sub(rr[0])._perp()._unit();for(let ar=1;ar<rr.length;ar++){const or=rr[ar],hr=rr[ar===rr.length-1?1:ar+1];let{x:Sr,y:Jt}=or;if(Xe){Zt=hr.sub(or)._perp()._unit();const Cr=yr.add(Zt)._unit(),$r=Xe*Math.min(4,1/(yr.x*Cr.x+yr.y*Cr.y));Sr+=$r*Cr.x,Jt+=$r*Cr.y,yr=Zt}Rl(this.layoutVertexArray,Sr,Jt,0,0,1,1,0),Et.vertexLength++,bt.push(or.x,or.y),ve&&Ol(this.layoutVertexExtArray,pe.projectTilePoint(Sr,Jt,K),pe.upVector(K,Sr,Jt))}}const zt=_d(bt,$t);for(let rr=0;rr<zt.length;rr+=3)this.indexArray.emplaceBack(ot+zt[rr],ot+zt[rr+2],ot+zt[rr+1]),Et.primitiveLength++}for(const bt of at){Ee&&bt.length&&Ee.startRing(bt[0]);let $t,zt,rr,yr=bt.length>4&&rp(bt[bt.length-2],bt[0],bt[1]),Zt=Xe?km(bt[bt.length-2],bt[0],bt[1],Xe):0;zt=bt[1].sub(bt[0])._perp()._unit();let ar=!0;for(let or=1,hr=0;or<bt.length;or++){let Sr=bt[or-1],Jt=bt[or];const Cr=bt[or===bt.length-1?1:or+1];if(Ee&&we&&Ee.currentPolyCount.top++,tp(Jt,Sr,mt)){Xe&&(zt=Cr.sub(Jt)._perp()._unit(),ar=!ar);continue}Ee&&Ee.append(Jt,Sr);const $r=Jt.sub(Sr)._perp(),Pr=$r.x/(Math.abs($r.x)+Math.abs($r.y)),di=$r.y>0?1:0,Tr=Sr.dist(Jt);if(hr+Tr>32768&&(hr=0),Xe){rr=Cr.sub(Jt)._perp()._unit();let pi=ep(Sr,Jt,Cr,Qf(zt,rr),Xe);isNaN(pi)&&(pi=0);const ai=Jt.sub(Sr)._unit();Sr=Sr.add(ai.mult(Zt))._round(),Jt=Jt.add(ai.mult(-pi))._round(),Zt=pi,zt=rr}const ei=Et.vertexLength,fi=bt.length>4&&rp(Sr,Jt,Cr);let Ii=ip(hr,yr,ar);if(Rl(this.layoutVertexArray,Sr.x,Sr.y,Pr,di,0,0,Ii),Rl(this.layoutVertexArray,Sr.x,Sr.y,Pr,di,0,1,Ii),hr+=Tr,Ii=ip(hr,fi,!ar),yr=fi,Rl(this.layoutVertexArray,Jt.x,Jt.y,Pr,di,0,0,Ii),Rl(this.layoutVertexArray,Jt.x,Jt.y,Pr,di,0,1,Ii),Et.vertexLength+=4,this.indexArray.emplaceBack(ei+0,ei+1,ei+2),this.indexArray.emplaceBack(ei+1,ei+3,ei+2),Et.primitiveLength+=2,Xe){const pi=ot+(or===1?bt.length-2:or-2),ai=or===1?ot:pi+1;if(this.indexArray.emplaceBack(ei+1,pi,ei+3),this.indexArray.emplaceBack(pi,ai,ei+3),Et.primitiveLength+=2,$t===void 0&&($t=ei),!tp(Cr,bt[or],mt)){const Wi=or===bt.length-1?$t:Et.vertexLength;this.indexArray.emplaceBack(ei+2,ei+3,Wi),this.indexArray.emplaceBack(ei+3,Wi+1,Wi),this.indexArray.emplaceBack(ei+3,ai,Wi+1),Et.primitiveLength+=3}ar=!ar}if(ve){const pi=this.layoutVertexExtArray,ai=pe.projectTilePoint(Sr.x,Sr.y,K),Wi=pe.projectTilePoint(Jt.x,Jt.y,K),_i=pe.upVector(K,Sr.x,Sr.y),mi=pe.upVector(K,Jt.x,Jt.y);Ol(pi,ai,_i),Ol(pi,ai,_i),Ol(pi,Wi,mi),Ol(pi,Wi,mi)}}we&&(ot+=bt.length-1)}}if(Ee&&Ee.polyCount.length>0){if(Ee.borders){Ee.vertexArrayOffset=this.centroidVertexArray.length;const at=Ee.borders,mt=this.featuresOnBorder.push(Ee)-1;for(let ot=0;ot<4;ot++)at[ot][0]!==Number.MAX_VALUE&&this.borders[ot].push(mt)}this.encodeCentroid(Ee.borders?void 0:Ee.centroid(),Ee)}this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,h,W,Q,oe,K)}sortBorders(){for(let h=0;h<4;h++)this.borders[h].sort((U,W)=>this.featuresOnBorder[U].borders[h][0]-this.featuresOnBorder[W].borders[h][0])}encodeCentroid(h,U,W=!0){let K,Q;if(h)if(h.y!==0){const ce=U.span()._mult(this.tileToMeter);K=(Math.max(h.x,1)<<3)+Math.min(7,Math.round(ce.x/10)),Q=(Math.max(h.y,1)<<3)+Math.min(7,Math.round(ce.y/10))}else K=Math.ceil(7*(h.x+450)),Q=0;else K=0,Q=+W;let oe=W?this.centroidVertexArray.length:U.vertexArrayOffset;for(const ce of U.polyCount){W&&this.centroidVertexArray.resize(this.centroidVertexArray.length+4*ce.edges+ce.top);for(let fe=0;fe<ce.top;fe++)this.centroidVertexArray.emplace(oe++,K,Q);for(let fe=0;fe<2*ce.edges;fe++)this.centroidVertexArray.emplace(oe++,0,Q),this.centroidVertexArray.emplace(oe++,K,Q)}}}function Qf(R,h){const U=R.add(h)._unit();return R.x*U.x+R.y*U.y}function km(R,h,U,W){const K=h.sub(R)._perp()._unit(),Q=U.sub(h)._perp()._unit();return ep(R,h,U,Qf(K,Q),W)}function ep(R,h,U,W,K){const Q=Math.sqrt(1-W*W);return Math.min(R.dist(h)/3,h.dist(U)/3,K*Q/W)}function tp(R,h,U){return R.x<U[0].x&&h.x<U[0].x||R.x>U[1].x&&h.x>U[1].x||R.y<U[0].y&&h.y<U[0].y||R.y>U[1].y&&h.y>U[1].y}function rp(R,h,U){if(R.x<0||R.x>=ri||h.x<0||h.x>=ri||U.x<0||U.x>=ri)return!1;const W=U.sub(h),K=W.perp(),Q=R.sub(h);return(W.x*Q.x+W.y*Q.y)/Math.sqrt((W.x*W.x+W.y*W.y)*(Q.x*Q.x+Q.y*Q.y))>-.866&&K.x*Q.x+K.y*Q.y<0}function ip(R,h,U){const W=h?2|R:-3&R;return U?1|W:-2&W}function np(){const R=Math.PI/32,h=Math.tan(R),U=Sl;return U*Math.sqrt(1+2*h*h)-U}function ap(R,h,U){const W=1<<U.z,K=aa(U.x/W),Q=aa((U.x+1)/W),oe=Rn(U.y/W),ce=Rn((U.y+1)/W);return function(fe,pe,ve,Ee,we=0,Ae){const Pe=[];if(!fe.length||!ve||!Ee)return Pe;const ze=(bt,$t)=>{for(const zt of bt)Pe.push({polygon:zt,bounds:$t})},Xe=Math.ceil(Math.log2(ve)),at=Math.ceil(Math.log2(Ee)),mt=Xe-at,ot=[];for(let bt=0;bt<Math.abs(mt);bt++)ot.push(mt>0?0:1);for(let bt=0;bt<Math.min(Xe,at);bt++)ot.push(0),ot.push(1);let pt=fe;if(pt=Jc(pt,pe[0].y-we,pe[1].y+we,1),pt=Jc(pt,pe[0].x-we,pe[1].x+we,0),!pt.length)return Pe;const Et=[];for(ot.length?Et.push({polygons:pt,bounds:pe,depth:0}):ze(pt,pe);Et.length;){const bt=Et.pop(),$t=bt.depth,zt=ot[$t],rr=bt.bounds[0],yr=bt.bounds[1],Zt=zt===0?rr.x:rr.y,ar=zt===0?yr.x:yr.y,or=Ae?Ae(zt,Zt,ar):.5*(Zt+ar),hr=Jc(bt.polygons,Zt-we,or+we,zt),Sr=Jc(bt.polygons,or-we,ar+we,zt);if(hr.length){const Jt=[rr,new He(zt===0?or:yr.x,zt===1?or:yr.y)];ot.length>$t+1?Et.push({polygons:hr,bounds:Jt,depth:$t+1}):ze(hr,Jt)}if(Sr.length){const Jt=[new He(zt===0?or:rr.x,zt===1?or:rr.y),yr];ot.length>$t+1?Et.push({polygons:Sr,bounds:Jt,depth:$t+1}):ze(Sr,Jt)}}return Pe}(R,h,Math.ceil((Q-K)/11.25),Math.ceil((oe-ce)/11.25),1,(fe,pe,ve)=>{if(fe===0)return .5*(pe+ve);{const Ee=Rn((U.y+pe/ri)/W);return(ja(.5*(Rn((U.y+ve/ri)/W)+Ee))*W-U.y)*ri}})}Vr(Cl,"FillExtrusionBucket",{omit:["layers","features"]}),Vr(Jf,"PartMetadata");const Bm=new ct({"fill-extrusion-edge-radius":new Be(Yt["layout_fill-extrusion"]["fill-extrusion-edge-radius"])});var zm={paint:new ct({"fill-extrusion-opacity":new Be(Yt["paint_fill-extrusion"]["fill-extrusion-opacity"]),"fill-extrusion-color":new Ye(Yt["paint_fill-extrusion"]["fill-extrusion-color"]),"fill-extrusion-translate":new Be(Yt["paint_fill-extrusion"]["fill-extrusion-translate"]),"fill-extrusion-translate-anchor":new Be(Yt["paint_fill-extrusion"]["fill-extrusion-translate-anchor"]),"fill-extrusion-pattern":new Ye(Yt["paint_fill-extrusion"]["fill-extrusion-pattern"]),"fill-extrusion-height":new Ye(Yt["paint_fill-extrusion"]["fill-extrusion-height"]),"fill-extrusion-base":new Ye(Yt["paint_fill-extrusion"]["fill-extrusion-base"]),"fill-extrusion-vertical-gradient":new Be(Yt["paint_fill-extrusion"]["fill-extrusion-vertical-gradient"]),"fill-extrusion-ambient-occlusion-intensity":new Be(Yt["paint_fill-extrusion"]["fill-extrusion-ambient-occlusion-intensity"]),"fill-extrusion-ambient-occlusion-radius":new Be(Yt["paint_fill-extrusion"]["fill-extrusion-ambient-occlusion-radius"]),"fill-extrusion-rounded-roof":new Be(Yt["paint_fill-extrusion"]["fill-extrusion-rounded-roof"])}),layout:Bm};function op(R,h,U){var W=2*Math.PI*6378137/256/Math.pow(2,U);return[R*W-2*Math.PI*6378137/2,h*W-2*Math.PI*6378137/2]}class Qc{constructor(h,U,W){this.z=h,this.x=U,this.y=W,this.key=Pl(0,h,h,U,W)}equals(h){return this.z===h.z&&this.x===h.x&&this.y===h.y}url(h,U){const W=function(Q,oe,ce){var fe=op(256*Q,256*(oe=Math.pow(2,ce)-oe-1),ce),pe=op(256*(Q+1),256*(oe+1),ce);return fe[0]+","+fe[1]+","+pe[0]+","+pe[1]}(this.x,this.y,this.z),K=function(Q,oe,ce){let fe,pe="";for(let ve=Q;ve>0;ve--)fe=1<<ve-1,pe+=(oe&fe?1:0)+(ce&fe?2:0);return pe}(this.z,this.x,this.y);return h[(this.x+this.y)%h.length].replace("{prefix}",(this.x%16).toString(16)+(this.y%16).toString(16)).replace(/{z}/g,String(this.z)).replace(/{x}/g,String(this.x)).replace(/{y}/g,String(U==="tms"?Math.pow(2,this.z)-this.y-1:this.y)).replace("{quadkey}",K).replace("{bbox-epsg-3857}",W)}toString(){return`${this.z}/${this.x}/${this.y}`}}class sp{constructor(h,U){this.wrap=h,this.canonical=U,this.key=Pl(h,U.z,U.z,U.x,U.y)}}class kn{constructor(h,U,W,K,Q){this.overscaledZ=h,this.wrap=U,this.canonical=new Qc(W,+K,+Q),this.key=U===0&&h===W?this.canonical.key:Pl(U,h,W,K,Q)}equals(h){return this.overscaledZ===h.overscaledZ&&this.wrap===h.wrap&&this.canonical.equals(h.canonical)}scaledTo(h){const U=this.canonical.z-h;return h>this.canonical.z?new kn(h,this.wrap,this.canonical.z,this.canonical.x,this.canonical.y):new kn(h,this.wrap,h,this.canonical.x>>U,this.canonical.y>>U)}calculateScaledKey(h,U=!0){if(this.overscaledZ===h&&U)return this.key;if(h>this.canonical.z)return Pl(this.wrap*+U,h,this.canonical.z,this.canonical.x,this.canonical.y);{const W=this.canonical.z-h;return Pl(this.wrap*+U,h,h,this.canonical.x>>W,this.canonical.y>>W)}}isChildOf(h){if(h.wrap!==this.wrap)return!1;const U=this.canonical.z-h.canonical.z;return h.overscaledZ===0||h.overscaledZ<this.overscaledZ&&h.canonical.x===this.canonical.x>>U&&h.canonical.y===this.canonical.y>>U}children(h){if(this.overscaledZ>=h)return[new kn(this.overscaledZ+1,this.wrap,this.canonical.z,this.canonical.x,this.canonical.y)];const U=this.canonical.z+1,W=2*this.canonical.x,K=2*this.canonical.y;return[new kn(U,this.wrap,U,W,K),new kn(U,this.wrap,U,W+1,K),new kn(U,this.wrap,U,W,K+1),new kn(U,this.wrap,U,W+1,K+1)]}isLessThan(h){return this.wrap<h.wrap||!(this.wrap>h.wrap)&&(this.overscaledZ<h.overscaledZ||!(this.overscaledZ>h.overscaledZ)&&(this.canonical.x<h.canonical.x||!(this.canonical.x>h.canonical.x)&&this.canonical.y<h.canonical.y))}wrapped(){return new kn(this.overscaledZ,0,this.canonical.z,this.canonical.x,this.canonical.y)}unwrapTo(h){return new kn(this.overscaledZ,h,this.canonical.z,this.canonical.x,this.canonical.y)}overscaleFactor(){return Math.pow(2,this.overscaledZ-this.canonical.z)}toUnwrapped(){return new sp(this.wrap,this.canonical)}toString(){return`${this.overscaledZ}/${this.canonical.x}/${this.canonical.y}`}}function Pl(R,h,U,W,K){const Q=1<<Math.min(U,22);let oe=Q*(K%Q)+W%Q;return R&&U<22&&(oe+=Q*Q*((R<0?-2*R-1:2*R)%(1<<2*(22-U)))),16*(32*oe+U)+(h-U)}Vr(Qc,"CanonicalTileID"),Vr(kn,"OverscaledTileID",{omit:["projMatrix"]});class lu extends He{constructor(h,U,W){super(h,U),this.z=W}}function Ml(R,h){return R.x*h.x+R.y*h.y}function up(R,h){if(R.length===1){let U=0;const W=h[U++];let K;for(;!K||W.equals(K);)if(K=h[U++],!K)return 1/0;for(;U<h.length;U++){const Q=h[U],oe=R[0],ce=K.sub(W),fe=Q.sub(W),pe=oe.sub(W),ve=Ml(ce,ce),Ee=Ml(ce,fe),we=Ml(fe,fe),Ae=Ml(pe,ce),Pe=Ml(pe,fe),ze=ve*we-Ee*Ee,Xe=(we*Ae-Ee*Pe)/ze,at=(ve*Pe-Ee*Ae)/ze,mt=W.z*(1-Xe-at)+K.z*Xe+Q.z*at;if(isFinite(mt))return mt}return 1/0}{let U=1/0;for(const W of h)U=Math.min(U,W.z);return U}}function lp(R,h,U,W,K,Q,oe,ce){const fe=oe*K.getElevationAt(R,h,!0,!0),pe=Q[0]!==0,ve=pe?Q[1]===0?oe*(Q[0]/7-450):oe*function(Ee,we,Ae){const Pe=Math.floor(we[0]/8),ze=Math.floor(we[1]/8),Xe=10*(we[0]-8*Pe),at=10*(we[1]-8*ze),mt=Ee.getElevationAt(Pe,ze,!0,!0),ot=Ee.getMeterToDEM(Ae),pt=Math.floor(.5*(Xe*ot-1)),Et=Math.floor(.5*(at*ot-1)),bt=Ee.tileCoordToPixel(Pe,ze),$t=2*pt+1,zt=2*Et+1,rr=function(Sr,Jt,Cr,$r,Pr){return[Sr.getElevationAtPixel(Jt,Cr,!0),Sr.getElevationAtPixel(Jt+Pr,Cr,!0),Sr.getElevationAtPixel(Jt,Cr+Pr,!0),Sr.getElevationAtPixel(Jt+$r,Cr+Pr,!0)]}(Ee,bt.x-pt,bt.y-Et,$t,zt),yr=Math.abs(rr[0]-rr[1]),Zt=Math.abs(rr[2]-rr[3]),ar=Math.abs(rr[0]-rr[2])+Math.abs(rr[1]-rr[3]),or=Math.min(.25,.5*ot*(yr+Zt)/$t),hr=Math.min(.25,.5*ot*ar/zt);return mt+Math.max(or*Xe,hr*at)}(K,Q,ce):fe;return{base:fe+(U===0)?-1:U,top:pe?Math.max(ve+W,fe+U+2):fe+W}}const Nm=Dt([{name:"a_pos_normal",components:2,type:"Int16"},{name:"a_data",components:4,type:"Uint8"},{name:"a_linesofar",components:1,type:"Float32"}],4),{members:jm}=Nm,Um=Dt([{name:"a_packed",components:4,type:"Float32"}]),{members:Vm}=Um,Gm=Yc.types,$m=Math.cos(Math.PI/180*37.5);class eh{constructor(h){this.zoom=h.zoom,this.overscaling=h.overscaling,this.layers=h.layers,this.layerIds=this.layers.map(U=>U.id),this.index=h.index,this.projection=h.projection,this.hasPattern=!1,this.patternFeatures=[],this.lineClipsArray=[],this.gradients={},this.layers.forEach(U=>{this.gradients[U.id]={}}),this.layoutVertexArray=new Ht,this.layoutVertexArray2=new pr,this.indexArray=new Zr,this.programConfigurations=new hs(h.layers,h.zoom),this.segments=new hn,this.maxLineLength=0,this.stateDependentLayerIds=this.layers.filter(U=>U.isStateDependent()).map(U=>U.id)}populate(h,U,W,K){this.hasPattern=yd("line",this.layers,U);const Q=this.layers[0].layout.get("line-sort-key"),oe=[];for(const{feature:ve,id:Ee,index:we,sourceLayerIndex:Ae}of h){const Pe=this.layers[0]._featureFilter.needGeometry,ze=gs(ve,Pe);if(!this.layers[0]._featureFilter.filter(new be(this.zoom),ze,W))continue;const Xe=Q?Q.evaluate(ze,{},W):void 0,at={id:Ee,properties:ve.properties,type:ve.type,sourceLayerIndex:Ae,index:we,geometry:Pe?ze.geometry:ao(ve,W,K),patterns:{},sortKey:Xe};oe.push(at)}Q&&oe.sort((ve,Ee)=>ve.sortKey-Ee.sortKey);const{lineAtlas:ce,featureIndex:fe}=U,pe=this.addConstantDashes(ce);for(const ve of oe){const{geometry:Ee,index:we,sourceLayerIndex:Ae}=ve;if(pe&&this.addFeatureDashes(ve,ce),this.hasPattern){const Pe=gd("line",this.layers,ve,this.zoom,U);this.patternFeatures.push(Pe)}else this.addFeature(ve,Ee,we,W,ce.positions,U.availableImages);fe.insert(h[we].feature,Ee,we,Ae,this.index)}}addConstantDashes(h){let U=!1;for(const W of this.layers){const K=W.paint.get("line-dasharray").value,Q=W.layout.get("line-cap").value;if(K.kind!=="constant"||Q.kind!=="constant")U=!0;else{const oe=Q.value,ce=K.value;if(!ce)continue;h.addDash(ce,oe)}}return U}addFeatureDashes(h,U){const W=this.zoom;for(const K of this.layers){const Q=K.paint.get("line-dasharray").value,oe=K.layout.get("line-cap").value;if(Q.kind==="constant"&&oe.kind==="constant")continue;let ce,fe;if(Q.kind==="constant"){if(ce=Q.value,!ce)continue}else ce=Q.evaluate({zoom:W},h);fe=oe.kind==="constant"?oe.value:oe.evaluate({zoom:W},h),U.addDash(ce,fe),h.patterns[K.id]=U.getKey(ce,fe)}}update(h,U,W,K){this.stateDependentLayers.length&&this.programConfigurations.updatePaintArrays(h,U,this.stateDependentLayers,W,K)}addFeatures(h,U,W,K,Q){for(const oe of this.patternFeatures)this.addFeature(oe,oe.geometry,oe.index,U,W,K)}isEmpty(){return this.layoutVertexArray.length===0}uploadPending(){return!this.uploaded||this.programConfigurations.needsUpload}upload(h){this.uploaded||(this.layoutVertexArray2.length!==0&&(this.layoutVertexBuffer2=h.createVertexBuffer(this.layoutVertexArray2,Vm)),this.layoutVertexBuffer=h.createVertexBuffer(this.layoutVertexArray,jm),this.indexBuffer=h.createIndexBuffer(this.indexArray)),this.programConfigurations.upload(h),this.uploaded=!0}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy())}lineFeatureClips(h){if(h.properties&&h.properties.hasOwnProperty("mapbox_clip_start")&&h.properties.hasOwnProperty("mapbox_clip_end"))return{start:+h.properties.mapbox_clip_start,end:+h.properties.mapbox_clip_end}}addFeature(h,U,W,K,Q,oe){const ce=this.layers[0].layout,fe=ce.get("line-join").evaluate(h,{}),pe=ce.get("line-cap").evaluate(h,{}),ve=ce.get("line-miter-limit"),Ee=ce.get("line-round-limit");this.lineClips=this.lineFeatureClips(h);for(const we of U)this.addLine(we,h,fe,pe,ve,Ee);this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,h,W,Q,oe,K)}addLine(h,U,W,K,Q,oe){if(this.distance=0,this.scaledDistance=0,this.totalDistance=0,this.lineSoFar=0,this.lineClips){this.lineClipsArray.push(this.lineClips);for(let at=0;at<h.length-1;at++)this.totalDistance+=h[at].dist(h[at+1]);this.updateScaledDistance(),this.maxLineLength=Math.max(this.maxLineLength,this.totalDistance)}const ce=Gm[U.type]==="Polygon";let fe=h.length;for(;fe>=2&&h[fe-1].equals(h[fe-2]);)fe--;let pe=0;for(;pe<fe-1&&h[pe].equals(h[pe+1]);)pe++;if(fe<(ce?3:2))return;W==="bevel"&&(Q=1.05);const ve=this.overscaling<=16?15*ri/(512*this.overscaling):0,Ee=this.segments.prepareSegment(10*fe,this.layoutVertexArray,this.indexArray);let we,Ae,Pe,ze,Xe;this.e1=this.e2=-1,ce&&(we=h[fe-2],Xe=h[pe].sub(we)._unit()._perp());for(let at=pe;at<fe;at++){if(Pe=at===fe-1?ce?h[pe+1]:void 0:h[at+1],Pe&&h[at].equals(Pe))continue;Xe&&(ze=Xe),we&&(Ae=we),we=h[at],Xe=Pe?Pe.sub(we)._unit()._perp():ze,ze=ze||Xe;let mt=ze.add(Xe);mt.x===0&&mt.y===0||mt._unit();const ot=ze.x*Xe.x+ze.y*Xe.y,pt=mt.x*Xe.x+mt.y*Xe.y,Et=pt!==0?1/pt:1/0,bt=2*Math.sqrt(2-2*pt),$t=pt<$m&&Ae&&Pe,zt=ze.x*Xe.y-ze.y*Xe.x>0;if($t&&at>pe){const Zt=we.dist(Ae);if(Zt>2*ve){const ar=we.sub(we.sub(Ae)._mult(ve/Zt)._round());this.updateDistance(Ae,ar),this.addCurrentVertex(ar,ze,0,0,Ee),Ae=ar}}const rr=Ae&&Pe;let yr=rr?W:ce?"butt":K;if(rr&&yr==="round"&&(Et<oe?yr="miter":Et<=2&&(yr="fakeround")),yr==="miter"&&Et>Q&&(yr="bevel"),yr==="bevel"&&(Et>2&&(yr="flipbevel"),Et<Q&&(yr="miter")),Ae&&this.updateDistance(Ae,we),yr==="miter")mt._mult(Et),this.addCurrentVertex(we,mt,0,0,Ee);else if(yr==="flipbevel"){if(Et>100)mt=Xe.mult(-1);else{const Zt=Et*ze.add(Xe).mag()/ze.sub(Xe).mag();mt._perp()._mult(Zt*(zt?-1:1))}this.addCurrentVertex(we,mt,0,0,Ee),this.addCurrentVertex(we,mt.mult(-1),0,0,Ee)}else if(yr==="bevel"||yr==="fakeround"){const Zt=-Math.sqrt(Et*Et-1),ar=zt?Zt:0,or=zt?0:Zt;if(Ae&&this.addCurrentVertex(we,ze,ar,or,Ee),yr==="fakeround"){const hr=Math.round(180*bt/Math.PI/20);for(let Sr=1;Sr<hr;Sr++){let Jt=Sr/hr;if(Jt!==.5){const $r=Jt-.5;Jt+=Jt*$r*(Jt-1)*((1.0904+ot*(ot*(3.55645-1.43519*ot)-3.2452))*$r*$r+(.848013+ot*(.215638*ot-1.06021)))}const Cr=Xe.sub(ze)._mult(Jt)._add(ze)._unit()._mult(zt?-1:1);this.addHalfVertex(we,Cr.x,Cr.y,!1,zt,0,Ee)}}Pe&&this.addCurrentVertex(we,Xe,-ar,-or,Ee)}else if(yr==="butt")this.addCurrentVertex(we,mt,0,0,Ee);else if(yr==="square"){const Zt=Ae?1:-1;Ae||this.addCurrentVertex(we,mt,Zt,Zt,Ee),this.addCurrentVertex(we,mt,0,0,Ee),Ae&&this.addCurrentVertex(we,mt,Zt,Zt,Ee)}else yr==="round"&&(Ae&&(this.addCurrentVertex(we,ze,0,0,Ee),this.addCurrentVertex(we,ze,1,1,Ee,!0)),Pe&&(this.addCurrentVertex(we,Xe,-1,-1,Ee,!0),this.addCurrentVertex(we,Xe,0,0,Ee)));if($t&&at<fe-1){const Zt=we.dist(Pe);if(Zt>2*ve){const ar=we.add(Pe.sub(we)._mult(ve/Zt)._round());this.updateDistance(we,ar),this.addCurrentVertex(ar,Xe,0,0,Ee),we=ar}}}}addCurrentVertex(h,U,W,K,Q,oe=!1){const ce=U.y*K-U.x,fe=-U.y-U.x*K;this.addHalfVertex(h,U.x+U.y*W,U.y-U.x*W,oe,!1,W,Q),this.addHalfVertex(h,ce,fe,oe,!0,-K,Q)}addHalfVertex({x:h,y:U},W,K,Q,oe,ce,fe){this.layoutVertexArray.emplaceBack((h<<1)+(Q?1:0),(U<<1)+(oe?1:0),Math.round(63*W)+128,Math.round(63*K)+128,1+(ce===0?0:ce<0?-1:1),0,this.lineSoFar),this.lineClips&&this.layoutVertexArray2.emplaceBack(this.scaledDistance,this.lineClipsArray.length,this.lineClips.start,this.lineClips.end);const pe=fe.vertexLength++;this.e1>=0&&this.e2>=0&&(this.indexArray.emplaceBack(this.e1,this.e2,pe),fe.primitiveLength++),oe?this.e2=pe:this.e1=pe}updateScaledDistance(){if(this.lineClips){const h=this.totalDistance/(this.lineClips.end-this.lineClips.start);this.scaledDistance=this.distance/this.totalDistance,this.lineSoFar=h*this.lineClips.start+this.distance}else this.lineSoFar=this.distance}updateDistance(h,U){this.distance+=h.dist(U),this.updateScaledDistance()}}Vr(eh,"LineBucket",{omit:["layers","patternFeatures"]});const Wm=new ct({"line-cap":new Ye(Yt.layout_line["line-cap"]),"line-join":new Ye(Yt.layout_line["line-join"]),"line-miter-limit":new Be(Yt.layout_line["line-miter-limit"]),"line-round-limit":new Be(Yt.layout_line["line-round-limit"]),"line-sort-key":new Ye(Yt.layout_line["line-sort-key"])});var cp={paint:new ct({"line-opacity":new Ye(Yt.paint_line["line-opacity"]),"line-color":new Ye(Yt.paint_line["line-color"]),"line-translate":new Be(Yt.paint_line["line-translate"]),"line-translate-anchor":new Be(Yt.paint_line["line-translate-anchor"]),"line-width":new Ye(Yt.paint_line["line-width"]),"line-gap-width":new Ye(Yt.paint_line["line-gap-width"]),"line-offset":new Ye(Yt.paint_line["line-offset"]),"line-blur":new Ye(Yt.paint_line["line-blur"]),"line-dasharray":new Ye(Yt.paint_line["line-dasharray"]),"line-pattern":new Ye(Yt.paint_line["line-pattern"]),"line-gradient":new lt(Yt.paint_line["line-gradient"]),"line-trim-offset":new Be(Yt.paint_line["line-trim-offset"])}),layout:Wm};const hp=new class extends Ye{possiblyEvaluate(R,h){return h=new be(Math.floor(h.zoom),{now:h.now,fadeDuration:h.fadeDuration,transition:h.transition}),super.possiblyEvaluate(R,h)}evaluate(R,h,U,W){return h=lr({},h,{zoom:Math.floor(h.zoom)}),super.evaluate(R,h,U,W)}}(cp.paint.properties["line-width"].specification);function dp(R,h){return h>0?h+2*R:R}hp.useIntegerZoom=!0;const Hm=Dt([{name:"a_pos_offset",components:4,type:"Int16"},{name:"a_tex_size",components:4,type:"Uint16"},{name:"a_pixeloffset",components:4,type:"Int16"}],4),Zm=Dt([{name:"a_globe_anchor",components:3,type:"Int16"},{name:"a_globe_normal",components:3,type:"Float32"}],4),Km=Dt([{name:"a_projected_pos",components:4,type:"Float32"}],4);Dt([{name:"a_fade_opacity",components:1,type:"Uint32"}],4);const Xm=Dt([{name:"a_placed",components:2,type:"Uint8"},{name:"a_shift",components:2,type:"Float32"}]),Ym=Dt([{name:"a_size_scale",components:1,type:"Float32"},{name:"a_padding",components:2,type:"Float32"}]);Dt([{type:"Int16",name:"projectedAnchorX"},{type:"Int16",name:"projectedAnchorY"},{type:"Int16",name:"projectedAnchorZ"},{type:"Int16",name:"tileAnchorX"},{type:"Int16",name:"tileAnchorY"},{type:"Float32",name:"x1"},{type:"Float32",name:"y1"},{type:"Float32",name:"x2"},{type:"Float32",name:"y2"},{type:"Int16",name:"padding"},{type:"Uint32",name:"featureIndex"},{type:"Uint16",name:"sourceLayerIndex"},{type:"Uint16",name:"bucketIndex"}]);const fp=Dt([{name:"a_pos",components:3,type:"Int16"},{name:"a_anchor_pos",components:2,type:"Int16"},{name:"a_extrude",components:2,type:"Int16"}],4),Jm=Dt([{name:"a_pos_2f",components:2,type:"Float32"},{name:"a_radius",components:1,type:"Float32"},{name:"a_flags",components:2,type:"Int16"}],4);Dt([{name:"triangle",components:3,type:"Uint16"}]),Dt([{type:"Int16",name:"projectedAnchorX"},{type:"Int16",name:"projectedAnchorY"},{type:"Int16",name:"projectedAnchorZ"},{type:"Float32",name:"tileAnchorX"},{type:"Float32",name:"tileAnchorY"},{type:"Uint16",name:"glyphStartIndex"},{type:"Uint16",name:"numGlyphs"},{type:"Uint32",name:"vertexStartIndex"},{type:"Uint32",name:"lineStartIndex"},{type:"Uint32",name:"lineLength"},{type:"Uint16",name:"segment"},{type:"Uint16",name:"lowerSize"},{type:"Uint16",name:"upperSize"},{type:"Float32",name:"lineOffsetX"},{type:"Float32",name:"lineOffsetY"},{type:"Uint8",name:"writingMode"},{type:"Uint8",name:"placedOrientation"},{type:"Uint8",name:"hidden"},{type:"Uint32",name:"crossTileID"},{type:"Int16",name:"associatedIconIndex"},{type:"Uint8",name:"flipState"}]),Dt([{type:"Int16",name:"projectedAnchorX"},{type:"Int16",name:"projectedAnchorY"},{type:"Int16",name:"projectedAnchorZ"},{type:"Float32",name:"tileAnchorX"},{type:"Float32",name:"tileAnchorY"},{type:"Int16",name:"rightJustifiedTextSymbolIndex"},{type:"Int16",name:"centerJustifiedTextSymbolIndex"},{type:"Int16",name:"leftJustifiedTextSymbolIndex"},{type:"Int16",name:"verticalPlacedTextSymbolIndex"},{type:"Int16",name:"placedIconSymbolIndex"},{type:"Int16",name:"verticalPlacedIconSymbolIndex"},{type:"Uint16",name:"key"},{type:"Uint16",name:"textBoxStartIndex"},{type:"Uint16",name:"textBoxEndIndex"},{type:"Uint16",name:"verticalTextBoxStartIndex"},{type:"Uint16",name:"verticalTextBoxEndIndex"},{type:"Uint16",name:"iconBoxStartIndex"},{type:"Uint16",name:"iconBoxEndIndex"},{type:"Uint16",name:"verticalIconBoxStartIndex"},{type:"Uint16",name:"verticalIconBoxEndIndex"},{type:"Uint16",name:"featureIndex"},{type:"Uint16",name:"numHorizontalGlyphVertices"},{type:"Uint16",name:"numVerticalGlyphVertices"},{type:"Uint16",name:"numIconVertices"},{type:"Uint16",name:"numVerticalIconVertices"},{type:"Uint16",name:"useRuntimeCollisionCircles"},{type:"Uint32",name:"crossTileID"},{type:"Float32",components:2,name:"textOffset"},{type:"Float32",name:"collisionCircleDiameter"}]),Dt([{type:"Float32",name:"offsetX"}]),Dt([{type:"Int16",name:"x"},{type:"Int16",name:"y"}]);var Sn=24;const Oa=128;function bd(R,h){const{expression:U}=h;if(U.kind==="constant")return{kind:"constant",layoutSize:U.evaluate(new be(R+1))};if(U.kind==="source")return{kind:"source"};{const{zoomStops:W,interpolationType:K}=U;let Q=0;for(;Q<W.length&&W[Q]<=R;)Q++;Q=Math.max(0,Q-1);let oe=Q;for(;oe<W.length&&W[oe]<R+1;)oe++;oe=Math.min(W.length-1,oe);const ce=W[Q],fe=W[oe];return U.kind==="composite"?{kind:"composite",minZoom:ce,maxZoom:fe,interpolationType:K}:{kind:"camera",minZoom:ce,maxZoom:fe,minSize:U.evaluate(new be(ce)),maxSize:U.evaluate(new be(fe)),interpolationType:K}}}function th(R,{uSize:h,uSizeT:U},{lowerSize:W,upperSize:K}){return R.kind==="source"?W/Oa:R.kind==="composite"?Ti(W/Oa,K/Oa,U):h}function cu(R,h){let U=0,W=0;if(R.kind==="constant")W=R.layoutSize;else if(R.kind!=="source"){const{interpolationType:K,minZoom:Q,maxZoom:oe}=R,ce=K?nt(la.interpolationFactor(K,h,Q,oe),0,1):0;R.kind==="camera"?W=Ti(R.minSize,R.maxSize,ce):U=ce}return{uSizeT:U,uSize:W}}var Qm=Object.freeze({__proto__:null,SIZE_PACK_FACTOR:Oa,evaluateSizeForFeature:th,evaluateSizeForZoom:cu,getSizeData:bd});function ey(R,h,U){return R.sections.forEach(W=>{W.text=function(K,Q,oe){const ce=Q.layout.get("text-transform").evaluate(oe,{});return ce==="uppercase"?K=K.toLocaleUpperCase():ce==="lowercase"&&(K=K.toLocaleLowerCase()),ye.applyArabicShaping&&(K=ye.applyArabicShaping(K)),K}(W.text,h,U)}),R}const Dl={"!":"︕","#":"＃",$:"＄","%":"％","&":"＆","(":"︵",")":"︶","*":"＊","+":"＋",",":"︐","-":"︲",".":"・","/":"／",":":"︓",";":"︔","<":"︿","=":"＝",">":"﹀","?":"︖","@":"＠","[":"﹇","\\":"＼","]":"﹈","^":"＾",_:"︳","`":"｀","{":"︷","|":"―","}":"︸","~":"～","¢":"￠","£":"￡","¥":"￥","¦":"￤","¬":"￢","¯":"￣","–":"︲","—":"︱","‘":"﹃","’":"﹄","“":"﹁","”":"﹂","…":"︙","‧":"・","₩":"￦","、":"︑","。":"︒","〈":"︿","〉":"﹀","《":"︽","》":"︾","「":"﹁","」":"﹂","『":"﹃","』":"﹄","【":"︻","】":"︼","〔":"︹","〕":"︺","〖":"︗","〗":"︘","！":"︕","（":"︵","）":"︶","，":"︐","－":"︲","．":"・","：":"︓","；":"︔","＜":"︿","＞":"﹀","？":"︖","［":"﹇","］":"﹈","＿":"︳","｛":"︷","｜":"―","｝":"︸","｟":"︵","｠":"︶","｡":"︒","｢":"﹁","｣":"﹂","←":"↑","→":"↓"};function ty(R){return R==="︶"||R==="﹈"||R==="︸"||R==="﹄"||R==="﹂"||R==="︾"||R==="︼"||R==="︺"||R==="︘"||R==="﹀"||R==="︐"||R==="︓"||R==="︔"||R==="｀"||R==="￣"||R==="︑"||R==="︒"}function ry(R){return R==="︵"||R==="﹇"||R==="︷"||R==="﹃"||R==="﹁"||R==="︽"||R==="︻"||R==="︹"||R==="︗"||R==="︿"}var pp=Ui,_p=function(R,h,U,W,K){var Q,oe,ce=8*K-W-1,fe=(1<<ce)-1,pe=fe>>1,ve=-7,Ee=K-1,we=-1,Ae=R[h+Ee];for(Ee+=we,Q=Ae&(1<<-ve)-1,Ae>>=-ve,ve+=ce;ve>0;Q=256*Q+R[h+Ee],Ee+=we,ve-=8);for(oe=Q&(1<<-ve)-1,Q>>=-ve,ve+=W;ve>0;oe=256*oe+R[h+Ee],Ee+=we,ve-=8);if(Q===0)Q=1-pe;else{if(Q===fe)return oe?NaN:1/0*(Ae?-1:1);oe+=Math.pow(2,W),Q-=pe}return(Ae?-1:1)*oe*Math.pow(2,Q-W)},mp=function(R,h,U,W,K,Q){var oe,ce,fe,pe=8*Q-K-1,ve=(1<<pe)-1,Ee=ve>>1,we=K===23?Math.pow(2,-24)-Math.pow(2,-77):0,Ae=0,Pe=1,ze=h<0||h===0&&1/h<0?1:0;for(h=Math.abs(h),isNaN(h)||h===1/0?(ce=isNaN(h)?1:0,oe=ve):(oe=Math.floor(Math.log(h)/Math.LN2),h*(fe=Math.pow(2,-oe))<1&&(oe--,fe*=2),(h+=oe+Ee>=1?we/fe:we*Math.pow(2,1-Ee))*fe>=2&&(oe++,fe/=2),oe+Ee>=ve?(ce=0,oe=ve):oe+Ee>=1?(ce=(h*fe-1)*Math.pow(2,K),oe+=Ee):(ce=h*Math.pow(2,Ee-1)*Math.pow(2,K),oe=0));K>=8;R[U+Ae]=255&ce,Ae+=Pe,ce/=256,K-=8);for(oe=oe<<K|ce,pe+=K;pe>0;R[U+Ae]=255&oe,Ae+=Pe,oe/=256,pe-=8);R[U+Ae-Pe]|=128*ze};/*! ieee754. BSD-3-Clause License. Feross Aboukhadijeh <https://feross.org/opensource> */function Ui(R){this.buf=ArrayBuffer.isView&&ArrayBuffer.isView(R)?R:new Uint8Array(R||0),this.pos=0,this.type=0,this.length=this.buf.length}Ui.Varint=0,Ui.Fixed64=1,Ui.Bytes=2,Ui.Fixed32=5;var xd=4294967296,yp=1/xd,gp=typeof TextDecoder>"u"?null:new TextDecoder("utf8");function so(R){return R.type===Ui.Bytes?R.readVarint()+R.pos:R.pos+1}function hu(R,h,U){return U?4294967296*h+(R>>>0):4294967296*(h>>>0)+(R>>>0)}function vp(R,h,U){var W=h<=16383?1:h<=2097151?2:h<=268435455?3:Math.floor(Math.log(h)/(7*Math.LN2));U.realloc(W);for(var K=U.pos-1;K>=R;K--)U.buf[K+W]=U.buf[K]}function iy(R,h){for(var U=0;U<R.length;U++)h.writeVarint(R[U])}function ny(R,h){for(var U=0;U<R.length;U++)h.writeSVarint(R[U])}function ay(R,h){for(var U=0;U<R.length;U++)h.writeFloat(R[U])}function oy(R,h){for(var U=0;U<R.length;U++)h.writeDouble(R[U])}function sy(R,h){for(var U=0;U<R.length;U++)h.writeBoolean(R[U])}function uy(R,h){for(var U=0;U<R.length;U++)h.writeFixed32(R[U])}function ly(R,h){for(var U=0;U<R.length;U++)h.writeSFixed32(R[U])}function cy(R,h){for(var U=0;U<R.length;U++)h.writeFixed64(R[U])}function hy(R,h){for(var U=0;U<R.length;U++)h.writeSFixed64(R[U])}function rh(R,h){return(R[h]|R[h+1]<<8|R[h+2]<<16)+16777216*R[h+3]}function du(R,h,U){R[U]=h,R[U+1]=h>>>8,R[U+2]=h>>>16,R[U+3]=h>>>24}function bp(R,h){return(R[h]|R[h+1]<<8|R[h+2]<<16)+(R[h+3]<<24)}Ui.prototype={destroy:function(){this.buf=null},readFields:function(R,h,U){for(U=U||this.length;this.pos<U;){var W=this.readVarint(),K=W>>3,Q=this.pos;this.type=7&W,R(K,h,this),this.pos===Q&&this.skip(W)}return h},readMessage:function(R,h){return this.readFields(R,h,this.readVarint()+this.pos)},readFixed32:function(){var R=rh(this.buf,this.pos);return this.pos+=4,R},readSFixed32:function(){var R=bp(this.buf,this.pos);return this.pos+=4,R},readFixed64:function(){var R=rh(this.buf,this.pos)+rh(this.buf,this.pos+4)*xd;return this.pos+=8,R},readSFixed64:function(){var R=rh(this.buf,this.pos)+bp(this.buf,this.pos+4)*xd;return this.pos+=8,R},readFloat:function(){var R=_p(this.buf,this.pos,!0,23,4);return this.pos+=4,R},readDouble:function(){var R=_p(this.buf,this.pos,!0,52,8);return this.pos+=8,R},readVarint:function(R){var h,U,W=this.buf;return h=127&(U=W[this.pos++]),U<128?h:(h|=(127&(U=W[this.pos++]))<<7,U<128?h:(h|=(127&(U=W[this.pos++]))<<14,U<128?h:(h|=(127&(U=W[this.pos++]))<<21,U<128?h:function(K,Q,oe){var ce,fe,pe=oe.buf;if(ce=(112&(fe=pe[oe.pos++]))>>4,fe<128||(ce|=(127&(fe=pe[oe.pos++]))<<3,fe<128)||(ce|=(127&(fe=pe[oe.pos++]))<<10,fe<128)||(ce|=(127&(fe=pe[oe.pos++]))<<17,fe<128)||(ce|=(127&(fe=pe[oe.pos++]))<<24,fe<128)||(ce|=(1&(fe=pe[oe.pos++]))<<31,fe<128))return hu(K,ce,Q);throw new Error("Expected varint not more than 10 bytes")}(h|=(15&(U=W[this.pos]))<<28,R,this))))},readVarint64:function(){return this.readVarint(!0)},readSVarint:function(){var R=this.readVarint();return R%2==1?(R+1)/-2:R/2},readBoolean:function(){return!!this.readVarint()},readString:function(){var R=this.readVarint()+this.pos,h=this.pos;return this.pos=R,R-h>=12&&gp?function(U,W,K){return gp.decode(U.subarray(W,K))}(this.buf,h,R):function(U,W,K){for(var Q="",oe=W;oe<K;){var ce,fe,pe,ve=U[oe],Ee=null,we=ve>239?4:ve>223?3:ve>191?2:1;if(oe+we>K)break;we===1?ve<128&&(Ee=ve):we===2?(192&(ce=U[oe+1]))==128&&(Ee=(31&ve)<<6|63&ce)<=127&&(Ee=null):we===3?(fe=U[oe+2],(192&(ce=U[oe+1]))==128&&(192&fe)==128&&((Ee=(15&ve)<<12|(63&ce)<<6|63&fe)<=2047||Ee>=55296&&Ee<=57343)&&(Ee=null)):we===4&&(fe=U[oe+2],pe=U[oe+3],(192&(ce=U[oe+1]))==128&&(192&fe)==128&&(192&pe)==128&&((Ee=(15&ve)<<18|(63&ce)<<12|(63&fe)<<6|63&pe)<=65535||Ee>=1114112)&&(Ee=null)),Ee===null?(Ee=65533,we=1):Ee>65535&&(Ee-=65536,Q+=String.fromCharCode(Ee>>>10&1023|55296),Ee=56320|1023&Ee),Q+=String.fromCharCode(Ee),oe+=we}return Q}(this.buf,h,R)},readBytes:function(){var R=this.readVarint()+this.pos,h=this.buf.subarray(this.pos,R);return this.pos=R,h},readPackedVarint:function(R,h){if(this.type!==Ui.Bytes)return R.push(this.readVarint(h));var U=so(this);for(R=R||[];this.pos<U;)R.push(this.readVarint(h));return R},readPackedSVarint:function(R){if(this.type!==Ui.Bytes)return R.push(this.readSVarint());var h=so(this);for(R=R||[];this.pos<h;)R.push(this.readSVarint());return R},readPackedBoolean:function(R){if(this.type!==Ui.Bytes)return R.push(this.readBoolean());var h=so(this);for(R=R||[];this.pos<h;)R.push(this.readBoolean());return R},readPackedFloat:function(R){if(this.type!==Ui.Bytes)return R.push(this.readFloat());var h=so(this);for(R=R||[];this.pos<h;)R.push(this.readFloat());return R},readPackedDouble:function(R){if(this.type!==Ui.Bytes)return R.push(this.readDouble());var h=so(this);for(R=R||[];this.pos<h;)R.push(this.readDouble());return R},readPackedFixed32:function(R){if(this.type!==Ui.Bytes)return R.push(this.readFixed32());var h=so(this);for(R=R||[];this.pos<h;)R.push(this.readFixed32());return R},readPackedSFixed32:function(R){if(this.type!==Ui.Bytes)return R.push(this.readSFixed32());var h=so(this);for(R=R||[];this.pos<h;)R.push(this.readSFixed32());return R},readPackedFixed64:function(R){if(this.type!==Ui.Bytes)return R.push(this.readFixed64());var h=so(this);for(R=R||[];this.pos<h;)R.push(this.readFixed64());return R},readPackedSFixed64:function(R){if(this.type!==Ui.Bytes)return R.push(this.readSFixed64());var h=so(this);for(R=R||[];this.pos<h;)R.push(this.readSFixed64());return R},skip:function(R){var h=7&R;if(h===Ui.Varint)for(;this.buf[this.pos++]>127;);else if(h===Ui.Bytes)this.pos=this.readVarint()+this.pos;else if(h===Ui.Fixed32)this.pos+=4;else{if(h!==Ui.Fixed64)throw new Error("Unimplemented type: "+h);this.pos+=8}},writeTag:function(R,h){this.writeVarint(R<<3|h)},realloc:function(R){for(var h=this.length||16;h<this.pos+R;)h*=2;if(h!==this.length){var U=new Uint8Array(h);U.set(this.buf),this.buf=U,this.length=h}},finish:function(){return this.length=this.pos,this.pos=0,this.buf.subarray(0,this.length)},writeFixed32:function(R){this.realloc(4),du(this.buf,R,this.pos),this.pos+=4},writeSFixed32:function(R){this.realloc(4),du(this.buf,R,this.pos),this.pos+=4},writeFixed64:function(R){this.realloc(8),du(this.buf,-1&R,this.pos),du(this.buf,Math.floor(R*yp),this.pos+4),this.pos+=8},writeSFixed64:function(R){this.realloc(8),du(this.buf,-1&R,this.pos),du(this.buf,Math.floor(R*yp),this.pos+4),this.pos+=8},writeVarint:function(R){(R=+R||0)>268435455||R<0?function(h,U){var W,K;if(h>=0?(W=h%4294967296|0,K=h/4294967296|0):(K=~(-h/4294967296),4294967295^(W=~(-h%4294967296))?W=W+1|0:(W=0,K=K+1|0)),h>=18446744073709552e3||h<-18446744073709552e3)throw new Error("Given varint doesn't fit into 10 bytes");U.realloc(10),function(Q,oe,ce){ce.buf[ce.pos++]=127&Q|128,Q>>>=7,ce.buf[ce.pos++]=127&Q|128,Q>>>=7,ce.buf[ce.pos++]=127&Q|128,Q>>>=7,ce.buf[ce.pos++]=127&Q|128,ce.buf[ce.pos]=127&(Q>>>=7)}(W,0,U),function(Q,oe){var ce=(7&Q)<<4;oe.buf[oe.pos++]|=ce|((Q>>>=3)?128:0),Q&&(oe.buf[oe.pos++]=127&Q|((Q>>>=7)?128:0),Q&&(oe.buf[oe.pos++]=127&Q|((Q>>>=7)?128:0),Q&&(oe.buf[oe.pos++]=127&Q|((Q>>>=7)?128:0),Q&&(oe.buf[oe.pos++]=127&Q|((Q>>>=7)?128:0),Q&&(oe.buf[oe.pos++]=127&Q)))))}(K,U)}(R,this):(this.realloc(4),this.buf[this.pos++]=127&R|(R>127?128:0),R<=127||(this.buf[this.pos++]=127&(R>>>=7)|(R>127?128:0),R<=127||(this.buf[this.pos++]=127&(R>>>=7)|(R>127?128:0),R<=127||(this.buf[this.pos++]=R>>>7&127))))},writeSVarint:function(R){this.writeVarint(R<0?2*-R-1:2*R)},writeBoolean:function(R){this.writeVarint(!!R)},writeString:function(R){R=String(R),this.realloc(4*R.length),this.pos++;var h=this.pos;this.pos=function(W,K,Q){for(var oe,ce,fe=0;fe<K.length;fe++){if((oe=K.charCodeAt(fe))>55295&&oe<57344){if(!ce){oe>56319||fe+1===K.length?(W[Q++]=239,W[Q++]=191,W[Q++]=189):ce=oe;continue}if(oe<56320){W[Q++]=239,W[Q++]=191,W[Q++]=189,ce=oe;continue}oe=ce-55296<<10|oe-56320|65536,ce=null}else ce&&(W[Q++]=239,W[Q++]=191,W[Q++]=189,ce=null);oe<128?W[Q++]=oe:(oe<2048?W[Q++]=oe>>6|192:(oe<65536?W[Q++]=oe>>12|224:(W[Q++]=oe>>18|240,W[Q++]=oe>>12&63|128),W[Q++]=oe>>6&63|128),W[Q++]=63&oe|128)}return Q}(this.buf,R,this.pos);var U=this.pos-h;U>=128&&vp(h,U,this),this.pos=h-1,this.writeVarint(U),this.pos+=U},writeFloat:function(R){this.realloc(4),mp(this.buf,R,this.pos,!0,23,4),this.pos+=4},writeDouble:function(R){this.realloc(8),mp(this.buf,R,this.pos,!0,52,8),this.pos+=8},writeBytes:function(R){var h=R.length;this.writeVarint(h),this.realloc(h);for(var U=0;U<h;U++)this.buf[this.pos++]=R[U]},writeRawMessage:function(R,h){this.pos++;var U=this.pos;R(h,this);var W=this.pos-U;W>=128&&vp(U,W,this),this.pos=U-1,this.writeVarint(W),this.pos+=W},writeMessage:function(R,h,U){this.writeTag(R,Ui.Bytes),this.writeRawMessage(h,U)},writePackedVarint:function(R,h){h.length&&this.writeMessage(R,iy,h)},writePackedSVarint:function(R,h){h.length&&this.writeMessage(R,ny,h)},writePackedBoolean:function(R,h){h.length&&this.writeMessage(R,sy,h)},writePackedFloat:function(R,h){h.length&&this.writeMessage(R,ay,h)},writePackedDouble:function(R,h){h.length&&this.writeMessage(R,oy,h)},writePackedFixed32:function(R,h){h.length&&this.writeMessage(R,uy,h)},writePackedSFixed32:function(R,h){h.length&&this.writeMessage(R,ly,h)},writePackedFixed64:function(R,h){h.length&&this.writeMessage(R,cy,h)},writePackedSFixed64:function(R,h){h.length&&this.writeMessage(R,hy,h)},writeBytesField:function(R,h){this.writeTag(R,Ui.Bytes),this.writeBytes(h)},writeFixed32Field:function(R,h){this.writeTag(R,Ui.Fixed32),this.writeFixed32(h)},writeSFixed32Field:function(R,h){this.writeTag(R,Ui.Fixed32),this.writeSFixed32(h)},writeFixed64Field:function(R,h){this.writeTag(R,Ui.Fixed64),this.writeFixed64(h)},writeSFixed64Field:function(R,h){this.writeTag(R,Ui.Fixed64),this.writeSFixed64(h)},writeVarintField:function(R,h){this.writeTag(R,Ui.Varint),this.writeVarint(h)},writeSVarintField:function(R,h){this.writeTag(R,Ui.Varint),this.writeSVarint(h)},writeStringField:function(R,h){this.writeTag(R,Ui.Bytes),this.writeString(h)},writeFloatField:function(R,h){this.writeTag(R,Ui.Fixed32),this.writeFloat(h)},writeDoubleField:function(R,h){this.writeTag(R,Ui.Fixed64),this.writeDouble(h)},writeBooleanField:function(R,h){this.writeVarintField(R,!!h)}};var ih=Le(pp);const Ed=3;function dy(R,h,U){h.glyphs=[],R===1&&U.readMessage(fy,h)}function fy(R,h,U){if(R===3){const{id:W,bitmap:K,width:Q,height:oe,left:ce,top:fe,advance:pe}=U.readMessage(py,{});h.glyphs.push({id:W,bitmap:new oo({width:Q+2*Ed,height:oe+2*Ed},K),metrics:{width:Q,height:oe,left:ce,top:fe,advance:pe}})}else R===4?h.ascender=U.readSVarint():R===5&&(h.descender=U.readSVarint())}function py(R,h,U){R===1?h.id=U.readVarint():R===2?h.bitmap=U.readBytes():R===3?h.width=U.readVarint():R===4?h.height=U.readVarint():R===5?h.left=U.readSVarint():R===6?h.top=U.readSVarint():R===7&&(h.advance=U.readVarint())}const xp=Ed;function wd(R){let h=0,U=0;for(const oe of R)h+=oe.w*oe.h,U=Math.max(U,oe.w);R.sort((oe,ce)=>ce.h-oe.h);const W=[{x:0,y:0,w:Math.max(Math.ceil(Math.sqrt(h/.95)),U),h:1/0}];let K=0,Q=0;for(const oe of R)for(let ce=W.length-1;ce>=0;ce--){const fe=W[ce];if(!(oe.w>fe.w||oe.h>fe.h)){if(oe.x=fe.x,oe.y=fe.y,Q=Math.max(Q,oe.y+oe.h),K=Math.max(K,oe.x+oe.w),oe.w===fe.w&&oe.h===fe.h){const pe=W.pop();ce<W.length&&(W[ce]=pe)}else oe.h===fe.h?(fe.x+=oe.w,fe.w-=oe.w):oe.w===fe.w?(fe.y+=oe.h,fe.h-=oe.h):(W.push({x:fe.x+oe.w,y:fe.y,w:fe.w-oe.w,h:oe.h}),fe.y+=oe.h,fe.h-=oe.h);break}}return{w:K,h:Q,fill:h/(K*Q)||0}}const Vn=1;class Sd{constructor(h,{pixelRatio:U,version:W,stretchX:K,stretchY:Q,content:oe}){this.paddedRect=h,this.pixelRatio=U,this.stretchX=K,this.stretchY=Q,this.content=oe,this.version=W}get tl(){return[this.paddedRect.x+Vn,this.paddedRect.y+Vn]}get br(){return[this.paddedRect.x+this.paddedRect.w-Vn,this.paddedRect.y+this.paddedRect.h-Vn]}get displaySize(){return[(this.paddedRect.w-2*Vn)/this.pixelRatio,(this.paddedRect.h-2*Vn)/this.pixelRatio]}}class Ep{constructor(h,U){const W={},K={};this.haveRenderCallbacks=[];const Q=[];this.addImages(h,W,Q),this.addImages(U,K,Q);const{w:oe,h:ce}=wd(Q),fe=new Yn({width:oe||1,height:ce||1});for(const pe in h){const ve=h[pe],Ee=W[pe].paddedRect;Yn.copy(ve.data,fe,{x:0,y:0},{x:Ee.x+Vn,y:Ee.y+Vn},ve.data)}for(const pe in U){const ve=U[pe],Ee=K[pe].paddedRect,we=Ee.x+Vn,Ae=Ee.y+Vn,Pe=ve.data.width,ze=ve.data.height;Yn.copy(ve.data,fe,{x:0,y:0},{x:we,y:Ae},ve.data),Yn.copy(ve.data,fe,{x:0,y:ze-1},{x:we,y:Ae-1},{width:Pe,height:1}),Yn.copy(ve.data,fe,{x:0,y:0},{x:we,y:Ae+ze},{width:Pe,height:1}),Yn.copy(ve.data,fe,{x:Pe-1,y:0},{x:we-1,y:Ae},{width:1,height:ze}),Yn.copy(ve.data,fe,{x:0,y:0},{x:we+Pe,y:Ae},{width:1,height:ze})}this.image=fe,this.iconPositions=W,this.patternPositions=K}addImages(h,U,W){for(const K in h){const Q=h[K],oe={x:0,y:0,w:Q.data.width+2*Vn,h:Q.data.height+2*Vn};W.push(oe),U[K]=new Sd(oe,Q),Q.hasRenderCallback&&this.haveRenderCallbacks.push(K)}}patchUpdatedImages(h,U){this.haveRenderCallbacks=this.haveRenderCallbacks.filter(W=>h.hasImage(W)),h.dispatchRenderCallbacks(this.haveRenderCallbacks);for(const W in h.updatedImages)this.patchUpdatedImage(this.iconPositions[W],h.getImage(W),U),this.patchUpdatedImage(this.patternPositions[W],h.getImage(W),U)}patchUpdatedImage(h,U,W){if(!h||!U||h.version===U.version)return;h.version=U.version;const[K,Q]=h.tl;W.update(U.data,void 0,{x:K,y:Q})}}Vr(Sd,"ImagePosition"),Vr(Ep,"ImageAtlas");const oa={horizontal:1,vertical:2,horizontalOnly:3},wp=-17;class Ll{constructor(){this.scale=1,this.fontStack="",this.imageName=null}static forText(h,U){const W=new Ll;return W.scale=h||1,W.fontStack=U,W}static forImage(h){const U=new Ll;return U.imageName=h,U}}class fu{constructor(){this.text="",this.sectionIndex=[],this.sections=[],this.imageSectionID=null}static fromFeature(h,U){const W=new fu;for(let K=0;K<h.sections.length;K++){const Q=h.sections[K];Q.image?W.addImageSection(Q):W.addTextSection(Q,U)}return W}length(){return this.text.length}getSection(h){return this.sections[this.sectionIndex[h]]}getSections(){return this.sections}getSectionIndex(h){return this.sectionIndex[h]}getCharCode(h){return this.text.charCodeAt(h)}verticalizePunctuation(h){this.text=function(U,W){let K="";for(let Q=0;Q<U.length;Q++){const oe=U.charCodeAt(Q+1)||null,ce=U.charCodeAt(Q-1)||null;K+=!W&&(oe&&Pc(oe)&&!Dl[U[Q+1]]||ce&&Pc(ce)&&!Dl[U[Q-1]])||!Dl[U[Q]]?U[Q]:Dl[U[Q]]}return K}(this.text,h)}trim(){let h=0;for(let W=0;W<this.text.length&&nh[this.text.charCodeAt(W)];W++)h++;let U=this.text.length;for(let W=this.text.length-1;W>=0&&W>=h&&nh[this.text.charCodeAt(W)];W--)U--;this.text=this.text.substring(h,U),this.sectionIndex=this.sectionIndex.slice(h,U)}substring(h,U){const W=new fu;return W.text=this.text.substring(h,U),W.sectionIndex=this.sectionIndex.slice(h,U),W.sections=this.sections,W}toString(){return this.text}getMaxScale(){return this.sectionIndex.reduce((h,U)=>Math.max(h,this.sections[U].scale),0)}addTextSection(h,U){this.text+=h.text,this.sections.push(Ll.forText(h.scale,h.fontStack||U));const W=this.sections.length-1;for(let K=0;K<h.text.length;++K)this.sectionIndex.push(W)}addImageSection(h){const U=h.image?h.image.name:"";if(U.length===0)return void Hr("Can't add FormattedSection with an empty image.");const W=this.getNextImageSectionCharCode();W?(this.text+=String.fromCharCode(W),this.sections.push(Ll.forImage(U)),this.sectionIndex.push(this.sections.length-1)):Hr("Reached maximum number of images 6401")}getNextImageSectionCharCode(){return this.imageSectionID?this.imageSectionID>=63743?null:++this.imageSectionID:(this.imageSectionID=57344,this.imageSectionID)}}function Td(R,h,U,W,K,Q,oe,ce,fe,pe,ve,Ee,we,Ae,Pe){const ze=fu.fromFeature(R,K);Ee===oa.vertical&&ze.verticalizePunctuation(we);let Xe=[];const at=function(bt,$t,zt,rr,yr,Zt){if(!bt)return[];const ar=[],or=function(Cr,$r,Pr,di,Tr,ei){let fi=0;for(let Ii=0;Ii<Cr.length();Ii++){const pi=Cr.getSection(Ii);fi+=Sp(Cr.getCharCode(Ii),pi,di,Tr,$r,ei)}return fi/Math.max(1,Math.ceil(fi/Pr))}(bt,$t,zt,rr,yr,Zt),hr=bt.text.indexOf("​")>=0;let Sr=0;for(let Cr=0;Cr<bt.length();Cr++){const $r=bt.getSection(Cr),Pr=bt.getCharCode(Cr);if(nh[Pr]||(Sr+=Sp(Pr,$r,rr,yr,$t,Zt)),Cr<bt.length()-1){const di=!((Jt=Pr)<11904||!(Dr["Bopomofo Extended"](Jt)||Dr.Bopomofo(Jt)||Dr["CJK Compatibility Forms"](Jt)||Dr["CJK Compatibility Ideographs"](Jt)||Dr["CJK Compatibility"](Jt)||Dr["CJK Radicals Supplement"](Jt)||Dr["CJK Strokes"](Jt)||Dr["CJK Symbols and Punctuation"](Jt)||Dr["CJK Unified Ideographs Extension A"](Jt)||Dr["CJK Unified Ideographs"](Jt)||Dr["Enclosed CJK Letters and Months"](Jt)||Dr["Halfwidth and Fullwidth Forms"](Jt)||Dr.Hiragana(Jt)||Dr["Ideographic Description Characters"](Jt)||Dr["Kangxi Radicals"](Jt)||Dr["Katakana Phonetic Extensions"](Jt)||Dr.Katakana(Jt)||Dr["Vertical Forms"](Jt)||Dr["Yi Radicals"](Jt)||Dr["Yi Syllables"](Jt)));(_y[Pr]||di||$r.imageName)&&ar.push(qp(Cr+1,Sr,or,ar,my(Pr,bt.getCharCode(Cr+1),di&&hr),!1))}}var Jt;return Ip(qp(bt.length(),Sr,or,ar,0,!0))}(ze,pe,Q,h,W,Ae),{processBidirectionalText:mt,processStyledBidirectionalText:ot}=ye;if(mt&&ze.sections.length===1){const bt=mt(ze.toString(),at);for(const $t of bt){const zt=new fu;zt.text=$t,zt.sections=ze.sections;for(let rr=0;rr<$t.length;rr++)zt.sectionIndex.push(0);Xe.push(zt)}}else if(ot){const bt=ot(ze.text,ze.sectionIndex,at);for(const $t of bt){const zt=new fu;zt.text=$t[0],zt.sectionIndex=$t[1],zt.sections=ze.sections,Xe.push(zt)}}else Xe=function(bt,$t){const zt=[],rr=bt.text;let yr=0;for(const Zt of $t)zt.push(bt.substring(yr,Zt)),yr=Zt;return yr<rr.length&&zt.push(bt.substring(yr,rr.length)),zt}(ze,at);const pt=[],Et={positionedLines:pt,text:ze.toString(),top:ve[1],bottom:ve[1],left:ve[0],right:ve[0],writingMode:Ee,iconsInText:!1,verticalizable:!1,hasBaseline:!1};return function(bt,$t,zt,rr,yr,Zt,ar,or,hr,Sr,Jt,Cr){let $r=0,Pr=0,di=0;const Tr=or==="right"?1:or==="left"?0:.5;let ei=!1;for(const _i of yr){const mi=_i.getSections();for(const zi of mi){if(zi.imageName)continue;const Vi=$t[zi.fontStack];if(Vi&&(ei=Vi.ascender!==void 0&&Vi.descender!==void 0,!ei))break}if(!ei)break}let fi=0;for(const _i of yr){_i.trim();const mi=_i.getMaxScale(),zi=(mi-1)*Sn,Vi={positionedGlyphs:[],lineOffset:0};bt.positionedLines[fi]=Vi;const Gi=Vi.positionedGlyphs;let Ni=0;if(!_i.length()){Pr+=Zt,++fi;continue}let Ji=0,nn=0;for(let ji=0;ji<_i.length();ji++){const yn=_i.getSection(ji),pn=_i.getSectionIndex(ji),Qi=_i.getCharCode(ji);let Oi=yn.scale,_n=null,$i=null,Bn=null,mn=Sn,Tn=0;const xn=!(hr===oa.horizontal||!Jt&&!ul(Qi)||Jt&&(nh[Qi]||(Ii=Qi,Dr.Arabic(Ii)||Dr["Arabic Supplement"](Ii)||Dr["Arabic Extended-A"](Ii)||Dr["Arabic Presentation Forms-A"](Ii)||Dr["Arabic Presentation Forms-B"](Ii))));if(yn.imageName){const zn=rr[yn.imageName];if(!zn)continue;Bn=yn.imageName,bt.iconsInText=bt.iconsInText||!0,$i=zn.paddedRect;const En=zn.displaySize;Oi=Oi*Sn/Cr,_n={width:En[0],height:En[1],left:Vn,top:-xp,advance:xn?En[1]:En[0],localGlyph:!1},Tn=ei?-_n.height*Oi:wp+mi*Sn-En[1]*Oi,mn=_n.advance;const Ma=(xn?En[0]:En[1])*Oi-Sn*mi;Ma>0&&Ma>Ni&&(Ni=Ma)}else{const zn=zt[yn.fontStack];if(!zn)continue;zn[Qi]&&($i=zn[Qi]);const En=$t[yn.fontStack];if(!En)continue;const Ma=En.glyphs[Qi];if(!Ma)continue;if(_n=Ma.metrics,mn=Qi!==8203?Sn:0,ei){const bu=En.ascender!==void 0?Math.abs(En.ascender):0,$l=En.descender!==void 0?Math.abs(En.descender):0,Wl=(bu+$l)*Oi;Ji<Wl&&(Ji=Wl,nn=(bu-$l)/2*Oi),Tn=-bu*Oi}else Tn=wp+(mi-Oi)*Sn}xn?(bt.verticalizable=!0,Gi.push({glyph:Qi,imageName:Bn,x:$r,y:Pr+Tn,vertical:xn,scale:Oi,localGlyph:_n.localGlyph,fontStack:yn.fontStack,sectionIndex:pn,metrics:_n,rect:$i}),$r+=mn*Oi+Sr):(Gi.push({glyph:Qi,imageName:Bn,x:$r,y:Pr+Tn,vertical:xn,scale:Oi,localGlyph:_n.localGlyph,fontStack:yn.fontStack,sectionIndex:pn,metrics:_n,rect:$i}),$r+=_n.advance*Oi+Sr)}Gi.length!==0&&(di=Math.max($r-Sr,di),ei?Ap(Gi,Tr,Ni,nn,Zt*mi/2):Ap(Gi,Tr,Ni,0,Zt/2)),$r=0;const fn=Zt*mi+Ni;Vi.lineOffset=Math.max(Ni,zi),Pr+=fn,++fi}var Ii;const pi=Pr,{horizontalAlign:ai,verticalAlign:Wi}=qd(ar);(function(_i,mi,zi,Vi,Gi,Ni){const Ji=(mi-zi)*Gi,nn=-Ni*Vi;for(const fn of _i)for(const ji of fn.positionedGlyphs)ji.x+=Ji,ji.y+=nn})(bt.positionedLines,Tr,ai,Wi,di,pi),bt.top+=-Wi*pi,bt.bottom=bt.top+pi,bt.left+=-ai*di,bt.right=bt.left+di,bt.hasBaseline=ei}(Et,h,U,W,Xe,oe,ce,fe,Ee,pe,we,Pe),!function(bt){for(const $t of bt)if($t.positionedGlyphs.length!==0)return!1;return!0}(pt)&&Et}const nh={9:!0,10:!0,11:!0,12:!0,13:!0,32:!0},_y={10:!0,32:!0,38:!0,40:!0,41:!0,43:!0,45:!0,47:!0,173:!0,183:!0,8203:!0,8208:!0,8211:!0,8231:!0};function Sp(R,h,U,W,K,Q){if(h.imageName){const oe=W[h.imageName];return oe?oe.displaySize[0]*h.scale*Sn/Q+K:0}{const oe=U[h.fontStack],ce=oe&&oe.glyphs[R];return ce?ce.metrics.advance*h.scale+K:0}}function Tp(R,h,U,W){const K=Math.pow(R-h,2);return W?R<h?K/2:2*K:K+Math.abs(U)*U}function my(R,h,U){let W=0;return R===10&&(W-=1e4),U&&(W+=150),R!==40&&R!==65288||(W+=50),h!==41&&h!==65289||(W+=50),W}function qp(R,h,U,W,K,Q){let oe=null,ce=Tp(h,U,K,Q);for(const fe of W){const pe=Tp(h-fe.x,U,K,Q)+fe.badness;pe<=ce&&(oe=fe,ce=pe)}return{index:R,x:h,priorBreak:oe,badness:ce}}function Ip(R){return R?Ip(R.priorBreak).concat(R.index):[]}function qd(R){let h=.5,U=.5;switch(R){case"right":case"top-right":case"bottom-right":h=1;break;case"left":case"top-left":case"bottom-left":h=0}switch(R){case"bottom":case"bottom-right":case"bottom-left":U=1;break;case"top":case"top-right":case"top-left":U=0}return{horizontalAlign:h,verticalAlign:U}}function Ap(R,h,U,W,K){if(!(h||U||W||K))return;const Q=R.length-1,oe=R[Q],ce=(oe.x+oe.metrics.advance*oe.scale)*h;for(let fe=0;fe<=Q;fe++)R[fe].x-=ce,R[fe].y+=U+W+K}function yy(R,h,U){const{horizontalAlign:W,verticalAlign:K}=qd(U),Q=h[0]-R.displaySize[0]*W,oe=h[1]-R.displaySize[1]*K;return{image:R,top:oe,bottom:oe+R.displaySize[1],left:Q,right:Q+R.displaySize[0]}}function Rp(R,h,U,W,K,Q){const oe=R.image;let ce;if(oe.content){const Xe=oe.content,at=oe.pixelRatio||1;ce=[Xe[0]/at,Xe[1]/at,oe.displaySize[0]-Xe[2]/at,oe.displaySize[1]-Xe[3]/at]}const fe=h.left*Q,pe=h.right*Q;let ve,Ee,we,Ae;U==="width"||U==="both"?(Ae=K[0]+fe-W[3],Ee=K[0]+pe+W[1]):(Ae=K[0]+(fe+pe-oe.displaySize[0])/2,Ee=Ae+oe.displaySize[0]);const Pe=h.top*Q,ze=h.bottom*Q;return U==="height"||U==="both"?(ve=K[1]+Pe-W[0],we=K[1]+ze+W[2]):(ve=K[1]+(Pe+ze-oe.displaySize[1])/2,we=ve+oe.displaySize[1]),{image:oe,top:ve,right:Ee,bottom:we,left:Ae,collisionPadding:ce}}class uo extends He{constructor(h,U,W,K,Q){super(h,U),this.angle=K,this.z=W,Q!==void 0&&(this.segment=Q)}clone(){return new uo(this.x,this.y,this.z,this.angle,this.segment)}}function Op(R,h,U,W,K){if(h.segment===void 0)return!0;let Q=h,oe=h.segment+1,ce=0;for(;ce>-U/2;){if(oe--,oe<0)return!1;ce-=R[oe].dist(Q),Q=R[oe]}ce+=R[oe].dist(R[oe+1]),oe++;const fe=[];let pe=0;for(;ce<U/2;){const ve=R[oe],Ee=R[oe+1];if(!Ee)return!1;let we=R[oe-1].angleTo(ve)-ve.angleTo(Ee);for(we=Math.abs((we+3*Math.PI)%(2*Math.PI)-Math.PI),fe.push({distance:ce,angleDelta:we}),pe+=we;ce-fe[0].distance>W;)pe-=fe.shift().angleDelta;if(pe>K)return!1;oe++,ce+=ve.dist(Ee)}return!0}function Cp(R){let h=0;for(let U=0;U<R.length-1;U++)h+=R[U].dist(R[U+1]);return h}function Pp(R,h,U){return R?.6*h*U:0}function Mp(R,h){return Math.max(R?R.right-R.left:0,h?h.right-h.left:0)}function gy(R,h,U,W,K,Q){const oe=Pp(U,K,Q),ce=Mp(U,W)*Q;let fe=0;const pe=Cp(R)/2;for(let ve=0;ve<R.length-1;ve++){const Ee=R[ve],we=R[ve+1],Ae=Ee.dist(we);if(fe+Ae>pe){const Pe=(pe-fe)/Ae,ze=Ti(Ee.x,we.x,Pe),Xe=Ti(Ee.y,we.y,Pe),at=new uo(ze,Xe,0,we.angleTo(Ee),ve);return!oe||Op(R,at,ce,oe,h)?at:void 0}fe+=Ae}}function vy(R,h,U,W,K,Q,oe,ce,fe){const pe=Pp(W,Q,oe),ve=Mp(W,K),Ee=ve*oe,we=R[0].x===0||R[0].x===fe||R[0].y===0||R[0].y===fe;return h-Ee<h/4&&(h=Ee+h/4),Dp(R,we?h/2*ce%h:(ve/2+2*Q)*oe*ce%h,h,pe,U,Ee,we,!1,fe)}function Dp(R,h,U,W,K,Q,oe,ce,fe){const pe=Q/2,ve=Cp(R);let Ee=0,we=h-U,Ae=[];for(let Pe=0;Pe<R.length-1;Pe++){const ze=R[Pe],Xe=R[Pe+1],at=ze.dist(Xe),mt=Xe.angleTo(ze);for(;we+U<Ee+at;){we+=U;const ot=(we-Ee)/at,pt=Ti(ze.x,Xe.x,ot),Et=Ti(ze.y,Xe.y,ot);if(pt>=0&&pt<fe&&Et>=0&&Et<fe&&we-pe>=0&&we+pe<=ve){const bt=new uo(pt,Et,0,mt,Pe);bt._round(),W&&!Op(R,bt,Q,W,K)||Ae.push(bt)}}Ee+=at}return ce||Ae.length||oe||(Ae=Dp(R,Ee/2,U,W,K,Q,oe,!0,fe)),Ae}function Lp(R,h,U,W,K){const Q=[];for(let oe=0;oe<R.length;oe++){const ce=R[oe];let fe;for(let pe=0;pe<ce.length-1;pe++){let ve=ce[pe],Ee=ce[pe+1];ve.x<h&&Ee.x<h||(ve.x<h?ve=new He(h,ve.y+(h-ve.x)/(Ee.x-ve.x)*(Ee.y-ve.y))._round():Ee.x<h&&(Ee=new He(h,ve.y+(h-ve.x)/(Ee.x-ve.x)*(Ee.y-ve.y))._round()),ve.y<U&&Ee.y<U||(ve.y<U?ve=new He(ve.x+(U-ve.y)/(Ee.y-ve.y)*(Ee.x-ve.x),U)._round():Ee.y<U&&(Ee=new He(ve.x+(U-ve.y)/(Ee.y-ve.y)*(Ee.x-ve.x),U)._round()),ve.x>=W&&Ee.x>=W||(ve.x>=W?ve=new He(W,ve.y+(W-ve.x)/(Ee.x-ve.x)*(Ee.y-ve.y))._round():Ee.x>=W&&(Ee=new He(W,ve.y+(W-ve.x)/(Ee.x-ve.x)*(Ee.y-ve.y))._round()),ve.y>=K&&Ee.y>=K||(ve.y>=K?ve=new He(ve.x+(K-ve.y)/(Ee.y-ve.y)*(Ee.x-ve.x),K)._round():Ee.y>=K&&(Ee=new He(ve.x+(K-ve.y)/(Ee.y-ve.y)*(Ee.x-ve.x),K)._round()),fe&&ve.equals(fe[fe.length-1])||(fe=[ve],Q.push(fe)),fe.push(Ee)))))}}return Q}Vr(uo,"Anchor");const Fl=1e20;function Fp(R,h,U,W,K,Q,oe,ce,fe){for(let pe=h;pe<h+W;pe++)kp(R,U*Q+pe,Q,K,oe,ce,fe);for(let pe=U;pe<U+K;pe++)kp(R,pe*Q+h,1,W,oe,ce,fe)}function kp(R,h,U,W,K,Q,oe){Q[0]=0,oe[0]=-Fl,oe[1]=Fl,K[0]=R[h];for(let ce=1,fe=0,pe=0;ce<W;ce++){K[ce]=R[h+ce*U];const ve=ce*ce;do{const Ee=Q[fe];pe=(K[ce]-K[Ee]+ve-Ee*Ee)/(ce-Ee)/2}while(pe<=oe[fe]&&--fe>-1);fe++,Q[fe]=ce,oe[fe]=pe,oe[fe+1]=Fl}for(let ce=0,fe=0;ce<W;ce++){for(;oe[fe+1]<ce;)fe++;const pe=Q[fe],ve=ce-pe;R[h+ce*U]=K[pe]+ve*ve}}const Ca=2,Id={none:0,ideographs:1,all:2};class pu{constructor(h,U,W){this.requestManager=h,this.localGlyphMode=U,this.localFontFamily=W,this.entries={},this.localGlyphs={200:{},400:{},500:{},900:{}}}setURL(h){this.url=h}getGlyphs(h,U){const W=[];for(const K in h)for(const Q of h[K])W.push({stack:K,id:Q});Ft(W,({stack:K,id:Q},oe)=>{let ce=this.entries[K];ce||(ce=this.entries[K]={glyphs:{},requests:{},ranges:{},ascender:void 0,descender:void 0});let fe=ce.glyphs[Q];if(fe!==void 0)return void oe(null,{stack:K,id:Q,glyph:fe});if(fe=this._tinySDF(ce,K,Q),fe)return ce.glyphs[Q]=fe,void oe(null,{stack:K,id:Q,glyph:fe});const pe=Math.floor(Q/256);if(256*pe>65535)return void oe(new Error("glyphs > 65535 not supported"));if(ce.ranges[pe])return void oe(null,{stack:K,id:Q,glyph:fe});let ve=ce.requests[pe];ve||(ve=ce.requests[pe]=[],pu.loadGlyphRange(K,pe,this.url,this.requestManager,(Ee,we)=>{if(we){ce.ascender=we.ascender,ce.descender=we.descender;for(const Ae in we.glyphs)this._doesCharSupportLocalGlyph(+Ae)||(ce.glyphs[+Ae]=we.glyphs[+Ae]);ce.ranges[pe]=!0}for(const Ae of ve)Ae(Ee,we);delete ce.requests[pe]})),ve.push((Ee,we)=>{Ee?oe(Ee):we&&oe(null,{stack:K,id:Q,glyph:we.glyphs[Q]||null})})},(K,Q)=>{if(K)U(K);else if(Q){const oe={};for(const{stack:ce,id:fe,glyph:pe}of Q)oe[ce]===void 0&&(oe[ce]={}),oe[ce].glyphs===void 0&&(oe[ce].glyphs={}),oe[ce].glyphs[fe]=pe&&{id:pe.id,bitmap:pe.bitmap.clone(),metrics:pe.metrics},oe[ce].ascender=this.entries[ce].ascender,oe[ce].descender=this.entries[ce].descender;U(null,oe)}})}_doesCharSupportLocalGlyph(h){return this.localGlyphMode!==Id.none&&(this.localGlyphMode===Id.all?!!this.localFontFamily:!!this.localFontFamily&&(Dr["CJK Unified Ideographs"](h)||Dr["Hangul Syllables"](h)||Dr.Hiragana(h)||Dr.Katakana(h)||Dr["CJK Symbols and Punctuation"](h)))}_tinySDF(h,U,W){const K=this.localFontFamily;if(!K||!this._doesCharSupportLocalGlyph(W))return;let Q=h.tinySDF;if(!Q){let ze="400";/bold/i.test(U)?ze="900":/medium/i.test(U)?ze="500":/light/i.test(U)&&(ze="200"),Q=h.tinySDF=new pu.TinySDF({fontFamily:K,fontWeight:ze,fontSize:24*Ca,buffer:3*Ca,radius:8*Ca}),Q.fontWeight=ze}if(this.localGlyphs[Q.fontWeight][W])return this.localGlyphs[Q.fontWeight][W];const oe=String.fromCharCode(W),{data:ce,width:fe,height:pe,glyphWidth:ve,glyphHeight:Ee,glyphLeft:we,glyphTop:Ae,glyphAdvance:Pe}=Q.draw(oe);return this.localGlyphs[Q.fontWeight][W]={id:W,bitmap:new oo({width:fe,height:pe},ce),metrics:{width:ve/Ca,height:Ee/Ca,left:we/Ca,top:Ae/Ca-27,advance:Pe/Ca,localGlyph:!0}}}}pu.loadGlyphRange=function(R,h,U,W,K){const Q=256*h,oe=Q+255,ce=W.transformRequest(W.normalizeGlyphsURL(U).replace("{fontstack}",R).replace("{range}",`${Q}-${oe}`),tr.Glyphs);Nt(ce,(fe,pe)=>{if(fe)K(fe);else if(pe){const ve={},Ee=function(we){return new ih(we).readFields(dy,{})}(pe);for(const we of Ee.glyphs)ve[we.id]=we;K(null,{glyphs:ve,ascender:Ee.ascender,descender:Ee.descender})}})},pu.TinySDF=class{constructor({fontSize:R=24,buffer:h=3,radius:U=8,cutoff:W=.25,fontFamily:K="sans-serif",fontWeight:Q="normal",fontStyle:oe="normal"}={}){this.buffer=h,this.cutoff=W,this.radius=U;const ce=this.size=R+4*h,fe=this._createCanvas(ce),pe=this.ctx=fe.getContext("2d",{willReadFrequently:!0});pe.font=`${oe} ${Q} ${R}px ${K}`,pe.textBaseline="alphabetic",pe.textAlign="left",pe.fillStyle="black",this.gridOuter=new Float64Array(ce*ce),this.gridInner=new Float64Array(ce*ce),this.f=new Float64Array(ce),this.z=new Float64Array(ce+1),this.v=new Uint16Array(ce)}_createCanvas(R){const h=document.createElement("canvas");return h.width=h.height=R,h}draw(R){const{width:h,actualBoundingBoxAscent:U,actualBoundingBoxDescent:W,actualBoundingBoxLeft:K,actualBoundingBoxRight:Q}=this.ctx.measureText(R),oe=Math.ceil(U),ce=Math.max(0,Math.min(this.size-this.buffer,Math.ceil(Q-K))),fe=Math.min(this.size-this.buffer,oe+Math.ceil(W)),pe=ce+2*this.buffer,ve=fe+2*this.buffer,Ee=Math.max(pe*ve,0),we=new Uint8ClampedArray(Ee),Ae={data:we,width:pe,height:ve,glyphWidth:ce,glyphHeight:fe,glyphTop:oe,glyphLeft:0,glyphAdvance:h};if(ce===0||fe===0)return Ae;const{ctx:Pe,buffer:ze,gridInner:Xe,gridOuter:at}=this;Pe.clearRect(ze,ze,ce,fe),Pe.fillText(R,ze,ze+oe);const mt=Pe.getImageData(ze,ze,ce,fe);at.fill(Fl,0,Ee),Xe.fill(0,0,Ee);for(let ot=0;ot<fe;ot++)for(let pt=0;pt<ce;pt++){const Et=mt.data[4*(ot*ce+pt)+3]/255;if(Et===0)continue;const bt=(ot+ze)*pe+pt+ze;if(Et===1)at[bt]=0,Xe[bt]=Fl;else{const $t=.5-Et;at[bt]=$t>0?$t*$t:0,Xe[bt]=$t<0?$t*$t:0}}Fp(at,0,0,pe,ve,pe,this.f,this.v,this.z),Fp(Xe,ze,ze,ce,fe,pe,this.f,this.v,this.z);for(let ot=0;ot<Ee;ot++){const pt=Math.sqrt(at[ot])-Math.sqrt(Xe[ot]);we[ot]=Math.round(255-255*(pt/this.radius+this.cutoff))}return Ae}};const _u=Vn;function Bp(R,h,U,W){const K=[],Q=R.image,oe=Q.pixelRatio,ce=Q.paddedRect.w-2*_u,fe=Q.paddedRect.h-2*_u,pe=R.right-R.left,ve=R.bottom-R.top,Ee=Q.stretchX||[[0,ce]],we=Q.stretchY||[[0,fe]],Ae=(Zt,ar)=>Zt+ar[1]-ar[0],Pe=Ee.reduce(Ae,0),ze=we.reduce(Ae,0),Xe=ce-Pe,at=fe-ze;let mt=0,ot=Pe,pt=0,Et=ze,bt=0,$t=Xe,zt=0,rr=at;if(Q.content&&W){const Zt=Q.content;mt=ah(Ee,0,Zt[0]),pt=ah(we,0,Zt[1]),ot=ah(Ee,Zt[0],Zt[2]),Et=ah(we,Zt[1],Zt[3]),bt=Zt[0]-mt,zt=Zt[1]-pt,$t=Zt[2]-Zt[0]-ot,rr=Zt[3]-Zt[1]-Et}const yr=(Zt,ar,or,hr)=>{const Sr=oh(Zt.stretch-mt,ot,pe,R.left),Jt=sh(Zt.fixed-bt,$t,Zt.stretch,Pe),Cr=oh(ar.stretch-pt,Et,ve,R.top),$r=sh(ar.fixed-zt,rr,ar.stretch,ze),Pr=oh(or.stretch-mt,ot,pe,R.left),di=sh(or.fixed-bt,$t,or.stretch,Pe),Tr=oh(hr.stretch-pt,Et,ve,R.top),ei=sh(hr.fixed-zt,rr,hr.stretch,ze),fi=new He(Sr,Cr),Ii=new He(Pr,Cr),pi=new He(Pr,Tr),ai=new He(Sr,Tr),Wi=new He(Jt/oe,$r/oe),_i=new He(di/oe,ei/oe),mi=h*Math.PI/180;if(mi){const Gi=Math.sin(mi),Ni=Math.cos(mi),Ji=[Ni,-Gi,Gi,Ni];fi._matMult(Ji),Ii._matMult(Ji),ai._matMult(Ji),pi._matMult(Ji)}const zi=Zt.stretch+Zt.fixed,Vi=ar.stretch+ar.fixed;return{tl:fi,tr:Ii,bl:ai,br:pi,tex:{x:Q.paddedRect.x+_u+zi,y:Q.paddedRect.y+_u+Vi,w:or.stretch+or.fixed-zi,h:hr.stretch+hr.fixed-Vi},writingMode:void 0,glyphOffset:[0,0],sectionIndex:0,pixelOffsetTL:Wi,pixelOffsetBR:_i,minFontScaleX:$t/oe/pe,minFontScaleY:rr/oe/ve,isSDF:U}};if(W&&(Q.stretchX||Q.stretchY)){const Zt=zp(Ee,Xe,Pe),ar=zp(we,at,ze);for(let or=0;or<Zt.length-1;or++){const hr=Zt[or],Sr=Zt[or+1];for(let Jt=0;Jt<ar.length-1;Jt++)K.push(yr(hr,ar[Jt],Sr,ar[Jt+1]))}}else K.push(yr({fixed:0,stretch:-1},{fixed:0,stretch:-1},{fixed:0,stretch:ce+1},{fixed:0,stretch:fe+1}));return K}function ah(R,h,U){let W=0;for(const K of R)W+=Math.max(h,Math.min(U,K[1]))-Math.max(h,Math.min(U,K[0]));return W}function zp(R,h,U){const W=[{fixed:-_u,stretch:0}];for(const[K,Q]of R){const oe=W[W.length-1];W.push({fixed:K-oe.stretch,stretch:oe.stretch}),W.push({fixed:K-oe.stretch,stretch:oe.stretch+(Q-K)})}return W.push({fixed:h+_u,stretch:U}),W}function oh(R,h,U,W){return R/h*U+W}function sh(R,h,U,W){return R-h*U/W}function by(R,h,U,W){const K=h+R.positionedLines[W].lineOffset;return W===0?U+K/2:U+(K+(h+R.positionedLines[W-1].lineOffset))/2}class xy{constructor(h=[],U=Ey){if(this.data=h,this.length=this.data.length,this.compare=U,this.length>0)for(let W=(this.length>>1)-1;W>=0;W--)this._down(W)}push(h){this.data.push(h),this.length++,this._up(this.length-1)}pop(){if(this.length===0)return;const h=this.data[0],U=this.data.pop();return this.length--,this.length>0&&(this.data[0]=U,this._down(0)),h}peek(){return this.data[0]}_up(h){const{data:U,compare:W}=this,K=U[h];for(;h>0;){const Q=h-1>>1,oe=U[Q];if(W(K,oe)>=0)break;U[h]=oe,h=Q}U[h]=K}_down(h){const{data:U,compare:W}=this,K=this.length>>1,Q=U[h];for(;h<K;){let oe=1+(h<<1),ce=U[oe];const fe=oe+1;if(fe<this.length&&W(U[fe],ce)<0&&(oe=fe,ce=U[fe]),W(ce,Q)>=0)break;U[h]=ce,h=oe}U[h]=Q}}function Ey(R,h){return R<h?-1:R>h?1:0}function wy(R,h=1,U=!1){let W=1/0,K=1/0,Q=-1/0,oe=-1/0;const ce=R[0];for(let Ae=0;Ae<ce.length;Ae++){const Pe=ce[Ae];(!Ae||Pe.x<W)&&(W=Pe.x),(!Ae||Pe.y<K)&&(K=Pe.y),(!Ae||Pe.x>Q)&&(Q=Pe.x),(!Ae||Pe.y>oe)&&(oe=Pe.y)}const fe=Math.min(Q-W,oe-K);let pe=fe/2;const ve=new xy([],Sy);if(fe===0)return new He(W,K);for(let Ae=W;Ae<Q;Ae+=fe)for(let Pe=K;Pe<oe;Pe+=fe)ve.push(new mu(Ae+pe,Pe+pe,pe,R));let Ee=function(Ae){let Pe=0,ze=0,Xe=0;const at=Ae[0];for(let mt=0,ot=at.length,pt=ot-1;mt<ot;pt=mt++){const Et=at[mt],bt=at[pt],$t=Et.x*bt.y-bt.x*Et.y;ze+=(Et.x+bt.x)*$t,Xe+=(Et.y+bt.y)*$t,Pe+=3*$t}return new mu(ze/Pe,Xe/Pe,0,Ae)}(R),we=ve.length;for(;ve.length;){const Ae=ve.pop();(Ae.d>Ee.d||!Ee.d)&&(Ee=Ae,U&&console.log("found best %d after %d probes",Math.round(1e4*Ae.d)/1e4,we)),Ae.max-Ee.d<=h||(pe=Ae.h/2,ve.push(new mu(Ae.p.x-pe,Ae.p.y-pe,pe,R)),ve.push(new mu(Ae.p.x+pe,Ae.p.y-pe,pe,R)),ve.push(new mu(Ae.p.x-pe,Ae.p.y+pe,pe,R)),ve.push(new mu(Ae.p.x+pe,Ae.p.y+pe,pe,R)),we+=4)}return U&&(console.log(`num probes: ${we}`),console.log(`best distance: ${Ee.d}`)),Ee.p}function Sy(R,h){return h.max-R.max}class mu{constructor(h,U,W,K){this.p=new He(h,U),this.h=W,this.d=function(Q,oe){let ce=!1,fe=1/0;for(let pe=0;pe<oe.length;pe++){const ve=oe[pe];for(let Ee=0,we=ve.length,Ae=we-1;Ee<we;Ae=Ee++){const Pe=ve[Ee],ze=ve[Ae];Pe.y>Q.y!=ze.y>Q.y&&Q.x<(ze.x-Pe.x)*(Q.y-Pe.y)/(ze.y-Pe.y)+Pe.x&&(ce=!ce),fe=Math.min(fe,Df(Q,Pe,ze))}}return(ce?1:-1)*Math.sqrt(fe)}(this.p,K),this.max=this.d+this.h*Math.SQRT2}}const yu=7,Ad=Number.POSITIVE_INFINITY,Ty=Math.sqrt(2);function Np(R,[h,U]){let W=0,K=0;if(U===Ad){h<0&&(h=0);const Q=h/Ty;switch(R){case"top-right":case"top-left":K=Q-yu;break;case"bottom-right":case"bottom-left":K=-Q+yu;break;case"bottom":K=-h+yu;break;case"top":K=h-yu}switch(R){case"top-right":case"bottom-right":W=-Q;break;case"top-left":case"bottom-left":W=Q;break;case"left":W=h;break;case"right":W=-h}}else{switch(h=Math.abs(h),U=Math.abs(U),R){case"top-right":case"top-left":case"top":K=U-yu;break;case"bottom-right":case"bottom-left":case"bottom":K=-U+yu}switch(R){case"top-right":case"bottom-right":case"right":W=-h;break;case"top-left":case"bottom-left":case"left":W=h}}return[W,K]}function qy(R,h,U,W,K,Q,oe,ce,fe,pe){R.createArrays(),R.tilePixelRatio=ri/(512*R.overscaling),R.compareText={},R.iconsNeedLinear=!1;const ve=R.layers[0].layout,Ee=R.layers[0]._unevaluatedLayout._values,we={};if(R.textSizeData.kind==="composite"){const{minZoom:ze,maxZoom:Xe}=R.textSizeData;we.compositeTextSizes=[Ee["text-size"].possiblyEvaluate(new be(ze),ce),Ee["text-size"].possiblyEvaluate(new be(Xe),ce)]}if(R.iconSizeData.kind==="composite"){const{minZoom:ze,maxZoom:Xe}=R.iconSizeData;we.compositeIconSizes=[Ee["icon-size"].possiblyEvaluate(new be(ze),ce),Ee["icon-size"].possiblyEvaluate(new be(Xe),ce)]}we.layoutTextSize=Ee["text-size"].possiblyEvaluate(new be(fe+1),ce),we.layoutIconSize=Ee["icon-size"].possiblyEvaluate(new be(fe+1),ce),we.textMaxSize=Ee["text-size"].possiblyEvaluate(new be(18),ce);const Ae=ve.get("text-rotation-alignment")==="map"&&ve.get("symbol-placement")!=="point",Pe=ve.get("text-size");for(const ze of R.features){const Xe=ve.get("text-font").evaluate(ze,{},ce).join(","),at=Pe.evaluate(ze,{},ce),mt=we.layoutTextSize.evaluate(ze,{},ce),ot=(we.layoutIconSize.evaluate(ze,{},ce),{horizontal:{},vertical:void 0}),pt=ze.text;let Et,bt=[0,0];if(pt){const rr=pt.toString(),yr=ve.get("text-letter-spacing").evaluate(ze,{},ce)*Sn,Zt=ve.get("text-line-height").evaluate(ze,{},ce)*Sn,ar=kh(rr)?yr:0,or=ve.get("text-anchor").evaluate(ze,{},ce),hr=ve.get("text-variable-anchor");if(!hr){const Pr=ve.get("text-radial-offset").evaluate(ze,{},ce);bt=Pr?Np(or,[Pr*Sn,Ad]):ve.get("text-offset").evaluate(ze,{},ce).map(di=>di*Sn)}let Sr=Ae?"center":ve.get("text-justify").evaluate(ze,{},ce);const Jt=ve.get("symbol-placement")==="point",Cr=Jt?ve.get("text-max-width").evaluate(ze,{},ce)*Sn:1/0,$r=Pr=>{R.allowVerticalPlacement&&sl(rr)&&(ot.vertical=Td(pt,h,U,K,Xe,Cr,Zt,or,Pr,ar,bt,oa.vertical,!0,mt,at))};if(!Ae&&hr){const Pr=Sr==="auto"?hr.map(Tr=>Rd(Tr)):[Sr];let di=!1;for(let Tr=0;Tr<Pr.length;Tr++){const ei=Pr[Tr];if(!ot.horizontal[ei])if(di)ot.horizontal[ei]=ot.horizontal[0];else{const fi=Td(pt,h,U,K,Xe,Cr,Zt,"center",ei,ar,bt,oa.horizontal,!1,mt,at);fi&&(ot.horizontal[ei]=fi,di=fi.positionedLines.length===1)}}$r("left")}else{if(Sr==="auto"&&(Sr=Rd(or)),Jt||ve.get("text-writing-mode").indexOf("horizontal")>=0||!sl(rr)){const Pr=Td(pt,h,U,K,Xe,Cr,Zt,or,Sr,ar,bt,oa.horizontal,!1,mt,at);Pr&&(ot.horizontal[Sr]=Pr)}$r(Jt?"left":Sr)}}let $t=!1;if(ze.icon&&ze.icon.name){const rr=W[ze.icon.name];rr&&(Et=yy(K[ze.icon.name],ve.get("icon-offset").evaluate(ze,{},ce),ve.get("icon-anchor").evaluate(ze,{},ce)),$t=rr.sdf,R.sdfIcons===void 0?R.sdfIcons=rr.sdf:R.sdfIcons!==rr.sdf&&Hr("Style sheet warning: Cannot mix SDF and non-SDF icons in one buffer"),(rr.pixelRatio!==R.pixelRatio||ve.get("icon-rotate").constantOr(1)!==0)&&(R.iconsNeedLinear=!0))}const zt=Up(ot.horizontal)||ot.vertical;R.iconsInText||(R.iconsInText=!!zt&&zt.iconsInText),(zt||Et)&&Iy(R,ze,ot,Et,W,we,mt,0,bt,$t,oe,ce,pe)}Q&&R.generateCollisionDebugBuffers(fe,R.collisionBoxArray)}function Rd(R){switch(R){case"right":case"top-right":case"bottom-right":return"right";case"left":case"top-left":case"bottom-left":return"left"}return"center"}function Iy(R,h,U,W,K,Q,oe,ce,fe,pe,ve,Ee,we){let Ae=Q.textMaxSize.evaluate(h,{},Ee);Ae===void 0&&(Ae=oe);const Pe=R.layers[0].layout,ze=Pe.get("icon-offset").evaluate(h,{},Ee),Xe=Up(U.horizontal)||U.vertical,at=we.name==="globe",mt=Sn,ot=oe/mt,pt=R.tilePixelRatio*Ae/mt,Et=(or=R.overscaling,R.zoom>18&&or>2&&(or>>=1),Math.max(ri/(512*or),1)*Pe.get("symbol-spacing")),bt=Pe.get("text-padding")*R.tilePixelRatio,$t=Pe.get("icon-padding")*R.tilePixelRatio,zt=ut(Pe.get("text-max-angle")),rr=Pe.get("text-rotation-alignment")==="map"&&Pe.get("symbol-placement")!=="point",yr=Pe.get("icon-rotation-alignment")==="map"&&Pe.get("symbol-placement")!=="point",Zt=Pe.get("symbol-placement"),ar=Et/2;var or;const hr=Pe.get("icon-text-fit");let Sr;W&&hr!=="none"&&(R.allowVerticalPlacement&&U.vertical&&(Sr=Rp(W,U.vertical,hr,Pe.get("icon-text-fit-padding"),ze,ot)),Xe&&(W=Rp(W,Xe,hr,Pe.get("icon-text-fit-padding"),ze,ot)));const Jt=(Cr,$r,Pr)=>{if($r.x<0||$r.x>=ri||$r.y<0||$r.y>=ri)return;let di=null;if(at){const{x:Tr,y:ei,z:fi}=we.projectTilePoint($r.x,$r.y,Pr);di={anchor:new uo(Tr,ei,fi,0,void 0),up:we.upVector(Pr,$r.x,$r.y)}}(function(Tr,ei,fi,Ii,pi,ai,Wi,_i,mi,zi,Vi,Gi,Ni,Ji,nn,fn,ji,yn,pn,Qi,Oi,_n,$i,Bn,mn){const Tn=Tr.addToLineVertexArray(ei,Ii);let xn,zn,En,Ma,bu,$l,Wl,x_=0,E_=0,w_=0,S_=0,Gd=-1,$d=-1;const $a={};let T_=Nh("");const ws=fi?fi.anchor:ei;let Wd=0,Hd=0;if(mi._unevaluatedLayout.getValue("text-radial-offset")===void 0?[Wd,Hd]=mi.layout.get("text-offset").evaluate(Oi,{},mn).map(Jn=>Jn*Sn):(Wd=mi.layout.get("text-radial-offset").evaluate(Oi,{},mn)*Sn,Hd=Ad),Tr.allowVerticalPlacement&&pi.vertical){const Jn=pi.vertical;if(nn)$l=Od(Jn),_i&&(Wl=Od(_i));else{const Qn=mi.layout.get("text-rotate").evaluate(Oi,{},mn)+90;En=uh(zi,ws,ei,Vi,Gi,Ni,Jn,Ji,Qn,fn),_i&&(Ma=uh(zi,ws,ei,Vi,Gi,Ni,_i,yn,Qn))}}if(ai){const Jn=mi.layout.get("icon-rotate").evaluate(Oi,{},mn),Qn=mi.layout.get("icon-text-fit")!=="none",Hl=Bp(ai,Jn,$i,Qn),Kd=_i?Bp(_i,Jn,$i,Qn):void 0;zn=uh(zi,ws,ei,Vi,Gi,Ni,ai,yn,Jn),x_=4*Hl.length;const q_=Tr.iconSizeData;let Ss=null;q_.kind==="source"?(Ss=[Oa*mi.layout.get("icon-size").evaluate(Oi,{},mn)],Ss[0]>Po&&Hr(`${Tr.layerIds[0]}: Value for "icon-size" is >= ${kl}. Reduce your "icon-size".`)):q_.kind==="composite"&&(Ss=[Oa*_n.compositeIconSizes[0].evaluate(Oi,{},mn),Oa*_n.compositeIconSizes[1].evaluate(Oi,{},mn)],(Ss[0]>Po||Ss[1]>Po)&&Hr(`${Tr.layerIds[0]}: Value for "icon-size" is >= ${kl}. Reduce your "icon-size".`)),Tr.addSymbols(Tr.icon,Hl,Ss,Qi,pn,Oi,!1,fi,ei,Tn.lineStartIndex,Tn.lineLength,-1,Bn,mn),Gd=Tr.icon.placedSymbolArray.length-1,Kd&&(E_=4*Kd.length,Tr.addSymbols(Tr.icon,Kd,Ss,Qi,pn,Oi,oa.vertical,fi,ei,Tn.lineStartIndex,Tn.lineLength,-1,Bn,mn),$d=Tr.icon.placedSymbolArray.length-1)}for(const Jn in pi.horizontal){const Qn=pi.horizontal[Jn];xn||(T_=Nh(Qn.text),nn?bu=Od(Qn):xn=uh(zi,ws,ei,Vi,Gi,Ni,Qn,Ji,mi.layout.get("text-rotate").evaluate(Oi,{},mn),fn));const Hl=Qn.positionedLines.length===1;if(w_+=jp(Tr,fi,ei,Qn,Wi,mi,nn,Oi,fn,Tn,pi.vertical?oa.horizontal:oa.horizontalOnly,Hl?Object.keys(pi.horizontal):[Jn],$a,Gd,_n,Bn,mn),Hl)break}pi.vertical&&(S_+=jp(Tr,fi,ei,pi.vertical,Wi,mi,nn,Oi,fn,Tn,oa.vertical,["vertical"],$a,$d,_n,Bn,mn));let Bo=-1;const Zd=(Jn,Qn)=>Jn?Math.max(Jn,Qn):Qn;Bo=Zd(bu,Bo),Bo=Zd($l,Bo),Bo=Zd(Wl,Bo);const tg=Bo>-1?1:0;Tr.glyphOffsetArray.length>=Do.MAX_GLYPHS&&Hr("Too many glyphs being rendered in a tile. See https://github.com/mapbox/mapbox-gl-js/issues/2907"),Oi.sortKey!==void 0&&Tr.addToSortKeyRanges(Tr.symbolInstances.length,Oi.sortKey),Tr.symbolInstances.emplaceBack(ws.x,ws.y,ws.z,ei.x,ei.y,$a.right>=0?$a.right:-1,$a.center>=0?$a.center:-1,$a.left>=0?$a.left:-1,$a.vertical>=0?$a.vertical:-1,Gd,$d,T_,xn!==void 0?xn:Tr.collisionBoxArray.length,xn!==void 0?xn+1:Tr.collisionBoxArray.length,En!==void 0?En:Tr.collisionBoxArray.length,En!==void 0?En+1:Tr.collisionBoxArray.length,zn!==void 0?zn:Tr.collisionBoxArray.length,zn!==void 0?zn+1:Tr.collisionBoxArray.length,Ma||Tr.collisionBoxArray.length,Ma?Ma+1:Tr.collisionBoxArray.length,Vi,w_,S_,x_,E_,tg,0,Wd,Hd,Bo)})(R,$r,di,Cr,U,W,K,Sr,R.layers[0],R.collisionBoxArray,h.index,h.sourceLayerIndex,R.index,bt,rr,fe,0,$t,yr,ze,h,Q,pe,ve,Ee)};if(Zt==="line")for(const Cr of Lp(h.geometry,0,0,ri,ri)){const $r=vy(Cr,Et,zt,U.vertical||Xe,W,mt,pt,R.overscaling,ri);for(const Pr of $r)Xe&&Ay(R,Xe.text,ar,Pr)||Jt(Cr,Pr,Ee)}else if(Zt==="line-center"){for(const Cr of h.geometry)if(Cr.length>1){const $r=gy(Cr,zt,U.vertical||Xe,W,mt,pt);$r&&Jt(Cr,$r,Ee)}}else if(h.type==="Polygon")for(const Cr of md(h.geometry,0)){const $r=wy(Cr,16);Jt(Cr[0],new uo($r.x,$r.y,0,0,void 0),Ee)}else if(h.type==="LineString")for(const Cr of h.geometry)Jt(Cr,new uo(Cr[0].x,Cr[0].y,0,0,void 0),Ee);else if(h.type==="Point")for(const Cr of h.geometry)for(const $r of Cr)Jt([$r],new uo($r.x,$r.y,0,0,void 0),Ee)}const kl=255,Po=kl*Oa;function jp(R,h,U,W,K,Q,oe,ce,fe,pe,ve,Ee,we,Ae,Pe,ze,Xe){const at=function(pt,Et,bt,$t,zt,rr,yr,Zt){const ar=[];if(Et.positionedLines.length===0)return ar;const or=$t.layout.get("text-rotate").evaluate(rr,{})*Math.PI/180,hr=function(Pr){const di=Pr[0],Tr=Pr[1],ei=di*Tr;return ei>0?[di,-Tr]:ei<0?[-di,Tr]:di===0?[Tr,di]:[Tr,-di]}(bt);let Sr=Math.abs(Et.top-Et.bottom);for(const Pr of Et.positionedLines)Sr-=Pr.lineOffset;const Jt=Et.positionedLines.length,Cr=Sr/Jt;let $r=Et.top-bt[1];for(let Pr=0;Pr<Jt;++Pr){const di=Et.positionedLines[Pr];$r=by(Et,Cr,$r,Pr);for(const Tr of di.positionedGlyphs){if(!Tr.rect)continue;const ei=Tr.rect||{};let fi=xp+1,Ii=!0,pi=1,ai=0;if(Tr.imageName){const $i=yr[Tr.imageName];if(!$i)continue;if($i.sdf){Hr("SDF images are not supported in formatted text and will be ignored.");continue}Ii=!1,pi=$i.pixelRatio,fi=Vn/pi}const Wi=(zt||Zt)&&Tr.vertical,_i=Tr.metrics.advance*Tr.scale/2,mi=Tr.metrics,zi=Tr.rect;if(zi===null)continue;Zt&&Et.verticalizable&&(ai=Tr.imageName?_i-Tr.metrics.width*Tr.scale/2:0);const Vi=zt?[Tr.x+_i,Tr.y]:[0,0];let Gi=[0,0],Ni=[0,0],Ji=!1;zt||(Wi?(Ni=[Tr.x+_i+hr[0],Tr.y+hr[1]-ai],Ji=!0):Gi=[Tr.x+_i+bt[0],Tr.y+bt[1]-ai]);const nn=zi.w*Tr.scale/(pi*(Tr.localGlyph?Ca:1)),fn=zi.h*Tr.scale/(pi*(Tr.localGlyph?Ca:1));let ji,yn,pn,Qi;if(Wi){const $i=Tr.y-$r,Bn=new He(-_i,_i-$i),mn=-Math.PI/2,Tn=new He(...Ni);ji=new He(-_i+Gi[0],Gi[1]),ji._rotateAround(mn,Bn)._add(Tn),ji.x+=-$i+_i,ji.y-=(mi.left-fi)*Tr.scale;const xn=Tr.imageName?mi.advance*Tr.scale:Sn*Tr.scale,zn=String.fromCharCode(Tr.glyph);ty(zn)?ji.x+=(1-fi)*Tr.scale:ry(zn)?ji.x+=xn-mi.height*Tr.scale+(-fi-1)*Tr.scale:ji.x+=Tr.imageName||mi.width+2*fi===zi.w&&mi.height+2*fi===zi.h?(xn-fn)/2:(xn-(mi.height+2*fi)*Tr.scale)/2,yn=new He(ji.x,ji.y-nn),pn=new He(ji.x+fn,ji.y),Qi=new He(ji.x+fn,ji.y-nn)}else{const $i=(mi.left-fi)*Tr.scale-_i+Gi[0],Bn=(-mi.top-fi)*Tr.scale+Gi[1],mn=$i+nn,Tn=Bn+fn;ji=new He($i,Bn),yn=new He(mn,Bn),pn=new He($i,Tn),Qi=new He(mn,Tn)}if(or){let $i;$i=zt?new He(0,0):Ji?new He(hr[0],hr[1]):new He(bt[0],bt[1]),ji._rotateAround(or,$i),yn._rotateAround(or,$i),pn._rotateAround(or,$i),Qi._rotateAround(or,$i)}const Oi=new He(0,0),_n=new He(0,0);ar.push({tl:ji,tr:yn,bl:pn,br:Qi,tex:ei,writingMode:Et.writingMode,glyphOffset:Vi,sectionIndex:Tr.sectionIndex,isSDF:Ii,pixelOffsetTL:Oi,pixelOffsetBR:_n,minFontScaleX:0,minFontScaleY:0})}}return ar}(0,W,fe,Q,oe,ce,K,R.allowVerticalPlacement),mt=R.textSizeData;let ot=null;mt.kind==="source"?(ot=[Oa*Q.layout.get("text-size").evaluate(ce,{},Xe)],ot[0]>Po&&Hr(`${R.layerIds[0]}: Value for "text-size" is >= ${kl}. Reduce your "text-size".`)):mt.kind==="composite"&&(ot=[Oa*Pe.compositeTextSizes[0].evaluate(ce,{},Xe),Oa*Pe.compositeTextSizes[1].evaluate(ce,{},Xe)],(ot[0]>Po||ot[1]>Po)&&Hr(`${R.layerIds[0]}: Value for "text-size" is >= ${kl}. Reduce your "text-size".`)),R.addSymbols(R.text,at,ot,fe,oe,ce,ve,h,U,pe.lineStartIndex,pe.lineLength,Ae,ze,Xe);for(const pt of Ee)we[pt]=R.text.placedSymbolArray.length-1;return 4*at.length}function Up(R){for(const h in R)return R[h];return null}function uh(R,h,U,W,K,Q,oe,ce,fe,pe){let ve=oe.top,Ee=oe.bottom,we=oe.left,Ae=oe.right;const Pe=oe.collisionPadding;if(Pe&&(we-=Pe[0],ve-=Pe[1],Ae+=Pe[2],Ee+=Pe[3]),fe){const ze=new He(we,ve),Xe=new He(Ae,ve),at=new He(we,Ee),mt=new He(Ae,Ee),ot=ut(fe);let pt=new He(0,0);pe&&(pt=new He(pe[0],pe[1])),ze._rotateAround(ot,pt),Xe._rotateAround(ot,pt),at._rotateAround(ot,pt),mt._rotateAround(ot,pt),we=Math.min(ze.x,Xe.x,at.x,mt.x),Ae=Math.max(ze.x,Xe.x,at.x,mt.x),ve=Math.min(ze.y,Xe.y,at.y,mt.y),Ee=Math.max(ze.y,Xe.y,at.y,mt.y)}return R.emplaceBack(h.x,h.y,h.z,U.x,U.y,we,ve,Ae,Ee,ce,W,K,Q),R.length-1}function Od(R){R.collisionPadding&&(R.top-=R.collisionPadding[1],R.bottom+=R.collisionPadding[3]);const h=R.bottom-R.top;return h>0?Math.max(10,h):null}function Ay(R,h,U,W){const K=R.compareText;if(h in K){const Q=K[h];for(let oe=Q.length-1;oe>=0;oe--)if(W.dist(Q[oe])<U)return!0}else K[h]=[];return K[h].push(W),!1}function Vp(R,h){const U=R.fovAboveCenter,W=R.elevation?R.elevation.getMinElevationBelowMSL()*h:0,K=(R._camera.position[2]*R.worldSize-W)/Math.cos(R._pitch),Q=Math.sin(U)*K/Math.sin(Math.max(Math.PI/2-R._pitch-U,.01)),oe=Math.sin(R._pitch)*Q+K;return Math.min(1.01*oe,K*(1/R._horizonShift))}function xs(R,h){if(!h.isReprojectedInTileSpace)return{scale:1<<R.z,x:R.x,y:R.y,x2:R.x+1,y2:R.y+1,projection:h};const U=Math.pow(2,-R.z),W=R.x*U,K=(R.x+1)*U,Q=R.y*U,oe=(R.y+1)*U,ce=aa(W),fe=aa(K),pe=Rn(Q),ve=Rn(oe),Ee=h.project(ce,pe),we=h.project(fe,pe),Ae=h.project(fe,ve),Pe=h.project(ce,ve);let ze=Math.min(Ee.x,we.x,Ae.x,Pe.x),Xe=Math.min(Ee.y,we.y,Ae.y,Pe.y),at=Math.max(Ee.x,we.x,Ae.x,Pe.x),mt=Math.max(Ee.y,we.y,Ae.y,Pe.y);const ot=U/16;function pt(bt,$t,zt,rr,yr,Zt){const ar=(zt+yr)/2,or=(rr+Zt)/2,hr=h.project(aa(ar),Rn(or)),Sr=Math.max(0,ze-hr.x,Xe-hr.y,hr.x-at,hr.y-mt);ze=Math.min(ze,hr.x),at=Math.max(at,hr.x),Xe=Math.min(Xe,hr.y),mt=Math.max(mt,hr.y),Sr>ot&&(pt(bt,hr,zt,rr,ar,or),pt(hr,$t,ar,or,yr,Zt))}pt(Ee,we,W,Q,K,Q),pt(we,Ae,K,Q,K,oe),pt(Ae,Pe,K,oe,W,oe),pt(Pe,Ee,W,oe,W,Q),ze-=ot,Xe-=ot,at+=ot,mt+=ot;const Et=1/Math.max(at-ze,mt-Xe);return{scale:Et,x:ze*Et,y:Xe*Et,x2:at*Et,y2:mt*Et,projection:h}}const Ry=Ia(new Float32Array(16));class Mo{constructor(h){this.spec=h,this.name=h.name,this.wrap=!1,this.requiresDraping=!1,this.supportsWorldCopies=!1,this.supportsTerrain=!1,this.supportsFog=!1,this.supportsFreeCamera=!1,this.zAxisUnit="meters",this.isReprojectedInTileSpace=!0,this.unsupportedLayers=["custom"],this.center=[0,0],this.range=[3.5,7]}project(h,U){return{x:0,y:0,z:0}}unproject(h,U){return new Bi(0,0)}projectTilePoint(h,U,W){return{x:h,y:U,z:0}}locationPoint(h,U,W=!0){return h._coordinatePoint(h.locationCoordinate(U),W)}pixelsPerMeter(h,U){return Ra(1,h)*U}pixelSpaceConversion(h,U,W){return 1}farthestPixelDistance(h){return Vp(h,h.pixelsPerMeter)}pointCoordinate(h,U,W,K){const Q=h.horizonLineFromTop(!1),oe=new He(U,Math.max(Q,W));return h.rayIntersectionCoordinate(h.pointRayIntersection(oe,K))}pointCoordinate3D(h,U,W){const K=new He(U,W);if(h.elevation)return h.elevation.pointCoordinate(K);{const Q=this.pointCoordinate(h,K.x,K.y,0);return[Q.x,Q.y,Q.z]}}isPointAboveHorizon(h,U){if(h.elevation)return!this.pointCoordinate3D(h,U.x,U.y);const W=h.horizonLineFromTop();return U.y<W}createInversionMatrix(h,U){return Ry}createTileMatrix(h,U,W){let K,Q,oe;const ce=W.canonical,fe=Ia(new Float64Array(16));if(this.isReprojectedInTileSpace){const pe=xs(ce,this);K=1,Q=pe.x+W.wrap*pe.scale,oe=pe.y,fs(fe,fe,[K/pe.scale,K/pe.scale,h.pixelsPerMeter/U])}else K=U/h.zoomScale(ce.z),Q=(ce.x+Math.pow(2,ce.z)*W.wrap)*K,oe=ce.y*K;return pl(fe,fe,[Q,oe,0]),fs(fe,fe,[K/ri,K/ri,1]),fe}upVector(h,U,W){return[0,0,1]}upVectorScale(h,U,W){return{metersToTile:1}}}class Oy extends Mo{constructor(h){super(h),this.range=[4,7],this.center=h.center||[-96,37.5];const[U,W]=this.parallels=h.parallels||[29.5,45.5],K=Math.sin(ut(U));this.n=(K+Math.sin(ut(W)))/2,this.c=1+K*(2*this.n-K),this.r0=Math.sqrt(this.c)/this.n}project(h,U){const{n:W,c:K,r0:Q}=this,oe=ut(h-this.center[0]),ce=ut(U),fe=Math.sqrt(K-2*W*Math.sin(ce))/W;return{x:fe*Math.sin(oe*W),y:fe*Math.cos(oe*W)-Q,z:0}}unproject(h,U){const{n:W,c:K,r0:Q}=this,oe=Q+U;let ce=Math.atan2(h,Math.abs(oe))*Math.sign(oe);oe*W<0&&(ce-=Math.PI*Math.sign(h)*Math.sign(oe));const fe=ut(this.center[0])*W;ce=wt(ce,-Math.PI-fe,Math.PI-fe);const pe=nt(yt(ce/W)+this.center[0],-180,180),ve=Math.asin(nt((K-(h*h+oe*oe)*W*W)/(2*W),-1,1)),Ee=nt(yt(ve),-On,On);return new Bi(pe,Ee)}}const Bl=1.340264,zl=-.081106,Nl=893e-6,jl=.003796,lh=Math.sqrt(3)/2;class Cy extends Mo{project(h,U){U=U/180*Math.PI,h=h/180*Math.PI;const W=Math.asin(lh*Math.sin(U)),K=W*W,Q=K*K*K;return{x:.5*(h*Math.cos(W)/(lh*(Bl+3*zl*K+Q*(7*Nl+9*jl*K)))/Math.PI+.5),y:1-.5*(W*(Bl+zl*K+Q*(Nl+jl*K))/Math.PI+1),z:0}}unproject(h,U){h=(2*h-.5)*Math.PI;let W=U=(2*(1-U)-1)*Math.PI,K=W*W,Q=K*K*K;for(let ve,Ee,we,Ae=0;Ae<12&&(Ee=W*(Bl+zl*K+Q*(Nl+jl*K))-U,we=Bl+3*zl*K+Q*(7*Nl+9*jl*K),ve=Ee/we,W=nt(W-ve,-Math.PI/3,Math.PI/3),K=W*W,Q=K*K*K,!(Math.abs(ve)<1e-12));++Ae);const oe=lh*h*(Bl+3*zl*K+Q*(7*Nl+9*jl*K))/Math.cos(W),ce=Math.asin(Math.sin(W)/lh),fe=nt(180*oe/Math.PI,-180,180),pe=nt(180*ce/Math.PI,-On,On);return new Bi(fe,pe)}}class Py extends Mo{constructor(h){super(h),this.wrap=!0,this.supportsWorldCopies=!0}project(h,U){return{x:.5+h/360,y:.5-U/360,z:0}}unproject(h,U){const W=360*(h-.5),K=nt(360*(.5-U),-On,On);return new Bi(W,K)}}const gu=Math.PI/2;function ch(R){return Math.tan((gu+R)/2)}class My extends Mo{constructor(h){super(h),this.center=h.center||[0,30];const[U,W]=this.parallels=h.parallels||[30,30];let K=ut(U),Q=ut(W);this.southernCenter=K+Q<0,this.southernCenter&&(K=-K,Q=-Q);const oe=Math.cos(K),ce=ch(K);this.n=K===Q?Math.sin(K):Math.log(oe/Math.cos(Q))/Math.log(ch(Q)/ce),this.f=oe*Math.pow(ch(K),this.n)/this.n}project(h,U){U=ut(U),this.southernCenter&&(U=-U),h=ut(h-this.center[0]);const W=1e-6,{n:K,f:Q}=this;Q>0?U<-gu+W&&(U=-gu+W):U>gu-W&&(U=gu-W);const oe=Q/Math.pow(ch(U),K);let ce=oe*Math.sin(K*h),fe=Q-oe*Math.cos(K*h);return ce=.5*(ce/Math.PI+.5),fe=.5*(fe/Math.PI+.5),{x:ce,y:this.southernCenter?fe:1-fe,z:0}}unproject(h,U){h=(2*h-.5)*Math.PI,this.southernCenter&&(U=1-U),U=(2*(1-U)-.5)*Math.PI;const{n:W,f:K}=this,Q=K-U,oe=Math.sign(Q),ce=Math.sign(W)*Math.sqrt(h*h+Q*Q);let fe=Math.atan2(h,Math.abs(Q))*oe;Q*W<0&&(fe-=Math.PI*Math.sign(h)*oe);const pe=nt(yt(fe/W)+this.center[0],-180,180),ve=nt(yt(2*Math.atan(Math.pow(K/ce,1/W))-gu),-On,On);return new Bi(pe,this.southernCenter?-ve:ve)}}class Gp extends Mo{constructor(h){super(h),this.wrap=!0,this.supportsWorldCopies=!0,this.supportsTerrain=!0,this.supportsFog=!0,this.supportsFreeCamera=!0,this.isReprojectedInTileSpace=!1,this.unsupportedLayers=[],this.range=null}project(h,U){return{x:Na(h),y:ja(U),z:0}}unproject(h,U){const W=aa(h),K=Rn(U);return new Bi(W,K)}}const $p=ut(On);class Dy extends Mo{project(h,U){const W=(U=ut(U))*U,K=W*W;return{x:.5*((h=ut(h))*(.8707-.131979*W+K*(K*(.003971*W-.001529*K)-.013791))/Math.PI+.5),y:1-.5*(U*(1.007226+W*(.015085+K*(.028874*W-.044475-.005916*K)))/Math.PI+1),z:0}}unproject(h,U){h=(2*h-.5)*Math.PI;let W=U=(2*(1-U)-1)*Math.PI,K=25,Q=0,oe=W*W;do{oe=W*W;const pe=oe*oe;Q=(W*(1.007226+oe*(.015085+pe*(.028874*oe-.044475-.005916*pe)))-U)/(1.007226+oe*(.045255+pe*(.259866*oe-.311325-.005916*11*pe))),W=nt(W-Q,-$p,$p)}while(Math.abs(Q)>1e-6&&--K>0);oe=W*W;const ce=nt(yt(h/(.8707+oe*(oe*(oe*oe*oe*(.003971-.001529*oe)-.013791)-.131979))),-180,180),fe=yt(W);return new Bi(ce,fe)}}const Wp=ut(On);class Ly extends Mo{project(h,U){U=ut(U),h=ut(h);const W=Math.cos(U),K=2/Math.PI,Q=Math.acos(W*Math.cos(h/2)),oe=Math.sin(Q)/Q,ce=.5*(h*K+2*W*Math.sin(h/2)/oe)||0,fe=.5*(U+Math.sin(U)/oe)||0;return{x:.5*(ce/Math.PI+.5),y:1-.5*(fe/Math.PI+1),z:0}}unproject(h,U){let W=h=(2*h-.5)*Math.PI,K=U=(2*(1-U)-1)*Math.PI,Q=25;const oe=1e-6;let ce=0,fe=0;do{const pe=Math.cos(K),ve=Math.sin(K),Ee=2*ve*pe,we=ve*ve,Ae=pe*pe,Pe=Math.cos(W/2),ze=Math.sin(W/2),Xe=2*Pe*ze,at=ze*ze,mt=1-Ae*Pe*Pe,ot=mt?1/mt:0,pt=mt?Math.acos(pe*Pe)*Math.sqrt(1/mt):0,Et=.5*(2*pt*pe*ze+2*W/Math.PI)-h,bt=.5*(pt*ve+K)-U,$t=.5*ot*(Ae*at+pt*pe*Pe*we)+1/Math.PI,zt=ot*(Xe*Ee/4-pt*ve*ze),rr=.125*ot*(Ee*ze-pt*ve*Ae*Xe),yr=.5*ot*(we*Pe+pt*at*pe)+.5,Zt=zt*rr-yr*$t;ce=(bt*zt-Et*yr)/Zt,fe=(Et*rr-bt*$t)/Zt,W=nt(W-ce,-Math.PI,Math.PI),K=nt(K-fe,-Wp,Wp)}while((Math.abs(ce)>oe||Math.abs(fe)>oe)&&--Q>0);return new Bi(yt(W),yt(K))}}class Hp extends Mo{constructor(h){super(h),this.center=h.center||[0,0],this.parallels=h.parallels||[0,0],this.cosPhi=Math.max(.01,Math.cos(ut(this.parallels[0]))),this.scale=1/(2*Math.max(Math.PI*this.cosPhi,1/this.cosPhi)),this.wrap=!0,this.supportsWorldCopies=!0}project(h,U){const{scale:W,cosPhi:K}=this;return{x:ut(h)*K*W+.5,y:-Math.sin(ut(U))/K*W+.5,z:0}}unproject(h,U){const{scale:W,cosPhi:K}=this,Q=-(U-.5)/W,oe=nt(yt((h-.5)/W)/K,-180,180),ce=Math.asin(nt(Q*K,-1,1)),fe=nt(yt(ce),-On,On);return new Bi(oe,fe)}}class Fy extends Gp{constructor(h){super(h),this.requiresDraping=!0,this.supportsWorldCopies=!1,this.supportsFog=!0,this.zAxisUnit="pixels",this.unsupportedLayers=["debug"],this.range=[3,5]}projectTilePoint(h,U,W){const K=El(h,U,W);return un(K,K,wl(za(W))),{x:K[0],y:K[1],z:K[2]}}locationPoint(h,U){const W=iu(U.lat,U.lng),K=Ln([],W),Q=h.elevation?h.elevation.getAtPointOrZero(h.locationCoordinate(U),h._centerAltitude):h._centerAltitude;gl(W,W,K,Ra(1,0)*ri*Q);const oe=Ia(new Float64Array(16));return ds(oe,h.pixelMatrix,h.globeMatrix),un(W,W,oe),new He(W[0],W[1])}pixelsPerMeter(h,U){return Ra(1,0)*U}pixelSpaceConversion(h,U,W){const K=Ra(1,h)*U,Q=Ti(Ra(1,45)*U,K,W);return this.pixelsPerMeter(h,U)/Q}createTileMatrix(h,U,W){const K=ed(za(W.canonical));return ds(new Float64Array(16),h.globeMatrix,K)}createInversionMatrix(h,U){const{center:W}=h,K=wl(za(U));return Bc(K,K,ut(W.lng)),Gh(K,K,ut(W.lat)),fs(K,K,[h._pixelsPerMercatorPixel,h._pixelsPerMercatorPixel,1]),Float32Array.from(K)}pointCoordinate(h,U,W,K){return bf(h,U,W,!0)||new au(0,0)}pointCoordinate3D(h,U,W){const K=this.pointCoordinate(h,U,W,0);return[K.x,K.y,K.z]}isPointAboveHorizon(h,U){return!bf(h,U.x,U.y,!1)}farthestPixelDistance(h){const U=function(K,Q){const oe=K.cameraToCenterDistance,ce=K._centerAltitude*Q,fe=K._camera,pe=K._camera.forward(),ve=no([],na([],pe,-oe),[0,0,ce]),Ee=K.worldSize/(2*Math.PI),we=[0,0,-Ee],Ae=K.width/K.height,Pe=Math.tan(K.fovAboveCenter),ze=na([],fe.up(),Pe),Xe=na([],fe.right(),Pe*Ae),at=Ln([],no([],no([],pe,ze),Xe)),mt=[];let ot;if(new Zh(ve,at).closestPointOnSphere(we,Ee,mt)){const pt=no([],mt,we),Et=Aa([],pt,ve);ot=Math.cos(K.fovAboveCenter)*_l(Et)}else{const pt=Aa([],ve,we),Et=Aa([],we,ve);Ln(Et,Et);const bt=_l(pt)-Ee;ot=Math.sqrt(bt*(bt+2*Ee));const $t=Math.acos(ot/(Ee+bt))-Math.acos(da(pe,Et));ot*=Math.cos($t)}return 1.01*ot}(h,this.pixelsPerMeter(h.center.lat,h.worldSize)),W=nu(h.zoom);if(W>0){const K=Vp(h,Ra(1,h.center.lat)*h.worldSize),Q=h.worldSize/(2*Math.PI),oe=Math.max(h.width,h.height)/h.worldSize*Math.PI;return Ti(U,K+Q*(1-Math.cos(oe)),Math.pow(W,10))}return U}upVector(h,U,W){return El(U,W,h,1)}upVectorScale(h){return{metersToTile:zc(jc(za(h)))}}}function Zp(R){const h=R.parallels,U=!!h&&Math.abs(h[0]+h[1])<.01;switch(R.name){case"mercator":return new Gp(R);case"equirectangular":return new Py(R);case"naturalEarth":return new Dy(R);case"equalEarth":return new Cy(R);case"winkelTripel":return new Ly(R);case"albers":return U?new Hp(R):new Oy(R);case"lambertConformalConic":return U?new Hp(R):new My(R);case"globe":return new Fy(R)}throw new Error(`Invalid projection name: ${R.name}`)}const ky=Yc.types,By=[{name:"a_fade_opacity",components:1,type:"Uint8",offset:0}];function hh(R,h,U,W,K,Q,oe,ce,fe,pe,ve,Ee,we){const Ae=ce?Math.min(Po,Math.round(ce[0])):0,Pe=ce?Math.min(Po,Math.round(ce[1])):0;R.emplaceBack(h,U,Math.round(32*W),Math.round(32*K),Q,oe,(Ae<<1)+(fe?1:0),Pe,16*pe,16*ve,256*Ee,256*we)}function dh(R,h,U,W,K,Q,oe){R.emplaceBack(h,U,W,K,Q,oe)}function fh(R,h,U,W,K){R.emplaceBack(h,U,W,K),R.emplaceBack(h,U,W,K),R.emplaceBack(h,U,W,K),R.emplaceBack(h,U,W,K)}function zy(R){for(const h of R.sections)if(zh(h.text))return!0;return!1}class Cd{constructor(h){this.layoutVertexArray=new ur,this.indexArray=new Zr,this.programConfigurations=h,this.segments=new hn,this.dynamicLayoutVertexArray=new pr,this.opacityVertexArray=new Jr,this.placedSymbolArray=new cn,this.globeExtVertexArray=new xr}isEmpty(){return this.layoutVertexArray.length===0&&this.indexArray.length===0&&this.dynamicLayoutVertexArray.length===0&&this.opacityVertexArray.length===0}upload(h,U,W,K){this.isEmpty()||(W&&(this.layoutVertexBuffer=h.createVertexBuffer(this.layoutVertexArray,Hm.members),this.indexBuffer=h.createIndexBuffer(this.indexArray,U),this.dynamicLayoutVertexBuffer=h.createVertexBuffer(this.dynamicLayoutVertexArray,Km.members,!0),this.opacityVertexBuffer=h.createVertexBuffer(this.opacityVertexArray,By,!0),this.globeExtVertexArray.length>0&&(this.globeExtVertexBuffer=h.createVertexBuffer(this.globeExtVertexArray,Zm.members,!0)),this.opacityVertexBuffer.itemSize=1),(W||K)&&this.programConfigurations.upload(h))}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy(),this.dynamicLayoutVertexBuffer.destroy(),this.opacityVertexBuffer.destroy(),this.globeExtVertexBuffer&&this.globeExtVertexBuffer.destroy())}}Vr(Cd,"SymbolBuffers");class Pd{constructor(h,U,W){this.layoutVertexArray=new h,this.layoutAttributes=U,this.indexArray=new W,this.segments=new hn,this.collisionVertexArray=new xi,this.collisionVertexArrayExt=new gi}upload(h){this.layoutVertexBuffer=h.createVertexBuffer(this.layoutVertexArray,this.layoutAttributes),this.indexBuffer=h.createIndexBuffer(this.indexArray),this.collisionVertexBuffer=h.createVertexBuffer(this.collisionVertexArray,Xm.members,!0),this.collisionVertexBufferExt=h.createVertexBuffer(this.collisionVertexArrayExt,Ym.members,!0)}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.segments.destroy(),this.collisionVertexBuffer.destroy(),this.collisionVertexBufferExt.destroy())}}Vr(Pd,"CollisionBuffers");class Do{constructor(h){this.collisionBoxArray=h.collisionBoxArray,this.zoom=h.zoom,this.overscaling=h.overscaling,this.layers=h.layers,this.layerIds=this.layers.map(oe=>oe.id),this.index=h.index,this.pixelRatio=h.pixelRatio,this.sourceLayerIndex=h.sourceLayerIndex,this.hasPattern=!1,this.hasRTLText=!1,this.fullyClipped=!1,this.sortKeyRanges=[],this.collisionCircleArray=[],this.placementInvProjMatrix=Ia([]),this.placementViewportMatrix=Ia([]);const U=this.layers[0]._unevaluatedLayout._values;this.textSizeData=bd(this.zoom,U["text-size"]),this.iconSizeData=bd(this.zoom,U["icon-size"]);const W=this.layers[0].layout,K=W.get("symbol-sort-key"),Q=W.get("symbol-z-order");this.canOverlap=W.get("text-allow-overlap")||W.get("icon-allow-overlap")||W.get("text-ignore-placement")||W.get("icon-ignore-placement"),this.sortFeaturesByKey=Q!=="viewport-y"&&K.constantOr(1)!==void 0,this.sortFeaturesByY=(Q==="viewport-y"||Q==="auto"&&!this.sortFeaturesByKey)&&this.canOverlap,this.writingModes=W.get("text-writing-mode").map(oe=>oa[oe]),this.stateDependentLayerIds=this.layers.filter(oe=>oe.isStateDependent()).map(oe=>oe.id),this.sourceID=h.sourceID,this.projection=h.projection}createArrays(){this.text=new Cd(new hs(this.layers,this.zoom,h=>/^text/.test(h))),this.icon=new Cd(new hs(this.layers,this.zoom,h=>/^icon/.test(h))),this.glyphOffsetArray=new Dn,this.lineVertexArray=new Js,this.symbolInstances=new Ki}calculateGlyphDependencies(h,U,W,K,Q){for(let oe=0;oe<h.length;oe++)if(U[h.charCodeAt(oe)]=!0,K&&Q){const ce=Dl[h.charAt(oe)];ce&&(U[ce.charCodeAt(0)]=!0)}}populate(h,U,W,K){const Q=this.layers[0],oe=Q.layout,ce=this.projection.name==="globe",fe=oe.get("text-font"),pe=oe.get("text-field"),ve=oe.get("icon-image"),Ee=(pe.value.kind!=="constant"||pe.value.value instanceof Mn&&!pe.value.value.isEmpty()||pe.value.value.toString().length>0)&&(fe.value.kind!=="constant"||fe.value.value.length>0),we=ve.value.kind!=="constant"||!!ve.value.value||Object.keys(ve.parameters).length>0,Ae=oe.get("symbol-sort-key");if(this.features=[],!Ee&&!we)return;const Pe=U.iconDependencies,ze=U.glyphDependencies,Xe=U.availableImages,at=new be(this.zoom);for(const{feature:mt,id:ot,index:pt,sourceLayerIndex:Et}of h){const bt=Q._featureFilter.needGeometry,$t=gs(mt,bt);if(!Q._featureFilter.filter(at,$t,W))continue;if(bt||($t.geometry=ao(mt,W,K)),ce&&mt.type!==1&&W.z<=5){const Zt=$t.geometry,ar=.98078528056,or=(hr,Sr)=>da(El(hr.x,hr.y,W,1),El(Sr.x,Sr.y,W,1))<ar;for(let hr=0;hr<Zt.length;hr++)Zt[hr]=K_(Zt[hr],or)}let zt,rr;if(Ee){const Zt=Q.getValueAndResolveTokens("text-field",$t,W,Xe),ar=Mn.factory(Zt);zy(ar)&&(this.hasRTLText=!0),(!this.hasRTLText||de()==="unavailable"||this.hasRTLText&&ye.isParsed())&&(zt=ey(ar,Q,$t))}if(we){const Zt=Q.getValueAndResolveTokens("icon-image",$t,W,Xe);rr=Zt instanceof Wn?Zt:Wn.fromString(Zt)}if(!zt&&!rr)continue;const yr=this.sortFeaturesByKey?Ae.evaluate($t,{},W):void 0;if(this.features.push({id:ot,text:zt,icon:rr,index:pt,sourceLayerIndex:Et,geometry:$t.geometry,properties:mt.properties,type:ky[mt.type],sortKey:yr}),rr&&(Pe[rr.name]=!0),zt){const Zt=fe.evaluate($t,{},W).join(","),ar=oe.get("text-rotation-alignment")==="map"&&oe.get("symbol-placement")!=="point";this.allowVerticalPlacement=this.writingModes&&this.writingModes.indexOf(oa.vertical)>=0;for(const or of zt.sections)if(or.image)Pe[or.image.name]=!0;else{const hr=sl(zt.toString()),Sr=or.fontStack||Zt,Jt=ze[Sr]=ze[Sr]||{};this.calculateGlyphDependencies(or.text,Jt,ar,this.allowVerticalPlacement,hr)}}}oe.get("symbol-placement")==="line"&&(this.features=function(mt){const ot={},pt={},Et=[];let bt=0;function $t(Zt){Et.push(mt[Zt]),bt++}function zt(Zt,ar,or){const hr=pt[Zt];return delete pt[Zt],pt[ar]=hr,Et[hr].geometry[0].pop(),Et[hr].geometry[0]=Et[hr].geometry[0].concat(or[0]),hr}function rr(Zt,ar,or){const hr=ot[ar];return delete ot[ar],ot[Zt]=hr,Et[hr].geometry[0].shift(),Et[hr].geometry[0]=or[0].concat(Et[hr].geometry[0]),hr}function yr(Zt,ar,or){const hr=or?ar[0][ar[0].length-1]:ar[0][0];return`${Zt}:${hr.x}:${hr.y}`}for(let Zt=0;Zt<mt.length;Zt++){const ar=mt[Zt],or=ar.geometry,hr=ar.text?ar.text.toString():null;if(!hr){$t(Zt);continue}const Sr=yr(hr,or),Jt=yr(hr,or,!0);if(Sr in pt&&Jt in ot&&pt[Sr]!==ot[Jt]){const Cr=rr(Sr,Jt,or),$r=zt(Sr,Jt,Et[Cr].geometry);delete ot[Sr],delete pt[Jt],pt[yr(hr,Et[$r].geometry,!0)]=$r,Et[Cr].geometry=null}else Sr in pt?zt(Sr,Jt,or):Jt in ot?rr(Sr,Jt,or):($t(Zt),ot[Sr]=bt-1,pt[Jt]=bt-1)}return Et.filter(Zt=>Zt.geometry)}(this.features)),this.sortFeaturesByKey&&this.features.sort((mt,ot)=>mt.sortKey-ot.sortKey)}update(h,U,W,K){this.stateDependentLayers.length&&(this.text.programConfigurations.updatePaintArrays(h,U,this.layers,W,K),this.icon.programConfigurations.updatePaintArrays(h,U,this.layers,W,K))}isEmpty(){return this.symbolInstances.length===0&&!this.hasRTLText}uploadPending(){return!this.uploaded||this.text.programConfigurations.needsUpload||this.icon.programConfigurations.needsUpload}upload(h){!this.uploaded&&this.hasDebugData()&&(this.textCollisionBox.upload(h),this.iconCollisionBox.upload(h)),this.text.upload(h,this.sortFeaturesByY,!this.uploaded,this.text.programConfigurations.needsUpload),this.icon.upload(h,this.sortFeaturesByY,!this.uploaded,this.icon.programConfigurations.needsUpload),this.uploaded=!0}destroyDebugData(){this.textCollisionBox.destroy(),this.iconCollisionBox.destroy()}getProjection(){return this.projectionInstance||(this.projectionInstance=Zp(this.projection)),this.projectionInstance}destroy(){this.text.destroy(),this.icon.destroy(),this.hasDebugData()&&this.destroyDebugData()}addToLineVertexArray(h,U){const W=this.lineVertexArray.length;if(h.segment!==void 0)for(const{x:K,y:Q}of U)this.lineVertexArray.emplaceBack(K,Q);return{lineStartIndex:W,lineLength:this.lineVertexArray.length-W}}addSymbols(h,U,W,K,Q,oe,ce,fe,pe,ve,Ee,we,Ae,Pe){const ze=h.indexArray,Xe=h.layoutVertexArray,at=h.globeExtVertexArray,mt=h.segments.prepareSegment(4*U.length,Xe,ze,this.canOverlap?oe.sortKey:void 0),ot=this.glyphOffsetArray.length,pt=mt.vertexLength,Et=this.allowVerticalPlacement&&ce===oa.vertical?Math.PI/2:0,bt=oe.text&&oe.text.sections;for(let zt=0;zt<U.length;zt++){const{tl:rr,tr:yr,bl:Zt,br:ar,tex:or,pixelOffsetTL:hr,pixelOffsetBR:Sr,minFontScaleX:Jt,minFontScaleY:Cr,glyphOffset:$r,isSDF:Pr,sectionIndex:di}=U[zt],Tr=mt.vertexLength,ei=$r[1];if(hh(Xe,pe.x,pe.y,rr.x,ei+rr.y,or.x,or.y,W,Pr,hr.x,hr.y,Jt,Cr),hh(Xe,pe.x,pe.y,yr.x,ei+yr.y,or.x+or.w,or.y,W,Pr,Sr.x,hr.y,Jt,Cr),hh(Xe,pe.x,pe.y,Zt.x,ei+Zt.y,or.x,or.y+or.h,W,Pr,hr.x,Sr.y,Jt,Cr),hh(Xe,pe.x,pe.y,ar.x,ei+ar.y,or.x+or.w,or.y+or.h,W,Pr,Sr.x,Sr.y,Jt,Cr),fe){const{x:fi,y:Ii,z:pi}=fe.anchor,[ai,Wi,_i]=fe.up;dh(at,fi,Ii,pi,ai,Wi,_i),dh(at,fi,Ii,pi,ai,Wi,_i),dh(at,fi,Ii,pi,ai,Wi,_i),dh(at,fi,Ii,pi,ai,Wi,_i),fh(h.dynamicLayoutVertexArray,fi,Ii,pi,Et)}else fh(h.dynamicLayoutVertexArray,pe.x,pe.y,pe.z,Et);ze.emplaceBack(Tr,Tr+1,Tr+2),ze.emplaceBack(Tr+1,Tr+2,Tr+3),mt.vertexLength+=4,mt.primitiveLength+=2,this.glyphOffsetArray.emplaceBack($r[0]),zt!==U.length-1&&di===U[zt+1].sectionIndex||h.programConfigurations.populatePaintArrays(Xe.length,oe,oe.index,{},Ae,Pe,bt&&bt[di])}const $t=fe?fe.anchor:pe;h.placedSymbolArray.emplaceBack($t.x,$t.y,$t.z,pe.x,pe.y,ot,this.glyphOffsetArray.length-ot,pt,ve,Ee,pe.segment,W?W[0]:0,W?W[1]:0,K[0],K[1],ce,0,!1,0,we,0)}_commitLayoutVertex(h,U,W,K,Q,oe,ce){h.emplaceBack(U,W,K,Q,oe,Math.round(ce.x),Math.round(ce.y))}_addCollisionDebugVertices(h,U,W,K,Q,oe,ce){const fe=W.segments.prepareSegment(4,W.layoutVertexArray,W.indexArray),pe=fe.vertexLength,ve=ce.tileAnchorX,Ee=ce.tileAnchorY;for(let Ae=0;Ae<4;Ae++)W.collisionVertexArray.emplaceBack(0,0,0,0);W.collisionVertexArrayExt.emplaceBack(U,-h.padding,-h.padding),W.collisionVertexArrayExt.emplaceBack(U,h.padding,-h.padding),W.collisionVertexArrayExt.emplaceBack(U,h.padding,h.padding),W.collisionVertexArrayExt.emplaceBack(U,-h.padding,h.padding),this._commitLayoutVertex(W.layoutVertexArray,K,Q,oe,ve,Ee,new He(h.x1,h.y1)),this._commitLayoutVertex(W.layoutVertexArray,K,Q,oe,ve,Ee,new He(h.x2,h.y1)),this._commitLayoutVertex(W.layoutVertexArray,K,Q,oe,ve,Ee,new He(h.x2,h.y2)),this._commitLayoutVertex(W.layoutVertexArray,K,Q,oe,ve,Ee,new He(h.x1,h.y2)),fe.vertexLength+=4;const we=W.indexArray;we.emplaceBack(pe,pe+1),we.emplaceBack(pe+1,pe+2),we.emplaceBack(pe+2,pe+3),we.emplaceBack(pe+3,pe),fe.primitiveLength+=4}_addTextDebugCollisionBoxes(h,U,W,K,Q,oe){for(let ce=K;ce<Q;ce++){const fe=W.get(ce),pe=this.getSymbolInstanceTextSize(h,oe,U,ce);this._addCollisionDebugVertices(fe,pe,this.textCollisionBox,fe.projectedAnchorX,fe.projectedAnchorY,fe.projectedAnchorZ,oe)}}_addIconDebugCollisionBoxes(h,U,W,K,Q,oe){for(let ce=K;ce<Q;ce++){const fe=W.get(ce),pe=this.getSymbolInstanceIconSize(h,U,oe.placedIconSymbolIndex);this._addCollisionDebugVertices(fe,pe,this.iconCollisionBox,fe.projectedAnchorX,fe.projectedAnchorY,fe.projectedAnchorZ,oe)}}generateCollisionDebugBuffers(h,U){this.hasDebugData()&&this.destroyDebugData(),this.textCollisionBox=new Pd(Gr,fp.members,bn),this.iconCollisionBox=new Pd(Gr,fp.members,bn);const W=cu(this.iconSizeData,h),K=cu(this.textSizeData,h);for(let Q=0;Q<this.symbolInstances.length;Q++){const oe=this.symbolInstances.get(Q);this._addTextDebugCollisionBoxes(K,h,U,oe.textBoxStartIndex,oe.textBoxEndIndex,oe),this._addTextDebugCollisionBoxes(K,h,U,oe.verticalTextBoxStartIndex,oe.verticalTextBoxEndIndex,oe),this._addIconDebugCollisionBoxes(W,h,U,oe.iconBoxStartIndex,oe.iconBoxEndIndex,oe),this._addIconDebugCollisionBoxes(W,h,U,oe.verticalIconBoxStartIndex,oe.verticalIconBoxEndIndex,oe)}}getSymbolInstanceTextSize(h,U,W,K){const Q=this.text.placedSymbolArray.get(U.rightJustifiedTextSymbolIndex>=0?U.rightJustifiedTextSymbolIndex:U.centerJustifiedTextSymbolIndex>=0?U.centerJustifiedTextSymbolIndex:U.leftJustifiedTextSymbolIndex>=0?U.leftJustifiedTextSymbolIndex:U.verticalPlacedTextSymbolIndex>=0?U.verticalPlacedTextSymbolIndex:K),oe=th(this.textSizeData,h,Q)/Sn;return this.tilePixelRatio*oe}getSymbolInstanceIconSize(h,U,W){const K=this.icon.placedSymbolArray.get(W),Q=th(this.iconSizeData,h,K);return this.tilePixelRatio*Q}_commitDebugCollisionVertexUpdate(h,U,W){h.emplaceBack(U,-W,-W),h.emplaceBack(U,W,-W),h.emplaceBack(U,W,W),h.emplaceBack(U,-W,W)}_updateTextDebugCollisionBoxes(h,U,W,K,Q,oe){for(let ce=K;ce<Q;ce++){const fe=W.get(ce),pe=this.getSymbolInstanceTextSize(h,oe,U,ce);this._commitDebugCollisionVertexUpdate(this.textCollisionBox.collisionVertexArrayExt,pe,fe.padding)}}_updateIconDebugCollisionBoxes(h,U,W,K,Q,oe){for(let ce=K;ce<Q;ce++){const fe=W.get(ce),pe=this.getSymbolInstanceIconSize(h,U,oe);this._commitDebugCollisionVertexUpdate(this.iconCollisionBox.collisionVertexArrayExt,pe,fe.padding)}}updateCollisionDebugBuffers(h,U){if(!this.hasDebugData())return;this.hasTextCollisionBoxData()&&this.textCollisionBox.collisionVertexArrayExt.clear(),this.hasIconCollisionBoxData()&&this.iconCollisionBox.collisionVertexArrayExt.clear();const W=cu(this.iconSizeData,h),K=cu(this.textSizeData,h);for(let Q=0;Q<this.symbolInstances.length;Q++){const oe=this.symbolInstances.get(Q);this._updateTextDebugCollisionBoxes(K,h,U,oe.textBoxStartIndex,oe.textBoxEndIndex,oe),this._updateTextDebugCollisionBoxes(K,h,U,oe.verticalTextBoxStartIndex,oe.verticalTextBoxEndIndex,oe),this._updateIconDebugCollisionBoxes(W,h,U,oe.iconBoxStartIndex,oe.iconBoxEndIndex,oe.placedIconSymbolIndex),this._updateIconDebugCollisionBoxes(W,h,U,oe.verticalIconBoxStartIndex,oe.verticalIconBoxEndIndex,oe.placedIconSymbolIndex)}this.hasTextCollisionBoxData()&&this.textCollisionBox.collisionVertexBufferExt&&this.textCollisionBox.collisionVertexBufferExt.updateData(this.textCollisionBox.collisionVertexArrayExt),this.hasIconCollisionBoxData()&&this.iconCollisionBox.collisionVertexBufferExt&&this.iconCollisionBox.collisionVertexBufferExt.updateData(this.iconCollisionBox.collisionVertexArrayExt)}_deserializeCollisionBoxesForSymbol(h,U,W,K,Q,oe,ce,fe,pe){const ve={};if(U<W){const{x1:Ee,y1:we,x2:Ae,y2:Pe,padding:ze,projectedAnchorX:Xe,projectedAnchorY:at,projectedAnchorZ:mt,tileAnchorX:ot,tileAnchorY:pt,featureIndex:Et}=h.get(U);ve.textBox={x1:Ee,y1:we,x2:Ae,y2:Pe,padding:ze,projectedAnchorX:Xe,projectedAnchorY:at,projectedAnchorZ:mt,tileAnchorX:ot,tileAnchorY:pt},ve.textFeatureIndex=Et}if(K<Q){const{x1:Ee,y1:we,x2:Ae,y2:Pe,padding:ze,projectedAnchorX:Xe,projectedAnchorY:at,projectedAnchorZ:mt,tileAnchorX:ot,tileAnchorY:pt,featureIndex:Et}=h.get(K);ve.verticalTextBox={x1:Ee,y1:we,x2:Ae,y2:Pe,padding:ze,projectedAnchorX:Xe,projectedAnchorY:at,projectedAnchorZ:mt,tileAnchorX:ot,tileAnchorY:pt},ve.verticalTextFeatureIndex=Et}if(oe<ce){const{x1:Ee,y1:we,x2:Ae,y2:Pe,padding:ze,projectedAnchorX:Xe,projectedAnchorY:at,projectedAnchorZ:mt,tileAnchorX:ot,tileAnchorY:pt,featureIndex:Et}=h.get(oe);ve.iconBox={x1:Ee,y1:we,x2:Ae,y2:Pe,padding:ze,projectedAnchorX:Xe,projectedAnchorY:at,projectedAnchorZ:mt,tileAnchorX:ot,tileAnchorY:pt},ve.iconFeatureIndex=Et}if(fe<pe){const{x1:Ee,y1:we,x2:Ae,y2:Pe,padding:ze,projectedAnchorX:Xe,projectedAnchorY:at,projectedAnchorZ:mt,tileAnchorX:ot,tileAnchorY:pt,featureIndex:Et}=h.get(fe);ve.verticalIconBox={x1:Ee,y1:we,x2:Ae,y2:Pe,padding:ze,projectedAnchorX:Xe,projectedAnchorY:at,projectedAnchorZ:mt,tileAnchorX:ot,tileAnchorY:pt},ve.verticalIconFeatureIndex=Et}return ve}deserializeCollisionBoxes(h){this.collisionArrays=[];for(let U=0;U<this.symbolInstances.length;U++){const W=this.symbolInstances.get(U);this.collisionArrays.push(this._deserializeCollisionBoxesForSymbol(h,W.textBoxStartIndex,W.textBoxEndIndex,W.verticalTextBoxStartIndex,W.verticalTextBoxEndIndex,W.iconBoxStartIndex,W.iconBoxEndIndex,W.verticalIconBoxStartIndex,W.verticalIconBoxEndIndex))}}hasTextData(){return this.text.segments.get().length>0}hasIconData(){return this.icon.segments.get().length>0}hasDebugData(){return this.textCollisionBox&&this.iconCollisionBox}hasTextCollisionBoxData(){return this.hasDebugData()&&this.textCollisionBox.segments.get().length>0}hasIconCollisionBoxData(){return this.hasDebugData()&&this.iconCollisionBox.segments.get().length>0}addIndicesForPlacedSymbol(h,U){const W=h.placedSymbolArray.get(U),K=W.vertexStartIndex+4*W.numGlyphs;for(let Q=W.vertexStartIndex;Q<K;Q+=4)h.indexArray.emplaceBack(Q,Q+1,Q+2),h.indexArray.emplaceBack(Q+1,Q+2,Q+3)}getSortedSymbolIndexes(h){if(this.sortedAngle===h&&this.symbolInstanceIndexes!==void 0)return this.symbolInstanceIndexes;const U=Math.sin(h),W=Math.cos(h),K=[],Q=[],oe=[];for(let ce=0;ce<this.symbolInstances.length;++ce){oe.push(ce);const fe=this.symbolInstances.get(ce);K.push(0|Math.round(U*fe.tileAnchorX+W*fe.tileAnchorY)),Q.push(fe.featureIndex)}return oe.sort((ce,fe)=>K[ce]-K[fe]||Q[fe]-Q[ce]),oe}addToSortKeyRanges(h,U){const W=this.sortKeyRanges[this.sortKeyRanges.length-1];W&&W.sortKey===U?W.symbolInstanceEnd=h+1:this.sortKeyRanges.push({sortKey:U,symbolInstanceStart:h,symbolInstanceEnd:h+1})}sortFeatures(h){if(this.sortFeaturesByY&&this.sortedAngle!==h&&!(this.text.segments.get().length>1||this.icon.segments.get().length>1)){this.symbolInstanceIndexes=this.getSortedSymbolIndexes(h),this.sortedAngle=h,this.text.indexArray.clear(),this.icon.indexArray.clear(),this.featureSortOrder=[];for(const U of this.symbolInstanceIndexes){const W=this.symbolInstances.get(U);this.featureSortOrder.push(W.featureIndex);const{rightJustifiedTextSymbolIndex:K,centerJustifiedTextSymbolIndex:Q,leftJustifiedTextSymbolIndex:oe,verticalPlacedTextSymbolIndex:ce,placedIconSymbolIndex:fe,verticalPlacedIconSymbolIndex:pe}=W;K>=0&&this.addIndicesForPlacedSymbol(this.text,K),Q>=0&&Q!==K&&this.addIndicesForPlacedSymbol(this.text,Q),oe>=0&&oe!==Q&&oe!==K&&this.addIndicesForPlacedSymbol(this.text,oe),ce>=0&&this.addIndicesForPlacedSymbol(this.text,ce),fe>=0&&this.addIndicesForPlacedSymbol(this.icon,fe),pe>=0&&this.addIndicesForPlacedSymbol(this.icon,pe)}this.text.indexBuffer&&this.text.indexBuffer.updateData(this.text.indexArray),this.icon.indexBuffer&&this.icon.indexBuffer.updateData(this.icon.indexArray)}}}Vr(Do,"SymbolBucket",{omit:["layers","collisionBoxArray","features","compareText"]}),Do.MAX_GLYPHS=65535,Do.addDynamicAttributes=fh;const Ny=new ct({"symbol-placement":new Be(Yt.layout_symbol["symbol-placement"]),"symbol-spacing":new Be(Yt.layout_symbol["symbol-spacing"]),"symbol-avoid-edges":new Be(Yt.layout_symbol["symbol-avoid-edges"]),"symbol-sort-key":new Ye(Yt.layout_symbol["symbol-sort-key"]),"symbol-z-order":new Be(Yt.layout_symbol["symbol-z-order"]),"icon-allow-overlap":new Be(Yt.layout_symbol["icon-allow-overlap"]),"icon-ignore-placement":new Be(Yt.layout_symbol["icon-ignore-placement"]),"icon-optional":new Be(Yt.layout_symbol["icon-optional"]),"icon-rotation-alignment":new Be(Yt.layout_symbol["icon-rotation-alignment"]),"icon-size":new Ye(Yt.layout_symbol["icon-size"]),"icon-text-fit":new Be(Yt.layout_symbol["icon-text-fit"]),"icon-text-fit-padding":new Be(Yt.layout_symbol["icon-text-fit-padding"]),"icon-image":new Ye(Yt.layout_symbol["icon-image"]),"icon-rotate":new Ye(Yt.layout_symbol["icon-rotate"]),"icon-padding":new Be(Yt.layout_symbol["icon-padding"]),"icon-keep-upright":new Be(Yt.layout_symbol["icon-keep-upright"]),"icon-offset":new Ye(Yt.layout_symbol["icon-offset"]),"icon-anchor":new Ye(Yt.layout_symbol["icon-anchor"]),"icon-pitch-alignment":new Be(Yt.layout_symbol["icon-pitch-alignment"]),"text-pitch-alignment":new Be(Yt.layout_symbol["text-pitch-alignment"]),"text-rotation-alignment":new Be(Yt.layout_symbol["text-rotation-alignment"]),"text-field":new Ye(Yt.layout_symbol["text-field"]),"text-font":new Ye(Yt.layout_symbol["text-font"]),"text-size":new Ye(Yt.layout_symbol["text-size"]),"text-max-width":new Ye(Yt.layout_symbol["text-max-width"]),"text-line-height":new Ye(Yt.layout_symbol["text-line-height"]),"text-letter-spacing":new Ye(Yt.layout_symbol["text-letter-spacing"]),"text-justify":new Ye(Yt.layout_symbol["text-justify"]),"text-radial-offset":new Ye(Yt.layout_symbol["text-radial-offset"]),"text-variable-anchor":new Be(Yt.layout_symbol["text-variable-anchor"]),"text-anchor":new Ye(Yt.layout_symbol["text-anchor"]),"text-max-angle":new Be(Yt.layout_symbol["text-max-angle"]),"text-writing-mode":new Be(Yt.layout_symbol["text-writing-mode"]),"text-rotate":new Ye(Yt.layout_symbol["text-rotate"]),"text-padding":new Be(Yt.layout_symbol["text-padding"]),"text-keep-upright":new Be(Yt.layout_symbol["text-keep-upright"]),"text-transform":new Ye(Yt.layout_symbol["text-transform"]),"text-offset":new Ye(Yt.layout_symbol["text-offset"]),"text-allow-overlap":new Be(Yt.layout_symbol["text-allow-overlap"]),"text-ignore-placement":new Be(Yt.layout_symbol["text-ignore-placement"]),"text-optional":new Be(Yt.layout_symbol["text-optional"])});var Md={paint:new ct({"icon-opacity":new Ye(Yt.paint_symbol["icon-opacity"]),"icon-color":new Ye(Yt.paint_symbol["icon-color"]),"icon-halo-color":new Ye(Yt.paint_symbol["icon-halo-color"]),"icon-halo-width":new Ye(Yt.paint_symbol["icon-halo-width"]),"icon-halo-blur":new Ye(Yt.paint_symbol["icon-halo-blur"]),"icon-translate":new Be(Yt.paint_symbol["icon-translate"]),"icon-translate-anchor":new Be(Yt.paint_symbol["icon-translate-anchor"]),"text-opacity":new Ye(Yt.paint_symbol["text-opacity"]),"text-color":new Ye(Yt.paint_symbol["text-color"],{runtimeType:jn,getOverride:R=>R.textColor,hasOverride:R=>!!R.textColor}),"text-halo-color":new Ye(Yt.paint_symbol["text-halo-color"]),"text-halo-width":new Ye(Yt.paint_symbol["text-halo-width"]),"text-halo-blur":new Ye(Yt.paint_symbol["text-halo-blur"]),"text-translate":new Be(Yt.paint_symbol["text-translate"]),"text-translate-anchor":new Be(Yt.paint_symbol["text-translate-anchor"])}),layout:Ny};class Kp{constructor(h){this.type=h.property.overrides?h.property.overrides.runtimeType:lo,this.defaultValue=h}evaluate(h){if(h.formattedSection){const U=this.defaultValue.property.overrides;if(U&&U.hasOverride(h.formattedSection))return U.getOverride(h.formattedSection)}return h.feature&&h.featureState?this.defaultValue.evaluate(h.feature,h.featureState):this.defaultValue.property.specification.default}eachChild(h){this.defaultValue.isConstant()||h(this.defaultValue.value._styleExpression.expression)}outputDefined(){return!1}serialize(){return null}}Vr(Kp,"FormatSectionOverride",{omit:["defaultValue"]});class ph extends qa{constructor(h){super(h,Md)}recalculate(h,U){super.recalculate(h,U),this.layout.get("icon-rotation-alignment")==="auto"&&(this.layout._values["icon-rotation-alignment"]=this.layout.get("symbol-placement")!=="point"?"map":"viewport"),this.layout.get("text-rotation-alignment")==="auto"&&(this.layout._values["text-rotation-alignment"]=this.layout.get("symbol-placement")!=="point"?"map":"viewport"),this.layout.get("text-pitch-alignment")==="auto"&&(this.layout._values["text-pitch-alignment"]=this.layout.get("text-rotation-alignment")),this.layout.get("icon-pitch-alignment")==="auto"&&(this.layout._values["icon-pitch-alignment"]=this.layout.get("icon-rotation-alignment"));const W=this.layout.get("text-writing-mode");if(W){const K=[];for(const Q of W)K.indexOf(Q)<0&&K.push(Q);this.layout._values["text-writing-mode"]=K}else this.layout._values["text-writing-mode"]=this.layout.get("symbol-placement")==="point"?["horizontal"]:["horizontal","vertical"];this._setPaintOverrides()}getValueAndResolveTokens(h,U,W,K){const Q=this.layout.get(h).evaluate(U,{},W,K),oe=this._unevaluatedLayout._values[h];return oe.isDataDriven()||Eo(oe.value)||!Q?Q:function(ce,fe){return fe.replace(/{([^{}]+)}/g,(pe,ve)=>ve in ce?String(ce[ve]):"")}(U.properties,Q)}createBucket(h){return new Do(h)}queryRadius(){return 0}queryIntersectsFeature(){return!1}_setPaintOverrides(){for(const h of Md.paint.overridableProperties){if(!ph.hasPaintOverride(this.layout,h))continue;const U=this.paint.get(h),W=new Kp(U),K=new Gs(W,U.property.specification);let Q=null;Q=U.value.kind==="constant"||U.value.kind==="source"?new Xu("source",K):new rs("composite",K,U.value.zoomStops,U.value._interpolationType),this.paint._values[h]=new Qe(U.property,Q,U.parameters)}}_handleOverridablePaintPropertyUpdate(h,U,W){return!(!this.layout||U.isDataDriven()||W.isDataDriven())&&ph.hasPaintOverride(this.layout,h)}static hasPaintOverride(h,U){const W=h.get("text-field"),K=Md.paint.properties[U];let Q=!1;const oe=ce=>{for(const fe of ce)if(K.overrides&&K.overrides.hasOverride(fe))return void(Q=!0)};if(W.value.kind==="constant"&&W.value.value instanceof Mn)oe(W.value.value.sections);else if(W.value.kind==="source"){const ce=pe=>{Q||(pe instanceof Ha&&rn(pe.value)===zo?oe(pe.value.sections):pe instanceof La?oe(pe.sections):pe.eachChild(ce))},fe=W.value;fe._styleExpression&&ce(fe._styleExpression.expression)}return Q}getProgramConfiguration(h){return new Ro(this,h)}}var jy={paint:new ct({"background-color":new Be(Yt.paint_background["background-color"]),"background-pattern":new Be(Yt.paint_background["background-pattern"]),"background-opacity":new Be(Yt.paint_background["background-opacity"])})},Uy={paint:new ct({"raster-opacity":new Be(Yt.paint_raster["raster-opacity"]),"raster-hue-rotate":new Be(Yt.paint_raster["raster-hue-rotate"]),"raster-brightness-min":new Be(Yt.paint_raster["raster-brightness-min"]),"raster-brightness-max":new Be(Yt.paint_raster["raster-brightness-max"]),"raster-saturation":new Be(Yt.paint_raster["raster-saturation"]),"raster-contrast":new Be(Yt.paint_raster["raster-contrast"]),"raster-resampling":new Be(Yt.paint_raster["raster-resampling"]),"raster-fade-duration":new Be(Yt.paint_raster["raster-fade-duration"])})};class Vy extends qa{constructor(h){super(h,{}),this.implementation=h}is3D(){return this.implementation.renderingMode==="3d"}hasOffscreenPass(){return this.implementation.prerender!==void 0}isLayerDraped(){return this.implementation.renderToTile!==void 0}shouldRedrape(){return!!this.implementation.shouldRerenderTiles&&this.implementation.shouldRerenderTiles()}recalculate(){}updateTransitions(){}hasTransition(){return!1}serialize(){}onAdd(h){this.implementation.onAdd&&this.implementation.onAdd(h,h.painter.context.gl)}onRemove(h){this.implementation.onRemove&&this.implementation.onRemove(h,h.painter.context.gl)}}var Gy={paint:new ct({"sky-type":new Be(Yt.paint_sky["sky-type"]),"sky-atmosphere-sun":new Be(Yt.paint_sky["sky-atmosphere-sun"]),"sky-atmosphere-sun-intensity":new Be(Yt.paint_sky["sky-atmosphere-sun-intensity"]),"sky-gradient-center":new Be(Yt.paint_sky["sky-gradient-center"]),"sky-gradient-radius":new Be(Yt.paint_sky["sky-gradient-radius"]),"sky-gradient":new lt(Yt.paint_sky["sky-gradient"]),"sky-atmosphere-halo-color":new Be(Yt.paint_sky["sky-atmosphere-halo-color"]),"sky-atmosphere-color":new Be(Yt.paint_sky["sky-atmosphere-color"]),"sky-opacity":new Be(Yt.paint_sky["sky-opacity"])})};function Dd(R,h,U){const W=[0,0,1],K=pf([]);return mf(K,K,U?-ut(R)+Math.PI:ut(R)),_f(K,K,-ut(h)),cf(W,W,K),Ln(W,W)}const $y={circle:class extends qa{constructor(R){super(R,rm)}createBucket(R){return new od(R)}queryRadius(R){const h=R;return ou("circle-radius",this,h)+ou("circle-stroke-width",this,h)+Gc(this.paint.get("circle-translate"))}queryIntersectsFeature(R,h,U,W,K,Q,oe,ce){const fe=Bf(this.paint.get("circle-translate"),this.paint.get("circle-translate-anchor"),Q.angle,R.pixelToTileUnitsFactor),pe=this.paint.get("circle-radius").evaluate(h,U)+this.paint.get("circle-stroke-width").evaluate(h,U);return zf(R,W,Q,oe,ce,this.paint.get("circle-pitch-alignment")==="map",this.paint.get("circle-pitch-scale")==="map",fe,pe)}getProgramIds(){return["circle"]}getProgramConfiguration(R){return new Ro(this,R)}},heatmap:class extends qa{createBucket(R){return new jf(R)}constructor(R){super(R,om),this._updateColorRamp()}_handleSpecialPaintPropertyUpdate(R){R==="heatmap-color"&&this._updateColorRamp()}_updateColorRamp(){this.colorRamp=cd({expression:this._transitionablePaint._values["heatmap-color"].value.expression,evaluationKey:"heatmapDensity",image:this.colorRamp}),this.colorRampTexture=null}resize(){this.heatmapFbo&&(this.heatmapFbo.destroy(),this.heatmapFbo=null)}queryRadius(R){return ou("heatmap-radius",this,R)}queryIntersectsFeature(R,h,U,W,K,Q,oe,ce){const fe=this.paint.get("heatmap-radius").evaluate(h,U);return zf(R,W,Q,oe,ce,!0,!0,new He(0,0),fe)}hasOffscreenPass(){return this.paint.get("heatmap-opacity")!==0&&this.visibility!=="none"}getProgramIds(){return["heatmap","heatmapTexture"]}getProgramConfiguration(R){return new Ro(this,R)}},hillshade:class extends qa{constructor(R){super(R,sm)}hasOffscreenPass(){return this.paint.get("hillshade-exaggeration")!==0&&this.visibility!=="none"}getProgramIds(){return["hillshade","hillshadePrepare"]}},fill:class extends qa{constructor(R){super(R,wm)}getProgramIds(){const R=this.paint.get("fill-pattern"),h=R&&R.constantOr(1),U=[h?"fillPattern":"fill"];return this.paint.get("fill-antialias")&&U.push(h&&!this.getPaintProperty("fill-outline-color")?"fillOutlinePattern":"fillOutline"),U}getProgramConfiguration(R){return new Ro(this,R)}recalculate(R,h){super.recalculate(R,h);const U=this.paint._values["fill-outline-color"];U.value.kind==="constant"&&U.value.value===void 0&&(this.paint._values["fill-outline-color"]=this.paint._values["fill-color"])}createBucket(R){return new Kc(R)}queryRadius(){return Gc(this.paint.get("fill-translate"))}queryIntersectsFeature(R,h,U,W,K,Q){return!R.queryGeometry.isAboveHorizon&&Mf(kf(R.tilespaceGeometry,this.paint.get("fill-translate"),this.paint.get("fill-translate-anchor"),Q.angle,R.pixelToTileUnitsFactor),W)}isTileClipped(){return!0}},"fill-extrusion":class extends qa{constructor(R){super(R,zm)}createBucket(R){return new Cl(R)}queryRadius(){return Gc(this.paint.get("fill-extrusion-translate"))}is3D(){return!0}getProgramIds(){return[this.paint.get("fill-extrusion-pattern").constantOr(1)?"fillExtrusionPattern":"fillExtrusion"]}getProgramConfiguration(R){return new Ro(this,R)}queryIntersectsFeature(R,h,U,W,K,Q,oe,ce,fe){const pe=Bf(this.paint.get("fill-extrusion-translate"),this.paint.get("fill-extrusion-translate-anchor"),Q.angle,R.pixelToTileUnitsFactor),ve=this.paint.get("fill-extrusion-height").evaluate(h,U),Ee=this.paint.get("fill-extrusion-base").evaluate(h,U),we=[0,0],Ae=ce&&Q.elevation,Pe=Q.elevation?Q.elevation.exaggeration():1,ze=R.tile.getBucket(this);if(Ae&&ze instanceof Cl){const pt=ze.centroidVertexArray,Et=fe+1;Et<pt.length&&(we[0]=pt.geta_centroid_pos0(Et),we[1]=pt.geta_centroid_pos1(Et))}if(we[0]===0&&we[1]===1)return!1;Q.projection.name==="globe"&&(W=ap([W],[new He(0,0),new He(ri,ri)],R.tileID.canonical).map(pt=>pt.polygon).flat());const Xe=Ae?ce:null,[at,mt]=function(pt,Et,bt,$t,zt,rr,yr,Zt,ar,or,hr){return pt.projection.name==="globe"?function(Sr,Jt,Cr,$r,Pr,di,Tr,ei,fi,Ii,pi){const ai=[],Wi=[],_i=Sr.projection.upVectorScale(pi,Sr.center.lat,Sr.worldSize).metersToTile,mi=[0,0,0,1],zi=[0,0,0,1],Vi=(Ni,Ji,nn,fn)=>{Ni[0]=Ji,Ni[1]=nn,Ni[2]=fn,Ni[3]=1},Gi=np();Cr>0&&(Cr+=Gi),$r+=Gi;for(const Ni of Jt){const Ji=[],nn=[];for(const fn of Ni){const ji=fn.x+Pr.x,yn=fn.y+Pr.y,pn=Sr.projection.projectTilePoint(ji,yn,pi),Qi=Sr.projection.upVector(pi,fn.x,fn.y);let Oi=Cr,_n=$r;if(Tr){const $i=lp(ji,yn,Cr,$r,Tr,ei,fi,Ii);Oi+=$i.base,_n+=$i.top}Cr!==0?Vi(mi,pn.x+Qi[0]*_i*Oi,pn.y+Qi[1]*_i*Oi,pn.z+Qi[2]*_i*Oi):Vi(mi,pn.x,pn.y,pn.z),Vi(zi,pn.x+Qi[0]*_i*_n,pn.y+Qi[1]*_i*_n,pn.z+Qi[2]*_i*_n),un(mi,mi,di),un(zi,zi,di),Ji.push(new lu(mi[0],mi[1],mi[2])),nn.push(new lu(zi[0],zi[1],zi[2]))}ai.push(Ji),Wi.push(nn)}return[ai,Wi]}(pt,Et,bt,$t,zt,rr,yr,Zt,ar,or,hr):yr?function(Sr,Jt,Cr,$r,Pr,di,Tr,ei,fi){const Ii=[],pi=[],ai=[0,0,0,1];for(const Wi of Sr){const _i=[],mi=[];for(const zi of Wi){const Vi=zi.x+$r.x,Gi=zi.y+$r.y,Ni=lp(Vi,Gi,Jt,Cr,di,Tr,ei,fi);ai[0]=Vi,ai[1]=Gi,ai[2]=Ni.base,ai[3]=1,ps(ai,ai,Pr),ai[3]=Math.max(ai[3],1e-5);const Ji=new lu(ai[0]/ai[3],ai[1]/ai[3],ai[2]/ai[3]);ai[0]=Vi,ai[1]=Gi,ai[2]=Ni.top,ai[3]=1,ps(ai,ai,Pr),ai[3]=Math.max(ai[3],1e-5);const nn=new lu(ai[0]/ai[3],ai[1]/ai[3],ai[2]/ai[3]);_i.push(Ji),mi.push(nn)}Ii.push(_i),pi.push(mi)}return[Ii,pi]}(Et,bt,$t,zt,rr,yr,Zt,ar,or):function(Sr,Jt,Cr,$r,Pr){const di=[],Tr=[],ei=Pr[8]*Jt,fi=Pr[9]*Jt,Ii=Pr[10]*Jt,pi=Pr[11]*Jt,ai=Pr[8]*Cr,Wi=Pr[9]*Cr,_i=Pr[10]*Cr,mi=Pr[11]*Cr;for(const zi of Sr){const Vi=[],Gi=[];for(const Ni of zi){const Ji=Ni.x+$r.x,nn=Ni.y+$r.y,fn=Pr[0]*Ji+Pr[4]*nn+Pr[12],ji=Pr[1]*Ji+Pr[5]*nn+Pr[13],yn=Pr[2]*Ji+Pr[6]*nn+Pr[14],pn=Pr[3]*Ji+Pr[7]*nn+Pr[15],Qi=fn+ei,Oi=ji+fi,_n=yn+Ii,$i=Math.max(pn+pi,1e-5),Bn=fn+ai,mn=ji+Wi,Tn=yn+_i,xn=Math.max(pn+mi,1e-5);Vi.push(new lu(Qi/$i,Oi/$i,_n/$i)),Gi.push(new lu(Bn/xn,mn/xn,Tn/xn))}di.push(Vi),Tr.push(Gi)}return[di,Tr]}(Et,bt,$t,zt,rr)}(Q,W,Ee,ve,pe,oe,Xe,we,Pe,Q.center.lat,R.tileID.canonical),ot=R.queryGeometry;return function(pt,Et,bt){let $t=1/0;Mf(bt,Et)&&($t=up(bt,Et[0]));for(let zt=0;zt<Et.length;zt++){const rr=Et[zt],yr=pt[zt];for(let Zt=0;Zt<rr.length-1;Zt++){const ar=rr[Zt],or=[ar,rr[Zt+1],yr[Zt+1],yr[Zt],ar];Pf(bt,or)&&($t=Math.min($t,up(bt,or)))}}return $t!==1/0&&$t}(at,mt,ot.isPointQuery()?ot.screenBounds:ot.screenGeometry)}},line:class extends qa{constructor(R){super(R,cp),this.gradientVersion=0}_handleSpecialPaintPropertyUpdate(R){if(R==="line-gradient"){const h=this._transitionablePaint._values["line-gradient"].value.expression;this.stepInterpolant=h._styleExpression&&h._styleExpression.expression instanceof ku,this.gradientVersion=(this.gradientVersion+1)%Number.MAX_SAFE_INTEGER}}gradientExpression(){return this._transitionablePaint._values["line-gradient"].value.expression}widthExpression(){return this._transitionablePaint._values["line-width"].value.expression}recalculate(R,h){super.recalculate(R,h),this.paint._values["line-floorwidth"]=hp.possiblyEvaluate(this._transitioningPaint._values["line-width"].value,R)}createBucket(R){return new eh(R)}getProgramIds(){return[this.paint.get("line-pattern").constantOr(1)?"linePattern":"line"]}getProgramConfiguration(R){return new Ro(this,R)}queryRadius(R){const h=R,U=dp(ou("line-width",this,h),ou("line-gap-width",this,h)),W=ou("line-offset",this,h);return U/2+Math.abs(W)+Gc(this.paint.get("line-translate"))}queryIntersectsFeature(R,h,U,W,K,Q){if(R.queryGeometry.isAboveHorizon)return!1;const oe=kf(R.tilespaceGeometry,this.paint.get("line-translate"),this.paint.get("line-translate-anchor"),Q.angle,R.pixelToTileUnitsFactor),ce=R.pixelToTileUnitsFactor/2*dp(this.paint.get("line-width").evaluate(h,U),this.paint.get("line-gap-width").evaluate(h,U)),fe=this.paint.get("line-offset").evaluate(h,U);return fe&&(W=function(pe,ve){const Ee=[],we=new He(0,0);for(let Ae=0;Ae<pe.length;Ae++){const Pe=pe[Ae],ze=[];for(let Xe=0;Xe<Pe.length;Xe++){const at=Pe[Xe],mt=Pe[Xe+1],ot=Xe===0?we:at.sub(Pe[Xe-1])._unit()._perp(),pt=Xe===Pe.length-1?we:mt.sub(at)._unit()._perp(),Et=ot._add(pt)._unit();Et._mult(1/(Et.x*pt.x+Et.y*pt.y)),ze.push(Et._mult(ve)._add(at))}Ee.push(ze)}return Ee}(W,fe*R.pixelToTileUnitsFactor)),function(pe,ve,Ee){for(let we=0;we<ve.length;we++){const Ae=ve[we];if(pe.length>=3){for(let Pe=0;Pe<Ae.length;Pe++)if(vs(pe,Ae[Pe]))return!0}if(J_(pe,Ae,Ee))return!0}return!1}(oe,W,ce)}isTileClipped(){return!0}},symbol:ph,background:class extends qa{constructor(R){super(R,jy)}getProgramIds(){return[this.paint.get("background-pattern")?"backgroundPattern":"background"]}},raster:class extends qa{constructor(R){super(R,Uy)}getProgramIds(){return["raster"]}},sky:class extends qa{constructor(R){super(R,Gy),this._updateColorRamp()}_handleSpecialPaintPropertyUpdate(R){R==="sky-gradient"?this._updateColorRamp():R!=="sky-atmosphere-sun"&&R!=="sky-atmosphere-halo-color"&&R!=="sky-atmosphere-color"&&R!=="sky-atmosphere-sun-intensity"||(this._skyboxInvalidated=!0)}_updateColorRamp(){this.colorRamp=cd({expression:this._transitionablePaint._values["sky-gradient"].value.expression,evaluationKey:"skyRadialProgress"}),this.colorRampTexture&&(this.colorRampTexture.destroy(),this.colorRampTexture=null)}needsSkyboxCapture(R){if(this._skyboxInvalidated||!this.skyboxTexture||!this.skyboxGeometry)return!0;if(!this.paint.get("sky-atmosphere-sun")){const h=R.style.light.properties.get("position");return this._lightPosition.azimuthal!==h.azimuthal||this._lightPosition.polar!==h.polar}return!1}getCenter(R,h){if(this.paint.get("sky-type")==="atmosphere"){const W=this.paint.get("sky-atmosphere-sun"),K=!W,Q=R.style.light,oe=Q.properties.get("position");return K&&Q.properties.get("anchor")==="viewport"&&Hr("The sun direction is attached to a light with viewport anchor, lighting may behave unexpectedly."),K?Dd(oe.azimuthal,90-oe.polar,h):Dd(W[0],90-W[1],h)}const U=this.paint.get("sky-gradient-center");return Dd(U[0],90-U[1],h)}is3D(){return!1}isSky(){return!0}markSkyboxValid(R){this._skyboxInvalidated=!1,this._lightPosition=R.style.light.properties.get("position")}hasOffscreenPass(){return!0}getProgramIds(){const R=this.paint.get("sky-type");return R==="atmosphere"?["skyboxCapture","skybox"]:R==="gradient"?["skyboxGradient"]:null}}};class Ul{constructor(h,U,W,K){this.context=h,this.format=W,this.texture=h.gl.createTexture(),this.update(U,K)}update(h,U,W){const{width:K,height:Q}=h,{context:oe}=this,{gl:ce}=oe,{HTMLImageElement:fe,HTMLCanvasElement:pe,HTMLVideoElement:ve,ImageData:Ee,ImageBitmap:we}=H;if(ce.bindTexture(ce.TEXTURE_2D,this.texture),oe.pixelStoreUnpackFlipY.set(!1),oe.pixelStoreUnpack.set(1),oe.pixelStoreUnpackPremultiplyAlpha.set(this.format===ce.RGBA&&(!U||U.premultiply!==!1)),W||this.size&&this.size[0]===K&&this.size[1]===Q){const{x:Ae,y:Pe}=W||{x:0,y:0};h instanceof fe||h instanceof pe||h instanceof ve||h instanceof Ee||we&&h instanceof we?ce.texSubImage2D(ce.TEXTURE_2D,0,Ae,Pe,ce.RGBA,ce.UNSIGNED_BYTE,h):ce.texSubImage2D(ce.TEXTURE_2D,0,Ae,Pe,K,Q,ce.RGBA,ce.UNSIGNED_BYTE,h.data)}else this.size=[K,Q],h instanceof fe||h instanceof pe||h instanceof ve||h instanceof Ee||we&&h instanceof we?ce.texImage2D(ce.TEXTURE_2D,0,this.format,this.format,ce.UNSIGNED_BYTE,h):ce.texImage2D(ce.TEXTURE_2D,0,this.format,K,Q,0,this.format,ce.UNSIGNED_BYTE,h.data);this.useMipmap=!!(U&&U.useMipmap&&this.isSizePowerOfTwo()),this.useMipmap&&ce.generateMipmap(ce.TEXTURE_2D)}bind(h,U){const{context:W}=this,{gl:K}=W;K.bindTexture(K.TEXTURE_2D,this.texture),h!==this.filter&&(K.texParameteri(K.TEXTURE_2D,K.TEXTURE_MAG_FILTER,h),K.texParameteri(K.TEXTURE_2D,K.TEXTURE_MIN_FILTER,this.useMipmap?h===K.NEAREST?K.NEAREST_MIPMAP_NEAREST:K.LINEAR_MIPMAP_NEAREST:h),this.filter=h),U!==this.wrap&&(K.texParameteri(K.TEXTURE_2D,K.TEXTURE_WRAP_S,U),K.texParameteri(K.TEXTURE_2D,K.TEXTURE_WRAP_T,U),this.wrap=U)}isSizePowerOfTwo(){return this.size[0]===this.size[1]&&Math.log(this.size[0])/Math.LN2%1==0}destroy(){const{gl:h}=this.context;h.deleteTexture(this.texture),this.texture=null}}class Wy{constructor(h){this._callback=h,this._triggered=!1,typeof MessageChannel<"u"&&(this._channel=new MessageChannel,this._channel.port2.onmessage=()=>{this._triggered=!1,this._callback()})}trigger(){this._triggered||(this._triggered=!0,this._channel?this._channel.port1.postMessage(!0):setTimeout(()=>{this._triggered=!1,this._callback()},0))}remove(){this._channel=void 0,this._callback=()=>{}}}class Hy{constructor(){this.tasks={},this.taskQueue=[],Ur(["process"],this),this.invoker=new Wy(this.process),this.nextId=0}add(h,U){const W=this.nextId++,K=function({type:Q,isSymbolTile:oe,zoom:ce}){return ce=ce||0,Q==="message"?0:Q!=="maybePrepare"||oe?Q!=="parseTile"||oe?Q==="parseTile"&&oe?300-ce:Q==="maybePrepare"&&oe?400-ce:500:200-ce:100-ce}(U);if(K===0){si();try{h()}finally{}return{cancel:()=>{}}}return this.tasks[W]={fn:h,metadata:U,priority:K,id:W},this.taskQueue.push(W),this.invoker.trigger(),{cancel:()=>{delete this.tasks[W]}}}process(){si();try{if(this.taskQueue=this.taskQueue.filter(W=>!!this.tasks[W]),!this.taskQueue.length)return;const h=this.pick();if(h===null)return;const U=this.tasks[h];if(delete this.tasks[h],this.taskQueue.length&&this.invoker.trigger(),!U)return;U.fn()}finally{}}pick(){let h=null,U=1/0;for(let K=0;K<this.taskQueue.length;K++){const Q=this.tasks[this.taskQueue[K]];Q.priority<U&&(U=Q.priority,h=K)}if(h===null)return null;const W=this.taskQueue[h];return this.taskQueue.splice(h,1),W}remove(){this.invoker.remove()}}class Xp{constructor(h){this._stringToNumber={},this._numberToString=[];for(let U=0;U<h.length;U++){const W=h[U];this._stringToNumber[W]=U,this._numberToString[U]=W}}encode(h){return this._stringToNumber[h]}decode(h){return this._numberToString[h]}}const Zy=["tile","layer","source","sourceLayer","state"];class Yp{constructor(h,U,W,K,Q){this.type="Feature",this._vectorTileFeature=h,this._z=U,this._x=W,this._y=K,this.properties=h.properties,this.id=Q}get geometry(){return this._geometry===void 0&&(this._geometry=this._vectorTileFeature.toGeoJSON(this._x,this._y,this._z).geometry),this._geometry}set geometry(h){this._geometry=h}toJSON(){const h={type:"Feature",state:void 0,geometry:this.geometry,properties:this.properties};this.id!==void 0&&(h.id=this.id);for(const U of Zy)this[U]!==void 0&&(h[U]=this[U]);return h}}const _a=32,Ua=33,Lo=new Uint16Array(8184);for(let R=0;R<2046;R++){let h=R+2,U=0,W=0,K=0,Q=0,oe=0,ce=0;for(1&h?K=Q=oe=_a:U=W=ce=_a;(h>>=1)>1;){const pe=U+K>>1,ve=W+Q>>1;1&h?(K=U,Q=W,U=oe,W=ce):(U=K,W=Q,K=oe,Q=ce),oe=pe,ce=ve}const fe=4*R;Lo[fe+0]=U,Lo[fe+1]=W,Lo[fe+2]=K,Lo[fe+3]=Q}const Va=new Uint16Array(2178),Fo=new Uint8Array(1089),_h=new Uint16Array(1089);function Jp(R){return R===0?-.03125:R===32?.03125:0}var Qp=Dt([{name:"a_pos",type:"Int16",components:2},{name:"a_texture_pos",type:"Int16",components:2}]);const e_={type:2,extent:ri,loadGeometry:()=>[[new He(0,0),new He(ri+1,0),new He(ri+1,ri+1),new He(0,ri+1),new He(0,0)]]};class Ld{constructor(h,U,W,K,Q){this.tileID=h,this.uid=Mr(),this.uses=0,this.tileSize=U,this.tileZoom=W,this.buckets={},this.expirationTime=null,this.queryPadding=0,this.hasSymbolBuckets=!1,this.hasRTLText=!1,this.dependencies={},this.isRaster=Q,this.expiredRequestCount=0,this.state="loading",K&&K.transform&&(this.projection=K.transform.projection)}registerFadeDuration(h){const U=h+this.timeAdded;U<qr.now()||this.fadeEndTime&&U<this.fadeEndTime||(this.fadeEndTime=U)}wasRequested(){return this.state==="errored"||this.state==="loaded"||this.state==="reloading"}get tileTransform(){return this._tileTransform||(this._tileTransform=xs(this.tileID.canonical,this.projection)),this._tileTransform}loadVectorData(h,U,W){if(this.unloadVectorData(),this.state="loaded",h){h.featureIndex&&(this.latestFeatureIndex=h.featureIndex,h.rawTileData?(this.latestRawTileData=h.rawTileData,this.latestFeatureIndex.rawTileData=h.rawTileData):this.latestRawTileData&&(this.latestFeatureIndex.rawTileData=this.latestRawTileData)),this.collisionBoxArray=h.collisionBoxArray,this.buckets=function(K,Q){const oe={};if(!Q)return oe;for(const ce of K){const fe=ce.layerIds.map(pe=>Q.getLayer(pe)).filter(Boolean);if(fe.length!==0){ce.layers=fe,ce.stateDependentLayerIds&&(ce.stateDependentLayers=ce.stateDependentLayerIds.map(pe=>fe.filter(ve=>ve.id===pe)[0]));for(const pe of fe)oe[pe.id]=ce}}return oe}(h.buckets,U.style),this.hasSymbolBuckets=!1;for(const K in this.buckets){const Q=this.buckets[K];if(Q instanceof Do){if(this.hasSymbolBuckets=!0,!W)break;Q.justReloaded=!0}}if(this.hasRTLText=!1,this.hasSymbolBuckets)for(const K in this.buckets){const Q=this.buckets[K];if(Q instanceof Do&&Q.hasRTLText){this.hasRTLText=!0,ye.isLoading()||ye.isLoaded()||de()!=="deferred"||me();break}}this.queryPadding=0;for(const K in this.buckets){const Q=this.buckets[K];this.queryPadding=Math.max(this.queryPadding,U.style.getLayer(K).queryRadius(Q))}h.imageAtlas&&(this.imageAtlas=h.imageAtlas),h.glyphAtlasImage&&(this.glyphAtlasImage=h.glyphAtlasImage),h.lineAtlas&&(this.lineAtlas=h.lineAtlas)}else this.collisionBoxArray=new ki}unloadVectorData(){if(this.hasData()){for(const h in this.buckets)this.buckets[h].destroy();this.buckets={},this.imageAtlas&&(this.imageAtlas=null),this.lineAtlas&&(this.lineAtlas=null),this.imageAtlasTexture&&this.imageAtlasTexture.destroy(),this.glyphAtlasTexture&&this.glyphAtlasTexture.destroy(),this.lineAtlasTexture&&this.lineAtlasTexture.destroy(),this._tileBoundsBuffer&&(this._tileBoundsBuffer.destroy(),this._tileBoundsIndexBuffer.destroy(),this._tileBoundsSegments.destroy(),this._tileBoundsBuffer=null),this._tileDebugBuffer&&(this._tileDebugBuffer.destroy(),this._tileDebugSegments.destroy(),this._tileDebugBuffer=null),this._tileDebugIndexBuffer&&(this._tileDebugIndexBuffer.destroy(),this._tileDebugIndexBuffer=null),this._globeTileDebugBorderBuffer&&(this._globeTileDebugBorderBuffer.destroy(),this._globeTileDebugBorderBuffer=null),this._tileDebugTextBuffer&&(this._tileDebugTextBuffer.destroy(),this._tileDebugTextSegments.destroy(),this._tileDebugTextIndexBuffer.destroy(),this._tileDebugTextBuffer=null),this._globeTileDebugTextBuffer&&(this._globeTileDebugTextBuffer.destroy(),this._globeTileDebugTextBuffer=null),this.latestFeatureIndex=null,this.state="unloaded"}}getBucket(h){return this.buckets[h.id]}upload(h){for(const W in this.buckets){const K=this.buckets[W];K.uploadPending()&&K.upload(h)}const U=h.gl;this.imageAtlas&&!this.imageAtlas.uploaded&&(this.imageAtlasTexture=new Ul(h,this.imageAtlas.image,U.RGBA),this.imageAtlas.uploaded=!0),this.glyphAtlasImage&&(this.glyphAtlasTexture=new Ul(h,this.glyphAtlasImage,U.ALPHA),this.glyphAtlasImage=null),this.lineAtlas&&!this.lineAtlas.uploaded&&(this.lineAtlasTexture=new Ul(h,this.lineAtlas.image,U.ALPHA),this.lineAtlas.uploaded=!0)}prepare(h){this.imageAtlas&&this.imageAtlas.patchUpdatedImages(h,this.imageAtlasTexture)}queryRenderedFeatures(h,U,W,K,Q,oe,ce,fe){return this.latestFeatureIndex&&this.latestFeatureIndex.rawTileData?this.latestFeatureIndex.query({tileResult:K,pixelPosMatrix:ce,transform:oe,params:Q,tileTransform:this.tileTransform},h,U,W):{}}querySourceFeatures(h,U){const W=this.latestFeatureIndex;if(!W||!W.rawTileData)return;const K=W.loadVTLayers(),Q=U?U.sourceLayer:"",oe=K._geojsonTileLayer||K[Q];if(!oe)return;const ce=Zs(U&&U.filter),{z:fe,x:pe,y:ve}=this.tileID.canonical,Ee={z:fe,x:pe,y:ve};for(let we=0;we<oe.length;we++){const Ae=oe.feature(we);if(ce.needGeometry){const Xe=gs(Ae,!0);if(!ce.filter(new be(this.tileID.overscaledZ),Xe,this.tileID.canonical))continue}else if(!ce.filter(new be(this.tileID.overscaledZ),Ae))continue;const Pe=W.getId(Ae,Q),ze=new Yp(Ae,fe,pe,ve,Pe);ze.tile=Ee,h.push(ze)}}hasData(){return this.state==="loaded"||this.state==="reloading"||this.state==="expired"}patternsLoaded(){return!!this.imageAtlas&&!!Object.keys(this.imageAtlas.patternPositions).length}setExpiryData(h){const U=this.expirationTime;if(h.cacheControl){const W=Qr(h.cacheControl);W["max-age"]&&(this.expirationTime=Date.now()+1e3*W["max-age"])}else h.expires&&(this.expirationTime=new Date(h.expires).getTime());if(this.expirationTime){const W=Date.now();let K=!1;if(this.expirationTime>W)K=!1;else if(U)if(this.expirationTime<U)K=!0;else{const Q=this.expirationTime-U;Q?this.expirationTime=W+Math.max(Q,3e4):K=!0}else K=!0;K?(this.expiredRequestCount++,this.state="expired"):this.expiredRequestCount=0}}getExpiryTimeout(){if(this.expirationTime)return this.expiredRequestCount?1e3*(1<<Math.min(this.expiredRequestCount-1,31)):Math.min(this.expirationTime-new Date().getTime(),Math.pow(2,31)-1)}setFeatureState(h,U){if(!this.latestFeatureIndex||!this.latestFeatureIndex.rawTileData||Object.keys(h).length===0||!U)return;const W=this.latestFeatureIndex.loadVTLayers(),K=U.style.listImages();for(const Q in this.buckets){if(!U.style.hasLayer(Q))continue;const oe=this.buckets[Q],ce=oe.layers[0].sourceLayer||"_geojsonTileLayer",fe=W[ce],pe=h[ce];if(!fe||!pe||Object.keys(pe).length===0)continue;if(oe.update(pe,fe,K,this.imageAtlas&&this.imageAtlas.patternPositions||{}),oe instanceof eh||oe instanceof Kc){const Ee=U.style._getSourceCache(oe.layers[0].source);U._terrain&&U._terrain.enabled&&Ee&&oe.programConfigurations.needsUpload&&U._terrain._clearRenderCacheForTile(Ee.id,this.tileID)}const ve=U&&U.style&&U.style.getLayer(Q);ve&&(this.queryPadding=Math.max(this.queryPadding,ve.queryRadius(oe)))}}holdingForFade(){return this.symbolFadeHoldUntil!==void 0}symbolFadeFinished(){return!this.symbolFadeHoldUntil||this.symbolFadeHoldUntil<qr.now()}clearFadeHold(){this.symbolFadeHoldUntil=void 0}setHoldDuration(h){this.symbolFadeHoldUntil=qr.now()+h}setTexture(h,U){const W=U.context,K=W.gl;this.texture=this.texture||U.getTileTexture(h.width),this.texture?this.texture.update(h,{useMipmap:!0}):(this.texture=new Ul(W,h,K.RGBA,{useMipmap:!0}),this.texture.bind(K.LINEAR,K.CLAMP_TO_EDGE))}setDependencies(h,U){const W={};for(const K of U)W[K]=!0;this.dependencies[h]=W}hasDependency(h,U){for(const W of h){const K=this.dependencies[W];if(K){for(const Q of U)if(K[Q])return!0}}return!1}clearQueryDebugViz(){}_makeDebugTileBoundsBuffers(h,U){if(!U||U.name==="mercator"||this._tileDebugBuffer)return;const W=ao(e_,this.tileID.canonical,this.tileTransform)[0],K=new mr,Q=new Kn;for(let oe=0;oe<W.length;oe++){const{x:ce,y:fe}=W[oe];K.emplaceBack(ce,fe),Q.emplaceBack(oe)}Q.emplaceBack(0),this._tileDebugIndexBuffer=h.createIndexBuffer(Q),this._tileDebugBuffer=h.createVertexBuffer(K,bl.members),this._tileDebugSegments=hn.simpleSegment(0,0,K.length,Q.length)}_makeTileBoundsBuffers(h,U){if(this._tileBoundsBuffer||!U||U.name==="mercator")return;const W=ao(e_,this.tileID.canonical,this.tileTransform)[0];let K,Q;if(this.isRaster){const oe=function(ce,fe){const pe=xs(ce,fe),ve=Math.pow(2,ce.z);for(let Xe=0;Xe<Ua;Xe++)for(let at=0;at<Ua;at++){const mt=aa((ce.x+(at+Jp(at))/_a)/ve),ot=Rn((ce.y+(Xe+Jp(Xe))/_a)/ve),pt=fe.project(mt,ot),Et=Xe*Ua+at;Va[2*Et+0]=Math.round((pt.x*pe.scale-pe.x)*ri),Va[2*Et+1]=Math.round((pt.y*pe.scale-pe.y)*ri)}Fo.fill(0),_h.fill(0);for(let Xe=2045;Xe>=0;Xe--){const at=4*Xe,mt=Lo[at+0],ot=Lo[at+1],pt=Lo[at+2],Et=Lo[at+3],bt=mt+pt>>1,$t=ot+Et>>1,zt=bt+$t-ot,rr=$t+mt-bt,yr=ot*Ua+mt,Zt=Et*Ua+pt,ar=$t*Ua+bt,or=Math.hypot((Va[2*yr+0]+Va[2*Zt+0])/2-Va[2*ar+0],(Va[2*yr+1]+Va[2*Zt+1])/2-Va[2*ar+1])>=16;Fo[ar]=Fo[ar]||(or?1:0),Xe<1022&&(Fo[ar]=Fo[ar]||Fo[(ot+rr>>1)*Ua+(mt+zt>>1)]||Fo[(Et+rr>>1)*Ua+(pt+zt>>1)])}const Ee=new nr,we=new Zr;let Ae=0;function Pe(Xe,at){const mt=at*Ua+Xe;return _h[mt]===0&&(Ee.emplaceBack(Va[2*mt+0],Va[2*mt+1],Xe*ri/_a,at*ri/_a),_h[mt]=++Ae),_h[mt]-1}function ze(Xe,at,mt,ot,pt,Et){const bt=Xe+mt>>1,$t=at+ot>>1;if(Math.abs(Xe-pt)+Math.abs(at-Et)>1&&Fo[$t*Ua+bt])ze(pt,Et,Xe,at,bt,$t),ze(mt,ot,pt,Et,bt,$t);else{const zt=Pe(Xe,at),rr=Pe(mt,ot),yr=Pe(pt,Et);we.emplaceBack(zt,rr,yr)}}return ze(0,0,_a,_a,_a,0),ze(_a,_a,0,0,0,_a),{vertices:Ee,indices:we}}(this.tileID.canonical,U);K=oe.vertices,Q=oe.indices}else{K=new nr,Q=new Zr;for(const{x:ce,y:fe}of W)K.emplaceBack(ce,fe,0,0);const oe=_d(K.int16,void 0,4);for(let ce=0;ce<oe.length;ce+=3)Q.emplaceBack(oe[ce],oe[ce+1],oe[ce+2])}this._tileBoundsBuffer=h.createVertexBuffer(K,Qp.members),this._tileBoundsIndexBuffer=h.createIndexBuffer(Q),this._tileBoundsSegments=hn.simpleSegment(0,0,K.length,Q.length)}_makeGlobeTileDebugBuffers(h,U){const W=U.projection;if(!W||W.name!=="globe"||U.freezeTileCoverage)return;const K=this.tileID.canonical,Q=wl(xf(K,U)),oe=nu(U.zoom);let ce;oe>0&&(ce=Vh(new Float64Array(16),U.globeMatrix)),this._makeGlobeTileDebugBorderBuffer(h,K,U,Q,ce,oe),this._makeGlobeTileDebugTextBuffer(h,K,U,Q,ce,oe)}_globePoint(h,U,W,K,Q,oe,ce){let fe=El(h,U,W);if(oe){const pe=1<<W.z,ve=Na(K.center.lng),Ee=ja(K.center.lat),we=(W.x+.5)/pe-ve;let Ae=0;we>.5?Ae=-1:we<-.5&&(Ae=1);let Pe=(h/ri+W.x)/pe+Ae,ze=(U/ri+W.y)/pe;Pe=(Pe-ve)*K._pixelsPerMercatorPixel+ve,ze=(ze-Ee)*K._pixelsPerMercatorPixel+Ee;const Xe=[Pe*K.worldSize,ze*K.worldSize,0];un(Xe,Xe,oe),fe=ys(fe,Xe,ce)}return un(fe,fe,Q)}_makeGlobeTileDebugBorderBuffer(h,U,W,K,Q,oe){const ce=new mr,fe=new Kn,pe=new Bt,ve=(we,Ae,Pe,ze,Xe)=>{const at=(Pe-we)/(Xe-1),mt=(ze-Ae)/(Xe-1),ot=ce.length;for(let pt=0;pt<Xe;pt++){const Et=we+pt*at,bt=Ae+pt*mt;ce.emplaceBack(Et,bt);const $t=this._globePoint(Et,bt,U,W,K,Q,oe);pe.emplaceBack($t[0],$t[1],$t[2]),fe.emplaceBack(ot+pt)}},Ee=ri;ve(0,0,Ee,0,16),ve(Ee,0,Ee,Ee,16),ve(Ee,Ee,0,Ee,16),ve(0,Ee,0,0,16),this._tileDebugIndexBuffer=h.createIndexBuffer(fe),this._tileDebugBuffer=h.createVertexBuffer(ce,bl.members),this._globeTileDebugBorderBuffer=h.createVertexBuffer(pe,gf.members),this._tileDebugSegments=hn.simpleSegment(0,0,ce.length,fe.length)}_makeGlobeTileDebugTextBuffer(h,U,W,K,Q,oe){const ce=ri/4,fe=new mr,pe=new Zr,ve=new Bt,Ee=25;pe.reserve(32),fe.reserve(Ee),ve.reserve(Ee);const we=(Ae,Pe)=>Ee*Ae+Pe;for(let Ae=0;Ae<Ee;Ae++){const Pe=Ae*ce;for(let ze=0;ze<Ee;ze++){const Xe=ze*ce;fe.emplaceBack(Xe,Pe);const at=this._globePoint(Xe,Pe,U,W,K,Q,oe);ve.emplaceBack(at[0],at[1],at[2])}}for(let Ae=0;Ae<4;Ae++)for(let Pe=0;Pe<4;Pe++){const ze=we(Ae,Pe),Xe=we(Ae,Pe+1),at=we(Ae+1,Pe),mt=we(Ae+1,Pe+1);pe.emplaceBack(ze,Xe,at),pe.emplaceBack(at,Xe,mt)}this._tileDebugTextIndexBuffer=h.createIndexBuffer(pe),this._tileDebugTextBuffer=h.createVertexBuffer(fe,bl.members),this._globeTileDebugTextBuffer=h.createVertexBuffer(ve,gf.members),this._tileDebugTextSegments=hn.simpleSegment(0,0,Ee,32)}}class Ky{constructor(){this.state={},this.stateChanges={},this.deletedStates={}}updateState(h,U,W){const K=String(U);if(this.stateChanges[h]=this.stateChanges[h]||{},this.stateChanges[h][K]=this.stateChanges[h][K]||{},lr(this.stateChanges[h][K],W),this.deletedStates[h]===null){this.deletedStates[h]={};for(const Q in this.state[h])Q!==K&&(this.deletedStates[h][Q]=null)}else if(this.deletedStates[h]&&this.deletedStates[h][K]===null){this.deletedStates[h][K]={};for(const Q in this.state[h][K])W[Q]||(this.deletedStates[h][K][Q]=null)}else for(const Q in W)this.deletedStates[h]&&this.deletedStates[h][K]&&this.deletedStates[h][K][Q]===null&&delete this.deletedStates[h][K][Q]}removeFeatureState(h,U,W){if(this.deletedStates[h]===null)return;const K=String(U);if(this.deletedStates[h]=this.deletedStates[h]||{},W&&U!==void 0)this.deletedStates[h][K]!==null&&(this.deletedStates[h][K]=this.deletedStates[h][K]||{},this.deletedStates[h][K][W]=null);else if(U!==void 0)if(this.stateChanges[h]&&this.stateChanges[h][K])for(W in this.deletedStates[h][K]={},this.stateChanges[h][K])this.deletedStates[h][K][W]=null;else this.deletedStates[h][K]=null;else this.deletedStates[h]=null}getState(h,U){const W=String(U),K=lr({},(this.state[h]||{})[W],(this.stateChanges[h]||{})[W]);if(this.deletedStates[h]===null)return{};if(this.deletedStates[h]){const Q=this.deletedStates[h][U];if(Q===null)return{};for(const oe in Q)delete K[oe]}return K}initializeTileState(h,U){h.setFeatureState(this.state,U)}coalesceChanges(h,U){const W={};for(const K in this.stateChanges){this.state[K]=this.state[K]||{};const Q={};for(const oe in this.stateChanges[K])this.state[K][oe]||(this.state[K][oe]={}),lr(this.state[K][oe],this.stateChanges[K][oe]),Q[oe]=this.state[K][oe];W[K]=Q}for(const K in this.deletedStates){this.state[K]=this.state[K]||{};const Q={};if(this.deletedStates[K]===null)for(const oe in this.state[K])Q[oe]={},this.state[K][oe]={};else for(const oe in this.deletedStates[K]){if(this.deletedStates[K][oe]===null)this.state[K][oe]={};else if(this.state[K][oe])for(const ce of Object.keys(this.deletedStates[K][oe]))delete this.state[K][oe][ce];Q[oe]=this.state[K][oe]}W[K]=W[K]||{},lr(W[K],Q)}if(this.stateChanges={},this.deletedStates={},Object.keys(W).length!==0)for(const K in h)h[K].setFeatureState(W,U)}}class t_{constructor(h){this.size=h,this.minimums=[],this.maximums=[],this.leaves=[]}getElevation(h,U){const W=this.toIdx(h,U);return{min:this.minimums[W],max:this.maximums[W]}}isLeaf(h,U){return this.leaves[this.toIdx(h,U)]}toIdx(h,U){return U*this.size+h}}function r_(R,h,U,W){let K=0,Q=Number.MAX_VALUE;for(let oe=0;oe<3;oe++)if(Math.abs(W[oe])<1e-15){if(U[oe]<R[oe]||U[oe]>h[oe])return null}else{const ce=1/W[oe];let fe=(R[oe]-U[oe])*ce,pe=(h[oe]-U[oe])*ce;if(fe>pe){const ve=fe;fe=pe,pe=ve}if(fe>K&&(K=fe),pe<Q&&(Q=pe),K>Q)return null}return K}function i_(R,h,U,W,K,Q,oe,ce,fe,pe,ve){const Ee=W-R,we=K-h,Ae=Q-U,Pe=oe-R,ze=ce-h,Xe=fe-U,at=ve[1]*Xe-ve[2]*ze,mt=ve[2]*Pe-ve[0]*Xe,ot=ve[0]*ze-ve[1]*Pe,pt=Ee*at+we*mt+Ae*ot;if(Math.abs(pt)<1e-15)return null;const Et=1/pt,bt=pe[0]-R,$t=pe[1]-h,zt=pe[2]-U,rr=(bt*at+$t*mt+zt*ot)*Et;if(rr<0||rr>1)return null;const yr=$t*Ae-zt*we,Zt=zt*Ee-bt*Ae,ar=bt*we-$t*Ee,or=(ve[0]*yr+ve[1]*Zt+ve[2]*ar)*Et;return or<0||rr+or>1?null:(Pe*yr+ze*Zt+Xe*ar)*Et}function n_(R,h,U){return(R-h)/(U-h)}function a_(R,h,U,W,K,Q,oe,ce,fe){const pe=1<<U,ve=Q-W,Ee=oe-K,we=(R+1)/pe*ve+W,Ae=(h+0)/pe*Ee+K,Pe=(h+1)/pe*Ee+K;ce[0]=(R+0)/pe*ve+W,ce[1]=Ae,fe[0]=we,fe[1]=Pe}class o_{constructor(h){if(this.maximums=[],this.minimums=[],this.leaves=[],this.childOffsets=[],this.nodeCount=0,this.dem=h,this._siblingOffset=[[0,0],[1,0],[0,1],[1,1]],!this.dem)return;const U=function(Q){const oe=Math.ceil(Math.log2(Q.dim/8)),ce=[];let fe=Math.ceil(Math.pow(2,oe));const pe=1/fe,ve=(Ae,Pe,ze,Xe,at)=>{const mt=Xe?1:0,ot=(Ae+1)*ze-mt,pt=Pe*ze,Et=(Pe+1)*ze-mt;at[0]=Ae*ze,at[1]=pt,at[2]=ot,at[3]=Et};let Ee=new t_(fe);const we=[];for(let Ae=0;Ae<fe*fe;Ae++){ve(Ae%fe,Math.floor(Ae/fe),pe,!1,we);const Pe=ko(we[0],we[1],Q),ze=ko(we[2],we[1],Q),Xe=ko(we[2],we[3],Q),at=ko(we[0],we[3],Q);Ee.minimums.push(Math.min(Pe,ze,Xe,at)),Ee.maximums.push(Math.max(Pe,ze,Xe,at)),Ee.leaves.push(1)}for(ce.push(Ee),fe/=2;fe>=1;fe/=2){const Ae=ce[ce.length-1];Ee=new t_(fe);for(let Pe=0;Pe<fe*fe;Pe++){ve(Pe%fe,Math.floor(Pe/fe),2,!0,we);const ze=Ae.getElevation(we[0],we[1]),Xe=Ae.getElevation(we[2],we[1]),at=Ae.getElevation(we[2],we[3]),mt=Ae.getElevation(we[0],we[3]),ot=Ae.isLeaf(we[0],we[1]),pt=Ae.isLeaf(we[2],we[1]),Et=Ae.isLeaf(we[2],we[3]),bt=Ae.isLeaf(we[0],we[3]),$t=Math.min(ze.min,Xe.min,at.min,mt.min),zt=Math.max(ze.max,Xe.max,at.max,mt.max),rr=ot&&pt&&Et&&bt;Ee.maximums.push(zt),Ee.minimums.push($t),Ee.leaves.push(zt-$t<=5&&rr?1:0)}ce.push(Ee)}return ce}(this.dem),W=U.length-1,K=U[W];this._addNode(K.minimums[0],K.maximums[0],K.leaves[0]),this._construct(U,0,0,W,0)}raycastRoot(h,U,W,K,Q,oe,ce=1){return r_([h,U,-100],[W,K,this.maximums[0]*ce],Q,oe)}raycast(h,U,W,K,Q,oe,ce=1){if(!this.nodeCount)return null;const fe=this.raycastRoot(h,U,W,K,Q,oe,ce);if(fe==null)return null;const pe=[],ve=[],Ee=[],we=[],Ae=[{idx:0,t:fe,nodex:0,nodey:0,depth:0}];for(;Ae.length>0;){const{idx:Pe,t:ze,nodex:Xe,nodey:at,depth:mt}=Ae.pop();if(this.leaves[Pe]){a_(Xe,at,mt,h,U,W,K,Ee,we);const pt=1<<mt,Et=(Xe+0)/pt,bt=(Xe+1)/pt,$t=(at+0)/pt,zt=(at+1)/pt,rr=ko(Et,$t,this.dem)*ce,yr=ko(bt,$t,this.dem)*ce,Zt=ko(bt,zt,this.dem)*ce,ar=ko(Et,zt,this.dem)*ce,or=i_(Ee[0],Ee[1],rr,we[0],Ee[1],yr,we[0],we[1],Zt,Q,oe),hr=i_(we[0],we[1],Zt,Ee[0],we[1],ar,Ee[0],Ee[1],rr,Q,oe),Sr=Math.min(or!==null?or:Number.MAX_VALUE,hr!==null?hr:Number.MAX_VALUE);if(Sr!==Number.MAX_VALUE)return Sr;{const Jt=gl([],Q,oe,ze);if(s_(rr,yr,ar,Zt,n_(Jt[0],Ee[0],we[0]),n_(Jt[1],Ee[1],we[1]))>=Jt[2])return ze}continue}let ot=0;for(let pt=0;pt<this._siblingOffset.length;pt++){a_((Xe<<1)+this._siblingOffset[pt][0],(at<<1)+this._siblingOffset[pt][1],mt+1,h,U,W,K,Ee,we),Ee[2]=-100,we[2]=this.maximums[this.childOffsets[Pe]+pt]*ce;const Et=r_(Ee,we,Q,oe);if(Et!=null){const bt=Et;pe[pt]=bt;let $t=!1;for(let zt=0;zt<ot&&!$t;zt++)bt>=pe[ve[zt]]&&(ve.splice(zt,0,pt),$t=!0);$t||(ve[ot]=pt),ot++}}for(let pt=0;pt<ot;pt++){const Et=ve[pt];Ae.push({idx:this.childOffsets[Pe]+Et,t:pe[Et],nodex:(Xe<<1)+this._siblingOffset[Et][0],nodey:(at<<1)+this._siblingOffset[Et][1],depth:mt+1})}}return null}_addNode(h,U,W){return this.minimums.push(h),this.maximums.push(U),this.leaves.push(W),this.childOffsets.push(0),this.nodeCount++}_construct(h,U,W,K,Q){if(h[K].isLeaf(U,W)===1)return;this.childOffsets[Q]||(this.childOffsets[Q]=this.nodeCount);const oe=K-1,ce=h[oe];let fe=0,pe=0;for(let ve=0;ve<this._siblingOffset.length;ve++){const Ee=2*U+this._siblingOffset[ve][0],we=2*W+this._siblingOffset[ve][1],Ae=ce.getElevation(Ee,we),Pe=ce.isLeaf(Ee,we),ze=this._addNode(Ae.min,Ae.max,Pe);Pe&&(fe|=1<<ve),pe||(pe=ze)}for(let ve=0;ve<this._siblingOffset.length;ve++)fe&1<<ve||this._construct(h,2*U+this._siblingOffset[ve][0],2*W+this._siblingOffset[ve][1],oe,pe+ve)}}function s_(R,h,U,W,K,Q){return Ti(Ti(R,U,Q),Ti(h,W,Q),K)}function ko(R,h,U){const W=U.dim,K=nt(R*W-.5,0,W-1),Q=nt(h*W-.5,0,W-1),oe=Math.floor(K),ce=Math.floor(Q),fe=Math.min(oe+1,W-1),pe=Math.min(ce+1,W-1);return s_(U.get(oe,ce),U.get(fe,ce),U.get(oe,pe),U.get(fe,pe),K-oe,Q-ce)}const u_={mapbox:[6553.6,25.6,.1,1e4],terrarium:[256,1,1/256,32768]};function Xy(R,h,U){return(256*R*256+256*h+U)/10-1e4}function Yy(R,h,U){return 256*R+h+U/256-32768}class mh{get tree(){return this._tree||this._buildQuadTree(),this._tree}constructor(h,U,W,K=!1,Q=!1){if(this.uid=h,U.height!==U.width)throw new RangeError("DEM tiles must be square");if(W&&W!=="mapbox"&&W!=="terrarium")return Hr(`"${W}" is not a valid encoding type. Valid types include "mapbox" and "terrarium".`);this.stride=U.height;const oe=this.dim=U.height-2,ce=new Uint32Array(U.data.buffer);if(this.pixels=new Uint8Array(U.data.buffer),this.encoding=W||"mapbox",this.borderReady=K,!K){for(let fe=0;fe<oe;fe++)ce[this._idx(-1,fe)]=ce[this._idx(0,fe)],ce[this._idx(oe,fe)]=ce[this._idx(oe-1,fe)],ce[this._idx(fe,-1)]=ce[this._idx(fe,0)],ce[this._idx(fe,oe)]=ce[this._idx(fe,oe-1)];ce[this._idx(-1,-1)]=ce[this._idx(0,0)],ce[this._idx(oe,-1)]=ce[this._idx(oe-1,0)],ce[this._idx(-1,oe)]=ce[this._idx(0,oe-1)],ce[this._idx(oe,oe)]=ce[this._idx(oe-1,oe-1)],Q&&this._buildQuadTree()}}_buildQuadTree(){this._tree=new o_(this)}get(h,U,W=!1){W&&(h=nt(h,-1,this.dim),U=nt(U,-1,this.dim));const K=4*this._idx(h,U);return(this.encoding==="terrarium"?Yy:Xy)(this.pixels[K],this.pixels[K+1],this.pixels[K+2])}static getUnpackVector(h){return u_[h]}get unpackVector(){return u_[this.encoding]}_idx(h,U){if(h<-1||h>=this.dim+1||U<-1||U>=this.dim+1)throw new RangeError("out of range source coordinates for DEM data");return(U+1)*this.stride+(h+1)}static pack(h,U){const W=[0,0,0,0],K=mh.getUnpackVector(U);let Q=Math.floor((h+K[3])/K[2]);return W[2]=Q%256,Q=Math.floor(Q/256),W[1]=Q%256,Q=Math.floor(Q/256),W[0]=Q,W}getPixels(){return new Yn({width:this.stride,height:this.stride},this.pixels)}backfillBorder(h,U,W){if(this.dim!==h.dim)throw new Error("dem dimension mismatch");let K=U*this.dim,Q=U*this.dim+this.dim,oe=W*this.dim,ce=W*this.dim+this.dim;switch(U){case-1:K=Q-1;break;case 1:Q=K+1}switch(W){case-1:oe=ce-1;break;case 1:ce=oe+1}const fe=-U*this.dim,pe=-W*this.dim;for(let ve=oe;ve<ce;ve++)for(let Ee=K;Ee<Q;Ee++){const we=4*this._idx(Ee,ve),Ae=4*this._idx(Ee+fe,ve+pe);this.pixels[we+0]=h.pixels[Ae+0],this.pixels[we+1]=h.pixels[Ae+1],this.pixels[we+2]=h.pixels[Ae+2],this.pixels[we+3]=h.pixels[Ae+3]}}onDeserialize(){this._tree&&(this._tree.dem=this)}}Vr(mh,"DEMData"),Vr(o_,"DemMinMaxQuadTree",{omit:["dem"]});class Jy{constructor(h,U){this.max=h,this.onRemove=U,this.reset()}reset(){for(const h in this.data)for(const U of this.data[h])U.timeout&&clearTimeout(U.timeout),this.onRemove(U.value);return this.data={},this.order=[],this}add(h,U,W){const K=h.wrapped().key;this.data[K]===void 0&&(this.data[K]=[]);const Q={value:U,timeout:void 0};if(W!==void 0&&(Q.timeout=setTimeout(()=>{this.remove(h,Q)},W)),this.data[K].push(Q),this.order.push(K),this.order.length>this.max){const oe=this._getAndRemoveByKey(this.order[0]);oe&&this.onRemove(oe)}return this}has(h){return h.wrapped().key in this.data}getAndRemove(h){return this.has(h)?this._getAndRemoveByKey(h.wrapped().key):null}_getAndRemoveByKey(h){const U=this.data[h].shift();return U.timeout&&clearTimeout(U.timeout),this.data[h].length===0&&delete this.data[h],this.order.splice(this.order.indexOf(h),1),U.value}getByKey(h){const U=this.data[h];return U?U[0].value:null}get(h){return this.has(h)?this.data[h.wrapped().key][0].value:null}remove(h,U){if(!this.has(h))return this;const W=h.wrapped().key,K=U===void 0?0:this.data[W].indexOf(U),Q=this.data[W][K];return this.data[W].splice(K,1),Q.timeout&&clearTimeout(Q.timeout),this.data[W].length===0&&delete this.data[W],this.onRemove(Q.value),this.order.splice(this.order.indexOf(W),1),this}setMaxSize(h){for(this.max=h;this.order.length>this.max;){const U=this._getAndRemoveByKey(this.order[0]);U&&this.onRemove(U)}return this}filter(h){const U=[];for(const W in this.data)for(const K of this.data[W])h(K.value)||U.push(K);for(const W of U)this.remove(W.value.tileID,W)}}class vu{constructor(h,U,W){this.func=h,this.mask=U,this.range=W}}vu.ReadOnly=!1,vu.ReadWrite=!0,vu.disabled=new vu(519,vu.ReadOnly,[0,1]);const Fd=7680;class kd{constructor(h,U,W,K,Q,oe){this.test=h,this.ref=U,this.mask=W,this.fail=K,this.depthFail=Q,this.pass=oe}}kd.disabled=new kd({func:519,mask:0},0,0,Fd,Fd,Fd);class Ga{constructor(h,U,W){this.blendFunction=h,this.blendColor=U,this.mask=W}}Ga.Replace=[1,0],Ga.disabled=new Ga(Ga.Replace,sn.transparent,[!1,!1,!1,!1]),Ga.unblended=new Ga(Ga.Replace,sn.transparent,[!0,!0,!0,!0]),Ga.alphaBlended=new Ga([1,771],sn.transparent,[!0,!0,!0,!0]);const Bd=1029,zd=2305;class Pa{constructor(h,U,W){this.enable=h,this.mode=U,this.frontFace=W}}Pa.disabled=new Pa(!1,Bd,zd),Pa.backCCW=new Pa(!0,Bd,zd),Pa.backCW=new Pa(!0,Bd,2304),Pa.frontCW=new Pa(!0,1028,2304),Pa.frontCCW=new Pa(!0,1028,zd);class Es extends Da{constructor(h,U,W){super(),this.id=h,this._onlySymbols=W,U.on("data",K=>{K.dataType==="source"&&K.sourceDataType==="metadata"&&(this._sourceLoaded=!0),this._sourceLoaded&&!this._paused&&K.dataType==="source"&&K.sourceDataType==="content"&&(this.reload(),this.transform&&this.update(this.transform))}),U.on("error",()=>{this._sourceErrored=!0}),this._source=U,this._tiles={},this._cache=new Jy(0,this._unloadTile.bind(this)),this._timers={},this._cacheTimers={},this._minTileCacheSize=U.minTileCacheSize,this._maxTileCacheSize=U.maxTileCacheSize,this._loadedParentTiles={},this._coveredTiles={},this._state=new Ky,this._isRaster=this._source.type==="raster"||this._source.type==="raster-dem"||this._source.type==="custom"&&this._source._dataType==="raster"}onAdd(h){this.map=h,this._minTileCacheSize=this._minTileCacheSize===void 0&&h?h._minTileCacheSize:this._minTileCacheSize,this._maxTileCacheSize=this._maxTileCacheSize===void 0&&h?h._maxTileCacheSize:this._maxTileCacheSize}loaded(){if(this._sourceErrored)return!0;if(!this._sourceLoaded||!this._source.loaded())return!1;for(const h in this._tiles){const U=this._tiles[h];if(U.state!=="loaded"&&U.state!=="errored")return!1}return!0}getSource(){return this._source}pause(){this._paused=!0}resume(){if(!this._paused)return;const h=this._shouldReloadOnResume;this._paused=!1,this._shouldReloadOnResume=!1,h&&this.reload(),this.transform&&this.update(this.transform)}_loadTile(h,U){return h.isSymbolTile=this._onlySymbols,this._source.loadTile(h,U)}_unloadTile(h){if(this._source.unloadTile)return this._source.unloadTile(h,()=>{})}_abortTile(h){if(this._source.abortTile)return this._source.abortTile(h,()=>{})}serialize(){return this._source.serialize()}prepare(h){this._source.prepare&&this._source.prepare(),this._state.coalesceChanges(this._tiles,this.map?this.map.painter:null);for(const U in this._tiles){const W=this._tiles[U];W.upload(h),W.prepare(this.map.style.imageManager)}}getIds(){return er(this._tiles).map(h=>h.tileID).sort(l_).map(h=>h.key)}getRenderableIds(h){const U=[];for(const W in this._tiles)this._isIdRenderable(+W,h)&&U.push(this._tiles[W]);return h?U.sort((W,K)=>{const Q=W.tileID,oe=K.tileID,ce=new He(Q.canonical.x,Q.canonical.y)._rotate(this.transform.angle),fe=new He(oe.canonical.x,oe.canonical.y)._rotate(this.transform.angle);return Q.overscaledZ-oe.overscaledZ||fe.y-ce.y||fe.x-ce.x}).map(W=>W.tileID.key):U.map(W=>W.tileID).sort(l_).map(W=>W.key)}hasRenderableParent(h){const U=this.findLoadedParent(h,0);return!!U&&this._isIdRenderable(U.tileID.key)}_isIdRenderable(h,U){return this._tiles[h]&&this._tiles[h].hasData()&&!this._coveredTiles[h]&&(U||!this._tiles[h].holdingForFade())}reload(){if(this._paused)this._shouldReloadOnResume=!0;else{this._cache.reset();for(const h in this._tiles)this._tiles[h].state!=="errored"&&this._reloadTile(+h,"reloading")}}_reloadTile(h,U){const W=this._tiles[h];W&&(W.state!=="loading"&&(W.state=U),this._loadTile(W,this._tileLoaded.bind(this,W,h,U)))}_tileLoaded(h,U,W,K){if(K)if(h.state="errored",K.status!==404)this._source.fire(new Gn(K,{tile:h}));else if(this._source.type==="raster-dem"&&this.usedForTerrain&&this.map.painter.terrain){const Q=this.map.painter.terrain;this.update(this.transform,Q.getScaledDemTileSize(),!0),Q.resetTileLookupCache(this.id)}else this.update(this.transform);else h.timeAdded=qr.now(),W==="expired"&&(h.refreshedUponExpiration=!0),this._setTileReloadTimer(U,h),this._source.type==="raster-dem"&&h.dem&&this._backfillDEM(h),this._state.initializeTileState(h,this.map?this.map.painter:null),this._source.fire(new ea("data",{dataType:"source",tile:h,coord:h.tileID,sourceCacheId:this.id}))}_backfillDEM(h){const U=this.getRenderableIds();for(let K=0;K<U.length;K++){const Q=U[K];if(h.neighboringTiles&&h.neighboringTiles[Q]){const oe=this.getTileByID(Q);W(h,oe),W(oe,h)}}function W(K,Q){if(!K.dem||K.dem.borderReady)return;K.needsHillshadePrepare=!0,K.needsDEMTextureUpload=!0;let oe=Q.tileID.canonical.x-K.tileID.canonical.x;const ce=Q.tileID.canonical.y-K.tileID.canonical.y,fe=Math.pow(2,K.tileID.canonical.z),pe=Q.tileID.key;oe===0&&ce===0||Math.abs(ce)>1||(Math.abs(oe)>1&&(Math.abs(oe+fe)===1?oe+=fe:Math.abs(oe-fe)===1&&(oe-=fe)),Q.dem&&K.dem&&(K.dem.backfillBorder(Q.dem,oe,ce),K.neighboringTiles&&K.neighboringTiles[pe]&&(K.neighboringTiles[pe].backfilled=!0)))}}getTile(h){return this.getTileByID(h.key)}getTileByID(h){return this._tiles[h]}_retainLoadedChildren(h,U,W,K){for(const Q in this._tiles){let oe=this._tiles[Q];if(K[Q]||!oe.hasData()||oe.tileID.overscaledZ<=U||oe.tileID.overscaledZ>W)continue;let ce=oe.tileID;for(;oe&&oe.tileID.overscaledZ>U+1;){const pe=oe.tileID.scaledTo(oe.tileID.overscaledZ-1);oe=this._tiles[pe.key],oe&&oe.hasData()&&(ce=pe)}let fe=ce;for(;fe.overscaledZ>U;)if(fe=fe.scaledTo(fe.overscaledZ-1),h[fe.key]){K[ce.key]=ce;break}}}findLoadedParent(h,U){if(h.key in this._loadedParentTiles){const W=this._loadedParentTiles[h.key];return W&&W.tileID.overscaledZ>=U?W:null}for(let W=h.overscaledZ-1;W>=U;W--){const K=h.scaledTo(W),Q=this._getLoadedTile(K);if(Q)return Q}}_getLoadedTile(h){const U=this._tiles[h.key];return U&&U.hasData()?U:this._cache.getByKey(this._source.reparseOverscaled?h.wrapped().key:h.canonical.key)}updateCacheSize(h,U){U=U||this._source.tileSize;const W=Math.ceil(h.width/U)+1,K=Math.ceil(h.height/U)+1,Q=Math.floor(W*K*5),oe=typeof this._minTileCacheSize=="number"?Math.max(this._minTileCacheSize,Q):Q,ce=typeof this._maxTileCacheSize=="number"?Math.min(this._maxTileCacheSize,oe):oe;this._cache.setMaxSize(ce)}handleWrapJump(h){const U=Math.round((h-(this._prevLng===void 0?h:this._prevLng))/360);if(this._prevLng=h,U){const W={};for(const K in this._tiles){const Q=this._tiles[K];Q.tileID=Q.tileID.unwrapTo(Q.tileID.wrap+U),W[Q.tileID.key]=Q}this._tiles=W;for(const K in this._timers)clearTimeout(this._timers[K]),delete this._timers[K];for(const K in this._tiles)this._setTileReloadTimer(+K,this._tiles[K])}}update(h,U,W){if(this.transform=h,!this._sourceLoaded||this._paused||this.transform.freezeTileCoverage||this.usedForTerrain&&!W)return;let K;this.updateCacheSize(h,U),this.transform.projection.name!=="globe"&&this.handleWrapJump(this.transform.center.lng),this._coveredTiles={},this.used||this.usedForTerrain?this._source.tileID?K=h.getVisibleUnwrappedCoordinates(this._source.tileID).map(ce=>new kn(ce.canonical.z,ce.wrap,ce.canonical.z,ce.canonical.x,ce.canonical.y)):(K=h.coveringTiles({tileSize:U||this._source.tileSize,minzoom:this._source.minzoom,maxzoom:this._source.maxzoom,roundZoom:this._source.roundZoom&&!W,reparseOverscaled:this._source.reparseOverscaled,isTerrainDEM:this.usedForTerrain}),this._source.hasTile&&(K=K.filter(ce=>this._source.hasTile(ce)))):K=[];const Q=this._updateRetainedTiles(K);if(c_(this._source.type)&&K.length!==0){const ce={},fe={},pe=Object.keys(Q);for(const Ee of pe){const we=Q[Ee],Ae=this._tiles[Ee];if(!Ae||Ae.fadeEndTime&&Ae.fadeEndTime<=qr.now())continue;const Pe=this.findLoadedParent(we,Math.max(we.overscaledZ-Es.maxOverzooming,this._source.minzoom));Pe&&(this._addTile(Pe.tileID),ce[Pe.tileID.key]=Pe.tileID),fe[Ee]=we}const ve=K[K.length-1].overscaledZ;for(const Ee in this._tiles){const we=this._tiles[Ee];if(Q[Ee]||!we.hasData())continue;let Ae=we.tileID;for(;Ae.overscaledZ>ve;){Ae=Ae.scaledTo(Ae.overscaledZ-1);const Pe=this._tiles[Ae.key];if(Pe&&Pe.hasData()&&fe[Ae.key]){Q[Ee]=we.tileID;break}}}for(const Ee in ce)Q[Ee]||(this._coveredTiles[Ee]=!0,Q[Ee]=ce[Ee])}for(const ce in Q)this._tiles[ce].clearFadeHold();const oe=function(ce,fe){const pe=[];for(const ve in ce)ve in fe||pe.push(ve);return pe}(this._tiles,Q);for(const ce of oe){const fe=this._tiles[ce];fe.hasSymbolBuckets&&!fe.holdingForFade()?fe.setHoldDuration(this.map._fadeDuration):fe.hasSymbolBuckets&&!fe.symbolFadeFinished()||this._removeTile(+ce)}this._updateLoadedParentTileCache(),this._onlySymbols&&this._source.afterUpdate&&this._source.afterUpdate()}releaseSymbolFadeTiles(){for(const h in this._tiles)this._tiles[h].holdingForFade()&&this._removeTile(+h)}_updateRetainedTiles(h){const U={};if(h.length===0)return U;const W={},K=h.reduce((pe,ve)=>Math.min(pe,ve.overscaledZ),1/0),Q=h[0].overscaledZ,oe=Math.max(Q-Es.maxOverzooming,this._source.minzoom),ce=Math.max(Q+Es.maxUnderzooming,this._source.minzoom),fe={};for(const pe of h){const ve=this._addTile(pe);U[pe.key]=pe,ve.hasData()||K<this._source.maxzoom&&(fe[pe.key]=pe)}this._retainLoadedChildren(fe,K,ce,U);for(const pe of h){let ve=this._tiles[pe.key];if(ve.hasData())continue;if(pe.canonical.z>=this._source.maxzoom){const we=pe.children(this._source.maxzoom)[0],Ae=this.getTile(we);if(Ae&&Ae.hasData()){U[we.key]=we;continue}}else{const we=pe.children(this._source.maxzoom);if(U[we[0].key]&&U[we[1].key]&&U[we[2].key]&&U[we[3].key])continue}let Ee=ve.wasRequested();for(let we=pe.overscaledZ-1;we>=oe;--we){const Ae=pe.scaledTo(we);if(W[Ae.key]||(W[Ae.key]=!0,ve=this.getTile(Ae),!ve&&Ee&&(ve=this._addTile(Ae)),ve&&(U[Ae.key]=Ae,Ee=ve.wasRequested(),ve.hasData())))break}}return U}_updateLoadedParentTileCache(){this._loadedParentTiles={};for(const h in this._tiles){const U=[];let W,K=this._tiles[h].tileID;for(;K.overscaledZ>0;){if(K.key in this._loadedParentTiles){W=this._loadedParentTiles[K.key];break}U.push(K.key);const Q=K.scaledTo(K.overscaledZ-1);if(W=this._getLoadedTile(Q),W)break;K=Q}for(const Q of U)this._loadedParentTiles[Q]=W}}_addTile(h){let U=this._tiles[h.key];if(U)return U;U=this._cache.getAndRemove(h),U&&(this._setTileReloadTimer(h.key,U),U.tileID=h,this._state.initializeTileState(U,this.map?this.map.painter:null),this._cacheTimers[h.key]&&(clearTimeout(this._cacheTimers[h.key]),delete this._cacheTimers[h.key],this._setTileReloadTimer(h.key,U)));const W=!!U;if(!W){const K=this.map?this.map.painter:null;U=new Ld(h,this._source.tileSize*h.overscaleFactor(),this.transform.tileZoom,K,this._isRaster),this._loadTile(U,this._tileLoaded.bind(this,U,h.key,U.state))}return U?(U.uses++,this._tiles[h.key]=U,W||this._source.fire(new ea("dataloading",{tile:U,coord:U.tileID,dataType:"source"})),U):null}_setTileReloadTimer(h,U){h in this._timers&&(clearTimeout(this._timers[h]),delete this._timers[h]);const W=U.getExpiryTimeout();W&&(this._timers[h]=setTimeout(()=>{this._reloadTile(h,"expired"),delete this._timers[h]},W))}_removeTile(h){const U=this._tiles[h];U&&(U.uses--,delete this._tiles[h],this._timers[h]&&(clearTimeout(this._timers[h]),delete this._timers[h]),U.uses>0||(U.hasData()&&U.state!=="reloading"?this._cache.add(U.tileID,U,U.getExpiryTimeout()):(U.aborted=!0,this._abortTile(U),this._unloadTile(U))))}clearTiles(){this._shouldReloadOnResume=!1,this._paused=!1;for(const h in this._tiles)this._removeTile(+h);this._source._clear&&this._source._clear(),this._cache.reset(),this.map&&this.usedForTerrain&&this.map.painter.terrain&&this.map.painter.terrain.resetTileLookupCache(this.id)}tilesIn(h,U,W){const K=[],Q=this.transform;if(!Q)return K;const oe=Q.projection.name==="globe",ce=Na(Q.center.lng);for(const fe in this._tiles){const pe=this._tiles[fe];if(W&&pe.clearQueryDebugViz(),pe.holdingForFade())continue;let ve;if(oe){const Ee=pe.tileID.canonical;if(Ee.z===0){const we=[Math.abs(nt(ce,...Vl(Ee,-1))-ce),Math.abs(nt(ce,...Vl(Ee,1))-ce)];ve=[0,2*we.indexOf(Math.min(...we))-1]}else{const we=[Math.abs(nt(ce,...Vl(Ee,-1))-ce),Math.abs(nt(ce,...Vl(Ee,0))-ce),Math.abs(nt(ce,...Vl(Ee,1))-ce)];ve=[we.indexOf(Math.min(...we))-1]}}else ve=[0];for(const Ee of ve){const we=h.containsTile(pe,Q,U,Ee);we&&K.push(we)}}return K}getVisibleCoordinates(h){const U=this.getRenderableIds(h).map(W=>this._tiles[W].tileID);for(const W of U)W.projMatrix=this.transform.calculateProjMatrix(W.toUnwrapped());return U}hasTransition(){if(this._source.hasTransition())return!0;if(c_(this._source.type))for(const h in this._tiles){const U=this._tiles[h];if(U.fadeEndTime!==void 0&&U.fadeEndTime>=qr.now())return!0}return!1}setFeatureState(h,U,W){this._state.updateState(h=h||"_geojsonTileLayer",U,W)}removeFeatureState(h,U,W){this._state.removeFeatureState(h=h||"_geojsonTileLayer",U,W)}getFeatureState(h,U){return this._state.getState(h=h||"_geojsonTileLayer",U)}setDependencies(h,U,W){const K=this._tiles[h];K&&K.setDependencies(U,W)}reloadTilesForDependencies(h,U){for(const W in this._tiles)this._tiles[W].hasDependency(h,U)&&this._reloadTile(+W,"reloading");this._cache.filter(W=>!W.hasDependency(h,U))}_preloadTiles(h,U){if(!this._sourceLoaded){const ce=()=>{this._sourceLoaded&&(this._source.off("data",ce),this._preloadTiles(h,U))};return void this._source.on("data",ce)}const W=new Map,K=Array.isArray(h)?h:[h],Q=this.map.painter.terrain,oe=this.usedForTerrain&&Q?Q.getScaledDemTileSize():this._source.tileSize;for(const ce of K){const fe=ce.coveringTiles({tileSize:oe,minzoom:this._source.minzoom,maxzoom:this._source.maxzoom,roundZoom:this._source.roundZoom&&!this.usedForTerrain,reparseOverscaled:this._source.reparseOverscaled,isTerrainDEM:this.usedForTerrain});for(const pe of fe)W.set(pe.key,pe);this.usedForTerrain&&ce.updateElevation(!1)}Ft(Array.from(W.values()),(ce,fe)=>{const pe=new Ld(ce,this._source.tileSize*ce.overscaleFactor(),this.transform.tileZoom,this.map.painter,this._isRaster);this._loadTile(pe,ve=>{this._source.type==="raster-dem"&&pe.dem&&this._backfillDEM(pe),fe(ve,pe)})},U)}}function l_(R,h){const U=Math.abs(2*R.wrap)-+(R.wrap<0),W=Math.abs(2*h.wrap)-+(h.wrap<0);return R.overscaledZ-h.overscaledZ||W-U||h.canonical.y-R.canonical.y||h.canonical.x-R.canonical.x}function c_(R){return R==="raster"||R==="image"||R==="video"||R==="custom"}function Vl(R,h){const U=1<<R.z;return[R.x/U+h,(R.x+1)/U+h]}Es.maxOverzooming=10,Es.maxUnderzooming=3;class yh{constructor(h,U,W){this._demTile=h,this._dem=this._demTile.dem,this._scale=U,this._offset=W}static create(h,U,W){const K=W||h.findDEMTileFor(U);if(!K||!K.dem)return;const Q=K.dem,oe=K.tileID,ce=1<<U.canonical.z-oe.canonical.z;return new yh(K,K.tileSize/ri/ce,[(U.canonical.x/ce-oe.canonical.x)*Q.dim,(U.canonical.y/ce-oe.canonical.y)*Q.dim])}tileCoordToPixel(h,U){const W=U*this._scale+this._offset[1],K=Math.floor(h*this._scale+this._offset[0]),Q=Math.floor(W);return new He(K,Q)}getElevationAt(h,U,W,K){const Q=h*this._scale+this._offset[0],oe=U*this._scale+this._offset[1],ce=Math.floor(Q),fe=Math.floor(oe),pe=this._dem;return K=!!K,W?Ti(Ti(pe.get(ce,fe,K),pe.get(ce,fe+1,K),oe-fe),Ti(pe.get(ce+1,fe,K),pe.get(ce+1,fe+1,K),oe-fe),Q-ce):pe.get(ce,fe,K)}getElevationAtPixel(h,U,W){return this._dem.get(h,U,!!W)}getMeterToDEM(h){return(1<<this._demTile.tileID.canonical.z)*Ra(1,h)*this._dem.stride}}class h_{constructor(h,U){this.tileID=h,this.x=h.canonical.x,this.y=h.canonical.y,this.z=h.canonical.z,this.grid=new Ja(ri,16,0),this.featureIndexArray=new ls,this.promoteId=U}insert(h,U,W,K,Q,oe=0){const ce=this.featureIndexArray.length;this.featureIndexArray.emplaceBack(W,K,Q,oe);const fe=this.grid;for(let pe=0;pe<U.length;pe++){const ve=U[pe],Ee=[1/0,1/0,-1/0,-1/0];for(let we=0;we<ve.length;we++){const Ae=ve[we];Ee[0]=Math.min(Ee[0],Ae.x),Ee[1]=Math.min(Ee[1],Ae.y),Ee[2]=Math.max(Ee[2],Ae.x),Ee[3]=Math.max(Ee[3],Ae.y)}Ee[0]<ri&&Ee[1]<ri&&Ee[2]>=0&&Ee[3]>=0&&fe.insert(ce,Ee[0],Ee[1],Ee[2],Ee[3])}}loadVTLayers(){if(!this.vtLayers){this.vtLayers=new vd(new ih(this.rawTileData)).layers,this.sourceLayerCoder=new Xp(this.vtLayers?Object.keys(this.vtLayers).sort():["_geojsonTileLayer"]),this.vtFeatures={};for(const h in this.vtLayers)this.vtFeatures[h]=[]}return this.vtLayers}query(h,U,W,K){this.loadVTLayers();const Q=h.params||{},oe=Zs(Q.filter),ce=h.tileResult,fe=h.transform,pe=ce.bufferedTilespaceBounds,ve=this.grid.query(pe.min.x,pe.min.y,pe.max.x,pe.max.y,(Pe,ze,Xe,at)=>Ff(ce.bufferedTilespaceGeometry,Pe,ze,Xe,at));ve.sort(Qy);let Ee=null;fe.elevation&&ve.length>0&&(Ee=yh.create(fe.elevation,this.tileID));const we={};let Ae;for(let Pe=0;Pe<ve.length;Pe++){const ze=ve[Pe];if(ze===Ae)continue;Ae=ze;const Xe=this.featureIndexArray.get(ze);let at=null;this.loadMatchingFeature(we,Xe,oe,Q.layers,Q.availableImages,U,W,K,(mt,ot,pt,Et=0)=>(at||(at=ao(mt,this.tileID.canonical,h.tileTransform)),ot.queryIntersectsFeature(ce,mt,pt,at,this.z,h.transform,h.pixelPosMatrix,Ee,Et)))}return we}loadMatchingFeature(h,U,W,K,Q,oe,ce,fe,pe){const{featureIndex:ve,bucketIndex:Ee,sourceLayerIndex:we,layoutVertexArrayOffset:Ae}=U,Pe=this.bucketLayerIDs[Ee];if(K&&!function(mt,ot){for(let pt=0;pt<mt.length;pt++)if(ot.indexOf(mt[pt])>=0)return!0;return!1}(K,Pe))return;const ze=this.sourceLayerCoder.decode(we),Xe=this.vtLayers[ze].feature(ve);if(W.needGeometry){const mt=gs(Xe,!0);if(!W.filter(new be(this.tileID.overscaledZ),mt,this.tileID.canonical))return}else if(!W.filter(new be(this.tileID.overscaledZ),Xe))return;const at=this.getId(Xe,ze);for(let mt=0;mt<Pe.length;mt++){const ot=Pe[mt];if(K&&K.indexOf(ot)<0)continue;const pt=oe[ot];if(!pt)continue;let Et={};at!==void 0&&fe&&(Et=fe.getState(pt.sourceLayer||"_geojsonTileLayer",at));const bt=lr({},ce[ot]);bt.paint=d_(bt.paint,pt.paint,Xe,Et,Q),bt.layout=d_(bt.layout,pt.layout,Xe,Et,Q);const $t=!pe||pe(Xe,pt,Et,Ae);if(!$t)continue;const zt=new Yp(Xe,this.z,this.x,this.y,at);zt.layer=bt;let rr=h[ot];rr===void 0&&(rr=h[ot]=[]),rr.push({featureIndex:ve,feature:zt,intersectionZ:$t})}}lookupSymbolFeatures(h,U,W,K,Q,oe,ce,fe){const pe={};this.loadVTLayers();const ve=Zs(Q);for(const Ee of h)this.loadMatchingFeature(pe,{bucketIndex:W,sourceLayerIndex:K,featureIndex:Ee,layoutVertexArrayOffset:0},ve,oe,ce,fe,U);return pe}loadFeature(h){const{featureIndex:U,sourceLayerIndex:W}=h;this.loadVTLayers();const K=this.sourceLayerCoder.decode(W),Q=this.vtFeatures[K];if(Q[U])return Q[U];const oe=this.vtLayers[K].feature(U);return Q[U]=oe,oe}hasLayer(h){for(const U of this.bucketLayerIDs)for(const W of U)if(h===W)return!0;return!1}getId(h,U){let W=h.id;if(this.promoteId){const K=typeof this.promoteId=="string"?this.promoteId:this.promoteId[U];K!=null&&(W=h.properties[K]),typeof W=="boolean"&&(W=Number(W))}return W}}function d_(R,h,U,W,K){return Er(R,(Q,oe)=>{const ce=h instanceof it?h.get(oe):null;return ce&&ce.evaluate?ce.evaluate(U,W,K):ce})}function Qy(R,h){return h-R}Vr(h_,"FeatureIndex",{omit:["rawTileData","sourceLayerCoder"]});class f_{constructor(h,U){this.width=h,this.height=U,this.nextRow=0,this.image=new oo({width:h,height:U}),this.positions={},this.uploaded=!1}getDash(h,U){const W=this.getKey(h,U);return this.positions[W]}trim(){const h=this.width,U=this.height=sr(this.nextRow);this.image.resize({width:h,height:U})}getKey(h,U){return h.join(",")+U}getDashRanges(h,U,W){const K=[];let Q=h.length%2==1?-h[h.length-1]*W:0,oe=h[0]*W,ce=!0;K.push({left:Q,right:oe,isDash:ce,zeroLength:h[0]===0});let fe=h[0];for(let pe=1;pe<h.length;pe++){ce=!ce;const ve=h[pe];Q=fe*W,fe+=ve,oe=fe*W,K.push({left:Q,right:oe,isDash:ce,zeroLength:ve===0})}return K}addRoundDash(h,U,W){const K=U/2;for(let Q=-W;Q<=W;Q++){const oe=this.width*(this.nextRow+W+Q);let ce=0,fe=h[ce];for(let pe=0;pe<this.width;pe++){pe/fe.right>1&&(fe=h[++ce]);const ve=Math.abs(pe-fe.left),Ee=Math.abs(pe-fe.right),we=Math.min(ve,Ee);let Ae;const Pe=Q/W*(K+1);if(fe.isDash){const ze=K-Math.abs(Pe);Ae=Math.sqrt(we*we+ze*ze)}else Ae=K-Math.sqrt(we*we+Pe*Pe);this.image.data[oe+pe]=Math.max(0,Math.min(255,Ae+128))}}}addRegularDash(h,U){for(let fe=h.length-1;fe>=0;--fe){const pe=h[fe],ve=h[fe+1];pe.zeroLength?h.splice(fe,1):ve&&ve.isDash===pe.isDash&&(ve.left=pe.left,h.splice(fe,1))}const W=h[0],K=h[h.length-1];W.isDash===K.isDash&&(W.left=K.left-this.width,K.right=W.right+this.width);const Q=this.width*this.nextRow;let oe=0,ce=h[oe];for(let fe=0;fe<this.width;fe++){fe/ce.right>1&&(ce=h[++oe]);const pe=Math.abs(fe-ce.left),ve=Math.abs(fe-ce.right),Ee=Math.min(pe,ve);this.image.data[Q+fe]=Math.max(0,Math.min(255,(ce.isDash?Ee:-Ee)+U+128))}}addDash(h,U){const W=this.getKey(h,U);if(this.positions[W])return this.positions[W];const K=U==="round",Q=K?7:0,oe=2*Q+1;if(this.nextRow+oe>this.height)return Hr("LineAtlas out of space"),null;h.length===0&&h.push(1);let ce=0;for(let ve=0;ve<h.length;ve++)h[ve]<0&&(Hr("Negative value is found in line dasharray, replacing values with 0"),h[ve]=0),ce+=h[ve];if(ce!==0){const ve=this.width/ce,Ee=this.getDashRanges(h,this.width,ve);K?this.addRoundDash(Ee,ve,Q):this.addRegularDash(Ee,U==="square"?.5*ve:0)}const fe=this.nextRow+Q;this.nextRow+=oe;const pe={tl:[fe,Q],br:[ce,0]};return this.positions[W]=pe,pe}}Vr(f_,"LineAtlas");const p_=1*Ca;class __{constructor(h){const U={},W=[];for(const ce in h){const fe=h[ce],pe=U[ce]={};for(const ve in fe.glyphs){const Ee=fe.glyphs[+ve];if(!Ee||Ee.bitmap.width===0||Ee.bitmap.height===0)continue;const we=Ee.metrics.localGlyph?p_:1,Ae={x:0,y:0,w:Ee.bitmap.width+2*we,h:Ee.bitmap.height+2*we};W.push(Ae),pe[ve]=Ae}}const{w:K,h:Q}=wd(W),oe=new oo({width:K||1,height:Q||1});for(const ce in h){const fe=h[ce];for(const pe in fe.glyphs){const ve=fe.glyphs[+pe];if(!ve||ve.bitmap.width===0||ve.bitmap.height===0)continue;const Ee=U[ce][pe],we=ve.metrics.localGlyph?p_:1;oo.copy(ve.bitmap,oe,{x:0,y:0},{x:Ee.x+we,y:Ee.y+we},ve.bitmap)}}this.image=oe,this.positions=U}}Vr(__,"GlyphAtlas");class eg{constructor(h){this.tileID=new kn(h.tileID.overscaledZ,h.tileID.wrap,h.tileID.canonical.z,h.tileID.canonical.x,h.tileID.canonical.y),this.tileZoom=h.tileZoom,this.uid=h.uid,this.zoom=h.zoom,this.canonical=h.tileID.canonical,this.pixelRatio=h.pixelRatio,this.tileSize=h.tileSize,this.source=h.source,this.overscaling=this.tileID.overscaleFactor(),this.showCollisionBoxes=h.showCollisionBoxes,this.collectResourceTiming=!!h.collectResourceTiming,this.returnDependencies=!!h.returnDependencies,this.promoteId=h.promoteId,this.enableTerrain=!!h.enableTerrain,this.isSymbolTile=h.isSymbolTile,this.tileTransform=xs(h.tileID.canonical,h.projection),this.projection=h.projection}parse(h,U,W,K,Q){this.status="parsing",this.data=h,this.collisionBoxArray=new ki;const oe=new Xp(Object.keys(h.layers).sort()),ce=new h_(this.tileID,this.promoteId);ce.bucketLayerIDs=[];const fe={},pe=new f_(256,256),ve={featureIndex:ce,iconDependencies:{},patternDependencies:{},glyphDependencies:{},lineAtlas:pe,availableImages:W},Ee=U.familiesBySource[this.source];for(const Et in Ee){const bt=h.layers[Et];if(!bt)continue;let $t=!1,zt=!1;for(const Zt of Ee[Et])Zt[0].type==="symbol"?$t=!0:zt=!0;if(this.isSymbolTile===!0&&!$t||this.isSymbolTile===!1&&!zt)continue;bt.version===1&&Hr(`Vector tile source "${this.source}" layer "${Et}" does not use vector tile spec v2 and therefore may have some rendering errors.`);const rr=oe.encode(Et),yr=[];for(let Zt=0;Zt<bt.length;Zt++){const ar=bt.feature(Zt),or=ce.getId(ar,Et);yr.push({feature:ar,id:or,index:Zt,sourceLayerIndex:rr})}for(const Zt of Ee[Et]){const ar=Zt[0];this.isSymbolTile!==void 0&&ar.type==="symbol"!==this.isSymbolTile||ar.minzoom&&this.zoom<Math.floor(ar.minzoom)||ar.maxzoom&&this.zoom>=ar.maxzoom||ar.visibility!=="none"&&(Nd(Zt,this.zoom,W),(fe[ar.id]=ar.createBucket({index:ce.bucketLayerIDs.length,layers:Zt,zoom:this.zoom,canonical:this.canonical,pixelRatio:this.pixelRatio,overscaling:this.overscaling,collisionBoxArray:this.collisionBoxArray,sourceLayerIndex:rr,sourceID:this.source,enableTerrain:this.enableTerrain,projection:this.projection.spec,availableImages:W})).populate(yr,ve,this.tileID.canonical,this.tileTransform),ce.bucketLayerIDs.push(Zt.map(or=>or.id)))}}let we,Ae,Pe,ze;pe.trim();const Xe={type:"maybePrepare",isSymbolTile:this.isSymbolTile,zoom:this.zoom},at=()=>{if(we)return Q(we);if(Ae&&Pe&&ze){const Et=new __(Ae),bt=new Ep(Pe,ze);for(const $t in fe){const zt=fe[$t];zt instanceof Do?(Nd(zt.layers,this.zoom,W),qy(zt,Ae,Et.positions,Pe,bt.iconPositions,this.showCollisionBoxes,W,this.tileID.canonical,this.tileZoom,this.projection)):zt.hasPattern&&(zt instanceof eh||zt instanceof Kc||zt instanceof Cl)&&(Nd(zt.layers,this.zoom,W),zt.addFeatures(ve,this.tileID.canonical,bt.patternPositions,W,this.tileTransform))}this.status="done",Q(null,{buckets:er(fe).filter($t=>!$t.isEmpty()),featureIndex:ce,collisionBoxArray:this.collisionBoxArray,glyphAtlasImage:Et.image,lineAtlas:pe,imageAtlas:bt,glyphMap:this.returnDependencies?Ae:null,iconMap:this.returnDependencies?Pe:null,glyphPositions:this.returnDependencies?Et.positions:null})}},mt=Er(ve.glyphDependencies,Et=>Object.keys(Et).map(Number));Object.keys(mt).length?K.send("getGlyphs",{uid:this.uid,stacks:mt},(Et,bt)=>{we||(we=Et,Ae=bt,at())},void 0,!1,Xe):Ae={};const ot=Object.keys(ve.iconDependencies);ot.length?K.send("getImages",{icons:ot,source:this.source,tileID:this.tileID,type:"icons"},(Et,bt)=>{we||(we=Et,Pe=bt,at())},void 0,!1,Xe):Pe={};const pt=Object.keys(ve.patternDependencies);pt.length?K.send("getImages",{icons:pt,source:this.source,tileID:this.tileID,type:"patterns"},(Et,bt)=>{we||(we=Et,ze=bt,at())},void 0,!1,Xe):ze={},at()}}function Nd(R,h,U){const W=new be(h);for(const K of R)K.recalculate(W,U)}class m_{constructor(h){this.entries={},this.scheduler=h}request(h,U,W,K){const Q=this.entries[h]=this.entries[h]||{callbacks:[]};if(Q.result){const[oe,ce]=Q.result;return this.scheduler?this.scheduler.add(()=>{K(oe,ce)},U):K(oe,ce),()=>{}}return Q.callbacks.push(K),Q.cancel||(Q.cancel=W((oe,ce)=>{Q.result=[oe,ce];for(const fe of Q.callbacks)this.scheduler?this.scheduler.add(()=>{fe(oe,ce)},U):fe(oe,ce);setTimeout(()=>delete this.entries[h],3e3)})),()=>{Q.result||(Q.callbacks=Q.callbacks.filter(oe=>oe!==K),Q.callbacks.length||(Q.cancel(),delete this.entries[h]))}}}function y_(R,h,U){const W=JSON.stringify(R.request);return R.data&&(this.deduped.entries[W]={result:[null,R.data]}),this.deduped.request(W,{type:"parseTile",isSymbolTile:R.isSymbolTile,zoom:R.tileZoom},K=>{const Q=Nt(R.request,(oe,ce,fe,pe)=>{oe?K(oe):ce&&K(null,{vectorTile:U?void 0:new vd(new ih(ce)),rawData:ce,cacheControl:fe,expires:pe})});return()=>{Q.cancel(),K()}},h)}const g_=[Int8Array,Uint8Array,Uint8ClampedArray,Int16Array,Uint16Array,Int32Array,Uint32Array,Float32Array,Float64Array];class jd{static from(h){if(!(h instanceof ArrayBuffer))throw new Error("Data must be an instance of ArrayBuffer.");const[U,W]=new Uint8Array(h,0,2);if(U!==219)throw new Error("Data does not appear to be in a KDBush format.");const K=W>>4;if(K!==1)throw new Error(`Got v${K} data when expected v1.`);const Q=g_[15&W];if(!Q)throw new Error("Unrecognized array type.");const[oe]=new Uint16Array(h,2,1),[ce]=new Uint32Array(h,4,1);return new jd(ce,oe,Q,h)}constructor(h,U=64,W=Float64Array,K){if(isNaN(h)||h<0)throw new Error(`Unpexpected numItems value: ${h}.`);this.numItems=+h,this.nodeSize=Math.min(Math.max(+U,2),65535),this.ArrayType=W,this.IndexArrayType=h<65536?Uint16Array:Uint32Array;const Q=g_.indexOf(this.ArrayType),oe=2*h*this.ArrayType.BYTES_PER_ELEMENT,ce=h*this.IndexArrayType.BYTES_PER_ELEMENT,fe=(8-ce%8)%8;if(Q<0)throw new Error(`Unexpected typed array class: ${W}.`);K&&K instanceof ArrayBuffer?(this.data=K,this.ids=new this.IndexArrayType(this.data,8,h),this.coords=new this.ArrayType(this.data,8+ce+fe,2*h),this._pos=2*h,this._finished=!0):(this.data=new ArrayBuffer(8+oe+ce+fe),this.ids=new this.IndexArrayType(this.data,8,h),this.coords=new this.ArrayType(this.data,8+ce+fe,2*h),this._pos=0,this._finished=!1,new Uint8Array(this.data,0,2).set([219,16+Q]),new Uint16Array(this.data,2,1)[0]=U,new Uint32Array(this.data,4,1)[0]=h)}add(h,U){const W=this._pos>>1;return this.ids[W]=W,this.coords[this._pos++]=h,this.coords[this._pos++]=U,W}finish(){const h=this._pos>>1;if(h!==this.numItems)throw new Error(`Added ${h} items when expected ${this.numItems}.`);return Ud(this.ids,this.coords,this.nodeSize,0,this.numItems-1,0),this._finished=!0,this}range(h,U,W,K){if(!this._finished)throw new Error("Data not yet indexed - call index.finish().");const{ids:Q,coords:oe,nodeSize:ce}=this,fe=[0,Q.length-1,0],pe=[];for(;fe.length;){const ve=fe.pop()||0,Ee=fe.pop()||0,we=fe.pop()||0;if(Ee-we<=ce){for(let Xe=we;Xe<=Ee;Xe++){const at=oe[2*Xe],mt=oe[2*Xe+1];at>=h&&at<=W&&mt>=U&&mt<=K&&pe.push(Q[Xe])}continue}const Ae=we+Ee>>1,Pe=oe[2*Ae],ze=oe[2*Ae+1];Pe>=h&&Pe<=W&&ze>=U&&ze<=K&&pe.push(Q[Ae]),(ve===0?h<=Pe:U<=ze)&&(fe.push(we),fe.push(Ae-1),fe.push(1-ve)),(ve===0?W>=Pe:K>=ze)&&(fe.push(Ae+1),fe.push(Ee),fe.push(1-ve))}return pe}within(h,U,W){if(!this._finished)throw new Error("Data not yet indexed - call index.finish().");const{ids:K,coords:Q,nodeSize:oe}=this,ce=[0,K.length-1,0],fe=[],pe=W*W;for(;ce.length;){const ve=ce.pop()||0,Ee=ce.pop()||0,we=ce.pop()||0;if(Ee-we<=oe){for(let Xe=we;Xe<=Ee;Xe++)b_(Q[2*Xe],Q[2*Xe+1],h,U)<=pe&&fe.push(K[Xe]);continue}const Ae=we+Ee>>1,Pe=Q[2*Ae],ze=Q[2*Ae+1];b_(Pe,ze,h,U)<=pe&&fe.push(K[Ae]),(ve===0?h-W<=Pe:U-W<=ze)&&(ce.push(we),ce.push(Ae-1),ce.push(1-ve)),(ve===0?h+W>=Pe:U+W>=ze)&&(ce.push(Ae+1),ce.push(Ee),ce.push(1-ve))}return fe}}function Ud(R,h,U,W,K,Q){if(K-W<=U)return;const oe=W+K>>1;v_(R,h,oe,W,K,Q),Ud(R,h,U,W,oe-1,1-Q),Ud(R,h,U,oe+1,K,1-Q)}function v_(R,h,U,W,K,Q){for(;K>W;){if(K-W>600){const pe=K-W+1,ve=U-W+1,Ee=Math.log(pe),we=.5*Math.exp(2*Ee/3),Ae=.5*Math.sqrt(Ee*we*(pe-we)/pe)*(ve-pe/2<0?-1:1);v_(R,h,U,Math.max(W,Math.floor(U-ve*we/pe+Ae)),Math.min(K,Math.floor(U+(pe-ve)*we/pe+Ae)),Q)}const oe=h[2*U+Q];let ce=W,fe=K;for(Gl(R,h,W,U),h[2*K+Q]>oe&&Gl(R,h,W,K);ce<fe;){for(Gl(R,h,ce,fe),ce++,fe--;h[2*ce+Q]<oe;)ce++;for(;h[2*fe+Q]>oe;)fe--}h[2*W+Q]===oe?Gl(R,h,W,fe):(fe++,Gl(R,h,fe,K)),fe<=U&&(W=fe+1),U<=fe&&(K=fe-1)}}function Gl(R,h,U,W){Vd(R,U,W),Vd(h,2*U,2*W),Vd(h,2*U+1,2*W+1)}function Vd(R,h,U){const W=R[h];R[h]=R[U],R[U]=W}function b_(R,h,U,W){const K=R-U,Q=h-W;return K*K+Q*Q}t.ARRAY_TYPE=Xn,t.AUTH_ERR_MSG=dt,t.Aabb=Fn,t.Actor=class{constructor(R,h,U){this.target=R,this.parent=h,this.mapId=U,this.callbacks={},this.cancelCallbacks={},Ur(["receive"],this),this.target.addEventListener("message",this.receive,!1),this.globalScope=si()?R:H,this.scheduler=new Hy}send(R,h,U,W,K=!1,Q){const oe=Math.round(1e18*Math.random()).toString(36).substring(0,10);U&&(U.metadata=Q,this.callbacks[oe]=U);const ce=vr(this.globalScope)?void 0:[];return this.target.postMessage({id:oe,type:R,hasCallback:!!U,targetMapId:W,mustQueue:K,sourceMapId:this.mapId,data:qo(h,ce)},ce),{cancel:()=>{U&&delete this.callbacks[oe],this.target.postMessage({id:oe,type:"<cancel>",targetMapId:W,sourceMapId:this.mapId})}}}receive(R){const h=R.data,U=h.id;if(U&&(!h.targetMapId||this.mapId===h.targetMapId))if(h.type==="<cancel>"){const W=this.cancelCallbacks[U];delete this.cancelCallbacks[U],W&&W.cancel()}else if(h.mustQueue||si()){const W=this.callbacks[U];this.cancelCallbacks[U]=this.scheduler.add(()=>this.processTask(U,h),W&&W.metadata||{type:"message"})}else this.processTask(U,h)}processTask(R,h){if(h.type==="<response>"){const U=this.callbacks[R];delete this.callbacks[R],U&&(h.error?U(Qa(h.error)):U(null,Qa(h.data)))}else{const U=vr(this.globalScope)?void 0:[],W=h.hasCallback?(Q,oe)=>{delete this.cancelCallbacks[R],this.target.postMessage({id:R,type:"<response>",sourceMapId:this.mapId,error:Q?qo(Q):null,data:qo(oe,U)},U)}:Q=>{},K=Qa(h.data);if(this.parent[h.type])this.parent[h.type](h.sourceMapId,K,W);else if(this.parent.getWorkerSource){const Q=h.type.split(".");this.parent.getWorkerSource(h.sourceMapId,Q[0],K.source)[Q[1]](K,W)}else W(new Error(`Could not find function ${h.type}`))}}remove(){this.scheduler.remove(),this.target.removeEventListener("message",this.receive,!1)}},t.CanonicalTileID=Qc,t.Color=sn,t.ColorMode=Ga,t.CullFaceMode=Pa,t.DEMData=mh,t.DataConstantProperty=Be,t.DedupedRequest=m_,t.DepthMode=vu,t.EXTENT=ri,t.Elevation=class{isDataAvailableAtPoint(R){const h=this._source();if(this.isUsingMockSource()||!h||R.y<0||R.y>1)return!1;const U=h.getSource().maxzoom,W=1<<U,K=Math.floor(R.x),Q=Math.floor((R.x-K)*W),oe=Math.floor(R.y*W),ce=this.findDEMTileFor(new kn(U,K,U,Q,oe));return!(!ce||!ce.dem)}getAtPointOrZero(R,h=0){return this.getAtPoint(R,h)||0}getAtPoint(R,h,U=!0){if(this.isUsingMockSource())return null;h==null&&(h=null);const W=this._source();if(!W||R.y<0||R.y>1)return h;const K=W.getSource().maxzoom,Q=1<<K,oe=Math.floor(R.x),ce=R.x-oe,fe=new kn(K,oe,K,Math.floor(ce*Q),Math.floor(R.y*Q)),pe=this.findDEMTileFor(fe);if(!pe||!pe.dem)return h;const ve=pe.dem,Ee=1<<pe.tileID.canonical.z,we=(ce*Ee-pe.tileID.canonical.x)*ve.dim,Ae=(R.y*Ee-pe.tileID.canonical.y)*ve.dim,Pe=Math.floor(we),ze=Math.floor(Ae);return(U?this.exaggeration():1)*Ti(Ti(ve.get(Pe,ze),ve.get(Pe,ze+1),Ae-ze),Ti(ve.get(Pe+1,ze),ve.get(Pe+1,ze+1),Ae-ze),we-Pe)}getAtTileOffset(R,h,U){const W=1<<R.canonical.z;return this.getAtPointOrZero(new au(R.wrap+(R.canonical.x+h/ri)/W,(R.canonical.y+U/ri)/W))}getAtTileOffsetFunc(R,h,U,W){return K=>{const Q=this.getAtTileOffset(R,K.x,K.y),oe=W.upVector(R.canonical,K.x,K.y);return na(oe,oe,Q*W.upVectorScale(R.canonical,h,U).metersToTile),oe}}getForTilePoints(R,h,U,W){if(this.isUsingMockSource())return!1;const K=yh.create(this,R,W);return!!K&&(h.forEach(Q=>{Q[2]=this.exaggeration()*K.getElevationAt(Q[0],Q[1],U)}),!0)}getMinMaxForTile(R){if(this.isUsingMockSource())return null;const h=this.findDEMTileFor(R);if(!h||!h.dem)return null;const U=h.dem.tree,W=h.tileID,K=1<<R.canonical.z-W.canonical.z;let Q=R.canonical.x/K-W.canonical.x,oe=R.canonical.y/K-W.canonical.y,ce=0;for(let fe=0;fe<R.canonical.z-W.canonical.z&&!U.leaves[ce];fe++){Q*=2,oe*=2;const pe=2*Math.floor(oe)+Math.floor(Q);ce=U.childOffsets[ce]+pe,Q%=1,oe%=1}return{min:this.exaggeration()*U.minimums[ce],max:this.exaggeration()*U.maximums[ce]}}getMinElevationBelowMSL(){throw new Error("Pure virtual method called.")}raycast(R,h,U){throw new Error("Pure virtual method called.")}pointCoordinate(R){throw new Error("Pure virtual method called.")}_source(){throw new Error("Pure virtual method called.")}isUsingMockSource(){throw new Error("Pure virtual method called.")}exaggeration(){throw new Error("Pure virtual method called.")}findDEMTileFor(R){throw new Error("Pure virtual method called.")}get visibleDemTiles(){throw new Error("Getter must be implemented in subclass.")}},t.ErrorEvent=Gn,t.EvaluationParameters=be,t.Event=ea,t.Evented=Da,t.FillExtrusionBucket=Cl,t.Frustum=Xh,t.FrustumCorners=Kh,t.GLOBE_RADIUS=Ba,t.GLOBE_SCALE_MATCH_LATITUDE=45,t.GLOBE_ZOOM_THRESHOLD_MAX=vf,t.GLOBE_ZOOM_THRESHOLD_MIN=Yh,t.GlobeSharedBuffers=class{constructor(R){this._createGrid(R),this._createPoles(R)}destroy(){this._poleIndexBuffer.destroy(),this._gridBuffer.destroy(),this._gridIndexBuffer.destroy(),this._poleNorthVertexBuffer.destroy(),this._poleSouthVertexBuffer.destroy();for(const R of this._poleSegments)R.destroy();for(const R of this._gridSegments)R.withSkirts.destroy(),R.withoutSkirts.destroy();if(this._wireframeIndexBuffer){this._wireframeIndexBuffer.destroy();for(const R of this._wireframeSegments)R.destroy()}}_fillGridMeshWithLods(R,h){const U=new mr,W=new Zr,K=[],Q=R+1+2,oe=h[0]+1,ce=h[0]+1+(1+h.length),fe=(pe,ve,Ee)=>{let we=pe===Q-1?pe-2:pe===0?pe:pe-1;return we+=Ee?24575:0,[we,ve]};for(let pe=0;pe<Q;++pe)U.emplaceBack(...fe(pe,0,!0));for(let pe=0;pe<oe;++pe)for(let ve=0;ve<Q;++ve)U.emplaceBack(...fe(ve,pe,(ve===0||ve===Q-1)&&!0));for(let pe=0;pe<h.length;++pe){const ve=h[pe];for(let Ee=0;Ee<Q;++Ee)U.emplaceBack(...fe(Ee,ve,!0))}for(let pe=0;pe<h.length;++pe){const ve=W.length,Ee=h[pe]+1+2,we=new Zr;for(let ze=0;ze<Ee-1;ze++){const Xe=ze===Ee-2,at=Xe?Q*(ce-h.length+pe-ze):Q;for(let mt=0;mt<Q-1;mt++){const ot=ze*Q+mt;ze===0||Xe||mt===0||mt===Q-2?(we.emplaceBack(ot+1,ot,ot+at),we.emplaceBack(ot+at,ot+at+1,ot+1)):(W.emplaceBack(ot+1,ot,ot+at),W.emplaceBack(ot+at,ot+at+1,ot+1))}}const Ae=hn.simpleSegment(0,ve,U.length,W.length-ve);for(let ze=0;ze<we.uint16.length;ze+=3)W.emplaceBack(we.uint16[ze],we.uint16[ze+1],we.uint16[ze+2]);const Pe=hn.simpleSegment(0,ve,U.length,W.length-ve);K.push({withoutSkirts:Ae,withSkirts:Pe})}return{vertices:U,indices:W,segments:K}}_createGrid(R){const h=this._fillGridMeshWithLods(_s,xl);this._gridSegments=h.segments,this._gridBuffer=R.createVertexBuffer(h.vertices,bl.members),this._gridIndexBuffer=R.createIndexBuffer(h.indices,!0)}_createPoles(R){const h=new Zr;for(let K=0;K<=_s;K++)h.emplaceBack(0,K+1,K+2);this._poleIndexBuffer=R.createIndexBuffer(h,!0);const U=new Fi,W=new Fi;this._poleSegments=[];for(let K=0,Q=0;K<Yh;K++){const oe=360/(1<<K);U.emplaceBack(0,-Ba,0,.5,0),W.emplaceBack(0,-Ba,0,.5,1);for(let ce=0;ce<=_s;ce++){const fe=ce/_s,pe=Ti(0,oe,fe),[ve,Ee,we]=ru(H_,Z_,pe,Ba);U.emplaceBack(ve,Ee,we,fe,0),W.emplaceBack(ve,Ee,we,fe,1)}this._poleSegments.push(hn.simpleSegment(Q,0,66,64)),Q+=66}this._poleNorthVertexBuffer=R.createVertexBuffer(U,yf,!1),this._poleSouthVertexBuffer=R.createVertexBuffer(W,yf,!1)}getGridBuffers(R,h){return[this._gridBuffer,this._gridIndexBuffer,h?this._gridSegments[R].withSkirts:this._gridSegments[R].withoutSkirts]}getPoleBuffers(R){return[this._poleNorthVertexBuffer,this._poleSouthVertexBuffer,this._poleIndexBuffer,this._poleSegments[R]]}getWirefameBuffers(R,h){if(!this._wireframeSegments){const U=new bn,W=_s,K=W+1+2,Q=1;this._wireframeSegments=[];for(let oe=0,ce=0;oe<xl.length;oe++){const fe=xl[oe];for(let ve=Q;ve<fe+Q;ve++)for(let Ee=Q;Ee<W+Q;Ee++){const we=ve*K+Ee;U.emplaceBack(we,we+1),U.emplaceBack(we,we+K),U.emplaceBack(we,we+K+1)}const pe=fe*W*3;this._wireframeSegments.push(hn.simpleSegment(0,ce,(fe+1)*K,pe)),ce+=pe}this._wireframeIndexBuffer=R.createIndexBuffer(U)}return[this._gridBuffer,this._wireframeIndexBuffer,this._wireframeSegments[h]]}},t.GlyphManager=pu,t.ImagePosition=Sd,t.KDBush=jd,t.LivePerformanceUtils=Ut,t.LngLat=Bi,t.LngLatBounds=Oo,t.LocalGlyphMode=Id,t.MAX_MERCATOR_LATITUDE=On,t.MercatorCoordinate=au,t.ONE_EM=Sn,t.OverscaledTileID=kn,t.PerformanceMarkers=Xt,t.Point=He,t.Properties=ct,t.RGBAImage=Yn,t.Ray=Zh,t.RequestManager=class{constructor(R,h,U){this._transformRequestFn=R,this._customAccessToken=h,this._silenceAuthErrors=!!U,this._createSkuToken()}_createSkuToken(){const R=function(){let h="";for(let U=0;U<10;U++)h+="0123456789abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ"[Math.floor(62*Math.random())];return{token:["1",Ue,h].join(""),tokenExpiresAt:Date.now()+432e5}}();this._skuToken=R.token,this._skuTokenExpiresAt=R.tokenExpiresAt}_isSkuTokenExpired(){return Date.now()>this._skuTokenExpiresAt}transformRequest(R,h){return this._transformRequestFn&&this._transformRequestFn(R,h)||{url:R}}normalizeStyleURL(R,h){if(!vt(R))return R;const U=Ar(R);return U.path=`/styles/v1${U.path}`,this._makeAPIURL(U,this._customAccessToken||h)}normalizeGlyphsURL(R,h){if(!vt(R))return R;const U=Ar(R);return U.path=`/fonts/v1${U.path}`,this._makeAPIURL(U,this._customAccessToken||h)}normalizeSourceURL(R,h,U,W){if(!vt(R))return R;const K=Ar(R);return K.path=`/v4/${K.authority}.json`,K.params.push("secure"),U&&K.params.push(`language=${U}`),W&&K.params.push(`worldview=${W}`),this._makeAPIURL(K,this._customAccessToken||h)}normalizeSpriteURL(R,h,U,W){const K=Ar(R);return vt(R)?(K.path=`/styles/v1${K.path}/sprite${h}${U}`,this._makeAPIURL(K,this._customAccessToken||W)):(K.path+=`${h}${U}`,cr(K))}normalizeTileURL(R,h,U){if(this._isSkuTokenExpired()&&this._createSkuToken(),R&&!vt(R))return R;const W=Ar(R);W.path=W.path.replace(/(\.(png|jpg)\d*)(?=$)/,`${h||U&&W.authority!=="raster"&&U===512?"@2x":""}${ge.supported?".webp":"$1"}`),W.authority==="raster"?W.path=`/${_e.RASTER_URL_PREFIX}${W.path}`:(W.path=W.path.replace(/^.+\/v4\//,"/"),W.path=`/${_e.TILE_URL_VERSION}${W.path}`);const K=this._customAccessToken||function(Q){for(const oe of Q){const ce=oe.match(/^access_token=(.*)$/);if(ce)return ce[1]}return null}(W.params)||_e.ACCESS_TOKEN;return _e.REQUIRE_ACCESS_TOKEN&&K&&this._skuToken&&W.params.push(`sku=${this._skuToken}`),this._makeAPIURL(W,K)}canonicalizeTileURL(R,h){const U=Ar(R);if(!U.path.match(/^(\/v4\/|\/raster\/v1\/)/)||!U.path.match(/\.[\w]+$/))return R;let W="mapbox://";U.path.match(/^\/raster\/v1\//)?W+=`raster/${U.path.replace(`/${_e.RASTER_URL_PREFIX}/`,"")}`:W+=`tiles/${U.path.replace(`/${_e.TILE_URL_VERSION}/`,"")}`;let K=U.params;return h&&(K=K.filter(Q=>!Q.match(/^access_token=/))),K.length&&(W+=`?${K.join("&")}`),W}canonicalizeTileset(R,h){const U=!!h&&vt(h),W=[];for(const K of R.tiles||[])Mt(K)?W.push(this.canonicalizeTileURL(K,U)):W.push(K);return W}_makeAPIURL(R,h){const U="See https://docs.mapbox.com/api/overview/#access-tokens-and-token-scopes",W=Ar(_e.API_URL);if(R.protocol=W.protocol,R.authority=W.authority,R.protocol==="http"){const K=R.params.indexOf("secure");K>=0&&R.params.splice(K,1)}if(W.path!=="/"&&(R.path=`${W.path}${R.path}`),!_e.REQUIRE_ACCESS_TOKEN)return cr(R);if(h=h||_e.ACCESS_TOKEN,!this._silenceAuthErrors){if(!h)throw new Error(`An API access token is required to use Mapbox GL. ${U}`);if(h[0]==="s")throw new Error(`Use a public access token (pk.*) with Mapbox GL, not a secret access token (sk.*). ${U}`)}return R.params=R.params.filter(K=>K.indexOf("access_token")===-1),R.params.push(`access_token=${h||""}`),cr(R)}},t.ResourceType=tr,t.SegmentVector=hn,t.SourceCache=Es,t.StencilMode=kd,t.StructArrayLayout1ui2=Kn,t.StructArrayLayout2f1f2i16=ii,t.StructArrayLayout2i4=mr,t.StructArrayLayout2ui4=bn,t.StructArrayLayout3f12=gi,t.StructArrayLayout3ui6=Zr,t.StructArrayLayout4i8=nr,t.StructArrayLayout5f20=Fi,t.Texture=Ul,t.Tile=Ld,t.Transitionable=Fe,t.Uniform1f=Fc,t.Uniform1i=class extends ro{constructor(R){super(R),this.current=0}set(R,h,U){this.fetchUniformLocation(R,h)&&this.current!==U&&(this.current=U,this.gl.uniform1i(this.location,U))}},t.Uniform2f=class extends ro{constructor(R){super(R),this.current=[0,0]}set(R,h,U){this.fetchUniformLocation(R,h)&&(U[0]===this.current[0]&&U[1]===this.current[1]||(this.current=U,this.gl.uniform2f(this.location,U[0],U[1])))}},t.Uniform3f=class extends ro{constructor(R){super(R),this.current=[0,0,0]}set(R,h,U){this.fetchUniformLocation(R,h)&&(U[0]===this.current[0]&&U[1]===this.current[1]&&U[2]===this.current[2]||(this.current=U,this.gl.uniform3f(this.location,U[0],U[1],U[2])))}},t.Uniform4f=Qd,t.UniformColor=ef,t.UniformMatrix2f=class extends ro{constructor(R){super(R),this.current=C_}set(R,h,U){if(this.fetchUniformLocation(R,h)){for(let W=0;W<4;W++)if(U[W]!==this.current[W]){this.current=U,this.gl.uniformMatrix2fv(this.location,!1,U);break}}}},t.UniformMatrix3f=class extends ro{constructor(R){super(R),this.current=O_}set(R,h,U){if(this.fetchUniformLocation(R,h)){for(let W=0;W<9;W++)if(U[W]!==this.current[W]){this.current=U,this.gl.uniformMatrix3fv(this.location,!1,U);break}}}},t.UniformMatrix4f=class extends ro{constructor(R){super(R),this.current=R_}set(R,h,U){if(this.fetchUniformLocation(R,h)){if(U[12]!==this.current[12]||U[0]!==this.current[0])return this.current=U,void this.gl.uniformMatrix4fv(this.location,!1,U);for(let W=1;W<16;W++)if(U[W]!==this.current[W]){this.current=U,this.gl.uniformMatrix4fv(this.location,!1,U);break}}}},t.UnwrappedTileID=sp,t.ValidationError=kr,t.VectorTileFeature=Yc,t.VectorTileWorkerSource=class extends Da{constructor(R,h,U,W,K){super(),this.actor=R,this.layerIndex=h,this.availableImages=U,this.loadVectorData=K||y_,this.loading={},this.loaded={},this.deduped=new m_(R.scheduler),this.isSpriteLoaded=W,this.scheduler=R.scheduler}loadTile(R,h){const U=R.uid,W=R&&R.request,K=W&&W.collectResourceTiming,Q=this.loading[U]=new eg(R);Q.abort=this.loadVectorData(R,(oe,ce)=>{const fe=!this.loading[U];if(delete this.loading[U],fe||oe||!ce)return Q.status="done",fe||(this.loaded[U]=Q),h(oe);const pe=ce.rawData,ve={};ce.expires&&(ve.expires=ce.expires),ce.cacheControl&&(ve.cacheControl=ce.cacheControl),Q.vectorTile=ce.vectorTile||new vd(new ih(pe));const Ee=()=>{Q.parse(Q.vectorTile,this.layerIndex,this.availableImages,this.actor,(we,Ae)=>{if(we||!Ae)return h(we);const Pe={};if(K){const ze=Yr(W);ze.length>0&&(Pe.resourceTiming=JSON.parse(JSON.stringify(ze)))}h(null,lr({rawTileData:pe.slice(0)},Ae,ve,Pe))})};this.isSpriteLoaded?Ee():this.once("isSpriteLoaded",()=>{this.scheduler?this.scheduler.add(Ee,{type:"parseTile",isSymbolTile:R.isSymbolTile,zoom:R.tileZoom}):Ee()}),this.loaded=this.loaded||{},this.loaded[U]=Q})}reloadTile(R,h){const U=this.loaded,W=R.uid,K=this;if(U&&U[W]){const Q=U[W];Q.showCollisionBoxes=R.showCollisionBoxes,Q.enableTerrain=!!R.enableTerrain,Q.projection=R.projection,Q.tileTransform=xs(R.tileID.canonical,R.projection);const oe=(ce,fe)=>{const pe=Q.reloadCallback;pe&&(delete Q.reloadCallback,Q.parse(Q.vectorTile,K.layerIndex,this.availableImages,K.actor,pe)),h(ce,fe)};Q.status==="parsing"?Q.reloadCallback=oe:Q.status==="done"&&(Q.vectorTile?Q.parse(Q.vectorTile,this.layerIndex,this.availableImages,this.actor,oe):oe())}}abortTile(R,h){const U=R.uid,W=this.loading[U];W&&(W.abort&&W.abort(),delete this.loading[U]),h()}removeTile(R,h){const U=this.loaded,W=R.uid;U&&U[W]&&delete U[W],h()}},t.WritingMode=oa,t.ZoomDependentExpression=rs,t.add=no,t.addDynamicAttributes=fh,t.adjoint=function(R,h){var U=h[0],W=h[1],K=h[2],Q=h[3],oe=h[4],ce=h[5],fe=h[6],pe=h[7],ve=h[8];return R[0]=oe*ve-ce*pe,R[1]=K*pe-W*ve,R[2]=W*ce-K*oe,R[3]=ce*fe-Q*ve,R[4]=U*ve-K*fe,R[5]=K*Q-U*ce,R[6]=Q*pe-oe*fe,R[7]=W*fe-U*pe,R[8]=U*oe-W*Q,R},t.asyncAll=Ft,t.bezier=ft,t.bindAll=Ur,t.boundsAttributes=Qp,t.bufferConvexPolygon=function(R,h){const U=[];for(let W=0;W<R.length;W++){const K=wt(W-1,-1,R.length-1),Q=wt(W+1,-1,R.length-1),oe=R[W],ce=R[Q],fe=R[K].sub(oe).unit(),pe=ce.sub(oe).unit(),ve=pe.angleWithSep(fe.x,fe.y),Ee=fe.add(pe).unit().mult(-1*h/Math.sin(ve/2));U.push(oe.add(Ee))}return U},t.cacheEntryPossiblyAdded=function(R){Ot++,Ot>je&&(R.getActor().send("enforceCacheSizeLimit",Nr),Ot=0)},t.calculateGlobeLabelMatrix=function(R,h){const{x:U,y:W}=R.point,K=Sf(U,W,R.worldSize/R._pixelsPerMercatorPixel,0,0);return ds(K,K,ed(za(h)))},t.calculateGlobeMatrix=function(R){const{x:h,y:U}=R.point,{lng:W,lat:K}=R._center;return Sf(h,U,R.worldSize,W,K)},t.calculateGlobeMercatorMatrix=function(R){const h=R.pixelsPerMeter,U=h/Ra(1,R.center.lat),W=Ia(new Float64Array(16));return pl(W,W,[R.point.x,R.point.y,0]),fs(W,W,[U,U,h]),Float32Array.from(W)},t.circumferenceAtLatitude=rd,t.clamp=nt,t.clearTileCache=function(R){if(!Ve())return;const h=H.caches.delete(Or);R&&h.catch(R).then(()=>R())},t.clipLine=Lp,t.clone=function(R){var h=new Xn(16);return h[0]=R[0],h[1]=R[1],h[2]=R[2],h[3]=R[3],h[4]=R[4],h[5]=R[5],h[6]=R[6],h[7]=R[7],h[8]=R[8],h[9]=R[9],h[10]=R[10],h[11]=R[11],h[12]=R[12],h[13]=R[13],h[14]=R[14],h[15]=R[15],h},t.clone$1=ui,t.collisionCircleLayout=Jm,t.config=_e,t.conjugate=function(R,h){return R[0]=-h[0],R[1]=-h[1],R[2]=-h[2],R[3]=h[3],R},t.create=function(){var R=new Xn(16);return Xn!=Float32Array&&(R[1]=0,R[2]=0,R[3]=0,R[4]=0,R[6]=0,R[7]=0,R[8]=0,R[9]=0,R[11]=0,R[12]=0,R[13]=0,R[14]=0),R[0]=1,R[5]=1,R[10]=1,R[15]=1,R},t.create$1=nf,t.createExpression=wo,t.createLayout=Dt,t.createStyleLayer=function(R){return R.type==="custom"?new Vy(R):new $y[R.type](R)},t.cross=Hh,t.degToRad=ut,t.distance=function(R,h){return Math.hypot(h[0]-R[0],h[1]-R[1],h[2]-R[2])},t.div=function(R,h,U){return R[0]=h[0]/U[0],R[1]=h[1]/U[1],R[2]=h[2]/U[2],R},t.dot=da,t.earthRadius=Sl,t.ease=qt,t.easeCubicInOut=Kt,t.ecefToLatLng=function([R,h,U]){const W=Math.hypot(R,h,U),K=Math.atan2(R,U),Q=.5*Math.PI-Math.acos(-h/W);return new Bi(yt(K),yt(Q))},t.emitValidationErrors=Oc,t.endsWith=Wr,t.enforceCacheSizeLimit=function(R){st(),Se&&Se.then(h=>{h.keys().then(U=>{for(let W=0;W<U.length-R;W++)h.delete(U[W])})})},t.evaluateSizeForFeature=th,t.evaluateSizeForZoom=cu,t.evaluateVariableOffset=Np,t.evented=le,t.exactEquals=function(R,h){return R[0]===h[0]&&R[1]===h[1]&&R[2]===h[2]&&R[3]===h[3]},t.exactEquals$1=function(R,h){return R[0]===h[0]&&R[1]===h[1]&&R[2]===h[2]},t.exported=qr,t.exported$1=ge,t.extend=lr,t.extend$1=ma,t.fillExtrusionHeightLift=np,t.filterObject=Kr,t.fromMat4=function(R,h){return R[0]=h[0],R[1]=h[1],R[2]=h[2],R[3]=h[4],R[4]=h[5],R[5]=h[6],R[6]=h[8],R[7]=h[9],R[8]=h[10],R},t.fromQuat=function(R,h){var U=h[0],W=h[1],K=h[2],Q=h[3],oe=U+U,ce=W+W,fe=K+K,pe=U*oe,ve=W*oe,Ee=W*ce,we=K*oe,Ae=K*ce,Pe=K*fe,ze=Q*oe,Xe=Q*ce,at=Q*fe;return R[0]=1-Ee-Pe,R[1]=ve+at,R[2]=we-Xe,R[3]=0,R[4]=ve-at,R[5]=1-pe-Pe,R[6]=Ae+ze,R[7]=0,R[8]=we+Xe,R[9]=Ae-ze,R[10]=1-pe-Ee,R[11]=0,R[12]=0,R[13]=0,R[14]=0,R[15]=1,R},t.fromRotation=function(R,h){var U=Math.sin(h),W=Math.cos(h);return R[0]=W,R[1]=U,R[2]=0,R[3]=-U,R[4]=W,R[5]=0,R[6]=0,R[7]=0,R[8]=1,R},t.fromScaling=of,t.furthestTileCorner=function(R){const h=Math.round((R+45+360)%360/90)%4;return Lt[h]},t.getAABBPointSquareDist=function(R,h,U){let W=0;for(let K=0;K<2;++K){const Q=U?U[K]:0;R[K]>Q&&(W+=(R[K]-Q)*(R[K]-Q)),h[K]<Q&&(W+=(Q-h[K])*(Q-h[K]))}return W},t.getAnchorAlignment=qd,t.getAnchorJustification=Rd,t.getBounds=function(R){let h=1/0,U=1/0,W=-1/0,K=-1/0;for(const Q of R)h=Math.min(h,Q.x),U=Math.min(U,Q.y),W=Math.max(W,Q.x),K=Math.max(K,Q.y);return{min:new He(h,U),max:new He(W,K)}},t.getColumn=Ir,t.getDefaultExportFromCjs=Le,t.getGridMatrix=function(R,h,U,W){const K=h.getNorth(),Q=h.getSouth(),oe=h.getWest(),ce=h.getEast(),fe=1<<R.z,pe=ce-oe,ve=K-Q,Ee=pe/_s,we=-ve/xl[U],Ae=[0,Ee,0,we,0,0,K,oe,0];if(R.z>0){const Pe=180/W;af(Ae,Ae,[Pe/pe+1,0,0,0,Pe/ve+1,0,-.5*Pe/Ee,.5*Pe/we,1])}return Ae[2]=fe,Ae[5]=R.x,Ae[8]=R.y,Ae},t.getImage=rt,t.getJSON=function(R,h){return Ct(lr(R,{type:"json"}),h)},t.getLatitudinalLod=function(R){const h=On-5;R=nt(R,-h,h)/h*90;const U=Math.pow(Math.abs(Math.sin(ut(R))),3);return Math.round(U*(xl.length-1))},t.getMapSessionAPI=Gt,t.getPerformanceMeasurement=Yr,t.getProjection=Zp,t.getRTLTextPluginStatus=de,t.getReferrer=xt,t.getTilePoint=function(R,{x:h,y:U},W=0){return new He(((h-W)*R.scale-R.x)*ri,(U*R.scale-R.y)*ri)},t.getTileVec3=function(R,h,U=0){return tu(((h.x-U)*R.scale-R.x)*ri,(h.y*R.scale-R.y)*ri,Af(h.z,h.y))},t.getVideo=function(R,h){const U=H.document.createElement("video");U.muted=!0,U.onloadstart=function(){h(null,U)};for(let W=0;W<R.length;W++){const K=H.document.createElement("source");dr(R[W])||(U.crossOrigin="Anonymous"),K.src=R[W],U.appendChild(K)}return{cancel:()=>{}}},t.globeCenterToScreenPoint=function(R){const h=[0,0,0],U=Ia(new Float64Array(16));return ds(U,R.pixelMatrix,R.globeMatrix),un(h,h,U),new He(h[0],h[1])},t.globeDenormalizeECEF=ed,t.globeECEFOrigin=function(R,h){const U=[0,0,0];return un(U,U,wl(za(h.canonical))),un(U,U,R),U},t.globeMetersToEcef=zc,t.globeNormalizeECEF=wl,t.globePixelsToTileUnits=function(R,h){return ri/(512*Math.pow(2,R))*jc(za(h))},t.globePoleMatrixForTile=function(R,h,U){const W=Ia(new Float64Array(16)),K=(h/(1<<R)-.5)*Math.PI*2;return Bc(W,U.globeMatrix,K),Float32Array.from(W)},t.globeTileBounds=za,t.globeTiltAtLngLat=Tf,t.globeToMercatorTransition=nu,t.globeUseCustomAntiAliasing=function(R,h,U){const W=nu(U.zoom),K=R.style.map._antialias,Q=!!h.extStandardDerivatives,oe=h.extStandardDerivativesForceOff||R.terrain&&R.terrain.exaggeration()>0;return W===0&&!K&&!oe&&Q},t.identity=Ia,t.identity$1=pf,t.invert=Vh,t.isFullscreen=function(){return!!H.document.fullscreenElement||!!H.document.webkitFullscreenElement},t.isLngLatBehindGlobe=td,t.isMapAuthenticated=function(R){return fr.has(R)},t.isMapboxURL=vt,t.isSafariWithAntialiasingBug=function(R){const h=R.navigator?R.navigator.userAgent:null;return!!vr(R)&&h&&(h.match("Version/15.4")||h.match("Version/15.5")||h.match(/CPU (OS|iPhone OS) (15_4|15_5) like Mac OS X/))},t.latFromMercatorY=Rn,t.latLngToECEF=iu,t.len=N_,t.length=_l,t.length$1=function(R){return Math.hypot(R[0],R[1],R[2],R[3])},t.lngFromMercatorX=aa,t.loadVectorTile=y_,t.makeRequest=Ct,t.mapValue=function(R,h,U,W,K){return nt((R-h)/(U-h)*(K-W)+W,W,K)},t.mercatorScale=Rf,t.mercatorXfromLng=Na,t.mercatorYfromLat=ja,t.mercatorZfromAltitude=Ra,t.mul=B_,t.mul$1=z_,t.multiply=ds,t.multiply$1=af,t.multiply$2=lf,t.nextPowerOfTwo=sr,t.normalize=Ln,t.normalize$1=j_,t.normalize$2=df,t.number=Ti,t.ortho=function(R,h,U,W,K,Q,oe){var ce=1/(h-U),fe=1/(W-K),pe=1/(Q-oe);return R[0]=-2*ce,R[1]=0,R[2]=0,R[3]=0,R[4]=0,R[5]=-2*fe,R[6]=0,R[7]=0,R[8]=0,R[9]=0,R[10]=2*pe,R[11]=0,R[12]=(h+U)*ce,R[13]=(K+W)*fe,R[14]=(oe+Q)*pe,R[15]=1,R},t.pbf=pp,t.perspective=function(R,h,U,W,K){var Q,oe=1/Math.tan(h/2);return R[0]=oe/U,R[1]=0,R[2]=0,R[3]=0,R[4]=0,R[5]=oe,R[6]=0,R[7]=0,R[8]=0,R[9]=0,R[11]=-1,R[12]=0,R[13]=0,R[15]=0,K!=null&&K!==1/0?(R[10]=(K+W)*(Q=1/(W-K)),R[14]=2*K*W*Q):(R[10]=-1,R[14]=-2*W),R},t.pick=function(R,h){const U={};for(let W=0;W<h.length;W++){const K=h[W];K in R&&(U[K]=R[K])}return U},t.plugin=ye,t.pointGeometry=We,t.polesInViewport=function(R){const h=Ia(new Float64Array(16));ds(h,R.pixelMatrix,R.globeMatrix);const U=[0,fa,0],W=[0,pa,0];return un(U,U,h),un(W,W,h),[U[0]>0&&U[0]<=R.width&&U[1]>0&&U[1]<=R.height&&!td(R,new Bi(R.center.lat,90)),W[0]>0&&W[0]<=R.width&&W[1]>0&&W[1]<=R.height&&!td(R,new Bi(R.center.lat,-90))]},t.polygonContainsPoint=vs,t.polygonIntersectsBox=Ff,t.polygonIntersectsPolygon=Pf,t.polygonizeBounds=function(R,h,U=0,W=!0){const K=new He(U,U),Q=R.sub(K),oe=h.add(K),ce=[Q,new He(oe.x,Q.y),oe,new He(Q.x,oe.y)];return W&&ce.push(Q.clone()),ce},t.posAttributes=bl,t.postMapLoadEvent=wi,t.postPerformanceEvent=Hi,t.postTurnstileEvent=yi,t.potpack=wd,t.prevPowerOfTwo=function(R){return R<=1?1:Math.pow(2,Math.floor(Math.log(R)/Math.LN2))},t.radToDeg=yt,t.refProperties=["type","source","source-layer","minzoom","maxzoom","filter","layout"],t.registerForPluginStateChange=function(R){return R({pluginStatus:J,pluginURL:G}),le.on("pluginStateChange",R),R},t.removeAuthState=function(R){fr.delete(R)},t.renderColorRamp=cd,t.resample=Of,t.rotateX=Gh,t.rotateX$1=_f,t.rotateY=Bc,t.rotateY$1=mf,t.rotateZ=function(R,h,U){var W=Math.sin(U),K=Math.cos(U),Q=h[0],oe=h[1],ce=h[2],fe=h[3],pe=h[4],ve=h[5],Ee=h[6],we=h[7];return h!==R&&(R[8]=h[8],R[9]=h[9],R[10]=h[10],R[11]=h[11],R[12]=h[12],R[13]=h[13],R[14]=h[14],R[15]=h[15]),R[0]=Q*K+pe*W,R[1]=oe*K+ve*W,R[2]=ce*K+Ee*W,R[3]=fe*K+we*W,R[4]=pe*K-Q*W,R[5]=ve*K-oe*W,R[6]=Ee*K-ce*W,R[7]=we*K-fe*W,R},t.rotateZ$1=function(R,h,U){U*=.5;var W=h[0],K=h[1],Q=h[2],oe=h[3],ce=Math.sin(U),fe=Math.cos(U);return R[0]=W*fe+K*ce,R[1]=K*fe-W*ce,R[2]=Q*fe+oe*ce,R[3]=oe*fe-Q*ce,R},t.scale=fs,t.scale$1=hf,t.scale$2=na,t.scaleAndAdd=gl,t.set=function(R,h,U,W){return R[0]=h,R[1]=U,R[2]=W,R},t.setCacheLimits=function(R,h){Nr=R,je=h},t.setColumn=function(R,h,U){R[4*h+0]=U[0],R[4*h+1]=U[1],R[4*h+2]=U[2],R[4*h+3]=U[3]},t.setRTLTextPlugin=function(R,h,U=!1){if(J===ll||J===cl||J===hl)throw new Error("setRTLTextPlugin cannot be called multiple times.");G=qr.resolveURL(R),J=ll,Io=h,re(),U||me()},t.smoothstep=At,t.spec=Yt,t.squaredLength=function(R){var h=R[0],U=R[1],W=R[2];return h*h+U*U+W*W},t.storeAuthState=function(R,h){h?fr.add(R):fr.delete(R)},t.sub=Aa,t.subtract=Wh,t.symbolSize=Qm,t.tileAABB=function(R,h,U,W,K,Q,oe,ce,fe){if(fe.name==="globe")return W_(R,h,new Qc(U,W,K));const pe=xs({z:U,x:W,y:K},fe);return new Fn([(Q+pe.x/pe.scale)*h,h*(pe.y/pe.scale),oe],[(Q+pe.x2/pe.scale)*h,h*(pe.y2/pe.scale),ce])},t.tileCornersToBounds=Nc,t.tileTransform=xs,t.transformMat3=function(R,h,U){var W=h[0],K=h[1],Q=h[2];return R[0]=W*U[0]+K*U[3]+Q*U[6],R[1]=W*U[1]+K*U[4]+Q*U[7],R[2]=W*U[2]+K*U[5]+Q*U[8],R},t.transformMat4=un,t.transformMat4$1=ps,t.transformQuat=cf,t.transitionTileAABBinECEF=xf,t.translate=pl,t.transpose=function(R,h){if(R===h){var U=h[1],W=h[2],K=h[5];R[1]=h[3],R[2]=h[6],R[3]=U,R[5]=h[7],R[6]=W,R[7]=K}else R[0]=h[0],R[1]=h[3],R[2]=h[6],R[3]=h[1],R[4]=h[4],R[5]=h[7],R[6]=h[2],R[7]=h[5],R[8]=h[8];return R},t.triggerPluginCompletionEvent=Z,t.uniqueId=Mr,t.updateGlobeVertexNormal=function(R,h,U,W,K){const Q=5*h+2;R.float32[Q+0]=U,R.float32[Q+1]=W,R.float32[Q+2]=K},t.validateCustomStyleLayer=function(R){const h=[],U=R.id;return U===void 0&&h.push({message:`layers.${U}: missing required property "id"`}),R.render===void 0&&h.push({message:`layers.${U}: missing required method "render"`}),R.renderingMode&&R.renderingMode!=="2d"&&R.renderingMode!=="3d"&&h.push({message:`layers.${U}: property "renderingMode" must be either "2d" or "3d"`}),h},t.validateFilter=R=>Zn(ss(R)),t.validateFog=R=>Zn(Ic(R)),t.validateLayer=R=>Zn(wc(R)),t.validateLight=R=>Zn(qc(R)),t.validateSource=R=>Zn(Tc(R)),t.validateStyle=Rc,t.validateTerrain=R=>Zn(nl(R)),t.values=er,t.vectorTile=Xc,t.version=ae,t.warnOnce=Hr,t.window=H,t.wrap=wt}),se(["./shared"],function(t){function H(Ke){if(typeof Ke=="number"||typeof Ke=="boolean"||typeof Ke=="string"||Ke==null)return JSON.stringify(Ke);if(Array.isArray(Ke)){let Ne="[";for(const rt of Ke)Ne+=`${H(rt)},`;return`${Ne}]`}let Me="{";for(const Ne of Object.keys(Ke).sort())Me+=`${Ne}:${H(Ke[Ne])},`;return`${Me}}`}function ae(Ke){let Me="";for(const Ne of t.refProperties)Me+=`/${H(Ke[Ne])}`;return Me}class he{constructor(Me){this.keyCache={},Me&&this.replace(Me)}replace(Me){this._layerConfigs={},this._layers={},this.update(Me,[])}update(Me,Ne){for(const dt of Me)this._layerConfigs[dt.id]=dt,(this._layers[dt.id]=t.createStyleLayer(dt)).compileFilter(),this.keyCache[dt.id]&&delete this.keyCache[dt.id];for(const dt of Ne)delete this.keyCache[dt],delete this._layerConfigs[dt],delete this._layers[dt];this.familiesBySource={};const rt=function(dt,vt){const Mt={};for(let St=0;St<dt.length;St++){const Wt=vt&&vt[dt[St].id]||ae(dt[St]);vt&&(vt[dt[St].id]=Wt);let br=Mt[Wt];br||(br=Mt[Wt]=[]),br.push(dt[St])}const Pt=[];for(const St in Mt)Pt.push(Mt[St]);return Pt}(t.values(this._layerConfigs),this.keyCache);for(const dt of rt){const vt=dt.map(Ar=>this._layers[Ar.id]),Mt=vt[0];if(Mt.visibility==="none")continue;const Pt=Mt.source||"";let St=this.familiesBySource[Pt];St||(St=this.familiesBySource[Pt]={});const Wt=Mt.sourceLayer||"_geojsonTileLayer";let br=St[Wt];br||(br=St[Wt]=[]),br.push(vt)}}}class _e{loadTile(Me,Ne){const{uid:rt,encoding:dt,rawImageData:vt,padding:Mt,buildQuadTree:Pt}=Me,St=t.window.ImageBitmap&&vt instanceof t.window.ImageBitmap?this.getImageData(vt,Mt):vt;Ne(null,new t.DEMData(rt,St,dt,Mt<1,Pt))}getImageData(Me,Ne){this.offscreenCanvas&&this.offscreenCanvasContext||(this.offscreenCanvas=new OffscreenCanvas(Me.width,Me.height),this.offscreenCanvasContext=this.offscreenCanvas.getContext("2d",{willReadFrequently:!0})),this.offscreenCanvas.width=Me.width,this.offscreenCanvas.height=Me.height,this.offscreenCanvasContext.drawImage(Me,0,0,Me.width,Me.height);const rt=this.offscreenCanvasContext.getImageData(-Ne,-Ne,Me.width+2*Ne,Me.height+2*Ne);return this.offscreenCanvasContext.clearRect(0,0,this.offscreenCanvas.width,this.offscreenCanvas.height),rt}}function ge(Ke,Me){if(Ke.length!==0){xe(Ke[0],Me);for(var Ne=1;Ne<Ke.length;Ne++)xe(Ke[Ne],!Me)}}function xe(Ke,Me){for(var Ne=0,rt=0,dt=0,vt=Ke.length,Mt=vt-1;dt<vt;Mt=dt++){var Pt=(Ke[dt][0]-Ke[Mt][0])*(Ke[Mt][1]+Ke[dt][1]),St=Ne+Pt;rt+=Math.abs(Ne)>=Math.abs(Pt)?Ne-St+Pt:Pt-St+Ne,Ne=St}Ne+rt>=0!=!!Me&&Ke.reverse()}var Re=t.getDefaultExportFromCjs(function Ke(Me,Ne){var rt,dt=Me&&Me.type;if(dt==="FeatureCollection")for(rt=0;rt<Me.features.length;rt++)Ke(Me.features[rt],Ne);else if(dt==="GeometryCollection")for(rt=0;rt<Me.geometries.length;rt++)Ke(Me.geometries[rt],Ne);else if(dt==="Feature")Ke(Me.geometry,Ne);else if(dt==="Polygon")ge(Me.coordinates,Ne);else if(dt==="MultiPolygon")for(rt=0;rt<Me.coordinates.length;rt++)ge(Me.coordinates[rt],Ne);return Me});const De=t.VectorTileFeature.prototype.toGeoJSON;var Ie={exports:{}},Ce=t.pointGeometry,Ue=t.vectorTile.VectorTileFeature,Le=ke;function ke(Ke,Me){this.options=Me||{},this.features=Ke,this.length=Ke.length}function Ge(Ke,Me){this.id=typeof Ke.id=="number"?Ke.id:void 0,this.type=Ke.type,this.rawGeometry=Ke.type===1?[Ke.geometry]:Ke.geometry,this.properties=Ke.tags,this.extent=Me||4096}ke.prototype.feature=function(Ke){return new Ge(this.features[Ke],this.options.extent)},Ge.prototype.loadGeometry=function(){var Ke=this.rawGeometry;this.geometry=[];for(var Me=0;Me<Ke.length;Me++){for(var Ne=Ke[Me],rt=[],dt=0;dt<Ne.length;dt++)rt.push(new Ce(Ne[dt][0],Ne[dt][1]));this.geometry.push(rt)}return this.geometry},Ge.prototype.bbox=function(){this.geometry||this.loadGeometry();for(var Ke=this.geometry,Me=1/0,Ne=-1/0,rt=1/0,dt=-1/0,vt=0;vt<Ke.length;vt++)for(var Mt=Ke[vt],Pt=0;Pt<Mt.length;Pt++){var St=Mt[Pt];Me=Math.min(Me,St.x),Ne=Math.max(Ne,St.x),rt=Math.min(rt,St.y),dt=Math.max(dt,St.y)}return[Me,rt,Ne,dt]},Ge.prototype.toGeoJSON=Ue.prototype.toGeoJSON;var Ze=t.pbf,We=Le;function et(Ke){var Me=new Ze;return function(Ne,rt){for(var dt in Ne.layers)rt.writeMessage(3,He,Ne.layers[dt])}(Ke,Me),Me.finish()}function He(Ke,Me){var Ne;Me.writeVarintField(15,Ke.version||1),Me.writeStringField(1,Ke.name||""),Me.writeVarintField(5,Ke.extent||4096);var rt={keys:[],values:[],keycache:{},valuecache:{}};for(Ne=0;Ne<Ke.length;Ne++)rt.feature=Ke.feature(Ne),Me.writeMessage(2,ht,rt);var dt=rt.keys;for(Ne=0;Ne<dt.length;Ne++)Me.writeStringField(3,dt[Ne]);var vt=rt.values;for(Ne=0;Ne<vt.length;Ne++)Me.writeMessage(4,Kt,vt[Ne])}function ht(Ke,Me){var Ne=Ke.feature;Ne.id!==void 0&&Me.writeVarintField(1,Ne.id),Me.writeMessage(2,_t,Ke),Me.writeVarintField(3,Ne.type),Me.writeMessage(4,Lt,Ne)}function _t(Ke,Me){var Ne=Ke.feature,rt=Ke.keys,dt=Ke.values,vt=Ke.keycache,Mt=Ke.valuecache;for(var Pt in Ne.properties){var St=Ne.properties[Pt],Wt=vt[Pt];if(St!==null){Wt===void 0&&(rt.push(Pt),vt[Pt]=Wt=rt.length-1),Me.writeVarint(Wt);var br=typeof St;br!=="string"&&br!=="boolean"&&br!=="number"&&(St=JSON.stringify(St));var Ar=br+":"+St,cr=Mt[Ar];cr===void 0&&(dt.push(St),Mt[Ar]=cr=dt.length-1),Me.writeVarint(cr)}}}function ut(Ke,Me){return(Me<<3)+(7&Ke)}function yt(Ke){return Ke<<1^Ke>>31}function Lt(Ke,Me){for(var Ne=Ke.loadGeometry(),rt=Ke.type,dt=0,vt=0,Mt=Ne.length,Pt=0;Pt<Mt;Pt++){var St=Ne[Pt],Wt=1;rt===1&&(Wt=St.length),Me.writeVarint(ut(1,Wt));for(var br=rt===3?St.length-1:St.length,Ar=0;Ar<br;Ar++){Ar===1&&rt!==1&&Me.writeVarint(ut(2,br-1));var cr=St[Ar].x-dt,ti=St[Ar].y-vt;Me.writeVarint(yt(cr)),Me.writeVarint(yt(ti)),dt+=cr,vt+=ti}rt===3&&Me.writeVarint(ut(7,1))}}function Kt(Ke,Me){var Ne=typeof Ke;Ne==="string"?Me.writeStringField(1,Ke):Ne==="boolean"?Me.writeBooleanField(7,Ke):Ne==="number"&&(Ke%1!=0?Me.writeDoubleField(3,Ke):Ke<0?Me.writeSVarintField(6,Ke):Me.writeVarintField(5,Ke))}Ie.exports=et,Ie.exports.fromVectorTileJs=et,Ie.exports.fromGeojsonVt=function(Ke,Me){Me=Me||{};var Ne={};for(var rt in Ke)Ne[rt]=new We(Ke[rt].features,Me),Ne[rt].name=rt,Ne[rt].version=Me.version,Ne[rt].extent=Me.extent;return et({layers:Ne})},Ie.exports.GeoJSONWrapper=We;var ft=t.getDefaultExportFromCjs(Ie.exports);const qt={minZoom:0,maxZoom:16,minPoints:2,radius:40,extent:512,nodeSize:64,log:!1,generateId:!1,reduce:null,map:Ke=>Ke},nt=Math.fround||(At=new Float32Array(1),Ke=>(At[0]=+Ke,At[0]));var At;const wt=3,Ft=5,er=6;class lr{constructor(Me){this.options=Object.assign(Object.create(qt),Me),this.trees=new Array(this.options.maxZoom+1),this.stride=this.options.reduce?7:6,this.clusterProps=[]}load(Me){const{log:Ne,minZoom:rt,maxZoom:dt}=this.options;Ne&&console.time("total time");const vt=`prepare ${Me.length} points`;Ne&&console.time(vt),this.points=Me;const Mt=[];for(let St=0;St<Me.length;St++){const Wt=Me[St];if(!Wt.geometry)continue;const[br,Ar]=Wt.geometry.coordinates,cr=nt(Lr(br)),ti=nt(sr(Ar));Mt.push(cr,ti,1/0,St,-1,1),this.options.reduce&&Mt.push(0)}let Pt=this.trees[dt+1]=this._createTree(Mt);Ne&&console.timeEnd(vt);for(let St=dt;St>=rt;St--){const Wt=+Date.now();Pt=this.trees[St]=this._createTree(this._cluster(Pt,St)),Ne&&console.log("z%d: %d clusters in %dms",St,Pt.numItems,+Date.now()-Wt)}return Ne&&console.timeEnd("total time"),this}getClusters(Me,Ne){let rt=((Me[0]+180)%360+360)%360-180;const dt=Math.max(-90,Math.min(90,Me[1]));let vt=Me[2]===180?180:((Me[2]+180)%360+360)%360-180;const Mt=Math.max(-90,Math.min(90,Me[3]));if(Me[2]-Me[0]>=360)rt=-180,vt=180;else if(rt>vt){const Ar=this.getClusters([rt,dt,180,Mt],Ne),cr=this.getClusters([-180,dt,vt,Mt],Ne);return Ar.concat(cr)}const Pt=this.trees[this._limitZoom(Ne)],St=Pt.range(Lr(rt),sr(Mt),Lr(vt),sr(dt)),Wt=Pt.data,br=[];for(const Ar of St){const cr=this.stride*Ar;br.push(Wt[cr+Ft]>1?jr(Wt,cr,this.clusterProps):this.points[Wt[cr+wt]])}return br}getChildren(Me){const Ne=this._getOriginId(Me),rt=this._getOriginZoom(Me),dt="No cluster with the specified id.",vt=this.trees[rt];if(!vt)throw new Error(dt);const Mt=vt.data;if(Ne*this.stride>=Mt.length)throw new Error(dt);const Pt=this.options.radius/(this.options.extent*Math.pow(2,rt-1)),St=vt.within(Mt[Ne*this.stride],Mt[Ne*this.stride+1],Pt),Wt=[];for(const br of St){const Ar=br*this.stride;Mt[Ar+4]===Me&&Wt.push(Mt[Ar+Ft]>1?jr(Mt,Ar,this.clusterProps):this.points[Mt[Ar+wt]])}if(Wt.length===0)throw new Error(dt);return Wt}getLeaves(Me,Ne,rt){const dt=[];return this._appendLeaves(dt,Me,Ne=Ne||10,rt=rt||0,0),dt}getTile(Me,Ne,rt){const dt=this.trees[this._limitZoom(Me)],vt=Math.pow(2,Me),{extent:Mt,radius:Pt}=this.options,St=Pt/Mt,Wt=(rt-St)/vt,br=(rt+1+St)/vt,Ar={features:[]};return this._addTileFeatures(dt.range((Ne-St)/vt,Wt,(Ne+1+St)/vt,br),dt.data,Ne,rt,vt,Ar),Ne===0&&this._addTileFeatures(dt.range(1-St/vt,Wt,1,br),dt.data,vt,rt,vt,Ar),Ne===vt-1&&this._addTileFeatures(dt.range(0,Wt,St/vt,br),dt.data,-1,rt,vt,Ar),Ar.features.length?Ar:null}getClusterExpansionZoom(Me){let Ne=this._getOriginZoom(Me)-1;for(;Ne<=this.options.maxZoom;){const rt=this.getChildren(Me);if(Ne++,rt.length!==1)break;Me=rt[0].properties.cluster_id}return Ne}_appendLeaves(Me,Ne,rt,dt,vt){const Mt=this.getChildren(Ne);for(const Pt of Mt){const St=Pt.properties;if(St&&St.cluster?vt+St.point_count<=dt?vt+=St.point_count:vt=this._appendLeaves(Me,St.cluster_id,rt,dt,vt):vt<dt?vt++:Me.push(Pt),Me.length===rt)break}return vt}_createTree(Me){const Ne=new t.KDBush(Me.length/this.stride|0,this.options.nodeSize,Float32Array);for(let rt=0;rt<Me.length;rt+=this.stride)Ne.add(Me[rt],Me[rt+1]);return Ne.finish(),Ne.data=Me,Ne}_addTileFeatures(Me,Ne,rt,dt,vt,Mt){for(const Pt of Me){const St=Pt*this.stride,Wt=Ne[St+Ft]>1;let br,Ar,cr;if(Wt)br=Mr(Ne,St,this.clusterProps),Ar=Ne[St],cr=Ne[St+1];else{const ni=this.points[Ne[St+wt]];br=ni.properties;const[oi,yi]=ni.geometry.coordinates;Ar=Lr(oi),cr=sr(yi)}const ti={type:1,geometry:[[Math.round(this.options.extent*(Ar*vt-rt)),Math.round(this.options.extent*(cr*vt-dt))]],tags:br};let ci;ci=Wt||this.options.generateId?Ne[St+wt]:this.points[Ne[St+wt]].id,ci!==void 0&&(ti.id=ci),Mt.features.push(ti)}}_limitZoom(Me){return Math.max(this.options.minZoom,Math.min(Math.floor(+Me),this.options.maxZoom+1))}_cluster(Me,Ne){const{radius:rt,extent:dt,reduce:vt,minPoints:Mt}=this.options,Pt=rt/(dt*Math.pow(2,Ne)),St=Me.data,Wt=[],br=this.stride;for(let Ar=0;Ar<St.length;Ar+=br){if(St[Ar+2]<=Ne)continue;St[Ar+2]=Ne;const cr=St[Ar],ti=St[Ar+1],ci=Me.within(St[Ar],St[Ar+1],Pt),ni=St[Ar+Ft];let oi=ni;for(const yi of ci){const Ai=yi*br;St[Ai+2]>Ne&&(oi+=St[Ai+Ft])}if(oi>ni&&oi>=Mt){let yi,Ai=cr*ni,wi=ti*ni,Mi=-1;const Hi=((Ar/br|0)<<5)+(Ne+1)+this.points.length;for(const qn of ci){const Gt=qn*br;if(St[Gt+2]<=Ne)continue;St[Gt+2]=Ne;const fr=St[Gt+Ft];Ai+=St[Gt]*fr,wi+=St[Gt+1]*fr,St[Gt+4]=Hi,vt&&(yi||(yi=this._map(St,Ar,!0),Mi=this.clusterProps.length,this.clusterProps.push(yi)),vt(yi,this._map(St,Gt)))}St[Ar+4]=Hi,Wt.push(Ai/oi,wi/oi,1/0,Hi,-1,oi),vt&&Wt.push(Mi)}else{for(let yi=0;yi<br;yi++)Wt.push(St[Ar+yi]);if(oi>1)for(const yi of ci){const Ai=yi*br;if(!(St[Ai+2]<=Ne)){St[Ai+2]=Ne;for(let wi=0;wi<br;wi++)Wt.push(St[Ai+wi])}}}}return Wt}_getOriginId(Me){return Me-this.points.length>>5}_getOriginZoom(Me){return(Me-this.points.length)%32}_map(Me,Ne,rt){if(Me[Ne+Ft]>1){const Mt=this.clusterProps[Me[Ne+er]];return rt?Object.assign({},Mt):Mt}const dt=this.points[Me[Ne+wt]].properties,vt=this.options.map(dt);return rt&&vt===dt?Object.assign({},vt):vt}}function jr(Ke,Me,Ne){return{type:"Feature",id:Ke[Me+wt],properties:Mr(Ke,Me,Ne),geometry:{type:"Point",coordinates:[(rt=Ke[Me],360*(rt-.5)),Rr(Ke[Me+1])]}};var rt}function Mr(Ke,Me,Ne){const rt=Ke[Me+Ft],dt=rt>=1e4?`${Math.round(rt/1e3)}k`:rt>=1e3?Math.round(rt/100)/10+"k":rt,vt=Ke[Me+er],Mt=vt===-1?{}:Object.assign({},Ne[vt]);return Object.assign(Mt,{cluster:!0,cluster_id:Ke[Me+wt],point_count:rt,point_count_abbreviated:dt})}function Lr(Ke){return Ke/360+.5}function sr(Ke){const Me=Math.sin(Ke*Math.PI/180),Ne=.5-.25*Math.log((1+Me)/(1-Me))/Math.PI;return Ne<0?0:Ne>1?1:Ne}function Rr(Ke){const Me=(180-360*Ke)*Math.PI/180;return 360*Math.atan(Math.exp(Me))/Math.PI-90}function Ur(Ke,Me,Ne,rt){for(var dt,vt=rt,Mt=Ne-Me>>1,Pt=Ne-Me,St=Ke[Me],Wt=Ke[Me+1],br=Ke[Ne],Ar=Ke[Ne+1],cr=Me+3;cr<Ne;cr+=3){var ti=Wr(Ke[cr],Ke[cr+1],St,Wt,br,Ar);if(ti>vt)dt=cr,vt=ti;else if(ti===vt){var ci=Math.abs(cr-Mt);ci<Pt&&(dt=cr,Pt=ci)}}vt>rt&&(dt-Me>3&&Ur(Ke,Me,dt,rt),Ke[dt+2]=vt,Ne-dt>3&&Ur(Ke,dt,Ne,rt))}function Wr(Ke,Me,Ne,rt,dt,vt){var Mt=dt-Ne,Pt=vt-rt;if(Mt!==0||Pt!==0){var St=((Ke-Ne)*Mt+(Me-rt)*Pt)/(Mt*Mt+Pt*Pt);St>1?(Ne=dt,rt=vt):St>0&&(Ne+=Mt*St,rt+=Pt*St)}return(Mt=Ke-Ne)*Mt+(Pt=Me-rt)*Pt}function Er(Ke,Me,Ne,rt){var dt={id:Ke===void 0?null:Ke,type:Me,geometry:Ne,tags:rt,minX:1/0,minY:1/0,maxX:-1/0,maxY:-1/0};return function(vt){var Mt=vt.geometry,Pt=vt.type;if(Pt==="Point"||Pt==="MultiPoint"||Pt==="LineString")Kr(vt,Mt);else if(Pt==="Polygon"||Pt==="MultiLineString")for(var St=0;St<Mt.length;St++)Kr(vt,Mt[St]);else if(Pt==="MultiPolygon")for(St=0;St<Mt.length;St++)for(var Wt=0;Wt<Mt[St].length;Wt++)Kr(vt,Mt[St][Wt])}(dt),dt}function Kr(Ke,Me){for(var Ne=0;Ne<Me.length;Ne+=3)Ke.minX=Math.min(Ke.minX,Me[Ne]),Ke.minY=Math.min(Ke.minY,Me[Ne+1]),Ke.maxX=Math.max(Ke.maxX,Me[Ne]),Ke.maxY=Math.max(Ke.maxY,Me[Ne+1])}function ui(Ke,Me,Ne,rt){if(Me.geometry){var dt=Me.geometry.coordinates,vt=Me.geometry.type,Mt=Math.pow(Ne.tolerance/((1<<Ne.maxZoom)*Ne.extent),2),Pt=[],St=Me.id;if(Ne.promoteId?St=Me.properties[Ne.promoteId]:Ne.generateId&&(St=rt||0),vt==="Point")Ei(dt,Pt);else if(vt==="MultiPoint")for(var Wt=0;Wt<dt.length;Wt++)Ei(dt[Wt],Pt);else if(vt==="LineString")Hr(dt,Pt,Mt,!1);else if(vt==="MultiLineString"){if(Ne.lineMetrics){for(Wt=0;Wt<dt.length;Wt++)Hr(dt[Wt],Pt=[],Mt,!1),Ke.push(Er(St,"LineString",Pt,Me.properties));return}Br(dt,Pt,Mt,!1)}else if(vt==="Polygon")Br(dt,Pt,Mt,!0);else{if(vt!=="MultiPolygon"){if(vt==="GeometryCollection"){for(Wt=0;Wt<Me.geometry.geometries.length;Wt++)ui(Ke,{id:St,geometry:Me.geometry.geometries[Wt],properties:Me.properties},Ne,rt);return}throw new Error("Input data is not a valid GeoJSON object.")}for(Wt=0;Wt<dt.length;Wt++){var br=[];Br(dt[Wt],br,Mt,!0),Pt.push(br)}}Ke.push(Er(St,vt,Pt,Me.properties))}}function Ei(Ke,Me){Me.push(li(Ke[0])),Me.push(si(Ke[1])),Me.push(0)}function Hr(Ke,Me,Ne,rt){for(var dt,vt,Mt=0,Pt=0;Pt<Ke.length;Pt++){var St=li(Ke[Pt][0]),Wt=si(Ke[Pt][1]);Me.push(St),Me.push(Wt),Me.push(0),Pt>0&&(Mt+=rt?(dt*Wt-St*vt)/2:Math.sqrt(Math.pow(St-dt,2)+Math.pow(Wt-vt,2))),dt=St,vt=Wt}var br=Me.length-3;Me[2]=1,Ur(Me,0,br,Ne),Me[br+2]=1,Me.size=Math.abs(Mt),Me.start=0,Me.end=Me.size}function Br(Ke,Me,Ne,rt){for(var dt=0;dt<Ke.length;dt++){var vt=[];Hr(Ke[dt],vt,Ne,rt),Me.push(vt)}}function li(Ke){return Ke/360+.5}function si(Ke){var Me=Math.sin(Ke*Math.PI/180),Ne=.5-.25*Math.log((1+Me)/(1-Me))/Math.PI;return Ne<0?0:Ne>1?1:Ne}function Qr(Ke,Me,Ne,rt,dt,vt,Mt,Pt){if(rt/=Me,vt>=(Ne/=Me)&&Mt<rt)return Ke;if(Mt<Ne||vt>=rt)return null;for(var St=[],Wt=0;Wt<Ke.length;Wt++){var br=Ke[Wt],Ar=br.geometry,cr=br.type,ti=dt===0?br.minX:br.minY,ci=dt===0?br.maxX:br.maxY;if(ti>=Ne&&ci<rt)St.push(br);else if(!(ci<Ne||ti>=rt)){var ni=[];if(cr==="Point"||cr==="MultiPoint")_r(Ar,ni,Ne,rt,dt);else if(cr==="LineString")vr(Ar,ni,Ne,rt,dt,!1,Pt.lineMetrics);else if(cr==="MultiLineString")Ir(Ar,ni,Ne,rt,dt,!1);else if(cr==="Polygon")Ir(Ar,ni,Ne,rt,dt,!0);else if(cr==="MultiPolygon")for(var oi=0;oi<Ar.length;oi++){var yi=[];Ir(Ar[oi],yi,Ne,rt,dt,!0),yi.length&&ni.push(yi)}if(ni.length){if(Pt.lineMetrics&&cr==="LineString"){for(oi=0;oi<ni.length;oi++)St.push(Er(br.id,cr,ni[oi],br.tags));continue}cr!=="LineString"&&cr!=="MultiLineString"||(ni.length===1?(cr="LineString",ni=ni[0]):cr="MultiLineString"),cr!=="Point"&&cr!=="MultiPoint"||(cr=ni.length===3?"Point":"MultiPoint"),St.push(Er(br.id,cr,ni,br.tags))}}}return St.length?St:null}function _r(Ke,Me,Ne,rt,dt){for(var vt=0;vt<Ke.length;vt+=3){var Mt=Ke[vt+dt];Mt>=Ne&&Mt<=rt&&(Me.push(Ke[vt]),Me.push(Ke[vt+1]),Me.push(Ke[vt+2]))}}function vr(Ke,Me,Ne,rt,dt,vt,Mt){for(var Pt,St,Wt=Xr(Ke),br=dt===0?Nr:je,Ar=Ke.start,cr=0;cr<Ke.length-3;cr+=3){var ti=Ke[cr],ci=Ke[cr+1],ni=Ke[cr+2],oi=Ke[cr+3],yi=Ke[cr+4],Ai=dt===0?ti:ci,wi=dt===0?oi:yi,Mi=!1;Mt&&(Pt=Math.sqrt(Math.pow(ti-oi,2)+Math.pow(ci-yi,2))),Ai<Ne?wi>Ne&&(St=br(Wt,ti,ci,oi,yi,Ne),Mt&&(Wt.start=Ar+Pt*St)):Ai>rt?wi<rt&&(St=br(Wt,ti,ci,oi,yi,rt),Mt&&(Wt.start=Ar+Pt*St)):Or(Wt,ti,ci,ni),wi<Ne&&Ai>=Ne&&(St=br(Wt,ti,ci,oi,yi,Ne),Mi=!0),wi>rt&&Ai<=rt&&(St=br(Wt,ti,ci,oi,yi,rt),Mi=!0),!vt&&Mi&&(Mt&&(Wt.end=Ar+Pt*St),Me.push(Wt),Wt=Xr(Ke)),Mt&&(Ar+=Pt)}var Hi=Ke.length-3;ti=Ke[Hi],ci=Ke[Hi+1],ni=Ke[Hi+2],(Ai=dt===0?ti:ci)>=Ne&&Ai<=rt&&Or(Wt,ti,ci,ni),Hi=Wt.length-3,vt&&Hi>=3&&(Wt[Hi]!==Wt[0]||Wt[Hi+1]!==Wt[1])&&Or(Wt,Wt[0],Wt[1],Wt[2]),Wt.length&&Me.push(Wt)}function Xr(Ke){var Me=[];return Me.size=Ke.size,Me.start=Ke.start,Me.end=Ke.end,Me}function Ir(Ke,Me,Ne,rt,dt,vt){for(var Mt=0;Mt<Ke.length;Mt++)vr(Ke[Mt],Me,Ne,rt,dt,vt,!1)}function Or(Ke,Me,Ne,rt){Ke.push(Me),Ke.push(Ne),Ke.push(rt)}function Nr(Ke,Me,Ne,rt,dt,vt){var Mt=(vt-Me)/(rt-Me);return Ke.push(vt),Ke.push(Ne+(dt-Ne)*Mt),Ke.push(1),Mt}function je(Ke,Me,Ne,rt,dt,vt){var Mt=(vt-Ne)/(dt-Ne);return Ke.push(Me+(rt-Me)*Mt),Ke.push(vt),Ke.push(1),Mt}function Se(Ke,Me){for(var Ne=[],rt=0;rt<Ke.length;rt++){var dt,vt=Ke[rt],Mt=vt.type;if(Mt==="Point"||Mt==="MultiPoint"||Mt==="LineString")dt=Oe(vt.geometry,Me);else if(Mt==="MultiLineString"||Mt==="Polygon"){dt=[];for(var Pt=0;Pt<vt.geometry.length;Pt++)dt.push(Oe(vt.geometry[Pt],Me))}else if(Mt==="MultiPolygon")for(dt=[],Pt=0;Pt<vt.geometry.length;Pt++){for(var St=[],Wt=0;Wt<vt.geometry[Pt].length;Wt++)St.push(Oe(vt.geometry[Pt][Wt],Me));dt.push(St)}Ne.push(Er(vt.id,Mt,dt,vt.tags))}return Ne}function Oe(Ke,Me){var Ne=[];Ne.size=Ke.size,Ke.start!==void 0&&(Ne.start=Ke.start,Ne.end=Ke.end);for(var rt=0;rt<Ke.length;rt+=3)Ne.push(Ke[rt]+Me,Ke[rt+1],Ke[rt+2]);return Ne}function Ve(Ke,Me){if(Ke.transformed)return Ke;var Ne,rt,dt,vt=1<<Ke.z,Mt=Ke.x,Pt=Ke.y;for(Ne=0;Ne<Ke.features.length;Ne++){var St=Ke.features[Ne],Wt=St.geometry,br=St.type;if(St.geometry=[],br===1)for(rt=0;rt<Wt.length;rt+=2)St.geometry.push(st(Wt[rt],Wt[rt+1],Me,vt,Mt,Pt));else for(rt=0;rt<Wt.length;rt++){var Ar=[];for(dt=0;dt<Wt[rt].length;dt+=2)Ar.push(st(Wt[rt][dt],Wt[rt][dt+1],Me,vt,Mt,Pt));St.geometry.push(Ar)}}return Ke.transformed=!0,Ke}function st(Ke,Me,Ne,rt,dt,vt){return[Math.round(Ne*(Ke*rt-dt)),Math.round(Ne*(Me*rt-vt))]}function gt(Ke,Me,Ne,rt,dt){for(var vt=Me===dt.maxZoom?0:dt.tolerance/((1<<Me)*dt.extent),Mt={features:[],numPoints:0,numSimplified:0,numFeatures:0,source:null,x:Ne,y:rt,z:Me,transformed:!1,minX:2,minY:1,maxX:-1,maxY:0},Pt=0;Pt<Ke.length;Pt++){Mt.numFeatures++,Ot(Mt,Ke[Pt],vt,dt);var St=Ke[Pt].minX,Wt=Ke[Pt].minY,br=Ke[Pt].maxX,Ar=Ke[Pt].maxY;St<Mt.minX&&(Mt.minX=St),Wt<Mt.minY&&(Mt.minY=Wt),br>Mt.maxX&&(Mt.maxX=br),Ar>Mt.maxY&&(Mt.maxY=Ar)}return Mt}function Ot(Ke,Me,Ne,rt){var dt=Me.geometry,vt=Me.type,Mt=[];if(vt==="Point"||vt==="MultiPoint")for(var Pt=0;Pt<dt.length;Pt+=3)Mt.push(dt[Pt]),Mt.push(dt[Pt+1]),Ke.numPoints++,Ke.numSimplified++;else if(vt==="LineString")tr(Mt,dt,Ke,Ne,!1,!1);else if(vt==="MultiLineString"||vt==="Polygon")for(Pt=0;Pt<dt.length;Pt++)tr(Mt,dt[Pt],Ke,Ne,vt==="Polygon",Pt===0);else if(vt==="MultiPolygon")for(var St=0;St<dt.length;St++){var Wt=dt[St];for(Pt=0;Pt<Wt.length;Pt++)tr(Mt,Wt[Pt],Ke,Ne,!0,Pt===0)}if(Mt.length){var br=Me.tags||null;if(vt==="LineString"&&rt.lineMetrics){for(var Ar in br={},Me.tags)br[Ar]=Me.tags[Ar];br.mapbox_clip_start=dt.start/dt.size,br.mapbox_clip_end=dt.end/dt.size}var cr={geometry:Mt,type:vt==="Polygon"||vt==="MultiPolygon"?3:vt==="LineString"||vt==="MultiLineString"?2:1,tags:br};Me.id!==null&&(cr.id=Me.id),Ke.features.push(cr)}}function tr(Ke,Me,Ne,rt,dt,vt){var Mt=rt*rt;if(rt>0&&Me.size<(dt?Mt:rt))Ne.numPoints+=Me.length/3;else{for(var Pt=[],St=0;St<Me.length;St+=3)(rt===0||Me[St+2]>Mt)&&(Ne.numSimplified++,Pt.push(Me[St]),Pt.push(Me[St+1])),Ne.numPoints++;dt&&function(Wt,br){for(var Ar=0,cr=0,ti=Wt.length,ci=ti-2;cr<ti;ci=cr,cr+=2)Ar+=(Wt[cr]-Wt[ci])*(Wt[cr+1]+Wt[ci+1]);if(Ar>0===br)for(cr=0,ti=Wt.length;cr<ti/2;cr+=2){var ni=Wt[cr],oi=Wt[cr+1];Wt[cr]=Wt[ti-2-cr],Wt[cr+1]=Wt[ti-1-cr],Wt[ti-2-cr]=ni,Wt[ti-1-cr]=oi}}(Pt,vt),Ke.push(Pt)}}function Qt(Ke,Me){var Ne=(Me=this.options=function(dt,vt){for(var Mt in vt)dt[Mt]=vt[Mt];return dt}(Object.create(this.options),Me)).debug;if(Ne&&console.time("preprocess data"),Me.maxZoom<0||Me.maxZoom>24)throw new Error("maxZoom should be in the 0-24 range");if(Me.promoteId&&Me.generateId)throw new Error("promoteId and generateId cannot be used together.");var rt=function(dt,vt){var Mt=[];if(dt.type==="FeatureCollection")for(var Pt=0;Pt<dt.features.length;Pt++)ui(Mt,dt.features[Pt],vt,Pt);else ui(Mt,dt.type==="Feature"?dt:{geometry:dt},vt);return Mt}(Ke,Me);this.tiles={},this.tileCoords=[],Ne&&(console.timeEnd("preprocess data"),console.log("index: maxZoom: %d, maxPoints: %d",Me.indexMaxZoom,Me.indexMaxPoints),console.time("generate tiles"),this.stats={},this.total=0),rt=function(dt,vt){var Mt=vt.buffer/vt.extent,Pt=dt,St=Qr(dt,1,-1-Mt,Mt,0,-1,2,vt),Wt=Qr(dt,1,1-Mt,2+Mt,0,-1,2,vt);return(St||Wt)&&(Pt=Qr(dt,1,-Mt,1+Mt,0,-1,2,vt)||[],St&&(Pt=Se(St,1).concat(Pt)),Wt&&(Pt=Pt.concat(Se(Wt,-1)))),Pt}(rt,Me),rt.length&&this.splitTile(rt,0,0,0),Ne&&(rt.length&&console.log("features: %d, points: %d",this.tiles[0].numFeatures,this.tiles[0].numPoints),console.timeEnd("generate tiles"),console.log("tiles generated:",this.total,JSON.stringify(this.stats)))}function xt(Ke,Me,Ne){return 32*((1<<Ke)*Ne+Me)+Ke}function Ct(Ke,Me){const Ne=Ke.tileID.canonical;if(!this._geoJSONIndex)return Me(null,null);const rt=this._geoJSONIndex.getTile(Ne.z,Ne.x,Ne.y);if(!rt)return Me(null,null);const dt=new class{constructor(Mt){this.layers={_geojsonTileLayer:this},this.name="_geojsonTileLayer",this.extent=t.EXTENT,this.length=Mt.length,this._features=Mt}feature(Mt){return new class{constructor(Pt){this._feature=Pt,this.extent=t.EXTENT,this.type=Pt.type,this.properties=Pt.tags,"id"in Pt&&!isNaN(Pt.id)&&(this.id=parseInt(Pt.id,10))}loadGeometry(){if(this._feature.type===1){const Pt=[];for(const St of this._feature.geometry)Pt.push([new t.Point(St[0],St[1])]);return Pt}{const Pt=[];for(const St of this._feature.geometry){const Wt=[];for(const br of St)Wt.push(new t.Point(br[0],br[1]));Pt.push(Wt)}return Pt}}toGeoJSON(Pt,St,Wt){return De.call(this,Pt,St,Wt)}}(this._features[Mt])}}(rt.features);let vt=ft(dt);vt.byteOffset===0&&vt.byteLength===vt.buffer.byteLength||(vt=new Uint8Array(vt)),Me(null,{vectorTile:dt,rawData:vt.buffer})}Qt.prototype.options={maxZoom:14,indexMaxZoom:5,indexMaxPoints:1e5,tolerance:3,extent:4096,buffer:64,lineMetrics:!1,promoteId:null,generateId:!1,debug:0},Qt.prototype.splitTile=function(Ke,Me,Ne,rt,dt,vt,Mt){for(var Pt=[Ke,Me,Ne,rt],St=this.options,Wt=St.debug;Pt.length;){rt=Pt.pop(),Ne=Pt.pop(),Me=Pt.pop(),Ke=Pt.pop();var br=1<<Me,Ar=xt(Me,Ne,rt),cr=this.tiles[Ar];if(!cr&&(Wt>1&&console.time("creation"),cr=this.tiles[Ar]=gt(Ke,Me,Ne,rt,St),this.tileCoords.push({z:Me,x:Ne,y:rt}),Wt)){Wt>1&&(console.log("tile z%d-%d-%d (features: %d, points: %d, simplified: %d)",Me,Ne,rt,cr.numFeatures,cr.numPoints,cr.numSimplified),console.timeEnd("creation"));var ti="z"+Me;this.stats[ti]=(this.stats[ti]||0)+1,this.total++}if(cr.source=Ke,dt){if(Me===St.maxZoom||Me===dt)continue;var ci=1<<dt-Me;if(Ne!==Math.floor(vt/ci)||rt!==Math.floor(Mt/ci))continue}else if(Me===St.indexMaxZoom||cr.numPoints<=St.indexMaxPoints)continue;if(cr.source=null,Ke.length!==0){Wt>1&&console.time("clipping");var ni,oi,yi,Ai,wi,Mi,Hi=.5*St.buffer/St.extent,qn=.5-Hi,Gt=.5+Hi,fr=1+Hi;ni=oi=yi=Ai=null,wi=Qr(Ke,br,Ne-Hi,Ne+Gt,0,cr.minX,cr.maxX,St),Mi=Qr(Ke,br,Ne+qn,Ne+fr,0,cr.minX,cr.maxX,St),Ke=null,wi&&(ni=Qr(wi,br,rt-Hi,rt+Gt,1,cr.minY,cr.maxY,St),oi=Qr(wi,br,rt+qn,rt+fr,1,cr.minY,cr.maxY,St),wi=null),Mi&&(yi=Qr(Mi,br,rt-Hi,rt+Gt,1,cr.minY,cr.maxY,St),Ai=Qr(Mi,br,rt+qn,rt+fr,1,cr.minY,cr.maxY,St),Mi=null),Wt>1&&console.timeEnd("clipping"),Pt.push(ni||[],Me+1,2*Ne,2*rt),Pt.push(oi||[],Me+1,2*Ne,2*rt+1),Pt.push(yi||[],Me+1,2*Ne+1,2*rt),Pt.push(Ai||[],Me+1,2*Ne+1,2*rt+1)}}},Qt.prototype.getTile=function(Ke,Me,Ne){var rt=this.options,dt=rt.extent,vt=rt.debug;if(Ke<0||Ke>24)return null;var Mt=1<<Ke,Pt=xt(Ke,Me=(Me%Mt+Mt)%Mt,Ne);if(this.tiles[Pt])return Ve(this.tiles[Pt],dt);vt>1&&console.log("drilling down to z%d-%d-%d",Ke,Me,Ne);for(var St,Wt=Ke,br=Me,Ar=Ne;!St&&Wt>0;)Wt--,br=Math.floor(br/2),Ar=Math.floor(Ar/2),St=this.tiles[xt(Wt,br,Ar)];return St&&St.source?(vt>1&&console.log("found parent tile z%d-%d-%d",Wt,br,Ar),vt>1&&console.time("drilling down"),this.splitTile(St.source,Wt,br,Ar,Ke,Me,Ne),vt>1&&console.timeEnd("drilling down"),this.tiles[Pt]?Ve(this.tiles[Pt],dt):null):null};class Nt extends t.VectorTileWorkerSource{constructor(Me,Ne,rt,dt,vt){super(Me,Ne,rt,dt,Ct),vt&&(this.loadGeoJSON=vt)}loadData(Me,Ne){const rt=Me&&Me.request,dt=rt&&rt.collectResourceTiming;this.loadGeoJSON(Me,(vt,Mt)=>{if(vt||!Mt)return Ne(vt);if(typeof Mt!="object")return Ne(new Error(`Input data given to '${Me.source}' is not a valid GeoJSON object.`));{Re(Mt,!0);try{if(Me.filter){const St=t.createExpression(Me.filter,{type:"boolean","property-type":"data-driven",overridable:!1,transition:!1});if(St.result==="error")throw new Error(St.value.map(br=>`${br.key}: ${br.message}`).join(", "));Mt={type:"FeatureCollection",features:Mt.features.filter(br=>St.value.evaluate({zoom:0},br))}}this._geoJSONIndex=Me.cluster?new lr(function({superclusterOptions:St,clusterProperties:Wt}){if(!Wt||!St)return St;const br={},Ar={},cr={accumulated:null,zoom:0},ti={properties:null},ci=Object.keys(Wt);for(const ni of ci){const[oi,yi]=Wt[ni],Ai=t.createExpression(yi),wi=t.createExpression(typeof oi=="string"?[oi,["accumulated"],["get",ni]]:oi);br[ni]=Ai.value,Ar[ni]=wi.value}return St.map=ni=>{ti.properties=ni;const oi={};for(const yi of ci)oi[yi]=br[yi].evaluate(cr,ti);return oi},St.reduce=(ni,oi)=>{ti.properties=oi;for(const yi of ci)cr.accumulated=ni[yi],ni[yi]=Ar[yi].evaluate(cr,ti)},St}(Me)).load(Mt.features):function(St,Wt){return new Qt(St,Wt)}(Mt,Me.geojsonVtOptions)}catch(St){return Ne(St)}this.loaded={};const Pt={};if(dt){const St=t.getPerformanceMeasurement(rt);St&&(Pt.resourceTiming={},Pt.resourceTiming[Me.source]=JSON.parse(JSON.stringify(St)))}Ne(null,Pt)}})}reloadTile(Me,Ne){const rt=this.loaded;return rt&&rt[Me.uid]?super.reloadTile(Me,Ne):this.loadTile(Me,Ne)}loadGeoJSON(Me,Ne){if(Me.request)t.getJSON(Me.request,Ne);else{if(typeof Me.data!="string")return Ne(new Error(`Input data given to '${Me.source}' is not a valid GeoJSON object.`));try{return Ne(null,JSON.parse(Me.data))}catch{return Ne(new Error(`Input data given to '${Me.source}' is not a valid GeoJSON object.`))}}}getClusterExpansionZoom(Me,Ne){try{Ne(null,this._geoJSONIndex.getClusterExpansionZoom(Me.clusterId))}catch(rt){Ne(rt)}}getClusterChildren(Me,Ne){try{Ne(null,this._geoJSONIndex.getChildren(Me.clusterId))}catch(rt){Ne(rt)}}getClusterLeaves(Me,Ne){try{Ne(null,this._geoJSONIndex.getLeaves(Me.clusterId,Me.limit,Me.offset))}catch(rt){Ne(rt)}}}class dr{constructor(Me){this.self=Me,this.actor=new t.Actor(Me,this),this.layerIndexes={},this.availableImages={},this.isSpriteLoaded={},this.projections={},this.defaultProjection=t.getProjection({name:"mercator"}),this.workerSourceTypes={vector:t.VectorTileWorkerSource,geojson:Nt},this.workerSources={},this.demWorkerSources={},this.self.registerWorkerSource=(Ne,rt)=>{if(this.workerSourceTypes[Ne])throw new Error(`Worker source with name "${Ne}" already registered.`);this.workerSourceTypes[Ne]=rt},this.self.registerRTLTextPlugin=Ne=>{if(t.plugin.isParsed())throw new Error("RTL text plugin already registered.");t.plugin.applyArabicShaping=Ne.applyArabicShaping,t.plugin.processBidirectionalText=Ne.processBidirectionalText,t.plugin.processStyledBidirectionalText=Ne.processStyledBidirectionalText}}clearCaches(Me,Ne,rt){delete this.layerIndexes[Me],delete this.availableImages[Me],delete this.workerSources[Me],delete this.demWorkerSources[Me],rt()}checkIfReady(Me,Ne,rt){rt()}setReferrer(Me,Ne){this.referrer=Ne}spriteLoaded(Me,Ne){this.isSpriteLoaded[Me]=Ne;for(const rt in this.workerSources[Me]){const dt=this.workerSources[Me][rt];for(const vt in dt)dt[vt]instanceof t.VectorTileWorkerSource&&(dt[vt].isSpriteLoaded=Ne,dt[vt].fire(new t.Event("isSpriteLoaded")))}}setImages(Me,Ne,rt){this.availableImages[Me]=Ne;for(const dt in this.workerSources[Me]){const vt=this.workerSources[Me][dt];for(const Mt in vt)vt[Mt].availableImages=Ne}rt()}enableTerrain(Me,Ne,rt){this.terrain=Ne,rt()}setProjection(Me,Ne){this.projections[Me]=t.getProjection(Ne)}setLayers(Me,Ne,rt){this.getLayerIndex(Me).replace(Ne),rt()}updateLayers(Me,Ne,rt){this.getLayerIndex(Me).update(Ne.layers,Ne.removedIds),rt()}loadTile(Me,Ne,rt){const dt=this.enableTerrain?t.extend({enableTerrain:this.terrain},Ne):Ne;dt.projection=this.projections[Me]||this.defaultProjection,this.getWorkerSource(Me,Ne.type,Ne.source).loadTile(dt,rt)}loadDEMTile(Me,Ne,rt){const dt=this.enableTerrain?t.extend({buildQuadTree:this.terrain},Ne):Ne;this.getDEMWorkerSource(Me,Ne.source).loadTile(dt,rt)}reloadTile(Me,Ne,rt){const dt=this.enableTerrain?t.extend({enableTerrain:this.terrain},Ne):Ne;dt.projection=this.projections[Me]||this.defaultProjection,this.getWorkerSource(Me,Ne.type,Ne.source).reloadTile(dt,rt)}abortTile(Me,Ne,rt){this.getWorkerSource(Me,Ne.type,Ne.source).abortTile(Ne,rt)}removeTile(Me,Ne,rt){this.getWorkerSource(Me,Ne.type,Ne.source).removeTile(Ne,rt)}removeSource(Me,Ne,rt){if(!this.workerSources[Me]||!this.workerSources[Me][Ne.type]||!this.workerSources[Me][Ne.type][Ne.source])return;const dt=this.workerSources[Me][Ne.type][Ne.source];delete this.workerSources[Me][Ne.type][Ne.source],dt.removeSource!==void 0?dt.removeSource(Ne,rt):rt()}loadWorkerSource(Me,Ne,rt){try{this.self.importScripts(Ne.url),rt()}catch(dt){rt(dt.toString())}}syncRTLPluginState(Me,Ne,rt){try{t.plugin.setState(Ne);const dt=t.plugin.getPluginURL();if(t.plugin.isLoaded()&&!t.plugin.isParsed()&&dt!=null){this.self.importScripts(dt);const vt=t.plugin.isParsed();rt(vt?void 0:new Error(`RTL Text Plugin failed to import scripts from ${dt}`),vt)}}catch(dt){rt(dt.toString())}}getAvailableImages(Me){let Ne=this.availableImages[Me];return Ne||(Ne=[]),Ne}getLayerIndex(Me){let Ne=this.layerIndexes[Me];return Ne||(Ne=this.layerIndexes[Me]=new he),Ne}getWorkerSource(Me,Ne,rt){if(this.workerSources[Me]||(this.workerSources[Me]={}),this.workerSources[Me][Ne]||(this.workerSources[Me][Ne]={}),!this.workerSources[Me][Ne][rt]){const dt={send:(vt,Mt,Pt,St,Wt,br)=>{this.actor.send(vt,Mt,Pt,Me,Wt,br)},scheduler:this.actor.scheduler};this.workerSources[Me][Ne][rt]=new this.workerSourceTypes[Ne](dt,this.getLayerIndex(Me),this.getAvailableImages(Me),this.isSpriteLoaded[Me])}return this.workerSources[Me][Ne][rt]}getDEMWorkerSource(Me,Ne){return this.demWorkerSources[Me]||(this.demWorkerSources[Me]={}),this.demWorkerSources[Me][Ne]||(this.demWorkerSources[Me][Ne]=new _e),this.demWorkerSources[Me][Ne]}enforceCacheSizeLimit(Me,Ne){t.enforceCacheSizeLimit(Ne)}getWorkerPerformanceMetrics(Me,Ne,rt){rt(void 0,void 0)}}return typeof WorkerGlobalScope<"u"&&typeof self<"u"&&self instanceof WorkerGlobalScope&&(self.worker=new dr(self)),dr}),se(["./shared"],function(t){function H(J,G){if(Array.isArray(J)){if(!Array.isArray(G)||J.length!==G.length)return!1;for(let Z=0;Z<J.length;Z++)if(!H(J[Z],G[Z]))return!1;return!0}if(typeof J=="object"&&J!==null&&G!==null){if(typeof G!="object"||Object.keys(J).length!==Object.keys(G).length)return!1;for(const Z in J)if(!H(J[Z],G[Z]))return!1;return!0}return J===G}var ae=he;function he(J){return!function(G){return typeof window>"u"||typeof document>"u"?"not a browser":Array.prototype&&Array.prototype.every&&Array.prototype.filter&&Array.prototype.forEach&&Array.prototype.indexOf&&Array.prototype.lastIndexOf&&Array.prototype.map&&Array.prototype.some&&Array.prototype.reduce&&Array.prototype.reduceRight&&Array.isArray?Function.prototype&&Function.prototype.bind?Object.keys&&Object.create&&Object.getPrototypeOf&&Object.getOwnPropertyNames&&Object.isSealed&&Object.isFrozen&&Object.isExtensible&&Object.getOwnPropertyDescriptor&&Object.defineProperty&&Object.defineProperties&&Object.seal&&Object.freeze&&Object.preventExtensions?"JSON"in window&&"parse"in JSON&&"stringify"in JSON?function(){if(!("Worker"in window&&"Blob"in window&&"URL"in window))return!1;var re,le,de=new Blob([""],{type:"text/javascript"}),me=URL.createObjectURL(de);try{le=new Worker(me),re=!0}catch{re=!1}return le&&le.terminate(),URL.revokeObjectURL(me),re}()?"Uint8ClampedArray"in window?ArrayBuffer.isView?function(){var re=document.createElement("canvas");re.width=re.height=1;var le=re.getContext("2d");if(!le)return!1;var de=le.getImageData(0,0,1,1);return de&&de.width===re.width}()?(_e[Z=G&&G.failIfMajorPerformanceCaveat]===void 0&&(_e[Z]=function(re){var le,de=function(me){var ye=document.createElement("canvas"),be=Object.create(he.webGLContextAttributes);return be.failIfMajorPerformanceCaveat=me,ye.getContext("webgl",be)||ye.getContext("experimental-webgl",be)}(re);if(!de)return!1;try{le=de.createShader(de.VERTEX_SHADER)}catch{return!1}return!(!le||de.isContextLost())&&(de.shaderSource(le,"void main() {}"),de.compileShader(le),de.getShaderParameter(le,de.COMPILE_STATUS)===!0)}(Z)),_e[Z]?document.documentMode?"insufficient ECMAScript 6 support":void 0:"insufficient WebGL support"):"insufficient Canvas/getImageData support":"insufficient ArrayBuffer support":"insufficient Uint8ClampedArray support":"insufficient worker support":"insufficient JSON support":"insufficient Object support":"insufficient Function support":"insufficent Array support";var Z}(J)}var _e={};function ge(J,G,Z){const re=t.window.document.createElement(J);return G!==void 0&&(re.className=G),Z&&Z.appendChild(re),re}function xe(J,G,Z){const re=t.window.document.createElementNS("http://www.w3.org/2000/svg",J);for(const le of Object.keys(G))re.setAttributeNS(null,le,G[le]);return Z&&Z.appendChild(re),re}he.webGLContextAttributes={antialias:!1,alpha:!0,stencil:!0,depth:!0};const Re=t.window.document&&t.window.document.documentElement.style,De=Re&&Re.userSelect!==void 0?"userSelect":"WebkitUserSelect";let Ie;function Ce(){Re&&De&&(Ie=Re[De],Re[De]="none")}function Ue(){Re&&De&&(Re[De]=Ie)}function Le(J){J.preventDefault(),J.stopPropagation(),t.window.removeEventListener("click",Le,!0)}function ke(){t.window.addEventListener("click",Le,!0),t.window.setTimeout(()=>{t.window.removeEventListener("click",Le,!0)},0)}function Ge(J,G){const Z=J.getBoundingClientRect();return et(J,Z,G)}function Ze(J,G){const Z=J.getBoundingClientRect(),re=[];for(let le=0;le<G.length;le++)re.push(et(J,Z,G[le]));return re}function We(J){return t.window.InstallTrigger!==void 0&&J.button===2&&J.ctrlKey&&t.window.navigator.platform.toUpperCase().indexOf("MAC")>=0?0:J.button}function et(J,G,Z){const re=J.offsetWidth===G.width?1:J.offsetWidth/G.width;return new t.Point((Z.clientX-G.left)*re,(Z.clientY-G.top)*re)}function He(J,G){var Z=G[0],re=G[1],le=G[2],de=G[3],me=Z*de-le*re;return me?(J[0]=de*(me=1/me),J[1]=-re*me,J[2]=-le*me,J[3]=Z*me,J):null}function ht(J){const{userImage:G}=J;return!!(G&&G.render&&G.render())&&(J.data.replace(new Uint8Array(G.data.buffer)),!0)}class _t extends t.Evented{constructor(){super(),this.images={},this.updatedImages={},this.callbackDispatchedThisFrame={},this.loaded=!1,this.requestors=[],this.patterns={},this.atlasImage=new t.RGBAImage({width:1,height:1}),this.dirty=!0}isLoaded(){return this.loaded}setLoaded(G){if(this.loaded!==G&&(this.loaded=G,G)){for(const{ids:Z,callback:re}of this.requestors)this._notify(Z,re);this.requestors=[]}}hasImage(G){return!!this.getImage(G)}getImage(G){return this.images[G]}addImage(G,Z){this._validate(G,Z)&&(this.images[G]=Z)}_validate(G,Z){let re=!0;return this._validateStretch(Z.stretchX,Z.data&&Z.data.width)||(this.fire(new t.ErrorEvent(new Error(`Image "${G}" has invalid "stretchX" value`))),re=!1),this._validateStretch(Z.stretchY,Z.data&&Z.data.height)||(this.fire(new t.ErrorEvent(new Error(`Image "${G}" has invalid "stretchY" value`))),re=!1),this._validateContent(Z.content,Z)||(this.fire(new t.ErrorEvent(new Error(`Image "${G}" has invalid "content" value`))),re=!1),re}_validateStretch(G,Z){if(!G)return!0;let re=0;for(const le of G){if(le[0]<re||le[1]<le[0]||Z<le[1])return!1;re=le[1]}return!0}_validateContent(G,Z){return!(G&&(G.length!==4||G[0]<0||Z.data.width<G[0]||G[1]<0||Z.data.height<G[1]||G[2]<0||Z.data.width<G[2]||G[3]<0||Z.data.height<G[3]||G[2]<G[0]||G[3]<G[1]))}updateImage(G,Z){Z.version=this.images[G].version+1,this.images[G]=Z,this.updatedImages[G]=!0}removeImage(G){const Z=this.images[G];delete this.images[G],delete this.patterns[G],Z.userImage&&Z.userImage.onRemove&&Z.userImage.onRemove()}listImages(){return Object.keys(this.images)}getImages(G,Z){let re=!0;if(!this.isLoaded())for(const le of G)this.images[le]||(re=!1);this.isLoaded()||re?this._notify(G,Z):this.requestors.push({ids:G,callback:Z})}_notify(G,Z){const re={};for(const le of G){this.images[le]||this.fire(new t.Event("styleimagemissing",{id:le}));const de=this.images[le];de?re[le]={data:de.data.clone(),pixelRatio:de.pixelRatio,sdf:de.sdf,version:de.version,stretchX:de.stretchX,stretchY:de.stretchY,content:de.content,hasRenderCallback:!!(de.userImage&&de.userImage.render)}:t.warnOnce(`Image "${le}" could not be loaded. Please make sure you have added the image with map.addImage() or a "sprite" property in your style. You can provide missing images by listening for the "styleimagemissing" map event.`)}Z(null,re)}getPixelSize(){const{width:G,height:Z}=this.atlasImage;return{width:G,height:Z}}getPattern(G){const Z=this.patterns[G],re=this.getImage(G);if(!re)return null;if(Z&&Z.position.version===re.version)return Z.position;if(Z)Z.position.version=re.version;else{const le={w:re.data.width+2,h:re.data.height+2,x:0,y:0},de=new t.ImagePosition(le,re);this.patterns[G]={bin:le,position:de}}return this._updatePatternAtlas(),this.patterns[G].position}bind(G){const Z=G.gl;this.atlasTexture?this.dirty&&(this.atlasTexture.update(this.atlasImage),this.dirty=!1):this.atlasTexture=new t.Texture(G,this.atlasImage,Z.RGBA),this.atlasTexture&&this.atlasTexture.bind(Z.LINEAR,Z.CLAMP_TO_EDGE)}_updatePatternAtlas(){const G=[];for(const de in this.patterns)G.push(this.patterns[de].bin);const{w:Z,h:re}=t.potpack(G),le=this.atlasImage;le.resize({width:Z||1,height:re||1});for(const de in this.patterns){const{bin:me}=this.patterns[de],ye=me.x+1,be=me.y+1,qe=this.images[de].data,Te=qe.width,Fe=qe.height;t.RGBAImage.copy(qe,le,{x:0,y:0},{x:ye,y:be},{width:Te,height:Fe}),t.RGBAImage.copy(qe,le,{x:0,y:Fe-1},{x:ye,y:be-1},{width:Te,height:1}),t.RGBAImage.copy(qe,le,{x:0,y:0},{x:ye,y:be+Fe},{width:Te,height:1}),t.RGBAImage.copy(qe,le,{x:Te-1,y:0},{x:ye-1,y:be},{width:1,height:Fe}),t.RGBAImage.copy(qe,le,{x:0,y:0},{x:ye+Te,y:be},{width:1,height:Fe})}this.dirty=!0}beginFrame(){this.callbackDispatchedThisFrame={}}dispatchRenderCallbacks(G){for(const Z of G){if(this.callbackDispatchedThisFrame[Z])continue;this.callbackDispatchedThisFrame[Z]=!0;const re=this.images[Z];ht(re)&&this.updateImage(Z,re)}}}const ut=new t.Properties({anchor:new t.DataConstantProperty(t.spec.light.anchor),position:new class{constructor(){this.specification=t.spec.light.position}possiblyEvaluate(J,G){return function([Z,re,le]){const de=t.degToRad(re+90),me=t.degToRad(le);return{x:Z*Math.cos(de)*Math.sin(me),y:Z*Math.sin(de)*Math.sin(me),z:Z*Math.cos(me),azimuthal:re,polar:le}}(J.expression.evaluate(G))}interpolate(J,G,Z){return{x:t.number(J.x,G.x,Z),y:t.number(J.y,G.y,Z),z:t.number(J.z,G.z,Z),azimuthal:t.number(J.azimuthal,G.azimuthal,Z),polar:t.number(J.polar,G.polar,Z)}}},color:new t.DataConstantProperty(t.spec.light.color),intensity:new t.DataConstantProperty(t.spec.light.intensity)});class yt extends t.Evented{constructor(G){super(),this._transitionable=new t.Transitionable(ut),this.setLight(G),this._transitioning=this._transitionable.untransitioned()}getLight(){return this._transitionable.serialize()}setLight(G,Z={}){if(!this._validate(t.validateLight,G,Z))for(const re in G){const le=G[re];t.endsWith(re,"-transition")?this._transitionable.setTransition(re.slice(0,-11),le):this._transitionable.setValue(re,le)}}updateTransitions(G){this._transitioning=this._transitionable.transitioned(G,this._transitioning)}hasTransition(){return this._transitioning.hasTransition()}recalculate(G){this.properties=this._transitioning.possiblyEvaluate(G)}_validate(G,Z,re){return(!re||re.validate!==!1)&&t.emitValidationErrors(this,G.call(t.validateStyle,t.extend({value:Z,style:{glyphs:!0,sprite:!0},styleSpec:t.spec})))}}const Lt=new t.Properties({source:new t.DataConstantProperty(t.spec.terrain.source),exaggeration:new t.DataConstantProperty(t.spec.terrain.exaggeration)});let Kt=class extends t.Evented{constructor(J,G){super(),this._transitionable=new t.Transitionable(Lt),this.set(J),this._transitioning=this._transitionable.untransitioned(),this.drapeRenderMode=G}get(){return this._transitionable.serialize()}set(J){for(const G in J){const Z=J[G];t.endsWith(G,"-transition")?this._transitionable.setTransition(G.slice(0,-11),Z):this._transitionable.setValue(G,Z)}}updateTransitions(J){this._transitioning=this._transitionable.transitioned(J,this._transitioning)}hasTransition(){return this._transitioning.hasTransition()}recalculate(J){this.properties=this._transitioning.possiblyEvaluate(J)}};function ft(J,G,Z,re){const le=t.smoothstep(45,65,Z),[de,me]=qt(J,re),ye=t.length(G);let be=1-Math.min(1,Math.exp((ye-de)/(me-de)*-6));return be*=be*be,be=Math.min(1,1.00747*be),be*le*J.alpha}function qt(J,G){const Z=.5/Math.tan(.5*G);return[J.range[0]+Z,J.range[1]+Z]}const nt=new t.Properties({range:new t.DataConstantProperty(t.spec.fog.range),color:new t.DataConstantProperty(t.spec.fog.color),"high-color":new t.DataConstantProperty(t.spec.fog["high-color"]),"space-color":new t.DataConstantProperty(t.spec.fog["space-color"]),"horizon-blend":new t.DataConstantProperty(t.spec.fog["horizon-blend"]),"star-intensity":new t.DataConstantProperty(t.spec.fog["star-intensity"])});class At extends t.Evented{constructor(G,Z){super(),this._transitionable=new t.Transitionable(nt),this.set(G),this._transitioning=this._transitionable.untransitioned(),this._transform=Z}get state(){const G=this._transform,Z=G.projection.name==="globe",re=t.globeToMercatorTransition(G.zoom),le=this.properties.get("range"),de=[.5,3];return{range:Z?[t.number(de[0],le[0],re),t.number(de[1],le[1],re)]:le,horizonBlend:this.properties.get("horizon-blend"),alpha:this.properties.get("color").a}}get(){return this._transitionable.serialize()}set(G,Z={}){if(!this._validate(t.validateFog,G,Z)){for(const re of Object.keys(t.spec.fog))G&&G[re]===void 0&&(G[re]=t.spec.fog[re].default);for(const re in G){const le=G[re];t.endsWith(re,"-transition")?this._transitionable.setTransition(re.slice(0,-11),le):this._transitionable.setValue(re,le)}}}getOpacity(G){if(!this._transform.projection.supportsFog)return 0;const Z=this.properties&&this.properties.get("color")||1;return(this._transform.projection.name==="globe"?1:t.smoothstep(45,65,G))*Z.a}getOpacityAtLatLng(G,Z){return this._transform.projection.supportsFog?function(re,le,de){const me=t.MercatorCoordinate.fromLngLat(le),ye=de.elevation?de.elevation.getAtPointOrZero(me):0,be=[me.x,me.y,ye];return t.transformMat4(be,be,de.mercatorFogMatrix),ft(re,be,de.pitch,de._fov)}(this.state,G,Z):0}getFovAdjustedRange(G){return this._transform.projection.supportsFog?qt(this.state,G):[0,1]}updateTransitions(G){this._transitioning=this._transitionable.transitioned(G,this._transitioning)}hasTransition(){return this._transitioning.hasTransition()}recalculate(G){this.properties=this._transitioning.possiblyEvaluate(G)}_validate(G,Z,re){return(!re||re.validate!==!1)&&t.emitValidationErrors(this,G.call(t.validateStyle,t.extend({value:Z,style:{glyphs:!0,sprite:!0},styleSpec:t.spec})))}}class wt{constructor(G,Z){this.workerPool=G,this.actors=[],this.currentActor=0,this.id=t.uniqueId();const re=this.workerPool.acquire(this.id);for(let le=0;le<re.length;le++){const de=new wt.Actor(re[le],Z,this.id);de.name=`Worker ${le}`,this.actors.push(de)}this.ready=!1,this.broadcast("checkIfReady",null,()=>{this.ready=!0})}broadcast(G,Z,re){t.asyncAll(this.actors,(le,de)=>{le.send(G,Z,de)},re=re||function(){})}getActor(){return this.currentActor=(this.currentActor+1)%this.actors.length,this.actors[this.currentActor]}remove(){this.actors.forEach(G=>{G.remove()}),this.actors=[],this.workerPool.release(this.id)}}function Ft(J,G,Z){return G*(t.EXTENT/(J.tileSize*Math.pow(2,Z-J.tileID.overscaledZ)))}wt.Actor=t.Actor;class er{constructor(G,Z,re,le){this.screenBounds=G,this.cameraPoint=Z,this._screenRaycastCache={},this._cameraRaycastCache={},this.isAboveHorizon=re,this.screenGeometry=this.bufferedScreenGeometry(0),this.screenGeometryMercator=this._bufferedScreenMercator(0,le)}static createFromScreenPoints(G,Z){let re,le;if(G instanceof t.Point||typeof G[0]=="number"){const de=t.Point.convert(G);re=[de],le=Z.isPointAboveHorizon(de)}else{const de=t.Point.convert(G[0]),me=t.Point.convert(G[1]);re=[de,me],le=t.polygonizeBounds(de,me).every(ye=>Z.isPointAboveHorizon(ye))}return new er(re,Z.getCameraPoint(),le,Z)}isPointQuery(){return this.screenBounds.length===1}bufferedScreenGeometry(G){return t.polygonizeBounds(this.screenBounds[0],this.screenBounds.length===1?this.screenBounds[0]:this.screenBounds[1],G)}bufferedCameraGeometry(G){const Z=this.screenBounds[0],re=this.screenBounds.length===1?this.screenBounds[0].add(new t.Point(1,1)):this.screenBounds[1],le=t.polygonizeBounds(Z,re,0,!1);return this.cameraPoint.y>re.y&&(this.cameraPoint.x>Z.x&&this.cameraPoint.x<re.x?le.splice(3,0,this.cameraPoint):this.cameraPoint.x>=re.x?le[2]=this.cameraPoint:this.cameraPoint.x<=Z.x&&(le[3]=this.cameraPoint)),t.bufferConvexPolygon(le,G)}bufferedCameraGeometryGlobe(G){const Z=this.screenBounds[0],re=this.screenBounds.length===1?this.screenBounds[0].add(new t.Point(1,1)):this.screenBounds[1],le=t.polygonizeBounds(Z,re,G),de=this.cameraPoint.clone();switch(3*((de.y>Z.y)+(de.y>re.y))+((de.x>Z.x)+(de.x>re.x))){case 0:le[0]=de,le[4]=de.clone();break;case 1:le.splice(1,0,de);break;case 2:le[1]=de;break;case 3:le.splice(4,0,de);break;case 5:le.splice(2,0,de);break;case 6:le[3]=de;break;case 7:le.splice(3,0,de);break;case 8:le[2]=de}return le}containsTile(G,Z,re,le=0){const de=G.queryPadding/Z._pixelsPerMercatorPixel+1,me=re?this._bufferedCameraMercator(de,Z):this._bufferedScreenMercator(de,Z);let ye=G.tileID.wrap+(me.unwrapped?le:0);const be=me.polygon.map(it=>t.getTilePoint(G.tileTransform,it,ye));if(!t.polygonIntersectsBox(be,0,0,t.EXTENT,t.EXTENT))return;ye=G.tileID.wrap+(this.screenGeometryMercator.unwrapped?le:0);const qe=this.screenGeometryMercator.polygon.map(it=>t.getTileVec3(G.tileTransform,it,ye)),Te=qe.map(it=>new t.Point(it[0],it[1])),Fe=Z.getFreeCameraOptions().position||new t.MercatorCoordinate(0,0,0),$e=t.getTileVec3(G.tileTransform,Fe,ye),Je=qe.map(it=>{const Be=t.sub(it,it,$e);return t.normalize(Be,Be),new t.Ray($e,Be)}),tt=Ft(G,1,Z.zoom)*Z._pixelsPerMercatorPixel;return{queryGeometry:this,tilespaceGeometry:Te,tilespaceRays:Je,bufferedTilespaceGeometry:be,bufferedTilespaceBounds:(Qe=t.getBounds(be),Qe.min.x=t.clamp(Qe.min.x,0,t.EXTENT),Qe.min.y=t.clamp(Qe.min.y,0,t.EXTENT),Qe.max.x=t.clamp(Qe.max.x,0,t.EXTENT),Qe.max.y=t.clamp(Qe.max.y,0,t.EXTENT),Qe),tile:G,tileID:G.tileID,pixelToTileUnitsFactor:tt};var Qe}_bufferedScreenMercator(G,Z){const re=Mr(G);if(this._screenRaycastCache[re])return this._screenRaycastCache[re];{let le;return le=Z.projection.name==="globe"?this._projectAndResample(this.bufferedScreenGeometry(G),Z):{polygon:this.bufferedScreenGeometry(G).map(de=>Z.pointCoordinate3D(de)),unwrapped:!0},this._screenRaycastCache[re]=le,le}}_bufferedCameraMercator(G,Z){const re=Mr(G);if(this._cameraRaycastCache[re])return this._cameraRaycastCache[re];{let le;return le=Z.projection.name==="globe"?this._projectAndResample(this.bufferedCameraGeometryGlobe(G),Z):{polygon:this.bufferedCameraGeometry(G).map(de=>Z.pointCoordinate3D(de)),unwrapped:!0},this._cameraRaycastCache[re]=le,le}}_projectAndResample(G,Z){const re=function(de,me){const ye=t.multiply([],me.pixelMatrix,me.globeMatrix),be=[0,-t.GLOBE_RADIUS,0,1],qe=[0,t.GLOBE_RADIUS,0,1],Te=[0,0,0,1];t.transformMat4$1(be,be,ye),t.transformMat4$1(qe,qe,ye),t.transformMat4$1(Te,Te,ye);const Fe=new t.Point(be[0]/be[3],be[1]/be[3]),$e=new t.Point(qe[0]/qe[3],qe[1]/qe[3]),Je=t.polygonContainsPoint(de,Fe)&&be[3]<Te[3],tt=t.polygonContainsPoint(de,$e)&&qe[3]<Te[3];if(!Je&&!tt)return null;const Qe=function(It,kt,Dt){for(let Vt=1;Vt<It.length;Vt++){const mr=jr(kt.pointCoordinate3D(It[Vt-1]).x),Bt=jr(kt.pointCoordinate3D(It[Vt]).x);if(Dt<0){if(mr<Bt)return{idx:Vt,t:-mr/(Bt-1-mr)}}else if(Bt<mr)return{idx:Vt,t:(1-mr)/(Bt+1-mr)}}return null}(de,me,Je?-1:1);if(!Qe)return null;const{idx:it,t:Be}=Qe;let Ye=it>1?lr(de.slice(0,it),me):[],lt=it<de.length?lr(de.slice(it),me):[];Ye=Ye.map(It=>new t.Point(jr(It.x),It.y)),lt=lt.map(It=>new t.Point(jr(It.x),It.y));const ct=[...Ye];ct.length===0&&ct.push(lt[lt.length-1]);const Tt=t.number(ct[ct.length-1].y,(lt.length===0?Ye[0]:lt[0]).y,Be);let Rt;return Rt=Je?[new t.Point(0,Tt),new t.Point(0,0),new t.Point(1,0),new t.Point(1,Tt)]:[new t.Point(1,Tt),new t.Point(1,1),new t.Point(0,1),new t.Point(0,Tt)],ct.push(...Rt),lt.length===0?ct.push(Ye[0]):ct.push(...lt),{polygon:ct.map(It=>new t.MercatorCoordinate(It.x,It.y)),unwrapped:!1}}(G,Z);if(re)return re;const le=function(de,me){let ye=!1,be=-1/0,qe=0;for(let Fe=0;Fe<de.length-1;Fe++)de[Fe].x>be&&(be=de[Fe].x,qe=Fe);for(let Fe=0;Fe<de.length-1;Fe++){const $e=(qe+Fe)%(de.length-1),Je=de[$e],tt=de[$e+1];Math.abs(Je.x-tt.x)>.5&&(Je.x<tt.x?(Je.x+=1,$e===0&&(de[de.length-1].x+=1)):(tt.x+=1,$e+1===de.length-1&&(de[0].x+=1)),ye=!0)}const Te=t.mercatorXfromLng(me.center.lng);return ye&&Te<Math.abs(Te-1)&&de.forEach(Fe=>{Fe.x-=1}),{polygon:de,unwrapped:ye}}(lr(G,Z).map(de=>new t.Point(jr(de.x),de.y)),Z);return{polygon:le.polygon.map(de=>new t.MercatorCoordinate(de.x,de.y)),unwrapped:le.unwrapped}}}function lr(J,G){return t.resample(J,Z=>{const re=G.pointCoordinate3D(Z);Z.x=re.x,Z.y=re.y},1/256)}function jr(J){return J<0?1+J%1:J%1}function Mr(J){return 100*J|0}function Lr(J,G,Z,re,le){const de=function(me,ye){if(me)return le(me);if(ye){J.url&&ye.tiles&&J.tiles&&delete J.tiles;const be=t.pick(t.extend(ye,J),["tiles","minzoom","maxzoom","attribution","mapbox_logo","bounds","scheme","tileSize","encoding"]);ye.vector_layers&&(be.vectorLayers=ye.vector_layers,be.vectorLayerIds=be.vectorLayers.map(qe=>qe.id)),be.tiles=G.canonicalizeTileset(be,J.url),le(null,be)}};return J.url?t.getJSON(G.transformRequest(G.normalizeSourceURL(J.url,null,Z,re),t.ResourceType.Source),de):t.exported.frame(()=>de(null,J))}class sr{constructor(G,Z,re){this.bounds=t.LngLatBounds.convert(this.validateBounds(G)),this.minzoom=Z||0,this.maxzoom=re||24}validateBounds(G){return Array.isArray(G)&&G.length===4?[Math.max(-180,G[0]),Math.max(-90,G[1]),Math.min(180,G[2]),Math.min(90,G[3])]:[-180,-90,180,90]}contains(G){const Z=Math.pow(2,G.z),re=Math.floor(t.mercatorXfromLng(this.bounds.getWest())*Z),le=Math.floor(t.mercatorYfromLat(this.bounds.getNorth())*Z),de=Math.ceil(t.mercatorXfromLng(this.bounds.getEast())*Z),me=Math.ceil(t.mercatorYfromLat(this.bounds.getSouth())*Z);return G.x>=re&&G.x<de&&G.y>=le&&G.y<me}}class Rr{constructor(G,Z,re){this.context=G;const le=G.gl;this.buffer=le.createBuffer(),this.dynamicDraw=!!re,this.context.unbindVAO(),G.bindElementBuffer.set(this.buffer),le.bufferData(le.ELEMENT_ARRAY_BUFFER,Z.arrayBuffer,this.dynamicDraw?le.DYNAMIC_DRAW:le.STATIC_DRAW),this.dynamicDraw||Z.destroy()}bind(){this.context.bindElementBuffer.set(this.buffer)}updateData(G){const Z=this.context.gl;this.context.unbindVAO(),this.bind(),Z.bufferSubData(Z.ELEMENT_ARRAY_BUFFER,0,G.arrayBuffer)}destroy(){this.buffer&&(this.context.gl.deleteBuffer(this.buffer),delete this.buffer)}}const Ur={Int8:"BYTE",Uint8:"UNSIGNED_BYTE",Int16:"SHORT",Uint16:"UNSIGNED_SHORT",Int32:"INT",Uint32:"UNSIGNED_INT",Float32:"FLOAT"};class Wr{constructor(G,Z,re,le){this.length=Z.length,this.attributes=re,this.itemSize=Z.bytesPerElement,this.dynamicDraw=le,this.context=G;const de=G.gl;this.buffer=de.createBuffer(),G.bindVertexBuffer.set(this.buffer),de.bufferData(de.ARRAY_BUFFER,Z.arrayBuffer,this.dynamicDraw?de.DYNAMIC_DRAW:de.STATIC_DRAW),this.dynamicDraw||Z.destroy()}bind(){this.context.bindVertexBuffer.set(this.buffer)}updateData(G){const Z=this.context.gl;this.bind(),Z.bufferSubData(Z.ARRAY_BUFFER,0,G.arrayBuffer)}enableAttributes(G,Z){for(let re=0;re<this.attributes.length;re++){const le=Z.attributes[this.attributes[re].name];le!==void 0&&G.enableVertexAttribArray(le)}}setVertexAttribPointers(G,Z,re){for(let le=0;le<this.attributes.length;le++){const de=this.attributes[le],me=Z.attributes[de.name];me!==void 0&&G.vertexAttribPointer(me,de.components,G[Ur[de.type]],!1,this.itemSize,de.offset+this.itemSize*(re||0))}}destroy(){this.buffer&&(this.context.gl.deleteBuffer(this.buffer),delete this.buffer)}}class Er{constructor(G){this.gl=G.gl,this.default=this.getDefault(),this.current=this.default,this.dirty=!1}get(){return this.current}set(G){}getDefault(){return this.default}setDefault(){this.set(this.default)}}class Kr extends Er{getDefault(){return t.Color.transparent}set(G){const Z=this.current;(G.r!==Z.r||G.g!==Z.g||G.b!==Z.b||G.a!==Z.a||this.dirty)&&(this.gl.clearColor(G.r,G.g,G.b,G.a),this.current=G,this.dirty=!1)}}class ui extends Er{getDefault(){return 1}set(G){(G!==this.current||this.dirty)&&(this.gl.clearDepth(G),this.current=G,this.dirty=!1)}}class Ei extends Er{getDefault(){return 0}set(G){(G!==this.current||this.dirty)&&(this.gl.clearStencil(G),this.current=G,this.dirty=!1)}}class Hr extends Er{getDefault(){return[!0,!0,!0,!0]}set(G){const Z=this.current;(G[0]!==Z[0]||G[1]!==Z[1]||G[2]!==Z[2]||G[3]!==Z[3]||this.dirty)&&(this.gl.colorMask(G[0],G[1],G[2],G[3]),this.current=G,this.dirty=!1)}}class Br extends Er{getDefault(){return!0}set(G){(G!==this.current||this.dirty)&&(this.gl.depthMask(G),this.current=G,this.dirty=!1)}}class li extends Er{getDefault(){return 255}set(G){(G!==this.current||this.dirty)&&(this.gl.stencilMask(G),this.current=G,this.dirty=!1)}}class si extends Er{getDefault(){return{func:this.gl.ALWAYS,ref:0,mask:255}}set(G){const Z=this.current;(G.func!==Z.func||G.ref!==Z.ref||G.mask!==Z.mask||this.dirty)&&(this.gl.stencilFunc(G.func,G.ref,G.mask),this.current=G,this.dirty=!1)}}class Qr extends Er{getDefault(){const G=this.gl;return[G.KEEP,G.KEEP,G.KEEP]}set(G){const Z=this.current;(G[0]!==Z[0]||G[1]!==Z[1]||G[2]!==Z[2]||this.dirty)&&(this.gl.stencilOp(G[0],G[1],G[2]),this.current=G,this.dirty=!1)}}class _r extends Er{getDefault(){return!1}set(G){if(G===this.current&&!this.dirty)return;const Z=this.gl;G?Z.enable(Z.STENCIL_TEST):Z.disable(Z.STENCIL_TEST),this.current=G,this.dirty=!1}}class vr extends Er{getDefault(){return[0,1]}set(G){const Z=this.current;(G[0]!==Z[0]||G[1]!==Z[1]||this.dirty)&&(this.gl.depthRange(G[0],G[1]),this.current=G,this.dirty=!1)}}class Xr extends Er{getDefault(){return!1}set(G){if(G===this.current&&!this.dirty)return;const Z=this.gl;G?Z.enable(Z.DEPTH_TEST):Z.disable(Z.DEPTH_TEST),this.current=G,this.dirty=!1}}class Ir extends Er{getDefault(){return this.gl.LESS}set(G){(G!==this.current||this.dirty)&&(this.gl.depthFunc(G),this.current=G,this.dirty=!1)}}class Or extends Er{getDefault(){return!1}set(G){if(G===this.current&&!this.dirty)return;const Z=this.gl;G?Z.enable(Z.BLEND):Z.disable(Z.BLEND),this.current=G,this.dirty=!1}}class Nr extends Er{getDefault(){const G=this.gl;return[G.ONE,G.ZERO]}set(G){const Z=this.current;(G[0]!==Z[0]||G[1]!==Z[1]||this.dirty)&&(this.gl.blendFunc(G[0],G[1]),this.current=G,this.dirty=!1)}}class je extends Er{getDefault(){return t.Color.transparent}set(G){const Z=this.current;(G.r!==Z.r||G.g!==Z.g||G.b!==Z.b||G.a!==Z.a||this.dirty)&&(this.gl.blendColor(G.r,G.g,G.b,G.a),this.current=G,this.dirty=!1)}}class Se extends Er{getDefault(){return this.gl.FUNC_ADD}set(G){(G!==this.current||this.dirty)&&(this.gl.blendEquation(G),this.current=G,this.dirty=!1)}}class Oe extends Er{getDefault(){return!1}set(G){if(G===this.current&&!this.dirty)return;const Z=this.gl;G?Z.enable(Z.CULL_FACE):Z.disable(Z.CULL_FACE),this.current=G,this.dirty=!1}}class Ve extends Er{getDefault(){return this.gl.BACK}set(G){(G!==this.current||this.dirty)&&(this.gl.cullFace(G),this.current=G,this.dirty=!1)}}class st extends Er{getDefault(){return this.gl.CCW}set(G){(G!==this.current||this.dirty)&&(this.gl.frontFace(G),this.current=G,this.dirty=!1)}}let gt,Ot=class extends Er{getDefault(){return null}set(J){(J!==this.current||this.dirty)&&(this.gl.useProgram(J),this.current=J,this.dirty=!1)}};class tr extends Er{getDefault(){return this.gl.TEXTURE0}set(G){(G!==this.current||this.dirty)&&(this.gl.activeTexture(G),this.current=G,this.dirty=!1)}}class Qt extends Er{getDefault(){const G=this.gl;return[0,0,G.drawingBufferWidth,G.drawingBufferHeight]}set(G){const Z=this.current;(G[0]!==Z[0]||G[1]!==Z[1]||G[2]!==Z[2]||G[3]!==Z[3]||this.dirty)&&(this.gl.viewport(G[0],G[1],G[2],G[3]),this.current=G,this.dirty=!1)}}class xt extends Er{getDefault(){return null}set(G){if(G===this.current&&!this.dirty)return;const Z=this.gl;Z.bindFramebuffer(Z.FRAMEBUFFER,G),this.current=G,this.dirty=!1}}class Ct extends Er{getDefault(){return null}set(G){if(G===this.current&&!this.dirty)return;const Z=this.gl;Z.bindRenderbuffer(Z.RENDERBUFFER,G),this.current=G,this.dirty=!1}}class Nt extends Er{getDefault(){return null}set(G){if(G===this.current&&!this.dirty)return;const Z=this.gl;Z.bindTexture(Z.TEXTURE_2D,G),this.current=G,this.dirty=!1}}class dr extends Er{getDefault(){return null}set(G){if(G===this.current&&!this.dirty)return;const Z=this.gl;Z.bindBuffer(Z.ARRAY_BUFFER,G),this.current=G,this.dirty=!1}}class Ke extends Er{getDefault(){return null}set(G){const Z=this.gl;Z.bindBuffer(Z.ELEMENT_ARRAY_BUFFER,G),this.current=G,this.dirty=!1}}class Me extends Er{constructor(G){super(G),this.vao=G.extVertexArrayObject}getDefault(){return null}set(G){this.vao&&(G!==this.current||this.dirty)&&(this.vao.bindVertexArrayOES(G),this.current=G,this.dirty=!1)}}class Ne extends Er{getDefault(){return 4}set(G){if(G===this.current&&!this.dirty)return;const Z=this.gl;Z.pixelStorei(Z.UNPACK_ALIGNMENT,G),this.current=G,this.dirty=!1}}class rt extends Er{getDefault(){return!1}set(G){if(G===this.current&&!this.dirty)return;const Z=this.gl;Z.pixelStorei(Z.UNPACK_PREMULTIPLY_ALPHA_WEBGL,G),this.current=G,this.dirty=!1}}class dt extends Er{getDefault(){return!1}set(G){if(G===this.current&&!this.dirty)return;const Z=this.gl;Z.pixelStorei(Z.UNPACK_FLIP_Y_WEBGL,G),this.current=G,this.dirty=!1}}class vt extends Er{constructor(G,Z){super(G),this.context=G,this.parent=Z}getDefault(){return null}}class Mt extends vt{setDirty(){this.dirty=!0}set(G){if(G===this.current&&!this.dirty)return;this.context.bindFramebuffer.set(this.parent);const Z=this.gl;Z.framebufferTexture2D(Z.FRAMEBUFFER,Z.COLOR_ATTACHMENT0,Z.TEXTURE_2D,G,0),this.current=G,this.dirty=!1}}class Pt extends vt{attachment(){return this.gl.DEPTH_ATTACHMENT}set(G){if(G===this.current&&!this.dirty)return;this.context.bindFramebuffer.set(this.parent);const Z=this.gl;Z.framebufferRenderbuffer(Z.FRAMEBUFFER,this.attachment(),Z.RENDERBUFFER,G),this.current=G,this.dirty=!1}}class St extends Pt{attachment(){return this.gl.DEPTH_STENCIL_ATTACHMENT}}class Wt{constructor(G,Z,re,le){this.context=G,this.width=Z,this.height=re;const de=this.framebuffer=G.gl.createFramebuffer();this.colorAttachment=new Mt(G,de),le&&(this.depthAttachment=new Pt(G,de))}destroy(){const G=this.context.gl,Z=this.colorAttachment.get();if(Z&&G.deleteTexture(Z),this.depthAttachment){const re=this.depthAttachment.get();re&&G.deleteRenderbuffer(re)}G.deleteFramebuffer(this.framebuffer)}}class br{constructor(G,Z=!1){if(this.gl=G,this.isWebGL2=Z,this.extVertexArrayObject=this.gl.getExtension("OES_vertex_array_object"),Z){const re=G;this.extVertexArrayObject={createVertexArrayOES:re.createVertexArray.bind(G),deleteVertexArrayOES:re.deleteVertexArray.bind(G),bindVertexArrayOES:re.bindVertexArray.bind(G)}}this.clearColor=new Kr(this),this.clearDepth=new ui(this),this.clearStencil=new Ei(this),this.colorMask=new Hr(this),this.depthMask=new Br(this),this.stencilMask=new li(this),this.stencilFunc=new si(this),this.stencilOp=new Qr(this),this.stencilTest=new _r(this),this.depthRange=new vr(this),this.depthTest=new Xr(this),this.depthFunc=new Ir(this),this.blend=new Or(this),this.blendFunc=new Nr(this),this.blendColor=new je(this),this.blendEquation=new Se(this),this.cullFace=new Oe(this),this.cullFaceSide=new Ve(this),this.frontFace=new st(this),this.program=new Ot(this),this.activeTexture=new tr(this),this.viewport=new Qt(this),this.bindFramebuffer=new xt(this),this.bindRenderbuffer=new Ct(this),this.bindTexture=new Nt(this),this.bindVertexBuffer=new dr(this),this.bindElementBuffer=new Ke(this),this.bindVertexArrayOES=this.extVertexArrayObject&&new Me(this),this.pixelStoreUnpack=new Ne(this),this.pixelStoreUnpackPremultiplyAlpha=new rt(this),this.pixelStoreUnpackFlipY=new dt(this),this.extTextureFilterAnisotropic=G.getExtension("EXT_texture_filter_anisotropic")||G.getExtension("MOZ_EXT_texture_filter_anisotropic")||G.getExtension("WEBKIT_EXT_texture_filter_anisotropic"),this.extTextureFilterAnisotropic&&(this.extTextureFilterAnisotropicMax=G.getParameter(this.extTextureFilterAnisotropic.MAX_TEXTURE_MAX_ANISOTROPY_EXT)),this.extTextureFilterAnisotropicForceOff=!1,this.extStandardDerivativesForceOff=!1,this.extDebugRendererInfo=G.getExtension("WEBGL_debug_renderer_info"),this.extDebugRendererInfo&&(this.renderer=G.getParameter(this.extDebugRendererInfo.UNMASKED_RENDERER_WEBGL),this.vendor=G.getParameter(this.extDebugRendererInfo.UNMASKED_VENDOR_WEBGL)),Z||(this.extTextureHalfFloat=G.getExtension("OES_texture_half_float")),(Z||this.extTextureHalfFloat&&G.getExtension("OES_texture_half_float_linear"))&&(this.extRenderToTextureHalfFloat=G.getExtension("EXT_color_buffer_half_float")),this.extStandardDerivatives=Z||G.getExtension("OES_standard_derivatives"),this.extTimerQuery=G.getExtension("EXT_disjoint_timer_query"),this.maxTextureSize=G.getParameter(G.MAX_TEXTURE_SIZE)}setDefault(){this.unbindVAO(),this.clearColor.setDefault(),this.clearDepth.setDefault(),this.clearStencil.setDefault(),this.colorMask.setDefault(),this.depthMask.setDefault(),this.stencilMask.setDefault(),this.stencilFunc.setDefault(),this.stencilOp.setDefault(),this.stencilTest.setDefault(),this.depthRange.setDefault(),this.depthTest.setDefault(),this.depthFunc.setDefault(),this.blend.setDefault(),this.blendFunc.setDefault(),this.blendColor.setDefault(),this.blendEquation.setDefault(),this.cullFace.setDefault(),this.cullFaceSide.setDefault(),this.frontFace.setDefault(),this.program.setDefault(),this.activeTexture.setDefault(),this.bindFramebuffer.setDefault(),this.pixelStoreUnpack.setDefault(),this.pixelStoreUnpackPremultiplyAlpha.setDefault(),this.pixelStoreUnpackFlipY.setDefault()}setDirty(){this.clearColor.dirty=!0,this.clearDepth.dirty=!0,this.clearStencil.dirty=!0,this.colorMask.dirty=!0,this.depthMask.dirty=!0,this.stencilMask.dirty=!0,this.stencilFunc.dirty=!0,this.stencilOp.dirty=!0,this.stencilTest.dirty=!0,this.depthRange.dirty=!0,this.depthTest.dirty=!0,this.depthFunc.dirty=!0,this.blend.dirty=!0,this.blendFunc.dirty=!0,this.blendColor.dirty=!0,this.blendEquation.dirty=!0,this.cullFace.dirty=!0,this.cullFaceSide.dirty=!0,this.frontFace.dirty=!0,this.program.dirty=!0,this.activeTexture.dirty=!0,this.viewport.dirty=!0,this.bindFramebuffer.dirty=!0,this.bindRenderbuffer.dirty=!0,this.bindTexture.dirty=!0,this.bindVertexBuffer.dirty=!0,this.bindElementBuffer.dirty=!0,this.extVertexArrayObject&&(this.bindVertexArrayOES.dirty=!0),this.pixelStoreUnpack.dirty=!0,this.pixelStoreUnpackPremultiplyAlpha.dirty=!0,this.pixelStoreUnpackFlipY.dirty=!0}createIndexBuffer(G,Z){return new Rr(this,G,Z)}createVertexBuffer(G,Z,re){return new Wr(this,G,Z,re)}createRenderbuffer(G,Z,re){const le=this.gl,de=le.createRenderbuffer();return this.bindRenderbuffer.set(de),le.renderbufferStorage(le.RENDERBUFFER,G,Z,re),this.bindRenderbuffer.set(null),de}createFramebuffer(G,Z,re){return new Wt(this,G,Z,re)}clear({color:G,depth:Z,stencil:re}){const le=this.gl;let de=0;G&&(de|=le.COLOR_BUFFER_BIT,this.clearColor.set(G),this.colorMask.set([!0,!0,!0,!0])),Z!==void 0&&(de|=le.DEPTH_BUFFER_BIT,this.depthRange.set([0,1]),this.clearDepth.set(Z),this.depthMask.set(!0)),re!==void 0&&(de|=le.STENCIL_BUFFER_BIT,this.clearStencil.set(re),this.stencilMask.set(255)),le.clear(de)}setCullFace(G){G.enable===!1?this.cullFace.set(!1):(this.cullFace.set(!0),this.cullFaceSide.set(G.mode),this.frontFace.set(G.frontFace))}setDepthMode(G){G.func!==this.gl.ALWAYS||G.mask?(this.depthTest.set(!0),this.depthFunc.set(G.func),this.depthMask.set(G.mask),this.depthRange.set(G.range)):this.depthTest.set(!1)}setStencilMode(G){G.test.func!==this.gl.ALWAYS||G.mask?(this.stencilTest.set(!0),this.stencilMask.set(G.mask),this.stencilOp.set([G.fail,G.depthFail,G.pass]),this.stencilFunc.set({func:G.test.func,ref:G.ref,mask:G.test.mask})):this.stencilTest.set(!1)}setColorMode(G){H(G.blendFunction,t.ColorMode.Replace)?this.blend.set(!1):(this.blend.set(!0),this.blendFunc.set(G.blendFunction),this.blendColor.set(G.blendColor)),this.colorMask.set(G.mask)}unbindVAO(){this.extVertexArrayObject&&this.bindVertexArrayOES.set(null)}}class Ar extends t.Evented{constructor(G,Z,re,le){if(super(),this.id=G,this.dispatcher=re,this.type="vector",this.minzoom=0,this.maxzoom=22,this.scheme="xyz",this.tileSize=512,this.reparseOverscaled=!0,this.isTileClipped=!0,this._loaded=!1,t.extend(this,t.pick(Z,["url","scheme","tileSize","promoteId"])),this._options=t.extend({type:"vector"},Z),this._collectResourceTiming=Z.collectResourceTiming,this.tileSize!==512)throw new Error("vector tile sources must have a tileSize of 512");this.setEventedParent(le),this._tileWorkers={},this._deduped=new t.DedupedRequest}load(G){this._loaded=!1,this.fire(new t.Event("dataloading",{dataType:"source"}));const Z=Array.isArray(this.map._language)?this.map._language.join():this.map._language,re=this.map._worldview;this._tileJSONRequest=Lr(this._options,this.map._requestManager,Z,re,(le,de)=>{this._tileJSONRequest=null,this._loaded=!0,le?(Z&&console.warn(`Ensure that your requested language string is a valid BCP-47 code or list of codes. Found: ${Z}`),re&&re.length!==2&&console.warn(`Requested worldview strings must be a valid ISO alpha-2 code. Found: ${re}`),this.fire(new t.ErrorEvent(le))):de&&(t.extend(this,de),de.bounds&&(this.tileBounds=new sr(de.bounds,this.minzoom,this.maxzoom)),t.postTurnstileEvent(de.tiles,this.map._requestManager._customAccessToken),this.fire(new t.Event("data",{dataType:"source",sourceDataType:"metadata"})),this.fire(new t.Event("data",{dataType:"source",sourceDataType:"content"}))),G&&G(le)})}loaded(){return this._loaded}hasTile(G){return!this.tileBounds||this.tileBounds.contains(G.canonical)}onAdd(G){this.map=G,this.load()}reload(){this.cancelTileJSONRequest(),this.load(()=>this.map.style._clearSource(this.id))}setTiles(G){return this._options.tiles=G,this.reload(),this}setUrl(G){return this.url=G,this._options.url=G,this.reload(),this}onRemove(){this.cancelTileJSONRequest()}serialize(){return t.extend({},this._options)}loadTile(G,Z){const re=this.map._requestManager.normalizeTileURL(G.tileID.canonical.url(this.tiles,this.scheme)),le={request:this.map._requestManager.transformRequest(re,t.ResourceType.Tile),data:void 0,uid:G.uid,tileID:G.tileID,tileZoom:G.tileZoom,zoom:G.tileID.overscaledZ,tileSize:this.tileSize*G.tileID.overscaleFactor(),type:this.type,source:this.id,pixelRatio:t.exported.devicePixelRatio,showCollisionBoxes:this.map.showCollisionBoxes,promoteId:this.promoteId,isSymbolTile:G.isSymbolTile};if(le.request.collectResourceTiming=this._collectResourceTiming,G.actor&&G.state!=="expired")G.state==="loading"?G.reloadCallback=Z:G.request=G.actor.send("reloadTile",le,de.bind(this));else if(G.actor=this._tileWorkers[re]=this._tileWorkers[re]||this.dispatcher.getActor(),this.dispatcher.ready)G.request=G.actor.send("loadTile",le,de.bind(this),void 0,!0);else{const me=t.loadVectorTile.call({deduped:this._deduped},le,(ye,be)=>{ye||!be?de.call(this,ye):(le.data={cacheControl:be.cacheControl,expires:be.expires,rawData:be.rawData.slice(0)},G.actor&&G.actor.send("loadTile",le,de.bind(this),void 0,!0))},!0);G.request={cancel:me}}function de(me,ye){return delete G.request,G.aborted?Z(null):me&&me.status!==404?Z(me):(ye&&ye.resourceTiming&&(G.resourceTiming=ye.resourceTiming),this.map._refreshExpiredTiles&&ye&&G.setExpiryData(ye),G.loadVectorData(ye,this.map.painter),t.cacheEntryPossiblyAdded(this.dispatcher),Z(null),void(G.reloadCallback&&(this.loadTile(G,G.reloadCallback),G.reloadCallback=null)))}}abortTile(G){G.request&&(G.request.cancel(),delete G.request),G.actor&&G.actor.send("abortTile",{uid:G.uid,type:this.type,source:this.id})}unloadTile(G){G.unloadVectorData(),G.actor&&G.actor.send("removeTile",{uid:G.uid,type:this.type,source:this.id})}hasTransition(){return!1}afterUpdate(){this._tileWorkers={}}cancelTileJSONRequest(){this._tileJSONRequest&&(this._tileJSONRequest.cancel(),this._tileJSONRequest=null)}}class cr extends t.Evented{constructor(G,Z,re,le){super(),this.id=G,this.dispatcher=re,this.setEventedParent(le),this.type="raster",this.minzoom=0,this.maxzoom=22,this.roundZoom=!0,this.scheme="xyz",this.tileSize=512,this._loaded=!1,this._options=t.extend({type:"raster"},Z),t.extend(this,t.pick(Z,["url","scheme","tileSize"]))}load(G){this._loaded=!1,this.fire(new t.Event("dataloading",{dataType:"source"})),this._tileJSONRequest=Lr(this._options,this.map._requestManager,null,null,(Z,re)=>{this._tileJSONRequest=null,this._loaded=!0,Z?this.fire(new t.ErrorEvent(Z)):re&&(t.extend(this,re),re.bounds&&(this.tileBounds=new sr(re.bounds,this.minzoom,this.maxzoom)),t.postTurnstileEvent(re.tiles),this.fire(new t.Event("data",{dataType:"source",sourceDataType:"metadata"})),this.fire(new t.Event("data",{dataType:"source",sourceDataType:"content"}))),G&&G(Z)})}loaded(){return this._loaded}onAdd(G){this.map=G,this.load()}reload(){this.cancelTileJSONRequest(),this.load(()=>this.map.style._clearSource(this.id))}setTiles(G){return this._options.tiles=G,this.reload(),this}setUrl(G){return this.url=G,this._options.url=G,this.reload(),this}onRemove(){this.cancelTileJSONRequest()}serialize(){return t.extend({},this._options)}hasTile(G){return!this.tileBounds||this.tileBounds.contains(G.canonical)}loadTile(G,Z){const re=t.exported.devicePixelRatio>=2,le=this.map._requestManager.normalizeTileURL(G.tileID.canonical.url(this.tiles,this.scheme),re,this.tileSize);G.request=t.getImage(this.map._requestManager.transformRequest(le,t.ResourceType.Tile),(de,me,ye,be)=>(delete G.request,G.aborted?(G.state="unloaded",Z(null)):de?(G.state="errored",Z(de)):me?(this.map._refreshExpiredTiles&&G.setExpiryData({cacheControl:ye,expires:be}),G.setTexture(me,this.map.painter),G.state="loaded",t.cacheEntryPossiblyAdded(this.dispatcher),void Z(null)):Z(null)))}static loadTileData(G,Z,re){G.setTexture(Z,re)}static unloadTileData(G,Z){G.texture&&Z.saveTileTexture(G.texture)}abortTile(G,Z){G.request&&(G.request.cancel(),delete G.request),Z()}unloadTile(G,Z){G.texture&&this.map.painter.saveTileTexture(G.texture),Z()}hasTransition(){return!1}cancelTileJSONRequest(){this._tileJSONRequest&&(this._tileJSONRequest.cancel(),this._tileJSONRequest=null)}}function ti(J,G,Z,re,le,de,me,ye){const be=[J,Z,le,G,re,de,1,1,1],qe=[me,ye,1],Te=t.adjoint([],be),[Fe,$e,Je]=t.transformMat3(qe,qe,t.transpose(Te,Te));return t.multiply$1(be,[Fe,0,0,0,$e,0,0,0,Je],be)}class ci extends t.Evented{constructor(G,Z,re,le){super(),this.id=G,this.dispatcher=re,this.coordinates=Z.coordinates,this.type="image",this.minzoom=0,this.maxzoom=22,this.tileSize=512,this.tiles={},this._loaded=!1,this.setEventedParent(le),this.options=Z,this._dirty=!1}load(G,Z){this._loaded=Z||!1,this.fire(new t.Event("dataloading",{dataType:"source"})),this.url=this.options.url,this._imageRequest=t.getImage(this.map._requestManager.transformRequest(this.url,t.ResourceType.Image),(re,le)=>{if(this._imageRequest=null,this._loaded=!0,re)this.fire(new t.ErrorEvent(re));else if(le){const{HTMLImageElement:de}=t.window;this.image=le instanceof de?t.exported.getImageData(le):le,this._dirty=!0,this.width=this.image.width,this.height=this.image.height,G&&(this.coordinates=G),this._finishLoading()}})}loaded(){return this._loaded}updateImage(G){return this.image&&G.url?(this._imageRequest&&G.url!==this.options.url&&(this._imageRequest.cancel(),this._imageRequest=null),this.options.url=G.url,this.load(G.coordinates,this._loaded),this):this}_finishLoading(){this.map&&(this.setCoordinates(this.coordinates),this.fire(new t.Event("data",{dataType:"source",sourceDataType:"metadata"})))}onAdd(G){this.map=G,this.load()}onRemove(){this._imageRequest&&(this._imageRequest.cancel(),this._imageRequest=null),this.texture&&this.texture.destroy()}setCoordinates(G){this.coordinates=G,this._boundsArray=void 0;const Z=G.map(t.MercatorCoordinate.fromLngLat);return this.tileID=function(re){let le=1/0,de=1/0,me=-1/0,ye=-1/0;for(const Fe of re)le=Math.min(le,Fe.x),de=Math.min(de,Fe.y),me=Math.max(me,Fe.x),ye=Math.max(ye,Fe.y);const be=Math.max(me-le,ye-de),qe=Math.max(0,Math.floor(-Math.log(be)/Math.LN2)),Te=Math.pow(2,qe);return new t.CanonicalTileID(qe,Math.floor((le+me)/2*Te),Math.floor((de+ye)/2*Te))}(Z),this.minzoom=this.maxzoom=this.tileID.z,this.fire(new t.Event("data",{dataType:"source",sourceDataType:"content"})),this}_clear(){this._boundsArray=void 0}_prepareData(G){for(const be in this.tiles){const qe=this.tiles[be];qe.state!=="loaded"&&(qe.state="loaded",qe.texture=this.texture)}if(this._boundsArray)return;const Z=t.tileTransform(this.tileID,this.map.transform.projection),[re,le,de,me]=this.coordinates.map(be=>{const qe=Z.projection.project(be[0],be[1]);return t.getTilePoint(Z,qe)._round()});this.perspectiveTransform=function(be,qe,Te,Fe,$e,Je,tt,Qe,it,Be){const Ye=ti(0,0,be,0,0,qe,be,qe),lt=ti(Te,Fe,$e,Je,tt,Qe,it,Be);return t.multiply$1(lt,t.adjoint(Ye,Ye),lt),[lt[6]/lt[8]*be/t.EXTENT,lt[7]/lt[8]*qe/t.EXTENT]}(this.width,this.height,re.x,re.y,le.x,le.y,me.x,me.y,de.x,de.y);const ye=this._boundsArray=new t.StructArrayLayout4i8;ye.emplaceBack(re.x,re.y,0,0),ye.emplaceBack(le.x,le.y,t.EXTENT,0),ye.emplaceBack(me.x,me.y,0,t.EXTENT),ye.emplaceBack(de.x,de.y,t.EXTENT,t.EXTENT),this.boundsBuffer&&this.boundsBuffer.destroy(),this.boundsBuffer=G.createVertexBuffer(ye,t.boundsAttributes.members),this.boundsSegments=t.SegmentVector.simpleSegment(0,0,4,2)}prepare(){if(Object.keys(this.tiles).length===0||!this.image)return;const G=this.map.painter.context,Z=G.gl;this._dirty&&(this.texture?this.texture.update(this.image):(this.texture=new t.Texture(G,this.image,Z.RGBA),this.texture.bind(Z.LINEAR,Z.CLAMP_TO_EDGE)),this._dirty=!1),this._prepareData(G)}loadTile(G,Z){this.tileID&&this.tileID.equals(G.tileID.canonical)?(this.tiles[String(G.tileID.wrap)]=G,G.buckets={},Z(null)):(G.state="errored",Z(null))}serialize(){return{type:"image",url:this.options.url,coordinates:this.coordinates}}hasTransition(){return!1}}const ni={vector:Ar,raster:cr,"raster-dem":class extends cr{constructor(J,G,Z,re){super(J,G,Z,re),this.type="raster-dem",this.maxzoom=22,this._options=t.extend({type:"raster-dem"},G),this.encoding=G.encoding||"mapbox"}loadTile(J,G){const Z=this.map._requestManager.normalizeTileURL(J.tileID.canonical.url(this.tiles,this.scheme),!1,this.tileSize);function re(le,de){le&&(J.state="errored",G(le)),de&&(J.dem=de,J.dem.onDeserialize(),J.needsHillshadePrepare=!0,J.needsDEMTextureUpload=!0,J.state="loaded",G(null))}J.request=t.getImage(this.map._requestManager.transformRequest(Z,t.ResourceType.Tile),(function(le,de,me,ye){if(delete J.request,J.aborted)J.state="unloaded",G(null);else if(le)J.state="errored",G(le);else if(de){this.map._refreshExpiredTiles&&J.setExpiryData({cacheControl:me,expires:ye});const be=t.window.ImageBitmap&&de instanceof t.window.ImageBitmap&&(gt==null&&(gt=t.window.OffscreenCanvas&&new t.window.OffscreenCanvas(1,1).getContext("2d")&&typeof t.window.createImageBitmap=="function"),gt),qe=1-(de.width-t.prevPowerOfTwo(de.width))/2;qe<1||J.neighboringTiles||(J.neighboringTiles=this._getNeighboringTiles(J.tileID));const Te=be?de:t.exported.getImageData(de,qe),Fe={uid:J.uid,coord:J.tileID,source:this.id,rawImageData:Te,encoding:this.encoding,padding:qe};J.actor&&J.state!=="expired"||(J.actor=this.dispatcher.getActor(),J.actor.send("loadDEMTile",Fe,re.bind(this),void 0,!0))}}).bind(this))}_getNeighboringTiles(J){const G=J.canonical,Z=Math.pow(2,G.z),re=(G.x-1+Z)%Z,le=G.x===0?J.wrap-1:J.wrap,de=(G.x+1+Z)%Z,me=G.x+1===Z?J.wrap+1:J.wrap,ye={};return ye[new t.OverscaledTileID(J.overscaledZ,le,G.z,re,G.y).key]={backfilled:!1},ye[new t.OverscaledTileID(J.overscaledZ,me,G.z,de,G.y).key]={backfilled:!1},G.y>0&&(ye[new t.OverscaledTileID(J.overscaledZ,le,G.z,re,G.y-1).key]={backfilled:!1},ye[new t.OverscaledTileID(J.overscaledZ,J.wrap,G.z,G.x,G.y-1).key]={backfilled:!1},ye[new t.OverscaledTileID(J.overscaledZ,me,G.z,de,G.y-1).key]={backfilled:!1}),G.y+1<Z&&(ye[new t.OverscaledTileID(J.overscaledZ,le,G.z,re,G.y+1).key]={backfilled:!1},ye[new t.OverscaledTileID(J.overscaledZ,J.wrap,G.z,G.x,G.y+1).key]={backfilled:!1},ye[new t.OverscaledTileID(J.overscaledZ,me,G.z,de,G.y+1).key]={backfilled:!1}),ye}unloadTile(J){J.demTexture&&this.map.painter.saveTileTexture(J.demTexture),J.fbo&&(J.fbo.destroy(),delete J.fbo),J.dem&&delete J.dem,delete J.neighboringTiles,J.state="unloaded"}},geojson:class extends t.Evented{constructor(J,G,Z,re){super(),this.id=J,this.type="geojson",this.minzoom=0,this.maxzoom=18,this.tileSize=512,this.isTileClipped=!0,this.reparseOverscaled=!0,this._loaded=!1,this.actor=Z.getActor(),this.setEventedParent(re),this._data=G.data,this._options=t.extend({},G),this._collectResourceTiming=G.collectResourceTiming,G.maxzoom!==void 0&&(this.maxzoom=G.maxzoom),G.type&&(this.type=G.type),G.attribution&&(this.attribution=G.attribution),this.promoteId=G.promoteId;const le=t.EXTENT/this.tileSize;this.workerOptions=t.extend({source:this.id,cluster:G.cluster||!1,geojsonVtOptions:{buffer:(G.buffer!==void 0?G.buffer:128)*le,tolerance:(G.tolerance!==void 0?G.tolerance:.375)*le,extent:t.EXTENT,maxZoom:this.maxzoom,lineMetrics:G.lineMetrics||!1,generateId:G.generateId||!1},superclusterOptions:{maxZoom:G.clusterMaxZoom!==void 0?G.clusterMaxZoom:this.maxzoom-1,minPoints:Math.max(2,G.clusterMinPoints||2),extent:t.EXTENT,radius:(G.clusterRadius!==void 0?G.clusterRadius:50)*le,log:!1,generateId:G.generateId||!1},clusterProperties:G.clusterProperties,filter:G.filter},G.workerOptions)}onAdd(J){this.map=J,this.setData(this._data)}setData(J){return this._data=J,this._updateWorkerData(),this}getClusterExpansionZoom(J,G){return this.actor.send("geojson.getClusterExpansionZoom",{clusterId:J,source:this.id},G),this}getClusterChildren(J,G){return this.actor.send("geojson.getClusterChildren",{clusterId:J,source:this.id},G),this}getClusterLeaves(J,G,Z,re){return this.actor.send("geojson.getClusterLeaves",{source:this.id,clusterId:J,limit:G,offset:Z},re),this}_updateWorkerData(){if(this._pendingLoad)return void(this._coalesce=!0);this.fire(new t.Event("dataloading",{dataType:"source"})),this._loaded=!1;const J=t.extend({},this.workerOptions),G=this._data;typeof G=="string"?(J.request=this.map._requestManager.transformRequest(t.exported.resolveURL(G),t.ResourceType.Source),J.request.collectResourceTiming=this._collectResourceTiming):J.data=JSON.stringify(G),this._pendingLoad=this.actor.send(`${this.type}.loadData`,J,(Z,re)=>{if(this._loaded=!0,this._pendingLoad=null,Z)this.fire(new t.ErrorEvent(Z));else{const le={dataType:"source",sourceDataType:this._metadataFired?"content":"metadata"};this._collectResourceTiming&&re&&re.resourceTiming&&re.resourceTiming[this.id]&&(le.resourceTiming=re.resourceTiming[this.id]),this.fire(new t.Event("data",le)),this._metadataFired=!0}this._coalesce&&(this._updateWorkerData(),this._coalesce=!1)})}loaded(){return this._loaded}loadTile(J,G){const Z=J.actor?"reloadTile":"loadTile";J.actor=this.actor,J.request=this.actor.send(Z,{type:this.type,uid:J.uid,tileID:J.tileID,tileZoom:J.tileZoom,zoom:J.tileID.overscaledZ,maxZoom:this.maxzoom,tileSize:this.tileSize,source:this.id,pixelRatio:t.exported.devicePixelRatio,showCollisionBoxes:this.map.showCollisionBoxes,promoteId:this.promoteId},(re,le)=>(delete J.request,J.unloadVectorData(),J.aborted?G(null):re?G(re):(J.loadVectorData(le,this.map.painter,Z==="reloadTile"),G(null))),void 0,Z==="loadTile")}abortTile(J){J.request&&(J.request.cancel(),delete J.request),J.aborted=!0}unloadTile(J){J.unloadVectorData(),this.actor.send("removeTile",{uid:J.uid,type:this.type,source:this.id})}onRemove(){this._pendingLoad&&this._pendingLoad.cancel()}serialize(){return t.extend({},this._options,{type:this.type,data:this._data})}hasTransition(){return!1}},video:class extends ci{constructor(J,G,Z,re){super(J,G,Z,re),this.roundZoom=!0,this.type="video",this.options=G}load(){this._loaded=!1;const J=this.options;this.urls=[];for(const G of J.urls)this.urls.push(this.map._requestManager.transformRequest(G,t.ResourceType.Source).url);t.getVideo(this.urls,(G,Z)=>{this._loaded=!0,G?this.fire(new t.ErrorEvent(G)):Z&&(this.video=Z,this.video.loop=!0,this.video.setAttribute("playsinline",""),this.video.addEventListener("playing",()=>{this.map.triggerRepaint()}),this.map&&this.video.play(),this._finishLoading())})}pause(){this.video&&this.video.pause()}play(){this.video&&this.video.play()}seek(J){if(this.video){const G=this.video.seekable;J<G.start(0)||J>G.end(0)?this.fire(new t.ErrorEvent(new t.ValidationError(`sources.${this.id}`,null,`Playback for this video can be set only between the ${G.start(0)} and ${G.end(0)}-second mark.`))):this.video.currentTime=J}}getVideo(){return this.video}onAdd(J){this.map||(this.map=J,this.load(),this.video&&(this.video.play(),this.setCoordinates(this.coordinates)))}prepare(){if(Object.keys(this.tiles).length===0||this.video.readyState<2)return;const J=this.map.painter.context,G=J.gl;this.texture?this.video.paused||(this.texture.bind(G.LINEAR,G.CLAMP_TO_EDGE),G.texSubImage2D(G.TEXTURE_2D,0,0,0,G.RGBA,G.UNSIGNED_BYTE,this.video)):(this.texture=new t.Texture(J,this.video,G.RGBA),this.texture.bind(G.LINEAR,G.CLAMP_TO_EDGE),this.width=this.video.videoWidth,this.height=this.video.videoHeight),this._prepareData(J)}serialize(){return{type:"video",urls:this.urls,coordinates:this.coordinates}}hasTransition(){return this.video&&!this.video.paused}},image:ci,canvas:class extends ci{constructor(J,G,Z,re){super(J,G,Z,re),G.coordinates?Array.isArray(G.coordinates)&&G.coordinates.length===4&&!G.coordinates.some(le=>!Array.isArray(le)||le.length!==2||le.some(de=>typeof de!="number"))||this.fire(new t.ErrorEvent(new t.ValidationError(`sources.${J}`,null,'"coordinates" property must be an array of 4 longitude/latitude array pairs'))):this.fire(new t.ErrorEvent(new t.ValidationError(`sources.${J}`,null,'missing required property "coordinates"'))),G.animate&&typeof G.animate!="boolean"&&this.fire(new t.ErrorEvent(new t.ValidationError(`sources.${J}`,null,'optional "animate" property must be a boolean value'))),G.canvas?typeof G.canvas=="string"||G.canvas instanceof t.window.HTMLCanvasElement||this.fire(new t.ErrorEvent(new t.ValidationError(`sources.${J}`,null,'"canvas" must be either a string representing the ID of the canvas element from which to read, or an HTMLCanvasElement instance'))):this.fire(new t.ErrorEvent(new t.ValidationError(`sources.${J}`,null,'missing required property "canvas"'))),this.options=G,this.animate=G.animate===void 0||G.animate}load(){this._loaded=!0,this.canvas||(this.canvas=this.options.canvas instanceof t.window.HTMLCanvasElement?this.options.canvas:t.window.document.getElementById(this.options.canvas)),this.width=this.canvas.width,this.height=this.canvas.height,this._hasInvalidDimensions()?this.fire(new t.ErrorEvent(new Error("Canvas dimensions cannot be less than or equal to zero."))):(this.play=function(){this._playing=!0,this.map.triggerRepaint()},this.pause=function(){this._playing&&(this.prepare(),this._playing=!1)},this._finishLoading())}getCanvas(){return this.canvas}onAdd(J){this.map=J,this.load(),this.canvas&&this.animate&&this.play()}onRemove(){this.pause()}prepare(){let J=!1;if(this.canvas.width!==this.width&&(this.width=this.canvas.width,J=!0),this.canvas.height!==this.height&&(this.height=this.canvas.height,J=!0),this._hasInvalidDimensions()||Object.keys(this.tiles).length===0)return;const G=this.map.painter.context;this.texture?(J||this._playing)&&this.texture.update(this.canvas,{premultiply:!0}):this.texture=new t.Texture(G,this.canvas,G.gl.RGBA,{premultiply:!0}),this._prepareData(G)}serialize(){return{type:"canvas",coordinates:this.coordinates}}hasTransition(){return this._playing}_hasInvalidDimensions(){for(const J of[this.canvas.width,this.canvas.height])if(isNaN(J)||J<=0)return!0;return!1}},custom:class extends t.Evented{constructor(J,G,Z,re){super(),this.id=J,this.type="custom",this._dataType="raster",this._dispatcher=Z,this._implementation=G,this.setEventedParent(re),this.scheme="xyz",this.minzoom=0,this.maxzoom=22,this.tileSize=512,this._loaded=!1,this.roundZoom=!0,this._implementation||this.fire(new t.ErrorEvent(new Error(`Missing implementation for ${this.id} custom source`))),this._implementation.loadTile||this.fire(new t.ErrorEvent(new Error(`Missing loadTile implementation for ${this.id} custom source`))),this._implementation.bounds&&(this.tileBounds=new sr(this._implementation.bounds,this.minzoom,this.maxzoom)),G.update=this._update.bind(this),G.clearTiles=this._clearTiles.bind(this),G.coveringTiles=this._coveringTiles.bind(this),t.extend(this,t.pick(G,["dataType","scheme","minzoom","maxzoom","tileSize","attribution","minTileCacheSize","maxTileCacheSize"]))}serialize(){return t.pick(this,["type","scheme","minzoom","maxzoom","tileSize","attribution"])}load(){this._loaded=!0,this.fire(new t.Event("data",{dataType:"source",sourceDataType:"metadata"})),this.fire(new t.Event("data",{dataType:"source",sourceDataType:"content"}))}loaded(){return this._loaded}onAdd(J){this._map=J,this._loaded=!1,this.fire(new t.Event("dataloading",{dataType:"source"})),this._implementation.onAdd&&this._implementation.onAdd(J),this.load()}onRemove(J){this._implementation.onRemove&&this._implementation.onRemove(J)}hasTile(J){if(this._implementation.hasTile){const{x:G,y:Z,z:re}=J.canonical;return this._implementation.hasTile({x:G,y:Z,z:re})}return!this.tileBounds||this.tileBounds.contains(J.canonical)}loadTile(J,G){const{x:Z,y:re,z:le}=J.tileID.canonical,de=new t.window.AbortController;J.request=Promise.resolve(this._implementation.loadTile({x:Z,y:re,z:le},{signal:de.signal})).then((function(me){return delete J.request,J.aborted?(J.state="unloaded",G(null)):me===void 0?(J.state="errored",G(null)):me===null?(this.loadTileData(J,{width:this.tileSize,height:this.tileSize,data:null}),J.state="loaded",G(null)):function(ye){return ye instanceof t.window.ImageData||ye instanceof t.window.HTMLCanvasElement||ye instanceof t.window.ImageBitmap||ye instanceof t.window.HTMLImageElement}(me)?(this.loadTileData(J,me),J.state="loaded",void G(null)):(J.state="errored",G(new Error(`Can't infer data type for ${this.id}, only raster data supported at the moment`)))}).bind(this)).catch(me=>{me.code!==20&&(J.state="errored",G(me))}),J.request.cancel=()=>de.abort()}loadTileData(J,G){cr.loadTileData(J,G,this._map.painter)}unloadTileData(J){cr.unloadTileData(J,this._map.painter)}unloadTile(J,G){if(this.unloadTileData(J),this._implementation.unloadTile){const{x:Z,y:re,z:le}=J.tileID.canonical;this._implementation.unloadTile({x:Z,y:re,z:le})}G()}abortTile(J,G){J.request&&J.request.cancel&&(J.request.cancel(),delete J.request),G()}hasTransition(){return!1}_coveringTiles(){return this._map.transform.coveringTiles({tileSize:this.tileSize,minzoom:this.minzoom,maxzoom:this.maxzoom,roundZoom:this.roundZoom}).map(J=>({x:J.canonical.x,y:J.canonical.y,z:J.canonical.z}))}_clearTiles(){this._map.style._clearSource(this.id)}_update(){this.fire(new t.Event("data",{dataType:"source",sourceDataType:"content"}))}}},oi=function(J,G,Z,re){const le=new ni[G.type](J,G,Z,re);if(le.id!==J)throw new Error(`Expected Source id to be ${J} instead of ${le.id}`);return t.bindAll(["load","abort","unload","serialize","prepare"],le),le};function yi(J,G){const Z=t.identity([]);return t.scale(Z,Z,[.5*J.width,.5*-J.height,1]),t.translate(Z,Z,[1,-1,0]),t.multiply(Z,Z,J.calculateProjMatrix(G.toUnwrapped())),Float32Array.from(Z)}function Ai(J,G,Z,re,le,de,me,ye=!1){const be=J.tilesIn(re,me,ye);be.sort(Mi);const qe=[];for(const Fe of be)qe.push({wrappedTileID:Fe.tile.tileID.wrapped().key,queryResults:Fe.tile.queryRenderedFeatures(G,Z,J._state,Fe,le,de,yi(J.transform,Fe.tile.tileID),ye)});const Te=function(Fe){const $e={},Je={};for(const tt of Fe){const Qe=tt.queryResults,it=tt.wrappedTileID,Be=Je[it]=Je[it]||{};for(const Ye in Qe){const lt=Qe[Ye],ct=Be[Ye]=Be[Ye]||{},Tt=$e[Ye]=$e[Ye]||[];for(const Rt of lt)ct[Rt.featureIndex]||(ct[Rt.featureIndex]=!0,Tt.push(Rt))}}return $e}(qe);for(const Fe in Te)Te[Fe].forEach($e=>{const Je=$e.feature,tt=Je.layer;tt&&tt.type!=="background"&&tt.type!=="sky"&&(Je.source=tt.source,tt["source-layer"]&&(Je.sourceLayer=tt["source-layer"]),Je.state=Je.id!==void 0?J.getFeatureState(tt["source-layer"],Je.id):{})});return Te}function wi(J,G){const Z=J.getRenderableIds().map(de=>J.getTileByID(de)),re=[],le={};for(let de=0;de<Z.length;de++){const me=Z[de],ye=me.tileID.canonical.key;le[ye]||(le[ye]=!0,me.querySourceFeatures(re,G))}return re}function Mi(J,G){const Z=J.tileID,re=G.tileID;return Z.overscaledZ-re.overscaledZ||Z.canonical.y-re.canonical.y||Z.wrap-re.wrap||Z.canonical.x-re.canonical.x}function Hi(){return Io.workerClass!=null?new Io.workerClass:new t.window.Worker(Io.workerUrl)}const qn="mapboxgl_preloaded_worker_pool";class Gt{constructor(){this.active={}}acquire(G){if(!this.workers)for(this.workers=[];this.workers.length<Gt.workerCount;)this.workers.push(new Hi);return this.active[G]=!0,this.workers.slice()}release(G){delete this.active[G],this.numActive()===0&&(this.workers.forEach(Z=>{Z.terminate()}),this.workers=null)}isPreloaded(){return!!this.active[qn]}numActive(){return Object.keys(this.active).length}}let fr;function Xt(){return fr||(fr=new Gt),fr}function Ut(J,G){const Z={};for(const re in J)re!=="ref"&&(Z[re]=J[re]);return t.refProperties.forEach(re=>{re in G&&(Z[re]=G[re])}),Z}function wr(J){J=J.slice();const G=Object.create(null);for(let Z=0;Z<J.length;Z++)G[J[Z].id]=J[Z];for(let Z=0;Z<J.length;Z++)"ref"in J[Z]&&(J[Z]=Ut(J[Z],G[J[Z].ref]));return J}Gt.workerCount=2;const zr={setStyle:"setStyle",addLayer:"addLayer",removeLayer:"removeLayer",setPaintProperty:"setPaintProperty",setLayoutProperty:"setLayoutProperty",setFilter:"setFilter",addSource:"addSource",removeSource:"removeSource",setGeoJSONSourceData:"setGeoJSONSourceData",setLayerZoomRange:"setLayerZoomRange",setLayerProperty:"setLayerProperty",setCenter:"setCenter",setZoom:"setZoom",setBearing:"setBearing",setPitch:"setPitch",setSprite:"setSprite",setGlyphs:"setGlyphs",setTransition:"setTransition",setLight:"setLight",setTerrain:"setTerrain",setFog:"setFog",setProjection:"setProjection"};function Yr(J,G,Z){Z.push({command:zr.addSource,args:[J,G[J]]})}function Zi(J,G,Z){G.push({command:zr.removeSource,args:[J]}),Z[J]=!0}function en(J,G,Z,re){Zi(J,Z,re),Yr(J,G,Z)}function an(J,G,Z){let re;for(re in J[Z])if(J[Z].hasOwnProperty(re)&&re!=="data"&&!H(J[Z][re],G[Z][re]))return!1;for(re in G[Z])if(G[Z].hasOwnProperty(re)&&re!=="data"&&!H(J[Z][re],G[Z][re]))return!1;return!0}function tn(J,G,Z,re,le,de){let me;for(me in G=G||{},J=J||{})J.hasOwnProperty(me)&&(H(J[me],G[me])||Z.push({command:de,args:[re,me,G[me],le]}));for(me in G)G.hasOwnProperty(me)&&!J.hasOwnProperty(me)&&(H(J[me],G[me])||Z.push({command:de,args:[re,me,G[me],le]}))}function qr(J){return J.id}function on(J,G){return J[G.id]=G,J}class Nn{constructor(G,Z){this.reset(G,Z)}reset(G,Z){this.points=G||[],this._distances=[0];for(let re=1;re<this.points.length;re++)this._distances[re]=this._distances[re-1]+this.points[re].dist(this.points[re-1]);this.length=this._distances[this._distances.length-1],this.padding=Math.min(Z||0,.5*this.length),this.paddedLength=this.length-2*this.padding}lerp(G){if(this.points.length===1)return this.points[0];G=t.clamp(G,0,1);let Z=1,re=this._distances[Z];const le=G*this.paddedLength+this.padding;for(;re<le&&Z<this._distances.length;)re=this._distances[++Z];const de=Z-1,me=this._distances[de],ye=re-me,be=ye>0?(le-me)/ye:0;return this.points[de].mult(1-be).add(this.points[Z].mult(be))}}class ea{constructor(G,Z,re){const le=this.boxCells=[],de=this.circleCells=[];this.xCellCount=Math.ceil(G/re),this.yCellCount=Math.ceil(Z/re);for(let me=0;me<this.xCellCount*this.yCellCount;me++)le.push([]),de.push([]);this.circleKeys=[],this.boxKeys=[],this.bboxes=[],this.circles=[],this.width=G,this.height=Z,this.xScale=this.xCellCount/G,this.yScale=this.yCellCount/Z,this.boxUid=0,this.circleUid=0}keysLength(){return this.boxKeys.length+this.circleKeys.length}insert(G,Z,re,le,de){this._forEachCell(Z,re,le,de,this._insertBoxCell,this.boxUid++),this.boxKeys.push(G),this.bboxes.push(Z),this.bboxes.push(re),this.bboxes.push(le),this.bboxes.push(de)}insertCircle(G,Z,re,le){this._forEachCell(Z-le,re-le,Z+le,re+le,this._insertCircleCell,this.circleUid++),this.circleKeys.push(G),this.circles.push(Z),this.circles.push(re),this.circles.push(le)}_insertBoxCell(G,Z,re,le,de,me){this.boxCells[de].push(me)}_insertCircleCell(G,Z,re,le,de,me){this.circleCells[de].push(me)}_query(G,Z,re,le,de,me){if(re<0||G>this.width||le<0||Z>this.height)return!de&&[];const ye=[];if(G<=0&&Z<=0&&this.width<=re&&this.height<=le){if(de)return!0;for(let be=0;be<this.boxKeys.length;be++)ye.push({key:this.boxKeys[be],x1:this.bboxes[4*be],y1:this.bboxes[4*be+1],x2:this.bboxes[4*be+2],y2:this.bboxes[4*be+3]});for(let be=0;be<this.circleKeys.length;be++){const qe=this.circles[3*be],Te=this.circles[3*be+1],Fe=this.circles[3*be+2];ye.push({key:this.circleKeys[be],x1:qe-Fe,y1:Te-Fe,x2:qe+Fe,y2:Te+Fe})}return me?ye.filter(me):ye}return this._forEachCell(G,Z,re,le,this._queryCell,ye,{hitTest:de,seenUids:{box:{},circle:{}}},me),de?ye.length>0:ye}_queryCircle(G,Z,re,le,de){const me=G-re,ye=G+re,be=Z-re,qe=Z+re;if(ye<0||me>this.width||qe<0||be>this.height)return!le&&[];const Te=[];return this._forEachCell(me,be,ye,qe,this._queryCellCircle,Te,{hitTest:le,circle:{x:G,y:Z,radius:re},seenUids:{box:{},circle:{}}},de),le?Te.length>0:Te}query(G,Z,re,le,de){return this._query(G,Z,re,le,!1,de)}hitTest(G,Z,re,le,de){return this._query(G,Z,re,le,!0,de)}hitTestCircle(G,Z,re,le){return this._queryCircle(G,Z,re,!0,le)}_queryCell(G,Z,re,le,de,me,ye,be){const qe=ye.seenUids,Te=this.boxCells[de];if(Te!==null){const $e=this.bboxes;for(const Je of Te)if(!qe.box[Je]){qe.box[Je]=!0;const tt=4*Je;if(G<=$e[tt+2]&&Z<=$e[tt+3]&&re>=$e[tt+0]&&le>=$e[tt+1]&&(!be||be(this.boxKeys[Je]))){if(ye.hitTest)return me.push(!0),!0;me.push({key:this.boxKeys[Je],x1:$e[tt],y1:$e[tt+1],x2:$e[tt+2],y2:$e[tt+3]})}}}const Fe=this.circleCells[de];if(Fe!==null){const $e=this.circles;for(const Je of Fe)if(!qe.circle[Je]){qe.circle[Je]=!0;const tt=3*Je;if(this._circleAndRectCollide($e[tt],$e[tt+1],$e[tt+2],G,Z,re,le)&&(!be||be(this.circleKeys[Je]))){if(ye.hitTest)return me.push(!0),!0;{const Qe=$e[tt],it=$e[tt+1],Be=$e[tt+2];me.push({key:this.circleKeys[Je],x1:Qe-Be,y1:it-Be,x2:Qe+Be,y2:it+Be})}}}}}_queryCellCircle(G,Z,re,le,de,me,ye,be){const qe=ye.circle,Te=ye.seenUids,Fe=this.boxCells[de];if(Fe!==null){const Je=this.bboxes;for(const tt of Fe)if(!Te.box[tt]){Te.box[tt]=!0;const Qe=4*tt;if(this._circleAndRectCollide(qe.x,qe.y,qe.radius,Je[Qe+0],Je[Qe+1],Je[Qe+2],Je[Qe+3])&&(!be||be(this.boxKeys[tt])))return me.push(!0),!0}}const $e=this.circleCells[de];if($e!==null){const Je=this.circles;for(const tt of $e)if(!Te.circle[tt]){Te.circle[tt]=!0;const Qe=3*tt;if(this._circlesCollide(Je[Qe],Je[Qe+1],Je[Qe+2],qe.x,qe.y,qe.radius)&&(!be||be(this.circleKeys[tt])))return me.push(!0),!0}}}_forEachCell(G,Z,re,le,de,me,ye,be){const qe=this._convertToXCellCoord(G),Te=this._convertToYCellCoord(Z),Fe=this._convertToXCellCoord(re),$e=this._convertToYCellCoord(le);for(let Je=qe;Je<=Fe;Je++)for(let tt=Te;tt<=$e;tt++)if(de.call(this,G,Z,re,le,this.xCellCount*tt+Je,me,ye,be))return}_convertToXCellCoord(G){return Math.max(0,Math.min(this.xCellCount-1,Math.floor(G*this.xScale)))}_convertToYCellCoord(G){return Math.max(0,Math.min(this.yCellCount-1,Math.floor(G*this.yScale)))}_circlesCollide(G,Z,re,le,de,me){const ye=le-G,be=de-Z,qe=re+me;return qe*qe>ye*ye+be*be}_circleAndRectCollide(G,Z,re,le,de,me,ye){const be=(me-le)/2,qe=Math.abs(G-(le+be));if(qe>be+re)return!1;const Te=(ye-de)/2,Fe=Math.abs(Z-(de+Te));if(Fe>Te+re)return!1;if(qe<=be||Fe<=Te)return!0;const $e=qe-be,Je=Fe-Te;return $e*$e+Je*Je<=re*re}}const Gn={unknown:0,flipRequired:1,flipNotRequired:2},Da=Math.tan(85*Math.PI/180);function Yt(J,G,Z,re,le,de,me){const ye=t.create();if(Z)if(de.name==="globe"){const be=t.calculateGlobeLabelMatrix(le,G);t.multiply(ye,ye,be)}else{const be=He([],me);ye[0]=be[0],ye[1]=be[1],ye[4]=be[2],ye[5]=be[3],re||t.rotateZ(ye,ye,le.angle)}else t.multiply(ye,le.labelPlaneMatrix,J);return ye}function ma(J,G,Z,re,le,de,me){const ye=Yt(J,G,Z,re,le,de,me);return de.name==="globe"&&Z||(ye[2]=ye[6]=ye[10]=ye[14]=0),ye}function ln(J,G,Z,re,le,de,me){if(Z){if(de.name==="globe"){const ye=Yt(J,G,Z,re,le,de,me);return t.invert(ye,ye),t.multiply(ye,J,ye),ye}{const ye=t.clone(J),be=t.identity([]);return be[0]=me[0],be[1]=me[1],be[4]=me[2],be[5]=me[3],t.multiply(ye,ye,be),re||t.rotateZ(ye,ye,-le.angle),ye}}return le.glCoordMatrix}function gn(J,G,Z,re){const le=[J,G,Z,1];Z?t.transformMat4$1(le,le,re):bi(le,le,re);const de=le[3];return le[0]/=de,le[1]/=de,le[2]/=de,le}function Zl(J,G){return Math.min(.5+J/G*.5,1.5)}function sa(J,G){const Z=J[0]/J[3],re=J[1]/J[3];return Z>=-G[0]&&Z<=G[0]&&re>=-G[1]&&re<=G[1]}function xu(J,G,Z,re,le,de,me,ye,be,qe){const Te=Z.transform,Fe=re?J.textSizeData:J.iconSizeData,$e=t.evaluateSizeForZoom(Fe,Z.transform.zoom),Je=Te.projection.name==="globe",tt=[256/Z.width*2+1,256/Z.height*2+1],Qe=re?J.text.dynamicLayoutVertexArray:J.icon.dynamicLayoutVertexArray;Qe.clear();let it=null;Je&&(it=re?J.text.globeExtVertexArray:J.icon.globeExtVertexArray);const Be=J.lineVertexArray,Ye=re?J.text.placedSymbolArray:J.icon.placedSymbolArray,lt=Z.transform.width/Z.transform.height;let ct,Tt=!1;for(let Rt=0;Rt<Ye.length;Rt++){const It=Ye.get(Rt),{numGlyphs:kt,writingMode:Dt}=It;if(Dt!==t.WritingMode.vertical||Tt||ct===t.WritingMode.horizontal||(Tt=!0),ct=Dt,(It.hidden||Dt===t.WritingMode.vertical)&&!Tt){ta(kt,Qe);continue}Tt=!1;const Vt=new t.Point(It.tileAnchorX,It.tileAnchorY);let{x:mr,y:Bt,z:nr}=Te.projection.projectTilePoint(Vt.x,Vt.y,qe.canonical);if(be){const[hi,Gr,ii]=be(Vt);mr+=hi,Bt+=Gr,nr+=ii}const Ht=[mr,Bt,nr,1];if(t.transformMat4$1(Ht,Ht,G),!sa(Ht,tt)){ta(kt,Qe);continue}const pr=Zl(Z.transform.cameraToCenterDistance,Ht[3]),jt=t.evaluateSizeForFeature(Fe,$e,It),ir=me?jt/pr:jt*pr,gr=gn(mr,Bt,nr,le);if(gr[3]<=0){ta(kt,Qe);continue}let ur={};const xr=me?null:be,Jr=Fr(It,ir,!1,ye,G,le,de,J.glyphOffsetArray,Be,Qe,it,gr,Vt,ur,lt,xr,Te.projection,qe,me);Tt=Jr.useVertical,xr&&Jr.needsFlipping&&(ur={}),(Jr.notEnoughRoom||Tt||Jr.needsFlipping&&Fr(It,ir,!0,ye,G,le,de,J.glyphOffsetArray,Be,Qe,it,gr,Vt,ur,lt,xr,Te.projection,qe,me).notEnoughRoom)&&ta(kt,Qe)}re?(J.text.dynamicLayoutVertexBuffer.updateData(Qe),it&&J.text.globeExtVertexBuffer.updateData(it)):(J.icon.dynamicLayoutVertexBuffer.updateData(Qe),it&&J.icon.globeExtVertexBuffer.updateData(it))}function Kl(J,G,Z,re,le,de,me,ye,be,qe,Te,Fe,$e,Je,tt,Qe){const{lineStartIndex:it,glyphStartIndex:Be,segment:Ye}=ye,lt=Be+ye.numGlyphs,ct=it+ye.lineLength,Tt=G.getoffsetX(Be),Rt=G.getoffsetX(lt-1),It=jn(J*Tt,Z,re,le,de,me,Ye,it,ct,be,qe,Te,Fe,$e,!0,Je,tt,Qe);if(!It)return null;const kt=jn(J*Rt,Z,re,le,de,me,Ye,it,ct,be,qe,Te,Fe,$e,!0,Je,tt,Qe);return kt?{first:It,last:kt}:null}function lo(J,G,Z,re){return J===t.WritingMode.horizontal&&Math.abs(re)>Math.abs(Z)?{useVertical:!0}:J===t.WritingMode.vertical?re>0?{needsFlipping:!0}:null:G!==Gn.unknown&&function(le,de){return le===0||Math.abs(de/le)>Da}(Z,re)?G===Gn.flipRequired?{needsFlipping:!0}:null:Z<0?{needsFlipping:!0}:null}function Fr(J,G,Z,re,le,de,me,ye,be,qe,Te,Fe,$e,Je,tt,Qe,it,Be,Ye){const lt=G/24,ct=J.lineOffsetX*lt,Tt=J.lineOffsetY*lt,{lineStartIndex:Rt,glyphStartIndex:It,numGlyphs:kt,segment:Dt,writingMode:Vt,flipState:mr}=J,Bt=Rt+J.lineLength,nr=Ht=>{if(Te){const[gr,ur,xr]=Ht.up,Jr=qe.length;t.updateGlobeVertexNormal(Te,Jr+0,gr,ur,xr),t.updateGlobeVertexNormal(Te,Jr+1,gr,ur,xr),t.updateGlobeVertexNormal(Te,Jr+2,gr,ur,xr),t.updateGlobeVertexNormal(Te,Jr+3,gr,ur,xr)}const[pr,jt,ir]=Ht.point;t.addDynamicAttributes(qe,pr,jt,ir,Ht.angle)};if(kt>1){const Ht=Kl(lt,ye,ct,Tt,Z,Fe,$e,J,be,de,Je,Qe,!1,it,Be,Ye);if(!Ht)return{notEnoughRoom:!0};if(re&&!Z){let[pr,jt,ir]=Ht.first.point,[gr,ur,xr]=Ht.last.point;[pr,jt]=gn(pr,jt,ir,me),[gr,ur]=gn(gr,ur,xr,me);const Jr=lo(Vt,mr,(gr-pr)*tt,ur-jt);if(J.flipState=Jr&&Jr.needsFlipping?Gn.flipRequired:Gn.flipNotRequired,Jr)return Jr}nr(Ht.first);for(let pr=It+1;pr<It+kt-1;pr++){const jt=jn(lt*ye.getoffsetX(pr),ct,Tt,Z,Fe,$e,Dt,Rt,Bt,be,de,Je,Qe,!1,!1,it,Be,Ye);if(!jt)return qe.length-=4*(pr-It),{notEnoughRoom:!0};nr(jt)}nr(Ht.last)}else{if(re&&!Z){const pr=gn($e.x,$e.y,0,le),jt=Rt+Dt+1,ir=new t.Point(be.getx(jt),be.gety(jt)),gr=gn(ir.x,ir.y,0,le),ur=gr[3]>0?gr:vi($e,ir,pr,1,le,void 0,it,Be.canonical),xr=lo(Vt,mr,(ur[0]-pr[0])*tt,ur[1]-pr[1]);if(J.flipState=xr&&xr.needsFlipping?Gn.flipRequired:Gn.flipNotRequired,xr)return xr}const Ht=jn(lt*ye.getoffsetX(It),ct,Tt,Z,Fe,$e,Dt,Rt,Bt,be,de,Je,Qe,!1,!1,it,Be,Ye);if(!Ht)return{notEnoughRoom:!0};nr(Ht)}return{}}function Si(J,G,Z,re,le){const{x:de,y:me,z:ye}=re.projectTilePoint(J.x,J.y,G);if(!le)return gn(de,me,ye,Z);const[be,qe,Te]=le(J);return gn(de+be,me+qe,ye+Te,Z)}function vi(J,G,Z,re,le,de,me,ye){const be=Si(J.sub(G)._unit()._add(J),ye,le,me,de);return t.sub(be,Z,be),t.normalize(be,be),t.scaleAndAdd(be,Z,be,re)}function jn(J,G,Z,re,le,de,me,ye,be,qe,Te,Fe,$e,Je,tt,Qe,it,Be){const Ye=re?J-G:J+G;let lt=Ye>0?1:-1,ct=0;re&&(lt*=-1,ct=Math.PI),lt<0&&(ct+=Math.PI);let Tt=ye+me+(lt>0?0:1)|0,Rt=le,It=le,kt=0,Dt=0;const Vt=Math.abs(Ye),mr=[],Bt=[];let nr=de,Ht=nr;const pr=()=>vi(Ht,nr,It,Vt-kt+1,Te,$e,Qe,it.canonical);for(;kt+Dt<=Vt;){if(Tt+=lt,Tt<ye||Tt>=be)return null;if(It=Rt,Ht=nr,mr.push(It),Je&&Bt.push(Ht),nr=new t.Point(qe.getx(Tt),qe.gety(Tt)),Rt=Fe[Tt],!Rt){const ii=Si(nr,it.canonical,Te,Qe,$e);Rt=ii[3]>0?Fe[Tt]=ii:pr()}kt+=Dt,Dt=t.distance(It,Rt)}tt&&$e&&(Fe[Tt]&&(Rt=pr(),Dt=t.distance(It,Rt)),Fe[Tt]=Rt);const jt=(Vt-kt)/Dt,ir=nr.sub(Ht)._mult(jt)._add(Ht),gr=t.sub([],Rt,It),ur=t.scaleAndAdd([],It,gr,jt);let xr=[0,0,1],Jr=gr[0],hi=gr[1];if(Be&&(xr=Qe.upVector(it.canonical,ir.x,ir.y),xr[0]!==0||xr[1]!==0||xr[2]!==1)){const ii=[xr[2],0,-xr[0]],xi=t.cross([],xr,ii);t.normalize(ii,ii),t.normalize(xi,xi),Jr=t.dot(gr,ii),hi=t.dot(gr,xi)}if(Z){const ii=t.cross([],xr,gr);t.normalize(ii,ii),t.scaleAndAdd(ur,ur,ii,Z*lt)}const Gr=ct+Math.atan2(hi,Jr);return mr.push(ur),Je&&Bt.push(ir),{point:ur,angle:Gr,path:mr,tilePath:Bt,up:xr}}function ta(J,G){const Z=G.length,re=Z+4*J;G.resize(re),G.float32.fill(-1/0,4*Z,4*re)}function bi(J,G,Z){const re=G[0],le=G[1];return J[0]=Z[0]*re+Z[4]*le+Z[12],J[1]=Z[1]*re+Z[5]*le+Z[13],J[3]=Z[3]*re+Z[7]*le+Z[15],J}const Un=100;class zo{constructor(G,Z,re=new ea(G.width+200,G.height+200,25),le=new ea(G.width+200,G.height+200,25)){this.transform=G,this.grid=re,this.ignoredGrid=le,this.pitchfactor=Math.cos(G._pitch)*G.cameraToCenterDistance,this.screenRightBoundary=G.width+Un,this.screenBottomBoundary=G.height+Un,this.gridRightBoundary=G.width+200,this.gridBottomBoundary=G.height+200,this.fogState=Z}placeCollisionBox(G,Z,re,le,de,me,ye,be){let qe=re.projectedAnchorX,Te=re.projectedAnchorY,Fe=re.projectedAnchorZ;const $e=re.elevation,Je=re.tileID,tt=G.getProjection();if($e&&Je){const[Rt,It,kt]=tt.upVector(Je.canonical,re.tileAnchorX,re.tileAnchorY),Dt=tt.upVectorScale(Je.canonical,this.transform.center.lat,this.transform.worldSize).metersToTile;qe+=Rt*$e*Dt,Te+=It*$e*Dt,Fe+=kt*$e*Dt}const Qe=this.projectAndGetPerspectiveRatio(ye,qe,Te,Fe,re.tileID,tt.name==="globe"||!!$e||this.transform.pitch>0,tt),it=me*Qe.perspectiveRatio,Be=(re.x1*Z+le.x-re.padding)*it+Qe.point.x,Ye=(re.y1*Z+le.y-re.padding)*it+Qe.point.y,lt=(re.x2*Z+le.x+re.padding)*it+Qe.point.x,ct=(re.y2*Z+le.y+re.padding)*it+Qe.point.y,Tt=Qe.perspectiveRatio<=.55||Qe.occluded;return!this.isInsideGrid(Be,Ye,lt,ct)||!de&&this.grid.hitTest(Be,Ye,lt,ct,be)||Tt?{box:[],offscreen:!1,occluded:Qe.occluded}:{box:[Be,Ye,lt,ct],offscreen:this.isOffscreen(Be,Ye,lt,ct),occluded:!1}}placeCollisionCircles(G,Z,re,le,de,me,ye,be,qe,Te,Fe,$e,Je,tt,Qe){const it=[],Be=this.transform.elevation,Ye=G.getProjection(),lt=Be?Be.getAtTileOffsetFunc(Qe,this.transform.center.lat,this.transform.worldSize,Ye):null,ct=new t.Point(re.tileAnchorX,re.tileAnchorY);let{x:Tt,y:Rt,z:It}=Ye.projectTilePoint(ct.x,ct.y,Qe.canonical);if(lt){const[ir,gr,ur]=lt(ct);Tt+=ir,Rt+=gr,It+=ur}const kt=Ye.name==="globe",Dt=this.projectAndGetPerspectiveRatio(ye,Tt,Rt,It,Qe,kt||!!Be||this.transform.pitch>0,Ye),{perspectiveRatio:Vt}=Dt,mr=(Fe?me/Vt:me*Vt)/t.ONE_EM,Bt=gn(Tt,Rt,It,be),nr=Dt.signedDistanceFromCamera>0?Kl(mr,de,re.lineOffsetX*mr,re.lineOffsetY*mr,!1,Bt,ct,re,le,be,{},Be&&!Fe?lt:null,Fe&&!!Be,Ye,Qe,Fe):null;let Ht=!1,pr=!1,jt=!0;if(nr&&!Dt.occluded){const ir=.5*Je*Vt+tt,gr=new t.Point(-100,-100),ur=new t.Point(this.screenRightBoundary,this.screenBottomBoundary),xr=new Nn,{first:Jr,last:hi}=nr,Gr=Jr.path.length;let ii=[];for(let Zr=Gr-1;Zr>=1;Zr--)ii.push(Jr.path[Zr]);for(let Zr=1;Zr<hi.path.length;Zr++)ii.push(hi.path[Zr]);const xi=2.5*ir;qe&&(ii=ii.map(([Zr,Pi,Di],Li)=>(lt&&!kt&&(Di=lt(Li<Gr-1?Jr.tilePath[Gr-1-Li]:hi.tilePath[Li-Gr+2])[2]),gn(Zr,Pi,Di,qe))),ii.some(Zr=>Zr[3]<=0)&&(ii=[]));let gi=[];if(ii.length>0){let Zr=1/0,Pi=-1/0,Di=1/0,Li=-1/0;for(const Fi of ii)Zr=Math.min(Zr,Fi[0]),Di=Math.min(Di,Fi[1]),Pi=Math.max(Pi,Fi[0]),Li=Math.max(Li,Fi[1]);Pi>=gr.x&&Zr<=ur.x&&Li>=gr.y&&Di<=ur.y&&(gi=[ii.map(Fi=>new t.Point(Fi[0],Fi[1]))],(Zr<gr.x||Pi>ur.x||Di<gr.y||Li>ur.y)&&(gi=t.clipLine(gi,gr.x,gr.y,ur.x,ur.y)))}for(const Zr of gi){xr.reset(Zr,.25*ir);let Pi=0;Pi=xr.length<=.5*ir?1:Math.ceil(xr.paddedLength/xi)+1;for(let Di=0;Di<Pi;Di++){const Li=Di/Math.max(Pi-1,1),Fi=xr.lerp(Li),An=Fi.x+Un,bn=Fi.y+Un;it.push(An,bn,ir,0);const Kn=An-ir,ha=bn-ir,Yi=An+ir,ki=bn+ir;if(jt=jt&&this.isOffscreen(Kn,ha,Yi,ki),pr=pr||this.isInsideGrid(Kn,ha,Yi,ki),!Z&&this.grid.hitTestCircle(An,bn,ir,$e)&&(Ht=!0,!Te))return{circles:[],offscreen:!1,collisionDetected:Ht,occluded:!1}}}}return{circles:!Te&&Ht||!pr?[]:it,offscreen:jt,collisionDetected:Ht,occluded:Dt.occluded}}queryRenderedSymbols(G){if(G.length===0||this.grid.keysLength()===0&&this.ignoredGrid.keysLength()===0)return{};const Z=[];let re=1/0,le=1/0,de=-1/0,me=-1/0;for(const Te of G){const Fe=new t.Point(Te.x+Un,Te.y+Un);re=Math.min(re,Fe.x),le=Math.min(le,Fe.y),de=Math.max(de,Fe.x),me=Math.max(me,Fe.y),Z.push(Fe)}const ye=this.grid.query(re,le,de,me).concat(this.ignoredGrid.query(re,le,de,me)),be={},qe={};for(const Te of ye){const Fe=Te.key;if(be[Fe.bucketInstanceId]===void 0&&(be[Fe.bucketInstanceId]={}),be[Fe.bucketInstanceId][Fe.featureIndex])continue;const $e=[new t.Point(Te.x1,Te.y1),new t.Point(Te.x2,Te.y1),new t.Point(Te.x2,Te.y2),new t.Point(Te.x1,Te.y2)];t.polygonIntersectsPolygon(Z,$e)&&(be[Fe.bucketInstanceId][Fe.featureIndex]=!0,qe[Fe.bucketInstanceId]===void 0&&(qe[Fe.bucketInstanceId]=[]),qe[Fe.bucketInstanceId].push(Fe.featureIndex))}return qe}insertCollisionBox(G,Z,re,le,de){(Z?this.ignoredGrid:this.grid).insert({bucketInstanceId:re,featureIndex:le,collisionGroupID:de},G[0],G[1],G[2],G[3])}insertCollisionCircles(G,Z,re,le,de){const me=Z?this.ignoredGrid:this.grid,ye={bucketInstanceId:re,featureIndex:le,collisionGroupID:de};for(let be=0;be<G.length;be+=4)me.insertCircle(ye,G[be],G[be+1],G[be+2])}projectAndGetPerspectiveRatio(G,Z,re,le,de,me,ye){const be=[Z,re,le,1];let qe=!1;le||this.transform.pitch>0?(t.transformMat4$1(be,be,G),this.fogState&&de&&ye.name!=="globe"&&(qe=function($e,Je,tt,Qe,it,Be){const Ye=Be.calculateFogTileMatrix(it),lt=[Je,tt,Qe];return t.transformMat4(lt,lt,Ye),ft($e,lt,Be.pitch,Be._fov)}(this.fogState,Z,re,le,de.toUnwrapped(),this.transform)>.9)):bi(be,be,G);const Te=be[3];return{point:new t.Point((be[0]/Te+1)/2*this.transform.width+Un,(-be[1]/Te+1)/2*this.transform.height+Un),perspectiveRatio:Math.min(.5+this.transform.getCameraToCenterDistance(ye)/Te*.5,1.5),signedDistanceFromCamera:Te,occluded:me&&be[2]>Te||qe}}isOffscreen(G,Z,re,le){return re<Un||G>=this.screenRightBoundary||le<Un||Z>this.screenBottomBoundary}isInsideGrid(G,Z,re,le){return re>=0&&G<this.gridRightBoundary&&le>=0&&Z<this.gridBottomBoundary}getViewportMatrix(){const G=t.identity([]);return t.translate(G,G,[-100,-100,0]),G}}function Wa(J,G,Z){const re=G.createTileMatrix(J,J.worldSize,Z.toUnwrapped());return t.multiply(new Float32Array(16),J.projMatrix,re)}function $n(J,G,Z){if(G.projection.name===Z.projection.name)return J.projMatrix;const re=Z.clone();return re.setProjection(G.projection),Wa(re,G.getProjection(),J)}function Xi(J,G,Z){return G.name===Z.projection.name?J.projMatrix:Wa(Z,G,J)}class Xl{constructor(G,Z,re,le){this.opacity=G?Math.max(0,Math.min(1,G.opacity+(G.placed?Z:-Z))):le&&re?1:0,this.placed=re}isHidden(){return this.opacity===0&&!this.placed}}class ya{constructor(G,Z,re,le,de,me=!1){this.text=new Xl(G?G.text:null,Z,re,de),this.icon=new Xl(G?G.icon:null,Z,le,de),this.clipped=me}isHidden(){return this.text.isHidden()&&this.icon.isHidden()}}class No{constructor(G,Z,re,le=!1){this.text=G,this.icon=Z,this.skipFade=re,this.clipped=le}}class jo{constructor(){this.invProjMatrix=t.create(),this.viewportMatrix=t.create(),this.circles=[]}}class Eu{constructor(G,Z,re,le,de){this.bucketInstanceId=G,this.featureIndex=Z,this.sourceLayerIndex=re,this.bucketIndex=le,this.tileID=de}}class Yl{constructor(G){this.crossSourceCollisions=G,this.maxGroupID=0,this.collisionGroups={}}get(G){if(this.crossSourceCollisions)return{ID:0,predicate:null};if(!this.collisionGroups[G]){const Z=++this.maxGroupID;this.collisionGroups[G]={ID:Z,predicate:re=>re.collisionGroupID===Z}}return this.collisionGroups[G]}}function Uo(J,G,Z,re,le){const{horizontalAlign:de,verticalAlign:me}=t.getAnchorAlignment(J),ye=-(de-.5)*G,be=-(me-.5)*Z,qe=t.evaluateVariableOffset(J,re);return new t.Point(ye+qe[0]*le,be+qe[1]*le)}function Vo(J,G,Z,re,le){const de=new t.Point(J,G);return Z&&de._rotate(re?le:-le),de}class Ts{constructor(G,Z,re,le,de){this.transform=G.clone(),this.projection=G.projection.name,this.collisionIndex=new zo(this.transform,de),this.placements={},this.opacities={},this.variableOffsets={},this.stale=!1,this.commitTime=0,this.fadeDuration=Z,this.retainedQueryData={},this.collisionGroups=new Yl(re),this.collisionCircleArrays={},this.prevPlacement=le,le&&(le.prevPlacement=void 0),this.placedOrientations={}}getBucketParts(G,Z,re,le){const de=re.getBucket(Z),me=re.latestFeatureIndex;if(!de||!me||Z.id!==de.layerIds[0])return;const ye=de.layers[0].layout,be=re.collisionBoxArray,qe=Math.pow(2,this.transform.zoom-re.tileID.overscaledZ),Te=re.tileSize/t.EXTENT,Fe=re.tileID.toUnwrapped();this.transform.setProjection(de.projection);const $e=(Je=re.tileID,tt=de.getProjection(),Qe=this.transform,tt.name===this.projection?Qe.calculateProjMatrix(Je.toUnwrapped()):Wa(Qe,tt,Je));var Je,tt,Qe;const it=ye.get("text-pitch-alignment")==="map",Be=ye.get("text-rotation-alignment")==="map";Z.compileFilter();const Ye=Z.dynamicFilter(),lt=Z.dynamicFilterNeedsFeature(),ct=this.transform.calculatePixelsToTileUnitsMatrix(re),Tt=ma($e,re.tileID.canonical,it,Be,this.transform,de.getProjection(),ct);let Rt=null;if(it){const Dt=ln($e,re.tileID.canonical,it,Be,this.transform,de.getProjection(),ct);Rt=t.multiply([],this.transform.labelPlaneMatrix,Dt)}let It=null;Ye&&re.latestFeatureIndex&&(It={unwrappedTileID:Fe,dynamicFilter:Ye,dynamicFilterNeedsFeature:lt,featureIndex:re.latestFeatureIndex}),this.retainedQueryData[de.bucketInstanceId]=new Eu(de.bucketInstanceId,me,de.sourceLayerIndex,de.index,re.tileID);const kt={bucket:de,layout:ye,posMatrix:$e,textLabelPlaneMatrix:Tt,labelToScreenMatrix:Rt,clippingData:It,scale:qe,textPixelRatio:Te,holdingForFade:re.holdingForFade(),collisionBoxArray:be,partiallyEvaluatedTextSize:t.evaluateSizeForZoom(de.textSizeData,this.transform.zoom),partiallyEvaluatedIconSize:t.evaluateSizeForZoom(de.iconSizeData,this.transform.zoom),collisionGroup:this.collisionGroups.get(de.sourceID)};if(le)for(const Dt of de.sortKeyRanges){const{sortKey:Vt,symbolInstanceStart:mr,symbolInstanceEnd:Bt}=Dt;G.push({sortKey:Vt,symbolInstanceStart:mr,symbolInstanceEnd:Bt,parameters:kt})}else G.push({symbolInstanceStart:0,symbolInstanceEnd:de.symbolInstances.length,parameters:kt})}attemptAnchorPlacement(G,Z,re,le,de,me,ye,be,qe,Te,Fe,$e,Je,tt,Qe,it,Be,Ye){const{textOffset0:lt,textOffset1:ct,crossTileID:Tt}=$e,Rt=[lt,ct],It=Uo(G,re,le,Rt,de),kt=this.collisionIndex.placeCollisionBox(tt,de,Z,Vo(It.x,It.y,me,ye,this.transform.angle),Fe,be,qe,Te.predicate);if(it){const Dt=tt.getSymbolInstanceIconSize(Ye,this.transform.zoom,$e.placedIconSymbolIndex);if(this.collisionIndex.placeCollisionBox(tt,Dt,it,Vo(It.x,It.y,me,ye,this.transform.angle),Fe,be,qe,Te.predicate).box.length===0)return}if(kt.box.length>0){let Dt;return this.prevPlacement&&this.prevPlacement.variableOffsets[Tt]&&this.prevPlacement.placements[Tt]&&this.prevPlacement.placements[Tt].text&&(Dt=this.prevPlacement.variableOffsets[Tt].anchor),this.variableOffsets[Tt]={textOffset:Rt,width:re,height:le,anchor:G,textScale:de,prevAnchor:Dt},this.markUsedJustification(tt,G,$e,Qe),tt.allowVerticalPlacement&&(this.markUsedOrientation(tt,Qe,$e),this.placedOrientations[Tt]=Qe),{shift:It,placedGlyphBoxes:kt}}}placeLayerBucketPart(G,Z,re,le){const{bucket:de,layout:me,posMatrix:ye,textLabelPlaneMatrix:be,labelToScreenMatrix:qe,clippingData:Te,textPixelRatio:Fe,holdingForFade:$e,collisionBoxArray:Je,partiallyEvaluatedTextSize:tt,partiallyEvaluatedIconSize:Qe,collisionGroup:it}=G.parameters,Be=me.get("text-optional"),Ye=me.get("icon-optional"),lt=me.get("text-allow-overlap"),ct=me.get("icon-allow-overlap"),Tt=me.get("text-rotation-alignment")==="map",Rt=me.get("text-pitch-alignment")==="map",It=me.get("icon-text-fit")!=="none",kt=me.get("symbol-z-order")==="viewport-y";this.transform.setProjection(de.projection);let Dt=lt&&(ct||!de.hasIconData()||Ye),Vt=ct&&(lt||!de.hasTextData()||Be);!de.collisionArrays&&Je&&de.deserializeCollisionBoxes(Je),re&&le&&de.updateCollisionDebugBuffers(this.transform.zoom,Je);const mr=(Bt,nr,Ht)=>{const{crossTileID:pr,numVerticalGlyphVertices:jt}=Bt;if(Te){const Yi={zoom:this.transform.zoom,pitch:this.transform.pitch};let ki=null;if(Te.dynamicFilterNeedsFeature){const Ri=this.retainedQueryData[de.bucketInstanceId];ki=Te.featureIndex.loadFeature({featureIndex:Bt.featureIndex,bucketIndex:Ri.bucketIndex,sourceLayerIndex:Ri.sourceLayerIndex,layoutVertexArrayOffset:0})}if(!(0,Te.dynamicFilter)(Yi,ki,this.retainedQueryData[de.bucketInstanceId].tileID.canonical,new t.Point(Bt.tileAnchorX,Bt.tileAnchorY),this.transform.calculateDistanceTileData(Te.unwrappedTileID)))return this.placements[pr]=new No(!1,!1,!1,!0),void Z.add(pr)}if(Z.has(pr))return;if($e)return void(this.placements[pr]=new No(!1,!1,!1));let ir=!1,gr=!1,ur=!0,xr=!1,Jr=!1,hi=null,Gr={box:null,offscreen:null,occluded:null},ii={box:null},xi=null,gi=null,Zr=null,Pi=0,Di=0,Li=0;Ht.textFeatureIndex?Pi=Ht.textFeatureIndex:Bt.useRuntimeCollisionCircles&&(Pi=Bt.featureIndex),Ht.verticalTextFeatureIndex&&(Di=Ht.verticalTextFeatureIndex);const Fi=Yi=>{Yi.tileID=this.retainedQueryData[de.bucketInstanceId].tileID;const ki=this.transform.elevation;(ki||Yi.elevation)&&(Yi.elevation=ki?ki.getAtTileOffset(Yi.tileID,Yi.tileAnchorX,Yi.tileAnchorY):0)},An=Ht.textBox;if(An){Fi(An);const Yi=Ri=>{let cn=t.WritingMode.horizontal;if(de.allowVerticalPlacement&&!Ri&&this.prevPlacement){const Cn=this.prevPlacement.placedOrientations[pr];Cn&&(this.placedOrientations[pr]=Cn,cn=Cn,this.markUsedOrientation(de,cn,Bt))}return cn},ki=(Ri,cn)=>{if(de.allowVerticalPlacement&&jt>0&&Ht.verticalTextBox){for(const Cn of de.writingModes)if(Cn===t.WritingMode.vertical?(Gr=cn(),ii=Gr):Gr=Ri(),Gr&&Gr.box&&Gr.box.length)break}else Gr=Ri()};if(me.get("text-variable-anchor")){let Ri=me.get("text-variable-anchor");if(this.prevPlacement&&this.prevPlacement.variableOffsets[pr]){const Ki=this.prevPlacement.variableOffsets[pr];Ri.indexOf(Ki.anchor)>0&&(Ri=Ri.filter(Dn=>Dn!==Ki.anchor),Ri.unshift(Ki.anchor))}const cn=(Ki,Dn,Js)=>{const eo=de.getSymbolInstanceTextSize(tt,Bt,this.transform.zoom,nr),ls=(Ki.x2-Ki.x1)*eo+2*Ki.padding,Sa=(Ki.y2-Ki.y1)*eo+2*Ki.padding,ka=It&&!ct?Dn:null;ka&&Fi(ka);let to={box:[],offscreen:!1,occluded:!1};const Qs=lt?2*Ri.length:Ri.length;for(let cs=0;cs<Qs;++cs){const dl=this.attemptAnchorPlacement(Ri[cs%Ri.length],Ki,ls,Sa,eo,Tt,Rt,Fe,ye,it,cs>=Ri.length,Bt,nr,de,Js,ka,tt,Qe);if(dl&&(to=dl.placedGlyphBoxes,to&&to.box&&to.box.length)){ir=!0,hi=dl.shift;break}}return to};ki(()=>cn(An,Ht.iconBox,t.WritingMode.horizontal),()=>{const Ki=Ht.verticalTextBox;return Ki&&Fi(Ki),de.allowVerticalPlacement&&!(Gr&&Gr.box&&Gr.box.length)&&jt>0&&Ki?cn(Ki,Ht.verticalIconBox,t.WritingMode.vertical):{box:null,offscreen:null,occluded:null}}),Gr&&(ir=Gr.box,ur=Gr.offscreen,xr=Gr.occluded);const Cn=Yi(!(!Gr||!Gr.box));if(!ir&&this.prevPlacement){const Ki=this.prevPlacement.variableOffsets[pr];Ki&&(this.variableOffsets[pr]=Ki,this.markUsedJustification(de,Ki.anchor,Bt,Cn))}}else{const Ri=(cn,Cn)=>{const Ki=de.getSymbolInstanceTextSize(tt,Bt,this.transform.zoom,nr),Dn=this.collisionIndex.placeCollisionBox(de,Ki,cn,new t.Point(0,0),lt,Fe,ye,it.predicate);return Dn&&Dn.box&&Dn.box.length&&(this.markUsedOrientation(de,Cn,Bt),this.placedOrientations[pr]=Cn),Dn};ki(()=>Ri(An,t.WritingMode.horizontal),()=>{const cn=Ht.verticalTextBox;return de.allowVerticalPlacement&&jt>0&&cn?(Fi(cn),Ri(cn,t.WritingMode.vertical)):{box:null,offscreen:null,occluded:null}}),Yi(!!(Gr&&Gr.box&&Gr.box.length))}}if(xi=Gr,ir=xi&&xi.box&&xi.box.length>0,ur=xi&&xi.offscreen,xr=xi&&xi.occluded,Bt.useRuntimeCollisionCircles){const Yi=de.text.placedSymbolArray.get(Bt.centerJustifiedTextSymbolIndex>=0?Bt.centerJustifiedTextSymbolIndex:Bt.verticalPlacedTextSymbolIndex),ki=t.evaluateSizeForFeature(de.textSizeData,tt,Yi),Ri=me.get("text-padding");gi=this.collisionIndex.placeCollisionCircles(de,lt,Yi,de.lineVertexArray,de.glyphOffsetArray,ki,ye,be,qe,re,Rt,it.predicate,Bt.collisionCircleDiameter*ki/t.ONE_EM,Ri,this.retainedQueryData[de.bucketInstanceId].tileID),ir=lt||gi.circles.length>0&&!gi.collisionDetected,ur=ur&&gi.offscreen,xr=gi.occluded}if(Ht.iconFeatureIndex&&(Li=Ht.iconFeatureIndex),Ht.iconBox){const Yi=ki=>{Fi(ki);const Ri=It&&hi?Vo(hi.x,hi.y,Tt,Rt,this.transform.angle):new t.Point(0,0),cn=de.getSymbolInstanceIconSize(Qe,this.transform.zoom,Bt.placedIconSymbolIndex);return this.collisionIndex.placeCollisionBox(de,cn,ki,Ri,ct,Fe,ye,it.predicate)};ii&&ii.box&&ii.box.length&&Ht.verticalIconBox?(Zr=Yi(Ht.verticalIconBox),gr=Zr.box.length>0):(Zr=Yi(Ht.iconBox),gr=Zr.box.length>0),ur=ur&&Zr.offscreen,Jr=Zr.occluded}const bn=Be||Bt.numHorizontalGlyphVertices===0&&jt===0,Kn=Ye||Bt.numIconVertices===0;if(bn||Kn?Kn?bn||(gr=gr&&ir):ir=gr&&ir:gr=ir=gr&&ir,ir&&xi&&xi.box&&this.collisionIndex.insertCollisionBox(xi.box,me.get("text-ignore-placement"),de.bucketInstanceId,ii&&ii.box&&Di?Di:Pi,it.ID),gr&&Zr&&this.collisionIndex.insertCollisionBox(Zr.box,me.get("icon-ignore-placement"),de.bucketInstanceId,Li,it.ID),gi&&(ir&&this.collisionIndex.insertCollisionCircles(gi.circles,me.get("text-ignore-placement"),de.bucketInstanceId,Pi,it.ID),re)){const Yi=de.bucketInstanceId;let ki=this.collisionCircleArrays[Yi];ki===void 0&&(ki=this.collisionCircleArrays[Yi]=new jo);for(let Ri=0;Ri<gi.circles.length;Ri+=4)ki.circles.push(gi.circles[Ri+0]),ki.circles.push(gi.circles[Ri+1]),ki.circles.push(gi.circles[Ri+2]),ki.circles.push(gi.collisionDetected?1:0)}const ha=de.projection.name!=="globe";Dt=Dt&&(ha||!xr),Vt=Vt&&(ha||!Jr),this.placements[pr]=new No(ir||Dt,gr||Vt,ur||de.justReloaded),Z.add(pr)};if(kt){const Bt=de.getSortedSymbolIndexes(this.transform.angle);for(let nr=Bt.length-1;nr>=0;--nr){const Ht=Bt[nr];mr(de.symbolInstances.get(Ht),Ht,de.collisionArrays[Ht])}}else for(let Bt=G.symbolInstanceStart;Bt<G.symbolInstanceEnd;Bt++)mr(de.symbolInstances.get(Bt),Bt,de.collisionArrays[Bt]);if(re&&de.bucketInstanceId in this.collisionCircleArrays){const Bt=this.collisionCircleArrays[de.bucketInstanceId];t.invert(Bt.invProjMatrix,ye),Bt.viewportMatrix=this.collisionIndex.getViewportMatrix()}de.justReloaded=!1}markUsedJustification(G,Z,re,le){const{leftJustifiedTextSymbolIndex:de,centerJustifiedTextSymbolIndex:me,rightJustifiedTextSymbolIndex:ye,verticalPlacedTextSymbolIndex:be,crossTileID:qe}=re,Te=t.getAnchorJustification(Z),Fe=le===t.WritingMode.vertical?be:Te==="left"?de:Te==="center"?me:Te==="right"?ye:-1;de>=0&&(G.text.placedSymbolArray.get(de).crossTileID=Fe>=0&&de!==Fe?0:qe),me>=0&&(G.text.placedSymbolArray.get(me).crossTileID=Fe>=0&&me!==Fe?0:qe),ye>=0&&(G.text.placedSymbolArray.get(ye).crossTileID=Fe>=0&&ye!==Fe?0:qe),be>=0&&(G.text.placedSymbolArray.get(be).crossTileID=Fe>=0&&be!==Fe?0:qe)}markUsedOrientation(G,Z,re){const le=Z===t.WritingMode.horizontal||Z===t.WritingMode.horizontalOnly?Z:0,de=Z===t.WritingMode.vertical?Z:0,{leftJustifiedTextSymbolIndex:me,centerJustifiedTextSymbolIndex:ye,rightJustifiedTextSymbolIndex:be,verticalPlacedTextSymbolIndex:qe}=re,Te=G.text.placedSymbolArray;me>=0&&(Te.get(me).placedOrientation=le),ye>=0&&(Te.get(ye).placedOrientation=le),be>=0&&(Te.get(be).placedOrientation=le),qe>=0&&(Te.get(qe).placedOrientation=de)}commit(G){this.commitTime=G,this.zoomAtLastRecencyCheck=this.transform.zoom;const Z=this.prevPlacement;let re=!1;this.prevZoomAdjustment=Z?Z.zoomAdjustment(this.transform.zoom):0;const le=Z?Z.symbolFadeChange(G):1,de=Z?Z.opacities:{},me=Z?Z.variableOffsets:{},ye=Z?Z.placedOrientations:{};for(const be in this.placements){const qe=this.placements[be],Te=de[be];Te?(this.opacities[be]=new ya(Te,le,qe.text,qe.icon,null,qe.clipped),re=re||qe.text!==Te.text.placed||qe.icon!==Te.icon.placed):(this.opacities[be]=new ya(null,le,qe.text,qe.icon,qe.skipFade,qe.clipped),re=re||qe.text||qe.icon)}for(const be in de){const qe=de[be];if(!this.opacities[be]){const Te=new ya(qe,le,!1,!1);Te.isHidden()||(this.opacities[be]=Te,re=re||qe.text.placed||qe.icon.placed)}}for(const be in me)this.variableOffsets[be]||!this.opacities[be]||this.opacities[be].isHidden()||(this.variableOffsets[be]=me[be]);for(const be in ye)this.placedOrientations[be]||!this.opacities[be]||this.opacities[be].isHidden()||(this.placedOrientations[be]=ye[be]);re?this.lastPlacementChangeTime=G:typeof this.lastPlacementChangeTime!="number"&&(this.lastPlacementChangeTime=Z?Z.lastPlacementChangeTime:G)}updateLayerOpacities(G,Z){const re=new Set;for(const le of Z){const de=le.getBucket(G);de&&le.latestFeatureIndex&&G.id===de.layerIds[0]&&this.updateBucketOpacities(de,re,le.collisionBoxArray)}}updateBucketOpacities(G,Z,re){G.hasTextData()&&G.text.opacityVertexArray.clear(),G.hasIconData()&&G.icon.opacityVertexArray.clear(),G.hasIconCollisionBoxData()&&G.iconCollisionBox.collisionVertexArray.clear(),G.hasTextCollisionBoxData()&&G.textCollisionBox.collisionVertexArray.clear();const le=G.layers[0].layout,de=!!G.layers[0].dynamicFilter(),me=new ya(null,0,!1,!1,!0),ye=le.get("text-allow-overlap"),be=le.get("icon-allow-overlap"),qe=le.get("text-variable-anchor"),Te=le.get("text-rotation-alignment")==="map",Fe=le.get("text-pitch-alignment")==="map",$e=le.get("icon-text-fit")!=="none",Je=new ya(null,0,ye&&(be||!G.hasIconData()||le.get("icon-optional")),be&&(ye||!G.hasTextData()||le.get("text-optional")),!0);!G.collisionArrays&&re&&(G.hasIconCollisionBoxData()||G.hasTextCollisionBoxData())&&G.deserializeCollisionBoxes(re);const tt=(it,Be,Ye)=>{for(let lt=0;lt<Be/4;lt++)it.opacityVertexArray.emplaceBack(Ye)};let Qe=0;for(let it=0;it<G.symbolInstances.length;it++){const Be=G.symbolInstances.get(it),{numHorizontalGlyphVertices:Ye,numVerticalGlyphVertices:lt,crossTileID:ct,numIconVertices:Tt}=Be,Rt=Z.has(ct);let It=this.opacities[ct];Rt?It=me:It||(It=Je,this.opacities[ct]=It),Z.add(ct);const kt=Ye>0||lt>0,Dt=Tt>0,Vt=this.placedOrientations[ct],mr=Vt===t.WritingMode.vertical,Bt=Vt===t.WritingMode.horizontal||Vt===t.WritingMode.horizontalOnly;if(!kt&&!Dt||It.isHidden()||Qe++,kt){const nr=Go(It.text);tt(G.text,Ye,mr?rn:nr),tt(G.text,lt,Bt?rn:nr);const Ht=It.text.isHidden(),{leftJustifiedTextSymbolIndex:pr,centerJustifiedTextSymbolIndex:jt,rightJustifiedTextSymbolIndex:ir,verticalPlacedTextSymbolIndex:gr}=Be,ur=G.text.placedSymbolArray,xr=Ht||mr?1:0;pr>=0&&(ur.get(pr).hidden=xr),jt>=0&&(ur.get(jt).hidden=xr),ir>=0&&(ur.get(ir).hidden=xr),gr>=0&&(ur.get(gr).hidden=Ht||Bt?1:0);const Jr=this.variableOffsets[ct];Jr&&this.markUsedJustification(G,Jr.anchor,Be,Vt);const hi=this.placedOrientations[ct];hi&&(this.markUsedJustification(G,"left",Be,hi),this.markUsedOrientation(G,hi,Be))}if(Dt){const nr=Go(It.icon),{placedIconSymbolIndex:Ht,verticalPlacedIconSymbolIndex:pr}=Be,jt=G.icon.placedSymbolArray,ir=It.icon.isHidden()?1:0;Ht>=0&&(tt(G.icon,Tt,mr?rn:nr),jt.get(Ht).hidden=ir),pr>=0&&(tt(G.icon,Be.numVerticalIconVertices,Bt?rn:nr),jt.get(pr).hidden=ir)}if(G.hasIconCollisionBoxData()||G.hasTextCollisionBoxData()){const nr=G.collisionArrays[it];if(nr){let Ht=new t.Point(0,0),pr=!0;if(nr.textBox||nr.verticalTextBox){if(qe){const ir=this.variableOffsets[ct];ir?(Ht=Uo(ir.anchor,ir.width,ir.height,ir.textOffset,ir.textScale),Te&&Ht._rotate(Fe?this.transform.angle:-this.transform.angle)):pr=!1}de&&(pr=!It.clipped),nr.textBox&&co(G.textCollisionBox.collisionVertexArray,It.text.placed,!pr||mr,Ht.x,Ht.y),nr.verticalTextBox&&co(G.textCollisionBox.collisionVertexArray,It.text.placed,!pr||Bt,Ht.x,Ht.y)}const jt=pr&&!!(!Bt&&nr.verticalIconBox);nr.iconBox&&co(G.iconCollisionBox.collisionVertexArray,It.icon.placed,jt,$e?Ht.x:0,$e?Ht.y:0),nr.verticalIconBox&&co(G.iconCollisionBox.collisionVertexArray,It.icon.placed,!jt,$e?Ht.x:0,$e?Ht.y:0)}}}if(G.fullyClipped=Qe===0,G.sortFeatures(this.transform.angle),this.retainedQueryData[G.bucketInstanceId]&&(this.retainedQueryData[G.bucketInstanceId].featureSortOrder=G.featureSortOrder),G.hasTextData()&&G.text.opacityVertexBuffer&&G.text.opacityVertexBuffer.updateData(G.text.opacityVertexArray),G.hasIconData()&&G.icon.opacityVertexBuffer&&G.icon.opacityVertexBuffer.updateData(G.icon.opacityVertexArray),G.hasIconCollisionBoxData()&&G.iconCollisionBox.collisionVertexBuffer&&G.iconCollisionBox.collisionVertexBuffer.updateData(G.iconCollisionBox.collisionVertexArray),G.hasTextCollisionBoxData()&&G.textCollisionBox.collisionVertexBuffer&&G.textCollisionBox.collisionVertexBuffer.updateData(G.textCollisionBox.collisionVertexArray),G.bucketInstanceId in this.collisionCircleArrays){const it=this.collisionCircleArrays[G.bucketInstanceId];G.placementInvProjMatrix=it.invProjMatrix,G.placementViewportMatrix=it.viewportMatrix,G.collisionCircleArray=it.circles,delete this.collisionCircleArrays[G.bucketInstanceId]}}symbolFadeChange(G){return this.fadeDuration===0?1:(G-this.commitTime)/this.fadeDuration+this.prevZoomAdjustment}zoomAdjustment(G){return Math.max(0,(this.transform.zoom-G)/1.5)}hasTransitions(G){return this.stale||G-this.lastPlacementChangeTime<this.fadeDuration}stillRecent(G,Z){const re=this.zoomAtLastRecencyCheck===Z?1-this.zoomAdjustment(Z):1;return this.zoomAtLastRecencyCheck=Z,this.commitTime+this.fadeDuration*re>G}setStale(){this.stale=!0}}function co(J,G,Z,re,le){J.emplaceBack(G?1:0,Z?1:0,re||0,le||0),J.emplaceBack(G?1:0,Z?1:0,re||0,le||0),J.emplaceBack(G?1:0,Z?1:0,re||0,le||0),J.emplaceBack(G?1:0,Z?1:0,re||0,le||0)}const Pn=Math.pow(2,25),sn=Math.pow(2,24),wu=Math.pow(2,17),Su=Math.pow(2,16),Mn=Math.pow(2,9),Wn=Math.pow(2,8),Jl=Math.pow(2,1);function Go(J){if(J.opacity===0&&!J.placed)return 0;if(J.opacity===1&&J.placed)return 4294967295;const G=J.placed?1:0,Z=Math.floor(127*J.opacity);return Z*Pn+G*sn+Z*wu+G*Su+Z*Mn+G*Wn+Z*Jl+G}const rn=0;class $o{constructor(G){this._sortAcrossTiles=G.layout.get("symbol-z-order")!=="viewport-y"&&G.layout.get("symbol-sort-key").constantOr(1)!==void 0,this._currentTileIndex=0,this._currentPartIndex=0,this._seenCrossTileIDs=new Set,this._bucketParts=[]}continuePlacement(G,Z,re,le,de){const me=this._bucketParts;for(;this._currentTileIndex<G.length;)if(Z.getBucketParts(me,le,G[this._currentTileIndex],this._sortAcrossTiles),this._currentTileIndex++,de())return!0;for(this._sortAcrossTiles&&(this._sortAcrossTiles=!1,me.sort((ye,be)=>ye.sortKey-be.sortKey));this._currentPartIndex<me.length;){const ye=me[this._currentPartIndex];if(Z.placeLayerBucketPart(ye,this._seenCrossTileIDs,re,ye.symbolInstanceStart===0),this._currentPartIndex++,de())return!0}return!1}}class Tu{constructor(G,Z,re,le,de,me,ye,be){this.placement=new Ts(G,de,me,ye,be),this._currentPlacementIndex=Z.length-1,this._forceFullPlacement=re,this._showCollisionBoxes=le,this._done=!1}isDone(){return this._done}continuePlacement(G,Z,re){const le=t.exported.now(),de=()=>{const me=t.exported.now()-le;return!this._forceFullPlacement&&me>2};for(;this._currentPlacementIndex>=0;){const me=Z[G[this._currentPlacementIndex]],ye=this.placement.collisionIndex.transform.zoom;if(me.type==="symbol"&&(!me.minzoom||me.minzoom<=ye)&&(!me.maxzoom||me.maxzoom>ye)){if(this._inProgressLayer||(this._inProgressLayer=new $o(me)),this._inProgressLayer.continuePlacement(re[me.source],this.placement,this._showCollisionBoxes,me,de))return;delete this._inProgressLayer}this._currentPlacementIndex--}this._done=!0}commit(G){return this.placement.commit(G),this.placement}}const Ha=512/t.EXTENT/2;class wn{constructor(G,Z,re){this.tileID=G,this.bucketInstanceId=re,this.index=new t.KDBush(Z.length,16,Int32Array),this.keys=[],this.crossTileIDs=[];const le=G.canonical.x*t.EXTENT,de=G.canonical.y*t.EXTENT;for(let me=0;me<Z.length;me++){const{key:ye,crossTileID:be,tileAnchorX:qe,tileAnchorY:Te}=Z.get(me),Fe=Math.floor((le+qe)*Ha),$e=Math.floor((de+Te)*Ha);this.index.add(Fe,$e),this.keys.push(ye),this.crossTileIDs.push(be)}this.index.finish()}findMatches(G,Z,re){const le=this.tileID.canonical.z<Z.canonical.z?1:Math.pow(2,this.tileID.canonical.z-Z.canonical.z),de=Ha/Math.pow(2,Z.canonical.z-this.tileID.canonical.z),me=Z.canonical.x*t.EXTENT,ye=Z.canonical.y*t.EXTENT;for(let be=0;be<G.length;be++){const qe=G.get(be);if(qe.crossTileID)continue;const{key:Te,tileAnchorX:Fe,tileAnchorY:$e}=qe,Je=Math.floor((me+Fe)*de),tt=Math.floor((ye+$e)*de),Qe=this.index.range(Je-le,tt-le,Je+le,tt+le);for(const it of Qe){const Be=this.crossTileIDs[it];if(this.keys[it]===Te&&!re.has(Be)){re.add(Be),qe.crossTileID=Be;break}}}}}class qu{constructor(){this.maxCrossTileID=0}generate(){return++this.maxCrossTileID}}class Iu{constructor(){this.indexes={},this.usedCrossTileIDs={},this.lng=0}handleWrapJump(G){const Z=Math.round((G-this.lng)/360);if(Z!==0)for(const re in this.indexes){const le=this.indexes[re],de={};for(const me in le){const ye=le[me];ye.tileID=ye.tileID.unwrapTo(ye.tileID.wrap+Z),de[ye.tileID.key]=ye}this.indexes[re]=de}this.lng=G}addBucket(G,Z,re){if(this.indexes[G.overscaledZ]&&this.indexes[G.overscaledZ][G.key]){if(this.indexes[G.overscaledZ][G.key].bucketInstanceId===Z.bucketInstanceId)return!1;this.removeBucketCrossTileIDs(G.overscaledZ,this.indexes[G.overscaledZ][G.key])}for(let de=0;de<Z.symbolInstances.length;de++)Z.symbolInstances.get(de).crossTileID=0;this.usedCrossTileIDs[G.overscaledZ]||(this.usedCrossTileIDs[G.overscaledZ]=new Set);const le=this.usedCrossTileIDs[G.overscaledZ];for(const de in this.indexes){const me=this.indexes[de];if(Number(de)>G.overscaledZ)for(const ye in me){const be=me[ye];be.tileID.isChildOf(G)&&be.findMatches(Z.symbolInstances,G,le)}else{const ye=me[G.scaledTo(Number(de)).key];ye&&ye.findMatches(Z.symbolInstances,G,le)}}for(let de=0;de<Z.symbolInstances.length;de++){const me=Z.symbolInstances.get(de);me.crossTileID||(me.crossTileID=re.generate(),le.add(me.crossTileID))}return this.indexes[G.overscaledZ]===void 0&&(this.indexes[G.overscaledZ]={}),this.indexes[G.overscaledZ][G.key]=new wn(G,Z.symbolInstances,Z.bucketInstanceId),!0}removeBucketCrossTileIDs(G,Z){for(const re of Z.crossTileIDs)this.usedCrossTileIDs[G].delete(re)}removeStaleBuckets(G){let Z=!1;for(const re in this.indexes){const le=this.indexes[re];for(const de in le)G[le[de].bucketInstanceId]||(this.removeBucketCrossTileIDs(re,le[de]),delete le[de],Z=!0)}return Z}}class ga{constructor(){this.layerIndexes={},this.crossTileIDs=new qu,this.maxBucketInstanceId=0,this.bucketsInCurrentPlacement={}}addLayer(G,Z,re,le){let de=this.layerIndexes[G.id];de===void 0&&(de=this.layerIndexes[G.id]=new Iu);let me=!1;const ye={};le.name!=="globe"&&de.handleWrapJump(re);for(const be of Z){const qe=be.getBucket(G);qe&&G.id===qe.layerIds[0]&&(qe.bucketInstanceId||(qe.bucketInstanceId=++this.maxBucketInstanceId),de.addBucket(be.tileID,qe,this.crossTileIDs)&&(me=!0),ye[qe.bucketInstanceId]=!0)}return de.removeStaleBuckets(ye)&&(me=!0),me}pruneUnusedLayers(G){const Z={};G.forEach(re=>{Z[re]=!0});for(const re in this.layerIndexes)Z[re]||delete this.layerIndexes[re]}}const La=(J,G)=>t.emitValidationErrors(J,G&&G.filter(Z=>Z.identifier!=="source.canvas")),qs=t.pick(zr,["addLayer","removeLayer","setPaintProperty","setLayoutProperty","setFilter","addSource","removeSource","setLayerZoomRange","setLight","setTransition","setGeoJSONSourceData","setTerrain","setFog","setProjection"]),gh=t.pick(zr,["setCenter","setZoom","setBearing","setPitch"]),Au={version:8,layers:[],sources:{}},ho={fill:!0,line:!0,background:!0,hillshade:!0,raster:!0};class ua extends t.Evented{constructor(G,Z={}){super(),this.map=G,this.dispatcher=new wt(Xt(),this),this.imageManager=new _t,this.imageManager.setEventedParent(this),this.glyphManager=new t.GlyphManager(G._requestManager,Z.localFontFamily?t.LocalGlyphMode.all:Z.localIdeographFontFamily?t.LocalGlyphMode.ideographs:t.LocalGlyphMode.none,Z.localFontFamily||Z.localIdeographFontFamily),this.crossTileSymbolIndex=new ga,this._layers={},this._num3DLayers=0,this._numSymbolLayers=0,this._numCircleLayers=0,this._serializedLayers={},this._sourceCaches={},this._otherSourceCaches={},this._symbolSourceCaches={},this._loaded=!1,this._availableImages=[],this._order=[],this._drapedFirstOrder=[],this._markersNeedUpdate=!1,this._resetUpdates(),this.dispatcher.broadcast("setReferrer",t.getReferrer());const re=this;this._rtlTextPluginCallback=ua.registerForPluginStateChange(le=>{re.dispatcher.broadcast("syncRTLPluginState",{pluginStatus:le.pluginStatus,pluginURL:le.pluginURL},(de,me)=>{if(t.triggerPluginCompletionEvent(de),me&&me.every(ye=>ye))for(const ye in re._sourceCaches){const be=re._sourceCaches[ye],qe=be.getSource().type;qe!=="vector"&&qe!=="geojson"||be.reload()}})}),this.on("data",le=>{if(le.dataType!=="source"||le.sourceDataType!=="metadata")return;const de=this.getSource(le.sourceId);if(de&&de.vectorLayerIds)for(const me in this._layers){const ye=this._layers[me];ye.source===de.id&&this._validateLayer(ye)}})}loadURL(G,Z={}){this.fire(new t.Event("dataloading",{dataType:"style"}));const re=typeof Z.validate=="boolean"?Z.validate:!t.isMapboxURL(G);G=this.map._requestManager.normalizeStyleURL(G,Z.accessToken);const le=this.map._requestManager.transformRequest(G,t.ResourceType.Style);this._request=t.getJSON(le,(de,me)=>{this._request=null,de?this.fire(new t.ErrorEvent(de)):me&&this._load(me,re)})}loadJSON(G,Z={}){this.fire(new t.Event("dataloading",{dataType:"style"})),this._request=t.exported.frame(()=>{this._request=null,this._load(G,Z.validate!==!1)})}loadEmpty(){this.fire(new t.Event("dataloading",{dataType:"style"})),this._load(Au,!1)}_updateLayerCount(G,Z){const re=Z?1:-1;G.is3D()&&(this._num3DLayers+=re),G.type==="circle"&&(this._numCircleLayers+=re),G.type==="symbol"&&(this._numSymbolLayers+=re)}_load(G,Z){if(Z&&La(this,t.validateStyle(G)))return;this._loaded=!0,this.stylesheet=t.clone$1(G),this._updateMapProjection();for(const le in G.sources)this.addSource(le,G.sources[le],{validate:!1});this._changed=!1,G.sprite?this._loadSprite(G.sprite):(this.imageManager.setLoaded(!0),this.dispatcher.broadcast("spriteLoaded",!0)),this.glyphManager.setURL(G.glyphs);const re=wr(this.stylesheet.layers);this._order=re.map(le=>le.id),this._layers={},this._serializedLayers={};for(const le of re){const de=t.createStyleLayer(le);de.setEventedParent(this,{layer:{id:de.id}}),this._layers[de.id]=de,this._serializedLayers[de.id]=de.serialize(),this._updateLayerCount(de,!0)}this.dispatcher.broadcast("setLayers",this._serializeLayers(this._order)),this.light=new yt(this.stylesheet.light),this.stylesheet.terrain&&!this.terrainSetForDrapingOnly()&&this._createTerrain(this.stylesheet.terrain,1),this.stylesheet.fog&&this._createFog(this.stylesheet.fog),this._updateDrapeFirstLayers(),this.fire(new t.Event("data",{dataType:"style"})),this.fire(new t.Event("style.load"))}terrainSetForDrapingOnly(){return!!this.terrain&&this.terrain.drapeRenderMode===0}setProjection(G){G?this.stylesheet.projection=G:delete this.stylesheet.projection,this._updateMapProjection()}applyProjectionUpdate(){this._loaded&&(this.dispatcher.broadcast("setProjection",this.map.transform.projectionOptions),this.map.transform.projection.requiresDraping?this.getTerrain()||this.stylesheet.terrain||this.setTerrainForDraping():this.terrainSetForDrapingOnly()&&this.setTerrain(null))}_updateMapProjection(){this.map._useExplicitProjection?this.applyProjectionUpdate():this.map._prioritizeAndUpdateProjection(null,this.stylesheet.projection)}_loadSprite(G){this._spriteRequest=function(Z,re,le){let de,me,ye;const be=t.exported.devicePixelRatio>1?"@2x":"";let qe=t.getJSON(re.transformRequest(re.normalizeSpriteURL(Z,be,".json"),t.ResourceType.SpriteJSON),($e,Je)=>{qe=null,ye||(ye=$e,de=Je,Fe())}),Te=t.getImage(re.transformRequest(re.normalizeSpriteURL(Z,be,".png"),t.ResourceType.SpriteImage),($e,Je)=>{Te=null,ye||(ye=$e,me=Je,Fe())});function Fe(){if(ye)le(ye);else if(de&&me){const $e=t.exported.getImageData(me),Je={};for(const tt in de){const{width:Qe,height:it,x:Be,y:Ye,sdf:lt,pixelRatio:ct,stretchX:Tt,stretchY:Rt,content:It}=de[tt],kt=new t.RGBAImage({width:Qe,height:it});t.RGBAImage.copy($e,kt,{x:Be,y:Ye},{x:0,y:0},{width:Qe,height:it}),Je[tt]={data:kt,pixelRatio:ct,sdf:lt,stretchX:Tt,stretchY:Rt,content:It}}le(null,Je)}}return{cancel(){qe&&(qe.cancel(),qe=null),Te&&(Te.cancel(),Te=null)}}}(G,this.map._requestManager,(Z,re)=>{if(this._spriteRequest=null,Z)this.fire(new t.ErrorEvent(Z));else if(re)for(const le in re)this.imageManager.addImage(le,re[le]);this.imageManager.setLoaded(!0),this._availableImages=this.imageManager.listImages(),this.dispatcher.broadcast("setImages",this._availableImages),this.dispatcher.broadcast("spriteLoaded",!0),this.fire(new t.Event("data",{dataType:"style"}))})}_validateLayer(G){const Z=this.getSource(G.source);if(!Z)return;const re=G.sourceLayer;re&&(Z.type==="geojson"||Z.vectorLayerIds&&Z.vectorLayerIds.indexOf(re)===-1)&&this.fire(new t.ErrorEvent(new Error(`Source layer "${re}" does not exist on source "${Z.id}" as specified by style layer "${G.id}"`)))}loaded(){if(!this._loaded||Object.keys(this._updatedSources).length)return!1;for(const G in this._sourceCaches)if(!this._sourceCaches[G].loaded())return!1;return!!this.imageManager.isLoaded()}_serializeLayers(G){const Z=[];for(const re of G){const le=this._layers[re];le.type!=="custom"&&Z.push(le.serialize())}return Z}hasTransitions(){if(this.light&&this.light.hasTransition()||this.fog&&this.fog.hasTransition())return!0;for(const G in this._sourceCaches)if(this._sourceCaches[G].hasTransition())return!0;for(const G in this._layers)if(this._layers[G].hasTransition())return!0;return!1}get order(){return this.map._optimizeForTerrain&&this.terrain?this._drapedFirstOrder:this._order}isLayerDraped(G){return!!this.terrain&&(typeof G.isLayerDraped=="function"?G.isLayerDraped():ho[G.type])}_checkLoaded(){if(!this._loaded)throw new Error("Style is not done loading")}update(G){if(!this._loaded)return;const Z=this._changed;if(this._changed){const le=Object.keys(this._updatedLayers),de=Object.keys(this._removedLayers);(le.length||de.length)&&this._updateWorkerLayers(le,de);for(const me in this._updatedSources){const ye=this._updatedSources[me];ye==="reload"?this._reloadSource(me):ye==="clear"&&this._clearSource(me)}this._updateTilesForChangedImages();for(const me in this._updatedPaintProps)this._layers[me].updateTransitions(G);this.light.updateTransitions(G),this.fog&&this.fog.updateTransitions(G),this._resetUpdates()}const re={};for(const le in this._sourceCaches){const de=this._sourceCaches[le];re[le]=de.used,de.used=!1}for(const le of this._order){const de=this._layers[le];if(de.recalculate(G,this._availableImages),!de.isHidden(G.zoom)){const ye=this._getLayerSourceCache(de);ye&&(ye.used=!0)}const me=this.map.painter;if(me){const ye=de.getProgramIds();if(!ye)continue;const be=de.getProgramConfiguration(G.zoom);for(const qe of ye)me.useProgram(qe,be)}}for(const le in re){const de=this._sourceCaches[le];re[le]!==de.used&&de.getSource().fire(new t.Event("data",{sourceDataType:"visibility",dataType:"source",sourceId:de.getSource().id}))}this.light.recalculate(G),this.terrain&&this.terrain.recalculate(G),this.fog&&this.fog.recalculate(G),this.z=G.zoom,this._markersNeedUpdate&&(this._updateMarkersOpacity(),this._markersNeedUpdate=!1),Z&&this.fire(new t.Event("data",{dataType:"style"}))}_updateTilesForChangedImages(){const G=Object.keys(this._changedImages);if(G.length){for(const Z in this._sourceCaches)this._sourceCaches[Z].reloadTilesForDependencies(["icons","patterns"],G);this._changedImages={}}}_updateWorkerLayers(G,Z){this.dispatcher.broadcast("updateLayers",{layers:this._serializeLayers(G),removedIds:Z})}_resetUpdates(){this._changed=!1,this._updatedLayers={},this._removedLayers={},this._updatedSources={},this._updatedPaintProps={},this._changedImages={}}setState(G){if(this._checkLoaded(),La(this,t.validateStyle(G)))return!1;(G=t.clone$1(G)).layers=wr(G.layers);const Z=function(le,de){if(!le)return[{command:zr.setStyle,args:[de]}];let me=[];try{if(!H(le.version,de.version))return[{command:zr.setStyle,args:[de]}];H(le.center,de.center)||me.push({command:zr.setCenter,args:[de.center]}),H(le.zoom,de.zoom)||me.push({command:zr.setZoom,args:[de.zoom]}),H(le.bearing,de.bearing)||me.push({command:zr.setBearing,args:[de.bearing]}),H(le.pitch,de.pitch)||me.push({command:zr.setPitch,args:[de.pitch]}),H(le.sprite,de.sprite)||me.push({command:zr.setSprite,args:[de.sprite]}),H(le.glyphs,de.glyphs)||me.push({command:zr.setGlyphs,args:[de.glyphs]}),H(le.transition,de.transition)||me.push({command:zr.setTransition,args:[de.transition]}),H(le.light,de.light)||me.push({command:zr.setLight,args:[de.light]}),H(le.fog,de.fog)||me.push({command:zr.setFog,args:[de.fog]}),H(le.projection,de.projection)||me.push({command:zr.setProjection,args:[de.projection]});const ye={},be=[];(function(Fe,$e,Je,tt){let Qe;for(Qe in $e=$e||{},Fe=Fe||{})Fe.hasOwnProperty(Qe)&&($e.hasOwnProperty(Qe)||Zi(Qe,Je,tt));for(Qe in $e){if(!$e.hasOwnProperty(Qe))continue;const it=$e[Qe];Fe.hasOwnProperty(Qe)?H(Fe[Qe],it)||(Fe[Qe].type==="geojson"&&it.type==="geojson"&&an(Fe,$e,Qe)?Je.push({command:zr.setGeoJSONSourceData,args:[Qe,it.data]}):en(Qe,$e,Je,tt)):Yr(Qe,$e,Je)}})(le.sources,de.sources,be,ye);const qe=[];le.layers&&le.layers.forEach(Fe=>{Fe.source&&ye[Fe.source]?me.push({command:zr.removeLayer,args:[Fe.id]}):qe.push(Fe)});let Te=le.terrain;Te&&ye[Te.source]&&(me.push({command:zr.setTerrain,args:[void 0]}),Te=void 0),me=me.concat(be),H(Te,de.terrain)||me.push({command:zr.setTerrain,args:[de.terrain]}),function(Fe,$e,Je){$e=$e||[];const tt=(Fe=Fe||[]).map(qr),Qe=$e.map(qr),it=Fe.reduce(on,{}),Be=$e.reduce(on,{}),Ye=tt.slice(),lt=Object.create(null);let ct,Tt,Rt,It,kt,Dt,Vt;for(ct=0,Tt=0;ct<tt.length;ct++)Rt=tt[ct],Be.hasOwnProperty(Rt)?Tt++:(Je.push({command:zr.removeLayer,args:[Rt]}),Ye.splice(Ye.indexOf(Rt,Tt),1));for(ct=0,Tt=0;ct<Qe.length;ct++)Rt=Qe[Qe.length-1-ct],Ye[Ye.length-1-ct]!==Rt&&(it.hasOwnProperty(Rt)?(Je.push({command:zr.removeLayer,args:[Rt]}),Ye.splice(Ye.lastIndexOf(Rt,Ye.length-Tt),1)):Tt++,Dt=Ye[Ye.length-ct],Je.push({command:zr.addLayer,args:[Be[Rt],Dt]}),Ye.splice(Ye.length-ct,0,Rt),lt[Rt]=!0);for(ct=0;ct<Qe.length;ct++)if(Rt=Qe[ct],It=it[Rt],kt=Be[Rt],!lt[Rt]&&!H(It,kt))if(H(It.source,kt.source)&&H(It["source-layer"],kt["source-layer"])&&H(It.type,kt.type)){for(Vt in tn(It.layout,kt.layout,Je,Rt,null,zr.setLayoutProperty),tn(It.paint,kt.paint,Je,Rt,null,zr.setPaintProperty),H(It.filter,kt.filter)||Je.push({command:zr.setFilter,args:[Rt,kt.filter]}),H(It.minzoom,kt.minzoom)&&H(It.maxzoom,kt.maxzoom)||Je.push({command:zr.setLayerZoomRange,args:[Rt,kt.minzoom,kt.maxzoom]}),It)It.hasOwnProperty(Vt)&&Vt!=="layout"&&Vt!=="paint"&&Vt!=="filter"&&Vt!=="metadata"&&Vt!=="minzoom"&&Vt!=="maxzoom"&&(Vt.indexOf("paint.")===0?tn(It[Vt],kt[Vt],Je,Rt,Vt.slice(6),zr.setPaintProperty):H(It[Vt],kt[Vt])||Je.push({command:zr.setLayerProperty,args:[Rt,Vt,kt[Vt]]}));for(Vt in kt)kt.hasOwnProperty(Vt)&&!It.hasOwnProperty(Vt)&&Vt!=="layout"&&Vt!=="paint"&&Vt!=="filter"&&Vt!=="metadata"&&Vt!=="minzoom"&&Vt!=="maxzoom"&&(Vt.indexOf("paint.")===0?tn(It[Vt],kt[Vt],Je,Rt,Vt.slice(6),zr.setPaintProperty):H(It[Vt],kt[Vt])||Je.push({command:zr.setLayerProperty,args:[Rt,Vt,kt[Vt]]}))}else Je.push({command:zr.removeLayer,args:[Rt]}),Dt=Ye[Ye.lastIndexOf(Rt)+1],Je.push({command:zr.addLayer,args:[kt,Dt]})}(qe,de.layers,me)}catch(ye){console.warn("Unable to compute style diff:",ye),me=[{command:zr.setStyle,args:[de]}]}return me}(this.serialize(),G).filter(le=>!(le.command in gh));if(Z.length===0)return!1;const re=Z.filter(le=>!(le.command in qs));if(re.length>0)throw new Error(`Unimplemented: ${re.map(le=>le.command).join(", ")}.`);return Z.forEach(le=>{le.command!=="setTransition"&&le.command!=="setProjection"&&this[le.command].apply(this,le.args)}),this.stylesheet=G,this._updateMapProjection(),!0}addImage(G,Z){return this.getImage(G)?this.fire(new t.ErrorEvent(new Error("An image with this name already exists."))):(this.imageManager.addImage(G,Z),this._afterImageUpdated(G),this)}updateImage(G,Z){this.imageManager.updateImage(G,Z)}getImage(G){return this.imageManager.getImage(G)}removeImage(G){return this.getImage(G)?(this.imageManager.removeImage(G),this._afterImageUpdated(G),this):this.fire(new t.ErrorEvent(new Error("No image with this name exists.")))}_afterImageUpdated(G){this._availableImages=this.imageManager.listImages(),this._changedImages[G]=!0,this._changed=!0,this.dispatcher.broadcast("setImages",this._availableImages),this.fire(new t.Event("data",{dataType:"style"}))}listImages(){return this._checkLoaded(),this._availableImages.slice()}addSource(G,Z,re={}){if(this._checkLoaded(),this.getSource(G)!==void 0)throw new Error("There is already a source with this ID");if(!Z.type)throw new Error(`The type property must be defined, but only the following properties were given: ${Object.keys(Z).join(", ")}.`);if(["vector","raster","geojson","video","image"].indexOf(Z.type)>=0&&this._validate(t.validateSource,`sources.${G}`,Z,null,re))return;this.map&&this.map._collectResourceTiming&&(Z.collectResourceTiming=!0);const le=oi(G,Z,this.dispatcher,this);le.setEventedParent(this,()=>({isSourceLoaded:this._isSourceCacheLoaded(G),source:le.serialize(),sourceId:G}));const de=me=>{const ye=(me?"symbol:":"other:")+G,be=this._sourceCaches[ye]=new t.SourceCache(ye,le,me);(me?this._symbolSourceCaches:this._otherSourceCaches)[G]=be,be.style=this,be.onAdd(this.map)};de(!1),Z.type!=="vector"&&Z.type!=="geojson"||de(!0),le.onAdd&&le.onAdd(this.map),this._changed=!0}removeSource(G){this._checkLoaded();const Z=this.getSource(G);if(!Z)throw new Error("There is no source with this ID");for(const le in this._layers)if(this._layers[le].source===G)return this.fire(new t.ErrorEvent(new Error(`Source "${G}" cannot be removed while layer "${le}" is using it.`)));if(this.terrain&&this.terrain.get().source===G)return this.fire(new t.ErrorEvent(new Error(`Source "${G}" cannot be removed while terrain is using it.`)));const re=this._getSourceCaches(G);for(const le of re)delete this._sourceCaches[le.id],delete this._updatedSources[le.id],le.fire(new t.Event("data",{sourceDataType:"metadata",dataType:"source",sourceId:le.getSource().id})),le.setEventedParent(null),le.clearTiles();return delete this._otherSourceCaches[G],delete this._symbolSourceCaches[G],Z.setEventedParent(null),Z.onRemove&&Z.onRemove(this.map),this._changed=!0,this}setGeoJSONSourceData(G,Z){this._checkLoaded(),this.getSource(G).setData(Z),this._changed=!0}getSource(G){const Z=this._getSourceCache(G);return Z&&Z.getSource()}_getSources(){const G=[];for(const Z in this._otherSourceCaches){const re=this._getSourceCache(Z);re&&G.push(re.getSource())}return G}addLayer(G,Z,re={}){this._checkLoaded();const le=G.id;if(this.getLayer(le))return void this.fire(new t.ErrorEvent(new Error(`Layer with id "${le}" already exists on this map`)));let de;if(G.type==="custom"){if(La(this,t.validateCustomStyleLayer(G)))return;de=t.createStyleLayer(G)}else{if(typeof G.source=="object"&&(this.addSource(le,G.source),G=t.clone$1(G),G=t.extend(G,{source:le})),this._validate(t.validateLayer,`layers.${le}`,G,{arrayIndex:-1},re))return;de=t.createStyleLayer(G),this._validateLayer(de),de.setEventedParent(this,{layer:{id:le}}),this._serializedLayers[de.id]=de.serialize(),this._updateLayerCount(de,!0)}const me=Z?this._order.indexOf(Z):this._order.length;if(Z&&me===-1)return void this.fire(new t.ErrorEvent(new Error(`Layer with id "${Z}" does not exist on this map.`)));this._order.splice(me,0,le),this._layerOrderChanged=!0,this._layers[le]=de;const ye=this._getLayerSourceCache(de);if(this._removedLayers[le]&&de.source&&ye&&de.type!=="custom"){const be=this._removedLayers[le];delete this._removedLayers[le],be.type!==de.type?this._updatedSources[de.source]="clear":(this._updatedSources[de.source]="reload",ye.pause())}this._updateLayer(de),de.onAdd&&de.onAdd(this.map),this._updateDrapeFirstLayers()}moveLayer(G,Z){if(this._checkLoaded(),this._changed=!0,!this._layers[G])return void this.fire(new t.ErrorEvent(new Error(`The layer '${G}' does not exist in the map's style and cannot be moved.`)));if(G===Z)return;const re=this._order.indexOf(G);this._order.splice(re,1);const le=Z?this._order.indexOf(Z):this._order.length;Z&&le===-1?this.fire(new t.ErrorEvent(new Error(`Layer with id "${Z}" does not exist on this map.`))):(this._order.splice(le,0,G),this._layerOrderChanged=!0,this._updateDrapeFirstLayers())}removeLayer(G){this._checkLoaded();const Z=this._layers[G];if(!Z)return void this.fire(new t.ErrorEvent(new Error(`The layer '${G}' does not exist in the map's style and cannot be removed.`)));Z.setEventedParent(null),this._updateLayerCount(Z,!1);const re=this._order.indexOf(G);this._order.splice(re,1),this._layerOrderChanged=!0,this._changed=!0,this._removedLayers[G]=Z,delete this._layers[G],delete this._serializedLayers[G],delete this._updatedLayers[G],delete this._updatedPaintProps[G],Z.onRemove&&Z.onRemove(this.map),this._updateDrapeFirstLayers()}getLayer(G){return this._layers[G]}hasLayer(G){return G in this._layers}hasLayerType(G){for(const Z in this._layers)if(this._layers[Z].type===G)return!0;return!1}setLayerZoomRange(G,Z,re){this._checkLoaded();const le=this.getLayer(G);le?le.minzoom===Z&&le.maxzoom===re||(Z!=null&&(le.minzoom=Z),re!=null&&(le.maxzoom=re),this._updateLayer(le)):this.fire(new t.ErrorEvent(new Error(`The layer '${G}' does not exist in the map's style and cannot have zoom extent.`)))}setFilter(G,Z,re={}){this._checkLoaded();const le=this.getLayer(G);if(le){if(!H(le.filter,Z))return Z==null?(le.filter=void 0,void this._updateLayer(le)):void(this._validate(t.validateFilter,`layers.${le.id}.filter`,Z,{layerType:le.type},re)||(le.filter=t.clone$1(Z),this._updateLayer(le)))}else this.fire(new t.ErrorEvent(new Error(`The layer '${G}' does not exist in the map's style and cannot be filtered.`)))}getFilter(G){const Z=this.getLayer(G);return Z&&t.clone$1(Z.filter)}setLayoutProperty(G,Z,re,le={}){this._checkLoaded();const de=this.getLayer(G);de?H(de.getLayoutProperty(Z),re)||(de.setLayoutProperty(Z,re,le),this._updateLayer(de)):this.fire(new t.ErrorEvent(new Error(`The layer '${G}' does not exist in the map's style and cannot be styled.`)))}getLayoutProperty(G,Z){const re=this.getLayer(G);if(re)return re.getLayoutProperty(Z);this.fire(new t.ErrorEvent(new Error(`The layer '${G}' does not exist in the map's style.`)))}setPaintProperty(G,Z,re,le={}){this._checkLoaded();const de=this.getLayer(G);de?H(de.getPaintProperty(Z),re)||(de.setPaintProperty(Z,re,le)&&this._updateLayer(de),this._changed=!0,this._updatedPaintProps[G]=!0):this.fire(new t.ErrorEvent(new Error(`The layer '${G}' does not exist in the map's style and cannot be styled.`)))}getPaintProperty(G,Z){const re=this.getLayer(G);return re&&re.getPaintProperty(Z)}setFeatureState(G,Z){this._checkLoaded();const re=G.source,le=G.sourceLayer,de=this.getSource(re);if(!de)return void this.fire(new t.ErrorEvent(new Error(`The source '${re}' does not exist in the map's style.`)));const me=de.type;if(me==="geojson"&&le)return void this.fire(new t.ErrorEvent(new Error("GeoJSON sources cannot have a sourceLayer parameter.")));if(me==="vector"&&!le)return void this.fire(new t.ErrorEvent(new Error("The sourceLayer parameter must be provided for vector source types.")));G.id===void 0&&this.fire(new t.ErrorEvent(new Error("The feature id parameter must be provided.")));const ye=this._getSourceCaches(re);for(const be of ye)be.setFeatureState(le,G.id,Z)}removeFeatureState(G,Z){this._checkLoaded();const re=G.source,le=this.getSource(re);if(!le)return void this.fire(new t.ErrorEvent(new Error(`The source '${re}' does not exist in the map's style.`)));const de=le.type,me=de==="vector"?G.sourceLayer:void 0;if(de==="vector"&&!me)return void this.fire(new t.ErrorEvent(new Error("The sourceLayer parameter must be provided for vector source types.")));if(Z&&typeof G.id!="string"&&typeof G.id!="number")return void this.fire(new t.ErrorEvent(new Error("A feature id is required to remove its specific state property.")));const ye=this._getSourceCaches(re);for(const be of ye)be.removeFeatureState(me,G.id,Z)}getFeatureState(G){this._checkLoaded();const Z=G.source,re=G.sourceLayer,le=this.getSource(Z);if(le){if(le.type!=="vector"||re)return G.id===void 0&&this.fire(new t.ErrorEvent(new Error("The feature id parameter must be provided."))),this._getSourceCaches(Z)[0].getFeatureState(re,G.id);this.fire(new t.ErrorEvent(new Error("The sourceLayer parameter must be provided for vector source types.")))}else this.fire(new t.ErrorEvent(new Error(`The source '${Z}' does not exist in the map's style.`)))}getTransition(){return t.extend({duration:300,delay:0},this.stylesheet&&this.stylesheet.transition)}serialize(){const G={};for(const Z in this._sourceCaches){const re=this._sourceCaches[Z].getSource();G[re.id]||(G[re.id]=re.serialize())}return t.filterObject({version:this.stylesheet.version,name:this.stylesheet.name,metadata:this.stylesheet.metadata,light:this.stylesheet.light,terrain:this.getTerrain()||void 0,fog:this.stylesheet.fog,center:this.stylesheet.center,zoom:this.stylesheet.zoom,bearing:this.stylesheet.bearing,pitch:this.stylesheet.pitch,sprite:this.stylesheet.sprite,glyphs:this.stylesheet.glyphs,transition:this.stylesheet.transition,projection:this.stylesheet.projection,sources:G,layers:this._serializeLayers(this._order)},Z=>Z!==void 0)}_updateLayer(G){this._updatedLayers[G.id]=!0;const Z=this._getLayerSourceCache(G);G.source&&!this._updatedSources[G.source]&&Z&&Z.getSource().type!=="raster"&&(this._updatedSources[G.source]="reload",Z.pause()),this._changed=!0,G.invalidateCompiledFilter()}_flattenAndSortRenderedFeatures(G){const Z=me=>this._layers[me].type==="fill-extrusion",re={},le=[];for(let me=this._order.length-1;me>=0;me--){const ye=this._order[me];if(Z(ye)){re[ye]=me;for(const be of G){const qe=be[ye];if(qe)for(const Te of qe)le.push(Te)}}}le.sort((me,ye)=>ye.intersectionZ-me.intersectionZ);const de=[];for(let me=this._order.length-1;me>=0;me--){const ye=this._order[me];if(Z(ye))for(let be=le.length-1;be>=0;be--){const qe=le[be].feature;if(re[qe.layer.id]<me)break;de.push(qe),le.pop()}else for(const be of G){const qe=be[ye];if(qe)for(const Te of qe)de.push(Te.feature)}}return de}queryRenderedFeatures(G,Z,re){Z&&Z.filter&&this._validate(t.validateFilter,"queryRenderedFeatures.filter",Z.filter,null,Z);const le={};if(Z&&Z.layers){if(!Array.isArray(Z.layers))return this.fire(new t.ErrorEvent(new Error("parameters.layers must be an Array."))),[];for(const be of Z.layers){const qe=this._layers[be];if(!qe)return this.fire(new t.ErrorEvent(new Error(`The layer '${be}' does not exist in the map's style and cannot be queried for features.`))),[];le[qe.source]=!0}}const de=[];Z.availableImages=this._availableImages;const me=Z&&Z.layers?Z.layers.some(be=>{const qe=this.getLayer(be);return qe&&qe.is3D()}):this.has3DLayers(),ye=er.createFromScreenPoints(G,re);for(const be in this._sourceCaches){const qe=this._sourceCaches[be].getSource().id;Z.layers&&!le[qe]||de.push(Ai(this._sourceCaches[be],this._layers,this._serializedLayers,ye,Z,re,me,!!this.map._showQueryGeometry))}return this.placement&&de.push(function(be,qe,Te,Fe,$e,Je,tt){const Qe={},it=Je.queryRenderedSymbols(Fe),Be=[];for(const Ye of Object.keys(it).map(Number))Be.push(tt[Ye]);Be.sort(Mi);for(const Ye of Be){const lt=Ye.featureIndex.lookupSymbolFeatures(it[Ye.bucketInstanceId],qe,Ye.bucketIndex,Ye.sourceLayerIndex,$e.filter,$e.layers,$e.availableImages,be);for(const ct in lt){const Tt=Qe[ct]=Qe[ct]||[],Rt=lt[ct];Rt.sort((It,kt)=>{const Dt=Ye.featureSortOrder;if(Dt){const Vt=Dt.indexOf(It.featureIndex);return Dt.indexOf(kt.featureIndex)-Vt}return kt.featureIndex-It.featureIndex});for(const It of Rt)Tt.push(It)}}for(const Ye in Qe)Qe[Ye].forEach(lt=>{const ct=lt.feature,Tt=Te(be[Ye]);if(!Tt)return;const Rt=Tt.getFeatureState(ct.layer["source-layer"],ct.id);ct.source=ct.layer.source,ct.layer["source-layer"]&&(ct.sourceLayer=ct.layer["source-layer"]),ct.state=Rt});return Qe}(this._layers,this._serializedLayers,this._getLayerSourceCache.bind(this),ye.screenGeometry,Z,this.placement.collisionIndex,this.placement.retainedQueryData)),this._flattenAndSortRenderedFeatures(de)}querySourceFeatures(G,Z){Z&&Z.filter&&this._validate(t.validateFilter,"querySourceFeatures.filter",Z.filter,null,Z);const re=this._getSourceCaches(G);let le=[];for(const de of re)le=le.concat(wi(de,Z));return le}addSourceType(G,Z,re){return ua.getSourceType(G)?re(new Error(`A source type called "${G}" already exists.`)):(ua.setSourceType(G,Z),Z.workerSourceURL?void this.dispatcher.broadcast("loadWorkerSource",{name:G,url:Z.workerSourceURL},re):re(null,null))}getLight(){return this.light.getLight()}setLight(G,Z={}){this._checkLoaded();const re=this.light.getLight();let le=!1;for(const me in G)if(!H(G[me],re[me])){le=!0;break}if(!le)return;const de=this._setTransitionParameters({duration:300,delay:0});this.light.setLight(G,Z),this.light.updateTransitions(de)}getTerrain(){return this.terrain&&this.terrain.drapeRenderMode===1?this.terrain.get():null}setTerrainForDraping(){this.setTerrain({source:"",exaggeration:0},0)}setTerrain(G,Z=1){if(this._checkLoaded(),!G)return delete this.terrain,delete this.stylesheet.terrain,this.dispatcher.broadcast("enableTerrain",!1),this._force3DLayerUpdate(),void(this._markersNeedUpdate=!0);let re=G;if(Z===1){if(typeof re.source=="object"){const le="terrain-dem-src";this.addSource(le,re.source),re=t.clone$1(re),re=t.extend(re,{source:le})}if(this._validate(t.validateTerrain,"terrain",re))return}if(!this.terrain||this.terrain&&Z!==this.terrain.drapeRenderMode){if(!re)return;this._createTerrain(re,Z)}else{const le=this.terrain,de=le.get();for(const me of Object.keys(t.spec.terrain))!re.hasOwnProperty(me)&&t.spec.terrain[me].default&&(re[me]=t.spec.terrain[me].default);for(const me in re)if(!H(re[me],de[me])){le.set(re),this.stylesheet.terrain=re;const ye=this._setTransitionParameters({duration:0});le.updateTransitions(ye);break}}this._updateDrapeFirstLayers(),this._markersNeedUpdate=!0}_createFog(G){const Z=this.fog=new At(G,this.map.transform);this.stylesheet.fog=G;const re=this._setTransitionParameters({duration:0});Z.updateTransitions(re)}_updateMarkersOpacity(){this.map._markers.length!==0&&this.map._requestDomTask(()=>{for(const G of this.map._markers)G._evaluateOpacity()})}getFog(){return this.fog?this.fog.get():null}setFog(G){if(this._checkLoaded(),!G)return delete this.fog,delete this.stylesheet.fog,void(this._markersNeedUpdate=!0);if(this.fog){const Z=this.fog,re=Z.get();Object.keys(G).length===0&&Z.set(G);for(const le in G)if(!H(G[le],re[le])){Z.set(G),this.stylesheet.fog=G;const de=this._setTransitionParameters({duration:0});Z.updateTransitions(de);break}}else this._createFog(G);this._markersNeedUpdate=!0}_setTransitionParameters(G){return{now:t.exported.now(),transition:t.extend(G,this.stylesheet.transition)}}_updateDrapeFirstLayers(){if(!this.map._optimizeForTerrain||!this.terrain)return;const G=this._order.filter(re=>this.isLayerDraped(this._layers[re])),Z=this._order.filter(re=>!this.isLayerDraped(this._layers[re]));this._drapedFirstOrder=[],this._drapedFirstOrder.push(...G),this._drapedFirstOrder.push(...Z)}_createTerrain(G,Z){const re=this.terrain=new Kt(G,Z);this.stylesheet.terrain=G,this.dispatcher.broadcast("enableTerrain",!this.terrainSetForDrapingOnly()),this._force3DLayerUpdate();const le=this._setTransitionParameters({duration:0});re.updateTransitions(le)}_force3DLayerUpdate(){for(const G in this._layers){const Z=this._layers[G];Z.type==="fill-extrusion"&&this._updateLayer(Z)}}_forceSymbolLayerUpdate(){for(const G in this._layers){const Z=this._layers[G];Z.type==="symbol"&&this._updateLayer(Z)}}_validate(G,Z,re,le,de={}){return(!de||de.validate!==!1)&&La(this,G.call(t.validateStyle,t.extend({key:Z,style:this.serialize(),value:re,styleSpec:t.spec},le)))}_remove(){this._request&&(this._request.cancel(),this._request=null),this._spriteRequest&&(this._spriteRequest.cancel(),this._spriteRequest=null),t.evented.off("pluginStateChange",this._rtlTextPluginCallback);for(const G in this._layers)this._layers[G].setEventedParent(null);for(const G in this._sourceCaches)this._sourceCaches[G].clearTiles(),this._sourceCaches[G].setEventedParent(null);this.imageManager.setEventedParent(null),this.setEventedParent(null),this.dispatcher.remove()}_clearSource(G){const Z=this._getSourceCaches(G);for(const re of Z)re.clearTiles()}_reloadSource(G){const Z=this._getSourceCaches(G);for(const re of Z)re.resume(),re.reload()}_reloadSources(){for(const G of this._getSources())G.reload&&G.reload()}_updateSources(G){for(const Z in this._sourceCaches)this._sourceCaches[Z].update(G)}_generateCollisionBoxes(){for(const G in this._sourceCaches){const Z=this._sourceCaches[G];Z.resume(),Z.reload()}}_updatePlacement(G,Z,re,le,de=!1){let me=!1,ye=!1;const be={};for(const qe of this._order){const Te=this._layers[qe];if(Te.type!=="symbol")continue;if(!be[Te.source]){const $e=this._getLayerSourceCache(Te);if(!$e)continue;be[Te.source]=$e.getRenderableIds(!0).map(Je=>$e.getTileByID(Je)).sort((Je,tt)=>tt.tileID.overscaledZ-Je.tileID.overscaledZ||(Je.tileID.isLessThan(tt.tileID)?-1:1))}const Fe=this.crossTileSymbolIndex.addLayer(Te,be[Te.source],G.center.lng,G.projection);me=me||Fe}if(this.crossTileSymbolIndex.pruneUnusedLayers(this._order),de=de||this._layerOrderChanged||re===0,this._layerOrderChanged&&this.fire(new t.Event("neworder")),(de||!this.pauseablePlacement||this.pauseablePlacement.isDone()&&!this.placement.stillRecent(t.exported.now(),G.zoom))&&(this.pauseablePlacement=new Tu(G,this._order,de,Z,re,le,this.placement,this.fog&&G.projection.supportsFog?this.fog.state:null),this._layerOrderChanged=!1),this.pauseablePlacement.isDone()?this.placement.setStale():(this.pauseablePlacement.continuePlacement(this._order,this._layers,be),this.pauseablePlacement.isDone()&&(this.placement=this.pauseablePlacement.commit(t.exported.now()),ye=!0),me&&this.pauseablePlacement.placement.setStale()),ye||me)for(const qe of this._order){const Te=this._layers[qe];Te.type==="symbol"&&this.placement.updateLayerOpacities(Te,be[Te.source])}return!this.pauseablePlacement.isDone()||this.placement.hasTransitions(t.exported.now())}_releaseSymbolFadeTiles(){for(const G in this._sourceCaches)this._sourceCaches[G].releaseSymbolFadeTiles()}getImages(G,Z,re){this.imageManager.getImages(Z.icons,re),this._updateTilesForChangedImages();const le=de=>{de&&de.setDependencies(Z.tileID.key,Z.type,Z.icons)};le(this._otherSourceCaches[Z.source]),le(this._symbolSourceCaches[Z.source])}getGlyphs(G,Z,re){this.glyphManager.getGlyphs(Z.stacks,re)}getResource(G,Z,re){return t.makeRequest(Z,re)}_getSourceCache(G){return this._otherSourceCaches[G]}_getLayerSourceCache(G){return G.type==="symbol"?this._symbolSourceCaches[G.source]:this._otherSourceCaches[G.source]}_getSourceCaches(G){const Z=[];return this._otherSourceCaches[G]&&Z.push(this._otherSourceCaches[G]),this._symbolSourceCaches[G]&&Z.push(this._symbolSourceCaches[G]),Z}_isSourceCacheLoaded(G){const Z=this._getSourceCaches(G);return Z.length===0?(this.fire(new t.ErrorEvent(new Error(`There is no source with ID '${G}'`))),!1):Z.every(re=>re.loaded())}has3DLayers(){return this._num3DLayers>0}hasSymbolLayers(){return this._numSymbolLayers>0}hasCircleLayers(){return this._numCircleLayers>0}_clearWorkerCaches(){this.dispatcher.broadcast("clearCaches")}destroy(){this._clearWorkerCaches(),this.terrainSetForDrapingOnly()&&(delete this.terrain,delete this.stylesheet.terrain)}}ua.getSourceType=function(J){return ni[J]},ua.setSourceType=function(J,G){ni[J]=G},ua.registerForPluginStateChange=t.registerForPluginStateChange;var Ru=`
#define EPSILON 0.0000001
#define PI 3.141592653589793
#define EXTENT 8192.0
#define HALF_PI PI/2.0
#define QUARTER_PI PI/4.0
#define RAD_TO_DEG 180.0/PI
#define DEG_TO_RAD PI/180.0
#define GLOBE_RADIUS EXTENT/PI/2.0`,Za="attribute highp vec3 a_pos_3f;uniform lowp mat4 u_matrix;varying highp vec3 v_uv;void main() {const mat3 half_neg_pi_around_x=mat3(1.0,0.0, 0.0,0.0,0.0,-1.0,0.0,1.0, 0.0);v_uv=half_neg_pi_around_x*a_pos_3f;vec4 pos=u_matrix*vec4(a_pos_3f,1.0);gl_Position=pos.xyww;}",va=`
#define ELEVATION_SCALE 7.0
#define ELEVATION_OFFSET 450.0
#ifdef PROJECTION_GLOBE_VIEW
uniform vec3 u_tile_tl_up;uniform vec3 u_tile_tr_up;uniform vec3 u_tile_br_up;uniform vec3 u_tile_bl_up;uniform float u_tile_up_scale;vec3 elevationVector(vec2 pos) {vec2 uv=pos/EXTENT;vec3 up=normalize(mix(
mix(u_tile_tl_up,u_tile_tr_up,uv.xxx),mix(u_tile_bl_up,u_tile_br_up,uv.xxx),uv.yyy));return up*u_tile_up_scale;}
#else
vec3 elevationVector(vec2 pos) { return vec3(0,0,1); }
#endif
const float skirtOffset=24575.0;vec3 decomposeToPosAndSkirt(vec2 posWithComposedSkirt)
{float skirt=float(posWithComposedSkirt.x >=skirtOffset);vec2 pos=posWithComposedSkirt-vec2(skirt*skirtOffset,0.0);return vec3(pos,skirt);}
#ifdef TERRAIN
#ifdef TERRAIN_DEM_FLOAT_FORMAT
uniform highp sampler2D u_dem;uniform highp sampler2D u_dem_prev;
#else
uniform sampler2D u_dem;uniform sampler2D u_dem_prev;
#endif
uniform vec4 u_dem_unpack;uniform vec2 u_dem_tl;uniform vec2 u_dem_tl_prev;uniform float u_dem_scale;uniform float u_dem_scale_prev;uniform float u_dem_size;uniform float u_dem_lerp;uniform float u_exaggeration;uniform float u_meter_to_dem;uniform mat4 u_label_plane_matrix_inv;uniform sampler2D u_depth;uniform vec2 u_depth_size_inv;vec4 tileUvToDemSample(vec2 uv,float dem_size,float dem_scale,vec2 dem_tl) {vec2 pos=dem_size*(uv*dem_scale+dem_tl)+1.0;vec2 f=fract(pos);return vec4((pos-f+0.5)/(dem_size+2.0),f);}float decodeElevation(vec4 v) {return dot(vec4(v.xyz*255.0,-1.0),u_dem_unpack);}float currentElevation(vec2 apos) {
#ifdef TERRAIN_DEM_FLOAT_FORMAT
vec2 pos=(u_dem_size*(apos/8192.0*u_dem_scale+u_dem_tl)+1.5)/(u_dem_size+2.0);return u_exaggeration*texture2D(u_dem,pos).a;
#else
float dd=1.0/(u_dem_size+2.0);vec4 r=tileUvToDemSample(apos/8192.0,u_dem_size,u_dem_scale,u_dem_tl);vec2 pos=r.xy;vec2 f=r.zw;float tl=decodeElevation(texture2D(u_dem,pos));
#ifdef TERRAIN_DEM_NEAREST_FILTER
return u_exaggeration*tl;
#endif
float tr=decodeElevation(texture2D(u_dem,pos+vec2(dd,0.0)));float bl=decodeElevation(texture2D(u_dem,pos+vec2(0.0,dd)));float br=decodeElevation(texture2D(u_dem,pos+vec2(dd,dd)));return u_exaggeration*mix(mix(tl,tr,f.x),mix(bl,br,f.x),f.y);
#endif
}float prevElevation(vec2 apos) {
#ifdef TERRAIN_DEM_FLOAT_FORMAT
vec2 pos=(u_dem_size*(apos/8192.0*u_dem_scale_prev+u_dem_tl_prev)+1.5)/(u_dem_size+2.0);return u_exaggeration*texture2D(u_dem_prev,pos).a;
#else
float dd=1.0/(u_dem_size+2.0);vec4 r=tileUvToDemSample(apos/8192.0,u_dem_size,u_dem_scale_prev,u_dem_tl_prev);vec2 pos=r.xy;vec2 f=r.zw;float tl=decodeElevation(texture2D(u_dem_prev,pos));float tr=decodeElevation(texture2D(u_dem_prev,pos+vec2(dd,0.0)));float bl=decodeElevation(texture2D(u_dem_prev,pos+vec2(0.0,dd)));float br=decodeElevation(texture2D(u_dem_prev,pos+vec2(dd,dd)));return u_exaggeration*mix(mix(tl,tr,f.x),mix(bl,br,f.x),f.y);
#endif
}
#ifdef TERRAIN_VERTEX_MORPHING
float elevation(vec2 apos) {
#ifdef ZERO_EXAGGERATION
return 0.0;
#endif
float nextElevation=currentElevation(apos);float prevElevation=prevElevation(apos);return mix(prevElevation,nextElevation,u_dem_lerp);}
#else
float elevation(vec2 apos) {
#ifdef ZERO_EXAGGERATION
return 0.0;
#endif
return currentElevation(apos);}
#endif
highp float unpack_depth(highp vec4 rgba_depth)
{const highp vec4 bit_shift=vec4(1.0/(255.0*255.0*255.0),1.0/(255.0*255.0),1.0/255.0,1.0);return dot(rgba_depth,bit_shift)*2.0-1.0;}bool isOccluded(vec4 frag) {vec3 coord=frag.xyz/frag.w;float depth=unpack_depth(texture2D(u_depth,(coord.xy+1.0)*0.5));return coord.z > depth+0.0005;}float occlusionFade(vec4 frag) {vec3 coord=frag.xyz/frag.w;vec3 df=vec3(5.0*u_depth_size_inv,0.0);vec2 uv=0.5*coord.xy+0.5;vec4 depth=vec4(
unpack_depth(texture2D(u_depth,uv-df.xz)),unpack_depth(texture2D(u_depth,uv+df.xz)),unpack_depth(texture2D(u_depth,uv-df.zy)),unpack_depth(texture2D(u_depth,uv+df.zy))
);return dot(vec4(0.25),vec4(1.0)-clamp(300.0*(vec4(coord.z-0.001)-depth),0.0,1.0));}vec4 fourSample(vec2 pos,vec2 off) {
#ifdef TERRAIN_DEM_FLOAT_FORMAT
float tl=texture2D(u_dem,pos).a;float tr=texture2D(u_dem,pos+vec2(off.x,0.0)).a;float bl=texture2D(u_dem,pos+vec2(0.0,off.y)).a;float br=texture2D(u_dem,pos+off).a;
#else
vec4 demtl=vec4(texture2D(u_dem,pos).xyz*255.0,-1.0);float tl=dot(demtl,u_dem_unpack);vec4 demtr=vec4(texture2D(u_dem,pos+vec2(off.x,0.0)).xyz*255.0,-1.0);float tr=dot(demtr,u_dem_unpack);vec4 dembl=vec4(texture2D(u_dem,pos+vec2(0.0,off.y)).xyz*255.0,-1.0);float bl=dot(dembl,u_dem_unpack);vec4 dembr=vec4(texture2D(u_dem,pos+off).xyz*255.0,-1.0);float br=dot(dembr,u_dem_unpack);
#endif
return vec4(tl,tr,bl,br);}float flatElevation(vec2 pack) {vec2 apos=floor(pack/8.0);vec2 span=10.0*(pack-apos*8.0);vec2 uvTex=(apos-vec2(1.0,1.0))/8190.0;float size=u_dem_size+2.0;float dd=1.0/size;vec2 pos=u_dem_size*(uvTex*u_dem_scale+u_dem_tl)+1.0;vec2 f=fract(pos);pos=(pos-f+0.5)*dd;vec4 h=fourSample(pos,vec2(dd));float z=mix(mix(h.x,h.y,f.x),mix(h.z,h.w,f.x),f.y);vec2 w=floor(0.5*(span*u_meter_to_dem-1.0));vec2 d=dd*w;h=fourSample(pos-d,2.0*d+vec2(dd));vec4 diff=abs(h.xzxy-h.ywzw);vec2 slope=min(vec2(0.25),u_meter_to_dem*0.5*(diff.xz+diff.yw)/(2.0*w+vec2(1.0)));vec2 fix=slope*span;float base=z+max(fix.x,fix.y);return u_exaggeration*base;}float elevationFromUint16(float word) {return u_exaggeration*(word/ELEVATION_SCALE-ELEVATION_OFFSET);}
#else
float elevation(vec2 pos) { return 0.0; }bool isOccluded(vec4 frag) { return false; }float occlusionFade(vec4 frag) { return 1.0; }
#endif`,Wo=`#ifdef FOG
uniform mediump vec4 u_fog_color;uniform mediump vec2 u_fog_range;uniform mediump float u_fog_horizon_blend;uniform mediump mat4 u_fog_matrix;varying vec3 v_fog_pos;float fog_range(float depth) {return (depth-u_fog_range[0])/(u_fog_range[1]-u_fog_range[0]);}float fog_horizon_blending(vec3 camera_dir) {float t=max(0.0,camera_dir.z/u_fog_horizon_blend);return u_fog_color.a*exp(-3.0*t*t);}float fog_opacity(float t) {const float decay=6.0;float falloff=1.0-min(1.0,exp(-decay*t));falloff*=falloff*falloff;return u_fog_color.a*min(1.0,1.00747*falloff);}vec3 fog_position(vec3 pos) {return (u_fog_matrix*vec4(pos,1.0)).xyz;}vec3 fog_position(vec2 pos) {return fog_position(vec3(pos,0.0));}float fog(vec3 pos) {float depth=length(pos);float opacity=fog_opacity(fog_range(depth));return opacity*fog_horizon_blending(pos/depth);}
#endif`,ba=`#ifdef FOG
uniform mediump vec4 u_fog_color;uniform mediump vec2 u_fog_range;uniform mediump float u_fog_horizon_blend;uniform mediump float u_fog_temporal_offset;varying vec3 v_fog_pos;uniform highp vec3 u_frustum_tl;uniform highp vec3 u_frustum_tr;uniform highp vec3 u_frustum_br;uniform highp vec3 u_frustum_bl;uniform highp vec3 u_globe_pos;uniform highp float u_globe_radius;uniform highp vec2 u_viewport;uniform float u_globe_transition;uniform int u_is_globe;float fog_range(float depth) {return (depth-u_fog_range[0])/(u_fog_range[1]-u_fog_range[0]);}float fog_horizon_blending(vec3 camera_dir) {float t=max(0.0,camera_dir.z/u_fog_horizon_blend);return u_fog_color.a*exp(-3.0*t*t);}float fog_opacity(float t) {const float decay=6.0;float falloff=1.0-min(1.0,exp(-decay*t));falloff*=falloff*falloff;return u_fog_color.a*min(1.0,1.00747*falloff);}float globe_glow_progress() {highp vec2 uv=gl_FragCoord.xy/u_viewport;highp vec3 ray_dir=mix(
mix(u_frustum_tl,u_frustum_tr,uv.x),mix(u_frustum_bl,u_frustum_br,uv.x),1.0-uv.y);highp vec3 dir=normalize(ray_dir);highp vec3 closest_point=dot(u_globe_pos,dir)*dir;highp float sdf=length(closest_point-u_globe_pos)/u_globe_radius;return sdf+PI*0.5;}float fog_opacity(vec3 pos) {float depth=length(pos);return fog_opacity(fog_range(depth));}vec3 fog_apply(vec3 color,vec3 pos) {float depth=length(pos);float opacity;if (u_is_globe==1) {float glow_progress=globe_glow_progress();float t=mix(glow_progress,depth,u_globe_transition);opacity=fog_opacity(fog_range(t));} else {opacity=fog_opacity(fog_range(depth));opacity*=fog_horizon_blending(pos/depth);}return mix(color,u_fog_color.rgb,opacity);}vec4 fog_apply_from_vert(vec4 color,float fog_opac) {float alpha=EPSILON+color.a;color.rgb=mix(color.rgb/alpha,u_fog_color.rgb,fog_opac)*alpha;return color;}vec3 fog_apply_sky_gradient(vec3 camera_ray,vec3 sky_color) {float horizon_blend=fog_horizon_blending(normalize(camera_ray));return mix(sky_color,u_fog_color.rgb,horizon_blend);}vec4 fog_apply_premultiplied(vec4 color,vec3 pos) {float alpha=EPSILON+color.a;color.rgb=fog_apply(color.rgb/alpha,pos)*alpha;return color;}vec3 fog_dither(vec3 color) {vec2 dither_seed=gl_FragCoord.xy+u_fog_temporal_offset;return dither(color,dither_seed);}vec4 fog_dither(vec4 color) {return vec4(fog_dither(color.rgb),color.a);}
#endif`;let Is={},fo={};const Ho=[];po(Ru,Ho),po(va,Ho),po(Wo,Ho),po(ba,Ho),Is=Ci("",va),fo=Ci(ba,Wo);const Ql=Ci(`
#if __VERSION__ >=300
#define varying in
#define gl_FragColor glFragColor
#define texture2D texture
#define textureCube texture
out vec4 glFragColor;
#endif
highp vec3 hash(highp vec2 p) {highp vec3 p3=fract(p.xyx*vec3(443.8975,397.2973,491.1871));p3+=dot(p3,p3.yxz+19.19);return fract((p3.xxy+p3.yzz)*p3.zyx);}vec3 dither(vec3 color,highp vec2 seed) {vec3 rnd=hash(seed)+hash(seed+0.59374)-0.5;return color+rnd/255.0;}highp float unpack_depth(highp vec4 rgba_depth)
{const highp vec4 bit_shift=vec4(1.0/(255.0*255.0*255.0),1.0/(255.0*255.0),1.0/255.0,1.0);return dot(rgba_depth,bit_shift)*2.0-1.0;}highp vec4 pack_depth(highp float ndc_z) {highp float depth=ndc_z*0.5+0.5;const highp vec4 bit_shift=vec4(255.0*255.0*255.0,255.0*255.0,255.0,1.0);const highp vec4 bit_mask =vec4(0.0,1.0/255.0,1.0/255.0,1.0/255.0);highp vec4 res=fract(depth*bit_shift);res-=res.xxyz*bit_mask;return res;}`,`
#if __VERSION__ >=300
#define attribute in
#define varying out
#define texture2D texture
#endif
float wrap(float n,float min,float max) {float d=max-min;float w=mod(mod(n-min,d)+d,d)+min;return (w==min) ? max : w;}
#ifdef PROJECTION_GLOBE_VIEW
vec3 mercator_tile_position(mat4 matrix,vec2 tile_anchor,vec3 tile_id,vec2 mercator_center) {
#ifndef PROJECTED_POS_ON_VIEWPORT
float tiles=tile_id.z;vec2 mercator=(tile_anchor/EXTENT+tile_id.xy)/tiles;mercator-=mercator_center;mercator.x=wrap(mercator.x,-0.5,0.5);vec4 mercator_tile=vec4(mercator.xy*EXTENT,EXTENT/(2.0*PI),1.0);mercator_tile=matrix*mercator_tile;return mercator_tile.xyz;
#else
return vec3(0.0);
#endif
}vec3 mix_globe_mercator(vec3 globe,vec3 mercator,float t) {return mix(globe,mercator,t);}mat3 globe_mercator_surface_vectors(vec3 pos_normal,vec3 up_dir,float zoom_transition) {vec3 normal=zoom_transition==0.0 ? pos_normal : normalize(mix(pos_normal,up_dir,zoom_transition));vec3 xAxis=normalize(vec3(normal.z,0.0,-normal.x));vec3 yAxis=normalize(cross(normal,xAxis));return mat3(xAxis,yAxis,normal);}
#endif
vec2 unpack_float(const float packedValue) {int packedIntValue=int(packedValue);int v0=packedIntValue/256;return vec2(v0,packedIntValue-v0*256);}vec2 unpack_opacity(const float packedOpacity) {int intOpacity=int(packedOpacity)/2;return vec2(float(intOpacity)/127.0,mod(packedOpacity,2.0));}vec4 decode_color(const vec2 encodedColor) {return vec4(
unpack_float(encodedColor[0])/255.0,unpack_float(encodedColor[1])/255.0
);}float unpack_mix_vec2(const vec2 packedValue,const float t) {return mix(packedValue[0],packedValue[1],t);}vec4 unpack_mix_color(const vec4 packedColors,const float t) {vec4 minColor=decode_color(vec2(packedColors[0],packedColors[1]));vec4 maxColor=decode_color(vec2(packedColors[2],packedColors[3]));return mix(minColor,maxColor,t);}vec2 get_pattern_pos(const vec2 pixel_coord_upper,const vec2 pixel_coord_lower,const vec2 pattern_size,const float tile_units_to_pixels,const vec2 pos) {vec2 offset=mod(mod(mod(pixel_coord_upper,pattern_size)*256.0,pattern_size)*256.0+pixel_coord_lower,pattern_size);return (tile_units_to_pixels*pos+offset)/pattern_size;}const vec4 AWAY=vec4(-1000.0,-1000.0,-1000.0,1);//Normalized device coordinate that is not rendered.`),As=Ru,Ou=`
#ifdef GL_ES
precision mediump float;
#else

#if !defined(lowp)
#define lowp
#endif

#if !defined(mediump)
#define mediump
#endif

#if !defined(highp)
#define highp
#endif

#endif`;var Cu={background:Ci(`uniform vec4 u_color;uniform float u_opacity;
#ifdef LIGHTING_3D_MODE
varying vec4 v_color;
#endif
void main() {vec4 out_color;
#ifdef LIGHTING_3D_MODE
out_color=v_color;
#else
out_color=u_color;
#endif
#ifdef FOG
out_color=fog_dither(fog_apply_premultiplied(out_color,v_fog_pos));
#endif
gl_FragColor=out_color*u_opacity;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`attribute vec2 a_pos;uniform mat4 u_matrix;
#ifdef LIGHTING_3D_MODE
uniform vec4 u_color;varying vec4 v_color;
#endif
void main() {gl_Position=u_matrix*vec4(a_pos,0,1);
#ifdef LIGHTING_3D_MODE
v_color=apply_lighting(u_color);
#endif
#ifdef FOG
v_fog_pos=fog_position(a_pos);
#endif
}`),backgroundPattern:Ci(`uniform vec2 u_pattern_tl;uniform vec2 u_pattern_br;uniform vec2 u_texsize;uniform float u_opacity;uniform sampler2D u_image;varying vec2 v_pos;void main() {vec2 imagecoord=mod(v_pos,1.0);vec2 pos=mix(u_pattern_tl/u_texsize,u_pattern_br/u_texsize,imagecoord);vec4 out_color=texture2D(u_image,pos);
#ifdef LIGHTING_3D_MODE
out_color=apply_lighting(out_color);
#endif
#ifdef FOG
out_color=fog_dither(fog_apply_premultiplied(out_color,v_fog_pos));
#endif
gl_FragColor=out_color*u_opacity;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`uniform mat4 u_matrix;uniform vec2 u_pattern_size;uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform float u_tile_units_to_pixels;attribute vec2 a_pos;varying vec2 v_pos;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);v_pos=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,u_pattern_size,u_tile_units_to_pixels,a_pos);
#ifdef FOG
v_fog_pos=fog_position(a_pos);
#endif
}`),circle:Ci(`varying vec3 v_data;varying float v_visibility;
#pragma mapbox: define highp vec4 color
#pragma mapbox: define mediump float radius
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define highp vec4 stroke_color
#pragma mapbox: define mediump float stroke_width
#pragma mapbox: define lowp float stroke_opacity
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize mediump float radius
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize highp vec4 stroke_color
#pragma mapbox: initialize mediump float stroke_width
#pragma mapbox: initialize lowp float stroke_opacity
vec2 extrude=v_data.xy;float extrude_length=length(extrude);lowp float antialiasblur=v_data.z;float antialiased_blur=-max(blur,antialiasblur);float opacity_t=smoothstep(0.0,antialiased_blur,extrude_length-1.0);float color_t=stroke_width < 0.01 ? 0.0 : smoothstep(
antialiased_blur,0.0,extrude_length-radius/(radius+stroke_width)
);vec4 out_color=mix(color*opacity,stroke_color*stroke_opacity,color_t);
#ifdef LIGHTING_3D_MODE
out_color=apply_lighting(out_color);
#endif
#ifdef FOG
out_color=fog_apply_premultiplied(out_color,v_fog_pos);
#endif
gl_FragColor=out_color*(v_visibility*opacity_t);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`#define NUM_VISIBILITY_RINGS 2
#define INV_SQRT2 0.70710678
#define ELEVATION_BIAS 0.0001
#define NUM_SAMPLES_PER_RING 16
uniform mat4 u_matrix;uniform mat2 u_extrude_scale;uniform lowp float u_device_pixel_ratio;uniform highp float u_camera_to_center_distance;attribute vec2 a_pos;
#ifdef PROJECTION_GLOBE_VIEW
attribute vec3 a_pos_3;attribute vec3 a_pos_normal_3;uniform mat4 u_inv_rot_matrix;uniform vec2 u_merc_center;uniform vec3 u_tile_id;uniform float u_zoom_transition;uniform vec3 u_up_dir;
#endif
varying vec3 v_data;varying float v_visibility;
#pragma mapbox: define highp vec4 color
#pragma mapbox: define mediump float radius
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define highp vec4 stroke_color
#pragma mapbox: define mediump float stroke_width
#pragma mapbox: define lowp float stroke_opacity
vec2 calc_offset(vec2 extrusion,float radius,float stroke_width, float view_scale) {return extrusion*(radius+stroke_width)*u_extrude_scale*view_scale;}float cantilevered_elevation(vec2 pos,float radius,float stroke_width,float view_scale) {vec2 c1=pos+calc_offset(vec2(-1,-1),radius,stroke_width,view_scale);vec2 c2=pos+calc_offset(vec2(1,-1),radius,stroke_width,view_scale);vec2 c3=pos+calc_offset(vec2(1,1),radius,stroke_width,view_scale);vec2 c4=pos+calc_offset(vec2(-1,1),radius,stroke_width,view_scale);float h1=elevation(c1)+ELEVATION_BIAS;float h2=elevation(c2)+ELEVATION_BIAS;float h3=elevation(c3)+ELEVATION_BIAS;float h4=elevation(c4)+ELEVATION_BIAS;return max(h4,max(h3,max(h1,h2)));}float circle_elevation(vec2 pos) {
#if defined(TERRAIN)
return elevation(pos)+ELEVATION_BIAS;
#else
return 0.0;
#endif
}vec4 project_vertex(vec2 extrusion,vec4 world_center,vec4 projected_center,float radius,float stroke_width, float view_scale,mat3 surface_vectors) {vec2 sample_offset=calc_offset(extrusion,radius,stroke_width,view_scale);
#ifdef PITCH_WITH_MAP
#ifdef PROJECTION_GLOBE_VIEW
return u_matrix*( world_center+vec4(sample_offset.x*surface_vectors[0]+sample_offset.y*surface_vectors[1],0) );
#else
return u_matrix*( world_center+vec4(sample_offset,0,0) );
#endif
#else
return projected_center+vec4(sample_offset,0,0);
#endif
}float get_sample_step() {
#ifdef PITCH_WITH_MAP
return 2.0*PI/float(NUM_SAMPLES_PER_RING);
#else
return PI/float(NUM_SAMPLES_PER_RING);
#endif
}void main(void) {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize mediump float radius
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize highp vec4 stroke_color
#pragma mapbox: initialize mediump float stroke_width
#pragma mapbox: initialize lowp float stroke_opacity
vec2 extrude=vec2(mod(a_pos,2.0)*2.0-1.0);vec2 circle_center=floor(a_pos*0.5);vec4 world_center;mat3 surface_vectors;
#ifdef PROJECTION_GLOBE_VIEW
vec3 pos_normal_3=a_pos_normal_3/16384.0;surface_vectors=globe_mercator_surface_vectors(pos_normal_3,u_up_dir,u_zoom_transition);vec3 surface_extrusion=extrude.x*surface_vectors[0]+extrude.y*surface_vectors[1];vec3 globe_elevation=elevationVector(circle_center)*circle_elevation(circle_center);vec3 globe_pos=a_pos_3+surface_extrusion+globe_elevation;vec3 mercator_elevation=u_up_dir*u_tile_up_scale*circle_elevation(circle_center);vec3 merc_pos=mercator_tile_position(u_inv_rot_matrix,circle_center,u_tile_id,u_merc_center)+surface_extrusion+mercator_elevation;vec3 pos=mix_globe_mercator(globe_pos,merc_pos,u_zoom_transition);world_center=vec4(pos,1);
#else 
surface_vectors=mat3(1.0);float height=circle_elevation(circle_center);world_center=vec4(circle_center,height,1);
#endif
vec4 projected_center=u_matrix*world_center;float view_scale=0.0;
#ifdef PITCH_WITH_MAP
#ifdef SCALE_WITH_MAP
view_scale=1.0;
#else
view_scale=projected_center.w/u_camera_to_center_distance;
#endif
#else
#ifdef SCALE_WITH_MAP
view_scale=u_camera_to_center_distance;
#else
view_scale=projected_center.w;
#endif
#endif
gl_Position=project_vertex(extrude,world_center,projected_center,radius,stroke_width,view_scale,surface_vectors);float visibility=0.0;
#ifdef TERRAIN
float step=get_sample_step();vec4 occlusion_world_center;vec4 occlusion_projected_center;
#ifdef PITCH_WITH_MAP
float cantilevered_height=cantilevered_elevation(circle_center,radius,stroke_width,view_scale);occlusion_world_center=vec4(circle_center,cantilevered_height,1);occlusion_projected_center=u_matrix*occlusion_world_center;
#else
occlusion_world_center=world_center;occlusion_projected_center=projected_center;
#endif
for(int ring=0; ring < NUM_VISIBILITY_RINGS; ring++) {float scale=(float(ring)+1.0)/float(NUM_VISIBILITY_RINGS);for(int i=0; i < NUM_SAMPLES_PER_RING; i++) {vec2 extrusion=vec2(cos(step*float(i)),-sin(step*float(i)))*scale;vec4 frag_pos=project_vertex(extrusion,occlusion_world_center,occlusion_projected_center,radius,stroke_width,view_scale,surface_vectors);visibility+=float(!isOccluded(frag_pos));}}visibility/=float(NUM_VISIBILITY_RINGS)*float(NUM_SAMPLES_PER_RING);
#else
visibility=1.0;
#endif
#ifdef PROJECTION_GLOBE_VIEW
visibility=1.0;
#endif
v_visibility=visibility;lowp float antialiasblur=1.0/u_device_pixel_ratio/(radius+stroke_width);v_data=vec3(extrude.x,extrude.y,antialiasblur);
#ifdef FOG
v_fog_pos=fog_position(world_center.xyz);
#endif
}`),clippingMask:Ci("void main() {gl_FragColor=vec4(1.0);}","attribute vec2 a_pos;uniform mat4 u_matrix;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);}"),heatmap:Ci(`uniform highp float u_intensity;varying vec2 v_extrude;
#pragma mapbox: define highp float weight
#define GAUSS_COEF 0.3989422804014327
void main() {
#pragma mapbox: initialize highp float weight
float d=-0.5*3.0*3.0*dot(v_extrude,v_extrude);float val=weight*u_intensity*GAUSS_COEF*exp(d);gl_FragColor=vec4(val,1.0,1.0,1.0);
#ifdef FOG
if (u_is_globe==0) {gl_FragColor.r*=pow(1.0-fog_opacity(v_fog_pos),2.0);}
#endif
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`uniform mat4 u_matrix;uniform float u_extrude_scale;uniform float u_opacity;uniform float u_intensity;attribute vec2 a_pos;
#ifdef PROJECTION_GLOBE_VIEW
attribute vec3 a_pos_3;attribute vec3 a_pos_normal_3;uniform mat4 u_inv_rot_matrix;uniform vec2 u_merc_center;uniform vec3 u_tile_id;uniform float u_zoom_transition;uniform vec3 u_up_dir;
#endif
varying vec2 v_extrude;
#pragma mapbox: define highp float weight
#pragma mapbox: define mediump float radius
const highp float ZERO=1.0/255.0/16.0;
#define GAUSS_COEF 0.3989422804014327
void main(void) {
#pragma mapbox: initialize highp float weight
#pragma mapbox: initialize mediump float radius
vec2 unscaled_extrude=vec2(mod(a_pos,2.0)*2.0-1.0);float S=sqrt(-2.0*log(ZERO/weight/u_intensity/GAUSS_COEF))/3.0;v_extrude=S*unscaled_extrude;vec2 extrude=v_extrude*radius*u_extrude_scale;vec2 tilePos=floor(a_pos*0.5);vec3 pos;
#ifdef PROJECTION_GLOBE_VIEW
vec3 pos_normal_3=a_pos_normal_3/16384.0;mat3 surface_vectors=globe_mercator_surface_vectors(pos_normal_3,u_up_dir,u_zoom_transition);vec3 surface_extrusion=extrude.x*surface_vectors[0]+extrude.y*surface_vectors[1];vec3 globe_elevation=elevationVector(tilePos)*elevation(tilePos);vec3 globe_pos=a_pos_3+surface_extrusion+globe_elevation;vec3 mercator_elevation=u_up_dir*u_tile_up_scale*elevation(tilePos);vec3 merc_pos=mercator_tile_position(u_inv_rot_matrix,tilePos,u_tile_id,u_merc_center)+surface_extrusion+mercator_elevation;pos=mix_globe_mercator(globe_pos,merc_pos,u_zoom_transition);
#else
pos=vec3(tilePos+extrude,elevation(tilePos));
#endif
gl_Position=u_matrix*vec4(pos,1);
#ifdef FOG
v_fog_pos=fog_position(pos);
#endif
}`),heatmapTexture:Ci(`uniform sampler2D u_image;uniform sampler2D u_color_ramp;uniform float u_opacity;varying vec2 v_pos;void main() {float t=texture2D(u_image,v_pos).r;vec4 color=texture2D(u_color_ramp,vec2(t,0.5));gl_FragColor=color*u_opacity;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(0.0);
#endif
}`,"attribute vec2 a_pos;varying vec2 v_pos;void main() {gl_Position=vec4(a_pos,0,1);v_pos=a_pos*0.5+0.5;}"),collisionBox:Ci("varying float v_placed;varying float v_notUsed;void main() {vec4 red =vec4(1.0,0.0,0.0,1.0);vec4 blue=vec4(0.0,0.0,1.0,0.5);gl_FragColor =mix(red,blue,step(0.5,v_placed))*0.5;gl_FragColor*=mix(1.0,0.1,step(0.5,v_notUsed));}",`attribute vec3 a_pos;attribute vec2 a_anchor_pos;attribute vec2 a_extrude;attribute vec2 a_placed;attribute vec2 a_shift;attribute float a_size_scale;attribute vec2 a_padding;uniform mat4 u_matrix;uniform vec2 u_extrude_scale;uniform float u_camera_to_center_distance;varying float v_placed;varying float v_notUsed;void main() {vec4 projectedPoint=u_matrix*vec4(a_pos+elevationVector(a_anchor_pos)*elevation(a_anchor_pos),1);highp float camera_to_anchor_distance=projectedPoint.w;highp float collision_perspective_ratio=clamp(
0.5+0.5*(u_camera_to_center_distance/camera_to_anchor_distance),0.0,1.5);gl_Position=projectedPoint;gl_Position.xy+=(a_extrude*a_size_scale+a_shift+a_padding)*u_extrude_scale*gl_Position.w*collision_perspective_ratio;v_placed=a_placed.x;v_notUsed=a_placed.y;}`),collisionCircle:Ci("varying float v_radius;varying vec2 v_extrude;varying float v_perspective_ratio;varying float v_collision;void main() {float alpha=0.5*min(v_perspective_ratio,1.0);float stroke_radius=0.9*max(v_perspective_ratio,1.0);float distance_to_center=length(v_extrude);float distance_to_edge=abs(distance_to_center-v_radius);float opacity_t=smoothstep(-stroke_radius,0.0,-distance_to_edge);vec4 color=mix(vec4(0.0,0.0,1.0,0.5),vec4(1.0,0.0,0.0,1.0),v_collision);gl_FragColor=color*alpha*opacity_t;}",`attribute vec2 a_pos_2f;attribute float a_radius;attribute vec2 a_flags;uniform mat4 u_matrix;uniform mat4 u_inv_matrix;uniform vec2 u_viewport_size;uniform float u_camera_to_center_distance;varying float v_radius;varying vec2 v_extrude;varying float v_perspective_ratio;varying float v_collision;vec3 toTilePosition(vec2 screenPos) {vec4 rayStart=u_inv_matrix*vec4(screenPos,-1.0,1.0);vec4 rayEnd  =u_inv_matrix*vec4(screenPos, 1.0,1.0);rayStart.xyz/=rayStart.w;rayEnd.xyz  /=rayEnd.w;highp float t=(0.0-rayStart.z)/(rayEnd.z-rayStart.z);return mix(rayStart.xyz,rayEnd.xyz,t);}void main() {vec2 quadCenterPos=a_pos_2f;float radius=a_radius;float collision=a_flags.x;float vertexIdx=a_flags.y;vec2 quadVertexOffset=vec2(
mix(-1.0,1.0,float(vertexIdx >=2.0)),mix(-1.0,1.0,float(vertexIdx >=1.0 && vertexIdx <=2.0)));vec2 quadVertexExtent=quadVertexOffset*radius;vec3 tilePos=toTilePosition(quadCenterPos);vec4 clipPos=u_matrix*vec4(tilePos,1.0);highp float camera_to_anchor_distance=clipPos.w;highp float collision_perspective_ratio=clamp(
0.5+0.5*(u_camera_to_center_distance/camera_to_anchor_distance),0.0,4.0);float padding_factor=1.2;v_radius=radius;v_extrude=quadVertexExtent*padding_factor;v_perspective_ratio=collision_perspective_ratio;v_collision=collision;gl_Position=vec4(clipPos.xyz/clipPos.w,1.0)+vec4(quadVertexExtent*padding_factor/u_viewport_size*2.0,0.0,0.0);}`),debug:Ci("uniform highp vec4 u_color;uniform sampler2D u_overlay;varying vec2 v_uv;void main() {vec4 overlay_color=texture2D(u_overlay,v_uv);gl_FragColor=mix(u_color,overlay_color,overlay_color.a);}",`attribute vec2 a_pos;
#ifdef PROJECTION_GLOBE_VIEW
attribute vec3 a_pos_3;
#endif
varying vec2 v_uv;uniform mat4 u_matrix;uniform float u_overlay_scale;void main() {float h=elevation(a_pos);v_uv=a_pos/8192.0;
#ifdef PROJECTION_GLOBE_VIEW
gl_Position=u_matrix*vec4(a_pos_3+elevationVector(a_pos)*h,1);
#else
gl_Position=u_matrix*vec4(a_pos*u_overlay_scale,h,1);
#endif
}`),fill:Ci(`#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float opacity
vec4 out_color=color;
#ifdef LIGHTING_3D_MODE
out_color=apply_lighting(out_color);
#endif
#ifdef FOG
out_color=fog_dither(fog_apply_premultiplied(out_color,v_fog_pos));
#endif
gl_FragColor=out_color*opacity;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`attribute vec2 a_pos;uniform mat4 u_matrix;
#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float opacity
gl_Position=u_matrix*vec4(a_pos,0,1);
#ifdef FOG
v_fog_pos=fog_position(a_pos);
#endif
}`),fillOutline:Ci(`varying vec2 v_pos;
#pragma mapbox: define highp vec4 outline_color
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize highp vec4 outline_color
#pragma mapbox: initialize lowp float opacity
float dist=length(v_pos-gl_FragCoord.xy);float alpha=1.0-smoothstep(0.0,1.0,dist);vec4 out_color=outline_color;
#ifdef LIGHTING_3D_MODE
out_color=apply_lighting(out_color);
#endif
#ifdef FOG
out_color=fog_dither(fog_apply_premultiplied(out_color,v_fog_pos));
#endif
gl_FragColor=out_color*(alpha*opacity);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`attribute vec2 a_pos;uniform mat4 u_matrix;uniform vec2 u_world;varying vec2 v_pos;
#pragma mapbox: define highp vec4 outline_color
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize highp vec4 outline_color
#pragma mapbox: initialize lowp float opacity
gl_Position=u_matrix*vec4(a_pos,0,1);v_pos=(gl_Position.xy/gl_Position.w+1.0)/2.0*u_world;
#ifdef FOG
v_fog_pos=fog_position(a_pos);
#endif
}`),fillOutlinePattern:Ci(`uniform vec2 u_texsize;uniform sampler2D u_image;varying vec2 v_pos;varying vec2 v_pos_world;
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp vec4 pattern
void main() {
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump vec4 pattern
vec2 pattern_tl=pattern.xy;vec2 pattern_br=pattern.zw;vec2 imagecoord=mod(v_pos,1.0);vec2 pos=mix(pattern_tl/u_texsize,pattern_br/u_texsize,imagecoord);float dist=length(v_pos_world-gl_FragCoord.xy);float alpha=1.0-smoothstep(0.0,1.0,dist);vec4 out_color=texture2D(u_image,pos);
#ifdef LIGHTING_3D_MODE
out_color=apply_lighting(out_color);
#endif
#ifdef FOG
out_color=fog_dither(fog_apply_premultiplied(out_color,v_fog_pos));
#endif
gl_FragColor=out_color*(alpha*opacity);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`uniform mat4 u_matrix;uniform vec2 u_world;uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform float u_tile_units_to_pixels;attribute vec2 a_pos;varying vec2 v_pos;varying vec2 v_pos_world;
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp vec4 pattern
#pragma mapbox: define lowp float pixel_ratio
void main() {
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump vec4 pattern
#pragma mapbox: initialize lowp float pixel_ratio
vec2 pattern_tl=pattern.xy;vec2 pattern_br=pattern.zw;gl_Position=u_matrix*vec4(a_pos,0,1);vec2 display_size=(pattern_br-pattern_tl)/pixel_ratio;v_pos=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,display_size,u_tile_units_to_pixels,a_pos);v_pos_world=(gl_Position.xy/gl_Position.w+1.0)/2.0*u_world;
#ifdef FOG
v_fog_pos=fog_position(a_pos);
#endif
}`),fillPattern:Ci(`uniform vec2 u_texsize;uniform sampler2D u_image;varying vec2 v_pos;
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp vec4 pattern
void main() {
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump vec4 pattern
vec2 pattern_tl=pattern.xy;vec2 pattern_br=pattern.zw;vec2 imagecoord=mod(v_pos,1.0);vec2 pos=mix(pattern_tl/u_texsize,pattern_br/u_texsize,imagecoord);vec4 out_color=texture2D(u_image,pos);
#ifdef LIGHTING_3D_MODE
out_color=apply_lighting(out_color);
#endif
#ifdef FOG
out_color=fog_dither(fog_apply_premultiplied(out_color,v_fog_pos));
#endif
gl_FragColor=out_color*opacity;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`uniform mat4 u_matrix;uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform float u_tile_units_to_pixels;attribute vec2 a_pos;varying vec2 v_pos;
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp vec4 pattern
#pragma mapbox: define lowp float pixel_ratio
void main() {
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump vec4 pattern
#pragma mapbox: initialize lowp float pixel_ratio
vec2 pattern_tl=pattern.xy;vec2 pattern_br=pattern.zw;vec2 display_size=(pattern_br-pattern_tl)/pixel_ratio;gl_Position=u_matrix*vec4(a_pos,0,1);v_pos=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,display_size,u_tile_units_to_pixels,a_pos);
#ifdef FOG
v_fog_pos=fog_position(a_pos);
#endif
}`),fillExtrusion:Ci(`varying vec4 v_color;
#ifdef RENDER_SHADOWS
varying highp vec4 v_pos_light_view_0;varying highp vec4 v_pos_light_view_1;varying float v_depth;
#endif
#ifdef FAUX_AO
uniform lowp vec2 u_ao;varying vec3 v_ao;
#endif
#ifdef ZERO_ROOF_RADIUS
varying vec4 v_roof_color;
#endif
#if defined(ZERO_ROOF_RADIUS) || defined(RENDER_SHADOWS)
varying highp vec3 v_normal;
#endif
void main() {
#if defined(ZERO_ROOF_RADIUS) || defined(RENDER_SHADOWS)
vec3 normal=v_normal;
#endif
float z;vec4 color;
#ifdef ZERO_ROOF_RADIUS
z=float(normal.z > 0.00001);color=mix(v_color,v_roof_color,z);
#else
color=v_color;
#endif
#ifdef FAUX_AO
float intensity=u_ao[0];float h=max(0.0,v_ao.z);float h_floors=h/u_ao[1];float y_shade=1.0-0.9*intensity*min(v_ao.y,1.0);float shade=(1.0-0.08*intensity)*(y_shade+(1.0-y_shade)*(1.0-pow(1.0-min(h_floors/16.0,1.0),16.0)))+0.08*intensity*min(h_floors/160.0,1.0);float concave=v_ao.x*v_ao.x;
#ifdef ZERO_ROOF_RADIUS
concave*=(1.0-z);
#endif
float x_shade=mix(1.0,mix(0.6,0.75,min(h_floors/30.0,1.0)),intensity)+0.1*intensity*min(h,1.0);shade*=mix(1.0,x_shade*x_shade*x_shade,concave);color.rgb=color.rgb*shade;
#endif
#ifdef RENDER_SHADOWS
#ifdef ZERO_ROOF_RADIUS
normal=mix(normal,vec3(0.0,0.0,1.0),z);
#endif
color.xyz=shadowed_color_normal(color.xyz,normalize(normal),v_pos_light_view_0,v_pos_light_view_1,v_depth);
#endif
#ifdef FOG
color=fog_dither(fog_apply_premultiplied(color,v_fog_pos));
#endif
gl_FragColor=color;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`uniform mat4 u_matrix;uniform vec3 u_lightcolor;uniform lowp vec3 u_lightpos;uniform lowp float u_lightintensity;uniform float u_vertical_gradient;uniform lowp float u_opacity;uniform float u_edge_radius;attribute vec4 a_pos_normal_ed;attribute vec2 a_centroid_pos;
#ifdef PROJECTION_GLOBE_VIEW
attribute vec3 a_pos_3;attribute vec3 a_pos_normal_3;uniform mat4 u_inv_rot_matrix;uniform vec2 u_merc_center;uniform vec3 u_tile_id;uniform float u_zoom_transition;uniform vec3 u_up_dir;uniform float u_height_lift;
#endif
varying vec4 v_color;
#ifdef RENDER_SHADOWS
uniform mat4 u_light_matrix_0;uniform mat4 u_light_matrix_1;varying highp vec4 v_pos_light_view_0;varying highp vec4 v_pos_light_view_1;varying float v_depth;
#endif
#ifdef ZERO_ROOF_RADIUS
varying vec4 v_roof_color;
#endif
#if defined(ZERO_ROOF_RADIUS) || defined(RENDER_SHADOWS)
varying highp vec3 v_normal;
#endif
#ifdef FAUX_AO
uniform lowp vec2 u_ao;varying vec3 v_ao;
#endif
#pragma mapbox: define highp float base
#pragma mapbox: define highp float height
#pragma mapbox: define highp vec4 color
void main() {
#pragma mapbox: initialize highp float base
#pragma mapbox: initialize highp float height
#pragma mapbox: initialize highp vec4 color
vec4 pos_nx=floor(a_pos_normal_ed*0.5);vec4 top_up_ny_start=a_pos_normal_ed-2.0*pos_nx;vec3 top_up_ny=top_up_ny_start.xyz;float x_normal=pos_nx.z/8192.0;vec3 normal=top_up_ny.y==1.0 ? vec3(0.0,0.0,1.0) : normalize(vec3(x_normal,(2.0*top_up_ny.z-1.0)*(1.0-abs(x_normal)),0.0));
#if defined(ZERO_ROOF_RADIUS) || defined(RENDER_SHADOWS)
v_normal=normal;
#endif
base=max(0.0,base);height=max(0.0,top_up_ny.y==0.0 && top_up_ny.x==1.0 ? height-u_edge_radius : height);float t=top_up_ny.x;vec2 centroid_pos=vec2(0.0);
#if defined(HAS_CENTROID) || defined(TERRAIN)
centroid_pos=a_centroid_pos;
#endif
float ele=0.0;float h=0.0;float c_ele;vec3 pos;
#ifdef TERRAIN
bool flat_roof=centroid_pos.x !=0.0 && t > 0.0;ele=elevation(pos_nx.xy);c_ele=flat_roof ? centroid_pos.y==0.0 ? elevationFromUint16(centroid_pos.x) : flatElevation(centroid_pos) : ele;h=flat_roof ? max(c_ele+height,ele+base+2.0) : ele+(t > 0.0 ? height : base==0.0 ?-5.0 : base);pos=vec3(pos_nx.xy,h);
#else
h=t > 0.0 ? height : base;pos=vec3(pos_nx.xy,h);
#endif
#ifdef PROJECTION_GLOBE_VIEW
float lift=float((t+base) > 0.0)*u_height_lift;h+=lift;vec3 globe_normal=normalize(mix(a_pos_normal_3/16384.0,u_up_dir,u_zoom_transition));vec3 globe_pos=a_pos_3+globe_normal*(u_tile_up_scale*h);vec3 merc_pos=mercator_tile_position(u_inv_rot_matrix,pos.xy,u_tile_id,u_merc_center)+u_up_dir*u_tile_up_scale*pos.z;pos=mix_globe_mercator(globe_pos,merc_pos,u_zoom_transition);
#endif
float hidden=float(centroid_pos.x==0.0 && centroid_pos.y==1.0);gl_Position=mix(u_matrix*vec4(pos,1),AWAY,hidden);
#ifdef RENDER_SHADOWS
v_pos_light_view_0=u_light_matrix_0*vec4(pos,1);v_pos_light_view_1=u_light_matrix_1*vec4(pos,1);v_depth=gl_Position.w;
#endif
float NdotL=0.0;float colorvalue=0.0;
#ifdef LIGHTING_3D_MODE
NdotL=calculate_NdotL(normal);
#else
colorvalue=color.r*0.2126+color.g*0.7152+color.b*0.0722;vec4 ambientlight=vec4(0.03,0.03,0.03,1.0);color+=ambientlight;NdotL=clamp(dot(normal,u_lightpos),0.0,1.0);NdotL=mix((1.0-u_lightintensity),max((1.0-colorvalue+u_lightintensity),1.0),NdotL);
#endif
if (normal.y !=0.0) {float r=0.84;
#ifndef LIGHTING_3D_MODE
r=mix(0.7,0.98,1.0-u_lightintensity);
#endif
NdotL*=(
(1.0-u_vertical_gradient)+(u_vertical_gradient*clamp((t+base)*pow(height/150.0,0.5),r,1.0)));}v_color=vec4(0.0,0.0,0.0,1.0);
#ifdef FAUX_AO
float concave=pos_nx.w-floor(pos_nx.w*0.5)*2.0;float start=top_up_ny_start.w;float y_ground=1.0-clamp(t+base,0.0,1.0);float top_height=height;
#ifdef TERRAIN
top_height=mix(max(c_ele+height,ele+base+2.0),ele+height,float(centroid_pos.x==0.0))-ele;y_ground+=y_ground*5.0/max(3.0,top_height);
#endif
v_ao=vec3(mix(concave,-concave,start),y_ground,h-ele);NdotL*=(1.0+0.05*(1.0-top_up_ny.y)*u_ao[0]);
#ifdef PROJECTION_GLOBE_VIEW
top_height+=u_height_lift;
#endif
gl_Position.z-=(0.0000006*(min(top_height,500.)+2.0*min(base,500.0)+60.0*concave+3.0*start))*gl_Position.w;
#endif
#ifdef LIGHTING_3D_MODE
v_color=apply_lighting(color,NdotL);
#else
v_color.rgb+=clamp(color.rgb*NdotL*u_lightcolor,mix(vec3(0.0),vec3(0.3),1.0-u_lightcolor),vec3(1.0));
#endif
v_color*=u_opacity;
#ifdef ZERO_ROOF_RADIUS
v_roof_color=vec4(0.0,0.0,0.0,1.0);
#ifdef LIGHTING_3D_MODE
v_roof_color=apply_lighting(color,calculate_NdotL(vec3(0.0,0.0,1.0)));
#else
float roofNdotL=clamp(u_lightpos.z,0.0,1.0);roofNdotL=mix((1.0-u_lightintensity),max((1.0-colorvalue+u_lightintensity),1.0),roofNdotL);v_roof_color.rgb+=clamp(color.rgb*roofNdotL*u_lightcolor,mix(vec3(0.0),vec3(0.3),1.0-u_lightcolor),vec3(1.0));
#endif
v_roof_color*=u_opacity;
#endif
#ifdef FOG
v_fog_pos=fog_position(pos);
#endif
}`),fillExtrusionPattern:Ci(`uniform vec2 u_texsize;uniform sampler2D u_image;
#ifdef FAUX_AO
uniform lowp vec2 u_ao;varying vec3 v_ao;
#endif
#ifdef LIGHTING_3D_MODE
varying float v_NdotL;
#endif
varying vec2 v_pos;varying vec4 v_lighting;uniform lowp float u_opacity;
#pragma mapbox: define lowp float base
#pragma mapbox: define lowp float height
#pragma mapbox: define lowp vec4 pattern
#pragma mapbox: define lowp float pixel_ratio
void main() {
#pragma mapbox: initialize lowp float base
#pragma mapbox: initialize lowp float height
#pragma mapbox: initialize mediump vec4 pattern
#pragma mapbox: initialize lowp float pixel_ratio
vec2 pattern_tl=pattern.xy;vec2 pattern_br=pattern.zw;vec2 imagecoord=mod(v_pos,1.0);vec2 pos=mix(pattern_tl/u_texsize,pattern_br/u_texsize,imagecoord);vec4 out_color=texture2D(u_image,pos);
#ifdef LIGHTING_3D_MODE
out_color=apply_lighting(out_color,v_NdotL)*u_opacity;
#else
out_color=out_color*v_lighting;
#endif
#ifdef FAUX_AO
float intensity=u_ao[0];float h=max(0.0,v_ao.z);float h_floors=h/u_ao[1];float y_shade=1.0-0.9*intensity*min(v_ao.y,1.0);float shade=(1.0-0.08*intensity)*(y_shade+(1.0-y_shade)*(1.0-pow(1.0-min(h_floors/16.0,1.0),16.0)))+0.08*intensity*min(h_floors/160.0,1.0);float concave=v_ao.x*v_ao.x;float x_shade=mix(1.0,mix(0.6,0.75,min(h_floors/30.0,1.0)),intensity)+0.1*intensity*min(h,1.0);shade*=mix(1.0,x_shade*x_shade*x_shade,concave);out_color.rgb=out_color.rgb*shade;
#endif
#ifdef FOG
out_color=fog_dither(fog_apply_premultiplied(out_color,v_fog_pos));
#endif
gl_FragColor=out_color;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`uniform mat4 u_matrix;uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform float u_height_factor;uniform float u_tile_units_to_pixels;uniform float u_vertical_gradient;uniform lowp float u_opacity;uniform vec3 u_lightcolor;uniform lowp vec3 u_lightpos;uniform lowp float u_lightintensity;attribute vec4 a_pos_normal_ed;attribute vec2 a_centroid_pos;
#ifdef PROJECTION_GLOBE_VIEW
attribute vec3 a_pos_3;attribute vec3 a_pos_normal_3;uniform mat4 u_inv_rot_matrix;uniform vec2 u_merc_center;uniform vec3 u_tile_id;uniform float u_zoom_transition;uniform vec3 u_up_dir;uniform float u_height_lift;
#endif
varying vec2 v_pos;varying vec4 v_lighting;
#ifdef FAUX_AO
uniform lowp vec2 u_ao;varying vec3 v_ao;
#endif
#ifdef LIGHTING_3D_MODE
varying float v_NdotL;
#endif
#pragma mapbox: define lowp float base
#pragma mapbox: define lowp float height
#pragma mapbox: define lowp vec4 pattern
#pragma mapbox: define lowp float pixel_ratio
void main() {
#pragma mapbox: initialize lowp float base
#pragma mapbox: initialize lowp float height
#pragma mapbox: initialize mediump vec4 pattern
#pragma mapbox: initialize lowp float pixel_ratio
vec2 pattern_tl=pattern.xy;vec2 pattern_br=pattern.zw;vec4 pos_nx=floor(a_pos_normal_ed*0.5);mediump vec4 top_up_ny_start=a_pos_normal_ed-2.0*pos_nx;mediump vec3 top_up_ny=top_up_ny_start.xyz;float x_normal=pos_nx.z/8192.0;vec3 normal=top_up_ny.y==1.0 ? vec3(0.0,0.0,1.0) : normalize(vec3(x_normal,(2.0*top_up_ny.z-1.0)*(1.0-abs(x_normal)),0.0));float edgedistance=a_pos_normal_ed.w;vec2 display_size=(pattern_br-pattern_tl)/pixel_ratio;base=max(0.0,base);height=max(0.0,height);float t=top_up_ny.x;float z=t > 0.0 ? height : base;vec2 centroid_pos=vec2(0.0);
#if defined(HAS_CENTROID) || defined(TERRAIN)
centroid_pos=a_centroid_pos;
#endif
float ele=0.0;float h=z;vec3 p;float c_ele;
#ifdef TERRAIN
bool flat_roof=centroid_pos.x !=0.0 && t > 0.0;ele=elevation(pos_nx.xy);c_ele=flat_roof ? centroid_pos.y==0.0 ? elevationFromUint16(centroid_pos.x) : flatElevation(centroid_pos) : ele;h=flat_roof ? max(c_ele+height,ele+base+2.0) : ele+(t > 0.0 ? height : base==0.0 ?-5.0 : base);p=vec3(pos_nx.xy,h);
#else
p=vec3(pos_nx.xy,z);
#endif
#ifdef PROJECTION_GLOBE_VIEW
float lift=float((t+base) > 0.0)*u_height_lift;h+=lift;vec3 globe_normal=normalize(mix(a_pos_normal_3/16384.0,u_up_dir,u_zoom_transition));vec3 globe_pos=a_pos_3+globe_normal*(u_tile_up_scale*(p.z+lift));vec3 merc_pos=mercator_tile_position(u_inv_rot_matrix,p.xy,u_tile_id,u_merc_center)+u_up_dir*u_tile_up_scale*p.z;p=mix_globe_mercator(globe_pos,merc_pos,u_zoom_transition);
#endif
float hidden=float(centroid_pos.x==0.0 && centroid_pos.y==1.0);gl_Position=mix(u_matrix*vec4(p,1),AWAY,hidden);vec2 pos=normal.z==1.0
? pos_nx.xy
: vec2(edgedistance,z*u_height_factor);v_pos=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,display_size,u_tile_units_to_pixels,pos);v_lighting=vec4(0.0,0.0,0.0,1.0);float NdotL=0.0;
#ifdef LIGHTING_3D_MODE
NdotL=calculate_NdotL(normal);
#else
NdotL=clamp(dot(normal,u_lightpos),0.0,1.0);NdotL=mix((1.0-u_lightintensity),max((0.5+u_lightintensity),1.0),NdotL);
#endif
if (normal.y !=0.0) {float r=0.84;
#ifndef LIGHTING_3D_MODE
r=mix(0.7,0.98,1.0-u_lightintensity);
#endif
NdotL*=(
(1.0-u_vertical_gradient)+(u_vertical_gradient*clamp((t+base)*pow(height/150.0,0.5),r,1.0)));}
#ifdef FAUX_AO
float concave=pos_nx.w-floor(pos_nx.w*0.5)*2.0;float start=top_up_ny_start.w;float y_ground=1.0-clamp(t+base,0.0,1.0);float top_height=height;
#ifdef TERRAIN
top_height=mix(max(c_ele+height,ele+base+2.0),ele+height,float(centroid_pos.x==0.0))-ele;y_ground+=y_ground*5.0/max(3.0,top_height);
#endif
v_ao=vec3(mix(concave,-concave,start),y_ground,h-ele);NdotL*=(1.0+0.05*(1.0-top_up_ny.y)*u_ao[0]);
#ifdef PROJECTION_GLOBE_VIEW
top_height+=u_height_lift;
#endif
gl_Position.z-=(0.0000006*(min(top_height,500.)+2.0*min(base,500.0)+60.0*concave+3.0*start))*gl_Position.w;
#endif
#ifdef LIGHTING_3D_MODE
v_NdotL=NdotL;
#else
v_lighting.rgb+=clamp(NdotL*u_lightcolor,mix(vec3(0.0),vec3(0.3),1.0-u_lightcolor),vec3(1.0));v_lighting*=u_opacity;
#endif 
#ifdef FOG
v_fog_pos=fog_position(p);
#endif
}`),hillshadePrepare:Ci(`#ifdef GL_ES
precision highp float;
#endif
uniform sampler2D u_image;varying vec2 v_pos;uniform vec2 u_dimension;uniform float u_zoom;uniform vec4 u_unpack;float getElevation(vec2 coord) {
#ifdef TERRAIN_DEM_FLOAT_FORMAT
return texture2D(u_image,coord).a/4.0;
#else
vec4 data=texture2D(u_image,coord)*255.0;data.a=-1.0;return dot(data,u_unpack)/4.0;
#endif
}void main() {vec2 epsilon=1.0/u_dimension;float a=getElevation(v_pos+vec2(-epsilon.x,-epsilon.y));float b=getElevation(v_pos+vec2(0,-epsilon.y));float c=getElevation(v_pos+vec2(epsilon.x,-epsilon.y));float d=getElevation(v_pos+vec2(-epsilon.x,0));float e=getElevation(v_pos+vec2(epsilon.x,0));float f=getElevation(v_pos+vec2(-epsilon.x,epsilon.y));float g=getElevation(v_pos+vec2(0,epsilon.y));float h=getElevation(v_pos+vec2(epsilon.x,epsilon.y));float exaggerationFactor=u_zoom < 2.0 ? 0.4 : u_zoom < 4.5 ? 0.35 : 0.3;float exaggeration=u_zoom < 15.0 ? (u_zoom-15.0)*exaggerationFactor : 0.0;vec2 deriv=vec2(
(c+e+e+h)-(a+d+d+f),(f+g+g+h)-(a+b+b+c)
)/pow(2.0,exaggeration+(19.2562-u_zoom));gl_FragColor=clamp(vec4(
deriv.x/2.0+0.5,deriv.y/2.0+0.5,1.0,1.0),0.0,1.0);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,"uniform mat4 u_matrix;uniform vec2 u_dimension;attribute vec2 a_pos;attribute vec2 a_texture_pos;varying vec2 v_pos;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);highp vec2 epsilon=1.0/u_dimension;float scale=(u_dimension.x-2.0)/u_dimension.x;v_pos=(a_texture_pos/8192.0)*scale+epsilon;}"),hillshade:Ci(`uniform sampler2D u_image;varying vec2 v_pos;uniform vec2 u_latrange;uniform vec2 u_light;uniform vec4 u_shadow;uniform vec4 u_highlight;uniform vec4 u_accent;void main() {vec4 pixel=texture2D(u_image,v_pos);vec2 deriv=((pixel.rg*2.0)-1.0);float scaleFactor=cos(radians((u_latrange[0]-u_latrange[1])*(1.0-v_pos.y)+u_latrange[1]));float slope=atan(1.25*length(deriv)/scaleFactor);float aspect=deriv.x !=0.0 ? atan(deriv.y,-deriv.x) : PI/2.0*(deriv.y > 0.0 ? 1.0 :-1.0);float intensity=u_light.x;float azimuth=u_light.y+PI;float base=1.875-intensity*1.75;float maxValue=0.5*PI;float scaledSlope=intensity !=0.5 ? ((pow(base,slope)-1.0)/(pow(base,maxValue)-1.0))*maxValue : slope;float accent=cos(scaledSlope);vec4 accent_color=(1.0-accent)*u_accent*clamp(intensity*2.0,0.0,1.0);float shade=abs(mod((aspect+azimuth)/PI+0.5,2.0)-1.0);vec4 shade_color=mix(u_shadow,u_highlight,shade)*sin(scaledSlope)*clamp(intensity*2.0,0.0,1.0);gl_FragColor=accent_color*(1.0-shade_color.a)+shade_color;
#ifdef LIGHTING_3D_MODE
gl_FragColor=apply_lighting(gl_FragColor);
#endif
#ifdef FOG
gl_FragColor=fog_dither(fog_apply_premultiplied(gl_FragColor,v_fog_pos));
#endif
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`uniform mat4 u_matrix;attribute vec2 a_pos;attribute vec2 a_texture_pos;varying vec2 v_pos;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);v_pos=a_texture_pos/8192.0;
#ifdef FOG
v_fog_pos=fog_position(a_pos);
#endif
}`),line:Ci(`uniform lowp float u_device_pixel_ratio;uniform float u_alpha_discard_threshold;uniform highp vec2 u_trim_offset;varying vec2 v_width2;varying vec2 v_normal;varying float v_gamma_scale;varying highp vec4 v_uv;
#ifdef RENDER_LINE_DASH
uniform sampler2D u_dash_image;varying vec2 v_tex;
#endif
#ifdef RENDER_LINE_GRADIENT
uniform sampler2D u_gradient_image;
#endif
uniform float u_border_width;uniform vec4 u_border_color;float luminance(vec3 c) {return (c.r+c.r+c.b+c.g+c.g+c.g)*0.1667;}
#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float floorwidth
#pragma mapbox: define lowp vec4 dash
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
float linearstep(float edge0,float edge1,float x) {return  clamp((x-edge0)/(edge1-edge0),0.0,1.0);}void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float floorwidth
#pragma mapbox: initialize lowp vec4 dash
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
float dist=length(v_normal)*v_width2.s;float blur2=(blur+1.0/u_device_pixel_ratio)*v_gamma_scale;float alpha=clamp(min(dist-(v_width2.t-blur2),v_width2.s-dist)/blur2,0.0,1.0);
#ifdef RENDER_LINE_DASH
float sdfdist=texture2D(u_dash_image,v_tex).a;float sdfgamma=1.0/(2.0*u_device_pixel_ratio)/dash.z;alpha*=linearstep(0.5-sdfgamma/floorwidth,0.5+sdfgamma/floorwidth,sdfdist);
#endif
highp vec4 out_color;
#ifdef RENDER_LINE_GRADIENT
out_color=texture2D(u_gradient_image,v_uv.xy);
#else
out_color=color;
#endif
float trimmed=1.0;
#ifdef RENDER_LINE_TRIM_OFFSET
highp float start=v_uv[2];highp float end=v_uv[3];highp float trim_start=u_trim_offset[0];highp float trim_end=u_trim_offset[1];highp float line_progress=(start+(v_uv.x)*(end-start));if (trim_end > trim_start) {if (line_progress <=trim_end && line_progress >=trim_start) {out_color=vec4(0,0,0,0);trimmed=0.0;}}
#endif
#ifdef LIGHTING_3D_MODE
out_color=apply_lighting(out_color);
#endif
#ifdef FOG
out_color=fog_dither(fog_apply_premultiplied(out_color,v_fog_pos));
#endif
#ifdef RENDER_LINE_ALPHA_DISCARD
if (alpha < u_alpha_discard_threshold) {discard;}
#endif
#ifdef RENDER_LINE_BORDER
float edgeBlur=(u_border_width+1.0/u_device_pixel_ratio);float alpha2=clamp(min(dist-(v_width2.t-edgeBlur),v_width2.s-dist)/edgeBlur,0.0,1.0);if (alpha2 < 1.) {float smoothAlpha=smoothstep(0.6,1.0,alpha2);
#ifdef RENDER_LINE_BORDER_AUTO
float Y=(out_color.a > 0.01) ? luminance(out_color.rgb/out_color.a) : 1.;float adjustment=(Y > 0.) ? 0.5/Y : 0.45;if (out_color.a > 0.25 && Y < 0.25) {vec3 borderColor=(Y > 0.) ? out_color.rgb : vec3(1,1,1)*out_color.a;out_color.rgb=out_color.rgb+borderColor*(adjustment*(1.0-smoothAlpha));} else {out_color.rgb*=(0.6 +0.4*smoothAlpha);}
#else
out_color.rgb=mix(u_border_color.rgb*u_border_color.a*trimmed,out_color.rgb,smoothAlpha);
#endif
}
#endif
gl_FragColor=out_color*(alpha*opacity);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`
#define EXTRUDE_SCALE 0.015873016
attribute vec2 a_pos_normal;attribute vec4 a_data;
#if defined(RENDER_LINE_GRADIENT) || defined(RENDER_LINE_TRIM_OFFSET)
attribute highp vec4 a_packed;
#endif
#ifdef RENDER_LINE_DASH
attribute float a_linesofar;
#endif
uniform mat4 u_matrix;uniform mat2 u_pixels_to_tile_units;uniform vec2 u_units_to_pixels;uniform lowp float u_device_pixel_ratio;varying vec2 v_normal;varying vec2 v_width2;varying float v_gamma_scale;varying highp vec4 v_uv;
#ifdef RENDER_LINE_DASH
uniform vec2 u_texsize;uniform float u_tile_units_to_pixels;varying vec2 v_tex;
#endif
#ifdef RENDER_LINE_GRADIENT
uniform float u_image_height;
#endif
#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float floorwidth
#pragma mapbox: define lowp vec4 dash
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define mediump float gapwidth
#pragma mapbox: define lowp float offset
#pragma mapbox: define mediump float width
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float floorwidth
#pragma mapbox: initialize lowp vec4 dash
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump float gapwidth
#pragma mapbox: initialize lowp float offset
#pragma mapbox: initialize mediump float width
float ANTIALIASING=1.0/u_device_pixel_ratio/2.0;vec2 a_extrude=a_data.xy-128.0;float a_direction=mod(a_data.z,4.0)-1.0;vec2 pos=floor(a_pos_normal*0.5);mediump vec2 normal=a_pos_normal-2.0*pos;normal.y=normal.y*2.0-1.0;v_normal=normal;gapwidth=gapwidth/2.0;float halfwidth=width/2.0;offset=-1.0*offset;float inset=gapwidth+(gapwidth > 0.0 ? ANTIALIASING : 0.0);float outset=gapwidth+halfwidth*(gapwidth > 0.0 ? 2.0 : 1.0)+(halfwidth==0.0 ? 0.0 : ANTIALIASING);mediump vec2 dist=outset*a_extrude*EXTRUDE_SCALE;mediump float u=0.5*a_direction;mediump float t=1.0-abs(u);mediump vec2 offset2=offset*a_extrude*EXTRUDE_SCALE*normal.y*mat2(t,-u,u,t);vec4 projected_extrude=u_matrix*vec4(dist*u_pixels_to_tile_units,0.0,0.0);gl_Position=u_matrix*vec4(pos+offset2*u_pixels_to_tile_units,0.0,1.0)+projected_extrude;
#ifndef RENDER_TO_TEXTURE
float extrude_length_without_perspective=length(dist);float extrude_length_with_perspective=length(projected_extrude.xy/gl_Position.w*u_units_to_pixels);v_gamma_scale=extrude_length_without_perspective/extrude_length_with_perspective;
#else
v_gamma_scale=1.0;
#endif
#if defined(RENDER_LINE_GRADIENT) || defined(RENDER_LINE_TRIM_OFFSET)
float a_uv_x=a_packed[0];float a_split_index=a_packed[1];highp float a_clip_start=a_packed[2];highp float a_clip_end=a_packed[3];
#ifdef RENDER_LINE_GRADIENT
highp float texel_height=1.0/u_image_height;highp float half_texel_height=0.5*texel_height;v_uv=vec4(a_uv_x,a_split_index*texel_height-half_texel_height,a_clip_start,a_clip_end);
#else
v_uv=vec4(a_uv_x,0.0,a_clip_start,a_clip_end);
#endif
#endif
#ifdef RENDER_LINE_DASH
float scale=dash.z==0.0 ? 0.0 : u_tile_units_to_pixels/dash.z;float height=dash.y;v_tex=vec2(a_linesofar*scale/floorwidth,(-normal.y*height+dash.x+0.5)/u_texsize.y);
#endif
v_width2=vec2(outset,inset);
#ifdef FOG
v_fog_pos=fog_position(pos);
#endif
}`),linePattern:Ci(`uniform lowp float u_device_pixel_ratio;uniform vec2 u_texsize;uniform float u_tile_units_to_pixels;uniform sampler2D u_image;varying vec2 v_normal;varying vec2 v_width2;varying float v_linesofar;varying float v_gamma_scale;varying float v_width;
#pragma mapbox: define lowp vec4 pattern
#pragma mapbox: define lowp float pixel_ratio
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize mediump vec4 pattern
#pragma mapbox: initialize lowp float pixel_ratio
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
vec2 pattern_tl=pattern.xy;vec2 pattern_br=pattern.zw;vec2 display_size=(pattern_br-pattern_tl)/pixel_ratio;vec2 pattern_size=vec2(display_size.x/u_tile_units_to_pixels,display_size.y);float aspect=display_size.y/v_width;float dist=length(v_normal)*v_width2.s;float blur2=(blur+1.0/u_device_pixel_ratio)*v_gamma_scale;float alpha=clamp(min(dist-(v_width2.t-blur2),v_width2.s-dist)/blur2,0.0,1.0);float x=mod(v_linesofar/pattern_size.x*aspect,1.0);float y=0.5*v_normal.y+0.5;vec2 texel_size=1.0/u_texsize;vec2 pos=mix(pattern_tl*texel_size-texel_size,pattern_br*texel_size+texel_size,vec2(x,y));vec4 color=texture2D(u_image,pos);
#ifdef LIGHTING_3D_MODE
color=apply_lighting(color);
#endif
#ifdef FOG
color=fog_dither(fog_apply_premultiplied(color,v_fog_pos));
#endif
gl_FragColor=color*(alpha*opacity);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`
#define scale 0.015873016
attribute vec2 a_pos_normal;attribute vec4 a_data;attribute float a_linesofar;uniform mat4 u_matrix;uniform vec2 u_units_to_pixels;uniform mat2 u_pixels_to_tile_units;uniform lowp float u_device_pixel_ratio;varying vec2 v_normal;varying vec2 v_width2;varying float v_linesofar;varying float v_gamma_scale;varying float v_width;
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp float offset
#pragma mapbox: define mediump float gapwidth
#pragma mapbox: define mediump float width
#pragma mapbox: define lowp float floorwidth
#pragma mapbox: define lowp vec4 pattern
#pragma mapbox: define lowp float pixel_ratio
void main() {
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize lowp float offset
#pragma mapbox: initialize mediump float gapwidth
#pragma mapbox: initialize mediump float width
#pragma mapbox: initialize lowp float floorwidth
#pragma mapbox: initialize mediump vec4 pattern
#pragma mapbox: initialize lowp float pixel_ratio
float ANTIALIASING=1.0/u_device_pixel_ratio/2.0;vec2 a_extrude=a_data.xy-128.0;float a_direction=mod(a_data.z,4.0)-1.0;vec2 pos=floor(a_pos_normal*0.5);mediump vec2 normal=a_pos_normal-2.0*pos;normal.y=normal.y*2.0-1.0;v_normal=normal;gapwidth=gapwidth/2.0;float halfwidth=width/2.0;offset=-1.0*offset;float inset=gapwidth+(gapwidth > 0.0 ? ANTIALIASING : 0.0);float outset=gapwidth+halfwidth*(gapwidth > 0.0 ? 2.0 : 1.0)+(halfwidth==0.0 ? 0.0 : ANTIALIASING);mediump vec2 dist=outset*a_extrude*scale;mediump float u=0.5*a_direction;mediump float t=1.0-abs(u);mediump vec2 offset2=offset*a_extrude*scale*normal.y*mat2(t,-u,u,t);vec4 projected_extrude=u_matrix*vec4(dist*u_pixels_to_tile_units,0.0,0.0);gl_Position=u_matrix*vec4(pos+offset2*u_pixels_to_tile_units,0.0,1.0)+projected_extrude;
#ifndef RENDER_TO_TEXTURE
float extrude_length_without_perspective=length(dist);float extrude_length_with_perspective=length(projected_extrude.xy/gl_Position.w*u_units_to_pixels);v_gamma_scale=extrude_length_without_perspective/extrude_length_with_perspective;
#else
v_gamma_scale=1.0;
#endif
v_linesofar=a_linesofar;v_width2=vec2(outset,inset);v_width=floorwidth;
#ifdef FOG
v_fog_pos=fog_position(pos);
#endif
}`),raster:Ci(`uniform float u_fade_t;uniform float u_opacity;uniform sampler2D u_image0;uniform sampler2D u_image1;varying vec2 v_pos0;varying vec2 v_pos1;uniform float u_brightness_low;uniform float u_brightness_high;uniform float u_saturation_factor;uniform float u_contrast_factor;uniform vec3 u_spin_weights;void main() {vec4 color0=texture2D(u_image0,v_pos0);vec4 color1=texture2D(u_image1,v_pos1);if (color0.a > 0.0) {color0.rgb=color0.rgb/color0.a;}if (color1.a > 0.0) {color1.rgb=color1.rgb/color1.a;}vec4 color=mix(color0,color1,u_fade_t);color.a*=u_opacity;vec3 rgb=color.rgb;rgb=vec3(
dot(rgb,u_spin_weights.xyz),dot(rgb,u_spin_weights.zxy),dot(rgb,u_spin_weights.yzx));float average=(color.r+color.g+color.b)/3.0;rgb+=(average-rgb)*u_saturation_factor;rgb=(rgb-0.5)*u_contrast_factor+0.5;vec3 u_high_vec=vec3(u_brightness_low,u_brightness_low,u_brightness_low);vec3 u_low_vec=vec3(u_brightness_high,u_brightness_high,u_brightness_high);vec3 out_color=mix(u_high_vec,u_low_vec,rgb);
#ifdef LIGHTING_3D_MODE
out_color=apply_lighting(out_color);
#endif
#ifdef FOG
out_color=fog_dither(fog_apply(out_color,v_fog_pos));
#endif
gl_FragColor=vec4(out_color*color.a,color.a);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`uniform mat4 u_matrix;uniform vec2 u_tl_parent;uniform float u_scale_parent;uniform vec2 u_perspective_transform;attribute vec2 a_pos;attribute vec2 a_texture_pos;varying vec2 v_pos0;varying vec2 v_pos1;void main() {float w=1.0+dot(a_texture_pos,u_perspective_transform);gl_Position=u_matrix*vec4(a_pos*w,0,w);v_pos0=a_texture_pos/8192.0;v_pos1=(v_pos0*u_scale_parent)+u_tl_parent;
#ifdef FOG
v_fog_pos=fog_position(a_pos);
#endif
}`),symbolIcon:Ci(`uniform sampler2D u_texture;varying vec2 v_tex;varying float v_fade_opacity;
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize lowp float opacity
lowp float alpha=opacity*v_fade_opacity;gl_FragColor=texture2D(u_texture,v_tex)*alpha;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`attribute vec4 a_pos_offset;attribute vec4 a_tex_size;attribute vec4 a_pixeloffset;attribute vec4 a_projected_pos;attribute float a_fade_opacity;
#ifdef PROJECTION_GLOBE_VIEW
attribute vec3 a_globe_anchor;attribute vec3 a_globe_normal;
#endif
uniform bool u_is_size_zoom_constant;uniform bool u_is_size_feature_constant;uniform highp float u_size_t;uniform highp float u_size;uniform highp float u_camera_to_center_distance;uniform bool u_rotate_symbol;uniform highp float u_aspect_ratio;uniform float u_fade_change;uniform mat4 u_matrix;uniform mat4 u_label_plane_matrix;uniform mat4 u_coord_matrix;uniform bool u_is_text;uniform bool u_pitch_with_map;uniform vec2 u_texsize;uniform vec3 u_up_vector;
#ifdef PROJECTION_GLOBE_VIEW
uniform vec3 u_tile_id;uniform mat4 u_inv_rot_matrix;uniform vec2 u_merc_center;uniform vec3 u_camera_forward;uniform float u_zoom_transition;uniform vec3 u_ecef_origin;uniform mat4 u_tile_matrix;
#endif
varying vec2 v_tex;varying float v_fade_opacity;
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize lowp float opacity
vec2 a_pos=a_pos_offset.xy;vec2 a_offset=a_pos_offset.zw;vec2 a_tex=a_tex_size.xy;vec2 a_size=a_tex_size.zw;float a_size_min=floor(a_size[0]*0.5);vec2 a_pxoffset=a_pixeloffset.xy;vec2 a_min_font_scale=a_pixeloffset.zw/256.0;highp float segment_angle=-a_projected_pos[3];float size;if (!u_is_size_zoom_constant && !u_is_size_feature_constant) {size=mix(a_size_min,a_size[1],u_size_t)/128.0;} else if (u_is_size_zoom_constant && !u_is_size_feature_constant) {size=a_size_min/128.0;} else {size=u_size;}vec2 tile_anchor=a_pos;vec3 h=elevationVector(tile_anchor)*elevation(tile_anchor);float globe_occlusion_fade;vec3 world_pos;vec3 mercator_pos;
#ifdef PROJECTION_GLOBE_VIEW
mercator_pos=mercator_tile_position(u_inv_rot_matrix,tile_anchor,u_tile_id,u_merc_center);world_pos=mix_globe_mercator(a_globe_anchor+h,mercator_pos,u_zoom_transition);vec4 ecef_point=u_tile_matrix*vec4(world_pos,1.0);vec3 origin_to_point=ecef_point.xyz-u_ecef_origin;globe_occlusion_fade=dot(origin_to_point,u_camera_forward) >=0.0 ? 0.0 : 1.0;
#else
world_pos=vec3(tile_anchor,0)+h;globe_occlusion_fade=1.0;
#endif
vec4 projected_point=u_matrix*vec4(world_pos,1);highp float camera_to_anchor_distance=projected_point.w;highp float distance_ratio=u_pitch_with_map ?
camera_to_anchor_distance/u_camera_to_center_distance :
u_camera_to_center_distance/camera_to_anchor_distance;highp float perspective_ratio=clamp(
0.5+0.5*distance_ratio,0.0,1.5);size*=perspective_ratio;float font_scale=u_is_text ? size/24.0 : size;highp float symbol_rotation=0.0;if (u_rotate_symbol) {vec4 offsetProjected_point;
#ifdef PROJECTION_GLOBE_VIEW
vec3 displacement=vec3(a_globe_normal.z,0,-a_globe_normal.x);offsetProjected_point=u_matrix*vec4(a_globe_anchor+displacement,1);
#else
offsetProjected_point=u_matrix*vec4(tile_anchor+vec2(1,0),0,1);
#endif
vec2 a=projected_point.xy/projected_point.w;vec2 b=offsetProjected_point.xy/offsetProjected_point.w;symbol_rotation=atan((b.y-a.y)/u_aspect_ratio,b.x-a.x);}vec4 projected_pos;
#ifdef PROJECTION_GLOBE_VIEW
vec3 proj_pos=mix_globe_mercator(a_projected_pos.xyz+h,mercator_pos,u_zoom_transition);projected_pos=u_label_plane_matrix*vec4(proj_pos,1.0);
#else
projected_pos=u_label_plane_matrix*vec4(a_projected_pos.xy,h.z,1.0);
#endif
highp float angle_sin=sin(segment_angle+symbol_rotation);highp float angle_cos=cos(segment_angle+symbol_rotation);mat2 rotation_matrix=mat2(angle_cos,-1.0*angle_sin,angle_sin,angle_cos);float z=0.0;vec2 offset=rotation_matrix*(a_offset/32.0*max(a_min_font_scale,font_scale)+a_pxoffset/16.0);
#ifdef TERRAIN
#ifdef PITCH_WITH_MAP_TERRAIN
vec4 tile_pos=u_label_plane_matrix_inv*vec4(a_projected_pos.xy+offset,0.0,1.0);z=elevation(tile_pos.xy);
#endif
#endif
float occlusion_fade=occlusionFade(projected_point)*globe_occlusion_fade;
#ifdef PROJECTION_GLOBE_VIEW
vec3 xAxis=u_pitch_with_map ? normalize(cross(a_globe_normal,u_up_vector)) : vec3(1,0,0);vec3 yAxis=u_pitch_with_map ? normalize(cross(a_globe_normal,xAxis)) : vec3(0,1,0);gl_Position=mix(u_coord_matrix*vec4(projected_pos.xyz/projected_pos.w+xAxis*offset.x+yAxis*offset.y,1.0),AWAY,float(projected_point.w <=0.0 || occlusion_fade==0.0));
#else
gl_Position=mix(u_coord_matrix*vec4(projected_pos.xy/projected_pos.w+offset,z,1.0),AWAY,float(projected_point.w <=0.0 || occlusion_fade==0.0));
#endif
float projection_transition_fade=1.0;
#if defined(PROJECTED_POS_ON_VIEWPORT) && defined(PROJECTION_GLOBE_VIEW)
projection_transition_fade=1.0-step(EPSILON,u_zoom_transition);
#endif
v_tex=a_tex/u_texsize;vec2 fade_opacity=unpack_opacity(a_fade_opacity);float fade_change=fade_opacity[1] > 0.5 ? u_fade_change :-u_fade_change;v_fade_opacity=max(0.0,min(occlusion_fade,fade_opacity[0]+fade_change))*projection_transition_fade;}`),symbolSDF:Ci(`#define SDF_PX 8.0
uniform bool u_is_halo;uniform sampler2D u_texture;uniform highp float u_gamma_scale;uniform lowp float u_device_pixel_ratio;uniform bool u_is_text;varying vec2 v_data0;varying vec3 v_data1;
#pragma mapbox: define highp vec4 fill_color
#pragma mapbox: define highp vec4 halo_color
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp float halo_width
#pragma mapbox: define lowp float halo_blur
void main() {
#pragma mapbox: initialize highp vec4 fill_color
#pragma mapbox: initialize highp vec4 halo_color
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize lowp float halo_width
#pragma mapbox: initialize lowp float halo_blur
float EDGE_GAMMA=0.105/u_device_pixel_ratio;vec2 tex=v_data0.xy;float gamma_scale=v_data1.x;float size=v_data1.y;float fade_opacity=v_data1[2];float fontScale=u_is_text ? size/24.0 : size;lowp vec4 color=fill_color;highp float gamma=EDGE_GAMMA/(fontScale*u_gamma_scale);lowp float buff=(256.0-64.0)/256.0;if (u_is_halo) {color=halo_color;gamma=(halo_blur*1.19/SDF_PX+EDGE_GAMMA)/(fontScale*u_gamma_scale);buff=(6.0-halo_width/fontScale)/SDF_PX;}lowp float dist=texture2D(u_texture,tex).a;highp float gamma_scaled=gamma*gamma_scale;highp float alpha=smoothstep(buff-gamma_scaled,buff+gamma_scaled,dist);gl_FragColor=color*(alpha*opacity*fade_opacity);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`attribute vec4 a_pos_offset;attribute vec4 a_tex_size;attribute vec4 a_pixeloffset;attribute vec4 a_projected_pos;attribute float a_fade_opacity;
#ifdef PROJECTION_GLOBE_VIEW
attribute vec3 a_globe_anchor;attribute vec3 a_globe_normal;
#endif
uniform bool u_is_size_zoom_constant;uniform bool u_is_size_feature_constant;uniform highp float u_size_t;uniform highp float u_size;uniform mat4 u_matrix;uniform mat4 u_label_plane_matrix;uniform mat4 u_coord_matrix;uniform bool u_is_text;uniform bool u_pitch_with_map;uniform bool u_rotate_symbol;uniform highp float u_aspect_ratio;uniform highp float u_camera_to_center_distance;uniform float u_fade_change;uniform vec2 u_texsize;uniform vec3 u_up_vector;
#ifdef PROJECTION_GLOBE_VIEW
uniform vec3 u_tile_id;uniform mat4 u_inv_rot_matrix;uniform vec2 u_merc_center;uniform vec3 u_camera_forward;uniform float u_zoom_transition;uniform vec3 u_ecef_origin;uniform mat4 u_tile_matrix;
#endif
varying vec2 v_data0;varying vec3 v_data1;
#pragma mapbox: define highp vec4 fill_color
#pragma mapbox: define highp vec4 halo_color
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp float halo_width
#pragma mapbox: define lowp float halo_blur
void main() {
#pragma mapbox: initialize highp vec4 fill_color
#pragma mapbox: initialize highp vec4 halo_color
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize lowp float halo_width
#pragma mapbox: initialize lowp float halo_blur
vec2 a_pos=a_pos_offset.xy;vec2 a_offset=a_pos_offset.zw;vec2 a_tex=a_tex_size.xy;vec2 a_size=a_tex_size.zw;float a_size_min=floor(a_size[0]*0.5);vec2 a_pxoffset=a_pixeloffset.xy;highp float segment_angle=-a_projected_pos[3];float size;if (!u_is_size_zoom_constant && !u_is_size_feature_constant) {size=mix(a_size_min,a_size[1],u_size_t)/128.0;} else if (u_is_size_zoom_constant && !u_is_size_feature_constant) {size=a_size_min/128.0;} else {size=u_size;}vec2 tile_anchor=a_pos;vec3 h=elevationVector(tile_anchor)*elevation(tile_anchor);float globe_occlusion_fade;vec3 world_pos;vec3 mercator_pos;
#ifdef PROJECTION_GLOBE_VIEW
mercator_pos=mercator_tile_position(u_inv_rot_matrix,tile_anchor,u_tile_id,u_merc_center);world_pos=mix_globe_mercator(a_globe_anchor+h,mercator_pos,u_zoom_transition);vec4 ecef_point=u_tile_matrix*vec4(world_pos,1.0);vec3 origin_to_point=ecef_point.xyz-u_ecef_origin;globe_occlusion_fade=dot(origin_to_point,u_camera_forward) >=0.0 ? 0.0 : 1.0;
#else
world_pos=vec3(tile_anchor,0)+h;globe_occlusion_fade=1.0;
#endif
vec4 projected_point=u_matrix*vec4(world_pos,1);highp float camera_to_anchor_distance=projected_point.w;highp float distance_ratio=u_pitch_with_map ?
camera_to_anchor_distance/u_camera_to_center_distance :
u_camera_to_center_distance/camera_to_anchor_distance;highp float perspective_ratio=clamp(
0.5+0.5*distance_ratio,0.0,1.5);size*=perspective_ratio;float fontScale=u_is_text ? size/24.0 : size;highp float symbol_rotation=0.0;if (u_rotate_symbol) {vec4 offsetprojected_point;
#ifdef PROJECTION_GLOBE_VIEW
vec3 displacement=vec3(a_globe_normal.z,0,-a_globe_normal.x);offsetprojected_point=u_matrix*vec4(a_globe_anchor+displacement,1);
#else
offsetprojected_point=u_matrix*vec4(tile_anchor+vec2(1,0),0,1);
#endif
vec2 a=projected_point.xy/projected_point.w;vec2 b=offsetprojected_point.xy/offsetprojected_point.w;symbol_rotation=atan((b.y-a.y)/u_aspect_ratio,b.x-a.x);}vec4 projected_pos;
#ifdef PROJECTION_GLOBE_VIEW
vec3 proj_pos=mix_globe_mercator(a_projected_pos.xyz+h,mercator_pos,u_zoom_transition);projected_pos=u_label_plane_matrix*vec4(proj_pos,1.0);
#else
projected_pos=u_label_plane_matrix*vec4(a_projected_pos.xy,h.z,1.0);
#endif
highp float angle_sin=sin(segment_angle+symbol_rotation);highp float angle_cos=cos(segment_angle+symbol_rotation);mat2 rotation_matrix=mat2(angle_cos,-1.0*angle_sin,angle_sin,angle_cos);float z=0.0;vec2 offset=rotation_matrix*(a_offset/32.0*fontScale+a_pxoffset);
#ifdef TERRAIN
#ifdef PITCH_WITH_MAP_TERRAIN
vec4 tile_pos=u_label_plane_matrix_inv*vec4(a_projected_pos.xy+offset,0.0,1.0);z=elevation(tile_pos.xy);
#endif
#endif
float occlusion_fade=occlusionFade(projected_point)*globe_occlusion_fade;
#ifdef PROJECTION_GLOBE_VIEW
vec3 xAxis=u_pitch_with_map ? normalize(cross(a_globe_normal,u_up_vector)) : vec3(1,0,0);vec3 yAxis=u_pitch_with_map ? normalize(cross(a_globe_normal,xAxis)) : vec3(0,1,0);gl_Position=mix(u_coord_matrix*vec4(projected_pos.xyz/projected_pos.w+xAxis*offset.x+yAxis*offset.y,1.0),AWAY,float(projected_point.w <=0.0 || occlusion_fade==0.0));
#else
gl_Position=mix(u_coord_matrix*vec4(projected_pos.xy/projected_pos.w+offset,z,1.0),AWAY,float(projected_point.w <=0.0 || occlusion_fade==0.0));
#endif
float gamma_scale=gl_Position.w;float projection_transition_fade=1.0;
#if defined(PROJECTED_POS_ON_VIEWPORT) && defined(PROJECTION_GLOBE_VIEW)
projection_transition_fade=1.0-step(EPSILON,u_zoom_transition);
#endif
vec2 fade_opacity=unpack_opacity(a_fade_opacity);float fade_change=fade_opacity[1] > 0.5 ? u_fade_change :-u_fade_change;float interpolated_fade_opacity=max(0.0,min(occlusion_fade,fade_opacity[0]+fade_change));v_data0=a_tex/u_texsize;v_data1=vec3(gamma_scale,size,interpolated_fade_opacity*projection_transition_fade);}`),symbolTextAndIcon:Ci(`#define SDF_PX 8.0
#define SDF 1.0
#define ICON 0.0
uniform bool u_is_halo;uniform sampler2D u_texture;uniform sampler2D u_texture_icon;uniform highp float u_gamma_scale;uniform lowp float u_device_pixel_ratio;varying vec4 v_data0;varying vec4 v_data1;
#pragma mapbox: define highp vec4 fill_color
#pragma mapbox: define highp vec4 halo_color
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp float halo_width
#pragma mapbox: define lowp float halo_blur
void main() {
#pragma mapbox: initialize highp vec4 fill_color
#pragma mapbox: initialize highp vec4 halo_color
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize lowp float halo_width
#pragma mapbox: initialize lowp float halo_blur
float fade_opacity=v_data1[2];if (v_data1.w==ICON) {vec2 tex_icon=v_data0.zw;lowp float alpha=opacity*fade_opacity;gl_FragColor=texture2D(u_texture_icon,tex_icon)*alpha;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
return;}vec2 tex=v_data0.xy;float EDGE_GAMMA=0.105/u_device_pixel_ratio;float gamma_scale=v_data1.x;float size=v_data1.y;float fontScale=size/24.0;lowp vec4 color=fill_color;highp float gamma=EDGE_GAMMA/(fontScale*u_gamma_scale);lowp float buff=(256.0-64.0)/256.0;if (u_is_halo) {color=halo_color;gamma=(halo_blur*1.19/SDF_PX+EDGE_GAMMA)/(fontScale*u_gamma_scale);buff=(6.0-halo_width/fontScale)/SDF_PX;}lowp float dist=texture2D(u_texture,tex).a;highp float gamma_scaled=gamma*gamma_scale;highp float alpha=smoothstep(buff-gamma_scaled,buff+gamma_scaled,dist);gl_FragColor=color*(alpha*opacity*fade_opacity);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`attribute vec4 a_pos_offset;attribute vec4 a_tex_size;attribute vec4 a_projected_pos;attribute float a_fade_opacity;
#ifdef PROJECTION_GLOBE_VIEW
attribute vec3 a_globe_anchor;attribute vec3 a_globe_normal;
#endif
uniform bool u_is_size_zoom_constant;uniform bool u_is_size_feature_constant;uniform highp float u_size_t;uniform highp float u_size;uniform mat4 u_matrix;uniform mat4 u_label_plane_matrix;uniform mat4 u_coord_matrix;uniform bool u_is_text;uniform bool u_pitch_with_map;uniform bool u_rotate_symbol;uniform highp float u_aspect_ratio;uniform highp float u_camera_to_center_distance;uniform float u_fade_change;uniform vec2 u_texsize;uniform vec3 u_up_vector;uniform vec2 u_texsize_icon;
#ifdef PROJECTION_GLOBE_VIEW
uniform vec3 u_tile_id;uniform mat4 u_inv_rot_matrix;uniform vec2 u_merc_center;uniform vec3 u_camera_forward;uniform float u_zoom_transition;uniform vec3 u_ecef_origin;uniform mat4 u_tile_matrix;
#endif
varying vec4 v_data0;varying vec4 v_data1;
#pragma mapbox: define highp vec4 fill_color
#pragma mapbox: define highp vec4 halo_color
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp float halo_width
#pragma mapbox: define lowp float halo_blur
void main() {
#pragma mapbox: initialize highp vec4 fill_color
#pragma mapbox: initialize highp vec4 halo_color
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize lowp float halo_width
#pragma mapbox: initialize lowp float halo_blur
vec2 a_pos=a_pos_offset.xy;vec2 a_offset=a_pos_offset.zw;vec2 a_tex=a_tex_size.xy;vec2 a_size=a_tex_size.zw;float a_size_min=floor(a_size[0]*0.5);float is_sdf=a_size[0]-2.0*a_size_min;highp float segment_angle=-a_projected_pos[3];float size;if (!u_is_size_zoom_constant && !u_is_size_feature_constant) {size=mix(a_size_min,a_size[1],u_size_t)/128.0;} else if (u_is_size_zoom_constant && !u_is_size_feature_constant) {size=a_size_min/128.0;} else {size=u_size;}vec2 tile_anchor=a_pos;vec3 h=elevationVector(tile_anchor)*elevation(tile_anchor);float globe_occlusion_fade;vec3 world_pos;vec3 mercator_pos;
#ifdef PROJECTION_GLOBE_VIEW
mercator_pos=mercator_tile_position(u_inv_rot_matrix,tile_anchor,u_tile_id,u_merc_center);world_pos=mix_globe_mercator(a_globe_anchor+h,mercator_pos,u_zoom_transition);vec4 ecef_point=u_tile_matrix*vec4(world_pos,1.0);vec3 origin_to_point=ecef_point.xyz-u_ecef_origin;globe_occlusion_fade=dot(origin_to_point,u_camera_forward) >=0.0 ? 0.0 : 1.0;
#else
world_pos=vec3(tile_anchor,0)+h;globe_occlusion_fade=1.0;
#endif
vec4 projected_point=u_matrix*vec4(world_pos,1);highp float camera_to_anchor_distance=projected_point.w;highp float distance_ratio=u_pitch_with_map ?
camera_to_anchor_distance/u_camera_to_center_distance :
u_camera_to_center_distance/camera_to_anchor_distance;highp float perspective_ratio=clamp(
0.5+0.5*distance_ratio,0.0,1.5);size*=perspective_ratio;float font_scale=size/24.0;highp float symbol_rotation=0.0;if (u_rotate_symbol) {vec4 offset_projected_point=u_matrix*vec4(a_pos+vec2(1,0),0,1);vec2 a=projected_point.xy/projected_point.w;vec2 b=offset_projected_point.xy/offset_projected_point.w;symbol_rotation=atan((b.y-a.y)/u_aspect_ratio,b.x-a.x);}vec4 projected_pos;
#ifdef PROJECTION_GLOBE_VIEW
vec3 proj_pos=mix_globe_mercator(a_projected_pos.xyz+h,mercator_pos,u_zoom_transition);projected_pos=u_label_plane_matrix*vec4(proj_pos,1.0);
#else
projected_pos=u_label_plane_matrix*vec4(a_projected_pos.xy,h.z,1.0);
#endif
highp float angle_sin=sin(segment_angle+symbol_rotation);highp float angle_cos=cos(segment_angle+symbol_rotation);mat2 rotation_matrix=mat2(angle_cos,-1.0*angle_sin,angle_sin,angle_cos);float z=0.0;vec2 offset=rotation_matrix*(a_offset/32.0*font_scale);
#ifdef TERRAIN
#ifdef PITCH_WITH_MAP_TERRAIN
vec4 tile_pos=u_label_plane_matrix_inv*vec4(a_projected_pos.xy+offset,0.0,1.0);z=elevation(tile_pos.xy);
#endif
#endif
float occlusion_fade=occlusionFade(projected_point)*globe_occlusion_fade;
#ifdef PROJECTION_GLOBE_VIEW
vec3 xAxis=u_pitch_with_map ? normalize(cross(a_globe_normal,u_up_vector)) : vec3(1,0,0);vec3 yAxis=u_pitch_with_map ? normalize(cross(a_globe_normal,xAxis)) : vec3(0,1,0);gl_Position=mix(u_coord_matrix*vec4(projected_pos.xyz/projected_pos.w+xAxis*offset.x+yAxis*offset.y,1.0),AWAY,float(projected_point.w <=0.0 || occlusion_fade==0.0));
#else
gl_Position=mix(u_coord_matrix*vec4(projected_pos.xy/projected_pos.w+offset,z,1.0),AWAY,float(projected_point.w <=0.0 || occlusion_fade==0.0));
#endif
float gamma_scale=gl_Position.w;vec2 fade_opacity=unpack_opacity(a_fade_opacity);float fade_change=fade_opacity[1] > 0.5 ? u_fade_change :-u_fade_change;float interpolated_fade_opacity=max(0.0,min(occlusion_fade,fade_opacity[0]+fade_change));float projection_transition_fade=1.0;
#if defined(PROJECTED_POS_ON_VIEWPORT) && defined(PROJECTION_GLOBE_VIEW)
projection_transition_fade=1.0-step(EPSILON,u_zoom_transition);
#endif
v_data0.xy=a_tex/u_texsize;v_data0.zw=a_tex/u_texsize_icon;v_data1=vec4(gamma_scale,size,interpolated_fade_opacity*projection_transition_fade,is_sdf);}`),terrainRaster:Ci(`uniform sampler2D u_image0;varying vec2 v_pos0;
#ifdef FOG
varying float v_fog_opacity;
#endif
#ifdef RENDER_SHADOWS
varying vec4 v_pos_light_view_0;varying vec4 v_pos_light_view_1;varying float v_depth;
#endif
void main() {vec4 color=texture2D(u_image0,v_pos0);
#ifdef RENDER_SHADOWS
color.xyz=shadowed_color(color.xyz,v_pos_light_view_0,v_pos_light_view_1,v_depth);
#endif
#ifdef FOG
#ifdef ZERO_EXAGGERATION
color=fog_dither(fog_apply_premultiplied(color,v_fog_pos));
#else
color=fog_dither(fog_apply_from_vert(color,v_fog_opacity));
#endif
#endif
gl_FragColor=color;
#ifdef TERRAIN_WIREFRAME
gl_FragColor=vec4(1.0,0.0,0.0,0.8);
#endif
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`uniform mat4 u_matrix;uniform float u_skirt_height;attribute vec2 a_pos;varying vec2 v_pos0;
#ifdef FOG
varying float v_fog_opacity;
#endif
#ifdef RENDER_SHADOWS
uniform mat4 u_light_matrix_0;uniform mat4 u_light_matrix_1;varying vec4 v_pos_light_view_0;varying vec4 v_pos_light_view_1;varying float v_depth;
#endif
const float wireframeOffset=0.00015;void main() {vec3 decomposedPosAndSkirt=decomposeToPosAndSkirt(a_pos);float skirt=decomposedPosAndSkirt.z;vec2 decodedPos=decomposedPosAndSkirt.xy;float elevation=elevation(decodedPos)-skirt*u_skirt_height;
#ifdef TERRAIN_WIREFRAME
elevation+=wireframeOffset;
#endif
v_pos0=decodedPos/8192.0;gl_Position=u_matrix*vec4(decodedPos,elevation,1.0);
#ifdef FOG
#ifdef ZERO_EXAGGERATION
v_fog_pos=fog_position(decodedPos);
#else
v_fog_opacity=fog(fog_position(vec3(decodedPos,elevation)));
#endif
#endif
#ifdef RENDER_SHADOWS
vec3 pos=vec3(decodedPos,elevation);v_pos_light_view_0=u_light_matrix_0*vec4(pos,1.);v_pos_light_view_1=u_light_matrix_1*vec4(pos,1.);v_depth=gl_Position.w;
#endif
}`),terrainDepth:Ci(`#ifdef GL_ES
precision highp float;
#endif
varying float v_depth;void main() {gl_FragColor=pack_depth(v_depth);}`,"uniform mat4 u_matrix;attribute vec2 a_pos;varying float v_depth;void main() {float elevation=elevation(a_pos);gl_Position=u_matrix*vec4(a_pos,elevation,1.0);v_depth=gl_Position.z/gl_Position.w;}"),skybox:Ci(`
varying lowp vec3 v_uv;uniform lowp samplerCube u_cubemap;uniform lowp float u_opacity;uniform highp float u_temporal_offset;uniform highp vec3 u_sun_direction;float sun_disk(highp vec3 ray_direction,highp vec3 sun_direction) {highp float cos_angle=dot(normalize(ray_direction),sun_direction);const highp float cos_sun_angular_diameter=0.99996192306;const highp float smoothstep_delta=1e-5;return smoothstep(
cos_sun_angular_diameter-smoothstep_delta,cos_sun_angular_diameter+smoothstep_delta,cos_angle);}float map(float value,float start,float end,float new_start,float new_end) {return ((value-start)*(new_end-new_start))/(end-start)+new_start;}void main() {vec3 uv=v_uv;const float y_bias=0.015;uv.y+=y_bias;uv.y=pow(abs(uv.y),1.0/5.0);uv.y=map(uv.y,0.0,1.0,-1.0,1.0);vec3 sky_color=textureCube(u_cubemap,uv).rgb;
#ifdef FOG
sky_color=fog_apply_sky_gradient(v_uv.xzy,sky_color);
#endif
sky_color.rgb=dither(sky_color.rgb,gl_FragCoord.xy+u_temporal_offset);sky_color+=0.1*sun_disk(v_uv,u_sun_direction);gl_FragColor=vec4(sky_color*u_opacity,u_opacity);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,Za),skyboxGradient:Ci(`varying highp vec3 v_uv;uniform lowp sampler2D u_color_ramp;uniform highp vec3 u_center_direction;uniform lowp float u_radius;uniform lowp float u_opacity;uniform highp float u_temporal_offset;void main() {float progress=acos(dot(normalize(v_uv),u_center_direction))/u_radius;vec4 color=texture2D(u_color_ramp,vec2(progress,0.5));
#ifdef FOG
color.rgb=fog_apply_sky_gradient(v_uv.xzy,color.rgb/color.a)*color.a;
#endif
color*=u_opacity;color.rgb=dither(color.rgb,gl_FragCoord.xy+u_temporal_offset);gl_FragColor=color;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,Za),skyboxCapture:Ci(`
varying highp vec3 v_position;uniform highp float u_sun_intensity;uniform highp float u_luminance;uniform lowp vec3 u_sun_direction;uniform highp vec4 u_color_tint_r;uniform highp vec4 u_color_tint_m;
#ifdef GL_ES
precision highp float;
#endif
#define BETA_R                  vec3(5.5e-6,13.0e-6,22.4e-6)
#define BETA_M                  vec3(21e-6,21e-6,21e-6)
#define MIE_G                   0.76
#define DENSITY_HEIGHT_SCALE_R  8000.0
#define DENSITY_HEIGHT_SCALE_M  1200.0
#define PLANET_RADIUS           6360e3
#define ATMOSPHERE_RADIUS       6420e3
#define SAMPLE_STEPS            10
#define DENSITY_STEPS           4
float ray_sphere_exit(vec3 orig,vec3 dir,float radius) {float a=dot(dir,dir);float b=2.0*dot(dir,orig);float c=dot(orig,orig)-radius*radius;float d=sqrt(b*b-4.0*a*c);return (-b+d)/(2.0*a);}vec3 extinction(vec2 density) {return exp(-vec3(BETA_R*u_color_tint_r.a*density.x+BETA_M*u_color_tint_m.a*density.y));}vec2 local_density(vec3 point) {float height=max(length(point)-PLANET_RADIUS,0.0);float exp_r=exp(-height/DENSITY_HEIGHT_SCALE_R);float exp_m=exp(-height/DENSITY_HEIGHT_SCALE_M);return vec2(exp_r,exp_m);}float phase_ray(float cos_angle) {return (3.0/(16.0*PI))*(1.0+cos_angle*cos_angle);}float phase_mie(float cos_angle) {return (3.0/(8.0*PI))*((1.0-MIE_G*MIE_G)*(1.0+cos_angle*cos_angle))/((2.0+MIE_G*MIE_G)*pow(1.0+MIE_G*MIE_G-2.0*MIE_G*cos_angle,1.5));}vec2 density_to_atmosphere(vec3 point,vec3 light_dir) {float ray_len=ray_sphere_exit(point,light_dir,ATMOSPHERE_RADIUS);float step_len=ray_len/float(DENSITY_STEPS);vec2 density_point_to_atmosphere=vec2(0.0);for (int i=0; i < DENSITY_STEPS;++i) {vec3 point_on_ray=point+light_dir*((float(i)+0.5)*step_len);density_point_to_atmosphere+=local_density(point_on_ray)*step_len;;}return density_point_to_atmosphere;}vec3 atmosphere(vec3 ray_dir,vec3 sun_direction,float sun_intensity) {vec2 density_orig_to_point=vec2(0.0);vec3 scatter_r=vec3(0.0);vec3 scatter_m=vec3(0.0);vec3 origin=vec3(0.0,PLANET_RADIUS,0.0);float ray_len=ray_sphere_exit(origin,ray_dir,ATMOSPHERE_RADIUS);float step_len=ray_len/float(SAMPLE_STEPS);for (int i=0; i < SAMPLE_STEPS;++i) {vec3 point_on_ray=origin+ray_dir*((float(i)+0.5)*step_len);vec2 density=local_density(point_on_ray)*step_len;density_orig_to_point+=density;vec2 density_point_to_atmosphere=density_to_atmosphere(point_on_ray,sun_direction);vec2 density_orig_to_atmosphere=density_orig_to_point+density_point_to_atmosphere;vec3 extinction=extinction(density_orig_to_atmosphere);scatter_r+=density.x*extinction;scatter_m+=density.y*extinction;}float cos_angle=dot(ray_dir,sun_direction);float phase_r=phase_ray(cos_angle);float phase_m=phase_mie(cos_angle);vec3 beta_r=BETA_R*u_color_tint_r.rgb*u_color_tint_r.a;vec3 beta_m=BETA_M*u_color_tint_m.rgb*u_color_tint_m.a;return (scatter_r*phase_r*beta_r+scatter_m*phase_m*beta_m)*sun_intensity;}const float A=0.15;const float B=0.50;const float C=0.10;const float D=0.20;const float E=0.02;const float F=0.30;vec3 uncharted2_tonemap(vec3 x) {return ((x*(A*x+C*B)+D*E)/(x*(A*x+B)+D*F))-E/F;}void main() {vec3 ray_direction=v_position;ray_direction.y=pow(ray_direction.y,5.0);const float y_bias=0.015;ray_direction.y+=y_bias;vec3 color=atmosphere(normalize(ray_direction),u_sun_direction,u_sun_intensity);float white_scale=1.0748724675633854;color=uncharted2_tonemap((log2(2.0/pow(u_luminance,4.0)))*color)*white_scale;gl_FragColor=vec4(color,1.0);}`,"attribute highp vec3 a_pos_3f;uniform mat3 u_matrix_3f;varying highp vec3 v_position;float map(float value,float start,float end,float new_start,float new_end) {return ((value-start)*(new_end-new_start))/(end-start)+new_start;}void main() {vec4 pos=vec4(u_matrix_3f*a_pos_3f,1.0);v_position=pos.xyz;v_position.y*=-1.0;v_position.y=map(v_position.y,-1.0,1.0,0.0,1.0);gl_Position=vec4(a_pos_3f.xy,0.0,1.0);}"),globeRaster:Ci(`uniform sampler2D u_image0;varying vec2 v_pos0;
#ifndef FOG
uniform highp vec3 u_frustum_tl;uniform highp vec3 u_frustum_tr;uniform highp vec3 u_frustum_br;uniform highp vec3 u_frustum_bl;uniform highp vec3 u_globe_pos;uniform highp float u_globe_radius;uniform vec2 u_viewport;
#endif
void main() {vec4 color;
#ifdef CUSTOM_ANTIALIASING
vec2 uv=gl_FragCoord.xy/u_viewport;highp vec3 ray_dir=mix(
mix(u_frustum_tl,u_frustum_tr,uv.x),mix(u_frustum_bl,u_frustum_br,uv.x),1.0-uv.y);vec3 dir=normalize(ray_dir);vec3 closest_point=dot(u_globe_pos,dir)*dir;float norm_dist_from_center=1.0-length(closest_point-u_globe_pos)/u_globe_radius;const float antialias_pixel=2.0;float antialias_factor=antialias_pixel*fwidth(norm_dist_from_center);float antialias=smoothstep(0.0,antialias_factor,norm_dist_from_center);vec4 raster=texture2D(u_image0,v_pos0);color=vec4(raster.rgb*antialias,raster.a*antialias);
#else
color=texture2D(u_image0,v_pos0);
#endif
#ifdef FOG
color=fog_dither(fog_apply_premultiplied(color,v_fog_pos));
#endif
gl_FragColor=color;
#ifdef TERRAIN_WIREFRAME
gl_FragColor=vec4(1.0,0.0,0.0,0.8);
#endif
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`uniform mat4 u_proj_matrix;uniform mat4 u_normalize_matrix;uniform mat4 u_globe_matrix;uniform mat4 u_merc_matrix;uniform float u_zoom_transition;uniform vec2 u_merc_center;uniform mat3 u_grid_matrix;uniform float u_skirt_height;
#ifdef GLOBE_POLES
attribute vec3 a_globe_pos;attribute vec2 a_uv;
#else
attribute vec2 a_pos;
#endif
varying vec2 v_pos0;const float wireframeOffset=1e3;float mercatorXfromLng(float lng) {return (180.0+lng)/360.0;}float mercatorYfromLat(float lat) {return (180.0-(RAD_TO_DEG*log(tan(QUARTER_PI+lat/2.0*DEG_TO_RAD))))/360.0;}vec3 latLngToECEF(vec2 latLng) {latLng=DEG_TO_RAD*latLng;float cosLat=cos(latLng[0]);float sinLat=sin(latLng[0]);float cosLng=cos(latLng[1]);float sinLng=sin(latLng[1]);float sx=cosLat*sinLng*GLOBE_RADIUS;float sy=-sinLat*GLOBE_RADIUS;float sz=cosLat*cosLng*GLOBE_RADIUS;return vec3(sx,sy,sz);}void main() {
#ifdef GLOBE_POLES
vec3 globe_pos=a_globe_pos;vec2 uv=a_uv;
#else
float tiles=u_grid_matrix[0][2];float idx=u_grid_matrix[1][2];float idy=u_grid_matrix[2][2];vec3 decomposed_pos_and_skirt=decomposeToPosAndSkirt(a_pos);vec3 latLng=u_grid_matrix*vec3(decomposed_pos_and_skirt.xy,1.0);float mercatorY=mercatorYfromLat(latLng[0]);float uvY=mercatorY*tiles-idy;float mercatorX=mercatorXfromLng(latLng[1]);float uvX=mercatorX*tiles-idx;vec3 globe_pos=latLngToECEF(latLng.xy);vec2 merc_pos=vec2(mercatorX,mercatorY);vec2 uv=vec2(uvX,uvY);
#endif
v_pos0=uv;vec2 tile_pos=uv*EXTENT;vec3 globe_derived_up_vector=normalize(globe_pos)*u_tile_up_scale;
#ifdef GLOBE_POLES
vec3 up_vector=globe_derived_up_vector;
#else
vec3 up_vector=elevationVector(tile_pos);
#endif
float height=elevation(tile_pos);
#ifdef TERRAIN_WIREFRAME
height+=wireframeOffset;
#endif
globe_pos+=up_vector*height;
#ifndef GLOBE_POLES
globe_pos-=globe_derived_up_vector*u_skirt_height*decomposed_pos_and_skirt.z;
#endif
#ifdef GLOBE_POLES
vec4 interpolated_pos=u_globe_matrix*vec4(globe_pos,1.0);
#else
vec4 globe_world_pos=u_globe_matrix*vec4(globe_pos,1.0);vec4 merc_world_pos=vec4(0.0);if (u_zoom_transition > 0.0) {merc_world_pos=vec4(merc_pos,height-u_skirt_height*decomposed_pos_and_skirt.z,1.0);merc_world_pos.xy-=u_merc_center;merc_world_pos.x=wrap(merc_world_pos.x,-0.5,0.5);merc_world_pos=u_merc_matrix*merc_world_pos;}vec4 interpolated_pos=vec4(mix(globe_world_pos.xyz,merc_world_pos.xyz,u_zoom_transition),1.0);
#endif
gl_Position=u_proj_matrix*interpolated_pos;
#ifdef FOG
v_fog_pos=fog_position((u_normalize_matrix*vec4(globe_pos,1.0)).xyz);
#endif
}`),globeAtmosphere:Ci(`uniform float u_transition;uniform highp float u_fadeout_range;uniform highp float u_temporal_offset;uniform vec3 u_start_color;uniform vec4 u_color;uniform vec4 u_space_color;uniform vec4 u_high_color;uniform float u_star_intensity;uniform float u_star_size;uniform float u_star_density;uniform float u_horizon_angle;uniform mat4 u_rotation_matrix;varying highp vec3 v_ray_dir;varying highp vec3 v_horizon_dir;highp float random(highp vec3 p) {p=fract(p*vec3(23.2342,97.1231,91.2342));p+=dot(p.zxy,p.yxz+123.1234);return fract(p.x*p.y);}float stars(vec3 p,float scale,vec2 offset) {vec2 uv_scale=(u_viewport/u_star_size)*scale;vec3 position=vec3(p.xy*uv_scale+offset*u_viewport,p.z);vec3 q=fract(position)-0.5;vec3 id=floor(position);float random_visibility=step(random(id),u_star_density);float circle=smoothstep(0.5+u_star_intensity,0.5,length(q));return circle*random_visibility;}void main() {highp vec3 dir=normalize(v_ray_dir);float globe_pos_dot_dir;
#ifdef PROJECTION_GLOBE_VIEW
globe_pos_dot_dir=dot(u_globe_pos,dir);highp vec3 closest_point_forward=abs(globe_pos_dot_dir)*dir;float norm_dist_from_center=length(closest_point_forward-u_globe_pos)/u_globe_radius;if (norm_dist_from_center < 0.98) {discard;return;}
#endif
highp vec3 horizon_dir=normalize(v_horizon_dir);float horizon_angle_mercator=dir.y < horizon_dir.y ?
0.0 : max(acos(dot(dir,horizon_dir)),0.0);float horizon_angle;
#ifdef PROJECTION_GLOBE_VIEW
highp vec3 closest_point=globe_pos_dot_dir*dir;float closest_point_to_center=length(closest_point-u_globe_pos);float theta=asin(clamp(closest_point_to_center/length(u_globe_pos),-1.0,1.0));horizon_angle=globe_pos_dot_dir < 0.0 ?
PI-theta-u_horizon_angle : theta-u_horizon_angle;float angle_t=pow(u_transition,10.0);horizon_angle=mix(horizon_angle,horizon_angle_mercator,angle_t);
#else
horizon_angle=horizon_angle_mercator;
#endif
horizon_angle/=PI;float t=exp(-horizon_angle/u_fadeout_range);float alpha_0=u_color.a;float alpha_1=u_high_color.a;float alpha_2=u_space_color.a;vec3 color_stop_0=u_color.rgb;vec3 color_stop_1=u_high_color.rgb;vec3 color_stop_2=u_space_color.rgb;vec3 c0=mix(color_stop_2,color_stop_1,alpha_1);vec3 c1=mix(c0,color_stop_0,alpha_0);vec3 c2=mix(c0,c1,t);vec3 c =mix(color_stop_2,c2,t);float a0=mix(alpha_2,1.0,alpha_1);float a1=mix(a0,1.0,alpha_0);float a2=mix(a0,a1,t);float a =mix(alpha_2,a2,t);vec2 uv=gl_FragCoord.xy/u_viewport-0.5;float aspect_ratio=u_viewport.x/u_viewport.y;vec4 uv_dir=vec4(normalize(vec3(uv.x*aspect_ratio,uv.y,1.0)),1.0);uv_dir=u_rotation_matrix*uv_dir;vec3 n=abs(uv_dir.xyz);vec2 uv_remap=(n.x > n.y && n.x > n.z) ? uv_dir.yz/uv_dir.x:
(n.y > n.x && n.y > n.z) ? uv_dir.zx/uv_dir.y:
uv_dir.xy/uv_dir.z;uv_remap.x/=aspect_ratio;vec3 D=vec3(uv_remap,1.0);highp float star_field=0.0;if (u_star_intensity > 0.0) {star_field+=stars(D,1.2,vec2(0.0,0.0));star_field+=stars(D,1.0,vec2(1.0,0.0));star_field+=stars(D,0.8,vec2(0.0,1.0));star_field+=stars(D,0.6,vec2(1.0,1.0));star_field*=(1.0-pow(t,0.25+(1.0-u_high_color.a)*0.75));c+=star_field*alpha_2;}c=dither(c,gl_FragCoord.xy+u_temporal_offset);gl_FragColor=vec4(c,a);}`,`attribute vec3 a_pos;attribute vec2 a_uv;uniform vec3 u_frustum_tl;uniform vec3 u_frustum_tr;uniform vec3 u_frustum_br;uniform vec3 u_frustum_bl;uniform float u_horizon;varying highp vec3 v_ray_dir;varying highp vec3 v_horizon_dir;void main() {v_ray_dir=mix(
mix(u_frustum_tl,u_frustum_tr,a_uv.x),mix(u_frustum_bl,u_frustum_br,a_uv.x),a_uv.y);v_horizon_dir=mix(
mix(u_frustum_tl,u_frustum_bl,u_horizon),mix(u_frustum_tr,u_frustum_br,u_horizon),a_uv.x);gl_Position=vec4(a_pos,1.0);}`)};function po(J,G){const Z=J.replace(/\s*\/\/[^\n]*\n/g,`
`).split(`
`);for(let re of Z)if(re=re.trim(),re[0]==="#"&&re.includes("if")&&!re.includes("endif")){re=re.replace("#","").replace(/ifdef|ifndef|elif|if/g,"").replace(/!|defined|\(|\)|\|\||&&/g,"").replace(/\s+/g," ").trim();const le=re.split(" ");for(const de of le)G.includes(de)||G.push(de)}}function Ci(J,G){const Z=/#pragma mapbox: ([\w]+) ([\w]+) ([\w]+) ([\w]+)/g,re=G.match(/attribute (highp |mediump |lowp )?([\w]+) ([\w]+)/g),le={},de=[...Ho];return po(J,de),po(G,de),{fragmentSource:J=J.replace(Z,(me,ye,be,qe,Te)=>(le[Te]=!0,ye==="define"?`
#ifndef HAS_UNIFORM_u_${Te}
varying ${be} ${qe} ${Te};
#else
uniform ${be} ${qe} u_${Te};
#endif
`:`
#ifdef HAS_UNIFORM_u_${Te}
    ${be} ${qe} ${Te} = u_${Te};
#endif
`)),vertexSource:G=G.replace(Z,(me,ye,be,qe,Te)=>{const Fe=qe==="float"?"vec2":"vec4",$e=Te.match(/color/)?"color":Fe;return le[Te]?ye==="define"?`
#ifndef HAS_UNIFORM_u_${Te}
uniform lowp float u_${Te}_t;
attribute ${be} ${Fe} a_${Te};
varying ${be} ${qe} ${Te};
#else
uniform ${be} ${qe} u_${Te};
#endif
`:$e==="vec4"?`
#ifndef HAS_UNIFORM_u_${Te}
    ${Te} = a_${Te};
#else
    ${be} ${qe} ${Te} = u_${Te};
#endif
`:`
#ifndef HAS_UNIFORM_u_${Te}
    ${Te} = unpack_mix_${$e}(a_${Te}, u_${Te}_t);
#else
    ${be} ${qe} ${Te} = u_${Te};
#endif
`:ye==="define"?`
#ifndef HAS_UNIFORM_u_${Te}
uniform lowp float u_${Te}_t;
attribute ${be} ${Fe} a_${Te};
#else
uniform ${be} ${qe} u_${Te};
#endif
`:$e==="vec4"?`
#ifndef HAS_UNIFORM_u_${Te}
    ${be} ${qe} ${Te} = a_${Te};
#else
    ${be} ${qe} ${Te} = u_${Te};
#endif
`:`
#ifndef HAS_UNIFORM_u_${Te}
    ${be} ${qe} ${Te} = unpack_mix_${$e}(a_${Te}, u_${Te}_t);
#else
    ${be} ${qe} ${Te} = u_${Te};
#endif
`}),staticAttributes:re,usedDefines:de}}class vh{constructor(){this.boundProgram=null,this.boundLayoutVertexBuffer=null,this.boundPaintVertexBuffers=[],this.boundIndexBuffer=null,this.boundVertexOffset=null,this.boundDynamicVertexBuffers=[],this.vao=null}bind(G,Z,re,le,de,me,ye){this.context=G;let be=this.boundPaintVertexBuffers.length!==le.length;for(let Te=0;!be&&Te<le.length;Te++)this.boundPaintVertexBuffers[Te]!==le[Te]&&(be=!0);let qe=this.boundDynamicVertexBuffers.length!==ye.length;for(let Te=0;!qe&&Te<ye.length;Te++)this.boundDynamicVertexBuffers[Te]!==ye[Te]&&(qe=!0);if(!G.extVertexArrayObject||!this.vao||this.boundProgram!==Z||this.boundLayoutVertexBuffer!==re||be||qe||this.boundIndexBuffer!==de||this.boundVertexOffset!==me)this.freshBind(Z,re,le,de,me,ye);else{G.bindVertexArrayOES.set(this.vao);for(const Te of ye)Te&&Te.bind();de&&de.dynamicDraw&&de.bind()}}freshBind(G,Z,re,le,de,me){let ye;const be=G.numAttributes,qe=this.context,Te=qe.gl;if(qe.extVertexArrayObject)this.vao&&this.destroy(),this.vao=qe.extVertexArrayObject.createVertexArrayOES(),qe.bindVertexArrayOES.set(this.vao),ye=0,this.boundProgram=G,this.boundLayoutVertexBuffer=Z,this.boundPaintVertexBuffers=re,this.boundIndexBuffer=le,this.boundVertexOffset=de,this.boundDynamicVertexBuffers=me;else{ye=qe.currentNumAttributes||0;for(let Fe=be;Fe<ye;Fe++)Te.disableVertexAttribArray(Fe)}Z.enableAttributes(Te,G),Z.bind(),Z.setVertexAttribPointers(Te,G,de);for(const Fe of re)Fe.enableAttributes(Te,G),Fe.bind(),Fe.setVertexAttribPointers(Te,G,de);for(const Fe of me)Fe&&(Fe.enableAttributes(Te,G),Fe.bind(),Fe.setVertexAttribPointers(Te,G,de));le&&le.bind(),qe.currentNumAttributes=be}destroy(){this.vao&&(this.context.extVertexArrayObject.deleteVertexArrayOES(this.vao),this.vao=null)}}function Pu(J,G){const Z=Math.pow(2,G.canonical.z),re=G.canonical.y;return[new t.MercatorCoordinate(0,re/Z).toLngLat().lat,new t.MercatorCoordinate(0,(re+1)/Z).toLngLat().lat]}function ec(J,G,Z,re,le,de,me){const ye=J.context,be=ye.gl,qe=Z.fbo;if(!qe)return;J.prepareDrawTile();const Te=J.useProgram("hillshade");ye.activeTexture.set(be.TEXTURE0),be.bindTexture(be.TEXTURE_2D,qe.colorAttachment.get());const Fe=((Qe,it,Be,Ye)=>{const lt=Be.paint.get("hillshade-shadow-color"),ct=Be.paint.get("hillshade-highlight-color"),Tt=Be.paint.get("hillshade-accent-color");let Rt=Be.paint.get("hillshade-illumination-direction")*(Math.PI/180);Be.paint.get("hillshade-illumination-anchor")==="viewport"&&(Rt-=Qe.transform.angle);const It=!Qe.options.moving;return{u_matrix:Ye||Qe.transform.calculateProjMatrix(it.tileID.toUnwrapped(),It),u_image:0,u_latrange:Pu(0,it.tileID),u_light:[Be.paint.get("hillshade-exaggeration"),Rt],u_shadow:lt,u_highlight:ct,u_accent:Tt}})(J,Z,re,J.terrain?G.projMatrix:null);J.prepareDrawProgram(ye,Te,G.toUnwrapped());const{tileBoundsBuffer:$e,tileBoundsIndexBuffer:Je,tileBoundsSegments:tt}=J.getTileBoundsBuffers(Z);Te.draw(ye,be.TRIANGLES,le,de,me,t.CullFaceMode.disabled,Fe,re.id,$e,Je,tt)}function Mu(J,G,Z){if(!G.needsDEMTextureUpload)return;const re=J.context,le=re.gl;re.pixelStoreUnpackPremultiplyAlpha.set(!1),G.demTexture=G.demTexture||J.getTileTexture(Z.stride);const de=Z.getPixels();G.demTexture?G.demTexture.update(de,{premultiply:!1}):G.demTexture=new t.Texture(re,de,le.RGBA,{premultiply:!1}),G.needsDEMTextureUpload=!1}function tc(J,G,Z,re,le,de){const me=J.context,ye=me.gl;if(!G.dem)return;const be=G.dem;if(me.activeTexture.set(ye.TEXTURE1),Mu(J,G,be),!G.demTexture)return;G.demTexture.bind(ye.NEAREST,ye.CLAMP_TO_EDGE);const qe=be.dim;me.activeTexture.set(ye.TEXTURE0);let Te=G.fbo;if(!Te){const tt=new t.Texture(me,{width:qe,height:qe,data:null},ye.RGBA);tt.bind(ye.LINEAR,ye.CLAMP_TO_EDGE),Te=G.fbo=me.createFramebuffer(qe,qe,!0),Te.colorAttachment.set(tt.texture)}me.bindFramebuffer.set(Te.framebuffer),me.viewport.set([0,0,qe,qe]);const{tileBoundsBuffer:Fe,tileBoundsIndexBuffer:$e,tileBoundsSegments:Je}=J.getMercatorTileBoundsBuffers();J.useProgram("hillshadePrepare").draw(me,ye.TRIANGLES,re,le,de,t.CullFaceMode.disabled,((tt,Qe)=>{const it=Qe.stride,Be=t.create();return t.ortho(Be,0,t.EXTENT,-t.EXTENT,0,0,1),t.translate(Be,Be,[0,-t.EXTENT,0]),{u_matrix:Be,u_image:1,u_dimension:[it,it],u_zoom:tt.overscaledZ,u_unpack:Qe.unpackVector}})(G.tileID,be),Z.id,Fe,$e,Je),G.needsHillshadePrepare=!1}const Du=J=>({u_matrix:new t.UniformMatrix4f(J),u_image0:new t.Uniform1i(J),u_skirt_height:new t.Uniform1f(J)}),_o=(J,G)=>({u_matrix:J,u_image0:0,u_skirt_height:G}),Rs=(J,G,Z,re,le,de,me,ye,be,qe,Te,Fe,$e,Je,tt)=>({u_proj_matrix:Float32Array.from(J),u_globe_matrix:G,u_normalize_matrix:Float32Array.from(re),u_merc_matrix:Z,u_zoom_transition:le,u_merc_center:de,u_image0:0,u_frustum_tl:me,u_frustum_tr:ye,u_frustum_br:be,u_frustum_bl:qe,u_globe_pos:Te,u_globe_radius:Fe,u_viewport:$e,u_grid_matrix:tt?Float32Array.from(tt):new Float32Array(9),u_skirt_height:Je});function mo(J,G){return J!=null&&G!=null&&!(!J.hasData()||!G.hasData())&&J.demTexture!=null&&G.demTexture!=null&&J.tileID.key!==G.tileID.key}const xa=new class{constructor(){this.operations={}}newMorphing(J,G,Z,re,le){if(J in this.operations){const de=this.operations[J];de.to.tileID.key!==Z.tileID.key&&(de.queued=Z)}else this.operations[J]={startTime:re,phase:0,duration:le,from:G,to:Z,queued:null}}getMorphValuesForProxy(J){if(!(J in this.operations))return null;const G=this.operations[J];return{from:G.from,to:G.to,phase:G.phase}}update(J){for(const G in this.operations){const Z=this.operations[G];for(Z.phase=(J-Z.startTime)/Z.duration;Z.phase>=1||!this._validOp(Z);)if(!this._nextOp(Z,J)){delete this.operations[G];break}}}_nextOp(J,G){return!!J.queued&&(J.from=J.to,J.to=J.queued,J.queued=null,J.phase=0,J.startTime=G,!0)}_validOp(J){return J.from.hasData()&&J.to.hasData()}},Ka={0:null,1:"TERRAIN_VERTEX_MORPHING",2:"TERRAIN_WIREFRAME"};function Os(J){return 6*Math.pow(1.5,22-J)}function rc(J,G){const Z=1<<J.z;return!G&&(J.x===0||J.x===Z-1)||J.y===0||J.y===Z-1}const Zo=J=>({u_matrix:J});function Lu(J,G,Z,re,le){if(le>0){const de=t.exported.now(),me=(de-J.timeAdded)/le,ye=G?(de-G.timeAdded)/le:-1,be=Z.getSource(),qe=re.coveringZoomLevel({tileSize:be.tileSize,roundZoom:be.roundZoom}),Te=!G||Math.abs(G.tileID.overscaledZ-qe)>Math.abs(J.tileID.overscaledZ-qe),Fe=Te&&J.refreshedUponExpiration?1:t.clamp(Te?me:1-ye,0,1);return J.refreshedUponExpiration&&me>=1&&(J.refreshedUponExpiration=!1),G?{opacity:1,mix:1-Fe}:{opacity:Fe,mix:0}}return{opacity:1,mix:0}}class Fu extends t.SourceCache{constructor(G){const Z={type:"raster-dem",maxzoom:G.transform.maxZoom},re=new wt(Xt(),null),le=oi("mock-dem",Z,re,G.style);super("mock-dem",le,!1),le.setEventedParent(this),this._sourceLoaded=!0}_loadTile(G,Z){G.state="loaded",Z(null)}}class Cs extends t.SourceCache{constructor(G){const Z=oi("proxy",{type:"geojson",maxzoom:G.transform.maxZoom},new wt(Xt(),null),G.style);super("proxy",Z,!1),Z.setEventedParent(this),this.map=this.getSource().map=G,this.used=this._sourceLoaded=!0,this.renderCache=[],this.renderCachePool=[],this.proxyCachedFBO={}}update(G,Z,re){if(G.freezeTileCoverage)return;this.transform=G;const le=G.coveringTiles({tileSize:this._source.tileSize,minzoom:this._source.minzoom,maxzoom:this._source.maxzoom,roundZoom:this._source.roundZoom,reparseOverscaled:this._source.reparseOverscaled}).reduce((de,me)=>{if(de[me.key]="",!this._tiles[me.key]){const ye=new t.Tile(me,this._source.tileSize*me.overscaleFactor(),G.tileZoom);ye.state="loaded",this._tiles[me.key]=ye}return de},{});for(const de in this._tiles)de in le||(this.freeFBO(de),this._tiles[de].unloadVectorData(),delete this._tiles[de])}freeFBO(G){const Z=this.proxyCachedFBO[G];if(Z!==void 0){const re=Object.values(Z);this.renderCachePool.push(...re),delete this.proxyCachedFBO[G]}}deallocRenderCache(){this.renderCache.forEach(G=>G.fb.destroy()),this.renderCache=[],this.renderCachePool=[],this.proxyCachedFBO={}}}class Ps extends t.OverscaledTileID{constructor(G,Z,re){super(G.overscaledZ,G.wrap,G.canonical.z,G.canonical.x,G.canonical.y),this.proxyTileKey=Z,this.projMatrix=re}}class ku extends t.Elevation{constructor(G,Z){super(),this.painter=G,this.terrainTileForTile={},this.prevTerrainTileForTile={};const[re,le,de]=function(be){const qe=new t.StructArrayLayout2i4,Te=new t.StructArrayLayout3ui6,Fe=131;qe.reserve(17161),Te.reserve(33800);const $e=t.EXTENT/128,Je=t.EXTENT+$e/2,tt=Je+$e;for(let it=-$e;it<tt;it+=$e)for(let Be=-$e;Be<tt;Be+=$e){const Ye=Be<0||Be>Je||it<0||it>Je?24575:0,lt=t.clamp(Math.round(Be),0,t.EXTENT),ct=t.clamp(Math.round(it),0,t.EXTENT);qe.emplaceBack(lt+Ye,ct)}const Qe=(it,Be)=>{const Ye=Be*Fe+it;Te.emplaceBack(Ye+1,Ye,Ye+Fe),Te.emplaceBack(Ye+Fe,Ye+Fe+1,Ye+1)};for(let it=1;it<129;it++)for(let Be=1;Be<129;Be++)Qe(Be,it);return[0,129].forEach(it=>{for(let Be=0;Be<130;Be++)Qe(Be,it),Qe(it,Be)}),[qe,Te,32768]}(),me=G.context;this.gridBuffer=me.createVertexBuffer(re,t.posAttributes.members),this.gridIndexBuffer=me.createIndexBuffer(le),this.gridSegments=t.SegmentVector.simpleSegment(0,0,re.length,le.length),this.gridNoSkirtSegments=t.SegmentVector.simpleSegment(0,0,re.length,de),this.proxyCoords=[],this.proxiedCoords={},this._visibleDemTiles=[],this._drapedRenderBatches=[],this._sourceTilesOverlap={},this.proxySourceCache=new Cs(Z.map),this.orthoMatrix=t.create(),t.ortho(this.orthoMatrix,this.painter.transform.projection.name==="globe"?.015:0,t.EXTENT,0,t.EXTENT,0,1);const ye=me.gl;this._overlapStencilMode=new t.StencilMode({func:ye.GEQUAL,mask:255},0,255,ye.KEEP,ye.KEEP,ye.REPLACE),this._previousZoom=G.transform.zoom,this.pool=[],this._findCoveringTileCache={},this._tilesDirty={},this.style=Z,this._useVertexMorphing=!0,this._exaggeration=1,this._mockSourceCache=new Fu(Z.map)}set style(G){G.on("data",this._onStyleDataEvent.bind(this)),G.on("neworder",this._checkRenderCacheEfficiency.bind(this)),this._style=G,this._checkRenderCacheEfficiency(),this._style.map.on("moveend",()=>{this._clearLineLayersFromRenderCache()})}update(G,Z,re){if(G&&G.terrain){this._style!==G&&(this.style=G),this.enabled=!0;const le=G.terrain.properties;this.sourceCache=G.terrain.drapeRenderMode===0?this._mockSourceCache:G._getSourceCache(le.get("source")),this._exaggeration=le.get("exaggeration");const de=()=>{this.sourceCache.used&&t.warnOnce(`Raster DEM source '${this.sourceCache.id}' is used both for terrain and as layer source.
This leads to lower resolution of hillshade. For full hillshade resolution but higher memory consumption, define another raster DEM source.`);const me=this.getScaledDemTileSize();this.sourceCache.update(Z,me,!0),this.resetTileLookupCache(this.sourceCache.id)};this.sourceCache.usedForTerrain||(this.resetTileLookupCache(this.sourceCache.id),this.sourceCache.usedForTerrain=!0,de(),this._initializing=!0),de(),Z.updateElevation(!0,re),this.resetTileLookupCache(this.proxySourceCache.id),this.proxySourceCache.update(Z),this._emptyDEMTextureDirty=!0}else this._disable()}resetTileLookupCache(G){this._findCoveringTileCache[G]={}}getScaledDemTileSize(){return this.sourceCache.getSource().tileSize/128*this.proxySourceCache.getSource().tileSize}_checkRenderCacheEfficiency(){const G=this.renderCacheEfficiency(this._style);this._style.map._optimizeForTerrain||G.efficiency!==100&&t.warnOnce(`Terrain render cache efficiency is not optimal (${G.efficiency}%) and performance
                may be affected negatively, consider placing all background, fill and line layers before layer
                with id '${G.firstUndrapedLayer}' or create a map using optimizeForTerrain: true option.`)}_onStyleDataEvent(G){G.coord&&G.dataType==="source"?this._clearRenderCacheForTile(G.sourceCacheId,G.coord):G.dataType==="style"&&(this._invalidateRenderCache=!0)}_disable(){if(this.enabled&&(this.enabled=!1,this._sharedDepthStencil=void 0,this.proxySourceCache.deallocRenderCache(),this._style))for(const G in this._style._sourceCaches)this._style._sourceCaches[G].usedForTerrain=!1}destroy(){this._disable(),this._emptyDEMTexture&&this._emptyDEMTexture.destroy(),this._emptyDepthBufferTexture&&this._emptyDepthBufferTexture.destroy(),this.pool.forEach(G=>G.fb.destroy()),this.pool=[],this._depthFBO&&(this._depthFBO.destroy(),this._depthFBO=void 0,this._depthTexture=void 0)}_source(){return this.enabled?this.sourceCache:null}isUsingMockSource(){return this.sourceCache===this._mockSourceCache}exaggeration(){return this._exaggeration}get visibleDemTiles(){return this._visibleDemTiles}get drapeBufferSize(){const G=2*this.proxySourceCache.getSource().tileSize;return[G,G]}set useVertexMorphing(G){this._useVertexMorphing=G}updateTileBinding(G){if(!this.enabled)return;this.prevTerrainTileForTile=this.terrainTileForTile;const Z=this.proxySourceCache,re=this.painter.transform;this._initializing&&(this._initializing=re._centerAltitude===0&&this.getAtPointOrZero(t.MercatorCoordinate.fromLngLat(re.center),-1)===-1,this._emptyDEMTextureDirty=!this._initializing);const le=this.proxyCoords=Z.getIds().map(be=>{const qe=Z.getTileByID(be).tileID;return qe.projMatrix=re.calculateProjMatrix(qe.toUnwrapped()),qe});(function(be,qe){const Te=qe.transform.pointCoordinate(qe.transform.getCameraPoint()),Fe=new t.Point(Te.x,Te.y);be.sort(($e,Je)=>{if(Je.overscaledZ-$e.overscaledZ)return Je.overscaledZ-$e.overscaledZ;const tt=new t.Point($e.canonical.x+(1<<$e.canonical.z)*$e.wrap,$e.canonical.y),Qe=new t.Point(Je.canonical.x+(1<<Je.canonical.z)*Je.wrap,Je.canonical.y),it=Fe.mult(1<<$e.canonical.z);return it.x-=.5,it.y-=.5,it.distSqr(tt)-it.distSqr(Qe)})})(le,this.painter),this._previousZoom=re.zoom;const de=this.proxyToSource||{};this.proxyToSource={},le.forEach(be=>{this.proxyToSource[be.key]={}}),this.terrainTileForTile={};const me=this._style._sourceCaches;for(const be in me){const qe=me[be];if(!qe.used||(qe!==this.sourceCache&&this.resetTileLookupCache(qe.id),this._setupProxiedCoordsForOrtho(qe,G[be],de),qe.usedForTerrain))continue;const Te=G[be];qe.getSource().reparseOverscaled&&this._assignTerrainTiles(Te)}this.proxiedCoords[Z.id]=le.map(be=>new Ps(be,be.key,this.orthoMatrix)),this._assignTerrainTiles(le),this._prepareDEMTextures(),this._setupDrapedRenderBatches(),this._initFBOPool(),this._setupRenderCache(de),this.renderingToTexture=!1,this._updateTimestamp=t.exported.now();const ye={};this._visibleDemTiles=[];for(const be of this.proxyCoords){const qe=this.terrainTileForTile[be.key];if(!qe)continue;const Te=qe.tileID.key;Te in ye||(this._visibleDemTiles.push(qe),ye[Te]=Te)}}_assignTerrainTiles(G){this._initializing||G.forEach(Z=>{if(this.terrainTileForTile[Z.key])return;const re=this._findTileCoveringTileID(Z,this.sourceCache);re&&(this.terrainTileForTile[Z.key]=re)})}_prepareDEMTextures(){const G=this.painter.context,Z=G.gl;for(const re in this.terrainTileForTile){const le=this.terrainTileForTile[re],de=le.dem;!de||le.demTexture&&!le.needsDEMTextureUpload||(G.activeTexture.set(Z.TEXTURE1),Mu(this.painter,le,de))}}_prepareDemTileUniforms(G,Z,re,le){if(!Z||Z.demTexture==null)return!1;const de=G.tileID.canonical,me=Math.pow(2,Z.tileID.canonical.z-de.z),ye=le||"";return re[`u_dem_tl${ye}`]=[de.x*me%1,de.y*me%1],re[`u_dem_scale${ye}`]=me,!0}get emptyDEMTexture(){return!this._emptyDEMTextureDirty&&this._emptyDEMTexture?this._emptyDEMTexture:this._updateEmptyDEMTexture()}get emptyDepthBufferTexture(){const G=this.painter.context,Z=G.gl;if(!this._emptyDepthBufferTexture){const re=new t.RGBAImage({width:1,height:1},Uint8Array.of(255,255,255,255));this._emptyDepthBufferTexture=new t.Texture(G,re,Z.RGBA,{premultiply:!1})}return this._emptyDepthBufferTexture}_getLoadedAreaMinimum(){let G=0;const Z=this._visibleDemTiles.reduce((re,le)=>{if(!le.dem)return re;const de=le.dem.tree.minimums[0];return de>0&&G++,re+de},0);return G?Z/G:0}_updateEmptyDEMTexture(){const G=this.painter.context,Z=G.gl;G.activeTexture.set(Z.TEXTURE2);const re=this._getLoadedAreaMinimum(),le=new t.RGBAImage({width:1,height:1},new Uint8Array(t.DEMData.pack(re,this.sourceCache.getSource().encoding)));this._emptyDEMTextureDirty=!1;let de=this._emptyDEMTexture;return de?de.update(le,{premultiply:!1}):de=this._emptyDEMTexture=new t.Texture(G,le,Z.RGBA,{premultiply:!1}),de}setupElevationDraw(G,Z,re){const le=this.painter.context,de=le.gl,me=(ye=this.sourceCache.getSource().encoding,{u_dem:2,u_dem_prev:4,u_dem_unpack:t.DEMData.getUnpackVector(ye),u_dem_tl:[0,0],u_dem_tl_prev:[0,0],u_dem_scale:0,u_dem_scale_prev:0,u_dem_size:0,u_dem_lerp:1,u_depth:3,u_depth_size_inv:[0,0],u_exaggeration:0});var ye;me.u_dem_size=this.sourceCache.getSource().tileSize,me.u_exaggeration=this.exaggeration();let be=null,qe=null,Te=1;if(re&&re.morphing&&this._useVertexMorphing){const Fe=re.morphing.srcDemTile,$e=re.morphing.dstDemTile;Te=re.morphing.phase,Fe&&$e&&(this._prepareDemTileUniforms(G,Fe,me,"_prev")&&(qe=Fe),this._prepareDemTileUniforms(G,$e,me)&&(be=$e))}if(qe&&be?(le.activeTexture.set(de.TEXTURE2),be.demTexture.bind(de.NEAREST,de.CLAMP_TO_EDGE,de.NEAREST),le.activeTexture.set(de.TEXTURE4),qe.demTexture.bind(de.NEAREST,de.CLAMP_TO_EDGE,de.NEAREST),me.u_dem_lerp=Te):(be=this.terrainTileForTile[G.tileID.key],le.activeTexture.set(de.TEXTURE2),(this._prepareDemTileUniforms(G,be,me)?be.demTexture:this.emptyDEMTexture).bind(de.NEAREST,de.CLAMP_TO_EDGE)),le.activeTexture.set(de.TEXTURE3),re&&re.useDepthForOcclusion?(this._depthTexture&&this._depthTexture.bind(de.NEAREST,de.CLAMP_TO_EDGE),this._depthFBO&&(me.u_depth_size_inv=[1/this._depthFBO.width,1/this._depthFBO.height])):(this.emptyDepthBufferTexture.bind(de.NEAREST,de.CLAMP_TO_EDGE),me.u_depth_size_inv=[1,1]),re&&re.useMeterToDem&&be){const Fe=(1<<be.tileID.canonical.z)*t.mercatorZfromAltitude(1,this.painter.transform.center.lat)*this.sourceCache.getSource().tileSize;me.u_meter_to_dem=Fe}if(re&&re.labelPlaneMatrixInv&&(me.u_label_plane_matrix_inv=re.labelPlaneMatrixInv),Z.setTerrainUniformValues(le,me),this.painter.transform.projection.name==="globe"){const Fe=this.globeUniformValues(this.painter.transform,G.tileID.canonical,re&&re.useDenormalizedUpVectorScale);Z.setGlobeUniformValues(le,Fe)}}globeUniformValues(G,Z,re){const le=G.projection;return{u_tile_tl_up:le.upVector(Z,0,0),u_tile_tr_up:le.upVector(Z,t.EXTENT,0),u_tile_br_up:le.upVector(Z,t.EXTENT,t.EXTENT),u_tile_bl_up:le.upVector(Z,0,t.EXTENT),u_tile_up_scale:re?t.globeMetersToEcef(1):le.upVectorScale(Z,G.center.lat,G.worldSize).metersToTile}}renderToBackBuffer(G){const Z=this.painter,re=this.painter.context;G.length!==0&&(re.bindFramebuffer.set(null),re.viewport.set([0,0,Z.width,Z.height]),Z.gpuTimingDeferredRenderStart(),this.renderingToTexture=!1,function(le,de,me,ye,be){if(le.transform.projection.name==="globe")(function(qe,Te,Fe,$e,Je){const tt=qe.context,Qe=tt.gl;let it,Be;const Ye=qe.options.showTerrainWireframe?2:0,lt=qe.transform,ct=t.globeUseCustomAntiAliasing(qe,tt,lt),Tt=(pr,jt)=>{if(Be===pr)return;const ir=[Ka[pr],"PROJECTION_GLOBE_VIEW"];ct&&ir.push("CUSTOM_ANTIALIASING"),jt&&ir.push(Ka[Ye]),it=qe.useProgram("globeRaster",null,ir),Be=pr},Rt=qe.colorModeForRenderPass(),It=new t.DepthMode(Qe.LEQUAL,t.DepthMode.ReadWrite,qe.depthRangeFor3D);xa.update(Je);const kt=t.calculateGlobeMercatorMatrix(lt),Dt=[t.mercatorXfromLng(lt.center.lng),t.mercatorYfromLat(lt.center.lat)],Vt=Ye?[!1,!0]:[!1],mr=qe.globeSharedBuffers,Bt=[lt.width*t.exported.devicePixelRatio,lt.height*t.exported.devicePixelRatio],nr=Float32Array.from(lt.globeMatrix),Ht={useDenormalizedUpVectorScale:!0};if(Vt.forEach(pr=>{const jt=qe.transform,ir=Os(jt.zoom)*Te.exaggeration();Be=-1;const gr=pr?Qe.LINES:Qe.TRIANGLES;for(const ur of $e){const xr=Fe.getTile(ur),Jr=t.StencilMode.disabled,hi=Te.prevTerrainTileForTile[ur.key],Gr=Te.terrainTileForTile[ur.key];mo(hi,Gr)&&xa.newMorphing(ur.key,hi,Gr,Je,250),tt.activeTexture.set(Qe.TEXTURE0),xr.texture.bind(Qe.LINEAR,Qe.CLAMP_TO_EDGE);const ii=xa.getMorphValuesForProxy(ur.key),xi=ii?1:0;ii&&t.extend$1(Ht,{morphing:{srcDemTile:ii.from,dstDemTile:ii.to,phase:t.easeCubicInOut(ii.phase)}});const gi=t.tileCornersToBounds(ur.canonical),Zr=t.getLatitudinalLod(gi.getCenter().lat),Pi=t.getGridMatrix(ur.canonical,gi,Zr,jt.worldSize/jt._pixelsPerMercatorPixel),Di=t.globeNormalizeECEF(t.globeTileBounds(ur.canonical)),Li=Rs(jt.projMatrix,nr,kt,Di,t.globeToMercatorTransition(jt.zoom),Dt,jt.frustumCorners.TL,jt.frustumCorners.TR,jt.frustumCorners.BR,jt.frustumCorners.BL,jt.globeCenterInViewSpace,jt.globeRadius,Bt,ir,Pi);if(Tt(xi,pr),Te.setupElevationDraw(xr,it,Ht),qe.prepareDrawProgram(tt,it,ur.toUnwrapped()),mr){const[Fi,An,bn]=pr?mr.getWirefameBuffers(qe.context,Zr):mr.getGridBuffers(Zr,ir!==0);it.draw(tt,gr,It,Jr,Rt,t.CullFaceMode.backCCW,Li,"globe_raster",Fi,An,bn)}}}),mr){const pr=["GLOBE_POLES","PROJECTION_GLOBE_VIEW"];ct&&pr.push("CUSTOM_ANTIALIASING"),it=qe.useProgram("globeRaster",null,pr);for(const jt of $e){const{x:ir,y:gr,z:ur}=jt.canonical,xr=gr===0,Jr=gr===(1<<ur)-1,[hi,Gr,ii,xi]=mr.getPoleBuffers(ur);if(xi&&(xr||Jr)){const gi=Fe.getTile(jt);tt.activeTexture.set(Qe.TEXTURE0),gi.texture.bind(Qe.LINEAR,Qe.CLAMP_TO_EDGE);let Zr=t.globePoleMatrixForTile(ur,ir,lt);const Pi=t.globeNormalizeECEF(t.globeTileBounds(jt.canonical)),Di=(Li,Fi)=>Li.draw(tt,Qe.TRIANGLES,It,t.StencilMode.disabled,Rt,t.CullFaceMode.disabled,Rs(lt.projMatrix,Zr,Zr,Pi,0,Dt,lt.frustumCorners.TL,lt.frustumCorners.TR,lt.frustumCorners.BR,lt.frustumCorners.BL,lt.globeCenterInViewSpace,lt.globeRadius,Bt,0),"globe_pole_raster",Fi,ii,xi);Te.setupElevationDraw(gi,it,Ht),qe.prepareDrawProgram(tt,it,jt.toUnwrapped()),xr&&Di(it,hi),Jr&&(Zr=t.scale(t.create(),Zr,[1,-1,1]),Di(it,Gr))}}}})(le,de,me,ye,be);else{const qe=le.context,Te=qe.gl;let Fe,$e;const Je=le.options.showTerrainWireframe?2:0,tt=(lt,ct)=>{if($e===lt)return;const Tt=[Ka[lt]];ct&&Tt.push(Ka[Je]),Fe=le.useProgram("terrainRaster",null,Tt),$e=lt},Qe=le.colorModeForRenderPass(),it=new t.DepthMode(Te.LEQUAL,t.DepthMode.ReadWrite,le.depthRangeFor3D);xa.update(be);const Be=le.transform,Ye=Os(Be.zoom)*de.exaggeration();(Je?[!1,!0]:[!1]).forEach(lt=>{$e=-1;const ct=lt?Te.LINES:Te.TRIANGLES,[Tt,Rt]=lt?de.getWirefameBuffer():[de.gridIndexBuffer,de.gridSegments];for(const It of ye){const kt=me.getTile(It),Dt=t.StencilMode.disabled,Vt=de.prevTerrainTileForTile[It.key],mr=de.terrainTileForTile[It.key];mo(Vt,mr)&&xa.newMorphing(It.key,Vt,mr,be,250),qe.activeTexture.set(Te.TEXTURE0),kt.texture.bind(Te.LINEAR,Te.CLAMP_TO_EDGE,Te.LINEAR_MIPMAP_NEAREST);const Bt=xa.getMorphValuesForProxy(It.key),nr=Bt?1:0;let Ht;Bt&&(Ht={morphing:{srcDemTile:Bt.from,dstDemTile:Bt.to,phase:t.easeCubicInOut(Bt.phase)}});const pr=_o(It.projMatrix,rc(It.canonical,Be.renderWorldCopies)?Ye/10:Ye);tt(nr,lt),de.setupElevationDraw(kt,Fe,Ht),le.prepareDrawProgram(qe,Fe,It.toUnwrapped()),Fe.draw(qe,ct,it,Dt,Qe,t.CullFaceMode.backCCW,pr,"terrain_raster",de.gridBuffer,Tt,Rt)}})}}(Z,this,this.proxySourceCache,G,this._updateTimestamp),this.renderingToTexture=!0,Z.gpuTimingDeferredRenderEnd(),G.splice(0,G.length))}renderBatch(G){if(this._drapedRenderBatches.length===0)return G+1;this.renderingToTexture=!0;const Z=this.painter,re=this.painter.context,le=this.proxySourceCache,de=this.proxiedCoords[le.id],me=this._drapedRenderBatches.shift(),ye=[],be=Z.style.order;let qe=0;for(const Te of de){const Fe=le.getTileByID(Te.proxyTileKey),$e=le.proxyCachedFBO[Te.key]?le.proxyCachedFBO[Te.key][G]:void 0,Je=$e!==void 0?le.renderCache[$e]:this.pool[qe++],tt=$e!==void 0;if(Fe.texture=Je.tex,tt&&!Je.dirty){ye.push(Fe.tileID);continue}let Qe;re.bindFramebuffer.set(Je.fb.framebuffer),this.renderedToTile=!1,Je.dirty&&(re.clear({color:t.Color.transparent,stencil:0}),Je.dirty=!1);for(let it=me.start;it<=me.end;++it){const Be=Z.style._layers[be[it]];if(Be.isHidden(Z.transform.zoom))continue;const Ye=Z.style._getLayerSourceCache(Be),lt=Ye?this.proxyToSource[Te.key][Ye.id]:[Te];if(!lt)continue;const ct=lt;re.viewport.set([0,0,Je.fb.width,Je.fb.height]),Qe!==(Ye?Ye.id:null)&&(this._setupStencil(Je,lt,Be,Ye),Qe=Ye?Ye.id:null),Z.renderLayer(Z,Ye,Be,ct)}this.renderedToTile?(Je.dirty=!0,ye.push(Fe.tileID)):tt||--qe,qe===5&&(qe=0,this.renderToBackBuffer(ye))}return this.renderToBackBuffer(ye),this.renderingToTexture=!1,re.bindFramebuffer.set(null),re.viewport.set([0,0,Z.width,Z.height]),me.end+1}postRender(){}renderCacheEfficiency(G){const Z=G.order.length;if(Z===0)return{efficiency:100};let re,le=0,de=0,me=!1;for(let ye=0;ye<Z;++ye){const be=G._layers[G.order[ye]];this._style.isLayerDraped(be)?(me&&++le,++de):me||(me=!0,re=be.id)}return de===0?{efficiency:100}:{efficiency:100*(1-le/de),firstUndrapedLayer:re}}getMinElevationBelowMSL(){let G=0;return this._visibleDemTiles.filter(Z=>Z.dem).forEach(Z=>{G=Math.min(G,Z.dem.tree.minimums[0])}),G===0?G:(G-30)*this._exaggeration}raycast(G,Z,re){if(!this._visibleDemTiles)return null;const le=this._visibleDemTiles.filter(de=>de.dem).map(de=>{const me=de.tileID,ye=1<<me.overscaledZ,{x:be,y:qe}=me.canonical,Te=be/ye,Fe=(be+1)/ye,$e=qe/ye,Je=(qe+1)/ye;return{minx:Te,miny:$e,maxx:Fe,maxy:Je,t:de.dem.tree.raycastRoot(Te,$e,Fe,Je,G,Z,re),tile:de}});le.sort((de,me)=>(de.t!==null?de.t:Number.MAX_VALUE)-(me.t!==null?me.t:Number.MAX_VALUE));for(const de of le){if(de.t==null)return null;const me=de.tile.dem.tree.raycast(de.minx,de.miny,de.maxx,de.maxy,G,Z,re);if(me!=null)return me}return null}_createFBO(){const G=this.painter.context,Z=G.gl,re=this.drapeBufferSize;G.activeTexture.set(Z.TEXTURE0);const le=new t.Texture(G,{width:re[0],height:re[1],data:null},Z.RGBA);le.bind(Z.LINEAR,Z.CLAMP_TO_EDGE);const de=G.createFramebuffer(re[0],re[1],!1);return de.colorAttachment.set(le.texture),de.depthAttachment=new St(G,de.framebuffer),this._sharedDepthStencil===void 0?(this._sharedDepthStencil=G.createRenderbuffer(G.gl.DEPTH_STENCIL,re[0],re[1]),this._stencilRef=0,de.depthAttachment.set(this._sharedDepthStencil),G.clear({stencil:0})):de.depthAttachment.set(this._sharedDepthStencil),G.extTextureFilterAnisotropic&&!G.extTextureFilterAnisotropicForceOff&&Z.texParameterf(Z.TEXTURE_2D,G.extTextureFilterAnisotropic.TEXTURE_MAX_ANISOTROPY_EXT,G.extTextureFilterAnisotropicMax),{fb:de,tex:le,dirty:!1}}_initFBOPool(){for(;this.pool.length<Math.min(5,this.proxyCoords.length);)this.pool.push(this._createFBO())}_shouldDisableRenderCache(){if(this._style.light&&this._style.light.hasTransition())return!0;for(const G in this._style._sourceCaches)if(this._style._sourceCaches[G].hasTransition())return!0;return this._style.order.some(G=>{const Z=this._style._layers[G],re=Z.isHidden(this.painter.transform.zoom);return Z.type==="custom"?!re&&Z.shouldRedrape():!re&&Z.hasTransition()})}_clearLineLayersFromRenderCache(){let G=!1;for(const re of this._style._getSources())if(re instanceof Ar){G=!0;break}if(!G)return;const Z={};for(let re=0;re<this._style.order.length;++re){const le=this._style._layers[this._style.order[re]],de=this._style._getLayerSourceCache(le);if(de&&!Z[de.id]&&!le.isHidden(this.painter.transform.zoom)&&le.type==="line"&&le.widthExpression()instanceof t.ZoomDependentExpression){Z[de.id]=!0;for(const me of this.proxyCoords){const ye=this.proxyToSource[me.key][de.id];if(ye)for(const be of ye)this._clearRenderCacheForTile(de.id,be)}}}}_clearRasterLayersFromRenderCache(){let G=!1;for(const re in this._style._sourceCaches)if(this._style._sourceCaches[re]._source instanceof cr){G=!0;break}if(!G)return;const Z={};for(let re=0;re<this._style.order.length;++re){const le=this._style._layers[this._style.order[re]],de=this._style._getLayerSourceCache(le);if(!de||Z[de.id]||le.isHidden(this.painter.transform.zoom)||le.type!=="raster")continue;const me=le.paint.get("raster-fade-duration");for(const ye of this.proxyCoords){const be=this.proxyToSource[ye.key][de.id];if(be)for(const qe of be){const Te=Lu(de.getTile(qe),de.findLoadedParent(qe,0),de,this.painter.transform,me);(Te.opacity!==1||Te.mix!==0)&&this._clearRenderCacheForTile(de.id,qe)}}}}_setupDrapedRenderBatches(){const G=this._style.order,Z=G.length;if(Z===0)return;const re=[];let le,de=0,me=this._style._layers[G[de]];for(;!this._style.isLayerDraped(me)&&me.isHidden(this.painter.transform.zoom)&&++de<Z;)me=this._style._layers[G[de]];for(;de<Z;++de){const ye=this._style._layers[G[de]];ye.isHidden(this.painter.transform.zoom)||(this._style.isLayerDraped(ye)?le===void 0&&(le=de):le!==void 0&&(re.push({start:le,end:de-1}),le=void 0))}le!==void 0&&re.push({start:le,end:de-1}),this._drapedRenderBatches=re}_setupRenderCache(G){const Z=this.proxySourceCache;if(this._shouldDisableRenderCache()||this._invalidateRenderCache){if(this._invalidateRenderCache=!1,Z.renderCache.length>Z.renderCachePool.length){const me=Object.values(Z.proxyCachedFBO);Z.proxyCachedFBO={};for(let ye=0;ye<me.length;++ye){const be=Object.values(me[ye]);Z.renderCachePool.push(...be)}}return}this._clearRasterLayersFromRenderCache();const re=this.proxyCoords,le=this._tilesDirty;for(let me=re.length-1;me>=0;me--){const ye=re[me];if(Z.getTileByID(ye.key),Z.proxyCachedFBO[ye.key]!==void 0){const be=G[ye.key],qe=this.proxyToSource[ye.key];let Te=0;for(const Fe in qe){const $e=qe[Fe],Je=be[Fe];if(!Je||Je.length!==$e.length||$e.some((tt,Qe)=>tt!==Je[Qe]||le[Fe]&&le[Fe].hasOwnProperty(tt.key))){Te=-1;break}++Te}for(const Fe in Z.proxyCachedFBO[ye.key])Z.renderCache[Z.proxyCachedFBO[ye.key][Fe]].dirty=Te<0||Te!==Object.values(be).length}}const de=[...this._drapedRenderBatches];de.sort((me,ye)=>ye.end-ye.start-(me.end-me.start));for(const me of de)for(const ye of re){if(Z.proxyCachedFBO[ye.key])continue;let be=Z.renderCachePool.pop();be===void 0&&Z.renderCache.length<50&&(be=Z.renderCache.length,Z.renderCache.push(this._createFBO())),be!==void 0&&(Z.proxyCachedFBO[ye.key]={},Z.proxyCachedFBO[ye.key][me.start]=be,Z.renderCache[be].dirty=!0)}this._tilesDirty={}}_setupStencil(G,Z,re,le){if(!le||!this._sourceTilesOverlap[le.id])return void(this._overlapStencilType&&(this._overlapStencilType=!1));const de=this.painter.context,me=de.gl;if(Z.length<=1)return void(this._overlapStencilType=!1);let ye;if(re.isTileClipped())ye=Z.length,this._overlapStencilMode.test={func:me.EQUAL,mask:255},this._overlapStencilType="Clip";else{if(!(Z[0].overscaledZ>Z[Z.length-1].overscaledZ))return void(this._overlapStencilType=!1);ye=1,this._overlapStencilMode.test={func:me.GREATER,mask:255},this._overlapStencilType="Mask"}this._stencilRef+ye>255&&(de.clear({stencil:0}),this._stencilRef=0),this._stencilRef+=ye,this._overlapStencilMode.ref=this._stencilRef,re.isTileClipped()&&this._renderTileClippingMasks(Z,this._overlapStencilMode.ref)}clipOrMaskOverlapStencilType(){return this._overlapStencilType==="Clip"||this._overlapStencilType==="Mask"}stencilModeForRTTOverlap(G){return this.renderingToTexture&&this._overlapStencilType?(this._overlapStencilType==="Clip"&&(this._overlapStencilMode.ref=this.painter._tileClippingMaskIDs[G.key]),this._overlapStencilMode):t.StencilMode.disabled}_renderTileClippingMasks(G,Z){const re=this.painter,le=this.painter.context,de=le.gl;re._tileClippingMaskIDs={},le.setColorMode(t.ColorMode.disabled),le.setDepthMode(t.DepthMode.disabled);const me=re.useProgram("clippingMask");for(const ye of G){const be=re._tileClippingMaskIDs[ye.key]=--Z;me.draw(le,de.TRIANGLES,t.DepthMode.disabled,new t.StencilMode({func:de.ALWAYS,mask:0},be,255,de.KEEP,de.KEEP,de.REPLACE),t.ColorMode.disabled,t.CullFaceMode.disabled,Zo(ye.projMatrix),"$clipping",re.tileExtentBuffer,re.quadTriangleIndexBuffer,re.tileExtentSegments)}}pointCoordinate(G){const Z=this.painter.transform;if(G.x<0||G.x>Z.width||G.y<0||G.y>Z.height)return null;const re=[G.x,G.y,1,1];t.transformMat4$1(re,re,Z.pixelMatrixInverse),t.scale$1(re,re,1/re[3]),re[0]/=Z.worldSize,re[1]/=Z.worldSize;const le=Z._camera.position,de=t.mercatorZfromAltitude(1,Z.center.lat),me=[le[0],le[1],le[2]/de,0],ye=t.subtract([],re.slice(0,3),me);t.normalize(ye,ye);const be=this.raycast(me,ye,this._exaggeration);return be!==null&&be?(t.scaleAndAdd(me,me,ye,be),me[3]=me[2],me[2]*=de,me):null}drawDepth(){const G=this.painter,Z=G.context,re=this.proxySourceCache,le=Math.ceil(G.width),de=Math.ceil(G.height);if(!this._depthFBO||this._depthFBO.width===le&&this._depthFBO.height===de||(this._depthFBO.destroy(),this._depthFBO=void 0,this._depthTexture=void 0),!this._depthFBO){const me=Z.gl,ye=Z.createFramebuffer(le,de,!0);Z.activeTexture.set(me.TEXTURE0);const be=new t.Texture(Z,{width:le,height:de,data:null},me.RGBA);be.bind(me.NEAREST,me.CLAMP_TO_EDGE),ye.colorAttachment.set(be.texture);const qe=Z.createRenderbuffer(Z.gl.DEPTH_COMPONENT16,le,de);ye.depthAttachment.set(qe),this._depthFBO=ye,this._depthTexture=be}Z.bindFramebuffer.set(this._depthFBO.framebuffer),Z.viewport.set([0,0,le,de]),function(me,ye,be,qe){if(me.transform.projection.name==="globe")return;const Te=me.context,Fe=Te.gl;Te.clear({depth:1});const $e=me.useProgram("terrainDepth"),Je=new t.DepthMode(Fe.LESS,t.DepthMode.ReadWrite,me.depthRangeFor3D);for(const tt of qe){const Qe=be.getTile(tt),it=_o(tt.projMatrix,0);ye.setupElevationDraw(Qe,$e),$e.draw(Te,Fe.TRIANGLES,Je,t.StencilMode.disabled,t.ColorMode.unblended,t.CullFaceMode.backCCW,it,"terrain_depth",ye.gridBuffer,ye.gridIndexBuffer,ye.gridNoSkirtSegments)}}(G,this,re,this.proxyCoords)}_setupProxiedCoordsForOrtho(G,Z,re){if(G.getSource()instanceof ci)return this._setupProxiedCoordsForImageSource(G,Z,re);this._findCoveringTileCache[G.id]=this._findCoveringTileCache[G.id]||{};const le=this.proxiedCoords[G.id]=[],de=this.proxyCoords;for(let ye=0;ye<de.length;ye++){const be=de[ye],qe=this._findTileCoveringTileID(be,G);if(qe){const Te=this._createProxiedId(be,qe,re[be.key]&&re[be.key][G.id]);le.push(Te),this.proxyToSource[be.key][G.id]=[Te]}}let me=!1;for(let ye=0;ye<Z.length;ye++){const be=G.getTile(Z[ye]);if(!be||!be.hasData())continue;const qe=this._findTileCoveringTileID(be.tileID,this.proxySourceCache);if(qe&&qe.tileID.canonical.z!==be.tileID.canonical.z){const Te=this.proxyToSource[qe.tileID.key][G.id],Fe=this._createProxiedId(qe.tileID,be,re[qe.tileID.key]&&re[qe.tileID.key][G.id]);Te?Te.splice(Te.length-1,0,Fe):this.proxyToSource[qe.tileID.key][G.id]=[Fe],le.push(Fe),me=!0}}this._sourceTilesOverlap[G.id]=me}_setupProxiedCoordsForImageSource(G,Z,re){if(!G.getSource().loaded())return;const le=this.proxiedCoords[G.id]=[],de=this.proxyCoords,me=G.getSource(),ye=new t.Point(me.tileID.x,me.tileID.y)._div(1<<me.tileID.z),be=me.coordinates.map(t.MercatorCoordinate.fromLngLat).reduce((Te,Fe)=>(Te.min.x=Math.min(Te.min.x,Fe.x-ye.x),Te.min.y=Math.min(Te.min.y,Fe.y-ye.y),Te.max.x=Math.max(Te.max.x,Fe.x-ye.x),Te.max.y=Math.max(Te.max.y,Fe.y-ye.y),Te),{min:new t.Point(Number.MAX_VALUE,Number.MAX_VALUE),max:new t.Point(-Number.MAX_VALUE,-Number.MAX_VALUE)}),qe=(Te,Fe)=>{const $e=Te.wrap+Te.canonical.x/(1<<Te.canonical.z),Je=Te.canonical.y/(1<<Te.canonical.z),tt=t.EXTENT/(1<<Te.canonical.z),Qe=Fe.wrap+Fe.canonical.x/(1<<Fe.canonical.z),it=Fe.canonical.y/(1<<Fe.canonical.z);return $e+tt<Qe+be.min.x||$e>Qe+be.max.x||Je+tt<it+be.min.y||Je>it+be.max.y};for(let Te=0;Te<de.length;Te++){const Fe=de[Te];for(let $e=0;$e<Z.length;$e++){const Je=G.getTile(Z[$e]);if(!Je||!Je.hasData()||qe(Fe,Je.tileID))continue;const tt=this._createProxiedId(Fe,Je,re[Fe.key]&&re[Fe.key][G.id]),Qe=this.proxyToSource[Fe.key][G.id];Qe?Qe.push(tt):this.proxyToSource[Fe.key][G.id]=[tt],le.push(tt)}}}_createProxiedId(G,Z,re){let le=this.orthoMatrix;if(re){const de=re.find(me=>me.key===Z.tileID.key);if(de)return de}if(Z.tileID.key!==G.key){const de=G.canonical.z-Z.tileID.canonical.z;let me,ye,be;le=t.create();const qe=Z.tileID.wrap-G.wrap<<G.overscaledZ;de>0?(me=t.EXTENT>>de,ye=me*((Z.tileID.canonical.x<<de)-G.canonical.x+qe),be=me*((Z.tileID.canonical.y<<de)-G.canonical.y)):(me=t.EXTENT<<-de,ye=t.EXTENT*(Z.tileID.canonical.x-(G.canonical.x+qe<<-de)),be=t.EXTENT*(Z.tileID.canonical.y-(G.canonical.y<<-de))),t.ortho(le,0,me,0,me,0,1),t.translate(le,le,[ye,be,0])}return new Ps(Z.tileID,G.key,le)}_findTileCoveringTileID(G,Z){let re=Z.getTile(G);if(re&&re.hasData())return re;const le=this._findCoveringTileCache[Z.id],de=le[G.key];if(re=de?Z.getTileByID(de):null,re&&re.hasData()||de===null)return re;let me=re?re.tileID:G,ye=me.overscaledZ;const be=Z.getSource().minzoom,qe=[];if(!de){const Fe=Z.getSource().maxzoom;if(G.canonical.z>=Fe){const $e=G.canonical.z-Fe;Z.getSource().reparseOverscaled?(ye=Math.max(G.canonical.z+2,Z.transform.tileZoom),me=new t.OverscaledTileID(ye,G.wrap,Fe,G.canonical.x>>$e,G.canonical.y>>$e)):$e!==0&&(ye=Fe,me=new t.OverscaledTileID(ye,G.wrap,Fe,G.canonical.x>>$e,G.canonical.y>>$e))}me.key!==G.key&&(qe.push(me.key),re=Z.getTile(me))}const Te=Fe=>{qe.forEach($e=>{le[$e]=Fe}),qe.length=0};for(ye-=1;ye>=be&&(!re||!re.hasData());ye--){re&&Te(re.tileID.key);const Fe=me.calculateScaledKey(ye);if(re=Z.getTileByID(Fe),re&&re.hasData())break;const $e=le[Fe];if($e===null)break;$e===void 0?qe.push(Fe):re=Z.getTileByID($e)}return Te(re?re.tileID.key:null),re&&re.hasData()?re:null}findDEMTileFor(G){return this.enabled?this._findTileCoveringTileID(G,this.sourceCache):null}prepareDrawTile(){this.renderedToTile=!0}_clearRenderCacheForTile(G,Z){let re=this._tilesDirty[G];re||(re=this._tilesDirty[G]={}),re[Z.key]=!0}getWirefameBuffer(){if(!this.wireframeSegments){const G=function(Z){let re=0;const le=new t.StructArrayLayout2ui4,de=131;for(let me=1;me<129;me++){for(let ye=1;ye<129;ye++)re=me*de+ye,le.emplaceBack(re,re+1),le.emplaceBack(re,re+de),le.emplaceBack(re+1,re+de),me===128&&le.emplaceBack(re+de,re+de+1);le.emplaceBack(re+1,re+1+de)}return le}();this.wireframeIndexBuffer=this.painter.context.createIndexBuffer(G),this.wireframeSegments=t.SegmentVector.simpleSegment(0,0,this.gridBuffer.length,G.length)}return[this.wireframeIndexBuffer,this.wireframeSegments]}}class Ti{static cacheKey(G,Z,re,le){let de=`${Z}${le?le.cacheKey:""}`;for(const me of re)G.usedDefines.includes(me)&&(de+=`/${me}`);return de}constructor(G,Z,re,le,de,me){const ye=G.gl;this.program=ye.createProgram();const be=function(Be){const Ye=[];for(let lt=0;lt<Be.length;lt++){if(Be[lt]===null)continue;const ct=Be[lt].split(" ");Ye.push(ct.pop())}return Ye}(re.staticAttributes),qe=le?le.getBinderAttributes():[],Te=be.concat(qe);let Fe=le?le.defines():[];Fe=Fe.concat(me.map(Be=>`#define ${Be}`));const $e=G.isWebGL2?`#version 300 es
`:"",Je=$e+Fe.concat(G.extStandardDerivatives&&$e.length===0?`#extension GL_OES_standard_derivatives : enable
`.concat(Ou):Ou,Ou,As,Ql.fragmentSource,fo.fragmentSource,re.fragmentSource).join(`
`),tt=$e+Fe.concat(`
#ifdef GL_ES
precision highp float;
#else

#if !defined(lowp)
#define lowp
#endif

#if !defined(mediump)
#define mediump
#endif

#if !defined(highp)
#define highp
#endif

#endif`,As,Ql.vertexSource,fo.vertexSource,Is.vertexSource,re.vertexSource).join(`
`),Qe=ye.createShader(ye.FRAGMENT_SHADER);if(ye.isContextLost())return void(this.failedToCreate=!0);ye.shaderSource(Qe,Je),ye.compileShader(Qe),ye.attachShader(this.program,Qe);const it=ye.createShader(ye.VERTEX_SHADER);if(ye.isContextLost())this.failedToCreate=!0;else{ye.shaderSource(it,tt),ye.compileShader(it),ye.attachShader(this.program,it),this.attributes={},this.numAttributes=Te.length;for(let Be=0;Be<this.numAttributes;Be++)Te[Be]&&(ye.bindAttribLocation(this.program,Be,Te[Be]),this.attributes[Te[Be]]=Be);ye.linkProgram(this.program),ye.deleteShader(it),ye.deleteShader(Qe),this.fixedUniforms=de(G),this.binderUniforms=le?le.getUniforms(G):[],me.includes("TERRAIN")&&(this.terrainUniforms=(Be=>({u_dem:new t.Uniform1i(Be),u_dem_prev:new t.Uniform1i(Be),u_dem_unpack:new t.Uniform4f(Be),u_dem_tl:new t.Uniform2f(Be),u_dem_scale:new t.Uniform1f(Be),u_dem_tl_prev:new t.Uniform2f(Be),u_dem_scale_prev:new t.Uniform1f(Be),u_dem_size:new t.Uniform1f(Be),u_dem_lerp:new t.Uniform1f(Be),u_exaggeration:new t.Uniform1f(Be),u_depth:new t.Uniform1i(Be),u_depth_size_inv:new t.Uniform2f(Be),u_meter_to_dem:new t.Uniform1f(Be),u_label_plane_matrix_inv:new t.UniformMatrix4f(Be)}))(G)),me.includes("GLOBE")&&(this.globeUniforms=(Be=>({u_tile_tl_up:new t.Uniform3f(Be),u_tile_tr_up:new t.Uniform3f(Be),u_tile_br_up:new t.Uniform3f(Be),u_tile_bl_up:new t.Uniform3f(Be),u_tile_up_scale:new t.Uniform1f(Be)}))(G)),me.includes("FOG")&&(this.fogUniforms=(Be=>({u_fog_matrix:new t.UniformMatrix4f(Be),u_fog_range:new t.Uniform2f(Be),u_fog_color:new t.Uniform4f(Be),u_fog_horizon_blend:new t.Uniform1f(Be),u_fog_temporal_offset:new t.Uniform1f(Be),u_frustum_tl:new t.Uniform3f(Be),u_frustum_tr:new t.Uniform3f(Be),u_frustum_br:new t.Uniform3f(Be),u_frustum_bl:new t.Uniform3f(Be),u_globe_pos:new t.Uniform3f(Be),u_globe_radius:new t.Uniform1f(Be),u_globe_transition:new t.Uniform1f(Be),u_is_globe:new t.Uniform1i(Be),u_viewport:new t.Uniform2f(Be)}))(G))}}setTerrainUniformValues(G,Z){if(!this.terrainUniforms)return;const re=this.terrainUniforms;if(!this.failedToCreate){G.program.set(this.program);for(const le in Z)re[le]&&re[le].set(this.program,le,Z[le])}}setGlobeUniformValues(G,Z){if(!this.globeUniforms)return;const re=this.globeUniforms;if(!this.failedToCreate){G.program.set(this.program);for(const le in Z)re[le]&&re[le].set(this.program,le,Z[le])}}setFogUniformValues(G,Z){if(!this.fogUniforms)return;const re=this.fogUniforms;if(!this.failedToCreate){G.program.set(this.program);for(const le in Z)re[le].set(this.program,le,Z[le])}}draw(G,Z,re,le,de,me,ye,be,qe,Te,Fe,$e,Je,tt,Qe){const it=G.gl;if(this.failedToCreate)return;G.program.set(this.program),G.setDepthMode(re),G.setStencilMode(le),G.setColorMode(de),G.setCullFace(me);for(const Ye of Object.keys(this.fixedUniforms))this.fixedUniforms[Ye].set(this.program,Ye,ye[Ye]);tt&&tt.setUniforms(this.program,G,this.binderUniforms,$e,{zoom:Je});const Be={[it.LINES]:2,[it.TRIANGLES]:3,[it.LINE_STRIP]:1}[Z];for(const Ye of Fe.get()){const lt=Ye.vaos||(Ye.vaos={});(lt[be]||(lt[be]=new vh)).bind(G,this,qe,tt?tt.getPaintVertexBuffers():[],Te,Ye.vertexOffset,Qe||[]),it.drawElements(Z,Ye.primitiveLength*Be,it.UNSIGNED_SHORT,Ye.primitiveOffset*Be*2)}}}function Ko(J,G){const Z=Math.pow(2,G.tileID.overscaledZ),re=G.tileSize*Math.pow(2,J.transform.tileZoom)/Z,le=re*(G.tileID.canonical.x+G.tileID.wrap*Z),de=re*G.tileID.canonical.y;return{u_image:0,u_texsize:G.imageAtlasTexture.size,u_tile_units_to_pixels:1/Ft(G,1,J.transform.tileZoom),u_pixel_coord_upper:[le>>16,de>>16],u_pixel_coord_lower:[65535&le,65535&de]}}const ic=t.create(),Bu=(J,G,Z,re,le,de,me,ye,be,qe,Te)=>{const Fe=G.style.light,$e=Fe.properties.get("position"),Je=[$e.x,$e.y,$e.z],tt=t.create$1();Fe.properties.get("anchor")==="viewport"&&(t.fromRotation(tt,-G.transform.angle),t.transformMat3(Je,Je,tt));const Qe=Fe.properties.get("color"),it=G.transform,Be={u_matrix:J,u_lightpos:Je,u_lightintensity:Fe.properties.get("intensity"),u_lightcolor:[Qe.r,Qe.g,Qe.b],u_vertical_gradient:+Z,u_opacity:re,u_tile_id:[0,0,0],u_zoom_transition:0,u_inv_rot_matrix:ic,u_merc_center:[0,0],u_up_dir:[0,0,0],u_height_lift:0,u_ao:le,u_edge_radius:de};return it.projection.name==="globe"&&(Be.u_tile_id=[me.canonical.x,me.canonical.y,1<<me.canonical.z],Be.u_zoom_transition=be,Be.u_inv_rot_matrix=Te,Be.u_merc_center=qe,Be.u_up_dir=it.projection.upVector(new t.CanonicalTileID(0,0,0),qe[0]*t.EXTENT,qe[1]*t.EXTENT),Be.u_height_lift=ye),Be},nc=(J,G,Z,re,le,de,me,ye,be,qe,Te,Fe)=>{const $e=Bu(J,G,Z,re,le,de,me,be,qe,Te,Fe),Je={u_height_factor:-Math.pow(2,me.overscaledZ)/ye.tileSize/8};return t.extend($e,Ko(G,ye),Je)},Xa=J=>({u_matrix:J}),zu=(J,G,Z)=>t.extend(Xa(J),Ko(G,Z)),bh=(J,G)=>({u_matrix:J,u_world:G}),xh=(J,G,Z,re)=>t.extend(zu(J,G,Z),{u_world:re}),Eh=t.create(),Nu=(J,G,Z,re,le,de)=>{const me=J.transform,ye=me.projection.name==="globe";let be;if(de.paint.get("circle-pitch-alignment")==="map")if(ye){const Te=t.globePixelsToTileUnits(me.zoom,G.canonical)*me._pixelsPerMercatorPixel;be=Float32Array.from([Te,0,0,Te])}else be=me.calculatePixelsToTileUnitsMatrix(Z);else be=new Float32Array([me.pixelsToGLUnits[0],0,0,me.pixelsToGLUnits[1]]);const qe={u_camera_to_center_distance:me.cameraToCenterDistance,u_matrix:J.translatePosMatrix(G.projMatrix,Z,de.paint.get("circle-translate"),de.paint.get("circle-translate-anchor")),u_device_pixel_ratio:t.exported.devicePixelRatio,u_extrude_scale:be,u_inv_rot_matrix:Eh,u_merc_center:[0,0],u_tile_id:[0,0,0],u_zoom_transition:0,u_up_dir:[0,0,0]};if(ye){qe.u_inv_rot_matrix=re,qe.u_merc_center=le,qe.u_tile_id=[G.canonical.x,G.canonical.y,1<<G.canonical.z],qe.u_zoom_transition=t.globeToMercatorTransition(me.zoom);const Te=le[0]*t.EXTENT,Fe=le[1]*t.EXTENT;qe.u_up_dir=me.projection.upVector(new t.CanonicalTileID(0,0,0),Te,Fe)}return qe},ju=J=>{const G=[];return J.paint.get("circle-pitch-alignment")==="map"&&G.push("PITCH_WITH_MAP"),J.paint.get("circle-pitch-scale")==="map"&&G.push("SCALE_WITH_MAP"),G},Uu=(J,G,Z,re)=>{const le=t.EXTENT/Z.tileSize;return{u_matrix:J,u_camera_to_center_distance:G.getCameraToCenterDistance(re),u_extrude_scale:[G.pixelsToGLUnits[0]/le,G.pixelsToGLUnits[1]/le]}},Ms=(J,G,Z=1)=>({u_matrix:J,u_color:G,u_overlay:0,u_overlay_scale:Z}),ac=t.create(),oc=(J,G,Z,re,le,de,me)=>{const ye=J.transform,be=ye.projection.name==="globe",qe=be?t.globePixelsToTileUnits(ye.zoom,G.canonical)*ye._pixelsPerMercatorPixel:Ft(Z,1,de),Te={u_matrix:G.projMatrix,u_extrude_scale:qe,u_intensity:me,u_inv_rot_matrix:ac,u_merc_center:[0,0],u_tile_id:[0,0,0],u_zoom_transition:0,u_up_dir:[0,0,0]};if(be){Te.u_inv_rot_matrix=re,Te.u_merc_center=le,Te.u_tile_id=[G.canonical.x,G.canonical.y,1<<G.canonical.z],Te.u_zoom_transition=t.globeToMercatorTransition(ye.zoom);const Fe=le[0]*t.EXTENT,$e=le[1]*t.EXTENT;Te.u_up_dir=ye.projection.upVector(new t.CanonicalTileID(0,0,0),Fe,$e)}return Te},wh=(J,G,Z,re,le,de,me)=>{const ye=J.transform,be=ye.calculatePixelsToTileUnitsMatrix(G);return{u_matrix:Vu(J,G,Z,re),u_pixels_to_tile_units:be,u_device_pixel_ratio:de,u_units_to_pixels:[1/ye.pixelsToGLUnits[0],1/ye.pixelsToGLUnits[1]],u_dash_image:0,u_gradient_image:1,u_image_height:le,u_texsize:Yo(Z)?G.lineAtlasTexture.size:[0,0],u_tile_units_to_pixels:yo(G,J.transform),u_alpha_discard_threshold:0,u_trim_offset:me}},Xo=(J,G,Z,re,le)=>{const de=J.transform;return{u_matrix:Vu(J,G,Z,re),u_texsize:G.imageAtlasTexture.size,u_pixels_to_tile_units:de.calculatePixelsToTileUnitsMatrix(G),u_device_pixel_ratio:le,u_image:0,u_tile_units_to_pixels:yo(G,de),u_units_to_pixels:[1/de.pixelsToGLUnits[0],1/de.pixelsToGLUnits[1]],u_alpha_discard_threshold:0}};function yo(J,G){return 1/Ft(J,1,G.tileZoom)}function Vu(J,G,Z,re){return J.translatePosMatrix(re||G.tileID.projMatrix,G,Z.paint.get("line-translate"),Z.paint.get("line-translate-anchor"))}function Yo(J){const G=J.paint.get("line-dasharray").value;return G.value||G.kind!=="constant"}const Gu=(J,G,Z,re,le,de)=>{return{u_matrix:J,u_tl_parent:G,u_scale_parent:Z,u_fade_t:re.mix,u_opacity:re.opacity*le.paint.get("raster-opacity"),u_image0:0,u_image1:1,u_brightness_low:le.paint.get("raster-brightness-min"),u_brightness_high:le.paint.get("raster-brightness-max"),u_saturation_factor:(ye=le.paint.get("raster-saturation"),ye>0?1-1/(1.001-ye):-ye),u_contrast_factor:(me=le.paint.get("raster-contrast"),me>0?1/(1-me):1+me),u_spin_weights:la(le.paint.get("raster-hue-rotate")),u_perspective_transform:de};var me,ye};function la(J){J*=Math.PI/180;const G=Math.sin(J),Z=Math.cos(J);return[(2*Z+1)/3,(-Math.sqrt(3)*G-Z+1)/3,(Math.sqrt(3)*G-Z+1)/3]}const Ds=t.create(),$u=(J,G,Z,re,le,de,me,ye,be,qe,Te,Fe,$e,Je,tt,Qe)=>{const it=le.transform,Be={u_is_size_zoom_constant:+(J==="constant"||J==="source"),u_is_size_feature_constant:+(J==="constant"||J==="camera"),u_size_t:G?G.uSizeT:0,u_size:G?G.uSize:0,u_camera_to_center_distance:it.cameraToCenterDistance,u_rotate_symbol:+Z,u_aspect_ratio:it.width/it.height,u_fade_change:le.options.fadeDuration?le.symbolFadeChange:1,u_matrix:de,u_label_plane_matrix:me,u_coord_matrix:ye,u_is_text:+be,u_pitch_with_map:+re,u_texsize:qe,u_texture:0,u_tile_id:[0,0,0],u_zoom_transition:0,u_inv_rot_matrix:Ds,u_merc_center:[0,0],u_camera_forward:[0,0,0],u_ecef_origin:[0,0,0],u_tile_matrix:Ds,u_up_vector:[0,-1,0]};return Qe.name==="globe"&&(Be.u_tile_id=[Te.canonical.x,Te.canonical.y,1<<Te.canonical.z],Be.u_zoom_transition=Fe,Be.u_inv_rot_matrix=Je,Be.u_merc_center=$e,Be.u_camera_forward=it._camera.forward(),Be.u_ecef_origin=t.globeECEFOrigin(it.globeMatrix,Te.toUnwrapped()),Be.u_tile_matrix=Float32Array.from(it.globeMatrix),Be.u_up_vector=tt),Be},Ls=(J,G,Z,re,le,de,me,ye,be,qe,Te,Fe,$e,Je,tt,Qe,it)=>t.extend($u(J,G,Z,re,le,de,me,ye,be,qe,Fe,$e,Je,tt,Qe,it),{u_gamma_scale:re?le.transform.cameraToCenterDistance*Math.cos(le.terrain?0:le.transform._pitch):1,u_device_pixel_ratio:t.exported.devicePixelRatio,u_is_halo:1}),sc=(J,G,Z,re,le,de,me,ye,be,qe,Te,Fe,$e,Je,tt,Qe)=>t.extend(Ls(J,G,Z,re,le,de,me,ye,!0,be,!0,Te,Fe,$e,Je,tt,Qe),{u_texsize_icon:qe,u_texture_icon:1}),Wu=(J,G,Z)=>({u_matrix:J,u_opacity:G,u_color:Z}),Sh=(J,G,Z,re,le)=>t.extend(function(de,me,ye){const be=me.imageManager.getPattern(de.toString()),{width:qe,height:Te}=me.imageManager.getPixelSize(),Fe=Math.pow(2,ye.tileID.overscaledZ),$e=ye.tileSize*Math.pow(2,me.transform.tileZoom)/Fe,Je=$e*(ye.tileID.canonical.x+ye.tileID.wrap*Fe),tt=$e*ye.tileID.canonical.y;return{u_image:0,u_pattern_tl:be.tl,u_pattern_br:be.br,u_texsize:[qe,Te],u_pattern_size:be.displaySize,u_tile_units_to_pixels:1/Ft(ye,1,me.transform.tileZoom),u_pixel_coord_upper:[Je>>16,tt>>16],u_pixel_coord_lower:[65535&Je,65535&tt]}}(re,Z,le),{u_matrix:J,u_opacity:G}),Hu={fillExtrusion:J=>({u_matrix:new t.UniformMatrix4f(J),u_lightpos:new t.Uniform3f(J),u_lightintensity:new t.Uniform1f(J),u_lightcolor:new t.Uniform3f(J),u_vertical_gradient:new t.Uniform1f(J),u_opacity:new t.Uniform1f(J),u_edge_radius:new t.Uniform1f(J),u_ao:new t.Uniform2f(J),u_tile_id:new t.Uniform3f(J),u_zoom_transition:new t.Uniform1f(J),u_inv_rot_matrix:new t.UniformMatrix4f(J),u_merc_center:new t.Uniform2f(J),u_up_dir:new t.Uniform3f(J),u_height_lift:new t.Uniform1f(J)}),fillExtrusionPattern:J=>({u_matrix:new t.UniformMatrix4f(J),u_lightpos:new t.Uniform3f(J),u_lightintensity:new t.Uniform1f(J),u_lightcolor:new t.Uniform3f(J),u_vertical_gradient:new t.Uniform1f(J),u_height_factor:new t.Uniform1f(J),u_edge_radius:new t.Uniform1f(J),u_ao:new t.Uniform2f(J),u_tile_id:new t.Uniform3f(J),u_zoom_transition:new t.Uniform1f(J),u_inv_rot_matrix:new t.UniformMatrix4f(J),u_merc_center:new t.Uniform2f(J),u_up_dir:new t.Uniform3f(J),u_height_lift:new t.Uniform1f(J),u_image:new t.Uniform1i(J),u_texsize:new t.Uniform2f(J),u_pixel_coord_upper:new t.Uniform2f(J),u_pixel_coord_lower:new t.Uniform2f(J),u_tile_units_to_pixels:new t.Uniform1f(J),u_opacity:new t.Uniform1f(J)}),fill:J=>({u_matrix:new t.UniformMatrix4f(J)}),fillPattern:J=>({u_matrix:new t.UniformMatrix4f(J),u_image:new t.Uniform1i(J),u_texsize:new t.Uniform2f(J),u_pixel_coord_upper:new t.Uniform2f(J),u_pixel_coord_lower:new t.Uniform2f(J),u_tile_units_to_pixels:new t.Uniform1f(J)}),fillOutline:J=>({u_matrix:new t.UniformMatrix4f(J),u_world:new t.Uniform2f(J)}),fillOutlinePattern:J=>({u_matrix:new t.UniformMatrix4f(J),u_world:new t.Uniform2f(J),u_image:new t.Uniform1i(J),u_texsize:new t.Uniform2f(J),u_pixel_coord_upper:new t.Uniform2f(J),u_pixel_coord_lower:new t.Uniform2f(J),u_tile_units_to_pixels:new t.Uniform1f(J)}),circle:J=>({u_camera_to_center_distance:new t.Uniform1f(J),u_extrude_scale:new t.UniformMatrix2f(J),u_device_pixel_ratio:new t.Uniform1f(J),u_matrix:new t.UniformMatrix4f(J),u_inv_rot_matrix:new t.UniformMatrix4f(J),u_merc_center:new t.Uniform2f(J),u_tile_id:new t.Uniform3f(J),u_zoom_transition:new t.Uniform1f(J),u_up_dir:new t.Uniform3f(J)}),collisionBox:J=>({u_matrix:new t.UniformMatrix4f(J),u_camera_to_center_distance:new t.Uniform1f(J),u_extrude_scale:new t.Uniform2f(J)}),collisionCircle:J=>({u_matrix:new t.UniformMatrix4f(J),u_inv_matrix:new t.UniformMatrix4f(J),u_camera_to_center_distance:new t.Uniform1f(J),u_viewport_size:new t.Uniform2f(J)}),debug:J=>({u_color:new t.UniformColor(J),u_matrix:new t.UniformMatrix4f(J),u_overlay:new t.Uniform1i(J),u_overlay_scale:new t.Uniform1f(J)}),clippingMask:J=>({u_matrix:new t.UniformMatrix4f(J)}),heatmap:J=>({u_extrude_scale:new t.Uniform1f(J),u_intensity:new t.Uniform1f(J),u_matrix:new t.UniformMatrix4f(J),u_inv_rot_matrix:new t.UniformMatrix4f(J),u_merc_center:new t.Uniform2f(J),u_tile_id:new t.Uniform3f(J),u_zoom_transition:new t.Uniform1f(J),u_up_dir:new t.Uniform3f(J)}),heatmapTexture:J=>({u_image:new t.Uniform1i(J),u_color_ramp:new t.Uniform1i(J),u_opacity:new t.Uniform1f(J)}),hillshade:J=>({u_matrix:new t.UniformMatrix4f(J),u_image:new t.Uniform1i(J),u_latrange:new t.Uniform2f(J),u_light:new t.Uniform2f(J),u_shadow:new t.UniformColor(J),u_highlight:new t.UniformColor(J),u_accent:new t.UniformColor(J)}),hillshadePrepare:J=>({u_matrix:new t.UniformMatrix4f(J),u_image:new t.Uniform1i(J),u_dimension:new t.Uniform2f(J),u_zoom:new t.Uniform1f(J),u_unpack:new t.Uniform4f(J)}),line:J=>({u_matrix:new t.UniformMatrix4f(J),u_pixels_to_tile_units:new t.UniformMatrix2f(J),u_device_pixel_ratio:new t.Uniform1f(J),u_units_to_pixels:new t.Uniform2f(J),u_dash_image:new t.Uniform1i(J),u_gradient_image:new t.Uniform1i(J),u_image_height:new t.Uniform1f(J),u_texsize:new t.Uniform2f(J),u_tile_units_to_pixels:new t.Uniform1f(J),u_alpha_discard_threshold:new t.Uniform1f(J),u_trim_offset:new t.Uniform2f(J)}),linePattern:J=>({u_matrix:new t.UniformMatrix4f(J),u_texsize:new t.Uniform2f(J),u_pixels_to_tile_units:new t.UniformMatrix2f(J),u_device_pixel_ratio:new t.Uniform1f(J),u_image:new t.Uniform1i(J),u_units_to_pixels:new t.Uniform2f(J),u_tile_units_to_pixels:new t.Uniform1f(J),u_alpha_discard_threshold:new t.Uniform1f(J)}),raster:J=>({u_matrix:new t.UniformMatrix4f(J),u_tl_parent:new t.Uniform2f(J),u_scale_parent:new t.Uniform1f(J),u_fade_t:new t.Uniform1f(J),u_opacity:new t.Uniform1f(J),u_image0:new t.Uniform1i(J),u_image1:new t.Uniform1i(J),u_brightness_low:new t.Uniform1f(J),u_brightness_high:new t.Uniform1f(J),u_saturation_factor:new t.Uniform1f(J),u_contrast_factor:new t.Uniform1f(J),u_spin_weights:new t.Uniform3f(J),u_perspective_transform:new t.Uniform2f(J)}),symbolIcon:J=>({u_is_size_zoom_constant:new t.Uniform1i(J),u_is_size_feature_constant:new t.Uniform1i(J),u_size_t:new t.Uniform1f(J),u_size:new t.Uniform1f(J),u_camera_to_center_distance:new t.Uniform1f(J),u_rotate_symbol:new t.Uniform1i(J),u_aspect_ratio:new t.Uniform1f(J),u_fade_change:new t.Uniform1f(J),u_matrix:new t.UniformMatrix4f(J),u_label_plane_matrix:new t.UniformMatrix4f(J),u_coord_matrix:new t.UniformMatrix4f(J),u_is_text:new t.Uniform1i(J),u_pitch_with_map:new t.Uniform1i(J),u_texsize:new t.Uniform2f(J),u_tile_id:new t.Uniform3f(J),u_zoom_transition:new t.Uniform1f(J),u_inv_rot_matrix:new t.UniformMatrix4f(J),u_merc_center:new t.Uniform2f(J),u_camera_forward:new t.Uniform3f(J),u_tile_matrix:new t.UniformMatrix4f(J),u_up_vector:new t.Uniform3f(J),u_ecef_origin:new t.Uniform3f(J),u_texture:new t.Uniform1i(J)}),symbolSDF:J=>({u_is_size_zoom_constant:new t.Uniform1i(J),u_is_size_feature_constant:new t.Uniform1i(J),u_size_t:new t.Uniform1f(J),u_size:new t.Uniform1f(J),u_camera_to_center_distance:new t.Uniform1f(J),u_rotate_symbol:new t.Uniform1i(J),u_aspect_ratio:new t.Uniform1f(J),u_fade_change:new t.Uniform1f(J),u_matrix:new t.UniformMatrix4f(J),u_label_plane_matrix:new t.UniformMatrix4f(J),u_coord_matrix:new t.UniformMatrix4f(J),u_is_text:new t.Uniform1i(J),u_pitch_with_map:new t.Uniform1i(J),u_texsize:new t.Uniform2f(J),u_texture:new t.Uniform1i(J),u_gamma_scale:new t.Uniform1f(J),u_device_pixel_ratio:new t.Uniform1f(J),u_tile_id:new t.Uniform3f(J),u_zoom_transition:new t.Uniform1f(J),u_inv_rot_matrix:new t.UniformMatrix4f(J),u_merc_center:new t.Uniform2f(J),u_camera_forward:new t.Uniform3f(J),u_tile_matrix:new t.UniformMatrix4f(J),u_up_vector:new t.Uniform3f(J),u_ecef_origin:new t.Uniform3f(J),u_is_halo:new t.Uniform1i(J)}),symbolTextAndIcon:J=>({u_is_size_zoom_constant:new t.Uniform1i(J),u_is_size_feature_constant:new t.Uniform1i(J),u_size_t:new t.Uniform1f(J),u_size:new t.Uniform1f(J),u_camera_to_center_distance:new t.Uniform1f(J),u_rotate_symbol:new t.Uniform1i(J),u_aspect_ratio:new t.Uniform1f(J),u_fade_change:new t.Uniform1f(J),u_matrix:new t.UniformMatrix4f(J),u_label_plane_matrix:new t.UniformMatrix4f(J),u_coord_matrix:new t.UniformMatrix4f(J),u_is_text:new t.Uniform1i(J),u_pitch_with_map:new t.Uniform1i(J),u_texsize:new t.Uniform2f(J),u_texsize_icon:new t.Uniform2f(J),u_texture:new t.Uniform1i(J),u_texture_icon:new t.Uniform1i(J),u_gamma_scale:new t.Uniform1f(J),u_device_pixel_ratio:new t.Uniform1f(J),u_is_halo:new t.Uniform1i(J)}),background:J=>({u_matrix:new t.UniformMatrix4f(J),u_opacity:new t.Uniform1f(J),u_color:new t.UniformColor(J)}),backgroundPattern:J=>({u_matrix:new t.UniformMatrix4f(J),u_opacity:new t.Uniform1f(J),u_image:new t.Uniform1i(J),u_pattern_tl:new t.Uniform2f(J),u_pattern_br:new t.Uniform2f(J),u_texsize:new t.Uniform2f(J),u_pattern_size:new t.Uniform2f(J),u_pixel_coord_upper:new t.Uniform2f(J),u_pixel_coord_lower:new t.Uniform2f(J),u_tile_units_to_pixels:new t.Uniform1f(J)}),terrainRaster:Du,terrainDepth:Du,skybox:J=>({u_matrix:new t.UniformMatrix4f(J),u_sun_direction:new t.Uniform3f(J),u_cubemap:new t.Uniform1i(J),u_opacity:new t.Uniform1f(J),u_temporal_offset:new t.Uniform1f(J)}),skyboxGradient:J=>({u_matrix:new t.UniformMatrix4f(J),u_color_ramp:new t.Uniform1i(J),u_center_direction:new t.Uniform3f(J),u_radius:new t.Uniform1f(J),u_opacity:new t.Uniform1f(J),u_temporal_offset:new t.Uniform1f(J)}),skyboxCapture:J=>({u_matrix_3f:new t.UniformMatrix3f(J),u_sun_direction:new t.Uniform3f(J),u_sun_intensity:new t.Uniform1f(J),u_color_tint_r:new t.Uniform4f(J),u_color_tint_m:new t.Uniform4f(J),u_luminance:new t.Uniform1f(J)}),globeRaster:J=>({u_proj_matrix:new t.UniformMatrix4f(J),u_globe_matrix:new t.UniformMatrix4f(J),u_normalize_matrix:new t.UniformMatrix4f(J),u_merc_matrix:new t.UniformMatrix4f(J),u_zoom_transition:new t.Uniform1f(J),u_merc_center:new t.Uniform2f(J),u_image0:new t.Uniform1i(J),u_grid_matrix:new t.UniformMatrix3f(J),u_skirt_height:new t.Uniform1f(J),u_frustum_tl:new t.Uniform3f(J),u_frustum_tr:new t.Uniform3f(J),u_frustum_br:new t.Uniform3f(J),u_frustum_bl:new t.Uniform3f(J),u_globe_pos:new t.Uniform3f(J),u_globe_radius:new t.Uniform1f(J),u_viewport:new t.Uniform2f(J)}),globeAtmosphere:J=>({u_frustum_tl:new t.Uniform3f(J),u_frustum_tr:new t.Uniform3f(J),u_frustum_br:new t.Uniform3f(J),u_frustum_bl:new t.Uniform3f(J),u_horizon:new t.Uniform1f(J),u_transition:new t.Uniform1f(J),u_fadeout_range:new t.Uniform1f(J),u_color:new t.Uniform4f(J),u_high_color:new t.Uniform4f(J),u_space_color:new t.Uniform4f(J),u_star_intensity:new t.Uniform1f(J),u_star_density:new t.Uniform1f(J),u_star_size:new t.Uniform1f(J),u_temporal_offset:new t.Uniform1f(J),u_horizon_angle:new t.Uniform1f(J),u_rotation_matrix:new t.UniformMatrix4f(J)})};let Fs;function Jo(J,G,Z,re,le,de,me){const ye=J.context,be=ye.gl,qe=J.transform,Te=J.useProgram("collisionBox"),Fe=[];let $e=0,Je=0;for(let ct=0;ct<re.length;ct++){const Tt=re[ct],Rt=G.getTile(Tt),It=Rt.getBucket(Z);if(!It)continue;const kt=$n(Tt,It,qe);let Dt=kt;le[0]===0&&le[1]===0||(Dt=J.translatePosMatrix(kt,Rt,le,de));const Vt=me?It.textCollisionBox:It.iconCollisionBox,mr=It.collisionCircleArray;if(mr.length>0){const Bt=t.create(),nr=Dt;t.mul(Bt,It.placementInvProjMatrix,qe.glCoordMatrix),t.mul(Bt,Bt,It.placementViewportMatrix),Fe.push({circleArray:mr,circleOffset:Je,transform:nr,invTransform:Bt,projection:It.getProjection()}),$e+=mr.length/4,Je=$e}Vt&&(J.terrain&&J.terrain.setupElevationDraw(Rt,Te),Te.draw(ye,be.LINES,t.DepthMode.disabled,t.StencilMode.disabled,J.colorModeForRenderPass(),t.CullFaceMode.disabled,Uu(Dt,qe,Rt,It.getProjection()),Z.id,Vt.layoutVertexBuffer,Vt.indexBuffer,Vt.segments,null,qe.zoom,null,[Vt.collisionVertexBuffer,Vt.collisionVertexBufferExt]))}if(!me||!Fe.length)return;const tt=J.useProgram("collisionCircle"),Qe=new t.StructArrayLayout2f1f2i16;Qe.resize(4*$e),Qe._trim();let it=0;for(const ct of Fe)for(let Tt=0;Tt<ct.circleArray.length/4;Tt++){const Rt=4*Tt,It=ct.circleArray[Rt+0],kt=ct.circleArray[Rt+1],Dt=ct.circleArray[Rt+2],Vt=ct.circleArray[Rt+3];Qe.emplace(it++,It,kt,Dt,Vt,0),Qe.emplace(it++,It,kt,Dt,Vt,1),Qe.emplace(it++,It,kt,Dt,Vt,2),Qe.emplace(it++,It,kt,Dt,Vt,3)}(!Fs||Fs.length<2*$e)&&(Fs=function(ct){const Tt=2*ct,Rt=new t.StructArrayLayout3ui6;Rt.resize(Tt),Rt._trim();for(let It=0;It<Tt;It++){const kt=6*It;Rt.uint16[kt+0]=4*It+0,Rt.uint16[kt+1]=4*It+1,Rt.uint16[kt+2]=4*It+2,Rt.uint16[kt+3]=4*It+2,Rt.uint16[kt+4]=4*It+3,Rt.uint16[kt+5]=4*It+0}return Rt}($e));const Be=ye.createIndexBuffer(Fs,!0),Ye=ye.createVertexBuffer(Qe,t.collisionCircleLayout.members,!0);for(const ct of Fe){const Tt={u_matrix:ct.transform,u_inv_matrix:ct.invTransform,u_camera_to_center_distance:(lt=qe).getCameraToCenterDistance(ct.projection),u_viewport_size:[lt.width,lt.height]};tt.draw(ye,be.TRIANGLES,t.DepthMode.disabled,t.StencilMode.disabled,J.colorModeForRenderPass(),t.CullFaceMode.disabled,Tt,Z.id,Ye,Be,t.SegmentVector.simpleSegment(0,2*ct.circleOffset,ct.circleArray.length,ct.circleArray.length/2),null,qe.zoom)}var lt;Ye.destroy(),Be.destroy()}const uc=t.create();function Zu({width:J,height:G,anchor:Z,textOffset:re,textScale:le},de){const{horizontalAlign:me,verticalAlign:ye}=t.getAnchorAlignment(Z),be=-(me-.5)*J,qe=-(ye-.5)*G,Te=t.evaluateVariableOffset(Z,re);return new t.Point((be/le+Te[0])*de,(qe/le+Te[1])*de)}function Th(J,G,Z,re,le,de,me,ye,be,qe,Te){const Fe=J.text.placedSymbolArray,$e=J.text.dynamicLayoutVertexArray,Je=J.icon.dynamicLayoutVertexArray,tt={},Qe=J.getProjection(),it=Xi(ye,Qe,de),Be=de.elevation,Ye=Qe.upVectorScale(ye.canonical,de.center.lat,de.worldSize).metersToTile;$e.clear();for(let lt=0;lt<Fe.length;lt++){const ct=Fe.get(lt),{tileAnchorX:Tt,tileAnchorY:Rt,numGlyphs:It}=ct,kt=ct.hidden||!ct.crossTileID||J.allowVerticalPlacement&&!ct.placedOrientation?null:re[ct.crossTileID];if(kt){let Dt=0,Vt=0,mr=0;if(Be){const xr=Be?Be.getAtTileOffset(ye,Tt,Rt):0,[Jr,hi,Gr]=Qe.upVector(ye.canonical,Tt,Rt);Dt=xr*Jr*Ye,Vt=xr*hi*Ye,mr=xr*Gr*Ye}let[Bt,nr,Ht,pr]=gn(ct.projectedAnchorX+Dt,ct.projectedAnchorY+Vt,ct.projectedAnchorZ+mr,Z?it:me);const jt=Zl(de.getCameraToCenterDistance(Qe),pr);let ir=le.evaluateSizeForFeature(J.textSizeData,qe,ct)*jt/t.ONE_EM;Z&&(ir*=J.tilePixelRatio/be);const gr=Zu(kt,ir);Z?({x:Bt,y:nr,z:Ht}=Qe.projectTilePoint(Tt+gr.x,Rt+gr.y,ye.canonical),[Bt,nr,Ht]=gn(Bt+Dt,nr+Vt,Ht+mr,me)):(G&&gr._rotate(-de.angle),Bt+=gr.x,nr+=gr.y,Ht=0);const ur=J.allowVerticalPlacement&&ct.placedOrientation===t.WritingMode.vertical?Math.PI/2:0;for(let xr=0;xr<It;xr++)t.addDynamicAttributes($e,Bt,nr,Ht,ur);Te&&ct.associatedIconIndex>=0&&(tt[ct.associatedIconIndex]={x:Bt,y:nr,z:Ht,angle:ur})}else ta(It,$e)}if(Te){Je.clear();const lt=J.icon.placedSymbolArray;for(let ct=0;ct<lt.length;ct++){const Tt=lt.get(ct),{numGlyphs:Rt}=Tt,It=tt[ct];if(Tt.hidden||!It)ta(Rt,Je);else{const{x:kt,y:Dt,z:Vt,angle:mr}=It;for(let Bt=0;Bt<Rt;Bt++)t.addDynamicAttributes(Je,kt,Dt,Vt,mr)}}J.icon.dynamicLayoutVertexBuffer.updateData(Je)}J.text.dynamicLayoutVertexBuffer.updateData($e)}function Ku(J,G,Z){return Z.iconsInText&&G?"symbolTextAndIcon":J?"symbolSDF":"symbolIcon"}function lc(J,G,Z,re,le,de,me,ye,be,qe,Te,Fe){const $e=J.context,Je=$e.gl,tt=J.transform,Qe=ye==="map",it=be==="map",Be=Qe&&Z.layout.get("symbol-placement")!=="point",Ye=Qe&&!it&&!Be,lt=Z.layout.get("symbol-sort-key").constantOr(1)!==void 0;let ct=!1;const Tt=J.depthModeForSublayer(0,t.DepthMode.ReadOnly),Rt=[t.mercatorXfromLng(tt.center.lng),t.mercatorYfromLat(tt.center.lat)],It=Z.layout.get("text-variable-anchor"),kt=tt.projection.name==="globe",Dt=[],Vt=[0,-1,0];let mr=Vt;!kt&&!tt.mercatorFromTransition||Qe||(mr=function(Bt){const nr=Bt._camera.getWorldToCamera(Bt.worldSize,1),Ht=t.multiply([],nr,Bt.globeMatrix);t.invert(Ht,Ht);const pr=[0,0,0],jt=[0,1,0,0];return t.transformMat4$1(jt,jt,Ht),pr[0]=jt[0],pr[1]=jt[1],pr[2]=jt[2],t.normalize(pr,pr),pr}(tt));for(const Bt of re){const nr=G.getTile(Bt),Ht=nr.getBucket(Z);if(!Ht||Ht.projection.name==="mercator"&&kt)continue;const pr=le?Ht.text:Ht.icon;if(!pr||Ht.fullyClipped||!pr.segments.get().length)continue;const jt=pr.programConfigurations.get(Z.id),ir=le||Ht.sdfIcons,gr=le?Ht.textSizeData:Ht.iconSizeData,ur=it||tt.pitch!==0,xr=t.evaluateSizeForZoom(gr,tt.zoom);let Jr,hi,Gr,ii,xi=[0,0],gi=null;if(le)hi=nr.glyphAtlasTexture,Gr=Je.LINEAR,Jr=nr.glyphAtlasTexture.size,Ht.iconsInText&&(xi=nr.imageAtlasTexture.size,gi=nr.imageAtlasTexture,ii=ur||J.options.rotating||J.options.zooming||gr.kind==="composite"||gr.kind==="camera"?Je.LINEAR:Je.NEAREST);else{const Sa=Z.layout.get("icon-size").constantOr(0)!==1||Ht.iconsNeedLinear;hi=nr.imageAtlasTexture,Gr=ir||J.options.rotating||J.options.zooming||Sa||ur?Je.LINEAR:Je.NEAREST,Jr=nr.imageAtlasTexture.size}const Zr=Ht.projection.name==="globe",Pi=Zr?mr:Vt,Di=Zr?t.globeToMercatorTransition(tt.zoom):0,Li=Xi(Bt,Ht.getProjection(),tt),Fi=tt.calculatePixelsToTileUnitsMatrix(nr),An=Yt(Li,nr.tileID.canonical,it,Qe,tt,Ht.getProjection(),Fi),bn=J.terrain&&it&&Be?t.invert(t.create(),An):uc,Kn=ln(Li,nr.tileID.canonical,it,Qe,tt,Ht.getProjection(),Fi),ha=It&&Ht.hasTextData(),Yi=Z.layout.get("icon-text-fit")!=="none"&&ha&&Ht.hasIconData();if(Be){const Sa=tt.elevation,ka=Sa?Sa.getAtTileOffsetFunc(Bt,tt.center.lat,tt.worldSize,Ht.getProjection()):null,to=ma(Li,nr.tileID.canonical,it,Qe,tt,Ht.getProjection(),Fi);xu(Ht,Li,J,le,to,Kn,it,qe,ka,Bt)}const ki=Be||le&&It||Yi,Ri=J.translatePosMatrix(Li,nr,de,me),cn=ki?uc:An,Cn=J.translatePosMatrix(Kn,nr,de,me,!0),Ki=Ht.getProjection().createInversionMatrix(tt,Bt.canonical),Dn=[];J.terrainRenderModeElevated()&&it&&Dn.push("PITCH_WITH_MAP_TERRAIN"),Zr&&Dn.push("PROJECTION_GLOBE_VIEW"),ki&&Dn.push("PROJECTED_POS_ON_VIEWPORT");const Js=ir&&Z.paint.get(le?"text-halo-width":"icon-halo-width").constantOr(1)!==0;let eo;eo=ir?Ht.iconsInText?sc(gr.kind,xr,Ye,it,J,Ri,cn,Cn,Jr,xi,Bt,Di,Rt,Ki,Pi,Ht.getProjection()):Ls(gr.kind,xr,Ye,it,J,Ri,cn,Cn,le,Jr,!0,Bt,Di,Rt,Ki,Pi,Ht.getProjection()):$u(gr.kind,xr,Ye,it,J,Ri,cn,Cn,le,Jr,Bt,Di,Rt,Ki,Pi,Ht.getProjection());const ls={program:J.useProgram(Ku(ir,le,Ht),jt,Dn),buffers:pr,uniformValues:eo,atlasTexture:hi,atlasTextureIcon:gi,atlasInterpolation:Gr,atlasInterpolationIcon:ii,isSDF:ir,hasHalo:Js,tile:nr,labelPlaneMatrixInv:bn};if(lt&&Ht.canOverlap){ct=!0;const Sa=pr.segments.get();for(const ka of Sa)Dt.push({segments:new t.SegmentVector([ka]),sortKey:ka.sortKey,state:ls})}else Dt.push({segments:pr.segments,sortKey:0,state:ls})}ct&&Dt.sort((Bt,nr)=>Bt.sortKey-nr.sortKey);for(const Bt of Dt){const nr=Bt.state;if(J.terrain&&J.terrain.setupElevationDraw(nr.tile,nr.program,{useDepthForOcclusion:!kt,labelPlaneMatrixInv:nr.labelPlaneMatrixInv}),$e.activeTexture.set(Je.TEXTURE0),nr.atlasTexture.bind(nr.atlasInterpolation,Je.CLAMP_TO_EDGE),nr.atlasTextureIcon&&($e.activeTexture.set(Je.TEXTURE1),nr.atlasTextureIcon&&nr.atlasTextureIcon.bind(nr.atlasInterpolationIcon,Je.CLAMP_TO_EDGE)),nr.isSDF){const Ht=nr.uniformValues;nr.hasHalo&&(Ht.u_is_halo=1,Qo(nr.buffers,Bt.segments,Z,J,nr.program,Tt,Te,Fe,Ht)),Ht.u_is_halo=0}Qo(nr.buffers,Bt.segments,Z,J,nr.program,Tt,Te,Fe,nr.uniformValues)}}function Qo(J,G,Z,re,le,de,me,ye,be){const qe=re.context,Te=[J.dynamicLayoutVertexBuffer,J.opacityVertexBuffer,J.globeExtVertexBuffer];le.draw(qe,qe.gl.TRIANGLES,de,me,ye,t.CullFaceMode.disabled,be,Z.id,J.layoutVertexBuffer,J.indexBuffer,G,Z.paint,re.transform.zoom,J.programConfigurations.get(Z.id),Te)}function cc(J,G,Z,re,le,de,me){const ye=J.context.gl,be=Z.paint.get("fill-pattern"),qe=be&&be.constantOr(1);let Te,Fe,$e,Je,tt;me?(Fe=qe&&!Z.getPaintProperty("fill-outline-color")?"fillOutlinePattern":"fillOutline",Te=ye.LINES):(Fe=qe?"fillPattern":"fill",Te=ye.TRIANGLES);for(const Qe of re){const it=G.getTile(Qe);if(qe&&!it.patternsLoaded())continue;const Be=it.getBucket(Z);if(!Be)continue;J.prepareDrawTile();const Ye=Be.programConfigurations.get(Z.id),lt=J.useProgram(Fe,Ye);qe&&(J.context.activeTexture.set(ye.TEXTURE0),it.imageAtlasTexture.bind(ye.LINEAR,ye.CLAMP_TO_EDGE),Ye.updatePaintBuffers());const ct=be.constantOr(null);if(ct&&it.imageAtlas){const Rt=it.imageAtlas.patternPositions[ct.toString()];Rt&&Ye.setConstantPatternPositions(Rt)}const Tt=J.translatePosMatrix(Qe.projMatrix,it,Z.paint.get("fill-translate"),Z.paint.get("fill-translate-anchor"));if(me){Je=Be.indexBuffer2,tt=Be.segments2;const Rt=J.terrain&&J.terrain.renderingToTexture?J.terrain.drapeBufferSize:[ye.drawingBufferWidth,ye.drawingBufferHeight];$e=Fe==="fillOutlinePattern"&&qe?xh(Tt,J,it,Rt):bh(Tt,Rt)}else Je=Be.indexBuffer,tt=Be.segments,$e=qe?zu(Tt,J,it):Xa(Tt);J.prepareDrawProgram(J.context,lt,Qe.toUnwrapped()),lt.draw(J.context,Te,le,J.stencilModeForClipping(Qe),de,t.CullFaceMode.disabled,$e,Z.id,Be.layoutVertexBuffer,Je,tt,Z.paint,J.transform.zoom,Ye)}}function ks(J,G,Z,re,le,de,me){const ye=J.context,be=ye.gl,qe=J.transform,Te=Z.paint.get("fill-extrusion-pattern"),Fe=Te.constantOr(1),$e=Z.paint.get("fill-extrusion-opacity"),Je=[Z.paint.get("fill-extrusion-ambient-occlusion-intensity"),Z.paint.get("fill-extrusion-ambient-occlusion-radius")],tt=Z.layout.get("fill-extrusion-edge-radius"),Qe=tt>0&&!Z.paint.get("fill-extrusion-rounded-roof"),it=Qe?0:tt,Be=qe.projection.name==="globe"?t.fillExtrusionHeightLift():0,Ye=qe.projection.name==="globe",lt=Ye?t.globeToMercatorTransition(qe.zoom):0,ct=[t.mercatorXfromLng(qe.center.lng),t.mercatorYfromLat(qe.center.lat)],Tt=[];Ye&&Tt.push("PROJECTION_GLOBE_VIEW"),Je[0]>0&&Tt.push("FAUX_AO"),Qe&&Tt.push("ZERO_ROOF_RADIUS");for(const Rt of re){const It=G.getTile(Rt),kt=It.getBucket(Z);if(!kt||kt.projection.name!==qe.projection.name)continue;const Dt=kt.programConfigurations.get(Z.id),Vt=J.useProgram(Fe?"fillExtrusionPattern":"fillExtrusion",Dt,Tt);if(J.terrain){const ir=J.terrain;if(J.style.terrainSetForDrapingOnly())ir.setupElevationDraw(It,Vt,{useMeterToDem:!0});else{if(!kt.enableTerrain)continue;if(ir.setupElevationDraw(It,Vt,{useMeterToDem:!0}),hc(ye,G,Rt,kt,Z,ir),!kt.centroidVertexBuffer){const gr=Vt.attributes.a_centroid_pos;gr!==void 0&&be.vertexAttrib2f(gr,0,0)}}}Fe&&(J.context.activeTexture.set(be.TEXTURE0),It.imageAtlasTexture.bind(be.LINEAR,be.CLAMP_TO_EDGE),Dt.updatePaintBuffers());const mr=Te.constantOr(null);if(mr&&It.imageAtlas){const ir=It.imageAtlas.patternPositions[mr.toString()];ir&&Dt.setConstantPatternPositions(ir)}const Bt=J.translatePosMatrix(Rt.projMatrix,It,Z.paint.get("fill-extrusion-translate"),Z.paint.get("fill-extrusion-translate-anchor")),nr=qe.projection.createInversionMatrix(qe,Rt.canonical),Ht=Z.paint.get("fill-extrusion-vertical-gradient"),pr=Fe?nc(Bt,J,Ht,$e,Je,it,Rt,It,Be,lt,ct,nr):Bu(Bt,J,Ht,$e,Je,it,Rt,Be,lt,ct,nr);J.prepareDrawProgram(ye,Vt,Rt.toUnwrapped());const jt=[];J.terrain&&jt.push(kt.centroidVertexBuffer),Ye&&jt.push(kt.layoutVertexExtBuffer),Vt.draw(ye,ye.gl.TRIANGLES,le,de,me,t.CullFaceMode.backCCW,pr,Z.id,kt.layoutVertexBuffer,kt.indexBuffer,kt.segments,Z.paint,J.transform.zoom,Dt,jt)}}function hc(J,G,Z,re,le,de){const me=[Be=>{let Ye=Be.canonical.x-1,lt=Be.wrap;return Ye<0&&(Ye=(1<<Be.canonical.z)-1,lt--),new t.OverscaledTileID(Be.overscaledZ,lt,Be.canonical.z,Ye,Be.canonical.y)},Be=>{let Ye=Be.canonical.x+1,lt=Be.wrap;return Ye===1<<Be.canonical.z&&(Ye=0,lt++),new t.OverscaledTileID(Be.overscaledZ,lt,Be.canonical.z,Ye,Be.canonical.y)},Be=>new t.OverscaledTileID(Be.overscaledZ,Be.wrap,Be.canonical.z,Be.canonical.x,(Be.canonical.y===0?1<<Be.canonical.z:Be.canonical.y)-1),Be=>new t.OverscaledTileID(Be.overscaledZ,Be.wrap,Be.canonical.z,Be.canonical.x,Be.canonical.y===(1<<Be.canonical.z)-1?0:Be.canonical.y+1)],ye=Be=>{const Ye=G.getSource().minzoom,lt=Tt=>{const Rt=G.getTileByID(Tt);if(Rt&&Rt.hasData())return Rt.getBucket(le)},ct=[0,-1,1];for(const Tt of ct){if(Be.overscaledZ+Tt<Ye)continue;const Rt=lt(Be.calculateScaledKey(Be.overscaledZ+Tt));if(Rt)return Rt}},be=[0,0,0],qe=(Be,Ye)=>(be[0]=Math.min(Be.min.y,Ye.min.y),be[1]=Math.max(Be.max.y,Ye.max.y),be[2]=t.EXTENT-Ye.min.x>Be.max.x?Ye.min.x-t.EXTENT:Be.max.x,be),Te=(Be,Ye)=>(be[0]=Math.min(Be.min.x,Ye.min.x),be[1]=Math.max(Be.max.x,Ye.max.x),be[2]=t.EXTENT-Ye.min.y>Be.max.y?Ye.min.y-t.EXTENT:Be.max.y,be),Fe=[(Be,Ye)=>qe(Be,Ye),(Be,Ye)=>qe(Ye,Be),(Be,Ye)=>Te(Be,Ye),(Be,Ye)=>Te(Ye,Be)],$e=new t.Point(0,0);let Je,tt,Qe;const it=(Be,Ye,lt,ct,Tt)=>{const Rt=[[ct?lt:Be,ct?Be:lt,0],[ct?lt:Ye,ct?Ye:lt,0]],It=Tt<0?t.EXTENT+Tt:Tt,kt=[ct?It:(Be+Ye)/2,ct?(Be+Ye)/2:It,0];return lt===0&&Tt<0||lt!==0&&Tt>0?de.getForTilePoints(Qe,[kt],!0,tt):Rt.push(kt),de.getForTilePoints(Z,Rt,!0,Je),Math.max(Rt[0][2],Rt[1][2],kt[2])/de.exaggeration()};for(let Be=0;Be<4;Be++){const Ye=(Be<2?1:5)-Be,lt=re.borders[Be];if(lt.length===0)continue;const ct=Qe=me[Be](Z),Tt=ye(ct);if(!(Tt&&Tt instanceof t.FillExtrusionBucket&&Tt.enableTerrain)||re.borderDoneWithNeighborZ[Be]===Tt.canonical.z&&Tt.borderDoneWithNeighborZ[Ye]===re.canonical.z||(tt=de.findDEMTileFor(ct),!tt||!tt.dem))continue;if(!Je){const Dt=de.findDEMTileFor(Z);if(!Dt||!Dt.dem)return;Je=Dt}const Rt=Tt.borders[Ye];let It=0;const kt=Tt.borderDoneWithNeighborZ[Ye]!==re.canonical.z;if(re.canonical.z===Tt.canonical.z){for(let Dt=0;Dt<lt.length;Dt++){const Vt=re.featuresOnBorder[lt[Dt]],mr=Vt.borders[Be];let Bt;for(;It<Rt.length&&(Bt=Tt.featuresOnBorder[Rt[It]],!(Bt.borders[Ye][1]>mr[0]+3));)kt&&Tt.encodeCentroid(void 0,Bt,!1),It++;if(Bt&&It<Rt.length){const nr=It;let Ht=0;for(;!(Bt.borders[Ye][0]>mr[1]-3)&&(Ht++,++It!==Rt.length);)Bt=Tt.featuresOnBorder[Rt[It]];if(Bt=Tt.featuresOnBorder[Rt[nr]],Vt.intersectsCount()>1||Bt.intersectsCount()>1||Ht!==1){Ht!==1&&(It=nr),re.encodeCentroid(void 0,Vt,!1),kt&&Tt.encodeCentroid(void 0,Bt,!1);continue}const pr=Fe[Be](Vt,Bt),jt=Be%2?t.EXTENT-1:0;$e.x=it(pr[0],Math.min(t.EXTENT-1,pr[1]),jt,Be<2,pr[2]),$e.y=0,re.encodeCentroid($e,Vt,!1),kt&&Tt.encodeCentroid($e,Bt,!1)}else re.encodeCentroid(void 0,Vt,!1)}re.borderDoneWithNeighborZ[Be]=Tt.canonical.z,re.needsCentroidUpdate=!0,kt&&(Tt.borderDoneWithNeighborZ[Ye]=re.canonical.z,Tt.needsCentroidUpdate=!0)}else{for(const Dt of lt)re.encodeCentroid(void 0,re.featuresOnBorder[Dt],!1);if(kt){for(const Dt of Rt)Tt.encodeCentroid(void 0,Tt.featuresOnBorder[Dt],!1);Tt.borderDoneWithNeighborZ[Ye]=re.canonical.z,Tt.needsCentroidUpdate=!0}re.borderDoneWithNeighborZ[Be]=Tt.canonical.z,re.needsCentroidUpdate=!0}}(re.needsCentroidUpdate||!re.centroidVertexBuffer&&re.centroidVertexArray.length!==0)&&re.uploadCentroid(J)}const go=new t.Color(1,0,0,1),qh=new t.Color(0,1,0,1),Ih=new t.Color(0,0,1,1),Ah=new t.Color(1,0,1,1),Rh=new t.Color(0,1,1,1);function Oh(J,G,Z){const re=J.context,le=J.transform,de=re.gl,me=le.projection.name==="globe",ye=me?["PROJECTION_GLOBE_VIEW"]:null;let be=Z.projMatrix;if(me&&t.globeToMercatorTransition(le.zoom)>0){const Vt=t.transitionTileAABBinECEF(Z.canonical,le),mr=t.globeDenormalizeECEF(Vt);be=t.multiply(new Float32Array(16),le.globeMatrix,mr),t.multiply(be,le.projMatrix,be)}const qe=J.useProgram("debug",null,ye),Te=G.getTileByID(Z.key);J.terrain&&J.terrain.setupElevationDraw(Te,qe);const Fe=t.DepthMode.disabled,$e=t.StencilMode.disabled,Je=J.colorModeForRenderPass(),tt="$debug";re.activeTexture.set(de.TEXTURE0),J.emptyTexture.bind(de.LINEAR,de.CLAMP_TO_EDGE),me?Te._makeGlobeTileDebugBuffers(J.context,le):Te._makeDebugTileBoundsBuffers(J.context,le.projection);const Qe=Te._tileDebugBuffer||J.debugBuffer,it=Te._tileDebugIndexBuffer||J.debugIndexBuffer,Be=Te._tileDebugSegments||J.debugSegments;qe.draw(re,de.LINE_STRIP,Fe,$e,Je,t.CullFaceMode.disabled,Ms(be,t.Color.red),tt,Qe,it,Be,null,null,null,[Te._globeTileDebugBorderBuffer]);const Ye=Te.latestRawTileData,lt=Math.floor((Ye&&Ye.byteLength||0)/1024),ct=G.getTile(Z).tileSize,Tt=512/Math.min(ct,512)*(Z.overscaledZ/le.zoom)*.5;let Rt=Z.canonical.toString();Z.overscaledZ!==Z.canonical.z&&(Rt+=` => ${Z.overscaledZ}`),Rt+=` ${lt}kb`,function(Vt,mr){Vt.initDebugOverlayCanvas();const Bt=Vt.debugOverlayCanvas,nr=Vt.context.gl,Ht=Vt.debugOverlayCanvas.getContext("2d");Ht.clearRect(0,0,Bt.width,Bt.height),Ht.shadowColor="white",Ht.shadowBlur=2,Ht.lineWidth=1.5,Ht.strokeStyle="white",Ht.textBaseline="top",Ht.font="bold 36px Open Sans, sans-serif",Ht.fillText(mr,5,5),Ht.strokeText(mr,5,5),Vt.debugOverlayTexture.update(Bt),Vt.debugOverlayTexture.bind(nr.LINEAR,nr.CLAMP_TO_EDGE)}(J,Rt);const It=Te._tileDebugTextBuffer||J.debugBuffer,kt=Te._tileDebugTextIndexBuffer||J.quadTriangleIndexBuffer,Dt=Te._tileDebugTextSegments||J.debugSegments;qe.draw(re,de.TRIANGLES,Fe,$e,t.ColorMode.alphaBlended,t.CullFaceMode.disabled,Ms(be,t.Color.transparent,Tt),tt,It,kt,Dt,null,null,null,[Te._globeTileDebugTextBuffer])}function dc(J,G,Z,re){vo(J,0,G+Z/2,J.transform.width,Z,re)}function Bs(J,G,Z,re){vo(J,G-Z/2,0,Z,J.transform.height,re)}function vo(J,G,Z,re,le,de){const me=J.context,ye=me.gl;ye.enable(ye.SCISSOR_TEST),ye.scissor(G*t.exported.devicePixelRatio,Z*t.exported.devicePixelRatio,re*t.exported.devicePixelRatio,le*t.exported.devicePixelRatio),me.clear({color:de}),ye.disable(ye.SCISSOR_TEST)}const fc=t.createLayout([{name:"a_pos_3f",components:3,type:"Float32"}]),{members:pc}=fc;function Ea(J,G,Z,re){J.emplaceBack(G,Z,re)}class zs{constructor(G){this.vertexArray=new t.StructArrayLayout3f12,this.indices=new t.StructArrayLayout3ui6,Ea(this.vertexArray,-1,-1,1),Ea(this.vertexArray,1,-1,1),Ea(this.vertexArray,-1,1,1),Ea(this.vertexArray,1,1,1),Ea(this.vertexArray,-1,-1,-1),Ea(this.vertexArray,1,-1,-1),Ea(this.vertexArray,-1,1,-1),Ea(this.vertexArray,1,1,-1),this.indices.emplaceBack(5,1,3),this.indices.emplaceBack(3,7,5),this.indices.emplaceBack(6,2,0),this.indices.emplaceBack(0,4,6),this.indices.emplaceBack(2,6,7),this.indices.emplaceBack(7,3,2),this.indices.emplaceBack(5,4,0),this.indices.emplaceBack(0,1,5),this.indices.emplaceBack(0,2,3),this.indices.emplaceBack(3,1,0),this.indices.emplaceBack(7,6,4),this.indices.emplaceBack(4,5,7),this.vertexBuffer=G.createVertexBuffer(this.vertexArray,pc),this.indexBuffer=G.createIndexBuffer(this.indices),this.segment=t.SegmentVector.simpleSegment(0,0,36,12)}}function Hn(J,G,Z,re,le,de){const me=J.gl,ye=G.paint.get("sky-atmosphere-color"),be=G.paint.get("sky-atmosphere-halo-color"),qe=G.paint.get("sky-atmosphere-sun-intensity"),Te=((Fe,$e,Je,tt,Qe)=>({u_matrix_3f:Fe,u_sun_direction:$e,u_sun_intensity:Je,u_color_tint_r:[tt.r,tt.g,tt.b,tt.a],u_color_tint_m:[Qe.r,Qe.g,Qe.b,Qe.a],u_luminance:5e-5}))(t.fromMat4(t.create$1(),re),le,qe,ye,be);me.framebufferTexture2D(me.FRAMEBUFFER,me.COLOR_ATTACHMENT0,me.TEXTURE_CUBE_MAP_POSITIVE_X+de,G.skyboxTexture,0),Z.draw(J,me.TRIANGLES,t.DepthMode.disabled,t.StencilMode.disabled,t.ColorMode.unblended,t.CullFaceMode.frontCW,Te,"skyboxCapture",G.skyboxGeometry.vertexBuffer,G.skyboxGeometry.indexBuffer,G.skyboxGeometry.segment)}const es=t.createLayout([{type:"Float32",name:"a_pos",components:3},{type:"Float32",name:"a_uv",components:2}]);class _c{constructor(G){const Z=new t.StructArrayLayout5f20;Z.emplaceBack(-1,1,1,0,0),Z.emplaceBack(1,1,1,1,0),Z.emplaceBack(1,-1,1,1,1),Z.emplaceBack(-1,-1,1,0,1);const re=new t.StructArrayLayout3ui6;re.emplaceBack(0,1,2),re.emplaceBack(2,3,0),this.vertexBuffer=G.createVertexBuffer(Z,es.members),this.indexBuffer=G.createIndexBuffer(re),this.segments=t.SegmentVector.simpleSegment(0,0,4,2)}destroy(){this.vertexBuffer.destroy(),this.indexBuffer.destroy(),this.segments.destroy()}}const Ya={symbol:function(J,G,Z,re,le){if(J.renderPass!=="translucent")return;const de=t.StencilMode.disabled,me=J.colorModeForRenderPass();Z.layout.get("text-variable-anchor")&&function(ye,be,qe,Te,Fe,$e,Je){const tt=be.transform,Qe=Fe==="map",it=$e==="map";for(const Be of ye){const Ye=Te.getTile(Be),lt=Ye.getBucket(qe);if(!lt||!lt.text||!lt.text.segments.get().length)continue;const ct=t.evaluateSizeForZoom(lt.textSizeData,tt.zoom),Tt=Xi(Be,lt.getProjection(),tt),Rt=tt.calculatePixelsToTileUnitsMatrix(Ye),It=Yt(Tt,Ye.tileID.canonical,it,Qe,tt,lt.getProjection(),Rt),kt=qe.layout.get("icon-text-fit")!=="none"&&lt.hasIconData();if(ct){const Dt=Math.pow(2,tt.zoom-Ye.tileID.overscaledZ);Th(lt,Qe,it,Je,t.symbolSize,tt,It,Be,Dt,ct,kt)}}}(re,J,Z,G,Z.layout.get("text-rotation-alignment"),Z.layout.get("text-pitch-alignment"),le),Z.paint.get("icon-opacity").constantOr(1)!==0&&lc(J,G,Z,re,!1,Z.paint.get("icon-translate"),Z.paint.get("icon-translate-anchor"),Z.layout.get("icon-rotation-alignment"),Z.layout.get("icon-pitch-alignment"),Z.layout.get("icon-keep-upright"),de,me),Z.paint.get("text-opacity").constantOr(1)!==0&&lc(J,G,Z,re,!0,Z.paint.get("text-translate"),Z.paint.get("text-translate-anchor"),Z.layout.get("text-rotation-alignment"),Z.layout.get("text-pitch-alignment"),Z.layout.get("text-keep-upright"),de,me),G.map.showCollisionBoxes&&(Jo(J,G,Z,re,Z.paint.get("text-translate"),Z.paint.get("text-translate-anchor"),!0),Jo(J,G,Z,re,Z.paint.get("icon-translate"),Z.paint.get("icon-translate-anchor"),!1))},circle:function(J,G,Z,re){if(J.renderPass!=="translucent")return;const le=Z.paint.get("circle-opacity"),de=Z.paint.get("circle-stroke-width"),me=Z.paint.get("circle-stroke-opacity"),ye=Z.layout.get("circle-sort-key").constantOr(1)!==void 0;if(le.constantOr(1)===0&&(de.constantOr(1)===0||me.constantOr(1)===0))return;const be=J.context,qe=be.gl,Te=J.transform,Fe=J.depthModeForSublayer(0,t.DepthMode.ReadOnly),$e=t.StencilMode.disabled,Je=J.colorModeForRenderPass(),tt=Te.projection.name==="globe",Qe=[t.mercatorXfromLng(Te.center.lng),t.mercatorYfromLat(Te.center.lat)],it=[];for(let Ye=0;Ye<re.length;Ye++){const lt=re[Ye],ct=G.getTile(lt),Tt=ct.getBucket(Z);if(!Tt||Tt.projection.name!==Te.projection.name)continue;const Rt=Tt.programConfigurations.get(Z.id),It=ju(Z);tt&&It.push("PROJECTION_GLOBE_VIEW");const kt=J.useProgram("circle",Rt,It),Dt=Tt.layoutVertexBuffer,Vt=Tt.globeExtVertexBuffer,mr=Tt.indexBuffer,Bt=Te.projection.createInversionMatrix(Te,lt.canonical),nr={programConfiguration:Rt,program:kt,layoutVertexBuffer:Dt,globeExtVertexBuffer:Vt,indexBuffer:mr,uniformValues:Nu(J,lt,ct,Bt,Qe,Z),tile:ct};if(ye){const Ht=Tt.segments.get();for(const pr of Ht)it.push({segments:new t.SegmentVector([pr]),sortKey:pr.sortKey,state:nr})}else it.push({segments:Tt.segments,sortKey:0,state:nr})}ye&&it.sort((Ye,lt)=>Ye.sortKey-lt.sortKey);const Be={useDepthForOcclusion:!tt};for(const Ye of it){const{programConfiguration:lt,program:ct,layoutVertexBuffer:Tt,globeExtVertexBuffer:Rt,indexBuffer:It,uniformValues:kt,tile:Dt}=Ye.state,Vt=Ye.segments;J.terrain&&J.terrain.setupElevationDraw(Dt,ct,Be),J.prepareDrawProgram(be,ct,Dt.tileID.toUnwrapped()),ct.draw(be,qe.TRIANGLES,Fe,$e,Je,t.CullFaceMode.disabled,kt,Z.id,Tt,It,Vt,Z.paint,Te.zoom,lt,[Rt])}},heatmap:function(J,G,Z,re){if(Z.paint.get("heatmap-opacity")!==0)if(J.renderPass==="offscreen"){const le=J.context,de=le.gl,me=t.StencilMode.disabled,ye=new t.ColorMode([de.ONE,de.ONE],t.Color.transparent,[!0,!0,!0,!0]);(function(Je,tt,Qe,it){const Be=Je.gl,Ye=tt.width*it,lt=tt.height*it;Je.activeTexture.set(Be.TEXTURE1),Je.viewport.set([0,0,Ye,lt]);let ct=Qe.heatmapFbo;if(!ct||ct&&(ct.width!==Ye||ct.height!==lt)){ct&&ct.destroy();const Tt=Be.createTexture();Be.bindTexture(Be.TEXTURE_2D,Tt),Be.texParameteri(Be.TEXTURE_2D,Be.TEXTURE_WRAP_S,Be.CLAMP_TO_EDGE),Be.texParameteri(Be.TEXTURE_2D,Be.TEXTURE_WRAP_T,Be.CLAMP_TO_EDGE),Be.texParameteri(Be.TEXTURE_2D,Be.TEXTURE_MIN_FILTER,Be.LINEAR),Be.texParameteri(Be.TEXTURE_2D,Be.TEXTURE_MAG_FILTER,Be.LINEAR),ct=Qe.heatmapFbo=Je.createFramebuffer(Ye,lt,!1),function(Rt,It,kt,Dt,Vt,mr){const Bt=Rt.gl;Bt.texImage2D(Bt.TEXTURE_2D,0,Rt.isWebGL2&&Rt.extRenderToTextureHalfFloat?Bt.RGBA16F:Bt.RGBA,Vt,mr,0,Bt.RGBA,Rt.extRenderToTextureHalfFloat?Rt.isWebGL2?Bt.HALF_FLOAT:Rt.extTextureHalfFloat.HALF_FLOAT_OES:Bt.UNSIGNED_BYTE,null),Dt.colorAttachment.set(kt)}(Je,0,Tt,ct,Ye,lt)}else Be.bindTexture(Be.TEXTURE_2D,ct.colorAttachment.get()),Je.bindFramebuffer.set(ct.framebuffer)})(le,J,Z,J.transform.projection.name==="globe"?.5:.25),le.clear({color:t.Color.transparent});const be=J.transform,qe=be.projection.name==="globe",Te=qe?["PROJECTION_GLOBE_VIEW"]:null,Fe=qe?t.CullFaceMode.frontCCW:t.CullFaceMode.disabled,$e=[t.mercatorXfromLng(be.center.lng),t.mercatorYfromLat(be.center.lat)];for(let Je=0;Je<re.length;Je++){const tt=re[Je];if(G.hasRenderableParent(tt))continue;const Qe=G.getTile(tt),it=Qe.getBucket(Z);if(!it||it.projection.name!==be.projection.name)continue;const Be=it.programConfigurations.get(Z.id),Ye=J.useProgram("heatmap",Be,Te),{zoom:lt}=J.transform;J.terrain&&J.terrain.setupElevationDraw(Qe,Ye),J.prepareDrawProgram(le,Ye,tt.toUnwrapped());const ct=be.projection.createInversionMatrix(be,tt.canonical);Ye.draw(le,de.TRIANGLES,t.DepthMode.disabled,me,ye,Fe,oc(J,tt,Qe,ct,$e,lt,Z.paint.get("heatmap-intensity")),Z.id,it.layoutVertexBuffer,it.indexBuffer,it.segments,Z.paint,J.transform.zoom,Be,qe?[it.globeExtVertexBuffer]:null)}le.viewport.set([0,0,J.width,J.height])}else J.renderPass==="translucent"&&(J.context.setColorMode(J.colorModeForRenderPass()),function(le,de){const me=le.context,ye=me.gl,be=de.heatmapFbo;if(!be)return;me.activeTexture.set(ye.TEXTURE0),ye.bindTexture(ye.TEXTURE_2D,be.colorAttachment.get()),me.activeTexture.set(ye.TEXTURE1);let qe=de.colorRampTexture;qe||(qe=de.colorRampTexture=new t.Texture(me,de.colorRamp,ye.RGBA)),qe.bind(ye.LINEAR,ye.CLAMP_TO_EDGE),le.useProgram("heatmapTexture").draw(me,ye.TRIANGLES,t.DepthMode.disabled,t.StencilMode.disabled,le.colorModeForRenderPass(),t.CullFaceMode.disabled,((Te,Fe,$e,Je)=>({u_image:0,u_color_ramp:1,u_opacity:Fe.paint.get("heatmap-opacity")}))(0,de),de.id,le.viewportBuffer,le.quadTriangleIndexBuffer,le.viewportSegments,de.paint,le.transform.zoom)}(J,Z))},line:function(J,G,Z,re){if(J.renderPass!=="translucent")return;const le=Z.paint.get("line-opacity"),de=Z.paint.get("line-width");if(le.constantOr(1)===0||de.constantOr(1)===0)return;const me=J.depthModeForSublayer(0,t.DepthMode.ReadOnly),ye=J.colorModeForRenderPass(),be=J.terrain&&J.terrain.renderingToTexture?1:t.exported.devicePixelRatio,qe=Z.paint.get("line-dasharray"),Te=qe.constantOr(1),Fe=Z.layout.get("line-cap"),$e=Z.paint.get("line-pattern"),Je=$e.constantOr(1),tt=Z.paint.get("line-gradient"),Qe=Je?"linePattern":"line",it=J.context,Be=it.gl,Ye=(ct=>{const Tt=[];Yo(ct)&&Tt.push("RENDER_LINE_DASH"),ct.paint.get("line-gradient")&&Tt.push("RENDER_LINE_GRADIENT");const Rt=ct.paint.get("line-trim-offset");Rt[0]===0&&Rt[1]===0||Tt.push("RENDER_LINE_TRIM_OFFSET");const It=ct.paint.get("line-pattern").constantOr(1),kt=ct.paint.get("line-opacity").constantOr(1)!==1;return!It&&kt&&Tt.push("RENDER_LINE_ALPHA_DISCARD"),Tt})(Z);let lt=Ye.includes("RENDER_LINE_ALPHA_DISCARD");J.terrain&&J.terrain.clipOrMaskOverlapStencilType()&&(lt=!1);for(const ct of re){const Tt=G.getTile(ct);if(Je&&!Tt.patternsLoaded())continue;const Rt=Tt.getBucket(Z);if(!Rt)continue;J.prepareDrawTile();const It=Rt.programConfigurations.get(Z.id),kt=J.useProgram(Qe,It,Ye),Dt=$e.constantOr(null);if(Dt&&Tt.imageAtlas){const ir=Tt.imageAtlas.patternPositions[Dt.toString()];ir&&It.setConstantPatternPositions(ir)}const Vt=qe.constantOr(null),mr=Fe.constantOr(null);if(!Je&&Vt&&mr&&Tt.lineAtlas){const ir=Tt.lineAtlas.getDash(Vt,mr);ir&&It.setConstantPatternPositions(ir)}let[Bt,nr]=Z.paint.get("line-trim-offset");(mr==="round"||mr==="square")&&Bt!==nr&&(Bt===0&&(Bt-=1),nr===1&&(nr+=1));const Ht=J.terrain?ct.projMatrix:null,pr=Je?Xo(J,Tt,Z,Ht,be):wh(J,Tt,Z,Ht,Rt.lineClipsArray.length,be,[Bt,nr]);if(tt){const ir=Rt.gradients[Z.id];let gr=ir.texture;if(Z.gradientVersion!==ir.version){let ur=256;if(Z.stepInterpolant){const xr=G.getSource().maxzoom,Jr=ct.canonical.z===xr?Math.ceil(1<<J.transform.maxZoom-ct.canonical.z):1;ur=t.clamp(t.nextPowerOfTwo(Rt.maxLineLength/t.EXTENT*1024*Jr),256,it.maxTextureSize)}ir.gradient=t.renderColorRamp({expression:Z.gradientExpression(),evaluationKey:"lineProgress",resolution:ur,image:ir.gradient||void 0,clips:Rt.lineClipsArray}),ir.texture?ir.texture.update(ir.gradient):ir.texture=new t.Texture(it,ir.gradient,Be.RGBA),ir.version=Z.gradientVersion,gr=ir.texture}it.activeTexture.set(Be.TEXTURE1),gr.bind(Z.stepInterpolant?Be.NEAREST:Be.LINEAR,Be.CLAMP_TO_EDGE)}Te&&(it.activeTexture.set(Be.TEXTURE0),Tt.lineAtlasTexture.bind(Be.LINEAR,Be.REPEAT),It.updatePaintBuffers()),Je&&(it.activeTexture.set(Be.TEXTURE0),Tt.imageAtlasTexture.bind(Be.LINEAR,Be.CLAMP_TO_EDGE),It.updatePaintBuffers()),J.prepareDrawProgram(it,kt,ct.toUnwrapped());const jt=ir=>{kt.draw(it,Be.TRIANGLES,me,ir,ye,t.CullFaceMode.disabled,pr,Z.id,Rt.layoutVertexBuffer,Rt.indexBuffer,Rt.segments,Z.paint,J.transform.zoom,It,[Rt.layoutVertexBuffer2])};if(lt){const ir=J.stencilModeForClipping(ct).ref;ir===0&&J.terrain&&it.clear({stencil:0});const gr={func:Be.EQUAL,mask:255};pr.u_alpha_discard_threshold=.8,jt(new t.StencilMode(gr,ir,255,Be.KEEP,Be.KEEP,Be.INVERT)),pr.u_alpha_discard_threshold=0,jt(new t.StencilMode(gr,ir,255,Be.KEEP,Be.KEEP,Be.KEEP))}else jt(J.stencilModeForClipping(ct))}lt&&(J.resetStencilClippingMasks(),J.terrain&&it.clear({stencil:0}))},fill:function(J,G,Z,re){const le=Z.paint.get("fill-color"),de=Z.paint.get("fill-opacity");if(de.constantOr(1)===0)return;const me=J.colorModeForRenderPass(),ye=Z.paint.get("fill-pattern"),be=J.opaquePassEnabledForLayer()&&!ye.constantOr(1)&&le.constantOr(t.Color.transparent).a===1&&de.constantOr(0)===1?"opaque":"translucent";if(J.renderPass===be){const qe=J.depthModeForSublayer(1,J.renderPass==="opaque"?t.DepthMode.ReadWrite:t.DepthMode.ReadOnly);cc(J,G,Z,re,qe,me,!1)}if(J.renderPass==="translucent"&&Z.paint.get("fill-antialias")){const qe=J.depthModeForSublayer(Z.getPaintProperty("fill-outline-color")?2:0,t.DepthMode.ReadOnly);cc(J,G,Z,re,qe,me,!0)}},"fill-extrusion":function(J,G,Z,re){const le=Z.paint.get("fill-extrusion-opacity");if(le!==0&&J.renderPass==="translucent"){const de=new t.DepthMode(J.context.gl.LEQUAL,t.DepthMode.ReadWrite,J.depthRangeFor3D);if(le!==1||Z.paint.get("fill-extrusion-pattern").constantOr(1))ks(J,G,Z,re,de,t.StencilMode.disabled,t.ColorMode.disabled),ks(J,G,Z,re,de,J.stencilModeFor3D(),J.colorModeForRenderPass()),J.resetStencilClippingMasks();else{const me=J.colorModeForRenderPass();ks(J,G,Z,re,de,t.StencilMode.disabled,me)}}},hillshade:function(J,G,Z,re){if(J.renderPass!=="offscreen"&&J.renderPass!=="translucent")return;const le=J.context,de=J.depthModeForSublayer(0,t.DepthMode.ReadOnly),me=J.colorModeForRenderPass(),ye=J.terrain&&J.terrain.renderingToTexture,[be,qe]=J.renderPass!=="translucent"||ye?[{},re]:J.stencilConfigForOverlap(re);for(const Te of qe){const Fe=G.getTile(Te);if(Fe.needsHillshadePrepare&&J.renderPass==="offscreen")tc(J,Fe,Z,de,t.StencilMode.disabled,me);else if(J.renderPass==="translucent"){const $e=ye&&J.terrain?J.terrain.stencilModeForRTTOverlap(Te):be[Te.overscaledZ];ec(J,Te,Fe,Z,de,$e,me)}}le.viewport.set([0,0,J.width,J.height]),J.resetStencilClippingMasks()},raster:function(J,G,Z,re,le,de){if(J.renderPass!=="translucent"||Z.paint.get("raster-opacity")===0||!re.length)return;const me=J.context,ye=me.gl,be=G.getSource(),qe=J.useProgram("raster"),Te=J.colorModeForRenderPass(),Fe=J.terrain&&J.terrain.renderingToTexture,[$e,Je]=be instanceof ci||Fe?[{},re]:J.stencilConfigForOverlap(re),tt=Je[Je.length-1].overscaledZ,Qe=!J.options.moving;for(const it of Je){const Be=Fe?t.DepthMode.disabled:J.depthModeForSublayer(it.overscaledZ-tt,Z.paint.get("raster-opacity")===1?t.DepthMode.ReadWrite:t.DepthMode.ReadOnly,ye.LESS),Ye=it.toUnwrapped(),lt=G.getTile(it);if(Fe&&(!lt||!lt.hasData()))continue;const ct=Fe?it.projMatrix:J.transform.calculateProjMatrix(Ye,Qe),Tt=J.terrain&&Fe?J.terrain.stencilModeForRTTOverlap(it):$e[it.overscaledZ],Rt=de?0:Z.paint.get("raster-fade-duration");lt.registerFadeDuration(Rt);const It=G.findLoadedParent(it,0),kt=Lu(lt,It,G,J.transform,Rt);let Dt,Vt;J.terrain&&J.terrain.prepareDrawTile();const mr=Z.paint.get("raster-resampling")==="nearest"?ye.NEAREST:ye.LINEAR;me.activeTexture.set(ye.TEXTURE0),lt.texture.bind(mr,ye.CLAMP_TO_EDGE),me.activeTexture.set(ye.TEXTURE1),It?(It.texture.bind(mr,ye.CLAMP_TO_EDGE),Dt=Math.pow(2,It.tileID.overscaledZ-lt.tileID.overscaledZ),Vt=[lt.tileID.canonical.x*Dt%1,lt.tileID.canonical.y*Dt%1]):lt.texture.bind(mr,ye.CLAMP_TO_EDGE),lt.texture.useMipmap&&me.extTextureFilterAnisotropic&&J.transform.pitch>20&&ye.texParameterf(ye.TEXTURE_2D,me.extTextureFilterAnisotropic.TEXTURE_MAX_ANISOTROPY_EXT,me.extTextureFilterAnisotropicMax);const Bt=Gu(ct,Vt||[0,0],Dt||1,kt,Z,be instanceof ci?be.perspectiveTransform:[0,0]);if(J.prepareDrawProgram(me,qe,Ye),be instanceof ci)be.boundsBuffer&&be.boundsSegments&&qe.draw(me,ye.TRIANGLES,Be,t.StencilMode.disabled,Te,t.CullFaceMode.disabled,Bt,Z.id,be.boundsBuffer,J.quadTriangleIndexBuffer,be.boundsSegments);else{const{tileBoundsBuffer:nr,tileBoundsIndexBuffer:Ht,tileBoundsSegments:pr}=J.getTileBoundsBuffers(lt);qe.draw(me,ye.TRIANGLES,Be,Tt,Te,t.CullFaceMode.disabled,Bt,Z.id,nr,Ht,pr)}}J.resetStencilClippingMasks()},background:function(J,G,Z,re){const le=Z.paint.get("background-color"),de=Z.paint.get("background-opacity");if(de===0)return;const me=J.context,ye=me.gl,be=J.transform,qe=be.tileSize,Te=Z.paint.get("background-pattern");if(J.isPatternMissing(Te))return;const Fe=!Te&&le.a===1&&de===1&&J.opaquePassEnabledForLayer()?"opaque":"translucent";if(J.renderPass!==Fe)return;const $e=t.StencilMode.disabled,Je=J.depthModeForSublayer(0,Fe==="opaque"?t.DepthMode.ReadWrite:t.DepthMode.ReadOnly),tt=J.colorModeForRenderPass(),Qe=J.useProgram(Te?"backgroundPattern":"background");let it,Be=re;Be||(it=J.getBackgroundTiles(),Be=Object.values(it).map(Ye=>Ye.tileID)),Te&&(me.activeTexture.set(ye.TEXTURE0),J.imageManager.bind(J.context));for(const Ye of Be){const lt=Ye.toUnwrapped(),ct=re?Ye.projMatrix:J.transform.calculateProjMatrix(lt);J.prepareDrawTile();const Tt=G?G.getTile(Ye):it?it[Ye.key]:new t.Tile(Ye,qe,be.zoom,J),Rt=Te?Sh(ct,de,J,Te,{tileID:Ye,tileSize:qe}):Wu(ct,de,le);J.prepareDrawProgram(me,Qe,lt);const{tileBoundsBuffer:It,tileBoundsIndexBuffer:kt,tileBoundsSegments:Dt}=J.getTileBoundsBuffers(Tt);Qe.draw(me,ye.TRIANGLES,Je,$e,tt,t.CullFaceMode.disabled,Rt,Z.id,It,kt,Dt)}},sky:function(J,G,Z){const re=J.transform,le=re.projection.name==="mercator"||re.projection.name==="globe"?1:t.smoothstep(7,8,re.zoom),de=Z.paint.get("sky-opacity")*le;if(de===0)return;const me=J.context,ye=Z.paint.get("sky-type"),be=new t.DepthMode(me.gl.LEQUAL,t.DepthMode.ReadOnly,[0,1]),qe=J.frameCounter/1e3%1;ye==="atmosphere"?J.renderPass==="offscreen"?Z.needsSkyboxCapture(J)&&(function(Te,Fe,$e,Je){const tt=Te.context,Qe=tt.gl;let it=Fe.skyboxFbo;if(!it){it=Fe.skyboxFbo=tt.createFramebuffer(32,32,!1),Fe.skyboxGeometry=new zs(tt),Fe.skyboxTexture=tt.gl.createTexture(),Qe.bindTexture(Qe.TEXTURE_CUBE_MAP,Fe.skyboxTexture),Qe.texParameteri(Qe.TEXTURE_CUBE_MAP,Qe.TEXTURE_WRAP_S,Qe.CLAMP_TO_EDGE),Qe.texParameteri(Qe.TEXTURE_CUBE_MAP,Qe.TEXTURE_WRAP_T,Qe.CLAMP_TO_EDGE),Qe.texParameteri(Qe.TEXTURE_CUBE_MAP,Qe.TEXTURE_MIN_FILTER,Qe.LINEAR),Qe.texParameteri(Qe.TEXTURE_CUBE_MAP,Qe.TEXTURE_MAG_FILTER,Qe.LINEAR);for(let ct=0;ct<6;++ct)Qe.texImage2D(Qe.TEXTURE_CUBE_MAP_POSITIVE_X+ct,0,Qe.RGBA,32,32,0,Qe.RGBA,Qe.UNSIGNED_BYTE,null)}tt.bindFramebuffer.set(it.framebuffer),tt.viewport.set([0,0,32,32]);const Be=Fe.getCenter(Te,!0),Ye=Te.useProgram("skyboxCapture"),lt=new Float64Array(16);t.identity(lt),t.rotateY(lt,lt,.5*-Math.PI),Hn(tt,Fe,Ye,lt,Be,0),t.identity(lt),t.rotateY(lt,lt,.5*Math.PI),Hn(tt,Fe,Ye,lt,Be,1),t.identity(lt),t.rotateX(lt,lt,.5*-Math.PI),Hn(tt,Fe,Ye,lt,Be,2),t.identity(lt),t.rotateX(lt,lt,.5*Math.PI),Hn(tt,Fe,Ye,lt,Be,3),t.identity(lt),Hn(tt,Fe,Ye,lt,Be,4),t.identity(lt),t.rotateY(lt,lt,Math.PI),Hn(tt,Fe,Ye,lt,Be,5),tt.viewport.set([0,0,Te.width,Te.height])}(J,Z),Z.markSkyboxValid(J)):J.renderPass==="sky"&&function(Te,Fe,$e,Je,tt){const Qe=Te.context,it=Qe.gl,Be=Te.transform,Ye=Te.useProgram("skybox");Qe.activeTexture.set(it.TEXTURE0),it.bindTexture(it.TEXTURE_CUBE_MAP,Fe.skyboxTexture);const lt=((ct,Tt,Rt,It,kt)=>({u_matrix:ct,u_sun_direction:Tt,u_cubemap:0,u_opacity:It,u_temporal_offset:kt}))(Be.skyboxMatrix,Fe.getCenter(Te,!1),0,Je,tt);Te.prepareDrawProgram(Qe,Ye),Ye.draw(Qe,it.TRIANGLES,$e,t.StencilMode.disabled,Te.colorModeForRenderPass(),t.CullFaceMode.backCW,lt,"skybox",Fe.skyboxGeometry.vertexBuffer,Fe.skyboxGeometry.indexBuffer,Fe.skyboxGeometry.segment)}(J,Z,be,de,qe):ye==="gradient"&&J.renderPass==="sky"&&function(Te,Fe,$e,Je,tt){const Qe=Te.context,it=Qe.gl,Be=Te.transform,Ye=Te.useProgram("skyboxGradient");Fe.skyboxGeometry||(Fe.skyboxGeometry=new zs(Qe)),Qe.activeTexture.set(it.TEXTURE0);let lt=Fe.colorRampTexture;lt||(lt=Fe.colorRampTexture=new t.Texture(Qe,Fe.colorRamp,it.RGBA)),lt.bind(it.LINEAR,it.CLAMP_TO_EDGE);const ct=((Tt,Rt,It,kt,Dt)=>({u_matrix:Tt,u_color_ramp:0,u_center_direction:Rt,u_radius:t.degToRad(It),u_opacity:kt,u_temporal_offset:Dt}))(Be.skyboxMatrix,Fe.getCenter(Te,!1),Fe.paint.get("sky-gradient-radius"),Je,tt);Te.prepareDrawProgram(Qe,Ye),Ye.draw(Qe,it.TRIANGLES,$e,t.StencilMode.disabled,Te.colorModeForRenderPass(),t.CullFaceMode.backCW,ct,"skyboxGradient",Fe.skyboxGeometry.vertexBuffer,Fe.skyboxGeometry.indexBuffer,Fe.skyboxGeometry.segment)}(J,Z,be,de,qe)},debug:function(J,G,Z){for(let re=0;re<Z.length;re++)Oh(J,G,Z[re])},custom:function(J,G,Z,re){const le=J.context,de=Z.implementation;if(!J.transform.projection.unsupportedLayers||!J.transform.projection.unsupportedLayers.includes("custom")||J.terrain&&(J.terrain.renderingToTexture||J.renderPass==="offscreen")&&Z.isLayerDraped()){if(J.renderPass==="offscreen"){const me=de.prerender;if(me){if(J.setCustomLayerDefaults(),le.setColorMode(J.colorModeForRenderPass()),J.transform.projection.name==="globe"){const ye=J.transform.pointMerc;me.call(de,le.gl,J.transform.customLayerMatrix(),J.transform.getProjection(),J.transform.globeToMercatorMatrix(),t.globeToMercatorTransition(J.transform.zoom),[ye.x,ye.y],J.transform.pixelsPerMeterRatio)}else me.call(de,le.gl,J.transform.customLayerMatrix());le.setDirty(),J.setBaseState()}}else if(J.renderPass==="translucent"){if(J.terrain&&J.terrain.renderingToTexture){const ye=de.renderToTile;if(ye){const be=re[0].canonical,qe=new t.MercatorCoordinate(be.x+re[0].wrap*(1<<be.z),be.y,be.z);le.setDepthMode(t.DepthMode.disabled),le.setStencilMode(t.StencilMode.disabled),le.setColorMode(J.colorModeForRenderPass()),J.setCustomLayerDefaults(),ye.call(de,le.gl,qe),le.setDirty(),J.setBaseState()}return}J.setCustomLayerDefaults(),le.setColorMode(J.colorModeForRenderPass()),le.setStencilMode(t.StencilMode.disabled);const me=de.renderingMode==="3d"?new t.DepthMode(J.context.gl.LEQUAL,t.DepthMode.ReadWrite,J.depthRangeFor3D):J.depthModeForSublayer(0,t.DepthMode.ReadOnly);if(le.setDepthMode(me),J.transform.projection.name==="globe"){const ye=J.transform.pointMerc;de.render(le.gl,J.transform.customLayerMatrix(),J.transform.getProjection(),J.transform.globeToMercatorMatrix(),t.globeToMercatorTransition(J.transform.zoom),[ye.x,ye.y],J.transform.pixelsPerMeterRatio)}else de.render(le.gl,J.transform.customLayerMatrix());le.setDirty(),J.setBaseState(),le.bindFramebuffer.set(null)}}else t.warnOnce("Custom layers are not yet supported with this projection. Use mercator or globe to enable usage of custom layers.")}};class bo{constructor(G,Z,re=!1){this.context=new br(G,re),this.transform=Z,this._tileTextures={},this.frameCopies=[],this.loadTimeStamps=[],this.setup(),this.numSublayers=t.SourceCache.maxUnderzooming+t.SourceCache.maxOverzooming+1,this.depthEpsilon=1/Math.pow(2,16),this.deferredRenderGpuTimeQueries=[],this.gpuTimers={},this.frameCounter=0,this._backgroundTiles={}}updateTerrain(G,Z){const re=!!G&&!!G.terrain&&this.transform.projection.supportsTerrain;if(!(re||this._terrain&&this._terrain.enabled))return;this._terrain||(this._terrain=new ku(this,G));const le=this._terrain;this.transform.elevation=re?le:null,le.update(G,this.transform,Z)}_updateFog(G){const Z=G.fog;if(!Z||this.transform.projection.name==="globe"||Z.getOpacity(this.transform.pitch)<1||Z.properties.get("horizon-blend")<.03)return void(this.transform.fogCullDistSq=null);const[re,le]=Z.getFovAdjustedRange(this.transform._fov);if(re>le)return void(this.transform.fogCullDistSq=null);const de=re+.78*(le-re);this.transform.fogCullDistSq=de*de}get terrain(){return this.transform._terrainEnabled()&&this._terrain&&this._terrain.enabled?this._terrain:null}resize(G,Z){if(this.width=G*t.exported.devicePixelRatio,this.height=Z*t.exported.devicePixelRatio,this.context.viewport.set([0,0,this.width,this.height]),this.style)for(const re of this.style.order)this.style._layers[re].resize()}setup(){const G=this.context,Z=new t.StructArrayLayout2i4;Z.emplaceBack(0,0),Z.emplaceBack(t.EXTENT,0),Z.emplaceBack(0,t.EXTENT),Z.emplaceBack(t.EXTENT,t.EXTENT),this.tileExtentBuffer=G.createVertexBuffer(Z,t.posAttributes.members),this.tileExtentSegments=t.SegmentVector.simpleSegment(0,0,4,2);const re=new t.StructArrayLayout2i4;re.emplaceBack(0,0),re.emplaceBack(t.EXTENT,0),re.emplaceBack(0,t.EXTENT),re.emplaceBack(t.EXTENT,t.EXTENT),this.debugBuffer=G.createVertexBuffer(re,t.posAttributes.members),this.debugSegments=t.SegmentVector.simpleSegment(0,0,4,5);const le=new t.StructArrayLayout2i4;le.emplaceBack(-1,-1),le.emplaceBack(1,-1),le.emplaceBack(-1,1),le.emplaceBack(1,1),this.viewportBuffer=G.createVertexBuffer(le,t.posAttributes.members),this.viewportSegments=t.SegmentVector.simpleSegment(0,0,4,2);const de=new t.StructArrayLayout4i8;de.emplaceBack(0,0,0,0),de.emplaceBack(t.EXTENT,0,t.EXTENT,0),de.emplaceBack(0,t.EXTENT,0,t.EXTENT),de.emplaceBack(t.EXTENT,t.EXTENT,t.EXTENT,t.EXTENT),this.mercatorBoundsBuffer=G.createVertexBuffer(de,t.boundsAttributes.members),this.mercatorBoundsSegments=t.SegmentVector.simpleSegment(0,0,4,2);const me=new t.StructArrayLayout3ui6;me.emplaceBack(0,1,2),me.emplaceBack(2,1,3),this.quadTriangleIndexBuffer=G.createIndexBuffer(me);const ye=new t.StructArrayLayout1ui2;for(const qe of[0,1,3,2,0])ye.emplaceBack(qe);this.debugIndexBuffer=G.createIndexBuffer(ye),this.emptyTexture=new t.Texture(G,new t.RGBAImage({width:1,height:1},Uint8Array.of(0,0,0,0)),G.gl.RGBA),this.identityMat=t.create();const be=this.context.gl;this.stencilClearMode=new t.StencilMode({func:be.ALWAYS,mask:0},0,255,be.ZERO,be.ZERO,be.ZERO),this.loadTimeStamps.push(t.window.performance.now()),this.atmosphereBuffer=new _c(this.context)}getMercatorTileBoundsBuffers(){return{tileBoundsBuffer:this.mercatorBoundsBuffer,tileBoundsIndexBuffer:this.quadTriangleIndexBuffer,tileBoundsSegments:this.mercatorBoundsSegments}}getTileBoundsBuffers(G){return G._makeTileBoundsBuffers(this.context,this.transform.projection),G._tileBoundsBuffer?{tileBoundsBuffer:G._tileBoundsBuffer,tileBoundsIndexBuffer:G._tileBoundsIndexBuffer,tileBoundsSegments:G._tileBoundsSegments}:this.getMercatorTileBoundsBuffers()}clearStencil(){const G=this.context,Z=G.gl;this.nextStencilID=1,this.currentStencilSource=void 0,this._tileClippingMaskIDs={},this.useProgram("clippingMask").draw(G,Z.TRIANGLES,t.DepthMode.disabled,this.stencilClearMode,t.ColorMode.disabled,t.CullFaceMode.disabled,Zo(this.identityMat),"$clipping",this.viewportBuffer,this.quadTriangleIndexBuffer,this.viewportSegments)}resetStencilClippingMasks(){this.terrain||(this.currentStencilSource=void 0,this._tileClippingMaskIDs={})}_renderTileClippingMasks(G,Z,re){if(!Z||this.currentStencilSource===Z.id||!G.isTileClipped()||!re||re.length===0)return;if(this._tileClippingMaskIDs&&!this.terrain){let ye=!1;for(const be of re)if(this._tileClippingMaskIDs[be.key]===void 0){ye=!0;break}if(!ye)return}this.currentStencilSource=Z.id;const le=this.context,de=le.gl;this.nextStencilID+re.length>256&&this.clearStencil(),le.setColorMode(t.ColorMode.disabled),le.setDepthMode(t.DepthMode.disabled);const me=this.useProgram("clippingMask");this._tileClippingMaskIDs={};for(const ye of re){const be=Z.getTile(ye),qe=this._tileClippingMaskIDs[ye.key]=this.nextStencilID++,{tileBoundsBuffer:Te,tileBoundsIndexBuffer:Fe,tileBoundsSegments:$e}=this.getTileBoundsBuffers(be);me.draw(le,de.TRIANGLES,t.DepthMode.disabled,new t.StencilMode({func:de.ALWAYS,mask:0},qe,255,de.KEEP,de.KEEP,de.REPLACE),t.ColorMode.disabled,t.CullFaceMode.disabled,Zo(ye.projMatrix),"$clipping",Te,Fe,$e)}}stencilModeFor3D(){this.currentStencilSource=void 0,this.nextStencilID+1>256&&this.clearStencil();const G=this.nextStencilID++,Z=this.context.gl;return new t.StencilMode({func:Z.NOTEQUAL,mask:255},G,255,Z.KEEP,Z.KEEP,Z.REPLACE)}stencilModeForClipping(G){if(this.terrain)return this.terrain.stencilModeForRTTOverlap(G);const Z=this.context.gl;return new t.StencilMode({func:Z.EQUAL,mask:255},this._tileClippingMaskIDs[G.key],0,Z.KEEP,Z.KEEP,Z.REPLACE)}stencilConfigForOverlap(G){const Z=this.context.gl,re=G.sort((me,ye)=>ye.overscaledZ-me.overscaledZ),le=re[re.length-1].overscaledZ,de=re[0].overscaledZ-le+1;if(de>1){this.currentStencilSource=void 0,this.nextStencilID+de>256&&this.clearStencil();const me={};for(let ye=0;ye<de;ye++)me[ye+le]=new t.StencilMode({func:Z.GEQUAL,mask:255},ye+this.nextStencilID,255,Z.KEEP,Z.KEEP,Z.REPLACE);return this.nextStencilID+=de,[me,re]}return[{[le]:t.StencilMode.disabled},re]}colorModeForRenderPass(){const G=this.context.gl;return this._showOverdrawInspector?new t.ColorMode([G.CONSTANT_COLOR,G.ONE],new t.Color(.125,.125,.125,0),[!0,!0,!0,!0]):this.renderPass==="opaque"?t.ColorMode.unblended:t.ColorMode.alphaBlended}depthModeForSublayer(G,Z,re){if(!this.opaquePassEnabledForLayer())return t.DepthMode.disabled;const le=1-((1+this.currentLayer)*this.numSublayers+G)*this.depthEpsilon;return new t.DepthMode(re||this.context.gl.LEQUAL,Z,[le,le])}opaquePassEnabledForLayer(){return this.currentLayer<this.opaquePassCutoff}render(G,Z){this.style=G,this.options=Z,this.imageManager=G.imageManager,this.glyphManager=G.glyphManager,this.symbolFadeChange=G.placement.symbolFadeChange(t.exported.now()),this.imageManager.beginFrame();const re=this.style.order,le=this.style._sourceCaches;for(const qe in le){const Te=le[qe];Te.used&&Te.prepare(this.context)}const de={},me={},ye={};for(const qe in le){const Te=le[qe];de[qe]=Te.getVisibleCoordinates(),me[qe]=de[qe].slice().reverse(),ye[qe]=Te.getVisibleCoordinates(!0).reverse()}this.opaquePassCutoff=1/0;for(let qe=0;qe<re.length;qe++)if(this.style._layers[re[qe]].is3D()){this.opaquePassCutoff=qe;break}if(this.terrain&&(this.terrain.updateTileBinding(ye),this.opaquePassCutoff=0),this.transform.projection.name!=="globe"||this.globeSharedBuffers||(this.globeSharedBuffers=new t.GlobeSharedBuffers(this.context)),!t.isMapAuthenticated(this.context.gl))return;this.renderPass="offscreen";for(const qe of re){const Te=this.style._layers[qe],Fe=G._getLayerSourceCache(Te);if(!Te.hasOffscreenPass()||Te.isHidden(this.transform.zoom))continue;const $e=Fe?me[Fe.id]:void 0;(Te.type==="custom"||Te.isSky()||$e&&$e.length)&&this.renderLayer(this,Fe,Te,$e)}this.depthRangeFor3D=[0,1-(G.order.length+2)*this.numSublayers*this.depthEpsilon];const be=this.terrain;if(be&&(this.style.hasSymbolLayers()||this.style.hasCircleLayers())&&be.drawDepth(),this.context.bindFramebuffer.set(null),this.context.viewport.set([0,0,this.width,this.height]),this.context.clear({color:Z.showOverdrawInspector?t.Color.black:t.Color.transparent,depth:1}),this.clearStencil(),this._showOverdrawInspector=Z.showOverdrawInspector,this.renderPass="opaque",!this.terrain)for(this.currentLayer=re.length-1;this.currentLayer>=0;this.currentLayer--){const qe=this.style._layers[re[this.currentLayer]],Te=G._getLayerSourceCache(qe);if(qe.isSky())continue;const Fe=Te?me[Te.id]:void 0;this._renderTileClippingMasks(qe,Te,Fe),this.renderLayer(this,Te,qe,Fe)}if(this.style.fog&&this.transform.projection.supportsFog&&function(qe,Te){const Fe=qe.context,$e=Fe.gl,Je=qe.transform,tt=new t.DepthMode($e.LEQUAL,t.DepthMode.ReadOnly,[0,1]),Qe=qe.useProgram("globeAtmosphere",null,Je.projection.name==="globe"?["PROJECTION_GLOBE_VIEW","FOG"]:["FOG"]),it=t.globeToMercatorTransition(Je.zoom),Be=Te.properties.get("color").toArray01(),Ye=Te.properties.get("high-color").toArray01(),lt=Te.properties.get("space-color").toArray01PremultipliedAlpha(),ct=t.identity$1([]);t.rotateY$1(ct,ct,-t.degToRad(Je._center.lng)),t.rotateX$1(ct,ct,t.degToRad(Je._center.lat)),t.rotateZ$1(ct,ct,Je.angle),t.rotateX$1(ct,ct,-Je._pitch);const Tt=t.fromQuat(new Float32Array(16),ct),Rt=t.mapValue(Te.properties.get("star-intensity"),0,1,0,.25),It=5e-4,kt=t.mapValue(Te.properties.get("horizon-blend"),0,1,It,.25),Dt=t.globeUseCustomAntiAliasing(qe,Fe,Je)&&kt===It?Je.worldSize/(2*Math.PI*1.025)-1:Je.globeRadius,Vt=qe.frameCounter/1e3%1,mr=t.length(Je.globeCenterInViewSpace),Bt=Math.sqrt(Math.pow(mr,2)-Math.pow(Dt,2)),nr=Math.acos(Bt/mr),Ht=((jt,ir,gr,ur,xr,Jr,hi,Gr,ii,xi,gi,Zr,Pi,Di)=>({u_frustum_tl:jt,u_frustum_tr:ir,u_frustum_br:gr,u_frustum_bl:ur,u_horizon:xr,u_transition:Jr,u_fadeout_range:hi,u_color:Gr,u_high_color:ii,u_space_color:xi,u_star_intensity:gi,u_star_size:5*t.exported.devicePixelRatio,u_star_density:0,u_temporal_offset:Zr,u_horizon_angle:Pi,u_rotation_matrix:Di}))(Je.frustumCorners.TL,Je.frustumCorners.TR,Je.frustumCorners.BR,Je.frustumCorners.BL,Je.frustumCorners.horizon,it,kt,Be,Ye,lt,Rt,Vt,nr,Tt);qe.prepareDrawProgram(Fe,Qe);const pr=qe.atmosphereBuffer;pr&&Qe.draw(Fe,$e.TRIANGLES,tt,t.StencilMode.disabled,t.ColorMode.alphaBlended,t.CullFaceMode.backCW,Ht,"skybox",pr.vertexBuffer,pr.indexBuffer,pr.segments)}(this,this.style.fog),this.renderPass="sky",(t.globeToMercatorTransition(this.transform.zoom)>0||this.transform.projection.name!=="globe")&&this.transform.isHorizonVisible())for(this.currentLayer=0;this.currentLayer<re.length;this.currentLayer++){const qe=this.style._layers[re[this.currentLayer]],Te=G._getLayerSourceCache(qe);qe.isSky()&&this.renderLayer(this,Te,qe,Te?me[Te.id]:void 0)}for(this.renderPass="translucent",this.currentLayer=0;this.currentLayer<re.length;){const qe=this.style._layers[re[this.currentLayer]],Te=G._getLayerSourceCache(qe);if(qe.isSky()){++this.currentLayer;continue}if(this.terrain&&this.style.isLayerDraped(qe)){if(qe.isHidden(this.transform.zoom)){++this.currentLayer;continue}this.currentLayer=this.terrain.renderBatch(this.currentLayer);continue}const Fe=Te?(qe.type==="symbol"?ye:me)[Te.id]:void 0;this._renderTileClippingMasks(qe,Te,Te?de[Te.id]:void 0),this.renderLayer(this,Te,qe,Fe),++this.currentLayer}if(this.terrain&&this.terrain.postRender(),this.options.showTileBoundaries||this.options.showQueryGeometry||this.options.showTileAABBs){let qe=null;t.values(this.style._layers).forEach(Te=>{const Fe=G._getLayerSourceCache(Te);Fe&&!Te.isHidden(this.transform.zoom)&&(!qe||qe.getSource().maxzoom<Fe.getSource().maxzoom)&&(qe=Fe)}),qe&&this.options.showTileBoundaries&&Ya.debug(this,qe,qe.getVisibleCoordinates())}this.options.showPadding&&function(qe){const Te=qe.transform.padding;dc(qe,qe.transform.height-(Te.top||0),3,go),dc(qe,Te.bottom||0,3,qh),Bs(qe,Te.left||0,3,Ih),Bs(qe,qe.transform.width-(Te.right||0),3,Ah);const Fe=qe.transform.centerPoint;(function($e,Je,tt,Qe){vo($e,Je-1,tt-10,2,20,Qe),vo($e,Je-10,tt-1,20,2,Qe)})(qe,Fe.x,qe.transform.height-Fe.y,Rh)}(this),this.context.setDefault(),this.frameCounter=(this.frameCounter+1)%Number.MAX_SAFE_INTEGER,this.tileLoaded&&this.options.speedIndexTiming&&(this.loadTimeStamps.push(t.window.performance.now()),this.saveCanvasCopy())}renderLayer(G,Z,re,le){re.isHidden(this.transform.zoom)||(re.type==="background"||re.type==="sky"||re.type==="custom"||le&&le.length)&&(this.id=re.id,this.gpuTimingStart(re),(!G.transform.projection.unsupportedLayers||!G.transform.projection.unsupportedLayers.includes(re.type)||G.terrain&&re.type==="custom")&&Ya[re.type](G,Z,re,le,this.style.placement.variableOffsets,this.options.isInitialLoad),this.gpuTimingEnd())}gpuTimingStart(G){if(!this.options.gpuTiming)return;const Z=this.context.extTimerQuery;let re=this.gpuTimers[G.id];re||(re=this.gpuTimers[G.id]={calls:0,cpuTime:0,query:Z.createQueryEXT()}),re.calls++,Z.beginQueryEXT(Z.TIME_ELAPSED_EXT,re.query)}gpuTimingDeferredRenderStart(){if(this.options.gpuTimingDeferredRender){const G=this.context.extTimerQuery,Z=G.createQueryEXT();this.deferredRenderGpuTimeQueries.push(Z),G.beginQueryEXT(G.TIME_ELAPSED_EXT,Z)}}gpuTimingDeferredRenderEnd(){if(!this.options.gpuTimingDeferredRender)return;const G=this.context.extTimerQuery;G.endQueryEXT(G.TIME_ELAPSED_EXT)}gpuTimingEnd(){if(!this.options.gpuTiming)return;const G=this.context.extTimerQuery;G.endQueryEXT(G.TIME_ELAPSED_EXT)}collectGpuTimers(){const G=this.gpuTimers;return this.gpuTimers={},G}collectDeferredRenderGpuQueries(){const G=this.deferredRenderGpuTimeQueries;return this.deferredRenderGpuTimeQueries=[],G}queryGpuTimers(G){const Z={};for(const re in G){const le=G[re],de=this.context.extTimerQuery,me=de.getQueryObjectEXT(le.query,de.QUERY_RESULT_EXT)/1e6;de.deleteQueryEXT(le.query),Z[re]=me}return Z}queryGpuTimeDeferredRender(G){if(!this.options.gpuTimingDeferredRender)return 0;const Z=this.context.extTimerQuery;let re=0;for(const le of G)re+=Z.getQueryObjectEXT(le,Z.QUERY_RESULT_EXT)/1e6,Z.deleteQueryEXT(le);return re}translatePosMatrix(G,Z,re,le,de){if(!re[0]&&!re[1])return G;const me=de?le==="map"?this.transform.angle:0:le==="viewport"?-this.transform.angle:0;if(me){const qe=Math.sin(me),Te=Math.cos(me);re=[re[0]*Te-re[1]*qe,re[0]*qe+re[1]*Te]}const ye=[de?re[0]:Ft(Z,re[0],this.transform.zoom),de?re[1]:Ft(Z,re[1],this.transform.zoom),0],be=new Float32Array(16);return t.translate(be,G,ye),be}saveTileTexture(G){const Z=this._tileTextures[G.size[0]];Z?Z.push(G):this._tileTextures[G.size[0]]=[G]}getTileTexture(G){const Z=this._tileTextures[G];return Z&&Z.length>0?Z.pop():null}isPatternMissing(G){return G===null||G!==void 0&&!this.imageManager.getPattern(G.toString())}terrainRenderModeElevated(){return this.style&&!!this.style.getTerrain()&&!!this.terrain&&!this.terrain.renderingToTexture}currentGlobalDefines(){const G=this.terrain&&this.terrain.renderingToTexture,Z=this.terrain&&this.terrain.exaggeration()===0,re=this.style&&this.style.fog,le=[];return this.terrainRenderModeElevated()&&le.push("TERRAIN"),this.transform.projection.name==="globe"&&le.push("GLOBE"),Z&&le.push("ZERO_EXAGGERATION"),re&&!G&&re.getOpacity(this.transform.pitch)!==0&&le.push("FOG"),G&&le.push("RENDER_TO_TEXTURE"),this._showOverdrawInspector&&le.push("OVERDRAW_INSPECTOR"),le}useProgram(G,Z,re){this.cache=this.cache||{};const le=re||[],de=this.currentGlobalDefines().concat(le),me=Ti.cacheKey(Cu[G],G,de,Z);return this.cache[me]||(this.cache[me]=new Ti(this.context,G,Cu[G],Z,Hu[G],de)),this.cache[me]}setCustomLayerDefaults(){this.context.unbindVAO(),this.context.cullFace.setDefault(),this.context.frontFace.setDefault(),this.context.cullFaceSide.setDefault(),this.context.activeTexture.setDefault(),this.context.pixelStoreUnpack.setDefault(),this.context.pixelStoreUnpackPremultiplyAlpha.setDefault(),this.context.pixelStoreUnpackFlipY.setDefault()}setBaseState(){const G=this.context.gl;this.context.cullFace.set(!1),this.context.viewport.set([0,0,this.width,this.height]),this.context.blendEquation.set(G.FUNC_ADD)}initDebugOverlayCanvas(){this.debugOverlayCanvas==null&&(this.debugOverlayCanvas=t.window.document.createElement("canvas"),this.debugOverlayCanvas.width=512,this.debugOverlayCanvas.height=512,this.debugOverlayTexture=new t.Texture(this.context,this.debugOverlayCanvas,this.context.gl.RGBA))}destroy(){this._terrain&&this._terrain.destroy(),this.globeSharedBuffers&&this.globeSharedBuffers.destroy(),this.emptyTexture.destroy(),this.debugOverlayTexture&&this.debugOverlayTexture.destroy(),this.atmosphereBuffer&&this.atmosphereBuffer.destroy()}prepareDrawTile(){this.terrain&&this.terrain.prepareDrawTile()}prepareDrawProgram(G,Z,re){if(this.terrain&&this.terrain.renderingToTexture)return;const le=this.style.fog;if(le){const de=le.getOpacity(this.transform.pitch),me=((ye,be,qe,Te,Fe,$e,Je,tt,Qe,it,Be)=>{const Ye=ye.transform,lt=be.properties.get("color").toArray01();lt[3]=Te;const ct=ye.frameCounter/1e3%1;return{u_fog_matrix:qe?Ye.calculateFogTileMatrix(qe):ye.identityMat,u_fog_range:be.getFovAdjustedRange(Ye._fov),u_fog_color:lt,u_fog_horizon_blend:be.properties.get("horizon-blend"),u_fog_temporal_offset:ct,u_frustum_tl:Fe,u_frustum_tr:$e,u_frustum_br:Je,u_frustum_bl:tt,u_globe_pos:Qe,u_globe_radius:it,u_viewport:Be,u_globe_transition:t.globeToMercatorTransition(Ye.zoom),u_is_globe:+(Ye.projection.name==="globe")}})(this,le,re,de,this.transform.frustumCorners.TL,this.transform.frustumCorners.TR,this.transform.frustumCorners.BR,this.transform.frustumCorners.BL,this.transform.globeCenterInViewSpace,this.transform.globeRadius,[this.transform.width*t.exported.devicePixelRatio,this.transform.height*t.exported.devicePixelRatio]);Z.setFogUniformValues(G,me)}}setTileLoadedFlag(G){this.tileLoaded=G}saveCanvasCopy(){const G=this.canvasCopy();G&&(this.frameCopies.push(G),this.tileLoaded=!1)}canvasCopy(){const G=this.context.gl,Z=G.createTexture();return G.bindTexture(G.TEXTURE_2D,Z),G.copyTexImage2D(G.TEXTURE_2D,0,G.RGBA,0,0,G.drawingBufferWidth,G.drawingBufferHeight,0),Z}getCanvasCopiesAndTimestamps(){return{canvasCopies:this.frameCopies,timeStamps:this.loadTimeStamps}}averageElevationNeedsEasing(){if(!this.transform._elevation)return!1;const G=this.style&&this.style.fog;return!!G&&G.getOpacity(this.transform.pitch)!==0}getBackgroundTiles(){const G=this._backgroundTiles,Z=this._backgroundTiles={},re=this.transform.coveringTiles({tileSize:512});for(const le of re)Z[le.key]=G[le.key]||new t.Tile(le,512,this.transform.tileZoom,this);return Z}clearBackgroundTiles(){this._backgroundTiles={}}}class Ns{constructor(G=0,Z=0,re=0,le=0){if(isNaN(G)||G<0||isNaN(Z)||Z<0||isNaN(re)||re<0||isNaN(le)||le<0)throw new Error("Invalid value for edge-insets, top, bottom, left and right must all be numbers");this.top=G,this.bottom=Z,this.left=re,this.right=le}interpolate(G,Z,re){return Z.top!=null&&G.top!=null&&(this.top=t.number(G.top,Z.top,re)),Z.bottom!=null&&G.bottom!=null&&(this.bottom=t.number(G.bottom,Z.bottom,re)),Z.left!=null&&G.left!=null&&(this.left=t.number(G.left,Z.left,re)),Z.right!=null&&G.right!=null&&(this.right=t.number(G.right,Z.right,re)),this}getCenter(G,Z){const re=t.clamp((this.left+G-this.right)/2,0,G),le=t.clamp((this.top+Z-this.bottom)/2,0,Z);return new t.Point(re,le)}equals(G){return this.top===G.top&&this.bottom===G.bottom&&this.left===G.left&&this.right===G.right}clone(){return new Ns(this.top,this.bottom,this.left,this.right)}toJSON(){return{top:this.top,bottom:this.bottom,left:this.left,right:this.right}}}function js(J,G){const Z=t.getColumn(J,3);t.fromQuat(J,G),t.setColumn(J,3,Z)}function qi(J,G){const Z=t.identity$1([]);return t.rotateZ$1(Z,Z,-G),t.rotateX$1(Z,Z,-J),Z}function ts(J,G){const Z=[J[0],J[1],0],re=[G[0],G[1],0];if(t.length(Z)>=1e-15){const me=t.normalize([],Z);t.scale$2(re,me,t.dot(re,me)),G[0]=re[0],G[1]=re[1]}const le=t.cross([],G,J);if(t.len(le)<1e-15)return null;const de=Math.atan2(-le[1],le[0]);return qi(Math.atan2(Math.sqrt(J[0]*J[0]+J[1]*J[1]),-J[2]),de)}class mc{constructor(G,Z){this.position=G,this.orientation=Z}get position(){return this._position}set position(G){if(G){const Z=G instanceof t.MercatorCoordinate?G:new t.MercatorCoordinate(G[0],G[1],G[2]);this._renderWorldCopies&&(Z.x=t.wrap(Z.x,0,1)),this._position=Z}else this._position=null}lookAtPoint(G,Z){if(this.orientation=null,!this.position)return;const re=this.position,le=this._elevation?this._elevation.getAtPointOrZero(t.MercatorCoordinate.fromLngLat(G)):0,de=t.MercatorCoordinate.fromLngLat(G,le),me=[de.x-re.x,de.y-re.y,de.z-re.z];Z||(Z=[0,0,1]),Z[2]=Math.abs(Z[2]),this.orientation=ts(me,Z)}setPitchBearing(G,Z){this.orientation=qi(t.degToRad(G),t.degToRad(-Z))}}class Us{constructor(G,Z){this._transform=t.identity([]),this.orientation=Z,this.position=G}get mercatorPosition(){const G=this.position;return new t.MercatorCoordinate(G[0],G[1],G[2])}get position(){const G=t.getColumn(this._transform,3);return[G[0],G[1],G[2]]}set position(G){var Z;G&&t.setColumn(this._transform,3,[(Z=G)[0],Z[1],Z[2],1])}get orientation(){return this._orientation}set orientation(G){this._orientation=G||t.identity$1([]),G&&js(this._transform,this._orientation)}getPitchBearing(){const G=this.forward(),Z=this.right();return{bearing:Math.atan2(-Z[1],Z[0]),pitch:Math.atan2(Math.sqrt(G[0]*G[0]+G[1]*G[1]),-G[2])}}setPitchBearing(G,Z){this._orientation=qi(G,Z),js(this._transform,this._orientation)}forward(){const G=t.getColumn(this._transform,2);return[-G[0],-G[1],-G[2]]}up(){const G=t.getColumn(this._transform,1);return[-G[0],-G[1],-G[2]]}right(){const G=t.getColumn(this._transform,0);return[G[0],G[1],G[2]]}getCameraToWorld(G,Z){const re=new Float64Array(16);return t.invert(re,this.getWorldToCamera(G,Z)),re}getWorldToCameraPosition(G,Z,re){const le=this.position;t.scale$2(le,le,-G);const de=new Float64Array(16);return t.fromScaling(de,[re,re,re]),t.translate(de,de,le),de[10]*=Z,de}getWorldToCamera(G,Z){const re=new Float64Array(16),le=new Float64Array(4),de=this.position;return t.conjugate(le,this._orientation),t.scale$2(de,de,-G),t.fromQuat(re,le),t.translate(re,re,de),re[1]*=-1,re[5]*=-1,re[9]*=-1,re[13]*=-1,re[8]*=Z,re[9]*=Z,re[10]*=Z,re[11]*=Z,re}getCameraToClipPerspective(G,Z,re,le){const de=new Float64Array(16);return t.perspective(de,G,Z,re,le),de}getDistanceToElevation(G,Z=!1){const re=G===0?0:t.mercatorZfromAltitude(G,Z?t.latFromMercatorY(this.position[1]):this.position[1]),le=this.forward();return(re-this.position[2])/le[2]}clone(){return new Us([...this.position],[...this.orientation])}}function xo(J,G){const Z=Vs(J.projection,J.zoom,J.width,J.height),re=function(de,me,ye,be,qe){const Te=new t.LngLat(ye.lng-180*wa,ye.lat),Fe=new t.LngLat(ye.lng+180*wa,ye.lat),$e=de.project(Te.lng,Te.lat),Je=de.project(Fe.lng,Fe.lat),tt=-Math.atan2(Je.y-$e.y,Je.x-$e.x),Qe=t.MercatorCoordinate.fromLngLat(ye);Qe.y=t.clamp(Qe.y,-1+wa,1-wa);const it=Qe.toLngLat(),Be=de.project(it.lng,it.lat),Ye=t.MercatorCoordinate.fromLngLat(it);Ye.x+=wa;const lt=Ye.toLngLat(),ct=de.project(lt.lng,lt.lat),Tt=Gs(ct.x-Be.x,ct.y-Be.y,tt),Rt=t.MercatorCoordinate.fromLngLat(it);Rt.y+=wa;const It=Rt.toLngLat(),kt=de.project(It.lng,It.lat),Dt=Gs(kt.x-Be.x,kt.y-Be.y,tt),Vt=Math.abs(Tt.x)/Math.abs(Dt.y),mr=t.identity([]);t.rotateZ(mr,mr,-tt*(1-(qe?0:be)));const Bt=t.identity([]);return t.scale(Bt,Bt,[1,1-(1-Vt)*be,1]),Bt[4]=-Dt.x/Dt.y*be,t.rotateZ(Bt,Bt,tt),t.multiply(Bt,mr,Bt),Bt}(J.projection,0,J.center,Z,G),le=yc(J);return t.scale(re,re,[le,le,1]),re}function yc(J){const G=J.projection,Z=Vs(J.projection,J.zoom,J.width,J.height),re=gc(G,J.center),le=gc(G,t.LngLat.convert(G.center));return Math.pow(2,re*Z+(1-Z)*le)}function Vs(J,G,Z,re,le=1/0){const de=J.range;if(!de)return 0;const me=Math.min(le,Math.max(Z,re)),ye=Math.log(me/1024)/Math.LN2;return t.smoothstep(de[0]+ye,de[1]+ye,G)}const wa=1/4e4;function gc(J,G){const Z=t.clamp(G.lat,-t.MAX_MERCATOR_LATITUDE,t.MAX_MERCATOR_LATITUDE),re=new t.LngLat(G.lng-180*wa,Z),le=new t.LngLat(G.lng+180*wa,Z),de=J.project(re.lng,Z),me=J.project(le.lng,Z),ye=t.MercatorCoordinate.fromLngLat(re),be=t.MercatorCoordinate.fromLngLat(le),qe=me.x-de.x,Te=me.y-de.y,Fe=be.x-ye.x,$e=be.y-ye.y,Je=Math.sqrt((Fe*Fe+$e*$e)/(qe*qe+Te*Te));return Math.log(Je)/Math.LN2}function Gs(J,G,Z){const re=Math.cos(Z),le=Math.sin(Z);return{x:J*re-G*le,y:J*le+G*re}}class Eo{constructor(G,Z,re,le,de,me,ye){this.tileSize=512,this._renderWorldCopies=de===void 0||de,this._minZoom=G||0,this._maxZoom=Z||22,this._minPitch=re??0,this._maxPitch=le??60,this.setProjection(me),this.setMaxBounds(ye),this.width=0,this.height=0,this._center=new t.LngLat(0,0),this.zoom=0,this.angle=0,this._fov=.6435011087932844,this._pitch=0,this._nearZ=0,this._farZ=0,this._unmodified=!0,this._edgeInsets=new Ns,this._projMatrixCache={},this._alignedProjMatrixCache={},this._fogTileMatrixCache={},this._distanceTileDataCache={},this._camera=new Us,this._centerAltitude=0,this._averageElevation=0,this.cameraElevationReference="ground",this._pixelsPerMercatorPixel=1,this.globeRadius=0,this.globeCenterInViewSpace=[0,0,0],this._horizonShift=.1}clone(){const G=new Eo(this._minZoom,this._maxZoom,this._minPitch,this.maxPitch,this._renderWorldCopies,this.getProjection());return G._elevation=this._elevation,G._centerAltitude=this._centerAltitude,G._centerAltitudeValidForExaggeration=this._centerAltitudeValidForExaggeration,G.tileSize=this.tileSize,G.mercatorFromTransition=this.mercatorFromTransition,G.width=this.width,G.height=this.height,G.cameraElevationReference=this.cameraElevationReference,G._center=this._center,G._setZoom(this.zoom),G._seaLevelZoom=this._seaLevelZoom,G.angle=this.angle,G._fov=this._fov,G._pitch=this._pitch,G._nearZ=this._nearZ,G._farZ=this._farZ,G._averageElevation=this._averageElevation,G._unmodified=this._unmodified,G._edgeInsets=this._edgeInsets.clone(),G._camera=this._camera.clone(),G._calcMatrices(),G.freezeTileCoverage=this.freezeTileCoverage,G.frustumCorners=this.frustumCorners,G}get elevation(){return this._elevation}set elevation(G){this._elevation!==G&&(this._elevation=G,this._updateCameraOnTerrain(),this._calcMatrices())}updateElevation(G,Z=!1){const re=this._elevation&&this._elevation.exaggeration()!==this._centerAltitudeValidForExaggeration;(this._seaLevelZoom==null||re)&&this._updateCameraOnTerrain(),(G||re)&&this._constrainCamera(Z),this._calcMatrices()}getProjection(){return t.pick(this.projection,["name","center","parallels"])}setProjection(G){this.projectionOptions=G||{name:"mercator"};const Z=this.projection?this.getProjection():void 0;this.projection=t.getProjection(this.projectionOptions);const re=!H(Z,this.getProjection());return re&&this._calcMatrices(),this.mercatorFromTransition=!1,re}setMercatorFromTransition(){const G=this.projection.name;this.mercatorFromTransition=!0,this.projectionOptions={name:"mercator"},this.projection=t.getProjection({name:"mercator"});const Z=G!==this.projection.name;return Z&&this._calcMatrices(),Z}get minZoom(){return this._minZoom}set minZoom(G){this._minZoom!==G&&(this._minZoom=G,this.zoom=Math.max(this.zoom,G))}get maxZoom(){return this._maxZoom}set maxZoom(G){this._maxZoom!==G&&(this._maxZoom=G,this.zoom=Math.min(this.zoom,G))}get minPitch(){return this._minPitch}set minPitch(G){this._minPitch!==G&&(this._minPitch=G,this.pitch=Math.max(this.pitch,G))}get maxPitch(){return this._maxPitch}set maxPitch(G){this._maxPitch!==G&&(this._maxPitch=G,this.pitch=Math.min(this.pitch,G))}get renderWorldCopies(){return this._renderWorldCopies&&this.projection.supportsWorldCopies===!0}set renderWorldCopies(G){G===void 0?G=!0:G===null&&(G=!1),this._renderWorldCopies=G}get worldSize(){return this.tileSize*this.scale}get cameraWorldSizeForFog(){const G=Math.max(this._camera.getDistanceToElevation(this._averageElevation),Number.EPSILON);return this._worldSizeFromZoom(this._zoomFromMercatorZ(G))}get cameraWorldSize(){const G=Math.max(this._camera.getDistanceToElevation(this._averageElevation,!0),Number.EPSILON);return this._worldSizeFromZoom(this._zoomFromMercatorZ(G))}get pixelsPerMeter(){return this.projection.pixelsPerMeter(this.center.lat,this.worldSize)}get cameraPixelsPerMeter(){return t.mercatorZfromAltitude(this.center.lat,this.cameraWorldSizeForFog)}get centerOffset(){return this.centerPoint._sub(this.size._div(2))}get size(){return new t.Point(this.width,this.height)}get bearing(){return t.wrap(this.rotation,-180,180)}set bearing(G){this.rotation=G}get rotation(){return-this.angle/Math.PI*180}set rotation(G){const Z=-G*Math.PI/180;var re;this.angle!==Z&&(this._unmodified=!1,this.angle=Z,this._calcMatrices(),this.rotationMatrix=(re=new t.ARRAY_TYPE(4),t.ARRAY_TYPE!=Float32Array&&(re[1]=0,re[2]=0),re[0]=1,re[3]=1,re),function(le,de,me){var ye=de[0],be=de[1],qe=de[2],Te=de[3],Fe=Math.sin(me),$e=Math.cos(me);le[0]=ye*$e+qe*Fe,le[1]=be*$e+Te*Fe,le[2]=ye*-Fe+qe*$e,le[3]=be*-Fe+Te*$e}(this.rotationMatrix,this.rotationMatrix,this.angle))}get pitch(){return this._pitch/Math.PI*180}set pitch(G){const Z=t.clamp(G,this.minPitch,this.maxPitch)/180*Math.PI;this._pitch!==Z&&(this._unmodified=!1,this._pitch=Z,this._calcMatrices())}get aspect(){return this.width/this.height}get fov(){return this._fov/Math.PI*180}get fovX(){return this._fov}get fovY(){const G=1/Math.tan(.5*this.fovX);return 2*Math.atan(1/this.aspect/G)}set fov(G){G=Math.max(.01,Math.min(60,G)),this._fov!==G&&(this._unmodified=!1,this._fov=t.degToRad(G),this._calcMatrices())}get averageElevation(){return this._averageElevation}set averageElevation(G){this._averageElevation=G,this._calcFogMatrices(),this._distanceTileDataCache={}}get zoom(){return this._zoom}set zoom(G){const Z=Math.min(Math.max(G,this.minZoom),this.maxZoom);this._zoom!==Z&&(this._unmodified=!1,this._setZoom(Z),this._updateSeaLevelZoom(),this._constrain(),this._calcMatrices())}_setZoom(G){this._zoom=G,this.scale=this.zoomScale(G),this.tileZoom=Math.floor(G),this.zoomFraction=G-this.tileZoom}_updateCameraOnTerrain(){if(!this._elevation||!this._elevation.isDataAvailableAtPoint(this.locationCoordinate(this.center)))return this._centerAltitude=0,this._seaLevelZoom=null,void(this._centerAltitudeValidForExaggeration=void 0);const G=this._elevation;this._centerAltitude=G.getAtPointOrZero(this.locationCoordinate(this.center)),this._centerAltitudeValidForExaggeration=G.exaggeration(),this._updateSeaLevelZoom()}_updateSeaLevelZoom(){this._centerAltitudeValidForExaggeration!==void 0&&(this._seaLevelZoom=this._zoomFromMercatorZ((this.pixelsPerMeter*this._centerAltitude+this.cameraToCenterDistance)/this.worldSize))}sampleAverageElevation(){if(!this._elevation)return 0;const G=this._elevation,Z=[[.5,.2],[.3,.5],[.5,.5],[.7,.5],[.5,.8]],re=this.horizonLineFromTop();let le=0,de=0;for(let me=0;me<Z.length;me++){const ye=new t.Point(Z[me][0]*this.width,re+Z[me][1]*(this.height-re)),be=G.pointCoordinate(ye);if(!be)continue;const qe=1/Math.hypot(be[0]-this._camera.position[0],be[1]-this._camera.position[1]);le+=be[3]*qe,de+=qe}return de===0?NaN:le/de}get center(){return this._center}set center(G){G.lat===this._center.lat&&G.lng===this._center.lng||(this._unmodified=!1,this._center=G,this._terrainEnabled()&&(this.cameraElevationReference==="ground"?this._updateCameraOnTerrain():this._updateZoomFromElevation()),this._constrain(),this._calcMatrices())}_updateZoomFromElevation(){if(this._seaLevelZoom==null||!this._elevation)return;const G=this._seaLevelZoom,Z=this._elevation.getAtPointOrZero(this.locationCoordinate(this.center)),re=this.pixelsPerMeter/this.worldSize*Z,le=this._mercatorZfromZoom(G),de=this._mercatorZfromZoom(this._maxZoom),me=Math.max(le-re,de);this._setZoom(this._zoomFromMercatorZ(me))}get padding(){return this._edgeInsets.toJSON()}set padding(G){this._edgeInsets.equals(G)||(this._unmodified=!1,this._edgeInsets.interpolate(this._edgeInsets,G,1),this._calcMatrices())}computeZoomRelativeTo(G){const Z=this.rayIntersectionCoordinate(this.pointRayIntersection(this.centerPoint,G.toAltitude()));let re;re=G.z<this._camera.position[2]?[Z.x,Z.y,Z.z]:[G.x,G.y,G.z];const le=t.length(t.sub([],this._camera.position,re));return t.clamp(this._zoomFromMercatorZ(le),this._minZoom,this._maxZoom)}setFreeCameraOptions(G){if(!this.height||!G.position&&!G.orientation)return;this._updateCameraState();let Z=!1;if(G.orientation&&!t.exactEquals(G.orientation,this._camera.orientation)&&(Z=this._setCameraOrientation(G.orientation)),G.position){const re=[G.position.x,G.position.y,G.position.z];t.exactEquals$1(re,this._camera.position)||(this._setCameraPosition(re),Z=!0)}Z&&(this._updateStateFromCamera(),this.recenterOnTerrain())}getFreeCameraOptions(){this._updateCameraState();const G=this._camera.position,Z=new mc;return Z.position=new t.MercatorCoordinate(G[0],G[1],G[2]),Z.orientation=this._camera.orientation,Z._elevation=this.elevation,Z._renderWorldCopies=this.renderWorldCopies,Z}_setCameraOrientation(G){if(!t.length$1(G))return!1;t.normalize$1(G,G);const Z=t.transformQuat([],[0,0,-1],G),re=t.transformQuat([],[0,-1,0],G);if(re[2]<0)return!1;const le=ts(Z,re);return!!le&&(this._camera.orientation=le,!0)}_setCameraPosition(G){const Z=this.zoomScale(this.minZoom)*this.tileSize,re=this.zoomScale(this.maxZoom)*this.tileSize,le=this.cameraToCenterDistance;G[2]=t.clamp(G[2],le/re,le/Z),this._camera.position=G}get centerPoint(){return this._edgeInsets.getCenter(this.width,this.height)}get fovAboveCenter(){return this._fov*(.5+this.centerOffset.y/this.height)}isPaddingEqual(G){return this._edgeInsets.equals(G)}interpolatePadding(G,Z,re){this._unmodified=!1,this._edgeInsets.interpolate(G,Z,re),this._constrain(),this._calcMatrices()}coveringZoomLevel(G){const Z=(G.roundZoom?Math.round:Math.floor)(this.zoom+this.scaleZoom(this.tileSize/G.tileSize));return Math.max(0,Z)}getVisibleUnwrappedCoordinates(G){const Z=[new t.UnwrappedTileID(0,G)];if(this.renderWorldCopies){const re=this.pointCoordinate(new t.Point(0,0)),le=this.pointCoordinate(new t.Point(this.width,0)),de=this.pointCoordinate(new t.Point(this.width,this.height)),me=this.pointCoordinate(new t.Point(0,this.height)),ye=Math.floor(Math.min(re.x,le.x,de.x,me.x)),be=Math.floor(Math.max(re.x,le.x,de.x,me.x)),qe=1;for(let Te=ye-qe;Te<=be+qe;Te++)Te!==0&&Z.push(new t.UnwrappedTileID(Te,G))}return Z}coveringTiles(G){let Z=this.coveringZoomLevel(G);const re=Z,le=this.elevation&&!G.isTerrainDEM,de=this.projection.name==="mercator";if(G.minzoom!==void 0&&Z<G.minzoom)return[];G.maxzoom!==void 0&&Z>G.maxzoom&&(Z=G.maxzoom);const me=this.locationCoordinate(this.center),ye=this.center.lat,be=1<<Z,qe=[be*me.x,be*me.y,0],Te=this.projection.name==="globe",Fe=!Te,$e=t.Frustum.fromInvProjectionMatrix(this.invProjMatrix,this.worldSize,Z,Fe),Je=Te?this._camera.mercatorPosition:this.pointCoordinate(this.getCameraPoint()),tt=be*t.mercatorZfromAltitude(1,this.center.lat),Qe=this._camera.position[2]/t.mercatorZfromAltitude(1,this.center.lat),it=[be*Je.x,be*Je.y,Qe*(Fe?1:tt)],Be=this.cameraToCenterDistance/G.tileSize*(G.roundZoom?1:.502),Ye=this.pitch<=60&&this._edgeInsets.top<=this._edgeInsets.bottom&&!this._elevation&&!this.projection.isReprojectedInTileSpace?Z:0,lt=G.isTerrainDEM&&this._elevation?1e4*this._elevation.exaggeration():this._centerAltitude,ct=G.isTerrainDEM?-lt:this._elevation?this._elevation.getMinElevationBelowMSL():0,Tt=this.projection.isReprojectedInTileSpace?yc(this):1,Rt=jt=>{const gr=new t.MercatorCoordinate(jt.x+25e-6,jt.y,jt.z),ur=new t.MercatorCoordinate(jt.x,jt.y+25e-6,jt.z),xr=jt.toLngLat(),Jr=gr.toLngLat(),hi=ur.toLngLat(),Gr=this.locationCoordinate(xr),ii=this.locationCoordinate(Jr),xi=this.locationCoordinate(hi),gi=Math.hypot(ii.x-Gr.x,ii.y-Gr.y),Zr=Math.hypot(xi.x-Gr.x,xi.y-Gr.y);return Math.sqrt(gi*Zr)*Tt/25e-6},It=jt=>{const ir=lt,gr=ct;return{aabb:t.tileAABB(this,be,0,0,0,jt,gr,ir,this.projection),zoom:0,x:0,y:0,minZ:gr,maxZ:ir,wrap:jt,fullyVisible:!1}},kt=[];let Dt=[];const Vt=Z,mr=G.reparseOverscaled?re:Z,Bt=jt=>jt*jt,nr=Bt((Qe-this._centerAltitude)*tt),Ht=jt=>{if(!this._elevation||!jt.tileID||!de)return;const ir=this._elevation.getMinMaxForTile(jt.tileID),gr=jt.aabb;ir?(gr.min[2]=ir.min,gr.max[2]=ir.max,gr.center[2]=(gr.min[2]+gr.max[2])/2):(jt.shouldSplit=pr(jt),jt.shouldSplit||(gr.min[2]=gr.max[2]=gr.center[2]=this._centerAltitude))},pr=jt=>{if(jt.zoom<Ye)return!0;if(jt.zoom===Vt)return!1;if(jt.shouldSplit!=null)return jt.shouldSplit;const ir=jt.aabb.distanceX(it),gr=jt.aabb.distanceY(it);let ur=nr,xr=1;if(Te){ur=Bt(jt.aabb.distanceZ(it));const Gr=Math.pow(2,jt.zoom),ii=t.latFromMercatorY((jt.y+1)/Gr),xi=t.latFromMercatorY(jt.y/Gr),gi=Math.min(Math.max(ye,ii),xi),Zr=t.circumferenceAtLatitude(gi)/t.circumferenceAtLatitude(ye);if(xr=gi===ye?1/Math.max(1,this._mercatorScaleRatio-.3):Math.min(1,Zr/this._mercatorScaleRatio),this.zoom<=t.GLOBE_ZOOM_THRESHOLD_MIN&&jt.zoom===Vt-1&&Zr>=.9)return!0}else if(le&&(ur=Bt(jt.aabb.distanceZ(it)*tt)),this.projection.isReprojectedInTileSpace&&re<=5){const Gr=Math.pow(2,jt.zoom),ii=Rt(new t.MercatorCoordinate((jt.x+.5)/Gr,(jt.y+.5)/Gr));xr=ii>.85?1:ii}const Jr=ir*ir+gr*gr+ur,hi=Bt((1<<Vt-jt.zoom)*Be*xr*((Gr,ii)=>{if(ii*Bt(.707)<Gr)return 1;const xi=Math.sqrt(ii/Gr);return xi/(1.4144271570014144+(Math.pow(1.1,xi-1.4144271570014144+1)-1)/(1.1-1)-1)})(Math.max(ur,nr),Jr));return Jr<hi};if(this.renderWorldCopies)for(let jt=1;jt<=3;jt++)kt.push(It(-jt)),kt.push(It(jt));for(kt.push(It(0));kt.length>0;){const jt=kt.pop(),ir=jt.x,gr=jt.y;let ur=jt.fullyVisible;if(!ur){const xr=jt.aabb.intersects($e);if(xr===0)continue;ur=xr===2}if(jt.zoom!==Vt&&pr(jt))for(let xr=0;xr<4;xr++){const Jr=(ir<<1)+xr%2,hi=(gr<<1)+(xr>>1),Gr={aabb:de?jt.aabb.quadrant(xr):t.tileAABB(this,be,jt.zoom+1,Jr,hi,jt.wrap,jt.minZ,jt.maxZ,this.projection),zoom:jt.zoom+1,x:Jr,y:hi,wrap:jt.wrap,fullyVisible:ur,tileID:void 0,shouldSplit:void 0,minZ:jt.minZ,maxZ:jt.maxZ};le&&!Te&&(Gr.tileID=new t.OverscaledTileID(jt.zoom+1===Vt?mr:jt.zoom+1,jt.wrap,jt.zoom+1,Jr,hi),Ht(Gr)),kt.push(Gr)}else{const xr=jt.zoom===Vt?mr:jt.zoom;if(G.minzoom&&G.minzoom>xr)continue;const Jr=qe[0]-(.5+ir+(jt.wrap<<jt.zoom))*(1<<Z-jt.zoom),hi=qe[1]-.5-gr,Gr=jt.tileID?jt.tileID:new t.OverscaledTileID(xr,jt.wrap,jt.zoom,ir,gr);Dt.push({tileID:Gr,distanceSq:Jr*Jr+hi*hi})}}if(this.fogCullDistSq){const jt=this.fogCullDistSq,ir=this.horizonLineFromTop();Dt=Dt.filter(gr=>{const ur=[0,0,0,1],xr=[t.EXTENT,t.EXTENT,0,1],Jr=this.calculateFogTileMatrix(gr.tileID.toUnwrapped());t.transformMat4$1(ur,ur,Jr),t.transformMat4$1(xr,xr,Jr);const hi=t.getAABBPointSquareDist(ur,xr);if(hi===0)return!0;let Gr=!1;const ii=this._elevation;if(ii&&hi>jt&&ir!==0){const xi=this.calculateProjMatrix(gr.tileID.toUnwrapped());let gi;G.isTerrainDEM||(gi=ii.getMinMaxForTile(gr.tileID)),gi||(gi={min:ct,max:lt});const Zr=t.furthestTileCorner(this.rotation),Pi=[Zr[0]*t.EXTENT,Zr[1]*t.EXTENT,gi.max];t.transformMat4(Pi,Pi,xi),Gr=(1-Pi[1])*this.height*.5<ir}return hi<jt||Gr})}return Dt.sort((jt,ir)=>jt.distanceSq-ir.distanceSq).map(jt=>jt.tileID)}resize(G,Z){this.width=G,this.height=Z,this.pixelsToGLUnits=[2/G,-2/Z],this._constrain(),this._calcMatrices()}get unmodified(){return this._unmodified}zoomScale(G){return Math.pow(2,G)}scaleZoom(G){return Math.log(G)/Math.LN2}project(G){const Z=t.clamp(G.lat,-t.MAX_MERCATOR_LATITUDE,t.MAX_MERCATOR_LATITUDE),re=this.projection.project(G.lng,Z);return new t.Point(re.x*this.worldSize,re.y*this.worldSize)}unproject(G){return this.projection.unproject(G.x/this.worldSize,G.y/this.worldSize)}get point(){return this.project(this.center)}get pointMerc(){return this.point._div(this.worldSize)}get pixelsPerMeterRatio(){return this.pixelsPerMeter/t.mercatorZfromAltitude(1,this.center.lat)/this.worldSize}setLocationAtPoint(G,Z){let re,le;const de=this.centerPoint;if(this.projection.name==="globe"){const ye=this.worldSize;re=(Z.x-de.x)/ye,le=(Z.y-de.y)/ye}else{const ye=this.pointCoordinate(Z),be=this.pointCoordinate(de);re=ye.x-be.x,le=ye.y-be.y}const me=this.locationCoordinate(G);this.setLocation(new t.MercatorCoordinate(me.x-re,me.y-le))}setLocation(G){this.center=this.coordinateLocation(G),this.projection.wrap&&(this.center=this.center.wrap())}locationPoint(G){return this.projection.locationPoint(this,G)}locationPoint3D(G){return this.projection.locationPoint(this,G,!0)}pointLocation(G){return this.coordinateLocation(this.pointCoordinate(G))}pointLocation3D(G){return this.coordinateLocation(this.pointCoordinate3D(G))}locationCoordinate(G,Z){const re=Z?t.mercatorZfromAltitude(Z,G.lat):void 0,le=this.projection.project(G.lng,G.lat);return new t.MercatorCoordinate(le.x,le.y,re)}coordinateLocation(G){return this.projection.unproject(G.x,G.y)}pointRayIntersection(G,Z){const re=Z??this._centerAltitude,le=[G.x,G.y,0,1],de=[G.x,G.y,1,1];t.transformMat4$1(le,le,this.pixelMatrixInverse),t.transformMat4$1(de,de,this.pixelMatrixInverse);const me=de[3];t.scale$1(le,le,1/le[3]),t.scale$1(de,de,1/me);const ye=le[2],be=de[2];return{p0:le,p1:de,t:ye===be?0:(re-ye)/(be-ye)}}screenPointToMercatorRay(G){const Z=[G.x,G.y,0,1],re=[G.x,G.y,1,1];return t.transformMat4$1(Z,Z,this.pixelMatrixInverse),t.transformMat4$1(re,re,this.pixelMatrixInverse),t.scale$1(Z,Z,1/Z[3]),t.scale$1(re,re,1/re[3]),Z[2]=t.mercatorZfromAltitude(Z[2],this._center.lat)*this.worldSize,re[2]=t.mercatorZfromAltitude(re[2],this._center.lat)*this.worldSize,t.scale$1(Z,Z,1/this.worldSize),t.scale$1(re,re,1/this.worldSize),new t.Ray([Z[0],Z[1],Z[2]],t.normalize([],t.sub([],re,Z)))}rayIntersectionCoordinate(G){const{p0:Z,p1:re,t:le}=G,de=t.mercatorZfromAltitude(Z[2],this._center.lat),me=t.mercatorZfromAltitude(re[2],this._center.lat);return new t.MercatorCoordinate(t.number(Z[0],re[0],le)/this.worldSize,t.number(Z[1],re[1],le)/this.worldSize,t.number(de,me,le))}pointCoordinate(G,Z=this._centerAltitude){return this.projection.pointCoordinate(this,G.x,G.y,Z)}pointCoordinate3D(G){if(!this.elevation)return this.pointCoordinate(G);let Z=this.projection.pointCoordinate3D(this,G.x,G.y);if(Z)return new t.MercatorCoordinate(Z[0],Z[1],Z[2]);let re=0,le=this.horizonLineFromTop();if(G.y>le)return this.pointCoordinate(G);const de=.02*le,me=G.clone();for(let ye=0;ye<10&&le-re>de;ye++){me.y=t.number(re,le,.66);const be=this.projection.pointCoordinate3D(this,me.x,me.y);be?(le=me.y,Z=be):re=me.y}return Z?new t.MercatorCoordinate(Z[0],Z[1],Z[2]):this.pointCoordinate(G)}isPointAboveHorizon(G){return this.projection.isPointAboveHorizon(this,G)}isPointOnSurface(G){if(G.y<0||G.y>this.height||G.x<0||G.x>this.width)return!1;if(this.elevation||this.zoom>=t.GLOBE_ZOOM_THRESHOLD_MAX)return!this.isPointAboveHorizon(G);const Z=this.pointCoordinate(G);return Z.y>=0&&Z.y<=1}_coordinatePoint(G,Z){const re=Z&&this.elevation?this.elevation.getAtPointOrZero(G,this._centerAltitude):this._centerAltitude,le=[G.x*this.worldSize,G.y*this.worldSize,re+G.toAltitude(),1];return t.transformMat4$1(le,le,this.pixelMatrix),le[3]>0?new t.Point(le[0]/le[3],le[1]/le[3]):new t.Point(Number.MAX_VALUE,Number.MAX_VALUE)}_getBoundsNonRectangular(){const{top:G,left:Z}=this._edgeInsets,re=this.height-this._edgeInsets.bottom,le=this.width-this._edgeInsets.right,de=this.pointLocation3D(new t.Point(Z,G)),me=this.pointLocation3D(new t.Point(le,G)),ye=this.pointLocation3D(new t.Point(le,re)),be=this.pointLocation3D(new t.Point(Z,re));let qe=Math.min(de.lng,me.lng,ye.lng,be.lng),Te=Math.max(de.lng,me.lng,ye.lng,be.lng),Fe=Math.min(de.lat,me.lat,ye.lat,be.lat),$e=Math.max(de.lat,me.lat,ye.lat,be.lat);const Je=Math.pow(2,-this.zoom)/16*270,tt=this.projection.name==="globe"?1:4,Qe=(it,Be,Ye,lt,ct)=>{const Tt=(it+Ye)/2,Rt=(Be+lt)/2,It=new t.Point(Tt,Rt),{lng:kt,lat:Dt}=this.pointLocation3D(It),Vt=Math.max(0,qe-kt,Fe-Dt,kt-Te,Dt-$e);qe=Math.min(qe,kt),Te=Math.max(Te,kt),Fe=Math.min(Fe,Dt),$e=Math.max($e,Dt),(ct<tt||Vt>Je)&&(Qe(it,Be,Tt,Rt,ct+1),Qe(Tt,Rt,Ye,lt,ct+1))};if(Qe(Z,G,le,G,1),Qe(le,G,le,re,1),Qe(le,re,Z,re,1),Qe(Z,re,Z,G,1),this.projection.name==="globe"){const[it,Be]=t.polesInViewport(this);it?($e=90,Te=180,qe=-180):Be&&(Fe=-90,Te=180,qe=-180)}return new t.LngLatBounds(new t.LngLat(qe,Fe),new t.LngLat(Te,$e))}_getBoundsRectangular(G,Z){const{top:re,left:le}=this._edgeInsets,de=this.height-this._edgeInsets.bottom,me=this.width-this._edgeInsets.right,ye=new t.Point(le,re),be=new t.Point(me,re),qe=new t.Point(me,de),Te=new t.Point(le,de);let Fe=this.pointCoordinate(ye,G),$e=this.pointCoordinate(be,G);const Je=this.pointCoordinate(qe,Z),tt=this.pointCoordinate(Te,Z),Qe=(it,Be)=>(Be.y-it.y)/(Be.x-it.x);return Fe.y>1&&$e.y>=0?Fe=new t.MercatorCoordinate((1-tt.y)/Qe(tt,Fe)+tt.x,1):Fe.y<0&&$e.y<=1&&(Fe=new t.MercatorCoordinate(-tt.y/Qe(tt,Fe)+tt.x,0)),$e.y>1&&Fe.y>=0?$e=new t.MercatorCoordinate((1-Je.y)/Qe(Je,$e)+Je.x,1):$e.y<0&&Fe.y<=1&&($e=new t.MercatorCoordinate(-Je.y/Qe(Je,$e)+Je.x,0)),new t.LngLatBounds().extend(this.coordinateLocation(Fe)).extend(this.coordinateLocation($e)).extend(this.coordinateLocation(tt)).extend(this.coordinateLocation(Je))}_getBoundsRectangularTerrain(){const G=this.elevation;if(!G.visibleDemTiles.length||G.isUsingMockSource())return this._getBoundsRectangular(0,0);const Z=G.visibleDemTiles.reduce((re,le)=>{if(le.dem){const de=le.dem.tree;re.min=Math.min(re.min,de.minimums[0]),re.max=Math.max(re.max,de.maximums[0])}return re},{min:Number.MAX_VALUE,max:0});return this._getBoundsRectangular(Z.min*G.exaggeration(),Z.max*G.exaggeration())}getBounds(){return this.projection.name==="mercator"||this.projection.name==="equirectangular"?this._terrainEnabled()?this._getBoundsRectangularTerrain():this._getBoundsRectangular(0,0):this._getBoundsNonRectangular()}horizonLineFromTop(G=!0){const Z=this.height/2/Math.tan(this._fov/2)/Math.tan(Math.max(this._pitch,.1))+this.centerOffset.y,re=this.height/2-Z*(1-this._horizonShift);return G?Math.max(0,re):re}getMaxBounds(){return this.maxBounds}setMaxBounds(G){this.maxBounds=G,this.minLat=-t.MAX_MERCATOR_LATITUDE,this.maxLat=t.MAX_MERCATOR_LATITUDE,this.minLng=-180,this.maxLng=180,G&&(this.minLat=G.getSouth(),this.maxLat=G.getNorth(),this.minLng=G.getWest(),this.maxLng=G.getEast(),this.maxLng<this.minLng&&(this.maxLng+=360)),this.worldMinX=t.mercatorXfromLng(this.minLng)*this.tileSize,this.worldMaxX=t.mercatorXfromLng(this.maxLng)*this.tileSize,this.worldMinY=t.mercatorYfromLat(this.maxLat)*this.tileSize,this.worldMaxY=t.mercatorYfromLat(this.minLat)*this.tileSize,this._constrain()}calculatePosMatrix(G,Z){return this.projection.createTileMatrix(this,Z,G)}calculateDistanceTileData(G){const Z=G.key,re=this._distanceTileDataCache;if(re[Z])return re[Z];const le=G.canonical,de=1/this.height,me=this.cameraWorldSize,ye=me/this.zoomScale(le.z),be=(le.x+Math.pow(2,le.z)*G.wrap)*ye,qe=le.y*ye,Te=this.point;Te.x*=me/this.worldSize,Te.y*=me/this.worldSize;const Fe=this.angle,$e=Math.sin(-Fe),Je=-Math.cos(-Fe);return re[Z]={bearing:[$e,Je],center:[(Te.x-be)*de,(Te.y-qe)*de],scale:ye/t.EXTENT*de},re[Z]}calculateFogTileMatrix(G){const Z=G.key,re=this._fogTileMatrixCache;if(re[Z])return re[Z];const le=this.projection.createTileMatrix(this,this.cameraWorldSizeForFog,G);return t.multiply(le,this.worldToFogMatrix,le),re[Z]=new Float32Array(le),re[Z]}calculateProjMatrix(G,Z=!1){const re=G.key,le=Z?this._alignedProjMatrixCache:this._projMatrixCache;if(le[re])return le[re];const de=this.calculatePosMatrix(G,this.worldSize);return t.multiply(de,this.projection.isReprojectedInTileSpace?this.mercatorMatrix:Z?this.alignedProjMatrix:this.projMatrix,de),le[re]=new Float32Array(de),le[re]}calculatePixelsToTileUnitsMatrix(G){const Z=G.tileID.key,re=this._pixelsToTileUnitsCache;if(re[Z])return re[Z];const le=function(de,me){const{scale:ye}=de.tileTransform,be=ye*t.EXTENT/(de.tileSize*Math.pow(2,me.zoom-de.tileID.overscaledZ+de.tileID.canonical.z));return qe=new Float32Array(4),$e=(Te=me.inverseAdjustmentMatrix)[1],Je=Te[2],tt=Te[3],it=(Fe=[be,be])[1],qe[0]=Te[0]*(Qe=Fe[0]),qe[1]=$e*Qe,qe[2]=Je*it,qe[3]=tt*it,qe;var qe,Te,Fe,$e,Je,tt,Qe,it}(G,this);return re[Z]=le,re[Z]}customLayerMatrix(){return this.mercatorMatrix.slice()}globeToMercatorMatrix(){if(this.projection.name==="globe"){const G=1/this.worldSize,Z=t.fromScaling([],[G,G,G]);return t.multiply(Z,Z,this.globeMatrix),Z}}recenterOnTerrain(){if(!this._elevation||this.projection.name==="globe")return;const G=this._elevation;this._updateCameraState();const Z=t.mercatorZfromAltitude(1,this._center.lat)*this.worldSize,re=this._computeCameraPosition(Z),le=this._camera.forward(),de=t.mercatorZfromAltitude(1,this._center.lat);re[2]/=de,le[2]/=de,t.normalize(le,le);const me=G.raycast(re,le,G.exaggeration());if(me){const ye=t.scaleAndAdd([],re,le,me),be=new t.MercatorCoordinate(ye[0],ye[1],t.mercatorZfromAltitude(ye[2],t.latFromMercatorY(ye[1]))),qe=(be.z+t.length([be.x-re[0],be.y-re[1],be.z-re[2]*de]))*this._pixelsPerMercatorPixel;this._seaLevelZoom=this._zoomFromMercatorZ(qe),this._centerAltitude=be.toAltitude(),this._center=this.coordinateLocation(be),this._updateZoomFromElevation(),this._constrain(),this._calcMatrices()}}_constrainCamera(G=!1){if(!this._elevation)return;const Z=this._elevation,re=t.mercatorZfromAltitude(1,this._center.lat)*this.worldSize,le=this._computeCameraPosition(re),de=Z.getAtPointOrZero(new t.MercatorCoordinate(...le)),me=this.pixelsPerMeter/this.worldSize*de,ye=this._minimumHeightOverTerrain(),be=le[2]-me;if(be<=ye)if(be<0||G){const qe=this.locationCoordinate(this._center,this._centerAltitude),Te=[le[0],le[1],qe.z-le[2]],Fe=t.length(Te);Te[2]-=(ye-be)/this._pixelsPerMercatorPixel;const $e=t.length(Te);if($e===0)return;t.scale$2(Te,Te,Fe/$e*this._pixelsPerMercatorPixel),this._camera.position=[le[0],le[1],qe.z*this._pixelsPerMercatorPixel-Te[2]],this._updateStateFromCamera()}else this._isCameraConstrained=!0}_constrain(){if(!this.center||!this.width||!this.height||this._constraining)return;this._constraining=!0;const G=this.projection.name==="globe"||this.mercatorFromTransition;if(this.projection.isReprojectedInTileSpace||G){const $e=this.center;return $e.lat=t.clamp($e.lat,this.minLat,this.maxLat),(this.maxBounds||!this.renderWorldCopies&&!G)&&($e.lng=t.clamp($e.lng,this.minLng,this.maxLng)),this.center=$e,void(this._constraining=!1)}const Z=this._unmodified,{x:re,y:le}=this.point;let de=0,me=re,ye=le;const be=this.width/2,qe=this.height/2,Te=this.worldMinY*this.scale,Fe=this.worldMaxY*this.scale;if(le-qe<Te&&(ye=Te+qe),le+qe>Fe&&(ye=Fe-qe),Fe-Te<this.height&&(de=Math.max(de,this.height/(Fe-Te)),ye=(Fe+Te)/2),this.maxBounds||!this._renderWorldCopies||!this.projection.wrap){const $e=this.worldMinX*this.scale,Je=this.worldMaxX*this.scale,tt=this.worldSize/2-($e+Je)/2;me=(re+tt+this.worldSize)%this.worldSize-tt,me-be<$e&&(me=$e+be),me+be>Je&&(me=Je-be),Je-$e<this.width&&(de=Math.max(de,this.width/(Je-$e)),me=(Je+$e)/2)}me===re&&ye===le||(this.center=this.unproject(new t.Point(me,ye))),de&&(this.zoom+=this.scaleZoom(de)),this._constrainCamera(),this._unmodified=Z,this._constraining=!1}_minZoomForBounds(){let G=Math.max(0,this.scaleZoom(this.height/(this.worldMaxY-this.worldMinY)));return this.maxBounds&&(G=Math.max(G,this.scaleZoom(this.width/(this.worldMaxX-this.worldMinX)))),G}_maxCameraBoundsDistance(){return this._mercatorZfromZoom(this._minZoomForBounds())}_calcMatrices(){if(!this.height)return;const G=this.centerOffset,Z=this.pixelsPerMeter;this.projection.name==="globe"&&(this._mercatorScaleRatio=t.mercatorZfromAltitude(1,this.center.lat)/t.mercatorZfromAltitude(1,t.GLOBE_SCALE_MATCH_LATITUDE));const re=Vs(this.projection,this.zoom,this.width,this.height,1024);this._pixelsPerMercatorPixel=this.projection.pixelSpaceConversion(this.center.lat,this.worldSize,re),this.cameraToCenterDistance=.5/Math.tan(.5*this._fov)*this.height*this._pixelsPerMercatorPixel,this._updateCameraState(),this._farZ=this.projection.farthestPixelDistance(this),this._nearZ=this.height/50;const le=this.projection.zAxisUnit==="meters"?Z:1,de=this._camera.getWorldToCamera(this.worldSize,le),me=this._camera.getCameraToClipPerspective(this._fov,this.width/this.height,this._nearZ,this._farZ);me[8]=2*-G.x/this.width,me[9]=2*G.y/this.height;let ye=t.mul([],me,de);if(this.projection.isReprojectedInTileSpace){const Rt=this.locationCoordinate(this.center),It=t.identity([]);t.translate(It,It,[Rt.x*this.worldSize,Rt.y*this.worldSize,0]),t.multiply(It,It,xo(this)),t.translate(It,It,[-Rt.x*this.worldSize,-Rt.y*this.worldSize,0]),t.multiply(ye,ye,It),this.inverseAdjustmentMatrix=function(kt){const Dt=xo(kt,!0);return He([],[Dt[0],Dt[1],Dt[4],Dt[5]])}(this)}else this.inverseAdjustmentMatrix=[1,0,0,1];this.mercatorMatrix=t.scale([],ye,[this.worldSize,this.worldSize,this.worldSize/le,1]),this.projMatrix=ye,this.invProjMatrix=t.invert(new Float64Array(16),this.projMatrix);const be=t.invert([],me);this.frustumCorners=t.FrustumCorners.fromInvProjectionMatrix(be,this.horizonLineFromTop(),this.height);const qe=new Float32Array(16);t.identity(qe),t.scale(qe,qe,[1,-1,1]),t.rotateX(qe,qe,this._pitch),t.rotateZ(qe,qe,this.angle);const Te=t.perspective(new Float32Array(16),this._fov,this.width/this.height,this._nearZ,this._farZ),Fe=(Math.PI/2-this._pitch)*(this.height/this._fov)*this._horizonShift;Te[8]=2*-G.x/this.width,Te[9]=2*(G.y+Fe)/this.height,this.skyboxMatrix=t.multiply(qe,Te,qe);const $e=this.point,Je=$e.x,tt=$e.y,Qe=this.width%2/2,it=this.height%2/2,Be=Math.cos(this.angle),Ye=Math.sin(this.angle),lt=Je-Math.round(Je)+Be*Qe+Ye*it,ct=tt-Math.round(tt)+Be*it+Ye*Qe,Tt=new Float64Array(ye);if(t.translate(Tt,Tt,[lt>.5?lt-1:lt,ct>.5?ct-1:ct,0]),this.alignedProjMatrix=Tt,ye=t.create(),t.scale(ye,ye,[this.width/2,-this.height/2,1]),t.translate(ye,ye,[1,-1,0]),this.labelPlaneMatrix=ye,ye=t.create(),t.scale(ye,ye,[1,-1,1]),t.translate(ye,ye,[-1,-1,0]),t.scale(ye,ye,[2/this.width,2/this.height,1]),this.glCoordMatrix=ye,this.pixelMatrix=t.multiply(new Float64Array(16),this.labelPlaneMatrix,this.projMatrix),this._calcFogMatrices(),this._distanceTileDataCache={},ye=t.invert(new Float64Array(16),this.pixelMatrix),!ye)throw new Error("failed to invert matrix");if(this.pixelMatrixInverse=ye,this.projection.name==="globe"||this.mercatorFromTransition){this.globeMatrix=t.calculateGlobeMatrix(this);const Rt=[this.globeMatrix[12],this.globeMatrix[13],this.globeMatrix[14]];this.globeCenterInViewSpace=t.transformMat4(Rt,Rt,de),this.globeRadius=this.worldSize/2/Math.PI-1}else this.globeMatrix=ye;this._projMatrixCache={},this._alignedProjMatrixCache={},this._pixelsToTileUnitsCache={}}_calcFogMatrices(){this._fogTileMatrixCache={};const G=this.cameraWorldSizeForFog,Z=this.cameraPixelsPerMeter,re=this._camera.position,le=1/this.height/this._pixelsPerMercatorPixel,de=[G,G,Z];t.scale$2(de,de,le),t.scale$2(re,re,-1),t.multiply$2(re,re,de);const me=t.create();t.translate(me,me,re),t.scale(me,me,de),this.mercatorFogMatrix=me,this.worldToFogMatrix=this._camera.getWorldToCameraPosition(G,Z,le)}_computeCameraPosition(G){const Z=(G=G||this.pixelsPerMeter)/this.pixelsPerMeter,re=this._camera.forward(),le=this.point,de=this._mercatorZfromZoom(this._seaLevelZoom?this._seaLevelZoom:this._zoom)*Z-G/this.worldSize*this._centerAltitude;return[le.x/this.worldSize-re[0]*de,le.y/this.worldSize-re[1]*de,G/this.worldSize*this._centerAltitude-re[2]*de]}_updateCameraState(){this.height&&(this._camera.setPitchBearing(this._pitch,this.angle),this._camera.position=this._computeCameraPosition())}_translateCameraConstrained(G){const Z=this._maxCameraBoundsDistance()*Math.cos(this._pitch),re=this._camera.position[2],le=G[2];let de=1;this.projection.wrap&&(this.center=this.center.wrap()),le>0&&(de=Math.min((Z-re)/le,1)),this._camera.position=t.scaleAndAdd([],this._camera.position,G,de),this._updateStateFromCamera()}_updateStateFromCamera(){const G=this._camera.position,Z=this._camera.forward(),{pitch:re,bearing:le}=this._camera.getPitchBearing(),de=t.mercatorZfromAltitude(this._centerAltitude,this.center.lat)*this._pixelsPerMercatorPixel,me=this._mercatorZfromZoom(this._maxZoom)*Math.cos(t.degToRad(this._maxPitch)),ye=Math.max((G[2]-de)/Math.cos(re),me),be=this._zoomFromMercatorZ(ye);t.scaleAndAdd(G,G,Z,ye),this._pitch=t.clamp(re,t.degToRad(this.minPitch),t.degToRad(this.maxPitch)),this.angle=t.wrap(le,-Math.PI,Math.PI),this._setZoom(t.clamp(be,this._minZoom,this._maxZoom)),this._updateSeaLevelZoom(),this._center=this.coordinateLocation(new t.MercatorCoordinate(G[0],G[1],G[2])),this._unmodified=!1,this._constrain(),this._calcMatrices()}_worldSizeFromZoom(G){return Math.pow(2,G)*this.tileSize}_mercatorZfromZoom(G){return this.cameraToCenterDistance/this._worldSizeFromZoom(G)}_minimumHeightOverTerrain(){const G=Math.min((this._seaLevelZoom!=null?this._seaLevelZoom:this._zoom)+4,this._maxZoom);return this._mercatorZfromZoom(G)}_zoomFromMercatorZ(G){return this.scaleZoom(this.cameraToCenterDistance/(G*this.tileSize))}zoomFromMercatorZAdjusted(G){let Z=0,re=t.GLOBE_ZOOM_THRESHOLD_MAX,le=0,de=1/0;for(;re-Z>1e-6&&re>Z;){const me=Z+.5*(re-Z),ye=this.tileSize*Math.pow(2,me),be=this.getCameraToCenterDistance(this.projection,me,ye),qe=this.scaleZoom(be/(G*this.tileSize)),Te=Math.abs(me-qe);Te<de&&(de=Te,le=me),me<qe?Z=me:re=me}return le}_terrainEnabled(){return!(!this._elevation||!this.projection.supportsTerrain&&(t.warnOnce("Terrain is not yet supported with alternate projections. Use mercator or globe to enable terrain."),1))}anyCornerOffEdge(G,Z){const re=Math.min(G.x,Z.x),le=Math.max(G.x,Z.x),de=Math.min(G.y,Z.y),me=Math.max(G.y,Z.y);if(de<this.horizonLineFromTop(!1))return!0;if(this.projection.name!=="mercator")return!1;const ye=[new t.Point(re,de),new t.Point(le,me),new t.Point(re,me),new t.Point(le,de)],be=this.renderWorldCopies?-3:0,qe=this.renderWorldCopies?4:1;for(const Te of ye){const Fe=this.pointRayIntersection(Te);if(Fe.t<0)return!0;const $e=this.rayIntersectionCoordinate(Fe);if($e.x<be||$e.y<0||$e.x>qe||$e.y>1)return!0}return!1}isHorizonVisible(){return this.pitch+t.radToDeg(this.fovAboveCenter)>88||this.anyCornerOffEdge(new t.Point(0,0),new t.Point(this.width,this.height))}zoomDeltaToMovement(G,Z){const re=t.length(t.sub([],this._camera.position,G)),le=this._zoomFromMercatorZ(re)+Z;return re-this._mercatorZfromZoom(le)}getCameraPoint(){if(this.projection.name==="globe"){const G=function([Z,re,le],de){const me=[Z,re,le,1];t.transformMat4$1(me,me,de);const ye=me[3]=Math.max(me[3],1e-6);return me[0]/=ye,me[1]/=ye,me[2]/=ye,me}([this.globeMatrix[12],this.globeMatrix[13],this.globeMatrix[14]],this.pixelMatrix);return new t.Point(G[0],G[1])}{const G=Math.tan(this._pitch)*(this.cameraToCenterDistance||1);return this.centerPoint.add(new t.Point(0,G))}}getCameraToCenterDistance(G,Z=this.zoom,re=this.worldSize){const le=Vs(G,Z,this.width,this.height,1024),de=G.pixelSpaceConversion(this.center.lat,re,le);return .5/Math.tan(.5*this._fov)*this.height*de}getWorldToCameraMatrix(){const G=this._camera.getWorldToCamera(this.worldSize,this.projection.zAxisUnit==="meters"?this.pixelsPerMeter:1);return this.projection.name==="globe"&&t.multiply(G,G,this.globeMatrix),G}}function wo(J,G){let Z=!1,re=null;const le=()=>{re=null,Z&&(J(),re=setTimeout(le,G),Z=!1)};return()=>(Z=!0,re||le(),re)}class Xu{constructor(G){this._hashName=G&&encodeURIComponent(G),t.bindAll(["_getCurrentHash","_onHashChange","_updateHash"],this),this._updateHash=wo(this._updateHashUnthrottled.bind(this),300)}addTo(G){return this._map=G,t.window.addEventListener("hashchange",this._onHashChange,!1),G.on("moveend",this._updateHash),this}remove(){return this._map?(this._map.off("moveend",this._updateHash),t.window.removeEventListener("hashchange",this._onHashChange,!1),clearTimeout(this._updateHash()),this._map=void 0,this):this}getHashString(){const G=this._map;if(!G)return"";const Z=rs(G);if(this._hashName){const re=this._hashName;let le=!1;const de=t.window.location.hash.slice(1).split("&").map(me=>{const ye=me.split("=")[0];return ye===re?(le=!0,`${ye}=${Z}`):me}).filter(me=>me);return le||de.push(`${re}=${Z}`),`#${de.join("&")}`}return`#${Z}`}_getCurrentHash(){const G=t.window.location.hash.replace("#","");if(this._hashName){let Z;return G.split("&").map(re=>re.split("=")).forEach(re=>{re[0]===this._hashName&&(Z=re)}),(Z&&Z[1]||"").split("/")}return G.split("/")}_onHashChange(){const G=this._map;if(!G)return!1;const Z=this._getCurrentHash();if(Z.length>=3&&!Z.some(re=>isNaN(re))){const re=G.dragRotate.isEnabled()&&G.touchZoomRotate.isEnabled()?+(Z[3]||0):G.getBearing();return G.jumpTo({center:[+Z[2],+Z[1]],zoom:+Z[0],bearing:re,pitch:+(Z[4]||0)}),!0}return!1}_updateHashUnthrottled(){const G=t.window.location.href.replace(/(#.+)?$/,this.getHashString());t.window.history.replaceState(t.window.history.state,null,G)}}function rs(J,G){const Z=J.getCenter(),re=Math.round(100*J.getZoom())/100,le=Math.ceil((re*Math.LN2+Math.log(512/360/.5))/Math.LN10),de=Math.pow(10,le),me=Math.round(Z.lng*de)/de,ye=Math.round(Z.lat*de)/de,be=J.getBearing(),qe=J.getPitch();let Te=G?`/${me}/${ye}/${re}`:`${re}/${ye}/${me}`;return(be||qe)&&(Te+="/"+Math.round(10*be)/10),qe&&(Te+=`/${Math.round(qe)}`),Te}const is={linearity:.3,easing:t.bezier(0,0,.3,1)},$s=t.extend({deceleration:2500,maxSpeed:1400},is),Ws=t.extend({deceleration:20,maxSpeed:1400},is),kr=t.extend({deceleration:1e3,maxSpeed:360},is),ra=t.extend({deceleration:1e3,maxSpeed:90},is);class vc{constructor(G){this._map=G,this.clear()}clear(){this._inertiaBuffer=[]}record(G){this._drainInertiaBuffer(),this._inertiaBuffer.push({time:t.exported.now(),settings:G})}_drainInertiaBuffer(){const G=this._inertiaBuffer,Z=t.exported.now();for(;G.length>0&&Z-G[0].time>160;)G.shift()}_onMoveEnd(G){if(this._map._prefersReducedMotion()||(this._drainInertiaBuffer(),this._inertiaBuffer.length<2))return;const Z={zoom:0,bearing:0,pitch:0,pan:new t.Point(0,0),pinchAround:void 0,around:void 0};for(const{settings:de}of this._inertiaBuffer)Z.zoom+=de.zoomDelta||0,Z.bearing+=de.bearingDelta||0,Z.pitch+=de.pitchDelta||0,de.panDelta&&Z.pan._add(de.panDelta),de.around&&(Z.around=de.around),de.pinchAround&&(Z.pinchAround=de.pinchAround);const re=this._inertiaBuffer[this._inertiaBuffer.length-1].time-this._inertiaBuffer[0].time,le={};if(Z.pan.mag()){const de=as(Z.pan.mag(),re,t.extend({},$s,G||{}));le.offset=Z.pan.mult(de.amount/Z.pan.mag()),le.center=this._map.transform.center,ns(le,de)}if(Z.zoom){const de=as(Z.zoom,re,Ws);le.zoom=this._map.transform.zoom+de.amount,ns(le,de)}if(Z.bearing){const de=as(Z.bearing,re,kr);le.bearing=this._map.transform.bearing+t.clamp(de.amount,-179,179),ns(le,de)}if(Z.pitch){const de=as(Z.pitch,re,ra);le.pitch=this._map.transform.pitch+de.amount,ns(le,de)}if(le.zoom||le.bearing){const de=Z.pinchAround===void 0?Z.around:Z.pinchAround;le.around=de?this._map.unproject(de):this._map.getCenter()}return this.clear(),le.noMoveStart=!0,le}}function ns(J,G){(!J.duration||J.duration<G.duration)&&(J.duration=G.duration,J.easing=G.easing)}function as(J,G,Z){const{maxSpeed:re,linearity:le,deceleration:de}=Z,me=t.clamp(J*le/(G/1e3),-re,re),ye=Math.abs(me)/(de*le);return{easing:Z.easing,duration:1e3*ye,amount:me*(ye/2)}}class vn extends t.Event{preventDefault(){this._defaultPrevented=!0}get defaultPrevented(){return this._defaultPrevented}constructor(G,Z,re,le={}){const de=Ge(Z.getCanvasContainer(),re),me=Z.unproject(de);super(G,t.extend({point:de,lngLat:me,originalEvent:re},le)),this._defaultPrevented=!1,this.target=Z}}class os extends t.Event{preventDefault(){this._defaultPrevented=!0}get defaultPrevented(){return this._defaultPrevented}constructor(G,Z,re){const le=G==="touchend"?re.changedTouches:re.touches,de=Ze(Z.getCanvasContainer(),le),me=de.map(be=>Z.unproject(be)),ye=de.reduce((be,qe,Te,Fe)=>be.add(qe.div(Fe.length)),new t.Point(0,0));super(G,{points:de,point:ye,lngLats:me,lngLat:Z.unproject(ye),originalEvent:re}),this._defaultPrevented=!1}}class Hs extends t.Event{preventDefault(){this._defaultPrevented=!0}get defaultPrevented(){return this._defaultPrevented}constructor(G,Z,re){super(G,{originalEvent:re}),this._defaultPrevented=!1}}class Yu{constructor(G,Z){this._map=G,this._clickTolerance=Z.clickTolerance}reset(){this._mousedownPos=void 0}wheel(G){return this._firePreventable(new Hs(G.type,this._map,G))}mousedown(G,Z){return this._mousedownPos=Z,this._firePreventable(new vn(G.type,this._map,G))}mouseup(G){this._map.fire(new vn(G.type,this._map,G))}preclick(G){const Z=t.extend({},G);Z.type="preclick",this._map.fire(new vn(Z.type,this._map,Z))}click(G,Z){this._mousedownPos&&this._mousedownPos.dist(Z)>=this._clickTolerance||(this.preclick(G),this._map.fire(new vn(G.type,this._map,G)))}dblclick(G){return this._firePreventable(new vn(G.type,this._map,G))}mouseover(G){this._map.fire(new vn(G.type,this._map,G))}mouseout(G){this._map.fire(new vn(G.type,this._map,G))}touchstart(G){return this._firePreventable(new os(G.type,this._map,G))}touchmove(G){this._map.fire(new os(G.type,this._map,G))}touchend(G){this._map.fire(new os(G.type,this._map,G))}touchcancel(G){this._map.fire(new os(G.type,this._map,G))}_firePreventable(G){if(this._map.fire(G),G.defaultPrevented)return{}}isEnabled(){return!0}isActive(){return!1}enable(){}disable(){}}class Zs{constructor(G){this._map=G}reset(){this._delayContextMenu=!1,this._contextMenuEvent=void 0}mousemove(G){this._map.fire(new vn(G.type,this._map,G))}mousedown(){this._delayContextMenu=!0}mouseup(){this._delayContextMenu=!1,this._contextMenuEvent&&(this._map.fire(new vn("contextmenu",this._map,this._contextMenuEvent)),delete this._contextMenuEvent)}contextmenu(G){this._delayContextMenu?this._contextMenuEvent=G:this._map.fire(new vn(G.type,this._map,G)),this._map.listens("contextmenu")&&G.preventDefault()}isEnabled(){return!0}isActive(){return!1}enable(){}disable(){}}class bc{constructor(G,Z){this._map=G,this._el=G.getCanvasContainer(),this._container=G.getContainer(),this._clickTolerance=Z.clickTolerance||1}isEnabled(){return!!this._enabled}isActive(){return!!this._active}enable(){this.isEnabled()||(this._enabled=!0)}disable(){this.isEnabled()&&(this._enabled=!1)}mousedown(G,Z){this.isEnabled()&&G.shiftKey&&G.button===0&&(Ce(),this._startPos=this._lastPos=Z,this._active=!0)}mousemoveWindow(G,Z){if(!this._active)return;const re=Z,le=this._startPos,de=this._lastPos;if(!le||!de||de.equals(re)||!this._box&&re.dist(le)<this._clickTolerance)return;this._lastPos=re,this._box||(this._box=ge("div","mapboxgl-boxzoom",this._container),this._container.classList.add("mapboxgl-crosshair"),this._fireEvent("boxzoomstart",G));const me=Math.min(le.x,re.x),ye=Math.max(le.x,re.x),be=Math.min(le.y,re.y),qe=Math.max(le.y,re.y);this._map._requestDomTask(()=>{this._box&&(this._box.style.transform=`translate(${me}px,${be}px)`,this._box.style.width=ye-me+"px",this._box.style.height=qe-be+"px")})}mouseupWindow(G,Z){if(!this._active)return;const re=this._startPos,le=Z;if(re&&G.button===0){if(this.reset(),ke(),re.x!==le.x||re.y!==le.y)return this._map.fire(new t.Event("boxzoomend",{originalEvent:G})),{cameraAnimation:de=>de.fitScreenCoordinates(re,le,this._map.getBearing(),{linear:!1})};this._fireEvent("boxzoomcancel",G)}}keydown(G){this._active&&G.keyCode===27&&(this.reset(),this._fireEvent("boxzoomcancel",G))}blur(){this.reset()}reset(){this._active=!1,this._container.classList.remove("mapboxgl-crosshair"),this._box&&(this._box.remove(),this._box=null),Ue(),delete this._startPos,delete this._lastPos}_fireEvent(G,Z){return this._map.fire(new t.Event(G,{originalEvent:Z}))}}function Ks(J,G){const Z={};for(let re=0;re<J.length;re++)Z[J[re].identifier]=G[re];return Z}class So{constructor(G){this.reset(),this.numTouches=G.numTouches}reset(){this.centroid=void 0,this.startTime=0,this.touches={},this.aborted=!1}touchstart(G,Z,re){(this.centroid||re.length>this.numTouches)&&(this.aborted=!0),this.aborted||(this.startTime===0&&(this.startTime=G.timeStamp),re.length===this.numTouches&&(this.centroid=function(le){const de=new t.Point(0,0);for(const me of le)de._add(me);return de.div(le.length)}(Z),this.touches=Ks(re,Z)))}touchmove(G,Z,re){if(this.aborted||!this.centroid)return;const le=Ks(re,Z);for(const de in this.touches){const me=le[de];(!me||me.dist(this.touches[de])>30)&&(this.aborted=!0)}}touchend(G,Z,re){if((!this.centroid||G.timeStamp-this.startTime>500)&&(this.aborted=!0),re.length===0){const le=!this.aborted&&this.centroid;if(this.reset(),le)return le}}}class Ju{constructor(G){this.singleTap=new So(G),this.numTaps=G.numTaps,this.reset()}reset(){this.lastTime=1/0,this.lastTap=void 0,this.count=0,this.singleTap.reset()}touchstart(G,Z,re){this.singleTap.touchstart(G,Z,re)}touchmove(G,Z,re){this.singleTap.touchmove(G,Z,re)}touchend(G,Z,re){const le=this.singleTap.touchend(G,Z,re);if(le){const de=G.timeStamp-this.lastTime<500,me=!this.lastTap||this.lastTap.dist(le)<30;if(de&&me||this.reset(),this.count++,this.lastTime=G.timeStamp,this.lastTap=le,this.count===this.numTaps)return this.reset(),le}}}class Ch{constructor(){this._zoomIn=new Ju({numTouches:1,numTaps:2}),this._zoomOut=new Ju({numTouches:2,numTaps:1}),this.reset()}reset(){this._active=!1,this._zoomIn.reset(),this._zoomOut.reset()}touchstart(G,Z,re){this._zoomIn.touchstart(G,Z,re),this._zoomOut.touchstart(G,Z,re)}touchmove(G,Z,re){this._zoomIn.touchmove(G,Z,re),this._zoomOut.touchmove(G,Z,re)}touchend(G,Z,re){const le=this._zoomIn.touchend(G,Z,re),de=this._zoomOut.touchend(G,Z,re);return le?(this._active=!0,G.preventDefault(),setTimeout(()=>this.reset(),0),{cameraAnimation:me=>me.easeTo({duration:300,zoom:me.getZoom()+1,around:me.unproject(le)},{originalEvent:G})}):de?(this._active=!0,G.preventDefault(),setTimeout(()=>this.reset(),0),{cameraAnimation:me=>me.easeTo({duration:300,zoom:me.getZoom()-1,around:me.unproject(de)},{originalEvent:G})}):void 0}touchcancel(){this.reset()}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}}const xc={0:1,2:2};class To{constructor(G){this.reset(),this._clickTolerance=G.clickTolerance||1}blur(){this.reset()}reset(){this._active=!1,this._moved=!1,this._lastPoint=void 0,this._eventButton=void 0}_correctButton(G,Z){return!1}_move(G,Z){return{}}mousedown(G,Z){if(this._lastPoint)return;const re=We(G);this._correctButton(G,re)&&(this._lastPoint=Z,this._eventButton=re)}mousemoveWindow(G,Z){const re=this._lastPoint;if(re){if(G.preventDefault(),this._eventButton!=null&&function(le,de){const me=xc[de];return le.buttons===void 0||(le.buttons&me)!==me}(G,this._eventButton))this.reset();else if(this._moved||!(Z.dist(re)<this._clickTolerance))return this._moved=!0,this._lastPoint=Z,this._move(re,Z)}}mouseupWindow(G){this._lastPoint&&We(G)===this._eventButton&&(this._moved&&ke(),this.reset())}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}}class Qu extends To{mousedown(G,Z){super.mousedown(G,Z),this._lastPoint&&(this._active=!0)}_correctButton(G,Z){return Z===0&&!G.ctrlKey}_move(G,Z){return{around:Z,panDelta:Z.sub(G)}}}class el extends To{_correctButton(G,Z){return Z===0&&G.ctrlKey||Z===2}_move(G,Z){const re=.8*(Z.x-G.x);if(re)return this._active=!0,{bearingDelta:re}}contextmenu(G){G.preventDefault()}}class tl extends To{_correctButton(G,Z){return Z===0&&G.ctrlKey||Z===2}_move(G,Z){const re=-.5*(Z.y-G.y);if(re)return this._active=!0,{pitchDelta:re}}contextmenu(G){G.preventDefault()}}class Xs{constructor(G,Z){this._map=G,this._el=G.getCanvasContainer(),this._minTouches=1,this._clickTolerance=Z.clickTolerance||1,this.reset(),t.bindAll(["_addTouchPanBlocker","_showTouchPanBlockerAlert"],this)}reset(){this._active=!1,this._touches={},this._sum=new t.Point(0,0)}touchstart(G,Z,re){return this._calculateTransform(G,Z,re)}touchmove(G,Z,re){if(this._active&&!(re.length<this._minTouches)){if(this._map._cooperativeGestures&&!this._map.isMoving()){if(re.length===1&&!t.isFullscreen())return void this._showTouchPanBlockerAlert();this._alertContainer.style.visibility!=="hidden"&&(this._alertContainer.style.visibility="hidden",clearTimeout(this._alertTimer))}return G.cancelable&&G.preventDefault(),this._calculateTransform(G,Z,re)}}touchend(G,Z,re){this._calculateTransform(G,Z,re),this._active&&re.length<this._minTouches&&this.reset()}touchcancel(){this.reset()}_calculateTransform(G,Z,re){re.length>0&&(this._active=!0);const le=Ks(re,Z),de=new t.Point(0,0),me=new t.Point(0,0);let ye=0;for(const qe in le){const Te=le[qe],Fe=this._touches[qe];Fe&&(de._add(Te),me._add(Te.sub(Fe)),ye++,le[qe]=Te)}if(this._touches=le,ye<this._minTouches||!me.mag())return;const be=me.div(ye);return this._sum._add(be),this._sum.mag()<this._clickTolerance?void 0:{around:de.div(ye),panDelta:be}}enable(){this._enabled=!0,this._map._cooperativeGestures&&(this._addTouchPanBlocker(),this._el.classList.add("mapboxgl-touch-pan-blocker-override","mapboxgl-scrollable-page"))}disable(){this._enabled=!1,this._map._cooperativeGestures&&(clearTimeout(this._alertTimer),this._alertContainer.remove(),this._el.classList.remove("mapboxgl-touch-pan-blocker-override","mapboxgl-scrollable-page")),this.reset()}isEnabled(){return!!this._enabled}isActive(){return!!this._active}_addTouchPanBlocker(){this._map&&!this._alertContainer&&(this._alertContainer=ge("div","mapboxgl-touch-pan-blocker",this._map._container),this._alertContainer.textContent=this._map._getUIString("TouchPanBlocker.Message"),this._alertContainer.style.fontSize=`${Math.max(10,Math.min(24,Math.floor(.05*this._el.clientWidth)))}px`)}_showTouchPanBlockerAlert(){this._alertContainer.style.visibility="visible",this._alertContainer.classList.add("mapboxgl-touch-pan-blocker-show"),this._alertContainer.setAttribute("role","alert"),clearTimeout(this._alertTimer),this._alertTimer=setTimeout(()=>{this._alertContainer.classList.remove("mapboxgl-touch-pan-blocker-show"),this._alertContainer.setAttribute("role","null")},500)}}class ss{constructor(){this.reset()}reset(){this._active=!1,this._firstTwoTouches=void 0}_start(G){}_move(G,Z,re){return{}}touchstart(G,Z,re){this._firstTwoTouches||re.length<2||(this._firstTwoTouches=[re[0].identifier,re[1].identifier],this._start([Z[0],Z[1]]))}touchmove(G,Z,re){const le=this._firstTwoTouches;if(!le)return;G.preventDefault();const[de,me]=le,ye=us(re,Z,de),be=us(re,Z,me);if(!ye||!be)return;const qe=this._aroundCenter?null:ye.add(be).div(2);return this._move([ye,be],qe,G)}touchend(G,Z,re){if(!this._firstTwoTouches)return;const[le,de]=this._firstTwoTouches,me=us(re,Z,le),ye=us(re,Z,de);me&&ye||(this._active&&ke(),this.reset())}touchcancel(){this.reset()}enable(G){this._enabled=!0,this._aroundCenter=!!G&&G.around==="center"}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}}function us(J,G,Z){for(let re=0;re<J.length;re++)if(J[re].identifier===Z)return G[re]}function rl(J,G){return Math.log(J/G)/Math.LN2}class Ec extends ss{reset(){super.reset(),this._distance=0,this._startDistance=0}_start(G){this._startDistance=this._distance=G[0].dist(G[1])}_move(G,Z){const re=this._distance;if(this._distance=G[0].dist(G[1]),this._active||!(Math.abs(rl(this._distance,this._startDistance))<.1))return this._active=!0,{zoomDelta:rl(this._distance,re),pinchAround:Z}}}function il(J,G){return 180*J.angleWith(G)/Math.PI}class wc extends ss{reset(){super.reset(),this._minDiameter=0,this._startVector=void 0,this._vector=void 0}_start(G){this._startVector=this._vector=G[0].sub(G[1]),this._minDiameter=G[0].dist(G[1])}_move(G,Z){const re=this._vector;if(this._vector=G[0].sub(G[1]),re&&(this._active||!this._isBelowThreshold(this._vector)))return this._active=!0,{bearingDelta:il(this._vector,re),pinchAround:Z}}_isBelowThreshold(G){this._minDiameter=Math.min(this._minDiameter,G.mag());const Z=25/(Math.PI*this._minDiameter)*360,re=this._startVector;if(!re)return!1;const le=il(G,re);return Math.abs(le)<Z}}function Fa(J){return Math.abs(J.y)>Math.abs(J.x)}class Sc extends ss{constructor(G){super(),this._map=G}reset(){super.reset(),this._valid=void 0,this._firstMove=void 0,this._lastPoints=void 0}_start(G){this._lastPoints=G,Fa(G[0].sub(G[1]))&&(this._valid=!1)}_move(G,Z,re){const le=this._lastPoints;if(!le)return;const de=G[0].sub(le[0]),me=G[1].sub(le[1]);return this._map._cooperativeGestures&&!t.isFullscreen()&&re.touches.length<3||(this._valid=this.gestureBeginsVertically(de,me,re.timeStamp),!this._valid)?void 0:(this._lastPoints=G,this._active=!0,{pitchDelta:(de.y+me.y)/2*-.5})}gestureBeginsVertically(G,Z,re){if(this._valid!==void 0)return this._valid;const le=G.mag()>=2,de=Z.mag()>=2;if(!le&&!de)return;if(!le||!de)return this._firstMove==null&&(this._firstMove=re),re-this._firstMove<100&&void 0;const me=G.y>0==Z.y>0;return Fa(G)&&Fa(Z)&&me}}const Tc={panStep:100,bearingStep:15,pitchStep:10};class Ph{constructor(){const G=Tc;this._panStep=G.panStep,this._bearingStep=G.bearingStep,this._pitchStep=G.pitchStep,this._rotationDisabled=!1}blur(){this.reset()}reset(){this._active=!1}keydown(G){if(G.altKey||G.ctrlKey||G.metaKey)return;let Z=0,re=0,le=0,de=0,me=0;switch(G.keyCode){case 61:case 107:case 171:case 187:Z=1;break;case 189:case 109:case 173:Z=-1;break;case 37:G.shiftKey?re=-1:(G.preventDefault(),de=-1);break;case 39:G.shiftKey?re=1:(G.preventDefault(),de=1);break;case 38:G.shiftKey?le=1:(G.preventDefault(),me=-1);break;case 40:G.shiftKey?le=-1:(G.preventDefault(),me=1);break;default:return}return this._rotationDisabled&&(re=0,le=0),{cameraAnimation:ye=>{const be=ye.getZoom();ye.easeTo({duration:300,easeId:"keyboardHandler",easing:qc,zoom:Z?Math.round(be)+Z*(G.shiftKey?2:1):be,bearing:ye.getBearing()+re*this._bearingStep,pitch:ye.getPitch()+le*this._pitchStep,offset:[-de*this._panStep,-me*this._panStep],center:ye.getCenter()},{originalEvent:G})}}}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}disableRotation(){this._rotationDisabled=!0}enableRotation(){this._rotationDisabled=!1}}function qc(J){return J*(2-J)}const nl=4.000244140625;class Ic{constructor(G,Z){this._map=G,this._el=G.getCanvasContainer(),this._handler=Z,this._delta=0,this._defaultZoomRate=.01,this._wheelZoomRate=.0022222222222222222,t.bindAll(["_onTimeout","_addScrollZoomBlocker","_showBlockerAlert"],this)}setZoomRate(G){this._defaultZoomRate=G}setWheelZoomRate(G){this._wheelZoomRate=G}isEnabled(){return!!this._enabled}isActive(){return this._active||this._finishTimeout!==void 0}isZooming(){return!!this._zooming}enable(G){this.isEnabled()||(this._enabled=!0,this._aroundCenter=!!G&&G.around==="center",this._map._cooperativeGestures&&this._addScrollZoomBlocker())}disable(){this.isEnabled()&&(this._enabled=!1,this._map._cooperativeGestures&&(clearTimeout(this._alertTimer),this._alertContainer.remove()))}wheel(G){if(!this.isEnabled())return;if(this._map._cooperativeGestures){if(!(G.ctrlKey||G.metaKey||this.isZooming()||t.isFullscreen()))return void this._showBlockerAlert();this._alertContainer.style.visibility!=="hidden"&&(this._alertContainer.style.visibility="hidden",clearTimeout(this._alertTimer))}let Z=G.deltaMode===t.window.WheelEvent.DOM_DELTA_LINE?40*G.deltaY:G.deltaY;const re=t.exported.now(),le=re-(this._lastWheelEventTime||0);this._lastWheelEventTime=re,Z!==0&&Z%nl==0?this._type="wheel":Z!==0&&Math.abs(Z)<4?this._type="trackpad":le>400?(this._type=null,this._lastValue=Z,this._timeout=setTimeout(this._onTimeout,40,G)):this._type||(this._type=Math.abs(le*Z)<200?"trackpad":"wheel",this._timeout&&(clearTimeout(this._timeout),this._timeout=null,Z+=this._lastValue)),G.shiftKey&&Z&&(Z/=4),this._type&&(this._lastWheelEvent=G,this._delta-=Z,this._active||this._start(G)),G.preventDefault()}_onTimeout(G){this._type="wheel",this._delta-=this._lastValue,this._active||this._start(G)}_start(G){if(!this._delta)return;this._frameId&&(this._frameId=null),this._active=!0,this.isZooming()||(this._zooming=!0),this._finishTimeout&&(clearTimeout(this._finishTimeout),delete this._finishTimeout);const Z=Ge(this._el,G);this._aroundPoint=this._aroundCenter?this._map.transform.centerPoint:Z,this._aroundCoord=this._map.transform.pointCoordinate3D(this._aroundPoint),this._targetZoom=void 0,this._frameId||(this._frameId=!0,this._handler._triggerRenderFrame())}renderFrame(){if(!this._frameId||(this._frameId=null,!this.isActive()))return;const G=this._map.transform;this._type==="wheel"&&G.projection.wrap&&(G._center.lng>=180||G._center.lng<=-180)&&(this._prevEase=null,this._easing=null,this._lastWheelEvent=null,this._lastWheelEventTime=0);const Z=()=>G._terrainEnabled()&&this._aroundCoord?G.computeZoomRelativeTo(this._aroundCoord):G.zoom;if(this._delta!==0){const be=this._type==="wheel"&&Math.abs(this._delta)>nl?this._wheelZoomRate:this._defaultZoomRate;let qe=2/(1+Math.exp(-Math.abs(this._delta*be)));this._delta<0&&qe!==0&&(qe=1/qe);const Te=Z(),Fe=Math.pow(2,Te),$e=typeof this._targetZoom=="number"?G.zoomScale(this._targetZoom):Fe;this._targetZoom=Math.min(G.maxZoom,Math.max(G.minZoom,G.scaleZoom($e*qe))),this._type==="wheel"&&(this._startZoom=Te,this._easing=this._smoothOutEasing(200)),this._delta=0}const re=typeof this._targetZoom=="number"?this._targetZoom:Z(),le=this._startZoom,de=this._easing;let me,ye=!1;if(this._type==="wheel"&&le&&de){const be=Math.min((t.exported.now()-this._lastWheelEventTime)/200,1),qe=de(be);me=t.number(le,re,qe),be<1?this._frameId||(this._frameId=!0):ye=!0}else me=re,ye=!0;return this._active=!0,ye&&(this._active=!1,this._finishTimeout=setTimeout(()=>{this._zooming=!1,this._handler._triggerRenderFrame(),delete this._targetZoom,delete this._finishTimeout},200)),{noInertia:!0,needsRenderFrame:!ye,zoomDelta:me-Z(),around:this._aroundPoint,aroundCoord:this._aroundCoord,originalEvent:this._lastWheelEvent}}_smoothOutEasing(G){let Z=t.ease;if(this._prevEase){const re=this._prevEase,le=(t.exported.now()-re.start)/re.duration,de=re.easing(le+.01)-re.easing(le),me=.27/Math.sqrt(de*de+1e-4)*.01,ye=Math.sqrt(.0729-me*me);Z=t.bezier(me,ye,.25,1)}return this._prevEase={start:t.exported.now(),duration:G,easing:Z},Z}blur(){this.reset()}reset(){this._active=!1}_addScrollZoomBlocker(){this._map&&!this._alertContainer&&(this._alertContainer=ge("div","mapboxgl-scroll-zoom-blocker",this._map._container),this._alertContainer.textContent=/(Mac|iPad)/i.test(t.window.navigator.userAgent)?this._map._getUIString("ScrollZoomBlocker.CmdMessage"):this._map._getUIString("ScrollZoomBlocker.CtrlMessage"),this._alertContainer.style.fontSize=`${Math.max(10,Math.min(24,Math.floor(.05*this._el.clientWidth)))}px`)}_showBlockerAlert(){this._alertContainer.style.visibility="visible",this._alertContainer.classList.add("mapboxgl-scroll-zoom-blocker-show"),this._alertContainer.setAttribute("role","alert"),clearTimeout(this._alertTimer),this._alertTimer=setTimeout(()=>{this._alertContainer.classList.remove("mapboxgl-scroll-zoom-blocker-show"),this._alertContainer.setAttribute("role","null")},200)}}class Ac{constructor(G,Z){this._clickZoom=G,this._tapZoom=Z}enable(){this._clickZoom.enable(),this._tapZoom.enable()}disable(){this._clickZoom.disable(),this._tapZoom.disable()}isEnabled(){return this._clickZoom.isEnabled()&&this._tapZoom.isEnabled()}isActive(){return this._clickZoom.isActive()||this._tapZoom.isActive()}}class In{constructor(){this.reset()}reset(){this._active=!1}blur(){this.reset()}dblclick(G,Z){return G.preventDefault(),{cameraAnimation:re=>{re.easeTo({duration:300,zoom:re.getZoom()+(G.shiftKey?-1:1),around:re.unproject(Z)},{originalEvent:G})}}}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}}class Mh{constructor(){this._tap=new Ju({numTouches:1,numTaps:1}),this.reset()}reset(){this._active=!1,this._swipePoint=void 0,this._swipeTouch=0,this._tapTime=0,this._tap.reset()}touchstart(G,Z,re){this._swipePoint||(this._tapTime&&G.timeStamp-this._tapTime>500&&this.reset(),this._tapTime?re.length>0&&(this._swipePoint=Z[0],this._swipeTouch=re[0].identifier):this._tap.touchstart(G,Z,re))}touchmove(G,Z,re){if(this._tapTime){if(this._swipePoint){if(re[0].identifier!==this._swipeTouch)return;const le=Z[0],de=le.y-this._swipePoint.y;return this._swipePoint=le,G.preventDefault(),this._active=!0,{zoomDelta:de/128}}}else this._tap.touchmove(G,Z,re)}touchend(G,Z,re){this._tapTime?this._swipePoint&&re.length===0&&this.reset():this._tap.touchend(G,Z,re)&&(this._tapTime=G.timeStamp)}touchcancel(){this.reset()}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}}class Rc{constructor(G,Z,re){this._el=G,this._mousePan=Z,this._touchPan=re}enable(G){this._inertiaOptions=G||{},this._mousePan.enable(),this._touchPan.enable(),this._el.classList.add("mapboxgl-touch-drag-pan")}disable(){this._mousePan.disable(),this._touchPan.disable(),this._el.classList.remove("mapboxgl-touch-drag-pan")}isEnabled(){return this._mousePan.isEnabled()&&this._touchPan.isEnabled()}isActive(){return this._mousePan.isActive()||this._touchPan.isActive()}}class Dh{constructor(G,Z,re){this._pitchWithRotate=G.pitchWithRotate,this._mouseRotate=Z,this._mousePitch=re}enable(){this._mouseRotate.enable(),this._pitchWithRotate&&this._mousePitch.enable()}disable(){this._mouseRotate.disable(),this._mousePitch.disable()}isEnabled(){return this._mouseRotate.isEnabled()&&(!this._pitchWithRotate||this._mousePitch.isEnabled())}isActive(){return this._mouseRotate.isActive()||this._mousePitch.isActive()}}class Lh{constructor(G,Z,re,le){this._el=G,this._touchZoom=Z,this._touchRotate=re,this._tapDragZoom=le,this._rotationDisabled=!1,this._enabled=!0}enable(G){this._touchZoom.enable(G),this._rotationDisabled||this._touchRotate.enable(G),this._tapDragZoom.enable(),this._el.classList.add("mapboxgl-touch-zoom-rotate")}disable(){this._touchZoom.disable(),this._touchRotate.disable(),this._tapDragZoom.disable(),this._el.classList.remove("mapboxgl-touch-zoom-rotate")}isEnabled(){return this._touchZoom.isEnabled()&&(this._rotationDisabled||this._touchRotate.isEnabled())&&this._tapDragZoom.isEnabled()}isActive(){return this._touchZoom.isActive()||this._touchRotate.isActive()||this._tapDragZoom.isActive()}disableRotation(){this._rotationDisabled=!0,this._touchRotate.disable()}enableRotation(){this._rotationDisabled=!1,this._touchZoom.isEnabled()&&this._touchRotate.enable()}}const Zn=J=>J.zoom||J.drag||J.pitch||J.rotate;class Oc extends t.Event{}class Fh{constructor(){this.constants=[1,1,.01],this.radius=0}setup(G,Z){const re=t.sub([],Z,G);this.radius=t.length(re[2]<0?t.div([],re,this.constants):[re[0],re[1],0])}projectRay(G){t.div(G,G,this.constants),t.normalize(G,G),t.mul$1(G,G,this.constants);const Z=t.scale$2([],G,this.radius);if(Z[2]>0){const re=t.scale$2([],[0,0,1],t.dot(Z,[0,0,1])),le=t.scale$2([],t.normalize([],[Z[0],Z[1],0]),this.radius),de=t.add([],Z,t.scale$2([],t.sub([],t.add([],le,re),Z),2));Z[0]=de[0],Z[1]=de[1]}return Z}}function ia(J){return J.panDelta&&J.panDelta.mag()||J.zoomDelta||J.bearingDelta||J.pitchDelta}class ca{constructor(G,Z){this._map=G,this._el=this._map.getCanvasContainer(),this._handlers=[],this._handlersById={},this._changes=[],this._inertia=new vc(G),this._bearingSnap=Z.bearingSnap,this._previousActiveHandlers={},this._trackingEllipsoid=new Fh,this._dragOrigin=null,this._eventsInProgress={},this._addDefaultHandlers(Z),t.bindAll(["handleEvent","handleWindowEvent"],this);const re=this._el;this._listeners=[[re,"touchstart",{passive:!0}],[re,"touchmove",{passive:!1}],[re,"touchend",void 0],[re,"touchcancel",void 0],[re,"mousedown",void 0],[re,"mousemove",void 0],[re,"mouseup",void 0],[t.window.document,"mousemove",{capture:!0}],[t.window.document,"mouseup",void 0],[re,"mouseover",void 0],[re,"mouseout",void 0],[re,"dblclick",void 0],[re,"click",void 0],[re,"keydown",{capture:!1}],[re,"keyup",void 0],[re,"wheel",{passive:!1}],[re,"contextmenu",void 0],[t.window,"blur",void 0]];for(const[le,de,me]of this._listeners)le.addEventListener(de,le===t.window.document?this.handleWindowEvent:this.handleEvent,me)}destroy(){for(const[G,Z,re]of this._listeners)G.removeEventListener(Z,G===t.window.document?this.handleWindowEvent:this.handleEvent,re)}_addDefaultHandlers(G){const Z=this._map,re=Z.getCanvasContainer();this._add("mapEvent",new Yu(Z,G));const le=Z.boxZoom=new bc(Z,G);this._add("boxZoom",le);const de=new Ch,me=new In;Z.doubleClickZoom=new Ac(me,de),this._add("tapZoom",de),this._add("clickZoom",me);const ye=new Mh;this._add("tapDragZoom",ye);const be=Z.touchPitch=new Sc(Z);this._add("touchPitch",be);const qe=new el(G),Te=new tl(G);Z.dragRotate=new Dh(G,qe,Te),this._add("mouseRotate",qe,["mousePitch"]),this._add("mousePitch",Te,["mouseRotate"]);const Fe=new Qu(G),$e=new Xs(Z,G);Z.dragPan=new Rc(re,Fe,$e),this._add("mousePan",Fe),this._add("touchPan",$e,["touchZoom","touchRotate"]);const Je=new wc,tt=new Ec;Z.touchZoomRotate=new Lh(re,tt,Je,ye),this._add("touchRotate",Je,["touchPan","touchZoom"]),this._add("touchZoom",tt,["touchPan","touchRotate"]),this._add("blockableMapEvent",new Zs(Z));const Qe=Z.scrollZoom=new Ic(Z,this);this._add("scrollZoom",Qe,["mousePan"]);const it=Z.keyboard=new Ph;this._add("keyboard",it);for(const Be of["boxZoom","doubleClickZoom","tapDragZoom","touchPitch","dragRotate","dragPan","touchZoomRotate","scrollZoom","keyboard"])G.interactive&&G[Be]&&Z[Be].enable(G[Be])}_add(G,Z,re){this._handlers.push({handlerName:G,handler:Z,allowed:re}),this._handlersById[G]=Z}stop(G){if(!this._updatingCamera){for(const{handler:Z}of this._handlers)Z.reset();this._inertia.clear(),this._fireEvents({},{},G),this._changes=[]}}isActive(){for(const{handler:G}of this._handlers)if(G.isActive())return!0;return!1}isZooming(){return!!this._eventsInProgress.zoom||this._map.scrollZoom.isZooming()}isRotating(){return!!this._eventsInProgress.rotate}isMoving(){return!!Zn(this._eventsInProgress)||this.isZooming()}_isDragging(){return!!this._eventsInProgress.drag}_blockedByActive(G,Z,re){for(const le in G)if(le!==re&&(!Z||Z.indexOf(le)<0))return!0;return!1}handleWindowEvent(G){this.handleEvent(G,`${G.type}Window`)}_getMapTouches(G){const Z=[];for(const re of G)this._el.contains(re.target)&&Z.push(re);return Z}handleEvent(G,Z){this._updatingCamera=!0;const re=G.type==="renderFrame",le=re?void 0:G,de={needsRenderFrame:!1},me={},ye={},be=G.touches?this._getMapTouches(G.touches):void 0,qe=be?Ze(this._el,be):re?void 0:Ge(this._el,G);for(const{handlerName:$e,handler:Je,allowed:tt}of this._handlers){if(!Je.isEnabled())continue;let Qe;this._blockedByActive(ye,tt,$e)?Je.reset():Je[Z||G.type]&&(Qe=Je[Z||G.type](G,qe,be),this.mergeHandlerResult(de,me,Qe,$e,le),Qe&&Qe.needsRenderFrame&&this._triggerRenderFrame()),(Qe||Je.isActive())&&(ye[$e]=Je)}const Te={};for(const $e in this._previousActiveHandlers)ye[$e]||(Te[$e]=le);this._previousActiveHandlers=ye,(Object.keys(Te).length||ia(de))&&(this._changes.push([de,me,Te]),this._triggerRenderFrame()),(Object.keys(ye).length||ia(de))&&this._map._stop(!0),this._updatingCamera=!1;const{cameraAnimation:Fe}=de;Fe&&(this._inertia.clear(),this._fireEvents({},{},!0),this._changes=[],Fe(this._map))}mergeHandlerResult(G,Z,re,le,de){if(!re)return;t.extend(G,re);const me={handlerName:le,originalEvent:re.originalEvent||de};re.zoomDelta!==void 0&&(Z.zoom=me),re.panDelta!==void 0&&(Z.drag=me),re.pitchDelta!==void 0&&(Z.pitch=me),re.bearingDelta!==void 0&&(Z.rotate=me)}_applyChanges(){const G={},Z={},re={};for(const[le,de,me]of this._changes)le.panDelta&&(G.panDelta=(G.panDelta||new t.Point(0,0))._add(le.panDelta)),le.zoomDelta&&(G.zoomDelta=(G.zoomDelta||0)+le.zoomDelta),le.bearingDelta&&(G.bearingDelta=(G.bearingDelta||0)+le.bearingDelta),le.pitchDelta&&(G.pitchDelta=(G.pitchDelta||0)+le.pitchDelta),le.around!==void 0&&(G.around=le.around),le.aroundCoord!==void 0&&(G.aroundCoord=le.aroundCoord),le.pinchAround!==void 0&&(G.pinchAround=le.pinchAround),le.noInertia&&(G.noInertia=le.noInertia),t.extend(Z,de),t.extend(re,me);this._updateMapTransform(G,Z,re),this._changes=[]}_updateMapTransform(G,Z,re){const le=this._map,de=le.transform,me=Ye=>[Ye.x,Ye.y,Ye.z];if((Ye=>{const lt=this._eventsInProgress.drag;return lt&&!this._handlersById[lt.handlerName].isActive()})()&&!ia(G)){const Ye=de.zoom;de.cameraElevationReference="sea",de.recenterOnTerrain(),de.cameraElevationReference="ground",Ye!==de.zoom&&this._map._update(!0)}if(de._isCameraConstrained&&le._stop(!0),!ia(G))return void this._fireEvents(Z,re,!0);let{panDelta:ye,zoomDelta:be,bearingDelta:qe,pitchDelta:Te,around:Fe,aroundCoord:$e,pinchAround:Je}=G;de._isCameraConstrained&&(be>0&&(be=0),de._isCameraConstrained=!1),Je!==void 0&&(Fe=Je),(be||(Ye=>Z[Ye]&&!this._eventsInProgress[Ye])("drag"))&&Fe&&(this._dragOrigin=me(de.pointCoordinate3D(Fe)),this._trackingEllipsoid.setup(de._camera.position,this._dragOrigin)),de.cameraElevationReference="sea",le._stop(!0),Fe=Fe||le.transform.centerPoint,qe&&(de.bearing+=qe),Te&&(de.pitch+=Te),de._updateCameraState();const tt=[0,0,0];if(ye)if(de.projection.name==="mercator"){const Ye=this._trackingEllipsoid.projectRay(de.screenPointToMercatorRay(Fe).dir),lt=this._trackingEllipsoid.projectRay(de.screenPointToMercatorRay(Fe.sub(ye)).dir);tt[0]=lt[0]-Ye[0],tt[1]=lt[1]-Ye[1]}else{const Ye=de.pointCoordinate(Fe);if(de.projection.name==="globe"){ye=ye.rotate(-de.angle);const lt=de._pixelsPerMercatorPixel/de.worldSize;tt[0]=-ye.x*t.mercatorScale(t.latFromMercatorY(Ye.y))*lt,tt[1]=-ye.y*t.mercatorScale(de.center.lat)*lt}else{const lt=de.pointCoordinate(Fe.sub(ye));Ye&&lt&&(tt[0]=lt.x-Ye.x,tt[1]=lt.y-Ye.y)}}const Qe=de.zoom,it=[0,0,0];if(be){const Ye=me($e||de.pointCoordinate3D(Fe)),lt={dir:t.normalize([],t.sub([],Ye,de._camera.position))};if(lt.dir[2]<0){const ct=de.zoomDeltaToMovement(Ye,be);t.scale$2(it,lt.dir,ct)}}const Be=t.add(tt,tt,it);de._translateCameraConstrained(Be),be&&Math.abs(de.zoom-Qe)>1e-4&&de.recenterOnTerrain(),de.cameraElevationReference="ground",this._map._update(),G.noInertia||this._inertia.record(G),this._fireEvents(Z,re,!0)}_fireEvents(G,Z,re){const le=Zn(this._eventsInProgress),de=Zn(G),me={};for(const Te in G){const{originalEvent:Fe}=G[Te];this._eventsInProgress[Te]||(me[`${Te}start`]=Fe),this._eventsInProgress[Te]=G[Te]}!le&&de&&this._fireEvent("movestart",de.originalEvent);for(const Te in me)this._fireEvent(Te,me[Te]);de&&this._fireEvent("move",de.originalEvent);for(const Te in G){const{originalEvent:Fe}=G[Te];this._fireEvent(Te,Fe)}const ye={};let be;for(const Te in this._eventsInProgress){const{handlerName:Fe,originalEvent:$e}=this._eventsInProgress[Te];this._handlersById[Fe].isActive()||(delete this._eventsInProgress[Te],be=Z[Fe]||$e,ye[`${Te}end`]=be)}for(const Te in ye)this._fireEvent(Te,ye[Te]);const qe=Zn(this._eventsInProgress);if(re&&(le||de)&&!qe){this._updatingCamera=!0;const Te=this._inertia._onMoveEnd(this._map.dragPan._inertiaOptions),Fe=$e=>$e!==0&&-this._bearingSnap<$e&&$e<this._bearingSnap;Te?(Fe(Te.bearing||this._map.getBearing())&&(Te.bearing=0),this._map.easeTo(Te,{originalEvent:be})):(this._map.fire(new t.Event("moveend",{originalEvent:be})),Fe(this._map.getBearing())&&this._map.resetNorth()),this._updatingCamera=!1}}_fireEvent(G,Z){this._map.fire(new t.Event(G,Z?{originalEvent:Z}:{}))}_requestFrame(){return this._map.triggerRepaint(),this._map._renderTaskQueue.add(G=>{this._frameId=void 0,this.handleEvent(new Oc("renderFrame",{timeStamp:G})),this._applyChanges()})}_triggerRenderFrame(){this._frameId===void 0&&(this._frameId=this._requestFrame())}}const Ja="map.setFreeCameraOptions(...) and map.getFreeCameraOptions() are not yet supported for non-mercator projections.";class Ys extends t.Evented{constructor(G,Z){super(),this._moving=!1,this._zooming=!1,this.transform=G,this._bearingSnap=Z.bearingSnap,this._respectPrefersReducedMotion=Z.respectPrefersReducedMotion!==!1,t.bindAll(["_renderFrameCallback"],this)}getCenter(){return new t.LngLat(this.transform.center.lng,this.transform.center.lat)}setCenter(G,Z){return this.jumpTo({center:G},Z)}panBy(G,Z,re){return G=t.Point.convert(G).mult(-1),this.panTo(this.transform.center,t.extend({offset:G},Z),re)}panTo(G,Z,re){return this.easeTo(t.extend({center:G},Z),re)}getZoom(){return this.transform.zoom}setZoom(G,Z){return this.jumpTo({zoom:G},Z),this}zoomTo(G,Z,re){return this.easeTo(t.extend({zoom:G},Z),re)}zoomIn(G,Z){return this.zoomTo(this.getZoom()+1,G,Z),this}zoomOut(G,Z){return this.zoomTo(this.getZoom()-1,G,Z),this}getBearing(){return this.transform.bearing}setBearing(G,Z){return this.jumpTo({bearing:G},Z),this}getPadding(){return this.transform.padding}setPadding(G,Z){return this.jumpTo({padding:G},Z),this}rotateTo(G,Z,re){return this.easeTo(t.extend({bearing:G},Z),re)}resetNorth(G,Z){return this.rotateTo(0,t.extend({duration:1e3},G),Z),this}resetNorthPitch(G,Z){return this.easeTo(t.extend({bearing:0,pitch:0,duration:1e3},G),Z),this}snapToNorth(G,Z){return Math.abs(this.getBearing())<this._bearingSnap?this.resetNorth(G,Z):this}getPitch(){return this.transform.pitch}setPitch(G,Z){return this.jumpTo({pitch:G},Z),this}cameraForBounds(G,Z){G=t.LngLatBounds.convert(G);const re=Z&&Z.bearing||0,le=Z&&Z.pitch||0,de=G.getNorthWest(),me=G.getSouthEast();return this._cameraForBounds(this.transform,de,me,re,le,Z)}_extendCameraOptions(G){const Z={top:0,bottom:0,right:0,left:0};if(typeof(G=t.extend({padding:Z,offset:[0,0],maxZoom:this.transform.maxZoom},G)).padding=="number"){const re=G.padding;G.padding={top:re,bottom:re,right:re,left:re}}return G.padding=t.extend(Z,G.padding),G}_minimumAABBFrustumDistance(G,Z){const re=Z.max[0]-Z.min[0],le=Z.max[1]-Z.min[1];return re/le>G.aspect?re/(2*Math.tan(.5*G.fovX)*G.aspect):le/(2*Math.tan(.5*G.fovY)*G.aspect)}_cameraForBoundsOnGlobe(G,Z,re,le,de,me){const ye=G.clone(),be=this._extendCameraOptions(me);ye.bearing=le,ye.pitch=de;const qe=t.LngLat.convert(Z),Te=t.LngLat.convert(re),Fe=.5*(qe.lat+Te.lat),$e=.5*(qe.lng+Te.lng),Je=t.latLngToECEF(Fe,$e),tt=t.normalize([],Je),Qe=t.normalize([],t.cross([],tt,[0,1,0])),it=t.cross([],Qe,tt),Be=[Qe[0],Qe[1],Qe[2],0,it[0],it[1],it[2],0,tt[0],tt[1],tt[2],0,0,0,0,1],Ye=[Je,t.latLngToECEF(qe.lat,qe.lng),t.latLngToECEF(Te.lat,qe.lng),t.latLngToECEF(Te.lat,Te.lng),t.latLngToECEF(qe.lat,Te.lng),t.latLngToECEF(Fe,qe.lng),t.latLngToECEF(Fe,Te.lng),t.latLngToECEF(qe.lat,$e),t.latLngToECEF(Te.lat,$e)];let lt=t.Aabb.fromPoints(Ye.map(ur=>[t.dot(Qe,ur),t.dot(it,ur),t.dot(tt,ur)]));const ct=t.transformMat4([],lt.center,Be);t.squaredLength(ct)===0&&t.set(ct,0,0,1),t.normalize(ct,ct),t.scale$2(ct,ct,t.GLOBE_RADIUS),ye.center=t.ecefToLatLng(ct);const Tt=ye.getWorldToCameraMatrix(),Rt=t.invert(new Float64Array(16),Tt);lt=t.Aabb.applyTransform(lt,t.multiply([],Tt,Be)),t.transformMat4(ct,ct,Tt);const It=.5*(lt.max[2]-lt.min[2]),kt=this._minimumAABBFrustumDistance(ye,lt),Dt=t.scale$2([],[0,0,1],It),Vt=t.add(Dt,ct,Dt),mr=kt+(ye.pitch===0?0:t.distance(ct,Vt)),Bt=ye.globeCenterInViewSpace,nr=t.sub([],ct,[Bt[0],Bt[1],Bt[2]]);t.normalize(nr,nr),t.scale$2(nr,nr,mr);const Ht=t.add([],ct,nr);t.transformMat4(Ht,Ht,Rt);const pr=t.earthRadius/t.GLOBE_RADIUS,jt=t.length(Ht),ir=t.mercatorZfromAltitude(Math.max(jt*pr-t.earthRadius,Number.EPSILON),0),gr=Math.min(ye.zoomFromMercatorZAdjusted(ir),be.maxZoom);return gr>.5*(t.GLOBE_ZOOM_THRESHOLD_MIN+t.GLOBE_ZOOM_THRESHOLD_MAX)?(ye.setProjection({name:"mercator"}),ye.zoom=gr,this._cameraForBounds(ye,Z,re,le,de,me)):{center:ye.center,zoom:gr,bearing:le,pitch:de}}queryTerrainElevation(G,Z){const re=this.transform.elevation;return re?(Z=t.extend({},{exaggerated:!0},Z),re.getAtPoint(t.MercatorCoordinate.fromLngLat(G),null,Z.exaggerated)):null}_cameraForBounds(G,Z,re,le,de,me){if(G.projection.name==="globe")return this._cameraForBoundsOnGlobe(G,Z,re,le,de,me);const ye=G.clone(),be=this._extendCameraOptions(me),qe=ye.padding;ye.bearing=le,ye.pitch=de;const Te=t.LngLat.convert(Z),Fe=t.LngLat.convert(re),$e=new t.LngLat(Te.lng,Fe.lat),Je=new t.LngLat(Fe.lng,Te.lat),tt=ye.project(Te),Qe=ye.project(Fe),it=this.queryTerrainElevation(Te),Be=this.queryTerrainElevation(Fe),Ye=this.queryTerrainElevation($e),lt=this.queryTerrainElevation(Je),ct=[[tt.x,tt.y,Math.min(it||0,Be||0,Ye||0,lt||0)],[Qe.x,Qe.y,Math.max(it||0,Be||0,Ye||0,lt||0)]];let Tt=t.Aabb.fromPoints(ct);const Rt=ye.getWorldToCameraMatrix(),It=t.invert(new Float64Array(16),Rt);Tt=t.Aabb.applyTransform(Tt,Rt);const kt=t.sub([],Tt.max,Tt.min),Dt=qe.left||0,Vt=qe.right||0,mr=qe.bottom||0,Bt=qe.top||0,{left:nr,right:Ht,top:pr,bottom:jt}=be.padding,ir=.5*(Dt+Vt),gr=.5*(Bt+mr),ur=Math.min(ye.scaleZoom(ye.scale*Math.min((ye.width-(Dt+Vt+nr+Ht))/kt[0],(ye.height-(mr+Bt+jt+pr))/kt[1])),be.maxZoom),xr=ye.scale/ye.zoomScale(ur);Tt=new t.Aabb([Tt.min[0]-(nr+ir)*xr,Tt.min[1]-(jt+gr)*xr,Tt.min[2]],[Tt.max[0]+(Ht+ir)*xr,Tt.max[1]+(pr+gr)*xr,Tt.max[2]]);const Jr=.5*kt[2],hi=this._minimumAABBFrustumDistance(ye,Tt),Gr=[0,0,1,0];t.transformMat4$1(Gr,Gr,Rt),t.normalize$2(Gr,Gr);const ii=t.scale$2([],Gr,hi+Jr),xi=t.add([],Tt.center,ii),gi=(typeof be.offset.x=="number"&&typeof be.offset.y=="number"?new t.Point(be.offset.x,be.offset.y):t.Point.convert(be.offset)).rotate(-t.degToRad(le));Tt.center[0]-=gi.x*xr,Tt.center[1]+=gi.y*xr,t.transformMat4(Tt.center,Tt.center,It),t.transformMat4(xi,xi,It);const Zr=[Tt.center[0],Tt.center[1],xi[2]*ye.pixelsPerMeter];t.scale$2(Zr,Zr,1/ye.worldSize);const Pi=t.lngFromMercatorX(Zr[0]),Di=t.latFromMercatorY(Zr[1]),Li=Math.min(ye._zoomFromMercatorZ(Zr[2]),be.maxZoom),Fi=new t.LngLat(Pi,Di);return ye.mercatorFromTransition&&Li<.5*(t.GLOBE_ZOOM_THRESHOLD_MIN+t.GLOBE_ZOOM_THRESHOLD_MAX)?(ye.setProjection({name:"globe"}),ye.zoom=Li,this._cameraForBounds(ye,Z,re,le,de,me)):{center:Fi,zoom:Li,bearing:le,pitch:de}}fitBounds(G,Z,re){const le=this.cameraForBounds(G,Z);return this._fitInternal(le,Z,re)}fitScreenCoordinates(G,Z,re,le,de){const me=t.Point.convert(G),ye=t.Point.convert(Z),be=new t.Point(Math.min(me.x,ye.x),Math.min(me.y,ye.y)),qe=new t.Point(Math.max(me.x,ye.x),Math.max(me.y,ye.y));if(this.transform.projection.name==="mercator"&&this.transform.anyCornerOffEdge(me,ye))return this;const Te=this.transform.pointLocation3D(be),Fe=this.transform.pointLocation3D(qe),$e=this.transform.pointLocation3D(new t.Point(be.x,qe.y)),Je=this.transform.pointLocation3D(new t.Point(qe.x,be.y)),tt=[Math.min(Te.lng,Fe.lng,$e.lng,Je.lng),Math.min(Te.lat,Fe.lat,$e.lat,Je.lat)],Qe=[Math.max(Te.lng,Fe.lng,$e.lng,Je.lng),Math.max(Te.lat,Fe.lat,$e.lat,Je.lat)],it=le&&le.pitch?le.pitch:this.getPitch(),Be=this._cameraForBounds(this.transform,tt,Qe,re,it,le);return this._fitInternal(Be,le,de)}_fitInternal(G,Z,re){return G?(delete(Z=t.extend(G,Z)).padding,Z.linear?this.easeTo(Z,re):this.flyTo(Z,re)):this}jumpTo(G,Z){this.stop();const re=G.preloadOnly?this.transform.clone():this.transform;let le=!1,de=!1,me=!1;return"zoom"in G&&re.zoom!==+G.zoom&&(le=!0,re.zoom=+G.zoom),G.center!==void 0&&(re.center=t.LngLat.convert(G.center)),"bearing"in G&&re.bearing!==+G.bearing&&(de=!0,re.bearing=+G.bearing),"pitch"in G&&re.pitch!==+G.pitch&&(me=!0,re.pitch=+G.pitch),G.padding==null||re.isPaddingEqual(G.padding)||(re.padding=G.padding),G.preloadOnly?(this._preloadTiles(re),this):(this.fire(new t.Event("movestart",Z)).fire(new t.Event("move",Z)),le&&this.fire(new t.Event("zoomstart",Z)).fire(new t.Event("zoom",Z)).fire(new t.Event("zoomend",Z)),de&&this.fire(new t.Event("rotatestart",Z)).fire(new t.Event("rotate",Z)).fire(new t.Event("rotateend",Z)),me&&this.fire(new t.Event("pitchstart",Z)).fire(new t.Event("pitch",Z)).fire(new t.Event("pitchend",Z)),this.fire(new t.Event("moveend",Z)))}getFreeCameraOptions(){return this.transform.projection.supportsFreeCamera||t.warnOnce(Ja),this.transform.getFreeCameraOptions()}setFreeCameraOptions(G,Z){const re=this.transform;if(!re.projection.supportsFreeCamera)return t.warnOnce(Ja),this;this.stop();const le=re.zoom,de=re.pitch,me=re.bearing;re.setFreeCameraOptions(G);const ye=le!==re.zoom,be=de!==re.pitch,qe=me!==re.bearing;return this.fire(new t.Event("movestart",Z)).fire(new t.Event("move",Z)),ye&&this.fire(new t.Event("zoomstart",Z)).fire(new t.Event("zoom",Z)).fire(new t.Event("zoomend",Z)),qe&&this.fire(new t.Event("rotatestart",Z)).fire(new t.Event("rotate",Z)).fire(new t.Event("rotateend",Z)),be&&this.fire(new t.Event("pitchstart",Z)).fire(new t.Event("pitch",Z)).fire(new t.Event("pitchend",Z)),this.fire(new t.Event("moveend",Z)),this}easeTo(G,Z){this._stop(!1,G.easeId),((G=t.extend({offset:[0,0],duration:500,easing:t.ease},G)).animate===!1||this._prefersReducedMotion(G))&&(G.duration=0);const re=this.transform,le=this.getZoom(),de=this.getBearing(),me=this.getPitch(),ye=this.getPadding(),be="zoom"in G?+G.zoom:le,qe="bearing"in G?this._normalizeBearing(G.bearing,de):de,Te="pitch"in G?+G.pitch:me,Fe="padding"in G?G.padding:re.padding,$e=t.Point.convert(G.offset);let Je,tt,Qe;if(re.projection.name==="globe"){const Dt=t.MercatorCoordinate.fromLngLat(re.center),Vt=$e.rotate(-re.angle);Dt.x+=Vt.x/re.worldSize,Dt.y+=Vt.y/re.worldSize;const mr=Dt.toLngLat(),Bt=t.LngLat.convert(G.center||mr);this._normalizeCenter(Bt),Je=re.centerPoint.add(Vt),tt=new t.Point(Dt.x,Dt.y).mult(re.worldSize),Qe=new t.Point(t.mercatorXfromLng(Bt.lng),t.mercatorYfromLat(Bt.lat)).mult(re.worldSize).sub(tt)}else{Je=re.centerPoint.add($e);const Dt=re.pointLocation(Je),Vt=t.LngLat.convert(G.center||Dt);this._normalizeCenter(Vt),tt=re.project(Dt),Qe=re.project(Vt).sub(tt)}const it=re.zoomScale(be-le);let Be,Ye;G.around&&(Be=t.LngLat.convert(G.around),Ye=re.locationPoint(Be));const lt=this._zooming||be!==le,ct=this._rotating||de!==qe,Tt=this._pitching||Te!==me,Rt=!re.isPaddingEqual(Fe),It=Dt=>Vt=>{if(lt&&(Dt.zoom=t.number(le,be,Vt)),ct&&(Dt.bearing=t.number(de,qe,Vt)),Tt&&(Dt.pitch=t.number(me,Te,Vt)),Rt&&(Dt.interpolatePadding(ye,Fe,Vt),Je=Dt.centerPoint.add($e)),Be)Dt.setLocationAtPoint(Be,Ye);else{const mr=Dt.zoomScale(Dt.zoom-le),Bt=be>le?Math.min(2,it):Math.max(.5,it),nr=Math.pow(Bt,1-Vt),Ht=Dt.unproject(tt.add(Qe.mult(Vt*nr)).mult(mr));Dt.setLocationAtPoint(Dt.renderWorldCopies?Ht.wrap():Ht,Je)}return G.preloadOnly||this._fireMoveEvents(Z),Dt};if(G.preloadOnly){const Dt=this._emulate(It,G.duration,re);return this._preloadTiles(Dt),this}const kt={moving:this._moving,zooming:this._zooming,rotating:this._rotating,pitching:this._pitching};return this._zooming=lt,this._rotating=ct,this._pitching=Tt,this._padding=Rt,this._easeId=G.easeId,this._prepareEase(Z,G.noMoveStart,kt),this._ease(It(re),Dt=>{re.recenterOnTerrain(),this._afterEase(Z,Dt)},G),this}_prepareEase(G,Z,re={}){this._moving=!0,this.transform.cameraElevationReference="sea",Z||re.moving||this.fire(new t.Event("movestart",G)),this._zooming&&!re.zooming&&this.fire(new t.Event("zoomstart",G)),this._rotating&&!re.rotating&&this.fire(new t.Event("rotatestart",G)),this._pitching&&!re.pitching&&this.fire(new t.Event("pitchstart",G))}_fireMoveEvents(G){this.fire(new t.Event("move",G)),this._zooming&&this.fire(new t.Event("zoom",G)),this._rotating&&this.fire(new t.Event("rotate",G)),this._pitching&&this.fire(new t.Event("pitch",G))}_afterEase(G,Z){if(this._easeId&&Z&&this._easeId===Z)return;this._easeId=void 0,this.transform.cameraElevationReference="ground";const re=this._zooming,le=this._rotating,de=this._pitching;this._moving=!1,this._zooming=!1,this._rotating=!1,this._pitching=!1,this._padding=!1,re&&this.fire(new t.Event("zoomend",G)),le&&this.fire(new t.Event("rotateend",G)),de&&this.fire(new t.Event("pitchend",G)),this.fire(new t.Event("moveend",G))}flyTo(G,Z){if(this._prefersReducedMotion(G)){const ur=t.pick(G,["center","zoom","bearing","pitch","around"]);return this.jumpTo(ur,Z)}this.stop(),G=t.extend({offset:[0,0],speed:1.2,curve:1.42,easing:t.ease},G);const re=this.transform,le=this.getZoom(),de=this.getBearing(),me=this.getPitch(),ye=this.getPadding(),be="zoom"in G?t.clamp(+G.zoom,re.minZoom,re.maxZoom):le,qe="bearing"in G?this._normalizeBearing(G.bearing,de):de,Te="pitch"in G?+G.pitch:me,Fe="padding"in G?G.padding:re.padding,$e=re.zoomScale(be-le),Je=t.Point.convert(G.offset);let tt=re.centerPoint.add(Je);const Qe=re.pointLocation(tt),it=t.LngLat.convert(G.center||Qe);this._normalizeCenter(it);const Be=re.project(Qe),Ye=re.project(it).sub(Be);let lt=G.curve;const ct=Math.max(re.width,re.height),Tt=ct/$e,Rt=Ye.mag();if("minZoom"in G){const ur=t.clamp(Math.min(G.minZoom,le,be),re.minZoom,re.maxZoom),xr=ct/re.zoomScale(ur-le);lt=Math.sqrt(xr/Rt*2)}const It=lt*lt;function kt(ur){const xr=(Tt*Tt-ct*ct+(ur?-1:1)*It*It*Rt*Rt)/(2*(ur?Tt:ct)*It*Rt);return Math.log(Math.sqrt(xr*xr+1)-xr)}function Dt(ur){return(Math.exp(ur)-Math.exp(-ur))/2}function Vt(ur){return(Math.exp(ur)+Math.exp(-ur))/2}const mr=kt(0);let Bt=function(ur){return Vt(mr)/Vt(mr+lt*ur)},nr=function(ur){return ct*((Vt(mr)*(Dt(xr=mr+lt*ur)/Vt(xr))-Dt(mr))/It)/Rt;var xr},Ht=(kt(1)-mr)/lt;if(Math.abs(Rt)<1e-6||!isFinite(Ht)){if(Math.abs(ct-Tt)<1e-6)return this.easeTo(G,Z);const ur=Tt<ct?-1:1;Ht=Math.abs(Math.log(Tt/ct))/lt,nr=function(){return 0},Bt=function(xr){return Math.exp(ur*lt*xr)}}G.duration="duration"in G?+G.duration:1e3*Ht/("screenSpeed"in G?+G.screenSpeed/lt:+G.speed),G.maxDuration&&G.duration>G.maxDuration&&(G.duration=0);const pr=de!==qe,jt=Te!==me,ir=!re.isPaddingEqual(Fe),gr=ur=>xr=>{const Jr=xr*Ht,hi=1/Bt(Jr);ur.zoom=xr===1?be:le+ur.scaleZoom(hi),pr&&(ur.bearing=t.number(de,qe,xr)),jt&&(ur.pitch=t.number(me,Te,xr)),ir&&(ur.interpolatePadding(ye,Fe,xr),tt=ur.centerPoint.add(Je));const Gr=xr===1?it:ur.unproject(Be.add(Ye.mult(nr(Jr))).mult(hi));return ur.setLocationAtPoint(ur.renderWorldCopies?Gr.wrap():Gr,tt),ur._updateCameraOnTerrain(),G.preloadOnly||this._fireMoveEvents(Z),ur};if(G.preloadOnly){const ur=this._emulate(gr,G.duration,re);return this._preloadTiles(ur),this}return this._zooming=!0,this._rotating=pr,this._pitching=jt,this._padding=ir,this._prepareEase(Z,!1),this._ease(gr(re),()=>this._afterEase(Z),G),this}isEasing(){return!!this._easeFrameId}stop(){return this._stop()}_stop(G,Z){if(this._easeFrameId&&(this._cancelRenderFrame(this._easeFrameId),this._easeFrameId=void 0,this._onEaseFrame=void 0),this._onEaseEnd){const re=this._onEaseEnd;this._onEaseEnd=void 0,re.call(this,Z)}if(!G){const re=this.handlers;re&&re.stop(!1)}return this}_ease(G,Z,re){re.animate===!1||re.duration===0?(G(1),Z()):(this._easeStart=t.exported.now(),this._easeOptions=re,this._onEaseFrame=G,this._onEaseEnd=Z,this._easeFrameId=this._requestRenderFrame(this._renderFrameCallback))}_renderFrameCallback(){const G=Math.min((t.exported.now()-this._easeStart)/this._easeOptions.duration,1),Z=this._onEaseFrame;Z&&Z(this._easeOptions.easing(G)),G<1?this._easeFrameId=this._requestRenderFrame(this._renderFrameCallback):this.stop()}_normalizeBearing(G,Z){G=t.wrap(G,-180,180);const re=Math.abs(G-Z);return Math.abs(G-360-Z)<re&&(G-=360),Math.abs(G+360-Z)<re&&(G+=360),G}_normalizeCenter(G){const Z=this.transform;if(!Z.renderWorldCopies||Z.maxBounds)return;const re=G.lng-Z.center.lng;G.lng+=re>180?-360:re<-180?360:0}_prefersReducedMotion(G){return this._respectPrefersReducedMotion&&t.exported.prefersReducedMotion&&!(G&&G.essential)}_emulate(G,Z,re){const le=Math.ceil(15*Z/1e3),de=[],me=G(re.clone());for(let ye=0;ye<=le;ye++){const be=me(ye/le);de.push(be.clone())}return de}}class Vr{constructor(G={}){this.options=G,t.bindAll(["_toggleAttribution","_updateEditLink","_updateData","_updateCompact"],this)}getDefaultPosition(){return"bottom-right"}onAdd(G){const Z=this.options&&this.options.compact;return this._map=G,this._container=ge("div","mapboxgl-ctrl mapboxgl-ctrl-attrib"),this._compactButton=ge("button","mapboxgl-ctrl-attrib-button",this._container),ge("span","mapboxgl-ctrl-icon",this._compactButton).setAttribute("aria-hidden","true"),this._compactButton.type="button",this._compactButton.addEventListener("click",this._toggleAttribution),this._setElementTitle(this._compactButton,"ToggleAttribution"),this._innerContainer=ge("div","mapboxgl-ctrl-attrib-inner",this._container),this._innerContainer.setAttribute("role","list"),Z&&this._container.classList.add("mapboxgl-compact"),this._updateAttributions(),this._updateEditLink(),this._map.on("styledata",this._updateData),this._map.on("sourcedata",this._updateData),this._map.on("moveend",this._updateEditLink),Z===void 0&&(this._map.on("resize",this._updateCompact),this._updateCompact()),this._container}onRemove(){this._container.remove(),this._map.off("styledata",this._updateData),this._map.off("sourcedata",this._updateData),this._map.off("moveend",this._updateEditLink),this._map.off("resize",this._updateCompact),this._map=void 0,this._attribHTML=void 0}_setElementTitle(G,Z){const re=this._map._getUIString(`AttributionControl.${Z}`);G.setAttribute("aria-label",re),G.removeAttribute("title"),G.firstElementChild&&G.firstElementChild.setAttribute("title",re)}_toggleAttribution(){this._container.classList.contains("mapboxgl-compact-show")?(this._container.classList.remove("mapboxgl-compact-show"),this._compactButton.setAttribute("aria-expanded","false")):(this._container.classList.add("mapboxgl-compact-show"),this._compactButton.setAttribute("aria-expanded","true"))}_updateEditLink(){let G=this._editLink;G||(G=this._editLink=this._container.querySelector(".mapbox-improve-map"));const Z=[{key:"owner",value:this.styleOwner},{key:"id",value:this.styleId},{key:"access_token",value:this._map._requestManager._customAccessToken||t.config.ACCESS_TOKEN}];if(G){const re=Z.reduce((le,de,me)=>(de.value&&(le+=`${de.key}=${de.value}${me<Z.length-1?"&":""}`),le),"?");G.href=`${t.config.FEEDBACK_URL}/${re}#${rs(this._map,!0)}`,G.rel="noopener nofollow",this._setElementTitle(G,"MapFeedback")}}_updateData(G){!G||G.sourceDataType!=="metadata"&&G.sourceDataType!=="visibility"&&G.dataType!=="style"||(this._updateAttributions(),this._updateEditLink())}_updateAttributions(){if(!this._map.style)return;let G=[];if(this._map.style.stylesheet){const le=this._map.style.stylesheet;this.styleOwner=le.owner,this.styleId=le.id}const Z=this._map.style._sourceCaches;for(const le in Z){const de=Z[le];if(de.used){const me=de.getSource();me.attribution&&G.indexOf(me.attribution)<0&&G.push(me.attribution)}}G.sort((le,de)=>le.length-de.length),G=G.filter((le,de)=>{for(let me=de+1;me<G.length;me++)if(G[me].indexOf(le)>=0)return!1;return!0}),this.options.customAttribution&&(Array.isArray(this.options.customAttribution)?G=[...this.options.customAttribution,...G]:G.unshift(this.options.customAttribution));const re=G.join(" | ");re!==this._attribHTML&&(this._attribHTML=re,G.length?(this._innerContainer.innerHTML=re,this._container.classList.remove("mapboxgl-attrib-empty")):this._container.classList.add("mapboxgl-attrib-empty"),this._editLink=null)}_updateCompact(){this._map.getCanvasContainer().offsetWidth<=640?this._container.classList.add("mapboxgl-compact"):this._container.classList.remove("mapboxgl-compact","mapboxgl-compact-show")}}class al{constructor(){t.bindAll(["_updateLogo","_updateCompact"],this)}onAdd(G){this._map=G,this._container=ge("div","mapboxgl-ctrl");const Z=ge("a","mapboxgl-ctrl-logo");return Z.target="_blank",Z.rel="noopener nofollow",Z.href="https://www.mapbox.com/",Z.setAttribute("aria-label",this._map._getUIString("LogoControl.Title")),Z.setAttribute("rel","noopener nofollow"),this._container.appendChild(Z),this._container.style.display="none",this._map.on("sourcedata",this._updateLogo),this._updateLogo(),this._map.on("resize",this._updateCompact),this._updateCompact(),this._container}onRemove(){this._container.remove(),this._map.off("sourcedata",this._updateLogo),this._map.off("resize",this._updateCompact)}getDefaultPosition(){return"bottom-left"}_updateLogo(G){G&&G.sourceDataType!=="metadata"||(this._container.style.display=this._logoRequired()?"block":"none")}_logoRequired(){if(!this._map.style)return!0;const G=this._map.style._sourceCaches;if(Object.entries(G).length===0)return!0;for(const Z in G){const re=G[Z].getSource();if(re.hasOwnProperty("mapbox_logo")&&!re.mapbox_logo)return!1}return!0}_updateCompact(){const G=this._container.children;if(G.length){const Z=G[0];this._map.getCanvasContainer().offsetWidth<250?Z.classList.add("mapboxgl-compact"):Z.classList.remove("mapboxgl-compact")}}}class ol{constructor(){this._queue=[],this._id=0,this._cleared=!1,this._currentlyRunning=!1}add(G){const Z=++this._id;return this._queue.push({callback:G,id:Z,cancelled:!1}),Z}remove(G){const Z=this._currentlyRunning,re=Z?this._queue.concat(Z):this._queue;for(const le of re)if(le.id===G)return void(le.cancelled=!0)}run(G=0){const Z=this._currentlyRunning=this._queue;this._queue=[];for(const re of Z)if(!re.cancelled&&(re.callback(G),this._cleared))break;this._cleared=!1,this._currentlyRunning=!1}clear(){this._currentlyRunning&&(this._cleared=!0),this._queue=[]}}function qo(J,G,Z){if(J=new t.LngLat(J.lng,J.lat),G){const re=new t.LngLat(J.lng-360,J.lat),le=new t.LngLat(J.lng+360,J.lat),de=360*Math.ceil(Math.abs(J.lng-Z.center.lng)/360),me=Z.locationPoint(J).distSqr(G),ye=G.x<0||G.y<0||G.x>Z.width||G.y>Z.height;Z.locationPoint(re).distSqr(G)<me&&(ye||Math.abs(re.lng-Z.center.lng)<de)?J=re:Z.locationPoint(le).distSqr(G)<me&&(ye||Math.abs(le.lng-Z.center.lng)<de)&&(J=le)}for(;Math.abs(J.lng-Z.center.lng)>180;){const re=Z.locationPoint(J);if(re.x>=0&&re.y>=0&&re.x<=Z.width&&re.y<=Z.height)break;J.lng>Z.center.lng?J.lng-=360:J.lng+=360}return J}const Qa={center:"translate(-50%,-50%)",top:"translate(-50%,0)","top-left":"translate(0,0)","top-right":"translate(-100%,0)",bottom:"translate(-50%,-100%)","bottom-left":"translate(0,-100%)","bottom-right":"translate(-100%,-100%)",left:"translate(0,-50%)",right:"translate(-100%,-50%)"};class Dr extends t.Evented{constructor(G,Z){if(super(),(G instanceof t.window.HTMLElement||Z)&&(G=t.extend({element:G},Z)),t.bindAll(["_update","_onMove","_onUp","_addDragHandler","_onMapClick","_onKeyPress","_clearFadeTimer"],this),this._anchor=G&&G.anchor||"center",this._color=G&&G.color||"#3FB1CE",this._scale=G&&G.scale||1,this._draggable=G&&G.draggable||!1,this._clickTolerance=G&&G.clickTolerance||0,this._isDragging=!1,this._state="inactive",this._rotation=G&&G.rotation||0,this._rotationAlignment=G&&G.rotationAlignment||"auto",this._pitchAlignment=G&&G.pitchAlignment&&G.pitchAlignment||"auto",this._updateMoving=()=>this._update(!0),this._occludedOpacity=G&&G.occludedOpacity||.2,G&&G.element)this._element=G.element,this._offset=t.Point.convert(G&&G.offset||[0,0]);else{this._defaultMarker=!0,this._element=ge("div");const le=41,de=27,me=xe("svg",{display:"block",height:le*this._scale+"px",width:de*this._scale+"px",viewBox:`0 0 ${de} ${le}`},this._element),ye=xe("radialGradient",{id:"shadowGradient"},xe("defs",{},me));xe("stop",{offset:"10%","stop-opacity":.4},ye),xe("stop",{offset:"100%","stop-opacity":.05},ye),xe("ellipse",{cx:13.5,cy:34.8,rx:10.5,ry:5.25,fill:"url(#shadowGradient)"},me),xe("path",{fill:this._color,d:"M27,13.5C27,19.07 20.25,27 14.75,34.5C14.02,35.5 12.98,35.5 12.25,34.5C6.75,27 0,19.22 0,13.5C0,6.04 6.04,0 13.5,0C20.96,0 27,6.04 27,13.5Z"},me),xe("path",{opacity:.25,d:"M13.5,0C6.04,0 0,6.04 0,13.5C0,19.22 6.75,27 12.25,34.5C13,35.52 14.02,35.5 14.75,34.5C20.25,27 27,19.07 27,13.5C27,6.04 20.96,0 13.5,0ZM13.5,1C20.42,1 26,6.58 26,13.5C26,15.9 24.5,19.18 22.22,22.74C19.95,26.3 16.71,30.14 13.94,33.91C13.74,34.18 13.61,34.32 13.5,34.44C13.39,34.32 13.26,34.18 13.06,33.91C10.28,30.13 7.41,26.31 5.02,22.77C2.62,19.23 1,15.95 1,13.5C1,6.58 6.58,1 13.5,1Z"},me),xe("circle",{fill:"white",cx:13.5,cy:13.5,r:5.5},me),this._offset=t.Point.convert(G&&G.offset||[0,-14])}this._element.hasAttribute("aria-label")||this._element.setAttribute("aria-label","Map marker"),this._element.classList.add("mapboxgl-marker"),this._element.addEventListener("dragstart",le=>{le.preventDefault()}),this._element.addEventListener("mousedown",le=>{le.preventDefault()});const re=this._element.classList;for(const le in Qa)re.remove(`mapboxgl-marker-anchor-${le}`);re.add(`mapboxgl-marker-anchor-${this._anchor}`),this._popup=null}addTo(G){return G===this._map||(this.remove(),this._map=G,G.getCanvasContainer().appendChild(this._element),G.on("move",this._updateMoving),G.on("moveend",this._update),G.on("remove",this._clearFadeTimer),G._addMarker(this),this.setDraggable(this._draggable),this._update(),G.on("click",this._onMapClick)),this}remove(){const G=this._map;return G&&(G.off("click",this._onMapClick),G.off("move",this._updateMoving),G.off("moveend",this._update),G.off("mousedown",this._addDragHandler),G.off("touchstart",this._addDragHandler),G.off("mouseup",this._onUp),G.off("touchend",this._onUp),G.off("mousemove",this._onMove),G.off("touchmove",this._onMove),G.off("remove",this._clearFadeTimer),G._removeMarker(this),this._map=void 0),this._clearFadeTimer(),this._element.remove(),this._popup&&this._popup.remove(),this}getLngLat(){return this._lngLat}setLngLat(G){return this._lngLat=t.LngLat.convert(G),this._pos=null,this._popup&&this._popup.setLngLat(this._lngLat),this._update(!0),this}getElement(){return this._element}setPopup(G){if(this._popup&&(this._popup.remove(),this._popup=null,this._element.removeAttribute("role"),this._element.removeEventListener("keypress",this._onKeyPress),this._originalTabIndex||this._element.removeAttribute("tabindex")),G){if(!("offset"in G.options)){const le=Math.sqrt(Math.pow(13.5,2)/2);G.options.offset=this._defaultMarker?{top:[0,0],"top-left":[0,0],"top-right":[0,0],bottom:[0,-38.1],"bottom-left":[le,-1*(38.1-13.5+le)],"bottom-right":[-le,-1*(38.1-13.5+le)],left:[13.5,-1*(38.1-13.5)],right:[-13.5,-1*(38.1-13.5)]}:this._offset}this._popup=G,G._marker=this,this._lngLat&&this._popup.setLngLat(this._lngLat),this._element.setAttribute("role","button"),this._originalTabIndex=this._element.getAttribute("tabindex"),this._originalTabIndex||this._element.setAttribute("tabindex","0"),this._element.addEventListener("keypress",this._onKeyPress),this._element.setAttribute("aria-expanded","false")}return this}_onKeyPress(G){const Z=G.code,re=G.charCode||G.keyCode;Z!=="Space"&&Z!=="Enter"&&re!==32&&re!==13||this.togglePopup()}_onMapClick(G){const Z=G.originalEvent.target,re=this._element;this._popup&&(Z===re||re.contains(Z))&&this.togglePopup()}getPopup(){return this._popup}togglePopup(){const G=this._popup;return G?(G.isOpen()?(G.remove(),this._element.setAttribute("aria-expanded","false")):this._map&&(G.addTo(this._map),this._element.setAttribute("aria-expanded","true")),this):this}_behindTerrain(){const G=this._map,Z=this._pos;if(!G||!Z)return!1;const re=G.unproject(Z),le=G.getFreeCameraOptions();if(!le.position)return!1;const de=le.position.toLngLat();return de.distanceTo(re)<.9*de.distanceTo(this._lngLat)}_evaluateOpacity(){const G=this._map;if(!G)return;const Z=this._pos;if(!Z||Z.x<0||Z.x>G.transform.width||Z.y<0||Z.y>G.transform.height)return void this._clearFadeTimer();const re=G.unproject(Z);let le;G._showingGlobe()&&t.isLngLatBehindGlobe(G.transform,this._lngLat)?le=0:(le=1-G._queryFogOpacity(re),G.transform._terrainEnabled()&&G.getTerrain()&&this._behindTerrain()&&(le*=this._occludedOpacity)),this._element.style.opacity=`${le}`,this._element.style.pointerEvents=le>0?"auto":"none",this._popup&&this._popup._setOpacity(le),this._fadeTimer=null}_clearFadeTimer(){this._fadeTimer&&(clearTimeout(this._fadeTimer),this._fadeTimer=null)}_updateDOM(){const G=this._pos;if(!G||!this._map)return;const Z=this._offset.mult(this._scale);this._element.style.transform=`
            translate(${G.x}px,${G.y}px)
            ${Qa[this._anchor]}
            ${this._calculateXYTransform()} ${this._calculateZTransform()}
            translate(${Z.x}px,${Z.y}px)
        `}_calculateXYTransform(){const G=this._pos,Z=this._map,re=this.getPitchAlignment();if(!Z||!G||re!=="map")return"";if(!Z._showingGlobe()){const be=Z.getPitch();return be?`rotateX(${be}deg)`:""}const le=t.radToDeg(t.globeTiltAtLngLat(Z.transform,this._lngLat)),de=G.sub(t.globeCenterToScreenPoint(Z.transform)),me=Math.abs(de.x)+Math.abs(de.y);if(me===0)return"";const ye=le/me;return`rotateX(${-de.y*ye}deg) rotateY(${de.x*ye}deg)`}_calculateZTransform(){const G=this._pos,Z=this._map;if(!Z||!G)return"";let re=0;const le=this.getRotationAlignment();if(le==="map")if(Z._showingGlobe()){const de=Z.project(new t.LngLat(this._lngLat.lng,this._lngLat.lat+.001)),me=Z.project(new t.LngLat(this._lngLat.lng,this._lngLat.lat-.001)).sub(de);re=t.radToDeg(Math.atan2(me.y,me.x))-90}else re=-Z.getBearing();else if(le==="horizon"){const de=t.smoothstep(4,6,Z.getZoom()),me=t.globeCenterToScreenPoint(Z.transform);me.y+=de*Z.transform.height;const ye=G.sub(me),be=t.radToDeg(Math.atan2(ye.y,ye.x));re=(be>90?be-270:be+90)*(1-de)}return re+=this._rotation,re?`rotateZ(${re}deg)`:""}_update(G){t.window.cancelAnimationFrame(this._updateFrameId);const Z=this._map;Z&&(Z.transform.renderWorldCopies&&(this._lngLat=qo(this._lngLat,this._pos,Z.transform)),this._pos=Z.project(this._lngLat),G===!0?this._updateFrameId=t.window.requestAnimationFrame(()=>{this._element&&this._pos&&this._anchor&&(this._pos=this._pos.round(),this._updateDOM())}):this._pos=this._pos.round(),Z._requestDomTask(()=>{this._map&&(this._element&&this._pos&&this._anchor&&this._updateDOM(),(Z._showingGlobe()||Z.getTerrain()||Z.getFog())&&!this._fadeTimer&&(this._fadeTimer=setTimeout(this._evaluateOpacity.bind(this),60)))}))}getOffset(){return this._offset}setOffset(G){return this._offset=t.Point.convert(G),this._update(),this}_onMove(G){const Z=this._map;if(!Z)return;const re=this._pointerdownPos,le=this._positionDelta;if(re&&le){if(!this._isDragging){const de=this._clickTolerance||Z._clickTolerance;if(G.point.dist(re)<de)return;this._isDragging=!0}this._pos=G.point.sub(le),this._lngLat=Z.unproject(this._pos),this.setLngLat(this._lngLat),this._element.style.pointerEvents="none",this._state==="pending"&&(this._state="active",this.fire(new t.Event("dragstart"))),this.fire(new t.Event("drag"))}}_onUp(){this._element.style.pointerEvents="auto",this._positionDelta=null,this._pointerdownPos=null,this._isDragging=!1;const G=this._map;G&&(G.off("mousemove",this._onMove),G.off("touchmove",this._onMove)),this._state==="active"&&this.fire(new t.Event("dragend")),this._state="inactive"}_addDragHandler(G){const Z=this._map,re=this._pos;Z&&re&&this._element.contains(G.originalEvent.target)&&(G.preventDefault(),this._positionDelta=G.point.sub(re),this._pointerdownPos=G.point,this._state="pending",Z.on("mousemove",this._onMove),Z.on("touchmove",this._onMove),Z.once("mouseup",this._onUp),Z.once("touchend",this._onUp))}setDraggable(G){this._draggable=!!G;const Z=this._map;return Z&&(G?(Z.on("mousedown",this._addDragHandler),Z.on("touchstart",this._addDragHandler)):(Z.off("mousedown",this._addDragHandler),Z.off("touchstart",this._addDragHandler))),this}isDraggable(){return this._draggable}setRotation(G){return this._rotation=G||0,this._update(),this}getRotation(){return this._rotation}setRotationAlignment(G){return this._rotationAlignment=G||"auto",this._update(),this}getRotationAlignment(){return this._rotationAlignment==="auto"||this._rotationAlignment==="horizon"&&this._map&&!this._map._showingGlobe()?"viewport":this._rotationAlignment}setPitchAlignment(G){return this._pitchAlignment=G||"auto",this._update(),this}getPitchAlignment(){return this._pitchAlignment==="auto"?this.getRotationAlignment():this._pitchAlignment}setOccludedOpacity(G){return this._occludedOpacity=G||.2,this._update(),this}getOccludedOpacity(){return this._occludedOpacity}}const sl={closeButton:!0,closeOnClick:!0,focusAfterOpen:!0,className:"",maxWidth:"240px"},kh=["a[href]","[tabindex]:not([tabindex='-1'])","[contenteditable]:not([contenteditable='false'])","button:not([disabled])","input:not([disabled])","select:not([disabled])","textarea:not([disabled])"].join(", ");function Cc(J=new t.Point(0,0),G="bottom"){if(typeof J=="number"){const Z=Math.round(Math.sqrt(.5*Math.pow(J,2)));switch(G){case"top":return new t.Point(0,J);case"top-left":return new t.Point(Z,Z);case"top-right":return new t.Point(-Z,Z);case"bottom":return new t.Point(0,-J);case"bottom-left":return new t.Point(Z,-Z);case"bottom-right":return new t.Point(-Z,-Z);case"left":return new t.Point(J,0);case"right":return new t.Point(-J,0)}return new t.Point(0,0)}return J instanceof t.Point||Array.isArray(J)?t.Point.convert(J):t.Point.convert(J[G]||[0,0])}class ul{constructor(G){this.jumpTo(G)}getValue(G){if(G<=this._startTime)return this._start;if(G>=this._endTime)return this._end;const Z=t.easeCubicInOut((G-this._startTime)/(this._endTime-this._startTime));return this._start*(1-Z)+this._end*Z}isEasing(G){return G>=this._startTime&&G<=this._endTime}jumpTo(G){this._startTime=-1/0,this._endTime=-1/0,this._start=G,this._end=G}easeTo(G,Z,re){this._start=this.getValue(Z),this._end=G,this._startTime=Z,this._endTime=Z+re}}const Pc={"AttributionControl.ToggleAttribution":"Toggle attribution","AttributionControl.MapFeedback":"Map feedback","FullscreenControl.Enter":"Enter fullscreen","FullscreenControl.Exit":"Exit fullscreen","GeolocateControl.FindMyLocation":"Find my location","GeolocateControl.LocationNotAvailable":"Location not available","LogoControl.Title":"Mapbox logo","Map.Title":"Map","NavigationControl.ResetBearing":"Reset bearing to north","NavigationControl.ZoomIn":"Zoom in","NavigationControl.ZoomOut":"Zoom out","ScrollZoomBlocker.CtrlMessage":"Use ctrl + scroll to zoom the map","ScrollZoomBlocker.CmdMessage":"Use ⌘ + scroll to zoom the map","TouchPanBlocker.Message":"Use two fingers to move the map"},Mc={center:[0,0],zoom:0,bearing:0,pitch:0,minZoom:-2,maxZoom:22,minPitch:0,maxPitch:85,interactive:!0,scrollZoom:!0,boxZoom:!0,dragRotate:!0,dragPan:!0,keyboard:!0,doubleClickZoom:!0,touchZoomRotate:!0,touchPitch:!0,cooperativeGestures:!1,performanceMetricsCollection:!0,bearingSnap:7,clickTolerance:3,pitchWithRotate:!0,hash:!1,attributionControl:!0,failIfMajorPerformanceCaveat:!1,preserveDrawingBuffer:!1,trackResize:!0,optimizeForTerrain:!0,renderWorldCopies:!0,refreshExpiredTiles:!0,minTileCacheSize:null,maxTileCacheSize:null,localIdeographFontFamily:"sans-serif",localFontFamily:null,transformRequest:null,accessToken:null,fadeDuration:300,respectPrefersReducedMotion:!0,crossSourceCollisions:!0},Bh={showCompass:!0,showZoom:!0,visualizePitch:!1};class zh{constructor(G,Z,re=!1){this._clickTolerance=10,this.element=Z,this.mouseRotate=new el({clickTolerance:G.dragRotate._mouseRotate._clickTolerance}),this.map=G,re&&(this.mousePitch=new tl({clickTolerance:G.dragRotate._mousePitch._clickTolerance})),t.bindAll(["mousedown","mousemove","mouseup","touchstart","touchmove","touchend","reset"],this),Z.addEventListener("mousedown",this.mousedown),Z.addEventListener("touchstart",this.touchstart,{passive:!1}),Z.addEventListener("touchmove",this.touchmove),Z.addEventListener("touchend",this.touchend),Z.addEventListener("touchcancel",this.reset)}down(G,Z){this.mouseRotate.mousedown(G,Z),this.mousePitch&&this.mousePitch.mousedown(G,Z),Ce()}move(G,Z){const re=this.map,le=this.mouseRotate.mousemoveWindow(G,Z),de=le&&le.bearingDelta;if(de&&re.setBearing(re.getBearing()+de),this.mousePitch){const me=this.mousePitch.mousemoveWindow(G,Z),ye=me&&me.pitchDelta;ye&&re.setPitch(re.getPitch()+ye)}}off(){const G=this.element;G.removeEventListener("mousedown",this.mousedown),G.removeEventListener("touchstart",this.touchstart,{passive:!1}),G.removeEventListener("touchmove",this.touchmove),G.removeEventListener("touchend",this.touchend),G.removeEventListener("touchcancel",this.reset),this.offTemp()}offTemp(){Ue(),t.window.removeEventListener("mousemove",this.mousemove),t.window.removeEventListener("mouseup",this.mouseup)}mousedown(G){this.down(t.extend({},G,{ctrlKey:!0,preventDefault:()=>G.preventDefault()}),Ge(this.element,G)),t.window.addEventListener("mousemove",this.mousemove),t.window.addEventListener("mouseup",this.mouseup)}mousemove(G){this.move(G,Ge(this.element,G))}mouseup(G){this.mouseRotate.mouseupWindow(G),this.mousePitch&&this.mousePitch.mouseupWindow(G),this.offTemp()}touchstart(G){G.targetTouches.length!==1?this.reset():(this._startPos=this._lastPos=Ze(this.element,G.targetTouches)[0],this.down({type:"mousedown",button:0,ctrlKey:!0,preventDefault:()=>G.preventDefault()},this._startPos))}touchmove(G){G.targetTouches.length!==1?this.reset():(this._lastPos=Ze(this.element,G.targetTouches)[0],this.move({preventDefault:()=>G.preventDefault()},this._lastPos))}touchend(G){G.targetTouches.length===0&&this._startPos&&this._lastPos&&this._startPos.dist(this._lastPos)<this._clickTolerance&&this.element.click(),this.reset()}reset(){this.mouseRotate.reset(),this.mousePitch&&this.mousePitch.reset(),delete this._startPos,delete this._lastPos,this.offTemp()}}const ll={positionOptions:{enableHighAccuracy:!1,maximumAge:0,timeout:6e3},fitBoundsOptions:{maxZoom:15},trackUserLocation:!1,showAccuracyCircle:!0,showUserLocation:!0,showUserHeading:!1},cl={maxWidth:100,unit:"metric"},hl={kilometer:"km",meter:"m",mile:"mi",foot:"ft","nautical-mile":"nm"},Io={version:t.version,supported:ae,setRTLTextPlugin:t.setRTLTextPlugin,getRTLTextPluginStatus:t.getRTLTextPluginStatus,Map:class extends Ys{constructor(J){if(t.LivePerformanceUtils.mark(t.PerformanceMarkers.create),(J=t.extend({},Mc,J)).minZoom!=null&&J.maxZoom!=null&&J.minZoom>J.maxZoom)throw new Error("maxZoom must be greater than or equal to minZoom");if(J.minPitch!=null&&J.maxPitch!=null&&J.minPitch>J.maxPitch)throw new Error("maxPitch must be greater than or equal to minPitch");if(J.minPitch!=null&&J.minPitch<0)throw new Error("minPitch must be greater than or equal to 0");if(J.maxPitch!=null&&J.maxPitch>85)throw new Error("maxPitch must be less than or equal to 85");if(J.antialias&&t.isSafariWithAntialiasingBug(t.window)&&(J.antialias=!1,t.warnOnce("Antialiasing is disabled for this WebGL context to avoid browser bug: https://github.com/mapbox/mapbox-gl-js/issues/11609")),super(new Eo(J.minZoom,J.maxZoom,J.minPitch,J.maxPitch,J.renderWorldCopies),J),this._interactive=J.interactive,this._minTileCacheSize=J.minTileCacheSize,this._maxTileCacheSize=J.maxTileCacheSize,this._failIfMajorPerformanceCaveat=J.failIfMajorPerformanceCaveat,this._preserveDrawingBuffer=J.preserveDrawingBuffer,this._antialias=J.antialias,this._useWebGL2=J.useWebGL2,this._trackResize=J.trackResize,this._bearingSnap=J.bearingSnap,this._refreshExpiredTiles=J.refreshExpiredTiles,this._fadeDuration=J.fadeDuration,this._isInitialLoad=!0,this._crossSourceCollisions=J.crossSourceCollisions,this._collectResourceTiming=J.collectResourceTiming,this._optimizeForTerrain=J.optimizeForTerrain,this._language=this._parseLanguage(J.language),this._worldview=J.worldview,this._renderTaskQueue=new ol,this._domRenderTaskQueue=new ol,this._controls=[],this._markers=[],this._popups=[],this._mapId=t.uniqueId(),this._locale=t.extend({},Pc,J.locale),this._clickTolerance=J.clickTolerance,this._cooperativeGestures=J.cooperativeGestures,this._performanceMetricsCollection=J.performanceMetricsCollection,this._containerWidth=0,this._containerHeight=0,this._averageElevationLastSampledAt=-1/0,this._averageElevationExaggeration=0,this._averageElevation=new ul(0),this._interactionRange=[1/0,-1/0],this._visibilityHidden=0,this._useExplicitProjection=!1,this._requestManager=new t.RequestManager(J.transformRequest,J.accessToken,J.testMode),this._silenceAuthErrors=!!J.testMode,typeof J.container=="string"){if(this._container=t.window.document.getElementById(J.container),!this._container)throw new Error(`Container '${J.container}' not found.`)}else{if(!(J.container instanceof t.window.HTMLElement))throw new Error("Invalid type: 'container' must be a String or HTMLElement.");this._container=J.container}if(this._container.childNodes.length>0&&t.warnOnce("The map container element should be empty, otherwise the map's interactivity will be negatively impacted. If you want to display a message when WebGL is not supported, use the Mapbox GL Supported plugin instead."),J.maxBounds&&this.setMaxBounds(J.maxBounds),t.bindAll(["_onWindowOnline","_onWindowResize","_onVisibilityChange","_onMapScroll","_contextLost","_contextRestored"],this),this._setupContainer(),this._setupPainter(),this.painter===void 0)throw new Error("Failed to initialize WebGL.");this.on("move",()=>this._update(!1)),this.on("moveend",()=>this._update(!1)),this.on("zoom",()=>this._update(!0)),t.window!==void 0&&(t.window.addEventListener("online",this._onWindowOnline,!1),t.window.addEventListener("resize",this._onWindowResize,!1),t.window.addEventListener("orientationchange",this._onWindowResize,!1),t.window.addEventListener("webkitfullscreenchange",this._onWindowResize,!1),t.window.addEventListener("visibilitychange",this._onVisibilityChange,!1)),this.handlers=new ca(this,J),this._localFontFamily=J.localFontFamily,this._localIdeographFontFamily=J.localIdeographFontFamily,J.style&&this.setStyle(J.style,{localFontFamily:this._localFontFamily,localIdeographFontFamily:this._localIdeographFontFamily}),J.projection&&this.setProjection(J.projection),this._hash=J.hash&&new Xu(typeof J.hash=="string"&&J.hash||void 0).addTo(this),this._hash&&this._hash._onHashChange()||(this.jumpTo({center:J.center,zoom:J.zoom,bearing:J.bearing,pitch:J.pitch}),J.bounds&&(this.resize(),this.fitBounds(J.bounds,t.extend({},J.fitBoundsOptions,{duration:0})))),this.resize(),J.attributionControl&&this.addControl(new Vr({customAttribution:J.customAttribution})),this._logoControl=new al,this.addControl(this._logoControl,J.logoPosition),this.on("style.load",()=>{this.transform.unmodified&&this.jumpTo(this.style.stylesheet)}),this.on("data",G=>{this._update(G.dataType==="style"),this.fire(new t.Event(`${G.dataType}data`,G))}),this.on("dataloading",G=>{this.fire(new t.Event(`${G.dataType}dataloading`,G))})}_getMapId(){return this._mapId}addControl(J,G){if(G===void 0&&(G=J.getDefaultPosition?J.getDefaultPosition():"top-right"),!J||!J.onAdd)return this.fire(new t.ErrorEvent(new Error("Invalid argument to map.addControl(). Argument must be a control with onAdd and onRemove methods.")));const Z=J.onAdd(this);this._controls.push(J);const re=this._controlPositions[G];return G.indexOf("bottom")!==-1?re.insertBefore(Z,re.firstChild):re.appendChild(Z),this}removeControl(J){if(!J||!J.onRemove)return this.fire(new t.ErrorEvent(new Error("Invalid argument to map.removeControl(). Argument must be a control with onAdd and onRemove methods.")));const G=this._controls.indexOf(J);return G>-1&&this._controls.splice(G,1),J.onRemove(this),this}hasControl(J){return this._controls.indexOf(J)>-1}getContainer(){return this._container}getCanvasContainer(){return this._canvasContainer}getCanvas(){return this._canvas}resize(J){if(this._updateContainerDimensions(),this._containerWidth===this.transform.width&&this._containerHeight===this.transform.height)return this;this._resizeCanvas(this._containerWidth,this._containerHeight),this.transform.resize(this._containerWidth,this._containerHeight),this.painter.resize(Math.ceil(this._containerWidth),Math.ceil(this._containerHeight));const G=!this._moving;return G&&this.fire(new t.Event("movestart",J)).fire(new t.Event("move",J)),this.fire(new t.Event("resize",J)),G&&this.fire(new t.Event("moveend",J)),this}getBounds(){return this.transform.getBounds()}getMaxBounds(){return this.transform.getMaxBounds()||null}setMaxBounds(J){return this.transform.setMaxBounds(t.LngLatBounds.convert(J)),this._update()}setMinZoom(J){if((J=J??-2)>=-2&&J<=this.transform.maxZoom)return this.transform.minZoom=J,this._update(),this.getZoom()<J?this.setZoom(J):this.fire(new t.Event("zoomstart")).fire(new t.Event("zoom")).fire(new t.Event("zoomend")),this;throw new Error("minZoom must be between -2 and the current maxZoom, inclusive")}getMinZoom(){return this.transform.minZoom}setMaxZoom(J){if((J=J??22)>=this.transform.minZoom)return this.transform.maxZoom=J,this._update(),this.getZoom()>J?this.setZoom(J):this.fire(new t.Event("zoomstart")).fire(new t.Event("zoom")).fire(new t.Event("zoomend")),this;throw new Error("maxZoom must be greater than the current minZoom")}getMaxZoom(){return this.transform.maxZoom}setMinPitch(J){if((J=J??0)<0)throw new Error("minPitch must be greater than or equal to 0");if(J>=0&&J<=this.transform.maxPitch)return this.transform.minPitch=J,this._update(),this.getPitch()<J?this.setPitch(J):this.fire(new t.Event("pitchstart")).fire(new t.Event("pitch")).fire(new t.Event("pitchend")),this;throw new Error("minPitch must be between 0 and the current maxPitch, inclusive")}getMinPitch(){return this.transform.minPitch}setMaxPitch(J){if((J=J??85)>85)throw new Error("maxPitch must be less than or equal to 85");if(J>=this.transform.minPitch)return this.transform.maxPitch=J,this._update(),this.getPitch()>J?this.setPitch(J):this.fire(new t.Event("pitchstart")).fire(new t.Event("pitch")).fire(new t.Event("pitchend")),this;throw new Error("maxPitch must be greater than or equal to minPitch")}getMaxPitch(){return this.transform.maxPitch}getRenderWorldCopies(){return this.transform.renderWorldCopies}setRenderWorldCopies(J){return this.transform.renderWorldCopies=J,this.transform.renderWorldCopies||this._forceMarkerAndPopupUpdate(!0),this._update()}getLanguage(){return this._language}_parseLanguage(J){return J==="auto"?t.window.navigator.language:Array.isArray(J)?J.length===0?void 0:J.map(G=>G==="auto"?t.window.navigator.language:G):J}setLanguage(J){const G=this._parseLanguage(J);if(!this.style||G===this._language)return this;this._language=G,this.style._reloadSources();for(const Z of this._controls)Z._setLanguage&&Z._setLanguage(this._language);return this}getWorldview(){return this._worldview}setWorldview(J){return this.style&&J!==this._worldview?(this._worldview=J,this.style._reloadSources(),this):this}getProjection(){return this.transform.mercatorFromTransition?{name:"globe",center:[0,0]}:this.transform.getProjection()}_showingGlobe(){return this.transform.projection.name==="globe"}setProjection(J){return this._lazyInitEmptyStyle(),J?typeof J=="string"&&(J={name:J}):J=null,this._useExplicitProjection=!!J,this._prioritizeAndUpdateProjection(J,this.style.stylesheet?this.style.stylesheet.projection:null)}_updateProjectionTransition(){if(this.getProjection().name!=="globe")return;const J=this.transform,G=J.projection.name;let Z;G==="globe"&&J.zoom>=t.GLOBE_ZOOM_THRESHOLD_MAX?(J.setMercatorFromTransition(),Z=!0):G==="mercator"&&J.zoom<t.GLOBE_ZOOM_THRESHOLD_MAX&&(J.setProjection({name:"globe"}),Z=!0),Z&&(this.style.applyProjectionUpdate(),this.style._forceSymbolLayerUpdate())}_prioritizeAndUpdateProjection(J,G){return this._updateProjection(J||G||{name:"mercator"})}_updateProjection(J){let G;if(G=J.name==="globe"&&this.transform.zoom>=t.GLOBE_ZOOM_THRESHOLD_MAX?this.transform.setMercatorFromTransition():this.transform.setProjection(J),this.style.applyProjectionUpdate(),G){this.painter.clearBackgroundTiles();for(const Z in this.style._sourceCaches)this.style._sourceCaches[Z].clearTiles();this._update(!0),this._forceMarkerAndPopupUpdate(!0)}return this}project(J){return this.transform.locationPoint3D(t.LngLat.convert(J))}unproject(J){return this.transform.pointLocation3D(t.Point.convert(J))}isMoving(){return this._moving||this.handlers&&this.handlers.isMoving()||!1}isZooming(){return this._zooming||this.handlers&&this.handlers.isZooming()||!1}isRotating(){return this._rotating||this.handlers&&this.handlers.isRotating()||!1}_isDragging(){return this.handlers&&this.handlers._isDragging()||!1}_createDelegatedListener(J,G,Z){if(J==="mouseenter"||J==="mouseover"){let re=!1;const le=me=>{const ye=G.filter(qe=>this.getLayer(qe)),be=ye.length?this.queryRenderedFeatures(me.point,{layers:ye}):[];be.length?re||(re=!0,Z.call(this,new vn(J,this,me.originalEvent,{features:be}))):re=!1},de=()=>{re=!1};return{layers:new Set(G),listener:Z,delegates:{mousemove:le,mouseout:de}}}if(J==="mouseleave"||J==="mouseout"){let re=!1;const le=me=>{const ye=G.filter(be=>this.getLayer(be));(ye.length?this.queryRenderedFeatures(me.point,{layers:ye}):[]).length?re=!0:re&&(re=!1,Z.call(this,new vn(J,this,me.originalEvent)))},de=me=>{re&&(re=!1,Z.call(this,new vn(J,this,me.originalEvent)))};return{layers:new Set(G),listener:Z,delegates:{mousemove:le,mouseout:de}}}{const re=le=>{const de=G.filter(ye=>this.getLayer(ye)),me=de.length?this.queryRenderedFeatures(le.point,{layers:de}):[];me.length&&(le.features=me,Z.call(this,le),delete le.features)};return{layers:new Set(G),listener:Z,delegates:{[J]:re}}}}on(J,G,Z){if(Z===void 0)return super.on(J,G);Array.isArray(G)||(G=[G]);const re=this._createDelegatedListener(J,G,Z);this._delegatedListeners=this._delegatedListeners||{},this._delegatedListeners[J]=this._delegatedListeners[J]||[],this._delegatedListeners[J].push(re);for(const le in re.delegates)this.on(le,re.delegates[le]);return this}once(J,G,Z){if(Z===void 0)return super.once(J,G);Array.isArray(G)||(G=[G]);const re=this._createDelegatedListener(J,G,Z);for(const le in re.delegates)this.once(le,re.delegates[le]);return this}off(J,G,Z){if(Z===void 0)return super.off(J,G);G=new Set(Array.isArray(G)?G:[G]);const re=(de,me)=>{if(de.size!==me.size)return!1;for(const ye of de)if(!me.has(ye))return!1;return!0},le=this._delegatedListeners?this._delegatedListeners[J]:void 0;return le&&(de=>{for(let me=0;me<de.length;me++){const ye=de[me];if(ye.listener===Z&&re(ye.layers,G)){for(const be in ye.delegates)this.off(be,ye.delegates[be]);return de.splice(me,1),this}}})(le),this}queryRenderedFeatures(J,G){return this.style?(G!==void 0||J===void 0||J instanceof t.Point||Array.isArray(J)||(G=J,J=void 0),this.style.queryRenderedFeatures(J=J||[[0,0],[this.transform.width,this.transform.height]],G=G||{},this.transform)):[]}querySourceFeatures(J,G){return this.style.querySourceFeatures(J,G)}isPointOnSurface(J){const{name:G}=this.transform.projection;return G!=="globe"&&G!=="mercator"&&t.warnOnce(`${G} projection does not support isPointOnSurface, this API may behave unexpectedly.`),this.transform.isPointOnSurface(t.Point.convert(J))}setStyle(J,G){return(G=t.extend({},{localIdeographFontFamily:this._localIdeographFontFamily,localFontFamily:this._localFontFamily},G)).diff!==!1&&G.localIdeographFontFamily===this._localIdeographFontFamily&&G.localFontFamily===this._localFontFamily&&this.style&&J?(this._diffStyle(J,G),this):(this._localIdeographFontFamily=G.localIdeographFontFamily,this._localFontFamily=G.localFontFamily,this._updateStyle(J,G))}_getUIString(J){const G=this._locale[J];if(G==null)throw new Error(`Missing UI string '${J}'`);return G}_updateStyle(J,G){return this.style&&(this.style.setEventedParent(null),this.style._remove(),this.style=void 0),J&&(this.style=new ua(this,G||{}),this.style.setEventedParent(this,{style:this.style}),typeof J=="string"?this.style.loadURL(J):this.style.loadJSON(J)),this._updateTerrain(),this}_lazyInitEmptyStyle(){this.style||(this.style=new ua(this,{}),this.style.setEventedParent(this,{style:this.style}),this.style.loadEmpty())}_diffStyle(J,G){if(typeof J=="string"){const Z=this._requestManager.normalizeStyleURL(J),re=this._requestManager.transformRequest(Z,t.ResourceType.Style);t.getJSON(re,(le,de)=>{le?this.fire(new t.ErrorEvent(le)):de&&this._updateDiff(de,G)})}else typeof J=="object"&&this._updateDiff(J,G)}_updateDiff(J,G){try{this.style.setState(J)&&this._update(!0)}catch(Z){t.warnOnce(`Unable to perform style diff: ${Z.message||Z.error||Z}.  Rebuilding the style from scratch.`),this._updateStyle(J,G)}}getStyle(){if(this.style)return this.style.serialize()}isStyleLoaded(){return this.style?this.style.loaded():(t.warnOnce("There is no style added to the map."),!1)}addSource(J,G){return this._lazyInitEmptyStyle(),this.style.addSource(J,G),this._update(!0)}isSourceLoaded(J){return!!this.style&&this.style._isSourceCacheLoaded(J)}areTilesLoaded(){const J=this.style&&this.style._sourceCaches;for(const G in J){const Z=J[G]._tiles;for(const re in Z){const le=Z[re];if(le.state!=="loaded"&&le.state!=="errored")return!1}}return!0}addSourceType(J,G,Z){this._lazyInitEmptyStyle(),this.style.addSourceType(J,G,Z)}removeSource(J){return this.style.removeSource(J),this._updateTerrain(),this._update(!0)}getSource(J){return this.style.getSource(J)}addImage(J,G,{pixelRatio:Z=1,sdf:re=!1,stretchX:le,stretchY:de,content:me}={}){if(this._lazyInitEmptyStyle(),G instanceof t.window.HTMLImageElement||t.window.ImageBitmap&&G instanceof t.window.ImageBitmap){const{width:ye,height:be,data:qe}=t.exported.getImageData(G);this.style.addImage(J,{data:new t.RGBAImage({width:ye,height:be},qe),pixelRatio:Z,stretchX:le,stretchY:de,content:me,sdf:re,version:0})}else if(G.width===void 0||G.height===void 0)this.fire(new t.ErrorEvent(new Error("Invalid arguments to map.addImage(). The second argument must be an `HTMLImageElement`, `ImageData`, `ImageBitmap`, or object with `width`, `height`, and `data` properties with the same format as `ImageData`")));else{const{width:ye,height:be}=G,qe=G;this.style.addImage(J,{data:new t.RGBAImage({width:ye,height:be},new Uint8Array(qe.data)),pixelRatio:Z,stretchX:le,stretchY:de,content:me,sdf:re,version:0,userImage:qe}),qe.onAdd&&qe.onAdd(this,J)}}updateImage(J,G){const Z=this.style.getImage(J);if(!Z)return void this.fire(new t.ErrorEvent(new Error("The map has no image with that id. If you are adding a new image use `map.addImage(...)` instead.")));const re=G instanceof t.window.HTMLImageElement||t.window.ImageBitmap&&G instanceof t.window.ImageBitmap?t.exported.getImageData(G):G,{width:le,height:de}=re;le!==void 0&&de!==void 0?le===Z.data.width&&de===Z.data.height?(Z.data.replace(re.data,!(G instanceof t.window.HTMLImageElement||t.window.ImageBitmap&&G instanceof t.window.ImageBitmap)),this.style.updateImage(J,Z)):this.fire(new t.ErrorEvent(new Error(`The width and height of the updated image (${le}, ${de})
                must be that same as the previous version of the image
                (${Z.data.width}, ${Z.data.height})`))):this.fire(new t.ErrorEvent(new Error("Invalid arguments to map.updateImage(). The second argument must be an `HTMLImageElement`, `ImageData`, `ImageBitmap`, or object with `width`, `height`, and `data` properties with the same format as `ImageData`")))}hasImage(J){return J?!!this.style.getImage(J):(this.fire(new t.ErrorEvent(new Error("Missing required image id"))),!1)}removeImage(J){this.style.removeImage(J)}loadImage(J,G){t.getImage(this._requestManager.transformRequest(J,t.ResourceType.Image),(Z,re)=>{G(Z,re instanceof t.window.HTMLImageElement?t.exported.getImageData(re):re)})}listImages(){return this.style.listImages()}addLayer(J,G){return this._lazyInitEmptyStyle(),this.style.addLayer(J,G),this._update(!0)}moveLayer(J,G){return this.style.moveLayer(J,G),this._update(!0)}removeLayer(J){return this.style.removeLayer(J),this._update(!0)}getLayer(J){return this.style.getLayer(J)}setLayerZoomRange(J,G,Z){return this.style.setLayerZoomRange(J,G,Z),this._update(!0)}setFilter(J,G,Z={}){return this.style.setFilter(J,G,Z),this._update(!0)}getFilter(J){return this.style.getFilter(J)}setPaintProperty(J,G,Z,re={}){return this.style.setPaintProperty(J,G,Z,re),this._update(!0)}getPaintProperty(J,G){return this.style.getPaintProperty(J,G)}setLayoutProperty(J,G,Z,re={}){return this.style.setLayoutProperty(J,G,Z,re),this._update(!0)}getLayoutProperty(J,G){return this.style.getLayoutProperty(J,G)}setLight(J,G={}){return this._lazyInitEmptyStyle(),this.style.setLight(J,G),this._update(!0)}getLight(){return this.style.getLight()}setTerrain(J){return this._lazyInitEmptyStyle(),!J&&this.transform.projection.requiresDraping?this.style.setTerrainForDraping():this.style.setTerrain(J),this._averageElevationLastSampledAt=-1/0,this._update(!0)}getTerrain(){return this.style?this.style.getTerrain():null}setFog(J){return this._lazyInitEmptyStyle(),this.style.setFog(J),this._update(!0)}getFog(){return this.style?this.style.getFog():null}_queryFogOpacity(J){return this.style&&this.style.fog?this.style.fog.getOpacityAtLatLng(t.LngLat.convert(J),this.transform):0}setFeatureState(J,G){return this.style.setFeatureState(J,G),this._update()}removeFeatureState(J,G){return this.style.removeFeatureState(J,G),this._update()}getFeatureState(J){return this.style.getFeatureState(J)}_updateContainerDimensions(){if(!this._container)return;const J=this._container.getBoundingClientRect().width||400,G=this._container.getBoundingClientRect().height||300;let Z,re,le,de=this._container;for(;de&&(!re||!le);){const me=t.window.getComputedStyle(de).transform;me&&me!=="none"&&(Z=me.match(/matrix.*\((.+)\)/)[1].split(", "),Z[0]&&Z[0]!=="0"&&Z[0]!=="1"&&(re=Z[0]),Z[3]&&Z[3]!=="0"&&Z[3]!=="1"&&(le=Z[3])),de=de.parentElement}this._containerWidth=re?Math.abs(J/re):J,this._containerHeight=le?Math.abs(G/le):G}_detectMissingCSS(){t.window.getComputedStyle(this._missingCSSCanary).getPropertyValue("background-color")!=="rgb(250, 128, 114)"&&t.warnOnce("This page appears to be missing CSS declarations for Mapbox GL JS, which may cause the map to display incorrectly. Please ensure your page includes mapbox-gl.css, as described in https://www.mapbox.com/mapbox-gl-js/api/.")}_setupContainer(){const J=this._container;J.classList.add("mapboxgl-map"),(this._missingCSSCanary=ge("div","mapboxgl-canary",J)).style.visibility="hidden",this._detectMissingCSS();const G=this._canvasContainer=ge("div","mapboxgl-canvas-container",J);this._interactive&&G.classList.add("mapboxgl-interactive"),this._canvas=ge("canvas","mapboxgl-canvas",G),this._canvas.addEventListener("webglcontextlost",this._contextLost,!1),this._canvas.addEventListener("webglcontextrestored",this._contextRestored,!1),this._canvas.setAttribute("tabindex","0"),this._canvas.setAttribute("aria-label",this._getUIString("Map.Title")),this._canvas.setAttribute("role","region"),this._updateContainerDimensions(),this._resizeCanvas(this._containerWidth,this._containerHeight);const Z=this._controlContainer=ge("div","mapboxgl-control-container",J),re=this._controlPositions={};["top-left","top-right","bottom-left","bottom-right"].forEach(le=>{re[le]=ge("div",`mapboxgl-ctrl-${le}`,Z)}),this._container.addEventListener("scroll",this._onMapScroll,!1)}_resizeCanvas(J,G){const Z=t.exported.devicePixelRatio||1;this._canvas.width=Z*Math.ceil(J),this._canvas.height=Z*Math.ceil(G),this._canvas.style.width=`${J}px`,this._canvas.style.height=`${G}px`}_addMarker(J){this._markers.push(J)}_removeMarker(J){const G=this._markers.indexOf(J);G!==-1&&this._markers.splice(G,1)}_addPopup(J){this._popups.push(J)}_removePopup(J){const G=this._popups.indexOf(J);G!==-1&&this._popups.splice(G,1)}_setupPainter(){const J=t.extend({},ae.webGLContextAttributes,{failIfMajorPerformanceCaveat:this._failIfMajorPerformanceCaveat,preserveDrawingBuffer:this._preserveDrawingBuffer,antialias:this._antialias||!1}),G=this._useWebGL2&&this._canvas.getContext("webgl2",J),Z=G||this._canvas.getContext("webgl",J)||this._canvas.getContext("experimental-webgl",J);Z?(this._useWebGL2&&!G&&t.warnOnce("Failed to create WebGL 2 context. Using WebGL 1."),t.storeAuthState(Z,!0),this.painter=new bo(Z,this.transform,!!G),this.on("data",re=>{re.dataType==="source"&&this.painter.setTileLoadedFlag(!0)}),t.exported$1.testSupport(Z)):this.fire(new t.ErrorEvent(new Error("Failed to initialize WebGL")))}_contextLost(J){J.preventDefault(),this._frame&&(this._frame.cancel(),this._frame=null),this.fire(new t.Event("webglcontextlost",{originalEvent:J}))}_contextRestored(J){this._setupPainter(),this.resize(),this._update(),this.fire(new t.Event("webglcontextrestored",{originalEvent:J}))}_onMapScroll(J){if(J.target===this._container)return this._container.scrollTop=0,this._container.scrollLeft=0,!1}loaded(){return!this._styleDirty&&!this._sourcesDirty&&!!this.style&&this.style.loaded()}_update(J){return this.style?(this._styleDirty=this._styleDirty||J,this._sourcesDirty=!0,this.triggerRepaint(),this):this}_requestRenderFrame(J){return this._update(),this._renderTaskQueue.add(J)}_cancelRenderFrame(J){this._renderTaskQueue.remove(J)}_requestDomTask(J){!this.loaded()||this.loaded()&&!this.isMoving()?J():this._domRenderTaskQueue.add(J)}_render(J){let G;const Z=this.painter.context.extTimerQuery,re=t.exported.now();if(this.listens("gpu-timing-frame")&&(G=Z.createQueryEXT(),Z.beginQueryEXT(Z.TIME_ELAPSED_EXT,G)),this.painter.context.setDirty(),this.painter.setBaseState(),(this.isMoving()||this.isRotating()||this.isZooming())&&(this._interactionRange[0]=Math.min(this._interactionRange[0],t.window.performance.now()),this._interactionRange[1]=Math.max(this._interactionRange[1],t.window.performance.now())),this._renderTaskQueue.run(J),this._domRenderTaskQueue.run(J),this._removed)return;this._updateProjectionTransition();const le=this._isInitialLoad?0:this._fadeDuration;if(this.style&&this._styleDirty){this._styleDirty=!1;const ye=this.transform.zoom,be=this.transform.pitch,qe=t.exported.now(),Te=new t.EvaluationParameters(ye,{now:qe,fadeDuration:le,pitch:be,transition:this.style.getTransition()});this.style.update(Te)}this.style&&this.style.fog&&this.style.fog.hasTransition()&&(this.style._markersNeedUpdate=!0,this._sourcesDirty=!0);let de=!1;if(this.style&&this._sourcesDirty?(this._sourcesDirty=!1,this.painter._updateFog(this.style),this._updateTerrain(),de=this._updateAverageElevation(re),this.style._updateSources(this.transform),this._forceMarkerAndPopupUpdate()):de=this._updateAverageElevation(re),this._placementDirty=this.style&&this.style._updatePlacement(this.painter.transform,this.showCollisionBoxes,le,this._crossSourceCollisions),this.style&&this.painter.render(this.style,{showTileBoundaries:this.showTileBoundaries,showTerrainWireframe:this.showTerrainWireframe,showOverdrawInspector:this._showOverdrawInspector,showQueryGeometry:!!this._showQueryGeometry,showTileAABBs:this.showTileAABBs,rotating:this.isRotating(),zooming:this.isZooming(),moving:this.isMoving(),fadeDuration:le,isInitialLoad:this._isInitialLoad,showPadding:this.showPadding,gpuTiming:!!this.listens("gpu-timing-layer"),gpuTimingDeferredRender:!!this.listens("gpu-timing-deferred-render"),speedIndexTiming:this.speedIndexTiming}),this.fire(new t.Event("render")),this.loaded()&&!this._loaded&&(this._loaded=!0,this.fire(new t.Event("load"))),this.style&&this.style.hasTransitions()&&(this._styleDirty=!0),this.style&&!this._placementDirty&&this.style._releaseSymbolFadeTiles(),G){const ye=t.exported.now()-re;Z.endQueryEXT(Z.TIME_ELAPSED_EXT,G),setTimeout(()=>{const be=Z.getQueryObjectEXT(G,Z.QUERY_RESULT_EXT)/1e6;Z.deleteQueryEXT(G),this.fire(new t.Event("gpu-timing-frame",{cpuTime:ye,gpuTime:be})),t.window.performance.mark("frame-gpu",{startTime:re,detail:{gpuTime:be}})},50)}if(this.listens("gpu-timing-layer")){const ye=this.painter.collectGpuTimers();setTimeout(()=>{const be=this.painter.queryGpuTimers(ye);this.fire(new t.Event("gpu-timing-layer",{layerTimes:be}))},50)}if(this.listens("gpu-timing-deferred-render")){const ye=this.painter.collectDeferredRenderGpuQueries();setTimeout(()=>{const be=this.painter.queryGpuTimeDeferredRender(ye);this.fire(new t.Event("gpu-timing-deferred-render",{gpuTime:be}))},50)}const me=this._sourcesDirty||this._styleDirty||this._placementDirty||de;if(me||this._repaint)this.triggerRepaint();else{const ye=!this.isMoving()&&this.loaded();if(ye&&(de=this._updateAverageElevation(re,!0)),de)this.triggerRepaint();else if(this._triggerFrame(!1),ye&&(this.fire(new t.Event("idle")),this._isInitialLoad=!1,this.speedIndexTiming)){const be=this._calculateSpeedIndex();this.fire(new t.Event("speedindexcompleted",{speedIndex:be})),this.speedIndexTiming=!1}}!this._loaded||this._fullyLoaded||me||(this._fullyLoaded=!0,t.LivePerformanceUtils.mark(t.PerformanceMarkers.fullLoad),this._performanceMetricsCollection&&t.postPerformanceEvent(this._requestManager._customAccessToken,{width:this.painter.width,height:this.painter.height,interactionRange:this._interactionRange,visibilityHidden:this._visibilityHidden,terrainEnabled:!!this.painter.style.getTerrain(),fogEnabled:!!this.painter.style.getFog(),projection:this.getProjection().name,zoom:this.transform.zoom,renderer:this.painter.context.renderer,vendor:this.painter.context.vendor}),this._authenticate())}_forceMarkerAndPopupUpdate(J){for(const G of this._markers)J&&!this.getRenderWorldCopies()&&(G._lngLat=G._lngLat.wrap()),G._update();for(const G of this._popups)!J||this.getRenderWorldCopies()||G._trackPointer||(G._lngLat=G._lngLat.wrap()),G._update()}_updateAverageElevation(J,G=!1){const Z=re=>(this.transform.averageElevation=re,this._update(!1),!0);if(!this.painter.averageElevationNeedsEasing())return this.transform.averageElevation!==0&&Z(0);if((G||J-this._averageElevationLastSampledAt>500)&&!this._averageElevation.isEasing(J)){const re=this.transform.averageElevation;let le=this.transform.sampleAverageElevation(),de=!1;this.transform.elevation&&(de=this.transform.elevation.exaggeration()!==this._averageElevationExaggeration,this._averageElevationExaggeration=this.transform.elevation.exaggeration()),isNaN(le)?le=0:this._averageElevationLastSampledAt=J;const me=Math.abs(re-le);if(me>1){if(this._isInitialLoad||de)return this._averageElevation.jumpTo(le),Z(le);this._averageElevation.easeTo(le,J,300)}else if(me>1e-4)return this._averageElevation.jumpTo(le),Z(le)}return!!this._averageElevation.isEasing(J)&&Z(this._averageElevation.getValue(J))}_authenticate(){t.getMapSessionAPI(this._getMapId(),this._requestManager._skuToken,this._requestManager._customAccessToken,J=>{if(J&&(J.message===t.AUTH_ERR_MSG||J.status===401)){const G=this.painter.context.gl;t.storeAuthState(G,!1),this._logoControl instanceof al&&this._logoControl._updateLogo(),G&&G.clear(G.DEPTH_BUFFER_BIT|G.COLOR_BUFFER_BIT|G.STENCIL_BUFFER_BIT),this._silenceAuthErrors||this.fire(new t.ErrorEvent(new Error("A valid Mapbox access token is required to use Mapbox GL JS. To create an account or a new access token, visit https://account.mapbox.com/")))}}),t.postMapLoadEvent(this._getMapId(),this._requestManager._skuToken,this._requestManager._customAccessToken,()=>{})}_updateTerrain(){const J=this._isDragging();this.painter.updateTerrain(this.style,J)}_calculateSpeedIndex(){const J=this.painter.canvasCopy(),G=this.painter.getCanvasCopiesAndTimestamps();G.timeStamps.push(performance.now());const Z=this.painter.context.gl,re=Z.createFramebuffer();function le(de){Z.framebufferTexture2D(Z.FRAMEBUFFER,Z.COLOR_ATTACHMENT0,Z.TEXTURE_2D,de,0);const me=new Uint8Array(Z.drawingBufferWidth*Z.drawingBufferHeight*4);return Z.readPixels(0,0,Z.drawingBufferWidth,Z.drawingBufferHeight,Z.RGBA,Z.UNSIGNED_BYTE,me),me}return Z.bindFramebuffer(Z.FRAMEBUFFER,re),this._canvasPixelComparison(le(J),G.canvasCopies.map(le),G.timeStamps)}_canvasPixelComparison(J,G,Z){let re=Z[1]-Z[0];const le=J.length/4;for(let de=0;de<G.length;de++){const me=G[de];let ye=0;for(let be=0;be<me.length;be+=4)me[be]===J[be]&&me[be+1]===J[be+1]&&me[be+2]===J[be+2]&&me[be+3]===J[be+3]&&(ye+=1);re+=(Z[de+2]-Z[de+1])*(1-ye/le)}return re}remove(){this._hash&&this._hash.remove();for(const G of this._controls)G.onRemove(this);this._controls=[],this._frame&&(this._frame.cancel(),this._frame=null),this._renderTaskQueue.clear(),this._domRenderTaskQueue.clear(),this.style&&this.style.destroy(),this.painter.destroy(),this.handlers&&this.handlers.destroy(),this.handlers=void 0,this.setStyle(null),t.window!==void 0&&(t.window.removeEventListener("resize",this._onWindowResize,!1),t.window.removeEventListener("orientationchange",this._onWindowResize,!1),t.window.removeEventListener("webkitfullscreenchange",this._onWindowResize,!1),t.window.removeEventListener("online",this._onWindowOnline,!1),t.window.removeEventListener("visibilitychange",this._onVisibilityChange,!1));const J=this.painter.context.gl.getExtension("WEBGL_lose_context");J&&J.loseContext(),this._canvas.removeEventListener("webglcontextlost",this._contextLost,!1),this._canvas.removeEventListener("webglcontextrestored",this._contextRestored,!1),this._canvasContainer.remove(),this._controlContainer.remove(),this._missingCSSCanary.remove(),this._canvas=void 0,this._canvasContainer=void 0,this._controlContainer=void 0,this._missingCSSCanary=void 0,this._container.classList.remove("mapboxgl-map"),this._container.removeEventListener("scroll",this._onMapScroll,!1),t.removeAuthState(this.painter.context.gl),this._removed=!0,this.fire(new t.Event("remove"))}triggerRepaint(){this._triggerFrame(!0)}_triggerFrame(J){this._renderNextFrame=this._renderNextFrame||J,this.style&&!this._frame&&(this._frame=t.exported.frame(G=>{const Z=!!this._renderNextFrame;this._frame=null,this._renderNextFrame=null,Z&&this._render(G)}))}_preloadTiles(J){const G=this.style?Object.values(this.style._sourceCaches):[];return t.asyncAll(G,(Z,re)=>Z._preloadTiles(J,re),()=>{this.triggerRepaint()}),this}_onWindowOnline(){this._update()}_onWindowResize(J){this._trackResize&&this.resize({originalEvent:J})._update()}_onVisibilityChange(){t.window.document.visibilityState==="hidden"&&this._visibilityHidden++}get showTileBoundaries(){return!!this._showTileBoundaries}set showTileBoundaries(J){this._showTileBoundaries!==J&&(this._showTileBoundaries=J,this._update())}get showTerrainWireframe(){return!!this._showTerrainWireframe}set showTerrainWireframe(J){this._showTerrainWireframe!==J&&(this._showTerrainWireframe=J,this._update())}get speedIndexTiming(){return!!this._speedIndexTiming}set speedIndexTiming(J){this._speedIndexTiming!==J&&(this._speedIndexTiming=J,this._update())}get showPadding(){return!!this._showPadding}set showPadding(J){this._showPadding!==J&&(this._showPadding=J,this._update())}get showCollisionBoxes(){return!!this._showCollisionBoxes}set showCollisionBoxes(J){this._showCollisionBoxes!==J&&(this._showCollisionBoxes=J,J?this.style._generateCollisionBoxes():this._update())}get showOverdrawInspector(){return!!this._showOverdrawInspector}set showOverdrawInspector(J){this._showOverdrawInspector!==J&&(this._showOverdrawInspector=J,this._update())}get repaint(){return!!this._repaint}set repaint(J){this._repaint!==J&&(this._repaint=J,this.triggerRepaint())}get vertices(){return!!this._vertices}set vertices(J){this._vertices=J,this._update()}get showTileAABBs(){return!!this._showTileAABBs}set showTileAABBs(J){this._showTileAABBs!==J&&(this._showTileAABBs=J,J&&this._update())}_setCacheLimits(J,G){t.setCacheLimits(J,G)}get version(){return t.version}},NavigationControl:class{constructor(J){this.options=t.extend({},Bh,J),this._container=ge("div","mapboxgl-ctrl mapboxgl-ctrl-group"),this._container.addEventListener("contextmenu",G=>G.preventDefault()),this.options.showZoom&&(t.bindAll(["_setButtonTitle","_updateZoomButtons"],this),this._zoomInButton=this._createButton("mapboxgl-ctrl-zoom-in",G=>{this._map&&this._map.zoomIn({},{originalEvent:G})}),ge("span","mapboxgl-ctrl-icon",this._zoomInButton).setAttribute("aria-hidden","true"),this._zoomOutButton=this._createButton("mapboxgl-ctrl-zoom-out",G=>{this._map&&this._map.zoomOut({},{originalEvent:G})}),ge("span","mapboxgl-ctrl-icon",this._zoomOutButton).setAttribute("aria-hidden","true")),this.options.showCompass&&(t.bindAll(["_rotateCompassArrow"],this),this._compass=this._createButton("mapboxgl-ctrl-compass",G=>{const Z=this._map;Z&&(this.options.visualizePitch?Z.resetNorthPitch({},{originalEvent:G}):Z.resetNorth({},{originalEvent:G}))}),this._compassIcon=ge("span","mapboxgl-ctrl-icon",this._compass),this._compassIcon.setAttribute("aria-hidden","true"))}_updateZoomButtons(){const J=this._map;if(!J)return;const G=J.getZoom(),Z=G===J.getMaxZoom(),re=G===J.getMinZoom();this._zoomInButton.disabled=Z,this._zoomOutButton.disabled=re,this._zoomInButton.setAttribute("aria-disabled",Z.toString()),this._zoomOutButton.setAttribute("aria-disabled",re.toString())}_rotateCompassArrow(){const J=this._map;if(!J)return;const G=this.options.visualizePitch?`scale(${1/Math.pow(Math.cos(J.transform.pitch*(Math.PI/180)),.5)}) rotateX(${J.transform.pitch}deg) rotateZ(${J.transform.angle*(180/Math.PI)}deg)`:`rotate(${J.transform.angle*(180/Math.PI)}deg)`;J._requestDomTask(()=>{this._compassIcon&&(this._compassIcon.style.transform=G)})}onAdd(J){return this._map=J,this.options.showZoom&&(this._setButtonTitle(this._zoomInButton,"ZoomIn"),this._setButtonTitle(this._zoomOutButton,"ZoomOut"),J.on("zoom",this._updateZoomButtons),this._updateZoomButtons()),this.options.showCompass&&(this._setButtonTitle(this._compass,"ResetBearing"),this.options.visualizePitch&&J.on("pitch",this._rotateCompassArrow),J.on("rotate",this._rotateCompassArrow),this._rotateCompassArrow(),this._handler=new zh(J,this._compass,this.options.visualizePitch)),this._container}onRemove(){const J=this._map;J&&(this._container.remove(),this.options.showZoom&&J.off("zoom",this._updateZoomButtons),this.options.showCompass&&(this.options.visualizePitch&&J.off("pitch",this._rotateCompassArrow),J.off("rotate",this._rotateCompassArrow),this._handler&&this._handler.off(),this._handler=void 0),this._map=void 0)}_createButton(J,G){const Z=ge("button",J,this._container);return Z.type="button",Z.addEventListener("click",G),Z}_setButtonTitle(J,G){if(!this._map)return;const Z=this._map._getUIString(`NavigationControl.${G}`);J.setAttribute("aria-label",Z),J.firstElementChild&&J.firstElementChild.setAttribute("title",Z)}},GeolocateControl:class extends t.Evented{constructor(J){super(),this.options=t.extend({geolocation:t.window.navigator.geolocation},ll,J),t.bindAll(["_onSuccess","_onError","_onZoom","_finish","_setupUI","_updateCamera","_updateMarker","_updateMarkerRotation","_onDeviceOrientation"],this),this._updateMarkerRotationThrottled=wo(this._updateMarkerRotation,20),this._numberOfWatches=0}onAdd(J){return this._map=J,this._container=ge("div","mapboxgl-ctrl mapboxgl-ctrl-group"),this._checkGeolocationSupport(this._setupUI),this._container}onRemove(){this._geolocationWatchID!==void 0&&(this.options.geolocation.clearWatch(this._geolocationWatchID),this._geolocationWatchID=void 0),this.options.showUserLocation&&this._userLocationDotMarker&&this._userLocationDotMarker.remove(),this.options.showAccuracyCircle&&this._accuracyCircleMarker&&this._accuracyCircleMarker.remove(),this._container.remove(),this._map.off("zoom",this._onZoom),this._map=void 0,this._numberOfWatches=0,this._noTimeout=!1}_checkGeolocationSupport(J){const G=(Z=!!this.options.geolocation)=>{this._supportsGeolocation=Z,J(Z)};this._supportsGeolocation!==void 0?J(this._supportsGeolocation):t.window.navigator.permissions!==void 0?t.window.navigator.permissions.query({name:"geolocation"}).then(Z=>G(Z.state!=="denied")).catch(()=>G()):G()}_isOutOfMapMaxBounds(J){const G=this._map.getMaxBounds(),Z=J.coords;return!!G&&(Z.longitude<G.getWest()||Z.longitude>G.getEast()||Z.latitude<G.getSouth()||Z.latitude>G.getNorth())}_setErrorState(){switch(this._watchState){case"WAITING_ACTIVE":this._watchState="ACTIVE_ERROR",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-active-error");break;case"ACTIVE_LOCK":this._watchState="ACTIVE_ERROR",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-active-error"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-waiting");break;case"BACKGROUND":this._watchState="BACKGROUND_ERROR",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-background-error"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-waiting")}}_onSuccess(J){if(this._map){if(this._isOutOfMapMaxBounds(J))return this._setErrorState(),this.fire(new t.Event("outofmaxbounds",J)),this._updateMarker(),void this._finish();if(this.options.trackUserLocation)switch(this._lastKnownPosition=J,this._watchState){case"WAITING_ACTIVE":case"ACTIVE_LOCK":case"ACTIVE_ERROR":this._watchState="ACTIVE_LOCK",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active-error"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-active");break;case"BACKGROUND":case"BACKGROUND_ERROR":this._watchState="BACKGROUND",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background-error"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-background")}this.options.showUserLocation&&this._watchState!=="OFF"&&this._updateMarker(J),this.options.trackUserLocation&&this._watchState!=="ACTIVE_LOCK"||this._updateCamera(J),this.options.showUserLocation&&this._dotElement.classList.remove("mapboxgl-user-location-dot-stale"),this.fire(new t.Event("geolocate",J)),this._finish()}}_updateCamera(J){const G=new t.LngLat(J.coords.longitude,J.coords.latitude),Z=J.coords.accuracy,re=this._map.getBearing(),le=t.extend({bearing:re},this.options.fitBoundsOptions);this._map.fitBounds(G.toBounds(Z),le,{geolocateSource:!0})}_updateMarker(J){if(J){const G=new t.LngLat(J.coords.longitude,J.coords.latitude);this._accuracyCircleMarker.setLngLat(G).addTo(this._map),this._userLocationDotMarker.setLngLat(G).addTo(this._map),this._accuracy=J.coords.accuracy,this.options.showUserLocation&&this.options.showAccuracyCircle&&this._updateCircleRadius()}else this._userLocationDotMarker.remove(),this._accuracyCircleMarker.remove()}_updateCircleRadius(){const J=this._map.transform,G=t.mercatorZfromAltitude(1,J._center.lat)*J.worldSize,Z=Math.ceil(2*this._accuracy*G);this._circleElement.style.width=`${Z}px`,this._circleElement.style.height=`${Z}px`}_onZoom(){this.options.showUserLocation&&this.options.showAccuracyCircle&&this._updateCircleRadius()}_updateMarkerRotation(){this._userLocationDotMarker&&typeof this._heading=="number"?(this._userLocationDotMarker.setRotation(this._heading),this._dotElement.classList.add("mapboxgl-user-location-show-heading")):(this._dotElement.classList.remove("mapboxgl-user-location-show-heading"),this._userLocationDotMarker.setRotation(0))}_onError(J){if(this._map){if(this.options.trackUserLocation)if(J.code===1){this._watchState="OFF",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active-error"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background-error"),this._geolocateButton.disabled=!0;const G=this._map._getUIString("GeolocateControl.LocationNotAvailable");this._geolocateButton.setAttribute("aria-label",G),this._geolocateButton.firstElementChild&&this._geolocateButton.firstElementChild.setAttribute("title",G),this._geolocationWatchID!==void 0&&this._clearWatch()}else{if(J.code===3&&this._noTimeout)return;this._setErrorState()}this._watchState!=="OFF"&&this.options.showUserLocation&&this._dotElement.classList.add("mapboxgl-user-location-dot-stale"),this.fire(new t.Event("error",J)),this._finish()}}_finish(){this._timeoutId&&clearTimeout(this._timeoutId),this._timeoutId=void 0}_setupUI(J){if(this._map!==void 0){if(this._container.addEventListener("contextmenu",G=>G.preventDefault()),this._geolocateButton=ge("button","mapboxgl-ctrl-geolocate",this._container),ge("span","mapboxgl-ctrl-icon",this._geolocateButton).setAttribute("aria-hidden","true"),this._geolocateButton.type="button",J===!1){t.warnOnce("Geolocation support is not available so the GeolocateControl will be disabled.");const G=this._map._getUIString("GeolocateControl.LocationNotAvailable");this._geolocateButton.disabled=!0,this._geolocateButton.setAttribute("aria-label",G),this._geolocateButton.firstElementChild&&this._geolocateButton.firstElementChild.setAttribute("title",G)}else{const G=this._map._getUIString("GeolocateControl.FindMyLocation");this._geolocateButton.setAttribute("aria-label",G),this._geolocateButton.firstElementChild&&this._geolocateButton.firstElementChild.setAttribute("title",G)}this.options.trackUserLocation&&(this._geolocateButton.setAttribute("aria-pressed","false"),this._watchState="OFF"),this.options.showUserLocation&&(this._dotElement=ge("div","mapboxgl-user-location"),this._dotElement.appendChild(ge("div","mapboxgl-user-location-dot")),this._dotElement.appendChild(ge("div","mapboxgl-user-location-heading")),this._userLocationDotMarker=new Dr({element:this._dotElement,rotationAlignment:"map",pitchAlignment:"map"}),this._circleElement=ge("div","mapboxgl-user-location-accuracy-circle"),this._accuracyCircleMarker=new Dr({element:this._circleElement,pitchAlignment:"map"}),this.options.trackUserLocation&&(this._watchState="OFF"),this._map.on("zoom",this._onZoom)),this._geolocateButton.addEventListener("click",this.trigger.bind(this)),this._setup=!0,this.options.trackUserLocation&&this._map.on("movestart",G=>{G.geolocateSource||this._watchState!=="ACTIVE_LOCK"||G.originalEvent&&G.originalEvent.type==="resize"||(this._watchState="BACKGROUND",this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-background"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active"),this.fire(new t.Event("trackuserlocationend")))})}}_onDeviceOrientation(J){this._userLocationDotMarker&&(J.webkitCompassHeading?this._heading=J.webkitCompassHeading:J.absolute===!0&&(this._heading=-1*J.alpha),this._updateMarkerRotationThrottled())}trigger(){if(!this._setup)return t.warnOnce("Geolocate control triggered before added to a map"),!1;if(this.options.trackUserLocation){switch(this._watchState){case"OFF":this._watchState="WAITING_ACTIVE",this.fire(new t.Event("trackuserlocationstart"));break;case"WAITING_ACTIVE":case"ACTIVE_LOCK":case"ACTIVE_ERROR":case"BACKGROUND_ERROR":this._numberOfWatches--,this._noTimeout=!1,this._watchState="OFF",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active-error"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background-error"),this.fire(new t.Event("trackuserlocationend"));break;case"BACKGROUND":this._watchState="ACTIVE_LOCK",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background"),this._lastKnownPosition&&this._updateCamera(this._lastKnownPosition),this.fire(new t.Event("trackuserlocationstart"))}switch(this._watchState){case"WAITING_ACTIVE":this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-active");break;case"ACTIVE_LOCK":this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-active");break;case"ACTIVE_ERROR":this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-active-error");break;case"BACKGROUND":this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-background");break;case"BACKGROUND_ERROR":this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-background-error")}if(this._watchState==="OFF"&&this._geolocationWatchID!==void 0)this._clearWatch();else if(this._geolocationWatchID===void 0){let J;this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.setAttribute("aria-pressed","true"),this._numberOfWatches++,this._numberOfWatches>1?(J={maximumAge:6e5,timeout:0},this._noTimeout=!0):(J=this.options.positionOptions,this._noTimeout=!1),this._geolocationWatchID=this.options.geolocation.watchPosition(this._onSuccess,this._onError,J),this.options.showUserHeading&&this._addDeviceOrientationListener()}}else this.options.geolocation.getCurrentPosition(this._onSuccess,this._onError,this.options.positionOptions),this._timeoutId=setTimeout(this._finish,1e4);return!0}_addDeviceOrientationListener(){const J=()=>{t.window.addEventListener("ondeviceorientationabsolute"in t.window?"deviceorientationabsolute":"deviceorientation",this._onDeviceOrientation)};t.window.DeviceMotionEvent!==void 0&&typeof t.window.DeviceMotionEvent.requestPermission=="function"?DeviceOrientationEvent.requestPermission().then(G=>{G==="granted"&&J()}).catch(console.error):J()}_clearWatch(){this.options.geolocation.clearWatch(this._geolocationWatchID),t.window.removeEventListener("deviceorientation",this._onDeviceOrientation),t.window.removeEventListener("deviceorientationabsolute",this._onDeviceOrientation),this._geolocationWatchID=void 0,this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.setAttribute("aria-pressed","false"),this.options.showUserLocation&&this._updateMarker(null)}},AttributionControl:Vr,ScaleControl:class{constructor(J){this.options=t.extend({},cl,J),this._isNumberFormatSupported=function(){try{return new Intl.NumberFormat("en",{style:"unit",unitDisplay:"short",unit:"meter"}),!0}catch{return!1}}(),t.bindAll(["_update","_setScale","setUnit"],this)}getDefaultPosition(){return"bottom-left"}_update(){const J=this.options.maxWidth||100,G=this._map,Z=G._containerHeight/2,re=G._containerWidth/2-J/2,le=G.unproject([re,Z]),de=G.unproject([re+J,Z]),me=le.distanceTo(de);if(this.options.unit==="imperial"){const ye=3.2808*me;ye>5280?this._setScale(J,ye/5280,"mile"):this._setScale(J,ye,"foot")}else this.options.unit==="nautical"?this._setScale(J,me/1852,"nautical-mile"):me>=1e3?this._setScale(J,me/1e3,"kilometer"):this._setScale(J,me,"meter")}_setScale(J,G,Z){this._map._requestDomTask(()=>{const re=function(de){const me=Math.pow(10,`${Math.floor(de)}`.length-1);let ye=de/me;return ye=ye>=10?10:ye>=5?5:ye>=3?3:ye>=2?2:ye>=1?1:function(be){const qe=Math.pow(10,Math.ceil(-Math.log(be)/Math.LN10));return Math.round(be*qe)/qe}(ye),me*ye}(G),le=re/G;this._container.innerHTML=this._isNumberFormatSupported&&Z!=="nautical-mile"?new Intl.NumberFormat(this._language,{style:"unit",unitDisplay:"short",unit:Z}).format(re):`${re}&nbsp;${hl[Z]}`,this._container.style.width=J*le+"px"})}onAdd(J){return this._map=J,this._language=J.getLanguage(),this._container=ge("div","mapboxgl-ctrl mapboxgl-ctrl-scale",J.getContainer()),this._container.dir="auto",this._map.on("move",this._update),this._update(),this._container}onRemove(){this._container.remove(),this._map.off("move",this._update),this._map=void 0}_setLanguage(J){this._language=J,this._update()}setUnit(J){this.options.unit=J,this._update()}},FullscreenControl:class{constructor(J){this._fullscreen=!1,J&&J.container&&(J.container instanceof t.window.HTMLElement?this._container=J.container:t.warnOnce("Full screen control 'container' must be a DOM element.")),t.bindAll(["_onClickFullscreen","_changeIcon"],this),"onfullscreenchange"in t.window.document?this._fullscreenchange="fullscreenchange":"onwebkitfullscreenchange"in t.window.document&&(this._fullscreenchange="webkitfullscreenchange")}onAdd(J){return this._map=J,this._container||(this._container=this._map.getContainer()),this._controlContainer=ge("div","mapboxgl-ctrl mapboxgl-ctrl-group"),this._checkFullscreenSupport()?this._setupUI():(this._controlContainer.style.display="none",t.warnOnce("This device does not support fullscreen mode.")),this._controlContainer}onRemove(){this._controlContainer.remove(),this._map=null,t.window.document.removeEventListener(this._fullscreenchange,this._changeIcon)}_checkFullscreenSupport(){return!(!t.window.document.fullscreenEnabled&&!t.window.document.webkitFullscreenEnabled)}_setupUI(){const J=this._fullscreenButton=ge("button","mapboxgl-ctrl-fullscreen",this._controlContainer);ge("span","mapboxgl-ctrl-icon",J).setAttribute("aria-hidden","true"),J.type="button",this._updateTitle(),this._fullscreenButton.addEventListener("click",this._onClickFullscreen),t.window.document.addEventListener(this._fullscreenchange,this._changeIcon)}_updateTitle(){const J=this._getTitle();this._fullscreenButton.setAttribute("aria-label",J),this._fullscreenButton.firstElementChild&&this._fullscreenButton.firstElementChild.setAttribute("title",J)}_getTitle(){return this._map._getUIString(this._isFullscreen()?"FullscreenControl.Exit":"FullscreenControl.Enter")}_isFullscreen(){return this._fullscreen}_changeIcon(){(t.window.document.fullscreenElement||t.window.document.webkitFullscreenElement)===this._container!==this._fullscreen&&(this._fullscreen=!this._fullscreen,this._fullscreenButton.classList.toggle("mapboxgl-ctrl-shrink"),this._fullscreenButton.classList.toggle("mapboxgl-ctrl-fullscreen"),this._updateTitle())}_onClickFullscreen(){this._isFullscreen()?t.window.document.exitFullscreen?t.window.document.exitFullscreen():t.window.document.webkitCancelFullScreen&&t.window.document.webkitCancelFullScreen():this._container.requestFullscreen?this._container.requestFullscreen():this._container.webkitRequestFullscreen&&this._container.webkitRequestFullscreen()}},Popup:class extends t.Evented{constructor(J){super(),this.options=t.extend(Object.create(sl),J),t.bindAll(["_update","_onClose","remove","_onMouseEvent"],this),this._classList=new Set(J&&J.className?J.className.trim().split(/\s+/):[])}addTo(J){return this._map&&this.remove(),this._map=J,this.options.closeOnClick&&J.on("preclick",this._onClose),this.options.closeOnMove&&J.on("move",this._onClose),J.on("remove",this.remove),this._update(),J._addPopup(this),this._focusFirstElement(),this._trackPointer?(J.on("mousemove",this._onMouseEvent),J.on("mouseup",this._onMouseEvent),J._canvasContainer.classList.add("mapboxgl-track-pointer")):J.on("move",this._update),this.fire(new t.Event("open")),this}isOpen(){return!!this._map}remove(){this._content&&this._content.remove(),this._container&&(this._container.remove(),this._container=void 0);const J=this._map;return J&&(J.off("move",this._update),J.off("move",this._onClose),J.off("preclick",this._onClose),J.off("click",this._onClose),J.off("remove",this.remove),J.off("mousemove",this._onMouseEvent),J.off("mouseup",this._onMouseEvent),J.off("drag",this._onMouseEvent),J._canvasContainer&&J._canvasContainer.classList.remove("mapboxgl-track-pointer"),J._removePopup(this),this._map=void 0),this.fire(new t.Event("close")),this}getLngLat(){return this._lngLat}setLngLat(J){this._lngLat=t.LngLat.convert(J),this._pos=null,this._trackPointer=!1,this._update();const G=this._map;return G&&(G.on("move",this._update),G.off("mousemove",this._onMouseEvent),G._canvasContainer.classList.remove("mapboxgl-track-pointer")),this}trackPointer(){this._trackPointer=!0,this._pos=null,this._update();const J=this._map;return J&&(J.off("move",this._update),J.on("mousemove",this._onMouseEvent),J.on("drag",this._onMouseEvent),J._canvasContainer.classList.add("mapboxgl-track-pointer")),this}getElement(){return this._container}setText(J){return this.setDOMContent(t.window.document.createTextNode(J))}setHTML(J){const G=t.window.document.createDocumentFragment(),Z=t.window.document.createElement("body");let re;for(Z.innerHTML=J;re=Z.firstChild,re;)G.appendChild(re);return this.setDOMContent(G)}getMaxWidth(){return this._container&&this._container.style.maxWidth}setMaxWidth(J){return this.options.maxWidth=J,this._update(),this}setDOMContent(J){let G=this._content;if(G)for(;G.hasChildNodes();)G.firstChild&&G.removeChild(G.firstChild);else G=this._content=ge("div","mapboxgl-popup-content",this._container||void 0);if(G.appendChild(J),this.options.closeButton){const Z=this._closeButton=ge("button","mapboxgl-popup-close-button",G);Z.type="button",Z.setAttribute("aria-label","Close popup"),Z.setAttribute("aria-hidden","true"),Z.innerHTML="&#215;",Z.addEventListener("click",this._onClose)}return this._update(),this._focusFirstElement(),this}addClassName(J){return this._classList.add(J),this._updateClassList(),this}removeClassName(J){return this._classList.delete(J),this._updateClassList(),this}setOffset(J){return this.options.offset=J,this._update(),this}toggleClassName(J){let G;return this._classList.delete(J)?G=!1:(this._classList.add(J),G=!0),this._updateClassList(),G}_onMouseEvent(J){this._update(J.point)}_getAnchor(J){if(this.options.anchor)return this.options.anchor;const G=this._map,Z=this._container,re=this._pos;if(!G||!Z||!re)return"bottom";const le=Z.offsetWidth,de=Z.offsetHeight,me=re.x<le/2,ye=re.x>G.transform.width-le/2;if(re.y+J<de)return me?"top-left":ye?"top-right":"top";if(re.y>G.transform.height-de){if(me)return"bottom-left";if(ye)return"bottom-right"}return me?"left":ye?"right":"bottom"}_updateClassList(){const J=this._container;if(!J)return;const G=[...this._classList];G.push("mapboxgl-popup"),this._anchor&&G.push(`mapboxgl-popup-anchor-${this._anchor}`),this._trackPointer&&G.push("mapboxgl-popup-track-pointer"),J.className=G.join(" ")}_update(J){const G=this._map,Z=this._content;if(!G||!this._lngLat&&!this._trackPointer||!Z)return;let re=this._container;if(re||(re=this._container=ge("div","mapboxgl-popup",G.getContainer()),this._tip=ge("div","mapboxgl-popup-tip",re),re.appendChild(Z)),this.options.maxWidth&&re.style.maxWidth!==this.options.maxWidth&&(re.style.maxWidth=this.options.maxWidth),G.transform.renderWorldCopies&&!this._trackPointer&&(this._lngLat=qo(this._lngLat,this._pos,G.transform)),!this._trackPointer||J){const le=this._pos=this._trackPointer&&J?J:G.project(this._lngLat),de=Cc(this.options.offset),me=this._anchor=this._getAnchor(de.y),ye=Cc(this.options.offset,me),be=le.add(ye).round();G._requestDomTask(()=>{this._container&&me&&(this._container.style.transform=`${Qa[me]} translate(${be.x}px,${be.y}px)`)})}if(!this._marker&&G._showingGlobe()){const le=t.isLngLatBehindGlobe(G.transform,this._lngLat)?0:1;this._setOpacity(le)}this._updateClassList()}_focusFirstElement(){if(!this.options.focusAfterOpen||!this._container)return;const J=this._container.querySelector(kh);J&&J.focus()}_onClose(){this.remove()}_setOpacity(J){this._container&&(this._container.style.opacity=`${J}`),this._content&&(this._content.style.pointerEvents=J?"auto":"none")}},Marker:Dr,Style:ua,LngLat:t.LngLat,LngLatBounds:t.LngLatBounds,Point:t.Point,MercatorCoordinate:t.MercatorCoordinate,FreeCameraOptions:mc,Evented:t.Evented,config:t.config,prewarm:function(){Xt().acquire(qn)},clearPrewarmedResources:function(){const J=fr;J&&(J.isPreloaded()&&J.numActive()===1?(J.release(qn),fr=null):console.warn("Could not clear WebWorkers since there are active Map instances that still reference it. The pre-warmed WebWorker pool can only be cleared when all map instances have been removed with map.remove()"))},get accessToken(){return t.config.ACCESS_TOKEN},set accessToken(J){t.config.ACCESS_TOKEN=J},get baseApiUrl(){return t.config.API_URL},set baseApiUrl(J){t.config.API_URL=J},get workerCount(){return Gt.workerCount},set workerCount(J){Gt.workerCount=J},get maxParallelImageRequests(){return t.config.MAX_PARALLEL_IMAGE_REQUESTS},set maxParallelImageRequests(J){t.config.MAX_PARALLEL_IMAGE_REQUESTS=J},clearStorage(J){t.clearTileCache(J)},workerUrl:"",workerClass:null,setNow:t.exported.setNow,restoreNow:t.exported.restoreNow};return Io});var ie=ue;return ie})}(mapboxGl$1)),mapboxGl$1.exports}var mapboxGlExports=requireMapboxGl();const mapboxgl=getDefaultExportFromCjs(mapboxGlExports),TRIP_SHAPE_ARROW_URL="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAFAAAABkCAMAAAAmJEckAAAAnFBMVEUAAAAA//+AgP9Vqv9JtttAr+9HqvFJqudDpulHo+tFp+tHqupFpepBpu1EquhFp+tDqu1EqelFqepFp+xEqOtFqetEqOxDqOxDp+pEp+tEp+tFqexEqOpEqOxEqOtEqOxEqOtEqOtEqOtEqOtEqOtDqOxEqOtEqOtEqOtEqOtEqOtEqOtEqOtEqOtEqOtEqOtEqOtEqOtEqOv///+CAFIPAAAAMnRSTlMAAQIGBxASFRcZGiQlKy00OUdKXWZoaWpudICRk6qzuLzLzNHb3+Hi5Ofo6vL29/n7/gX8zyAAAAABYktHRDM31XxeAAABlElEQVRYw+2ZWVICQRBEQWVwFBVEodVW3FHEhbz/4fxVp7eqSmL8mDzAiyDm0V2V3et16WJMNTsfMHmjJbCaEHkvALC52qXyANyPuDxgPeXyAFybv021xK88nhiBc/zJ50XfBJyhkcW+BThYNYk2JSebJtGmpEcgFiX3HkLE9ZmeePQeIlqUdEEgnsZaYP8mTPy63FESh69hIm4PiO4AAN5Ome5YlAy7Y1Ey4o5BSYd4VErG3NErGXVHrWTUHbWSPgXUKJlwR6lkwh2lki4NlCuZdEelZNIdlZJpdzRKemQjUzLjjkLJnDtyJR0KIlEy745Uybw7UiXz7kiV9EVAgZIl7siUPP4oJD5XTHcAYN4SkP2Tyz9K3Y42bLHZf73Cw2Ha2vHFPmDpV4DnybeVa5R90dNHEceTbyvjHH3gZI/EmaG9lvLYawV98WGvZqnlUVOx0ddb9gLOrgjiJUat4tFrFnYRxK6qImWavt9l133sQpJemdJLXXrtTC/G6dU9/3HhB/Hu8J8+0PCfkPiPXF26lOUbWqrC+sGueMcAAAAASUVORK5CYII=",VEHICLE_POINT_COLOR=["case",["!=",["get","delay"],null],["interpolate",["linear"],["get","delay"],0,["to-color","#2ecc71"],90,["to-color","#eebb00"],210,["to-color","#ee2200"]],"#e0e0e0"],FOCUSED_TRIP_SHAPE_OPACITY={base:.3,stops:[[9,.3],[15,.8]]};mapboxgl.accessToken="pk.eyJ1IjoiZGVyaHVlcnN0IiwiYSI6ImNrajRuNnB3cjVyMWEycXFqMmh4dWUxZjMifQ.VVjBdXpzJVGbGc4u2n8Fog";setTimeout(()=>{mapboxgl.prewarm()},100);class MapView extends x{constructor(){super(),this.ref=b()}updateVehiclePositions(){const{feedData:X}=this.props.state,ne=(X.entity||[]).filter(ie=>ie.vehicle&&ie.vehicle.position);if(ne.length===0)return;const te=this.map.getSource("vehicle-positions");if(!te)return;te.setData({type:"FeatureCollection",features:ne.map(ie=>{var t,H;return{type:"Feature",properties:{vehicleId:(t=ie.vehicle.vehicle)==null?void 0:t.id,trip_id:(H=ie.vehicle.trip)==null?void 0:H.trip_id,delay:ie.vehicle.delay},geometry:{type:"Point",coordinates:[ie.vehicle.position.longitude,ie.vehicle.position.latitude]}}})});const ue=[ne[0].vehicle.position.longitude,ne[0].vehicle.position.latitude],se=new mapboxgl.LngLatBounds(ue,ue);for(const ie of ne)se.extend([ie.vehicle.position.longitude,ie.vehicle.position.latitude]);this.map.fitBounds(se,{padding:50})}updateFocusedTripShape(){const{focusedTripShape:X}=this.props.state,ee=this.map.getSource("focused-trip-shape");ee&&(X===null?ee.setData({type:"FeatureCollection",features:[]}):ee.setData(X))}updateFocusedVehiclePosition(){const{focusedVehiclePosition:X}=this.props.state,ee=this.map.getSource("focused-vehicle-position");ee&&(X===null?ee.setData({type:"FeatureCollection",features:[]}):ee.setData(X))}updateMap(){this.map&&(this.updateVehiclePositions(),this.updateFocusedTripShape(),this.updateFocusedVehiclePosition())}componentDidMount(){const{emit:X}=this.props;this.map=new mapboxgl.Map({container:this.ref.current,style:"mapbox://styles/mapbox/dark-v10",center:[-74.5,40],zoom:9}),this.map.once("load",()=>{this.map.addSource("vehicle-positions",{type:"geojson",data:{type:"FeatureCollection",features:[]}}),this.map.addLayer({id:"vehicle-positions",source:"vehicle-positions",type:"circle",paint:{"circle-radius":{base:1.5,stops:[[1,1],[20,35]]},"circle-color":VEHICLE_POINT_COLOR}}),this.map.on("mouseenter","vehicle-positions",()=>{this.map.getCanvas().style.cursor="pointer"}),this.map.on("mouseleave","vehicle-positions",()=>{this.map.getCanvas().style.cursor=""}),this.map.on("click","vehicle-positions",ne=>{var se,ie;const te=((se=ne.features[0])==null?void 0:se.properties.vehicleId)||null;X("focus-vehicle-id",te);const ue=((ie=ne.features[0])==null?void 0:ie.properties.trip_id)||null;X("focus-trip-id",ue)}),this.map.addSource("focused-trip-shape",{type:"geojson",data:null}),this.map.addLayer({id:"focused-trip-shape",source:"focused-trip-shape",type:"line",paint:{"line-width":{base:1,stops:[[1,.6],[20,4]]},"line-color":"#44a8eb","line-opacity":FOCUSED_TRIP_SHAPE_OPACITY}});const ee=this.map;ee.loadImage(TRIP_SHAPE_ARROW_URL,(ne,te)=>{if(ne){console.error("failed to load trip shape arrow",ne);return}ee.addImage("focused-trip-shape-arrow",te),ee.addLayer({id:"focused-trip-shape-arrows",type:"symbol",source:"focused-trip-shape",paint:{"icon-opacity":FOCUSED_TRIP_SHAPE_OPACITY},layout:{"symbol-placement":"line","icon-ignore-placement":!0,"icon-image":"focused-trip-shape-arrow","icon-size":.15}})}),this.map.addSource("focused-vehicle-position",{type:"geojson",data:null}),this.map.addLayer({id:"focused-vehicle-position",source:"focused-vehicle-position",type:"circle",paint:{"circle-radius":{base:5,stops:[[1,5],[20,100]]},"circle-color":VEHICLE_POINT_COLOR}}),this.updateMap()})}componentDidUpdate(){this.updateMap()}componentWillUnmount(){this.map&&(this.map.remove(),this.map=null)}render(){return u("div",{class:"map",ref:this.ref})}}const __viteBrowserExternal={},__viteBrowserExternal$1=Object.freeze(Object.defineProperty({__proto__:null,default:__viteBrowserExternal},Symbol.toStringTag,{value:"Module"})),require$$0=getAugmentedNamespace(__viteBrowserExternal$1);var objectInspect,hasRequiredObjectInspect;function requireObjectInspect(){if(hasRequiredObjectInspect)return objectInspect;hasRequiredObjectInspect=1;var Y=typeof Map=="function"&&Map.prototype,X=Object.getOwnPropertyDescriptor&&Y?Object.getOwnPropertyDescriptor(Map.prototype,"size"):null,ee=Y&&X&&typeof X.get=="function"?X.get:null,ne=Y&&Map.prototype.forEach,te=typeof Set=="function"&&Set.prototype,ue=Object.getOwnPropertyDescriptor&&te?Object.getOwnPropertyDescriptor(Set.prototype,"size"):null,se=te&&ue&&typeof ue.get=="function"?ue.get:null,ie=te&&Set.prototype.forEach,t=typeof WeakMap=="function"&&WeakMap.prototype,H=t?WeakMap.prototype.has:null,ae=typeof WeakSet=="function"&&WeakSet.prototype,he=ae?WeakSet.prototype.has:null,_e=typeof WeakRef=="function"&&WeakRef.prototype,ge=_e?WeakRef.prototype.deref:null,xe=Boolean.prototype.valueOf,Re=Object.prototype.toString,De=Function.prototype.toString,Ie=String.prototype.match,Ce=String.prototype.slice,Ue=String.prototype.replace,Le=String.prototype.toUpperCase,ke=String.prototype.toLowerCase,Ge=RegExp.prototype.test,Ze=Array.prototype.concat,We=Array.prototype.join,et=Array.prototype.slice,He=Math.floor,ht=typeof BigInt=="function"?BigInt.prototype.valueOf:null,_t=Object.getOwnPropertySymbols,ut=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?Symbol.prototype.toString:null,yt=typeof Symbol=="function"&&typeof Symbol.iterator=="object",Lt=typeof Symbol=="function"&&Symbol.toStringTag&&(typeof Symbol.toStringTag===yt||!0)?Symbol.toStringTag:null,Kt=Object.prototype.propertyIsEnumerable,ft=(typeof Reflect=="function"?Reflect.getPrototypeOf:Object.getPrototypeOf)||([].__proto__===Array.prototype?function(xt){return xt.__proto__}:null);function qt(xt,Ct){if(xt===1/0||xt===-1/0||xt!==xt||xt&&xt>-1e3&&xt<1e3||Ge.call(/e/,Ct))return Ct;var Nt=/[0-9](?=(?:[0-9]{3})+(?![0-9]))/g;if(typeof xt=="number"){var dr=xt<0?-He(-xt):He(xt);if(dr!==xt){var Ke=String(dr),Me=Ce.call(Ct,Ke.length+1);return Ue.call(Ke,Nt,"$&_")+"."+Ue.call(Ue.call(Me,/([0-9]{3})/g,"$&_"),/_$/,"")}}return Ue.call(Ct,Nt,"$&_")}var nt=require$$0,At=nt.custom,wt=ui(At)?At:null,Ft={__proto__:null,double:'"',single:"'"},er={__proto__:null,double:/(["\\])/g,single:/(['\\])/g};objectInspect=function xt(Ct,Nt,dr,Ke){var Me=Nt||{};if(Br(Me,"quoteStyle")&&!Br(Ft,Me.quoteStyle))throw new TypeError('option "quoteStyle" must be "single" or "double"');if(Br(Me,"maxStringLength")&&(typeof Me.maxStringLength=="number"?Me.maxStringLength<0&&Me.maxStringLength!==1/0:Me.maxStringLength!==null))throw new TypeError('option "maxStringLength", if provided, must be a positive integer, Infinity, or `null`');var Ne=Br(Me,"customInspect")?Me.customInspect:!0;if(typeof Ne!="boolean"&&Ne!=="symbol")throw new TypeError("option \"customInspect\", if provided, must be `true`, `false`, or `'symbol'`");if(Br(Me,"indent")&&Me.indent!==null&&Me.indent!=="	"&&!(parseInt(Me.indent,10)===Me.indent&&Me.indent>0))throw new TypeError('option "indent" must be "\\t", an integer > 0, or `null`');if(Br(Me,"numericSeparator")&&typeof Me.numericSeparator!="boolean")throw new TypeError('option "numericSeparator", if provided, must be `true` or `false`');var rt=Me.numericSeparator;if(typeof Ct>"u")return"undefined";if(Ct===null)return"null";if(typeof Ct=="boolean")return Ct?"true":"false";if(typeof Ct=="string")return je(Ct,Me);if(typeof Ct=="number"){if(Ct===0)return 1/0/Ct>0?"0":"-0";var dt=String(Ct);return rt?qt(Ct,dt):dt}if(typeof Ct=="bigint"){var vt=String(Ct)+"n";return rt?qt(Ct,vt):vt}var Mt=typeof Me.depth>"u"?5:Me.depth;if(typeof dr>"u"&&(dr=0),dr>=Mt&&Mt>0&&typeof Ct=="object")return Lr(Ct)?"[Array]":"[Object]";var Pt=Ot(Me,dr);if(typeof Ke>"u")Ke=[];else if(Qr(Ke,Ct)>=0)return"[Circular]";function St(Xt,Ut,wr){if(Ut&&(Ke=et.call(Ke),Ke.push(Ut)),wr){var zr={depth:Me.depth};return Br(Me,"quoteStyle")&&(zr.quoteStyle=Me.quoteStyle),xt(Xt,zr,dr+1,Ke)}return xt(Xt,Me,dr+1,Ke)}if(typeof Ct=="function"&&!Rr(Ct)){var Wt=si(Ct),br=Qt(Ct,St);return"[Function"+(Wt?": "+Wt:" (anonymous)")+"]"+(br.length>0?" { "+We.call(br,", ")+" }":"")}if(ui(Ct)){var Ar=yt?Ue.call(String(Ct),/^(Symbol\(.*\))_[^)]*$/,"$1"):ut.call(Ct);return typeof Ct=="object"&&!yt?Oe(Ar):Ar}if(Nr(Ct)){for(var cr="<"+ke.call(String(Ct.nodeName)),ti=Ct.attributes||[],ci=0;ci<ti.length;ci++)cr+=" "+ti[ci].name+"="+lr(jr(ti[ci].value),"double",Me);return cr+=">",Ct.childNodes&&Ct.childNodes.length&&(cr+="..."),cr+="</"+ke.call(String(Ct.nodeName))+">",cr}if(Lr(Ct)){if(Ct.length===0)return"[]";var ni=Qt(Ct,St);return Pt&&!gt(ni)?"["+tr(ni,Pt)+"]":"[ "+We.call(ni,", ")+" ]"}if(Ur(Ct)){var oi=Qt(Ct,St);return!("cause"in Error.prototype)&&"cause"in Ct&&!Kt.call(Ct,"cause")?"{ ["+String(Ct)+"] "+We.call(Ze.call("[cause]: "+St(Ct.cause),oi),", ")+" }":oi.length===0?"["+String(Ct)+"]":"{ ["+String(Ct)+"] "+We.call(oi,", ")+" }"}if(typeof Ct=="object"&&Ne){if(wt&&typeof Ct[wt]=="function"&&nt)return nt(Ct,{depth:Mt-dr});if(Ne!=="symbol"&&typeof Ct.inspect=="function")return Ct.inspect()}if(_r(Ct)){var yi=[];return ne&&ne.call(Ct,function(Xt,Ut){yi.push(St(Ut,Ct,!0)+" => "+St(Xt,Ct))}),st("Map",ee.call(Ct),yi,Pt)}if(Ir(Ct)){var Ai=[];return ie&&ie.call(Ct,function(Xt){Ai.push(St(Xt,Ct))}),st("Set",se.call(Ct),Ai,Pt)}if(vr(Ct))return Ve("WeakMap");if(Or(Ct))return Ve("WeakSet");if(Xr(Ct))return Ve("WeakRef");if(Er(Ct))return Oe(St(Number(Ct)));if(Ei(Ct))return Oe(St(ht.call(Ct)));if(Kr(Ct))return Oe(xe.call(Ct));if(Wr(Ct))return Oe(St(String(Ct)));if(typeof window<"u"&&Ct===window)return"{ [object Window] }";if(typeof globalThis<"u"&&Ct===globalThis||typeof commonjsGlobal<"u"&&Ct===commonjsGlobal)return"{ [object globalThis] }";if(!sr(Ct)&&!Rr(Ct)){var wi=Qt(Ct,St),Mi=ft?ft(Ct)===Object.prototype:Ct instanceof Object||Ct.constructor===Object,Hi=Ct instanceof Object?"":"null prototype",qn=!Mi&&Lt&&Object(Ct)===Ct&&Lt in Ct?Ce.call(li(Ct),8,-1):Hi?"Object":"",Gt=Mi||typeof Ct.constructor!="function"?"":Ct.constructor.name?Ct.constructor.name+" ":"",fr=Gt+(qn||Hi?"["+We.call(Ze.call([],qn||[],Hi||[]),": ")+"] ":"");return wi.length===0?fr+"{}":Pt?fr+"{"+tr(wi,Pt)+"}":fr+"{ "+We.call(wi,", ")+" }"}return String(Ct)};function lr(xt,Ct,Nt){var dr=Nt.quoteStyle||Ct,Ke=Ft[dr];return Ke+xt+Ke}function jr(xt){return Ue.call(String(xt),/"/g,"&quot;")}function Mr(xt){return!Lt||!(typeof xt=="object"&&(Lt in xt||typeof xt[Lt]<"u"))}function Lr(xt){return li(xt)==="[object Array]"&&Mr(xt)}function sr(xt){return li(xt)==="[object Date]"&&Mr(xt)}function Rr(xt){return li(xt)==="[object RegExp]"&&Mr(xt)}function Ur(xt){return li(xt)==="[object Error]"&&Mr(xt)}function Wr(xt){return li(xt)==="[object String]"&&Mr(xt)}function Er(xt){return li(xt)==="[object Number]"&&Mr(xt)}function Kr(xt){return li(xt)==="[object Boolean]"&&Mr(xt)}function ui(xt){if(yt)return xt&&typeof xt=="object"&&xt instanceof Symbol;if(typeof xt=="symbol")return!0;if(!xt||typeof xt!="object"||!ut)return!1;try{return ut.call(xt),!0}catch{}return!1}function Ei(xt){if(!xt||typeof xt!="object"||!ht)return!1;try{return ht.call(xt),!0}catch{}return!1}var Hr=Object.prototype.hasOwnProperty||function(xt){return xt in this};function Br(xt,Ct){return Hr.call(xt,Ct)}function li(xt){return Re.call(xt)}function si(xt){if(xt.name)return xt.name;var Ct=Ie.call(De.call(xt),/^function\s*([\w$]+)/);return Ct?Ct[1]:null}function Qr(xt,Ct){if(xt.indexOf)return xt.indexOf(Ct);for(var Nt=0,dr=xt.length;Nt<dr;Nt++)if(xt[Nt]===Ct)return Nt;return-1}function _r(xt){if(!ee||!xt||typeof xt!="object")return!1;try{ee.call(xt);try{se.call(xt)}catch{return!0}return xt instanceof Map}catch{}return!1}function vr(xt){if(!H||!xt||typeof xt!="object")return!1;try{H.call(xt,H);try{he.call(xt,he)}catch{return!0}return xt instanceof WeakMap}catch{}return!1}function Xr(xt){if(!ge||!xt||typeof xt!="object")return!1;try{return ge.call(xt),!0}catch{}return!1}function Ir(xt){if(!se||!xt||typeof xt!="object")return!1;try{se.call(xt);try{ee.call(xt)}catch{return!0}return xt instanceof Set}catch{}return!1}function Or(xt){if(!he||!xt||typeof xt!="object")return!1;try{he.call(xt,he);try{H.call(xt,H)}catch{return!0}return xt instanceof WeakSet}catch{}return!1}function Nr(xt){return!xt||typeof xt!="object"?!1:typeof HTMLElement<"u"&&xt instanceof HTMLElement?!0:typeof xt.nodeName=="string"&&typeof xt.getAttribute=="function"}function je(xt,Ct){if(xt.length>Ct.maxStringLength){var Nt=xt.length-Ct.maxStringLength,dr="... "+Nt+" more character"+(Nt>1?"s":"");return je(Ce.call(xt,0,Ct.maxStringLength),Ct)+dr}var Ke=er[Ct.quoteStyle||"single"];Ke.lastIndex=0;var Me=Ue.call(Ue.call(xt,Ke,"\\$1"),/[\x00-\x1f]/g,Se);return lr(Me,"single",Ct)}function Se(xt){var Ct=xt.charCodeAt(0),Nt={8:"b",9:"t",10:"n",12:"f",13:"r"}[Ct];return Nt?"\\"+Nt:"\\x"+(Ct<16?"0":"")+Le.call(Ct.toString(16))}function Oe(xt){return"Object("+xt+")"}function Ve(xt){return xt+" { ? }"}function st(xt,Ct,Nt,dr){var Ke=dr?tr(Nt,dr):We.call(Nt,", ");return xt+" ("+Ct+") {"+Ke+"}"}function gt(xt){for(var Ct=0;Ct<xt.length;Ct++)if(Qr(xt[Ct],`
`)>=0)return!1;return!0}function Ot(xt,Ct){var Nt;if(xt.indent==="	")Nt="	";else if(typeof xt.indent=="number"&&xt.indent>0)Nt=We.call(Array(xt.indent+1)," ");else return null;return{base:Nt,prev:We.call(Array(Ct+1),Nt)}}function tr(xt,Ct){if(xt.length===0)return"";var Nt=`
`+Ct.prev+Ct.base;return Nt+We.call(xt,","+Nt)+`
`+Ct.prev}function Qt(xt,Ct){var Nt=Lr(xt),dr=[];if(Nt){dr.length=xt.length;for(var Ke=0;Ke<xt.length;Ke++)dr[Ke]=Br(xt,Ke)?Ct(xt[Ke],xt):""}var Me=typeof _t=="function"?_t(xt):[],Ne;if(yt){Ne={};for(var rt=0;rt<Me.length;rt++)Ne["$"+Me[rt]]=Me[rt]}for(var dt in xt)Br(xt,dt)&&(Nt&&String(Number(dt))===dt&&dt<xt.length||yt&&Ne["$"+dt]instanceof Symbol||(Ge.call(/[^\w$]/,dt)?dr.push(Ct(dt,xt)+": "+Ct(xt[dt],xt)):dr.push(dt+": "+Ct(xt[dt],xt))));if(typeof _t=="function")for(var vt=0;vt<Me.length;vt++)Kt.call(xt,Me[vt])&&dr.push("["+Ct(Me[vt])+"]: "+Ct(xt[Me[vt]],xt));return dr}return objectInspect}var objectInspectExports=requireObjectInspect();const inspect=getDefaultExportFromCjs(objectInspectExports),errorView=({state:Y,emit:X})=>{const ee=Y.feedError,ne=("	"+ee.stack.replace(/\n/g,`	
`)).trim();return u("div",{class:"error",children:[u("h2",{children:u("code",{children:"failed to fetch the feed"})}),u("pre",{children:u("code",{children:inspect(ee)+`
`+ne})})]})},mainView=({state:Y,emit:X})=>{const ee={log:logView,inspector:inspectorView,map:MapView,raw:rawView}[Y.view]||inspectorView;return u("div",{class:"app",children:[u(barView,{state:Y,emit:X}),u("div",{class:"view",children:Y.feedData?u(ee,{state:Y,emit:X}):Y.feedError?u(errorView,{state:Y,emit:X}):null})]})},state={},bus=new EventEmitter;bus.STATE_CHANGE=Symbol("state change");const emit=bus.emit.bind(bus);viewStore(state,bus);feedStore(state,bus);feedLogStore(state,bus);inspectorStore(state,bus);focusStore(state,bus);urlStore(state,bus);const rerender=()=>{E(u(mainView,{state,emit}),document.body)};bus.on(bus.STATE_CHANGE,rerender);rerender();
