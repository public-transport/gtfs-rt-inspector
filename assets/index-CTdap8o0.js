(function(){const Y=document.createElement("link").relList;if(Y&&Y.supports&&Y.supports("modulepreload"))return;for(const ne of document.querySelectorAll('link[rel="modulepreload"]'))ae(ne);new MutationObserver(ne=>{for(const ce of ne)if(ce.type==="childList")for(const ee of ce.addedNodes)ee.tagName==="LINK"&&ee.rel==="modulepreload"&&ae(ee)}).observe(document,{childList:!0,subtree:!0});function re(ne){const ce={};return ne.integrity&&(ce.integrity=ne.integrity),ne.referrerPolicy&&(ce.referrerPolicy=ne.referrerPolicy),ne.crossOrigin==="use-credentials"?ce.credentials="include":ne.crossOrigin==="anonymous"?ce.credentials="omit":ce.credentials="same-origin",ce}function ae(ne){if(ne.ep)return;ne.ep=!0;const ce=re(ne);fetch(ne.href,ce)}})();var n,l,u$1,i,r,o,e,f$1,c,s,a,p={},v=[],y=/acit|ex(?:s|g|n|p|$)|rph|grid|ows|mnc|ntw|ine[ch]|zoo|^ord|itera/i,w=Array.isArray;function d(J,Y){for(var re in Y)J[re]=Y[re];return J}function g(J){J&&J.parentNode&&J.parentNode.removeChild(J)}function _(J,Y,re){var ae,ne,ce,ee={};for(ce in Y)ce=="key"?ae=Y[ce]:ce=="ref"?ne=Y[ce]:ee[ce]=Y[ce];if(arguments.length>2&&(ee.children=arguments.length>3?n.call(arguments,2):re),typeof J=="function"&&J.defaultProps!=null)for(ce in J.defaultProps)ee[ce]===void 0&&(ee[ce]=J.defaultProps[ce]);return m(J,ee,ae,ne,null)}function m(J,Y,re,ae,ne){var ce={type:J,props:Y,key:re,ref:ae,__k:null,__:null,__b:0,__e:null,__c:null,constructor:void 0,__v:ne??++u$1,__i:-1,__u:0};return ne==null&&l.vnode!=null&&l.vnode(ce),ce}function b(){return{current:null}}function k(J){return J.children}function x(J,Y){this.props=J,this.context=Y}function S(J,Y){if(Y==null)return J.__?S(J.__,J.__i+1):null;for(var re;Y<J.__k.length;Y++)if((re=J.__k[Y])!=null&&re.__e!=null)return re.__e;return typeof J.type=="function"?S(J):null}function C(J){var Y,re;if((J=J.__)!=null&&J.__c!=null){for(J.__e=J.__c.base=null,Y=0;Y<J.__k.length;Y++)if((re=J.__k[Y])!=null&&re.__e!=null){J.__e=J.__c.base=re.__e;break}return C(J)}}function M(J){(!J.__d&&(J.__d=!0)&&i.push(J)&&!$.__r++||r!=l.debounceRendering)&&((r=l.debounceRendering)||o)($)}function $(){for(var J,Y,re,ae,ne,ce,ee,R=1;i.length;)i.length>R&&i.sort(e),J=i.shift(),R=i.length,J.__d&&(re=void 0,ae=void 0,ne=(ae=(Y=J).__v).__e,ce=[],ee=[],Y.__P&&((re=d({},ae)).__v=ae.__v+1,l.vnode&&l.vnode(re),O(Y.__P,re,ae,Y.__n,Y.__P.namespaceURI,32&ae.__u?[ne]:null,ce,ne??S(ae),!!(32&ae.__u),ee),re.__v=ae.__v,re.__.__k[re.__i]=re,N(ce,re,ee),ae.__e=ae.__=null,re.__e!=ne&&C(re)));$.__r=0}function I(J,Y,re,ae,ne,ce,ee,R,U,K,oe){var pe,_e,me,we,Oe,De,Ae,Ce=ae&&ae.__k||v,je=Y.length;for(U=P(re,Y,Ce,U,je),pe=0;pe<je;pe++)(me=re.__k[pe])!=null&&(_e=me.__i==-1?p:Ce[me.__i]||p,me.__i=pe,De=O(J,me,_e,ne,ce,ee,R,U,K,oe),we=me.__e,me.ref&&_e.ref!=me.ref&&(_e.ref&&B(_e.ref,null,me),oe.push(me.ref,me.__c||we,me)),Oe==null&&we!=null&&(Oe=we),(Ae=!!(4&me.__u))||_e.__k===me.__k?U=A(me,U,J,Ae):typeof me.type=="function"&&De!==void 0?U=De:we&&(U=we.nextSibling),me.__u&=-7);return re.__e=Oe,U}function P(J,Y,re,ae,ne){var ce,ee,R,U,K,oe=re.length,pe=oe,_e=0;for(J.__k=new Array(ne),ce=0;ce<ne;ce++)(ee=Y[ce])!=null&&typeof ee!="boolean"&&typeof ee!="function"?(U=ce+_e,(ee=J.__k[ce]=typeof ee=="string"||typeof ee=="number"||typeof ee=="bigint"||ee.constructor==String?m(null,ee,null,null,null):w(ee)?m(k,{children:ee},null,null,null):ee.constructor==null&&ee.__b>0?m(ee.type,ee.props,ee.key,ee.ref?ee.ref:null,ee.__v):ee).__=J,ee.__b=J.__b+1,R=null,(K=ee.__i=L(ee,re,U,pe))!=-1&&(pe--,(R=re[K])&&(R.__u|=2)),R==null||R.__v==null?(K==-1&&(ne>oe?_e--:ne<oe&&_e++),typeof ee.type!="function"&&(ee.__u|=4)):K!=U&&(K==U-1?_e--:K==U+1?_e++:(K>U?_e--:_e++,ee.__u|=4))):J.__k[ce]=null;if(pe)for(ce=0;ce<oe;ce++)(R=re[ce])!=null&&(2&R.__u)==0&&(R.__e==ae&&(ae=S(R)),D(R,R));return ae}function A(J,Y,re,ae){var ne,ce;if(typeof J.type=="function"){for(ne=J.__k,ce=0;ne&&ce<ne.length;ce++)ne[ce]&&(ne[ce].__=J,Y=A(ne[ce],Y,re,ae));return Y}J.__e!=Y&&(ae&&(Y&&J.type&&!Y.parentNode&&(Y=S(J)),re.insertBefore(J.__e,Y||null)),Y=J.__e);do Y=Y&&Y.nextSibling;while(Y!=null&&Y.nodeType==8);return Y}function L(J,Y,re,ae){var ne,ce,ee,R=J.key,U=J.type,K=Y[re],oe=K!=null&&(2&K.__u)==0;if(K===null&&J.key==null||oe&&R==K.key&&U==K.type)return re;if(ae>(oe?1:0)){for(ne=re-1,ce=re+1;ne>=0||ce<Y.length;)if((K=Y[ee=ne>=0?ne--:ce++])!=null&&(2&K.__u)==0&&R==K.key&&U==K.type)return ee}return-1}function T(J,Y,re){Y[0]=="-"?J.setProperty(Y,re??""):J[Y]=re==null?"":typeof re!="number"||y.test(Y)?re:re+"px"}function j(J,Y,re,ae,ne){var ce,ee;e:if(Y=="style")if(typeof re=="string")J.style.cssText=re;else{if(typeof ae=="string"&&(J.style.cssText=ae=""),ae)for(Y in ae)re&&Y in re||T(J.style,Y,"");if(re)for(Y in re)ae&&re[Y]==ae[Y]||T(J.style,Y,re[Y])}else if(Y[0]=="o"&&Y[1]=="n")ce=Y!=(Y=Y.replace(f$1,"$1")),ee=Y.toLowerCase(),Y=ee in J||Y=="onFocusOut"||Y=="onFocusIn"?ee.slice(2):Y.slice(2),J.l||(J.l={}),J.l[Y+ce]=re,re?ae?re.u=ae.u:(re.u=c,J.addEventListener(Y,ce?a:s,ce)):J.removeEventListener(Y,ce?a:s,ce);else{if(ne=="http://www.w3.org/2000/svg")Y=Y.replace(/xlink(H|:h)/,"h").replace(/sName$/,"s");else if(Y!="width"&&Y!="height"&&Y!="href"&&Y!="list"&&Y!="form"&&Y!="tabIndex"&&Y!="download"&&Y!="rowSpan"&&Y!="colSpan"&&Y!="role"&&Y!="popover"&&Y in J)try{J[Y]=re??"";break e}catch{}typeof re=="function"||(re==null||re===!1&&Y[4]!="-"?J.removeAttribute(Y):J.setAttribute(Y,Y=="popover"&&re==1?"":re))}}function F(J){return function(Y){if(this.l){var re=this.l[Y.type+J];if(Y.t==null)Y.t=c++;else if(Y.t<re.u)return;return re(l.event?l.event(Y):Y)}}}function O(J,Y,re,ae,ne,ce,ee,R,U,K){var oe,pe,_e,me,we,Oe,De,Ae,Ce,je,ke,Be,We,Je,Ke,et,it,nt=Y.type;if(Y.constructor!=null)return null;128&re.__u&&(U=!!(32&re.__u),ce=[R=Y.__e=re.__e]),(oe=l.__b)&&oe(Y);e:if(typeof nt=="function")try{if(Ae=Y.props,Ce="prototype"in nt&&nt.prototype.render,je=(oe=nt.contextType)&&ae[oe.__c],ke=oe?je?je.props.value:oe.__:ae,re.__c?De=(pe=Y.__c=re.__c).__=pe.__E:(Ce?Y.__c=pe=new nt(Ae,ke):(Y.__c=pe=new x(Ae,ke),pe.constructor=nt,pe.render=E),je&&je.sub(pe),pe.props=Ae,pe.state||(pe.state={}),pe.context=ke,pe.__n=ae,_e=pe.__d=!0,pe.__h=[],pe._sb=[]),Ce&&pe.__s==null&&(pe.__s=pe.state),Ce&&nt.getDerivedStateFromProps!=null&&(pe.__s==pe.state&&(pe.__s=d({},pe.__s)),d(pe.__s,nt.getDerivedStateFromProps(Ae,pe.__s))),me=pe.props,we=pe.state,pe.__v=Y,_e)Ce&&nt.getDerivedStateFromProps==null&&pe.componentWillMount!=null&&pe.componentWillMount(),Ce&&pe.componentDidMount!=null&&pe.__h.push(pe.componentDidMount);else{if(Ce&&nt.getDerivedStateFromProps==null&&Ae!==me&&pe.componentWillReceiveProps!=null&&pe.componentWillReceiveProps(Ae,ke),!pe.__e&&pe.shouldComponentUpdate!=null&&pe.shouldComponentUpdate(Ae,pe.__s,ke)===!1||Y.__v==re.__v){for(Y.__v!=re.__v&&(pe.props=Ae,pe.state=pe.__s,pe.__d=!1),Y.__e=re.__e,Y.__k=re.__k,Y.__k.some(function(ct){ct&&(ct.__=Y)}),Be=0;Be<pe._sb.length;Be++)pe.__h.push(pe._sb[Be]);pe._sb=[],pe.__h.length&&ee.push(pe);break e}pe.componentWillUpdate!=null&&pe.componentWillUpdate(Ae,pe.__s,ke),Ce&&pe.componentDidUpdate!=null&&pe.__h.push(function(){pe.componentDidUpdate(me,we,Oe)})}if(pe.context=ke,pe.props=Ae,pe.__P=J,pe.__e=!1,We=l.__r,Je=0,Ce){for(pe.state=pe.__s,pe.__d=!1,We&&We(Y),oe=pe.render(pe.props,pe.state,pe.context),Ke=0;Ke<pe._sb.length;Ke++)pe.__h.push(pe._sb[Ke]);pe._sb=[]}else do pe.__d=!1,We&&We(Y),oe=pe.render(pe.props,pe.state,pe.context),pe.state=pe.__s;while(pe.__d&&++Je<25);pe.state=pe.__s,pe.getChildContext!=null&&(ae=d(d({},ae),pe.getChildContext())),Ce&&!_e&&pe.getSnapshotBeforeUpdate!=null&&(Oe=pe.getSnapshotBeforeUpdate(me,we)),et=oe,oe!=null&&oe.type===k&&oe.key==null&&(et=V(oe.props.children)),R=I(J,w(et)?et:[et],Y,re,ae,ne,ce,ee,R,U,K),pe.base=Y.__e,Y.__u&=-161,pe.__h.length&&ee.push(pe),De&&(pe.__E=pe.__=null)}catch(ct){if(Y.__v=null,U||ce!=null)if(ct.then){for(Y.__u|=U?160:128;R&&R.nodeType==8&&R.nextSibling;)R=R.nextSibling;ce[ce.indexOf(R)]=null,Y.__e=R}else{for(it=ce.length;it--;)g(ce[it]);z(Y)}else Y.__e=re.__e,Y.__k=re.__k,ct.then||z(Y);l.__e(ct,Y,re)}else ce==null&&Y.__v==re.__v?(Y.__k=re.__k,Y.__e=re.__e):R=Y.__e=q(re.__e,Y,re,ae,ne,ce,ee,U,K);return(oe=l.diffed)&&oe(Y),128&Y.__u?void 0:R}function z(J){J&&J.__c&&(J.__c.__e=!0),J&&J.__k&&J.__k.forEach(z)}function N(J,Y,re){for(var ae=0;ae<re.length;ae++)B(re[ae],re[++ae],re[++ae]);l.__c&&l.__c(Y,J),J.some(function(ne){try{J=ne.__h,ne.__h=[],J.some(function(ce){ce.call(ne)})}catch(ce){l.__e(ce,ne.__v)}})}function V(J){return typeof J!="object"||J==null||J.__b&&J.__b>0?J:w(J)?J.map(V):d({},J)}function q(J,Y,re,ae,ne,ce,ee,R,U){var K,oe,pe,_e,me,we,Oe,De=re.props,Ae=Y.props,Ce=Y.type;if(Ce=="svg"?ne="http://www.w3.org/2000/svg":Ce=="math"?ne="http://www.w3.org/1998/Math/MathML":ne||(ne="http://www.w3.org/1999/xhtml"),ce!=null){for(K=0;K<ce.length;K++)if((me=ce[K])&&"setAttribute"in me==!!Ce&&(Ce?me.localName==Ce:me.nodeType==3)){J=me,ce[K]=null;break}}if(J==null){if(Ce==null)return document.createTextNode(Ae);J=document.createElementNS(ne,Ce,Ae.is&&Ae),R&&(l.__m&&l.__m(Y,ce),R=!1),ce=null}if(Ce==null)De===Ae||R&&J.data==Ae||(J.data=Ae);else{if(ce=ce&&n.call(J.childNodes),De=re.props||p,!R&&ce!=null)for(De={},K=0;K<J.attributes.length;K++)De[(me=J.attributes[K]).name]=me.value;for(K in De)if(me=De[K],K!="children"){if(K=="dangerouslySetInnerHTML")pe=me;else if(!(K in Ae)){if(K=="value"&&"defaultValue"in Ae||K=="checked"&&"defaultChecked"in Ae)continue;j(J,K,null,me,ne)}}for(K in Ae)me=Ae[K],K=="children"?_e=me:K=="dangerouslySetInnerHTML"?oe=me:K=="value"?we=me:K=="checked"?Oe=me:R&&typeof me!="function"||De[K]===me||j(J,K,me,De[K],ne);if(oe)R||pe&&(oe.__html==pe.__html||oe.__html==J.innerHTML)||(J.innerHTML=oe.__html),Y.__k=[];else if(pe&&(J.innerHTML=""),I(Y.type=="template"?J.content:J,w(_e)?_e:[_e],Y,re,ae,Ce=="foreignObject"?"http://www.w3.org/1999/xhtml":ne,ce,ee,ce?ce[0]:re.__k&&S(re,0),R,U),ce!=null)for(K=ce.length;K--;)g(ce[K]);R||(K="value",Ce=="progress"&&we==null?J.removeAttribute("value"):we!=null&&(we!==J[K]||Ce=="progress"&&!we||Ce=="option"&&we!=De[K])&&j(J,K,we,De[K],ne),K="checked",Oe!=null&&Oe!=J[K]&&j(J,K,Oe,De[K],ne))}return J}function B(J,Y,re){try{if(typeof J=="function"){var ae=typeof J.__u=="function";ae&&J.__u(),ae&&Y==null||(J.__u=J(Y))}else J.current=Y}catch(ne){l.__e(ne,re)}}function D(J,Y,re){var ae,ne;if(l.unmount&&l.unmount(J),(ae=J.ref)&&(ae.current&&ae.current!=J.__e||B(ae,null,Y)),(ae=J.__c)!=null){if(ae.componentWillUnmount)try{ae.componentWillUnmount()}catch(ce){l.__e(ce,Y)}ae.base=ae.__P=null}if(ae=J.__k)for(ne=0;ne<ae.length;ne++)ae[ne]&&D(ae[ne],Y,re||typeof J.type!="function");re||g(J.__e),J.__c=J.__=J.__e=void 0}function E(J,Y,re){return this.constructor(J,re)}function G(J,Y,re){var ae,ne,ce,ee;Y==document&&(Y=document.documentElement),l.__&&l.__(J,Y),ne=(ae=!1)?null:Y.__k,ce=[],ee=[],O(Y,J=Y.__k=_(k,null,[J]),ne||p,p,Y.namespaceURI,ne?null:Y.firstChild?n.call(Y.childNodes):null,ce,ne?ne.__e:Y.firstChild,ae,ee),N(ce,J,ee)}n=v.slice,l={__e:function(J,Y,re,ae){for(var ne,ce,ee;Y=Y.__;)if((ne=Y.__c)&&!ne.__)try{if((ce=ne.constructor)&&ce.getDerivedStateFromError!=null&&(ne.setState(ce.getDerivedStateFromError(J)),ee=ne.__d),ne.componentDidCatch!=null&&(ne.componentDidCatch(J,ae||{}),ee=ne.__d),ee)return ne.__E=ne}catch(R){J=R}throw J}},u$1=0,x.prototype.setState=function(J,Y){var re;re=this.__s!=null&&this.__s!=this.state?this.__s:this.__s=d({},this.state),typeof J=="function"&&(J=J(d({},re),this.props)),J&&d(re,J),J!=null&&this.__v&&(Y&&this._sb.push(Y),M(this))},x.prototype.forceUpdate=function(J){this.__v&&(this.__e=!0,J&&this.__h.push(J),M(this))},x.prototype.render=k,i=[],o=typeof Promise=="function"?Promise.prototype.then.bind(Promise.resolve()):setTimeout,e=function(J,Y){return J.__v.__b-Y.__v.__b},$.__r=0,f$1=/(PointerCapture)$|Capture$/i,c=0,s=F(!1),a=F(!0);var f=0;function u(J,Y,re,ae,ne,ce){Y||(Y={});var ee,R,U=Y;if("ref"in U)for(R in U={},Y)R=="ref"?ee=Y[R]:U[R]=Y[R];var K={type:J,props:U,key:re,ref:ee,__k:null,__:null,__b:0,__e:null,__c:null,constructor:void 0,__v:--f,__i:-1,__u:0,__source:ne,__self:ce};if(typeof J=="function"&&(ee=J.defaultProps))for(R in ee)U[R]===void 0&&(U[R]=ee[R]);return l.vnode&&l.vnode(K),K}var commonjsGlobal=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};function getDefaultExportFromCjs(J){return J&&J.__esModule&&Object.prototype.hasOwnProperty.call(J,"default")?J.default:J}function getAugmentedNamespace(J){if(Object.prototype.hasOwnProperty.call(J,"__esModule"))return J;var Y=J.default;if(typeof Y=="function"){var re=function ae(){return this instanceof ae?Reflect.construct(Y,arguments,this.constructor):Y.apply(this,arguments)};re.prototype=Y.prototype}else re={};return Object.defineProperty(re,"__esModule",{value:!0}),Object.keys(J).forEach(function(ae){var ne=Object.getOwnPropertyDescriptor(J,ae);Object.defineProperty(re,ae,ne.get?ne:{enumerable:!0,get:function(){return J[ae]}})}),re}var es_symbol={},es_symbol_constructor={},globalThis_1,hasRequiredGlobalThis;function requireGlobalThis(){if(hasRequiredGlobalThis)return globalThis_1;hasRequiredGlobalThis=1;var J=function(Y){return Y&&Y.Math===Math&&Y};return globalThis_1=J(typeof globalThis=="object"&&globalThis)||J(typeof window=="object"&&window)||J(typeof self=="object"&&self)||J(typeof commonjsGlobal=="object"&&commonjsGlobal)||J(typeof globalThis_1=="object"&&globalThis_1)||(function(){return this})()||Function("return this")(),globalThis_1}var objectGetOwnPropertyDescriptor={},fails,hasRequiredFails;function requireFails(){return hasRequiredFails||(hasRequiredFails=1,fails=function(J){try{return!!J()}catch{return!0}}),fails}var descriptors,hasRequiredDescriptors;function requireDescriptors(){if(hasRequiredDescriptors)return descriptors;hasRequiredDescriptors=1;var J=requireFails();return descriptors=!J(function(){return Object.defineProperty({},1,{get:function(){return 7}})[1]!==7}),descriptors}var functionBindNative,hasRequiredFunctionBindNative;function requireFunctionBindNative(){if(hasRequiredFunctionBindNative)return functionBindNative;hasRequiredFunctionBindNative=1;var J=requireFails();return functionBindNative=!J(function(){var Y=(function(){}).bind();return typeof Y!="function"||Y.hasOwnProperty("prototype")}),functionBindNative}var functionCall,hasRequiredFunctionCall;function requireFunctionCall(){if(hasRequiredFunctionCall)return functionCall;hasRequiredFunctionCall=1;var J=requireFunctionBindNative(),Y=Function.prototype.call;return functionCall=J?Y.bind(Y):function(){return Y.apply(Y,arguments)},functionCall}var objectPropertyIsEnumerable={},hasRequiredObjectPropertyIsEnumerable;function requireObjectPropertyIsEnumerable(){if(hasRequiredObjectPropertyIsEnumerable)return objectPropertyIsEnumerable;hasRequiredObjectPropertyIsEnumerable=1;var J={}.propertyIsEnumerable,Y=Object.getOwnPropertyDescriptor,re=Y&&!J.call({1:2},1);return objectPropertyIsEnumerable.f=re?function(ne){var ce=Y(this,ne);return!!ce&&ce.enumerable}:J,objectPropertyIsEnumerable}var createPropertyDescriptor,hasRequiredCreatePropertyDescriptor;function requireCreatePropertyDescriptor(){return hasRequiredCreatePropertyDescriptor||(hasRequiredCreatePropertyDescriptor=1,createPropertyDescriptor=function(J,Y){return{enumerable:!(J&1),configurable:!(J&2),writable:!(J&4),value:Y}}),createPropertyDescriptor}var functionUncurryThis,hasRequiredFunctionUncurryThis;function requireFunctionUncurryThis(){if(hasRequiredFunctionUncurryThis)return functionUncurryThis;hasRequiredFunctionUncurryThis=1;var J=requireFunctionBindNative(),Y=Function.prototype,re=Y.call,ae=J&&Y.bind.bind(re,re);return functionUncurryThis=J?ae:function(ne){return function(){return re.apply(ne,arguments)}},functionUncurryThis}var classofRaw,hasRequiredClassofRaw;function requireClassofRaw(){if(hasRequiredClassofRaw)return classofRaw;hasRequiredClassofRaw=1;var J=requireFunctionUncurryThis(),Y=J({}.toString),re=J("".slice);return classofRaw=function(ae){return re(Y(ae),8,-1)},classofRaw}var indexedObject,hasRequiredIndexedObject;function requireIndexedObject(){if(hasRequiredIndexedObject)return indexedObject;hasRequiredIndexedObject=1;var J=requireFunctionUncurryThis(),Y=requireFails(),re=requireClassofRaw(),ae=Object,ne=J("".split);return indexedObject=Y(function(){return!ae("z").propertyIsEnumerable(0)})?function(ce){return re(ce)==="String"?ne(ce,""):ae(ce)}:ae,indexedObject}var isNullOrUndefined$1,hasRequiredIsNullOrUndefined;function requireIsNullOrUndefined(){return hasRequiredIsNullOrUndefined||(hasRequiredIsNullOrUndefined=1,isNullOrUndefined$1=function(J){return J==null}),isNullOrUndefined$1}var requireObjectCoercible,hasRequiredRequireObjectCoercible;function requireRequireObjectCoercible(){if(hasRequiredRequireObjectCoercible)return requireObjectCoercible;hasRequiredRequireObjectCoercible=1;var J=requireIsNullOrUndefined(),Y=TypeError;return requireObjectCoercible=function(re){if(J(re))throw new Y("Can't call method on "+re);return re},requireObjectCoercible}var toIndexedObject,hasRequiredToIndexedObject;function requireToIndexedObject(){if(hasRequiredToIndexedObject)return toIndexedObject;hasRequiredToIndexedObject=1;var J=requireIndexedObject(),Y=requireRequireObjectCoercible();return toIndexedObject=function(re){return J(Y(re))},toIndexedObject}var isCallable,hasRequiredIsCallable;function requireIsCallable(){if(hasRequiredIsCallable)return isCallable;hasRequiredIsCallable=1;var J=typeof document=="object"&&document.all;return isCallable=typeof J>"u"&&J!==void 0?function(Y){return typeof Y=="function"||Y===J}:function(Y){return typeof Y=="function"},isCallable}var isObject,hasRequiredIsObject$1;function requireIsObject$1(){if(hasRequiredIsObject$1)return isObject;hasRequiredIsObject$1=1;var J=requireIsCallable();return isObject=function(Y){return typeof Y=="object"?Y!==null:J(Y)},isObject}var getBuiltIn,hasRequiredGetBuiltIn;function requireGetBuiltIn(){if(hasRequiredGetBuiltIn)return getBuiltIn;hasRequiredGetBuiltIn=1;var J=requireGlobalThis(),Y=requireIsCallable(),re=function(ae){return Y(ae)?ae:void 0};return getBuiltIn=function(ae,ne){return arguments.length<2?re(J[ae]):J[ae]&&J[ae][ne]},getBuiltIn}var objectIsPrototypeOf,hasRequiredObjectIsPrototypeOf;function requireObjectIsPrototypeOf(){if(hasRequiredObjectIsPrototypeOf)return objectIsPrototypeOf;hasRequiredObjectIsPrototypeOf=1;var J=requireFunctionUncurryThis();return objectIsPrototypeOf=J({}.isPrototypeOf),objectIsPrototypeOf}var environmentUserAgent,hasRequiredEnvironmentUserAgent;function requireEnvironmentUserAgent(){if(hasRequiredEnvironmentUserAgent)return environmentUserAgent;hasRequiredEnvironmentUserAgent=1;var J=requireGlobalThis(),Y=J.navigator,re=Y&&Y.userAgent;return environmentUserAgent=re?String(re):"",environmentUserAgent}var environmentV8Version,hasRequiredEnvironmentV8Version;function requireEnvironmentV8Version(){if(hasRequiredEnvironmentV8Version)return environmentV8Version;hasRequiredEnvironmentV8Version=1;var J=requireGlobalThis(),Y=requireEnvironmentUserAgent(),re=J.process,ae=J.Deno,ne=re&&re.versions||ae&&ae.version,ce=ne&&ne.v8,ee,R;return ce&&(ee=ce.split("."),R=ee[0]>0&&ee[0]<4?1:+(ee[0]+ee[1])),!R&&Y&&(ee=Y.match(/Edge\/(\d+)/),(!ee||ee[1]>=74)&&(ee=Y.match(/Chrome\/(\d+)/),ee&&(R=+ee[1]))),environmentV8Version=R,environmentV8Version}var symbolConstructorDetection,hasRequiredSymbolConstructorDetection;function requireSymbolConstructorDetection(){if(hasRequiredSymbolConstructorDetection)return symbolConstructorDetection;hasRequiredSymbolConstructorDetection=1;var J=requireEnvironmentV8Version(),Y=requireFails(),re=requireGlobalThis(),ae=re.String;return symbolConstructorDetection=!!Object.getOwnPropertySymbols&&!Y(function(){var ne=Symbol("symbol detection");return!ae(ne)||!(Object(ne)instanceof Symbol)||!Symbol.sham&&J&&J<41}),symbolConstructorDetection}var useSymbolAsUid,hasRequiredUseSymbolAsUid;function requireUseSymbolAsUid(){if(hasRequiredUseSymbolAsUid)return useSymbolAsUid;hasRequiredUseSymbolAsUid=1;var J=requireSymbolConstructorDetection();return useSymbolAsUid=J&&!Symbol.sham&&typeof Symbol.iterator=="symbol",useSymbolAsUid}var isSymbol,hasRequiredIsSymbol$1;function requireIsSymbol$1(){if(hasRequiredIsSymbol$1)return isSymbol;hasRequiredIsSymbol$1=1;var J=requireGetBuiltIn(),Y=requireIsCallable(),re=requireObjectIsPrototypeOf(),ae=requireUseSymbolAsUid(),ne=Object;return isSymbol=ae?function(ce){return typeof ce=="symbol"}:function(ce){var ee=J("Symbol");return Y(ee)&&re(ee.prototype,ne(ce))},isSymbol}var tryToString,hasRequiredTryToString;function requireTryToString(){if(hasRequiredTryToString)return tryToString;hasRequiredTryToString=1;var J=String;return tryToString=function(Y){try{return J(Y)}catch{return"Object"}},tryToString}var aCallable,hasRequiredACallable;function requireACallable(){if(hasRequiredACallable)return aCallable;hasRequiredACallable=1;var J=requireIsCallable(),Y=requireTryToString(),re=TypeError;return aCallable=function(ae){if(J(ae))return ae;throw new re(Y(ae)+" is not a function")},aCallable}var getMethod,hasRequiredGetMethod;function requireGetMethod(){if(hasRequiredGetMethod)return getMethod;hasRequiredGetMethod=1;var J=requireACallable(),Y=requireIsNullOrUndefined();return getMethod=function(re,ae){var ne=re[ae];return Y(ne)?void 0:J(ne)},getMethod}var ordinaryToPrimitive,hasRequiredOrdinaryToPrimitive;function requireOrdinaryToPrimitive(){if(hasRequiredOrdinaryToPrimitive)return ordinaryToPrimitive;hasRequiredOrdinaryToPrimitive=1;var J=requireFunctionCall(),Y=requireIsCallable(),re=requireIsObject$1(),ae=TypeError;return ordinaryToPrimitive=function(ne,ce){var ee,R;if(ce==="string"&&Y(ee=ne.toString)&&!re(R=J(ee,ne))||Y(ee=ne.valueOf)&&!re(R=J(ee,ne))||ce!=="string"&&Y(ee=ne.toString)&&!re(R=J(ee,ne)))return R;throw new ae("Can't convert object to primitive value")},ordinaryToPrimitive}var sharedStore={exports:{}},isPure,hasRequiredIsPure;function requireIsPure(){return hasRequiredIsPure||(hasRequiredIsPure=1,isPure=!1),isPure}var defineGlobalProperty,hasRequiredDefineGlobalProperty;function requireDefineGlobalProperty(){if(hasRequiredDefineGlobalProperty)return defineGlobalProperty;hasRequiredDefineGlobalProperty=1;var J=requireGlobalThis(),Y=Object.defineProperty;return defineGlobalProperty=function(re,ae){try{Y(J,re,{value:ae,configurable:!0,writable:!0})}catch{J[re]=ae}return ae},defineGlobalProperty}var hasRequiredSharedStore;function requireSharedStore(){if(hasRequiredSharedStore)return sharedStore.exports;hasRequiredSharedStore=1;var J=requireIsPure(),Y=requireGlobalThis(),re=requireDefineGlobalProperty(),ae="__core-js_shared__",ne=sharedStore.exports=Y[ae]||re(ae,{});return(ne.versions||(ne.versions=[])).push({version:"3.46.0",mode:J?"pure":"global",copyright:"Â© 2014-2025 Denis Pushkarev (zloirock.ru), 2025 CoreJS Company (core-js.io)",license:"https://github.com/zloirock/core-js/blob/v3.46.0/LICENSE",source:"https://github.com/zloirock/core-js"}),sharedStore.exports}var shared,hasRequiredShared;function requireShared(){if(hasRequiredShared)return shared;hasRequiredShared=1;var J=requireSharedStore();return shared=function(Y,re){return J[Y]||(J[Y]=re||{})},shared}var toObject,hasRequiredToObject;function requireToObject(){if(hasRequiredToObject)return toObject;hasRequiredToObject=1;var J=requireRequireObjectCoercible(),Y=Object;return toObject=function(re){return Y(J(re))},toObject}var hasOwnProperty_1,hasRequiredHasOwnProperty;function requireHasOwnProperty(){if(hasRequiredHasOwnProperty)return hasOwnProperty_1;hasRequiredHasOwnProperty=1;var J=requireFunctionUncurryThis(),Y=requireToObject(),re=J({}.hasOwnProperty);return hasOwnProperty_1=Object.hasOwn||function(ne,ce){return re(Y(ne),ce)},hasOwnProperty_1}var uid,hasRequiredUid;function requireUid(){if(hasRequiredUid)return uid;hasRequiredUid=1;var J=requireFunctionUncurryThis(),Y=0,re=Math.random(),ae=J(1.1.toString);return uid=function(ne){return"Symbol("+(ne===void 0?"":ne)+")_"+ae(++Y+re,36)},uid}var wellKnownSymbol,hasRequiredWellKnownSymbol;function requireWellKnownSymbol(){if(hasRequiredWellKnownSymbol)return wellKnownSymbol;hasRequiredWellKnownSymbol=1;var J=requireGlobalThis(),Y=requireShared(),re=requireHasOwnProperty(),ae=requireUid(),ne=requireSymbolConstructorDetection(),ce=requireUseSymbolAsUid(),ee=J.Symbol,R=Y("wks"),U=ce?ee.for||ee:ee&&ee.withoutSetter||ae;return wellKnownSymbol=function(K){return re(R,K)||(R[K]=ne&&re(ee,K)?ee[K]:U("Symbol."+K)),R[K]},wellKnownSymbol}var toPrimitive,hasRequiredToPrimitive;function requireToPrimitive(){if(hasRequiredToPrimitive)return toPrimitive;hasRequiredToPrimitive=1;var J=requireFunctionCall(),Y=requireIsObject$1(),re=requireIsSymbol$1(),ae=requireGetMethod(),ne=requireOrdinaryToPrimitive(),ce=requireWellKnownSymbol(),ee=TypeError,R=ce("toPrimitive");return toPrimitive=function(U,K){if(!Y(U)||re(U))return U;var oe=ae(U,R),pe;if(oe){if(K===void 0&&(K="default"),pe=J(oe,U,K),!Y(pe)||re(pe))return pe;throw new ee("Can't convert object to primitive value")}return K===void 0&&(K="number"),ne(U,K)},toPrimitive}var toPropertyKey,hasRequiredToPropertyKey;function requireToPropertyKey(){if(hasRequiredToPropertyKey)return toPropertyKey;hasRequiredToPropertyKey=1;var J=requireToPrimitive(),Y=requireIsSymbol$1();return toPropertyKey=function(re){var ae=J(re,"string");return Y(ae)?ae:ae+""},toPropertyKey}var documentCreateElement,hasRequiredDocumentCreateElement;function requireDocumentCreateElement(){if(hasRequiredDocumentCreateElement)return documentCreateElement;hasRequiredDocumentCreateElement=1;var J=requireGlobalThis(),Y=requireIsObject$1(),re=J.document,ae=Y(re)&&Y(re.createElement);return documentCreateElement=function(ne){return ae?re.createElement(ne):{}},documentCreateElement}var ie8DomDefine,hasRequiredIe8DomDefine;function requireIe8DomDefine(){if(hasRequiredIe8DomDefine)return ie8DomDefine;hasRequiredIe8DomDefine=1;var J=requireDescriptors(),Y=requireFails(),re=requireDocumentCreateElement();return ie8DomDefine=!J&&!Y(function(){return Object.defineProperty(re("div"),"a",{get:function(){return 7}}).a!==7}),ie8DomDefine}var hasRequiredObjectGetOwnPropertyDescriptor;function requireObjectGetOwnPropertyDescriptor(){if(hasRequiredObjectGetOwnPropertyDescriptor)return objectGetOwnPropertyDescriptor;hasRequiredObjectGetOwnPropertyDescriptor=1;var J=requireDescriptors(),Y=requireFunctionCall(),re=requireObjectPropertyIsEnumerable(),ae=requireCreatePropertyDescriptor(),ne=requireToIndexedObject(),ce=requireToPropertyKey(),ee=requireHasOwnProperty(),R=requireIe8DomDefine(),U=Object.getOwnPropertyDescriptor;return objectGetOwnPropertyDescriptor.f=J?U:function(oe,pe){if(oe=ne(oe),pe=ce(pe),R)try{return U(oe,pe)}catch{}if(ee(oe,pe))return ae(!Y(re.f,oe,pe),oe[pe])},objectGetOwnPropertyDescriptor}var objectDefineProperty={},v8PrototypeDefineBug,hasRequiredV8PrototypeDefineBug;function requireV8PrototypeDefineBug(){if(hasRequiredV8PrototypeDefineBug)return v8PrototypeDefineBug;hasRequiredV8PrototypeDefineBug=1;var J=requireDescriptors(),Y=requireFails();return v8PrototypeDefineBug=J&&Y(function(){return Object.defineProperty(function(){},"prototype",{value:42,writable:!1}).prototype!==42}),v8PrototypeDefineBug}var anObject,hasRequiredAnObject;function requireAnObject(){if(hasRequiredAnObject)return anObject;hasRequiredAnObject=1;var J=requireIsObject$1(),Y=String,re=TypeError;return anObject=function(ae){if(J(ae))return ae;throw new re(Y(ae)+" is not an object")},anObject}var hasRequiredObjectDefineProperty;function requireObjectDefineProperty(){if(hasRequiredObjectDefineProperty)return objectDefineProperty;hasRequiredObjectDefineProperty=1;var J=requireDescriptors(),Y=requireIe8DomDefine(),re=requireV8PrototypeDefineBug(),ae=requireAnObject(),ne=requireToPropertyKey(),ce=TypeError,ee=Object.defineProperty,R=Object.getOwnPropertyDescriptor,U="enumerable",K="configurable",oe="writable";return objectDefineProperty.f=J?re?function(_e,me,we){if(ae(_e),me=ne(me),ae(we),typeof _e=="function"&&me==="prototype"&&"value"in we&&oe in we&&!we[oe]){var Oe=R(_e,me);Oe&&Oe[oe]&&(_e[me]=we.value,we={configurable:K in we?we[K]:Oe[K],enumerable:U in we?we[U]:Oe[U],writable:!1})}return ee(_e,me,we)}:ee:function(_e,me,we){if(ae(_e),me=ne(me),ae(we),Y)try{return ee(_e,me,we)}catch{}if("get"in we||"set"in we)throw new ce("Accessors not supported");return"value"in we&&(_e[me]=we.value),_e},objectDefineProperty}var createNonEnumerableProperty,hasRequiredCreateNonEnumerableProperty;function requireCreateNonEnumerableProperty(){if(hasRequiredCreateNonEnumerableProperty)return createNonEnumerableProperty;hasRequiredCreateNonEnumerableProperty=1;var J=requireDescriptors(),Y=requireObjectDefineProperty(),re=requireCreatePropertyDescriptor();return createNonEnumerableProperty=J?function(ae,ne,ce){return Y.f(ae,ne,re(1,ce))}:function(ae,ne,ce){return ae[ne]=ce,ae},createNonEnumerableProperty}var makeBuiltIn={exports:{}},functionName,hasRequiredFunctionName;function requireFunctionName(){if(hasRequiredFunctionName)return functionName;hasRequiredFunctionName=1;var J=requireDescriptors(),Y=requireHasOwnProperty(),re=Function.prototype,ae=J&&Object.getOwnPropertyDescriptor,ne=Y(re,"name"),ce=ne&&(function(){}).name==="something",ee=ne&&(!J||J&&ae(re,"name").configurable);return functionName={EXISTS:ne,PROPER:ce,CONFIGURABLE:ee},functionName}var inspectSource,hasRequiredInspectSource;function requireInspectSource(){if(hasRequiredInspectSource)return inspectSource;hasRequiredInspectSource=1;var J=requireFunctionUncurryThis(),Y=requireIsCallable(),re=requireSharedStore(),ae=J(Function.toString);return Y(re.inspectSource)||(re.inspectSource=function(ne){return ae(ne)}),inspectSource=re.inspectSource,inspectSource}var weakMapBasicDetection,hasRequiredWeakMapBasicDetection;function requireWeakMapBasicDetection(){if(hasRequiredWeakMapBasicDetection)return weakMapBasicDetection;hasRequiredWeakMapBasicDetection=1;var J=requireGlobalThis(),Y=requireIsCallable(),re=J.WeakMap;return weakMapBasicDetection=Y(re)&&/native code/.test(String(re)),weakMapBasicDetection}var sharedKey,hasRequiredSharedKey;function requireSharedKey(){if(hasRequiredSharedKey)return sharedKey;hasRequiredSharedKey=1;var J=requireShared(),Y=requireUid(),re=J("keys");return sharedKey=function(ae){return re[ae]||(re[ae]=Y(ae))},sharedKey}var hiddenKeys,hasRequiredHiddenKeys;function requireHiddenKeys(){return hasRequiredHiddenKeys||(hasRequiredHiddenKeys=1,hiddenKeys={}),hiddenKeys}var internalState,hasRequiredInternalState;function requireInternalState(){if(hasRequiredInternalState)return internalState;hasRequiredInternalState=1;var J=requireWeakMapBasicDetection(),Y=requireGlobalThis(),re=requireIsObject$1(),ae=requireCreateNonEnumerableProperty(),ne=requireHasOwnProperty(),ce=requireSharedStore(),ee=requireSharedKey(),R=requireHiddenKeys(),U="Object already initialized",K=Y.TypeError,oe=Y.WeakMap,pe,_e,me,we=function(Ce){return me(Ce)?_e(Ce):pe(Ce,{})},Oe=function(Ce){return function(je){var ke;if(!re(je)||(ke=_e(je)).type!==Ce)throw new K("Incompatible receiver, "+Ce+" required");return ke}};if(J||ce.state){var De=ce.state||(ce.state=new oe);De.get=De.get,De.has=De.has,De.set=De.set,pe=function(Ce,je){if(De.has(Ce))throw new K(U);return je.facade=Ce,De.set(Ce,je),je},_e=function(Ce){return De.get(Ce)||{}},me=function(Ce){return De.has(Ce)}}else{var Ae=ee("state");R[Ae]=!0,pe=function(Ce,je){if(ne(Ce,Ae))throw new K(U);return je.facade=Ce,ae(Ce,Ae,je),je},_e=function(Ce){return ne(Ce,Ae)?Ce[Ae]:{}},me=function(Ce){return ne(Ce,Ae)}}return internalState={set:pe,get:_e,has:me,enforce:we,getterFor:Oe},internalState}var hasRequiredMakeBuiltIn;function requireMakeBuiltIn(){if(hasRequiredMakeBuiltIn)return makeBuiltIn.exports;hasRequiredMakeBuiltIn=1;var J=requireFunctionUncurryThis(),Y=requireFails(),re=requireIsCallable(),ae=requireHasOwnProperty(),ne=requireDescriptors(),ce=requireFunctionName().CONFIGURABLE,ee=requireInspectSource(),R=requireInternalState(),U=R.enforce,K=R.get,oe=String,pe=Object.defineProperty,_e=J("".slice),me=J("".replace),we=J([].join),Oe=ne&&!Y(function(){return pe(function(){},"length",{value:8}).length!==8}),De=String(String).split("String"),Ae=makeBuiltIn.exports=function(Ce,je,ke){_e(oe(je),0,7)==="Symbol("&&(je="["+me(oe(je),/^Symbol\(([^)]*)\).*$/,"$1")+"]"),ke&&ke.getter&&(je="get "+je),ke&&ke.setter&&(je="set "+je),(!ae(Ce,"name")||ce&&Ce.name!==je)&&(ne?pe(Ce,"name",{value:je,configurable:!0}):Ce.name=je),Oe&&ke&&ae(ke,"arity")&&Ce.length!==ke.arity&&pe(Ce,"length",{value:ke.arity});try{ke&&ae(ke,"constructor")&&ke.constructor?ne&&pe(Ce,"prototype",{writable:!1}):Ce.prototype&&(Ce.prototype=void 0)}catch{}var Be=U(Ce);return ae(Be,"source")||(Be.source=we(De,typeof je=="string"?je:"")),Ce};return Function.prototype.toString=Ae(function(){return re(this)&&K(this).source||ee(this)},"toString"),makeBuiltIn.exports}var defineBuiltIn,hasRequiredDefineBuiltIn;function requireDefineBuiltIn(){if(hasRequiredDefineBuiltIn)return defineBuiltIn;hasRequiredDefineBuiltIn=1;var J=requireIsCallable(),Y=requireObjectDefineProperty(),re=requireMakeBuiltIn(),ae=requireDefineGlobalProperty();return defineBuiltIn=function(ne,ce,ee,R){R||(R={});var U=R.enumerable,K=R.name!==void 0?R.name:ce;if(J(ee)&&re(ee,K,R),R.global)U?ne[ce]=ee:ae(ce,ee);else{try{R.unsafe?ne[ce]&&(U=!0):delete ne[ce]}catch{}U?ne[ce]=ee:Y.f(ne,ce,{value:ee,enumerable:!1,configurable:!R.nonConfigurable,writable:!R.nonWritable})}return ne},defineBuiltIn}var objectGetOwnPropertyNames={},mathTrunc,hasRequiredMathTrunc;function requireMathTrunc(){if(hasRequiredMathTrunc)return mathTrunc;hasRequiredMathTrunc=1;var J=Math.ceil,Y=Math.floor;return mathTrunc=Math.trunc||function(ae){var ne=+ae;return(ne>0?Y:J)(ne)},mathTrunc}var toIntegerOrInfinity,hasRequiredToIntegerOrInfinity;function requireToIntegerOrInfinity(){if(hasRequiredToIntegerOrInfinity)return toIntegerOrInfinity;hasRequiredToIntegerOrInfinity=1;var J=requireMathTrunc();return toIntegerOrInfinity=function(Y){var re=+Y;return re!==re||re===0?0:J(re)},toIntegerOrInfinity}var toAbsoluteIndex,hasRequiredToAbsoluteIndex;function requireToAbsoluteIndex(){if(hasRequiredToAbsoluteIndex)return toAbsoluteIndex;hasRequiredToAbsoluteIndex=1;var J=requireToIntegerOrInfinity(),Y=Math.max,re=Math.min;return toAbsoluteIndex=function(ae,ne){var ce=J(ae);return ce<0?Y(ce+ne,0):re(ce,ne)},toAbsoluteIndex}var toLength,hasRequiredToLength;function requireToLength(){if(hasRequiredToLength)return toLength;hasRequiredToLength=1;var J=requireToIntegerOrInfinity(),Y=Math.min;return toLength=function(re){var ae=J(re);return ae>0?Y(ae,9007199254740991):0},toLength}var lengthOfArrayLike,hasRequiredLengthOfArrayLike;function requireLengthOfArrayLike(){if(hasRequiredLengthOfArrayLike)return lengthOfArrayLike;hasRequiredLengthOfArrayLike=1;var J=requireToLength();return lengthOfArrayLike=function(Y){return J(Y.length)},lengthOfArrayLike}var arrayIncludes,hasRequiredArrayIncludes;function requireArrayIncludes(){if(hasRequiredArrayIncludes)return arrayIncludes;hasRequiredArrayIncludes=1;var J=requireToIndexedObject(),Y=requireToAbsoluteIndex(),re=requireLengthOfArrayLike(),ae=function(ne){return function(ce,ee,R){var U=J(ce),K=re(U);if(K===0)return!ne&&-1;var oe=Y(R,K),pe;if(ne&&ee!==ee){for(;K>oe;)if(pe=U[oe++],pe!==pe)return!0}else for(;K>oe;oe++)if((ne||oe in U)&&U[oe]===ee)return ne||oe||0;return!ne&&-1}};return arrayIncludes={includes:ae(!0),indexOf:ae(!1)},arrayIncludes}var objectKeysInternal,hasRequiredObjectKeysInternal;function requireObjectKeysInternal(){if(hasRequiredObjectKeysInternal)return objectKeysInternal;hasRequiredObjectKeysInternal=1;var J=requireFunctionUncurryThis(),Y=requireHasOwnProperty(),re=requireToIndexedObject(),ae=requireArrayIncludes().indexOf,ne=requireHiddenKeys(),ce=J([].push);return objectKeysInternal=function(ee,R){var U=re(ee),K=0,oe=[],pe;for(pe in U)!Y(ne,pe)&&Y(U,pe)&&ce(oe,pe);for(;R.length>K;)Y(U,pe=R[K++])&&(~ae(oe,pe)||ce(oe,pe));return oe},objectKeysInternal}var enumBugKeys,hasRequiredEnumBugKeys;function requireEnumBugKeys(){return hasRequiredEnumBugKeys||(hasRequiredEnumBugKeys=1,enumBugKeys=["constructor","hasOwnProperty","isPrototypeOf","propertyIsEnumerable","toLocaleString","toString","valueOf"]),enumBugKeys}var hasRequiredObjectGetOwnPropertyNames;function requireObjectGetOwnPropertyNames(){if(hasRequiredObjectGetOwnPropertyNames)return objectGetOwnPropertyNames;hasRequiredObjectGetOwnPropertyNames=1;var J=requireObjectKeysInternal(),Y=requireEnumBugKeys(),re=Y.concat("length","prototype");return objectGetOwnPropertyNames.f=Object.getOwnPropertyNames||function(ne){return J(ne,re)},objectGetOwnPropertyNames}var objectGetOwnPropertySymbols={},hasRequiredObjectGetOwnPropertySymbols;function requireObjectGetOwnPropertySymbols(){return hasRequiredObjectGetOwnPropertySymbols||(hasRequiredObjectGetOwnPropertySymbols=1,objectGetOwnPropertySymbols.f=Object.getOwnPropertySymbols),objectGetOwnPropertySymbols}var ownKeys,hasRequiredOwnKeys;function requireOwnKeys(){if(hasRequiredOwnKeys)return ownKeys;hasRequiredOwnKeys=1;var J=requireGetBuiltIn(),Y=requireFunctionUncurryThis(),re=requireObjectGetOwnPropertyNames(),ae=requireObjectGetOwnPropertySymbols(),ne=requireAnObject(),ce=Y([].concat);return ownKeys=J("Reflect","ownKeys")||function(R){var U=re.f(ne(R)),K=ae.f;return K?ce(U,K(R)):U},ownKeys}var copyConstructorProperties,hasRequiredCopyConstructorProperties;function requireCopyConstructorProperties(){if(hasRequiredCopyConstructorProperties)return copyConstructorProperties;hasRequiredCopyConstructorProperties=1;var J=requireHasOwnProperty(),Y=requireOwnKeys(),re=requireObjectGetOwnPropertyDescriptor(),ae=requireObjectDefineProperty();return copyConstructorProperties=function(ne,ce,ee){for(var R=Y(ce),U=ae.f,K=re.f,oe=0;oe<R.length;oe++){var pe=R[oe];!J(ne,pe)&&!(ee&&J(ee,pe))&&U(ne,pe,K(ce,pe))}},copyConstructorProperties}var isForced_1,hasRequiredIsForced;function requireIsForced(){if(hasRequiredIsForced)return isForced_1;hasRequiredIsForced=1;var J=requireFails(),Y=requireIsCallable(),re=/#|\.prototype\./,ae=function(U,K){var oe=ce[ne(U)];return oe===R?!0:oe===ee?!1:Y(K)?J(K):!!K},ne=ae.normalize=function(U){return String(U).replace(re,".").toLowerCase()},ce=ae.data={},ee=ae.NATIVE="N",R=ae.POLYFILL="P";return isForced_1=ae,isForced_1}var _export,hasRequired_export;function require_export(){if(hasRequired_export)return _export;hasRequired_export=1;var J=requireGlobalThis(),Y=requireObjectGetOwnPropertyDescriptor().f,re=requireCreateNonEnumerableProperty(),ae=requireDefineBuiltIn(),ne=requireDefineGlobalProperty(),ce=requireCopyConstructorProperties(),ee=requireIsForced();return _export=function(R,U){var K=R.target,oe=R.global,pe=R.stat,_e,me,we,Oe,De,Ae;if(oe?me=J:pe?me=J[K]||ne(K,{}):me=J[K]&&J[K].prototype,me)for(we in U){if(De=U[we],R.dontCallGetSet?(Ae=Y(me,we),Oe=Ae&&Ae.value):Oe=me[we],_e=ee(oe?we:K+(pe?".":"#")+we,R.forced),!_e&&Oe!==void 0){if(typeof De==typeof Oe)continue;ce(De,Oe)}(R.sham||Oe&&Oe.sham)&&re(De,"sham",!0),ae(me,we,De,R)}},_export}var toStringTagSupport,hasRequiredToStringTagSupport;function requireToStringTagSupport(){if(hasRequiredToStringTagSupport)return toStringTagSupport;hasRequiredToStringTagSupport=1;var J=requireWellKnownSymbol(),Y=J("toStringTag"),re={};return re[Y]="z",toStringTagSupport=String(re)==="[object z]",toStringTagSupport}var classof,hasRequiredClassof;function requireClassof(){if(hasRequiredClassof)return classof;hasRequiredClassof=1;var J=requireToStringTagSupport(),Y=requireIsCallable(),re=requireClassofRaw(),ae=requireWellKnownSymbol(),ne=ae("toStringTag"),ce=Object,ee=re((function(){return arguments})())==="Arguments",R=function(U,K){try{return U[K]}catch{}};return classof=J?re:function(U){var K,oe,pe;return U===void 0?"Undefined":U===null?"Null":typeof(oe=R(K=ce(U),ne))=="string"?oe:ee?re(K):(pe=re(K))==="Object"&&Y(K.callee)?"Arguments":pe},classof}var toString,hasRequiredToString$1;function requireToString$1(){if(hasRequiredToString$1)return toString;hasRequiredToString$1=1;var J=requireClassof(),Y=String;return toString=function(re){if(J(re)==="Symbol")throw new TypeError("Cannot convert a Symbol value to a string");return Y(re)},toString}var objectDefineProperties={},objectKeys,hasRequiredObjectKeys;function requireObjectKeys(){if(hasRequiredObjectKeys)return objectKeys;hasRequiredObjectKeys=1;var J=requireObjectKeysInternal(),Y=requireEnumBugKeys();return objectKeys=Object.keys||function(ae){return J(ae,Y)},objectKeys}var hasRequiredObjectDefineProperties;function requireObjectDefineProperties(){if(hasRequiredObjectDefineProperties)return objectDefineProperties;hasRequiredObjectDefineProperties=1;var J=requireDescriptors(),Y=requireV8PrototypeDefineBug(),re=requireObjectDefineProperty(),ae=requireAnObject(),ne=requireToIndexedObject(),ce=requireObjectKeys();return objectDefineProperties.f=J&&!Y?Object.defineProperties:function(R,U){ae(R);for(var K=ne(U),oe=ce(U),pe=oe.length,_e=0,me;pe>_e;)re.f(R,me=oe[_e++],K[me]);return R},objectDefineProperties}var html,hasRequiredHtml;function requireHtml(){if(hasRequiredHtml)return html;hasRequiredHtml=1;var J=requireGetBuiltIn();return html=J("document","documentElement"),html}var objectCreate,hasRequiredObjectCreate;function requireObjectCreate(){if(hasRequiredObjectCreate)return objectCreate;hasRequiredObjectCreate=1;var J=requireAnObject(),Y=requireObjectDefineProperties(),re=requireEnumBugKeys(),ae=requireHiddenKeys(),ne=requireHtml(),ce=requireDocumentCreateElement(),ee=requireSharedKey(),R=">",U="<",K="prototype",oe="script",pe=ee("IE_PROTO"),_e=function(){},me=function(Ce){return U+oe+R+Ce+U+"/"+oe+R},we=function(Ce){Ce.write(me("")),Ce.close();var je=Ce.parentWindow.Object;return Ce=null,je},Oe=function(){var Ce=ce("iframe"),je="java"+oe+":",ke;return Ce.style.display="none",ne.appendChild(Ce),Ce.src=String(je),ke=Ce.contentWindow.document,ke.open(),ke.write(me("document.F=Object")),ke.close(),ke.F},De,Ae=function(){try{De=new ActiveXObject("htmlfile")}catch{}Ae=typeof document<"u"?document.domain&&De?we(De):Oe():we(De);for(var Ce=re.length;Ce--;)delete Ae[K][re[Ce]];return Ae()};return ae[pe]=!0,objectCreate=Object.create||function(je,ke){var Be;return je!==null?(_e[K]=J(je),Be=new _e,_e[K]=null,Be[pe]=je):Be=Ae(),ke===void 0?Be:Y.f(Be,ke)},objectCreate}var objectGetOwnPropertyNamesExternal={},arraySlice,hasRequiredArraySlice;function requireArraySlice(){if(hasRequiredArraySlice)return arraySlice;hasRequiredArraySlice=1;var J=requireFunctionUncurryThis();return arraySlice=J([].slice),arraySlice}var hasRequiredObjectGetOwnPropertyNamesExternal;function requireObjectGetOwnPropertyNamesExternal(){if(hasRequiredObjectGetOwnPropertyNamesExternal)return objectGetOwnPropertyNamesExternal;hasRequiredObjectGetOwnPropertyNamesExternal=1;var J=requireClassofRaw(),Y=requireToIndexedObject(),re=requireObjectGetOwnPropertyNames().f,ae=requireArraySlice(),ne=typeof window=="object"&&window&&Object.getOwnPropertyNames?Object.getOwnPropertyNames(window):[],ce=function(ee){try{return re(ee)}catch{return ae(ne)}};return objectGetOwnPropertyNamesExternal.f=function(R){return ne&&J(R)==="Window"?ce(R):re(Y(R))},objectGetOwnPropertyNamesExternal}var defineBuiltInAccessor,hasRequiredDefineBuiltInAccessor;function requireDefineBuiltInAccessor(){if(hasRequiredDefineBuiltInAccessor)return defineBuiltInAccessor;hasRequiredDefineBuiltInAccessor=1;var J=requireMakeBuiltIn(),Y=requireObjectDefineProperty();return defineBuiltInAccessor=function(re,ae,ne){return ne.get&&J(ne.get,ae,{getter:!0}),ne.set&&J(ne.set,ae,{setter:!0}),Y.f(re,ae,ne)},defineBuiltInAccessor}var wellKnownSymbolWrapped={},hasRequiredWellKnownSymbolWrapped;function requireWellKnownSymbolWrapped(){if(hasRequiredWellKnownSymbolWrapped)return wellKnownSymbolWrapped;hasRequiredWellKnownSymbolWrapped=1;var J=requireWellKnownSymbol();return wellKnownSymbolWrapped.f=J,wellKnownSymbolWrapped}var path,hasRequiredPath;function requirePath(){if(hasRequiredPath)return path;hasRequiredPath=1;var J=requireGlobalThis();return path=J,path}var wellKnownSymbolDefine,hasRequiredWellKnownSymbolDefine;function requireWellKnownSymbolDefine(){if(hasRequiredWellKnownSymbolDefine)return wellKnownSymbolDefine;hasRequiredWellKnownSymbolDefine=1;var J=requirePath(),Y=requireHasOwnProperty(),re=requireWellKnownSymbolWrapped(),ae=requireObjectDefineProperty().f;return wellKnownSymbolDefine=function(ne){var ce=J.Symbol||(J.Symbol={});Y(ce,ne)||ae(ce,ne,{value:re.f(ne)})},wellKnownSymbolDefine}var symbolDefineToPrimitive,hasRequiredSymbolDefineToPrimitive;function requireSymbolDefineToPrimitive(){if(hasRequiredSymbolDefineToPrimitive)return symbolDefineToPrimitive;hasRequiredSymbolDefineToPrimitive=1;var J=requireFunctionCall(),Y=requireGetBuiltIn(),re=requireWellKnownSymbol(),ae=requireDefineBuiltIn();return symbolDefineToPrimitive=function(){var ne=Y("Symbol"),ce=ne&&ne.prototype,ee=ce&&ce.valueOf,R=re("toPrimitive");ce&&!ce[R]&&ae(ce,R,function(U){return J(ee,this)},{arity:1})},symbolDefineToPrimitive}var setToStringTag,hasRequiredSetToStringTag;function requireSetToStringTag(){if(hasRequiredSetToStringTag)return setToStringTag;hasRequiredSetToStringTag=1;var J=requireObjectDefineProperty().f,Y=requireHasOwnProperty(),re=requireWellKnownSymbol(),ae=re("toStringTag");return setToStringTag=function(ne,ce,ee){ne&&!ee&&(ne=ne.prototype),ne&&!Y(ne,ae)&&J(ne,ae,{configurable:!0,value:ce})},setToStringTag}var functionUncurryThisClause,hasRequiredFunctionUncurryThisClause;function requireFunctionUncurryThisClause(){if(hasRequiredFunctionUncurryThisClause)return functionUncurryThisClause;hasRequiredFunctionUncurryThisClause=1;var J=requireClassofRaw(),Y=requireFunctionUncurryThis();return functionUncurryThisClause=function(re){if(J(re)==="Function")return Y(re)},functionUncurryThisClause}var functionBindContext,hasRequiredFunctionBindContext;function requireFunctionBindContext(){if(hasRequiredFunctionBindContext)return functionBindContext;hasRequiredFunctionBindContext=1;var J=requireFunctionUncurryThisClause(),Y=requireACallable(),re=requireFunctionBindNative(),ae=J(J.bind);return functionBindContext=function(ne,ce){return Y(ne),ce===void 0?ne:re?ae(ne,ce):function(){return ne.apply(ce,arguments)}},functionBindContext}var isArray,hasRequiredIsArray$1;function requireIsArray$1(){if(hasRequiredIsArray$1)return isArray;hasRequiredIsArray$1=1;var J=requireClassofRaw();return isArray=Array.isArray||function(re){return J(re)==="Array"},isArray}var isConstructor,hasRequiredIsConstructor;function requireIsConstructor(){if(hasRequiredIsConstructor)return isConstructor;hasRequiredIsConstructor=1;var J=requireFunctionUncurryThis(),Y=requireFails(),re=requireIsCallable(),ae=requireClassof(),ne=requireGetBuiltIn(),ce=requireInspectSource(),ee=function(){},R=ne("Reflect","construct"),U=/^\s*(?:class|function)\b/,K=J(U.exec),oe=!U.test(ee),pe=function(we){if(!re(we))return!1;try{return R(ee,[],we),!0}catch{return!1}},_e=function(we){if(!re(we))return!1;switch(ae(we)){case"AsyncFunction":case"GeneratorFunction":case"AsyncGeneratorFunction":return!1}try{return oe||!!K(U,ce(we))}catch{return!0}};return _e.sham=!0,isConstructor=!R||Y(function(){var me;return pe(pe.call)||!pe(Object)||!pe(function(){me=!0})||me})?_e:pe,isConstructor}var arraySpeciesConstructor,hasRequiredArraySpeciesConstructor;function requireArraySpeciesConstructor(){if(hasRequiredArraySpeciesConstructor)return arraySpeciesConstructor;hasRequiredArraySpeciesConstructor=1;var J=requireIsArray$1(),Y=requireIsConstructor(),re=requireIsObject$1(),ae=requireWellKnownSymbol(),ne=ae("species"),ce=Array;return arraySpeciesConstructor=function(ee){var R;return J(ee)&&(R=ee.constructor,Y(R)&&(R===ce||J(R.prototype))?R=void 0:re(R)&&(R=R[ne],R===null&&(R=void 0))),R===void 0?ce:R},arraySpeciesConstructor}var arraySpeciesCreate,hasRequiredArraySpeciesCreate;function requireArraySpeciesCreate(){if(hasRequiredArraySpeciesCreate)return arraySpeciesCreate;hasRequiredArraySpeciesCreate=1;var J=requireArraySpeciesConstructor();return arraySpeciesCreate=function(Y,re){return new(J(Y))(re===0?0:re)},arraySpeciesCreate}var arrayIteration,hasRequiredArrayIteration;function requireArrayIteration(){if(hasRequiredArrayIteration)return arrayIteration;hasRequiredArrayIteration=1;var J=requireFunctionBindContext(),Y=requireFunctionUncurryThis(),re=requireIndexedObject(),ae=requireToObject(),ne=requireLengthOfArrayLike(),ce=requireArraySpeciesCreate(),ee=Y([].push),R=function(U){var K=U===1,oe=U===2,pe=U===3,_e=U===4,me=U===6,we=U===7,Oe=U===5||me;return function(De,Ae,Ce,je){for(var ke=ae(De),Be=re(ke),We=ne(Be),Je=J(Ae,Ce),Ke=0,et=je||ce,it=K?et(De,We):oe||we?et(De,0):void 0,nt,ct;We>Ke;Ke++)if((Oe||Ke in Be)&&(nt=Be[Ke],ct=Je(nt,Ke,ke),U))if(K)it[Ke]=ct;else if(ct)switch(U){case 3:return!0;case 5:return nt;case 6:return Ke;case 2:ee(it,nt)}else switch(U){case 4:return!1;case 7:ee(it,nt)}return me?-1:pe||_e?_e:it}};return arrayIteration={forEach:R(0),map:R(1),filter:R(2),some:R(3),every:R(4),find:R(5),findIndex:R(6),filterReject:R(7)},arrayIteration}var hasRequiredEs_symbol_constructor;function requireEs_symbol_constructor(){if(hasRequiredEs_symbol_constructor)return es_symbol_constructor;hasRequiredEs_symbol_constructor=1;var J=require_export(),Y=requireGlobalThis(),re=requireFunctionCall(),ae=requireFunctionUncurryThis(),ne=requireIsPure(),ce=requireDescriptors(),ee=requireSymbolConstructorDetection(),R=requireFails(),U=requireHasOwnProperty(),K=requireObjectIsPrototypeOf(),oe=requireAnObject(),pe=requireToIndexedObject(),_e=requireToPropertyKey(),me=requireToString$1(),we=requireCreatePropertyDescriptor(),Oe=requireObjectCreate(),De=requireObjectKeys(),Ae=requireObjectGetOwnPropertyNames(),Ce=requireObjectGetOwnPropertyNamesExternal(),je=requireObjectGetOwnPropertySymbols(),ke=requireObjectGetOwnPropertyDescriptor(),Be=requireObjectDefineProperty(),We=requireObjectDefineProperties(),Je=requireObjectPropertyIsEnumerable(),Ke=requireDefineBuiltIn(),et=requireDefineBuiltInAccessor(),it=requireShared(),nt=requireSharedKey(),ct=requireHiddenKeys(),ft=requireUid(),_t=requireWellKnownSymbol(),Rt=requireWellKnownSymbolWrapped(),Ft=requireWellKnownSymbolDefine(),ht=requireSymbolDefineToPrimitive(),St=requireSetToStringTag(),ut=requireInternalState(),Et=requireArrayIteration().forEach,bt=nt("hidden"),Dt="Symbol",Ut="prototype",er=ut.set,xr=ut.getterFor(Dt),ur=Object[Ut],yr=Y.Symbol,Wt=yr&&yr[Ut],or=Y.RangeError,wr=Y.TypeError,Ir=Y.QObject,br=ke.f,gr=Be.f,Mr=Ce.f,Hr=Je.f,jr=ae([].push),Sr=it("symbols"),Nr=it("op-symbols"),Dr=it("wks"),Lr=!Ir||!Ir[Ut]||!Ir[Ut].findChild,Yt=function(Te,Me,ze){var Qe=br(ur,Me);Qe&&delete ur[Me],gr(Te,Me,ze),Qe&&Te!==ur&&gr(ur,Me,Qe)},Jt=ce&&R(function(){return Oe(gr({},"a",{get:function(){return gr(this,"a",{value:7}).a}})).a!==7})?Yt:gr,qr=function(Te,Me){var ze=Sr[Te]=Oe(Wt);return er(ze,{type:Dt,tag:Te,description:Me}),ce||(ze.description=Me),ze},nr=function(Me,ze,Qe){Me===ur&&nr(Nr,ze,Qe),oe(Me);var tt=_e(ze);return oe(Qe),U(Sr,tt)?(Qe.enumerable?(U(Me,bt)&&Me[bt][tt]&&(Me[bt][tt]=!1),Qe=Oe(Qe,{enumerable:we(0,!1)})):(U(Me,bt)||gr(Me,bt,we(1,Oe(null))),Me[bt][tt]=!0),Jt(Me,tt,Qe)):gr(Me,tt,Qe)},dr=function(Me,ze){oe(Me);var Qe=pe(ze),tt=De(Qe).concat(xe(Qe));return Et(tt,function(He){(!ce||re(Ge,Qe,He))&&nr(Me,He,Qe[He])}),Me},mr=function(Me,ze){return ze===void 0?Oe(Me):dr(Oe(Me),ze)},Ge=function(Me){var ze=_e(Me),Qe=re(Hr,this,ze);return this===ur&&U(Sr,ze)&&!U(Nr,ze)?!1:Qe||!U(this,ze)||!U(Sr,ze)||U(this,bt)&&this[bt][ze]?Qe:!0},Ie=function(Me,ze){var Qe=pe(Me),tt=_e(ze);if(!(Qe===ur&&U(Sr,tt)&&!U(Nr,tt))){var He=br(Qe,tt);return He&&U(Sr,tt)&&!(U(Qe,bt)&&Qe[bt][tt])&&(He.enumerable=!0),He}},Se=function(Me){var ze=Mr(pe(Me)),Qe=[];return Et(ze,function(tt){!U(Sr,tt)&&!U(ct,tt)&&jr(Qe,tt)}),Qe},xe=function(Te){var Me=Te===ur,ze=Mr(Me?Nr:pe(Te)),Qe=[];return Et(ze,function(tt){U(Sr,tt)&&(!Me||U(ur,tt))&&jr(Qe,Sr[tt])}),Qe};return ee||(yr=function(){if(K(Wt,this))throw new wr("Symbol is not a constructor");var Me=!arguments.length||arguments[0]===void 0?void 0:me(arguments[0]),ze=ft(Me),Qe=function(tt){var He=this===void 0?Y:this;He===ur&&re(Qe,Nr,tt),U(He,bt)&&U(He[bt],ze)&&(He[bt][ze]=!1);var Ze=we(1,tt);try{Jt(He,ze,Ze)}catch(st){if(!(st instanceof or))throw st;Yt(He,ze,Ze)}};return ce&&Lr&&Jt(ur,ze,{configurable:!0,set:Qe}),qr(ze,Me)},Wt=yr[Ut],Ke(Wt,"toString",function(){return xr(this).tag}),Ke(yr,"withoutSetter",function(Te){return qr(ft(Te),Te)}),Je.f=Ge,Be.f=nr,We.f=dr,ke.f=Ie,Ae.f=Ce.f=Se,je.f=xe,Rt.f=function(Te){return qr(_t(Te),Te)},ce&&(et(Wt,"description",{configurable:!0,get:function(){return xr(this).description}}),ne||Ke(ur,"propertyIsEnumerable",Ge,{unsafe:!0}))),J({global:!0,constructor:!0,wrap:!0,forced:!ee,sham:!ee},{Symbol:yr}),Et(De(Dr),function(Te){Ft(Te)}),J({target:Dt,stat:!0,forced:!ee},{useSetter:function(){Lr=!0},useSimple:function(){Lr=!1}}),J({target:"Object",stat:!0,forced:!ee,sham:!ce},{create:mr,defineProperty:nr,defineProperties:dr,getOwnPropertyDescriptor:Ie}),J({target:"Object",stat:!0,forced:!ee},{getOwnPropertyNames:Se}),ht(),St(yr,Dt),ct[bt]=!0,es_symbol_constructor}var es_symbol_for={},symbolRegistryDetection,hasRequiredSymbolRegistryDetection;function requireSymbolRegistryDetection(){if(hasRequiredSymbolRegistryDetection)return symbolRegistryDetection;hasRequiredSymbolRegistryDetection=1;var J=requireSymbolConstructorDetection();return symbolRegistryDetection=J&&!!Symbol.for&&!!Symbol.keyFor,symbolRegistryDetection}var hasRequiredEs_symbol_for;function requireEs_symbol_for(){if(hasRequiredEs_symbol_for)return es_symbol_for;hasRequiredEs_symbol_for=1;var J=require_export(),Y=requireGetBuiltIn(),re=requireHasOwnProperty(),ae=requireToString$1(),ne=requireShared(),ce=requireSymbolRegistryDetection(),ee=ne("string-to-symbol-registry"),R=ne("symbol-to-string-registry");return J({target:"Symbol",stat:!0,forced:!ce},{for:function(U){var K=ae(U);if(re(ee,K))return ee[K];var oe=Y("Symbol")(K);return ee[K]=oe,R[oe]=K,oe}}),es_symbol_for}var es_symbol_keyFor={},hasRequiredEs_symbol_keyFor;function requireEs_symbol_keyFor(){if(hasRequiredEs_symbol_keyFor)return es_symbol_keyFor;hasRequiredEs_symbol_keyFor=1;var J=require_export(),Y=requireHasOwnProperty(),re=requireIsSymbol$1(),ae=requireTryToString(),ne=requireShared(),ce=requireSymbolRegistryDetection(),ee=ne("symbol-to-string-registry");return J({target:"Symbol",stat:!0,forced:!ce},{keyFor:function(U){if(!re(U))throw new TypeError(ae(U)+" is not a symbol");if(Y(ee,U))return ee[U]}}),es_symbol_keyFor}var es_json_stringify={},functionApply,hasRequiredFunctionApply;function requireFunctionApply(){if(hasRequiredFunctionApply)return functionApply;hasRequiredFunctionApply=1;var J=requireFunctionBindNative(),Y=Function.prototype,re=Y.apply,ae=Y.call;return functionApply=typeof Reflect=="object"&&Reflect.apply||(J?ae.bind(re):function(){return ae.apply(re,arguments)}),functionApply}var getJsonReplacerFunction,hasRequiredGetJsonReplacerFunction;function requireGetJsonReplacerFunction(){if(hasRequiredGetJsonReplacerFunction)return getJsonReplacerFunction;hasRequiredGetJsonReplacerFunction=1;var J=requireFunctionUncurryThis(),Y=requireIsArray$1(),re=requireIsCallable(),ae=requireClassofRaw(),ne=requireToString$1(),ce=J([].push);return getJsonReplacerFunction=function(ee){if(re(ee))return ee;if(Y(ee)){for(var R=ee.length,U=[],K=0;K<R;K++){var oe=ee[K];typeof oe=="string"?ce(U,oe):(typeof oe=="number"||ae(oe)==="Number"||ae(oe)==="String")&&ce(U,ne(oe))}var pe=U.length,_e=!0;return function(me,we){if(_e)return _e=!1,we;if(Y(this))return we;for(var Oe=0;Oe<pe;Oe++)if(U[Oe]===me)return we}}},getJsonReplacerFunction}var hasRequiredEs_json_stringify;function requireEs_json_stringify(){if(hasRequiredEs_json_stringify)return es_json_stringify;hasRequiredEs_json_stringify=1;var J=require_export(),Y=requireGetBuiltIn(),re=requireFunctionApply(),ae=requireFunctionCall(),ne=requireFunctionUncurryThis(),ce=requireFails(),ee=requireIsCallable(),R=requireIsSymbol$1(),U=requireArraySlice(),K=requireGetJsonReplacerFunction(),oe=requireSymbolConstructorDetection(),pe=String,_e=Y("JSON","stringify"),me=ne(/./.exec),we=ne("".charAt),Oe=ne("".charCodeAt),De=ne("".replace),Ae=ne(1.1.toString),Ce=/[\uD800-\uDFFF]/g,je=/^[\uD800-\uDBFF]$/,ke=/^[\uDC00-\uDFFF]$/,Be=!oe||ce(function(){var et=Y("Symbol")("stringify detection");return _e([et])!=="[null]"||_e({a:et})!=="{}"||_e(Object(et))!=="{}"}),We=ce(function(){return _e("\uDF06\uD834")!=='"\\udf06\\ud834"'||_e("\uDEAD")!=='"\\udead"'}),Je=function(et,it){var nt=U(arguments),ct=K(it);if(!(!ee(ct)&&(et===void 0||R(et))))return nt[1]=function(ft,_t){if(ee(ct)&&(_t=ae(ct,this,pe(ft),_t)),!R(_t))return _t},re(_e,null,nt)},Ke=function(et,it,nt){var ct=we(nt,it-1),ft=we(nt,it+1);return me(je,et)&&!me(ke,ft)||me(ke,et)&&!me(je,ct)?"\\u"+Ae(Oe(et,0),16):et};return _e&&J({target:"JSON",stat:!0,arity:3,forced:Be||We},{stringify:function(it,nt,ct){var ft=U(arguments),_t=re(Be?Je:_e,null,ft);return We&&typeof _t=="string"?De(_t,Ce,Ke):_t}}),es_json_stringify}var es_object_getOwnPropertySymbols={},hasRequiredEs_object_getOwnPropertySymbols;function requireEs_object_getOwnPropertySymbols(){if(hasRequiredEs_object_getOwnPropertySymbols)return es_object_getOwnPropertySymbols;hasRequiredEs_object_getOwnPropertySymbols=1;var J=require_export(),Y=requireSymbolConstructorDetection(),re=requireFails(),ae=requireObjectGetOwnPropertySymbols(),ne=requireToObject(),ce=!Y||re(function(){ae.f(1)});return J({target:"Object",stat:!0,forced:ce},{getOwnPropertySymbols:function(R){var U=ae.f;return U?U(ne(R)):[]}}),es_object_getOwnPropertySymbols}var hasRequiredEs_symbol;function requireEs_symbol(){return hasRequiredEs_symbol||(hasRequiredEs_symbol=1,requireEs_symbol_constructor(),requireEs_symbol_for(),requireEs_symbol_keyFor(),requireEs_json_stringify(),requireEs_object_getOwnPropertySymbols()),es_symbol}var es_symbol_description={},hasRequiredEs_symbol_description;function requireEs_symbol_description(){if(hasRequiredEs_symbol_description)return es_symbol_description;hasRequiredEs_symbol_description=1;var J=require_export(),Y=requireDescriptors(),re=requireGlobalThis(),ae=requireFunctionUncurryThis(),ne=requireHasOwnProperty(),ce=requireIsCallable(),ee=requireObjectIsPrototypeOf(),R=requireToString$1(),U=requireDefineBuiltInAccessor(),K=requireCopyConstructorProperties(),oe=re.Symbol,pe=oe&&oe.prototype;if(Y&&ce(oe)&&(!("description"in pe)||oe().description!==void 0)){var _e={},me=function(){var Be=arguments.length<1||arguments[0]===void 0?void 0:R(arguments[0]),We=ee(pe,this)?new oe(Be):Be===void 0?oe():oe(Be);return Be===""&&(_e[We]=!0),We};K(me,oe),me.prototype=pe,pe.constructor=me;var we=String(oe("description detection"))==="Symbol(description detection)",Oe=ae(pe.valueOf),De=ae(pe.toString),Ae=/^Symbol\((.*)\)[^)]+$/,Ce=ae("".replace),je=ae("".slice);U(pe,"description",{configurable:!0,get:function(){var Be=Oe(this);if(ne(_e,Be))return"";var We=De(Be),Je=we?je(We,7,-1):Ce(We,Ae,"$1");return Je===""?void 0:Je}}),J({global:!0,constructor:!0,forced:!0},{Symbol:me})}return es_symbol_description}var es_symbol_asyncDispose={},hasRequiredEs_symbol_asyncDispose;function requireEs_symbol_asyncDispose(){if(hasRequiredEs_symbol_asyncDispose)return es_symbol_asyncDispose;hasRequiredEs_symbol_asyncDispose=1;var J=requireGlobalThis(),Y=requireWellKnownSymbolDefine(),re=requireObjectDefineProperty().f,ae=requireObjectGetOwnPropertyDescriptor().f,ne=J.Symbol;if(Y("asyncDispose"),ne){var ce=ae(ne,"asyncDispose");ce.enumerable&&ce.configurable&&ce.writable&&re(ne,"asyncDispose",{value:ce.value,enumerable:!1,configurable:!1,writable:!1})}return es_symbol_asyncDispose}var es_symbol_asyncIterator={},hasRequiredEs_symbol_asyncIterator;function requireEs_symbol_asyncIterator(){if(hasRequiredEs_symbol_asyncIterator)return es_symbol_asyncIterator;hasRequiredEs_symbol_asyncIterator=1;var J=requireWellKnownSymbolDefine();return J("asyncIterator"),es_symbol_asyncIterator}var es_symbol_dispose={},hasRequiredEs_symbol_dispose;function requireEs_symbol_dispose(){if(hasRequiredEs_symbol_dispose)return es_symbol_dispose;hasRequiredEs_symbol_dispose=1;var J=requireGlobalThis(),Y=requireWellKnownSymbolDefine(),re=requireObjectDefineProperty().f,ae=requireObjectGetOwnPropertyDescriptor().f,ne=J.Symbol;if(Y("dispose"),ne){var ce=ae(ne,"dispose");ce.enumerable&&ce.configurable&&ce.writable&&re(ne,"dispose",{value:ce.value,enumerable:!1,configurable:!1,writable:!1})}return es_symbol_dispose}var es_symbol_hasInstance={},hasRequiredEs_symbol_hasInstance;function requireEs_symbol_hasInstance(){if(hasRequiredEs_symbol_hasInstance)return es_symbol_hasInstance;hasRequiredEs_symbol_hasInstance=1;var J=requireWellKnownSymbolDefine();return J("hasInstance"),es_symbol_hasInstance}var es_symbol_isConcatSpreadable={},hasRequiredEs_symbol_isConcatSpreadable;function requireEs_symbol_isConcatSpreadable(){if(hasRequiredEs_symbol_isConcatSpreadable)return es_symbol_isConcatSpreadable;hasRequiredEs_symbol_isConcatSpreadable=1;var J=requireWellKnownSymbolDefine();return J("isConcatSpreadable"),es_symbol_isConcatSpreadable}var es_symbol_iterator={},hasRequiredEs_symbol_iterator;function requireEs_symbol_iterator(){if(hasRequiredEs_symbol_iterator)return es_symbol_iterator;hasRequiredEs_symbol_iterator=1;var J=requireWellKnownSymbolDefine();return J("iterator"),es_symbol_iterator}var es_symbol_match={},hasRequiredEs_symbol_match;function requireEs_symbol_match(){if(hasRequiredEs_symbol_match)return es_symbol_match;hasRequiredEs_symbol_match=1;var J=requireWellKnownSymbolDefine();return J("match"),es_symbol_match}var es_symbol_matchAll={},hasRequiredEs_symbol_matchAll;function requireEs_symbol_matchAll(){if(hasRequiredEs_symbol_matchAll)return es_symbol_matchAll;hasRequiredEs_symbol_matchAll=1;var J=requireWellKnownSymbolDefine();return J("matchAll"),es_symbol_matchAll}var es_symbol_replace={},hasRequiredEs_symbol_replace;function requireEs_symbol_replace(){if(hasRequiredEs_symbol_replace)return es_symbol_replace;hasRequiredEs_symbol_replace=1;var J=requireWellKnownSymbolDefine();return J("replace"),es_symbol_replace}var es_symbol_search={},hasRequiredEs_symbol_search;function requireEs_symbol_search(){if(hasRequiredEs_symbol_search)return es_symbol_search;hasRequiredEs_symbol_search=1;var J=requireWellKnownSymbolDefine();return J("search"),es_symbol_search}var es_symbol_species={},hasRequiredEs_symbol_species;function requireEs_symbol_species(){if(hasRequiredEs_symbol_species)return es_symbol_species;hasRequiredEs_symbol_species=1;var J=requireWellKnownSymbolDefine();return J("species"),es_symbol_species}var es_symbol_split={},hasRequiredEs_symbol_split;function requireEs_symbol_split(){if(hasRequiredEs_symbol_split)return es_symbol_split;hasRequiredEs_symbol_split=1;var J=requireWellKnownSymbolDefine();return J("split"),es_symbol_split}var es_symbol_toPrimitive={},hasRequiredEs_symbol_toPrimitive;function requireEs_symbol_toPrimitive(){if(hasRequiredEs_symbol_toPrimitive)return es_symbol_toPrimitive;hasRequiredEs_symbol_toPrimitive=1;var J=requireWellKnownSymbolDefine(),Y=requireSymbolDefineToPrimitive();return J("toPrimitive"),Y(),es_symbol_toPrimitive}var es_symbol_toStringTag={},hasRequiredEs_symbol_toStringTag;function requireEs_symbol_toStringTag(){if(hasRequiredEs_symbol_toStringTag)return es_symbol_toStringTag;hasRequiredEs_symbol_toStringTag=1;var J=requireGetBuiltIn(),Y=requireWellKnownSymbolDefine(),re=requireSetToStringTag();return Y("toStringTag"),re(J("Symbol"),"Symbol"),es_symbol_toStringTag}var es_symbol_unscopables={},hasRequiredEs_symbol_unscopables;function requireEs_symbol_unscopables(){if(hasRequiredEs_symbol_unscopables)return es_symbol_unscopables;hasRequiredEs_symbol_unscopables=1;var J=requireWellKnownSymbolDefine();return J("unscopables"),es_symbol_unscopables}var es_error_cause={},functionUncurryThisAccessor,hasRequiredFunctionUncurryThisAccessor;function requireFunctionUncurryThisAccessor(){if(hasRequiredFunctionUncurryThisAccessor)return functionUncurryThisAccessor;hasRequiredFunctionUncurryThisAccessor=1;var J=requireFunctionUncurryThis(),Y=requireACallable();return functionUncurryThisAccessor=function(re,ae,ne){try{return J(Y(Object.getOwnPropertyDescriptor(re,ae)[ne]))}catch{}},functionUncurryThisAccessor}var isPossiblePrototype,hasRequiredIsPossiblePrototype;function requireIsPossiblePrototype(){if(hasRequiredIsPossiblePrototype)return isPossiblePrototype;hasRequiredIsPossiblePrototype=1;var J=requireIsObject$1();return isPossiblePrototype=function(Y){return J(Y)||Y===null},isPossiblePrototype}var aPossiblePrototype,hasRequiredAPossiblePrototype;function requireAPossiblePrototype(){if(hasRequiredAPossiblePrototype)return aPossiblePrototype;hasRequiredAPossiblePrototype=1;var J=requireIsPossiblePrototype(),Y=String,re=TypeError;return aPossiblePrototype=function(ae){if(J(ae))return ae;throw new re("Can't set "+Y(ae)+" as a prototype")},aPossiblePrototype}var objectSetPrototypeOf,hasRequiredObjectSetPrototypeOf;function requireObjectSetPrototypeOf(){if(hasRequiredObjectSetPrototypeOf)return objectSetPrototypeOf;hasRequiredObjectSetPrototypeOf=1;var J=requireFunctionUncurryThisAccessor(),Y=requireIsObject$1(),re=requireRequireObjectCoercible(),ae=requireAPossiblePrototype();return objectSetPrototypeOf=Object.setPrototypeOf||("__proto__"in{}?(function(){var ne=!1,ce={},ee;try{ee=J(Object.prototype,"__proto__","set"),ee(ce,[]),ne=ce instanceof Array}catch{}return function(U,K){return re(U),ae(K),Y(U)&&(ne?ee(U,K):U.__proto__=K),U}})():void 0),objectSetPrototypeOf}var proxyAccessor,hasRequiredProxyAccessor;function requireProxyAccessor(){if(hasRequiredProxyAccessor)return proxyAccessor;hasRequiredProxyAccessor=1;var J=requireObjectDefineProperty().f;return proxyAccessor=function(Y,re,ae){ae in Y||J(Y,ae,{configurable:!0,get:function(){return re[ae]},set:function(ne){re[ae]=ne}})},proxyAccessor}var inheritIfRequired,hasRequiredInheritIfRequired;function requireInheritIfRequired(){if(hasRequiredInheritIfRequired)return inheritIfRequired;hasRequiredInheritIfRequired=1;var J=requireIsCallable(),Y=requireIsObject$1(),re=requireObjectSetPrototypeOf();return inheritIfRequired=function(ae,ne,ce){var ee,R;return re&&J(ee=ne.constructor)&&ee!==ce&&Y(R=ee.prototype)&&R!==ce.prototype&&re(ae,R),ae},inheritIfRequired}var normalizeStringArgument,hasRequiredNormalizeStringArgument;function requireNormalizeStringArgument(){if(hasRequiredNormalizeStringArgument)return normalizeStringArgument;hasRequiredNormalizeStringArgument=1;var J=requireToString$1();return normalizeStringArgument=function(Y,re){return Y===void 0?arguments.length<2?"":re:J(Y)},normalizeStringArgument}var installErrorCause,hasRequiredInstallErrorCause;function requireInstallErrorCause(){if(hasRequiredInstallErrorCause)return installErrorCause;hasRequiredInstallErrorCause=1;var J=requireIsObject$1(),Y=requireCreateNonEnumerableProperty();return installErrorCause=function(re,ae){J(ae)&&"cause"in ae&&Y(re,"cause",ae.cause)},installErrorCause}var errorStackClear,hasRequiredErrorStackClear;function requireErrorStackClear(){if(hasRequiredErrorStackClear)return errorStackClear;hasRequiredErrorStackClear=1;var J=requireFunctionUncurryThis(),Y=Error,re=J("".replace),ae=(function(ee){return String(new Y(ee).stack)})("zxcasd"),ne=/\n\s*at [^:]*:[^\n]*/,ce=ne.test(ae);return errorStackClear=function(ee,R){if(ce&&typeof ee=="string"&&!Y.prepareStackTrace)for(;R--;)ee=re(ee,ne,"");return ee},errorStackClear}var errorStackInstallable,hasRequiredErrorStackInstallable;function requireErrorStackInstallable(){if(hasRequiredErrorStackInstallable)return errorStackInstallable;hasRequiredErrorStackInstallable=1;var J=requireFails(),Y=requireCreatePropertyDescriptor();return errorStackInstallable=!J(function(){var re=new Error("a");return"stack"in re?(Object.defineProperty(re,"stack",Y(1,7)),re.stack!==7):!0}),errorStackInstallable}var errorStackInstall,hasRequiredErrorStackInstall;function requireErrorStackInstall(){if(hasRequiredErrorStackInstall)return errorStackInstall;hasRequiredErrorStackInstall=1;var J=requireCreateNonEnumerableProperty(),Y=requireErrorStackClear(),re=requireErrorStackInstallable(),ae=Error.captureStackTrace;return errorStackInstall=function(ne,ce,ee,R){re&&(ae?ae(ne,ce):J(ne,"stack",Y(ee,R)))},errorStackInstall}var wrapErrorConstructorWithCause,hasRequiredWrapErrorConstructorWithCause;function requireWrapErrorConstructorWithCause(){if(hasRequiredWrapErrorConstructorWithCause)return wrapErrorConstructorWithCause;hasRequiredWrapErrorConstructorWithCause=1;var J=requireGetBuiltIn(),Y=requireHasOwnProperty(),re=requireCreateNonEnumerableProperty(),ae=requireObjectIsPrototypeOf(),ne=requireObjectSetPrototypeOf(),ce=requireCopyConstructorProperties(),ee=requireProxyAccessor(),R=requireInheritIfRequired(),U=requireNormalizeStringArgument(),K=requireInstallErrorCause(),oe=requireErrorStackInstall(),pe=requireDescriptors(),_e=requireIsPure();return wrapErrorConstructorWithCause=function(me,we,Oe,De){var Ae="stackTraceLimit",Ce=De?2:1,je=me.split("."),ke=je[je.length-1],Be=J.apply(null,je);if(Be){var We=Be.prototype;if(!_e&&Y(We,"cause")&&delete We.cause,!Oe)return Be;var Je=J("Error"),Ke=we(function(et,it){var nt=U(De?it:et,void 0),ct=De?new Be(et):new Be;return nt!==void 0&&re(ct,"message",nt),oe(ct,Ke,ct.stack,2),this&&ae(We,this)&&R(ct,this,Ke),arguments.length>Ce&&K(ct,arguments[Ce]),ct});if(Ke.prototype=We,ke!=="Error"?ne?ne(Ke,Je):ce(Ke,Je,{name:!0}):pe&&Ae in Be&&(ee(Ke,Be,Ae),ee(Ke,Be,"prepareStackTrace")),ce(Ke,Be),!_e)try{We.name!==ke&&re(We,"name",ke),We.constructor=Ke}catch{}return Ke}},wrapErrorConstructorWithCause}var hasRequiredEs_error_cause;function requireEs_error_cause(){if(hasRequiredEs_error_cause)return es_error_cause;hasRequiredEs_error_cause=1;var J=require_export(),Y=requireGlobalThis(),re=requireFunctionApply(),ae=requireWrapErrorConstructorWithCause(),ne="WebAssembly",ce=Y[ne],ee=new Error("e",{cause:7}).cause!==7,R=function(K,oe){var pe={};pe[K]=ae(K,oe,ee),J({global:!0,constructor:!0,arity:1,forced:ee},pe)},U=function(K,oe){if(ce&&ce[K]){var pe={};pe[K]=ae(ne+"."+K,oe,ee),J({target:ne,stat:!0,constructor:!0,arity:1,forced:ee},pe)}};return R("Error",function(K){return function(pe){return re(K,this,arguments)}}),R("EvalError",function(K){return function(pe){return re(K,this,arguments)}}),R("RangeError",function(K){return function(pe){return re(K,this,arguments)}}),R("ReferenceError",function(K){return function(pe){return re(K,this,arguments)}}),R("SyntaxError",function(K){return function(pe){return re(K,this,arguments)}}),R("TypeError",function(K){return function(pe){return re(K,this,arguments)}}),R("URIError",function(K){return function(pe){return re(K,this,arguments)}}),U("CompileError",function(K){return function(pe){return re(K,this,arguments)}}),U("LinkError",function(K){return function(pe){return re(K,this,arguments)}}),U("RuntimeError",function(K){return function(pe){return re(K,this,arguments)}}),es_error_cause}var es_error_isError={},hasRequiredEs_error_isError;function requireEs_error_isError(){if(hasRequiredEs_error_isError)return es_error_isError;hasRequiredEs_error_isError=1;var J=require_export(),Y=requireGetBuiltIn(),re=requireIsObject$1(),ae=requireClassof(),ne=requireFails(),ce="Error",ee="DOMException",R=Object.setPrototypeOf||{}.__proto__,U=Y(ee),K=Error,oe=K.isError,pe=!oe||!R||ne(function(){return U&&!oe(new U(ee))||!oe(new K(ce,{cause:function(){}}))||oe(Y("Object","create")(K.prototype))});return J({target:"Error",stat:!0,sham:!0,forced:pe},{isError:function(me){if(!re(me))return!1;var we=ae(me);return we===ce||we===ee}}),es_error_isError}var es_error_toString={},errorToString,hasRequiredErrorToString;function requireErrorToString(){if(hasRequiredErrorToString)return errorToString;hasRequiredErrorToString=1;var J=requireDescriptors(),Y=requireFails(),re=requireAnObject(),ae=requireNormalizeStringArgument(),ne=Error.prototype.toString,ce=Y(function(){if(J){var ee=Object.create(Object.defineProperty({},"name",{get:function(){return this===ee}}));if(ne.call(ee)!=="true")return!0}return ne.call({message:1,name:2})!=="2: 1"||ne.call({})!=="Error"});return errorToString=ce?function(){var R=re(this),U=ae(R.name,"Error"),K=ae(R.message);return U?K?U+": "+K:U:K}:ne,errorToString}var hasRequiredEs_error_toString;function requireEs_error_toString(){if(hasRequiredEs_error_toString)return es_error_toString;hasRequiredEs_error_toString=1;var J=requireDefineBuiltIn(),Y=requireErrorToString(),re=Error.prototype;return re.toString!==Y&&J(re,"toString",Y),es_error_toString}var es_aggregateError={},es_aggregateError_constructor={},correctPrototypeGetter,hasRequiredCorrectPrototypeGetter;function requireCorrectPrototypeGetter(){if(hasRequiredCorrectPrototypeGetter)return correctPrototypeGetter;hasRequiredCorrectPrototypeGetter=1;var J=requireFails();return correctPrototypeGetter=!J(function(){function Y(){}return Y.prototype.constructor=null,Object.getPrototypeOf(new Y)!==Y.prototype}),correctPrototypeGetter}var objectGetPrototypeOf,hasRequiredObjectGetPrototypeOf;function requireObjectGetPrototypeOf(){if(hasRequiredObjectGetPrototypeOf)return objectGetPrototypeOf;hasRequiredObjectGetPrototypeOf=1;var J=requireHasOwnProperty(),Y=requireIsCallable(),re=requireToObject(),ae=requireSharedKey(),ne=requireCorrectPrototypeGetter(),ce=ae("IE_PROTO"),ee=Object,R=ee.prototype;return objectGetPrototypeOf=ne?ee.getPrototypeOf:function(U){var K=re(U);if(J(K,ce))return K[ce];var oe=K.constructor;return Y(oe)&&K instanceof oe?oe.prototype:K instanceof ee?R:null},objectGetPrototypeOf}var iterators,hasRequiredIterators;function requireIterators(){return hasRequiredIterators||(hasRequiredIterators=1,iterators={}),iterators}var isArrayIteratorMethod,hasRequiredIsArrayIteratorMethod;function requireIsArrayIteratorMethod(){if(hasRequiredIsArrayIteratorMethod)return isArrayIteratorMethod;hasRequiredIsArrayIteratorMethod=1;var J=requireWellKnownSymbol(),Y=requireIterators(),re=J("iterator"),ae=Array.prototype;return isArrayIteratorMethod=function(ne){return ne!==void 0&&(Y.Array===ne||ae[re]===ne)},isArrayIteratorMethod}var getIteratorMethod,hasRequiredGetIteratorMethod;function requireGetIteratorMethod(){if(hasRequiredGetIteratorMethod)return getIteratorMethod;hasRequiredGetIteratorMethod=1;var J=requireClassof(),Y=requireGetMethod(),re=requireIsNullOrUndefined(),ae=requireIterators(),ne=requireWellKnownSymbol(),ce=ne("iterator");return getIteratorMethod=function(ee){if(!re(ee))return Y(ee,ce)||Y(ee,"@@iterator")||ae[J(ee)]},getIteratorMethod}var getIterator,hasRequiredGetIterator;function requireGetIterator(){if(hasRequiredGetIterator)return getIterator;hasRequiredGetIterator=1;var J=requireFunctionCall(),Y=requireACallable(),re=requireAnObject(),ae=requireTryToString(),ne=requireGetIteratorMethod(),ce=TypeError;return getIterator=function(ee,R){var U=arguments.length<2?ne(ee):R;if(Y(U))return re(J(U,ee));throw new ce(ae(ee)+" is not iterable")},getIterator}var iteratorClose,hasRequiredIteratorClose;function requireIteratorClose(){if(hasRequiredIteratorClose)return iteratorClose;hasRequiredIteratorClose=1;var J=requireFunctionCall(),Y=requireAnObject(),re=requireGetMethod();return iteratorClose=function(ae,ne,ce){var ee,R;Y(ae);try{if(ee=re(ae,"return"),!ee){if(ne==="throw")throw ce;return ce}ee=J(ee,ae)}catch(U){R=!0,ee=U}if(ne==="throw")throw ce;if(R)throw ee;return Y(ee),ce},iteratorClose}var iterate,hasRequiredIterate;function requireIterate(){if(hasRequiredIterate)return iterate;hasRequiredIterate=1;var J=requireFunctionBindContext(),Y=requireFunctionCall(),re=requireAnObject(),ae=requireTryToString(),ne=requireIsArrayIteratorMethod(),ce=requireLengthOfArrayLike(),ee=requireObjectIsPrototypeOf(),R=requireGetIterator(),U=requireGetIteratorMethod(),K=requireIteratorClose(),oe=TypeError,pe=function(me,we){this.stopped=me,this.result=we},_e=pe.prototype;return iterate=function(me,we,Oe){var De=Oe&&Oe.that,Ae=!!(Oe&&Oe.AS_ENTRIES),Ce=!!(Oe&&Oe.IS_RECORD),je=!!(Oe&&Oe.IS_ITERATOR),ke=!!(Oe&&Oe.INTERRUPTED),Be=J(we,De),We,Je,Ke,et,it,nt,ct,ft=function(Rt){return We&&K(We,"normal"),new pe(!0,Rt)},_t=function(Rt){return Ae?(re(Rt),ke?Be(Rt[0],Rt[1],ft):Be(Rt[0],Rt[1])):ke?Be(Rt,ft):Be(Rt)};if(Ce)We=me.iterator;else if(je)We=me;else{if(Je=U(me),!Je)throw new oe(ae(me)+" is not iterable");if(ne(Je)){for(Ke=0,et=ce(me);et>Ke;Ke++)if(it=_t(me[Ke]),it&&ee(_e,it))return it;return new pe(!1)}We=R(me,Je)}for(nt=Ce?me.next:We.next;!(ct=Y(nt,We)).done;){try{it=_t(ct.value)}catch(Rt){K(We,"throw",Rt)}if(typeof it=="object"&&it&&ee(_e,it))return it}return new pe(!1)},iterate}var hasRequiredEs_aggregateError_constructor;function requireEs_aggregateError_constructor(){if(hasRequiredEs_aggregateError_constructor)return es_aggregateError_constructor;hasRequiredEs_aggregateError_constructor=1;var J=require_export(),Y=requireObjectIsPrototypeOf(),re=requireObjectGetPrototypeOf(),ae=requireObjectSetPrototypeOf(),ne=requireCopyConstructorProperties(),ce=requireObjectCreate(),ee=requireCreateNonEnumerableProperty(),R=requireCreatePropertyDescriptor(),U=requireInstallErrorCause(),K=requireErrorStackInstall(),oe=requireIterate(),pe=requireNormalizeStringArgument(),_e=requireWellKnownSymbol(),me=_e("toStringTag"),we=Error,Oe=[].push,De=function(je,ke){var Be=Y(Ae,this),We;ae?We=ae(new we,Be?re(this):Ae):(We=Be?this:ce(Ae),ee(We,me,"Error")),ke!==void 0&&ee(We,"message",pe(ke)),K(We,De,We.stack,1),arguments.length>2&&U(We,arguments[2]);var Je=[];return oe(je,Oe,{that:Je}),ee(We,"errors",Je),We};ae?ae(De,we):ne(De,we,{name:!0});var Ae=De.prototype=ce(we.prototype,{constructor:R(1,De),message:R(1,""),name:R(1,"AggregateError")});return J({global:!0,constructor:!0,arity:2},{AggregateError:De}),es_aggregateError_constructor}var hasRequiredEs_aggregateError;function requireEs_aggregateError(){return hasRequiredEs_aggregateError||(hasRequiredEs_aggregateError=1,requireEs_aggregateError_constructor()),es_aggregateError}var es_aggregateError_cause={},hasRequiredEs_aggregateError_cause;function requireEs_aggregateError_cause(){if(hasRequiredEs_aggregateError_cause)return es_aggregateError_cause;hasRequiredEs_aggregateError_cause=1;var J=require_export(),Y=requireGetBuiltIn(),re=requireFunctionApply(),ae=requireFails(),ne=requireWrapErrorConstructorWithCause(),ce="AggregateError",ee=Y(ce),R=!ae(function(){return ee([1]).errors[0]!==1})&&ae(function(){return ee([1],ce,{cause:7}).cause!==7});return J({global:!0,constructor:!0,arity:2,forced:R},{AggregateError:ne(ce,function(U){return function(oe,pe){return re(U,this,arguments)}},R,!0)}),es_aggregateError_cause}var es_suppressedError_constructor={},hasRequiredEs_suppressedError_constructor;function requireEs_suppressedError_constructor(){if(hasRequiredEs_suppressedError_constructor)return es_suppressedError_constructor;hasRequiredEs_suppressedError_constructor=1;var J=require_export(),Y=requireGlobalThis(),re=requireObjectIsPrototypeOf(),ae=requireObjectGetPrototypeOf(),ne=requireObjectSetPrototypeOf(),ce=requireCopyConstructorProperties(),ee=requireObjectCreate(),R=requireCreateNonEnumerableProperty(),U=requireCreatePropertyDescriptor(),K=requireErrorStackInstall(),oe=requireNormalizeStringArgument(),pe=requireWellKnownSymbol(),_e=requireFails(),me=requireIsPure(),we=Y.SuppressedError,Oe=pe("toStringTag"),De=Error,Ae=!!we&&we.length!==3,Ce=!!we&&_e(function(){return new we(1,2,3,{cause:4}).cause===4}),je=Ae||Ce,ke=function(Je,Ke,et){var it=re(Be,this),nt;return ne?nt=je&&(!it||ae(this)===Be)?new we:ne(new De,it?ae(this):Be):(nt=it?this:ee(Be),R(nt,Oe,"Error")),et!==void 0&&R(nt,"message",oe(et)),K(nt,ke,nt.stack,1),R(nt,"error",Je),R(nt,"suppressed",Ke),nt};ne?ne(ke,De):ce(ke,De,{name:!0});var Be=ke.prototype=je?we.prototype:ee(De.prototype,{constructor:U(1,ke),message:U(1,""),name:U(1,"SuppressedError")});return je&&!me&&(Be.constructor=ke),J({global:!0,constructor:!0,arity:3,forced:je},{SuppressedError:ke}),es_suppressedError_constructor}var es_array_at={},addToUnscopables,hasRequiredAddToUnscopables;function requireAddToUnscopables(){if(hasRequiredAddToUnscopables)return addToUnscopables;hasRequiredAddToUnscopables=1;var J=requireWellKnownSymbol(),Y=requireObjectCreate(),re=requireObjectDefineProperty().f,ae=J("unscopables"),ne=Array.prototype;return ne[ae]===void 0&&re(ne,ae,{configurable:!0,value:Y(null)}),addToUnscopables=function(ce){ne[ae][ce]=!0},addToUnscopables}var hasRequiredEs_array_at;function requireEs_array_at(){if(hasRequiredEs_array_at)return es_array_at;hasRequiredEs_array_at=1;var J=require_export(),Y=requireToObject(),re=requireLengthOfArrayLike(),ae=requireToIntegerOrInfinity(),ne=requireAddToUnscopables();return J({target:"Array",proto:!0},{at:function(ee){var R=Y(this),U=re(R),K=ae(ee),oe=K>=0?K:U+K;return oe<0||oe>=U?void 0:R[oe]}}),ne("at"),es_array_at}var es_array_concat={},doesNotExceedSafeInteger,hasRequiredDoesNotExceedSafeInteger;function requireDoesNotExceedSafeInteger(){if(hasRequiredDoesNotExceedSafeInteger)return doesNotExceedSafeInteger;hasRequiredDoesNotExceedSafeInteger=1;var J=TypeError,Y=9007199254740991;return doesNotExceedSafeInteger=function(re){if(re>Y)throw J("Maximum allowed index exceeded");return re},doesNotExceedSafeInteger}var createProperty,hasRequiredCreateProperty;function requireCreateProperty(){if(hasRequiredCreateProperty)return createProperty;hasRequiredCreateProperty=1;var J=requireDescriptors(),Y=requireObjectDefineProperty(),re=requireCreatePropertyDescriptor();return createProperty=function(ae,ne,ce){J?Y.f(ae,ne,re(0,ce)):ae[ne]=ce},createProperty}var arrayMethodHasSpeciesSupport,hasRequiredArrayMethodHasSpeciesSupport;function requireArrayMethodHasSpeciesSupport(){if(hasRequiredArrayMethodHasSpeciesSupport)return arrayMethodHasSpeciesSupport;hasRequiredArrayMethodHasSpeciesSupport=1;var J=requireFails(),Y=requireWellKnownSymbol(),re=requireEnvironmentV8Version(),ae=Y("species");return arrayMethodHasSpeciesSupport=function(ne){return re>=51||!J(function(){var ce=[],ee=ce.constructor={};return ee[ae]=function(){return{foo:1}},ce[ne](Boolean).foo!==1})},arrayMethodHasSpeciesSupport}var hasRequiredEs_array_concat;function requireEs_array_concat(){if(hasRequiredEs_array_concat)return es_array_concat;hasRequiredEs_array_concat=1;var J=require_export(),Y=requireFails(),re=requireIsArray$1(),ae=requireIsObject$1(),ne=requireToObject(),ce=requireLengthOfArrayLike(),ee=requireDoesNotExceedSafeInteger(),R=requireCreateProperty(),U=requireArraySpeciesCreate(),K=requireArrayMethodHasSpeciesSupport(),oe=requireWellKnownSymbol(),pe=requireEnvironmentV8Version(),_e=oe("isConcatSpreadable"),me=pe>=51||!Y(function(){var De=[];return De[_e]=!1,De.concat()[0]!==De}),we=function(De){if(!ae(De))return!1;var Ae=De[_e];return Ae!==void 0?!!Ae:re(De)},Oe=!me||!K("concat");return J({target:"Array",proto:!0,arity:1,forced:Oe},{concat:function(Ae){var Ce=ne(this),je=U(Ce,0),ke=0,Be,We,Je,Ke,et;for(Be=-1,Je=arguments.length;Be<Je;Be++)if(et=Be===-1?Ce:arguments[Be],we(et))for(Ke=ce(et),ee(ke+Ke),We=0;We<Ke;We++,ke++)We in et&&R(je,ke,et[We]);else ee(ke+1),R(je,ke++,et);return je.length=ke,je}}),es_array_concat}var es_array_copyWithin={},deletePropertyOrThrow,hasRequiredDeletePropertyOrThrow;function requireDeletePropertyOrThrow(){if(hasRequiredDeletePropertyOrThrow)return deletePropertyOrThrow;hasRequiredDeletePropertyOrThrow=1;var J=requireTryToString(),Y=TypeError;return deletePropertyOrThrow=function(re,ae){if(!delete re[ae])throw new Y("Cannot delete property "+J(ae)+" of "+J(re))},deletePropertyOrThrow}var arrayCopyWithin,hasRequiredArrayCopyWithin;function requireArrayCopyWithin(){if(hasRequiredArrayCopyWithin)return arrayCopyWithin;hasRequiredArrayCopyWithin=1;var J=requireToObject(),Y=requireToAbsoluteIndex(),re=requireLengthOfArrayLike(),ae=requireDeletePropertyOrThrow(),ne=Math.min;return arrayCopyWithin=[].copyWithin||function(ee,R){var U=J(this),K=re(U),oe=Y(ee,K),pe=Y(R,K),_e=arguments.length>2?arguments[2]:void 0,me=ne((_e===void 0?K:Y(_e,K))-pe,K-oe),we=1;for(pe<oe&&oe<pe+me&&(we=-1,pe+=me-1,oe+=me-1);me-- >0;)pe in U?U[oe]=U[pe]:ae(U,oe),oe+=we,pe+=we;return U},arrayCopyWithin}var hasRequiredEs_array_copyWithin;function requireEs_array_copyWithin(){if(hasRequiredEs_array_copyWithin)return es_array_copyWithin;hasRequiredEs_array_copyWithin=1;var J=require_export(),Y=requireArrayCopyWithin(),re=requireAddToUnscopables();return J({target:"Array",proto:!0},{copyWithin:Y}),re("copyWithin"),es_array_copyWithin}var es_array_every={},arrayMethodIsStrict,hasRequiredArrayMethodIsStrict;function requireArrayMethodIsStrict(){if(hasRequiredArrayMethodIsStrict)return arrayMethodIsStrict;hasRequiredArrayMethodIsStrict=1;var J=requireFails();return arrayMethodIsStrict=function(Y,re){var ae=[][Y];return!!ae&&J(function(){ae.call(null,re||function(){return 1},1)})},arrayMethodIsStrict}var hasRequiredEs_array_every;function requireEs_array_every(){if(hasRequiredEs_array_every)return es_array_every;hasRequiredEs_array_every=1;var J=require_export(),Y=requireArrayIteration().every,re=requireArrayMethodIsStrict(),ae=re("every");return J({target:"Array",proto:!0,forced:!ae},{every:function(ce){return Y(this,ce,arguments.length>1?arguments[1]:void 0)}}),es_array_every}var es_array_fill={},arrayFill,hasRequiredArrayFill;function requireArrayFill(){if(hasRequiredArrayFill)return arrayFill;hasRequiredArrayFill=1;var J=requireToObject(),Y=requireToAbsoluteIndex(),re=requireLengthOfArrayLike();return arrayFill=function(ne){for(var ce=J(this),ee=re(ce),R=arguments.length,U=Y(R>1?arguments[1]:void 0,ee),K=R>2?arguments[2]:void 0,oe=K===void 0?ee:Y(K,ee);oe>U;)ce[U++]=ne;return ce},arrayFill}var hasRequiredEs_array_fill;function requireEs_array_fill(){if(hasRequiredEs_array_fill)return es_array_fill;hasRequiredEs_array_fill=1;var J=require_export(),Y=requireArrayFill(),re=requireAddToUnscopables();return J({target:"Array",proto:!0},{fill:Y}),re("fill"),es_array_fill}var es_array_filter={},hasRequiredEs_array_filter;function requireEs_array_filter(){if(hasRequiredEs_array_filter)return es_array_filter;hasRequiredEs_array_filter=1;var J=require_export(),Y=requireArrayIteration().filter,re=requireArrayMethodHasSpeciesSupport(),ae=re("filter");return J({target:"Array",proto:!0,forced:!ae},{filter:function(ce){return Y(this,ce,arguments.length>1?arguments[1]:void 0)}}),es_array_filter}var es_array_find={},hasRequiredEs_array_find;function requireEs_array_find(){if(hasRequiredEs_array_find)return es_array_find;hasRequiredEs_array_find=1;var J=require_export(),Y=requireArrayIteration().find,re=requireAddToUnscopables(),ae="find",ne=!0;return ae in[]&&Array(1)[ae](function(){ne=!1}),J({target:"Array",proto:!0,forced:ne},{find:function(ee){return Y(this,ee,arguments.length>1?arguments[1]:void 0)}}),re(ae),es_array_find}var es_array_findIndex={},hasRequiredEs_array_findIndex;function requireEs_array_findIndex(){if(hasRequiredEs_array_findIndex)return es_array_findIndex;hasRequiredEs_array_findIndex=1;var J=require_export(),Y=requireArrayIteration().findIndex,re=requireAddToUnscopables(),ae="findIndex",ne=!0;return ae in[]&&Array(1)[ae](function(){ne=!1}),J({target:"Array",proto:!0,forced:ne},{findIndex:function(ee){return Y(this,ee,arguments.length>1?arguments[1]:void 0)}}),re(ae),es_array_findIndex}var es_array_findLast={},arrayIterationFromLast,hasRequiredArrayIterationFromLast;function requireArrayIterationFromLast(){if(hasRequiredArrayIterationFromLast)return arrayIterationFromLast;hasRequiredArrayIterationFromLast=1;var J=requireFunctionBindContext(),Y=requireIndexedObject(),re=requireToObject(),ae=requireLengthOfArrayLike(),ne=function(ce){var ee=ce===1;return function(R,U,K){for(var oe=re(R),pe=Y(oe),_e=ae(pe),me=J(U,K),we,Oe;_e-- >0;)if(we=pe[_e],Oe=me(we,_e,oe),Oe)switch(ce){case 0:return we;case 1:return _e}return ee?-1:void 0}};return arrayIterationFromLast={findLast:ne(0),findLastIndex:ne(1)},arrayIterationFromLast}var hasRequiredEs_array_findLast;function requireEs_array_findLast(){if(hasRequiredEs_array_findLast)return es_array_findLast;hasRequiredEs_array_findLast=1;var J=require_export(),Y=requireArrayIterationFromLast().findLast,re=requireAddToUnscopables();return J({target:"Array",proto:!0},{findLast:function(ne){return Y(this,ne,arguments.length>1?arguments[1]:void 0)}}),re("findLast"),es_array_findLast}var es_array_findLastIndex={},hasRequiredEs_array_findLastIndex;function requireEs_array_findLastIndex(){if(hasRequiredEs_array_findLastIndex)return es_array_findLastIndex;hasRequiredEs_array_findLastIndex=1;var J=require_export(),Y=requireArrayIterationFromLast().findLastIndex,re=requireAddToUnscopables();return J({target:"Array",proto:!0},{findLastIndex:function(ne){return Y(this,ne,arguments.length>1?arguments[1]:void 0)}}),re("findLastIndex"),es_array_findLastIndex}var es_array_flat={},flattenIntoArray_1,hasRequiredFlattenIntoArray;function requireFlattenIntoArray(){if(hasRequiredFlattenIntoArray)return flattenIntoArray_1;hasRequiredFlattenIntoArray=1;var J=requireIsArray$1(),Y=requireLengthOfArrayLike(),re=requireDoesNotExceedSafeInteger(),ae=requireFunctionBindContext(),ne=function(ce,ee,R,U,K,oe,pe,_e){for(var me=K,we=0,Oe=pe?ae(pe,_e):!1,De,Ae;we<U;)we in R&&(De=Oe?Oe(R[we],we,ee):R[we],oe>0&&J(De)?(Ae=Y(De),me=ne(ce,ee,De,Ae,me,oe-1)-1):(re(me+1),ce[me]=De),me++),we++;return me};return flattenIntoArray_1=ne,flattenIntoArray_1}var hasRequiredEs_array_flat;function requireEs_array_flat(){if(hasRequiredEs_array_flat)return es_array_flat;hasRequiredEs_array_flat=1;var J=require_export(),Y=requireFlattenIntoArray(),re=requireToObject(),ae=requireLengthOfArrayLike(),ne=requireToIntegerOrInfinity(),ce=requireArraySpeciesCreate();return J({target:"Array",proto:!0},{flat:function(){var R=arguments.length?arguments[0]:void 0,U=re(this),K=ae(U),oe=ce(U,0);return oe.length=Y(oe,U,U,K,0,R===void 0?1:ne(R)),oe}}),es_array_flat}var es_array_flatMap={},hasRequiredEs_array_flatMap;function requireEs_array_flatMap(){if(hasRequiredEs_array_flatMap)return es_array_flatMap;hasRequiredEs_array_flatMap=1;var J=require_export(),Y=requireFlattenIntoArray(),re=requireACallable(),ae=requireToObject(),ne=requireLengthOfArrayLike(),ce=requireArraySpeciesCreate();return J({target:"Array",proto:!0},{flatMap:function(R){var U=ae(this),K=ne(U),oe;return re(R),oe=ce(U,0),oe.length=Y(oe,U,U,K,0,1,R,arguments.length>1?arguments[1]:void 0),oe}}),es_array_flatMap}var es_array_forEach={},arrayForEach,hasRequiredArrayForEach;function requireArrayForEach(){if(hasRequiredArrayForEach)return arrayForEach;hasRequiredArrayForEach=1;var J=requireArrayIteration().forEach,Y=requireArrayMethodIsStrict(),re=Y("forEach");return arrayForEach=re?[].forEach:function(ne){return J(this,ne,arguments.length>1?arguments[1]:void 0)},arrayForEach}var hasRequiredEs_array_forEach;function requireEs_array_forEach(){if(hasRequiredEs_array_forEach)return es_array_forEach;hasRequiredEs_array_forEach=1;var J=require_export(),Y=requireArrayForEach();return J({target:"Array",proto:!0,forced:[].forEach!==Y},{forEach:Y}),es_array_forEach}var es_array_from={},callWithSafeIterationClosing,hasRequiredCallWithSafeIterationClosing;function requireCallWithSafeIterationClosing(){if(hasRequiredCallWithSafeIterationClosing)return callWithSafeIterationClosing;hasRequiredCallWithSafeIterationClosing=1;var J=requireAnObject(),Y=requireIteratorClose();return callWithSafeIterationClosing=function(re,ae,ne,ce){try{return ce?ae(J(ne)[0],ne[1]):ae(ne)}catch(ee){Y(re,"throw",ee)}},callWithSafeIterationClosing}var arrayFrom,hasRequiredArrayFrom;function requireArrayFrom(){if(hasRequiredArrayFrom)return arrayFrom;hasRequiredArrayFrom=1;var J=requireFunctionBindContext(),Y=requireFunctionCall(),re=requireToObject(),ae=requireCallWithSafeIterationClosing(),ne=requireIsArrayIteratorMethod(),ce=requireIsConstructor(),ee=requireLengthOfArrayLike(),R=requireCreateProperty(),U=requireGetIterator(),K=requireGetIteratorMethod(),oe=Array;return arrayFrom=function(_e){var me=re(_e),we=ce(this),Oe=arguments.length,De=Oe>1?arguments[1]:void 0,Ae=De!==void 0;Ae&&(De=J(De,Oe>2?arguments[2]:void 0));var Ce=K(me),je=0,ke,Be,We,Je,Ke,et;if(Ce&&!(this===oe&&ne(Ce)))for(Be=we?new this:[],Je=U(me,Ce),Ke=Je.next;!(We=Y(Ke,Je)).done;je++)et=Ae?ae(Je,De,[We.value,je],!0):We.value,R(Be,je,et);else for(ke=ee(me),Be=we?new this(ke):oe(ke);ke>je;je++)et=Ae?De(me[je],je):me[je],R(Be,je,et);return Be.length=je,Be},arrayFrom}var checkCorrectnessOfIteration,hasRequiredCheckCorrectnessOfIteration;function requireCheckCorrectnessOfIteration(){if(hasRequiredCheckCorrectnessOfIteration)return checkCorrectnessOfIteration;hasRequiredCheckCorrectnessOfIteration=1;var J=requireWellKnownSymbol(),Y=J("iterator"),re=!1;try{var ae=0,ne={next:function(){return{done:!!ae++}},return:function(){re=!0}};ne[Y]=function(){return this},Array.from(ne,function(){throw 2})}catch{}return checkCorrectnessOfIteration=function(ce,ee){try{if(!ee&&!re)return!1}catch{return!1}var R=!1;try{var U={};U[Y]=function(){return{next:function(){return{done:R=!0}}}},ce(U)}catch{}return R},checkCorrectnessOfIteration}var hasRequiredEs_array_from;function requireEs_array_from(){if(hasRequiredEs_array_from)return es_array_from;hasRequiredEs_array_from=1;var J=require_export(),Y=requireArrayFrom(),re=requireCheckCorrectnessOfIteration(),ae=!re(function(ne){Array.from(ne)});return J({target:"Array",stat:!0,forced:ae},{from:Y}),es_array_from}var es_array_includes={},hasRequiredEs_array_includes;function requireEs_array_includes(){if(hasRequiredEs_array_includes)return es_array_includes;hasRequiredEs_array_includes=1;var J=require_export(),Y=requireArrayIncludes().includes,re=requireFails(),ae=requireAddToUnscopables(),ne=re(function(){return!Array(1).includes()});return J({target:"Array",proto:!0,forced:ne},{includes:function(ee){return Y(this,ee,arguments.length>1?arguments[1]:void 0)}}),ae("includes"),es_array_includes}var es_array_indexOf={},hasRequiredEs_array_indexOf;function requireEs_array_indexOf(){if(hasRequiredEs_array_indexOf)return es_array_indexOf;hasRequiredEs_array_indexOf=1;var J=require_export(),Y=requireFunctionUncurryThisClause(),re=requireArrayIncludes().indexOf,ae=requireArrayMethodIsStrict(),ne=Y([].indexOf),ce=!!ne&&1/ne([1],1,-0)<0,ee=ce||!ae("indexOf");return J({target:"Array",proto:!0,forced:ee},{indexOf:function(U){var K=arguments.length>1?arguments[1]:void 0;return ce?ne(this,U,K)||0:re(this,U,K)}}),es_array_indexOf}var es_array_isArray={},hasRequiredEs_array_isArray;function requireEs_array_isArray(){if(hasRequiredEs_array_isArray)return es_array_isArray;hasRequiredEs_array_isArray=1;var J=require_export(),Y=requireIsArray$1();return J({target:"Array",stat:!0},{isArray:Y}),es_array_isArray}var iteratorsCore,hasRequiredIteratorsCore;function requireIteratorsCore(){if(hasRequiredIteratorsCore)return iteratorsCore;hasRequiredIteratorsCore=1;var J=requireFails(),Y=requireIsCallable(),re=requireIsObject$1(),ae=requireObjectCreate(),ne=requireObjectGetPrototypeOf(),ce=requireDefineBuiltIn(),ee=requireWellKnownSymbol(),R=requireIsPure(),U=ee("iterator"),K=!1,oe,pe,_e;[].keys&&(_e=[].keys(),"next"in _e?(pe=ne(ne(_e)),pe!==Object.prototype&&(oe=pe)):K=!0);var me=!re(oe)||J(function(){var we={};return oe[U].call(we)!==we});return me?oe={}:R&&(oe=ae(oe)),Y(oe[U])||ce(oe,U,function(){return this}),iteratorsCore={IteratorPrototype:oe,BUGGY_SAFARI_ITERATORS:K},iteratorsCore}var iteratorCreateConstructor,hasRequiredIteratorCreateConstructor;function requireIteratorCreateConstructor(){if(hasRequiredIteratorCreateConstructor)return iteratorCreateConstructor;hasRequiredIteratorCreateConstructor=1;var J=requireIteratorsCore().IteratorPrototype,Y=requireObjectCreate(),re=requireCreatePropertyDescriptor(),ae=requireSetToStringTag(),ne=requireIterators(),ce=function(){return this};return iteratorCreateConstructor=function(ee,R,U,K){var oe=R+" Iterator";return ee.prototype=Y(J,{next:re(+!K,U)}),ae(ee,oe,!1,!0),ne[oe]=ce,ee},iteratorCreateConstructor}var iteratorDefine,hasRequiredIteratorDefine;function requireIteratorDefine(){if(hasRequiredIteratorDefine)return iteratorDefine;hasRequiredIteratorDefine=1;var J=require_export(),Y=requireFunctionCall(),re=requireIsPure(),ae=requireFunctionName(),ne=requireIsCallable(),ce=requireIteratorCreateConstructor(),ee=requireObjectGetPrototypeOf(),R=requireObjectSetPrototypeOf(),U=requireSetToStringTag(),K=requireCreateNonEnumerableProperty(),oe=requireDefineBuiltIn(),pe=requireWellKnownSymbol(),_e=requireIterators(),me=requireIteratorsCore(),we=ae.PROPER,Oe=ae.CONFIGURABLE,De=me.IteratorPrototype,Ae=me.BUGGY_SAFARI_ITERATORS,Ce=pe("iterator"),je="keys",ke="values",Be="entries",We=function(){return this};return iteratorDefine=function(Je,Ke,et,it,nt,ct,ft){ce(et,Ke,it);var _t=function(er){if(er===nt&&ut)return ut;if(!Ae&&er&&er in ht)return ht[er];switch(er){case je:return function(){return new et(this,er)};case ke:return function(){return new et(this,er)};case Be:return function(){return new et(this,er)}}return function(){return new et(this)}},Rt=Ke+" Iterator",Ft=!1,ht=Je.prototype,St=ht[Ce]||ht["@@iterator"]||nt&&ht[nt],ut=!Ae&&St||_t(nt),Et=Ke==="Array"&&ht.entries||St,bt,Dt,Ut;if(Et&&(bt=ee(Et.call(new Je)),bt!==Object.prototype&&bt.next&&(!re&&ee(bt)!==De&&(R?R(bt,De):ne(bt[Ce])||oe(bt,Ce,We)),U(bt,Rt,!0,!0),re&&(_e[Rt]=We))),we&&nt===ke&&St&&St.name!==ke&&(!re&&Oe?K(ht,"name",ke):(Ft=!0,ut=function(){return Y(St,this)})),nt)if(Dt={values:_t(ke),keys:ct?ut:_t(je),entries:_t(Be)},ft)for(Ut in Dt)(Ae||Ft||!(Ut in ht))&&oe(ht,Ut,Dt[Ut]);else J({target:Ke,proto:!0,forced:Ae||Ft},Dt);return(!re||ft)&&ht[Ce]!==ut&&oe(ht,Ce,ut,{name:nt}),_e[Ke]=ut,Dt},iteratorDefine}var createIterResultObject,hasRequiredCreateIterResultObject;function requireCreateIterResultObject(){return hasRequiredCreateIterResultObject||(hasRequiredCreateIterResultObject=1,createIterResultObject=function(J,Y){return{value:J,done:Y}}),createIterResultObject}var es_array_iterator,hasRequiredEs_array_iterator;function requireEs_array_iterator(){if(hasRequiredEs_array_iterator)return es_array_iterator;hasRequiredEs_array_iterator=1;var J=requireToIndexedObject(),Y=requireAddToUnscopables(),re=requireIterators(),ae=requireInternalState(),ne=requireObjectDefineProperty().f,ce=requireIteratorDefine(),ee=requireCreateIterResultObject(),R=requireIsPure(),U=requireDescriptors(),K="Array Iterator",oe=ae.set,pe=ae.getterFor(K);es_array_iterator=ce(Array,"Array",function(me,we){oe(this,{type:K,target:J(me),index:0,kind:we})},function(){var me=pe(this),we=me.target,Oe=me.index++;if(!we||Oe>=we.length)return me.target=null,ee(void 0,!0);switch(me.kind){case"keys":return ee(Oe,!1);case"values":return ee(we[Oe],!1)}return ee([Oe,we[Oe]],!1)},"values");var _e=re.Arguments=re.Array;if(Y("keys"),Y("values"),Y("entries"),!R&&U&&_e.name!=="values")try{ne(_e,"name",{value:"values"})}catch{}return es_array_iterator}var es_array_join={},hasRequiredEs_array_join;function requireEs_array_join(){if(hasRequiredEs_array_join)return es_array_join;hasRequiredEs_array_join=1;var J=require_export(),Y=requireFunctionUncurryThis(),re=requireIndexedObject(),ae=requireToIndexedObject(),ne=requireArrayMethodIsStrict(),ce=Y([].join),ee=re!==Object,R=ee||!ne("join",",");return J({target:"Array",proto:!0,forced:R},{join:function(K){return ce(ae(this),K===void 0?",":K)}}),es_array_join}var es_array_lastIndexOf={},arrayLastIndexOf,hasRequiredArrayLastIndexOf;function requireArrayLastIndexOf(){if(hasRequiredArrayLastIndexOf)return arrayLastIndexOf;hasRequiredArrayLastIndexOf=1;var J=requireFunctionApply(),Y=requireToIndexedObject(),re=requireToIntegerOrInfinity(),ae=requireLengthOfArrayLike(),ne=requireArrayMethodIsStrict(),ce=Math.min,ee=[].lastIndexOf,R=!!ee&&1/[1].lastIndexOf(1,-0)<0,U=ne("lastIndexOf"),K=R||!U;return arrayLastIndexOf=K?function(pe){if(R)return J(ee,this,arguments)||0;var _e=Y(this),me=ae(_e);if(me===0)return-1;var we=me-1;for(arguments.length>1&&(we=ce(we,re(arguments[1]))),we<0&&(we=me+we);we>=0;we--)if(we in _e&&_e[we]===pe)return we||0;return-1}:ee,arrayLastIndexOf}var hasRequiredEs_array_lastIndexOf;function requireEs_array_lastIndexOf(){if(hasRequiredEs_array_lastIndexOf)return es_array_lastIndexOf;hasRequiredEs_array_lastIndexOf=1;var J=require_export(),Y=requireArrayLastIndexOf();return J({target:"Array",proto:!0,forced:Y!==[].lastIndexOf},{lastIndexOf:Y}),es_array_lastIndexOf}var es_array_map={},hasRequiredEs_array_map;function requireEs_array_map(){if(hasRequiredEs_array_map)return es_array_map;hasRequiredEs_array_map=1;var J=require_export(),Y=requireArrayIteration().map,re=requireArrayMethodHasSpeciesSupport(),ae=re("map");return J({target:"Array",proto:!0,forced:!ae},{map:function(ce){return Y(this,ce,arguments.length>1?arguments[1]:void 0)}}),es_array_map}var es_array_of={},hasRequiredEs_array_of;function requireEs_array_of(){if(hasRequiredEs_array_of)return es_array_of;hasRequiredEs_array_of=1;var J=require_export(),Y=requireFails(),re=requireIsConstructor(),ae=requireCreateProperty(),ne=Array,ce=Y(function(){function ee(){}return!(ne.of.call(ee)instanceof ee)});return J({target:"Array",stat:!0,forced:ce},{of:function(){for(var R=0,U=arguments.length,K=new(re(this)?this:ne)(U);U>R;)ae(K,R,arguments[R++]);return K.length=U,K}}),es_array_of}var es_array_push={},arraySetLength,hasRequiredArraySetLength;function requireArraySetLength(){if(hasRequiredArraySetLength)return arraySetLength;hasRequiredArraySetLength=1;var J=requireDescriptors(),Y=requireIsArray$1(),re=TypeError,ae=Object.getOwnPropertyDescriptor,ne=J&&!(function(){if(this!==void 0)return!0;try{Object.defineProperty([],"length",{writable:!1}).length=1}catch(ce){return ce instanceof TypeError}})();return arraySetLength=ne?function(ce,ee){if(Y(ce)&&!ae(ce,"length").writable)throw new re("Cannot set read only .length");return ce.length=ee}:function(ce,ee){return ce.length=ee},arraySetLength}var hasRequiredEs_array_push;function requireEs_array_push(){if(hasRequiredEs_array_push)return es_array_push;hasRequiredEs_array_push=1;var J=require_export(),Y=requireToObject(),re=requireLengthOfArrayLike(),ae=requireArraySetLength(),ne=requireDoesNotExceedSafeInteger(),ce=requireFails(),ee=ce(function(){return[].push.call({length:4294967296},1)!==4294967297}),R=function(){try{Object.defineProperty([],"length",{writable:!1}).push()}catch(K){return K instanceof TypeError}},U=ee||!R();return J({target:"Array",proto:!0,arity:1,forced:U},{push:function(oe){var pe=Y(this),_e=re(pe),me=arguments.length;ne(_e+me);for(var we=0;we<me;we++)pe[_e]=arguments[we],_e++;return ae(pe,_e),_e}}),es_array_push}var es_array_reduce={},arrayReduce,hasRequiredArrayReduce;function requireArrayReduce(){if(hasRequiredArrayReduce)return arrayReduce;hasRequiredArrayReduce=1;var J=requireACallable(),Y=requireToObject(),re=requireIndexedObject(),ae=requireLengthOfArrayLike(),ne=TypeError,ce="Reduce of empty array with no initial value",ee=function(R){return function(U,K,oe,pe){var _e=Y(U),me=re(_e),we=ae(_e);if(J(K),we===0&&oe<2)throw new ne(ce);var Oe=R?we-1:0,De=R?-1:1;if(oe<2)for(;;){if(Oe in me){pe=me[Oe],Oe+=De;break}if(Oe+=De,R?Oe<0:we<=Oe)throw new ne(ce)}for(;R?Oe>=0:we>Oe;Oe+=De)Oe in me&&(pe=K(pe,me[Oe],Oe,_e));return pe}};return arrayReduce={left:ee(!1),right:ee(!0)},arrayReduce}var environment,hasRequiredEnvironment;function requireEnvironment(){if(hasRequiredEnvironment)return environment;hasRequiredEnvironment=1;var J=requireGlobalThis(),Y=requireEnvironmentUserAgent(),re=requireClassofRaw(),ae=function(ne){return Y.slice(0,ne.length)===ne};return environment=(function(){return ae("Bun/")?"BUN":ae("Cloudflare-Workers")?"CLOUDFLARE":ae("Deno/")?"DENO":ae("Node.js/")?"NODE":J.Bun&&typeof Bun.version=="string"?"BUN":J.Deno&&typeof Deno.version=="object"?"DENO":re(J.process)==="process"?"NODE":J.window&&J.document?"BROWSER":"REST"})(),environment}var environmentIsNode,hasRequiredEnvironmentIsNode;function requireEnvironmentIsNode(){if(hasRequiredEnvironmentIsNode)return environmentIsNode;hasRequiredEnvironmentIsNode=1;var J=requireEnvironment();return environmentIsNode=J==="NODE",environmentIsNode}var hasRequiredEs_array_reduce;function requireEs_array_reduce(){if(hasRequiredEs_array_reduce)return es_array_reduce;hasRequiredEs_array_reduce=1;var J=require_export(),Y=requireArrayReduce().left,re=requireArrayMethodIsStrict(),ae=requireEnvironmentV8Version(),ne=requireEnvironmentIsNode(),ce=!ne&&ae>79&&ae<83,ee=ce||!re("reduce");return J({target:"Array",proto:!0,forced:ee},{reduce:function(U){var K=arguments.length;return Y(this,U,K,K>1?arguments[1]:void 0)}}),es_array_reduce}var es_array_reduceRight={},hasRequiredEs_array_reduceRight;function requireEs_array_reduceRight(){if(hasRequiredEs_array_reduceRight)return es_array_reduceRight;hasRequiredEs_array_reduceRight=1;var J=require_export(),Y=requireArrayReduce().right,re=requireArrayMethodIsStrict(),ae=requireEnvironmentV8Version(),ne=requireEnvironmentIsNode(),ce=!ne&&ae>79&&ae<83,ee=ce||!re("reduceRight");return J({target:"Array",proto:!0,forced:ee},{reduceRight:function(U){return Y(this,U,arguments.length,arguments.length>1?arguments[1]:void 0)}}),es_array_reduceRight}var es_array_reverse={},hasRequiredEs_array_reverse;function requireEs_array_reverse(){if(hasRequiredEs_array_reverse)return es_array_reverse;hasRequiredEs_array_reverse=1;var J=require_export(),Y=requireFunctionUncurryThis(),re=requireIsArray$1(),ae=Y([].reverse),ne=[1,2];return J({target:"Array",proto:!0,forced:String(ne)===String(ne.reverse())},{reverse:function(){return re(this)&&(this.length=this.length),ae(this)}}),es_array_reverse}var es_array_slice={},hasRequiredEs_array_slice;function requireEs_array_slice(){if(hasRequiredEs_array_slice)return es_array_slice;hasRequiredEs_array_slice=1;var J=require_export(),Y=requireIsArray$1(),re=requireIsConstructor(),ae=requireIsObject$1(),ne=requireToAbsoluteIndex(),ce=requireLengthOfArrayLike(),ee=requireToIndexedObject(),R=requireCreateProperty(),U=requireWellKnownSymbol(),K=requireArrayMethodHasSpeciesSupport(),oe=requireArraySlice(),pe=K("slice"),_e=U("species"),me=Array,we=Math.max;return J({target:"Array",proto:!0,forced:!pe},{slice:function(De,Ae){var Ce=ee(this),je=ce(Ce),ke=ne(De,je),Be=ne(Ae===void 0?je:Ae,je),We,Je,Ke;if(Y(Ce)&&(We=Ce.constructor,re(We)&&(We===me||Y(We.prototype))?We=void 0:ae(We)&&(We=We[_e],We===null&&(We=void 0)),We===me||We===void 0))return oe(Ce,ke,Be);for(Je=new(We===void 0?me:We)(we(Be-ke,0)),Ke=0;ke<Be;ke++,Ke++)ke in Ce&&R(Je,Ke,Ce[ke]);return Je.length=Ke,Je}}),es_array_slice}var es_array_some={},hasRequiredEs_array_some;function requireEs_array_some(){if(hasRequiredEs_array_some)return es_array_some;hasRequiredEs_array_some=1;var J=require_export(),Y=requireArrayIteration().some,re=requireArrayMethodIsStrict(),ae=re("some");return J({target:"Array",proto:!0,forced:!ae},{some:function(ce){return Y(this,ce,arguments.length>1?arguments[1]:void 0)}}),es_array_some}var es_array_sort={},arraySort,hasRequiredArraySort;function requireArraySort(){if(hasRequiredArraySort)return arraySort;hasRequiredArraySort=1;var J=requireArraySlice(),Y=Math.floor,re=function(ae,ne){var ce=ae.length;if(ce<8)for(var ee=1,R,U;ee<ce;){for(U=ee,R=ae[ee];U&&ne(ae[U-1],R)>0;)ae[U]=ae[--U];U!==ee++&&(ae[U]=R)}else for(var K=Y(ce/2),oe=re(J(ae,0,K),ne),pe=re(J(ae,K),ne),_e=oe.length,me=pe.length,we=0,Oe=0;we<_e||Oe<me;)ae[we+Oe]=we<_e&&Oe<me?ne(oe[we],pe[Oe])<=0?oe[we++]:pe[Oe++]:we<_e?oe[we++]:pe[Oe++];return ae};return arraySort=re,arraySort}var environmentFfVersion,hasRequiredEnvironmentFfVersion;function requireEnvironmentFfVersion(){if(hasRequiredEnvironmentFfVersion)return environmentFfVersion;hasRequiredEnvironmentFfVersion=1;var J=requireEnvironmentUserAgent(),Y=J.match(/firefox\/(\d+)/i);return environmentFfVersion=!!Y&&+Y[1],environmentFfVersion}var environmentIsIeOrEdge,hasRequiredEnvironmentIsIeOrEdge;function requireEnvironmentIsIeOrEdge(){if(hasRequiredEnvironmentIsIeOrEdge)return environmentIsIeOrEdge;hasRequiredEnvironmentIsIeOrEdge=1;var J=requireEnvironmentUserAgent();return environmentIsIeOrEdge=/MSIE|Trident/.test(J),environmentIsIeOrEdge}var environmentWebkitVersion,hasRequiredEnvironmentWebkitVersion;function requireEnvironmentWebkitVersion(){if(hasRequiredEnvironmentWebkitVersion)return environmentWebkitVersion;hasRequiredEnvironmentWebkitVersion=1;var J=requireEnvironmentUserAgent(),Y=J.match(/AppleWebKit\/(\d+)\./);return environmentWebkitVersion=!!Y&&+Y[1],environmentWebkitVersion}var hasRequiredEs_array_sort;function requireEs_array_sort(){if(hasRequiredEs_array_sort)return es_array_sort;hasRequiredEs_array_sort=1;var J=require_export(),Y=requireFunctionUncurryThis(),re=requireACallable(),ae=requireToObject(),ne=requireLengthOfArrayLike(),ce=requireDeletePropertyOrThrow(),ee=requireToString$1(),R=requireFails(),U=requireArraySort(),K=requireArrayMethodIsStrict(),oe=requireEnvironmentFfVersion(),pe=requireEnvironmentIsIeOrEdge(),_e=requireEnvironmentV8Version(),me=requireEnvironmentWebkitVersion(),we=[],Oe=Y(we.sort),De=Y(we.push),Ae=R(function(){we.sort(void 0)}),Ce=R(function(){we.sort(null)}),je=K("sort"),ke=!R(function(){if(_e)return _e<70;if(!(oe&&oe>3)){if(pe)return!0;if(me)return me<603;var Je="",Ke,et,it,nt;for(Ke=65;Ke<76;Ke++){switch(et=String.fromCharCode(Ke),Ke){case 66:case 69:case 70:case 72:it=3;break;case 68:case 71:it=4;break;default:it=2}for(nt=0;nt<47;nt++)we.push({k:et+nt,v:it})}for(we.sort(function(ct,ft){return ft.v-ct.v}),nt=0;nt<we.length;nt++)et=we[nt].k.charAt(0),Je.charAt(Je.length-1)!==et&&(Je+=et);return Je!=="DGBEFHACIJK"}}),Be=Ae||!Ce||!je||!ke,We=function(Je){return function(Ke,et){return et===void 0?-1:Ke===void 0?1:Je!==void 0?+Je(Ke,et)||0:ee(Ke)>ee(et)?1:-1}};return J({target:"Array",proto:!0,forced:Be},{sort:function(Ke){Ke!==void 0&&re(Ke);var et=ae(this);if(ke)return Ke===void 0?Oe(et):Oe(et,Ke);var it=[],nt=ne(et),ct,ft;for(ft=0;ft<nt;ft++)ft in et&&De(it,et[ft]);for(U(it,We(Ke)),ct=ne(it),ft=0;ft<ct;)et[ft]=it[ft++];for(;ft<nt;)ce(et,ft++);return et}}),es_array_sort}var es_array_species={},setSpecies,hasRequiredSetSpecies;function requireSetSpecies(){if(hasRequiredSetSpecies)return setSpecies;hasRequiredSetSpecies=1;var J=requireGetBuiltIn(),Y=requireDefineBuiltInAccessor(),re=requireWellKnownSymbol(),ae=requireDescriptors(),ne=re("species");return setSpecies=function(ce){var ee=J(ce);ae&&ee&&!ee[ne]&&Y(ee,ne,{configurable:!0,get:function(){return this}})},setSpecies}var hasRequiredEs_array_species;function requireEs_array_species(){if(hasRequiredEs_array_species)return es_array_species;hasRequiredEs_array_species=1;var J=requireSetSpecies();return J("Array"),es_array_species}var es_array_splice={},hasRequiredEs_array_splice;function requireEs_array_splice(){if(hasRequiredEs_array_splice)return es_array_splice;hasRequiredEs_array_splice=1;var J=require_export(),Y=requireToObject(),re=requireToAbsoluteIndex(),ae=requireToIntegerOrInfinity(),ne=requireLengthOfArrayLike(),ce=requireArraySetLength(),ee=requireDoesNotExceedSafeInteger(),R=requireArraySpeciesCreate(),U=requireCreateProperty(),K=requireDeletePropertyOrThrow(),oe=requireArrayMethodHasSpeciesSupport(),pe=oe("splice"),_e=Math.max,me=Math.min;return J({target:"Array",proto:!0,forced:!pe},{splice:function(Oe,De){var Ae=Y(this),Ce=ne(Ae),je=re(Oe,Ce),ke=arguments.length,Be,We,Je,Ke,et,it;for(ke===0?Be=We=0:ke===1?(Be=0,We=Ce-je):(Be=ke-2,We=me(_e(ae(De),0),Ce-je)),ee(Ce+Be-We),Je=R(Ae,We),Ke=0;Ke<We;Ke++)et=je+Ke,et in Ae&&U(Je,Ke,Ae[et]);if(Je.length=We,Be<We){for(Ke=je;Ke<Ce-We;Ke++)et=Ke+We,it=Ke+Be,et in Ae?Ae[it]=Ae[et]:K(Ae,it);for(Ke=Ce;Ke>Ce-We+Be;Ke--)K(Ae,Ke-1)}else if(Be>We)for(Ke=Ce-We;Ke>je;Ke--)et=Ke+We-1,it=Ke+Be-1,et in Ae?Ae[it]=Ae[et]:K(Ae,it);for(Ke=0;Ke<Be;Ke++)Ae[Ke+je]=arguments[Ke+2];return ce(Ae,Ce-We+Be),Je}}),es_array_splice}var es_array_toReversed={},arrayToReversed,hasRequiredArrayToReversed;function requireArrayToReversed(){if(hasRequiredArrayToReversed)return arrayToReversed;hasRequiredArrayToReversed=1;var J=requireLengthOfArrayLike();return arrayToReversed=function(Y,re){for(var ae=J(Y),ne=new re(ae),ce=0;ce<ae;ce++)ne[ce]=Y[ae-ce-1];return ne},arrayToReversed}var hasRequiredEs_array_toReversed;function requireEs_array_toReversed(){if(hasRequiredEs_array_toReversed)return es_array_toReversed;hasRequiredEs_array_toReversed=1;var J=require_export(),Y=requireArrayToReversed(),re=requireToIndexedObject(),ae=requireAddToUnscopables(),ne=Array;return J({target:"Array",proto:!0},{toReversed:function(){return Y(re(this),ne)}}),ae("toReversed"),es_array_toReversed}var es_array_toSorted={},arrayFromConstructorAndList,hasRequiredArrayFromConstructorAndList;function requireArrayFromConstructorAndList(){if(hasRequiredArrayFromConstructorAndList)return arrayFromConstructorAndList;hasRequiredArrayFromConstructorAndList=1;var J=requireLengthOfArrayLike();return arrayFromConstructorAndList=function(Y,re,ae){for(var ne=0,ce=arguments.length>2?ae:J(re),ee=new Y(ce);ce>ne;)ee[ne]=re[ne++];return ee},arrayFromConstructorAndList}var getBuiltInPrototypeMethod,hasRequiredGetBuiltInPrototypeMethod;function requireGetBuiltInPrototypeMethod(){if(hasRequiredGetBuiltInPrototypeMethod)return getBuiltInPrototypeMethod;hasRequiredGetBuiltInPrototypeMethod=1;var J=requireGlobalThis();return getBuiltInPrototypeMethod=function(Y,re){var ae=J[Y],ne=ae&&ae.prototype;return ne&&ne[re]},getBuiltInPrototypeMethod}var hasRequiredEs_array_toSorted;function requireEs_array_toSorted(){if(hasRequiredEs_array_toSorted)return es_array_toSorted;hasRequiredEs_array_toSorted=1;var J=require_export(),Y=requireFunctionUncurryThis(),re=requireACallable(),ae=requireToIndexedObject(),ne=requireArrayFromConstructorAndList(),ce=requireGetBuiltInPrototypeMethod(),ee=requireAddToUnscopables(),R=Array,U=Y(ce("Array","sort"));return J({target:"Array",proto:!0},{toSorted:function(oe){oe!==void 0&&re(oe);var pe=ae(this),_e=ne(R,pe);return U(_e,oe)}}),ee("toSorted"),es_array_toSorted}var es_array_toSpliced={},hasRequiredEs_array_toSpliced;function requireEs_array_toSpliced(){if(hasRequiredEs_array_toSpliced)return es_array_toSpliced;hasRequiredEs_array_toSpliced=1;var J=require_export(),Y=requireAddToUnscopables(),re=requireDoesNotExceedSafeInteger(),ae=requireLengthOfArrayLike(),ne=requireToAbsoluteIndex(),ce=requireToIndexedObject(),ee=requireToIntegerOrInfinity(),R=Array,U=Math.max,K=Math.min;return J({target:"Array",proto:!0},{toSpliced:function(pe,_e){var me=ce(this),we=ae(me),Oe=ne(pe,we),De=arguments.length,Ae=0,Ce,je,ke,Be;for(De===0?Ce=je=0:De===1?(Ce=0,je=we-Oe):(Ce=De-2,je=K(U(ee(_e),0),we-Oe)),ke=re(we+Ce-je),Be=R(ke);Ae<Oe;Ae++)Be[Ae]=me[Ae];for(;Ae<Oe+Ce;Ae++)Be[Ae]=arguments[Ae-Oe+2];for(;Ae<ke;Ae++)Be[Ae]=me[Ae+je-Ce];return Be}}),Y("toSpliced"),es_array_toSpliced}var es_array_unscopables_flat={},hasRequiredEs_array_unscopables_flat;function requireEs_array_unscopables_flat(){if(hasRequiredEs_array_unscopables_flat)return es_array_unscopables_flat;hasRequiredEs_array_unscopables_flat=1;var J=requireAddToUnscopables();return J("flat"),es_array_unscopables_flat}var es_array_unscopables_flatMap={},hasRequiredEs_array_unscopables_flatMap;function requireEs_array_unscopables_flatMap(){if(hasRequiredEs_array_unscopables_flatMap)return es_array_unscopables_flatMap;hasRequiredEs_array_unscopables_flatMap=1;var J=requireAddToUnscopables();return J("flatMap"),es_array_unscopables_flatMap}var es_array_unshift={},hasRequiredEs_array_unshift;function requireEs_array_unshift(){if(hasRequiredEs_array_unshift)return es_array_unshift;hasRequiredEs_array_unshift=1;var J=require_export(),Y=requireToObject(),re=requireLengthOfArrayLike(),ae=requireArraySetLength(),ne=requireDeletePropertyOrThrow(),ce=requireDoesNotExceedSafeInteger(),ee=[].unshift(0)!==1,R=function(){try{Object.defineProperty([],"length",{writable:!1}).unshift()}catch(K){return K instanceof TypeError}},U=ee||!R();return J({target:"Array",proto:!0,arity:1,forced:U},{unshift:function(oe){var pe=Y(this),_e=re(pe),me=arguments.length;if(me){ce(_e+me);for(var we=_e;we--;){var Oe=we+me;we in pe?pe[Oe]=pe[we]:ne(pe,Oe)}for(var De=0;De<me;De++)pe[De]=arguments[De]}return ae(pe,_e+me)}}),es_array_unshift}var es_array_with={},arrayWith,hasRequiredArrayWith;function requireArrayWith(){if(hasRequiredArrayWith)return arrayWith;hasRequiredArrayWith=1;var J=requireLengthOfArrayLike(),Y=requireToIntegerOrInfinity(),re=RangeError;return arrayWith=function(ae,ne,ce,ee){var R=J(ae),U=Y(ce),K=U<0?R+U:U;if(K>=R||K<0)throw new re("Incorrect index");for(var oe=new ne(R),pe=0;pe<R;pe++)oe[pe]=pe===K?ee:ae[pe];return oe},arrayWith}var hasRequiredEs_array_with;function requireEs_array_with(){if(hasRequiredEs_array_with)return es_array_with;hasRequiredEs_array_with=1;var J=require_export(),Y=requireArrayWith(),re=requireToIndexedObject(),ae=Array,ne=(function(){try{[].with({valueOf:function(){throw 4}},null)}catch(ce){return ce!==4}})();return J({target:"Array",proto:!0,forced:ne},{with:function(ce,ee){return Y(re(this),ae,ce,ee)}}),es_array_with}var es_arrayBuffer_constructor={},arrayBufferBasicDetection,hasRequiredArrayBufferBasicDetection;function requireArrayBufferBasicDetection(){return hasRequiredArrayBufferBasicDetection||(hasRequiredArrayBufferBasicDetection=1,arrayBufferBasicDetection=typeof ArrayBuffer<"u"&&typeof DataView<"u"),arrayBufferBasicDetection}var defineBuiltIns,hasRequiredDefineBuiltIns;function requireDefineBuiltIns(){if(hasRequiredDefineBuiltIns)return defineBuiltIns;hasRequiredDefineBuiltIns=1;var J=requireDefineBuiltIn();return defineBuiltIns=function(Y,re,ae){for(var ne in re)J(Y,ne,re[ne],ae);return Y},defineBuiltIns}var anInstance,hasRequiredAnInstance;function requireAnInstance(){if(hasRequiredAnInstance)return anInstance;hasRequiredAnInstance=1;var J=requireObjectIsPrototypeOf(),Y=TypeError;return anInstance=function(re,ae){if(J(ae,re))return re;throw new Y("Incorrect invocation")},anInstance}var toIndex,hasRequiredToIndex;function requireToIndex(){if(hasRequiredToIndex)return toIndex;hasRequiredToIndex=1;var J=requireToIntegerOrInfinity(),Y=requireToLength(),re=RangeError;return toIndex=function(ae){if(ae===void 0)return 0;var ne=J(ae),ce=Y(ne);if(ne!==ce)throw new re("Wrong length or index");return ce},toIndex}var mathSign,hasRequiredMathSign;function requireMathSign(){return hasRequiredMathSign||(hasRequiredMathSign=1,mathSign=Math.sign||function(Y){var re=+Y;return re===0||re!==re?re:re<0?-1:1}),mathSign}var mathRoundTiesToEven,hasRequiredMathRoundTiesToEven;function requireMathRoundTiesToEven(){if(hasRequiredMathRoundTiesToEven)return mathRoundTiesToEven;hasRequiredMathRoundTiesToEven=1;var J=2220446049250313e-31,Y=1/J;return mathRoundTiesToEven=function(re){return re+Y-Y},mathRoundTiesToEven}var mathFloatRound,hasRequiredMathFloatRound;function requireMathFloatRound(){if(hasRequiredMathFloatRound)return mathFloatRound;hasRequiredMathFloatRound=1;var J=requireMathSign(),Y=requireMathRoundTiesToEven(),re=Math.abs,ae=2220446049250313e-31;return mathFloatRound=function(ne,ce,ee,R){var U=+ne,K=re(U),oe=J(U);if(K<R)return oe*Y(K/R/ce)*R*ce;var pe=(1+ce/ae)*K,_e=pe-(pe-K);return _e>ee||_e!==_e?oe*(1/0):oe*_e},mathFloatRound}var mathFround,hasRequiredMathFround;function requireMathFround(){if(hasRequiredMathFround)return mathFround;hasRequiredMathFround=1;var J=requireMathFloatRound(),Y=11920928955078125e-23,re=34028234663852886e22,ae=11754943508222875e-54;return mathFround=Math.fround||function(ce){return J(ce,Y,re,ae)},mathFround}var ieee754$1,hasRequiredIeee754$1;function requireIeee754$1(){if(hasRequiredIeee754$1)return ieee754$1;hasRequiredIeee754$1=1;var J=Array,Y=Math.abs,re=Math.pow,ae=Math.floor,ne=Math.log,ce=Math.LN2,ee=function(U,K,oe){var pe=J(oe),_e=oe*8-K-1,me=(1<<_e)-1,we=me>>1,Oe=K===23?re(2,-24)-re(2,-77):0,De=U<0||U===0&&1/U<0?1:0,Ae=0,Ce,je,ke;for(U=Y(U),U!==U||U===1/0?(je=U!==U?1:0,Ce=me):(Ce=ae(ne(U)/ce),ke=re(2,-Ce),U*ke<1&&(Ce--,ke*=2),Ce+we>=1?U+=Oe/ke:U+=Oe*re(2,1-we),U*ke>=2&&(Ce++,ke/=2),Ce+we>=me?(je=0,Ce=me):Ce+we>=1?(je=(U*ke-1)*re(2,K),Ce+=we):(je=U*re(2,we-1)*re(2,K),Ce=0));K>=8;)pe[Ae++]=je&255,je/=256,K-=8;for(Ce=Ce<<K|je,_e+=K;_e>0;)pe[Ae++]=Ce&255,Ce/=256,_e-=8;return pe[Ae-1]|=De*128,pe},R=function(U,K){var oe=U.length,pe=oe*8-K-1,_e=(1<<pe)-1,me=_e>>1,we=pe-7,Oe=oe-1,De=U[Oe--],Ae=De&127,Ce;for(De>>=7;we>0;)Ae=Ae*256+U[Oe--],we-=8;for(Ce=Ae&(1<<-we)-1,Ae>>=-we,we+=K;we>0;)Ce=Ce*256+U[Oe--],we-=8;if(Ae===0)Ae=1-me;else{if(Ae===_e)return Ce?NaN:De?-1/0:1/0;Ce+=re(2,K),Ae-=me}return(De?-1:1)*Ce*re(2,Ae-K)};return ieee754$1={pack:ee,unpack:R},ieee754$1}var arrayBuffer,hasRequiredArrayBuffer;function requireArrayBuffer(){if(hasRequiredArrayBuffer)return arrayBuffer;hasRequiredArrayBuffer=1;var J=requireGlobalThis(),Y=requireFunctionUncurryThis(),re=requireDescriptors(),ae=requireArrayBufferBasicDetection(),ne=requireFunctionName(),ce=requireCreateNonEnumerableProperty(),ee=requireDefineBuiltInAccessor(),R=requireDefineBuiltIns(),U=requireFails(),K=requireAnInstance(),oe=requireToIntegerOrInfinity(),pe=requireToLength(),_e=requireToIndex(),me=requireMathFround(),we=requireIeee754$1(),Oe=requireObjectGetPrototypeOf(),De=requireObjectSetPrototypeOf(),Ae=requireArrayFill(),Ce=requireArraySlice(),je=requireInheritIfRequired(),ke=requireCopyConstructorProperties(),Be=requireSetToStringTag(),We=requireInternalState(),Je=ne.PROPER,Ke=ne.CONFIGURABLE,et="ArrayBuffer",it="DataView",nt="prototype",ct="Wrong length",ft="Wrong index",_t=We.getterFor(et),Rt=We.getterFor(it),Ft=We.set,ht=J[et],St=ht,ut=St&&St[nt],Et=J[it],bt=Et&&Et[nt],Dt=Object.prototype,Ut=J.Array,er=J.RangeError,xr=Y(Ae),ur=Y([].reverse),yr=we.pack,Wt=we.unpack,or=function(Yt){return[Yt&255]},wr=function(Yt){return[Yt&255,Yt>>8&255]},Ir=function(Yt){return[Yt&255,Yt>>8&255,Yt>>16&255,Yt>>24&255]},br=function(Yt){return Yt[3]<<24|Yt[2]<<16|Yt[1]<<8|Yt[0]},gr=function(Yt){return yr(me(Yt),23,4)},Mr=function(Yt){return yr(Yt,52,8)},Hr=function(Yt,Jt,qr){ee(Yt[nt],Jt,{configurable:!0,get:function(){return qr(this)[Jt]}})},jr=function(Yt,Jt,qr,nr){var dr=Rt(Yt),mr=_e(qr),Ge=!!nr;if(mr+Jt>dr.byteLength)throw new er(ft);var Ie=dr.bytes,Se=mr+dr.byteOffset,xe=Ce(Ie,Se,Se+Jt);return Ge?xe:ur(xe)},Sr=function(Yt,Jt,qr,nr,dr,mr){var Ge=Rt(Yt),Ie=_e(qr),Se=nr(+dr),xe=!!mr;if(Ie+Jt>Ge.byteLength)throw new er(ft);for(var Te=Ge.bytes,Me=Ie+Ge.byteOffset,ze=0;ze<Jt;ze++)Te[Me+ze]=Se[xe?ze:Jt-ze-1]};if(!ae)St=function(Jt){K(this,ut);var qr=_e(Jt);Ft(this,{type:et,bytes:xr(Ut(qr),0),byteLength:qr}),re||(this.byteLength=qr,this.detached=!1)},ut=St[nt],Et=function(Jt,qr,nr){K(this,bt),K(Jt,ut);var dr=_t(Jt),mr=dr.byteLength,Ge=oe(qr);if(Ge<0||Ge>mr)throw new er("Wrong offset");if(nr=nr===void 0?mr-Ge:pe(nr),Ge+nr>mr)throw new er(ct);Ft(this,{type:it,buffer:Jt,byteLength:nr,byteOffset:Ge,bytes:dr.bytes}),re||(this.buffer=Jt,this.byteLength=nr,this.byteOffset=Ge)},bt=Et[nt],re&&(Hr(St,"byteLength",_t),Hr(Et,"buffer",Rt),Hr(Et,"byteLength",Rt),Hr(Et,"byteOffset",Rt)),R(bt,{getInt8:function(Jt){return jr(this,1,Jt)[0]<<24>>24},getUint8:function(Jt){return jr(this,1,Jt)[0]},getInt16:function(Jt){var qr=jr(this,2,Jt,arguments.length>1?arguments[1]:!1);return(qr[1]<<8|qr[0])<<16>>16},getUint16:function(Jt){var qr=jr(this,2,Jt,arguments.length>1?arguments[1]:!1);return qr[1]<<8|qr[0]},getInt32:function(Jt){return br(jr(this,4,Jt,arguments.length>1?arguments[1]:!1))},getUint32:function(Jt){return br(jr(this,4,Jt,arguments.length>1?arguments[1]:!1))>>>0},getFloat32:function(Jt){return Wt(jr(this,4,Jt,arguments.length>1?arguments[1]:!1),23)},getFloat64:function(Jt){return Wt(jr(this,8,Jt,arguments.length>1?arguments[1]:!1),52)},setInt8:function(Jt,qr){Sr(this,1,Jt,or,qr)},setUint8:function(Jt,qr){Sr(this,1,Jt,or,qr)},setInt16:function(Jt,qr){Sr(this,2,Jt,wr,qr,arguments.length>2?arguments[2]:!1)},setUint16:function(Jt,qr){Sr(this,2,Jt,wr,qr,arguments.length>2?arguments[2]:!1)},setInt32:function(Jt,qr){Sr(this,4,Jt,Ir,qr,arguments.length>2?arguments[2]:!1)},setUint32:function(Jt,qr){Sr(this,4,Jt,Ir,qr,arguments.length>2?arguments[2]:!1)},setFloat32:function(Jt,qr){Sr(this,4,Jt,gr,qr,arguments.length>2?arguments[2]:!1)},setFloat64:function(Jt,qr){Sr(this,8,Jt,Mr,qr,arguments.length>2?arguments[2]:!1)}});else{var Nr=Je&&ht.name!==et;!U(function(){ht(1)})||!U(function(){new ht(-1)})||U(function(){return new ht,new ht(1.5),new ht(NaN),ht.length!==1||Nr&&!Ke})?(St=function(Jt){return K(this,ut),je(new ht(_e(Jt)),this,St)},St[nt]=ut,ut.constructor=St,ke(St,ht)):Nr&&Ke&&ce(ht,"name",et),De&&Oe(bt)!==Dt&&De(bt,Dt);var Dr=new Et(new St(2)),Lr=Y(bt.setInt8);Dr.setInt8(0,2147483648),Dr.setInt8(1,2147483649),(Dr.getInt8(0)||!Dr.getInt8(1))&&R(bt,{setInt8:function(Jt,qr){Lr(this,Jt,qr<<24>>24)},setUint8:function(Jt,qr){Lr(this,Jt,qr<<24>>24)}},{unsafe:!0})}return Be(St,et),Be(Et,it),arrayBuffer={ArrayBuffer:St,DataView:Et},arrayBuffer}var hasRequiredEs_arrayBuffer_constructor;function requireEs_arrayBuffer_constructor(){if(hasRequiredEs_arrayBuffer_constructor)return es_arrayBuffer_constructor;hasRequiredEs_arrayBuffer_constructor=1;var J=require_export(),Y=requireGlobalThis(),re=requireArrayBuffer(),ae=requireSetSpecies(),ne="ArrayBuffer",ce=re[ne],ee=Y[ne];return J({global:!0,constructor:!0,forced:ee!==ce},{ArrayBuffer:ce}),ae(ne),es_arrayBuffer_constructor}var es_arrayBuffer_isView={},arrayBufferViewCore,hasRequiredArrayBufferViewCore;function requireArrayBufferViewCore(){if(hasRequiredArrayBufferViewCore)return arrayBufferViewCore;hasRequiredArrayBufferViewCore=1;var J=requireArrayBufferBasicDetection(),Y=requireDescriptors(),re=requireGlobalThis(),ae=requireIsCallable(),ne=requireIsObject$1(),ce=requireHasOwnProperty(),ee=requireClassof(),R=requireTryToString(),U=requireCreateNonEnumerableProperty(),K=requireDefineBuiltIn(),oe=requireDefineBuiltInAccessor(),pe=requireObjectIsPrototypeOf(),_e=requireObjectGetPrototypeOf(),me=requireObjectSetPrototypeOf(),we=requireWellKnownSymbol(),Oe=requireUid(),De=requireInternalState(),Ae=De.enforce,Ce=De.get,je=re.Int8Array,ke=je&&je.prototype,Be=re.Uint8ClampedArray,We=Be&&Be.prototype,Je=je&&_e(je),Ke=ke&&_e(ke),et=Object.prototype,it=re.TypeError,nt=we("toStringTag"),ct=Oe("TYPED_ARRAY_TAG"),ft="TypedArrayConstructor",_t=J&&!!me&&ee(re.opera)!=="Opera",Rt=!1,Ft,ht,St,ut={Int8Array:1,Uint8Array:1,Uint8ClampedArray:1,Int16Array:2,Uint16Array:2,Int32Array:4,Uint32Array:4,Float32Array:4,Float64Array:8},Et={BigInt64Array:8,BigUint64Array:8},bt=function(or){if(!ne(or))return!1;var wr=ee(or);return wr==="DataView"||ce(ut,wr)||ce(Et,wr)},Dt=function(Wt){var or=_e(Wt);if(ne(or)){var wr=Ce(or);return wr&&ce(wr,ft)?wr[ft]:Dt(or)}},Ut=function(Wt){if(!ne(Wt))return!1;var or=ee(Wt);return ce(ut,or)||ce(Et,or)},er=function(Wt){if(Ut(Wt))return Wt;throw new it("Target is not a typed array")},xr=function(Wt){if(ae(Wt)&&(!me||pe(Je,Wt)))return Wt;throw new it(R(Wt)+" is not a typed array constructor")},ur=function(Wt,or,wr,Ir){if(Y){if(wr)for(var br in ut){var gr=re[br];if(gr&&ce(gr.prototype,Wt))try{delete gr.prototype[Wt]}catch{try{gr.prototype[Wt]=or}catch{}}}(!Ke[Wt]||wr)&&K(Ke,Wt,wr?or:_t&&ke[Wt]||or,Ir)}},yr=function(Wt,or,wr){var Ir,br;if(Y){if(me){if(wr){for(Ir in ut)if(br=re[Ir],br&&ce(br,Wt))try{delete br[Wt]}catch{}}if(!Je[Wt]||wr)try{return K(Je,Wt,wr?or:_t&&Je[Wt]||or)}catch{}else return}for(Ir in ut)br=re[Ir],br&&(!br[Wt]||wr)&&K(br,Wt,or)}};for(Ft in ut)ht=re[Ft],St=ht&&ht.prototype,St?Ae(St)[ft]=ht:_t=!1;for(Ft in Et)ht=re[Ft],St=ht&&ht.prototype,St&&(Ae(St)[ft]=ht);if((!_t||!ae(Je)||Je===Function.prototype)&&(Je=function(){throw new it("Incorrect invocation")},_t))for(Ft in ut)re[Ft]&&me(re[Ft],Je);if((!_t||!Ke||Ke===et)&&(Ke=Je.prototype,_t))for(Ft in ut)re[Ft]&&me(re[Ft].prototype,Ke);if(_t&&_e(We)!==Ke&&me(We,Ke),Y&&!ce(Ke,nt)){Rt=!0,oe(Ke,nt,{configurable:!0,get:function(){return ne(this)?this[ct]:void 0}});for(Ft in ut)re[Ft]&&U(re[Ft],ct,Ft)}return arrayBufferViewCore={NATIVE_ARRAY_BUFFER_VIEWS:_t,TYPED_ARRAY_TAG:Rt&&ct,aTypedArray:er,aTypedArrayConstructor:xr,exportTypedArrayMethod:ur,exportTypedArrayStaticMethod:yr,getTypedArrayConstructor:Dt,isView:bt,isTypedArray:Ut,TypedArray:Je,TypedArrayPrototype:Ke},arrayBufferViewCore}var hasRequiredEs_arrayBuffer_isView;function requireEs_arrayBuffer_isView(){if(hasRequiredEs_arrayBuffer_isView)return es_arrayBuffer_isView;hasRequiredEs_arrayBuffer_isView=1;var J=require_export(),Y=requireArrayBufferViewCore(),re=Y.NATIVE_ARRAY_BUFFER_VIEWS;return J({target:"ArrayBuffer",stat:!0,forced:!re},{isView:Y.isView}),es_arrayBuffer_isView}var es_arrayBuffer_slice={},hasRequiredEs_arrayBuffer_slice;function requireEs_arrayBuffer_slice(){if(hasRequiredEs_arrayBuffer_slice)return es_arrayBuffer_slice;hasRequiredEs_arrayBuffer_slice=1;var J=require_export(),Y=requireFunctionUncurryThisClause(),re=requireFails(),ae=requireArrayBuffer(),ne=requireAnObject(),ce=requireToAbsoluteIndex(),ee=requireToLength(),R=ae.ArrayBuffer,U=ae.DataView,K=U.prototype,oe=Y(R.prototype.slice),pe=Y(K.getUint8),_e=Y(K.setUint8),me=re(function(){return!new R(2).slice(1,void 0).byteLength});return J({target:"ArrayBuffer",proto:!0,unsafe:!0,forced:me},{slice:function(Oe,De){if(oe&&De===void 0)return oe(ne(this),Oe);for(var Ae=ne(this).byteLength,Ce=ce(Oe,Ae),je=ce(De===void 0?Ae:De,Ae),ke=new R(ee(je-Ce)),Be=new U(this),We=new U(ke),Je=0;Ce<je;)_e(We,Je++,pe(Be,Ce++));return ke}}),es_arrayBuffer_slice}var es_dataView={},es_dataView_constructor={},hasRequiredEs_dataView_constructor;function requireEs_dataView_constructor(){if(hasRequiredEs_dataView_constructor)return es_dataView_constructor;hasRequiredEs_dataView_constructor=1;var J=require_export(),Y=requireArrayBuffer(),re=requireArrayBufferBasicDetection();return J({global:!0,constructor:!0,forced:!re},{DataView:Y.DataView}),es_dataView_constructor}var hasRequiredEs_dataView;function requireEs_dataView(){return hasRequiredEs_dataView||(hasRequiredEs_dataView=1,requireEs_dataView_constructor()),es_dataView}var es_dataView_getFloat16={},hasRequiredEs_dataView_getFloat16;function requireEs_dataView_getFloat16(){if(hasRequiredEs_dataView_getFloat16)return es_dataView_getFloat16;hasRequiredEs_dataView_getFloat16=1;var J=require_export(),Y=requireFunctionUncurryThis(),re=Math.pow,ae=31,ne=1023,ce=re(2,-24),ee=.0009765625,R=function(K){var oe=K>>>15,pe=K>>>10&ae,_e=K&ne;return pe===ae?_e===0?oe===0?1/0:-1/0:NaN:pe===0?_e*(oe===0?ce:-ce):re(2,pe-15)*(oe===0?1+_e*ee:-1-_e*ee)},U=Y(DataView.prototype.getUint16);return J({target:"DataView",proto:!0},{getFloat16:function(oe){return R(U(this,oe,arguments.length>1?arguments[1]:!1))}}),es_dataView_getFloat16}var es_dataView_setFloat16={},aDataView,hasRequiredADataView;function requireADataView(){if(hasRequiredADataView)return aDataView;hasRequiredADataView=1;var J=requireClassof(),Y=TypeError;return aDataView=function(re){if(J(re)==="DataView")return re;throw new Y("Argument is not a DataView")},aDataView}var mathLog2,hasRequiredMathLog2;function requireMathLog2(){if(hasRequiredMathLog2)return mathLog2;hasRequiredMathLog2=1;var J=Math.log,Y=Math.LN2;return mathLog2=Math.log2||function(ae){return J(ae)/Y},mathLog2}var hasRequiredEs_dataView_setFloat16;function requireEs_dataView_setFloat16(){if(hasRequiredEs_dataView_setFloat16)return es_dataView_setFloat16;hasRequiredEs_dataView_setFloat16=1;var J=require_export(),Y=requireFunctionUncurryThis(),re=requireADataView(),ae=requireToIndex(),ne=requireMathLog2(),ce=requireMathRoundTiesToEven(),ee=Math.pow,R=65520,U=61005353927612305e-21,K=16777216,oe=1024,pe=function(me){if(me!==me)return 32256;if(me===0)return(1/me===-1/0)<<15;var we=me<0;if(we&&(me=-me),me>=R)return we<<15|31744;if(me<U)return we<<15|ce(me*K);var Oe=ne(me)|0;if(Oe===-15)return we<<15|oe;var De=ce((me*ee(2,-Oe)-1)*oe);return De===oe?we<<15|Oe+16<<10:we<<15|Oe+15<<10|De},_e=Y(DataView.prototype.setUint16);return J({target:"DataView",proto:!0},{setFloat16:function(we,Oe){_e(re(this),ae(we),pe(+Oe),arguments.length>2?arguments[2]:!1)}}),es_dataView_setFloat16}var es_arrayBuffer_detached={},arrayBufferByteLength,hasRequiredArrayBufferByteLength;function requireArrayBufferByteLength(){if(hasRequiredArrayBufferByteLength)return arrayBufferByteLength;hasRequiredArrayBufferByteLength=1;var J=requireGlobalThis(),Y=requireFunctionUncurryThisAccessor(),re=requireClassofRaw(),ae=J.ArrayBuffer,ne=J.TypeError;return arrayBufferByteLength=ae&&Y(ae.prototype,"byteLength","get")||function(ce){if(re(ce)!=="ArrayBuffer")throw new ne("ArrayBuffer expected");return ce.byteLength},arrayBufferByteLength}var arrayBufferIsDetached,hasRequiredArrayBufferIsDetached;function requireArrayBufferIsDetached(){if(hasRequiredArrayBufferIsDetached)return arrayBufferIsDetached;hasRequiredArrayBufferIsDetached=1;var J=requireGlobalThis(),Y=requireArrayBufferBasicDetection(),re=requireArrayBufferByteLength(),ae=J.DataView;return arrayBufferIsDetached=function(ne){if(!Y||re(ne)!==0)return!1;try{return new ae(ne),!1}catch{return!0}},arrayBufferIsDetached}var hasRequiredEs_arrayBuffer_detached;function requireEs_arrayBuffer_detached(){if(hasRequiredEs_arrayBuffer_detached)return es_arrayBuffer_detached;hasRequiredEs_arrayBuffer_detached=1;var J=requireDescriptors(),Y=requireDefineBuiltInAccessor(),re=requireArrayBufferIsDetached(),ae=ArrayBuffer.prototype;return J&&!("detached"in ae)&&Y(ae,"detached",{configurable:!0,get:function(){return re(this)}}),es_arrayBuffer_detached}var es_arrayBuffer_transfer={},arrayBufferNotDetached,hasRequiredArrayBufferNotDetached;function requireArrayBufferNotDetached(){if(hasRequiredArrayBufferNotDetached)return arrayBufferNotDetached;hasRequiredArrayBufferNotDetached=1;var J=requireArrayBufferIsDetached(),Y=TypeError;return arrayBufferNotDetached=function(re){if(J(re))throw new Y("ArrayBuffer is detached");return re},arrayBufferNotDetached}var getBuiltInNodeModule,hasRequiredGetBuiltInNodeModule;function requireGetBuiltInNodeModule(){if(hasRequiredGetBuiltInNodeModule)return getBuiltInNodeModule;hasRequiredGetBuiltInNodeModule=1;var J=requireGlobalThis(),Y=requireEnvironmentIsNode();return getBuiltInNodeModule=function(re){if(Y){try{return J.process.getBuiltinModule(re)}catch{}try{return Function('return require("'+re+'")')()}catch{}}},getBuiltInNodeModule}var structuredCloneProperTransfer,hasRequiredStructuredCloneProperTransfer;function requireStructuredCloneProperTransfer(){if(hasRequiredStructuredCloneProperTransfer)return structuredCloneProperTransfer;hasRequiredStructuredCloneProperTransfer=1;var J=requireGlobalThis(),Y=requireFails(),re=requireEnvironmentV8Version(),ae=requireEnvironment(),ne=J.structuredClone;return structuredCloneProperTransfer=!!ne&&!Y(function(){if(ae==="DENO"&&re>92||ae==="NODE"&&re>94||ae==="BROWSER"&&re>97)return!1;var ce=new ArrayBuffer(8),ee=ne(ce,{transfer:[ce]});return ce.byteLength!==0||ee.byteLength!==8}),structuredCloneProperTransfer}var detachTransferable,hasRequiredDetachTransferable;function requireDetachTransferable(){if(hasRequiredDetachTransferable)return detachTransferable;hasRequiredDetachTransferable=1;var J=requireGlobalThis(),Y=requireGetBuiltInNodeModule(),re=requireStructuredCloneProperTransfer(),ae=J.structuredClone,ne=J.ArrayBuffer,ce=J.MessageChannel,ee=!1,R,U,K,oe;if(re)ee=function(pe){ae(pe,{transfer:[pe]})};else if(ne)try{ce||(R=Y("worker_threads"),R&&(ce=R.MessageChannel)),ce&&(U=new ce,K=new ne(2),oe=function(pe){U.port1.postMessage(null,[pe])},K.byteLength===2&&(oe(K),K.byteLength===0&&(ee=oe)))}catch{}return detachTransferable=ee,detachTransferable}var arrayBufferTransfer,hasRequiredArrayBufferTransfer;function requireArrayBufferTransfer(){if(hasRequiredArrayBufferTransfer)return arrayBufferTransfer;hasRequiredArrayBufferTransfer=1;var J=requireGlobalThis(),Y=requireFunctionUncurryThis(),re=requireFunctionUncurryThisAccessor(),ae=requireToIndex(),ne=requireArrayBufferNotDetached(),ce=requireArrayBufferByteLength(),ee=requireDetachTransferable(),R=requireStructuredCloneProperTransfer(),U=J.structuredClone,K=J.ArrayBuffer,oe=J.DataView,pe=Math.min,_e=K.prototype,me=oe.prototype,we=Y(_e.slice),Oe=re(_e,"resizable","get"),De=re(_e,"maxByteLength","get"),Ae=Y(me.getInt8),Ce=Y(me.setInt8);return arrayBufferTransfer=(R||ee)&&function(je,ke,Be){var We=ce(je),Je=ke===void 0?We:ae(ke),Ke=!Oe||!Oe(je),et;if(ne(je),R&&(je=U(je,{transfer:[je]}),We===Je&&(Be||Ke)))return je;if(We>=Je&&(!Be||Ke))et=we(je,0,Je);else{var it=Be&&!Ke&&De?{maxByteLength:De(je)}:void 0;et=new K(Je,it);for(var nt=new oe(je),ct=new oe(et),ft=pe(Je,We),_t=0;_t<ft;_t++)Ce(ct,_t,Ae(nt,_t))}return R||ee(je),et},arrayBufferTransfer}var hasRequiredEs_arrayBuffer_transfer;function requireEs_arrayBuffer_transfer(){if(hasRequiredEs_arrayBuffer_transfer)return es_arrayBuffer_transfer;hasRequiredEs_arrayBuffer_transfer=1;var J=require_export(),Y=requireArrayBufferTransfer();return Y&&J({target:"ArrayBuffer",proto:!0},{transfer:function(){return Y(this,arguments.length?arguments[0]:void 0,!0)}}),es_arrayBuffer_transfer}var es_arrayBuffer_transferToFixedLength={},hasRequiredEs_arrayBuffer_transferToFixedLength;function requireEs_arrayBuffer_transferToFixedLength(){if(hasRequiredEs_arrayBuffer_transferToFixedLength)return es_arrayBuffer_transferToFixedLength;hasRequiredEs_arrayBuffer_transferToFixedLength=1;var J=require_export(),Y=requireArrayBufferTransfer();return Y&&J({target:"ArrayBuffer",proto:!0},{transferToFixedLength:function(){return Y(this,arguments.length?arguments[0]:void 0,!1)}}),es_arrayBuffer_transferToFixedLength}var es_date_getYear={},hasRequiredEs_date_getYear;function requireEs_date_getYear(){if(hasRequiredEs_date_getYear)return es_date_getYear;hasRequiredEs_date_getYear=1;var J=require_export(),Y=requireFunctionUncurryThis(),re=requireFails(),ae=re(function(){return new Date(16e11).getYear()!==120}),ne=Y(Date.prototype.getFullYear);return J({target:"Date",proto:!0,forced:ae},{getYear:function(){return ne(this)-1900}}),es_date_getYear}var es_date_now={},hasRequiredEs_date_now;function requireEs_date_now(){if(hasRequiredEs_date_now)return es_date_now;hasRequiredEs_date_now=1;var J=require_export(),Y=requireFunctionUncurryThis(),re=Date,ae=Y(re.prototype.getTime);return J({target:"Date",stat:!0},{now:function(){return ae(new re)}}),es_date_now}var es_date_setYear={},hasRequiredEs_date_setYear;function requireEs_date_setYear(){if(hasRequiredEs_date_setYear)return es_date_setYear;hasRequiredEs_date_setYear=1;var J=require_export(),Y=requireFunctionUncurryThis(),re=requireToIntegerOrInfinity(),ae=Date.prototype,ne=Y(ae.getTime),ce=Y(ae.setFullYear);return J({target:"Date",proto:!0},{setYear:function(R){ne(this);var U=re(R),K=U>=0&&U<=99?U+1900:U;return ce(this,K)}}),es_date_setYear}var es_date_toGmtString={},hasRequiredEs_date_toGmtString;function requireEs_date_toGmtString(){if(hasRequiredEs_date_toGmtString)return es_date_toGmtString;hasRequiredEs_date_toGmtString=1;var J=require_export();return J({target:"Date",proto:!0},{toGMTString:Date.prototype.toUTCString}),es_date_toGmtString}var es_date_toIsoString={},stringRepeat,hasRequiredStringRepeat;function requireStringRepeat(){if(hasRequiredStringRepeat)return stringRepeat;hasRequiredStringRepeat=1;var J=requireToIntegerOrInfinity(),Y=requireToString$1(),re=requireRequireObjectCoercible(),ae=RangeError;return stringRepeat=function(ce){var ee=Y(re(this)),R="",U=J(ce);if(U<0||U===1/0)throw new ae("Wrong number of repetitions");for(;U>0;(U>>>=1)&&(ee+=ee))U&1&&(R+=ee);return R},stringRepeat}var stringPad,hasRequiredStringPad;function requireStringPad(){if(hasRequiredStringPad)return stringPad;hasRequiredStringPad=1;var J=requireFunctionUncurryThis(),Y=requireToLength(),re=requireToString$1(),ae=requireStringRepeat(),ne=requireRequireObjectCoercible(),ce=J(ae),ee=J("".slice),R=Math.ceil,U=function(K){return function(oe,pe,_e){var me=re(ne(oe)),we=Y(pe),Oe=me.length,De=_e===void 0?" ":re(_e),Ae,Ce;return we<=Oe||De===""?me:(Ae=we-Oe,Ce=ce(De,R(Ae/De.length)),Ce.length>Ae&&(Ce=ee(Ce,0,Ae)),K?me+Ce:Ce+me)}};return stringPad={start:U(!1),end:U(!0)},stringPad}var dateToIsoString,hasRequiredDateToIsoString;function requireDateToIsoString(){if(hasRequiredDateToIsoString)return dateToIsoString;hasRequiredDateToIsoString=1;var J=requireFunctionUncurryThis(),Y=requireFails(),re=requireStringPad().start,ae=RangeError,ne=isFinite,ce=Math.abs,ee=Date.prototype,R=ee.toISOString,U=J(ee.getTime),K=J(ee.getUTCDate),oe=J(ee.getUTCFullYear),pe=J(ee.getUTCHours),_e=J(ee.getUTCMilliseconds),me=J(ee.getUTCMinutes),we=J(ee.getUTCMonth),Oe=J(ee.getUTCSeconds);return dateToIsoString=Y(function(){return R.call(new Date(-5e13-1))!=="0385-07-25T07:06:39.999Z"})||!Y(function(){R.call(new Date(NaN))})?function(){if(!ne(U(this)))throw new ae("Invalid time value");var Ae=this,Ce=oe(Ae),je=_e(Ae),ke=Ce<0?"-":Ce>9999?"+":"";return ke+re(ce(Ce),ke?6:4,0)+"-"+re(we(Ae)+1,2,0)+"-"+re(K(Ae),2,0)+"T"+re(pe(Ae),2,0)+":"+re(me(Ae),2,0)+":"+re(Oe(Ae),2,0)+"."+re(je,3,0)+"Z"}:R,dateToIsoString}var hasRequiredEs_date_toIsoString;function requireEs_date_toIsoString(){if(hasRequiredEs_date_toIsoString)return es_date_toIsoString;hasRequiredEs_date_toIsoString=1;var J=require_export(),Y=requireDateToIsoString();return J({target:"Date",proto:!0,forced:Date.prototype.toISOString!==Y},{toISOString:Y}),es_date_toIsoString}var es_date_toJson={},hasRequiredEs_date_toJson;function requireEs_date_toJson(){if(hasRequiredEs_date_toJson)return es_date_toJson;hasRequiredEs_date_toJson=1;var J=require_export(),Y=requireFails(),re=requireToObject(),ae=requireToPrimitive(),ne=Y(function(){return new Date(NaN).toJSON()!==null||Date.prototype.toJSON.call({toISOString:function(){return 1}})!==1});return J({target:"Date",proto:!0,arity:1,forced:ne},{toJSON:function(ee){var R=re(this),U=ae(R,"number");return typeof U=="number"&&!isFinite(U)?null:R.toISOString()}}),es_date_toJson}var es_date_toPrimitive={},dateToPrimitive,hasRequiredDateToPrimitive;function requireDateToPrimitive(){if(hasRequiredDateToPrimitive)return dateToPrimitive;hasRequiredDateToPrimitive=1;var J=requireAnObject(),Y=requireOrdinaryToPrimitive(),re=TypeError;return dateToPrimitive=function(ae){if(J(this),ae==="string"||ae==="default")ae="string";else if(ae!=="number")throw new re("Incorrect hint");return Y(this,ae)},dateToPrimitive}var hasRequiredEs_date_toPrimitive;function requireEs_date_toPrimitive(){if(hasRequiredEs_date_toPrimitive)return es_date_toPrimitive;hasRequiredEs_date_toPrimitive=1;var J=requireHasOwnProperty(),Y=requireDefineBuiltIn(),re=requireDateToPrimitive(),ae=requireWellKnownSymbol(),ne=ae("toPrimitive"),ce=Date.prototype;return J(ce,ne)||Y(ce,ne,re),es_date_toPrimitive}var es_date_toString={},hasRequiredEs_date_toString;function requireEs_date_toString(){if(hasRequiredEs_date_toString)return es_date_toString;hasRequiredEs_date_toString=1;var J=requireFunctionUncurryThis(),Y=requireDefineBuiltIn(),re=Date.prototype,ae="Invalid Date",ne="toString",ce=J(re[ne]),ee=J(re.getTime);return String(new Date(NaN))!==ae&&Y(re,ne,function(){var U=ee(this);return U===U?ce(this):ae}),es_date_toString}var es_disposableStack_constructor={},addDisposableResource,hasRequiredAddDisposableResource;function requireAddDisposableResource(){if(hasRequiredAddDisposableResource)return addDisposableResource;hasRequiredAddDisposableResource=1;var J=requireGetBuiltIn(),Y=requireFunctionCall(),re=requireFunctionUncurryThis(),ae=requireFunctionBindContext(),ne=requireAnObject(),ce=requireACallable(),ee=requireIsNullOrUndefined(),R=requireGetMethod(),U=requireWellKnownSymbol(),K=U("asyncDispose"),oe=U("dispose"),pe=re([].push),_e=function(we,Oe){if(Oe==="async-dispose"){var De=R(we,K);return De!==void 0||(De=R(we,oe),De===void 0)?De:function(){var Ae=this,Ce=J("Promise");return new Ce(function(je){Y(De,Ae),je(void 0)})}}return R(we,oe)},me=function(we,Oe,De){return arguments.length<3&&!ee(we)&&(De=ce(_e(ne(we),Oe))),De===void 0?function(){}:ae(De,we)};return addDisposableResource=function(we,Oe,De,Ae){var Ce;if(arguments.length<4){if(ee(Oe)&&De==="sync-dispose")return;Ce=me(Oe,De)}else Ce=me(void 0,De,Ae);pe(we.stack,Ce)},addDisposableResource}var hasRequiredEs_disposableStack_constructor;function requireEs_disposableStack_constructor(){if(hasRequiredEs_disposableStack_constructor)return es_disposableStack_constructor;hasRequiredEs_disposableStack_constructor=1;var J=require_export(),Y=requireDescriptors(),re=requireGetBuiltIn(),ae=requireACallable(),ne=requireAnInstance(),ce=requireDefineBuiltIn(),ee=requireDefineBuiltIns(),R=requireDefineBuiltInAccessor(),U=requireWellKnownSymbol(),K=requireInternalState(),oe=requireAddDisposableResource(),pe=re("SuppressedError"),_e=ReferenceError,me=U("dispose"),we=U("toStringTag"),Oe="DisposableStack",De=K.set,Ae=K.getterFor(Oe),Ce="sync-dispose",je="disposed",ke="pending",Be=function(Ke){var et=Ae(Ke);if(et.state===je)throw new _e(Oe+" already disposed");return et},We=function(){De(ne(this,Je),{type:Oe,state:ke,stack:[]}),Y||(this.disposed=!1)},Je=We.prototype;return ee(Je,{dispose:function(){var et=Ae(this);if(et.state!==je){et.state=je,Y||(this.disposed=!0);for(var it=et.stack,nt=it.length,ct=!1,ft;nt;){var _t=it[--nt];it[nt]=null;try{_t()}catch(Rt){ct?ft=new pe(Rt,ft):(ct=!0,ft=Rt)}}if(et.stack=null,ct)throw ft}},use:function(et){return oe(Be(this),et,Ce),et},adopt:function(et,it){var nt=Be(this);return ae(it),oe(nt,void 0,Ce,function(){it(et)}),et},defer:function(et){var it=Be(this);ae(et),oe(it,void 0,Ce,et)},move:function(){var et=Be(this),it=new We;return Ae(it).stack=et.stack,et.stack=[],et.state=je,Y||(this.disposed=!0),it}}),Y&&R(Je,"disposed",{configurable:!0,get:function(){return Ae(this).state===je}}),ce(Je,me,Je.dispose,{name:"dispose"}),ce(Je,we,Oe,{nonWritable:!0}),J({global:!0,constructor:!0},{DisposableStack:We}),es_disposableStack_constructor}var es_escape={},hasRequiredEs_escape;function requireEs_escape(){if(hasRequiredEs_escape)return es_escape;hasRequiredEs_escape=1;var J=require_export(),Y=requireFunctionUncurryThis(),re=requireToString$1(),ae=Y("".charAt),ne=Y("".charCodeAt),ce=Y(/./.exec),ee=Y(1.1.toString),R=Y("".toUpperCase),U=/[\w*+\-./@]/,K=function(oe,pe){for(var _e=ee(oe,16);_e.length<pe;)_e="0"+_e;return _e};return J({global:!0},{escape:function(pe){for(var _e=re(pe),me="",we=_e.length,Oe=0,De,Ae;Oe<we;)De=ae(_e,Oe++),ce(U,De)?me+=De:(Ae=ne(De,0),Ae<256?me+="%"+K(Ae,2):me+="%u"+R(K(Ae,4)));return me}}),es_escape}var es_function_bind={},functionBind,hasRequiredFunctionBind;function requireFunctionBind(){if(hasRequiredFunctionBind)return functionBind;hasRequiredFunctionBind=1;var J=requireFunctionUncurryThis(),Y=requireACallable(),re=requireIsObject$1(),ae=requireHasOwnProperty(),ne=requireArraySlice(),ce=requireFunctionBindNative(),ee=Function,R=J([].concat),U=J([].join),K={},oe=function(pe,_e,me){if(!ae(K,_e)){for(var we=[],Oe=0;Oe<_e;Oe++)we[Oe]="a["+Oe+"]";K[_e]=ee("C,a","return new C("+U(we,",")+")")}return K[_e](pe,me)};return functionBind=ce?ee.bind:function(_e){var me=Y(this),we=me.prototype,Oe=ne(arguments,1),De=function(){var Ce=R(Oe,ne(arguments));return this instanceof De?oe(me,Ce.length,Ce):me.apply(_e,Ce)};return re(we)&&(De.prototype=we),De},functionBind}var hasRequiredEs_function_bind;function requireEs_function_bind(){if(hasRequiredEs_function_bind)return es_function_bind;hasRequiredEs_function_bind=1;var J=require_export(),Y=requireFunctionBind();return J({target:"Function",proto:!0,forced:Function.bind!==Y},{bind:Y}),es_function_bind}var es_function_hasInstance={},hasRequiredEs_function_hasInstance;function requireEs_function_hasInstance(){if(hasRequiredEs_function_hasInstance)return es_function_hasInstance;hasRequiredEs_function_hasInstance=1;var J=requireIsCallable(),Y=requireIsObject$1(),re=requireObjectDefineProperty(),ae=requireObjectIsPrototypeOf(),ne=requireWellKnownSymbol(),ce=requireMakeBuiltIn(),ee=ne("hasInstance"),R=Function.prototype;return ee in R||re.f(R,ee,{value:ce(function(U){if(!J(this)||!Y(U))return!1;var K=this.prototype;return Y(K)?ae(K,U):U instanceof this},ee)}),es_function_hasInstance}var es_function_name={},hasRequiredEs_function_name;function requireEs_function_name(){if(hasRequiredEs_function_name)return es_function_name;hasRequiredEs_function_name=1;var J=requireDescriptors(),Y=requireFunctionName().EXISTS,re=requireFunctionUncurryThis(),ae=requireDefineBuiltInAccessor(),ne=Function.prototype,ce=re(ne.toString),ee=/function\b(?:\s|\/\*[\S\s]*?\*\/|\/\/[^\n\r]*[\n\r]+)*([^\s(/]*)/,R=re(ee.exec),U="name";return J&&!Y&&ae(ne,U,{configurable:!0,get:function(){try{return R(ee,ce(this))[1]}catch{return""}}}),es_function_name}var es_globalThis={},hasRequiredEs_globalThis;function requireEs_globalThis(){if(hasRequiredEs_globalThis)return es_globalThis;hasRequiredEs_globalThis=1;var J=require_export(),Y=requireGlobalThis();return J({global:!0,forced:Y.globalThis!==Y},{globalThis:Y}),es_globalThis}var es_iterator_constructor={},hasRequiredEs_iterator_constructor;function requireEs_iterator_constructor(){if(hasRequiredEs_iterator_constructor)return es_iterator_constructor;hasRequiredEs_iterator_constructor=1;var J=require_export(),Y=requireGlobalThis(),re=requireAnInstance(),ae=requireAnObject(),ne=requireIsCallable(),ce=requireObjectGetPrototypeOf(),ee=requireDefineBuiltInAccessor(),R=requireCreateProperty(),U=requireFails(),K=requireHasOwnProperty(),oe=requireWellKnownSymbol(),pe=requireIteratorsCore().IteratorPrototype,_e=requireDescriptors(),me=requireIsPure(),we="constructor",Oe="Iterator",De=oe("toStringTag"),Ae=TypeError,Ce=Y[Oe],je=me||!ne(Ce)||Ce.prototype!==pe||!U(function(){Ce({})}),ke=function(){if(re(this,pe),ce(this)===pe)throw new Ae("Abstract class Iterator not directly constructable")},Be=function(We,Je){_e?ee(pe,We,{configurable:!0,get:function(){return Je},set:function(Ke){if(ae(this),this===pe)throw new Ae("You can't redefine this property");K(this,We)?this[We]=Ke:R(this,We,Ke)}}):pe[We]=Je};return K(pe,De)||Be(De,Oe),(je||!K(pe,we)||pe[we]===Object)&&Be(we,ke),ke.prototype=pe,J({global:!0,constructor:!0,forced:je},{Iterator:ke}),es_iterator_constructor}var es_iterator_dispose={},hasRequiredEs_iterator_dispose;function requireEs_iterator_dispose(){if(hasRequiredEs_iterator_dispose)return es_iterator_dispose;hasRequiredEs_iterator_dispose=1;var J=requireFunctionCall(),Y=requireDefineBuiltIn(),re=requireGetMethod(),ae=requireHasOwnProperty(),ne=requireWellKnownSymbol(),ce=requireIteratorsCore().IteratorPrototype,ee=ne("dispose");return ae(ce,ee)||Y(ce,ee,function(){var R=re(this,"return");R&&J(R,this)}),es_iterator_dispose}var es_iterator_drop={},getIteratorDirect,hasRequiredGetIteratorDirect;function requireGetIteratorDirect(){return hasRequiredGetIteratorDirect||(hasRequiredGetIteratorDirect=1,getIteratorDirect=function(J){return{iterator:J,next:J.next,done:!1}}),getIteratorDirect}var notANan,hasRequiredNotANan;function requireNotANan(){if(hasRequiredNotANan)return notANan;hasRequiredNotANan=1;var J=RangeError;return notANan=function(Y){if(Y===Y)return Y;throw new J("NaN is not allowed")},notANan}var toPositiveInteger,hasRequiredToPositiveInteger;function requireToPositiveInteger(){if(hasRequiredToPositiveInteger)return toPositiveInteger;hasRequiredToPositiveInteger=1;var J=requireToIntegerOrInfinity(),Y=RangeError;return toPositiveInteger=function(re){var ae=J(re);if(ae<0)throw new Y("The argument can't be less than 0");return ae},toPositiveInteger}var iteratorCloseAll,hasRequiredIteratorCloseAll;function requireIteratorCloseAll(){if(hasRequiredIteratorCloseAll)return iteratorCloseAll;hasRequiredIteratorCloseAll=1;var J=requireIteratorClose();return iteratorCloseAll=function(Y,re,ae){for(var ne=Y.length-1;ne>=0;ne--)if(Y[ne]!==void 0)try{ae=J(Y[ne].iterator,re,ae)}catch(ce){re="throw",ae=ce}if(re==="throw")throw ae;return ae},iteratorCloseAll}var iteratorCreateProxy,hasRequiredIteratorCreateProxy;function requireIteratorCreateProxy(){if(hasRequiredIteratorCreateProxy)return iteratorCreateProxy;hasRequiredIteratorCreateProxy=1;var J=requireFunctionCall(),Y=requireObjectCreate(),re=requireCreateNonEnumerableProperty(),ae=requireDefineBuiltIns(),ne=requireWellKnownSymbol(),ce=requireInternalState(),ee=requireGetMethod(),R=requireIteratorsCore().IteratorPrototype,U=requireCreateIterResultObject(),K=requireIteratorClose(),oe=requireIteratorCloseAll(),pe=ne("toStringTag"),_e="IteratorHelper",me="WrapForValidIterator",we="normal",Oe="throw",De=ce.set,Ae=function(ke){var Be=ce.getterFor(ke?me:_e);return ae(Y(R),{next:function(){var Je=Be(this);if(ke)return Je.nextHandler();if(Je.done)return U(void 0,!0);try{var Ke=Je.nextHandler();return Je.returnHandlerResult?Ke:U(Ke,Je.done)}catch(et){throw Je.done=!0,et}},return:function(){var We=Be(this),Je=We.iterator;if(We.done=!0,ke){var Ke=ee(Je,"return");return Ke?J(Ke,Je):U(void 0,!0)}if(We.inner)try{K(We.inner.iterator,we)}catch(et){return K(Je,Oe,et)}if(We.openIters)try{oe(We.openIters,we)}catch(et){return K(Je,Oe,et)}return Je&&K(Je,we),U(void 0,!0)}})},Ce=Ae(!0),je=Ae(!1);return re(je,pe,"Iterator Helper"),iteratorCreateProxy=function(ke,Be,We){var Je=function(et,it){it?(it.iterator=et.iterator,it.next=et.next):it=et,it.type=Be?me:_e,it.returnHandlerResult=!!We,it.nextHandler=ke,it.counter=0,it.done=!1,De(this,it)};return Je.prototype=Be?Ce:je,Je},iteratorCreateProxy}var iteratorHelperThrowsOnInvalidIterator,hasRequiredIteratorHelperThrowsOnInvalidIterator;function requireIteratorHelperThrowsOnInvalidIterator(){return hasRequiredIteratorHelperThrowsOnInvalidIterator||(hasRequiredIteratorHelperThrowsOnInvalidIterator=1,iteratorHelperThrowsOnInvalidIterator=function(J,Y){var re=typeof Iterator=="function"&&Iterator.prototype[J];if(re)try{re.call({next:null},Y).next()}catch{return!0}}),iteratorHelperThrowsOnInvalidIterator}var iteratorHelperWithoutClosingOnEarlyError,hasRequiredIteratorHelperWithoutClosingOnEarlyError;function requireIteratorHelperWithoutClosingOnEarlyError(){if(hasRequiredIteratorHelperWithoutClosingOnEarlyError)return iteratorHelperWithoutClosingOnEarlyError;hasRequiredIteratorHelperWithoutClosingOnEarlyError=1;var J=requireGlobalThis();return iteratorHelperWithoutClosingOnEarlyError=function(Y,re){var ae=J.Iterator,ne=ae&&ae.prototype,ce=ne&&ne[Y],ee=!1;if(ce)try{ce.call({next:function(){return{done:!0}},return:function(){ee=!0}},-1)}catch(R){R instanceof re||(ee=!1)}if(!ee)return ce},iteratorHelperWithoutClosingOnEarlyError}var hasRequiredEs_iterator_drop;function requireEs_iterator_drop(){if(hasRequiredEs_iterator_drop)return es_iterator_drop;hasRequiredEs_iterator_drop=1;var J=require_export(),Y=requireFunctionCall(),re=requireAnObject(),ae=requireGetIteratorDirect(),ne=requireNotANan(),ce=requireToPositiveInteger(),ee=requireIteratorClose(),R=requireIteratorCreateProxy(),U=requireIteratorHelperThrowsOnInvalidIterator(),K=requireIteratorHelperWithoutClosingOnEarlyError(),oe=requireIsPure(),pe=!oe&&!U("drop",0),_e=!oe&&!pe&&K("drop",RangeError),me=oe||pe||_e,we=R(function(){for(var Oe=this.iterator,De=this.next,Ae,Ce;this.remaining;)if(this.remaining--,Ae=re(Y(De,Oe)),Ce=this.done=!!Ae.done,Ce)return;if(Ae=re(Y(De,Oe)),Ce=this.done=!!Ae.done,!Ce)return Ae.value});return J({target:"Iterator",proto:!0,real:!0,forced:me},{drop:function(De){re(this);var Ae;try{Ae=ce(ne(+De))}catch(Ce){ee(this,"throw",Ce)}return _e?Y(_e,this,Ae):new we(ae(this),{remaining:Ae})}}),es_iterator_drop}var es_iterator_every={},hasRequiredEs_iterator_every;function requireEs_iterator_every(){if(hasRequiredEs_iterator_every)return es_iterator_every;hasRequiredEs_iterator_every=1;var J=require_export(),Y=requireFunctionCall(),re=requireIterate(),ae=requireACallable(),ne=requireAnObject(),ce=requireGetIteratorDirect(),ee=requireIteratorClose(),R=requireIteratorHelperWithoutClosingOnEarlyError(),U=R("every",TypeError);return J({target:"Iterator",proto:!0,real:!0,forced:U},{every:function(oe){ne(this);try{ae(oe)}catch(me){ee(this,"throw",me)}if(U)return Y(U,this,oe);var pe=ce(this),_e=0;return!re(pe,function(me,we){if(!oe(me,_e++))return we()},{IS_RECORD:!0,INTERRUPTED:!0}).stopped}}),es_iterator_every}var es_iterator_filter={},hasRequiredEs_iterator_filter;function requireEs_iterator_filter(){if(hasRequiredEs_iterator_filter)return es_iterator_filter;hasRequiredEs_iterator_filter=1;var J=require_export(),Y=requireFunctionCall(),re=requireACallable(),ae=requireAnObject(),ne=requireGetIteratorDirect(),ce=requireIteratorCreateProxy(),ee=requireCallWithSafeIterationClosing(),R=requireIsPure(),U=requireIteratorClose(),K=requireIteratorHelperThrowsOnInvalidIterator(),oe=requireIteratorHelperWithoutClosingOnEarlyError(),pe=!R&&!K("filter",function(){}),_e=!R&&!pe&&oe("filter",TypeError),me=R||pe||_e,we=ce(function(){for(var Oe=this.iterator,De=this.predicate,Ae=this.next,Ce,je,ke;;){if(Ce=ae(Y(Ae,Oe)),je=this.done=!!Ce.done,je)return;if(ke=Ce.value,ee(Oe,De,[ke,this.counter++],!0))return ke}});return J({target:"Iterator",proto:!0,real:!0,forced:me},{filter:function(De){ae(this);try{re(De)}catch(Ae){U(this,"throw",Ae)}return _e?Y(_e,this,De):new we(ne(this),{predicate:De})}}),es_iterator_filter}var es_iterator_find={},hasRequiredEs_iterator_find;function requireEs_iterator_find(){if(hasRequiredEs_iterator_find)return es_iterator_find;hasRequiredEs_iterator_find=1;var J=require_export(),Y=requireFunctionCall(),re=requireIterate(),ae=requireACallable(),ne=requireAnObject(),ce=requireGetIteratorDirect(),ee=requireIteratorClose(),R=requireIteratorHelperWithoutClosingOnEarlyError(),U=R("find",TypeError);return J({target:"Iterator",proto:!0,real:!0,forced:U},{find:function(oe){ne(this);try{ae(oe)}catch(me){ee(this,"throw",me)}if(U)return Y(U,this,oe);var pe=ce(this),_e=0;return re(pe,function(me,we){if(oe(me,_e++))return we(me)},{IS_RECORD:!0,INTERRUPTED:!0}).result}}),es_iterator_find}var es_iterator_flatMap={},getIteratorFlattenable,hasRequiredGetIteratorFlattenable;function requireGetIteratorFlattenable(){if(hasRequiredGetIteratorFlattenable)return getIteratorFlattenable;hasRequiredGetIteratorFlattenable=1;var J=requireFunctionCall(),Y=requireAnObject(),re=requireGetIteratorDirect(),ae=requireGetIteratorMethod();return getIteratorFlattenable=function(ne,ce){(!ce||typeof ne!="string")&&Y(ne);var ee=ae(ne);return re(Y(ee!==void 0?J(ee,ne):ne))},getIteratorFlattenable}var hasRequiredEs_iterator_flatMap;function requireEs_iterator_flatMap(){if(hasRequiredEs_iterator_flatMap)return es_iterator_flatMap;hasRequiredEs_iterator_flatMap=1;var J=require_export(),Y=requireFunctionCall(),re=requireACallable(),ae=requireAnObject(),ne=requireGetIteratorDirect(),ce=requireGetIteratorFlattenable(),ee=requireIteratorCreateProxy(),R=requireIteratorClose(),U=requireIsPure(),K=requireIteratorHelperThrowsOnInvalidIterator(),oe=requireIteratorHelperWithoutClosingOnEarlyError(),pe=!U&&!K("flatMap",function(){}),_e=!U&&!pe&&oe("flatMap",TypeError),me=U||pe||_e,we=ee(function(){for(var Oe=this.iterator,De=this.mapper,Ae,Ce;;){if(Ce=this.inner)try{if(Ae=ae(Y(Ce.next,Ce.iterator)),!Ae.done)return Ae.value;this.inner=null}catch(je){R(Oe,"throw",je)}if(Ae=ae(Y(this.next,Oe)),this.done=!!Ae.done)return;try{this.inner=ce(De(Ae.value,this.counter++),!1)}catch(je){R(Oe,"throw",je)}}});return J({target:"Iterator",proto:!0,real:!0,forced:me},{flatMap:function(De){ae(this);try{re(De)}catch(Ae){R(this,"throw",Ae)}return _e?Y(_e,this,De):new we(ne(this),{mapper:De,inner:null})}}),es_iterator_flatMap}var es_iterator_forEach={},hasRequiredEs_iterator_forEach;function requireEs_iterator_forEach(){if(hasRequiredEs_iterator_forEach)return es_iterator_forEach;hasRequiredEs_iterator_forEach=1;var J=require_export(),Y=requireFunctionCall(),re=requireIterate(),ae=requireACallable(),ne=requireAnObject(),ce=requireGetIteratorDirect(),ee=requireIteratorClose(),R=requireIteratorHelperWithoutClosingOnEarlyError(),U=R("forEach",TypeError);return J({target:"Iterator",proto:!0,real:!0,forced:U},{forEach:function(oe){ne(this);try{ae(oe)}catch(me){ee(this,"throw",me)}if(U)return Y(U,this,oe);var pe=ce(this),_e=0;re(pe,function(me){oe(me,_e++)},{IS_RECORD:!0})}}),es_iterator_forEach}var es_iterator_from={},hasRequiredEs_iterator_from;function requireEs_iterator_from(){if(hasRequiredEs_iterator_from)return es_iterator_from;hasRequiredEs_iterator_from=1;var J=require_export(),Y=requireFunctionCall(),re=requireToObject(),ae=requireObjectIsPrototypeOf(),ne=requireIteratorsCore().IteratorPrototype,ce=requireIteratorCreateProxy(),ee=requireGetIteratorFlattenable(),R=requireIsPure(),U=R||(function(){try{Iterator.from({return:null}).return()}catch{return!0}})(),K=ce(function(){return Y(this.next,this.iterator)},!0);return J({target:"Iterator",stat:!0,forced:U},{from:function(pe){var _e=ee(typeof pe=="string"?re(pe):pe,!0);return ae(ne,_e.iterator)?_e.iterator:new K(_e)}}),es_iterator_from}var es_iterator_map={},hasRequiredEs_iterator_map;function requireEs_iterator_map(){if(hasRequiredEs_iterator_map)return es_iterator_map;hasRequiredEs_iterator_map=1;var J=require_export(),Y=requireFunctionCall(),re=requireACallable(),ae=requireAnObject(),ne=requireGetIteratorDirect(),ce=requireIteratorCreateProxy(),ee=requireCallWithSafeIterationClosing(),R=requireIteratorClose(),U=requireIteratorHelperThrowsOnInvalidIterator(),K=requireIteratorHelperWithoutClosingOnEarlyError(),oe=requireIsPure(),pe=!oe&&!U("map",function(){}),_e=!oe&&!pe&&K("map",TypeError),me=oe||pe||_e,we=ce(function(){var Oe=this.iterator,De=ae(Y(this.next,Oe)),Ae=this.done=!!De.done;if(!Ae)return ee(Oe,this.mapper,[De.value,this.counter++],!0)});return J({target:"Iterator",proto:!0,real:!0,forced:me},{map:function(De){ae(this);try{re(De)}catch(Ae){R(this,"throw",Ae)}return _e?Y(_e,this,De):new we(ne(this),{mapper:De})}}),es_iterator_map}var es_iterator_reduce={},hasRequiredEs_iterator_reduce;function requireEs_iterator_reduce(){if(hasRequiredEs_iterator_reduce)return es_iterator_reduce;hasRequiredEs_iterator_reduce=1;var J=require_export(),Y=requireIterate(),re=requireACallable(),ae=requireAnObject(),ne=requireGetIteratorDirect(),ce=requireIteratorClose(),ee=requireIteratorHelperWithoutClosingOnEarlyError(),R=requireFunctionApply(),U=requireFails(),K=TypeError,oe=U(function(){[].keys().reduce(function(){},void 0)}),pe=!oe&&ee("reduce",K);return J({target:"Iterator",proto:!0,real:!0,forced:oe||pe},{reduce:function(me){ae(this);try{re(me)}catch(Ce){ce(this,"throw",Ce)}var we=arguments.length<2,Oe=we?void 0:arguments[1];if(pe)return R(pe,this,we?[me]:[me,Oe]);var De=ne(this),Ae=0;if(Y(De,function(Ce){we?(we=!1,Oe=Ce):Oe=me(Oe,Ce,Ae),Ae++},{IS_RECORD:!0}),we)throw new K("Reduce of empty iterator with no initial value");return Oe}}),es_iterator_reduce}var es_iterator_some={},hasRequiredEs_iterator_some;function requireEs_iterator_some(){if(hasRequiredEs_iterator_some)return es_iterator_some;hasRequiredEs_iterator_some=1;var J=require_export(),Y=requireFunctionCall(),re=requireIterate(),ae=requireACallable(),ne=requireAnObject(),ce=requireGetIteratorDirect(),ee=requireIteratorClose(),R=requireIteratorHelperWithoutClosingOnEarlyError(),U=R("some",TypeError);return J({target:"Iterator",proto:!0,real:!0,forced:U},{some:function(oe){ne(this);try{ae(oe)}catch(me){ee(this,"throw",me)}if(U)return Y(U,this,oe);var pe=ce(this),_e=0;return re(pe,function(me,we){if(oe(me,_e++))return we()},{IS_RECORD:!0,INTERRUPTED:!0}).stopped}}),es_iterator_some}var es_iterator_take={},hasRequiredEs_iterator_take;function requireEs_iterator_take(){if(hasRequiredEs_iterator_take)return es_iterator_take;hasRequiredEs_iterator_take=1;var J=require_export(),Y=requireFunctionCall(),re=requireAnObject(),ae=requireGetIteratorDirect(),ne=requireNotANan(),ce=requireToPositiveInteger(),ee=requireIteratorCreateProxy(),R=requireIteratorClose(),U=requireIteratorHelperWithoutClosingOnEarlyError(),K=requireIsPure(),oe=!K&&U("take",RangeError),pe=ee(function(){var _e=this.iterator;if(!this.remaining--)return this.done=!0,R(_e,"normal",void 0);var me=re(Y(this.next,_e)),we=this.done=!!me.done;if(!we)return me.value});return J({target:"Iterator",proto:!0,real:!0,forced:K||oe},{take:function(me){re(this);var we;try{we=ce(ne(+me))}catch(Oe){R(this,"throw",Oe)}return oe?Y(oe,this,we):new pe(ae(this),{remaining:we})}}),es_iterator_take}var es_iterator_toArray={},hasRequiredEs_iterator_toArray;function requireEs_iterator_toArray(){if(hasRequiredEs_iterator_toArray)return es_iterator_toArray;hasRequiredEs_iterator_toArray=1;var J=require_export(),Y=requireAnObject(),re=requireIterate(),ae=requireGetIteratorDirect(),ne=[].push;return J({target:"Iterator",proto:!0,real:!0},{toArray:function(){var ee=[];return re(ae(Y(this)),ne,{that:ee,IS_RECORD:!0}),ee}}),es_iterator_toArray}var es_json_toStringTag={},hasRequiredEs_json_toStringTag;function requireEs_json_toStringTag(){if(hasRequiredEs_json_toStringTag)return es_json_toStringTag;hasRequiredEs_json_toStringTag=1;var J=requireGlobalThis(),Y=requireSetToStringTag();return Y(J.JSON,"JSON",!0),es_json_toStringTag}var es_map={},es_map_constructor={},internalMetadata={exports:{}},arrayBufferNonExtensible,hasRequiredArrayBufferNonExtensible;function requireArrayBufferNonExtensible(){if(hasRequiredArrayBufferNonExtensible)return arrayBufferNonExtensible;hasRequiredArrayBufferNonExtensible=1;var J=requireFails();return arrayBufferNonExtensible=J(function(){if(typeof ArrayBuffer=="function"){var Y=new ArrayBuffer(8);Object.isExtensible(Y)&&Object.defineProperty(Y,"a",{value:8})}}),arrayBufferNonExtensible}var objectIsExtensible,hasRequiredObjectIsExtensible;function requireObjectIsExtensible(){if(hasRequiredObjectIsExtensible)return objectIsExtensible;hasRequiredObjectIsExtensible=1;var J=requireFails(),Y=requireIsObject$1(),re=requireClassofRaw(),ae=requireArrayBufferNonExtensible(),ne=Object.isExtensible,ce=J(function(){});return objectIsExtensible=ce||ae?function(R){return!Y(R)||ae&&re(R)==="ArrayBuffer"?!1:ne?ne(R):!0}:ne,objectIsExtensible}var freezing,hasRequiredFreezing;function requireFreezing(){if(hasRequiredFreezing)return freezing;hasRequiredFreezing=1;var J=requireFails();return freezing=!J(function(){return Object.isExtensible(Object.preventExtensions({}))}),freezing}var hasRequiredInternalMetadata;function requireInternalMetadata(){if(hasRequiredInternalMetadata)return internalMetadata.exports;hasRequiredInternalMetadata=1;var J=require_export(),Y=requireFunctionUncurryThis(),re=requireHiddenKeys(),ae=requireIsObject$1(),ne=requireHasOwnProperty(),ce=requireObjectDefineProperty().f,ee=requireObjectGetOwnPropertyNames(),R=requireObjectGetOwnPropertyNamesExternal(),U=requireObjectIsExtensible(),K=requireUid(),oe=requireFreezing(),pe=!1,_e=K("meta"),me=0,we=function(ke){ce(ke,_e,{value:{objectID:"O"+me++,weakData:{}}})},Oe=function(ke,Be){if(!ae(ke))return typeof ke=="symbol"?ke:(typeof ke=="string"?"S":"P")+ke;if(!ne(ke,_e)){if(!U(ke))return"F";if(!Be)return"E";we(ke)}return ke[_e].objectID},De=function(ke,Be){if(!ne(ke,_e)){if(!U(ke))return!0;if(!Be)return!1;we(ke)}return ke[_e].weakData},Ae=function(ke){return oe&&pe&&U(ke)&&!ne(ke,_e)&&we(ke),ke},Ce=function(){je.enable=function(){},pe=!0;var ke=ee.f,Be=Y([].splice),We={};We[_e]=1,ke(We).length&&(ee.f=function(Je){for(var Ke=ke(Je),et=0,it=Ke.length;et<it;et++)if(Ke[et]===_e){Be(Ke,et,1);break}return Ke},J({target:"Object",stat:!0,forced:!0},{getOwnPropertyNames:R.f}))},je=internalMetadata.exports={enable:Ce,fastKey:Oe,getWeakData:De,onFreeze:Ae};return re[_e]=!0,internalMetadata.exports}var collection,hasRequiredCollection;function requireCollection(){if(hasRequiredCollection)return collection;hasRequiredCollection=1;var J=require_export(),Y=requireGlobalThis(),re=requireFunctionUncurryThis(),ae=requireIsForced(),ne=requireDefineBuiltIn(),ce=requireInternalMetadata(),ee=requireIterate(),R=requireAnInstance(),U=requireIsCallable(),K=requireIsNullOrUndefined(),oe=requireIsObject$1(),pe=requireFails(),_e=requireCheckCorrectnessOfIteration(),me=requireSetToStringTag(),we=requireInheritIfRequired();return collection=function(Oe,De,Ae){var Ce=Oe.indexOf("Map")!==-1,je=Oe.indexOf("Weak")!==-1,ke=Ce?"set":"add",Be=Y[Oe],We=Be&&Be.prototype,Je=Be,Ke={},et=function(Ft){var ht=re(We[Ft]);ne(We,Ft,Ft==="add"?function(ut){return ht(this,ut===0?0:ut),this}:Ft==="delete"?function(St){return je&&!oe(St)?!1:ht(this,St===0?0:St)}:Ft==="get"?function(ut){return je&&!oe(ut)?void 0:ht(this,ut===0?0:ut)}:Ft==="has"?function(ut){return je&&!oe(ut)?!1:ht(this,ut===0?0:ut)}:function(ut,Et){return ht(this,ut===0?0:ut,Et),this})},it=ae(Oe,!U(Be)||!(je||We.forEach&&!pe(function(){new Be().entries().next()})));if(it)Je=Ae.getConstructor(De,Oe,Ce,ke),ce.enable();else if(ae(Oe,!0)){var nt=new Je,ct=nt[ke](je?{}:-0,1)!==nt,ft=pe(function(){nt.has(1)}),_t=_e(function(Ft){new Be(Ft)}),Rt=!je&&pe(function(){for(var Ft=new Be,ht=5;ht--;)Ft[ke](ht,ht);return!Ft.has(-0)});_t||(Je=De(function(Ft,ht){R(Ft,We);var St=we(new Be,Ft,Je);return K(ht)||ee(ht,St[ke],{that:St,AS_ENTRIES:Ce}),St}),Je.prototype=We,We.constructor=Je),(ft||Rt)&&(et("delete"),et("has"),Ce&&et("get")),(Rt||ct)&&et(ke),je&&We.clear&&delete We.clear}return Ke[Oe]=Je,J({global:!0,constructor:!0,forced:Je!==Be},Ke),me(Je,Oe),je||Ae.setStrong(Je,Oe,Ce),Je},collection}var collectionStrong,hasRequiredCollectionStrong;function requireCollectionStrong(){if(hasRequiredCollectionStrong)return collectionStrong;hasRequiredCollectionStrong=1;var J=requireObjectCreate(),Y=requireDefineBuiltInAccessor(),re=requireDefineBuiltIns(),ae=requireFunctionBindContext(),ne=requireAnInstance(),ce=requireIsNullOrUndefined(),ee=requireIterate(),R=requireIteratorDefine(),U=requireCreateIterResultObject(),K=requireSetSpecies(),oe=requireDescriptors(),pe=requireInternalMetadata().fastKey,_e=requireInternalState(),me=_e.set,we=_e.getterFor;return collectionStrong={getConstructor:function(Oe,De,Ae,Ce){var je=Oe(function(Ke,et){ne(Ke,ke),me(Ke,{type:De,index:J(null),first:null,last:null,size:0}),oe||(Ke.size=0),ce(et)||ee(et,Ke[Ce],{that:Ke,AS_ENTRIES:Ae})}),ke=je.prototype,Be=we(De),We=function(Ke,et,it){var nt=Be(Ke),ct=Je(Ke,et),ft,_t;return ct?ct.value=it:(nt.last=ct={index:_t=pe(et,!0),key:et,value:it,previous:ft=nt.last,next:null,removed:!1},nt.first||(nt.first=ct),ft&&(ft.next=ct),oe?nt.size++:Ke.size++,_t!=="F"&&(nt.index[_t]=ct)),Ke},Je=function(Ke,et){var it=Be(Ke),nt=pe(et),ct;if(nt!=="F")return it.index[nt];for(ct=it.first;ct;ct=ct.next)if(ct.key===et)return ct};return re(ke,{clear:function(){for(var et=this,it=Be(et),nt=it.first;nt;)nt.removed=!0,nt.previous&&(nt.previous=nt.previous.next=null),nt=nt.next;it.first=it.last=null,it.index=J(null),oe?it.size=0:et.size=0},delete:function(Ke){var et=this,it=Be(et),nt=Je(et,Ke);if(nt){var ct=nt.next,ft=nt.previous;delete it.index[nt.index],nt.removed=!0,ft&&(ft.next=ct),ct&&(ct.previous=ft),it.first===nt&&(it.first=ct),it.last===nt&&(it.last=ft),oe?it.size--:et.size--}return!!nt},forEach:function(et){for(var it=Be(this),nt=ae(et,arguments.length>1?arguments[1]:void 0),ct;ct=ct?ct.next:it.first;)for(nt(ct.value,ct.key,this);ct&&ct.removed;)ct=ct.previous},has:function(et){return!!Je(this,et)}}),re(ke,Ae?{get:function(et){var it=Je(this,et);return it&&it.value},set:function(et,it){return We(this,et===0?0:et,it)}}:{add:function(et){return We(this,et=et===0?0:et,et)}}),oe&&Y(ke,"size",{configurable:!0,get:function(){return Be(this).size}}),je},setStrong:function(Oe,De,Ae){var Ce=De+" Iterator",je=we(De),ke=we(Ce);R(Oe,De,function(Be,We){me(this,{type:Ce,target:Be,state:je(Be),kind:We,last:null})},function(){for(var Be=ke(this),We=Be.kind,Je=Be.last;Je&&Je.removed;)Je=Je.previous;return!Be.target||!(Be.last=Je=Je?Je.next:Be.state.first)?(Be.target=null,U(void 0,!0)):U(We==="keys"?Je.key:We==="values"?Je.value:[Je.key,Je.value],!1)},Ae?"entries":"values",!Ae,!0),K(De)}},collectionStrong}var hasRequiredEs_map_constructor;function requireEs_map_constructor(){if(hasRequiredEs_map_constructor)return es_map_constructor;hasRequiredEs_map_constructor=1;var J=requireCollection(),Y=requireCollectionStrong();return J("Map",function(re){return function(){return re(this,arguments.length?arguments[0]:void 0)}},Y),es_map_constructor}var hasRequiredEs_map;function requireEs_map(){return hasRequiredEs_map||(hasRequiredEs_map=1,requireEs_map_constructor()),es_map}var es_map_groupBy={},mapHelpers,hasRequiredMapHelpers;function requireMapHelpers(){if(hasRequiredMapHelpers)return mapHelpers;hasRequiredMapHelpers=1;var J=requireFunctionUncurryThis(),Y=Map.prototype;return mapHelpers={Map,set:J(Y.set),get:J(Y.get),has:J(Y.has),remove:J(Y.delete),proto:Y},mapHelpers}var hasRequiredEs_map_groupBy;function requireEs_map_groupBy(){if(hasRequiredEs_map_groupBy)return es_map_groupBy;hasRequiredEs_map_groupBy=1;var J=require_export(),Y=requireFunctionUncurryThis(),re=requireACallable(),ae=requireRequireObjectCoercible(),ne=requireIterate(),ce=requireMapHelpers(),ee=requireIsPure(),R=requireFails(),U=ce.Map,K=ce.has,oe=ce.get,pe=ce.set,_e=Y([].push),me=ee||R(function(){return U.groupBy("ab",function(we){return we}).get("a").length!==1});return J({target:"Map",stat:!0,forced:ee||me},{groupBy:function(Oe,De){ae(Oe),re(De);var Ae=new U,Ce=0;return ne(Oe,function(je){var ke=De(je,Ce++);K(Ae,ke)?_e(oe(Ae,ke),je):pe(Ae,ke,[je])}),Ae}}),es_map_groupBy}var es_math_acosh={},mathLog1p,hasRequiredMathLog1p;function requireMathLog1p(){if(hasRequiredMathLog1p)return mathLog1p;hasRequiredMathLog1p=1;var J=Math.log;return mathLog1p=Math.log1p||function(re){var ae=+re;return ae>-1e-8&&ae<1e-8?ae-ae*ae/2:J(1+ae)},mathLog1p}var hasRequiredEs_math_acosh;function requireEs_math_acosh(){if(hasRequiredEs_math_acosh)return es_math_acosh;hasRequiredEs_math_acosh=1;var J=require_export(),Y=requireMathLog1p(),re=Math.acosh,ae=Math.log,ne=Math.sqrt,ce=Math.LN2,ee=!re||Math.floor(re(Number.MAX_VALUE))!==710||re(1/0)!==1/0;return J({target:"Math",stat:!0,forced:ee},{acosh:function(U){var K=+U;return K<1?NaN:K>9490626562425156e-8?ae(K)+ce:Y(K-1+ne(K-1)*ne(K+1))}}),es_math_acosh}var es_math_asinh={},hasRequiredEs_math_asinh;function requireEs_math_asinh(){if(hasRequiredEs_math_asinh)return es_math_asinh;hasRequiredEs_math_asinh=1;var J=require_export(),Y=Math.asinh,re=Math.log,ae=Math.sqrt;function ne(ee){var R=+ee;return!isFinite(R)||R===0?R:R<0?-ne(-R):re(R+ae(R*R+1))}var ce=!(Y&&1/Y(0)>0);return J({target:"Math",stat:!0,forced:ce},{asinh:ne}),es_math_asinh}var es_math_atanh={},hasRequiredEs_math_atanh;function requireEs_math_atanh(){if(hasRequiredEs_math_atanh)return es_math_atanh;hasRequiredEs_math_atanh=1;var J=require_export(),Y=Math.atanh,re=Math.log,ae=!(Y&&1/Y(-0)<0);return J({target:"Math",stat:!0,forced:ae},{atanh:function(ce){var ee=+ce;return ee===0?ee:re((1+ee)/(1-ee))/2}}),es_math_atanh}var es_math_cbrt={},hasRequiredEs_math_cbrt;function requireEs_math_cbrt(){if(hasRequiredEs_math_cbrt)return es_math_cbrt;hasRequiredEs_math_cbrt=1;var J=require_export(),Y=requireMathSign(),re=Math.abs,ae=Math.pow;return J({target:"Math",stat:!0},{cbrt:function(ce){var ee=+ce;return Y(ee)*ae(re(ee),1/3)}}),es_math_cbrt}var es_math_clz32={},hasRequiredEs_math_clz32;function requireEs_math_clz32(){if(hasRequiredEs_math_clz32)return es_math_clz32;hasRequiredEs_math_clz32=1;var J=require_export(),Y=Math.floor,re=Math.log,ae=Math.LOG2E;return J({target:"Math",stat:!0},{clz32:function(ce){var ee=ce>>>0;return ee?31-Y(re(ee+.5)*ae):32}}),es_math_clz32}var es_math_cosh={},mathExpm1,hasRequiredMathExpm1;function requireMathExpm1(){if(hasRequiredMathExpm1)return mathExpm1;hasRequiredMathExpm1=1;var J=Math.expm1,Y=Math.exp;return mathExpm1=!J||J(10)>22025.465794806718||J(10)<22025.465794806718||J(-2e-17)!==-2e-17?function(ae){var ne=+ae;return ne===0?ne:ne>-1e-6&&ne<1e-6?ne+ne*ne/2:Y(ne)-1}:J,mathExpm1}var hasRequiredEs_math_cosh;function requireEs_math_cosh(){if(hasRequiredEs_math_cosh)return es_math_cosh;hasRequiredEs_math_cosh=1;var J=require_export(),Y=requireMathExpm1(),re=Math.cosh,ae=Math.abs,ne=Math.E,ce=!re||re(710)===1/0;return J({target:"Math",stat:!0,forced:ce},{cosh:function(R){var U=Y(ae(R)-1)+1;return(U+1/(U*ne*ne))*(ne/2)}}),es_math_cosh}var es_math_expm1={},hasRequiredEs_math_expm1;function requireEs_math_expm1(){if(hasRequiredEs_math_expm1)return es_math_expm1;hasRequiredEs_math_expm1=1;var J=require_export(),Y=requireMathExpm1();return J({target:"Math",stat:!0,forced:Y!==Math.expm1},{expm1:Y}),es_math_expm1}var es_math_fround={},hasRequiredEs_math_fround;function requireEs_math_fround(){if(hasRequiredEs_math_fround)return es_math_fround;hasRequiredEs_math_fround=1;var J=require_export(),Y=requireMathFround();return J({target:"Math",stat:!0},{fround:Y}),es_math_fround}var es_math_f16round={},hasRequiredEs_math_f16round;function requireEs_math_f16round(){if(hasRequiredEs_math_f16round)return es_math_f16round;hasRequiredEs_math_f16round=1;var J=require_export(),Y=requireMathFloatRound(),re=.0009765625,ae=65504,ne=6103515625e-14;return J({target:"Math",stat:!0},{f16round:function(ee){return Y(ee,re,ae,ne)}}),es_math_f16round}var es_math_hypot={},hasRequiredEs_math_hypot;function requireEs_math_hypot(){if(hasRequiredEs_math_hypot)return es_math_hypot;hasRequiredEs_math_hypot=1;var J=require_export(),Y=Math.hypot,re=Math.abs,ae=Math.sqrt,ne=!!Y&&Y(1/0,NaN)!==1/0;return J({target:"Math",stat:!0,arity:2,forced:ne},{hypot:function(ee,R){for(var U=0,K=0,oe=arguments.length,pe=0,_e,me;K<oe;)_e=re(arguments[K++]),pe<_e?(me=pe/_e,U=U*me*me+1,pe=_e):_e>0?(me=_e/pe,U+=me*me):U+=_e;return pe===1/0?1/0:pe*ae(U)}}),es_math_hypot}var es_math_imul={},hasRequiredEs_math_imul;function requireEs_math_imul(){if(hasRequiredEs_math_imul)return es_math_imul;hasRequiredEs_math_imul=1;var J=require_export(),Y=requireFails(),re=Math.imul,ae=Y(function(){return re(4294967295,5)!==-5||re.length!==2});return J({target:"Math",stat:!0,forced:ae},{imul:function(ce,ee){var R=65535,U=+ce,K=+ee,oe=R&U,pe=R&K;return 0|oe*pe+((R&U>>>16)*pe+oe*(R&K>>>16)<<16>>>0)}}),es_math_imul}var es_math_log10={},mathLog10,hasRequiredMathLog10;function requireMathLog10(){if(hasRequiredMathLog10)return mathLog10;hasRequiredMathLog10=1;var J=Math.log,Y=Math.LOG10E;return mathLog10=Math.log10||function(ae){return J(ae)*Y},mathLog10}var hasRequiredEs_math_log10;function requireEs_math_log10(){if(hasRequiredEs_math_log10)return es_math_log10;hasRequiredEs_math_log10=1;var J=require_export(),Y=requireMathLog10();return J({target:"Math",stat:!0},{log10:Y}),es_math_log10}var es_math_log1p={},hasRequiredEs_math_log1p;function requireEs_math_log1p(){if(hasRequiredEs_math_log1p)return es_math_log1p;hasRequiredEs_math_log1p=1;var J=require_export(),Y=requireMathLog1p();return J({target:"Math",stat:!0},{log1p:Y}),es_math_log1p}var es_math_log2={},hasRequiredEs_math_log2;function requireEs_math_log2(){if(hasRequiredEs_math_log2)return es_math_log2;hasRequiredEs_math_log2=1;var J=require_export(),Y=requireMathLog2();return J({target:"Math",stat:!0},{log2:Y}),es_math_log2}var es_math_sign={},hasRequiredEs_math_sign;function requireEs_math_sign(){if(hasRequiredEs_math_sign)return es_math_sign;hasRequiredEs_math_sign=1;var J=require_export(),Y=requireMathSign();return J({target:"Math",stat:!0},{sign:Y}),es_math_sign}var es_math_sinh={},hasRequiredEs_math_sinh;function requireEs_math_sinh(){if(hasRequiredEs_math_sinh)return es_math_sinh;hasRequiredEs_math_sinh=1;var J=require_export(),Y=requireFails(),re=requireMathExpm1(),ae=Math.abs,ne=Math.exp,ce=Math.E,ee=Y(function(){return Math.sinh(-2e-17)!==-2e-17});return J({target:"Math",stat:!0,forced:ee},{sinh:function(U){var K=+U;return ae(K)<1?(re(K)-re(-K))/2:(ne(K-1)-ne(-K-1))*(ce/2)}}),es_math_sinh}var es_math_sumPrecise={},hasRequiredEs_math_sumPrecise;function requireEs_math_sumPrecise(){if(hasRequiredEs_math_sumPrecise)return es_math_sumPrecise;hasRequiredEs_math_sumPrecise=1;var J=require_export(),Y=requireFunctionUncurryThis(),re=requireIterate(),ae=RangeError,ne=TypeError,ce=1/0,ee=NaN,R=Math.abs,U=Math.pow,K=Y([].push),oe=U(2,1023),pe=U(2,53)-1,_e=Number.MAX_VALUE,me=U(2,971),we={},Oe={},De={},Ae={},Ce={},je=function(ke,Be){var We=ke+Be,Je=Be-(We-ke);return{hi:We,lo:Je}};return J({target:"Math",stat:!0},{sumPrecise:function(Be){var We=[],Je=0,Ke=Ae;switch(re(Be,function(Ut){if(++Je>=pe)throw new ae("Maximum allowed index exceeded");if(typeof Ut!="number")throw new ne("Value is not a number");Ke!==we&&(Ut!==Ut?Ke=we:Ut===ce?Ke=Ke===Oe?we:De:Ut===-ce?Ke=Ke===De?we:Oe:(Ut!==0||1/Ut===ce)&&(Ke===Ae||Ke===Ce)&&(Ke=Ce,K(We,Ut)))}),Ke){case we:return ee;case Oe:return-ce;case De:return ce;case Ae:return-0}for(var et=[],it=0,nt,ct,ft,_t,Rt,Ft,ht=0;ht<We.length;ht++){nt=We[ht];for(var St=0,ut=0;ut<et.length;ut++){if(ct=et[ut],R(nt)<R(ct)&&(Ft=nt,nt=ct,ct=Ft),ft=je(nt,ct),_t=ft.hi,Rt=ft.lo,R(_t)===ce){var Et=_t===ce?1:-1;it+=Et,nt=nt-Et*oe-Et*oe,R(nt)<R(ct)&&(Ft=nt,nt=ct,ct=Ft),ft=je(nt,ct),_t=ft.hi,Rt=ft.lo}Rt!==0&&(et[St++]=Rt),nt=_t}et.length=St,nt!==0&&K(et,nt)}var bt=et.length-1;if(_t=0,Rt=0,it!==0){var Dt=bt>=0?et[bt]:0;if(bt--,R(it)>1||it>0&&Dt>0||it<0&&Dt<0)return it>0?ce:-ce;if(ft=je(it*oe,Dt/2),_t=ft.hi,Rt=ft.lo,Rt*=2,R(2*_t)===ce)return _t>0?_t===oe&&Rt===-(me/2)&&bt>=0&&et[bt]<0?_e:ce:_t===-oe&&Rt===me/2&&bt>=0&&et[bt]>0?-_e:-ce;Rt!==0&&(et[++bt]=Rt,Rt=0),_t*=2}for(;bt>=0&&(ft=je(_t,et[bt--]),_t=ft.hi,Rt=ft.lo,Rt===0););return bt>=0&&(Rt<0&&et[bt]<0||Rt>0&&et[bt]>0)&&(ct=Rt*2,nt=_t+ct,ct===nt-_t&&(_t=nt)),_t}}),es_math_sumPrecise}var es_math_tanh={},hasRequiredEs_math_tanh;function requireEs_math_tanh(){if(hasRequiredEs_math_tanh)return es_math_tanh;hasRequiredEs_math_tanh=1;var J=require_export(),Y=requireMathExpm1(),re=Math.exp;return J({target:"Math",stat:!0},{tanh:function(ne){var ce=+ne,ee=Y(ce),R=Y(-ce);return ee===1/0?1:R===1/0?-1:(ee-R)/(re(ce)+re(-ce))}}),es_math_tanh}var es_math_toStringTag={},hasRequiredEs_math_toStringTag;function requireEs_math_toStringTag(){if(hasRequiredEs_math_toStringTag)return es_math_toStringTag;hasRequiredEs_math_toStringTag=1;var J=requireSetToStringTag();return J(Math,"Math",!0),es_math_toStringTag}var es_math_trunc={},hasRequiredEs_math_trunc;function requireEs_math_trunc(){if(hasRequiredEs_math_trunc)return es_math_trunc;hasRequiredEs_math_trunc=1;var J=require_export(),Y=requireMathTrunc();return J({target:"Math",stat:!0},{trunc:Y}),es_math_trunc}var es_number_constructor={},thisNumberValue,hasRequiredThisNumberValue;function requireThisNumberValue(){if(hasRequiredThisNumberValue)return thisNumberValue;hasRequiredThisNumberValue=1;var J=requireFunctionUncurryThis();return thisNumberValue=J(1.1.valueOf),thisNumberValue}var whitespaces,hasRequiredWhitespaces;function requireWhitespaces(){return hasRequiredWhitespaces||(hasRequiredWhitespaces=1,whitespaces=`	
\v\f\r Â áââââââââââââ¯âã\u2028\u2029\uFEFF`),whitespaces}var stringTrim,hasRequiredStringTrim;function requireStringTrim(){if(hasRequiredStringTrim)return stringTrim;hasRequiredStringTrim=1;var J=requireFunctionUncurryThis(),Y=requireRequireObjectCoercible(),re=requireToString$1(),ae=requireWhitespaces(),ne=J("".replace),ce=RegExp("^["+ae+"]+"),ee=RegExp("(^|[^"+ae+"])["+ae+"]+$"),R=function(U){return function(K){var oe=re(Y(K));return U&1&&(oe=ne(oe,ce,"")),U&2&&(oe=ne(oe,ee,"$1")),oe}};return stringTrim={start:R(1),end:R(2),trim:R(3)},stringTrim}var hasRequiredEs_number_constructor;function requireEs_number_constructor(){if(hasRequiredEs_number_constructor)return es_number_constructor;hasRequiredEs_number_constructor=1;var J=require_export(),Y=requireIsPure(),re=requireDescriptors(),ae=requireGlobalThis(),ne=requirePath(),ce=requireFunctionUncurryThis(),ee=requireIsForced(),R=requireHasOwnProperty(),U=requireInheritIfRequired(),K=requireObjectIsPrototypeOf(),oe=requireIsSymbol$1(),pe=requireToPrimitive(),_e=requireFails(),me=requireObjectGetOwnPropertyNames().f,we=requireObjectGetOwnPropertyDescriptor().f,Oe=requireObjectDefineProperty().f,De=requireThisNumberValue(),Ae=requireStringTrim().trim,Ce="Number",je=ae[Ce],ke=ne[Ce],Be=je.prototype,We=ae.TypeError,Je=ce("".slice),Ke=ce("".charCodeAt),et=function(Rt){var Ft=pe(Rt,"number");return typeof Ft=="bigint"?Ft:it(Ft)},it=function(Rt){var Ft=pe(Rt,"number"),ht,St,ut,Et,bt,Dt,Ut,er;if(oe(Ft))throw new We("Cannot convert a Symbol value to a number");if(typeof Ft=="string"&&Ft.length>2){if(Ft=Ae(Ft),ht=Ke(Ft,0),ht===43||ht===45){if(St=Ke(Ft,2),St===88||St===120)return NaN}else if(ht===48){switch(Ke(Ft,1)){case 66:case 98:ut=2,Et=49;break;case 79:case 111:ut=8,Et=55;break;default:return+Ft}for(bt=Je(Ft,2),Dt=bt.length,Ut=0;Ut<Dt;Ut++)if(er=Ke(bt,Ut),er<48||er>Et)return NaN;return parseInt(bt,ut)}}return+Ft},nt=ee(Ce,!je(" 0o1")||!je("0b1")||je("+0x1")),ct=function(Rt){return K(Be,Rt)&&_e(function(){De(Rt)})},ft=function(Ft){var ht=arguments.length<1?0:je(et(Ft));return ct(this)?U(Object(ht),this,ft):ht};ft.prototype=Be,nt&&!Y&&(Be.constructor=ft),J({global:!0,constructor:!0,wrap:!0,forced:nt},{Number:ft});var _t=function(Rt,Ft){for(var ht=re?me(Ft):"MAX_VALUE,MIN_VALUE,NaN,NEGATIVE_INFINITY,POSITIVE_INFINITY,EPSILON,MAX_SAFE_INTEGER,MIN_SAFE_INTEGER,isFinite,isInteger,isNaN,isSafeInteger,parseFloat,parseInt,fromString,range".split(","),St=0,ut;ht.length>St;St++)R(Ft,ut=ht[St])&&!R(Rt,ut)&&Oe(Rt,ut,we(Ft,ut))};return Y&&ke&&_t(ne[Ce],ke),(nt||Y)&&_t(ne[Ce],je),es_number_constructor}var es_number_epsilon={},hasRequiredEs_number_epsilon;function requireEs_number_epsilon(){if(hasRequiredEs_number_epsilon)return es_number_epsilon;hasRequiredEs_number_epsilon=1;var J=require_export();return J({target:"Number",stat:!0,nonConfigurable:!0,nonWritable:!0},{EPSILON:Math.pow(2,-52)}),es_number_epsilon}var es_number_isFinite={},numberIsFinite,hasRequiredNumberIsFinite;function requireNumberIsFinite(){if(hasRequiredNumberIsFinite)return numberIsFinite;hasRequiredNumberIsFinite=1;var J=requireGlobalThis(),Y=J.isFinite;return numberIsFinite=Number.isFinite||function(ae){return typeof ae=="number"&&Y(ae)},numberIsFinite}var hasRequiredEs_number_isFinite;function requireEs_number_isFinite(){if(hasRequiredEs_number_isFinite)return es_number_isFinite;hasRequiredEs_number_isFinite=1;var J=require_export(),Y=requireNumberIsFinite();return J({target:"Number",stat:!0},{isFinite:Y}),es_number_isFinite}var es_number_isInteger={},isIntegralNumber,hasRequiredIsIntegralNumber;function requireIsIntegralNumber(){if(hasRequiredIsIntegralNumber)return isIntegralNumber;hasRequiredIsIntegralNumber=1;var J=requireIsObject$1(),Y=Math.floor;return isIntegralNumber=Number.isInteger||function(ae){return!J(ae)&&isFinite(ae)&&Y(ae)===ae},isIntegralNumber}var hasRequiredEs_number_isInteger;function requireEs_number_isInteger(){if(hasRequiredEs_number_isInteger)return es_number_isInteger;hasRequiredEs_number_isInteger=1;var J=require_export(),Y=requireIsIntegralNumber();return J({target:"Number",stat:!0},{isInteger:Y}),es_number_isInteger}var es_number_isNan={},hasRequiredEs_number_isNan;function requireEs_number_isNan(){if(hasRequiredEs_number_isNan)return es_number_isNan;hasRequiredEs_number_isNan=1;var J=require_export();return J({target:"Number",stat:!0},{isNaN:function(re){return re!==re}}),es_number_isNan}var es_number_isSafeInteger={},hasRequiredEs_number_isSafeInteger;function requireEs_number_isSafeInteger(){if(hasRequiredEs_number_isSafeInteger)return es_number_isSafeInteger;hasRequiredEs_number_isSafeInteger=1;var J=require_export(),Y=requireIsIntegralNumber(),re=Math.abs;return J({target:"Number",stat:!0},{isSafeInteger:function(ne){return Y(ne)&&re(ne)<=9007199254740991}}),es_number_isSafeInteger}var es_number_maxSafeInteger={},hasRequiredEs_number_maxSafeInteger;function requireEs_number_maxSafeInteger(){if(hasRequiredEs_number_maxSafeInteger)return es_number_maxSafeInteger;hasRequiredEs_number_maxSafeInteger=1;var J=require_export();return J({target:"Number",stat:!0,nonConfigurable:!0,nonWritable:!0},{MAX_SAFE_INTEGER:9007199254740991}),es_number_maxSafeInteger}var es_number_minSafeInteger={},hasRequiredEs_number_minSafeInteger;function requireEs_number_minSafeInteger(){if(hasRequiredEs_number_minSafeInteger)return es_number_minSafeInteger;hasRequiredEs_number_minSafeInteger=1;var J=require_export();return J({target:"Number",stat:!0,nonConfigurable:!0,nonWritable:!0},{MIN_SAFE_INTEGER:-9007199254740991}),es_number_minSafeInteger}var es_number_parseFloat={},numberParseFloat,hasRequiredNumberParseFloat;function requireNumberParseFloat(){if(hasRequiredNumberParseFloat)return numberParseFloat;hasRequiredNumberParseFloat=1;var J=requireGlobalThis(),Y=requireFails(),re=requireFunctionUncurryThis(),ae=requireToString$1(),ne=requireStringTrim().trim,ce=requireWhitespaces(),ee=re("".charAt),R=J.parseFloat,U=J.Symbol,K=U&&U.iterator,oe=1/R(ce+"-0")!==-1/0||K&&!Y(function(){R(Object(K))});return numberParseFloat=oe?function(_e){var me=ne(ae(_e)),we=R(me);return we===0&&ee(me,0)==="-"?-0:we}:R,numberParseFloat}var hasRequiredEs_number_parseFloat;function requireEs_number_parseFloat(){if(hasRequiredEs_number_parseFloat)return es_number_parseFloat;hasRequiredEs_number_parseFloat=1;var J=require_export(),Y=requireNumberParseFloat();return J({target:"Number",stat:!0,forced:Number.parseFloat!==Y},{parseFloat:Y}),es_number_parseFloat}var es_number_parseInt={},numberParseInt,hasRequiredNumberParseInt;function requireNumberParseInt(){if(hasRequiredNumberParseInt)return numberParseInt;hasRequiredNumberParseInt=1;var J=requireGlobalThis(),Y=requireFails(),re=requireFunctionUncurryThis(),ae=requireToString$1(),ne=requireStringTrim().trim,ce=requireWhitespaces(),ee=J.parseInt,R=J.Symbol,U=R&&R.iterator,K=/^[+-]?0x/i,oe=re(K.exec),pe=ee(ce+"08")!==8||ee(ce+"0x16")!==22||U&&!Y(function(){ee(Object(U))});return numberParseInt=pe?function(me,we){var Oe=ne(ae(me));return ee(Oe,we>>>0||(oe(K,Oe)?16:10))}:ee,numberParseInt}var hasRequiredEs_number_parseInt;function requireEs_number_parseInt(){if(hasRequiredEs_number_parseInt)return es_number_parseInt;hasRequiredEs_number_parseInt=1;var J=require_export(),Y=requireNumberParseInt();return J({target:"Number",stat:!0,forced:Number.parseInt!==Y},{parseInt:Y}),es_number_parseInt}var es_number_toExponential={},hasRequiredEs_number_toExponential;function requireEs_number_toExponential(){if(hasRequiredEs_number_toExponential)return es_number_toExponential;hasRequiredEs_number_toExponential=1;var J=require_export(),Y=requireFunctionUncurryThis(),re=requireToIntegerOrInfinity(),ae=requireThisNumberValue(),ne=requireStringRepeat(),ce=requireMathLog10(),ee=requireFails(),R=RangeError,U=String,K=isFinite,oe=Math.abs,pe=Math.floor,_e=Math.pow,me=Math.round,we=Y(1.1.toExponential),Oe=Y(ne),De=Y("".slice),Ae=we(-69e-12,4)==="-6.9000e-11"&&we(1.255,2)==="1.25e+0"&&we(12345,3)==="1.235e+4"&&we(25,0)==="3e+1",Ce=function(){return ee(function(){we(1,1/0)})&&ee(function(){we(1,-1/0)})},je=function(){return!ee(function(){we(1/0,1/0),we(NaN,1/0)})},ke=!Ae||!Ce()||!je();return J({target:"Number",proto:!0,forced:ke},{toExponential:function(We){var Je=ae(this);if(We===void 0)return we(Je);var Ke=re(We);if(!K(Je))return String(Je);if(Ke<0||Ke>20)throw new R("Incorrect fraction digits");if(Ae)return we(Je,Ke);var et="",it,nt,ct,ft;if(Je<0&&(et="-",Je=-Je),Je===0)nt=0,it=Oe("0",Ke+1);else{var _t=ce(Je);nt=pe(_t);var Rt=_e(10,nt-Ke),Ft=me(Je/Rt);2*Je>=(2*Ft+1)*Rt&&(Ft+=1),Ft>=_e(10,Ke+1)&&(Ft/=10,nt+=1),it=U(Ft)}return Ke!==0&&(it=De(it,0,1)+"."+De(it,1)),nt===0?(ct="+",ft="0"):(ct=nt>0?"+":"-",ft=U(oe(nt))),it+="e"+ct+ft,et+it}}),es_number_toExponential}var es_number_toFixed={},hasRequiredEs_number_toFixed;function requireEs_number_toFixed(){if(hasRequiredEs_number_toFixed)return es_number_toFixed;hasRequiredEs_number_toFixed=1;var J=require_export(),Y=requireFunctionUncurryThis(),re=requireToIntegerOrInfinity(),ae=requireThisNumberValue(),ne=requireStringRepeat(),ce=requireFails(),ee=RangeError,R=String,U=Math.floor,K=Y(ne),oe=Y("".slice),pe=Y(1.1.toFixed),_e=function(Ce,je,ke){return je===0?ke:je%2===1?_e(Ce,je-1,ke*Ce):_e(Ce*Ce,je/2,ke)},me=function(Ce){for(var je=0,ke=Ce;ke>=4096;)je+=12,ke/=4096;for(;ke>=2;)je+=1,ke/=2;return je},we=function(Ce,je,ke){for(var Be=-1,We=ke;++Be<6;)We+=je*Ce[Be],Ce[Be]=We%1e7,We=U(We/1e7)},Oe=function(Ce,je){for(var ke=6,Be=0;--ke>=0;)Be+=Ce[ke],Ce[ke]=U(Be/je),Be=Be%je*1e7},De=function(Ce){for(var je=6,ke="";--je>=0;)if(ke!==""||je===0||Ce[je]!==0){var Be=R(Ce[je]);ke=ke===""?Be:ke+K("0",7-Be.length)+Be}return ke},Ae=ce(function(){return pe(8e-5,3)!=="0.000"||pe(.9,0)!=="1"||pe(1.255,2)!=="1.25"||pe(0xde0b6b3a7640080,0)!=="1000000000000000128"})||!ce(function(){pe({})});return J({target:"Number",proto:!0,forced:Ae},{toFixed:function(je){var ke=ae(this),Be=re(je),We=[0,0,0,0,0,0],Je="",Ke="0",et,it,nt,ct;if(Be<0||Be>20)throw new ee("Incorrect fraction digits");if(ke!==ke)return"NaN";if(ke<=-1e21||ke>=1e21)return R(ke);if(ke<0&&(Je="-",ke=-ke),ke>1e-21)if(et=me(ke*_e(2,69,1))-69,it=et<0?ke*_e(2,-et,1):ke/_e(2,et,1),it*=4503599627370496,et=52-et,et>0){for(we(We,0,it),nt=Be;nt>=7;)we(We,1e7,0),nt-=7;for(we(We,_e(10,nt,1),0),nt=et-1;nt>=23;)Oe(We,1<<23),nt-=23;Oe(We,1<<nt),we(We,1,1),Oe(We,2),Ke=De(We)}else we(We,0,it),we(We,1<<-et,0),Ke=De(We)+K("0",Be);return Be>0?(ct=Ke.length,Ke=Je+(ct<=Be?"0."+K("0",Be-ct)+Ke:oe(Ke,0,ct-Be)+"."+oe(Ke,ct-Be))):Ke=Je+Ke,Ke}}),es_number_toFixed}var es_number_toPrecision={},hasRequiredEs_number_toPrecision;function requireEs_number_toPrecision(){if(hasRequiredEs_number_toPrecision)return es_number_toPrecision;hasRequiredEs_number_toPrecision=1;var J=require_export(),Y=requireFunctionUncurryThis(),re=requireFails(),ae=requireThisNumberValue(),ne=Y(1.1.toPrecision),ce=re(function(){return ne(1,void 0)!=="1"})||!re(function(){ne({})});return J({target:"Number",proto:!0,forced:ce},{toPrecision:function(R){return R===void 0?ne(ae(this)):ne(ae(this),R)}}),es_number_toPrecision}var es_object_assign={},objectAssign,hasRequiredObjectAssign;function requireObjectAssign(){if(hasRequiredObjectAssign)return objectAssign;hasRequiredObjectAssign=1;var J=requireDescriptors(),Y=requireFunctionUncurryThis(),re=requireFunctionCall(),ae=requireFails(),ne=requireObjectKeys(),ce=requireObjectGetOwnPropertySymbols(),ee=requireObjectPropertyIsEnumerable(),R=requireToObject(),U=requireIndexedObject(),K=Object.assign,oe=Object.defineProperty,pe=Y([].concat);return objectAssign=!K||ae(function(){if(J&&K({b:1},K(oe({},"a",{enumerable:!0,get:function(){oe(this,"b",{value:3,enumerable:!1})}}),{b:2})).b!==1)return!0;var _e={},me={},we=Symbol("assign detection"),Oe="abcdefghijklmnopqrst";return _e[we]=7,Oe.split("").forEach(function(De){me[De]=De}),K({},_e)[we]!==7||ne(K({},me)).join("")!==Oe})?function(me,we){for(var Oe=R(me),De=arguments.length,Ae=1,Ce=ce.f,je=ee.f;De>Ae;)for(var ke=U(arguments[Ae++]),Be=Ce?pe(ne(ke),Ce(ke)):ne(ke),We=Be.length,Je=0,Ke;We>Je;)Ke=Be[Je++],(!J||re(je,ke,Ke))&&(Oe[Ke]=ke[Ke]);return Oe}:K,objectAssign}var hasRequiredEs_object_assign;function requireEs_object_assign(){if(hasRequiredEs_object_assign)return es_object_assign;hasRequiredEs_object_assign=1;var J=require_export(),Y=requireObjectAssign();return J({target:"Object",stat:!0,arity:2,forced:Object.assign!==Y},{assign:Y}),es_object_assign}var es_object_create={},hasRequiredEs_object_create;function requireEs_object_create(){if(hasRequiredEs_object_create)return es_object_create;hasRequiredEs_object_create=1;var J=require_export(),Y=requireDescriptors(),re=requireObjectCreate();return J({target:"Object",stat:!0,sham:!Y},{create:re}),es_object_create}var es_object_defineGetter={},objectPrototypeAccessorsForced,hasRequiredObjectPrototypeAccessorsForced;function requireObjectPrototypeAccessorsForced(){if(hasRequiredObjectPrototypeAccessorsForced)return objectPrototypeAccessorsForced;hasRequiredObjectPrototypeAccessorsForced=1;var J=requireIsPure(),Y=requireGlobalThis(),re=requireFails(),ae=requireEnvironmentWebkitVersion();return objectPrototypeAccessorsForced=J||!re(function(){if(!(ae&&ae<535)){var ne=Math.random();__defineSetter__.call(null,ne,function(){}),delete Y[ne]}}),objectPrototypeAccessorsForced}var hasRequiredEs_object_defineGetter;function requireEs_object_defineGetter(){if(hasRequiredEs_object_defineGetter)return es_object_defineGetter;hasRequiredEs_object_defineGetter=1;var J=require_export(),Y=requireDescriptors(),re=requireObjectPrototypeAccessorsForced(),ae=requireACallable(),ne=requireToObject(),ce=requireObjectDefineProperty();return Y&&J({target:"Object",proto:!0,forced:re},{__defineGetter__:function(R,U){ce.f(ne(this),R,{get:ae(U),enumerable:!0,configurable:!0})}}),es_object_defineGetter}var es_object_defineProperties={},hasRequiredEs_object_defineProperties;function requireEs_object_defineProperties(){if(hasRequiredEs_object_defineProperties)return es_object_defineProperties;hasRequiredEs_object_defineProperties=1;var J=require_export(),Y=requireDescriptors(),re=requireObjectDefineProperties().f;return J({target:"Object",stat:!0,forced:Object.defineProperties!==re,sham:!Y},{defineProperties:re}),es_object_defineProperties}var es_object_defineProperty={},hasRequiredEs_object_defineProperty;function requireEs_object_defineProperty(){if(hasRequiredEs_object_defineProperty)return es_object_defineProperty;hasRequiredEs_object_defineProperty=1;var J=require_export(),Y=requireDescriptors(),re=requireObjectDefineProperty().f;return J({target:"Object",stat:!0,forced:Object.defineProperty!==re,sham:!Y},{defineProperty:re}),es_object_defineProperty}var es_object_defineSetter={},hasRequiredEs_object_defineSetter;function requireEs_object_defineSetter(){if(hasRequiredEs_object_defineSetter)return es_object_defineSetter;hasRequiredEs_object_defineSetter=1;var J=require_export(),Y=requireDescriptors(),re=requireObjectPrototypeAccessorsForced(),ae=requireACallable(),ne=requireToObject(),ce=requireObjectDefineProperty();return Y&&J({target:"Object",proto:!0,forced:re},{__defineSetter__:function(R,U){ce.f(ne(this),R,{set:ae(U),enumerable:!0,configurable:!0})}}),es_object_defineSetter}var es_object_entries={},objectToArray,hasRequiredObjectToArray;function requireObjectToArray(){if(hasRequiredObjectToArray)return objectToArray;hasRequiredObjectToArray=1;var J=requireDescriptors(),Y=requireFails(),re=requireFunctionUncurryThis(),ae=requireObjectGetPrototypeOf(),ne=requireObjectKeys(),ce=requireToIndexedObject(),ee=requireObjectPropertyIsEnumerable().f,R=re(ee),U=re([].push),K=J&&Y(function(){var pe=Object.create(null);return pe[2]=2,!R(pe,2)}),oe=function(pe){return function(_e){for(var me=ce(_e),we=ne(me),Oe=K&&ae(me)===null,De=we.length,Ae=0,Ce=[],je;De>Ae;)je=we[Ae++],(!J||(Oe?je in me:R(me,je)))&&U(Ce,pe?[je,me[je]]:me[je]);return Ce}};return objectToArray={entries:oe(!0),values:oe(!1)},objectToArray}var hasRequiredEs_object_entries;function requireEs_object_entries(){if(hasRequiredEs_object_entries)return es_object_entries;hasRequiredEs_object_entries=1;var J=require_export(),Y=requireObjectToArray().entries;return J({target:"Object",stat:!0},{entries:function(ae){return Y(ae)}}),es_object_entries}var es_object_freeze={},hasRequiredEs_object_freeze;function requireEs_object_freeze(){if(hasRequiredEs_object_freeze)return es_object_freeze;hasRequiredEs_object_freeze=1;var J=require_export(),Y=requireFreezing(),re=requireFails(),ae=requireIsObject$1(),ne=requireInternalMetadata().onFreeze,ce=Object.freeze,ee=re(function(){ce(1)});return J({target:"Object",stat:!0,forced:ee,sham:!Y},{freeze:function(U){return ce&&ae(U)?ce(ne(U)):U}}),es_object_freeze}var es_object_fromEntries={},hasRequiredEs_object_fromEntries;function requireEs_object_fromEntries(){if(hasRequiredEs_object_fromEntries)return es_object_fromEntries;hasRequiredEs_object_fromEntries=1;var J=require_export(),Y=requireIterate(),re=requireCreateProperty();return J({target:"Object",stat:!0},{fromEntries:function(ne){var ce={};return Y(ne,function(ee,R){re(ce,ee,R)},{AS_ENTRIES:!0}),ce}}),es_object_fromEntries}var es_object_getOwnPropertyDescriptor={},hasRequiredEs_object_getOwnPropertyDescriptor;function requireEs_object_getOwnPropertyDescriptor(){if(hasRequiredEs_object_getOwnPropertyDescriptor)return es_object_getOwnPropertyDescriptor;hasRequiredEs_object_getOwnPropertyDescriptor=1;var J=require_export(),Y=requireFails(),re=requireToIndexedObject(),ae=requireObjectGetOwnPropertyDescriptor().f,ne=requireDescriptors(),ce=!ne||Y(function(){ae(1)});return J({target:"Object",stat:!0,forced:ce,sham:!ne},{getOwnPropertyDescriptor:function(R,U){return ae(re(R),U)}}),es_object_getOwnPropertyDescriptor}var es_object_getOwnPropertyDescriptors={},hasRequiredEs_object_getOwnPropertyDescriptors;function requireEs_object_getOwnPropertyDescriptors(){if(hasRequiredEs_object_getOwnPropertyDescriptors)return es_object_getOwnPropertyDescriptors;hasRequiredEs_object_getOwnPropertyDescriptors=1;var J=require_export(),Y=requireDescriptors(),re=requireOwnKeys(),ae=requireToIndexedObject(),ne=requireObjectGetOwnPropertyDescriptor(),ce=requireCreateProperty();return J({target:"Object",stat:!0,sham:!Y},{getOwnPropertyDescriptors:function(R){for(var U=ae(R),K=ne.f,oe=re(U),pe={},_e=0,me,we;oe.length>_e;)we=K(U,me=oe[_e++]),we!==void 0&&ce(pe,me,we);return pe}}),es_object_getOwnPropertyDescriptors}var es_object_getOwnPropertyNames={},hasRequiredEs_object_getOwnPropertyNames;function requireEs_object_getOwnPropertyNames(){if(hasRequiredEs_object_getOwnPropertyNames)return es_object_getOwnPropertyNames;hasRequiredEs_object_getOwnPropertyNames=1;var J=require_export(),Y=requireFails(),re=requireObjectGetOwnPropertyNamesExternal().f,ae=Y(function(){return!Object.getOwnPropertyNames(1)});return J({target:"Object",stat:!0,forced:ae},{getOwnPropertyNames:re}),es_object_getOwnPropertyNames}var es_object_getPrototypeOf={},hasRequiredEs_object_getPrototypeOf;function requireEs_object_getPrototypeOf(){if(hasRequiredEs_object_getPrototypeOf)return es_object_getPrototypeOf;hasRequiredEs_object_getPrototypeOf=1;var J=require_export(),Y=requireFails(),re=requireToObject(),ae=requireObjectGetPrototypeOf(),ne=requireCorrectPrototypeGetter(),ce=Y(function(){ae(1)});return J({target:"Object",stat:!0,forced:ce,sham:!ne},{getPrototypeOf:function(R){return ae(re(R))}}),es_object_getPrototypeOf}var es_object_groupBy={},hasRequiredEs_object_groupBy;function requireEs_object_groupBy(){if(hasRequiredEs_object_groupBy)return es_object_groupBy;hasRequiredEs_object_groupBy=1;var J=require_export(),Y=requireCreateProperty(),re=requireGetBuiltIn(),ae=requireFunctionUncurryThis(),ne=requireACallable(),ce=requireRequireObjectCoercible(),ee=requireToPropertyKey(),R=requireIterate(),U=requireFails(),K=Object.groupBy,oe=re("Object","create"),pe=ae([].push),_e=!K||U(function(){return K("ab",function(me){return me}).a.length!==1});return J({target:"Object",stat:!0,forced:_e},{groupBy:function(we,Oe){ce(we),ne(Oe);var De=oe(null),Ae=0;return R(we,function(Ce){var je=ee(Oe(Ce,Ae++));je in De?pe(De[je],Ce):Y(De,je,[Ce])}),De}}),es_object_groupBy}var es_object_hasOwn={},hasRequiredEs_object_hasOwn;function requireEs_object_hasOwn(){if(hasRequiredEs_object_hasOwn)return es_object_hasOwn;hasRequiredEs_object_hasOwn=1;var J=require_export(),Y=requireHasOwnProperty();return J({target:"Object",stat:!0},{hasOwn:Y}),es_object_hasOwn}var es_object_is={},sameValue,hasRequiredSameValue;function requireSameValue(){return hasRequiredSameValue||(hasRequiredSameValue=1,sameValue=Object.is||function(Y,re){return Y===re?Y!==0||1/Y===1/re:Y!==Y&&re!==re}),sameValue}var hasRequiredEs_object_is;function requireEs_object_is(){if(hasRequiredEs_object_is)return es_object_is;hasRequiredEs_object_is=1;var J=require_export(),Y=requireSameValue();return J({target:"Object",stat:!0},{is:Y}),es_object_is}var es_object_isExtensible={},hasRequiredEs_object_isExtensible;function requireEs_object_isExtensible(){if(hasRequiredEs_object_isExtensible)return es_object_isExtensible;hasRequiredEs_object_isExtensible=1;var J=require_export(),Y=requireObjectIsExtensible();return J({target:"Object",stat:!0,forced:Object.isExtensible!==Y},{isExtensible:Y}),es_object_isExtensible}var es_object_isFrozen={},hasRequiredEs_object_isFrozen;function requireEs_object_isFrozen(){if(hasRequiredEs_object_isFrozen)return es_object_isFrozen;hasRequiredEs_object_isFrozen=1;var J=require_export(),Y=requireFails(),re=requireIsObject$1(),ae=requireClassofRaw(),ne=requireArrayBufferNonExtensible(),ce=Object.isFrozen,ee=ne||Y(function(){});return J({target:"Object",stat:!0,forced:ee},{isFrozen:function(U){return!re(U)||ne&&ae(U)==="ArrayBuffer"?!0:ce?ce(U):!1}}),es_object_isFrozen}var es_object_isSealed={},hasRequiredEs_object_isSealed;function requireEs_object_isSealed(){if(hasRequiredEs_object_isSealed)return es_object_isSealed;hasRequiredEs_object_isSealed=1;var J=require_export(),Y=requireFails(),re=requireIsObject$1(),ae=requireClassofRaw(),ne=requireArrayBufferNonExtensible(),ce=Object.isSealed,ee=ne||Y(function(){});return J({target:"Object",stat:!0,forced:ee},{isSealed:function(U){return!re(U)||ne&&ae(U)==="ArrayBuffer"?!0:ce?ce(U):!1}}),es_object_isSealed}var es_object_keys={},hasRequiredEs_object_keys;function requireEs_object_keys(){if(hasRequiredEs_object_keys)return es_object_keys;hasRequiredEs_object_keys=1;var J=require_export(),Y=requireToObject(),re=requireObjectKeys(),ae=requireFails(),ne=ae(function(){re(1)});return J({target:"Object",stat:!0,forced:ne},{keys:function(ee){return re(Y(ee))}}),es_object_keys}var es_object_lookupGetter={},hasRequiredEs_object_lookupGetter;function requireEs_object_lookupGetter(){if(hasRequiredEs_object_lookupGetter)return es_object_lookupGetter;hasRequiredEs_object_lookupGetter=1;var J=require_export(),Y=requireDescriptors(),re=requireObjectPrototypeAccessorsForced(),ae=requireToObject(),ne=requireToPropertyKey(),ce=requireObjectGetPrototypeOf(),ee=requireObjectGetOwnPropertyDescriptor().f;return Y&&J({target:"Object",proto:!0,forced:re},{__lookupGetter__:function(U){var K=ae(this),oe=ne(U),pe;do if(pe=ee(K,oe))return pe.get;while(K=ce(K))}}),es_object_lookupGetter}var es_object_lookupSetter={},hasRequiredEs_object_lookupSetter;function requireEs_object_lookupSetter(){if(hasRequiredEs_object_lookupSetter)return es_object_lookupSetter;hasRequiredEs_object_lookupSetter=1;var J=require_export(),Y=requireDescriptors(),re=requireObjectPrototypeAccessorsForced(),ae=requireToObject(),ne=requireToPropertyKey(),ce=requireObjectGetPrototypeOf(),ee=requireObjectGetOwnPropertyDescriptor().f;return Y&&J({target:"Object",proto:!0,forced:re},{__lookupSetter__:function(U){var K=ae(this),oe=ne(U),pe;do if(pe=ee(K,oe))return pe.set;while(K=ce(K))}}),es_object_lookupSetter}var es_object_preventExtensions={},hasRequiredEs_object_preventExtensions;function requireEs_object_preventExtensions(){if(hasRequiredEs_object_preventExtensions)return es_object_preventExtensions;hasRequiredEs_object_preventExtensions=1;var J=require_export(),Y=requireIsObject$1(),re=requireInternalMetadata().onFreeze,ae=requireFreezing(),ne=requireFails(),ce=Object.preventExtensions,ee=ne(function(){ce(1)});return J({target:"Object",stat:!0,forced:ee,sham:!ae},{preventExtensions:function(U){return ce&&Y(U)?ce(re(U)):U}}),es_object_preventExtensions}var es_object_proto={},hasRequiredEs_object_proto;function requireEs_object_proto(){if(hasRequiredEs_object_proto)return es_object_proto;hasRequiredEs_object_proto=1;var J=requireDescriptors(),Y=requireDefineBuiltInAccessor(),re=requireIsObject$1(),ae=requireIsPossiblePrototype(),ne=requireToObject(),ce=requireRequireObjectCoercible(),ee=Object.getPrototypeOf,R=Object.setPrototypeOf,U=Object.prototype,K="__proto__";if(J&&ee&&R&&!(K in U))try{Y(U,K,{configurable:!0,get:function(){return ee(ne(this))},set:function(pe){var _e=ce(this);ae(pe)&&re(_e)&&R(_e,pe)}})}catch{}return es_object_proto}var es_object_seal={},hasRequiredEs_object_seal;function requireEs_object_seal(){if(hasRequiredEs_object_seal)return es_object_seal;hasRequiredEs_object_seal=1;var J=require_export(),Y=requireIsObject$1(),re=requireInternalMetadata().onFreeze,ae=requireFreezing(),ne=requireFails(),ce=Object.seal,ee=ne(function(){ce(1)});return J({target:"Object",stat:!0,forced:ee,sham:!ae},{seal:function(U){return ce&&Y(U)?ce(re(U)):U}}),es_object_seal}var es_object_setPrototypeOf={},hasRequiredEs_object_setPrototypeOf;function requireEs_object_setPrototypeOf(){if(hasRequiredEs_object_setPrototypeOf)return es_object_setPrototypeOf;hasRequiredEs_object_setPrototypeOf=1;var J=require_export(),Y=requireObjectSetPrototypeOf();return J({target:"Object",stat:!0},{setPrototypeOf:Y}),es_object_setPrototypeOf}var es_object_toString={},objectToString,hasRequiredObjectToString;function requireObjectToString(){if(hasRequiredObjectToString)return objectToString;hasRequiredObjectToString=1;var J=requireToStringTagSupport(),Y=requireClassof();return objectToString=J?{}.toString:function(){return"[object "+Y(this)+"]"},objectToString}var hasRequiredEs_object_toString;function requireEs_object_toString(){if(hasRequiredEs_object_toString)return es_object_toString;hasRequiredEs_object_toString=1;var J=requireToStringTagSupport(),Y=requireDefineBuiltIn(),re=requireObjectToString();return J||Y(Object.prototype,"toString",re,{unsafe:!0}),es_object_toString}var es_object_values={},hasRequiredEs_object_values;function requireEs_object_values(){if(hasRequiredEs_object_values)return es_object_values;hasRequiredEs_object_values=1;var J=require_export(),Y=requireObjectToArray().values;return J({target:"Object",stat:!0},{values:function(ae){return Y(ae)}}),es_object_values}var es_parseFloat={},hasRequiredEs_parseFloat;function requireEs_parseFloat(){if(hasRequiredEs_parseFloat)return es_parseFloat;hasRequiredEs_parseFloat=1;var J=require_export(),Y=requireNumberParseFloat();return J({global:!0,forced:parseFloat!==Y},{parseFloat:Y}),es_parseFloat}var es_parseInt={},hasRequiredEs_parseInt;function requireEs_parseInt(){if(hasRequiredEs_parseInt)return es_parseInt;hasRequiredEs_parseInt=1;var J=require_export(),Y=requireNumberParseInt();return J({global:!0,forced:parseInt!==Y},{parseInt:Y}),es_parseInt}var es_promise={},es_promise_constructor={},aConstructor,hasRequiredAConstructor;function requireAConstructor(){if(hasRequiredAConstructor)return aConstructor;hasRequiredAConstructor=1;var J=requireIsConstructor(),Y=requireTryToString(),re=TypeError;return aConstructor=function(ae){if(J(ae))return ae;throw new re(Y(ae)+" is not a constructor")},aConstructor}var speciesConstructor,hasRequiredSpeciesConstructor;function requireSpeciesConstructor(){if(hasRequiredSpeciesConstructor)return speciesConstructor;hasRequiredSpeciesConstructor=1;var J=requireAnObject(),Y=requireAConstructor(),re=requireIsNullOrUndefined(),ae=requireWellKnownSymbol(),ne=ae("species");return speciesConstructor=function(ce,ee){var R=J(ce).constructor,U;return R===void 0||re(U=J(R)[ne])?ee:Y(U)},speciesConstructor}var validateArgumentsLength,hasRequiredValidateArgumentsLength;function requireValidateArgumentsLength(){if(hasRequiredValidateArgumentsLength)return validateArgumentsLength;hasRequiredValidateArgumentsLength=1;var J=TypeError;return validateArgumentsLength=function(Y,re){if(Y<re)throw new J("Not enough arguments");return Y},validateArgumentsLength}var environmentIsIos,hasRequiredEnvironmentIsIos;function requireEnvironmentIsIos(){if(hasRequiredEnvironmentIsIos)return environmentIsIos;hasRequiredEnvironmentIsIos=1;var J=requireEnvironmentUserAgent();return environmentIsIos=/(?:ipad|iphone|ipod).*applewebkit/i.test(J),environmentIsIos}var task,hasRequiredTask;function requireTask(){if(hasRequiredTask)return task;hasRequiredTask=1;var J=requireGlobalThis(),Y=requireFunctionApply(),re=requireFunctionBindContext(),ae=requireIsCallable(),ne=requireHasOwnProperty(),ce=requireFails(),ee=requireHtml(),R=requireArraySlice(),U=requireDocumentCreateElement(),K=requireValidateArgumentsLength(),oe=requireEnvironmentIsIos(),pe=requireEnvironmentIsNode(),_e=J.setImmediate,me=J.clearImmediate,we=J.process,Oe=J.Dispatch,De=J.Function,Ae=J.MessageChannel,Ce=J.String,je=0,ke={},Be="onreadystatechange",We,Je,Ke,et;ce(function(){We=J.location});var it=function(_t){if(ne(ke,_t)){var Rt=ke[_t];delete ke[_t],Rt()}},nt=function(_t){return function(){it(_t)}},ct=function(_t){it(_t.data)},ft=function(_t){J.postMessage(Ce(_t),We.protocol+"//"+We.host)};return(!_e||!me)&&(_e=function(Rt){K(arguments.length,1);var Ft=ae(Rt)?Rt:De(Rt),ht=R(arguments,1);return ke[++je]=function(){Y(Ft,void 0,ht)},Je(je),je},me=function(Rt){delete ke[Rt]},pe?Je=function(_t){we.nextTick(nt(_t))}:Oe&&Oe.now?Je=function(_t){Oe.now(nt(_t))}:Ae&&!oe?(Ke=new Ae,et=Ke.port2,Ke.port1.onmessage=ct,Je=re(et.postMessage,et)):J.addEventListener&&ae(J.postMessage)&&!J.importScripts&&We&&We.protocol!=="file:"&&!ce(ft)?(Je=ft,J.addEventListener("message",ct,!1)):Be in U("script")?Je=function(_t){ee.appendChild(U("script"))[Be]=function(){ee.removeChild(this),it(_t)}}:Je=function(_t){setTimeout(nt(_t),0)}),task={set:_e,clear:me},task}var safeGetBuiltIn,hasRequiredSafeGetBuiltIn;function requireSafeGetBuiltIn(){if(hasRequiredSafeGetBuiltIn)return safeGetBuiltIn;hasRequiredSafeGetBuiltIn=1;var J=requireGlobalThis(),Y=requireDescriptors(),re=Object.getOwnPropertyDescriptor;return safeGetBuiltIn=function(ae){if(!Y)return J[ae];var ne=re(J,ae);return ne&&ne.value},safeGetBuiltIn}var queue,hasRequiredQueue;function requireQueue(){if(hasRequiredQueue)return queue;hasRequiredQueue=1;var J=function(){this.head=null,this.tail=null};return J.prototype={add:function(Y){var re={item:Y,next:null},ae=this.tail;ae?ae.next=re:this.head=re,this.tail=re},get:function(){var Y=this.head;if(Y){var re=this.head=Y.next;return re===null&&(this.tail=null),Y.item}}},queue=J,queue}var environmentIsIosPebble,hasRequiredEnvironmentIsIosPebble;function requireEnvironmentIsIosPebble(){if(hasRequiredEnvironmentIsIosPebble)return environmentIsIosPebble;hasRequiredEnvironmentIsIosPebble=1;var J=requireEnvironmentUserAgent();return environmentIsIosPebble=/ipad|iphone|ipod/i.test(J)&&typeof Pebble<"u",environmentIsIosPebble}var environmentIsWebosWebkit,hasRequiredEnvironmentIsWebosWebkit;function requireEnvironmentIsWebosWebkit(){if(hasRequiredEnvironmentIsWebosWebkit)return environmentIsWebosWebkit;hasRequiredEnvironmentIsWebosWebkit=1;var J=requireEnvironmentUserAgent();return environmentIsWebosWebkit=/web0s(?!.*chrome)/i.test(J),environmentIsWebosWebkit}var microtask_1,hasRequiredMicrotask;function requireMicrotask(){if(hasRequiredMicrotask)return microtask_1;hasRequiredMicrotask=1;var J=requireGlobalThis(),Y=requireSafeGetBuiltIn(),re=requireFunctionBindContext(),ae=requireTask().set,ne=requireQueue(),ce=requireEnvironmentIsIos(),ee=requireEnvironmentIsIosPebble(),R=requireEnvironmentIsWebosWebkit(),U=requireEnvironmentIsNode(),K=J.MutationObserver||J.WebKitMutationObserver,oe=J.document,pe=J.process,_e=J.Promise,me=Y("queueMicrotask"),we,Oe,De,Ae,Ce;if(!me){var je=new ne,ke=function(){var Be,We;for(U&&(Be=pe.domain)&&Be.exit();We=je.get();)try{We()}catch(Je){throw je.head&&we(),Je}Be&&Be.enter()};!ce&&!U&&!R&&K&&oe?(Oe=!0,De=oe.createTextNode(""),new K(ke).observe(De,{characterData:!0}),we=function(){De.data=Oe=!Oe}):!ee&&_e&&_e.resolve?(Ae=_e.resolve(void 0),Ae.constructor=_e,Ce=re(Ae.then,Ae),we=function(){Ce(ke)}):U?we=function(){pe.nextTick(ke)}:(ae=re(ae,J),we=function(){ae(ke)}),me=function(Be){je.head||we(),je.add(Be)}}return microtask_1=me,microtask_1}var hostReportErrors,hasRequiredHostReportErrors;function requireHostReportErrors(){return hasRequiredHostReportErrors||(hasRequiredHostReportErrors=1,hostReportErrors=function(J,Y){try{arguments.length===1?console.error(J):console.error(J,Y)}catch{}}),hostReportErrors}var perform,hasRequiredPerform;function requirePerform(){return hasRequiredPerform||(hasRequiredPerform=1,perform=function(J){try{return{error:!1,value:J()}}catch(Y){return{error:!0,value:Y}}}),perform}var promiseNativeConstructor,hasRequiredPromiseNativeConstructor;function requirePromiseNativeConstructor(){if(hasRequiredPromiseNativeConstructor)return promiseNativeConstructor;hasRequiredPromiseNativeConstructor=1;var J=requireGlobalThis();return promiseNativeConstructor=J.Promise,promiseNativeConstructor}var promiseConstructorDetection,hasRequiredPromiseConstructorDetection;function requirePromiseConstructorDetection(){if(hasRequiredPromiseConstructorDetection)return promiseConstructorDetection;hasRequiredPromiseConstructorDetection=1;var J=requireGlobalThis(),Y=requirePromiseNativeConstructor(),re=requireIsCallable(),ae=requireIsForced(),ne=requireInspectSource(),ce=requireWellKnownSymbol(),ee=requireEnvironment(),R=requireIsPure(),U=requireEnvironmentV8Version(),K=Y&&Y.prototype,oe=ce("species"),pe=!1,_e=re(J.PromiseRejectionEvent),me=ae("Promise",function(){var we=ne(Y),Oe=we!==String(Y);if(!Oe&&U===66||R&&!(K.catch&&K.finally))return!0;if(!U||U<51||!/native code/.test(we)){var De=new Y(function(je){je(1)}),Ae=function(je){je(function(){},function(){})},Ce=De.constructor={};if(Ce[oe]=Ae,pe=De.then(function(){})instanceof Ae,!pe)return!0}return!Oe&&(ee==="BROWSER"||ee==="DENO")&&!_e});return promiseConstructorDetection={CONSTRUCTOR:me,REJECTION_EVENT:_e,SUBCLASSING:pe},promiseConstructorDetection}var newPromiseCapability={},hasRequiredNewPromiseCapability;function requireNewPromiseCapability(){if(hasRequiredNewPromiseCapability)return newPromiseCapability;hasRequiredNewPromiseCapability=1;var J=requireACallable(),Y=TypeError,re=function(ae){var ne,ce;this.promise=new ae(function(ee,R){if(ne!==void 0||ce!==void 0)throw new Y("Bad Promise constructor");ne=ee,ce=R}),this.resolve=J(ne),this.reject=J(ce)};return newPromiseCapability.f=function(ae){return new re(ae)},newPromiseCapability}var hasRequiredEs_promise_constructor;function requireEs_promise_constructor(){if(hasRequiredEs_promise_constructor)return es_promise_constructor;hasRequiredEs_promise_constructor=1;var J=require_export(),Y=requireIsPure(),re=requireEnvironmentIsNode(),ae=requireGlobalThis(),ne=requirePath(),ce=requireFunctionCall(),ee=requireDefineBuiltIn(),R=requireObjectSetPrototypeOf(),U=requireSetToStringTag(),K=requireSetSpecies(),oe=requireACallable(),pe=requireIsCallable(),_e=requireIsObject$1(),me=requireAnInstance(),we=requireSpeciesConstructor(),Oe=requireTask().set,De=requireMicrotask(),Ae=requireHostReportErrors(),Ce=requirePerform(),je=requireQueue(),ke=requireInternalState(),Be=requirePromiseNativeConstructor(),We=requirePromiseConstructorDetection(),Je=requireNewPromiseCapability(),Ke="Promise",et=We.CONSTRUCTOR,it=We.REJECTION_EVENT,nt=We.SUBCLASSING,ct=ke.getterFor(Ke),ft=ke.set,_t=Be&&Be.prototype,Rt=Be,Ft=_t,ht=ae.TypeError,St=ae.document,ut=ae.process,Et=Je.f,bt=Et,Dt=!!(St&&St.createEvent&&ae.dispatchEvent),Ut="unhandledrejection",er="rejectionhandled",xr=0,ur=1,yr=2,Wt=1,or=2,wr,Ir,br,gr,Mr=function(nr){var dr;return _e(nr)&&pe(dr=nr.then)?dr:!1},Hr=function(nr,dr){var mr=dr.value,Ge=dr.state===ur,Ie=Ge?nr.ok:nr.fail,Se=nr.resolve,xe=nr.reject,Te=nr.domain,Me,ze,Qe;try{Ie?(Ge||(dr.rejection===or&&Lr(dr),dr.rejection=Wt),Ie===!0?Me=mr:(Te&&Te.enter(),Me=Ie(mr),Te&&(Te.exit(),Qe=!0)),Me===nr.promise?xe(new ht("Promise-chain cycle")):(ze=Mr(Me))?ce(ze,Me,Se,xe):Se(Me)):xe(mr)}catch(tt){Te&&!Qe&&Te.exit(),xe(tt)}},jr=function(nr,dr){nr.notified||(nr.notified=!0,De(function(){for(var mr=nr.reactions,Ge;Ge=mr.get();)Hr(Ge,nr);nr.notified=!1,dr&&!nr.rejection&&Nr(nr)}))},Sr=function(nr,dr,mr){var Ge,Ie;Dt?(Ge=St.createEvent("Event"),Ge.promise=dr,Ge.reason=mr,Ge.initEvent(nr,!1,!0),ae.dispatchEvent(Ge)):Ge={promise:dr,reason:mr},!it&&(Ie=ae["on"+nr])?Ie(Ge):nr===Ut&&Ae("Unhandled promise rejection",mr)},Nr=function(nr){ce(Oe,ae,function(){var dr=nr.facade,mr=nr.value,Ge=Dr(nr),Ie;if(Ge&&(Ie=Ce(function(){re?ut.emit("unhandledRejection",mr,dr):Sr(Ut,dr,mr)}),nr.rejection=re||Dr(nr)?or:Wt,Ie.error))throw Ie.value})},Dr=function(nr){return nr.rejection!==Wt&&!nr.parent},Lr=function(nr){ce(Oe,ae,function(){var dr=nr.facade;re?ut.emit("rejectionHandled",dr):Sr(er,dr,nr.value)})},Yt=function(nr,dr,mr){return function(Ge){nr(dr,Ge,mr)}},Jt=function(nr,dr,mr){nr.done||(nr.done=!0,mr&&(nr=mr),nr.value=dr,nr.state=yr,jr(nr,!0))},qr=function(nr,dr,mr){if(!nr.done){nr.done=!0,mr&&(nr=mr);try{if(nr.facade===dr)throw new ht("Promise can't be resolved itself");var Ge=Mr(dr);Ge?De(function(){var Ie={done:!1};try{ce(Ge,dr,Yt(qr,Ie,nr),Yt(Jt,Ie,nr))}catch(Se){Jt(Ie,Se,nr)}}):(nr.value=dr,nr.state=ur,jr(nr,!1))}catch(Ie){Jt({done:!1},Ie,nr)}}};if(et&&(Rt=function(dr){me(this,Ft),oe(dr),ce(wr,this);var mr=ct(this);try{dr(Yt(qr,mr),Yt(Jt,mr))}catch(Ge){Jt(mr,Ge)}},Ft=Rt.prototype,wr=function(dr){ft(this,{type:Ke,done:!1,notified:!1,parent:!1,reactions:new je,rejection:!1,state:xr,value:null})},wr.prototype=ee(Ft,"then",function(dr,mr){var Ge=ct(this),Ie=Et(we(this,Rt));return Ge.parent=!0,Ie.ok=pe(dr)?dr:!0,Ie.fail=pe(mr)&&mr,Ie.domain=re?ut.domain:void 0,Ge.state===xr?Ge.reactions.add(Ie):De(function(){Hr(Ie,Ge)}),Ie.promise}),Ir=function(){var nr=new wr,dr=ct(nr);this.promise=nr,this.resolve=Yt(qr,dr),this.reject=Yt(Jt,dr)},Je.f=Et=function(nr){return nr===Rt||nr===br?new Ir(nr):bt(nr)},!Y&&pe(Be)&&_t!==Object.prototype)){gr=_t.then,nt||ee(_t,"then",function(dr,mr){var Ge=this;return new Rt(function(Ie,Se){ce(gr,Ge,Ie,Se)}).then(dr,mr)},{unsafe:!0});try{delete _t.constructor}catch{}R&&R(_t,Ft)}return J({global:!0,constructor:!0,wrap:!0,forced:et},{Promise:Rt}),br=ne.Promise,U(Rt,Ke,!1,!0),K(Ke),es_promise_constructor}var es_promise_all={},promiseStaticsIncorrectIteration,hasRequiredPromiseStaticsIncorrectIteration;function requirePromiseStaticsIncorrectIteration(){if(hasRequiredPromiseStaticsIncorrectIteration)return promiseStaticsIncorrectIteration;hasRequiredPromiseStaticsIncorrectIteration=1;var J=requirePromiseNativeConstructor(),Y=requireCheckCorrectnessOfIteration(),re=requirePromiseConstructorDetection().CONSTRUCTOR;return promiseStaticsIncorrectIteration=re||!Y(function(ae){J.all(ae).then(void 0,function(){})}),promiseStaticsIncorrectIteration}var hasRequiredEs_promise_all;function requireEs_promise_all(){if(hasRequiredEs_promise_all)return es_promise_all;hasRequiredEs_promise_all=1;var J=require_export(),Y=requireFunctionCall(),re=requireACallable(),ae=requireNewPromiseCapability(),ne=requirePerform(),ce=requireIterate(),ee=requirePromiseStaticsIncorrectIteration();return J({target:"Promise",stat:!0,forced:ee},{all:function(U){var K=this,oe=ae.f(K),pe=oe.resolve,_e=oe.reject,me=ne(function(){var we=re(K.resolve),Oe=[],De=0,Ae=1;ce(U,function(Ce){var je=De++,ke=!1;Ae++,Y(we,K,Ce).then(function(Be){ke||(ke=!0,Oe[je]=Be,--Ae||pe(Oe))},_e)}),--Ae||pe(Oe)});return me.error&&_e(me.value),oe.promise}}),es_promise_all}var es_promise_catch={},hasRequiredEs_promise_catch;function requireEs_promise_catch(){if(hasRequiredEs_promise_catch)return es_promise_catch;hasRequiredEs_promise_catch=1;var J=require_export(),Y=requireIsPure(),re=requirePromiseConstructorDetection().CONSTRUCTOR,ae=requirePromiseNativeConstructor(),ne=requireGetBuiltIn(),ce=requireIsCallable(),ee=requireDefineBuiltIn(),R=ae&&ae.prototype;if(J({target:"Promise",proto:!0,forced:re,real:!0},{catch:function(K){return this.then(void 0,K)}}),!Y&&ce(ae)){var U=ne("Promise").prototype.catch;R.catch!==U&&ee(R,"catch",U,{unsafe:!0})}return es_promise_catch}var es_promise_race={},hasRequiredEs_promise_race;function requireEs_promise_race(){if(hasRequiredEs_promise_race)return es_promise_race;hasRequiredEs_promise_race=1;var J=require_export(),Y=requireFunctionCall(),re=requireACallable(),ae=requireNewPromiseCapability(),ne=requirePerform(),ce=requireIterate(),ee=requirePromiseStaticsIncorrectIteration();return J({target:"Promise",stat:!0,forced:ee},{race:function(U){var K=this,oe=ae.f(K),pe=oe.reject,_e=ne(function(){var me=re(K.resolve);ce(U,function(we){Y(me,K,we).then(oe.resolve,pe)})});return _e.error&&pe(_e.value),oe.promise}}),es_promise_race}var es_promise_reject={},hasRequiredEs_promise_reject;function requireEs_promise_reject(){if(hasRequiredEs_promise_reject)return es_promise_reject;hasRequiredEs_promise_reject=1;var J=require_export(),Y=requireNewPromiseCapability(),re=requirePromiseConstructorDetection().CONSTRUCTOR;return J({target:"Promise",stat:!0,forced:re},{reject:function(ne){var ce=Y.f(this),ee=ce.reject;return ee(ne),ce.promise}}),es_promise_reject}var es_promise_resolve={},promiseResolve,hasRequiredPromiseResolve;function requirePromiseResolve(){if(hasRequiredPromiseResolve)return promiseResolve;hasRequiredPromiseResolve=1;var J=requireAnObject(),Y=requireIsObject$1(),re=requireNewPromiseCapability();return promiseResolve=function(ae,ne){if(J(ae),Y(ne)&&ne.constructor===ae)return ne;var ce=re.f(ae),ee=ce.resolve;return ee(ne),ce.promise},promiseResolve}var hasRequiredEs_promise_resolve;function requireEs_promise_resolve(){if(hasRequiredEs_promise_resolve)return es_promise_resolve;hasRequiredEs_promise_resolve=1;var J=require_export(),Y=requireGetBuiltIn(),re=requireIsPure(),ae=requirePromiseNativeConstructor(),ne=requirePromiseConstructorDetection().CONSTRUCTOR,ce=requirePromiseResolve(),ee=Y("Promise"),R=re&&!ne;return J({target:"Promise",stat:!0,forced:re||ne},{resolve:function(K){return ce(R&&this===ee?ae:this,K)}}),es_promise_resolve}var hasRequiredEs_promise;function requireEs_promise(){return hasRequiredEs_promise||(hasRequiredEs_promise=1,requireEs_promise_constructor(),requireEs_promise_all(),requireEs_promise_catch(),requireEs_promise_race(),requireEs_promise_reject(),requireEs_promise_resolve()),es_promise}var es_promise_allSettled={},hasRequiredEs_promise_allSettled;function requireEs_promise_allSettled(){if(hasRequiredEs_promise_allSettled)return es_promise_allSettled;hasRequiredEs_promise_allSettled=1;var J=require_export(),Y=requireFunctionCall(),re=requireACallable(),ae=requireNewPromiseCapability(),ne=requirePerform(),ce=requireIterate(),ee=requirePromiseStaticsIncorrectIteration();return J({target:"Promise",stat:!0,forced:ee},{allSettled:function(U){var K=this,oe=ae.f(K),pe=oe.resolve,_e=oe.reject,me=ne(function(){var we=re(K.resolve),Oe=[],De=0,Ae=1;ce(U,function(Ce){var je=De++,ke=!1;Ae++,Y(we,K,Ce).then(function(Be){ke||(ke=!0,Oe[je]={status:"fulfilled",value:Be},--Ae||pe(Oe))},function(Be){ke||(ke=!0,Oe[je]={status:"rejected",reason:Be},--Ae||pe(Oe))})}),--Ae||pe(Oe)});return me.error&&_e(me.value),oe.promise}}),es_promise_allSettled}var es_promise_any={},hasRequiredEs_promise_any;function requireEs_promise_any(){if(hasRequiredEs_promise_any)return es_promise_any;hasRequiredEs_promise_any=1;var J=require_export(),Y=requireFunctionCall(),re=requireACallable(),ae=requireGetBuiltIn(),ne=requireNewPromiseCapability(),ce=requirePerform(),ee=requireIterate(),R=requirePromiseStaticsIncorrectIteration(),U="No one promise resolved";return J({target:"Promise",stat:!0,forced:R},{any:function(oe){var pe=this,_e=ae("AggregateError"),me=ne.f(pe),we=me.resolve,Oe=me.reject,De=ce(function(){var Ae=re(pe.resolve),Ce=[],je=0,ke=1,Be=!1;ee(oe,function(We){var Je=je++,Ke=!1;ke++,Y(Ae,pe,We).then(function(et){Ke||Be||(Be=!0,we(et))},function(et){Ke||Be||(Ke=!0,Ce[Je]=et,--ke||Oe(new _e(Ce,U)))})}),--ke||Oe(new _e(Ce,U))});return De.error&&Oe(De.value),me.promise}}),es_promise_any}var es_promise_finally={},hasRequiredEs_promise_finally;function requireEs_promise_finally(){if(hasRequiredEs_promise_finally)return es_promise_finally;hasRequiredEs_promise_finally=1;var J=require_export(),Y=requireIsPure(),re=requirePromiseNativeConstructor(),ae=requireFails(),ne=requireGetBuiltIn(),ce=requireIsCallable(),ee=requireSpeciesConstructor(),R=requirePromiseResolve(),U=requireDefineBuiltIn(),K=re&&re.prototype,oe=!!re&&ae(function(){K.finally.call({then:function(){}},function(){})});if(J({target:"Promise",proto:!0,real:!0,forced:oe},{finally:function(_e){var me=ee(this,ne("Promise")),we=ce(_e);return this.then(we?function(Oe){return R(me,_e()).then(function(){return Oe})}:_e,we?function(Oe){return R(me,_e()).then(function(){throw Oe})}:_e)}}),!Y&&ce(re)){var pe=ne("Promise").prototype.finally;K.finally!==pe&&U(K,"finally",pe,{unsafe:!0})}return es_promise_finally}var es_promise_try={},hasRequiredEs_promise_try;function requireEs_promise_try(){if(hasRequiredEs_promise_try)return es_promise_try;hasRequiredEs_promise_try=1;var J=require_export(),Y=requireGlobalThis(),re=requireFunctionApply(),ae=requireArraySlice(),ne=requireNewPromiseCapability(),ce=requireACallable(),ee=requirePerform(),R=Y.Promise,U=!1,K=!R||!R.try||ee(function(){R.try(function(oe){U=oe===8},8)}).error||!U;return J({target:"Promise",stat:!0,forced:K},{try:function(oe){var pe=arguments.length>1?ae(arguments,1):[],_e=ne.f(this),me=ee(function(){return re(ce(oe),void 0,pe)});return(me.error?_e.reject:_e.resolve)(me.value),_e.promise}}),es_promise_try}var es_promise_withResolvers={},hasRequiredEs_promise_withResolvers;function requireEs_promise_withResolvers(){if(hasRequiredEs_promise_withResolvers)return es_promise_withResolvers;hasRequiredEs_promise_withResolvers=1;var J=require_export(),Y=requireNewPromiseCapability();return J({target:"Promise",stat:!0},{withResolvers:function(){var ae=Y.f(this);return{promise:ae.promise,resolve:ae.resolve,reject:ae.reject}}}),es_promise_withResolvers}var es_array_fromAsync={},asyncIteratorPrototype,hasRequiredAsyncIteratorPrototype;function requireAsyncIteratorPrototype(){if(hasRequiredAsyncIteratorPrototype)return asyncIteratorPrototype;hasRequiredAsyncIteratorPrototype=1;var J=requireGlobalThis(),Y=requireSharedStore(),re=requireIsCallable(),ae=requireObjectCreate(),ne=requireObjectGetPrototypeOf(),ce=requireDefineBuiltIn(),ee=requireWellKnownSymbol(),R=requireIsPure(),U="USE_FUNCTION_CONSTRUCTOR",K=ee("asyncIterator"),oe=J.AsyncIterator,pe=Y.AsyncIteratorPrototype,_e,me;if(pe)_e=pe;else if(re(oe))_e=oe.prototype;else if(Y[U]||J[U])try{me=ne(ne(ne(Function("return async function*(){}()")()))),ne(me)===Object.prototype&&(_e=me)}catch{}return _e?R&&(_e=ae(_e)):_e={},re(_e[K])||ce(_e,K,function(){return this}),asyncIteratorPrototype=_e,asyncIteratorPrototype}var asyncFromSyncIterator,hasRequiredAsyncFromSyncIterator;function requireAsyncFromSyncIterator(){if(hasRequiredAsyncFromSyncIterator)return asyncFromSyncIterator;hasRequiredAsyncFromSyncIterator=1;var J=requireFunctionCall(),Y=requireAnObject(),re=requireObjectCreate(),ae=requireGetMethod(),ne=requireDefineBuiltIns(),ce=requireInternalState(),ee=requireIteratorClose(),R=requireGetBuiltIn(),U=requireAsyncIteratorPrototype(),K=requireCreateIterResultObject(),oe=R("Promise"),pe="AsyncFromSyncIterator",_e=ce.set,me=ce.getterFor(pe),we=function(De,Ae,Ce,je,ke){var Be=De.done;oe.resolve(De.value).then(function(We){Ae(K(We,Be))},function(We){if(!Be&&ke)try{ee(je,"throw",We)}catch(Je){We=Je}Ce(We)})},Oe=function(Ae){Ae.type=pe,_e(this,Ae)};return Oe.prototype=ne(re(U),{next:function(){var Ae=me(this);return new oe(function(Ce,je){var ke=Y(J(Ae.next,Ae.iterator));we(ke,Ce,je,Ae.iterator,!0)})},return:function(){var De=me(this).iterator;return new oe(function(Ae,Ce){var je=ae(De,"return");if(je===void 0)return Ae(K(void 0,!0));var ke=Y(J(je,De));we(ke,Ae,Ce,De)})}}),asyncFromSyncIterator=Oe,asyncFromSyncIterator}var getAsyncIterator,hasRequiredGetAsyncIterator;function requireGetAsyncIterator(){if(hasRequiredGetAsyncIterator)return getAsyncIterator;hasRequiredGetAsyncIterator=1;var J=requireFunctionCall(),Y=requireAsyncFromSyncIterator(),re=requireAnObject(),ae=requireGetIterator(),ne=requireGetIteratorDirect(),ce=requireGetMethod(),ee=requireWellKnownSymbol(),R=ee("asyncIterator");return getAsyncIterator=function(U,K){var oe=arguments.length<2?ce(U,R):K;return oe?re(J(oe,U)):new Y(ne(ae(U)))},getAsyncIterator}var asyncIteratorClose,hasRequiredAsyncIteratorClose;function requireAsyncIteratorClose(){if(hasRequiredAsyncIteratorClose)return asyncIteratorClose;hasRequiredAsyncIteratorClose=1;var J=requireFunctionCall(),Y=requireGetBuiltIn(),re=requireGetMethod();return asyncIteratorClose=function(ae,ne,ce,ee){try{var R=re(ae,"return");if(R)return Y("Promise").resolve(J(R,ae)).then(function(){ne(ce)},function(U){ee(U)})}catch(U){return ee(U)}ne(ce)},asyncIteratorClose}var asyncIteratorIteration,hasRequiredAsyncIteratorIteration;function requireAsyncIteratorIteration(){if(hasRequiredAsyncIteratorIteration)return asyncIteratorIteration;hasRequiredAsyncIteratorIteration=1;var J=requireFunctionCall(),Y=requireACallable(),re=requireAnObject(),ae=requireIsObject$1(),ne=requireDoesNotExceedSafeInteger(),ce=requireGetBuiltIn(),ee=requireGetIteratorDirect(),R=requireAsyncIteratorClose(),U=function(K){var oe=K===0,pe=K===1,_e=K===2,me=K===3;return function(we,Oe,De){re(we);var Ae=Oe!==void 0;(Ae||!oe)&&Y(Oe);var Ce=ee(we),je=ce("Promise"),ke=Ce.iterator,Be=Ce.next,We=0;return new je(function(Je,Ke){var et=function(nt){R(ke,Ke,nt,Ke)},it=function(){try{if(Ae)try{ne(We)}catch(nt){et(nt)}je.resolve(re(J(Be,ke))).then(function(nt){try{if(re(nt).done)oe?(De.length=We,Je(De)):Je(me?!1:_e||void 0);else{var ct=nt.value;try{if(Ae){var ft=Oe(ct,We),_t=function(Rt){if(pe)it();else if(_e)Rt?it():R(ke,Je,!1,Ke);else if(oe)try{De[We++]=Rt,it()}catch(Ft){et(Ft)}else Rt?R(ke,Je,me||ct,Ke):it()};ae(ft)?je.resolve(ft).then(_t,et):_t(ft)}else De[We++]=ct,it()}catch(Rt){et(Rt)}}}catch(Rt){Ke(Rt)}},Ke)}catch(nt){Ke(nt)}};it()})}};return asyncIteratorIteration={toArray:U(0),forEach:U(1),every:U(2),some:U(3),find:U(4)},asyncIteratorIteration}var arrayFromAsync,hasRequiredArrayFromAsync;function requireArrayFromAsync(){if(hasRequiredArrayFromAsync)return arrayFromAsync;hasRequiredArrayFromAsync=1;var J=requireFunctionBindContext(),Y=requireFunctionUncurryThis(),re=requireToObject(),ae=requireIsConstructor(),ne=requireGetAsyncIterator(),ce=requireGetIterator(),ee=requireGetIteratorDirect(),R=requireGetIteratorMethod(),U=requireGetMethod(),K=requireGetBuiltIn(),oe=requireGetBuiltInPrototypeMethod(),pe=requireWellKnownSymbol(),_e=requireAsyncFromSyncIterator(),me=requireAsyncIteratorIteration().toArray,we=pe("asyncIterator"),Oe=Y(oe("Array","values")),De=Y(Oe([]).next),Ae=function(){return new Ce(this)},Ce=function(je){this.iterator=Oe(je)};return Ce.prototype.next=function(){return De(this.iterator)},arrayFromAsync=function(ke){var Be=this,We=arguments.length,Je=We>1?arguments[1]:void 0,Ke=We>2?arguments[2]:void 0;return new(K("Promise"))(function(et){var it=re(ke);Je!==void 0&&(Je=J(Je,Ke));var nt=U(it,we),ct=nt?void 0:R(it)||Ae,ft=ae(Be)?new Be:[],_t=nt?ne(it,nt):new _e(ee(ce(it,ct)));et(me(_t,Je,ft))})},arrayFromAsync}var hasRequiredEs_array_fromAsync;function requireEs_array_fromAsync(){if(hasRequiredEs_array_fromAsync)return es_array_fromAsync;hasRequiredEs_array_fromAsync=1;var J=require_export(),Y=requireArrayFromAsync(),re=requireFails(),ae=Array.fromAsync,ne=!ae||re(function(){var ce=0;return ae.call(function(){return ce++,[]},{length:0}),ce!==1});return J({target:"Array",stat:!0,forced:ne},{fromAsync:Y}),es_array_fromAsync}var es_asyncDisposableStack_constructor={},hasRequiredEs_asyncDisposableStack_constructor;function requireEs_asyncDisposableStack_constructor(){if(hasRequiredEs_asyncDisposableStack_constructor)return es_asyncDisposableStack_constructor;hasRequiredEs_asyncDisposableStack_constructor=1;var J=require_export(),Y=requireDescriptors(),re=requireGetBuiltIn(),ae=requireACallable(),ne=requireAnInstance(),ce=requireDefineBuiltIn(),ee=requireDefineBuiltIns(),R=requireDefineBuiltInAccessor(),U=requireWellKnownSymbol(),K=requireInternalState(),oe=requireAddDisposableResource(),pe=requireEnvironmentV8Version(),_e=re("Promise"),me=re("SuppressedError"),we=ReferenceError,Oe=U("asyncDispose"),De=U("toStringTag"),Ae="AsyncDisposableStack",Ce=K.set,je=K.getterFor(Ae),ke="async-dispose",Be="disposed",We="pending",Je=function(nt){var ct=je(nt);if(ct.state===Be)throw new we(Ae+" already disposed");return ct},Ke=function(){Ce(ne(this,et),{type:Ae,state:We,stack:[]}),Y||(this.disposed=!1)},et=Ke.prototype;ee(et,{disposeAsync:function(){var ct=this;return new _e(function(ft,_t){var Rt=je(ct);if(Rt.state===Be)return ft(void 0);Rt.state=Be,Y||(ct.disposed=!0);var Ft=Rt.stack,ht=Ft.length,St=!1,ut,Et=function(Dt){St?ut=new me(Dt,ut):(St=!0,ut=Dt),bt()},bt=function(){if(ht){var Dt=Ft[--ht];Ft[ht]=null;try{_e.resolve(Dt()).then(bt,Et)}catch(Ut){Et(Ut)}}else Rt.stack=null,St?_t(ut):ft(void 0)};bt()})},use:function(ct){return oe(Je(this),ct,ke),ct},adopt:function(ct,ft){var _t=Je(this);return ae(ft),oe(_t,void 0,ke,function(){return ft(ct)}),ct},defer:function(ct){var ft=Je(this);ae(ct),oe(ft,void 0,ke,ct)},move:function(){var ct=Je(this),ft=new Ke;return je(ft).stack=ct.stack,ct.stack=[],ct.state=Be,Y||(this.disposed=!0),ft}}),Y&&R(et,"disposed",{configurable:!0,get:function(){return je(this).state===Be}}),ce(et,Oe,et.disposeAsync,{name:"disposeAsync"}),ce(et,De,Ae,{nonWritable:!0});var it=pe&&pe<136;return J({global:!0,constructor:!0,forced:it},{AsyncDisposableStack:Ke}),es_asyncDisposableStack_constructor}var es_asyncIterator_asyncDispose={},hasRequiredEs_asyncIterator_asyncDispose;function requireEs_asyncIterator_asyncDispose(){if(hasRequiredEs_asyncIterator_asyncDispose)return es_asyncIterator_asyncDispose;hasRequiredEs_asyncIterator_asyncDispose=1;var J=requireFunctionCall(),Y=requireDefineBuiltIn(),re=requireGetBuiltIn(),ae=requireGetMethod(),ne=requireHasOwnProperty(),ce=requireWellKnownSymbol(),ee=requireAsyncIteratorPrototype(),R=ce("asyncDispose"),U=re("Promise");return ne(ee,R)||Y(ee,R,function(){var K=this;return new U(function(oe,pe){var _e=ae(K,"return");_e?U.resolve(J(_e,K)).then(function(){oe(void 0)},pe):oe(void 0)})}),es_asyncIterator_asyncDispose}var es_reflect_apply={},hasRequiredEs_reflect_apply;function requireEs_reflect_apply(){if(hasRequiredEs_reflect_apply)return es_reflect_apply;hasRequiredEs_reflect_apply=1;var J=require_export(),Y=requireFunctionApply(),re=requireACallable(),ae=requireAnObject(),ne=requireFails(),ce=!ne(function(){Reflect.apply(function(){})});return J({target:"Reflect",stat:!0,forced:ce},{apply:function(R,U,K){return Y(re(R),U,ae(K))}}),es_reflect_apply}var es_reflect_construct={},hasRequiredEs_reflect_construct;function requireEs_reflect_construct(){if(hasRequiredEs_reflect_construct)return es_reflect_construct;hasRequiredEs_reflect_construct=1;var J=require_export(),Y=requireGetBuiltIn(),re=requireFunctionApply(),ae=requireFunctionBind(),ne=requireAConstructor(),ce=requireAnObject(),ee=requireIsObject$1(),R=requireObjectCreate(),U=requireFails(),K=Y("Reflect","construct"),oe=Object.prototype,pe=[].push,_e=U(function(){function Oe(){}return!(K(function(){},[],Oe)instanceof Oe)}),me=!U(function(){K(function(){})}),we=_e||me;return J({target:"Reflect",stat:!0,forced:we,sham:we},{construct:function(De,Ae){ne(De),ce(Ae);var Ce=arguments.length<3?De:ne(arguments[2]);if(me&&!_e)return K(De,Ae,Ce);if(De===Ce){switch(Ae.length){case 0:return new De;case 1:return new De(Ae[0]);case 2:return new De(Ae[0],Ae[1]);case 3:return new De(Ae[0],Ae[1],Ae[2]);case 4:return new De(Ae[0],Ae[1],Ae[2],Ae[3])}var je=[null];return re(pe,je,Ae),new(re(ae,De,je))}var ke=Ce.prototype,Be=R(ee(ke)?ke:oe),We=re(De,Be,Ae);return ee(We)?We:Be}}),es_reflect_construct}var es_reflect_defineProperty={},hasRequiredEs_reflect_defineProperty;function requireEs_reflect_defineProperty(){if(hasRequiredEs_reflect_defineProperty)return es_reflect_defineProperty;hasRequiredEs_reflect_defineProperty=1;var J=require_export(),Y=requireDescriptors(),re=requireAnObject(),ae=requireToPropertyKey(),ne=requireObjectDefineProperty(),ce=requireFails(),ee=ce(function(){Reflect.defineProperty(ne.f({},1,{value:1}),1,{value:2})});return J({target:"Reflect",stat:!0,forced:ee,sham:!Y},{defineProperty:function(U,K,oe){re(U);var pe=ae(K);re(oe);try{return ne.f(U,pe,oe),!0}catch{return!1}}}),es_reflect_defineProperty}var es_reflect_deleteProperty={},hasRequiredEs_reflect_deleteProperty;function requireEs_reflect_deleteProperty(){if(hasRequiredEs_reflect_deleteProperty)return es_reflect_deleteProperty;hasRequiredEs_reflect_deleteProperty=1;var J=require_export(),Y=requireAnObject(),re=requireObjectGetOwnPropertyDescriptor().f;return J({target:"Reflect",stat:!0},{deleteProperty:function(ne,ce){var ee=re(Y(ne),ce);return ee&&!ee.configurable?!1:delete ne[ce]}}),es_reflect_deleteProperty}var es_reflect_get={},isDataDescriptor,hasRequiredIsDataDescriptor;function requireIsDataDescriptor(){if(hasRequiredIsDataDescriptor)return isDataDescriptor;hasRequiredIsDataDescriptor=1;var J=requireHasOwnProperty();return isDataDescriptor=function(Y){return Y!==void 0&&(J(Y,"value")||J(Y,"writable"))},isDataDescriptor}var hasRequiredEs_reflect_get;function requireEs_reflect_get(){if(hasRequiredEs_reflect_get)return es_reflect_get;hasRequiredEs_reflect_get=1;var J=require_export(),Y=requireFunctionCall(),re=requireIsObject$1(),ae=requireAnObject(),ne=requireIsDataDescriptor(),ce=requireObjectGetOwnPropertyDescriptor(),ee=requireObjectGetPrototypeOf();function R(U,K){var oe=arguments.length<3?U:arguments[2],pe,_e;if(ae(U)===oe)return U[K];if(pe=ce.f(U,K),pe)return ne(pe)?pe.value:pe.get===void 0?void 0:Y(pe.get,oe);if(re(_e=ee(U)))return R(_e,K,oe)}return J({target:"Reflect",stat:!0},{get:R}),es_reflect_get}var es_reflect_getOwnPropertyDescriptor={},hasRequiredEs_reflect_getOwnPropertyDescriptor;function requireEs_reflect_getOwnPropertyDescriptor(){if(hasRequiredEs_reflect_getOwnPropertyDescriptor)return es_reflect_getOwnPropertyDescriptor;hasRequiredEs_reflect_getOwnPropertyDescriptor=1;var J=require_export(),Y=requireDescriptors(),re=requireAnObject(),ae=requireObjectGetOwnPropertyDescriptor();return J({target:"Reflect",stat:!0,sham:!Y},{getOwnPropertyDescriptor:function(ce,ee){return ae.f(re(ce),ee)}}),es_reflect_getOwnPropertyDescriptor}var es_reflect_getPrototypeOf={},hasRequiredEs_reflect_getPrototypeOf;function requireEs_reflect_getPrototypeOf(){if(hasRequiredEs_reflect_getPrototypeOf)return es_reflect_getPrototypeOf;hasRequiredEs_reflect_getPrototypeOf=1;var J=require_export(),Y=requireAnObject(),re=requireObjectGetPrototypeOf(),ae=requireCorrectPrototypeGetter();return J({target:"Reflect",stat:!0,sham:!ae},{getPrototypeOf:function(ce){return re(Y(ce))}}),es_reflect_getPrototypeOf}var es_reflect_has={},hasRequiredEs_reflect_has;function requireEs_reflect_has(){if(hasRequiredEs_reflect_has)return es_reflect_has;hasRequiredEs_reflect_has=1;var J=require_export();return J({target:"Reflect",stat:!0},{has:function(re,ae){return ae in re}}),es_reflect_has}var es_reflect_isExtensible={},hasRequiredEs_reflect_isExtensible;function requireEs_reflect_isExtensible(){if(hasRequiredEs_reflect_isExtensible)return es_reflect_isExtensible;hasRequiredEs_reflect_isExtensible=1;var J=require_export(),Y=requireAnObject(),re=requireObjectIsExtensible();return J({target:"Reflect",stat:!0},{isExtensible:function(ne){return Y(ne),re(ne)}}),es_reflect_isExtensible}var es_reflect_ownKeys={},hasRequiredEs_reflect_ownKeys;function requireEs_reflect_ownKeys(){if(hasRequiredEs_reflect_ownKeys)return es_reflect_ownKeys;hasRequiredEs_reflect_ownKeys=1;var J=require_export(),Y=requireOwnKeys();return J({target:"Reflect",stat:!0},{ownKeys:Y}),es_reflect_ownKeys}var es_reflect_preventExtensions={},hasRequiredEs_reflect_preventExtensions;function requireEs_reflect_preventExtensions(){if(hasRequiredEs_reflect_preventExtensions)return es_reflect_preventExtensions;hasRequiredEs_reflect_preventExtensions=1;var J=require_export(),Y=requireGetBuiltIn(),re=requireAnObject(),ae=requireFreezing();return J({target:"Reflect",stat:!0,sham:!ae},{preventExtensions:function(ce){re(ce);try{var ee=Y("Object","preventExtensions");return ee&&ee(ce),!0}catch{return!1}}}),es_reflect_preventExtensions}var es_reflect_set={},hasRequiredEs_reflect_set;function requireEs_reflect_set(){if(hasRequiredEs_reflect_set)return es_reflect_set;hasRequiredEs_reflect_set=1;var J=require_export(),Y=requireFunctionCall(),re=requireAnObject(),ae=requireIsObject$1(),ne=requireIsDataDescriptor(),ce=requireFails(),ee=requireObjectDefineProperty(),R=requireObjectGetOwnPropertyDescriptor(),U=requireObjectGetPrototypeOf(),K=requireCreatePropertyDescriptor();function oe(_e,me,we){var Oe=arguments.length<4?_e:arguments[3],De=R.f(re(_e),me),Ae,Ce,je;if(!De){if(ae(Ce=U(_e)))return oe(Ce,me,we,Oe);De=K(0)}if(ne(De)){if(De.writable===!1||!ae(Oe))return!1;if(Ae=R.f(Oe,me)){if(Ae.get||Ae.set||Ae.writable===!1)return!1;Ae.value=we,ee.f(Oe,me,Ae)}else ee.f(Oe,me,K(0,we))}else{if(je=De.set,je===void 0)return!1;Y(je,Oe,we)}return!0}var pe=ce(function(){var _e=function(){},me=ee.f(new _e,"a",{configurable:!0});return Reflect.set(_e.prototype,"a",1,me)!==!1});return J({target:"Reflect",stat:!0,forced:pe},{set:oe}),es_reflect_set}var es_reflect_setPrototypeOf={},hasRequiredEs_reflect_setPrototypeOf;function requireEs_reflect_setPrototypeOf(){if(hasRequiredEs_reflect_setPrototypeOf)return es_reflect_setPrototypeOf;hasRequiredEs_reflect_setPrototypeOf=1;var J=require_export(),Y=requireAnObject(),re=requireAPossiblePrototype(),ae=requireObjectSetPrototypeOf();return ae&&J({target:"Reflect",stat:!0},{setPrototypeOf:function(ce,ee){Y(ce),re(ee);try{return ae(ce,ee),!0}catch{return!1}}}),es_reflect_setPrototypeOf}var es_reflect_toStringTag={},hasRequiredEs_reflect_toStringTag;function requireEs_reflect_toStringTag(){if(hasRequiredEs_reflect_toStringTag)return es_reflect_toStringTag;hasRequiredEs_reflect_toStringTag=1;var J=require_export(),Y=requireGlobalThis(),re=requireSetToStringTag();return J({global:!0},{Reflect:{}}),re(Y.Reflect,"Reflect",!0),es_reflect_toStringTag}var es_regexp_constructor={},isRegexp,hasRequiredIsRegexp;function requireIsRegexp(){if(hasRequiredIsRegexp)return isRegexp;hasRequiredIsRegexp=1;var J=requireIsObject$1(),Y=requireClassofRaw(),re=requireWellKnownSymbol(),ae=re("match");return isRegexp=function(ne){var ce;return J(ne)&&((ce=ne[ae])!==void 0?!!ce:Y(ne)==="RegExp")},isRegexp}var regexpFlagsDetection,hasRequiredRegexpFlagsDetection;function requireRegexpFlagsDetection(){if(hasRequiredRegexpFlagsDetection)return regexpFlagsDetection;hasRequiredRegexpFlagsDetection=1;var J=requireGlobalThis(),Y=requireFails(),re=J.RegExp,ae=!Y(function(){var ne=!0;try{re(".","d")}catch{ne=!1}var ce={},ee="",R=ne?"dgimsy":"gimsy",U=function(_e,me){Object.defineProperty(ce,_e,{get:function(){return ee+=me,!0}})},K={dotAll:"s",global:"g",ignoreCase:"i",multiline:"m",sticky:"y"};ne&&(K.hasIndices="d");for(var oe in K)U(oe,K[oe]);var pe=Object.getOwnPropertyDescriptor(re.prototype,"flags").get.call(ce);return pe!==R||ee!==R});return regexpFlagsDetection={correct:ae},regexpFlagsDetection}var regexpFlags,hasRequiredRegexpFlags;function requireRegexpFlags(){if(hasRequiredRegexpFlags)return regexpFlags;hasRequiredRegexpFlags=1;var J=requireAnObject();return regexpFlags=function(){var Y=J(this),re="";return Y.hasIndices&&(re+="d"),Y.global&&(re+="g"),Y.ignoreCase&&(re+="i"),Y.multiline&&(re+="m"),Y.dotAll&&(re+="s"),Y.unicode&&(re+="u"),Y.unicodeSets&&(re+="v"),Y.sticky&&(re+="y"),re},regexpFlags}var regexpGetFlags,hasRequiredRegexpGetFlags;function requireRegexpGetFlags(){if(hasRequiredRegexpGetFlags)return regexpGetFlags;hasRequiredRegexpGetFlags=1;var J=requireFunctionCall(),Y=requireHasOwnProperty(),re=requireObjectIsPrototypeOf(),ae=requireRegexpFlagsDetection(),ne=requireRegexpFlags(),ce=RegExp.prototype;return regexpGetFlags=ae.correct?function(ee){return ee.flags}:function(ee){return!ae.correct&&re(ce,ee)&&!Y(ee,"flags")?J(ne,ee):ee.flags},regexpGetFlags}var regexpStickyHelpers,hasRequiredRegexpStickyHelpers;function requireRegexpStickyHelpers(){if(hasRequiredRegexpStickyHelpers)return regexpStickyHelpers;hasRequiredRegexpStickyHelpers=1;var J=requireFails(),Y=requireGlobalThis(),re=Y.RegExp,ae=J(function(){var ee=re("a","y");return ee.lastIndex=2,ee.exec("abcd")!==null}),ne=ae||J(function(){return!re("a","y").sticky}),ce=ae||J(function(){var ee=re("^r","gy");return ee.lastIndex=2,ee.exec("str")!==null});return regexpStickyHelpers={BROKEN_CARET:ce,MISSED_STICKY:ne,UNSUPPORTED_Y:ae},regexpStickyHelpers}var regexpUnsupportedDotAll,hasRequiredRegexpUnsupportedDotAll;function requireRegexpUnsupportedDotAll(){if(hasRequiredRegexpUnsupportedDotAll)return regexpUnsupportedDotAll;hasRequiredRegexpUnsupportedDotAll=1;var J=requireFails(),Y=requireGlobalThis(),re=Y.RegExp;return regexpUnsupportedDotAll=J(function(){var ae=re(".","s");return!(ae.dotAll&&ae.test(`
`)&&ae.flags==="s")}),regexpUnsupportedDotAll}var regexpUnsupportedNcg,hasRequiredRegexpUnsupportedNcg;function requireRegexpUnsupportedNcg(){if(hasRequiredRegexpUnsupportedNcg)return regexpUnsupportedNcg;hasRequiredRegexpUnsupportedNcg=1;var J=requireFails(),Y=requireGlobalThis(),re=Y.RegExp;return regexpUnsupportedNcg=J(function(){var ae=re("(?<a>b)","g");return ae.exec("b").groups.a!=="b"||"b".replace(ae,"$<a>c")!=="bc"}),regexpUnsupportedNcg}var hasRequiredEs_regexp_constructor;function requireEs_regexp_constructor(){if(hasRequiredEs_regexp_constructor)return es_regexp_constructor;hasRequiredEs_regexp_constructor=1;var J=requireDescriptors(),Y=requireGlobalThis(),re=requireFunctionUncurryThis(),ae=requireIsForced(),ne=requireInheritIfRequired(),ce=requireCreateNonEnumerableProperty(),ee=requireObjectCreate(),R=requireObjectGetOwnPropertyNames().f,U=requireObjectIsPrototypeOf(),K=requireIsRegexp(),oe=requireToString$1(),pe=requireRegexpGetFlags(),_e=requireRegexpStickyHelpers(),me=requireProxyAccessor(),we=requireDefineBuiltIn(),Oe=requireFails(),De=requireHasOwnProperty(),Ae=requireInternalState().enforce,Ce=requireSetSpecies(),je=requireWellKnownSymbol(),ke=requireRegexpUnsupportedDotAll(),Be=requireRegexpUnsupportedNcg(),We=je("match"),Je=Y.RegExp,Ke=Je.prototype,et=Y.SyntaxError,it=re(Ke.exec),nt=re("".charAt),ct=re("".replace),ft=re("".indexOf),_t=re("".slice),Rt=/^\?<[^\s\d!#%&*+<=>@^][^\s!#%&*+<=>@^]*>/,Ft=/a/g,ht=/a/g,St=new Je(Ft)!==Ft,ut=_e.MISSED_STICKY,Et=_e.UNSUPPORTED_Y,bt=J&&(!St||ut||ke||Be||Oe(function(){return ht[We]=!1,Je(Ft)!==Ft||Je(ht)===ht||String(Je(Ft,"i"))!=="/a/i"})),Dt=function(yr){for(var Wt=yr.length,or=0,wr="",Ir=!1,br;or<=Wt;or++){if(br=nt(yr,or),br==="\\"){wr+=br+nt(yr,++or);continue}!Ir&&br==="."?wr+="[\\s\\S]":(br==="["?Ir=!0:br==="]"&&(Ir=!1),wr+=br)}return wr},Ut=function(yr){for(var Wt=yr.length,or=0,wr="",Ir=[],br=ee(null),gr=!1,Mr=!1,Hr=0,jr="",Sr;or<=Wt;or++){if(Sr=nt(yr,or),Sr==="\\")Sr+=nt(yr,++or);else if(Sr==="]")gr=!1;else if(!gr)switch(!0){case Sr==="[":gr=!0;break;case Sr==="(":if(wr+=Sr,_t(yr,or+1,or+3)==="?:")continue;it(Rt,_t(yr,or+1))&&(or+=2,Mr=!0),Hr++;continue;case(Sr===">"&&Mr):if(jr===""||De(br,jr))throw new et("Invalid capture group name");br[jr]=!0,Ir[Ir.length]=[jr,Hr],Mr=!1,jr="";continue}Mr?jr+=Sr:wr+=Sr}return[wr,Ir]};if(ae("RegExp",bt)){for(var er=function(Wt,or){var wr=U(Ke,this),Ir=K(Wt),br=or===void 0,gr=[],Mr=Wt,Hr,jr,Sr,Nr,Dr,Lr;if(!wr&&Ir&&br&&Wt.constructor===er)return Wt;if((Ir||U(Ke,Wt))&&(Wt=Wt.source,br&&(or=pe(Mr))),Wt=Wt===void 0?"":oe(Wt),or=or===void 0?"":oe(or),Mr=Wt,ke&&"dotAll"in Ft&&(jr=!!or&&ft(or,"s")>-1,jr&&(or=ct(or,/s/g,""))),Hr=or,ut&&"sticky"in Ft&&(Sr=!!or&&ft(or,"y")>-1,Sr&&Et&&(or=ct(or,/y/g,""))),Be&&(Nr=Ut(Wt),Wt=Nr[0],gr=Nr[1]),Dr=ne(Je(Wt,or),wr?this:Ke,er),(jr||Sr||gr.length)&&(Lr=Ae(Dr),jr&&(Lr.dotAll=!0,Lr.raw=er(Dt(Wt),Hr)),Sr&&(Lr.sticky=!0),gr.length&&(Lr.groups=gr)),Wt!==Mr)try{ce(Dr,"source",Mr===""?"(?:)":Mr)}catch{}return Dr},xr=R(Je),ur=0;xr.length>ur;)me(er,Je,xr[ur++]);Ke.constructor=er,er.prototype=Ke,we(Y,"RegExp",er,{constructor:!0})}return Ce("RegExp"),es_regexp_constructor}var es_regexp_escape={},aString,hasRequiredAString;function requireAString(){if(hasRequiredAString)return aString;hasRequiredAString=1;var J=TypeError;return aString=function(Y){if(typeof Y=="string")return Y;throw new J("Argument is not a string")},aString}var hasRequiredEs_regexp_escape;function requireEs_regexp_escape(){if(hasRequiredEs_regexp_escape)return es_regexp_escape;hasRequiredEs_regexp_escape=1;var J=require_export(),Y=requireFunctionUncurryThis(),re=requireAString(),ae=requireHasOwnProperty(),ne=requireStringPad().start,ce=requireWhitespaces(),ee=Array,R=RegExp.escape,U=Y("".charAt),K=Y("".charCodeAt),oe=Y(1.1.toString),pe=Y([].join),_e=/^[0-9a-z]/i,me=/^[$()*+./?[\\\]^{|}]/,we=RegExp("^[!\"#%&',\\-:;<=>@`~"+ce+"]"),Oe=Y(_e.exec),De={"	":"t","\n":"n","\v":"v","\f":"f","\r":"r"},Ae=function(je){var ke=oe(K(je,0),16);return ke.length<3?"\\x"+ne(ke,2,"0"):"\\u"+ne(ke,4,"0")},Ce=!R||R("ab")!=="\\x61b";return J({target:"RegExp",stat:!0,forced:Ce},{escape:function(ke){re(ke);for(var Be=ke.length,We=ee(Be),Je=0;Je<Be;Je++){var Ke=U(ke,Je);if(Je===0&&Oe(_e,Ke))We[Je]=Ae(Ke);else if(ae(De,Ke))We[Je]="\\"+De[Ke];else if(Oe(me,Ke))We[Je]="\\"+Ke;else if(Oe(we,Ke))We[Je]=Ae(Ke);else{var et=K(Ke,0);(et&63488)!==55296?We[Je]=Ke:et>=56320||Je+1>=Be||(K(ke,Je+1)&64512)!==56320?We[Je]=Ae(Ke):(We[Je]=Ke,We[++Je]=U(ke,Je))}}return pe(We,"")}}),es_regexp_escape}var es_regexp_dotAll={},hasRequiredEs_regexp_dotAll;function requireEs_regexp_dotAll(){if(hasRequiredEs_regexp_dotAll)return es_regexp_dotAll;hasRequiredEs_regexp_dotAll=1;var J=requireDescriptors(),Y=requireRegexpUnsupportedDotAll(),re=requireClassofRaw(),ae=requireDefineBuiltInAccessor(),ne=requireInternalState().get,ce=RegExp.prototype,ee=TypeError;return J&&Y&&ae(ce,"dotAll",{configurable:!0,get:function(){if(this!==ce){if(re(this)==="RegExp")return!!ne(this).dotAll;throw new ee("Incompatible receiver, RegExp required")}}}),es_regexp_dotAll}var es_regexp_exec={},regexpExec,hasRequiredRegexpExec;function requireRegexpExec(){if(hasRequiredRegexpExec)return regexpExec;hasRequiredRegexpExec=1;var J=requireFunctionCall(),Y=requireFunctionUncurryThis(),re=requireToString$1(),ae=requireRegexpFlags(),ne=requireRegexpStickyHelpers(),ce=requireShared(),ee=requireObjectCreate(),R=requireInternalState().get,U=requireRegexpUnsupportedDotAll(),K=requireRegexpUnsupportedNcg(),oe=ce("native-string-replace",String.prototype.replace),pe=RegExp.prototype.exec,_e=pe,me=Y("".charAt),we=Y("".indexOf),Oe=Y("".replace),De=Y("".slice),Ae=(function(){var Be=/a/,We=/b*/g;return J(pe,Be,"a"),J(pe,We,"a"),Be.lastIndex!==0||We.lastIndex!==0})(),Ce=ne.BROKEN_CARET,je=/()??/.exec("")[1]!==void 0,ke=Ae||je||Ce||U||K;return ke&&(_e=function(We){var Je=this,Ke=R(Je),et=re(We),it=Ke.raw,nt,ct,ft,_t,Rt,Ft,ht;if(it)return it.lastIndex=Je.lastIndex,nt=J(_e,it,et),Je.lastIndex=it.lastIndex,nt;var St=Ke.groups,ut=Ce&&Je.sticky,Et=J(ae,Je),bt=Je.source,Dt=0,Ut=et;if(ut&&(Et=Oe(Et,"y",""),we(Et,"g")===-1&&(Et+="g"),Ut=De(et,Je.lastIndex),Je.lastIndex>0&&(!Je.multiline||Je.multiline&&me(et,Je.lastIndex-1)!==`
`)&&(bt="(?: "+bt+")",Ut=" "+Ut,Dt++),ct=new RegExp("^(?:"+bt+")",Et)),je&&(ct=new RegExp("^"+bt+"$(?!\\s)",Et)),Ae&&(ft=Je.lastIndex),_t=J(pe,ut?ct:Je,Ut),ut?_t?(_t.input=De(_t.input,Dt),_t[0]=De(_t[0],Dt),_t.index=Je.lastIndex,Je.lastIndex+=_t[0].length):Je.lastIndex=0:Ae&&_t&&(Je.lastIndex=Je.global?_t.index+_t[0].length:ft),je&&_t&&_t.length>1&&J(oe,_t[0],ct,function(){for(Rt=1;Rt<arguments.length-2;Rt++)arguments[Rt]===void 0&&(_t[Rt]=void 0)}),_t&&St)for(_t.groups=Ft=ee(null),Rt=0;Rt<St.length;Rt++)ht=St[Rt],Ft[ht[0]]=_t[ht[1]];return _t}),regexpExec=_e,regexpExec}var hasRequiredEs_regexp_exec;function requireEs_regexp_exec(){if(hasRequiredEs_regexp_exec)return es_regexp_exec;hasRequiredEs_regexp_exec=1;var J=require_export(),Y=requireRegexpExec();return J({target:"RegExp",proto:!0,forced:/./.exec!==Y},{exec:Y}),es_regexp_exec}var es_regexp_flags={},hasRequiredEs_regexp_flags;function requireEs_regexp_flags(){if(hasRequiredEs_regexp_flags)return es_regexp_flags;hasRequiredEs_regexp_flags=1;var J=requireDescriptors(),Y=requireDefineBuiltInAccessor(),re=requireRegexpFlagsDetection(),ae=requireRegexpFlags();return J&&!re.correct&&(Y(RegExp.prototype,"flags",{configurable:!0,get:ae}),re.correct=!0),es_regexp_flags}var es_regexp_sticky={},hasRequiredEs_regexp_sticky;function requireEs_regexp_sticky(){if(hasRequiredEs_regexp_sticky)return es_regexp_sticky;hasRequiredEs_regexp_sticky=1;var J=requireDescriptors(),Y=requireRegexpStickyHelpers().MISSED_STICKY,re=requireClassofRaw(),ae=requireDefineBuiltInAccessor(),ne=requireInternalState().get,ce=RegExp.prototype,ee=TypeError;return J&&Y&&ae(ce,"sticky",{configurable:!0,get:function(){if(this!==ce){if(re(this)==="RegExp")return!!ne(this).sticky;throw new ee("Incompatible receiver, RegExp required")}}}),es_regexp_sticky}var es_regexp_test={},hasRequiredEs_regexp_test;function requireEs_regexp_test(){if(hasRequiredEs_regexp_test)return es_regexp_test;hasRequiredEs_regexp_test=1,requireEs_regexp_exec();var J=require_export(),Y=requireFunctionCall(),re=requireIsCallable(),ae=requireAnObject(),ne=requireToString$1(),ce=(function(){var R=!1,U=/[ac]/;return U.exec=function(){return R=!0,/./.exec.apply(this,arguments)},U.test("abc")===!0&&R})(),ee=/./.test;return J({target:"RegExp",proto:!0,forced:!ce},{test:function(R){var U=ae(this),K=ne(R),oe=U.exec;if(!re(oe))return Y(ee,U,K);var pe=Y(oe,U,K);return pe===null?!1:(ae(pe),!0)}}),es_regexp_test}var es_regexp_toString={},hasRequiredEs_regexp_toString;function requireEs_regexp_toString(){if(hasRequiredEs_regexp_toString)return es_regexp_toString;hasRequiredEs_regexp_toString=1;var J=requireFunctionName().PROPER,Y=requireDefineBuiltIn(),re=requireAnObject(),ae=requireToString$1(),ne=requireFails(),ce=requireRegexpGetFlags(),ee="toString",R=RegExp.prototype,U=R[ee],K=ne(function(){return U.call({source:"a",flags:"b"})!=="/a/b"}),oe=J&&U.name!==ee;return(K||oe)&&Y(R,ee,function(){var _e=re(this),me=ae(_e.source),we=ae(ce(_e));return"/"+me+"/"+we},{unsafe:!0}),es_regexp_toString}var es_set={},es_set_constructor={},hasRequiredEs_set_constructor;function requireEs_set_constructor(){if(hasRequiredEs_set_constructor)return es_set_constructor;hasRequiredEs_set_constructor=1;var J=requireCollection(),Y=requireCollectionStrong();return J("Set",function(re){return function(){return re(this,arguments.length?arguments[0]:void 0)}},Y),es_set_constructor}var hasRequiredEs_set;function requireEs_set(){return hasRequiredEs_set||(hasRequiredEs_set=1,requireEs_set_constructor()),es_set}var es_set_difference_v2={},setHelpers,hasRequiredSetHelpers;function requireSetHelpers(){if(hasRequiredSetHelpers)return setHelpers;hasRequiredSetHelpers=1;var J=requireFunctionUncurryThis(),Y=Set.prototype;return setHelpers={Set,add:J(Y.add),has:J(Y.has),remove:J(Y.delete),proto:Y},setHelpers}var aSet,hasRequiredASet;function requireASet(){if(hasRequiredASet)return aSet;hasRequiredASet=1;var J=requireSetHelpers().has;return aSet=function(Y){return J(Y),Y},aSet}var iterateSimple,hasRequiredIterateSimple;function requireIterateSimple(){if(hasRequiredIterateSimple)return iterateSimple;hasRequiredIterateSimple=1;var J=requireFunctionCall();return iterateSimple=function(Y,re,ae){for(var ne=ae?Y:Y.iterator,ce=Y.next,ee,R;!(ee=J(ce,ne)).done;)if(R=re(ee.value),R!==void 0)return R},iterateSimple}var setIterate,hasRequiredSetIterate;function requireSetIterate(){if(hasRequiredSetIterate)return setIterate;hasRequiredSetIterate=1;var J=requireFunctionUncurryThis(),Y=requireIterateSimple(),re=requireSetHelpers(),ae=re.Set,ne=re.proto,ce=J(ne.forEach),ee=J(ne.keys),R=ee(new ae).next;return setIterate=function(U,K,oe){return oe?Y({iterator:ee(U),next:R},K):ce(U,K)},setIterate}var setClone,hasRequiredSetClone;function requireSetClone(){if(hasRequiredSetClone)return setClone;hasRequiredSetClone=1;var J=requireSetHelpers(),Y=requireSetIterate(),re=J.Set,ae=J.add;return setClone=function(ne){var ce=new re;return Y(ne,function(ee){ae(ce,ee)}),ce},setClone}var setSize,hasRequiredSetSize;function requireSetSize(){if(hasRequiredSetSize)return setSize;hasRequiredSetSize=1;var J=requireFunctionUncurryThisAccessor(),Y=requireSetHelpers();return setSize=J(Y.proto,"size","get")||function(re){return re.size},setSize}var getSetRecord,hasRequiredGetSetRecord;function requireGetSetRecord(){if(hasRequiredGetSetRecord)return getSetRecord;hasRequiredGetSetRecord=1;var J=requireACallable(),Y=requireAnObject(),re=requireFunctionCall(),ae=requireToIntegerOrInfinity(),ne=requireGetIteratorDirect(),ce="Invalid size",ee=RangeError,R=TypeError,U=Math.max,K=function(oe,pe){this.set=oe,this.size=U(pe,0),this.has=J(oe.has),this.keys=J(oe.keys)};return K.prototype={getIterator:function(){return ne(Y(re(this.keys,this.set)))},includes:function(oe){return re(this.has,this.set,oe)}},getSetRecord=function(oe){Y(oe);var pe=+oe.size;if(pe!==pe)throw new R(ce);var _e=ae(pe);if(_e<0)throw new ee(ce);return new K(oe,_e)},getSetRecord}var setDifference,hasRequiredSetDifference;function requireSetDifference(){if(hasRequiredSetDifference)return setDifference;hasRequiredSetDifference=1;var J=requireASet(),Y=requireSetHelpers(),re=requireSetClone(),ae=requireSetSize(),ne=requireGetSetRecord(),ce=requireSetIterate(),ee=requireIterateSimple(),R=Y.has,U=Y.remove;return setDifference=function(oe){var pe=J(this),_e=ne(oe),me=re(pe);return ae(pe)<=_e.size?ce(pe,function(we){_e.includes(we)&&U(me,we)}):ee(_e.getIterator(),function(we){R(me,we)&&U(me,we)}),me},setDifference}var setMethodAcceptSetLike,hasRequiredSetMethodAcceptSetLike;function requireSetMethodAcceptSetLike(){if(hasRequiredSetMethodAcceptSetLike)return setMethodAcceptSetLike;hasRequiredSetMethodAcceptSetLike=1;var J=requireGetBuiltIn(),Y=function(ae){return{size:ae,has:function(){return!1},keys:function(){return{next:function(){return{done:!0}}}}}},re=function(ae){return{size:ae,has:function(){return!0},keys:function(){throw new Error("e")}}};return setMethodAcceptSetLike=function(ae,ne){var ce=J("Set");try{new ce()[ae](Y(0));try{return new ce()[ae](Y(-1)),!1}catch{if(!ne)return!0;try{return new ce()[ae](re(-1/0)),!1}catch{var ee=new ce;return ee.add(1),ee.add(2),ne(ee[ae](re(1/0)))}}}catch{return!1}},setMethodAcceptSetLike}var hasRequiredEs_set_difference_v2;function requireEs_set_difference_v2(){if(hasRequiredEs_set_difference_v2)return es_set_difference_v2;hasRequiredEs_set_difference_v2=1;var J=require_export(),Y=requireSetDifference(),re=requireFails(),ae=requireSetMethodAcceptSetLike(),ne=!ae("difference",function(ee){return ee.size===0}),ce=ne||re(function(){var ee={size:1,has:function(){return!0},keys:function(){var U=0;return{next:function(){var K=U++>1;return R.has(1)&&R.clear(),{done:K,value:2}}}}},R=new Set([1,2,3,4]);return R.difference(ee).size!==3});return J({target:"Set",proto:!0,real:!0,forced:ce},{difference:Y}),es_set_difference_v2}var es_set_intersection_v2={},setIntersection,hasRequiredSetIntersection;function requireSetIntersection(){if(hasRequiredSetIntersection)return setIntersection;hasRequiredSetIntersection=1;var J=requireASet(),Y=requireSetHelpers(),re=requireSetSize(),ae=requireGetSetRecord(),ne=requireSetIterate(),ce=requireIterateSimple(),ee=Y.Set,R=Y.add,U=Y.has;return setIntersection=function(oe){var pe=J(this),_e=ae(oe),me=new ee;return re(pe)>_e.size?ce(_e.getIterator(),function(we){U(pe,we)&&R(me,we)}):ne(pe,function(we){_e.includes(we)&&R(me,we)}),me},setIntersection}var hasRequiredEs_set_intersection_v2;function requireEs_set_intersection_v2(){if(hasRequiredEs_set_intersection_v2)return es_set_intersection_v2;hasRequiredEs_set_intersection_v2=1;var J=require_export(),Y=requireFails(),re=requireSetIntersection(),ae=requireSetMethodAcceptSetLike(),ne=!ae("intersection",function(ce){return ce.size===2&&ce.has(1)&&ce.has(2)})||Y(function(){return String(Array.from(new Set([1,2,3]).intersection(new Set([3,2]))))!=="3,2"});return J({target:"Set",proto:!0,real:!0,forced:ne},{intersection:re}),es_set_intersection_v2}var es_set_isDisjointFrom_v2={},setIsDisjointFrom,hasRequiredSetIsDisjointFrom;function requireSetIsDisjointFrom(){if(hasRequiredSetIsDisjointFrom)return setIsDisjointFrom;hasRequiredSetIsDisjointFrom=1;var J=requireASet(),Y=requireSetHelpers().has,re=requireSetSize(),ae=requireGetSetRecord(),ne=requireSetIterate(),ce=requireIterateSimple(),ee=requireIteratorClose();return setIsDisjointFrom=function(U){var K=J(this),oe=ae(U);if(re(K)<=oe.size)return ne(K,function(_e){if(oe.includes(_e))return!1},!0)!==!1;var pe=oe.getIterator();return ce(pe,function(_e){if(Y(K,_e))return ee(pe,"normal",!1)})!==!1},setIsDisjointFrom}var hasRequiredEs_set_isDisjointFrom_v2;function requireEs_set_isDisjointFrom_v2(){if(hasRequiredEs_set_isDisjointFrom_v2)return es_set_isDisjointFrom_v2;hasRequiredEs_set_isDisjointFrom_v2=1;var J=require_export(),Y=requireSetIsDisjointFrom(),re=requireSetMethodAcceptSetLike(),ae=!re("isDisjointFrom",function(ne){return!ne});return J({target:"Set",proto:!0,real:!0,forced:ae},{isDisjointFrom:Y}),es_set_isDisjointFrom_v2}var es_set_isSubsetOf_v2={},setIsSubsetOf,hasRequiredSetIsSubsetOf;function requireSetIsSubsetOf(){if(hasRequiredSetIsSubsetOf)return setIsSubsetOf;hasRequiredSetIsSubsetOf=1;var J=requireASet(),Y=requireSetSize(),re=requireSetIterate(),ae=requireGetSetRecord();return setIsSubsetOf=function(ce){var ee=J(this),R=ae(ce);return Y(ee)>R.size?!1:re(ee,function(U){if(!R.includes(U))return!1},!0)!==!1},setIsSubsetOf}var hasRequiredEs_set_isSubsetOf_v2;function requireEs_set_isSubsetOf_v2(){if(hasRequiredEs_set_isSubsetOf_v2)return es_set_isSubsetOf_v2;hasRequiredEs_set_isSubsetOf_v2=1;var J=require_export(),Y=requireSetIsSubsetOf(),re=requireSetMethodAcceptSetLike(),ae=!re("isSubsetOf",function(ne){return ne});return J({target:"Set",proto:!0,real:!0,forced:ae},{isSubsetOf:Y}),es_set_isSubsetOf_v2}var es_set_isSupersetOf_v2={},setIsSupersetOf,hasRequiredSetIsSupersetOf;function requireSetIsSupersetOf(){if(hasRequiredSetIsSupersetOf)return setIsSupersetOf;hasRequiredSetIsSupersetOf=1;var J=requireASet(),Y=requireSetHelpers().has,re=requireSetSize(),ae=requireGetSetRecord(),ne=requireIterateSimple(),ce=requireIteratorClose();return setIsSupersetOf=function(R){var U=J(this),K=ae(R);if(re(U)<K.size)return!1;var oe=K.getIterator();return ne(oe,function(pe){if(!Y(U,pe))return ce(oe,"normal",!1)})!==!1},setIsSupersetOf}var hasRequiredEs_set_isSupersetOf_v2;function requireEs_set_isSupersetOf_v2(){if(hasRequiredEs_set_isSupersetOf_v2)return es_set_isSupersetOf_v2;hasRequiredEs_set_isSupersetOf_v2=1;var J=require_export(),Y=requireSetIsSupersetOf(),re=requireSetMethodAcceptSetLike(),ae=!re("isSupersetOf",function(ne){return!ne});return J({target:"Set",proto:!0,real:!0,forced:ae},{isSupersetOf:Y}),es_set_isSupersetOf_v2}var es_set_symmetricDifference_v2={},setSymmetricDifference,hasRequiredSetSymmetricDifference;function requireSetSymmetricDifference(){if(hasRequiredSetSymmetricDifference)return setSymmetricDifference;hasRequiredSetSymmetricDifference=1;var J=requireASet(),Y=requireSetHelpers(),re=requireSetClone(),ae=requireGetSetRecord(),ne=requireIterateSimple(),ce=Y.add,ee=Y.has,R=Y.remove;return setSymmetricDifference=function(K){var oe=J(this),pe=ae(K).getIterator(),_e=re(oe);return ne(pe,function(me){ee(oe,me)?R(_e,me):ce(_e,me)}),_e},setSymmetricDifference}var setMethodGetKeysBeforeCloningDetection,hasRequiredSetMethodGetKeysBeforeCloningDetection;function requireSetMethodGetKeysBeforeCloningDetection(){return hasRequiredSetMethodGetKeysBeforeCloningDetection||(hasRequiredSetMethodGetKeysBeforeCloningDetection=1,setMethodGetKeysBeforeCloningDetection=function(J){try{var Y=new Set,re={size:0,has:function(){return!0},keys:function(){return Object.defineProperty({},"next",{get:function(){return Y.clear(),Y.add(4),function(){return{done:!0}}}})}},ae=Y[J](re);return ae.size===1&&ae.values().next().value===4}catch{return!1}}),setMethodGetKeysBeforeCloningDetection}var hasRequiredEs_set_symmetricDifference_v2;function requireEs_set_symmetricDifference_v2(){if(hasRequiredEs_set_symmetricDifference_v2)return es_set_symmetricDifference_v2;hasRequiredEs_set_symmetricDifference_v2=1;var J=require_export(),Y=requireSetSymmetricDifference(),re=requireSetMethodGetKeysBeforeCloningDetection(),ae=requireSetMethodAcceptSetLike(),ne=!ae("symmetricDifference")||!re("symmetricDifference");return J({target:"Set",proto:!0,real:!0,forced:ne},{symmetricDifference:Y}),es_set_symmetricDifference_v2}var es_set_union_v2={},setUnion,hasRequiredSetUnion;function requireSetUnion(){if(hasRequiredSetUnion)return setUnion;hasRequiredSetUnion=1;var J=requireASet(),Y=requireSetHelpers().add,re=requireSetClone(),ae=requireGetSetRecord(),ne=requireIterateSimple();return setUnion=function(ee){var R=J(this),U=ae(ee).getIterator(),K=re(R);return ne(U,function(oe){Y(K,oe)}),K},setUnion}var hasRequiredEs_set_union_v2;function requireEs_set_union_v2(){if(hasRequiredEs_set_union_v2)return es_set_union_v2;hasRequiredEs_set_union_v2=1;var J=require_export(),Y=requireSetUnion(),re=requireSetMethodGetKeysBeforeCloningDetection(),ae=requireSetMethodAcceptSetLike(),ne=!ae("union")||!re("union");return J({target:"Set",proto:!0,real:!0,forced:ne},{union:Y}),es_set_union_v2}var es_string_atAlternative={},hasRequiredEs_string_atAlternative;function requireEs_string_atAlternative(){if(hasRequiredEs_string_atAlternative)return es_string_atAlternative;hasRequiredEs_string_atAlternative=1;var J=require_export(),Y=requireFunctionUncurryThis(),re=requireRequireObjectCoercible(),ae=requireToIntegerOrInfinity(),ne=requireToString$1(),ce=requireFails(),ee=Y("".charAt),R=ce(function(){return"ð ®·".at(-2)!=="\uD842"});return J({target:"String",proto:!0,forced:R},{at:function(K){var oe=ne(re(this)),pe=oe.length,_e=ae(K),me=_e>=0?_e:pe+_e;return me<0||me>=pe?void 0:ee(oe,me)}}),es_string_atAlternative}var es_string_codePointAt={},stringMultibyte,hasRequiredStringMultibyte;function requireStringMultibyte(){if(hasRequiredStringMultibyte)return stringMultibyte;hasRequiredStringMultibyte=1;var J=requireFunctionUncurryThis(),Y=requireToIntegerOrInfinity(),re=requireToString$1(),ae=requireRequireObjectCoercible(),ne=J("".charAt),ce=J("".charCodeAt),ee=J("".slice),R=function(U){return function(K,oe){var pe=re(ae(K)),_e=Y(oe),me=pe.length,we,Oe;return _e<0||_e>=me?U?"":void 0:(we=ce(pe,_e),we<55296||we>56319||_e+1===me||(Oe=ce(pe,_e+1))<56320||Oe>57343?U?ne(pe,_e):we:U?ee(pe,_e,_e+2):(we-55296<<10)+(Oe-56320)+65536)}};return stringMultibyte={codeAt:R(!1),charAt:R(!0)},stringMultibyte}var hasRequiredEs_string_codePointAt;function requireEs_string_codePointAt(){if(hasRequiredEs_string_codePointAt)return es_string_codePointAt;hasRequiredEs_string_codePointAt=1;var J=require_export(),Y=requireStringMultibyte().codeAt;return J({target:"String",proto:!0},{codePointAt:function(ae){return Y(this,ae)}}),es_string_codePointAt}var es_string_endsWith={},notARegexp,hasRequiredNotARegexp;function requireNotARegexp(){if(hasRequiredNotARegexp)return notARegexp;hasRequiredNotARegexp=1;var J=requireIsRegexp(),Y=TypeError;return notARegexp=function(re){if(J(re))throw new Y("The method doesn't accept regular expressions");return re},notARegexp}var correctIsRegexpLogic,hasRequiredCorrectIsRegexpLogic;function requireCorrectIsRegexpLogic(){if(hasRequiredCorrectIsRegexpLogic)return correctIsRegexpLogic;hasRequiredCorrectIsRegexpLogic=1;var J=requireWellKnownSymbol(),Y=J("match");return correctIsRegexpLogic=function(re){var ae=/./;try{"/./"[re](ae)}catch{try{return ae[Y]=!1,"/./"[re](ae)}catch{}}return!1},correctIsRegexpLogic}var hasRequiredEs_string_endsWith;function requireEs_string_endsWith(){if(hasRequiredEs_string_endsWith)return es_string_endsWith;hasRequiredEs_string_endsWith=1;var J=require_export(),Y=requireFunctionUncurryThisClause(),re=requireObjectGetOwnPropertyDescriptor().f,ae=requireToLength(),ne=requireToString$1(),ce=requireNotARegexp(),ee=requireRequireObjectCoercible(),R=requireCorrectIsRegexpLogic(),U=requireIsPure(),K=Y("".slice),oe=Math.min,pe=R("endsWith"),_e=!U&&!pe&&!!(function(){var me=re(String.prototype,"endsWith");return me&&!me.writable})();return J({target:"String",proto:!0,forced:!_e&&!pe},{endsWith:function(we){var Oe=ne(ee(this));ce(we);var De=arguments.length>1?arguments[1]:void 0,Ae=Oe.length,Ce=De===void 0?Ae:oe(ae(De),Ae),je=ne(we);return K(Oe,Ce-je.length,Ce)===je}}),es_string_endsWith}var es_string_fromCodePoint={},hasRequiredEs_string_fromCodePoint;function requireEs_string_fromCodePoint(){if(hasRequiredEs_string_fromCodePoint)return es_string_fromCodePoint;hasRequiredEs_string_fromCodePoint=1;var J=require_export(),Y=requireFunctionUncurryThis(),re=requireToAbsoluteIndex(),ae=RangeError,ne=String.fromCharCode,ce=String.fromCodePoint,ee=Y([].join),R=!!ce&&ce.length!==1;return J({target:"String",stat:!0,arity:1,forced:R},{fromCodePoint:function(K){for(var oe=[],pe=arguments.length,_e=0,me;pe>_e;){if(me=+arguments[_e++],re(me,1114111)!==me)throw new ae(me+" is not a valid code point");oe[_e]=me<65536?ne(me):ne(((me-=65536)>>10)+55296,me%1024+56320)}return ee(oe,"")}}),es_string_fromCodePoint}var es_string_includes={},hasRequiredEs_string_includes;function requireEs_string_includes(){if(hasRequiredEs_string_includes)return es_string_includes;hasRequiredEs_string_includes=1;var J=require_export(),Y=requireFunctionUncurryThis(),re=requireNotARegexp(),ae=requireRequireObjectCoercible(),ne=requireToString$1(),ce=requireCorrectIsRegexpLogic(),ee=Y("".indexOf);return J({target:"String",proto:!0,forced:!ce("includes")},{includes:function(U){return!!~ee(ne(ae(this)),ne(re(U)),arguments.length>1?arguments[1]:void 0)}}),es_string_includes}var es_string_isWellFormed={},hasRequiredEs_string_isWellFormed;function requireEs_string_isWellFormed(){if(hasRequiredEs_string_isWellFormed)return es_string_isWellFormed;hasRequiredEs_string_isWellFormed=1;var J=require_export(),Y=requireFunctionUncurryThis(),re=requireRequireObjectCoercible(),ae=requireToString$1(),ne=Y("".charCodeAt);return J({target:"String",proto:!0},{isWellFormed:function(){for(var ee=ae(re(this)),R=ee.length,U=0;U<R;U++){var K=ne(ee,U);if((K&63488)===55296&&(K>=56320||++U>=R||(ne(ee,U)&64512)!==56320))return!1}return!0}}),es_string_isWellFormed}var es_string_iterator={},hasRequiredEs_string_iterator;function requireEs_string_iterator(){if(hasRequiredEs_string_iterator)return es_string_iterator;hasRequiredEs_string_iterator=1;var J=requireStringMultibyte().charAt,Y=requireToString$1(),re=requireInternalState(),ae=requireIteratorDefine(),ne=requireCreateIterResultObject(),ce="String Iterator",ee=re.set,R=re.getterFor(ce);return ae(String,"String",function(U){ee(this,{type:ce,string:Y(U),index:0})},function(){var K=R(this),oe=K.string,pe=K.index,_e;return pe>=oe.length?ne(void 0,!0):(_e=J(oe,pe),K.index+=_e.length,ne(_e,!1))}),es_string_iterator}var es_string_match={},fixRegexpWellKnownSymbolLogic,hasRequiredFixRegexpWellKnownSymbolLogic;function requireFixRegexpWellKnownSymbolLogic(){if(hasRequiredFixRegexpWellKnownSymbolLogic)return fixRegexpWellKnownSymbolLogic;hasRequiredFixRegexpWellKnownSymbolLogic=1,requireEs_regexp_exec();var J=requireFunctionCall(),Y=requireDefineBuiltIn(),re=requireRegexpExec(),ae=requireFails(),ne=requireWellKnownSymbol(),ce=requireCreateNonEnumerableProperty(),ee=ne("species"),R=RegExp.prototype;return fixRegexpWellKnownSymbolLogic=function(U,K,oe,pe){var _e=ne(U),me=!ae(function(){var Ae={};return Ae[_e]=function(){return 7},""[U](Ae)!==7}),we=me&&!ae(function(){var Ae=!1,Ce=/a/;return U==="split"&&(Ce={},Ce.constructor={},Ce.constructor[ee]=function(){return Ce},Ce.flags="",Ce[_e]=/./[_e]),Ce.exec=function(){return Ae=!0,null},Ce[_e](""),!Ae});if(!me||!we||oe){var Oe=/./[_e],De=K(_e,""[U],function(Ae,Ce,je,ke,Be){var We=Ce.exec;return We===re||We===R.exec?me&&!Be?{done:!0,value:J(Oe,Ce,je,ke)}:{done:!0,value:J(Ae,je,Ce,ke)}:{done:!1}});Y(String.prototype,U,De[0]),Y(R,_e,De[1])}pe&&ce(R[_e],"sham",!0)},fixRegexpWellKnownSymbolLogic}var advanceStringIndex,hasRequiredAdvanceStringIndex;function requireAdvanceStringIndex(){if(hasRequiredAdvanceStringIndex)return advanceStringIndex;hasRequiredAdvanceStringIndex=1;var J=requireStringMultibyte().charAt;return advanceStringIndex=function(Y,re,ae){return re+(ae?J(Y,re).length:1)},advanceStringIndex}var regexpExecAbstract,hasRequiredRegexpExecAbstract;function requireRegexpExecAbstract(){if(hasRequiredRegexpExecAbstract)return regexpExecAbstract;hasRequiredRegexpExecAbstract=1;var J=requireFunctionCall(),Y=requireAnObject(),re=requireIsCallable(),ae=requireClassofRaw(),ne=requireRegexpExec(),ce=TypeError;return regexpExecAbstract=function(ee,R){var U=ee.exec;if(re(U)){var K=J(U,ee,R);return K!==null&&Y(K),K}if(ae(ee)==="RegExp")return J(ne,ee,R);throw new ce("RegExp#exec called on incompatible receiver")},regexpExecAbstract}var hasRequiredEs_string_match;function requireEs_string_match(){if(hasRequiredEs_string_match)return es_string_match;hasRequiredEs_string_match=1;var J=requireFunctionCall(),Y=requireFunctionUncurryThis(),re=requireFixRegexpWellKnownSymbolLogic(),ae=requireAnObject(),ne=requireIsObject$1(),ce=requireToLength(),ee=requireToString$1(),R=requireRequireObjectCoercible(),U=requireGetMethod(),K=requireAdvanceStringIndex(),oe=requireRegexpGetFlags(),pe=requireRegexpExecAbstract(),_e=Y("".indexOf);return re("match",function(me,we,Oe){return[function(Ae){var Ce=R(this),je=ne(Ae)?U(Ae,me):void 0;return je?J(je,Ae,Ce):new RegExp(Ae)[me](ee(Ce))},function(De){var Ae=ae(this),Ce=ee(De),je=Oe(we,Ae,Ce);if(je.done)return je.value;var ke=ee(oe(Ae));if(_e(ke,"g")===-1)return pe(Ae,Ce);var Be=_e(ke,"u")!==-1;Ae.lastIndex=0;for(var We=[],Je=0,Ke;(Ke=pe(Ae,Ce))!==null;){var et=ee(Ke[0]);We[Je]=et,et===""&&(Ae.lastIndex=K(Ce,ce(Ae.lastIndex),Be)),Je++}return Je===0?null:We}]}),es_string_match}var es_string_matchAll={},hasRequiredEs_string_matchAll;function requireEs_string_matchAll(){if(hasRequiredEs_string_matchAll)return es_string_matchAll;hasRequiredEs_string_matchAll=1;var J=require_export(),Y=requireFunctionCall(),re=requireFunctionUncurryThisClause(),ae=requireIteratorCreateConstructor(),ne=requireCreateIterResultObject(),ce=requireRequireObjectCoercible(),ee=requireToLength(),R=requireToString$1(),U=requireAnObject(),K=requireIsObject$1(),oe=requireClassofRaw(),pe=requireIsRegexp(),_e=requireRegexpGetFlags(),me=requireGetMethod(),we=requireDefineBuiltIn(),Oe=requireFails(),De=requireWellKnownSymbol(),Ae=requireSpeciesConstructor(),Ce=requireAdvanceStringIndex(),je=requireRegexpExecAbstract(),ke=requireInternalState(),Be=requireIsPure(),We=De("matchAll"),Je="RegExp String",Ke=Je+" Iterator",et=ke.set,it=ke.getterFor(Ke),nt=RegExp.prototype,ct=TypeError,ft=re("".indexOf),_t=re("".matchAll),Rt=!!_t&&!Oe(function(){_t("a",/./)}),Ft=ae(function(ut,Et,bt,Dt){et(this,{type:Ke,regexp:ut,string:Et,global:bt,unicode:Dt,done:!1})},Je,function(){var ut=it(this);if(ut.done)return ne(void 0,!0);var Et=ut.regexp,bt=ut.string,Dt=je(Et,bt);return Dt===null?(ut.done=!0,ne(void 0,!0)):ut.global?(R(Dt[0])===""&&(Et.lastIndex=Ce(bt,ee(Et.lastIndex),ut.unicode)),ne(Dt,!1)):(ut.done=!0,ne(Dt,!1))}),ht=function(St){var ut=U(this),Et=R(St),bt=Ae(ut,RegExp),Dt=R(_e(ut)),Ut,er,xr;return Ut=new bt(bt===RegExp?ut.source:ut,Dt),er=!!~ft(Dt,"g"),xr=!!~ft(Dt,"u"),Ut.lastIndex=ee(ut.lastIndex),new Ft(Ut,Et,er,xr)};return J({target:"String",proto:!0,forced:Rt},{matchAll:function(ut){var Et=ce(this),bt,Dt,Ut,er;if(K(ut)){if(pe(ut)&&(bt=R(ce(_e(ut))),!~ft(bt,"g")))throw new ct("`.matchAll` does not allow non-global regexes");if(Rt)return _t(Et,ut);if(Ut=me(ut,We),Ut===void 0&&Be&&oe(ut)==="RegExp"&&(Ut=ht),Ut)return Y(Ut,ut,Et)}else if(Rt)return _t(Et,ut);return Dt=R(Et),er=new RegExp(ut,"g"),Be?Y(ht,er,Dt):er[We](Dt)}}),Be||We in nt||we(nt,We,ht),es_string_matchAll}var es_string_padEnd={},stringPadWebkitBug,hasRequiredStringPadWebkitBug;function requireStringPadWebkitBug(){if(hasRequiredStringPadWebkitBug)return stringPadWebkitBug;hasRequiredStringPadWebkitBug=1;var J=requireEnvironmentUserAgent();return stringPadWebkitBug=/Version\/10(?:\.\d+){1,2}(?: [\w./]+)?(?: Mobile\/\w+)? Safari\//.test(J),stringPadWebkitBug}var hasRequiredEs_string_padEnd;function requireEs_string_padEnd(){if(hasRequiredEs_string_padEnd)return es_string_padEnd;hasRequiredEs_string_padEnd=1;var J=require_export(),Y=requireStringPad().end,re=requireStringPadWebkitBug();return J({target:"String",proto:!0,forced:re},{padEnd:function(ne){return Y(this,ne,arguments.length>1?arguments[1]:void 0)}}),es_string_padEnd}var es_string_padStart={},hasRequiredEs_string_padStart;function requireEs_string_padStart(){if(hasRequiredEs_string_padStart)return es_string_padStart;hasRequiredEs_string_padStart=1;var J=require_export(),Y=requireStringPad().start,re=requireStringPadWebkitBug();return J({target:"String",proto:!0,forced:re},{padStart:function(ne){return Y(this,ne,arguments.length>1?arguments[1]:void 0)}}),es_string_padStart}var es_string_raw={},hasRequiredEs_string_raw;function requireEs_string_raw(){if(hasRequiredEs_string_raw)return es_string_raw;hasRequiredEs_string_raw=1;var J=require_export(),Y=requireFunctionUncurryThis(),re=requireToIndexedObject(),ae=requireToObject(),ne=requireToString$1(),ce=requireLengthOfArrayLike(),ee=Y([].push),R=Y([].join);return J({target:"String",stat:!0},{raw:function(K){var oe=re(ae(K).raw),pe=ce(oe);if(!pe)return"";for(var _e=arguments.length,me=[],we=0;;){if(ee(me,ne(oe[we++])),we===pe)return R(me,"");we<_e&&ee(me,ne(arguments[we]))}}}),es_string_raw}var es_string_repeat={},hasRequiredEs_string_repeat;function requireEs_string_repeat(){if(hasRequiredEs_string_repeat)return es_string_repeat;hasRequiredEs_string_repeat=1;var J=require_export(),Y=requireStringRepeat();return J({target:"String",proto:!0},{repeat:Y}),es_string_repeat}var es_string_replace={},getSubstitution,hasRequiredGetSubstitution;function requireGetSubstitution(){if(hasRequiredGetSubstitution)return getSubstitution;hasRequiredGetSubstitution=1;var J=requireFunctionUncurryThis(),Y=requireToObject(),re=Math.floor,ae=J("".charAt),ne=J("".replace),ce=J("".slice),ee=/\$([$&'`]|\d{1,2}|<[^>]*>)/g,R=/\$([$&'`]|\d{1,2})/g;return getSubstitution=function(U,K,oe,pe,_e,me){var we=oe+U.length,Oe=pe.length,De=R;return _e!==void 0&&(_e=Y(_e),De=ee),ne(me,De,function(Ae,Ce){var je;switch(ae(Ce,0)){case"$":return"$";case"&":return U;case"`":return ce(K,0,oe);case"'":return ce(K,we);case"<":je=_e[ce(Ce,1,-1)];break;default:var ke=+Ce;if(ke===0)return Ae;if(ke>Oe){var Be=re(ke/10);return Be===0?Ae:Be<=Oe?pe[Be-1]===void 0?ae(Ce,1):pe[Be-1]+ae(Ce,1):Ae}je=pe[ke-1]}return je===void 0?"":je})},getSubstitution}var hasRequiredEs_string_replace;function requireEs_string_replace(){if(hasRequiredEs_string_replace)return es_string_replace;hasRequiredEs_string_replace=1;var J=requireFunctionApply(),Y=requireFunctionCall(),re=requireFunctionUncurryThis(),ae=requireFixRegexpWellKnownSymbolLogic(),ne=requireFails(),ce=requireAnObject(),ee=requireIsCallable(),R=requireIsObject$1(),U=requireToIntegerOrInfinity(),K=requireToLength(),oe=requireToString$1(),pe=requireRequireObjectCoercible(),_e=requireAdvanceStringIndex(),me=requireGetMethod(),we=requireGetSubstitution(),Oe=requireRegexpGetFlags(),De=requireRegexpExecAbstract(),Ae=requireWellKnownSymbol(),Ce=Ae("replace"),je=Math.max,ke=Math.min,Be=re([].concat),We=re([].push),Je=re("".indexOf),Ke=re("".slice),et=function(ft){return ft===void 0?ft:String(ft)},it=(function(){return"a".replace(/./,"$0")==="$0"})(),nt=(function(){return/./[Ce]?/./[Ce]("a","$0")==="":!1})(),ct=!ne(function(){var ft=/./;return ft.exec=function(){var _t=[];return _t.groups={a:"7"},_t},"".replace(ft,"$<a>")!=="7"});return ae("replace",function(ft,_t,Rt){var Ft=nt?"$":"$0";return[function(St,ut){var Et=pe(this),bt=R(St)?me(St,Ce):void 0;return bt?Y(bt,St,Et,ut):Y(_t,oe(Et),St,ut)},function(ht,St){var ut=ce(this),Et=oe(ht);if(typeof St=="string"&&Je(St,Ft)===-1&&Je(St,"$<")===-1){var bt=Rt(_t,ut,Et,St);if(bt.done)return bt.value}var Dt=ee(St);Dt||(St=oe(St));var Ut=oe(Oe(ut)),er=Je(Ut,"g")!==-1,xr;er&&(xr=Je(Ut,"u")!==-1,ut.lastIndex=0);for(var ur=[],yr;yr=De(ut,Et),!(yr===null||(We(ur,yr),!er));){var Wt=oe(yr[0]);Wt===""&&(ut.lastIndex=_e(Et,K(ut.lastIndex),xr))}for(var or="",wr=0,Ir=0;Ir<ur.length;Ir++){yr=ur[Ir];for(var br=oe(yr[0]),gr=je(ke(U(yr.index),Et.length),0),Mr=[],Hr,jr=1;jr<yr.length;jr++)We(Mr,et(yr[jr]));var Sr=yr.groups;if(Dt){var Nr=Be([br],Mr,gr,Et);Sr!==void 0&&We(Nr,Sr),Hr=oe(J(St,void 0,Nr))}else Hr=we(br,Et,gr,Mr,Sr,St);gr>=wr&&(or+=Ke(Et,wr,gr)+Hr,wr=gr+br.length)}return or+Ke(Et,wr)}]},!ct||!it||nt),es_string_replace}var es_string_replaceAll={},hasRequiredEs_string_replaceAll;function requireEs_string_replaceAll(){if(hasRequiredEs_string_replaceAll)return es_string_replaceAll;hasRequiredEs_string_replaceAll=1;var J=require_export(),Y=requireFunctionCall(),re=requireFunctionUncurryThis(),ae=requireRequireObjectCoercible(),ne=requireIsCallable(),ce=requireIsObject$1(),ee=requireIsRegexp(),R=requireToString$1(),U=requireGetMethod(),K=requireRegexpGetFlags(),oe=requireGetSubstitution(),pe=requireWellKnownSymbol(),_e=requireIsPure(),me=pe("replace"),we=TypeError,Oe=re("".indexOf),De=re("".replace),Ae=re("".slice),Ce=Math.max;return J({target:"String",proto:!0},{replaceAll:function(ke,Be){var We=ae(this),Je,Ke,et,it,nt,ct,ft,_t,Rt,Ft,ht=0,St="";if(ce(ke)){if(Je=ee(ke),Je&&(Ke=R(ae(K(ke))),!~Oe(Ke,"g")))throw new we("`.replaceAll` does not allow non-global regexes");if(et=U(ke,me),et)return Y(et,ke,We,Be);if(_e&&Je)return De(R(We),ke,Be)}for(it=R(We),nt=R(ke),ct=ne(Be),ct||(Be=R(Be)),ft=nt.length,_t=Ce(1,ft),Rt=Oe(it,nt);Rt!==-1;)Ft=ct?R(Be(nt,Rt,it)):oe(nt,it,Rt,[],void 0,Be),St+=Ae(it,ht,Rt)+Ft,ht=Rt+ft,Rt=Rt+_t>it.length?-1:Oe(it,nt,Rt+_t);return ht<it.length&&(St+=Ae(it,ht)),St}}),es_string_replaceAll}var es_string_search={},hasRequiredEs_string_search;function requireEs_string_search(){if(hasRequiredEs_string_search)return es_string_search;hasRequiredEs_string_search=1;var J=requireFunctionCall(),Y=requireFixRegexpWellKnownSymbolLogic(),re=requireAnObject(),ae=requireIsObject$1(),ne=requireRequireObjectCoercible(),ce=requireSameValue(),ee=requireToString$1(),R=requireGetMethod(),U=requireRegexpExecAbstract();return Y("search",function(K,oe,pe){return[function(me){var we=ne(this),Oe=ae(me)?R(me,K):void 0;return Oe?J(Oe,me,we):new RegExp(me)[K](ee(we))},function(_e){var me=re(this),we=ee(_e),Oe=pe(oe,me,we);if(Oe.done)return Oe.value;var De=me.lastIndex;ce(De,0)||(me.lastIndex=0);var Ae=U(me,we);return ce(me.lastIndex,De)||(me.lastIndex=De),Ae===null?-1:Ae.index}]}),es_string_search}var es_string_split={},hasRequiredEs_string_split;function requireEs_string_split(){if(hasRequiredEs_string_split)return es_string_split;hasRequiredEs_string_split=1;var J=requireFunctionCall(),Y=requireFunctionUncurryThis(),re=requireFixRegexpWellKnownSymbolLogic(),ae=requireAnObject(),ne=requireIsObject$1(),ce=requireRequireObjectCoercible(),ee=requireSpeciesConstructor(),R=requireAdvanceStringIndex(),U=requireToLength(),K=requireToString$1(),oe=requireGetMethod(),pe=requireRegexpExecAbstract(),_e=requireRegexpStickyHelpers(),me=requireFails(),we=_e.UNSUPPORTED_Y,Oe=4294967295,De=Math.min,Ae=Y([].push),Ce=Y("".slice),je=!me(function(){var Be=/(?:)/,We=Be.exec;Be.exec=function(){return We.apply(this,arguments)};var Je="ab".split(Be);return Je.length!==2||Je[0]!=="a"||Je[1]!=="b"}),ke="abbc".split(/(b)*/)[1]==="c"||"test".split(/(?:)/,-1).length!==4||"ab".split(/(?:ab)*/).length!==2||".".split(/(.?)(.?)/).length!==4||".".split(/()()/).length>1||"".split(/.?/).length;return re("split",function(Be,We,Je){var Ke="0".split(void 0,0).length?function(et,it){return et===void 0&&it===0?[]:J(We,this,et,it)}:We;return[function(it,nt){var ct=ce(this),ft=ne(it)?oe(it,Be):void 0;return ft?J(ft,it,ct,nt):J(Ke,K(ct),it,nt)},function(et,it){var nt=ae(this),ct=K(et);if(!ke){var ft=Je(Ke,nt,ct,it,Ke!==We);if(ft.done)return ft.value}var _t=ee(nt,RegExp),Rt=nt.unicode,Ft=(nt.ignoreCase?"i":"")+(nt.multiline?"m":"")+(nt.unicode?"u":"")+(we?"g":"y"),ht=new _t(we?"^(?:"+nt.source+")":nt,Ft),St=it===void 0?Oe:it>>>0;if(St===0)return[];if(ct.length===0)return pe(ht,ct)===null?[ct]:[];for(var ut=0,Et=0,bt=[];Et<ct.length;){ht.lastIndex=we?0:Et;var Dt=pe(ht,we?Ce(ct,Et):ct),Ut;if(Dt===null||(Ut=De(U(ht.lastIndex+(we?Et:0)),ct.length))===ut)Et=R(ct,Et,Rt);else{if(Ae(bt,Ce(ct,ut,Et)),bt.length===St)return bt;for(var er=1;er<=Dt.length-1;er++)if(Ae(bt,Dt[er]),bt.length===St)return bt;Et=ut=Ut}}return Ae(bt,Ce(ct,ut)),bt}]},ke||!je,we),es_string_split}var es_string_startsWith={},hasRequiredEs_string_startsWith;function requireEs_string_startsWith(){if(hasRequiredEs_string_startsWith)return es_string_startsWith;hasRequiredEs_string_startsWith=1;var J=require_export(),Y=requireFunctionUncurryThisClause(),re=requireObjectGetOwnPropertyDescriptor().f,ae=requireToLength(),ne=requireToString$1(),ce=requireNotARegexp(),ee=requireRequireObjectCoercible(),R=requireCorrectIsRegexpLogic(),U=requireIsPure(),K=Y("".slice),oe=Math.min,pe=R("startsWith"),_e=!U&&!pe&&!!(function(){var me=re(String.prototype,"startsWith");return me&&!me.writable})();return J({target:"String",proto:!0,forced:!_e&&!pe},{startsWith:function(we){var Oe=ne(ee(this));ce(we);var De=ae(oe(arguments.length>1?arguments[1]:void 0,Oe.length)),Ae=ne(we);return K(Oe,De,De+Ae.length)===Ae}}),es_string_startsWith}var es_string_substr={},hasRequiredEs_string_substr;function requireEs_string_substr(){if(hasRequiredEs_string_substr)return es_string_substr;hasRequiredEs_string_substr=1;var J=require_export(),Y=requireFunctionUncurryThis(),re=requireRequireObjectCoercible(),ae=requireToIntegerOrInfinity(),ne=requireToString$1(),ce=Y("".slice),ee=Math.max,R=Math.min,U=!"".substr||"ab".substr(-1)!=="b";return J({target:"String",proto:!0,forced:U},{substr:function(oe,pe){var _e=ne(re(this)),me=_e.length,we=ae(oe),Oe,De;return we===1/0&&(we=0),we<0&&(we=ee(me+we,0)),Oe=pe===void 0?me:ae(pe),Oe<=0||Oe===1/0?"":(De=R(we+Oe,me),we>=De?"":ce(_e,we,De))}}),es_string_substr}var es_string_toWellFormed={},hasRequiredEs_string_toWellFormed;function requireEs_string_toWellFormed(){if(hasRequiredEs_string_toWellFormed)return es_string_toWellFormed;hasRequiredEs_string_toWellFormed=1;var J=require_export(),Y=requireFunctionCall(),re=requireFunctionUncurryThis(),ae=requireRequireObjectCoercible(),ne=requireToString$1(),ce=requireFails(),ee=Array,R=re("".charAt),U=re("".charCodeAt),K=re([].join),oe="".toWellFormed,pe="ï¿½",_e=oe&&ce(function(){return Y(oe,1)!=="1"});return J({target:"String",proto:!0,forced:_e},{toWellFormed:function(){var we=ne(ae(this));if(_e)return Y(oe,we);for(var Oe=we.length,De=ee(Oe),Ae=0;Ae<Oe;Ae++){var Ce=U(we,Ae);(Ce&63488)!==55296?De[Ae]=R(we,Ae):Ce>=56320||Ae+1>=Oe||(U(we,Ae+1)&64512)!==56320?De[Ae]=pe:(De[Ae]=R(we,Ae),De[++Ae]=R(we,Ae))}return K(De,"")}}),es_string_toWellFormed}var es_string_trim={},stringTrimForced,hasRequiredStringTrimForced;function requireStringTrimForced(){if(hasRequiredStringTrimForced)return stringTrimForced;hasRequiredStringTrimForced=1;var J=requireFunctionName().PROPER,Y=requireFails(),re=requireWhitespaces(),ae="âÂá ";return stringTrimForced=function(ne){return Y(function(){return!!re[ne]()||ae[ne]()!==ae||J&&re[ne].name!==ne})},stringTrimForced}var hasRequiredEs_string_trim;function requireEs_string_trim(){if(hasRequiredEs_string_trim)return es_string_trim;hasRequiredEs_string_trim=1;var J=require_export(),Y=requireStringTrim().trim,re=requireStringTrimForced();return J({target:"String",proto:!0,forced:re("trim")},{trim:function(){return Y(this)}}),es_string_trim}var es_string_trimEnd={},es_string_trimRight={},stringTrimEnd,hasRequiredStringTrimEnd;function requireStringTrimEnd(){if(hasRequiredStringTrimEnd)return stringTrimEnd;hasRequiredStringTrimEnd=1;var J=requireStringTrim().end,Y=requireStringTrimForced();return stringTrimEnd=Y("trimEnd")?function(){return J(this)}:"".trimEnd,stringTrimEnd}var hasRequiredEs_string_trimRight;function requireEs_string_trimRight(){if(hasRequiredEs_string_trimRight)return es_string_trimRight;hasRequiredEs_string_trimRight=1;var J=require_export(),Y=requireStringTrimEnd();return J({target:"String",proto:!0,name:"trimEnd",forced:"".trimRight!==Y},{trimRight:Y}),es_string_trimRight}var hasRequiredEs_string_trimEnd;function requireEs_string_trimEnd(){if(hasRequiredEs_string_trimEnd)return es_string_trimEnd;hasRequiredEs_string_trimEnd=1,requireEs_string_trimRight();var J=require_export(),Y=requireStringTrimEnd();return J({target:"String",proto:!0,name:"trimEnd",forced:"".trimEnd!==Y},{trimEnd:Y}),es_string_trimEnd}var es_string_trimStart={},es_string_trimLeft={},stringTrimStart,hasRequiredStringTrimStart;function requireStringTrimStart(){if(hasRequiredStringTrimStart)return stringTrimStart;hasRequiredStringTrimStart=1;var J=requireStringTrim().start,Y=requireStringTrimForced();return stringTrimStart=Y("trimStart")?function(){return J(this)}:"".trimStart,stringTrimStart}var hasRequiredEs_string_trimLeft;function requireEs_string_trimLeft(){if(hasRequiredEs_string_trimLeft)return es_string_trimLeft;hasRequiredEs_string_trimLeft=1;var J=require_export(),Y=requireStringTrimStart();return J({target:"String",proto:!0,name:"trimStart",forced:"".trimLeft!==Y},{trimLeft:Y}),es_string_trimLeft}var hasRequiredEs_string_trimStart;function requireEs_string_trimStart(){if(hasRequiredEs_string_trimStart)return es_string_trimStart;hasRequiredEs_string_trimStart=1,requireEs_string_trimLeft();var J=require_export(),Y=requireStringTrimStart();return J({target:"String",proto:!0,name:"trimStart",forced:"".trimStart!==Y},{trimStart:Y}),es_string_trimStart}var es_string_anchor={},createHtml,hasRequiredCreateHtml;function requireCreateHtml(){if(hasRequiredCreateHtml)return createHtml;hasRequiredCreateHtml=1;var J=requireFunctionUncurryThis(),Y=requireRequireObjectCoercible(),re=requireToString$1(),ae=/"/g,ne=J("".replace);return createHtml=function(ce,ee,R,U){var K=re(Y(ce)),oe="<"+ee;return R!==""&&(oe+=" "+R+'="'+ne(re(U),ae,"&quot;")+'"'),oe+">"+K+"</"+ee+">"},createHtml}var stringHtmlForced,hasRequiredStringHtmlForced;function requireStringHtmlForced(){if(hasRequiredStringHtmlForced)return stringHtmlForced;hasRequiredStringHtmlForced=1;var J=requireFails();return stringHtmlForced=function(Y){return J(function(){var re=""[Y]('"');return re!==re.toLowerCase()||re.split('"').length>3})},stringHtmlForced}var hasRequiredEs_string_anchor;function requireEs_string_anchor(){if(hasRequiredEs_string_anchor)return es_string_anchor;hasRequiredEs_string_anchor=1;var J=require_export(),Y=requireCreateHtml(),re=requireStringHtmlForced();return J({target:"String",proto:!0,forced:re("anchor")},{anchor:function(ne){return Y(this,"a","name",ne)}}),es_string_anchor}var es_string_big={},hasRequiredEs_string_big;function requireEs_string_big(){if(hasRequiredEs_string_big)return es_string_big;hasRequiredEs_string_big=1;var J=require_export(),Y=requireCreateHtml(),re=requireStringHtmlForced();return J({target:"String",proto:!0,forced:re("big")},{big:function(){return Y(this,"big","","")}}),es_string_big}var es_string_blink={},hasRequiredEs_string_blink;function requireEs_string_blink(){if(hasRequiredEs_string_blink)return es_string_blink;hasRequiredEs_string_blink=1;var J=require_export(),Y=requireCreateHtml(),re=requireStringHtmlForced();return J({target:"String",proto:!0,forced:re("blink")},{blink:function(){return Y(this,"blink","","")}}),es_string_blink}var es_string_bold={},hasRequiredEs_string_bold;function requireEs_string_bold(){if(hasRequiredEs_string_bold)return es_string_bold;hasRequiredEs_string_bold=1;var J=require_export(),Y=requireCreateHtml(),re=requireStringHtmlForced();return J({target:"String",proto:!0,forced:re("bold")},{bold:function(){return Y(this,"b","","")}}),es_string_bold}var es_string_fixed={},hasRequiredEs_string_fixed;function requireEs_string_fixed(){if(hasRequiredEs_string_fixed)return es_string_fixed;hasRequiredEs_string_fixed=1;var J=require_export(),Y=requireCreateHtml(),re=requireStringHtmlForced();return J({target:"String",proto:!0,forced:re("fixed")},{fixed:function(){return Y(this,"tt","","")}}),es_string_fixed}var es_string_fontcolor={},hasRequiredEs_string_fontcolor;function requireEs_string_fontcolor(){if(hasRequiredEs_string_fontcolor)return es_string_fontcolor;hasRequiredEs_string_fontcolor=1;var J=require_export(),Y=requireCreateHtml(),re=requireStringHtmlForced();return J({target:"String",proto:!0,forced:re("fontcolor")},{fontcolor:function(ne){return Y(this,"font","color",ne)}}),es_string_fontcolor}var es_string_fontsize={},hasRequiredEs_string_fontsize;function requireEs_string_fontsize(){if(hasRequiredEs_string_fontsize)return es_string_fontsize;hasRequiredEs_string_fontsize=1;var J=require_export(),Y=requireCreateHtml(),re=requireStringHtmlForced();return J({target:"String",proto:!0,forced:re("fontsize")},{fontsize:function(ne){return Y(this,"font","size",ne)}}),es_string_fontsize}var es_string_italics={},hasRequiredEs_string_italics;function requireEs_string_italics(){if(hasRequiredEs_string_italics)return es_string_italics;hasRequiredEs_string_italics=1;var J=require_export(),Y=requireCreateHtml(),re=requireStringHtmlForced();return J({target:"String",proto:!0,forced:re("italics")},{italics:function(){return Y(this,"i","","")}}),es_string_italics}var es_string_link={},hasRequiredEs_string_link;function requireEs_string_link(){if(hasRequiredEs_string_link)return es_string_link;hasRequiredEs_string_link=1;var J=require_export(),Y=requireCreateHtml(),re=requireStringHtmlForced();return J({target:"String",proto:!0,forced:re("link")},{link:function(ne){return Y(this,"a","href",ne)}}),es_string_link}var es_string_small={},hasRequiredEs_string_small;function requireEs_string_small(){if(hasRequiredEs_string_small)return es_string_small;hasRequiredEs_string_small=1;var J=require_export(),Y=requireCreateHtml(),re=requireStringHtmlForced();return J({target:"String",proto:!0,forced:re("small")},{small:function(){return Y(this,"small","","")}}),es_string_small}var es_string_strike={},hasRequiredEs_string_strike;function requireEs_string_strike(){if(hasRequiredEs_string_strike)return es_string_strike;hasRequiredEs_string_strike=1;var J=require_export(),Y=requireCreateHtml(),re=requireStringHtmlForced();return J({target:"String",proto:!0,forced:re("strike")},{strike:function(){return Y(this,"strike","","")}}),es_string_strike}var es_string_sub={},hasRequiredEs_string_sub;function requireEs_string_sub(){if(hasRequiredEs_string_sub)return es_string_sub;hasRequiredEs_string_sub=1;var J=require_export(),Y=requireCreateHtml(),re=requireStringHtmlForced();return J({target:"String",proto:!0,forced:re("sub")},{sub:function(){return Y(this,"sub","","")}}),es_string_sub}var es_string_sup={},hasRequiredEs_string_sup;function requireEs_string_sup(){if(hasRequiredEs_string_sup)return es_string_sup;hasRequiredEs_string_sup=1;var J=require_export(),Y=requireCreateHtml(),re=requireStringHtmlForced();return J({target:"String",proto:!0,forced:re("sup")},{sup:function(){return Y(this,"sup","","")}}),es_string_sup}var es_typedArray_float32Array={},typedArrayConstructor={exports:{}},typedArrayConstructorsRequireWrappers,hasRequiredTypedArrayConstructorsRequireWrappers;function requireTypedArrayConstructorsRequireWrappers(){if(hasRequiredTypedArrayConstructorsRequireWrappers)return typedArrayConstructorsRequireWrappers;hasRequiredTypedArrayConstructorsRequireWrappers=1;var J=requireGlobalThis(),Y=requireFails(),re=requireCheckCorrectnessOfIteration(),ae=requireArrayBufferViewCore().NATIVE_ARRAY_BUFFER_VIEWS,ne=J.ArrayBuffer,ce=J.Int8Array;return typedArrayConstructorsRequireWrappers=!ae||!Y(function(){ce(1)})||!Y(function(){new ce(-1)})||!re(function(ee){new ce,new ce(null),new ce(1.5),new ce(ee)},!0)||Y(function(){return new ce(new ne(2),1,void 0).length!==1}),typedArrayConstructorsRequireWrappers}var toOffset,hasRequiredToOffset;function requireToOffset(){if(hasRequiredToOffset)return toOffset;hasRequiredToOffset=1;var J=requireToPositiveInteger(),Y=RangeError;return toOffset=function(re,ae){var ne=J(re);if(ne%ae)throw new Y("Wrong offset");return ne},toOffset}var toUint8Clamped,hasRequiredToUint8Clamped;function requireToUint8Clamped(){if(hasRequiredToUint8Clamped)return toUint8Clamped;hasRequiredToUint8Clamped=1;var J=Math.round;return toUint8Clamped=function(Y){var re=J(Y);return re<0?0:re>255?255:re&255},toUint8Clamped}var isBigIntArray,hasRequiredIsBigIntArray;function requireIsBigIntArray(){if(hasRequiredIsBigIntArray)return isBigIntArray;hasRequiredIsBigIntArray=1;var J=requireClassof();return isBigIntArray=function(Y){var re=J(Y);return re==="BigInt64Array"||re==="BigUint64Array"},isBigIntArray}var toBigInt,hasRequiredToBigInt;function requireToBigInt(){if(hasRequiredToBigInt)return toBigInt;hasRequiredToBigInt=1;var J=requireToPrimitive(),Y=TypeError;return toBigInt=function(re){var ae=J(re,"number");if(typeof ae=="number")throw new Y("Can't convert number to bigint");return BigInt(ae)},toBigInt}var typedArrayFrom,hasRequiredTypedArrayFrom;function requireTypedArrayFrom(){if(hasRequiredTypedArrayFrom)return typedArrayFrom;hasRequiredTypedArrayFrom=1;var J=requireFunctionBindContext(),Y=requireFunctionCall(),re=requireAConstructor(),ae=requireToObject(),ne=requireLengthOfArrayLike(),ce=requireGetIterator(),ee=requireGetIteratorMethod(),R=requireIsArrayIteratorMethod(),U=requireIsBigIntArray(),K=requireArrayBufferViewCore().aTypedArrayConstructor,oe=requireToBigInt();return typedArrayFrom=function(_e){var me=re(this),we=ae(_e),Oe=arguments.length,De=Oe>1?arguments[1]:void 0,Ae=De!==void 0,Ce=ee(we),je,ke,Be,We,Je,Ke,et,it;if(Ce&&!R(Ce))for(et=ce(we,Ce),it=et.next,we=[];!(Ke=Y(it,et)).done;)we.push(Ke.value);for(Ae&&Oe>2&&(De=J(De,arguments[2])),ke=ne(we),Be=new(K(me))(ke),We=U(Be),je=0;ke>je;je++)Je=Ae?De(we[je],je):we[je],Be[je]=We?oe(Je):+Je;return Be},typedArrayFrom}var hasRequiredTypedArrayConstructor;function requireTypedArrayConstructor(){if(hasRequiredTypedArrayConstructor)return typedArrayConstructor.exports;hasRequiredTypedArrayConstructor=1;var J=require_export(),Y=requireGlobalThis(),re=requireFunctionCall(),ae=requireDescriptors(),ne=requireTypedArrayConstructorsRequireWrappers(),ce=requireArrayBufferViewCore(),ee=requireArrayBuffer(),R=requireAnInstance(),U=requireCreatePropertyDescriptor(),K=requireCreateNonEnumerableProperty(),oe=requireIsIntegralNumber(),pe=requireToLength(),_e=requireToIndex(),me=requireToOffset(),we=requireToUint8Clamped(),Oe=requireToPropertyKey(),De=requireHasOwnProperty(),Ae=requireClassof(),Ce=requireIsObject$1(),je=requireIsSymbol$1(),ke=requireObjectCreate(),Be=requireObjectIsPrototypeOf(),We=requireObjectSetPrototypeOf(),Je=requireObjectGetOwnPropertyNames().f,Ke=requireTypedArrayFrom(),et=requireArrayIteration().forEach,it=requireSetSpecies(),nt=requireDefineBuiltInAccessor(),ct=requireObjectDefineProperty(),ft=requireObjectGetOwnPropertyDescriptor(),_t=requireArrayFromConstructorAndList(),Rt=requireInternalState(),Ft=requireInheritIfRequired(),ht=Rt.get,St=Rt.set,ut=Rt.enforce,Et=ct.f,bt=ft.f,Dt=Y.RangeError,Ut=ee.ArrayBuffer,er=Ut.prototype,xr=ee.DataView,ur=ce.NATIVE_ARRAY_BUFFER_VIEWS,yr=ce.TYPED_ARRAY_TAG,Wt=ce.TypedArray,or=ce.TypedArrayPrototype,wr=ce.isTypedArray,Ir="BYTES_PER_ELEMENT",br="Wrong length",gr=function(Nr,Dr){nt(Nr,Dr,{configurable:!0,get:function(){return ht(this)[Dr]}})},Mr=function(Nr){var Dr;return Be(er,Nr)||(Dr=Ae(Nr))==="ArrayBuffer"||Dr==="SharedArrayBuffer"},Hr=function(Nr,Dr){return wr(Nr)&&!je(Dr)&&Dr in Nr&&oe(+Dr)&&Dr>=0},jr=function(Dr,Lr){return Lr=Oe(Lr),Hr(Dr,Lr)?U(2,Dr[Lr]):bt(Dr,Lr)},Sr=function(Dr,Lr,Yt){return Lr=Oe(Lr),Hr(Dr,Lr)&&Ce(Yt)&&De(Yt,"value")&&!De(Yt,"get")&&!De(Yt,"set")&&!Yt.configurable&&(!De(Yt,"writable")||Yt.writable)&&(!De(Yt,"enumerable")||Yt.enumerable)?(Dr[Lr]=Yt.value,Dr):Et(Dr,Lr,Yt)};return ae?(ur||(ft.f=jr,ct.f=Sr,gr(or,"buffer"),gr(or,"byteOffset"),gr(or,"byteLength"),gr(or,"length")),J({target:"Object",stat:!0,forced:!ur},{getOwnPropertyDescriptor:jr,defineProperty:Sr}),typedArrayConstructor.exports=function(Nr,Dr,Lr){var Yt=Nr.match(/\d+/)[0]/8,Jt=Nr+(Lr?"Clamped":"")+"Array",qr="get"+Nr,nr="set"+Nr,dr=Y[Jt],mr=dr,Ge=mr&&mr.prototype,Ie={},Se=function(ze,Qe){var tt=ht(ze);return tt.view[qr](Qe*Yt+tt.byteOffset,!0)},xe=function(ze,Qe,tt){var He=ht(ze);He.view[nr](Qe*Yt+He.byteOffset,Lr?we(tt):tt,!0)},Te=function(ze,Qe){Et(ze,Qe,{get:function(){return Se(this,Qe)},set:function(tt){return xe(this,Qe,tt)},enumerable:!0})};ur?ne&&(mr=Dr(function(ze,Qe,tt,He){return R(ze,Ge),Ft((function(){return Ce(Qe)?Mr(Qe)?He!==void 0?new dr(Qe,me(tt,Yt),He):tt!==void 0?new dr(Qe,me(tt,Yt)):new dr(Qe):wr(Qe)?_t(mr,Qe):re(Ke,mr,Qe):new dr(_e(Qe))})(),ze,mr)}),We&&We(mr,Wt),et(Je(dr),function(ze){ze in mr||K(mr,ze,dr[ze])}),mr.prototype=Ge):(mr=Dr(function(ze,Qe,tt,He){R(ze,Ge);var Ze=0,st=0,At,wt,Mt;if(!Ce(Qe))Mt=_e(Qe),wt=Mt*Yt,At=new Ut(wt);else if(Mr(Qe)){At=Qe,st=me(tt,Yt);var Zt=Qe.byteLength;if(He===void 0){if(Zt%Yt)throw new Dt(br);if(wt=Zt-st,wt<0)throw new Dt(br)}else if(wt=pe(He)*Yt,wt+st>Zt)throw new Dt(br);Mt=wt/Yt}else return wr(Qe)?_t(mr,Qe):re(Ke,mr,Qe);for(St(ze,{buffer:At,byteOffset:st,byteLength:wt,length:Mt,view:new xr(At)});Ze<Mt;)Te(ze,Ze++)}),We&&We(mr,Wt),Ge=mr.prototype=ke(or)),Ge.constructor!==mr&&K(Ge,"constructor",mr),ut(Ge).TypedArrayConstructor=mr,yr&&K(Ge,yr,Jt);var Me=mr!==dr;Ie[Jt]=mr,J({global:!0,constructor:!0,forced:Me,sham:!ur},Ie),Ir in mr||K(mr,Ir,Yt),Ir in Ge||K(Ge,Ir,Yt),it(Jt)}):typedArrayConstructor.exports=function(){},typedArrayConstructor.exports}var hasRequiredEs_typedArray_float32Array;function requireEs_typedArray_float32Array(){if(hasRequiredEs_typedArray_float32Array)return es_typedArray_float32Array;hasRequiredEs_typedArray_float32Array=1;var J=requireTypedArrayConstructor();return J("Float32",function(Y){return function(ae,ne,ce){return Y(this,ae,ne,ce)}}),es_typedArray_float32Array}var es_typedArray_float64Array={},hasRequiredEs_typedArray_float64Array;function requireEs_typedArray_float64Array(){if(hasRequiredEs_typedArray_float64Array)return es_typedArray_float64Array;hasRequiredEs_typedArray_float64Array=1;var J=requireTypedArrayConstructor();return J("Float64",function(Y){return function(ae,ne,ce){return Y(this,ae,ne,ce)}}),es_typedArray_float64Array}var es_typedArray_int8Array={},hasRequiredEs_typedArray_int8Array;function requireEs_typedArray_int8Array(){if(hasRequiredEs_typedArray_int8Array)return es_typedArray_int8Array;hasRequiredEs_typedArray_int8Array=1;var J=requireTypedArrayConstructor();return J("Int8",function(Y){return function(ae,ne,ce){return Y(this,ae,ne,ce)}}),es_typedArray_int8Array}var es_typedArray_int16Array={},hasRequiredEs_typedArray_int16Array;function requireEs_typedArray_int16Array(){if(hasRequiredEs_typedArray_int16Array)return es_typedArray_int16Array;hasRequiredEs_typedArray_int16Array=1;var J=requireTypedArrayConstructor();return J("Int16",function(Y){return function(ae,ne,ce){return Y(this,ae,ne,ce)}}),es_typedArray_int16Array}var es_typedArray_int32Array={},hasRequiredEs_typedArray_int32Array;function requireEs_typedArray_int32Array(){if(hasRequiredEs_typedArray_int32Array)return es_typedArray_int32Array;hasRequiredEs_typedArray_int32Array=1;var J=requireTypedArrayConstructor();return J("Int32",function(Y){return function(ae,ne,ce){return Y(this,ae,ne,ce)}}),es_typedArray_int32Array}var es_typedArray_uint8Array={},hasRequiredEs_typedArray_uint8Array;function requireEs_typedArray_uint8Array(){if(hasRequiredEs_typedArray_uint8Array)return es_typedArray_uint8Array;hasRequiredEs_typedArray_uint8Array=1;var J=requireTypedArrayConstructor();return J("Uint8",function(Y){return function(ae,ne,ce){return Y(this,ae,ne,ce)}}),es_typedArray_uint8Array}var es_typedArray_uint8ClampedArray={},hasRequiredEs_typedArray_uint8ClampedArray;function requireEs_typedArray_uint8ClampedArray(){if(hasRequiredEs_typedArray_uint8ClampedArray)return es_typedArray_uint8ClampedArray;hasRequiredEs_typedArray_uint8ClampedArray=1;var J=requireTypedArrayConstructor();return J("Uint8",function(Y){return function(ae,ne,ce){return Y(this,ae,ne,ce)}},!0),es_typedArray_uint8ClampedArray}var es_typedArray_uint16Array={},hasRequiredEs_typedArray_uint16Array;function requireEs_typedArray_uint16Array(){if(hasRequiredEs_typedArray_uint16Array)return es_typedArray_uint16Array;hasRequiredEs_typedArray_uint16Array=1;var J=requireTypedArrayConstructor();return J("Uint16",function(Y){return function(ae,ne,ce){return Y(this,ae,ne,ce)}}),es_typedArray_uint16Array}var es_typedArray_uint32Array={},hasRequiredEs_typedArray_uint32Array;function requireEs_typedArray_uint32Array(){if(hasRequiredEs_typedArray_uint32Array)return es_typedArray_uint32Array;hasRequiredEs_typedArray_uint32Array=1;var J=requireTypedArrayConstructor();return J("Uint32",function(Y){return function(ae,ne,ce){return Y(this,ae,ne,ce)}}),es_typedArray_uint32Array}var es_typedArray_at={},hasRequiredEs_typedArray_at;function requireEs_typedArray_at(){if(hasRequiredEs_typedArray_at)return es_typedArray_at;hasRequiredEs_typedArray_at=1;var J=requireArrayBufferViewCore(),Y=requireLengthOfArrayLike(),re=requireToIntegerOrInfinity(),ae=J.aTypedArray,ne=J.exportTypedArrayMethod;return ne("at",function(ee){var R=ae(this),U=Y(R),K=re(ee),oe=K>=0?K:U+K;return oe<0||oe>=U?void 0:R[oe]}),es_typedArray_at}var es_typedArray_copyWithin={},hasRequiredEs_typedArray_copyWithin;function requireEs_typedArray_copyWithin(){if(hasRequiredEs_typedArray_copyWithin)return es_typedArray_copyWithin;hasRequiredEs_typedArray_copyWithin=1;var J=requireFunctionUncurryThis(),Y=requireArrayBufferViewCore(),re=requireArrayCopyWithin(),ae=J(re),ne=Y.aTypedArray,ce=Y.exportTypedArrayMethod;return ce("copyWithin",function(R,U){return ae(ne(this),R,U,arguments.length>2?arguments[2]:void 0)}),es_typedArray_copyWithin}var es_typedArray_every={},hasRequiredEs_typedArray_every;function requireEs_typedArray_every(){if(hasRequiredEs_typedArray_every)return es_typedArray_every;hasRequiredEs_typedArray_every=1;var J=requireArrayBufferViewCore(),Y=requireArrayIteration().every,re=J.aTypedArray,ae=J.exportTypedArrayMethod;return ae("every",function(ce){return Y(re(this),ce,arguments.length>1?arguments[1]:void 0)}),es_typedArray_every}var es_typedArray_fill={},hasRequiredEs_typedArray_fill;function requireEs_typedArray_fill(){if(hasRequiredEs_typedArray_fill)return es_typedArray_fill;hasRequiredEs_typedArray_fill=1;var J=requireArrayBufferViewCore(),Y=requireArrayFill(),re=requireToBigInt(),ae=requireClassof(),ne=requireFunctionCall(),ce=requireFunctionUncurryThis(),ee=requireFails(),R=J.aTypedArray,U=J.exportTypedArrayMethod,K=ce("".slice),oe=ee(function(){var pe=0;return new Int8Array(2).fill({valueOf:function(){return pe++}}),pe!==1});return U("fill",function(_e){var me=arguments.length;R(this);var we=K(ae(this),0,3)==="Big"?re(_e):+_e;return ne(Y,this,we,me>1?arguments[1]:void 0,me>2?arguments[2]:void 0)},oe),es_typedArray_fill}var es_typedArray_filter={},typedArrayFromSameTypeAndList,hasRequiredTypedArrayFromSameTypeAndList;function requireTypedArrayFromSameTypeAndList(){if(hasRequiredTypedArrayFromSameTypeAndList)return typedArrayFromSameTypeAndList;hasRequiredTypedArrayFromSameTypeAndList=1;var J=requireArrayFromConstructorAndList(),Y=requireArrayBufferViewCore().getTypedArrayConstructor;return typedArrayFromSameTypeAndList=function(re,ae){return J(Y(re),ae)},typedArrayFromSameTypeAndList}var hasRequiredEs_typedArray_filter;function requireEs_typedArray_filter(){if(hasRequiredEs_typedArray_filter)return es_typedArray_filter;hasRequiredEs_typedArray_filter=1;var J=requireArrayBufferViewCore(),Y=requireArrayIteration().filter,re=requireTypedArrayFromSameTypeAndList(),ae=J.aTypedArray,ne=J.exportTypedArrayMethod;return ne("filter",function(ee){var R=Y(ae(this),ee,arguments.length>1?arguments[1]:void 0);return re(this,R)}),es_typedArray_filter}var es_typedArray_find={},hasRequiredEs_typedArray_find;function requireEs_typedArray_find(){if(hasRequiredEs_typedArray_find)return es_typedArray_find;hasRequiredEs_typedArray_find=1;var J=requireArrayBufferViewCore(),Y=requireArrayIteration().find,re=J.aTypedArray,ae=J.exportTypedArrayMethod;return ae("find",function(ce){return Y(re(this),ce,arguments.length>1?arguments[1]:void 0)}),es_typedArray_find}var es_typedArray_findIndex={},hasRequiredEs_typedArray_findIndex;function requireEs_typedArray_findIndex(){if(hasRequiredEs_typedArray_findIndex)return es_typedArray_findIndex;hasRequiredEs_typedArray_findIndex=1;var J=requireArrayBufferViewCore(),Y=requireArrayIteration().findIndex,re=J.aTypedArray,ae=J.exportTypedArrayMethod;return ae("findIndex",function(ce){return Y(re(this),ce,arguments.length>1?arguments[1]:void 0)}),es_typedArray_findIndex}var es_typedArray_findLast={},hasRequiredEs_typedArray_findLast;function requireEs_typedArray_findLast(){if(hasRequiredEs_typedArray_findLast)return es_typedArray_findLast;hasRequiredEs_typedArray_findLast=1;var J=requireArrayBufferViewCore(),Y=requireArrayIterationFromLast().findLast,re=J.aTypedArray,ae=J.exportTypedArrayMethod;return ae("findLast",function(ce){return Y(re(this),ce,arguments.length>1?arguments[1]:void 0)}),es_typedArray_findLast}var es_typedArray_findLastIndex={},hasRequiredEs_typedArray_findLastIndex;function requireEs_typedArray_findLastIndex(){if(hasRequiredEs_typedArray_findLastIndex)return es_typedArray_findLastIndex;hasRequiredEs_typedArray_findLastIndex=1;var J=requireArrayBufferViewCore(),Y=requireArrayIterationFromLast().findLastIndex,re=J.aTypedArray,ae=J.exportTypedArrayMethod;return ae("findLastIndex",function(ce){return Y(re(this),ce,arguments.length>1?arguments[1]:void 0)}),es_typedArray_findLastIndex}var es_typedArray_forEach={},hasRequiredEs_typedArray_forEach;function requireEs_typedArray_forEach(){if(hasRequiredEs_typedArray_forEach)return es_typedArray_forEach;hasRequiredEs_typedArray_forEach=1;var J=requireArrayBufferViewCore(),Y=requireArrayIteration().forEach,re=J.aTypedArray,ae=J.exportTypedArrayMethod;return ae("forEach",function(ce){Y(re(this),ce,arguments.length>1?arguments[1]:void 0)}),es_typedArray_forEach}var es_typedArray_from={},hasRequiredEs_typedArray_from;function requireEs_typedArray_from(){if(hasRequiredEs_typedArray_from)return es_typedArray_from;hasRequiredEs_typedArray_from=1;var J=requireTypedArrayConstructorsRequireWrappers(),Y=requireArrayBufferViewCore().exportTypedArrayStaticMethod,re=requireTypedArrayFrom();return Y("from",re,J),es_typedArray_from}var es_typedArray_includes={},hasRequiredEs_typedArray_includes;function requireEs_typedArray_includes(){if(hasRequiredEs_typedArray_includes)return es_typedArray_includes;hasRequiredEs_typedArray_includes=1;var J=requireArrayBufferViewCore(),Y=requireArrayIncludes().includes,re=J.aTypedArray,ae=J.exportTypedArrayMethod;return ae("includes",function(ce){return Y(re(this),ce,arguments.length>1?arguments[1]:void 0)}),es_typedArray_includes}var es_typedArray_indexOf={},hasRequiredEs_typedArray_indexOf;function requireEs_typedArray_indexOf(){if(hasRequiredEs_typedArray_indexOf)return es_typedArray_indexOf;hasRequiredEs_typedArray_indexOf=1;var J=requireArrayBufferViewCore(),Y=requireArrayIncludes().indexOf,re=J.aTypedArray,ae=J.exportTypedArrayMethod;return ae("indexOf",function(ce){return Y(re(this),ce,arguments.length>1?arguments[1]:void 0)}),es_typedArray_indexOf}var es_typedArray_iterator={},hasRequiredEs_typedArray_iterator;function requireEs_typedArray_iterator(){if(hasRequiredEs_typedArray_iterator)return es_typedArray_iterator;hasRequiredEs_typedArray_iterator=1;var J=requireGlobalThis(),Y=requireFails(),re=requireFunctionUncurryThis(),ae=requireArrayBufferViewCore(),ne=requireEs_array_iterator(),ce=requireWellKnownSymbol(),ee=ce("iterator"),R=J.Uint8Array,U=re(ne.values),K=re(ne.keys),oe=re(ne.entries),pe=ae.aTypedArray,_e=ae.exportTypedArrayMethod,me=R&&R.prototype,we=!Y(function(){me[ee].call([1])}),Oe=!!me&&me.values&&me[ee]===me.values&&me.values.name==="values",De=function(){return U(pe(this))};return _e("entries",function(){return oe(pe(this))},we),_e("keys",function(){return K(pe(this))},we),_e("values",De,we||!Oe,{name:"values"}),_e(ee,De,we||!Oe,{name:"values"}),es_typedArray_iterator}var es_typedArray_join={},hasRequiredEs_typedArray_join;function requireEs_typedArray_join(){if(hasRequiredEs_typedArray_join)return es_typedArray_join;hasRequiredEs_typedArray_join=1;var J=requireArrayBufferViewCore(),Y=requireFunctionUncurryThis(),re=J.aTypedArray,ae=J.exportTypedArrayMethod,ne=Y([].join);return ae("join",function(ee){return ne(re(this),ee)}),es_typedArray_join}var es_typedArray_lastIndexOf={},hasRequiredEs_typedArray_lastIndexOf;function requireEs_typedArray_lastIndexOf(){if(hasRequiredEs_typedArray_lastIndexOf)return es_typedArray_lastIndexOf;hasRequiredEs_typedArray_lastIndexOf=1;var J=requireArrayBufferViewCore(),Y=requireFunctionApply(),re=requireArrayLastIndexOf(),ae=J.aTypedArray,ne=J.exportTypedArrayMethod;return ne("lastIndexOf",function(ee){var R=arguments.length;return Y(re,ae(this),R>1?[ee,arguments[1]]:[ee])}),es_typedArray_lastIndexOf}var es_typedArray_map={},hasRequiredEs_typedArray_map;function requireEs_typedArray_map(){if(hasRequiredEs_typedArray_map)return es_typedArray_map;hasRequiredEs_typedArray_map=1;var J=requireArrayBufferViewCore(),Y=requireArrayIteration().map,re=J.aTypedArray,ae=J.getTypedArrayConstructor,ne=J.exportTypedArrayMethod;return ne("map",function(ee){return Y(re(this),ee,arguments.length>1?arguments[1]:void 0,function(R,U){return new(ae(R))(U)})}),es_typedArray_map}var es_typedArray_of={},hasRequiredEs_typedArray_of;function requireEs_typedArray_of(){if(hasRequiredEs_typedArray_of)return es_typedArray_of;hasRequiredEs_typedArray_of=1;var J=requireArrayBufferViewCore(),Y=requireTypedArrayConstructorsRequireWrappers(),re=J.aTypedArrayConstructor,ae=J.exportTypedArrayStaticMethod;return ae("of",function(){for(var ce=0,ee=arguments.length,R=new(re(this))(ee);ee>ce;)R[ce]=arguments[ce++];return R},Y),es_typedArray_of}var es_typedArray_reduce={},hasRequiredEs_typedArray_reduce;function requireEs_typedArray_reduce(){if(hasRequiredEs_typedArray_reduce)return es_typedArray_reduce;hasRequiredEs_typedArray_reduce=1;var J=requireArrayBufferViewCore(),Y=requireArrayReduce().left,re=J.aTypedArray,ae=J.exportTypedArrayMethod;return ae("reduce",function(ce){var ee=arguments.length;return Y(re(this),ce,ee,ee>1?arguments[1]:void 0)}),es_typedArray_reduce}var es_typedArray_reduceRight={},hasRequiredEs_typedArray_reduceRight;function requireEs_typedArray_reduceRight(){if(hasRequiredEs_typedArray_reduceRight)return es_typedArray_reduceRight;hasRequiredEs_typedArray_reduceRight=1;var J=requireArrayBufferViewCore(),Y=requireArrayReduce().right,re=J.aTypedArray,ae=J.exportTypedArrayMethod;return ae("reduceRight",function(ce){var ee=arguments.length;return Y(re(this),ce,ee,ee>1?arguments[1]:void 0)}),es_typedArray_reduceRight}var es_typedArray_reverse={},hasRequiredEs_typedArray_reverse;function requireEs_typedArray_reverse(){if(hasRequiredEs_typedArray_reverse)return es_typedArray_reverse;hasRequiredEs_typedArray_reverse=1;var J=requireArrayBufferViewCore(),Y=J.aTypedArray,re=J.exportTypedArrayMethod,ae=Math.floor;return re("reverse",function(){for(var ce=this,ee=Y(ce).length,R=ae(ee/2),U=0,K;U<R;)K=ce[U],ce[U++]=ce[--ee],ce[ee]=K;return ce}),es_typedArray_reverse}var es_typedArray_set={},hasRequiredEs_typedArray_set;function requireEs_typedArray_set(){if(hasRequiredEs_typedArray_set)return es_typedArray_set;hasRequiredEs_typedArray_set=1;var J=requireGlobalThis(),Y=requireFunctionCall(),re=requireArrayBufferViewCore(),ae=requireLengthOfArrayLike(),ne=requireToOffset(),ce=requireToObject(),ee=requireFails(),R=J.RangeError,U=J.Int8Array,K=U&&U.prototype,oe=K&&K.set,pe=re.aTypedArray,_e=re.exportTypedArrayMethod,me=!ee(function(){var Oe=new Uint8ClampedArray(2);return Y(oe,Oe,{length:1,0:3},1),Oe[1]!==3}),we=me&&re.NATIVE_ARRAY_BUFFER_VIEWS&&ee(function(){var Oe=new U(2);return Oe.set(1),Oe.set("2",1),Oe[0]!==0||Oe[1]!==2});return _e("set",function(De){pe(this);var Ae=ne(arguments.length>1?arguments[1]:void 0,1),Ce=ce(De);if(me)return Y(oe,this,Ce,Ae);var je=this.length,ke=ae(Ce),Be=0;if(ke+Ae>je)throw new R("Wrong length");for(;Be<ke;)this[Ae+Be]=Ce[Be++]},!me||we),es_typedArray_set}var es_typedArray_slice={},hasRequiredEs_typedArray_slice;function requireEs_typedArray_slice(){if(hasRequiredEs_typedArray_slice)return es_typedArray_slice;hasRequiredEs_typedArray_slice=1;var J=requireArrayBufferViewCore(),Y=requireFails(),re=requireArraySlice(),ae=J.aTypedArray,ne=J.getTypedArrayConstructor,ce=J.exportTypedArrayMethod,ee=Y(function(){new Int8Array(1).slice()});return ce("slice",function(U,K){for(var oe=re(ae(this),U,K),pe=ne(this),_e=0,me=oe.length,we=new pe(me);me>_e;)we[_e]=oe[_e++];return we},ee),es_typedArray_slice}var es_typedArray_some={},hasRequiredEs_typedArray_some;function requireEs_typedArray_some(){if(hasRequiredEs_typedArray_some)return es_typedArray_some;hasRequiredEs_typedArray_some=1;var J=requireArrayBufferViewCore(),Y=requireArrayIteration().some,re=J.aTypedArray,ae=J.exportTypedArrayMethod;return ae("some",function(ce){return Y(re(this),ce,arguments.length>1?arguments[1]:void 0)}),es_typedArray_some}var es_typedArray_sort={},hasRequiredEs_typedArray_sort;function requireEs_typedArray_sort(){if(hasRequiredEs_typedArray_sort)return es_typedArray_sort;hasRequiredEs_typedArray_sort=1;var J=requireGlobalThis(),Y=requireFunctionUncurryThisClause(),re=requireFails(),ae=requireACallable(),ne=requireArraySort(),ce=requireArrayBufferViewCore(),ee=requireEnvironmentFfVersion(),R=requireEnvironmentIsIeOrEdge(),U=requireEnvironmentV8Version(),K=requireEnvironmentWebkitVersion(),oe=ce.aTypedArray,pe=ce.exportTypedArrayMethod,_e=J.Uint16Array,me=_e&&Y(_e.prototype.sort),we=!!me&&!(re(function(){me(new _e(2),null)})&&re(function(){me(new _e(2),{})})),Oe=!!me&&!re(function(){if(U)return U<74;if(ee)return ee<67;if(R)return!0;if(K)return K<602;var Ae=new _e(516),Ce=Array(516),je,ke;for(je=0;je<516;je++)ke=je%4,Ae[je]=515-je,Ce[je]=je-2*ke+3;for(me(Ae,function(Be,We){return(Be/4|0)-(We/4|0)}),je=0;je<516;je++)if(Ae[je]!==Ce[je])return!0}),De=function(Ae){return function(Ce,je){return Ae!==void 0?+Ae(Ce,je)||0:je!==je?-1:Ce!==Ce?1:Ce===0&&je===0?1/Ce>0&&1/je<0?1:-1:Ce>je}};return pe("sort",function(Ce){return Ce!==void 0&&ae(Ce),Oe?me(this,Ce):ne(oe(this),De(Ce))},!Oe||we),es_typedArray_sort}var es_typedArray_subarray={},hasRequiredEs_typedArray_subarray;function requireEs_typedArray_subarray(){if(hasRequiredEs_typedArray_subarray)return es_typedArray_subarray;hasRequiredEs_typedArray_subarray=1;var J=requireArrayBufferViewCore(),Y=requireToLength(),re=requireToAbsoluteIndex(),ae=J.aTypedArray,ne=J.getTypedArrayConstructor,ce=J.exportTypedArrayMethod;return ce("subarray",function(R,U){var K=ae(this),oe=K.length,pe=re(R,oe),_e=ne(K);return new _e(K.buffer,K.byteOffset+pe*K.BYTES_PER_ELEMENT,Y((U===void 0?oe:re(U,oe))-pe))}),es_typedArray_subarray}var es_typedArray_toLocaleString={},hasRequiredEs_typedArray_toLocaleString;function requireEs_typedArray_toLocaleString(){if(hasRequiredEs_typedArray_toLocaleString)return es_typedArray_toLocaleString;hasRequiredEs_typedArray_toLocaleString=1;var J=requireGlobalThis(),Y=requireFunctionApply(),re=requireArrayBufferViewCore(),ae=requireFails(),ne=requireArraySlice(),ce=J.Int8Array,ee=re.aTypedArray,R=re.exportTypedArrayMethod,U=[].toLocaleString,K=!!ce&&ae(function(){U.call(new ce(1))}),oe=ae(function(){return[1,2].toLocaleString()!==new ce([1,2]).toLocaleString()})||!ae(function(){ce.prototype.toLocaleString.call([1,2])});return R("toLocaleString",function(){return Y(U,K?ne(ee(this)):ee(this),ne(arguments))},oe),es_typedArray_toLocaleString}var es_typedArray_toReversed={},hasRequiredEs_typedArray_toReversed;function requireEs_typedArray_toReversed(){if(hasRequiredEs_typedArray_toReversed)return es_typedArray_toReversed;hasRequiredEs_typedArray_toReversed=1;var J=requireArrayToReversed(),Y=requireArrayBufferViewCore(),re=Y.aTypedArray,ae=Y.exportTypedArrayMethod,ne=Y.getTypedArrayConstructor;return ae("toReversed",function(){return J(re(this),ne(this))}),es_typedArray_toReversed}var es_typedArray_toSorted={},hasRequiredEs_typedArray_toSorted;function requireEs_typedArray_toSorted(){if(hasRequiredEs_typedArray_toSorted)return es_typedArray_toSorted;hasRequiredEs_typedArray_toSorted=1;var J=requireArrayBufferViewCore(),Y=requireFunctionUncurryThis(),re=requireACallable(),ae=requireArrayFromConstructorAndList(),ne=J.aTypedArray,ce=J.getTypedArrayConstructor,ee=J.exportTypedArrayMethod,R=Y(J.TypedArrayPrototype.sort);return ee("toSorted",function(K){K!==void 0&&re(K);var oe=ne(this),pe=ae(ce(oe),oe);return R(pe,K)}),es_typedArray_toSorted}var es_typedArray_toString={},hasRequiredEs_typedArray_toString;function requireEs_typedArray_toString(){if(hasRequiredEs_typedArray_toString)return es_typedArray_toString;hasRequiredEs_typedArray_toString=1;var J=requireArrayBufferViewCore().exportTypedArrayMethod,Y=requireFails(),re=requireGlobalThis(),ae=requireFunctionUncurryThis(),ne=re.Uint8Array,ce=ne&&ne.prototype||{},ee=[].toString,R=ae([].join);Y(function(){ee.call({})})&&(ee=function(){return R(this)});var U=ce.toString!==ee;return J("toString",ee,U),es_typedArray_toString}var es_typedArray_with={},hasRequiredEs_typedArray_with;function requireEs_typedArray_with(){if(hasRequiredEs_typedArray_with)return es_typedArray_with;hasRequiredEs_typedArray_with=1;var J=requireArrayWith(),Y=requireArrayBufferViewCore(),re=requireIsBigIntArray(),ae=requireToIntegerOrInfinity(),ne=requireToBigInt(),ce=Y.aTypedArray,ee=Y.getTypedArrayConstructor,R=Y.exportTypedArrayMethod,U=(function(){try{new Int8Array(1).with(2,{valueOf:function(){throw 8}})}catch(oe){return oe===8}})(),K=U&&(function(){try{new Int8Array(1).with(-.5,1)}catch{return!0}})();return R("with",function(oe,pe){var _e=ce(this),me=ae(oe),we=re(_e)?ne(pe):+pe;return J(_e,ee(_e),me,we)},!U||K),es_typedArray_with}var es_uint8Array_fromBase64={},anObjectOrUndefined,hasRequiredAnObjectOrUndefined;function requireAnObjectOrUndefined(){if(hasRequiredAnObjectOrUndefined)return anObjectOrUndefined;hasRequiredAnObjectOrUndefined=1;var J=requireIsObject$1(),Y=String,re=TypeError;return anObjectOrUndefined=function(ae){if(ae===void 0||J(ae))return ae;throw new re(Y(ae)+" is not an object or undefined")},anObjectOrUndefined}var base64Map,hasRequiredBase64Map;function requireBase64Map(){if(hasRequiredBase64Map)return base64Map;hasRequiredBase64Map=1;var J="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",Y=J+"+/",re=J+"-_",ae=function(ne){for(var ce={},ee=0;ee<64;ee++)ce[ne.charAt(ee)]=ee;return ce};return base64Map={i2c:Y,c2i:ae(Y),i2cUrl:re,c2iUrl:ae(re)},base64Map}var getAlphabetOption,hasRequiredGetAlphabetOption;function requireGetAlphabetOption(){if(hasRequiredGetAlphabetOption)return getAlphabetOption;hasRequiredGetAlphabetOption=1;var J=TypeError;return getAlphabetOption=function(Y){var re=Y&&Y.alphabet;if(re===void 0||re==="base64"||re==="base64url")return re||"base64";throw new J("Incorrect `alphabet` option")},getAlphabetOption}var uint8FromBase64,hasRequiredUint8FromBase64;function requireUint8FromBase64(){if(hasRequiredUint8FromBase64)return uint8FromBase64;hasRequiredUint8FromBase64=1;var J=requireGlobalThis(),Y=requireFunctionUncurryThis(),re=requireAnObjectOrUndefined(),ae=requireAString(),ne=requireHasOwnProperty(),ce=requireBase64Map(),ee=requireGetAlphabetOption(),R=requireArrayBufferNotDetached(),U=ce.c2i,K=ce.c2iUrl,oe=J.SyntaxError,pe=J.TypeError,_e=Y("".charAt),me=function(De,Ae){for(var Ce=De.length;Ae<Ce;Ae++){var je=_e(De,Ae);if(je!==" "&&je!=="	"&&je!==`
`&&je!=="\f"&&je!=="\r")break}return Ae},we=function(De,Ae,Ce){var je=De.length;je<4&&(De+=je===2?"AA":"A");var ke=(Ae[_e(De,0)]<<18)+(Ae[_e(De,1)]<<12)+(Ae[_e(De,2)]<<6)+Ae[_e(De,3)],Be=[ke>>16&255,ke>>8&255,ke&255];if(je===2){if(Ce&&Be[1]!==0)throw new oe("Extra bits");return[Be[0]]}if(je===3){if(Ce&&Be[2]!==0)throw new oe("Extra bits");return[Be[0],Be[1]]}return Be},Oe=function(De,Ae,Ce){for(var je=Ae.length,ke=0;ke<je;ke++)De[Ce+ke]=Ae[ke];return Ce+je};return uint8FromBase64=function(De,Ae,Ce,je){ae(De),re(Ae);var ke=ee(Ae)==="base64"?U:K,Be=Ae?Ae.lastChunkHandling:void 0;if(Be===void 0&&(Be="loose"),Be!=="loose"&&Be!=="strict"&&Be!=="stop-before-partial")throw new pe("Incorrect `lastChunkHandling` option");Ce&&R(Ce.buffer);var We=De.length,Je=Ce||[],Ke=0,et=0,it="",nt=0;if(je)for(;;){if(nt=me(De,nt),nt===We){if(it.length>0){if(Be==="stop-before-partial")break;if(Be==="loose"){if(it.length===1)throw new oe("Malformed padding: exactly one additional character");Ke=Oe(Je,we(it,ke,!1),Ke)}else throw new oe("Missing padding")}et=We;break}var ct=_e(De,nt);if(++nt,ct==="="){if(it.length<2)throw new oe("Padding is too early");if(nt=me(De,nt),it.length===2){if(nt===We){if(Be==="stop-before-partial")break;throw new oe("Malformed padding: only one =")}_e(De,nt)==="="&&(++nt,nt=me(De,nt))}if(nt<We)throw new oe("Unexpected character after padding");Ke=Oe(Je,we(it,ke,Be==="strict"),Ke),et=We;break}if(!ne(ke,ct))throw new oe("Unexpected character");var ft=je-Ke;if(ft===1&&it.length===2||ft===2&&it.length===3||(it+=ct,it.length===4&&(Ke=Oe(Je,we(it,ke,!1),Ke),it="",et=nt,Ke===je)))break}return{bytes:Je,read:et,written:Ke}},uint8FromBase64}var hasRequiredEs_uint8Array_fromBase64;function requireEs_uint8Array_fromBase64(){if(hasRequiredEs_uint8Array_fromBase64)return es_uint8Array_fromBase64;hasRequiredEs_uint8Array_fromBase64=1;var J=require_export(),Y=requireGlobalThis(),re=requireArrayFromConstructorAndList(),ae=requireUint8FromBase64(),ne=Y.Uint8Array,ce=!ne||!ne.fromBase64||!(function(){try{ne.fromBase64("a");return}catch{}try{ne.fromBase64("",null)}catch{return!0}})();return ne&&J({target:"Uint8Array",stat:!0,forced:ce},{fromBase64:function(R){var U=ae(R,arguments.length>1?arguments[1]:void 0,null,9007199254740991);return re(ne,U.bytes)}}),es_uint8Array_fromBase64}var es_uint8Array_fromHex={},uint8FromHex,hasRequiredUint8FromHex;function requireUint8FromHex(){if(hasRequiredUint8FromHex)return uint8FromHex;hasRequiredUint8FromHex=1;var J=requireGlobalThis(),Y=requireFunctionUncurryThis(),re=J.Uint8Array,ae=J.SyntaxError,ne=J.parseInt,ce=Math.min,ee=/[^\da-f]/i,R=Y(ee.exec),U=Y("".slice);return uint8FromHex=function(K,oe){var pe=K.length;if(pe%2!==0)throw new ae("String should be an even number of characters");for(var _e=oe?ce(oe.length,pe/2):pe/2,me=oe||new re(_e),we=0,Oe=0;Oe<_e;){var De=U(K,we,we+=2);if(R(ee,De))throw new ae("String should only contain hex characters");me[Oe++]=ne(De,16)}return{bytes:me,read:we}},uint8FromHex}var hasRequiredEs_uint8Array_fromHex;function requireEs_uint8Array_fromHex(){if(hasRequiredEs_uint8Array_fromHex)return es_uint8Array_fromHex;hasRequiredEs_uint8Array_fromHex=1;var J=require_export(),Y=requireGlobalThis(),re=requireAString(),ae=requireUint8FromHex();return Y.Uint8Array&&J({target:"Uint8Array",stat:!0},{fromHex:function(ce){return ae(re(ce)).bytes}}),es_uint8Array_fromHex}var es_uint8Array_setFromBase64={},anUint8Array,hasRequiredAnUint8Array;function requireAnUint8Array(){if(hasRequiredAnUint8Array)return anUint8Array;hasRequiredAnUint8Array=1;var J=requireClassof(),Y=TypeError;return anUint8Array=function(re){if(J(re)==="Uint8Array")return re;throw new Y("Argument is not an Uint8Array")},anUint8Array}var hasRequiredEs_uint8Array_setFromBase64;function requireEs_uint8Array_setFromBase64(){if(hasRequiredEs_uint8Array_setFromBase64)return es_uint8Array_setFromBase64;hasRequiredEs_uint8Array_setFromBase64=1;var J=require_export(),Y=requireGlobalThis(),re=requireUint8FromBase64(),ae=requireAnUint8Array(),ne=Y.Uint8Array,ce=!ne||!ne.prototype.setFromBase64||!(function(){var ee=new ne([255,255,255,255,255]);try{ee.setFromBase64("",null);return}catch{}try{ee.setFromBase64("a");return}catch{}try{ee.setFromBase64("MjYyZg===")}catch{return ee[0]===50&&ee[1]===54&&ee[2]===50&&ee[3]===255&&ee[4]===255}})();return ne&&J({target:"Uint8Array",proto:!0,forced:ce},{setFromBase64:function(R){ae(this);var U=re(R,arguments.length>1?arguments[1]:void 0,this,this.length);return{read:U.read,written:U.written}}}),es_uint8Array_setFromBase64}var es_uint8Array_setFromHex={},hasRequiredEs_uint8Array_setFromHex;function requireEs_uint8Array_setFromHex(){if(hasRequiredEs_uint8Array_setFromHex)return es_uint8Array_setFromHex;hasRequiredEs_uint8Array_setFromHex=1;var J=require_export(),Y=requireGlobalThis(),re=requireAString(),ae=requireAnUint8Array(),ne=requireArrayBufferNotDetached(),ce=requireUint8FromHex();return Y.Uint8Array&&J({target:"Uint8Array",proto:!0},{setFromHex:function(R){ae(this),re(R),ne(this.buffer);var U=ce(R,this).read;return{read:U,written:U/2}}}),es_uint8Array_setFromHex}var es_uint8Array_toBase64={},hasRequiredEs_uint8Array_toBase64;function requireEs_uint8Array_toBase64(){if(hasRequiredEs_uint8Array_toBase64)return es_uint8Array_toBase64;hasRequiredEs_uint8Array_toBase64=1;var J=require_export(),Y=requireGlobalThis(),re=requireFunctionUncurryThis(),ae=requireAnObjectOrUndefined(),ne=requireAnUint8Array(),ce=requireArrayBufferNotDetached(),ee=requireBase64Map(),R=requireGetAlphabetOption(),U=ee.i2c,K=ee.i2cUrl,oe=re("".charAt),pe=Y.Uint8Array,_e=!pe||!pe.prototype.toBase64||!(function(){try{var me=new pe;me.toBase64(null)}catch{return!0}})();return pe&&J({target:"Uint8Array",proto:!0,forced:_e},{toBase64:function(){var we=ne(this),Oe=arguments.length?ae(arguments[0]):void 0,De=R(Oe)==="base64"?U:K,Ae=!!Oe&&!!Oe.omitPadding;ce(this.buffer);for(var Ce="",je=0,ke=we.length,Be,We=function(Je){return oe(De,Be>>6*Je&63)};je+2<ke;je+=3)Be=(we[je]<<16)+(we[je+1]<<8)+we[je+2],Ce+=We(3)+We(2)+We(1)+We(0);return je+2===ke?(Be=(we[je]<<16)+(we[je+1]<<8),Ce+=We(3)+We(2)+We(1)+(Ae?"":"=")):je+1===ke&&(Be=we[je]<<16,Ce+=We(3)+We(2)+(Ae?"":"==")),Ce}}),es_uint8Array_toBase64}var es_uint8Array_toHex={},hasRequiredEs_uint8Array_toHex;function requireEs_uint8Array_toHex(){if(hasRequiredEs_uint8Array_toHex)return es_uint8Array_toHex;hasRequiredEs_uint8Array_toHex=1;var J=require_export(),Y=requireGlobalThis(),re=requireFunctionUncurryThis(),ae=requireAnUint8Array(),ne=requireArrayBufferNotDetached(),ce=re(1.1.toString),ee=Y.Uint8Array,R=!ee||!ee.prototype.toHex||!(function(){try{var U=new ee([255,255,255,255,255,255,255,255]);return U.toHex()==="ffffffffffffffff"}catch{return!1}})();return ee&&J({target:"Uint8Array",proto:!0,forced:R},{toHex:function(){ae(this),ne(this.buffer);for(var K="",oe=0,pe=this.length;oe<pe;oe++){var _e=ce(this[oe],16);K+=_e.length===1?"0"+_e:_e}return K}}),es_uint8Array_toHex}var es_unescape={},hasRequiredEs_unescape;function requireEs_unescape(){if(hasRequiredEs_unescape)return es_unescape;hasRequiredEs_unescape=1;var J=require_export(),Y=requireFunctionUncurryThis(),re=requireToString$1(),ae=String.fromCharCode,ne=Y("".charAt),ce=Y(/./.exec),ee=Y("".slice),R=/^[\da-f]{2}$/i,U=/^[\da-f]{4}$/i;return J({global:!0},{unescape:function(oe){for(var pe=re(oe),_e="",me=pe.length,we=0,Oe,De;we<me;){if(Oe=ne(pe,we++),Oe==="%"){if(ne(pe,we)==="u"){if(De=ee(pe,we+1,we+5),ce(U,De)){_e+=ae(parseInt(De,16)),we+=5;continue}}else if(De=ee(pe,we,we+2),ce(R,De)){_e+=ae(parseInt(De,16)),we+=2;continue}}_e+=Oe}return _e}}),es_unescape}var es_weakMap={},es_weakMap_constructor={},collectionWeak,hasRequiredCollectionWeak;function requireCollectionWeak(){if(hasRequiredCollectionWeak)return collectionWeak;hasRequiredCollectionWeak=1;var J=requireFunctionUncurryThis(),Y=requireDefineBuiltIns(),re=requireInternalMetadata().getWeakData,ae=requireAnInstance(),ne=requireAnObject(),ce=requireIsNullOrUndefined(),ee=requireIsObject$1(),R=requireIterate(),U=requireArrayIteration(),K=requireHasOwnProperty(),oe=requireInternalState(),pe=oe.set,_e=oe.getterFor,me=U.find,we=U.findIndex,Oe=J([].splice),De=0,Ae=function(ke){return ke.frozen||(ke.frozen=new Ce)},Ce=function(){this.entries=[]},je=function(ke,Be){return me(ke.entries,function(We){return We[0]===Be})};return Ce.prototype={get:function(ke){var Be=je(this,ke);if(Be)return Be[1]},has:function(ke){return!!je(this,ke)},set:function(ke,Be){var We=je(this,ke);We?We[1]=Be:this.entries.push([ke,Be])},delete:function(ke){var Be=we(this.entries,function(We){return We[0]===ke});return~Be&&Oe(this.entries,Be,1),!!~Be}},collectionWeak={getConstructor:function(ke,Be,We,Je){var Ke=ke(function(ct,ft){ae(ct,et),pe(ct,{type:Be,id:De++,frozen:null}),ce(ft)||R(ft,ct[Je],{that:ct,AS_ENTRIES:We})}),et=Ke.prototype,it=_e(Be),nt=function(ct,ft,_t){var Rt=it(ct),Ft=re(ne(ft),!0);return Ft===!0?Ae(Rt).set(ft,_t):Ft[Rt.id]=_t,ct};return Y(et,{delete:function(ct){var ft=it(this);if(!ee(ct))return!1;var _t=re(ct);return _t===!0?Ae(ft).delete(ct):_t&&K(_t,ft.id)&&delete _t[ft.id]},has:function(ft){var _t=it(this);if(!ee(ft))return!1;var Rt=re(ft);return Rt===!0?Ae(_t).has(ft):Rt&&K(Rt,_t.id)}}),Y(et,We?{get:function(ft){var _t=it(this);if(ee(ft)){var Rt=re(ft);if(Rt===!0)return Ae(_t).get(ft);if(Rt)return Rt[_t.id]}},set:function(ft,_t){return nt(this,ft,_t)}}:{add:function(ft){return nt(this,ft,!0)}}),Ke}},collectionWeak}var hasRequiredEs_weakMap_constructor;function requireEs_weakMap_constructor(){if(hasRequiredEs_weakMap_constructor)return es_weakMap_constructor;hasRequiredEs_weakMap_constructor=1;var J=requireFreezing(),Y=requireGlobalThis(),re=requireFunctionUncurryThis(),ae=requireDefineBuiltIns(),ne=requireInternalMetadata(),ce=requireCollection(),ee=requireCollectionWeak(),R=requireIsObject$1(),U=requireInternalState().enforce,K=requireFails(),oe=requireWeakMapBasicDetection(),pe=Object,_e=Array.isArray,me=pe.isExtensible,we=pe.isFrozen,Oe=pe.isSealed,De=pe.freeze,Ae=pe.seal,Ce=!Y.ActiveXObject&&"ActiveXObject"in Y,je,ke=function(ct){return function(){return ct(this,arguments.length?arguments[0]:void 0)}},Be=ce("WeakMap",ke,ee),We=Be.prototype,Je=re(We.set),Ke=function(){return J&&K(function(){var ct=De([]);return Je(new Be,ct,1),!we(ct)})};if(oe)if(Ce){je=ee.getConstructor(ke,"WeakMap",!0),ne.enable();var et=re(We.delete),it=re(We.has),nt=re(We.get);ae(We,{delete:function(ct){if(R(ct)&&!me(ct)){var ft=U(this);return ft.frozen||(ft.frozen=new je),et(this,ct)||ft.frozen.delete(ct)}return et(this,ct)},has:function(ft){if(R(ft)&&!me(ft)){var _t=U(this);return _t.frozen||(_t.frozen=new je),it(this,ft)||_t.frozen.has(ft)}return it(this,ft)},get:function(ft){if(R(ft)&&!me(ft)){var _t=U(this);return _t.frozen||(_t.frozen=new je),it(this,ft)?nt(this,ft):_t.frozen.get(ft)}return nt(this,ft)},set:function(ft,_t){if(R(ft)&&!me(ft)){var Rt=U(this);Rt.frozen||(Rt.frozen=new je),it(this,ft)?Je(this,ft,_t):Rt.frozen.set(ft,_t)}else Je(this,ft,_t);return this}})}else Ke()&&ae(We,{set:function(ft,_t){var Rt;return _e(ft)&&(we(ft)?Rt=De:Oe(ft)&&(Rt=Ae)),Je(this,ft,_t),Rt&&Rt(ft),this}});return es_weakMap_constructor}var hasRequiredEs_weakMap;function requireEs_weakMap(){return hasRequiredEs_weakMap||(hasRequiredEs_weakMap=1,requireEs_weakMap_constructor()),es_weakMap}var es_weakSet={},es_weakSet_constructor={},hasRequiredEs_weakSet_constructor;function requireEs_weakSet_constructor(){if(hasRequiredEs_weakSet_constructor)return es_weakSet_constructor;hasRequiredEs_weakSet_constructor=1;var J=requireCollection(),Y=requireCollectionWeak();return J("WeakSet",function(re){return function(){return re(this,arguments.length?arguments[0]:void 0)}},Y),es_weakSet_constructor}var hasRequiredEs_weakSet;function requireEs_weakSet(){return hasRequiredEs_weakSet||(hasRequiredEs_weakSet=1,requireEs_weakSet_constructor()),es_weakSet}var web_atob={},hasRequiredWeb_atob;function requireWeb_atob(){if(hasRequiredWeb_atob)return web_atob;hasRequiredWeb_atob=1;var J=require_export(),Y=requireGlobalThis(),re=requireGetBuiltIn(),ae=requireFunctionUncurryThis(),ne=requireFunctionCall(),ce=requireFails(),ee=requireToString$1(),R=requireValidateArgumentsLength(),U=requireBase64Map().c2i,K=/[^\d+/a-z]/i,oe=/[\t\n\f\r ]+/g,pe=/[=]{1,2}$/,_e=re("atob"),me=String.fromCharCode,we=ae("".charAt),Oe=ae("".replace),De=ae(K.exec),Ae=!!_e&&!ce(function(){return _e("aGk=")!=="hi"}),Ce=Ae&&ce(function(){return _e(" ")!==""}),je=Ae&&!ce(function(){_e("a")}),ke=Ae&&!ce(function(){_e()}),Be=Ae&&_e.length!==1,We=!Ae||Ce||je||ke||Be;return J({global:!0,bind:!0,enumerable:!0,forced:We},{atob:function(Ke){if(R(arguments.length,1),Ae&&!Ce&&!je)return ne(_e,Y,Ke);var et=Oe(ee(Ke),oe,""),it="",nt=0,ct=0,ft,_t,Rt;if(et.length%4===0&&(et=Oe(et,pe,"")),ft=et.length,ft%4===1||De(K,et))throw new(re("DOMException"))("The string is not correctly encoded","InvalidCharacterError");for(;nt<ft;)_t=we(et,nt++),Rt=ct%4?Rt*64+U[_t]:U[_t],ct++%4&&(it+=me(255&Rt>>(-2*ct&6)));return it}}),web_atob}var web_btoa={},hasRequiredWeb_btoa;function requireWeb_btoa(){if(hasRequiredWeb_btoa)return web_btoa;hasRequiredWeb_btoa=1;var J=require_export(),Y=requireGlobalThis(),re=requireGetBuiltIn(),ae=requireFunctionUncurryThis(),ne=requireFunctionCall(),ce=requireFails(),ee=requireToString$1(),R=requireValidateArgumentsLength(),U=requireBase64Map().i2c,K=re("btoa"),oe=ae("".charAt),pe=ae("".charCodeAt),_e=!!K&&!ce(function(){return K("hi")!=="aGk="}),me=_e&&!ce(function(){K()}),we=_e&&ce(function(){return K(null)!=="bnVsbA=="}),Oe=_e&&K.length!==1;return J({global:!0,bind:!0,enumerable:!0,forced:!_e||me||we||Oe},{btoa:function(Ae){if(R(arguments.length,1),_e)return ne(K,Y,ee(Ae));for(var Ce=ee(Ae),je="",ke=0,Be=U,We,Je;oe(Ce,ke)||(Be="=",ke%1);){if(Je=pe(Ce,ke+=3/4),Je>255)throw new(re("DOMException"))("The string contains characters outside of the Latin1 range","InvalidCharacterError");We=We<<8|Je,je+=oe(Be,63&We>>8-ke%1*8)}return je}}),web_btoa}var web_domCollections_forEach={},domIterables,hasRequiredDomIterables;function requireDomIterables(){return hasRequiredDomIterables||(hasRequiredDomIterables=1,domIterables={CSSRuleList:0,CSSStyleDeclaration:0,CSSValueList:0,ClientRectList:0,DOMRectList:0,DOMStringList:0,DOMTokenList:1,DataTransferItemList:0,FileList:0,HTMLAllCollection:0,HTMLCollection:0,HTMLFormElement:0,HTMLSelectElement:0,MediaList:0,MimeTypeArray:0,NamedNodeMap:0,NodeList:1,PaintRequestList:0,Plugin:0,PluginArray:0,SVGLengthList:0,SVGNumberList:0,SVGPathSegList:0,SVGPointList:0,SVGStringList:0,SVGTransformList:0,SourceBufferList:0,StyleSheetList:0,TextTrackCueList:0,TextTrackList:0,TouchList:0}),domIterables}var domTokenListPrototype,hasRequiredDomTokenListPrototype;function requireDomTokenListPrototype(){if(hasRequiredDomTokenListPrototype)return domTokenListPrototype;hasRequiredDomTokenListPrototype=1;var J=requireDocumentCreateElement(),Y=J("span").classList,re=Y&&Y.constructor&&Y.constructor.prototype;return domTokenListPrototype=re===Object.prototype?void 0:re,domTokenListPrototype}var hasRequiredWeb_domCollections_forEach;function requireWeb_domCollections_forEach(){if(hasRequiredWeb_domCollections_forEach)return web_domCollections_forEach;hasRequiredWeb_domCollections_forEach=1;var J=requireGlobalThis(),Y=requireDomIterables(),re=requireDomTokenListPrototype(),ae=requireArrayForEach(),ne=requireCreateNonEnumerableProperty(),ce=function(R){if(R&&R.forEach!==ae)try{ne(R,"forEach",ae)}catch{R.forEach=ae}};for(var ee in Y)Y[ee]&&ce(J[ee]&&J[ee].prototype);return ce(re),web_domCollections_forEach}var web_domCollections_iterator={},hasRequiredWeb_domCollections_iterator;function requireWeb_domCollections_iterator(){if(hasRequiredWeb_domCollections_iterator)return web_domCollections_iterator;hasRequiredWeb_domCollections_iterator=1;var J=requireGlobalThis(),Y=requireDomIterables(),re=requireDomTokenListPrototype(),ae=requireEs_array_iterator(),ne=requireCreateNonEnumerableProperty(),ce=requireSetToStringTag(),ee=requireWellKnownSymbol(),R=ee("iterator"),U=ae.values,K=function(pe,_e){if(pe){if(pe[R]!==U)try{ne(pe,R,U)}catch{pe[R]=U}if(ce(pe,_e,!0),Y[_e]){for(var me in ae)if(pe[me]!==ae[me])try{ne(pe,me,ae[me])}catch{pe[me]=ae[me]}}}};for(var oe in Y)K(J[oe]&&J[oe].prototype,oe);return K(re,"DOMTokenList"),web_domCollections_iterator}var web_domException_constructor={},domExceptionConstants,hasRequiredDomExceptionConstants;function requireDomExceptionConstants(){return hasRequiredDomExceptionConstants||(hasRequiredDomExceptionConstants=1,domExceptionConstants={IndexSizeError:{s:"INDEX_SIZE_ERR",c:1,m:1},DOMStringSizeError:{s:"DOMSTRING_SIZE_ERR",c:2,m:0},HierarchyRequestError:{s:"HIERARCHY_REQUEST_ERR",c:3,m:1},WrongDocumentError:{s:"WRONG_DOCUMENT_ERR",c:4,m:1},InvalidCharacterError:{s:"INVALID_CHARACTER_ERR",c:5,m:1},NoDataAllowedError:{s:"NO_DATA_ALLOWED_ERR",c:6,m:0},NoModificationAllowedError:{s:"NO_MODIFICATION_ALLOWED_ERR",c:7,m:1},NotFoundError:{s:"NOT_FOUND_ERR",c:8,m:1},NotSupportedError:{s:"NOT_SUPPORTED_ERR",c:9,m:1},InUseAttributeError:{s:"INUSE_ATTRIBUTE_ERR",c:10,m:1},InvalidStateError:{s:"INVALID_STATE_ERR",c:11,m:1},SyntaxError:{s:"SYNTAX_ERR",c:12,m:1},InvalidModificationError:{s:"INVALID_MODIFICATION_ERR",c:13,m:1},NamespaceError:{s:"NAMESPACE_ERR",c:14,m:1},InvalidAccessError:{s:"INVALID_ACCESS_ERR",c:15,m:1},ValidationError:{s:"VALIDATION_ERR",c:16,m:0},TypeMismatchError:{s:"TYPE_MISMATCH_ERR",c:17,m:1},SecurityError:{s:"SECURITY_ERR",c:18,m:1},NetworkError:{s:"NETWORK_ERR",c:19,m:1},AbortError:{s:"ABORT_ERR",c:20,m:1},URLMismatchError:{s:"URL_MISMATCH_ERR",c:21,m:1},QuotaExceededError:{s:"QUOTA_EXCEEDED_ERR",c:22,m:1},TimeoutError:{s:"TIMEOUT_ERR",c:23,m:1},InvalidNodeTypeError:{s:"INVALID_NODE_TYPE_ERR",c:24,m:1},DataCloneError:{s:"DATA_CLONE_ERR",c:25,m:1}}),domExceptionConstants}var hasRequiredWeb_domException_constructor;function requireWeb_domException_constructor(){if(hasRequiredWeb_domException_constructor)return web_domException_constructor;hasRequiredWeb_domException_constructor=1;var J=require_export(),Y=requireGetBuiltIn(),re=requireGetBuiltInNodeModule(),ae=requireFails(),ne=requireObjectCreate(),ce=requireCreatePropertyDescriptor(),ee=requireObjectDefineProperty().f,R=requireDefineBuiltIn(),U=requireDefineBuiltInAccessor(),K=requireHasOwnProperty(),oe=requireAnInstance(),pe=requireAnObject(),_e=requireErrorToString(),me=requireNormalizeStringArgument(),we=requireDomExceptionConstants(),Oe=requireErrorStackClear(),De=requireInternalState(),Ae=requireDescriptors(),Ce=requireIsPure(),je="DOMException",ke="DATA_CLONE_ERR",Be=Y("Error"),We=Y(je)||(function(){try{var Wt=Y("MessageChannel")||re("worker_threads").MessageChannel;new Wt().port1.postMessage(new WeakMap)}catch(or){if(or.name===ke&&or.code===25)return or.constructor}})(),Je=We&&We.prototype,Ke=Be.prototype,et=De.set,it=De.getterFor(je),nt="stack"in new Be(je),ct=function(Wt){return K(we,Wt)&&we[Wt].m?we[Wt].c:0},ft=function(){oe(this,_t);var or=arguments.length,wr=me(or<1?void 0:arguments[0]),Ir=me(or<2?void 0:arguments[1],"Error"),br=ct(Ir);if(et(this,{type:je,name:Ir,message:wr,code:br}),Ae||(this.name=Ir,this.message=wr,this.code=br),nt){var gr=new Be(wr);gr.name=je,ee(this,"stack",ce(1,Oe(gr.stack,1)))}},_t=ft.prototype=ne(Ke),Rt=function(Wt){return{enumerable:!0,configurable:!0,get:Wt}},Ft=function(Wt){return Rt(function(){return it(this)[Wt]})};Ae&&(U(_t,"code",Ft("code")),U(_t,"message",Ft("message")),U(_t,"name",Ft("name"))),ee(_t,"constructor",ce(1,ft));var ht=ae(function(){return!(new We instanceof Be)}),St=ht||ae(function(){return Ke.toString!==_e||String(new We(1,2))!=="2: 1"}),ut=ht||ae(function(){return new We(1,"DataCloneError").code!==25}),Et=ht||We[ke]!==25||Je[ke]!==25,bt=Ce?St||ut||Et:ht;J({global:!0,constructor:!0,forced:bt},{DOMException:bt?ft:We});var Dt=Y(je),Ut=Dt.prototype;St&&(Ce||We===Dt)&&R(Ut,"toString",_e),ut&&Ae&&We===Dt&&U(Ut,"code",Rt(function(){return ct(pe(this).name)}));for(var er in we)if(K(we,er)){var xr=we[er],ur=xr.s,yr=ce(6,xr.c);K(Dt,ur)||ee(Dt,ur,yr),K(Ut,ur)||ee(Ut,ur,yr)}return web_domException_constructor}var web_domException_stack={},hasRequiredWeb_domException_stack;function requireWeb_domException_stack(){if(hasRequiredWeb_domException_stack)return web_domException_stack;hasRequiredWeb_domException_stack=1;var J=require_export(),Y=requireGlobalThis(),re=requireGetBuiltIn(),ae=requireCreatePropertyDescriptor(),ne=requireObjectDefineProperty().f,ce=requireHasOwnProperty(),ee=requireAnInstance(),R=requireInheritIfRequired(),U=requireNormalizeStringArgument(),K=requireDomExceptionConstants(),oe=requireErrorStackClear(),pe=requireDescriptors(),_e=requireIsPure(),me="DOMException",we=re("Error"),Oe=re(me),De=function(){ee(this,Ae);var ft=arguments.length,_t=U(ft<1?void 0:arguments[0]),Rt=U(ft<2?void 0:arguments[1],"Error"),Ft=new Oe(_t,Rt),ht=new we(_t);return ht.name=me,ne(Ft,"stack",ae(1,oe(ht.stack,1))),R(Ft,this,De),Ft},Ae=De.prototype=Oe.prototype,Ce="stack"in new we(me),je="stack"in new Oe(1,2),ke=Oe&&pe&&Object.getOwnPropertyDescriptor(Y,me),Be=!!ke&&!(ke.writable&&ke.configurable),We=Ce&&!Be&&!je;J({global:!0,constructor:!0,forced:_e||We},{DOMException:We?De:Oe});var Je=re(me),Ke=Je.prototype;if(Ke.constructor!==Je){_e||ne(Ke,"constructor",ae(1,Je));for(var et in K)if(ce(K,et)){var it=K[et],nt=it.s;ce(Je,nt)||ne(Je,nt,ae(6,it.c))}}return web_domException_stack}var web_domException_toStringTag={},hasRequiredWeb_domException_toStringTag;function requireWeb_domException_toStringTag(){if(hasRequiredWeb_domException_toStringTag)return web_domException_toStringTag;hasRequiredWeb_domException_toStringTag=1;var J=requireGetBuiltIn(),Y=requireSetToStringTag(),re="DOMException";return Y(J(re),re),web_domException_toStringTag}var web_immediate={},web_clearImmediate={},hasRequiredWeb_clearImmediate;function requireWeb_clearImmediate(){if(hasRequiredWeb_clearImmediate)return web_clearImmediate;hasRequiredWeb_clearImmediate=1;var J=require_export(),Y=requireGlobalThis(),re=requireTask().clear;return J({global:!0,bind:!0,enumerable:!0,forced:Y.clearImmediate!==re},{clearImmediate:re}),web_clearImmediate}var web_setImmediate={},schedulersFix,hasRequiredSchedulersFix;function requireSchedulersFix(){if(hasRequiredSchedulersFix)return schedulersFix;hasRequiredSchedulersFix=1;var J=requireGlobalThis(),Y=requireFunctionApply(),re=requireIsCallable(),ae=requireEnvironment(),ne=requireEnvironmentUserAgent(),ce=requireArraySlice(),ee=requireValidateArgumentsLength(),R=J.Function,U=/MSIE .\./.test(ne)||ae==="BUN"&&(function(){var K=J.Bun.version.split(".");return K.length<3||K[0]==="0"&&(K[1]<3||K[1]==="3"&&K[2]==="0")})();return schedulersFix=function(K,oe){var pe=oe?2:1;return U?function(_e,me){var we=ee(arguments.length,1)>pe,Oe=re(_e)?_e:R(_e),De=we?ce(arguments,pe):[],Ae=we?function(){Y(Oe,this,De)}:Oe;return oe?K(Ae,me):K(Ae)}:K},schedulersFix}var hasRequiredWeb_setImmediate;function requireWeb_setImmediate(){if(hasRequiredWeb_setImmediate)return web_setImmediate;hasRequiredWeb_setImmediate=1;var J=require_export(),Y=requireGlobalThis(),re=requireTask().set,ae=requireSchedulersFix(),ne=Y.setImmediate?ae(re,!1):re;return J({global:!0,bind:!0,enumerable:!0,forced:Y.setImmediate!==ne},{setImmediate:ne}),web_setImmediate}var hasRequiredWeb_immediate;function requireWeb_immediate(){return hasRequiredWeb_immediate||(hasRequiredWeb_immediate=1,requireWeb_clearImmediate(),requireWeb_setImmediate()),web_immediate}var web_queueMicrotask={},hasRequiredWeb_queueMicrotask;function requireWeb_queueMicrotask(){if(hasRequiredWeb_queueMicrotask)return web_queueMicrotask;hasRequiredWeb_queueMicrotask=1;var J=require_export(),Y=requireGlobalThis(),re=requireMicrotask(),ae=requireACallable(),ne=requireValidateArgumentsLength(),ce=requireFails(),ee=requireDescriptors(),R=ce(function(){return ee&&Object.getOwnPropertyDescriptor(Y,"queueMicrotask").value.length!==1});return J({global:!0,enumerable:!0,dontCallGetSet:!0,forced:R},{queueMicrotask:function(K){ne(arguments.length,1),re(ae(K))}}),web_queueMicrotask}var web_self={},hasRequiredWeb_self;function requireWeb_self(){if(hasRequiredWeb_self)return web_self;hasRequiredWeb_self=1;var J=require_export(),Y=requireGlobalThis(),re=requireDefineBuiltInAccessor(),ae=requireDescriptors(),ne=TypeError,ce=Object.defineProperty,ee=Y.self!==Y;try{if(ae){var R=Object.getOwnPropertyDescriptor(Y,"self");(ee||!R||!R.get||!R.enumerable)&&re(Y,"self",{get:function(){return Y},set:function(K){if(this!==Y)throw new ne("Illegal invocation");ce(Y,"self",{value:K,writable:!0,configurable:!0,enumerable:!0})},configurable:!0,enumerable:!0})}else J({global:!0,simple:!0,forced:ee},{self:Y})}catch{}return web_self}var web_structuredClone={},hasRequiredWeb_structuredClone;function requireWeb_structuredClone(){if(hasRequiredWeb_structuredClone)return web_structuredClone;hasRequiredWeb_structuredClone=1;var J=requireIsPure(),Y=require_export(),re=requireGlobalThis(),ae=requireGetBuiltIn(),ne=requireFunctionUncurryThis(),ce=requireFails(),ee=requireUid(),R=requireIsCallable(),U=requireIsConstructor(),K=requireIsNullOrUndefined(),oe=requireIsObject$1(),pe=requireIsSymbol$1(),_e=requireIterate(),me=requireAnObject(),we=requireClassof(),Oe=requireHasOwnProperty(),De=requireCreateProperty(),Ae=requireCreateNonEnumerableProperty(),Ce=requireLengthOfArrayLike(),je=requireValidateArgumentsLength(),ke=requireRegexpGetFlags(),Be=requireMapHelpers(),We=requireSetHelpers(),Je=requireSetIterate(),Ke=requireDetachTransferable(),et=requireErrorStackInstallable(),it=requireStructuredCloneProperTransfer(),nt=re.Object,ct=re.Array,ft=re.Date,_t=re.Error,Rt=re.TypeError,Ft=re.PerformanceMark,ht=ae("DOMException"),St=Be.Map,ut=Be.has,Et=Be.get,bt=Be.set,Dt=We.Set,Ut=We.add,er=We.has,xr=ae("Object","keys"),ur=ne([].push),yr=ne((!0).valueOf),Wt=ne(1.1.valueOf),or=ne("".valueOf),wr=ne(ft.prototype.getTime),Ir=ee("structuredClone"),br="DataCloneError",gr="Transferring",Mr=function(xe){return!ce(function(){var Te=new re.Set([7]),Me=xe(Te),ze=xe(nt(7));return Me===Te||!Me.has(7)||!oe(ze)||+ze!=7})&&xe},Hr=function(xe,Te){return!ce(function(){var Me=new Te,ze=xe({a:Me,b:Me});return!(ze&&ze.a===ze.b&&ze.a instanceof Te&&ze.a.stack===Me.stack)})},jr=function(xe){return!ce(function(){var Te=xe(new re.AggregateError([1],Ir,{cause:3}));return Te.name!=="AggregateError"||Te.errors[0]!==1||Te.message!==Ir||Te.cause!==3})},Sr=re.structuredClone,Nr=J||!Hr(Sr,_t)||!Hr(Sr,ht)||!jr(Sr),Dr=!Sr&&Mr(function(xe){return new Ft(Ir,{detail:xe}).detail}),Lr=Mr(Sr)||Dr,Yt=function(xe){throw new ht("Uncloneable type: "+xe,br)},Jt=function(xe,Te){throw new ht((Te||"Cloning")+" of "+xe+" cannot be properly polyfilled in this engine",br)},qr=function(xe,Te){return Lr||Jt(Te),Lr(xe)},nr=function(){var xe;try{xe=new re.DataTransfer}catch{try{xe=new re.ClipboardEvent("").clipboardData}catch{}}return xe&&xe.items&&xe.files?xe:null},dr=function(xe,Te,Me){if(ut(Te,xe))return Et(Te,xe);var ze=Me||we(xe),Qe,tt,He,Ze,st,At;if(ze==="SharedArrayBuffer")Lr?Qe=Lr(xe):Qe=xe;else{var wt=re.DataView;!wt&&!R(xe.slice)&&Jt("ArrayBuffer");try{if(R(xe.slice)&&!xe.resizable)Qe=xe.slice(0);else for(tt=xe.byteLength,He=("maxByteLength"in xe)?{maxByteLength:xe.maxByteLength}:void 0,Qe=new ArrayBuffer(tt,He),Ze=new wt(xe),st=new wt(Qe),At=0;At<tt;At++)st.setUint8(At,Ze.getUint8(At))}catch{throw new ht("ArrayBuffer is detached",br)}}return bt(Te,xe,Qe),Qe},mr=function(xe,Te,Me,ze,Qe){var tt=re[Te];return oe(tt)||Jt(Te),new tt(dr(xe.buffer,Qe),Me,ze)},Ge=function(xe,Te){if(pe(xe)&&Yt("Symbol"),!oe(xe))return xe;if(Te){if(ut(Te,xe))return Et(Te,xe)}else Te=new St;var Me=we(xe),ze,Qe,tt,He,Ze,st,At,wt;switch(Me){case"Array":tt=ct(Ce(xe));break;case"Object":tt={};break;case"Map":tt=new St;break;case"Set":tt=new Dt;break;case"RegExp":tt=new RegExp(xe.source,ke(xe));break;case"Error":switch(Qe=xe.name,Qe){case"AggregateError":tt=new(ae(Qe))([]);break;case"EvalError":case"RangeError":case"ReferenceError":case"SuppressedError":case"SyntaxError":case"TypeError":case"URIError":tt=new(ae(Qe));break;case"CompileError":case"LinkError":case"RuntimeError":tt=new(ae("WebAssembly",Qe));break;default:tt=new _t}break;case"DOMException":tt=new ht(xe.message,xe.name);break;case"ArrayBuffer":case"SharedArrayBuffer":tt=dr(xe,Te,Me);break;case"DataView":case"Int8Array":case"Uint8Array":case"Uint8ClampedArray":case"Int16Array":case"Uint16Array":case"Int32Array":case"Uint32Array":case"Float16Array":case"Float32Array":case"Float64Array":case"BigInt64Array":case"BigUint64Array":st=Me==="DataView"?xe.byteLength:xe.length,tt=mr(xe,Me,xe.byteOffset,st,Te);break;case"DOMQuad":try{tt=new DOMQuad(Ge(xe.p1,Te),Ge(xe.p2,Te),Ge(xe.p3,Te),Ge(xe.p4,Te))}catch{tt=qr(xe,Me)}break;case"File":if(Lr)try{tt=Lr(xe),we(tt)!==Me&&(tt=void 0)}catch{}if(!tt)try{tt=new File([xe],xe.name,xe)}catch{}tt||Jt(Me);break;case"FileList":if(He=nr(),He){for(Ze=0,st=Ce(xe);Ze<st;Ze++)He.items.add(Ge(xe[Ze],Te));tt=He.files}else tt=qr(xe,Me);break;case"ImageData":try{tt=new ImageData(Ge(xe.data,Te),xe.width,xe.height,{colorSpace:xe.colorSpace})}catch{tt=qr(xe,Me)}break;default:if(Lr)tt=Lr(xe);else switch(Me){case"BigInt":tt=nt(xe.valueOf());break;case"Boolean":tt=nt(yr(xe));break;case"Number":tt=nt(Wt(xe));break;case"String":tt=nt(or(xe));break;case"Date":tt=new ft(wr(xe));break;case"Blob":try{tt=xe.slice(0,xe.size,xe.type)}catch{Jt(Me)}break;case"DOMPoint":case"DOMPointReadOnly":ze=re[Me];try{tt=ze.fromPoint?ze.fromPoint(xe):new ze(xe.x,xe.y,xe.z,xe.w)}catch{Jt(Me)}break;case"DOMRect":case"DOMRectReadOnly":ze=re[Me];try{tt=ze.fromRect?ze.fromRect(xe):new ze(xe.x,xe.y,xe.width,xe.height)}catch{Jt(Me)}break;case"DOMMatrix":case"DOMMatrixReadOnly":ze=re[Me];try{tt=ze.fromMatrix?ze.fromMatrix(xe):new ze(xe)}catch{Jt(Me)}break;case"AudioData":case"VideoFrame":R(xe.clone)||Jt(Me);try{tt=xe.clone()}catch{Yt(Me)}break;case"CropTarget":case"CryptoKey":case"FileSystemDirectoryHandle":case"FileSystemFileHandle":case"FileSystemHandle":case"GPUCompilationInfo":case"GPUCompilationMessage":case"ImageBitmap":case"RTCCertificate":case"WebAssembly.Module":Jt(Me);default:Yt(Me)}}switch(bt(Te,xe,tt),Me){case"Array":case"Object":for(At=xr(xe),Ze=0,st=Ce(At);Ze<st;Ze++)wt=At[Ze],De(tt,wt,Ge(xe[wt],Te));break;case"Map":xe.forEach(function(Mt,Zt){bt(tt,Ge(Zt,Te),Ge(Mt,Te))});break;case"Set":xe.forEach(function(Mt){Ut(tt,Ge(Mt,Te))});break;case"Error":Ae(tt,"message",Ge(xe.message,Te)),Oe(xe,"cause")&&Ae(tt,"cause",Ge(xe.cause,Te)),Qe==="AggregateError"?tt.errors=Ge(xe.errors,Te):Qe==="SuppressedError"&&(tt.error=Ge(xe.error,Te),tt.suppressed=Ge(xe.suppressed,Te));case"DOMException":et&&Ae(tt,"stack",Ge(xe.stack,Te))}return tt},Ie=function(xe,Te){if(!oe(xe))throw new Rt("Transfer option cannot be converted to a sequence");var Me=[];_e(xe,function(Zt){ur(Me,me(Zt))});for(var ze=0,Qe=Ce(Me),tt=new Dt,He,Ze,st,At,wt,Mt;ze<Qe;){if(He=Me[ze++],Ze=we(He),Ze==="ArrayBuffer"?er(tt,He):ut(Te,He))throw new ht("Duplicate transferable",br);if(Ze==="ArrayBuffer"){Ut(tt,He);continue}if(it)At=Sr(He,{transfer:[He]});else switch(Ze){case"ImageBitmap":st=re.OffscreenCanvas,U(st)||Jt(Ze,gr);try{wt=new st(He.width,He.height),Mt=wt.getContext("bitmaprenderer"),Mt.transferFromImageBitmap(He),At=wt.transferToImageBitmap()}catch{}break;case"AudioData":case"VideoFrame":(!R(He.clone)||!R(He.close))&&Jt(Ze,gr);try{At=He.clone(),He.close()}catch{}break;case"MediaSourceHandle":case"MessagePort":case"MIDIAccess":case"OffscreenCanvas":case"ReadableStream":case"RTCDataChannel":case"TransformStream":case"WebTransportReceiveStream":case"WebTransportSendStream":case"WritableStream":Jt(Ze,gr)}if(At===void 0)throw new ht("This object cannot be transferred: "+Ze,br);bt(Te,He,At)}return tt},Se=function(xe){Je(xe,function(Te){it?Lr(Te,{transfer:[Te]}):R(Te.transfer)?Te.transfer():Ke?Ke(Te):Jt("ArrayBuffer",gr)})};return Y({global:!0,enumerable:!0,sham:!it,forced:Nr},{structuredClone:function(Te){var Me=je(arguments.length,1)>1&&!K(arguments[1])?me(arguments[1]):void 0,ze=Me?Me.transfer:void 0,Qe,tt;ze!==void 0&&(Qe=new St,tt=Ie(ze,Qe));var He=Ge(Te,Qe);return tt&&Se(tt),He}}),web_structuredClone}var web_timers={},web_setInterval={},hasRequiredWeb_setInterval;function requireWeb_setInterval(){if(hasRequiredWeb_setInterval)return web_setInterval;hasRequiredWeb_setInterval=1;var J=require_export(),Y=requireGlobalThis(),re=requireSchedulersFix(),ae=re(Y.setInterval,!0);return J({global:!0,bind:!0,forced:Y.setInterval!==ae},{setInterval:ae}),web_setInterval}var web_setTimeout={},hasRequiredWeb_setTimeout;function requireWeb_setTimeout(){if(hasRequiredWeb_setTimeout)return web_setTimeout;hasRequiredWeb_setTimeout=1;var J=require_export(),Y=requireGlobalThis(),re=requireSchedulersFix(),ae=re(Y.setTimeout,!0);return J({global:!0,bind:!0,forced:Y.setTimeout!==ae},{setTimeout:ae}),web_setTimeout}var hasRequiredWeb_timers;function requireWeb_timers(){return hasRequiredWeb_timers||(hasRequiredWeb_timers=1,requireWeb_setInterval(),requireWeb_setTimeout()),web_timers}var web_url={},web_url_constructor={},urlConstructorDetection,hasRequiredUrlConstructorDetection;function requireUrlConstructorDetection(){if(hasRequiredUrlConstructorDetection)return urlConstructorDetection;hasRequiredUrlConstructorDetection=1;var J=requireFails(),Y=requireWellKnownSymbol(),re=requireDescriptors(),ae=requireIsPure(),ne=Y("iterator");return urlConstructorDetection=!J(function(){var ce=new URL("b?a=1&b=2&c=3","https://a"),ee=ce.searchParams,R=new URLSearchParams("a=1&a=2&b=3"),U="";return ce.pathname="c%20d",ee.forEach(function(K,oe){ee.delete("b"),U+=oe+K}),R.delete("a",2),R.delete("b",void 0),ae&&(!ce.toJSON||!R.has("a",1)||R.has("a",2)||!R.has("a",void 0)||R.has("b"))||!ee.size&&(ae||!re)||!ee.sort||ce.href!=="https://a/c%20d?a=1&c=3"||ee.get("c")!=="3"||String(new URLSearchParams("?a=1"))!=="a=1"||!ee[ne]||new URL("https://a@b").username!=="a"||new URLSearchParams(new URLSearchParams("a=b")).get("a")!=="b"||new URL("https://ÑÐµÑÑ").host!=="xn--e1aybc"||new URL("https://a#Ð±").hash!=="#%D0%B1"||U!=="a1c3"||new URL("https://x",void 0).host!=="x"}),urlConstructorDetection}var stringPunycodeToAscii,hasRequiredStringPunycodeToAscii;function requireStringPunycodeToAscii(){if(hasRequiredStringPunycodeToAscii)return stringPunycodeToAscii;hasRequiredStringPunycodeToAscii=1;var J=requireFunctionUncurryThis(),Y=2147483647,re=36,ae=1,ne=26,ce=38,ee=700,R=72,U=128,K="-",oe=/[^\0-\u007E]/,pe=/[.\u3002\uFF0E\uFF61]/g,_e="Overflow: input needs wider integers to process",me=re-ae,we=RangeError,Oe=J(pe.exec),De=Math.floor,Ae=String.fromCharCode,Ce=J("".charCodeAt),je=J([].join),ke=J([].push),Be=J("".replace),We=J("".split),Je=J("".toLowerCase),Ke=function(ct){for(var ft=[],_t=0,Rt=ct.length;_t<Rt;){var Ft=Ce(ct,_t++);if(Ft>=55296&&Ft<=56319&&_t<Rt){var ht=Ce(ct,_t++);(ht&64512)===56320?ke(ft,((Ft&1023)<<10)+(ht&1023)+65536):(ke(ft,Ft),_t--)}else ke(ft,Ft)}return ft},et=function(ct){return ct+22+75*(ct<26)},it=function(ct,ft,_t){var Rt=0;for(ct=_t?De(ct/ee):ct>>1,ct+=De(ct/ft);ct>me*ne>>1;)ct=De(ct/me),Rt+=re;return De(Rt+(me+1)*ct/(ct+ce))},nt=function(ct){var ft=[];ct=Ke(ct);var _t=ct.length,Rt=U,Ft=0,ht=R,St,ut;for(St=0;St<ct.length;St++)ut=ct[St],ut<128&&ke(ft,Ae(ut));var Et=ft.length,bt=Et;for(Et&&ke(ft,K);bt<_t;){var Dt=Y;for(St=0;St<ct.length;St++)ut=ct[St],ut>=Rt&&ut<Dt&&(Dt=ut);var Ut=bt+1;if(Dt-Rt>De((Y-Ft)/Ut))throw new we(_e);for(Ft+=(Dt-Rt)*Ut,Rt=Dt,St=0;St<ct.length;St++){if(ut=ct[St],ut<Rt&&++Ft>Y)throw new we(_e);if(ut===Rt){for(var er=Ft,xr=re;;){var ur=xr<=ht?ae:xr>=ht+ne?ne:xr-ht;if(er<ur)break;var yr=er-ur,Wt=re-ur;ke(ft,Ae(et(ur+yr%Wt))),er=De(yr/Wt),xr+=re}ke(ft,Ae(et(er))),ht=it(Ft,Ut,bt===Et),Ft=0,bt++}}Ft++,Rt++}return je(ft,"")};return stringPunycodeToAscii=function(ct){var ft=[],_t=We(Be(Je(ct),pe,"."),"."),Rt,Ft;for(Rt=0;Rt<_t.length;Rt++)Ft=_t[Rt],ke(ft,Oe(oe,Ft)?"xn--"+nt(Ft):Ft);return je(ft,".")},stringPunycodeToAscii}var web_urlSearchParams_constructor,hasRequiredWeb_urlSearchParams_constructor;function requireWeb_urlSearchParams_constructor(){if(hasRequiredWeb_urlSearchParams_constructor)return web_urlSearchParams_constructor;hasRequiredWeb_urlSearchParams_constructor=1,requireEs_array_iterator(),requireEs_string_fromCodePoint();var J=require_export(),Y=requireGlobalThis(),re=requireSafeGetBuiltIn(),ae=requireGetBuiltIn(),ne=requireFunctionCall(),ce=requireFunctionUncurryThis(),ee=requireDescriptors(),R=requireUrlConstructorDetection(),U=requireDefineBuiltIn(),K=requireDefineBuiltInAccessor(),oe=requireDefineBuiltIns(),pe=requireSetToStringTag(),_e=requireIteratorCreateConstructor(),me=requireInternalState(),we=requireAnInstance(),Oe=requireIsCallable(),De=requireHasOwnProperty(),Ae=requireFunctionBindContext(),Ce=requireClassof(),je=requireAnObject(),ke=requireIsObject$1(),Be=requireToString$1(),We=requireObjectCreate(),Je=requireCreatePropertyDescriptor(),Ke=requireGetIterator(),et=requireGetIteratorMethod(),it=requireCreateIterResultObject(),nt=requireValidateArgumentsLength(),ct=requireWellKnownSymbol(),ft=requireArraySort(),_t=ct("iterator"),Rt="URLSearchParams",Ft=Rt+"Iterator",ht=me.set,St=me.getterFor(Rt),ut=me.getterFor(Ft),Et=re("fetch"),bt=re("Request"),Dt=re("Headers"),Ut=bt&&bt.prototype,er=Dt&&Dt.prototype,xr=Y.TypeError,ur=Y.encodeURIComponent,yr=String.fromCharCode,Wt=ae("String","fromCodePoint"),or=parseInt,wr=ce("".charAt),Ir=ce([].join),br=ce([].push),gr=ce("".replace),Mr=ce([].shift),Hr=ce([].splice),jr=ce("".split),Sr=ce("".slice),Nr=ce(/./.exec),Dr=/\+/g,Lr="ï¿½",Yt=/^[0-9a-f]+$/i,Jt=function(st,At){var wt=Sr(st,At,At+2);return Nr(Yt,wt)?or(wt,16):NaN},qr=function(st){for(var At=0,wt=128;wt>0&&(st&wt)!==0;wt>>=1)At++;return At},nr=function(st){var At=null;switch(st.length){case 1:At=st[0];break;case 2:At=(st[0]&31)<<6|st[1]&63;break;case 3:At=(st[0]&15)<<12|(st[1]&63)<<6|st[2]&63;break;case 4:At=(st[0]&7)<<18|(st[1]&63)<<12|(st[2]&63)<<6|st[3]&63;break}return At>1114111?null:At},dr=function(st){st=gr(st,Dr," ");for(var At=st.length,wt="",Mt=0;Mt<At;){var Zt=wr(st,Mt);if(Zt==="%"){if(wr(st,Mt+1)==="%"||Mt+3>At){wt+="%",Mt++;continue}var Tt=Jt(st,Mt+1);if(Tt!==Tt){wt+=Zt,Mt++;continue}Mt+=2;var Er=qr(Tt);if(Er===0)Zt=yr(Tt);else{if(Er===1||Er>4){wt+=Lr,Mt++;continue}for(var Or=[Tt],cr=1;cr<Er&&(Mt++,!(Mt+3>At||wr(st,Mt)!=="%"));){var Fr=Jt(st,Mt+1);if(Fr!==Fr){Mt+=3;break}if(Fr>191||Fr<128)break;br(Or,Fr),Mt+=2,cr++}if(Or.length!==Er){wt+=Lr;continue}var Yr=nr(Or);Yr===null?wt+=Lr:Zt=Wt(Yr)}}wt+=Zt,Mt++}return wt},mr=/[!'()~]|%20/g,Ge={"!":"%21","'":"%27","(":"%28",")":"%29","~":"%7E","%20":"+"},Ie=function(st){return Ge[st]},Se=function(st){return gr(ur(st),mr,Ie)},xe=_e(function(At,wt){ht(this,{type:Ft,target:St(At).entries,index:0,kind:wt})},Rt,function(){var At=ut(this),wt=At.target,Mt=At.index++;if(!wt||Mt>=wt.length)return At.target=null,it(void 0,!0);var Zt=wt[Mt];switch(At.kind){case"keys":return it(Zt.key,!1);case"values":return it(Zt.value,!1)}return it([Zt.key,Zt.value],!1)},!0),Te=function(st){this.entries=[],this.url=null,st!==void 0&&(ke(st)?this.parseObject(st):this.parseQuery(typeof st=="string"?wr(st,0)==="?"?Sr(st,1):st:Be(st)))};Te.prototype={type:Rt,bindURL:function(st){this.url=st,this.update()},parseObject:function(st){var At=this.entries,wt=et(st),Mt,Zt,Tt,Er,Or,cr,Fr;if(wt)for(Mt=Ke(st,wt),Zt=Mt.next;!(Tt=ne(Zt,Mt)).done;){if(Er=Ke(je(Tt.value)),Or=Er.next,(cr=ne(Or,Er)).done||(Fr=ne(Or,Er)).done||!ne(Or,Er).done)throw new xr("Expected sequence with length 2");br(At,{key:Be(cr.value),value:Be(Fr.value)})}else for(var Yr in st)De(st,Yr)&&br(At,{key:Yr,value:Be(st[Yr])})},parseQuery:function(st){if(st)for(var At=this.entries,wt=jr(st,"&"),Mt=0,Zt,Tt;Mt<wt.length;)Zt=wt[Mt++],Zt.length&&(Tt=jr(Zt,"="),br(At,{key:dr(Mr(Tt)),value:dr(Ir(Tt,"="))}))},serialize:function(){for(var st=this.entries,At=[],wt=0,Mt;wt<st.length;)Mt=st[wt++],br(At,Se(Mt.key)+"="+Se(Mt.value));return Ir(At,"&")},update:function(){this.entries.length=0,this.parseQuery(this.url.query)},updateURL:function(){this.url&&this.url.update()}};var Me=function(){we(this,ze);var At=arguments.length>0?arguments[0]:void 0,wt=ht(this,new Te(At));ee||(this.size=wt.entries.length)},ze=Me.prototype;if(oe(ze,{append:function(At,wt){var Mt=St(this);nt(arguments.length,2),br(Mt.entries,{key:Be(At),value:Be(wt)}),ee||this.length++,Mt.updateURL()},delete:function(st){for(var At=St(this),wt=nt(arguments.length,1),Mt=At.entries,Zt=Be(st),Tt=wt<2?void 0:arguments[1],Er=Tt===void 0?Tt:Be(Tt),Or=0;Or<Mt.length;){var cr=Mt[Or];if(cr.key===Zt&&(Er===void 0||cr.value===Er)){if(Hr(Mt,Or,1),Er!==void 0)break}else Or++}ee||(this.size=Mt.length),At.updateURL()},get:function(At){var wt=St(this).entries;nt(arguments.length,1);for(var Mt=Be(At),Zt=0;Zt<wt.length;Zt++)if(wt[Zt].key===Mt)return wt[Zt].value;return null},getAll:function(At){var wt=St(this).entries;nt(arguments.length,1);for(var Mt=Be(At),Zt=[],Tt=0;Tt<wt.length;Tt++)wt[Tt].key===Mt&&br(Zt,wt[Tt].value);return Zt},has:function(At){for(var wt=St(this).entries,Mt=nt(arguments.length,1),Zt=Be(At),Tt=Mt<2?void 0:arguments[1],Er=Tt===void 0?Tt:Be(Tt),Or=0;Or<wt.length;){var cr=wt[Or++];if(cr.key===Zt&&(Er===void 0||cr.value===Er))return!0}return!1},set:function(At,wt){var Mt=St(this);nt(arguments.length,1);for(var Zt=Mt.entries,Tt=!1,Er=Be(At),Or=Be(wt),cr=0,Fr;cr<Zt.length;cr++)Fr=Zt[cr],Fr.key===Er&&(Tt?Hr(Zt,cr--,1):(Tt=!0,Fr.value=Or));Tt||br(Zt,{key:Er,value:Or}),ee||(this.size=Zt.length),Mt.updateURL()},sort:function(){var At=St(this);ft(At.entries,function(wt,Mt){return wt.key>Mt.key?1:-1}),At.updateURL()},forEach:function(At){for(var wt=St(this).entries,Mt=Ae(At,arguments.length>1?arguments[1]:void 0),Zt=0,Tt;Zt<wt.length;)Tt=wt[Zt++],Mt(Tt.value,Tt.key,this)},keys:function(){return new xe(this,"keys")},values:function(){return new xe(this,"values")},entries:function(){return new xe(this,"entries")}},{enumerable:!0}),U(ze,_t,ze.entries,{name:"entries"}),U(ze,"toString",function(){return St(this).serialize()},{enumerable:!0}),ee&&K(ze,"size",{get:function(){return St(this).entries.length},configurable:!0,enumerable:!0}),pe(Me,Rt),J({global:!0,constructor:!0,forced:!R},{URLSearchParams:Me}),!R&&Oe(Dt)){var Qe=ce(er.has),tt=ce(er.set),He=function(st){if(ke(st)){var At=st.body,wt;if(Ce(At)===Rt)return wt=st.headers?new Dt(st.headers):new Dt,Qe(wt,"content-type")||tt(wt,"content-type","application/x-www-form-urlencoded;charset=UTF-8"),We(st,{body:Je(0,Be(At)),headers:Je(0,wt)})}return st};if(Oe(Et)&&J({global:!0,enumerable:!0,dontCallGetSet:!0,forced:!0},{fetch:function(At){return Et(At,arguments.length>1?He(arguments[1]):{})}}),Oe(bt)){var Ze=function(At){return we(this,Ut),new bt(At,arguments.length>1?He(arguments[1]):{})};Ut.constructor=Ze,Ze.prototype=Ut,J({global:!0,constructor:!0,dontCallGetSet:!0,forced:!0},{Request:Ze})}}return web_urlSearchParams_constructor={URLSearchParams:Me,getState:St},web_urlSearchParams_constructor}var hasRequiredWeb_url_constructor;function requireWeb_url_constructor(){if(hasRequiredWeb_url_constructor)return web_url_constructor;hasRequiredWeb_url_constructor=1,requireEs_string_iterator();var J=require_export(),Y=requireDescriptors(),re=requireUrlConstructorDetection(),ae=requireGlobalThis(),ne=requireFunctionBindContext(),ce=requireFunctionUncurryThis(),ee=requireDefineBuiltIn(),R=requireDefineBuiltInAccessor(),U=requireAnInstance(),K=requireHasOwnProperty(),oe=requireObjectAssign(),pe=requireArrayFrom(),_e=requireArraySlice(),me=requireStringMultibyte().codeAt,we=requireStringPunycodeToAscii(),Oe=requireToString$1(),De=requireSetToStringTag(),Ae=requireValidateArgumentsLength(),Ce=requireWeb_urlSearchParams_constructor(),je=requireInternalState(),ke=je.set,Be=je.getterFor("URL"),We=Ce.URLSearchParams,Je=Ce.getState,Ke=ae.URL,et=ae.TypeError,it=ae.parseInt,nt=Math.floor,ct=Math.pow,ft=ce("".charAt),_t=ce(/./.exec),Rt=ce([].join),Ft=ce(1.1.toString),ht=ce([].pop),St=ce([].push),ut=ce("".replace),Et=ce([].shift),bt=ce("".split),Dt=ce("".slice),Ut=ce("".toLowerCase),er=ce([].unshift),xr="Invalid authority",ur="Invalid scheme",yr="Invalid host",Wt="Invalid port",or=/[a-z]/i,wr=/[\d+-.a-z]/i,Ir=/\d/,br=/^0x/i,gr=/^[0-7]+$/,Mr=/^\d+$/,Hr=/^[\da-f]+$/i,jr=/[\0\t\n\r #%/:<>?@[\\\]^|]/,Sr=/[\0\t\n\r #/:<>?@[\\\]^|]/,Nr=/^[\u0000-\u0020]+/,Dr=/(^|[^\u0000-\u0020])[\u0000-\u0020]+$/,Lr=/[\t\n\r]/g,Yt,Jt=function(jt){var tr=bt(jt,"."),Vt,Pt,Qt,Ur,Rr,yi,fi;if(tr.length&&tr[tr.length-1]===""&&tr.length--,Vt=tr.length,Vt>4)return jt;for(Pt=[],Qt=0;Qt<Vt;Qt++){if(Ur=tr[Qt],Ur==="")return jt;if(Rr=10,Ur.length>1&&ft(Ur,0)==="0"&&(Rr=_t(br,Ur)?16:8,Ur=Dt(Ur,Rr===8?1:2)),Ur==="")yi=0;else{if(!_t(Rr===10?Mr:Rr===8?gr:Hr,Ur))return jt;yi=it(Ur,Rr)}St(Pt,yi)}for(Qt=0;Qt<Vt;Qt++)if(yi=Pt[Qt],Qt===Vt-1){if(yi>=ct(256,5-Vt))return null}else if(yi>255)return null;for(fi=ht(Pt),Qt=0;Qt<Pt.length;Qt++)fi+=Pt[Qt]*ct(256,3-Qt);return fi},qr=function(jt){var tr=[0,0,0,0,0,0,0,0],Vt=0,Pt=null,Qt=0,Ur,Rr,yi,fi,Si,ui,rr,Kr=function(){return ft(jt,Qt)};if(Kr()===":"){if(ft(jt,1)!==":")return;Qt+=2,Vt++,Pt=Vt}for(;Kr();){if(Vt===8)return;if(Kr()===":"){if(Pt!==null)return;Qt++,Vt++,Pt=Vt;continue}for(Ur=Rr=0;Rr<4&&_t(Hr,Kr());)Ur=Ur*16+it(Kr(),16),Qt++,Rr++;if(Kr()==="."){if(Rr===0||(Qt-=Rr,Vt>6))return;for(yi=0;Kr();){if(fi=null,yi>0)if(Kr()==="."&&yi<4)Qt++;else return;if(!_t(Ir,Kr()))return;for(;_t(Ir,Kr());){if(Si=it(Kr(),10),fi===null)fi=Si;else{if(fi===0)return;fi=fi*10+Si}if(fi>255)return;Qt++}tr[Vt]=tr[Vt]*256+fi,yi++,(yi===2||yi===4)&&Vt++}if(yi!==4)return;break}else if(Kr()===":"){if(Qt++,!Kr())return}else if(Kr())return;tr[Vt++]=Ur}if(Pt!==null)for(ui=Vt-Pt,Vt=7;Vt!==0&&ui>0;)rr=tr[Vt],tr[Vt--]=tr[Pt+ui-1],tr[Pt+--ui]=rr;else if(Vt!==8)return;return tr},nr=function(jt){for(var tr=null,Vt=1,Pt=null,Qt=0,Ur=0;Ur<8;Ur++)jt[Ur]!==0?(Qt>Vt&&(tr=Pt,Vt=Qt),Pt=null,Qt=0):(Pt===null&&(Pt=Ur),++Qt);return Qt>Vt?Pt:tr},dr=function(jt){var tr,Vt,Pt,Qt;if(typeof jt=="number"){for(tr=[],Vt=0;Vt<4;Vt++)er(tr,jt%256),jt=nt(jt/256);return Rt(tr,".")}if(typeof jt=="object"){for(tr="",Pt=nr(jt),Vt=0;Vt<8;Vt++)Qt&&jt[Vt]===0||(Qt&&(Qt=!1),Pt===Vt?(tr+=Vt?":":"::",Qt=!0):(tr+=Ft(jt[Vt],16),Vt<7&&(tr+=":")));return"["+tr+"]"}return jt},mr={},Ge=oe({},mr,{" ":1,'"':1,"<":1,">":1,"`":1}),Ie=oe({},Ge,{"#":1,"?":1,"{":1,"}":1}),Se=oe({},Ie,{"/":1,":":1,";":1,"=":1,"@":1,"[":1,"\\":1,"]":1,"^":1,"|":1}),xe=function(jt,tr){var Vt=me(jt,0);return Vt>32&&Vt<127&&!K(tr,jt)?jt:encodeURIComponent(jt)},Te={ftp:21,file:null,http:80,https:443,ws:80,wss:443},Me=function(jt,tr){var Vt;return jt.length===2&&_t(or,ft(jt,0))&&((Vt=ft(jt,1))===":"||!tr&&Vt==="|")},ze=function(jt){var tr;return jt.length>1&&Me(Dt(jt,0,2))&&(jt.length===2||(tr=ft(jt,2))==="/"||tr==="\\"||tr==="?"||tr==="#")},Qe=function(jt){return jt==="."||Ut(jt)==="%2e"},tt=function(jt){return jt=Ut(jt),jt===".."||jt==="%2e."||jt===".%2e"||jt==="%2e%2e"},He={},Ze={},st={},At={},wt={},Mt={},Zt={},Tt={},Er={},Or={},cr={},Fr={},Yr={},vi={},bi={},qi={},Jr={},li={},ri={},Ht={},Ti={},Ni=function(jt,tr,Vt){var Pt=Oe(jt),Qt,Ur,Rr;if(tr){if(Ur=this.parse(Pt),Ur)throw new et(Ur);this.searchParams=null}else{if(Vt!==void 0&&(Qt=new Ni(Vt,!0)),Ur=this.parse(Pt,null,Qt),Ur)throw new et(Ur);Rr=Je(new We),Rr.bindURL(this),this.searchParams=Rr}};Ni.prototype={type:"URL",parse:function(jt,tr,Vt){var Pt=this,Qt=tr||He,Ur=0,Rr="",yi=!1,fi=!1,Si=!1,ui,rr,Kr,cn;for(jt=Oe(jt),tr||(Pt.scheme="",Pt.username="",Pt.password="",Pt.host=null,Pt.port=null,Pt.path=[],Pt.query=null,Pt.fragment=null,Pt.cannotBeABaseURL=!1,jt=ut(jt,Nr,""),jt=ut(jt,Dr,"$1")),jt=ut(jt,Lr,""),ui=pe(jt);Ur<=ui.length;){switch(rr=ui[Ur],Qt){case He:if(rr&&_t(or,rr))Rr+=Ut(rr),Qt=Ze;else{if(tr)return ur;Qt=st;continue}break;case Ze:if(rr&&(_t(wr,rr)||rr==="+"||rr==="-"||rr==="."))Rr+=Ut(rr);else if(rr===":"){if(tr&&(Pt.isSpecial()!==K(Te,Rr)||Rr==="file"&&(Pt.includesCredentials()||Pt.port!==null)||Pt.scheme==="file"&&!Pt.host))return;if(Pt.scheme=Rr,tr){Pt.isSpecial()&&Te[Pt.scheme]===Pt.port&&(Pt.port=null);return}Rr="",Pt.scheme==="file"?Qt=vi:Pt.isSpecial()&&Vt&&Vt.scheme===Pt.scheme?Qt=At:Pt.isSpecial()?Qt=Tt:ui[Ur+1]==="/"?(Qt=wt,Ur++):(Pt.cannotBeABaseURL=!0,St(Pt.path,""),Qt=ri)}else{if(tr)return ur;Rr="",Qt=st,Ur=0;continue}break;case st:if(!Vt||Vt.cannotBeABaseURL&&rr!=="#")return ur;if(Vt.cannotBeABaseURL&&rr==="#"){Pt.scheme=Vt.scheme,Pt.path=_e(Vt.path),Pt.query=Vt.query,Pt.fragment="",Pt.cannotBeABaseURL=!0,Qt=Ti;break}Qt=Vt.scheme==="file"?vi:Mt;continue;case At:if(rr==="/"&&ui[Ur+1]==="/")Qt=Er,Ur++;else{Qt=Mt;continue}break;case wt:if(rr==="/"){Qt=Or;break}else{Qt=li;continue}case Mt:if(Pt.scheme=Vt.scheme,rr===Yt)Pt.username=Vt.username,Pt.password=Vt.password,Pt.host=Vt.host,Pt.port=Vt.port,Pt.path=_e(Vt.path),Pt.query=Vt.query;else if(rr==="/"||rr==="\\"&&Pt.isSpecial())Qt=Zt;else if(rr==="?")Pt.username=Vt.username,Pt.password=Vt.password,Pt.host=Vt.host,Pt.port=Vt.port,Pt.path=_e(Vt.path),Pt.query="",Qt=Ht;else if(rr==="#")Pt.username=Vt.username,Pt.password=Vt.password,Pt.host=Vt.host,Pt.port=Vt.port,Pt.path=_e(Vt.path),Pt.query=Vt.query,Pt.fragment="",Qt=Ti;else{Pt.username=Vt.username,Pt.password=Vt.password,Pt.host=Vt.host,Pt.port=Vt.port,Pt.path=_e(Vt.path),Pt.path.length--,Qt=li;continue}break;case Zt:if(Pt.isSpecial()&&(rr==="/"||rr==="\\"))Qt=Er;else if(rr==="/")Qt=Or;else{Pt.username=Vt.username,Pt.password=Vt.password,Pt.host=Vt.host,Pt.port=Vt.port,Qt=li;continue}break;case Tt:if(Qt=Er,rr!=="/"||ft(Rr,Ur+1)!=="/")continue;Ur++;break;case Er:if(rr!=="/"&&rr!=="\\"){Qt=Or;continue}break;case Or:if(rr==="@"){yi&&(Rr="%40"+Rr),yi=!0,Kr=pe(Rr);for(var Gn=0;Gn<Kr.length;Gn++){var Ba=Kr[Gn];if(Ba===":"&&!Si){Si=!0;continue}var $n=xe(Ba,Se);Si?Pt.password+=$n:Pt.username+=$n}Rr=""}else if(rr===Yt||rr==="/"||rr==="?"||rr==="#"||rr==="\\"&&Pt.isSpecial()){if(yi&&Rr==="")return xr;Ur-=pe(Rr).length+1,Rr="",Qt=cr}else Rr+=rr;break;case cr:case Fr:if(tr&&Pt.scheme==="file"){Qt=qi;continue}else if(rr===":"&&!fi){if(Rr==="")return yr;if(cn=Pt.parseHost(Rr),cn)return cn;if(Rr="",Qt=Yr,tr===Fr)return}else if(rr===Yt||rr==="/"||rr==="?"||rr==="#"||rr==="\\"&&Pt.isSpecial()){if(Pt.isSpecial()&&Rr==="")return yr;if(tr&&Rr===""&&(Pt.includesCredentials()||Pt.port!==null))return;if(cn=Pt.parseHost(Rr),cn)return cn;if(Rr="",Qt=Jr,tr)return;continue}else rr==="["?fi=!0:rr==="]"&&(fi=!1),Rr+=rr;break;case Yr:if(_t(Ir,rr))Rr+=rr;else if(rr===Yt||rr==="/"||rr==="?"||rr==="#"||rr==="\\"&&Pt.isSpecial()||tr){if(Rr!==""){var xn=it(Rr,10);if(xn>65535)return Wt;Pt.port=Pt.isSpecial()&&xn===Te[Pt.scheme]?null:xn,Rr=""}if(tr)return;Qt=Jr;continue}else return Wt;break;case vi:if(Pt.scheme="file",rr==="/"||rr==="\\")Qt=bi;else if(Vt&&Vt.scheme==="file")switch(rr){case Yt:Pt.host=Vt.host,Pt.path=_e(Vt.path),Pt.query=Vt.query;break;case"?":Pt.host=Vt.host,Pt.path=_e(Vt.path),Pt.query="",Qt=Ht;break;case"#":Pt.host=Vt.host,Pt.path=_e(Vt.path),Pt.query=Vt.query,Pt.fragment="",Qt=Ti;break;default:ze(Rt(_e(ui,Ur),""))||(Pt.host=Vt.host,Pt.path=_e(Vt.path),Pt.shortenPath()),Qt=li;continue}else{Qt=li;continue}break;case bi:if(rr==="/"||rr==="\\"){Qt=qi;break}Vt&&Vt.scheme==="file"&&!ze(Rt(_e(ui,Ur),""))&&(Me(Vt.path[0],!0)?St(Pt.path,Vt.path[0]):Pt.host=Vt.host),Qt=li;continue;case qi:if(rr===Yt||rr==="/"||rr==="\\"||rr==="?"||rr==="#"){if(!tr&&Me(Rr))Qt=li;else if(Rr===""){if(Pt.host="",tr)return;Qt=Jr}else{if(cn=Pt.parseHost(Rr),cn)return cn;if(Pt.host==="localhost"&&(Pt.host=""),tr)return;Rr="",Qt=Jr}continue}else Rr+=rr;break;case Jr:if(Pt.isSpecial()){if(Qt=li,rr!=="/"&&rr!=="\\")continue}else if(!tr&&rr==="?")Pt.query="",Qt=Ht;else if(!tr&&rr==="#")Pt.fragment="",Qt=Ti;else if(rr!==Yt&&(Qt=li,rr!=="/"))continue;break;case li:if(rr===Yt||rr==="/"||rr==="\\"&&Pt.isSpecial()||!tr&&(rr==="?"||rr==="#")){if(tt(Rr)?(Pt.shortenPath(),rr!=="/"&&!(rr==="\\"&&Pt.isSpecial())&&St(Pt.path,"")):Qe(Rr)?rr!=="/"&&!(rr==="\\"&&Pt.isSpecial())&&St(Pt.path,""):(Pt.scheme==="file"&&!Pt.path.length&&Me(Rr)&&(Pt.host&&(Pt.host=""),Rr=ft(Rr,0)+":"),St(Pt.path,Rr)),Rr="",Pt.scheme==="file"&&(rr===Yt||rr==="?"||rr==="#"))for(;Pt.path.length>1&&Pt.path[0]==="";)Et(Pt.path);rr==="?"?(Pt.query="",Qt=Ht):rr==="#"&&(Pt.fragment="",Qt=Ti)}else Rr+=xe(rr,Ie);break;case ri:rr==="?"?(Pt.query="",Qt=Ht):rr==="#"?(Pt.fragment="",Qt=Ti):rr!==Yt&&(Pt.path[0]+=xe(rr,mr));break;case Ht:!tr&&rr==="#"?(Pt.fragment="",Qt=Ti):rr!==Yt&&(rr==="'"&&Pt.isSpecial()?Pt.query+="%27":rr==="#"?Pt.query+="%23":Pt.query+=xe(rr,mr));break;case Ti:rr!==Yt&&(Pt.fragment+=xe(rr,Ge));break}Ur++}},parseHost:function(jt){var tr,Vt,Pt;if(ft(jt,0)==="["){if(ft(jt,jt.length-1)!=="]"||(tr=qr(Dt(jt,1,-1)),!tr))return yr;this.host=tr}else if(this.isSpecial()){if(jt=we(jt),_t(jr,jt)||(tr=Jt(jt),tr===null))return yr;this.host=tr}else{if(_t(Sr,jt))return yr;for(tr="",Vt=pe(jt),Pt=0;Pt<Vt.length;Pt++)tr+=xe(Vt[Pt],mr);this.host=tr}},cannotHaveUsernamePasswordPort:function(){return!this.host||this.cannotBeABaseURL||this.scheme==="file"},includesCredentials:function(){return this.username!==""||this.password!==""},isSpecial:function(){return K(Te,this.scheme)},shortenPath:function(){var jt=this.path,tr=jt.length;tr&&(this.scheme!=="file"||tr!==1||!Me(jt[0],!0))&&jt.length--},serialize:function(){var jt=this,tr=jt.scheme,Vt=jt.username,Pt=jt.password,Qt=jt.host,Ur=jt.port,Rr=jt.path,yi=jt.query,fi=jt.fragment,Si=tr+":";return Qt!==null?(Si+="//",jt.includesCredentials()&&(Si+=Vt+(Pt?":"+Pt:"")+"@"),Si+=dr(Qt),Ur!==null&&(Si+=":"+Ur)):tr==="file"&&(Si+="//"),Si+=jt.cannotBeABaseURL?Rr[0]:Rr.length?"/"+Rt(Rr,"/"):"",yi!==null&&(Si+="?"+yi),fi!==null&&(Si+="#"+fi),Si},setHref:function(jt){var tr=this.parse(jt);if(tr)throw new et(tr);this.searchParams.update()},getOrigin:function(){var jt=this.scheme,tr=this.port;if(jt==="blob")try{return new Pi(jt.path[0]).origin}catch{return"null"}return jt==="file"||!this.isSpecial()?"null":jt+"://"+dr(this.host)+(tr!==null?":"+tr:"")},getProtocol:function(){return this.scheme+":"},setProtocol:function(jt){this.parse(Oe(jt)+":",He)},getUsername:function(){return this.username},setUsername:function(jt){var tr=pe(Oe(jt));if(!this.cannotHaveUsernamePasswordPort()){this.username="";for(var Vt=0;Vt<tr.length;Vt++)this.username+=xe(tr[Vt],Se)}},getPassword:function(){return this.password},setPassword:function(jt){var tr=pe(Oe(jt));if(!this.cannotHaveUsernamePasswordPort()){this.password="";for(var Vt=0;Vt<tr.length;Vt++)this.password+=xe(tr[Vt],Se)}},getHost:function(){var jt=this.host,tr=this.port;return jt===null?"":tr===null?dr(jt):dr(jt)+":"+tr},setHost:function(jt){this.cannotBeABaseURL||this.parse(jt,cr)},getHostname:function(){var jt=this.host;return jt===null?"":dr(jt)},setHostname:function(jt){this.cannotBeABaseURL||this.parse(jt,Fr)},getPort:function(){var jt=this.port;return jt===null?"":Oe(jt)},setPort:function(jt){this.cannotHaveUsernamePasswordPort()||(jt=Oe(jt),jt===""?this.port=null:this.parse(jt,Yr))},getPathname:function(){var jt=this.path;return this.cannotBeABaseURL?jt[0]:jt.length?"/"+Rt(jt,"/"):""},setPathname:function(jt){this.cannotBeABaseURL||(this.path=[],this.parse(jt,Jr))},getSearch:function(){var jt=this.query;return jt?"?"+jt:""},setSearch:function(jt){jt=Oe(jt),jt===""?this.query=null:(ft(jt,0)==="?"&&(jt=Dt(jt,1)),this.query="",this.parse(jt,Ht)),this.searchParams.update()},getSearchParams:function(){return this.searchParams.facade},getHash:function(){var jt=this.fragment;return jt?"#"+jt:""},setHash:function(jt){if(jt=Oe(jt),jt===""){this.fragment=null;return}ft(jt,0)==="#"&&(jt=Dt(jt,1)),this.fragment="",this.parse(jt,Ti)},update:function(){this.query=this.searchParams.serialize()||null}};var Pi=function(tr){var Vt=U(this,ii),Pt=Ae(arguments.length,1)>1?arguments[1]:void 0,Qt=ke(Vt,new Ni(tr,!1,Pt));Y||(Vt.href=Qt.serialize(),Vt.origin=Qt.getOrigin(),Vt.protocol=Qt.getProtocol(),Vt.username=Qt.getUsername(),Vt.password=Qt.getPassword(),Vt.host=Qt.getHost(),Vt.hostname=Qt.getHostname(),Vt.port=Qt.getPort(),Vt.pathname=Qt.getPathname(),Vt.search=Qt.getSearch(),Vt.searchParams=Qt.getSearchParams(),Vt.hash=Qt.getHash())},ii=Pi.prototype,ir=function(jt,tr){return{get:function(){return Be(this)[jt]()},set:tr&&function(Vt){return Be(this)[tr](Vt)},configurable:!0,enumerable:!0}};if(Y&&(R(ii,"href",ir("serialize","setHref")),R(ii,"origin",ir("getOrigin")),R(ii,"protocol",ir("getProtocol","setProtocol")),R(ii,"username",ir("getUsername","setUsername")),R(ii,"password",ir("getPassword","setPassword")),R(ii,"host",ir("getHost","setHost")),R(ii,"hostname",ir("getHostname","setHostname")),R(ii,"port",ir("getPort","setPort")),R(ii,"pathname",ir("getPathname","setPathname")),R(ii,"search",ir("getSearch","setSearch")),R(ii,"searchParams",ir("getSearchParams")),R(ii,"hash",ir("getHash","setHash"))),ee(ii,"toJSON",function(){return Be(this).serialize()},{enumerable:!0}),ee(ii,"toString",function(){return Be(this).serialize()},{enumerable:!0}),Ke){var Zr=Ke.createObjectURL,Gr=Ke.revokeObjectURL;Zr&&ee(Pi,"createObjectURL",ne(Zr,Ke)),Gr&&ee(Pi,"revokeObjectURL",ne(Gr,Ke))}return De(Pi,"URL"),J({global:!0,constructor:!0,forced:!re,sham:!Y},{URL:Pi}),web_url_constructor}var hasRequiredWeb_url;function requireWeb_url(){return hasRequiredWeb_url||(hasRequiredWeb_url=1,requireWeb_url_constructor()),web_url}var web_url_canParse={},hasRequiredWeb_url_canParse;function requireWeb_url_canParse(){if(hasRequiredWeb_url_canParse)return web_url_canParse;hasRequiredWeb_url_canParse=1;var J=require_export(),Y=requireGetBuiltIn(),re=requireFails(),ae=requireValidateArgumentsLength(),ne=requireToString$1(),ce=requireUrlConstructorDetection(),ee=Y("URL"),R=ce&&re(function(){ee.canParse()}),U=re(function(){return ee.canParse.length!==1});return J({target:"URL",stat:!0,forced:!R||U},{canParse:function(oe){var pe=ae(arguments.length,1),_e=ne(oe),me=pe<2||arguments[1]===void 0?void 0:ne(arguments[1]);try{return!!new ee(_e,me)}catch{return!1}}}),web_url_canParse}var web_url_parse={},hasRequiredWeb_url_parse;function requireWeb_url_parse(){if(hasRequiredWeb_url_parse)return web_url_parse;hasRequiredWeb_url_parse=1;var J=require_export(),Y=requireGetBuiltIn(),re=requireValidateArgumentsLength(),ae=requireToString$1(),ne=requireUrlConstructorDetection(),ce=Y("URL");return J({target:"URL",stat:!0,forced:!ne},{parse:function(R){var U=re(arguments.length,1),K=ae(R),oe=U<2||arguments[1]===void 0?void 0:ae(arguments[1]);try{return new ce(K,oe)}catch{return null}}}),web_url_parse}var web_url_toJson={},hasRequiredWeb_url_toJson;function requireWeb_url_toJson(){if(hasRequiredWeb_url_toJson)return web_url_toJson;hasRequiredWeb_url_toJson=1;var J=require_export(),Y=requireFunctionCall();return J({target:"URL",proto:!0,enumerable:!0},{toJSON:function(){return Y(URL.prototype.toString,this)}}),web_url_toJson}var web_urlSearchParams={},hasRequiredWeb_urlSearchParams;function requireWeb_urlSearchParams(){return hasRequiredWeb_urlSearchParams||(hasRequiredWeb_urlSearchParams=1,requireWeb_urlSearchParams_constructor()),web_urlSearchParams}var web_urlSearchParams_delete={},hasRequiredWeb_urlSearchParams_delete;function requireWeb_urlSearchParams_delete(){if(hasRequiredWeb_urlSearchParams_delete)return web_urlSearchParams_delete;hasRequiredWeb_urlSearchParams_delete=1;var J=requireDefineBuiltIn(),Y=requireFunctionUncurryThis(),re=requireToString$1(),ae=requireValidateArgumentsLength(),ne=URLSearchParams,ce=ne.prototype,ee=Y(ce.append),R=Y(ce.delete),U=Y(ce.forEach),K=Y([].push),oe=new ne("a=1&a=2&b=3");return oe.delete("a",1),oe.delete("b",void 0),oe+""!="a=2"&&J(ce,"delete",function(pe){var _e=arguments.length,me=_e<2?void 0:arguments[1];if(_e&&me===void 0)return R(this,pe);var we=[];U(this,function(We,Je){K(we,{key:Je,value:We})}),ae(_e,1);for(var Oe=re(pe),De=re(me),Ae=0,Ce=0,je=!1,ke=we.length,Be;Ae<ke;)Be=we[Ae++],je||Be.key===Oe?(je=!0,R(this,Be.key)):Ce++;for(;Ce<ke;)Be=we[Ce++],Be.key===Oe&&Be.value===De||ee(this,Be.key,Be.value)},{enumerable:!0,unsafe:!0}),web_urlSearchParams_delete}var web_urlSearchParams_has={},hasRequiredWeb_urlSearchParams_has;function requireWeb_urlSearchParams_has(){if(hasRequiredWeb_urlSearchParams_has)return web_urlSearchParams_has;hasRequiredWeb_urlSearchParams_has=1;var J=requireDefineBuiltIn(),Y=requireFunctionUncurryThis(),re=requireToString$1(),ae=requireValidateArgumentsLength(),ne=URLSearchParams,ce=ne.prototype,ee=Y(ce.getAll),R=Y(ce.has),U=new ne("a=1");return(U.has("a",2)||!U.has("a",void 0))&&J(ce,"has",function(oe){var pe=arguments.length,_e=pe<2?void 0:arguments[1];if(pe&&_e===void 0)return R(this,oe);var me=ee(this,oe);ae(pe,1);for(var we=re(_e),Oe=0;Oe<me.length;)if(me[Oe++]===we)return!0;return!1},{enumerable:!0,unsafe:!0}),web_urlSearchParams_has}var web_urlSearchParams_size={},hasRequiredWeb_urlSearchParams_size;function requireWeb_urlSearchParams_size(){if(hasRequiredWeb_urlSearchParams_size)return web_urlSearchParams_size;hasRequiredWeb_urlSearchParams_size=1;var J=requireDescriptors(),Y=requireFunctionUncurryThis(),re=requireDefineBuiltInAccessor(),ae=URLSearchParams.prototype,ne=Y(ae.forEach);return J&&!("size"in ae)&&re(ae,"size",{get:function(){var ee=0;return ne(this,function(){ee++}),ee},configurable:!0,enumerable:!0}),web_urlSearchParams_size}var stable,hasRequiredStable;function requireStable(){return hasRequiredStable||(hasRequiredStable=1,requireEs_symbol(),requireEs_symbol_description(),requireEs_symbol_asyncDispose(),requireEs_symbol_asyncIterator(),requireEs_symbol_dispose(),requireEs_symbol_hasInstance(),requireEs_symbol_isConcatSpreadable(),requireEs_symbol_iterator(),requireEs_symbol_match(),requireEs_symbol_matchAll(),requireEs_symbol_replace(),requireEs_symbol_search(),requireEs_symbol_species(),requireEs_symbol_split(),requireEs_symbol_toPrimitive(),requireEs_symbol_toStringTag(),requireEs_symbol_unscopables(),requireEs_error_cause(),requireEs_error_isError(),requireEs_error_toString(),requireEs_aggregateError(),requireEs_aggregateError_cause(),requireEs_suppressedError_constructor(),requireEs_array_at(),requireEs_array_concat(),requireEs_array_copyWithin(),requireEs_array_every(),requireEs_array_fill(),requireEs_array_filter(),requireEs_array_find(),requireEs_array_findIndex(),requireEs_array_findLast(),requireEs_array_findLastIndex(),requireEs_array_flat(),requireEs_array_flatMap(),requireEs_array_forEach(),requireEs_array_from(),requireEs_array_includes(),requireEs_array_indexOf(),requireEs_array_isArray(),requireEs_array_iterator(),requireEs_array_join(),requireEs_array_lastIndexOf(),requireEs_array_map(),requireEs_array_of(),requireEs_array_push(),requireEs_array_reduce(),requireEs_array_reduceRight(),requireEs_array_reverse(),requireEs_array_slice(),requireEs_array_some(),requireEs_array_sort(),requireEs_array_species(),requireEs_array_splice(),requireEs_array_toReversed(),requireEs_array_toSorted(),requireEs_array_toSpliced(),requireEs_array_unscopables_flat(),requireEs_array_unscopables_flatMap(),requireEs_array_unshift(),requireEs_array_with(),requireEs_arrayBuffer_constructor(),requireEs_arrayBuffer_isView(),requireEs_arrayBuffer_slice(),requireEs_dataView(),requireEs_dataView_getFloat16(),requireEs_dataView_setFloat16(),requireEs_arrayBuffer_detached(),requireEs_arrayBuffer_transfer(),requireEs_arrayBuffer_transferToFixedLength(),requireEs_date_getYear(),requireEs_date_now(),requireEs_date_setYear(),requireEs_date_toGmtString(),requireEs_date_toIsoString(),requireEs_date_toJson(),requireEs_date_toPrimitive(),requireEs_date_toString(),requireEs_disposableStack_constructor(),requireEs_escape(),requireEs_function_bind(),requireEs_function_hasInstance(),requireEs_function_name(),requireEs_globalThis(),requireEs_iterator_constructor(),requireEs_iterator_dispose(),requireEs_iterator_drop(),requireEs_iterator_every(),requireEs_iterator_filter(),requireEs_iterator_find(),requireEs_iterator_flatMap(),requireEs_iterator_forEach(),requireEs_iterator_from(),requireEs_iterator_map(),requireEs_iterator_reduce(),requireEs_iterator_some(),requireEs_iterator_take(),requireEs_iterator_toArray(),requireEs_json_stringify(),requireEs_json_toStringTag(),requireEs_map(),requireEs_map_groupBy(),requireEs_math_acosh(),requireEs_math_asinh(),requireEs_math_atanh(),requireEs_math_cbrt(),requireEs_math_clz32(),requireEs_math_cosh(),requireEs_math_expm1(),requireEs_math_fround(),requireEs_math_f16round(),requireEs_math_hypot(),requireEs_math_imul(),requireEs_math_log10(),requireEs_math_log1p(),requireEs_math_log2(),requireEs_math_sign(),requireEs_math_sinh(),requireEs_math_sumPrecise(),requireEs_math_tanh(),requireEs_math_toStringTag(),requireEs_math_trunc(),requireEs_number_constructor(),requireEs_number_epsilon(),requireEs_number_isFinite(),requireEs_number_isInteger(),requireEs_number_isNan(),requireEs_number_isSafeInteger(),requireEs_number_maxSafeInteger(),requireEs_number_minSafeInteger(),requireEs_number_parseFloat(),requireEs_number_parseInt(),requireEs_number_toExponential(),requireEs_number_toFixed(),requireEs_number_toPrecision(),requireEs_object_assign(),requireEs_object_create(),requireEs_object_defineGetter(),requireEs_object_defineProperties(),requireEs_object_defineProperty(),requireEs_object_defineSetter(),requireEs_object_entries(),requireEs_object_freeze(),requireEs_object_fromEntries(),requireEs_object_getOwnPropertyDescriptor(),requireEs_object_getOwnPropertyDescriptors(),requireEs_object_getOwnPropertyNames(),requireEs_object_getPrototypeOf(),requireEs_object_groupBy(),requireEs_object_hasOwn(),requireEs_object_is(),requireEs_object_isExtensible(),requireEs_object_isFrozen(),requireEs_object_isSealed(),requireEs_object_keys(),requireEs_object_lookupGetter(),requireEs_object_lookupSetter(),requireEs_object_preventExtensions(),requireEs_object_proto(),requireEs_object_seal(),requireEs_object_setPrototypeOf(),requireEs_object_toString(),requireEs_object_values(),requireEs_parseFloat(),requireEs_parseInt(),requireEs_promise(),requireEs_promise_allSettled(),requireEs_promise_any(),requireEs_promise_finally(),requireEs_promise_try(),requireEs_promise_withResolvers(),requireEs_array_fromAsync(),requireEs_asyncDisposableStack_constructor(),requireEs_asyncIterator_asyncDispose(),requireEs_reflect_apply(),requireEs_reflect_construct(),requireEs_reflect_defineProperty(),requireEs_reflect_deleteProperty(),requireEs_reflect_get(),requireEs_reflect_getOwnPropertyDescriptor(),requireEs_reflect_getPrototypeOf(),requireEs_reflect_has(),requireEs_reflect_isExtensible(),requireEs_reflect_ownKeys(),requireEs_reflect_preventExtensions(),requireEs_reflect_set(),requireEs_reflect_setPrototypeOf(),requireEs_reflect_toStringTag(),requireEs_regexp_constructor(),requireEs_regexp_escape(),requireEs_regexp_dotAll(),requireEs_regexp_exec(),requireEs_regexp_flags(),requireEs_regexp_sticky(),requireEs_regexp_test(),requireEs_regexp_toString(),requireEs_set(),requireEs_set_difference_v2(),requireEs_set_intersection_v2(),requireEs_set_isDisjointFrom_v2(),requireEs_set_isSubsetOf_v2(),requireEs_set_isSupersetOf_v2(),requireEs_set_symmetricDifference_v2(),requireEs_set_union_v2(),requireEs_string_atAlternative(),requireEs_string_codePointAt(),requireEs_string_endsWith(),requireEs_string_fromCodePoint(),requireEs_string_includes(),requireEs_string_isWellFormed(),requireEs_string_iterator(),requireEs_string_match(),requireEs_string_matchAll(),requireEs_string_padEnd(),requireEs_string_padStart(),requireEs_string_raw(),requireEs_string_repeat(),requireEs_string_replace(),requireEs_string_replaceAll(),requireEs_string_search(),requireEs_string_split(),requireEs_string_startsWith(),requireEs_string_substr(),requireEs_string_toWellFormed(),requireEs_string_trim(),requireEs_string_trimEnd(),requireEs_string_trimStart(),requireEs_string_anchor(),requireEs_string_big(),requireEs_string_blink(),requireEs_string_bold(),requireEs_string_fixed(),requireEs_string_fontcolor(),requireEs_string_fontsize(),requireEs_string_italics(),requireEs_string_link(),requireEs_string_small(),requireEs_string_strike(),requireEs_string_sub(),requireEs_string_sup(),requireEs_typedArray_float32Array(),requireEs_typedArray_float64Array(),requireEs_typedArray_int8Array(),requireEs_typedArray_int16Array(),requireEs_typedArray_int32Array(),requireEs_typedArray_uint8Array(),requireEs_typedArray_uint8ClampedArray(),requireEs_typedArray_uint16Array(),requireEs_typedArray_uint32Array(),requireEs_typedArray_at(),requireEs_typedArray_copyWithin(),requireEs_typedArray_every(),requireEs_typedArray_fill(),requireEs_typedArray_filter(),requireEs_typedArray_find(),requireEs_typedArray_findIndex(),requireEs_typedArray_findLast(),requireEs_typedArray_findLastIndex(),requireEs_typedArray_forEach(),requireEs_typedArray_from(),requireEs_typedArray_includes(),requireEs_typedArray_indexOf(),requireEs_typedArray_iterator(),requireEs_typedArray_join(),requireEs_typedArray_lastIndexOf(),requireEs_typedArray_map(),requireEs_typedArray_of(),requireEs_typedArray_reduce(),requireEs_typedArray_reduceRight(),requireEs_typedArray_reverse(),requireEs_typedArray_set(),requireEs_typedArray_slice(),requireEs_typedArray_some(),requireEs_typedArray_sort(),requireEs_typedArray_subarray(),requireEs_typedArray_toLocaleString(),requireEs_typedArray_toReversed(),requireEs_typedArray_toSorted(),requireEs_typedArray_toString(),requireEs_typedArray_with(),requireEs_uint8Array_fromBase64(),requireEs_uint8Array_fromHex(),requireEs_uint8Array_setFromBase64(),requireEs_uint8Array_setFromHex(),requireEs_uint8Array_toBase64(),requireEs_uint8Array_toHex(),requireEs_unescape(),requireEs_weakMap(),requireEs_weakSet(),requireWeb_atob(),requireWeb_btoa(),requireWeb_domCollections_forEach(),requireWeb_domCollections_iterator(),requireWeb_domException_constructor(),requireWeb_domException_stack(),requireWeb_domException_toStringTag(),requireWeb_immediate(),requireWeb_queueMicrotask(),requireWeb_self(),requireWeb_structuredClone(),requireWeb_timers(),requireWeb_url(),requireWeb_url_canParse(),requireWeb_url_parse(),requireWeb_url_toJson(),requireWeb_urlSearchParams(),requireWeb_urlSearchParams_delete(),requireWeb_urlSearchParams_has(),requireWeb_urlSearchParams_size(),stable=requirePath()),stable}requireStable();var runtime={exports:{}},hasRequiredRuntime;function requireRuntime(){return hasRequiredRuntime||(hasRequiredRuntime=1,(function(J){var Y=(function(re){var ae=Object.prototype,ne=ae.hasOwnProperty,ce=Object.defineProperty||function(ut,Et,bt){ut[Et]=bt.value},ee,R=typeof Symbol=="function"?Symbol:{},U=R.iterator||"@@iterator",K=R.asyncIterator||"@@asyncIterator",oe=R.toStringTag||"@@toStringTag";function pe(ut,Et,bt){return Object.defineProperty(ut,Et,{value:bt,enumerable:!0,configurable:!0,writable:!0}),ut[Et]}try{pe({},"")}catch{pe=function(Et,bt,Dt){return Et[bt]=Dt}}function _e(ut,Et,bt,Dt){var Ut=Et&&Et.prototype instanceof je?Et:je,er=Object.create(Ut.prototype),xr=new Ft(Dt||[]);return ce(er,"_invoke",{value:ct(ut,bt,xr)}),er}re.wrap=_e;function me(ut,Et,bt){try{return{type:"normal",arg:ut.call(Et,bt)}}catch(Dt){return{type:"throw",arg:Dt}}}var we="suspendedStart",Oe="suspendedYield",De="executing",Ae="completed",Ce={};function je(){}function ke(){}function Be(){}var We={};pe(We,U,function(){return this});var Je=Object.getPrototypeOf,Ke=Je&&Je(Je(ht([])));Ke&&Ke!==ae&&ne.call(Ke,U)&&(We=Ke);var et=Be.prototype=je.prototype=Object.create(We);ke.prototype=Be,ce(et,"constructor",{value:Be,configurable:!0}),ce(Be,"constructor",{value:ke,configurable:!0}),ke.displayName=pe(Be,oe,"GeneratorFunction");function it(ut){["next","throw","return"].forEach(function(Et){pe(ut,Et,function(bt){return this._invoke(Et,bt)})})}re.isGeneratorFunction=function(ut){var Et=typeof ut=="function"&&ut.constructor;return Et?Et===ke||(Et.displayName||Et.name)==="GeneratorFunction":!1},re.mark=function(ut){return Object.setPrototypeOf?Object.setPrototypeOf(ut,Be):(ut.__proto__=Be,pe(ut,oe,"GeneratorFunction")),ut.prototype=Object.create(et),ut},re.awrap=function(ut){return{__await:ut}};function nt(ut,Et){function bt(er,xr,ur,yr){var Wt=me(ut[er],ut,xr);if(Wt.type==="throw")yr(Wt.arg);else{var or=Wt.arg,wr=or.value;return wr&&typeof wr=="object"&&ne.call(wr,"__await")?Et.resolve(wr.__await).then(function(Ir){bt("next",Ir,ur,yr)},function(Ir){bt("throw",Ir,ur,yr)}):Et.resolve(wr).then(function(Ir){or.value=Ir,ur(or)},function(Ir){return bt("throw",Ir,ur,yr)})}}var Dt;function Ut(er,xr){function ur(){return new Et(function(yr,Wt){bt(er,xr,yr,Wt)})}return Dt=Dt?Dt.then(ur,ur):ur()}ce(this,"_invoke",{value:Ut})}it(nt.prototype),pe(nt.prototype,K,function(){return this}),re.AsyncIterator=nt,re.async=function(ut,Et,bt,Dt,Ut){Ut===void 0&&(Ut=Promise);var er=new nt(_e(ut,Et,bt,Dt),Ut);return re.isGeneratorFunction(Et)?er:er.next().then(function(xr){return xr.done?xr.value:er.next()})};function ct(ut,Et,bt){var Dt=we;return function(er,xr){if(Dt===De)throw new Error("Generator is already running");if(Dt===Ae){if(er==="throw")throw xr;return St()}for(bt.method=er,bt.arg=xr;;){var ur=bt.delegate;if(ur){var yr=ft(ur,bt);if(yr){if(yr===Ce)continue;return yr}}if(bt.method==="next")bt.sent=bt._sent=bt.arg;else if(bt.method==="throw"){if(Dt===we)throw Dt=Ae,bt.arg;bt.dispatchException(bt.arg)}else bt.method==="return"&&bt.abrupt("return",bt.arg);Dt=De;var Wt=me(ut,Et,bt);if(Wt.type==="normal"){if(Dt=bt.done?Ae:Oe,Wt.arg===Ce)continue;return{value:Wt.arg,done:bt.done}}else Wt.type==="throw"&&(Dt=Ae,bt.method="throw",bt.arg=Wt.arg)}}}function ft(ut,Et){var bt=Et.method,Dt=ut.iterator[bt];if(Dt===ee)return Et.delegate=null,bt==="throw"&&ut.iterator.return&&(Et.method="return",Et.arg=ee,ft(ut,Et),Et.method==="throw")||bt!=="return"&&(Et.method="throw",Et.arg=new TypeError("The iterator does not provide a '"+bt+"' method")),Ce;var Ut=me(Dt,ut.iterator,Et.arg);if(Ut.type==="throw")return Et.method="throw",Et.arg=Ut.arg,Et.delegate=null,Ce;var er=Ut.arg;if(!er)return Et.method="throw",Et.arg=new TypeError("iterator result is not an object"),Et.delegate=null,Ce;if(er.done)Et[ut.resultName]=er.value,Et.next=ut.nextLoc,Et.method!=="return"&&(Et.method="next",Et.arg=ee);else return er;return Et.delegate=null,Ce}it(et),pe(et,oe,"Generator"),pe(et,U,function(){return this}),pe(et,"toString",function(){return"[object Generator]"});function _t(ut){var Et={tryLoc:ut[0]};1 in ut&&(Et.catchLoc=ut[1]),2 in ut&&(Et.finallyLoc=ut[2],Et.afterLoc=ut[3]),this.tryEntries.push(Et)}function Rt(ut){var Et=ut.completion||{};Et.type="normal",delete Et.arg,ut.completion=Et}function Ft(ut){this.tryEntries=[{tryLoc:"root"}],ut.forEach(_t,this),this.reset(!0)}re.keys=function(ut){var Et=Object(ut),bt=[];for(var Dt in Et)bt.push(Dt);return bt.reverse(),function Ut(){for(;bt.length;){var er=bt.pop();if(er in Et)return Ut.value=er,Ut.done=!1,Ut}return Ut.done=!0,Ut}};function ht(ut){if(ut!=null){var Et=ut[U];if(Et)return Et.call(ut);if(typeof ut.next=="function")return ut;if(!isNaN(ut.length)){var bt=-1,Dt=function Ut(){for(;++bt<ut.length;)if(ne.call(ut,bt))return Ut.value=ut[bt],Ut.done=!1,Ut;return Ut.value=ee,Ut.done=!0,Ut};return Dt.next=Dt}}throw new TypeError(typeof ut+" is not iterable")}re.values=ht;function St(){return{value:ee,done:!0}}return Ft.prototype={constructor:Ft,reset:function(ut){if(this.prev=0,this.next=0,this.sent=this._sent=ee,this.done=!1,this.delegate=null,this.method="next",this.arg=ee,this.tryEntries.forEach(Rt),!ut)for(var Et in this)Et.charAt(0)==="t"&&ne.call(this,Et)&&!isNaN(+Et.slice(1))&&(this[Et]=ee)},stop:function(){this.done=!0;var ut=this.tryEntries[0],Et=ut.completion;if(Et.type==="throw")throw Et.arg;return this.rval},dispatchException:function(ut){if(this.done)throw ut;var Et=this;function bt(yr,Wt){return er.type="throw",er.arg=ut,Et.next=yr,Wt&&(Et.method="next",Et.arg=ee),!!Wt}for(var Dt=this.tryEntries.length-1;Dt>=0;--Dt){var Ut=this.tryEntries[Dt],er=Ut.completion;if(Ut.tryLoc==="root")return bt("end");if(Ut.tryLoc<=this.prev){var xr=ne.call(Ut,"catchLoc"),ur=ne.call(Ut,"finallyLoc");if(xr&&ur){if(this.prev<Ut.catchLoc)return bt(Ut.catchLoc,!0);if(this.prev<Ut.finallyLoc)return bt(Ut.finallyLoc)}else if(xr){if(this.prev<Ut.catchLoc)return bt(Ut.catchLoc,!0)}else if(ur){if(this.prev<Ut.finallyLoc)return bt(Ut.finallyLoc)}else throw new Error("try statement without catch or finally")}}},abrupt:function(ut,Et){for(var bt=this.tryEntries.length-1;bt>=0;--bt){var Dt=this.tryEntries[bt];if(Dt.tryLoc<=this.prev&&ne.call(Dt,"finallyLoc")&&this.prev<Dt.finallyLoc){var Ut=Dt;break}}Ut&&(ut==="break"||ut==="continue")&&Ut.tryLoc<=Et&&Et<=Ut.finallyLoc&&(Ut=null);var er=Ut?Ut.completion:{};return er.type=ut,er.arg=Et,Ut?(this.method="next",this.next=Ut.finallyLoc,Ce):this.complete(er)},complete:function(ut,Et){if(ut.type==="throw")throw ut.arg;return ut.type==="break"||ut.type==="continue"?this.next=ut.arg:ut.type==="return"?(this.rval=this.arg=ut.arg,this.method="return",this.next="end"):ut.type==="normal"&&Et&&(this.next=Et),Ce},finish:function(ut){for(var Et=this.tryEntries.length-1;Et>=0;--Et){var bt=this.tryEntries[Et];if(bt.finallyLoc===ut)return this.complete(bt.completion,bt.afterLoc),Rt(bt),Ce}},catch:function(ut){for(var Et=this.tryEntries.length-1;Et>=0;--Et){var bt=this.tryEntries[Et];if(bt.tryLoc===ut){var Dt=bt.completion;if(Dt.type==="throw"){var Ut=Dt.arg;Rt(bt)}return Ut}}throw new Error("illegal catch attempt")},delegateYield:function(ut,Et,bt){return this.delegate={iterator:ht(ut),resultName:Et,nextLoc:bt},this.method==="next"&&(this.arg=ee),Ce}},re})(J.exports);try{regeneratorRuntime=Y}catch{typeof globalThis=="object"?globalThis.regeneratorRuntime=Y:Function("r","regeneratorRuntime = r")(Y)}})(runtime)),runtime.exports}requireRuntime();var events={exports:{}},hasRequiredEvents;function requireEvents(){if(hasRequiredEvents)return events.exports;hasRequiredEvents=1;var J=typeof Reflect=="object"?Reflect:null,Y=J&&typeof J.apply=="function"?J.apply:function(Be,We,Je){return Function.prototype.apply.call(Be,We,Je)},re;J&&typeof J.ownKeys=="function"?re=J.ownKeys:Object.getOwnPropertySymbols?re=function(Be){return Object.getOwnPropertyNames(Be).concat(Object.getOwnPropertySymbols(Be))}:re=function(Be){return Object.getOwnPropertyNames(Be)};function ae(ke){console&&console.warn&&console.warn(ke)}var ne=Number.isNaN||function(Be){return Be!==Be};function ce(){ce.init.call(this)}events.exports=ce,events.exports.once=Ae,ce.EventEmitter=ce,ce.prototype._events=void 0,ce.prototype._eventsCount=0,ce.prototype._maxListeners=void 0;var ee=10;function R(ke){if(typeof ke!="function")throw new TypeError('The "listener" argument must be of type Function. Received type '+typeof ke)}Object.defineProperty(ce,"defaultMaxListeners",{enumerable:!0,get:function(){return ee},set:function(ke){if(typeof ke!="number"||ke<0||ne(ke))throw new RangeError('The value of "defaultMaxListeners" is out of range. It must be a non-negative number. Received '+ke+".");ee=ke}}),ce.init=function(){(this._events===void 0||this._events===Object.getPrototypeOf(this)._events)&&(this._events=Object.create(null),this._eventsCount=0),this._maxListeners=this._maxListeners||void 0},ce.prototype.setMaxListeners=function(Be){if(typeof Be!="number"||Be<0||ne(Be))throw new RangeError('The value of "n" is out of range. It must be a non-negative number. Received '+Be+".");return this._maxListeners=Be,this};function U(ke){return ke._maxListeners===void 0?ce.defaultMaxListeners:ke._maxListeners}ce.prototype.getMaxListeners=function(){return U(this)},ce.prototype.emit=function(Be){for(var We=[],Je=1;Je<arguments.length;Je++)We.push(arguments[Je]);var Ke=Be==="error",et=this._events;if(et!==void 0)Ke=Ke&&et.error===void 0;else if(!Ke)return!1;if(Ke){var it;if(We.length>0&&(it=We[0]),it instanceof Error)throw it;var nt=new Error("Unhandled error."+(it?" ("+it.message+")":""));throw nt.context=it,nt}var ct=et[Be];if(ct===void 0)return!1;if(typeof ct=="function")Y(ct,this,We);else for(var ft=ct.length,_t=we(ct,ft),Je=0;Je<ft;++Je)Y(_t[Je],this,We);return!0};function K(ke,Be,We,Je){var Ke,et,it;if(R(We),et=ke._events,et===void 0?(et=ke._events=Object.create(null),ke._eventsCount=0):(et.newListener!==void 0&&(ke.emit("newListener",Be,We.listener?We.listener:We),et=ke._events),it=et[Be]),it===void 0)it=et[Be]=We,++ke._eventsCount;else if(typeof it=="function"?it=et[Be]=Je?[We,it]:[it,We]:Je?it.unshift(We):it.push(We),Ke=U(ke),Ke>0&&it.length>Ke&&!it.warned){it.warned=!0;var nt=new Error("Possible EventEmitter memory leak detected. "+it.length+" "+String(Be)+" listeners added. Use emitter.setMaxListeners() to increase limit");nt.name="MaxListenersExceededWarning",nt.emitter=ke,nt.type=Be,nt.count=it.length,ae(nt)}return ke}ce.prototype.addListener=function(Be,We){return K(this,Be,We,!1)},ce.prototype.on=ce.prototype.addListener,ce.prototype.prependListener=function(Be,We){return K(this,Be,We,!0)};function oe(){if(!this.fired)return this.target.removeListener(this.type,this.wrapFn),this.fired=!0,arguments.length===0?this.listener.call(this.target):this.listener.apply(this.target,arguments)}function pe(ke,Be,We){var Je={fired:!1,wrapFn:void 0,target:ke,type:Be,listener:We},Ke=oe.bind(Je);return Ke.listener=We,Je.wrapFn=Ke,Ke}ce.prototype.once=function(Be,We){return R(We),this.on(Be,pe(this,Be,We)),this},ce.prototype.prependOnceListener=function(Be,We){return R(We),this.prependListener(Be,pe(this,Be,We)),this},ce.prototype.removeListener=function(Be,We){var Je,Ke,et,it,nt;if(R(We),Ke=this._events,Ke===void 0)return this;if(Je=Ke[Be],Je===void 0)return this;if(Je===We||Je.listener===We)--this._eventsCount===0?this._events=Object.create(null):(delete Ke[Be],Ke.removeListener&&this.emit("removeListener",Be,Je.listener||We));else if(typeof Je!="function"){for(et=-1,it=Je.length-1;it>=0;it--)if(Je[it]===We||Je[it].listener===We){nt=Je[it].listener,et=it;break}if(et<0)return this;et===0?Je.shift():Oe(Je,et),Je.length===1&&(Ke[Be]=Je[0]),Ke.removeListener!==void 0&&this.emit("removeListener",Be,nt||We)}return this},ce.prototype.off=ce.prototype.removeListener,ce.prototype.removeAllListeners=function(Be){var We,Je,Ke;if(Je=this._events,Je===void 0)return this;if(Je.removeListener===void 0)return arguments.length===0?(this._events=Object.create(null),this._eventsCount=0):Je[Be]!==void 0&&(--this._eventsCount===0?this._events=Object.create(null):delete Je[Be]),this;if(arguments.length===0){var et=Object.keys(Je),it;for(Ke=0;Ke<et.length;++Ke)it=et[Ke],it!=="removeListener"&&this.removeAllListeners(it);return this.removeAllListeners("removeListener"),this._events=Object.create(null),this._eventsCount=0,this}if(We=Je[Be],typeof We=="function")this.removeListener(Be,We);else if(We!==void 0)for(Ke=We.length-1;Ke>=0;Ke--)this.removeListener(Be,We[Ke]);return this};function _e(ke,Be,We){var Je=ke._events;if(Je===void 0)return[];var Ke=Je[Be];return Ke===void 0?[]:typeof Ke=="function"?We?[Ke.listener||Ke]:[Ke]:We?De(Ke):we(Ke,Ke.length)}ce.prototype.listeners=function(Be){return _e(this,Be,!0)},ce.prototype.rawListeners=function(Be){return _e(this,Be,!1)},ce.listenerCount=function(ke,Be){return typeof ke.listenerCount=="function"?ke.listenerCount(Be):me.call(ke,Be)},ce.prototype.listenerCount=me;function me(ke){var Be=this._events;if(Be!==void 0){var We=Be[ke];if(typeof We=="function")return 1;if(We!==void 0)return We.length}return 0}ce.prototype.eventNames=function(){return this._eventsCount>0?re(this._events):[]};function we(ke,Be){for(var We=new Array(Be),Je=0;Je<Be;++Je)We[Je]=ke[Je];return We}function Oe(ke,Be){for(;Be+1<ke.length;Be++)ke[Be]=ke[Be+1];ke.pop()}function De(ke){for(var Be=new Array(ke.length),We=0;We<Be.length;++We)Be[We]=ke[We].listener||ke[We];return Be}function Ae(ke,Be){return new Promise(function(We,Je){function Ke(it){ke.removeListener(Be,et),Je(it)}function et(){typeof ke.removeListener=="function"&&ke.removeListener("error",Ke),We([].slice.call(arguments))}je(ke,Be,et,{once:!0}),Be!=="error"&&Ce(ke,Ke,{once:!0})})}function Ce(ke,Be,We){typeof ke.on=="function"&&je(ke,"error",Be,We)}function je(ke,Be,We,Je){if(typeof ke.on=="function")Je.once?ke.once(Be,We):ke.on(Be,We);else if(typeof ke.addEventListener=="function")ke.addEventListener(Be,function Ke(et){Je.once&&ke.removeEventListener(Be,Ke),We(et)});else throw new TypeError('The "emitter" argument must be of type EventEmitter. Received type '+typeof ke)}return events.exports}var eventsExports=requireEvents();const EventEmitter=getDefaultExportFromCjs(eventsExports),viewStore=(J,Y)=>{J.view="log",Y.on("view:set",re=>{re!==J.view&&(J.view=re,Y.emit(Y.STATE_CHANGE))})};var isObject_1,hasRequiredIsObject;function requireIsObject(){if(hasRequiredIsObject)return isObject_1;hasRequiredIsObject=1;function J(Y){var re=typeof Y;return Y!=null&&(re=="object"||re=="function")}return isObject_1=J,isObject_1}var _freeGlobal,hasRequired_freeGlobal;function require_freeGlobal(){if(hasRequired_freeGlobal)return _freeGlobal;hasRequired_freeGlobal=1;var J=typeof commonjsGlobal=="object"&&commonjsGlobal&&commonjsGlobal.Object===Object&&commonjsGlobal;return _freeGlobal=J,_freeGlobal}var _root,hasRequired_root;function require_root(){if(hasRequired_root)return _root;hasRequired_root=1;var J=require_freeGlobal(),Y=typeof self=="object"&&self&&self.Object===Object&&self,re=J||Y||Function("return this")();return _root=re,_root}var now_1,hasRequiredNow;function requireNow(){if(hasRequiredNow)return now_1;hasRequiredNow=1;var J=require_root(),Y=function(){return J.Date.now()};return now_1=Y,now_1}var _trimmedEndIndex,hasRequired_trimmedEndIndex;function require_trimmedEndIndex(){if(hasRequired_trimmedEndIndex)return _trimmedEndIndex;hasRequired_trimmedEndIndex=1;var J=/\s/;function Y(re){for(var ae=re.length;ae--&&J.test(re.charAt(ae)););return ae}return _trimmedEndIndex=Y,_trimmedEndIndex}var _baseTrim,hasRequired_baseTrim;function require_baseTrim(){if(hasRequired_baseTrim)return _baseTrim;hasRequired_baseTrim=1;var J=require_trimmedEndIndex(),Y=/^\s+/;function re(ae){return ae&&ae.slice(0,J(ae)+1).replace(Y,"")}return _baseTrim=re,_baseTrim}var _Symbol,hasRequired_Symbol;function require_Symbol(){if(hasRequired_Symbol)return _Symbol;hasRequired_Symbol=1;var J=require_root(),Y=J.Symbol;return _Symbol=Y,_Symbol}var _getRawTag,hasRequired_getRawTag;function require_getRawTag(){if(hasRequired_getRawTag)return _getRawTag;hasRequired_getRawTag=1;var J=require_Symbol(),Y=Object.prototype,re=Y.hasOwnProperty,ae=Y.toString,ne=J?J.toStringTag:void 0;function ce(ee){var R=re.call(ee,ne),U=ee[ne];try{ee[ne]=void 0;var K=!0}catch{}var oe=ae.call(ee);return K&&(R?ee[ne]=U:delete ee[ne]),oe}return _getRawTag=ce,_getRawTag}var _objectToString,hasRequired_objectToString;function require_objectToString(){if(hasRequired_objectToString)return _objectToString;hasRequired_objectToString=1;var J=Object.prototype,Y=J.toString;function re(ae){return Y.call(ae)}return _objectToString=re,_objectToString}var _baseGetTag,hasRequired_baseGetTag;function require_baseGetTag(){if(hasRequired_baseGetTag)return _baseGetTag;hasRequired_baseGetTag=1;var J=require_Symbol(),Y=require_getRawTag(),re=require_objectToString(),ae="[object Null]",ne="[object Undefined]",ce=J?J.toStringTag:void 0;function ee(R){return R==null?R===void 0?ne:ae:ce&&ce in Object(R)?Y(R):re(R)}return _baseGetTag=ee,_baseGetTag}var isObjectLike_1,hasRequiredIsObjectLike;function requireIsObjectLike(){if(hasRequiredIsObjectLike)return isObjectLike_1;hasRequiredIsObjectLike=1;function J(Y){return Y!=null&&typeof Y=="object"}return isObjectLike_1=J,isObjectLike_1}var isSymbol_1,hasRequiredIsSymbol;function requireIsSymbol(){if(hasRequiredIsSymbol)return isSymbol_1;hasRequiredIsSymbol=1;var J=require_baseGetTag(),Y=requireIsObjectLike(),re="[object Symbol]";function ae(ne){return typeof ne=="symbol"||Y(ne)&&J(ne)==re}return isSymbol_1=ae,isSymbol_1}var toNumber_1,hasRequiredToNumber;function requireToNumber(){if(hasRequiredToNumber)return toNumber_1;hasRequiredToNumber=1;var J=require_baseTrim(),Y=requireIsObject(),re=requireIsSymbol(),ae=NaN,ne=/^[-+]0x[0-9a-f]+$/i,ce=/^0b[01]+$/i,ee=/^0o[0-7]+$/i,R=parseInt;function U(K){if(typeof K=="number")return K;if(re(K))return ae;if(Y(K)){var oe=typeof K.valueOf=="function"?K.valueOf():K;K=Y(oe)?oe+"":oe}if(typeof K!="string")return K===0?K:+K;K=J(K);var pe=ce.test(K);return pe||ee.test(K)?R(K.slice(2),pe?2:8):ne.test(K)?ae:+K}return toNumber_1=U,toNumber_1}var debounce_1,hasRequiredDebounce;function requireDebounce(){if(hasRequiredDebounce)return debounce_1;hasRequiredDebounce=1;var J=requireIsObject(),Y=requireNow(),re=requireToNumber(),ae="Expected a function",ne=Math.max,ce=Math.min;function ee(R,U,K){var oe,pe,_e,me,we,Oe,De=0,Ae=!1,Ce=!1,je=!0;if(typeof R!="function")throw new TypeError(ae);U=re(U)||0,J(K)&&(Ae=!!K.leading,Ce="maxWait"in K,_e=Ce?ne(re(K.maxWait)||0,U):_e,je="trailing"in K?!!K.trailing:je);function ke(ft){var _t=oe,Rt=pe;return oe=pe=void 0,De=ft,me=R.apply(Rt,_t),me}function Be(ft){return De=ft,we=setTimeout(Ke,U),Ae?ke(ft):me}function We(ft){var _t=ft-Oe,Rt=ft-De,Ft=U-_t;return Ce?ce(Ft,_e-Rt):Ft}function Je(ft){var _t=ft-Oe,Rt=ft-De;return Oe===void 0||_t>=U||_t<0||Ce&&Rt>=_e}function Ke(){var ft=Y();if(Je(ft))return et(ft);we=setTimeout(Ke,We(ft))}function et(ft){return we=void 0,je&&oe?ke(ft):(oe=pe=void 0,me)}function it(){we!==void 0&&clearTimeout(we),De=0,oe=Oe=pe=we=void 0}function nt(){return we===void 0?me:et(Y())}function ct(){var ft=Y(),_t=Je(ft);if(oe=arguments,pe=this,Oe=ft,_t){if(we===void 0)return Be(Oe);if(Ce)return clearTimeout(we),we=setTimeout(Ke,U),ke(Oe)}return we===void 0&&(we=setTimeout(Ke,U)),me}return ct.cancel=it,ct.flush=nt,ct}return debounce_1=ee,debounce_1}var debounceExports=requireDebounce();const debounce=getDefaultExportFromCjs(debounceExports);var contentType={};/*!
 * content-type
 * Copyright(c) 2015 Douglas Christopher Wilson
 * MIT Licensed
 */var hasRequiredContentType;function requireContentType(){if(hasRequiredContentType)return contentType;hasRequiredContentType=1;var J=/; *([!#$%&'*+.^_`|~0-9A-Za-z-]+) *= *("(?:[\u000b\u0020\u0021\u0023-\u005b\u005d-\u007e\u0080-\u00ff]|\\[\u000b\u0020-\u00ff])*"|[!#$%&'*+.^_`|~0-9A-Za-z-]+) */g,Y=/^[\u000b\u0020-\u007e\u0080-\u00ff]+$/,re=/^[!#$%&'*+.^_`|~0-9A-Za-z-]+$/,ae=/\\([\u000b\u0020-\u00ff])/g,ne=/([\\"])/g,ce=/^[!#$%&'*+.^_`|~0-9A-Za-z-]+\/[!#$%&'*+.^_`|~0-9A-Za-z-]+$/;contentType.format=ee,contentType.parse=R;function ee(pe){if(!pe||typeof pe!="object")throw new TypeError("argument obj is required");var _e=pe.parameters,me=pe.type;if(!me||!ce.test(me))throw new TypeError("invalid type");var we=me;if(_e&&typeof _e=="object")for(var Oe,De=Object.keys(_e).sort(),Ae=0;Ae<De.length;Ae++){if(Oe=De[Ae],!re.test(Oe))throw new TypeError("invalid parameter name");we+="; "+Oe+"="+K(_e[Oe])}return we}function R(pe){if(!pe)throw new TypeError("argument string is required");var _e=typeof pe=="object"?U(pe):pe;if(typeof _e!="string")throw new TypeError("argument string is required to be a string");var me=_e.indexOf(";"),we=me!==-1?_e.slice(0,me).trim():_e.trim();if(!ce.test(we))throw new TypeError("invalid media type");var Oe=new oe(we.toLowerCase());if(me!==-1){var De,Ae,Ce;for(J.lastIndex=me;Ae=J.exec(_e);){if(Ae.index!==me)throw new TypeError("invalid parameter format");me+=Ae[0].length,De=Ae[1].toLowerCase(),Ce=Ae[2],Ce.charCodeAt(0)===34&&(Ce=Ce.slice(1,-1),Ce.indexOf("\\")!==-1&&(Ce=Ce.replace(ae,"$1"))),Oe.parameters[De]=Ce}if(me!==_e.length)throw new TypeError("invalid parameter format")}return Oe}function U(pe){var _e;if(typeof pe.getHeader=="function"?_e=pe.getHeader("content-type"):typeof pe.headers=="object"&&(_e=pe.headers&&pe.headers["content-type"]),typeof _e!="string")throw new TypeError("content-type header is missing from object");return _e}function K(pe){var _e=String(pe);if(re.test(_e))return _e;if(_e.length>0&&!Y.test(_e))throw new TypeError("invalid parameter value");return'"'+_e.replace(ne,"\\$1")+'"'}function oe(pe){this.parameters=Object.create(null),this.type=pe}return contentType}var contentTypeExports=requireContentType(),buffer={},base64Js={},hasRequiredBase64Js;function requireBase64Js(){if(hasRequiredBase64Js)return base64Js;hasRequiredBase64Js=1,base64Js.byteLength=R,base64Js.toByteArray=K,base64Js.fromByteArray=_e;for(var J=[],Y=[],re=typeof Uint8Array<"u"?Uint8Array:Array,ae="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",ne=0,ce=ae.length;ne<ce;++ne)J[ne]=ae[ne],Y[ae.charCodeAt(ne)]=ne;Y[45]=62,Y[95]=63;function ee(me){var we=me.length;if(we%4>0)throw new Error("Invalid string. Length must be a multiple of 4");var Oe=me.indexOf("=");Oe===-1&&(Oe=we);var De=Oe===we?0:4-Oe%4;return[Oe,De]}function R(me){var we=ee(me),Oe=we[0],De=we[1];return(Oe+De)*3/4-De}function U(me,we,Oe){return(we+Oe)*3/4-Oe}function K(me){var we,Oe=ee(me),De=Oe[0],Ae=Oe[1],Ce=new re(U(me,De,Ae)),je=0,ke=Ae>0?De-4:De,Be;for(Be=0;Be<ke;Be+=4)we=Y[me.charCodeAt(Be)]<<18|Y[me.charCodeAt(Be+1)]<<12|Y[me.charCodeAt(Be+2)]<<6|Y[me.charCodeAt(Be+3)],Ce[je++]=we>>16&255,Ce[je++]=we>>8&255,Ce[je++]=we&255;return Ae===2&&(we=Y[me.charCodeAt(Be)]<<2|Y[me.charCodeAt(Be+1)]>>4,Ce[je++]=we&255),Ae===1&&(we=Y[me.charCodeAt(Be)]<<10|Y[me.charCodeAt(Be+1)]<<4|Y[me.charCodeAt(Be+2)]>>2,Ce[je++]=we>>8&255,Ce[je++]=we&255),Ce}function oe(me){return J[me>>18&63]+J[me>>12&63]+J[me>>6&63]+J[me&63]}function pe(me,we,Oe){for(var De,Ae=[],Ce=we;Ce<Oe;Ce+=3)De=(me[Ce]<<16&16711680)+(me[Ce+1]<<8&65280)+(me[Ce+2]&255),Ae.push(oe(De));return Ae.join("")}function _e(me){for(var we,Oe=me.length,De=Oe%3,Ae=[],Ce=16383,je=0,ke=Oe-De;je<ke;je+=Ce)Ae.push(pe(me,je,je+Ce>ke?ke:je+Ce));return De===1?(we=me[Oe-1],Ae.push(J[we>>2]+J[we<<4&63]+"==")):De===2&&(we=(me[Oe-2]<<8)+me[Oe-1],Ae.push(J[we>>10]+J[we>>4&63]+J[we<<2&63]+"=")),Ae.join("")}return base64Js}var ieee754={};/*! ieee754. BSD-3-Clause License. Feross Aboukhadijeh <https://feross.org/opensource> */var hasRequiredIeee754;function requireIeee754(){return hasRequiredIeee754||(hasRequiredIeee754=1,ieee754.read=function(J,Y,re,ae,ne){var ce,ee,R=ne*8-ae-1,U=(1<<R)-1,K=U>>1,oe=-7,pe=re?ne-1:0,_e=re?-1:1,me=J[Y+pe];for(pe+=_e,ce=me&(1<<-oe)-1,me>>=-oe,oe+=R;oe>0;ce=ce*256+J[Y+pe],pe+=_e,oe-=8);for(ee=ce&(1<<-oe)-1,ce>>=-oe,oe+=ae;oe>0;ee=ee*256+J[Y+pe],pe+=_e,oe-=8);if(ce===0)ce=1-K;else{if(ce===U)return ee?NaN:(me?-1:1)*(1/0);ee=ee+Math.pow(2,ae),ce=ce-K}return(me?-1:1)*ee*Math.pow(2,ce-ae)},ieee754.write=function(J,Y,re,ae,ne,ce){var ee,R,U,K=ce*8-ne-1,oe=(1<<K)-1,pe=oe>>1,_e=ne===23?Math.pow(2,-24)-Math.pow(2,-77):0,me=ae?0:ce-1,we=ae?1:-1,Oe=Y<0||Y===0&&1/Y<0?1:0;for(Y=Math.abs(Y),isNaN(Y)||Y===1/0?(R=isNaN(Y)?1:0,ee=oe):(ee=Math.floor(Math.log(Y)/Math.LN2),Y*(U=Math.pow(2,-ee))<1&&(ee--,U*=2),ee+pe>=1?Y+=_e/U:Y+=_e*Math.pow(2,1-pe),Y*U>=2&&(ee++,U/=2),ee+pe>=oe?(R=0,ee=oe):ee+pe>=1?(R=(Y*U-1)*Math.pow(2,ne),ee=ee+pe):(R=Y*Math.pow(2,pe-1)*Math.pow(2,ne),ee=0));ne>=8;J[re+me]=R&255,me+=we,R/=256,ne-=8);for(ee=ee<<ne|R,K+=ne;K>0;J[re+me]=ee&255,me+=we,ee/=256,K-=8);J[re+me-we]|=Oe*128}),ieee754}/*!
 * The buffer module from node.js, for the browser.
 *
 * @author   Feross Aboukhadijeh <https://feross.org>
 * @license  MIT
 */var hasRequiredBuffer;function requireBuffer(){return hasRequiredBuffer||(hasRequiredBuffer=1,(function(J){const Y=requireBase64Js(),re=requireIeee754(),ae=typeof Symbol=="function"&&typeof Symbol.for=="function"?Symbol.for("nodejs.util.inspect.custom"):null;J.Buffer=R,J.SlowBuffer=Ce,J.INSPECT_MAX_BYTES=50;const ne=2147483647;J.kMaxLength=ne,R.TYPED_ARRAY_SUPPORT=ce(),!R.TYPED_ARRAY_SUPPORT&&typeof console<"u"&&typeof console.error=="function"&&console.error("This browser lacks typed array (Uint8Array) support which is required by `buffer` v5.x. Use `buffer` v4.x if you require old browser support.");function ce(){try{const Ge=new Uint8Array(1),Ie={foo:function(){return 42}};return Object.setPrototypeOf(Ie,Uint8Array.prototype),Object.setPrototypeOf(Ge,Ie),Ge.foo()===42}catch{return!1}}Object.defineProperty(R.prototype,"parent",{enumerable:!0,get:function(){if(R.isBuffer(this))return this.buffer}}),Object.defineProperty(R.prototype,"offset",{enumerable:!0,get:function(){if(R.isBuffer(this))return this.byteOffset}});function ee(Ge){if(Ge>ne)throw new RangeError('The value "'+Ge+'" is invalid for option "size"');const Ie=new Uint8Array(Ge);return Object.setPrototypeOf(Ie,R.prototype),Ie}function R(Ge,Ie,Se){if(typeof Ge=="number"){if(typeof Ie=="string")throw new TypeError('The "string" argument must be of type string. Received type number');return pe(Ge)}return U(Ge,Ie,Se)}R.poolSize=8192;function U(Ge,Ie,Se){if(typeof Ge=="string")return _e(Ge,Ie);if(ArrayBuffer.isView(Ge))return we(Ge);if(Ge==null)throw new TypeError("The first argument must be one of type string, Buffer, ArrayBuffer, Array, or Array-like Object. Received type "+typeof Ge);if(Jt(Ge,ArrayBuffer)||Ge&&Jt(Ge.buffer,ArrayBuffer)||typeof SharedArrayBuffer<"u"&&(Jt(Ge,SharedArrayBuffer)||Ge&&Jt(Ge.buffer,SharedArrayBuffer)))return Oe(Ge,Ie,Se);if(typeof Ge=="number")throw new TypeError('The "value" argument must not be of type number. Received type number');const xe=Ge.valueOf&&Ge.valueOf();if(xe!=null&&xe!==Ge)return R.from(xe,Ie,Se);const Te=De(Ge);if(Te)return Te;if(typeof Symbol<"u"&&Symbol.toPrimitive!=null&&typeof Ge[Symbol.toPrimitive]=="function")return R.from(Ge[Symbol.toPrimitive]("string"),Ie,Se);throw new TypeError("The first argument must be one of type string, Buffer, ArrayBuffer, Array, or Array-like Object. Received type "+typeof Ge)}R.from=function(Ge,Ie,Se){return U(Ge,Ie,Se)},Object.setPrototypeOf(R.prototype,Uint8Array.prototype),Object.setPrototypeOf(R,Uint8Array);function K(Ge){if(typeof Ge!="number")throw new TypeError('"size" argument must be of type number');if(Ge<0)throw new RangeError('The value "'+Ge+'" is invalid for option "size"')}function oe(Ge,Ie,Se){return K(Ge),Ge<=0?ee(Ge):Ie!==void 0?typeof Se=="string"?ee(Ge).fill(Ie,Se):ee(Ge).fill(Ie):ee(Ge)}R.alloc=function(Ge,Ie,Se){return oe(Ge,Ie,Se)};function pe(Ge){return K(Ge),ee(Ge<0?0:Ae(Ge)|0)}R.allocUnsafe=function(Ge){return pe(Ge)},R.allocUnsafeSlow=function(Ge){return pe(Ge)};function _e(Ge,Ie){if((typeof Ie!="string"||Ie==="")&&(Ie="utf8"),!R.isEncoding(Ie))throw new TypeError("Unknown encoding: "+Ie);const Se=je(Ge,Ie)|0;let xe=ee(Se);const Te=xe.write(Ge,Ie);return Te!==Se&&(xe=xe.slice(0,Te)),xe}function me(Ge){const Ie=Ge.length<0?0:Ae(Ge.length)|0,Se=ee(Ie);for(let xe=0;xe<Ie;xe+=1)Se[xe]=Ge[xe]&255;return Se}function we(Ge){if(Jt(Ge,Uint8Array)){const Ie=new Uint8Array(Ge);return Oe(Ie.buffer,Ie.byteOffset,Ie.byteLength)}return me(Ge)}function Oe(Ge,Ie,Se){if(Ie<0||Ge.byteLength<Ie)throw new RangeError('"offset" is outside of buffer bounds');if(Ge.byteLength<Ie+(Se||0))throw new RangeError('"length" is outside of buffer bounds');let xe;return Ie===void 0&&Se===void 0?xe=new Uint8Array(Ge):Se===void 0?xe=new Uint8Array(Ge,Ie):xe=new Uint8Array(Ge,Ie,Se),Object.setPrototypeOf(xe,R.prototype),xe}function De(Ge){if(R.isBuffer(Ge)){const Ie=Ae(Ge.length)|0,Se=ee(Ie);return Se.length===0||Ge.copy(Se,0,0,Ie),Se}if(Ge.length!==void 0)return typeof Ge.length!="number"||qr(Ge.length)?ee(0):me(Ge);if(Ge.type==="Buffer"&&Array.isArray(Ge.data))return me(Ge.data)}function Ae(Ge){if(Ge>=ne)throw new RangeError("Attempt to allocate Buffer larger than maximum size: 0x"+ne.toString(16)+" bytes");return Ge|0}function Ce(Ge){return+Ge!=Ge&&(Ge=0),R.alloc(+Ge)}R.isBuffer=function(Ie){return Ie!=null&&Ie._isBuffer===!0&&Ie!==R.prototype},R.compare=function(Ie,Se){if(Jt(Ie,Uint8Array)&&(Ie=R.from(Ie,Ie.offset,Ie.byteLength)),Jt(Se,Uint8Array)&&(Se=R.from(Se,Se.offset,Se.byteLength)),!R.isBuffer(Ie)||!R.isBuffer(Se))throw new TypeError('The "buf1", "buf2" arguments must be one of type Buffer or Uint8Array');if(Ie===Se)return 0;let xe=Ie.length,Te=Se.length;for(let Me=0,ze=Math.min(xe,Te);Me<ze;++Me)if(Ie[Me]!==Se[Me]){xe=Ie[Me],Te=Se[Me];break}return xe<Te?-1:Te<xe?1:0},R.isEncoding=function(Ie){switch(String(Ie).toLowerCase()){case"hex":case"utf8":case"utf-8":case"ascii":case"latin1":case"binary":case"base64":case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return!0;default:return!1}},R.concat=function(Ie,Se){if(!Array.isArray(Ie))throw new TypeError('"list" argument must be an Array of Buffers');if(Ie.length===0)return R.alloc(0);let xe;if(Se===void 0)for(Se=0,xe=0;xe<Ie.length;++xe)Se+=Ie[xe].length;const Te=R.allocUnsafe(Se);let Me=0;for(xe=0;xe<Ie.length;++xe){let ze=Ie[xe];if(Jt(ze,Uint8Array))Me+ze.length>Te.length?(R.isBuffer(ze)||(ze=R.from(ze)),ze.copy(Te,Me)):Uint8Array.prototype.set.call(Te,ze,Me);else if(R.isBuffer(ze))ze.copy(Te,Me);else throw new TypeError('"list" argument must be an Array of Buffers');Me+=ze.length}return Te};function je(Ge,Ie){if(R.isBuffer(Ge))return Ge.length;if(ArrayBuffer.isView(Ge)||Jt(Ge,ArrayBuffer))return Ge.byteLength;if(typeof Ge!="string")throw new TypeError('The "string" argument must be one of type string, Buffer, or ArrayBuffer. Received type '+typeof Ge);const Se=Ge.length,xe=arguments.length>2&&arguments[2]===!0;if(!xe&&Se===0)return 0;let Te=!1;for(;;)switch(Ie){case"ascii":case"latin1":case"binary":return Se;case"utf8":case"utf-8":return Sr(Ge).length;case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return Se*2;case"hex":return Se>>>1;case"base64":return Lr(Ge).length;default:if(Te)return xe?-1:Sr(Ge).length;Ie=(""+Ie).toLowerCase(),Te=!0}}R.byteLength=je;function ke(Ge,Ie,Se){let xe=!1;if((Ie===void 0||Ie<0)&&(Ie=0),Ie>this.length||((Se===void 0||Se>this.length)&&(Se=this.length),Se<=0)||(Se>>>=0,Ie>>>=0,Se<=Ie))return"";for(Ge||(Ge="utf8");;)switch(Ge){case"hex":return ut(this,Ie,Se);case"utf8":case"utf-8":return _t(this,Ie,Se);case"ascii":return ht(this,Ie,Se);case"latin1":case"binary":return St(this,Ie,Se);case"base64":return ft(this,Ie,Se);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return Et(this,Ie,Se);default:if(xe)throw new TypeError("Unknown encoding: "+Ge);Ge=(Ge+"").toLowerCase(),xe=!0}}R.prototype._isBuffer=!0;function Be(Ge,Ie,Se){const xe=Ge[Ie];Ge[Ie]=Ge[Se],Ge[Se]=xe}R.prototype.swap16=function(){const Ie=this.length;if(Ie%2!==0)throw new RangeError("Buffer size must be a multiple of 16-bits");for(let Se=0;Se<Ie;Se+=2)Be(this,Se,Se+1);return this},R.prototype.swap32=function(){const Ie=this.length;if(Ie%4!==0)throw new RangeError("Buffer size must be a multiple of 32-bits");for(let Se=0;Se<Ie;Se+=4)Be(this,Se,Se+3),Be(this,Se+1,Se+2);return this},R.prototype.swap64=function(){const Ie=this.length;if(Ie%8!==0)throw new RangeError("Buffer size must be a multiple of 64-bits");for(let Se=0;Se<Ie;Se+=8)Be(this,Se,Se+7),Be(this,Se+1,Se+6),Be(this,Se+2,Se+5),Be(this,Se+3,Se+4);return this},R.prototype.toString=function(){const Ie=this.length;return Ie===0?"":arguments.length===0?_t(this,0,Ie):ke.apply(this,arguments)},R.prototype.toLocaleString=R.prototype.toString,R.prototype.equals=function(Ie){if(!R.isBuffer(Ie))throw new TypeError("Argument must be a Buffer");return this===Ie?!0:R.compare(this,Ie)===0},R.prototype.inspect=function(){let Ie="";const Se=J.INSPECT_MAX_BYTES;return Ie=this.toString("hex",0,Se).replace(/(.{2})/g,"$1 ").trim(),this.length>Se&&(Ie+=" ... "),"<Buffer "+Ie+">"},ae&&(R.prototype[ae]=R.prototype.inspect),R.prototype.compare=function(Ie,Se,xe,Te,Me){if(Jt(Ie,Uint8Array)&&(Ie=R.from(Ie,Ie.offset,Ie.byteLength)),!R.isBuffer(Ie))throw new TypeError('The "target" argument must be one of type Buffer or Uint8Array. Received type '+typeof Ie);if(Se===void 0&&(Se=0),xe===void 0&&(xe=Ie?Ie.length:0),Te===void 0&&(Te=0),Me===void 0&&(Me=this.length),Se<0||xe>Ie.length||Te<0||Me>this.length)throw new RangeError("out of range index");if(Te>=Me&&Se>=xe)return 0;if(Te>=Me)return-1;if(Se>=xe)return 1;if(Se>>>=0,xe>>>=0,Te>>>=0,Me>>>=0,this===Ie)return 0;let ze=Me-Te,Qe=xe-Se;const tt=Math.min(ze,Qe),He=this.slice(Te,Me),Ze=Ie.slice(Se,xe);for(let st=0;st<tt;++st)if(He[st]!==Ze[st]){ze=He[st],Qe=Ze[st];break}return ze<Qe?-1:Qe<ze?1:0};function We(Ge,Ie,Se,xe,Te){if(Ge.length===0)return-1;if(typeof Se=="string"?(xe=Se,Se=0):Se>2147483647?Se=2147483647:Se<-2147483648&&(Se=-2147483648),Se=+Se,qr(Se)&&(Se=Te?0:Ge.length-1),Se<0&&(Se=Ge.length+Se),Se>=Ge.length){if(Te)return-1;Se=Ge.length-1}else if(Se<0)if(Te)Se=0;else return-1;if(typeof Ie=="string"&&(Ie=R.from(Ie,xe)),R.isBuffer(Ie))return Ie.length===0?-1:Je(Ge,Ie,Se,xe,Te);if(typeof Ie=="number")return Ie=Ie&255,typeof Uint8Array.prototype.indexOf=="function"?Te?Uint8Array.prototype.indexOf.call(Ge,Ie,Se):Uint8Array.prototype.lastIndexOf.call(Ge,Ie,Se):Je(Ge,[Ie],Se,xe,Te);throw new TypeError("val must be string, number or Buffer")}function Je(Ge,Ie,Se,xe,Te){let Me=1,ze=Ge.length,Qe=Ie.length;if(xe!==void 0&&(xe=String(xe).toLowerCase(),xe==="ucs2"||xe==="ucs-2"||xe==="utf16le"||xe==="utf-16le")){if(Ge.length<2||Ie.length<2)return-1;Me=2,ze/=2,Qe/=2,Se/=2}function tt(Ze,st){return Me===1?Ze[st]:Ze.readUInt16BE(st*Me)}let He;if(Te){let Ze=-1;for(He=Se;He<ze;He++)if(tt(Ge,He)===tt(Ie,Ze===-1?0:He-Ze)){if(Ze===-1&&(Ze=He),He-Ze+1===Qe)return Ze*Me}else Ze!==-1&&(He-=He-Ze),Ze=-1}else for(Se+Qe>ze&&(Se=ze-Qe),He=Se;He>=0;He--){let Ze=!0;for(let st=0;st<Qe;st++)if(tt(Ge,He+st)!==tt(Ie,st)){Ze=!1;break}if(Ze)return He}return-1}R.prototype.includes=function(Ie,Se,xe){return this.indexOf(Ie,Se,xe)!==-1},R.prototype.indexOf=function(Ie,Se,xe){return We(this,Ie,Se,xe,!0)},R.prototype.lastIndexOf=function(Ie,Se,xe){return We(this,Ie,Se,xe,!1)};function Ke(Ge,Ie,Se,xe){Se=Number(Se)||0;const Te=Ge.length-Se;xe?(xe=Number(xe),xe>Te&&(xe=Te)):xe=Te;const Me=Ie.length;xe>Me/2&&(xe=Me/2);let ze;for(ze=0;ze<xe;++ze){const Qe=parseInt(Ie.substr(ze*2,2),16);if(qr(Qe))return ze;Ge[Se+ze]=Qe}return ze}function et(Ge,Ie,Se,xe){return Yt(Sr(Ie,Ge.length-Se),Ge,Se,xe)}function it(Ge,Ie,Se,xe){return Yt(Nr(Ie),Ge,Se,xe)}function nt(Ge,Ie,Se,xe){return Yt(Lr(Ie),Ge,Se,xe)}function ct(Ge,Ie,Se,xe){return Yt(Dr(Ie,Ge.length-Se),Ge,Se,xe)}R.prototype.write=function(Ie,Se,xe,Te){if(Se===void 0)Te="utf8",xe=this.length,Se=0;else if(xe===void 0&&typeof Se=="string")Te=Se,xe=this.length,Se=0;else if(isFinite(Se))Se=Se>>>0,isFinite(xe)?(xe=xe>>>0,Te===void 0&&(Te="utf8")):(Te=xe,xe=void 0);else throw new Error("Buffer.write(string, encoding, offset[, length]) is no longer supported");const Me=this.length-Se;if((xe===void 0||xe>Me)&&(xe=Me),Ie.length>0&&(xe<0||Se<0)||Se>this.length)throw new RangeError("Attempt to write outside buffer bounds");Te||(Te="utf8");let ze=!1;for(;;)switch(Te){case"hex":return Ke(this,Ie,Se,xe);case"utf8":case"utf-8":return et(this,Ie,Se,xe);case"ascii":case"latin1":case"binary":return it(this,Ie,Se,xe);case"base64":return nt(this,Ie,Se,xe);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return ct(this,Ie,Se,xe);default:if(ze)throw new TypeError("Unknown encoding: "+Te);Te=(""+Te).toLowerCase(),ze=!0}},R.prototype.toJSON=function(){return{type:"Buffer",data:Array.prototype.slice.call(this._arr||this,0)}};function ft(Ge,Ie,Se){return Ie===0&&Se===Ge.length?Y.fromByteArray(Ge):Y.fromByteArray(Ge.slice(Ie,Se))}function _t(Ge,Ie,Se){Se=Math.min(Ge.length,Se);const xe=[];let Te=Ie;for(;Te<Se;){const Me=Ge[Te];let ze=null,Qe=Me>239?4:Me>223?3:Me>191?2:1;if(Te+Qe<=Se){let tt,He,Ze,st;switch(Qe){case 1:Me<128&&(ze=Me);break;case 2:tt=Ge[Te+1],(tt&192)===128&&(st=(Me&31)<<6|tt&63,st>127&&(ze=st));break;case 3:tt=Ge[Te+1],He=Ge[Te+2],(tt&192)===128&&(He&192)===128&&(st=(Me&15)<<12|(tt&63)<<6|He&63,st>2047&&(st<55296||st>57343)&&(ze=st));break;case 4:tt=Ge[Te+1],He=Ge[Te+2],Ze=Ge[Te+3],(tt&192)===128&&(He&192)===128&&(Ze&192)===128&&(st=(Me&15)<<18|(tt&63)<<12|(He&63)<<6|Ze&63,st>65535&&st<1114112&&(ze=st))}}ze===null?(ze=65533,Qe=1):ze>65535&&(ze-=65536,xe.push(ze>>>10&1023|55296),ze=56320|ze&1023),xe.push(ze),Te+=Qe}return Ft(xe)}const Rt=4096;function Ft(Ge){const Ie=Ge.length;if(Ie<=Rt)return String.fromCharCode.apply(String,Ge);let Se="",xe=0;for(;xe<Ie;)Se+=String.fromCharCode.apply(String,Ge.slice(xe,xe+=Rt));return Se}function ht(Ge,Ie,Se){let xe="";Se=Math.min(Ge.length,Se);for(let Te=Ie;Te<Se;++Te)xe+=String.fromCharCode(Ge[Te]&127);return xe}function St(Ge,Ie,Se){let xe="";Se=Math.min(Ge.length,Se);for(let Te=Ie;Te<Se;++Te)xe+=String.fromCharCode(Ge[Te]);return xe}function ut(Ge,Ie,Se){const xe=Ge.length;(!Ie||Ie<0)&&(Ie=0),(!Se||Se<0||Se>xe)&&(Se=xe);let Te="";for(let Me=Ie;Me<Se;++Me)Te+=nr[Ge[Me]];return Te}function Et(Ge,Ie,Se){const xe=Ge.slice(Ie,Se);let Te="";for(let Me=0;Me<xe.length-1;Me+=2)Te+=String.fromCharCode(xe[Me]+xe[Me+1]*256);return Te}R.prototype.slice=function(Ie,Se){const xe=this.length;Ie=~~Ie,Se=Se===void 0?xe:~~Se,Ie<0?(Ie+=xe,Ie<0&&(Ie=0)):Ie>xe&&(Ie=xe),Se<0?(Se+=xe,Se<0&&(Se=0)):Se>xe&&(Se=xe),Se<Ie&&(Se=Ie);const Te=this.subarray(Ie,Se);return Object.setPrototypeOf(Te,R.prototype),Te};function bt(Ge,Ie,Se){if(Ge%1!==0||Ge<0)throw new RangeError("offset is not uint");if(Ge+Ie>Se)throw new RangeError("Trying to access beyond buffer length")}R.prototype.readUintLE=R.prototype.readUIntLE=function(Ie,Se,xe){Ie=Ie>>>0,Se=Se>>>0,xe||bt(Ie,Se,this.length);let Te=this[Ie],Me=1,ze=0;for(;++ze<Se&&(Me*=256);)Te+=this[Ie+ze]*Me;return Te},R.prototype.readUintBE=R.prototype.readUIntBE=function(Ie,Se,xe){Ie=Ie>>>0,Se=Se>>>0,xe||bt(Ie,Se,this.length);let Te=this[Ie+--Se],Me=1;for(;Se>0&&(Me*=256);)Te+=this[Ie+--Se]*Me;return Te},R.prototype.readUint8=R.prototype.readUInt8=function(Ie,Se){return Ie=Ie>>>0,Se||bt(Ie,1,this.length),this[Ie]},R.prototype.readUint16LE=R.prototype.readUInt16LE=function(Ie,Se){return Ie=Ie>>>0,Se||bt(Ie,2,this.length),this[Ie]|this[Ie+1]<<8},R.prototype.readUint16BE=R.prototype.readUInt16BE=function(Ie,Se){return Ie=Ie>>>0,Se||bt(Ie,2,this.length),this[Ie]<<8|this[Ie+1]},R.prototype.readUint32LE=R.prototype.readUInt32LE=function(Ie,Se){return Ie=Ie>>>0,Se||bt(Ie,4,this.length),(this[Ie]|this[Ie+1]<<8|this[Ie+2]<<16)+this[Ie+3]*16777216},R.prototype.readUint32BE=R.prototype.readUInt32BE=function(Ie,Se){return Ie=Ie>>>0,Se||bt(Ie,4,this.length),this[Ie]*16777216+(this[Ie+1]<<16|this[Ie+2]<<8|this[Ie+3])},R.prototype.readBigUInt64LE=dr(function(Ie){Ie=Ie>>>0,gr(Ie,"offset");const Se=this[Ie],xe=this[Ie+7];(Se===void 0||xe===void 0)&&Mr(Ie,this.length-8);const Te=Se+this[++Ie]*2**8+this[++Ie]*2**16+this[++Ie]*2**24,Me=this[++Ie]+this[++Ie]*2**8+this[++Ie]*2**16+xe*2**24;return BigInt(Te)+(BigInt(Me)<<BigInt(32))}),R.prototype.readBigUInt64BE=dr(function(Ie){Ie=Ie>>>0,gr(Ie,"offset");const Se=this[Ie],xe=this[Ie+7];(Se===void 0||xe===void 0)&&Mr(Ie,this.length-8);const Te=Se*2**24+this[++Ie]*2**16+this[++Ie]*2**8+this[++Ie],Me=this[++Ie]*2**24+this[++Ie]*2**16+this[++Ie]*2**8+xe;return(BigInt(Te)<<BigInt(32))+BigInt(Me)}),R.prototype.readIntLE=function(Ie,Se,xe){Ie=Ie>>>0,Se=Se>>>0,xe||bt(Ie,Se,this.length);let Te=this[Ie],Me=1,ze=0;for(;++ze<Se&&(Me*=256);)Te+=this[Ie+ze]*Me;return Me*=128,Te>=Me&&(Te-=Math.pow(2,8*Se)),Te},R.prototype.readIntBE=function(Ie,Se,xe){Ie=Ie>>>0,Se=Se>>>0,xe||bt(Ie,Se,this.length);let Te=Se,Me=1,ze=this[Ie+--Te];for(;Te>0&&(Me*=256);)ze+=this[Ie+--Te]*Me;return Me*=128,ze>=Me&&(ze-=Math.pow(2,8*Se)),ze},R.prototype.readInt8=function(Ie,Se){return Ie=Ie>>>0,Se||bt(Ie,1,this.length),this[Ie]&128?(255-this[Ie]+1)*-1:this[Ie]},R.prototype.readInt16LE=function(Ie,Se){Ie=Ie>>>0,Se||bt(Ie,2,this.length);const xe=this[Ie]|this[Ie+1]<<8;return xe&32768?xe|4294901760:xe},R.prototype.readInt16BE=function(Ie,Se){Ie=Ie>>>0,Se||bt(Ie,2,this.length);const xe=this[Ie+1]|this[Ie]<<8;return xe&32768?xe|4294901760:xe},R.prototype.readInt32LE=function(Ie,Se){return Ie=Ie>>>0,Se||bt(Ie,4,this.length),this[Ie]|this[Ie+1]<<8|this[Ie+2]<<16|this[Ie+3]<<24},R.prototype.readInt32BE=function(Ie,Se){return Ie=Ie>>>0,Se||bt(Ie,4,this.length),this[Ie]<<24|this[Ie+1]<<16|this[Ie+2]<<8|this[Ie+3]},R.prototype.readBigInt64LE=dr(function(Ie){Ie=Ie>>>0,gr(Ie,"offset");const Se=this[Ie],xe=this[Ie+7];(Se===void 0||xe===void 0)&&Mr(Ie,this.length-8);const Te=this[Ie+4]+this[Ie+5]*2**8+this[Ie+6]*2**16+(xe<<24);return(BigInt(Te)<<BigInt(32))+BigInt(Se+this[++Ie]*2**8+this[++Ie]*2**16+this[++Ie]*2**24)}),R.prototype.readBigInt64BE=dr(function(Ie){Ie=Ie>>>0,gr(Ie,"offset");const Se=this[Ie],xe=this[Ie+7];(Se===void 0||xe===void 0)&&Mr(Ie,this.length-8);const Te=(Se<<24)+this[++Ie]*2**16+this[++Ie]*2**8+this[++Ie];return(BigInt(Te)<<BigInt(32))+BigInt(this[++Ie]*2**24+this[++Ie]*2**16+this[++Ie]*2**8+xe)}),R.prototype.readFloatLE=function(Ie,Se){return Ie=Ie>>>0,Se||bt(Ie,4,this.length),re.read(this,Ie,!0,23,4)},R.prototype.readFloatBE=function(Ie,Se){return Ie=Ie>>>0,Se||bt(Ie,4,this.length),re.read(this,Ie,!1,23,4)},R.prototype.readDoubleLE=function(Ie,Se){return Ie=Ie>>>0,Se||bt(Ie,8,this.length),re.read(this,Ie,!0,52,8)},R.prototype.readDoubleBE=function(Ie,Se){return Ie=Ie>>>0,Se||bt(Ie,8,this.length),re.read(this,Ie,!1,52,8)};function Dt(Ge,Ie,Se,xe,Te,Me){if(!R.isBuffer(Ge))throw new TypeError('"buffer" argument must be a Buffer instance');if(Ie>Te||Ie<Me)throw new RangeError('"value" argument is out of bounds');if(Se+xe>Ge.length)throw new RangeError("Index out of range")}R.prototype.writeUintLE=R.prototype.writeUIntLE=function(Ie,Se,xe,Te){if(Ie=+Ie,Se=Se>>>0,xe=xe>>>0,!Te){const Qe=Math.pow(2,8*xe)-1;Dt(this,Ie,Se,xe,Qe,0)}let Me=1,ze=0;for(this[Se]=Ie&255;++ze<xe&&(Me*=256);)this[Se+ze]=Ie/Me&255;return Se+xe},R.prototype.writeUintBE=R.prototype.writeUIntBE=function(Ie,Se,xe,Te){if(Ie=+Ie,Se=Se>>>0,xe=xe>>>0,!Te){const Qe=Math.pow(2,8*xe)-1;Dt(this,Ie,Se,xe,Qe,0)}let Me=xe-1,ze=1;for(this[Se+Me]=Ie&255;--Me>=0&&(ze*=256);)this[Se+Me]=Ie/ze&255;return Se+xe},R.prototype.writeUint8=R.prototype.writeUInt8=function(Ie,Se,xe){return Ie=+Ie,Se=Se>>>0,xe||Dt(this,Ie,Se,1,255,0),this[Se]=Ie&255,Se+1},R.prototype.writeUint16LE=R.prototype.writeUInt16LE=function(Ie,Se,xe){return Ie=+Ie,Se=Se>>>0,xe||Dt(this,Ie,Se,2,65535,0),this[Se]=Ie&255,this[Se+1]=Ie>>>8,Se+2},R.prototype.writeUint16BE=R.prototype.writeUInt16BE=function(Ie,Se,xe){return Ie=+Ie,Se=Se>>>0,xe||Dt(this,Ie,Se,2,65535,0),this[Se]=Ie>>>8,this[Se+1]=Ie&255,Se+2},R.prototype.writeUint32LE=R.prototype.writeUInt32LE=function(Ie,Se,xe){return Ie=+Ie,Se=Se>>>0,xe||Dt(this,Ie,Se,4,4294967295,0),this[Se+3]=Ie>>>24,this[Se+2]=Ie>>>16,this[Se+1]=Ie>>>8,this[Se]=Ie&255,Se+4},R.prototype.writeUint32BE=R.prototype.writeUInt32BE=function(Ie,Se,xe){return Ie=+Ie,Se=Se>>>0,xe||Dt(this,Ie,Se,4,4294967295,0),this[Se]=Ie>>>24,this[Se+1]=Ie>>>16,this[Se+2]=Ie>>>8,this[Se+3]=Ie&255,Se+4};function Ut(Ge,Ie,Se,xe,Te){br(Ie,xe,Te,Ge,Se,7);let Me=Number(Ie&BigInt(4294967295));Ge[Se++]=Me,Me=Me>>8,Ge[Se++]=Me,Me=Me>>8,Ge[Se++]=Me,Me=Me>>8,Ge[Se++]=Me;let ze=Number(Ie>>BigInt(32)&BigInt(4294967295));return Ge[Se++]=ze,ze=ze>>8,Ge[Se++]=ze,ze=ze>>8,Ge[Se++]=ze,ze=ze>>8,Ge[Se++]=ze,Se}function er(Ge,Ie,Se,xe,Te){br(Ie,xe,Te,Ge,Se,7);let Me=Number(Ie&BigInt(4294967295));Ge[Se+7]=Me,Me=Me>>8,Ge[Se+6]=Me,Me=Me>>8,Ge[Se+5]=Me,Me=Me>>8,Ge[Se+4]=Me;let ze=Number(Ie>>BigInt(32)&BigInt(4294967295));return Ge[Se+3]=ze,ze=ze>>8,Ge[Se+2]=ze,ze=ze>>8,Ge[Se+1]=ze,ze=ze>>8,Ge[Se]=ze,Se+8}R.prototype.writeBigUInt64LE=dr(function(Ie,Se=0){return Ut(this,Ie,Se,BigInt(0),BigInt("0xffffffffffffffff"))}),R.prototype.writeBigUInt64BE=dr(function(Ie,Se=0){return er(this,Ie,Se,BigInt(0),BigInt("0xffffffffffffffff"))}),R.prototype.writeIntLE=function(Ie,Se,xe,Te){if(Ie=+Ie,Se=Se>>>0,!Te){const tt=Math.pow(2,8*xe-1);Dt(this,Ie,Se,xe,tt-1,-tt)}let Me=0,ze=1,Qe=0;for(this[Se]=Ie&255;++Me<xe&&(ze*=256);)Ie<0&&Qe===0&&this[Se+Me-1]!==0&&(Qe=1),this[Se+Me]=(Ie/ze>>0)-Qe&255;return Se+xe},R.prototype.writeIntBE=function(Ie,Se,xe,Te){if(Ie=+Ie,Se=Se>>>0,!Te){const tt=Math.pow(2,8*xe-1);Dt(this,Ie,Se,xe,tt-1,-tt)}let Me=xe-1,ze=1,Qe=0;for(this[Se+Me]=Ie&255;--Me>=0&&(ze*=256);)Ie<0&&Qe===0&&this[Se+Me+1]!==0&&(Qe=1),this[Se+Me]=(Ie/ze>>0)-Qe&255;return Se+xe},R.prototype.writeInt8=function(Ie,Se,xe){return Ie=+Ie,Se=Se>>>0,xe||Dt(this,Ie,Se,1,127,-128),Ie<0&&(Ie=255+Ie+1),this[Se]=Ie&255,Se+1},R.prototype.writeInt16LE=function(Ie,Se,xe){return Ie=+Ie,Se=Se>>>0,xe||Dt(this,Ie,Se,2,32767,-32768),this[Se]=Ie&255,this[Se+1]=Ie>>>8,Se+2},R.prototype.writeInt16BE=function(Ie,Se,xe){return Ie=+Ie,Se=Se>>>0,xe||Dt(this,Ie,Se,2,32767,-32768),this[Se]=Ie>>>8,this[Se+1]=Ie&255,Se+2},R.prototype.writeInt32LE=function(Ie,Se,xe){return Ie=+Ie,Se=Se>>>0,xe||Dt(this,Ie,Se,4,2147483647,-2147483648),this[Se]=Ie&255,this[Se+1]=Ie>>>8,this[Se+2]=Ie>>>16,this[Se+3]=Ie>>>24,Se+4},R.prototype.writeInt32BE=function(Ie,Se,xe){return Ie=+Ie,Se=Se>>>0,xe||Dt(this,Ie,Se,4,2147483647,-2147483648),Ie<0&&(Ie=4294967295+Ie+1),this[Se]=Ie>>>24,this[Se+1]=Ie>>>16,this[Se+2]=Ie>>>8,this[Se+3]=Ie&255,Se+4},R.prototype.writeBigInt64LE=dr(function(Ie,Se=0){return Ut(this,Ie,Se,-BigInt("0x8000000000000000"),BigInt("0x7fffffffffffffff"))}),R.prototype.writeBigInt64BE=dr(function(Ie,Se=0){return er(this,Ie,Se,-BigInt("0x8000000000000000"),BigInt("0x7fffffffffffffff"))});function xr(Ge,Ie,Se,xe,Te,Me){if(Se+xe>Ge.length)throw new RangeError("Index out of range");if(Se<0)throw new RangeError("Index out of range")}function ur(Ge,Ie,Se,xe,Te){return Ie=+Ie,Se=Se>>>0,Te||xr(Ge,Ie,Se,4),re.write(Ge,Ie,Se,xe,23,4),Se+4}R.prototype.writeFloatLE=function(Ie,Se,xe){return ur(this,Ie,Se,!0,xe)},R.prototype.writeFloatBE=function(Ie,Se,xe){return ur(this,Ie,Se,!1,xe)};function yr(Ge,Ie,Se,xe,Te){return Ie=+Ie,Se=Se>>>0,Te||xr(Ge,Ie,Se,8),re.write(Ge,Ie,Se,xe,52,8),Se+8}R.prototype.writeDoubleLE=function(Ie,Se,xe){return yr(this,Ie,Se,!0,xe)},R.prototype.writeDoubleBE=function(Ie,Se,xe){return yr(this,Ie,Se,!1,xe)},R.prototype.copy=function(Ie,Se,xe,Te){if(!R.isBuffer(Ie))throw new TypeError("argument should be a Buffer");if(xe||(xe=0),!Te&&Te!==0&&(Te=this.length),Se>=Ie.length&&(Se=Ie.length),Se||(Se=0),Te>0&&Te<xe&&(Te=xe),Te===xe||Ie.length===0||this.length===0)return 0;if(Se<0)throw new RangeError("targetStart out of bounds");if(xe<0||xe>=this.length)throw new RangeError("Index out of range");if(Te<0)throw new RangeError("sourceEnd out of bounds");Te>this.length&&(Te=this.length),Ie.length-Se<Te-xe&&(Te=Ie.length-Se+xe);const Me=Te-xe;return this===Ie&&typeof Uint8Array.prototype.copyWithin=="function"?this.copyWithin(Se,xe,Te):Uint8Array.prototype.set.call(Ie,this.subarray(xe,Te),Se),Me},R.prototype.fill=function(Ie,Se,xe,Te){if(typeof Ie=="string"){if(typeof Se=="string"?(Te=Se,Se=0,xe=this.length):typeof xe=="string"&&(Te=xe,xe=this.length),Te!==void 0&&typeof Te!="string")throw new TypeError("encoding must be a string");if(typeof Te=="string"&&!R.isEncoding(Te))throw new TypeError("Unknown encoding: "+Te);if(Ie.length===1){const ze=Ie.charCodeAt(0);(Te==="utf8"&&ze<128||Te==="latin1")&&(Ie=ze)}}else typeof Ie=="number"?Ie=Ie&255:typeof Ie=="boolean"&&(Ie=Number(Ie));if(Se<0||this.length<Se||this.length<xe)throw new RangeError("Out of range index");if(xe<=Se)return this;Se=Se>>>0,xe=xe===void 0?this.length:xe>>>0,Ie||(Ie=0);let Me;if(typeof Ie=="number")for(Me=Se;Me<xe;++Me)this[Me]=Ie;else{const ze=R.isBuffer(Ie)?Ie:R.from(Ie,Te),Qe=ze.length;if(Qe===0)throw new TypeError('The value "'+Ie+'" is invalid for argument "value"');for(Me=0;Me<xe-Se;++Me)this[Me+Se]=ze[Me%Qe]}return this};const Wt={};function or(Ge,Ie,Se){Wt[Ge]=class extends Se{constructor(){super(),Object.defineProperty(this,"message",{value:Ie.apply(this,arguments),writable:!0,configurable:!0}),this.name=`${this.name} [${Ge}]`,this.stack,delete this.name}get code(){return Ge}set code(Te){Object.defineProperty(this,"code",{configurable:!0,enumerable:!0,value:Te,writable:!0})}toString(){return`${this.name} [${Ge}]: ${this.message}`}}}or("ERR_BUFFER_OUT_OF_BOUNDS",function(Ge){return Ge?`${Ge} is outside of buffer bounds`:"Attempt to access memory outside buffer bounds"},RangeError),or("ERR_INVALID_ARG_TYPE",function(Ge,Ie){return`The "${Ge}" argument must be of type number. Received type ${typeof Ie}`},TypeError),or("ERR_OUT_OF_RANGE",function(Ge,Ie,Se){let xe=`The value of "${Ge}" is out of range.`,Te=Se;return Number.isInteger(Se)&&Math.abs(Se)>2**32?Te=wr(String(Se)):typeof Se=="bigint"&&(Te=String(Se),(Se>BigInt(2)**BigInt(32)||Se<-(BigInt(2)**BigInt(32)))&&(Te=wr(Te)),Te+="n"),xe+=` It must be ${Ie}. Received ${Te}`,xe},RangeError);function wr(Ge){let Ie="",Se=Ge.length;const xe=Ge[0]==="-"?1:0;for(;Se>=xe+4;Se-=3)Ie=`_${Ge.slice(Se-3,Se)}${Ie}`;return`${Ge.slice(0,Se)}${Ie}`}function Ir(Ge,Ie,Se){gr(Ie,"offset"),(Ge[Ie]===void 0||Ge[Ie+Se]===void 0)&&Mr(Ie,Ge.length-(Se+1))}function br(Ge,Ie,Se,xe,Te,Me){if(Ge>Se||Ge<Ie){const ze=typeof Ie=="bigint"?"n":"";let Qe;throw Ie===0||Ie===BigInt(0)?Qe=`>= 0${ze} and < 2${ze} ** ${(Me+1)*8}${ze}`:Qe=`>= -(2${ze} ** ${(Me+1)*8-1}${ze}) and < 2 ** ${(Me+1)*8-1}${ze}`,new Wt.ERR_OUT_OF_RANGE("value",Qe,Ge)}Ir(xe,Te,Me)}function gr(Ge,Ie){if(typeof Ge!="number")throw new Wt.ERR_INVALID_ARG_TYPE(Ie,"number",Ge)}function Mr(Ge,Ie,Se){throw Math.floor(Ge)!==Ge?(gr(Ge,Se),new Wt.ERR_OUT_OF_RANGE("offset","an integer",Ge)):Ie<0?new Wt.ERR_BUFFER_OUT_OF_BOUNDS:new Wt.ERR_OUT_OF_RANGE("offset",`>= 0 and <= ${Ie}`,Ge)}const Hr=/[^+/0-9A-Za-z-_]/g;function jr(Ge){if(Ge=Ge.split("=")[0],Ge=Ge.trim().replace(Hr,""),Ge.length<2)return"";for(;Ge.length%4!==0;)Ge=Ge+"=";return Ge}function Sr(Ge,Ie){Ie=Ie||1/0;let Se;const xe=Ge.length;let Te=null;const Me=[];for(let ze=0;ze<xe;++ze){if(Se=Ge.charCodeAt(ze),Se>55295&&Se<57344){if(!Te){if(Se>56319){(Ie-=3)>-1&&Me.push(239,191,189);continue}else if(ze+1===xe){(Ie-=3)>-1&&Me.push(239,191,189);continue}Te=Se;continue}if(Se<56320){(Ie-=3)>-1&&Me.push(239,191,189),Te=Se;continue}Se=(Te-55296<<10|Se-56320)+65536}else Te&&(Ie-=3)>-1&&Me.push(239,191,189);if(Te=null,Se<128){if((Ie-=1)<0)break;Me.push(Se)}else if(Se<2048){if((Ie-=2)<0)break;Me.push(Se>>6|192,Se&63|128)}else if(Se<65536){if((Ie-=3)<0)break;Me.push(Se>>12|224,Se>>6&63|128,Se&63|128)}else if(Se<1114112){if((Ie-=4)<0)break;Me.push(Se>>18|240,Se>>12&63|128,Se>>6&63|128,Se&63|128)}else throw new Error("Invalid code point")}return Me}function Nr(Ge){const Ie=[];for(let Se=0;Se<Ge.length;++Se)Ie.push(Ge.charCodeAt(Se)&255);return Ie}function Dr(Ge,Ie){let Se,xe,Te;const Me=[];for(let ze=0;ze<Ge.length&&!((Ie-=2)<0);++ze)Se=Ge.charCodeAt(ze),xe=Se>>8,Te=Se%256,Me.push(Te),Me.push(xe);return Me}function Lr(Ge){return Y.toByteArray(jr(Ge))}function Yt(Ge,Ie,Se,xe){let Te;for(Te=0;Te<xe&&!(Te+Se>=Ie.length||Te>=Ge.length);++Te)Ie[Te+Se]=Ge[Te];return Te}function Jt(Ge,Ie){return Ge instanceof Ie||Ge!=null&&Ge.constructor!=null&&Ge.constructor.name!=null&&Ge.constructor.name===Ie.name}function qr(Ge){return Ge!==Ge}const nr=(function(){const Ge="0123456789abcdef",Ie=new Array(256);for(let Se=0;Se<16;++Se){const xe=Se*16;for(let Te=0;Te<16;++Te)Ie[xe+Te]=Ge[Se]+Ge[Te]}return Ie})();function dr(Ge){return typeof BigInt>"u"?mr:Ge}function mr(){throw new Error("BigInt not supported")}})(buffer)),buffer}var bufferExports=requireBuffer(),indexMinimal={},minimal$1={},aspromise,hasRequiredAspromise;function requireAspromise(){if(hasRequiredAspromise)return aspromise;hasRequiredAspromise=1,aspromise=J;function J(Y,re){for(var ae=new Array(arguments.length-1),ne=0,ce=2,ee=!0;ce<arguments.length;)ae[ne++]=arguments[ce++];return new Promise(function(U,K){ae[ne]=function(pe){if(ee)if(ee=!1,pe)K(pe);else{for(var _e=new Array(arguments.length-1),me=0;me<_e.length;)_e[me++]=arguments[me];U.apply(null,_e)}};try{Y.apply(re||null,ae)}catch(oe){ee&&(ee=!1,K(oe))}})}return aspromise}var base64={},hasRequiredBase64;function requireBase64(){return hasRequiredBase64||(hasRequiredBase64=1,(function(J){var Y=J;Y.length=function(R){var U=R.length;if(!U)return 0;for(var K=0;--U%4>1&&R.charAt(U)==="=";)++K;return Math.ceil(R.length*3)/4-K};for(var re=new Array(64),ae=new Array(123),ne=0;ne<64;)ae[re[ne]=ne<26?ne+65:ne<52?ne+71:ne<62?ne-4:ne-59|43]=ne++;Y.encode=function(R,U,K){for(var oe=null,pe=[],_e=0,me=0,we;U<K;){var Oe=R[U++];switch(me){case 0:pe[_e++]=re[Oe>>2],we=(Oe&3)<<4,me=1;break;case 1:pe[_e++]=re[we|Oe>>4],we=(Oe&15)<<2,me=2;break;case 2:pe[_e++]=re[we|Oe>>6],pe[_e++]=re[Oe&63],me=0;break}_e>8191&&((oe||(oe=[])).push(String.fromCharCode.apply(String,pe)),_e=0)}return me&&(pe[_e++]=re[we],pe[_e++]=61,me===1&&(pe[_e++]=61)),oe?(_e&&oe.push(String.fromCharCode.apply(String,pe.slice(0,_e))),oe.join("")):String.fromCharCode.apply(String,pe.slice(0,_e))};var ce="invalid encoding";Y.decode=function(R,U,K){for(var oe=K,pe=0,_e,me=0;me<R.length;){var we=R.charCodeAt(me++);if(we===61&&pe>1)break;if((we=ae[we])===void 0)throw Error(ce);switch(pe){case 0:_e=we,pe=1;break;case 1:U[K++]=_e<<2|(we&48)>>4,_e=we,pe=2;break;case 2:U[K++]=(_e&15)<<4|(we&60)>>2,_e=we,pe=3;break;case 3:U[K++]=(_e&3)<<6|we,pe=0;break}}if(pe===1)throw Error(ce);return K-oe},Y.test=function(R){return/^(?:[A-Za-z0-9+/]{4})*(?:[A-Za-z0-9+/]{2}==|[A-Za-z0-9+/]{3}=)?$/.test(R)}})(base64)),base64}var eventemitter,hasRequiredEventemitter;function requireEventemitter(){if(hasRequiredEventemitter)return eventemitter;hasRequiredEventemitter=1,eventemitter=J;function J(){this._listeners={}}return J.prototype.on=function(re,ae,ne){return(this._listeners[re]||(this._listeners[re]=[])).push({fn:ae,ctx:ne||this}),this},J.prototype.off=function(re,ae){if(re===void 0)this._listeners={};else if(ae===void 0)this._listeners[re]=[];else for(var ne=this._listeners[re],ce=0;ce<ne.length;)ne[ce].fn===ae?ne.splice(ce,1):++ce;return this},J.prototype.emit=function(re){var ae=this._listeners[re];if(ae){for(var ne=[],ce=1;ce<arguments.length;)ne.push(arguments[ce++]);for(ce=0;ce<ae.length;)ae[ce].fn.apply(ae[ce++].ctx,ne)}return this},eventemitter}var float,hasRequiredFloat;function requireFloat(){if(hasRequiredFloat)return float;hasRequiredFloat=1,float=J(J);function J(ce){return typeof Float32Array<"u"?(function(){var ee=new Float32Array([-0]),R=new Uint8Array(ee.buffer),U=R[3]===128;function K(me,we,Oe){ee[0]=me,we[Oe]=R[0],we[Oe+1]=R[1],we[Oe+2]=R[2],we[Oe+3]=R[3]}function oe(me,we,Oe){ee[0]=me,we[Oe]=R[3],we[Oe+1]=R[2],we[Oe+2]=R[1],we[Oe+3]=R[0]}ce.writeFloatLE=U?K:oe,ce.writeFloatBE=U?oe:K;function pe(me,we){return R[0]=me[we],R[1]=me[we+1],R[2]=me[we+2],R[3]=me[we+3],ee[0]}function _e(me,we){return R[3]=me[we],R[2]=me[we+1],R[1]=me[we+2],R[0]=me[we+3],ee[0]}ce.readFloatLE=U?pe:_e,ce.readFloatBE=U?_e:pe})():(function(){function ee(U,K,oe,pe){var _e=K<0?1:0;if(_e&&(K=-K),K===0)U(1/K>0?0:2147483648,oe,pe);else if(isNaN(K))U(2143289344,oe,pe);else if(K>34028234663852886e22)U((_e<<31|2139095040)>>>0,oe,pe);else if(K<11754943508222875e-54)U((_e<<31|Math.round(K/1401298464324817e-60))>>>0,oe,pe);else{var me=Math.floor(Math.log(K)/Math.LN2),we=Math.round(K*Math.pow(2,-me)*8388608)&8388607;U((_e<<31|me+127<<23|we)>>>0,oe,pe)}}ce.writeFloatLE=ee.bind(null,Y),ce.writeFloatBE=ee.bind(null,re);function R(U,K,oe){var pe=U(K,oe),_e=(pe>>31)*2+1,me=pe>>>23&255,we=pe&8388607;return me===255?we?NaN:_e*(1/0):me===0?_e*1401298464324817e-60*we:_e*Math.pow(2,me-150)*(we+8388608)}ce.readFloatLE=R.bind(null,ae),ce.readFloatBE=R.bind(null,ne)})(),typeof Float64Array<"u"?(function(){var ee=new Float64Array([-0]),R=new Uint8Array(ee.buffer),U=R[7]===128;function K(me,we,Oe){ee[0]=me,we[Oe]=R[0],we[Oe+1]=R[1],we[Oe+2]=R[2],we[Oe+3]=R[3],we[Oe+4]=R[4],we[Oe+5]=R[5],we[Oe+6]=R[6],we[Oe+7]=R[7]}function oe(me,we,Oe){ee[0]=me,we[Oe]=R[7],we[Oe+1]=R[6],we[Oe+2]=R[5],we[Oe+3]=R[4],we[Oe+4]=R[3],we[Oe+5]=R[2],we[Oe+6]=R[1],we[Oe+7]=R[0]}ce.writeDoubleLE=U?K:oe,ce.writeDoubleBE=U?oe:K;function pe(me,we){return R[0]=me[we],R[1]=me[we+1],R[2]=me[we+2],R[3]=me[we+3],R[4]=me[we+4],R[5]=me[we+5],R[6]=me[we+6],R[7]=me[we+7],ee[0]}function _e(me,we){return R[7]=me[we],R[6]=me[we+1],R[5]=me[we+2],R[4]=me[we+3],R[3]=me[we+4],R[2]=me[we+5],R[1]=me[we+6],R[0]=me[we+7],ee[0]}ce.readDoubleLE=U?pe:_e,ce.readDoubleBE=U?_e:pe})():(function(){function ee(U,K,oe,pe,_e,me){var we=pe<0?1:0;if(we&&(pe=-pe),pe===0)U(0,_e,me+K),U(1/pe>0?0:2147483648,_e,me+oe);else if(isNaN(pe))U(0,_e,me+K),U(2146959360,_e,me+oe);else if(pe>17976931348623157e292)U(0,_e,me+K),U((we<<31|2146435072)>>>0,_e,me+oe);else{var Oe;if(pe<22250738585072014e-324)Oe=pe/5e-324,U(Oe>>>0,_e,me+K),U((we<<31|Oe/4294967296)>>>0,_e,me+oe);else{var De=Math.floor(Math.log(pe)/Math.LN2);De===1024&&(De=1023),Oe=pe*Math.pow(2,-De),U(Oe*4503599627370496>>>0,_e,me+K),U((we<<31|De+1023<<20|Oe*1048576&1048575)>>>0,_e,me+oe)}}}ce.writeDoubleLE=ee.bind(null,Y,0,4),ce.writeDoubleBE=ee.bind(null,re,4,0);function R(U,K,oe,pe,_e){var me=U(pe,_e+K),we=U(pe,_e+oe),Oe=(we>>31)*2+1,De=we>>>20&2047,Ae=4294967296*(we&1048575)+me;return De===2047?Ae?NaN:Oe*(1/0):De===0?Oe*5e-324*Ae:Oe*Math.pow(2,De-1075)*(Ae+4503599627370496)}ce.readDoubleLE=R.bind(null,ae,0,4),ce.readDoubleBE=R.bind(null,ne,4,0)})(),ce}function Y(ce,ee,R){ee[R]=ce&255,ee[R+1]=ce>>>8&255,ee[R+2]=ce>>>16&255,ee[R+3]=ce>>>24}function re(ce,ee,R){ee[R]=ce>>>24,ee[R+1]=ce>>>16&255,ee[R+2]=ce>>>8&255,ee[R+3]=ce&255}function ae(ce,ee){return(ce[ee]|ce[ee+1]<<8|ce[ee+2]<<16|ce[ee+3]<<24)>>>0}function ne(ce,ee){return(ce[ee]<<24|ce[ee+1]<<16|ce[ee+2]<<8|ce[ee+3])>>>0}return float}var inquire_1,hasRequiredInquire;function requireInquire(){if(hasRequiredInquire)return inquire_1;hasRequiredInquire=1,inquire_1=inquire;function inquire(moduleName){try{var mod=eval("quire".replace(/^/,"re"))(moduleName);if(mod&&(mod.length||Object.keys(mod).length))return mod}catch(J){}return null}return inquire_1}var utf8={},hasRequiredUtf8;function requireUtf8(){return hasRequiredUtf8||(hasRequiredUtf8=1,(function(J){var Y=J;Y.length=function(ae){for(var ne=0,ce=0,ee=0;ee<ae.length;++ee)ce=ae.charCodeAt(ee),ce<128?ne+=1:ce<2048?ne+=2:(ce&64512)===55296&&(ae.charCodeAt(ee+1)&64512)===56320?(++ee,ne+=4):ne+=3;return ne},Y.read=function(ae,ne,ce){var ee=ce-ne;if(ee<1)return"";for(var R=null,U=[],K=0,oe;ne<ce;)oe=ae[ne++],oe<128?U[K++]=oe:oe>191&&oe<224?U[K++]=(oe&31)<<6|ae[ne++]&63:oe>239&&oe<365?(oe=((oe&7)<<18|(ae[ne++]&63)<<12|(ae[ne++]&63)<<6|ae[ne++]&63)-65536,U[K++]=55296+(oe>>10),U[K++]=56320+(oe&1023)):U[K++]=(oe&15)<<12|(ae[ne++]&63)<<6|ae[ne++]&63,K>8191&&((R||(R=[])).push(String.fromCharCode.apply(String,U)),K=0);return R?(K&&R.push(String.fromCharCode.apply(String,U.slice(0,K))),R.join("")):String.fromCharCode.apply(String,U.slice(0,K))},Y.write=function(ae,ne,ce){for(var ee=ce,R,U,K=0;K<ae.length;++K)R=ae.charCodeAt(K),R<128?ne[ce++]=R:R<2048?(ne[ce++]=R>>6|192,ne[ce++]=R&63|128):(R&64512)===55296&&((U=ae.charCodeAt(K+1))&64512)===56320?(R=65536+((R&1023)<<10)+(U&1023),++K,ne[ce++]=R>>18|240,ne[ce++]=R>>12&63|128,ne[ce++]=R>>6&63|128,ne[ce++]=R&63|128):(ne[ce++]=R>>12|224,ne[ce++]=R>>6&63|128,ne[ce++]=R&63|128);return ce-ee}})(utf8)),utf8}var pool_1,hasRequiredPool;function requirePool(){if(hasRequiredPool)return pool_1;hasRequiredPool=1,pool_1=J;function J(Y,re,ae){var ne=ae||8192,ce=ne>>>1,ee=null,R=ne;return function(K){if(K<1||K>ce)return Y(K);R+K>ne&&(ee=Y(ne),R=0);var oe=re.call(ee,R,R+=K);return R&7&&(R=(R|7)+1),oe}}return pool_1}var longbits,hasRequiredLongbits;function requireLongbits(){if(hasRequiredLongbits)return longbits;hasRequiredLongbits=1,longbits=Y;var J=requireMinimal$1();function Y(ce,ee){this.lo=ce>>>0,this.hi=ee>>>0}var re=Y.zero=new Y(0,0);re.toNumber=function(){return 0},re.zzEncode=re.zzDecode=function(){return this},re.length=function(){return 1};var ae=Y.zeroHash="\0\0\0\0\0\0\0\0";Y.fromNumber=function(ee){if(ee===0)return re;var R=ee<0;R&&(ee=-ee);var U=ee>>>0,K=(ee-U)/4294967296>>>0;return R&&(K=~K>>>0,U=~U>>>0,++U>4294967295&&(U=0,++K>4294967295&&(K=0))),new Y(U,K)},Y.from=function(ee){if(typeof ee=="number")return Y.fromNumber(ee);if(J.isString(ee))if(J.Long)ee=J.Long.fromString(ee);else return Y.fromNumber(parseInt(ee,10));return ee.low||ee.high?new Y(ee.low>>>0,ee.high>>>0):re},Y.prototype.toNumber=function(ee){if(!ee&&this.hi>>>31){var R=~this.lo+1>>>0,U=~this.hi>>>0;return R||(U=U+1>>>0),-(R+U*4294967296)}return this.lo+this.hi*4294967296},Y.prototype.toLong=function(ee){return J.Long?new J.Long(this.lo|0,this.hi|0,!!ee):{low:this.lo|0,high:this.hi|0,unsigned:!!ee}};var ne=String.prototype.charCodeAt;return Y.fromHash=function(ee){return ee===ae?re:new Y((ne.call(ee,0)|ne.call(ee,1)<<8|ne.call(ee,2)<<16|ne.call(ee,3)<<24)>>>0,(ne.call(ee,4)|ne.call(ee,5)<<8|ne.call(ee,6)<<16|ne.call(ee,7)<<24)>>>0)},Y.prototype.toHash=function(){return String.fromCharCode(this.lo&255,this.lo>>>8&255,this.lo>>>16&255,this.lo>>>24,this.hi&255,this.hi>>>8&255,this.hi>>>16&255,this.hi>>>24)},Y.prototype.zzEncode=function(){var ee=this.hi>>31;return this.hi=((this.hi<<1|this.lo>>>31)^ee)>>>0,this.lo=(this.lo<<1^ee)>>>0,this},Y.prototype.zzDecode=function(){var ee=-(this.lo&1);return this.lo=((this.lo>>>1|this.hi<<31)^ee)>>>0,this.hi=(this.hi>>>1^ee)>>>0,this},Y.prototype.length=function(){var ee=this.lo,R=(this.lo>>>28|this.hi<<4)>>>0,U=this.hi>>>24;return U===0?R===0?ee<16384?ee<128?1:2:ee<2097152?3:4:R<16384?R<128?5:6:R<2097152?7:8:U<128?9:10},longbits}var hasRequiredMinimal$1;function requireMinimal$1(){return hasRequiredMinimal$1||(hasRequiredMinimal$1=1,(function(J){var Y=J;Y.asPromise=requireAspromise(),Y.base64=requireBase64(),Y.EventEmitter=requireEventemitter(),Y.float=requireFloat(),Y.inquire=requireInquire(),Y.utf8=requireUtf8(),Y.pool=requirePool(),Y.LongBits=requireLongbits(),Y.isNode=!!(typeof commonjsGlobal<"u"&&commonjsGlobal&&commonjsGlobal.process&&commonjsGlobal.process.versions&&commonjsGlobal.process.versions.node),Y.global=Y.isNode&&commonjsGlobal||typeof window<"u"&&window||typeof self<"u"&&self||minimal$1,Y.emptyArray=Object.freeze?Object.freeze([]):[],Y.emptyObject=Object.freeze?Object.freeze({}):{},Y.isInteger=Number.isInteger||function(ce){return typeof ce=="number"&&isFinite(ce)&&Math.floor(ce)===ce},Y.isString=function(ce){return typeof ce=="string"||ce instanceof String},Y.isObject=function(ce){return ce&&typeof ce=="object"},Y.isset=Y.isSet=function(ce,ee){var R=ce[ee];return R!=null&&ce.hasOwnProperty(ee)?typeof R!="object"||(Array.isArray(R)?R.length:Object.keys(R).length)>0:!1},Y.Buffer=(function(){try{var ne=Y.inquire("buffer").Buffer;return ne.prototype.utf8Write?ne:null}catch{return null}})(),Y._Buffer_from=null,Y._Buffer_allocUnsafe=null,Y.newBuffer=function(ce){return typeof ce=="number"?Y.Buffer?Y._Buffer_allocUnsafe(ce):new Y.Array(ce):Y.Buffer?Y._Buffer_from(ce):typeof Uint8Array>"u"?ce:new Uint8Array(ce)},Y.Array=typeof Uint8Array<"u"?Uint8Array:Array,Y.Long=Y.global.dcodeIO&&Y.global.dcodeIO.Long||Y.global.Long||Y.inquire("long"),Y.key2Re=/^true|false|0|1$/,Y.key32Re=/^-?(?:0|[1-9][0-9]*)$/,Y.key64Re=/^(?:[\\x00-\\xff]{8}|-?(?:0|[1-9][0-9]*))$/,Y.longToHash=function(ce){return ce?Y.LongBits.from(ce).toHash():Y.LongBits.zeroHash},Y.longFromHash=function(ce,ee){var R=Y.LongBits.fromHash(ce);return Y.Long?Y.Long.fromBits(R.lo,R.hi,ee):R.toNumber(!!ee)};function re(ne,ce,ee){for(var R=Object.keys(ce),U=0;U<R.length;++U)(ne[R[U]]===void 0||!ee)&&(ne[R[U]]=ce[R[U]]);return ne}Y.merge=re,Y.lcFirst=function(ce){return ce.charAt(0).toLowerCase()+ce.substring(1)};function ae(ne){function ce(ee,R){if(!(this instanceof ce))return new ce(ee,R);Object.defineProperty(this,"message",{get:function(){return ee}}),Error.captureStackTrace?Error.captureStackTrace(this,ce):Object.defineProperty(this,"stack",{value:new Error().stack||""}),R&&re(this,R)}return ce.prototype=Object.create(Error.prototype,{constructor:{value:ce,writable:!0,enumerable:!1,configurable:!0},name:{get:function(){return ne},set:void 0,enumerable:!1,configurable:!0},toString:{value:function(){return this.name+": "+this.message},writable:!0,enumerable:!1,configurable:!0}}),ce}Y.newError=ae,Y.ProtocolError=ae("ProtocolError"),Y.oneOfGetter=function(ce){for(var ee={},R=0;R<ce.length;++R)ee[ce[R]]=1;return function(){for(var U=Object.keys(this),K=U.length-1;K>-1;--K)if(ee[U[K]]===1&&this[U[K]]!==void 0&&this[U[K]]!==null)return U[K]}},Y.oneOfSetter=function(ce){return function(ee){for(var R=0;R<ce.length;++R)ce[R]!==ee&&delete this[ce[R]]}},Y.toJSONOptions={longs:String,enums:String,bytes:String,json:!0},Y._configure=function(){var ne=Y.Buffer;if(!ne){Y._Buffer_from=Y._Buffer_allocUnsafe=null;return}Y._Buffer_from=ne.from!==Uint8Array.from&&ne.from||function(ee,R){return new ne(ee,R)},Y._Buffer_allocUnsafe=ne.allocUnsafe||function(ee){return new ne(ee)}}})(minimal$1)),minimal$1}var writer,hasRequiredWriter;function requireWriter(){if(hasRequiredWriter)return writer;hasRequiredWriter=1,writer=U;var J=requireMinimal$1(),Y,re=J.LongBits,ae=J.base64,ne=J.utf8;function ce(De,Ae,Ce){this.fn=De,this.len=Ae,this.next=void 0,this.val=Ce}function ee(){}function R(De){this.head=De.head,this.tail=De.tail,this.len=De.len,this.next=De.states}function U(){this.len=0,this.head=new ce(ee,0,0),this.tail=this.head,this.states=null}var K=function(){return J.Buffer?function(){return(U.create=function(){return new Y})()}:function(){return new U}};U.create=K(),U.alloc=function(Ae){return new J.Array(Ae)},J.Array!==Array&&(U.alloc=J.pool(U.alloc,J.Array.prototype.subarray)),U.prototype._push=function(Ae,Ce,je){return this.tail=this.tail.next=new ce(Ae,Ce,je),this.len+=Ce,this};function oe(De,Ae,Ce){Ae[Ce]=De&255}function pe(De,Ae,Ce){for(;De>127;)Ae[Ce++]=De&127|128,De>>>=7;Ae[Ce]=De}function _e(De,Ae){this.len=De,this.next=void 0,this.val=Ae}_e.prototype=Object.create(ce.prototype),_e.prototype.fn=pe,U.prototype.uint32=function(Ae){return this.len+=(this.tail=this.tail.next=new _e((Ae=Ae>>>0)<128?1:Ae<16384?2:Ae<2097152?3:Ae<268435456?4:5,Ae)).len,this},U.prototype.int32=function(Ae){return Ae<0?this._push(me,10,re.fromNumber(Ae)):this.uint32(Ae)},U.prototype.sint32=function(Ae){return this.uint32((Ae<<1^Ae>>31)>>>0)};function me(De,Ae,Ce){for(;De.hi;)Ae[Ce++]=De.lo&127|128,De.lo=(De.lo>>>7|De.hi<<25)>>>0,De.hi>>>=7;for(;De.lo>127;)Ae[Ce++]=De.lo&127|128,De.lo=De.lo>>>7;Ae[Ce++]=De.lo}U.prototype.uint64=function(Ae){var Ce=re.from(Ae);return this._push(me,Ce.length(),Ce)},U.prototype.int64=U.prototype.uint64,U.prototype.sint64=function(Ae){var Ce=re.from(Ae).zzEncode();return this._push(me,Ce.length(),Ce)},U.prototype.bool=function(Ae){return this._push(oe,1,Ae?1:0)};function we(De,Ae,Ce){Ae[Ce]=De&255,Ae[Ce+1]=De>>>8&255,Ae[Ce+2]=De>>>16&255,Ae[Ce+3]=De>>>24}U.prototype.fixed32=function(Ae){return this._push(we,4,Ae>>>0)},U.prototype.sfixed32=U.prototype.fixed32,U.prototype.fixed64=function(Ae){var Ce=re.from(Ae);return this._push(we,4,Ce.lo)._push(we,4,Ce.hi)},U.prototype.sfixed64=U.prototype.fixed64,U.prototype.float=function(Ae){return this._push(J.float.writeFloatLE,4,Ae)},U.prototype.double=function(Ae){return this._push(J.float.writeDoubleLE,8,Ae)};var Oe=J.Array.prototype.set?function(Ae,Ce,je){Ce.set(Ae,je)}:function(Ae,Ce,je){for(var ke=0;ke<Ae.length;++ke)Ce[je+ke]=Ae[ke]};return U.prototype.bytes=function(Ae){var Ce=Ae.length>>>0;if(!Ce)return this._push(oe,1,0);if(J.isString(Ae)){var je=U.alloc(Ce=ae.length(Ae));ae.decode(Ae,je,0),Ae=je}return this.uint32(Ce)._push(Oe,Ce,Ae)},U.prototype.string=function(Ae){var Ce=ne.length(Ae);return Ce?this.uint32(Ce)._push(ne.write,Ce,Ae):this._push(oe,1,0)},U.prototype.fork=function(){return this.states=new R(this),this.head=this.tail=new ce(ee,0,0),this.len=0,this},U.prototype.reset=function(){return this.states?(this.head=this.states.head,this.tail=this.states.tail,this.len=this.states.len,this.states=this.states.next):(this.head=this.tail=new ce(ee,0,0),this.len=0),this},U.prototype.ldelim=function(){var Ae=this.head,Ce=this.tail,je=this.len;return this.reset().uint32(je),je&&(this.tail.next=Ae.next,this.tail=Ce,this.len+=je),this},U.prototype.finish=function(){for(var Ae=this.head.next,Ce=this.constructor.alloc(this.len),je=0;Ae;)Ae.fn(Ae.val,Ce,je),je+=Ae.len,Ae=Ae.next;return Ce},U._configure=function(De){Y=De,U.create=K(),Y._configure()},writer}var writer_buffer,hasRequiredWriter_buffer;function requireWriter_buffer(){if(hasRequiredWriter_buffer)return writer_buffer;hasRequiredWriter_buffer=1,writer_buffer=re;var J=requireWriter();(re.prototype=Object.create(J.prototype)).constructor=re;var Y=requireMinimal$1();function re(){J.call(this)}re._configure=function(){re.alloc=Y._Buffer_allocUnsafe,re.writeBytesBuffer=Y.Buffer&&Y.Buffer.prototype instanceof Uint8Array&&Y.Buffer.prototype.set.name==="set"?function(ce,ee,R){ee.set(ce,R)}:function(ce,ee,R){if(ce.copy)ce.copy(ee,R,0,ce.length);else for(var U=0;U<ce.length;)ee[R++]=ce[U++]}},re.prototype.bytes=function(ce){Y.isString(ce)&&(ce=Y._Buffer_from(ce,"base64"));var ee=ce.length>>>0;return this.uint32(ee),ee&&this._push(re.writeBytesBuffer,ee,ce),this};function ae(ne,ce,ee){ne.length<40?Y.utf8.write(ne,ce,ee):ce.utf8Write?ce.utf8Write(ne,ee):ce.write(ne,ee)}return re.prototype.string=function(ce){var ee=Y.Buffer.byteLength(ce);return this.uint32(ee),ee&&this._push(ae,ee,ce),this},re._configure(),writer_buffer}var reader,hasRequiredReader;function requireReader(){if(hasRequiredReader)return reader;hasRequiredReader=1,reader=ce;var J=requireMinimal$1(),Y,re=J.LongBits,ae=J.utf8;function ne(pe,_e){return RangeError("index out of range: "+pe.pos+" + "+(_e||1)+" > "+pe.len)}function ce(pe){this.buf=pe,this.pos=0,this.len=pe.length}var ee=typeof Uint8Array<"u"?function(_e){if(_e instanceof Uint8Array||Array.isArray(_e))return new ce(_e);throw Error("illegal buffer")}:function(_e){if(Array.isArray(_e))return new ce(_e);throw Error("illegal buffer")},R=function(){return J.Buffer?function(me){return(ce.create=function(Oe){return J.Buffer.isBuffer(Oe)?new Y(Oe):ee(Oe)})(me)}:ee};ce.create=R(),ce.prototype._slice=J.Array.prototype.subarray||J.Array.prototype.slice,ce.prototype.uint32=(function(){var _e=4294967295;return function(){if(_e=(this.buf[this.pos]&127)>>>0,this.buf[this.pos++]<128||(_e=(_e|(this.buf[this.pos]&127)<<7)>>>0,this.buf[this.pos++]<128)||(_e=(_e|(this.buf[this.pos]&127)<<14)>>>0,this.buf[this.pos++]<128)||(_e=(_e|(this.buf[this.pos]&127)<<21)>>>0,this.buf[this.pos++]<128)||(_e=(_e|(this.buf[this.pos]&15)<<28)>>>0,this.buf[this.pos++]<128))return _e;if((this.pos+=5)>this.len)throw this.pos=this.len,ne(this,10);return _e}})(),ce.prototype.int32=function(){return this.uint32()|0},ce.prototype.sint32=function(){var _e=this.uint32();return _e>>>1^-(_e&1)|0};function U(){var pe=new re(0,0),_e=0;if(this.len-this.pos>4){for(;_e<4;++_e)if(pe.lo=(pe.lo|(this.buf[this.pos]&127)<<_e*7)>>>0,this.buf[this.pos++]<128)return pe;if(pe.lo=(pe.lo|(this.buf[this.pos]&127)<<28)>>>0,pe.hi=(pe.hi|(this.buf[this.pos]&127)>>4)>>>0,this.buf[this.pos++]<128)return pe;_e=0}else{for(;_e<3;++_e){if(this.pos>=this.len)throw ne(this);if(pe.lo=(pe.lo|(this.buf[this.pos]&127)<<_e*7)>>>0,this.buf[this.pos++]<128)return pe}return pe.lo=(pe.lo|(this.buf[this.pos++]&127)<<_e*7)>>>0,pe}if(this.len-this.pos>4){for(;_e<5;++_e)if(pe.hi=(pe.hi|(this.buf[this.pos]&127)<<_e*7+3)>>>0,this.buf[this.pos++]<128)return pe}else for(;_e<5;++_e){if(this.pos>=this.len)throw ne(this);if(pe.hi=(pe.hi|(this.buf[this.pos]&127)<<_e*7+3)>>>0,this.buf[this.pos++]<128)return pe}throw Error("invalid varint encoding")}ce.prototype.bool=function(){return this.uint32()!==0};function K(pe,_e){return(pe[_e-4]|pe[_e-3]<<8|pe[_e-2]<<16|pe[_e-1]<<24)>>>0}ce.prototype.fixed32=function(){if(this.pos+4>this.len)throw ne(this,4);return K(this.buf,this.pos+=4)},ce.prototype.sfixed32=function(){if(this.pos+4>this.len)throw ne(this,4);return K(this.buf,this.pos+=4)|0};function oe(){if(this.pos+8>this.len)throw ne(this,8);return new re(K(this.buf,this.pos+=4),K(this.buf,this.pos+=4))}return ce.prototype.float=function(){if(this.pos+4>this.len)throw ne(this,4);var _e=J.float.readFloatLE(this.buf,this.pos);return this.pos+=4,_e},ce.prototype.double=function(){if(this.pos+8>this.len)throw ne(this,4);var _e=J.float.readDoubleLE(this.buf,this.pos);return this.pos+=8,_e},ce.prototype.bytes=function(){var _e=this.uint32(),me=this.pos,we=this.pos+_e;if(we>this.len)throw ne(this,_e);if(this.pos+=_e,Array.isArray(this.buf))return this.buf.slice(me,we);if(me===we){var Oe=J.Buffer;return Oe?Oe.alloc(0):new this.buf.constructor(0)}return this._slice.call(this.buf,me,we)},ce.prototype.string=function(){var _e=this.bytes();return ae.read(_e,0,_e.length)},ce.prototype.skip=function(_e){if(typeof _e=="number"){if(this.pos+_e>this.len)throw ne(this,_e);this.pos+=_e}else do if(this.pos>=this.len)throw ne(this);while(this.buf[this.pos++]&128);return this},ce.prototype.skipType=function(pe){switch(pe){case 0:this.skip();break;case 1:this.skip(8);break;case 2:this.skip(this.uint32());break;case 3:for(;(pe=this.uint32()&7)!==4;)this.skipType(pe);break;case 5:this.skip(4);break;default:throw Error("invalid wire type "+pe+" at offset "+this.pos)}return this},ce._configure=function(pe){Y=pe,ce.create=R(),Y._configure();var _e=J.Long?"toLong":"toNumber";J.merge(ce.prototype,{int64:function(){return U.call(this)[_e](!1)},uint64:function(){return U.call(this)[_e](!0)},sint64:function(){return U.call(this).zzDecode()[_e](!1)},fixed64:function(){return oe.call(this)[_e](!0)},sfixed64:function(){return oe.call(this)[_e](!1)}})},reader}var reader_buffer,hasRequiredReader_buffer;function requireReader_buffer(){if(hasRequiredReader_buffer)return reader_buffer;hasRequiredReader_buffer=1,reader_buffer=re;var J=requireReader();(re.prototype=Object.create(J.prototype)).constructor=re;var Y=requireMinimal$1();function re(ae){J.call(this,ae)}return re._configure=function(){Y.Buffer&&(re.prototype._slice=Y.Buffer.prototype.slice)},re.prototype.string=function(){var ne=this.uint32();return this.buf.utf8Slice?this.buf.utf8Slice(this.pos,this.pos=Math.min(this.pos+ne,this.len)):this.buf.toString("utf-8",this.pos,this.pos=Math.min(this.pos+ne,this.len))},re._configure(),reader_buffer}var rpc={},service,hasRequiredService;function requireService(){if(hasRequiredService)return service;hasRequiredService=1,service=Y;var J=requireMinimal$1();(Y.prototype=Object.create(J.EventEmitter.prototype)).constructor=Y;function Y(re,ae,ne){if(typeof re!="function")throw TypeError("rpcImpl must be a function");J.EventEmitter.call(this),this.rpcImpl=re,this.requestDelimited=!!ae,this.responseDelimited=!!ne}return Y.prototype.rpcCall=function re(ae,ne,ce,ee,R){if(!ee)throw TypeError("request must be specified");var U=this;if(!R)return J.asPromise(re,U,ae,ne,ce,ee);if(!U.rpcImpl){setTimeout(function(){R(Error("already ended"))},0);return}try{return U.rpcImpl(ae,ne[U.requestDelimited?"encodeDelimited":"encode"](ee).finish(),function(oe,pe){if(oe)return U.emit("error",oe,ae),R(oe);if(pe===null){U.end(!0);return}if(!(pe instanceof ce))try{pe=ce[U.responseDelimited?"decodeDelimited":"decode"](pe)}catch(_e){return U.emit("error",_e,ae),R(_e)}return U.emit("data",pe,ae),R(null,pe)})}catch(K){U.emit("error",K,ae),setTimeout(function(){R(K)},0);return}},Y.prototype.end=function(ae){return this.rpcImpl&&(ae||this.rpcImpl(null,null,null),this.rpcImpl=null,this.emit("end").off()),this},service}var hasRequiredRpc;function requireRpc(){return hasRequiredRpc||(hasRequiredRpc=1,(function(J){var Y=J;Y.Service=requireService()})(rpc)),rpc}var roots,hasRequiredRoots;function requireRoots(){return hasRequiredRoots||(hasRequiredRoots=1,roots={}),roots}var hasRequiredIndexMinimal;function requireIndexMinimal(){return hasRequiredIndexMinimal||(hasRequiredIndexMinimal=1,(function(J){var Y=J;Y.build="minimal",Y.Writer=requireWriter(),Y.BufferWriter=requireWriter_buffer(),Y.Reader=requireReader(),Y.BufferReader=requireReader_buffer(),Y.util=requireMinimal$1(),Y.rpc=requireRpc(),Y.roots=requireRoots(),Y.configure=re;function re(){Y.util._configure(),Y.Writer._configure(Y.BufferWriter),Y.Reader._configure(Y.BufferReader)}re()})(indexMinimal)),indexMinimal}var minimal,hasRequiredMinimal;function requireMinimal(){return hasRequiredMinimal||(hasRequiredMinimal=1,minimal=requireIndexMinimal()),minimal}var gtfsRealtime_pbf,hasRequiredGtfsRealtime_pbf;function requireGtfsRealtime_pbf(){if(hasRequiredGtfsRealtime_pbf)return gtfsRealtime_pbf;hasRequiredGtfsRealtime_pbf=1;var J=requireMinimal(),Y=J.Reader,re=J.Writer,ae=J.util,ne=J.roots.default||(J.roots.default={});return ne.transit_realtime=(function(){var ce={};return ce.FeedMessage=(function(){function ee(R){if(this.entity=[],R)for(var U=Object.keys(R),K=0;K<U.length;++K)R[U[K]]!=null&&(this[U[K]]=R[U[K]])}return ee.prototype.header=null,ee.prototype.entity=ae.emptyArray,ee.create=function(U){return new ee(U)},ee.encode=function(U,K){if(K||(K=re.create()),ne.transit_realtime.FeedHeader.encode(U.header,K.uint32(10).fork()).ldelim(),U.entity!=null&&U.entity.length)for(var oe=0;oe<U.entity.length;++oe)ne.transit_realtime.FeedEntity.encode(U.entity[oe],K.uint32(18).fork()).ldelim();return K},ee.encodeDelimited=function(U,K){return this.encode(U,K).ldelim()},ee.decode=function(U,K,oe){U instanceof Y||(U=Y.create(U));for(var pe=K===void 0?U.len:U.pos+K,_e=new ne.transit_realtime.FeedMessage;U.pos<pe;){var me=U.uint32();if(me===oe)break;switch(me>>>3){case 1:{_e.header=ne.transit_realtime.FeedHeader.decode(U,U.uint32());break}case 2:{_e.entity&&_e.entity.length||(_e.entity=[]),_e.entity.push(ne.transit_realtime.FeedEntity.decode(U,U.uint32()));break}default:U.skipType(me&7);break}}if(!_e.hasOwnProperty("header"))throw ae.ProtocolError("missing required 'header'",{instance:_e});return _e},ee.decodeDelimited=function(U){return U instanceof Y||(U=new Y(U)),this.decode(U,U.uint32())},ee.verify=function(U){if(typeof U!="object"||U===null)return"object expected";{var K=ne.transit_realtime.FeedHeader.verify(U.header);if(K)return"header."+K}if(U.entity!=null&&U.hasOwnProperty("entity")){if(!Array.isArray(U.entity))return"entity: array expected";for(var oe=0;oe<U.entity.length;++oe){var K=ne.transit_realtime.FeedEntity.verify(U.entity[oe]);if(K)return"entity."+K}}return null},ee.fromObject=function(U){if(U instanceof ne.transit_realtime.FeedMessage)return U;var K=new ne.transit_realtime.FeedMessage;if(U.header!=null){if(typeof U.header!="object")throw TypeError(".transit_realtime.FeedMessage.header: object expected");K.header=ne.transit_realtime.FeedHeader.fromObject(U.header)}if(U.entity){if(!Array.isArray(U.entity))throw TypeError(".transit_realtime.FeedMessage.entity: array expected");K.entity=[];for(var oe=0;oe<U.entity.length;++oe){if(typeof U.entity[oe]!="object")throw TypeError(".transit_realtime.FeedMessage.entity: object expected");K.entity[oe]=ne.transit_realtime.FeedEntity.fromObject(U.entity[oe])}}return K},ee.toObject=function(U,K){K||(K={});var oe={};if((K.arrays||K.defaults)&&(oe.entity=[]),K.defaults&&(oe.header=null),U.header!=null&&U.hasOwnProperty("header")&&(oe.header=ne.transit_realtime.FeedHeader.toObject(U.header,K)),U.entity&&U.entity.length){oe.entity=[];for(var pe=0;pe<U.entity.length;++pe)oe.entity[pe]=ne.transit_realtime.FeedEntity.toObject(U.entity[pe],K)}return oe},ee.prototype.toJSON=function(){return this.constructor.toObject(this,J.util.toJSONOptions)},ee.getTypeUrl=function(U){return U===void 0&&(U="type.googleapis.com"),U+"/transit_realtime.FeedMessage"},ee})(),ce.FeedHeader=(function(){function ee(R){if(R)for(var U=Object.keys(R),K=0;K<U.length;++K)R[U[K]]!=null&&(this[U[K]]=R[U[K]])}return ee.prototype.gtfs_realtime_version="",ee.prototype.incrementality=0,ee.prototype.timestamp=ae.Long?ae.Long.fromBits(0,0,!0):0,ee.prototype.feed_version="",ee.create=function(U){return new ee(U)},ee.encode=function(U,K){return K||(K=re.create()),K.uint32(10).string(U.gtfs_realtime_version),U.incrementality!=null&&Object.hasOwnProperty.call(U,"incrementality")&&K.uint32(16).int32(U.incrementality),U.timestamp!=null&&Object.hasOwnProperty.call(U,"timestamp")&&K.uint32(24).uint64(U.timestamp),U.feed_version!=null&&Object.hasOwnProperty.call(U,"feed_version")&&K.uint32(34).string(U.feed_version),K},ee.encodeDelimited=function(U,K){return this.encode(U,K).ldelim()},ee.decode=function(U,K,oe){U instanceof Y||(U=Y.create(U));for(var pe=K===void 0?U.len:U.pos+K,_e=new ne.transit_realtime.FeedHeader;U.pos<pe;){var me=U.uint32();if(me===oe)break;switch(me>>>3){case 1:{_e.gtfs_realtime_version=U.string();break}case 2:{_e.incrementality=U.int32();break}case 3:{_e.timestamp=U.uint64();break}case 4:{_e.feed_version=U.string();break}default:U.skipType(me&7);break}}if(!_e.hasOwnProperty("gtfs_realtime_version"))throw ae.ProtocolError("missing required 'gtfs_realtime_version'",{instance:_e});return _e},ee.decodeDelimited=function(U){return U instanceof Y||(U=new Y(U)),this.decode(U,U.uint32())},ee.verify=function(U){if(typeof U!="object"||U===null)return"object expected";if(!ae.isString(U.gtfs_realtime_version))return"gtfs_realtime_version: string expected";if(U.incrementality!=null&&U.hasOwnProperty("incrementality"))switch(U.incrementality){default:return"incrementality: enum value expected";case 0:case 1:break}return U.timestamp!=null&&U.hasOwnProperty("timestamp")&&!ae.isInteger(U.timestamp)&&!(U.timestamp&&ae.isInteger(U.timestamp.low)&&ae.isInteger(U.timestamp.high))?"timestamp: integer|Long expected":U.feed_version!=null&&U.hasOwnProperty("feed_version")&&!ae.isString(U.feed_version)?"feed_version: string expected":null},ee.fromObject=function(U){if(U instanceof ne.transit_realtime.FeedHeader)return U;var K=new ne.transit_realtime.FeedHeader;switch(U.gtfs_realtime_version!=null&&(K.gtfs_realtime_version=String(U.gtfs_realtime_version)),U.incrementality){default:if(typeof U.incrementality=="number"){K.incrementality=U.incrementality;break}break;case"FULL_DATASET":case 0:K.incrementality=0;break;case"DIFFERENTIAL":case 1:K.incrementality=1;break}return U.timestamp!=null&&(ae.Long?(K.timestamp=ae.Long.fromValue(U.timestamp)).unsigned=!0:typeof U.timestamp=="string"?K.timestamp=parseInt(U.timestamp,10):typeof U.timestamp=="number"?K.timestamp=U.timestamp:typeof U.timestamp=="object"&&(K.timestamp=new ae.LongBits(U.timestamp.low>>>0,U.timestamp.high>>>0).toNumber(!0))),U.feed_version!=null&&(K.feed_version=String(U.feed_version)),K},ee.toObject=function(U,K){K||(K={});var oe={};if(K.defaults){if(oe.gtfs_realtime_version="",oe.incrementality=K.enums===String?"FULL_DATASET":0,ae.Long){var pe=new ae.Long(0,0,!0);oe.timestamp=K.longs===String?pe.toString():K.longs===Number?pe.toNumber():pe}else oe.timestamp=K.longs===String?"0":0;oe.feed_version=""}return U.gtfs_realtime_version!=null&&U.hasOwnProperty("gtfs_realtime_version")&&(oe.gtfs_realtime_version=U.gtfs_realtime_version),U.incrementality!=null&&U.hasOwnProperty("incrementality")&&(oe.incrementality=K.enums===String?ne.transit_realtime.FeedHeader.Incrementality[U.incrementality]===void 0?U.incrementality:ne.transit_realtime.FeedHeader.Incrementality[U.incrementality]:U.incrementality),U.timestamp!=null&&U.hasOwnProperty("timestamp")&&(typeof U.timestamp=="number"?oe.timestamp=K.longs===String?String(U.timestamp):U.timestamp:oe.timestamp=K.longs===String?ae.Long.prototype.toString.call(U.timestamp):K.longs===Number?new ae.LongBits(U.timestamp.low>>>0,U.timestamp.high>>>0).toNumber(!0):U.timestamp),U.feed_version!=null&&U.hasOwnProperty("feed_version")&&(oe.feed_version=U.feed_version),oe},ee.prototype.toJSON=function(){return this.constructor.toObject(this,J.util.toJSONOptions)},ee.getTypeUrl=function(U){return U===void 0&&(U="type.googleapis.com"),U+"/transit_realtime.FeedHeader"},ee.Incrementality=(function(){var R={},U=Object.create(R);return U[R[0]="FULL_DATASET"]=0,U[R[1]="DIFFERENTIAL"]=1,U})(),ee})(),ce.FeedEntity=(function(){function ee(R){if(R)for(var U=Object.keys(R),K=0;K<U.length;++K)R[U[K]]!=null&&(this[U[K]]=R[U[K]])}return ee.prototype.id="",ee.prototype.is_deleted=!1,ee.prototype.trip_update=null,ee.prototype.vehicle=null,ee.prototype.alert=null,ee.prototype.shape=null,ee.prototype.stop=null,ee.prototype.trip_modifications=null,ee.create=function(U){return new ee(U)},ee.encode=function(U,K){return K||(K=re.create()),K.uint32(10).string(U.id),U.is_deleted!=null&&Object.hasOwnProperty.call(U,"is_deleted")&&K.uint32(16).bool(U.is_deleted),U.trip_update!=null&&Object.hasOwnProperty.call(U,"trip_update")&&ne.transit_realtime.TripUpdate.encode(U.trip_update,K.uint32(26).fork()).ldelim(),U.vehicle!=null&&Object.hasOwnProperty.call(U,"vehicle")&&ne.transit_realtime.VehiclePosition.encode(U.vehicle,K.uint32(34).fork()).ldelim(),U.alert!=null&&Object.hasOwnProperty.call(U,"alert")&&ne.transit_realtime.Alert.encode(U.alert,K.uint32(42).fork()).ldelim(),U.shape!=null&&Object.hasOwnProperty.call(U,"shape")&&ne.transit_realtime.Shape.encode(U.shape,K.uint32(50).fork()).ldelim(),U.stop!=null&&Object.hasOwnProperty.call(U,"stop")&&ne.transit_realtime.Stop.encode(U.stop,K.uint32(58).fork()).ldelim(),U.trip_modifications!=null&&Object.hasOwnProperty.call(U,"trip_modifications")&&ne.transit_realtime.TripModifications.encode(U.trip_modifications,K.uint32(66).fork()).ldelim(),K},ee.encodeDelimited=function(U,K){return this.encode(U,K).ldelim()},ee.decode=function(U,K,oe){U instanceof Y||(U=Y.create(U));for(var pe=K===void 0?U.len:U.pos+K,_e=new ne.transit_realtime.FeedEntity;U.pos<pe;){var me=U.uint32();if(me===oe)break;switch(me>>>3){case 1:{_e.id=U.string();break}case 2:{_e.is_deleted=U.bool();break}case 3:{_e.trip_update=ne.transit_realtime.TripUpdate.decode(U,U.uint32());break}case 4:{_e.vehicle=ne.transit_realtime.VehiclePosition.decode(U,U.uint32());break}case 5:{_e.alert=ne.transit_realtime.Alert.decode(U,U.uint32());break}case 6:{_e.shape=ne.transit_realtime.Shape.decode(U,U.uint32());break}case 7:{_e.stop=ne.transit_realtime.Stop.decode(U,U.uint32());break}case 8:{_e.trip_modifications=ne.transit_realtime.TripModifications.decode(U,U.uint32());break}default:U.skipType(me&7);break}}if(!_e.hasOwnProperty("id"))throw ae.ProtocolError("missing required 'id'",{instance:_e});return _e},ee.decodeDelimited=function(U){return U instanceof Y||(U=new Y(U)),this.decode(U,U.uint32())},ee.verify=function(U){if(typeof U!="object"||U===null)return"object expected";if(!ae.isString(U.id))return"id: string expected";if(U.is_deleted!=null&&U.hasOwnProperty("is_deleted")&&typeof U.is_deleted!="boolean")return"is_deleted: boolean expected";if(U.trip_update!=null&&U.hasOwnProperty("trip_update")){var K=ne.transit_realtime.TripUpdate.verify(U.trip_update);if(K)return"trip_update."+K}if(U.vehicle!=null&&U.hasOwnProperty("vehicle")){var K=ne.transit_realtime.VehiclePosition.verify(U.vehicle);if(K)return"vehicle."+K}if(U.alert!=null&&U.hasOwnProperty("alert")){var K=ne.transit_realtime.Alert.verify(U.alert);if(K)return"alert."+K}if(U.shape!=null&&U.hasOwnProperty("shape")){var K=ne.transit_realtime.Shape.verify(U.shape);if(K)return"shape."+K}if(U.stop!=null&&U.hasOwnProperty("stop")){var K=ne.transit_realtime.Stop.verify(U.stop);if(K)return"stop."+K}if(U.trip_modifications!=null&&U.hasOwnProperty("trip_modifications")){var K=ne.transit_realtime.TripModifications.verify(U.trip_modifications);if(K)return"trip_modifications."+K}return null},ee.fromObject=function(U){if(U instanceof ne.transit_realtime.FeedEntity)return U;var K=new ne.transit_realtime.FeedEntity;if(U.id!=null&&(K.id=String(U.id)),U.is_deleted!=null&&(K.is_deleted=!!U.is_deleted),U.trip_update!=null){if(typeof U.trip_update!="object")throw TypeError(".transit_realtime.FeedEntity.trip_update: object expected");K.trip_update=ne.transit_realtime.TripUpdate.fromObject(U.trip_update)}if(U.vehicle!=null){if(typeof U.vehicle!="object")throw TypeError(".transit_realtime.FeedEntity.vehicle: object expected");K.vehicle=ne.transit_realtime.VehiclePosition.fromObject(U.vehicle)}if(U.alert!=null){if(typeof U.alert!="object")throw TypeError(".transit_realtime.FeedEntity.alert: object expected");K.alert=ne.transit_realtime.Alert.fromObject(U.alert)}if(U.shape!=null){if(typeof U.shape!="object")throw TypeError(".transit_realtime.FeedEntity.shape: object expected");K.shape=ne.transit_realtime.Shape.fromObject(U.shape)}if(U.stop!=null){if(typeof U.stop!="object")throw TypeError(".transit_realtime.FeedEntity.stop: object expected");K.stop=ne.transit_realtime.Stop.fromObject(U.stop)}if(U.trip_modifications!=null){if(typeof U.trip_modifications!="object")throw TypeError(".transit_realtime.FeedEntity.trip_modifications: object expected");K.trip_modifications=ne.transit_realtime.TripModifications.fromObject(U.trip_modifications)}return K},ee.toObject=function(U,K){K||(K={});var oe={};return K.defaults&&(oe.id="",oe.is_deleted=!1,oe.trip_update=null,oe.vehicle=null,oe.alert=null,oe.shape=null,oe.stop=null,oe.trip_modifications=null),U.id!=null&&U.hasOwnProperty("id")&&(oe.id=U.id),U.is_deleted!=null&&U.hasOwnProperty("is_deleted")&&(oe.is_deleted=U.is_deleted),U.trip_update!=null&&U.hasOwnProperty("trip_update")&&(oe.trip_update=ne.transit_realtime.TripUpdate.toObject(U.trip_update,K)),U.vehicle!=null&&U.hasOwnProperty("vehicle")&&(oe.vehicle=ne.transit_realtime.VehiclePosition.toObject(U.vehicle,K)),U.alert!=null&&U.hasOwnProperty("alert")&&(oe.alert=ne.transit_realtime.Alert.toObject(U.alert,K)),U.shape!=null&&U.hasOwnProperty("shape")&&(oe.shape=ne.transit_realtime.Shape.toObject(U.shape,K)),U.stop!=null&&U.hasOwnProperty("stop")&&(oe.stop=ne.transit_realtime.Stop.toObject(U.stop,K)),U.trip_modifications!=null&&U.hasOwnProperty("trip_modifications")&&(oe.trip_modifications=ne.transit_realtime.TripModifications.toObject(U.trip_modifications,K)),oe},ee.prototype.toJSON=function(){return this.constructor.toObject(this,J.util.toJSONOptions)},ee.getTypeUrl=function(U){return U===void 0&&(U="type.googleapis.com"),U+"/transit_realtime.FeedEntity"},ee})(),ce.TripUpdate=(function(){function ee(R){if(this.stop_time_update=[],R)for(var U=Object.keys(R),K=0;K<U.length;++K)R[U[K]]!=null&&(this[U[K]]=R[U[K]])}return ee.prototype.trip=null,ee.prototype.vehicle=null,ee.prototype.stop_time_update=ae.emptyArray,ee.prototype.timestamp=ae.Long?ae.Long.fromBits(0,0,!0):0,ee.prototype.delay=0,ee.prototype.trip_properties=null,ee.create=function(U){return new ee(U)},ee.encode=function(U,K){if(K||(K=re.create()),ne.transit_realtime.TripDescriptor.encode(U.trip,K.uint32(10).fork()).ldelim(),U.stop_time_update!=null&&U.stop_time_update.length)for(var oe=0;oe<U.stop_time_update.length;++oe)ne.transit_realtime.TripUpdate.StopTimeUpdate.encode(U.stop_time_update[oe],K.uint32(18).fork()).ldelim();return U.vehicle!=null&&Object.hasOwnProperty.call(U,"vehicle")&&ne.transit_realtime.VehicleDescriptor.encode(U.vehicle,K.uint32(26).fork()).ldelim(),U.timestamp!=null&&Object.hasOwnProperty.call(U,"timestamp")&&K.uint32(32).uint64(U.timestamp),U.delay!=null&&Object.hasOwnProperty.call(U,"delay")&&K.uint32(40).int32(U.delay),U.trip_properties!=null&&Object.hasOwnProperty.call(U,"trip_properties")&&ne.transit_realtime.TripUpdate.TripProperties.encode(U.trip_properties,K.uint32(50).fork()).ldelim(),K},ee.encodeDelimited=function(U,K){return this.encode(U,K).ldelim()},ee.decode=function(U,K,oe){U instanceof Y||(U=Y.create(U));for(var pe=K===void 0?U.len:U.pos+K,_e=new ne.transit_realtime.TripUpdate;U.pos<pe;){var me=U.uint32();if(me===oe)break;switch(me>>>3){case 1:{_e.trip=ne.transit_realtime.TripDescriptor.decode(U,U.uint32());break}case 3:{_e.vehicle=ne.transit_realtime.VehicleDescriptor.decode(U,U.uint32());break}case 2:{_e.stop_time_update&&_e.stop_time_update.length||(_e.stop_time_update=[]),_e.stop_time_update.push(ne.transit_realtime.TripUpdate.StopTimeUpdate.decode(U,U.uint32()));break}case 4:{_e.timestamp=U.uint64();break}case 5:{_e.delay=U.int32();break}case 6:{_e.trip_properties=ne.transit_realtime.TripUpdate.TripProperties.decode(U,U.uint32());break}default:U.skipType(me&7);break}}if(!_e.hasOwnProperty("trip"))throw ae.ProtocolError("missing required 'trip'",{instance:_e});return _e},ee.decodeDelimited=function(U){return U instanceof Y||(U=new Y(U)),this.decode(U,U.uint32())},ee.verify=function(U){if(typeof U!="object"||U===null)return"object expected";{var K=ne.transit_realtime.TripDescriptor.verify(U.trip);if(K)return"trip."+K}if(U.vehicle!=null&&U.hasOwnProperty("vehicle")){var K=ne.transit_realtime.VehicleDescriptor.verify(U.vehicle);if(K)return"vehicle."+K}if(U.stop_time_update!=null&&U.hasOwnProperty("stop_time_update")){if(!Array.isArray(U.stop_time_update))return"stop_time_update: array expected";for(var oe=0;oe<U.stop_time_update.length;++oe){var K=ne.transit_realtime.TripUpdate.StopTimeUpdate.verify(U.stop_time_update[oe]);if(K)return"stop_time_update."+K}}if(U.timestamp!=null&&U.hasOwnProperty("timestamp")&&!ae.isInteger(U.timestamp)&&!(U.timestamp&&ae.isInteger(U.timestamp.low)&&ae.isInteger(U.timestamp.high)))return"timestamp: integer|Long expected";if(U.delay!=null&&U.hasOwnProperty("delay")&&!ae.isInteger(U.delay))return"delay: integer expected";if(U.trip_properties!=null&&U.hasOwnProperty("trip_properties")){var K=ne.transit_realtime.TripUpdate.TripProperties.verify(U.trip_properties);if(K)return"trip_properties."+K}return null},ee.fromObject=function(U){if(U instanceof ne.transit_realtime.TripUpdate)return U;var K=new ne.transit_realtime.TripUpdate;if(U.trip!=null){if(typeof U.trip!="object")throw TypeError(".transit_realtime.TripUpdate.trip: object expected");K.trip=ne.transit_realtime.TripDescriptor.fromObject(U.trip)}if(U.vehicle!=null){if(typeof U.vehicle!="object")throw TypeError(".transit_realtime.TripUpdate.vehicle: object expected");K.vehicle=ne.transit_realtime.VehicleDescriptor.fromObject(U.vehicle)}if(U.stop_time_update){if(!Array.isArray(U.stop_time_update))throw TypeError(".transit_realtime.TripUpdate.stop_time_update: array expected");K.stop_time_update=[];for(var oe=0;oe<U.stop_time_update.length;++oe){if(typeof U.stop_time_update[oe]!="object")throw TypeError(".transit_realtime.TripUpdate.stop_time_update: object expected");K.stop_time_update[oe]=ne.transit_realtime.TripUpdate.StopTimeUpdate.fromObject(U.stop_time_update[oe])}}if(U.timestamp!=null&&(ae.Long?(K.timestamp=ae.Long.fromValue(U.timestamp)).unsigned=!0:typeof U.timestamp=="string"?K.timestamp=parseInt(U.timestamp,10):typeof U.timestamp=="number"?K.timestamp=U.timestamp:typeof U.timestamp=="object"&&(K.timestamp=new ae.LongBits(U.timestamp.low>>>0,U.timestamp.high>>>0).toNumber(!0))),U.delay!=null&&(K.delay=U.delay|0),U.trip_properties!=null){if(typeof U.trip_properties!="object")throw TypeError(".transit_realtime.TripUpdate.trip_properties: object expected");K.trip_properties=ne.transit_realtime.TripUpdate.TripProperties.fromObject(U.trip_properties)}return K},ee.toObject=function(U,K){K||(K={});var oe={};if((K.arrays||K.defaults)&&(oe.stop_time_update=[]),K.defaults){if(oe.trip=null,oe.vehicle=null,ae.Long){var pe=new ae.Long(0,0,!0);oe.timestamp=K.longs===String?pe.toString():K.longs===Number?pe.toNumber():pe}else oe.timestamp=K.longs===String?"0":0;oe.delay=0,oe.trip_properties=null}if(U.trip!=null&&U.hasOwnProperty("trip")&&(oe.trip=ne.transit_realtime.TripDescriptor.toObject(U.trip,K)),U.stop_time_update&&U.stop_time_update.length){oe.stop_time_update=[];for(var _e=0;_e<U.stop_time_update.length;++_e)oe.stop_time_update[_e]=ne.transit_realtime.TripUpdate.StopTimeUpdate.toObject(U.stop_time_update[_e],K)}return U.vehicle!=null&&U.hasOwnProperty("vehicle")&&(oe.vehicle=ne.transit_realtime.VehicleDescriptor.toObject(U.vehicle,K)),U.timestamp!=null&&U.hasOwnProperty("timestamp")&&(typeof U.timestamp=="number"?oe.timestamp=K.longs===String?String(U.timestamp):U.timestamp:oe.timestamp=K.longs===String?ae.Long.prototype.toString.call(U.timestamp):K.longs===Number?new ae.LongBits(U.timestamp.low>>>0,U.timestamp.high>>>0).toNumber(!0):U.timestamp),U.delay!=null&&U.hasOwnProperty("delay")&&(oe.delay=U.delay),U.trip_properties!=null&&U.hasOwnProperty("trip_properties")&&(oe.trip_properties=ne.transit_realtime.TripUpdate.TripProperties.toObject(U.trip_properties,K)),oe},ee.prototype.toJSON=function(){return this.constructor.toObject(this,J.util.toJSONOptions)},ee.getTypeUrl=function(U){return U===void 0&&(U="type.googleapis.com"),U+"/transit_realtime.TripUpdate"},ee.StopTimeEvent=(function(){function R(U){if(U)for(var K=Object.keys(U),oe=0;oe<K.length;++oe)U[K[oe]]!=null&&(this[K[oe]]=U[K[oe]])}return R.prototype.delay=0,R.prototype.time=ae.Long?ae.Long.fromBits(0,0,!1):0,R.prototype.uncertainty=0,R.prototype.scheduled_time=ae.Long?ae.Long.fromBits(0,0,!1):0,R.create=function(K){return new R(K)},R.encode=function(K,oe){return oe||(oe=re.create()),K.delay!=null&&Object.hasOwnProperty.call(K,"delay")&&oe.uint32(8).int32(K.delay),K.time!=null&&Object.hasOwnProperty.call(K,"time")&&oe.uint32(16).int64(K.time),K.uncertainty!=null&&Object.hasOwnProperty.call(K,"uncertainty")&&oe.uint32(24).int32(K.uncertainty),K.scheduled_time!=null&&Object.hasOwnProperty.call(K,"scheduled_time")&&oe.uint32(32).int64(K.scheduled_time),oe},R.encodeDelimited=function(K,oe){return this.encode(K,oe).ldelim()},R.decode=function(K,oe,pe){K instanceof Y||(K=Y.create(K));for(var _e=oe===void 0?K.len:K.pos+oe,me=new ne.transit_realtime.TripUpdate.StopTimeEvent;K.pos<_e;){var we=K.uint32();if(we===pe)break;switch(we>>>3){case 1:{me.delay=K.int32();break}case 2:{me.time=K.int64();break}case 3:{me.uncertainty=K.int32();break}case 4:{me.scheduled_time=K.int64();break}default:K.skipType(we&7);break}}return me},R.decodeDelimited=function(K){return K instanceof Y||(K=new Y(K)),this.decode(K,K.uint32())},R.verify=function(K){return typeof K!="object"||K===null?"object expected":K.delay!=null&&K.hasOwnProperty("delay")&&!ae.isInteger(K.delay)?"delay: integer expected":K.time!=null&&K.hasOwnProperty("time")&&!ae.isInteger(K.time)&&!(K.time&&ae.isInteger(K.time.low)&&ae.isInteger(K.time.high))?"time: integer|Long expected":K.uncertainty!=null&&K.hasOwnProperty("uncertainty")&&!ae.isInteger(K.uncertainty)?"uncertainty: integer expected":K.scheduled_time!=null&&K.hasOwnProperty("scheduled_time")&&!ae.isInteger(K.scheduled_time)&&!(K.scheduled_time&&ae.isInteger(K.scheduled_time.low)&&ae.isInteger(K.scheduled_time.high))?"scheduled_time: integer|Long expected":null},R.fromObject=function(K){if(K instanceof ne.transit_realtime.TripUpdate.StopTimeEvent)return K;var oe=new ne.transit_realtime.TripUpdate.StopTimeEvent;return K.delay!=null&&(oe.delay=K.delay|0),K.time!=null&&(ae.Long?(oe.time=ae.Long.fromValue(K.time)).unsigned=!1:typeof K.time=="string"?oe.time=parseInt(K.time,10):typeof K.time=="number"?oe.time=K.time:typeof K.time=="object"&&(oe.time=new ae.LongBits(K.time.low>>>0,K.time.high>>>0).toNumber())),K.uncertainty!=null&&(oe.uncertainty=K.uncertainty|0),K.scheduled_time!=null&&(ae.Long?(oe.scheduled_time=ae.Long.fromValue(K.scheduled_time)).unsigned=!1:typeof K.scheduled_time=="string"?oe.scheduled_time=parseInt(K.scheduled_time,10):typeof K.scheduled_time=="number"?oe.scheduled_time=K.scheduled_time:typeof K.scheduled_time=="object"&&(oe.scheduled_time=new ae.LongBits(K.scheduled_time.low>>>0,K.scheduled_time.high>>>0).toNumber())),oe},R.toObject=function(K,oe){oe||(oe={});var pe={};if(oe.defaults){if(pe.delay=0,ae.Long){var _e=new ae.Long(0,0,!1);pe.time=oe.longs===String?_e.toString():oe.longs===Number?_e.toNumber():_e}else pe.time=oe.longs===String?"0":0;if(pe.uncertainty=0,ae.Long){var _e=new ae.Long(0,0,!1);pe.scheduled_time=oe.longs===String?_e.toString():oe.longs===Number?_e.toNumber():_e}else pe.scheduled_time=oe.longs===String?"0":0}return K.delay!=null&&K.hasOwnProperty("delay")&&(pe.delay=K.delay),K.time!=null&&K.hasOwnProperty("time")&&(typeof K.time=="number"?pe.time=oe.longs===String?String(K.time):K.time:pe.time=oe.longs===String?ae.Long.prototype.toString.call(K.time):oe.longs===Number?new ae.LongBits(K.time.low>>>0,K.time.high>>>0).toNumber():K.time),K.uncertainty!=null&&K.hasOwnProperty("uncertainty")&&(pe.uncertainty=K.uncertainty),K.scheduled_time!=null&&K.hasOwnProperty("scheduled_time")&&(typeof K.scheduled_time=="number"?pe.scheduled_time=oe.longs===String?String(K.scheduled_time):K.scheduled_time:pe.scheduled_time=oe.longs===String?ae.Long.prototype.toString.call(K.scheduled_time):oe.longs===Number?new ae.LongBits(K.scheduled_time.low>>>0,K.scheduled_time.high>>>0).toNumber():K.scheduled_time),pe},R.prototype.toJSON=function(){return this.constructor.toObject(this,J.util.toJSONOptions)},R.getTypeUrl=function(K){return K===void 0&&(K="type.googleapis.com"),K+"/transit_realtime.TripUpdate.StopTimeEvent"},R})(),ee.StopTimeUpdate=(function(){function R(U){if(U)for(var K=Object.keys(U),oe=0;oe<K.length;++oe)U[K[oe]]!=null&&(this[K[oe]]=U[K[oe]])}return R.prototype.stop_sequence=0,R.prototype.stop_id="",R.prototype.arrival=null,R.prototype.departure=null,R.prototype.departure_occupancy_status=0,R.prototype.schedule_relationship=0,R.prototype.stop_time_properties=null,R.create=function(K){return new R(K)},R.encode=function(K,oe){return oe||(oe=re.create()),K.stop_sequence!=null&&Object.hasOwnProperty.call(K,"stop_sequence")&&oe.uint32(8).uint32(K.stop_sequence),K.arrival!=null&&Object.hasOwnProperty.call(K,"arrival")&&ne.transit_realtime.TripUpdate.StopTimeEvent.encode(K.arrival,oe.uint32(18).fork()).ldelim(),K.departure!=null&&Object.hasOwnProperty.call(K,"departure")&&ne.transit_realtime.TripUpdate.StopTimeEvent.encode(K.departure,oe.uint32(26).fork()).ldelim(),K.stop_id!=null&&Object.hasOwnProperty.call(K,"stop_id")&&oe.uint32(34).string(K.stop_id),K.schedule_relationship!=null&&Object.hasOwnProperty.call(K,"schedule_relationship")&&oe.uint32(40).int32(K.schedule_relationship),K.stop_time_properties!=null&&Object.hasOwnProperty.call(K,"stop_time_properties")&&ne.transit_realtime.TripUpdate.StopTimeUpdate.StopTimeProperties.encode(K.stop_time_properties,oe.uint32(50).fork()).ldelim(),K.departure_occupancy_status!=null&&Object.hasOwnProperty.call(K,"departure_occupancy_status")&&oe.uint32(56).int32(K.departure_occupancy_status),oe},R.encodeDelimited=function(K,oe){return this.encode(K,oe).ldelim()},R.decode=function(K,oe,pe){K instanceof Y||(K=Y.create(K));for(var _e=oe===void 0?K.len:K.pos+oe,me=new ne.transit_realtime.TripUpdate.StopTimeUpdate;K.pos<_e;){var we=K.uint32();if(we===pe)break;switch(we>>>3){case 1:{me.stop_sequence=K.uint32();break}case 4:{me.stop_id=K.string();break}case 2:{me.arrival=ne.transit_realtime.TripUpdate.StopTimeEvent.decode(K,K.uint32());break}case 3:{me.departure=ne.transit_realtime.TripUpdate.StopTimeEvent.decode(K,K.uint32());break}case 7:{me.departure_occupancy_status=K.int32();break}case 5:{me.schedule_relationship=K.int32();break}case 6:{me.stop_time_properties=ne.transit_realtime.TripUpdate.StopTimeUpdate.StopTimeProperties.decode(K,K.uint32());break}default:K.skipType(we&7);break}}return me},R.decodeDelimited=function(K){return K instanceof Y||(K=new Y(K)),this.decode(K,K.uint32())},R.verify=function(K){if(typeof K!="object"||K===null)return"object expected";if(K.stop_sequence!=null&&K.hasOwnProperty("stop_sequence")&&!ae.isInteger(K.stop_sequence))return"stop_sequence: integer expected";if(K.stop_id!=null&&K.hasOwnProperty("stop_id")&&!ae.isString(K.stop_id))return"stop_id: string expected";if(K.arrival!=null&&K.hasOwnProperty("arrival")){var oe=ne.transit_realtime.TripUpdate.StopTimeEvent.verify(K.arrival);if(oe)return"arrival."+oe}if(K.departure!=null&&K.hasOwnProperty("departure")){var oe=ne.transit_realtime.TripUpdate.StopTimeEvent.verify(K.departure);if(oe)return"departure."+oe}if(K.departure_occupancy_status!=null&&K.hasOwnProperty("departure_occupancy_status"))switch(K.departure_occupancy_status){default:return"departure_occupancy_status: enum value expected";case 0:case 1:case 2:case 3:case 4:case 5:case 6:case 7:case 8:break}if(K.schedule_relationship!=null&&K.hasOwnProperty("schedule_relationship"))switch(K.schedule_relationship){default:return"schedule_relationship: enum value expected";case 0:case 1:case 2:case 3:break}if(K.stop_time_properties!=null&&K.hasOwnProperty("stop_time_properties")){var oe=ne.transit_realtime.TripUpdate.StopTimeUpdate.StopTimeProperties.verify(K.stop_time_properties);if(oe)return"stop_time_properties."+oe}return null},R.fromObject=function(K){if(K instanceof ne.transit_realtime.TripUpdate.StopTimeUpdate)return K;var oe=new ne.transit_realtime.TripUpdate.StopTimeUpdate;if(K.stop_sequence!=null&&(oe.stop_sequence=K.stop_sequence>>>0),K.stop_id!=null&&(oe.stop_id=String(K.stop_id)),K.arrival!=null){if(typeof K.arrival!="object")throw TypeError(".transit_realtime.TripUpdate.StopTimeUpdate.arrival: object expected");oe.arrival=ne.transit_realtime.TripUpdate.StopTimeEvent.fromObject(K.arrival)}if(K.departure!=null){if(typeof K.departure!="object")throw TypeError(".transit_realtime.TripUpdate.StopTimeUpdate.departure: object expected");oe.departure=ne.transit_realtime.TripUpdate.StopTimeEvent.fromObject(K.departure)}switch(K.departure_occupancy_status){default:if(typeof K.departure_occupancy_status=="number"){oe.departure_occupancy_status=K.departure_occupancy_status;break}break;case"EMPTY":case 0:oe.departure_occupancy_status=0;break;case"MANY_SEATS_AVAILABLE":case 1:oe.departure_occupancy_status=1;break;case"FEW_SEATS_AVAILABLE":case 2:oe.departure_occupancy_status=2;break;case"STANDING_ROOM_ONLY":case 3:oe.departure_occupancy_status=3;break;case"CRUSHED_STANDING_ROOM_ONLY":case 4:oe.departure_occupancy_status=4;break;case"FULL":case 5:oe.departure_occupancy_status=5;break;case"NOT_ACCEPTING_PASSENGERS":case 6:oe.departure_occupancy_status=6;break;case"NO_DATA_AVAILABLE":case 7:oe.departure_occupancy_status=7;break;case"NOT_BOARDABLE":case 8:oe.departure_occupancy_status=8;break}switch(K.schedule_relationship){default:if(typeof K.schedule_relationship=="number"){oe.schedule_relationship=K.schedule_relationship;break}break;case"SCHEDULED":case 0:oe.schedule_relationship=0;break;case"SKIPPED":case 1:oe.schedule_relationship=1;break;case"NO_DATA":case 2:oe.schedule_relationship=2;break;case"UNSCHEDULED":case 3:oe.schedule_relationship=3;break}if(K.stop_time_properties!=null){if(typeof K.stop_time_properties!="object")throw TypeError(".transit_realtime.TripUpdate.StopTimeUpdate.stop_time_properties: object expected");oe.stop_time_properties=ne.transit_realtime.TripUpdate.StopTimeUpdate.StopTimeProperties.fromObject(K.stop_time_properties)}return oe},R.toObject=function(K,oe){oe||(oe={});var pe={};return oe.defaults&&(pe.stop_sequence=0,pe.arrival=null,pe.departure=null,pe.stop_id="",pe.schedule_relationship=oe.enums===String?"SCHEDULED":0,pe.stop_time_properties=null,pe.departure_occupancy_status=oe.enums===String?"EMPTY":0),K.stop_sequence!=null&&K.hasOwnProperty("stop_sequence")&&(pe.stop_sequence=K.stop_sequence),K.arrival!=null&&K.hasOwnProperty("arrival")&&(pe.arrival=ne.transit_realtime.TripUpdate.StopTimeEvent.toObject(K.arrival,oe)),K.departure!=null&&K.hasOwnProperty("departure")&&(pe.departure=ne.transit_realtime.TripUpdate.StopTimeEvent.toObject(K.departure,oe)),K.stop_id!=null&&K.hasOwnProperty("stop_id")&&(pe.stop_id=K.stop_id),K.schedule_relationship!=null&&K.hasOwnProperty("schedule_relationship")&&(pe.schedule_relationship=oe.enums===String?ne.transit_realtime.TripUpdate.StopTimeUpdate.ScheduleRelationship[K.schedule_relationship]===void 0?K.schedule_relationship:ne.transit_realtime.TripUpdate.StopTimeUpdate.ScheduleRelationship[K.schedule_relationship]:K.schedule_relationship),K.stop_time_properties!=null&&K.hasOwnProperty("stop_time_properties")&&(pe.stop_time_properties=ne.transit_realtime.TripUpdate.StopTimeUpdate.StopTimeProperties.toObject(K.stop_time_properties,oe)),K.departure_occupancy_status!=null&&K.hasOwnProperty("departure_occupancy_status")&&(pe.departure_occupancy_status=oe.enums===String?ne.transit_realtime.VehiclePosition.OccupancyStatus[K.departure_occupancy_status]===void 0?K.departure_occupancy_status:ne.transit_realtime.VehiclePosition.OccupancyStatus[K.departure_occupancy_status]:K.departure_occupancy_status),pe},R.prototype.toJSON=function(){return this.constructor.toObject(this,J.util.toJSONOptions)},R.getTypeUrl=function(K){return K===void 0&&(K="type.googleapis.com"),K+"/transit_realtime.TripUpdate.StopTimeUpdate"},R.ScheduleRelationship=(function(){var U={},K=Object.create(U);return K[U[0]="SCHEDULED"]=0,K[U[1]="SKIPPED"]=1,K[U[2]="NO_DATA"]=2,K[U[3]="UNSCHEDULED"]=3,K})(),R.StopTimeProperties=(function(){function U(K){if(K)for(var oe=Object.keys(K),pe=0;pe<oe.length;++pe)K[oe[pe]]!=null&&(this[oe[pe]]=K[oe[pe]])}return U.prototype.assigned_stop_id="",U.prototype.stop_headsign="",U.prototype.pickup_type=0,U.prototype.drop_off_type=0,U.create=function(oe){return new U(oe)},U.encode=function(oe,pe){return pe||(pe=re.create()),oe.assigned_stop_id!=null&&Object.hasOwnProperty.call(oe,"assigned_stop_id")&&pe.uint32(10).string(oe.assigned_stop_id),oe.stop_headsign!=null&&Object.hasOwnProperty.call(oe,"stop_headsign")&&pe.uint32(18).string(oe.stop_headsign),oe.pickup_type!=null&&Object.hasOwnProperty.call(oe,"pickup_type")&&pe.uint32(24).int32(oe.pickup_type),oe.drop_off_type!=null&&Object.hasOwnProperty.call(oe,"drop_off_type")&&pe.uint32(32).int32(oe.drop_off_type),pe},U.encodeDelimited=function(oe,pe){return this.encode(oe,pe).ldelim()},U.decode=function(oe,pe,_e){oe instanceof Y||(oe=Y.create(oe));for(var me=pe===void 0?oe.len:oe.pos+pe,we=new ne.transit_realtime.TripUpdate.StopTimeUpdate.StopTimeProperties;oe.pos<me;){var Oe=oe.uint32();if(Oe===_e)break;switch(Oe>>>3){case 1:{we.assigned_stop_id=oe.string();break}case 2:{we.stop_headsign=oe.string();break}case 3:{we.pickup_type=oe.int32();break}case 4:{we.drop_off_type=oe.int32();break}default:oe.skipType(Oe&7);break}}return we},U.decodeDelimited=function(oe){return oe instanceof Y||(oe=new Y(oe)),this.decode(oe,oe.uint32())},U.verify=function(oe){if(typeof oe!="object"||oe===null)return"object expected";if(oe.assigned_stop_id!=null&&oe.hasOwnProperty("assigned_stop_id")&&!ae.isString(oe.assigned_stop_id))return"assigned_stop_id: string expected";if(oe.stop_headsign!=null&&oe.hasOwnProperty("stop_headsign")&&!ae.isString(oe.stop_headsign))return"stop_headsign: string expected";if(oe.pickup_type!=null&&oe.hasOwnProperty("pickup_type"))switch(oe.pickup_type){default:return"pickup_type: enum value expected";case 0:case 1:case 2:case 3:break}if(oe.drop_off_type!=null&&oe.hasOwnProperty("drop_off_type"))switch(oe.drop_off_type){default:return"drop_off_type: enum value expected";case 0:case 1:case 2:case 3:break}return null},U.fromObject=function(oe){if(oe instanceof ne.transit_realtime.TripUpdate.StopTimeUpdate.StopTimeProperties)return oe;var pe=new ne.transit_realtime.TripUpdate.StopTimeUpdate.StopTimeProperties;switch(oe.assigned_stop_id!=null&&(pe.assigned_stop_id=String(oe.assigned_stop_id)),oe.stop_headsign!=null&&(pe.stop_headsign=String(oe.stop_headsign)),oe.pickup_type){default:if(typeof oe.pickup_type=="number"){pe.pickup_type=oe.pickup_type;break}break;case"REGULAR":case 0:pe.pickup_type=0;break;case"NONE":case 1:pe.pickup_type=1;break;case"PHONE_AGENCY":case 2:pe.pickup_type=2;break;case"COORDINATE_WITH_DRIVER":case 3:pe.pickup_type=3;break}switch(oe.drop_off_type){default:if(typeof oe.drop_off_type=="number"){pe.drop_off_type=oe.drop_off_type;break}break;case"REGULAR":case 0:pe.drop_off_type=0;break;case"NONE":case 1:pe.drop_off_type=1;break;case"PHONE_AGENCY":case 2:pe.drop_off_type=2;break;case"COORDINATE_WITH_DRIVER":case 3:pe.drop_off_type=3;break}return pe},U.toObject=function(oe,pe){pe||(pe={});var _e={};return pe.defaults&&(_e.assigned_stop_id="",_e.stop_headsign="",_e.pickup_type=pe.enums===String?"REGULAR":0,_e.drop_off_type=pe.enums===String?"REGULAR":0),oe.assigned_stop_id!=null&&oe.hasOwnProperty("assigned_stop_id")&&(_e.assigned_stop_id=oe.assigned_stop_id),oe.stop_headsign!=null&&oe.hasOwnProperty("stop_headsign")&&(_e.stop_headsign=oe.stop_headsign),oe.pickup_type!=null&&oe.hasOwnProperty("pickup_type")&&(_e.pickup_type=pe.enums===String?ne.transit_realtime.TripUpdate.StopTimeUpdate.StopTimeProperties.DropOffPickupType[oe.pickup_type]===void 0?oe.pickup_type:ne.transit_realtime.TripUpdate.StopTimeUpdate.StopTimeProperties.DropOffPickupType[oe.pickup_type]:oe.pickup_type),oe.drop_off_type!=null&&oe.hasOwnProperty("drop_off_type")&&(_e.drop_off_type=pe.enums===String?ne.transit_realtime.TripUpdate.StopTimeUpdate.StopTimeProperties.DropOffPickupType[oe.drop_off_type]===void 0?oe.drop_off_type:ne.transit_realtime.TripUpdate.StopTimeUpdate.StopTimeProperties.DropOffPickupType[oe.drop_off_type]:oe.drop_off_type),_e},U.prototype.toJSON=function(){return this.constructor.toObject(this,J.util.toJSONOptions)},U.getTypeUrl=function(oe){return oe===void 0&&(oe="type.googleapis.com"),oe+"/transit_realtime.TripUpdate.StopTimeUpdate.StopTimeProperties"},U.DropOffPickupType=(function(){var K={},oe=Object.create(K);return oe[K[0]="REGULAR"]=0,oe[K[1]="NONE"]=1,oe[K[2]="PHONE_AGENCY"]=2,oe[K[3]="COORDINATE_WITH_DRIVER"]=3,oe})(),U})(),R})(),ee.TripProperties=(function(){function R(U){if(U)for(var K=Object.keys(U),oe=0;oe<K.length;++oe)U[K[oe]]!=null&&(this[K[oe]]=U[K[oe]])}return R.prototype.trip_id="",R.prototype.start_date="",R.prototype.start_time="",R.prototype.shape_id="",R.prototype.trip_headsign="",R.prototype.trip_short_name="",R.create=function(K){return new R(K)},R.encode=function(K,oe){return oe||(oe=re.create()),K.trip_id!=null&&Object.hasOwnProperty.call(K,"trip_id")&&oe.uint32(10).string(K.trip_id),K.start_date!=null&&Object.hasOwnProperty.call(K,"start_date")&&oe.uint32(18).string(K.start_date),K.start_time!=null&&Object.hasOwnProperty.call(K,"start_time")&&oe.uint32(26).string(K.start_time),K.shape_id!=null&&Object.hasOwnProperty.call(K,"shape_id")&&oe.uint32(34).string(K.shape_id),K.trip_headsign!=null&&Object.hasOwnProperty.call(K,"trip_headsign")&&oe.uint32(42).string(K.trip_headsign),K.trip_short_name!=null&&Object.hasOwnProperty.call(K,"trip_short_name")&&oe.uint32(50).string(K.trip_short_name),oe},R.encodeDelimited=function(K,oe){return this.encode(K,oe).ldelim()},R.decode=function(K,oe,pe){K instanceof Y||(K=Y.create(K));for(var _e=oe===void 0?K.len:K.pos+oe,me=new ne.transit_realtime.TripUpdate.TripProperties;K.pos<_e;){var we=K.uint32();if(we===pe)break;switch(we>>>3){case 1:{me.trip_id=K.string();break}case 2:{me.start_date=K.string();break}case 3:{me.start_time=K.string();break}case 4:{me.shape_id=K.string();break}case 5:{me.trip_headsign=K.string();break}case 6:{me.trip_short_name=K.string();break}default:K.skipType(we&7);break}}return me},R.decodeDelimited=function(K){return K instanceof Y||(K=new Y(K)),this.decode(K,K.uint32())},R.verify=function(K){return typeof K!="object"||K===null?"object expected":K.trip_id!=null&&K.hasOwnProperty("trip_id")&&!ae.isString(K.trip_id)?"trip_id: string expected":K.start_date!=null&&K.hasOwnProperty("start_date")&&!ae.isString(K.start_date)?"start_date: string expected":K.start_time!=null&&K.hasOwnProperty("start_time")&&!ae.isString(K.start_time)?"start_time: string expected":K.shape_id!=null&&K.hasOwnProperty("shape_id")&&!ae.isString(K.shape_id)?"shape_id: string expected":K.trip_headsign!=null&&K.hasOwnProperty("trip_headsign")&&!ae.isString(K.trip_headsign)?"trip_headsign: string expected":K.trip_short_name!=null&&K.hasOwnProperty("trip_short_name")&&!ae.isString(K.trip_short_name)?"trip_short_name: string expected":null},R.fromObject=function(K){if(K instanceof ne.transit_realtime.TripUpdate.TripProperties)return K;var oe=new ne.transit_realtime.TripUpdate.TripProperties;return K.trip_id!=null&&(oe.trip_id=String(K.trip_id)),K.start_date!=null&&(oe.start_date=String(K.start_date)),K.start_time!=null&&(oe.start_time=String(K.start_time)),K.shape_id!=null&&(oe.shape_id=String(K.shape_id)),K.trip_headsign!=null&&(oe.trip_headsign=String(K.trip_headsign)),K.trip_short_name!=null&&(oe.trip_short_name=String(K.trip_short_name)),oe},R.toObject=function(K,oe){oe||(oe={});var pe={};return oe.defaults&&(pe.trip_id="",pe.start_date="",pe.start_time="",pe.shape_id="",pe.trip_headsign="",pe.trip_short_name=""),K.trip_id!=null&&K.hasOwnProperty("trip_id")&&(pe.trip_id=K.trip_id),K.start_date!=null&&K.hasOwnProperty("start_date")&&(pe.start_date=K.start_date),K.start_time!=null&&K.hasOwnProperty("start_time")&&(pe.start_time=K.start_time),K.shape_id!=null&&K.hasOwnProperty("shape_id")&&(pe.shape_id=K.shape_id),K.trip_headsign!=null&&K.hasOwnProperty("trip_headsign")&&(pe.trip_headsign=K.trip_headsign),K.trip_short_name!=null&&K.hasOwnProperty("trip_short_name")&&(pe.trip_short_name=K.trip_short_name),pe},R.prototype.toJSON=function(){return this.constructor.toObject(this,J.util.toJSONOptions)},R.getTypeUrl=function(K){return K===void 0&&(K="type.googleapis.com"),K+"/transit_realtime.TripUpdate.TripProperties"},R})(),ee})(),ce.VehiclePosition=(function(){function ee(R){if(this.multi_carriage_details=[],R)for(var U=Object.keys(R),K=0;K<U.length;++K)R[U[K]]!=null&&(this[U[K]]=R[U[K]])}return ee.prototype.trip=null,ee.prototype.vehicle=null,ee.prototype.position=null,ee.prototype.current_stop_sequence=0,ee.prototype.stop_id="",ee.prototype.current_status=2,ee.prototype.timestamp=ae.Long?ae.Long.fromBits(0,0,!0):0,ee.prototype.congestion_level=0,ee.prototype.occupancy_status=0,ee.prototype.occupancy_percentage=0,ee.prototype.multi_carriage_details=ae.emptyArray,ee.create=function(U){return new ee(U)},ee.encode=function(U,K){if(K||(K=re.create()),U.trip!=null&&Object.hasOwnProperty.call(U,"trip")&&ne.transit_realtime.TripDescriptor.encode(U.trip,K.uint32(10).fork()).ldelim(),U.position!=null&&Object.hasOwnProperty.call(U,"position")&&ne.transit_realtime.Position.encode(U.position,K.uint32(18).fork()).ldelim(),U.current_stop_sequence!=null&&Object.hasOwnProperty.call(U,"current_stop_sequence")&&K.uint32(24).uint32(U.current_stop_sequence),U.current_status!=null&&Object.hasOwnProperty.call(U,"current_status")&&K.uint32(32).int32(U.current_status),U.timestamp!=null&&Object.hasOwnProperty.call(U,"timestamp")&&K.uint32(40).uint64(U.timestamp),U.congestion_level!=null&&Object.hasOwnProperty.call(U,"congestion_level")&&K.uint32(48).int32(U.congestion_level),U.stop_id!=null&&Object.hasOwnProperty.call(U,"stop_id")&&K.uint32(58).string(U.stop_id),U.vehicle!=null&&Object.hasOwnProperty.call(U,"vehicle")&&ne.transit_realtime.VehicleDescriptor.encode(U.vehicle,K.uint32(66).fork()).ldelim(),U.occupancy_status!=null&&Object.hasOwnProperty.call(U,"occupancy_status")&&K.uint32(72).int32(U.occupancy_status),U.occupancy_percentage!=null&&Object.hasOwnProperty.call(U,"occupancy_percentage")&&K.uint32(80).uint32(U.occupancy_percentage),U.multi_carriage_details!=null&&U.multi_carriage_details.length)for(var oe=0;oe<U.multi_carriage_details.length;++oe)ne.transit_realtime.VehiclePosition.CarriageDetails.encode(U.multi_carriage_details[oe],K.uint32(90).fork()).ldelim();return K},ee.encodeDelimited=function(U,K){return this.encode(U,K).ldelim()},ee.decode=function(U,K,oe){U instanceof Y||(U=Y.create(U));for(var pe=K===void 0?U.len:U.pos+K,_e=new ne.transit_realtime.VehiclePosition;U.pos<pe;){var me=U.uint32();if(me===oe)break;switch(me>>>3){case 1:{_e.trip=ne.transit_realtime.TripDescriptor.decode(U,U.uint32());break}case 8:{_e.vehicle=ne.transit_realtime.VehicleDescriptor.decode(U,U.uint32());break}case 2:{_e.position=ne.transit_realtime.Position.decode(U,U.uint32());break}case 3:{_e.current_stop_sequence=U.uint32();break}case 7:{_e.stop_id=U.string();break}case 4:{_e.current_status=U.int32();break}case 5:{_e.timestamp=U.uint64();break}case 6:{_e.congestion_level=U.int32();break}case 9:{_e.occupancy_status=U.int32();break}case 10:{_e.occupancy_percentage=U.uint32();break}case 11:{_e.multi_carriage_details&&_e.multi_carriage_details.length||(_e.multi_carriage_details=[]),_e.multi_carriage_details.push(ne.transit_realtime.VehiclePosition.CarriageDetails.decode(U,U.uint32()));break}default:U.skipType(me&7);break}}return _e},ee.decodeDelimited=function(U){return U instanceof Y||(U=new Y(U)),this.decode(U,U.uint32())},ee.verify=function(U){if(typeof U!="object"||U===null)return"object expected";if(U.trip!=null&&U.hasOwnProperty("trip")){var K=ne.transit_realtime.TripDescriptor.verify(U.trip);if(K)return"trip."+K}if(U.vehicle!=null&&U.hasOwnProperty("vehicle")){var K=ne.transit_realtime.VehicleDescriptor.verify(U.vehicle);if(K)return"vehicle."+K}if(U.position!=null&&U.hasOwnProperty("position")){var K=ne.transit_realtime.Position.verify(U.position);if(K)return"position."+K}if(U.current_stop_sequence!=null&&U.hasOwnProperty("current_stop_sequence")&&!ae.isInteger(U.current_stop_sequence))return"current_stop_sequence: integer expected";if(U.stop_id!=null&&U.hasOwnProperty("stop_id")&&!ae.isString(U.stop_id))return"stop_id: string expected";if(U.current_status!=null&&U.hasOwnProperty("current_status"))switch(U.current_status){default:return"current_status: enum value expected";case 0:case 1:case 2:break}if(U.timestamp!=null&&U.hasOwnProperty("timestamp")&&!ae.isInteger(U.timestamp)&&!(U.timestamp&&ae.isInteger(U.timestamp.low)&&ae.isInteger(U.timestamp.high)))return"timestamp: integer|Long expected";if(U.congestion_level!=null&&U.hasOwnProperty("congestion_level"))switch(U.congestion_level){default:return"congestion_level: enum value expected";case 0:case 1:case 2:case 3:case 4:break}if(U.occupancy_status!=null&&U.hasOwnProperty("occupancy_status"))switch(U.occupancy_status){default:return"occupancy_status: enum value expected";case 0:case 1:case 2:case 3:case 4:case 5:case 6:case 7:case 8:break}if(U.occupancy_percentage!=null&&U.hasOwnProperty("occupancy_percentage")&&!ae.isInteger(U.occupancy_percentage))return"occupancy_percentage: integer expected";if(U.multi_carriage_details!=null&&U.hasOwnProperty("multi_carriage_details")){if(!Array.isArray(U.multi_carriage_details))return"multi_carriage_details: array expected";for(var oe=0;oe<U.multi_carriage_details.length;++oe){var K=ne.transit_realtime.VehiclePosition.CarriageDetails.verify(U.multi_carriage_details[oe]);if(K)return"multi_carriage_details."+K}}return null},ee.fromObject=function(U){if(U instanceof ne.transit_realtime.VehiclePosition)return U;var K=new ne.transit_realtime.VehiclePosition;if(U.trip!=null){if(typeof U.trip!="object")throw TypeError(".transit_realtime.VehiclePosition.trip: object expected");K.trip=ne.transit_realtime.TripDescriptor.fromObject(U.trip)}if(U.vehicle!=null){if(typeof U.vehicle!="object")throw TypeError(".transit_realtime.VehiclePosition.vehicle: object expected");K.vehicle=ne.transit_realtime.VehicleDescriptor.fromObject(U.vehicle)}if(U.position!=null){if(typeof U.position!="object")throw TypeError(".transit_realtime.VehiclePosition.position: object expected");K.position=ne.transit_realtime.Position.fromObject(U.position)}switch(U.current_stop_sequence!=null&&(K.current_stop_sequence=U.current_stop_sequence>>>0),U.stop_id!=null&&(K.stop_id=String(U.stop_id)),U.current_status){case"INCOMING_AT":case 0:K.current_status=0;break;case"STOPPED_AT":case 1:K.current_status=1;break;default:if(typeof U.current_status=="number"){K.current_status=U.current_status;break}break;case"IN_TRANSIT_TO":case 2:K.current_status=2;break}switch(U.timestamp!=null&&(ae.Long?(K.timestamp=ae.Long.fromValue(U.timestamp)).unsigned=!0:typeof U.timestamp=="string"?K.timestamp=parseInt(U.timestamp,10):typeof U.timestamp=="number"?K.timestamp=U.timestamp:typeof U.timestamp=="object"&&(K.timestamp=new ae.LongBits(U.timestamp.low>>>0,U.timestamp.high>>>0).toNumber(!0))),U.congestion_level){default:if(typeof U.congestion_level=="number"){K.congestion_level=U.congestion_level;break}break;case"UNKNOWN_CONGESTION_LEVEL":case 0:K.congestion_level=0;break;case"RUNNING_SMOOTHLY":case 1:K.congestion_level=1;break;case"STOP_AND_GO":case 2:K.congestion_level=2;break;case"CONGESTION":case 3:K.congestion_level=3;break;case"SEVERE_CONGESTION":case 4:K.congestion_level=4;break}switch(U.occupancy_status){default:if(typeof U.occupancy_status=="number"){K.occupancy_status=U.occupancy_status;break}break;case"EMPTY":case 0:K.occupancy_status=0;break;case"MANY_SEATS_AVAILABLE":case 1:K.occupancy_status=1;break;case"FEW_SEATS_AVAILABLE":case 2:K.occupancy_status=2;break;case"STANDING_ROOM_ONLY":case 3:K.occupancy_status=3;break;case"CRUSHED_STANDING_ROOM_ONLY":case 4:K.occupancy_status=4;break;case"FULL":case 5:K.occupancy_status=5;break;case"NOT_ACCEPTING_PASSENGERS":case 6:K.occupancy_status=6;break;case"NO_DATA_AVAILABLE":case 7:K.occupancy_status=7;break;case"NOT_BOARDABLE":case 8:K.occupancy_status=8;break}if(U.occupancy_percentage!=null&&(K.occupancy_percentage=U.occupancy_percentage>>>0),U.multi_carriage_details){if(!Array.isArray(U.multi_carriage_details))throw TypeError(".transit_realtime.VehiclePosition.multi_carriage_details: array expected");K.multi_carriage_details=[];for(var oe=0;oe<U.multi_carriage_details.length;++oe){if(typeof U.multi_carriage_details[oe]!="object")throw TypeError(".transit_realtime.VehiclePosition.multi_carriage_details: object expected");K.multi_carriage_details[oe]=ne.transit_realtime.VehiclePosition.CarriageDetails.fromObject(U.multi_carriage_details[oe])}}return K},ee.toObject=function(U,K){K||(K={});var oe={};if((K.arrays||K.defaults)&&(oe.multi_carriage_details=[]),K.defaults){if(oe.trip=null,oe.position=null,oe.current_stop_sequence=0,oe.current_status=K.enums===String?"IN_TRANSIT_TO":2,ae.Long){var pe=new ae.Long(0,0,!0);oe.timestamp=K.longs===String?pe.toString():K.longs===Number?pe.toNumber():pe}else oe.timestamp=K.longs===String?"0":0;oe.congestion_level=K.enums===String?"UNKNOWN_CONGESTION_LEVEL":0,oe.stop_id="",oe.vehicle=null,oe.occupancy_status=K.enums===String?"EMPTY":0,oe.occupancy_percentage=0}if(U.trip!=null&&U.hasOwnProperty("trip")&&(oe.trip=ne.transit_realtime.TripDescriptor.toObject(U.trip,K)),U.position!=null&&U.hasOwnProperty("position")&&(oe.position=ne.transit_realtime.Position.toObject(U.position,K)),U.current_stop_sequence!=null&&U.hasOwnProperty("current_stop_sequence")&&(oe.current_stop_sequence=U.current_stop_sequence),U.current_status!=null&&U.hasOwnProperty("current_status")&&(oe.current_status=K.enums===String?ne.transit_realtime.VehiclePosition.VehicleStopStatus[U.current_status]===void 0?U.current_status:ne.transit_realtime.VehiclePosition.VehicleStopStatus[U.current_status]:U.current_status),U.timestamp!=null&&U.hasOwnProperty("timestamp")&&(typeof U.timestamp=="number"?oe.timestamp=K.longs===String?String(U.timestamp):U.timestamp:oe.timestamp=K.longs===String?ae.Long.prototype.toString.call(U.timestamp):K.longs===Number?new ae.LongBits(U.timestamp.low>>>0,U.timestamp.high>>>0).toNumber(!0):U.timestamp),U.congestion_level!=null&&U.hasOwnProperty("congestion_level")&&(oe.congestion_level=K.enums===String?ne.transit_realtime.VehiclePosition.CongestionLevel[U.congestion_level]===void 0?U.congestion_level:ne.transit_realtime.VehiclePosition.CongestionLevel[U.congestion_level]:U.congestion_level),U.stop_id!=null&&U.hasOwnProperty("stop_id")&&(oe.stop_id=U.stop_id),U.vehicle!=null&&U.hasOwnProperty("vehicle")&&(oe.vehicle=ne.transit_realtime.VehicleDescriptor.toObject(U.vehicle,K)),U.occupancy_status!=null&&U.hasOwnProperty("occupancy_status")&&(oe.occupancy_status=K.enums===String?ne.transit_realtime.VehiclePosition.OccupancyStatus[U.occupancy_status]===void 0?U.occupancy_status:ne.transit_realtime.VehiclePosition.OccupancyStatus[U.occupancy_status]:U.occupancy_status),U.occupancy_percentage!=null&&U.hasOwnProperty("occupancy_percentage")&&(oe.occupancy_percentage=U.occupancy_percentage),U.multi_carriage_details&&U.multi_carriage_details.length){oe.multi_carriage_details=[];for(var _e=0;_e<U.multi_carriage_details.length;++_e)oe.multi_carriage_details[_e]=ne.transit_realtime.VehiclePosition.CarriageDetails.toObject(U.multi_carriage_details[_e],K)}return oe},ee.prototype.toJSON=function(){return this.constructor.toObject(this,J.util.toJSONOptions)},ee.getTypeUrl=function(U){return U===void 0&&(U="type.googleapis.com"),U+"/transit_realtime.VehiclePosition"},ee.VehicleStopStatus=(function(){var R={},U=Object.create(R);return U[R[0]="INCOMING_AT"]=0,U[R[1]="STOPPED_AT"]=1,U[R[2]="IN_TRANSIT_TO"]=2,U})(),ee.CongestionLevel=(function(){var R={},U=Object.create(R);return U[R[0]="UNKNOWN_CONGESTION_LEVEL"]=0,U[R[1]="RUNNING_SMOOTHLY"]=1,U[R[2]="STOP_AND_GO"]=2,U[R[3]="CONGESTION"]=3,U[R[4]="SEVERE_CONGESTION"]=4,U})(),ee.OccupancyStatus=(function(){var R={},U=Object.create(R);return U[R[0]="EMPTY"]=0,U[R[1]="MANY_SEATS_AVAILABLE"]=1,U[R[2]="FEW_SEATS_AVAILABLE"]=2,U[R[3]="STANDING_ROOM_ONLY"]=3,U[R[4]="CRUSHED_STANDING_ROOM_ONLY"]=4,U[R[5]="FULL"]=5,U[R[6]="NOT_ACCEPTING_PASSENGERS"]=6,U[R[7]="NO_DATA_AVAILABLE"]=7,U[R[8]="NOT_BOARDABLE"]=8,U})(),ee.CarriageDetails=(function(){function R(U){if(U)for(var K=Object.keys(U),oe=0;oe<K.length;++oe)U[K[oe]]!=null&&(this[K[oe]]=U[K[oe]])}return R.prototype.id="",R.prototype.label="",R.prototype.occupancy_status=7,R.prototype.occupancy_percentage=-1,R.prototype.carriage_sequence=0,R.create=function(K){return new R(K)},R.encode=function(K,oe){return oe||(oe=re.create()),K.id!=null&&Object.hasOwnProperty.call(K,"id")&&oe.uint32(10).string(K.id),K.label!=null&&Object.hasOwnProperty.call(K,"label")&&oe.uint32(18).string(K.label),K.occupancy_status!=null&&Object.hasOwnProperty.call(K,"occupancy_status")&&oe.uint32(24).int32(K.occupancy_status),K.occupancy_percentage!=null&&Object.hasOwnProperty.call(K,"occupancy_percentage")&&oe.uint32(32).int32(K.occupancy_percentage),K.carriage_sequence!=null&&Object.hasOwnProperty.call(K,"carriage_sequence")&&oe.uint32(40).uint32(K.carriage_sequence),oe},R.encodeDelimited=function(K,oe){return this.encode(K,oe).ldelim()},R.decode=function(K,oe,pe){K instanceof Y||(K=Y.create(K));for(var _e=oe===void 0?K.len:K.pos+oe,me=new ne.transit_realtime.VehiclePosition.CarriageDetails;K.pos<_e;){var we=K.uint32();if(we===pe)break;switch(we>>>3){case 1:{me.id=K.string();break}case 2:{me.label=K.string();break}case 3:{me.occupancy_status=K.int32();break}case 4:{me.occupancy_percentage=K.int32();break}case 5:{me.carriage_sequence=K.uint32();break}default:K.skipType(we&7);break}}return me},R.decodeDelimited=function(K){return K instanceof Y||(K=new Y(K)),this.decode(K,K.uint32())},R.verify=function(K){if(typeof K!="object"||K===null)return"object expected";if(K.id!=null&&K.hasOwnProperty("id")&&!ae.isString(K.id))return"id: string expected";if(K.label!=null&&K.hasOwnProperty("label")&&!ae.isString(K.label))return"label: string expected";if(K.occupancy_status!=null&&K.hasOwnProperty("occupancy_status"))switch(K.occupancy_status){default:return"occupancy_status: enum value expected";case 0:case 1:case 2:case 3:case 4:case 5:case 6:case 7:case 8:break}return K.occupancy_percentage!=null&&K.hasOwnProperty("occupancy_percentage")&&!ae.isInteger(K.occupancy_percentage)?"occupancy_percentage: integer expected":K.carriage_sequence!=null&&K.hasOwnProperty("carriage_sequence")&&!ae.isInteger(K.carriage_sequence)?"carriage_sequence: integer expected":null},R.fromObject=function(K){if(K instanceof ne.transit_realtime.VehiclePosition.CarriageDetails)return K;var oe=new ne.transit_realtime.VehiclePosition.CarriageDetails;switch(K.id!=null&&(oe.id=String(K.id)),K.label!=null&&(oe.label=String(K.label)),K.occupancy_status){case"EMPTY":case 0:oe.occupancy_status=0;break;case"MANY_SEATS_AVAILABLE":case 1:oe.occupancy_status=1;break;case"FEW_SEATS_AVAILABLE":case 2:oe.occupancy_status=2;break;case"STANDING_ROOM_ONLY":case 3:oe.occupancy_status=3;break;case"CRUSHED_STANDING_ROOM_ONLY":case 4:oe.occupancy_status=4;break;case"FULL":case 5:oe.occupancy_status=5;break;case"NOT_ACCEPTING_PASSENGERS":case 6:oe.occupancy_status=6;break;default:if(typeof K.occupancy_status=="number"){oe.occupancy_status=K.occupancy_status;break}break;case"NO_DATA_AVAILABLE":case 7:oe.occupancy_status=7;break;case"NOT_BOARDABLE":case 8:oe.occupancy_status=8;break}return K.occupancy_percentage!=null&&(oe.occupancy_percentage=K.occupancy_percentage|0),K.carriage_sequence!=null&&(oe.carriage_sequence=K.carriage_sequence>>>0),oe},R.toObject=function(K,oe){oe||(oe={});var pe={};return oe.defaults&&(pe.id="",pe.label="",pe.occupancy_status=oe.enums===String?"NO_DATA_AVAILABLE":7,pe.occupancy_percentage=-1,pe.carriage_sequence=0),K.id!=null&&K.hasOwnProperty("id")&&(pe.id=K.id),K.label!=null&&K.hasOwnProperty("label")&&(pe.label=K.label),K.occupancy_status!=null&&K.hasOwnProperty("occupancy_status")&&(pe.occupancy_status=oe.enums===String?ne.transit_realtime.VehiclePosition.OccupancyStatus[K.occupancy_status]===void 0?K.occupancy_status:ne.transit_realtime.VehiclePosition.OccupancyStatus[K.occupancy_status]:K.occupancy_status),K.occupancy_percentage!=null&&K.hasOwnProperty("occupancy_percentage")&&(pe.occupancy_percentage=K.occupancy_percentage),K.carriage_sequence!=null&&K.hasOwnProperty("carriage_sequence")&&(pe.carriage_sequence=K.carriage_sequence),pe},R.prototype.toJSON=function(){return this.constructor.toObject(this,J.util.toJSONOptions)},R.getTypeUrl=function(K){return K===void 0&&(K="type.googleapis.com"),K+"/transit_realtime.VehiclePosition.CarriageDetails"},R})(),ee})(),ce.Alert=(function(){function ee(R){if(this.active_period=[],this.informed_entity=[],R)for(var U=Object.keys(R),K=0;K<U.length;++K)R[U[K]]!=null&&(this[U[K]]=R[U[K]])}return ee.prototype.active_period=ae.emptyArray,ee.prototype.informed_entity=ae.emptyArray,ee.prototype.cause=1,ee.prototype.effect=8,ee.prototype.url=null,ee.prototype.header_text=null,ee.prototype.description_text=null,ee.prototype.tts_header_text=null,ee.prototype.tts_description_text=null,ee.prototype.severity_level=1,ee.prototype.image=null,ee.prototype.image_alternative_text=null,ee.prototype.cause_detail=null,ee.prototype.effect_detail=null,ee.create=function(U){return new ee(U)},ee.encode=function(U,K){if(K||(K=re.create()),U.active_period!=null&&U.active_period.length)for(var oe=0;oe<U.active_period.length;++oe)ne.transit_realtime.TimeRange.encode(U.active_period[oe],K.uint32(10).fork()).ldelim();if(U.informed_entity!=null&&U.informed_entity.length)for(var oe=0;oe<U.informed_entity.length;++oe)ne.transit_realtime.EntitySelector.encode(U.informed_entity[oe],K.uint32(42).fork()).ldelim();return U.cause!=null&&Object.hasOwnProperty.call(U,"cause")&&K.uint32(48).int32(U.cause),U.effect!=null&&Object.hasOwnProperty.call(U,"effect")&&K.uint32(56).int32(U.effect),U.url!=null&&Object.hasOwnProperty.call(U,"url")&&ne.transit_realtime.TranslatedString.encode(U.url,K.uint32(66).fork()).ldelim(),U.header_text!=null&&Object.hasOwnProperty.call(U,"header_text")&&ne.transit_realtime.TranslatedString.encode(U.header_text,K.uint32(82).fork()).ldelim(),U.description_text!=null&&Object.hasOwnProperty.call(U,"description_text")&&ne.transit_realtime.TranslatedString.encode(U.description_text,K.uint32(90).fork()).ldelim(),U.tts_header_text!=null&&Object.hasOwnProperty.call(U,"tts_header_text")&&ne.transit_realtime.TranslatedString.encode(U.tts_header_text,K.uint32(98).fork()).ldelim(),U.tts_description_text!=null&&Object.hasOwnProperty.call(U,"tts_description_text")&&ne.transit_realtime.TranslatedString.encode(U.tts_description_text,K.uint32(106).fork()).ldelim(),U.severity_level!=null&&Object.hasOwnProperty.call(U,"severity_level")&&K.uint32(112).int32(U.severity_level),U.image!=null&&Object.hasOwnProperty.call(U,"image")&&ne.transit_realtime.TranslatedImage.encode(U.image,K.uint32(122).fork()).ldelim(),U.image_alternative_text!=null&&Object.hasOwnProperty.call(U,"image_alternative_text")&&ne.transit_realtime.TranslatedString.encode(U.image_alternative_text,K.uint32(130).fork()).ldelim(),U.cause_detail!=null&&Object.hasOwnProperty.call(U,"cause_detail")&&ne.transit_realtime.TranslatedString.encode(U.cause_detail,K.uint32(138).fork()).ldelim(),U.effect_detail!=null&&Object.hasOwnProperty.call(U,"effect_detail")&&ne.transit_realtime.TranslatedString.encode(U.effect_detail,K.uint32(146).fork()).ldelim(),K},ee.encodeDelimited=function(U,K){return this.encode(U,K).ldelim()},ee.decode=function(U,K,oe){U instanceof Y||(U=Y.create(U));for(var pe=K===void 0?U.len:U.pos+K,_e=new ne.transit_realtime.Alert;U.pos<pe;){var me=U.uint32();if(me===oe)break;switch(me>>>3){case 1:{_e.active_period&&_e.active_period.length||(_e.active_period=[]),_e.active_period.push(ne.transit_realtime.TimeRange.decode(U,U.uint32()));break}case 5:{_e.informed_entity&&_e.informed_entity.length||(_e.informed_entity=[]),_e.informed_entity.push(ne.transit_realtime.EntitySelector.decode(U,U.uint32()));break}case 6:{_e.cause=U.int32();break}case 7:{_e.effect=U.int32();break}case 8:{_e.url=ne.transit_realtime.TranslatedString.decode(U,U.uint32());break}case 10:{_e.header_text=ne.transit_realtime.TranslatedString.decode(U,U.uint32());break}case 11:{_e.description_text=ne.transit_realtime.TranslatedString.decode(U,U.uint32());break}case 12:{_e.tts_header_text=ne.transit_realtime.TranslatedString.decode(U,U.uint32());break}case 13:{_e.tts_description_text=ne.transit_realtime.TranslatedString.decode(U,U.uint32());break}case 14:{_e.severity_level=U.int32();break}case 15:{_e.image=ne.transit_realtime.TranslatedImage.decode(U,U.uint32());break}case 16:{_e.image_alternative_text=ne.transit_realtime.TranslatedString.decode(U,U.uint32());break}case 17:{_e.cause_detail=ne.transit_realtime.TranslatedString.decode(U,U.uint32());break}case 18:{_e.effect_detail=ne.transit_realtime.TranslatedString.decode(U,U.uint32());break}default:U.skipType(me&7);break}}return _e},ee.decodeDelimited=function(U){return U instanceof Y||(U=new Y(U)),this.decode(U,U.uint32())},ee.verify=function(U){if(typeof U!="object"||U===null)return"object expected";if(U.active_period!=null&&U.hasOwnProperty("active_period")){if(!Array.isArray(U.active_period))return"active_period: array expected";for(var K=0;K<U.active_period.length;++K){var oe=ne.transit_realtime.TimeRange.verify(U.active_period[K]);if(oe)return"active_period."+oe}}if(U.informed_entity!=null&&U.hasOwnProperty("informed_entity")){if(!Array.isArray(U.informed_entity))return"informed_entity: array expected";for(var K=0;K<U.informed_entity.length;++K){var oe=ne.transit_realtime.EntitySelector.verify(U.informed_entity[K]);if(oe)return"informed_entity."+oe}}if(U.cause!=null&&U.hasOwnProperty("cause"))switch(U.cause){default:return"cause: enum value expected";case 1:case 2:case 3:case 4:case 5:case 6:case 7:case 8:case 9:case 10:case 11:case 12:break}if(U.effect!=null&&U.hasOwnProperty("effect"))switch(U.effect){default:return"effect: enum value expected";case 1:case 2:case 3:case 4:case 5:case 6:case 7:case 8:case 9:case 10:case 11:break}if(U.url!=null&&U.hasOwnProperty("url")){var oe=ne.transit_realtime.TranslatedString.verify(U.url);if(oe)return"url."+oe}if(U.header_text!=null&&U.hasOwnProperty("header_text")){var oe=ne.transit_realtime.TranslatedString.verify(U.header_text);if(oe)return"header_text."+oe}if(U.description_text!=null&&U.hasOwnProperty("description_text")){var oe=ne.transit_realtime.TranslatedString.verify(U.description_text);if(oe)return"description_text."+oe}if(U.tts_header_text!=null&&U.hasOwnProperty("tts_header_text")){var oe=ne.transit_realtime.TranslatedString.verify(U.tts_header_text);if(oe)return"tts_header_text."+oe}if(U.tts_description_text!=null&&U.hasOwnProperty("tts_description_text")){var oe=ne.transit_realtime.TranslatedString.verify(U.tts_description_text);if(oe)return"tts_description_text."+oe}if(U.severity_level!=null&&U.hasOwnProperty("severity_level"))switch(U.severity_level){default:return"severity_level: enum value expected";case 1:case 2:case 3:case 4:break}if(U.image!=null&&U.hasOwnProperty("image")){var oe=ne.transit_realtime.TranslatedImage.verify(U.image);if(oe)return"image."+oe}if(U.image_alternative_text!=null&&U.hasOwnProperty("image_alternative_text")){var oe=ne.transit_realtime.TranslatedString.verify(U.image_alternative_text);if(oe)return"image_alternative_text."+oe}if(U.cause_detail!=null&&U.hasOwnProperty("cause_detail")){var oe=ne.transit_realtime.TranslatedString.verify(U.cause_detail);if(oe)return"cause_detail."+oe}if(U.effect_detail!=null&&U.hasOwnProperty("effect_detail")){var oe=ne.transit_realtime.TranslatedString.verify(U.effect_detail);if(oe)return"effect_detail."+oe}return null},ee.fromObject=function(U){if(U instanceof ne.transit_realtime.Alert)return U;var K=new ne.transit_realtime.Alert;if(U.active_period){if(!Array.isArray(U.active_period))throw TypeError(".transit_realtime.Alert.active_period: array expected");K.active_period=[];for(var oe=0;oe<U.active_period.length;++oe){if(typeof U.active_period[oe]!="object")throw TypeError(".transit_realtime.Alert.active_period: object expected");K.active_period[oe]=ne.transit_realtime.TimeRange.fromObject(U.active_period[oe])}}if(U.informed_entity){if(!Array.isArray(U.informed_entity))throw TypeError(".transit_realtime.Alert.informed_entity: array expected");K.informed_entity=[];for(var oe=0;oe<U.informed_entity.length;++oe){if(typeof U.informed_entity[oe]!="object")throw TypeError(".transit_realtime.Alert.informed_entity: object expected");K.informed_entity[oe]=ne.transit_realtime.EntitySelector.fromObject(U.informed_entity[oe])}}switch(U.cause){default:if(typeof U.cause=="number"){K.cause=U.cause;break}break;case"UNKNOWN_CAUSE":case 1:K.cause=1;break;case"OTHER_CAUSE":case 2:K.cause=2;break;case"TECHNICAL_PROBLEM":case 3:K.cause=3;break;case"STRIKE":case 4:K.cause=4;break;case"DEMONSTRATION":case 5:K.cause=5;break;case"ACCIDENT":case 6:K.cause=6;break;case"HOLIDAY":case 7:K.cause=7;break;case"WEATHER":case 8:K.cause=8;break;case"MAINTENANCE":case 9:K.cause=9;break;case"CONSTRUCTION":case 10:K.cause=10;break;case"POLICE_ACTIVITY":case 11:K.cause=11;break;case"MEDICAL_EMERGENCY":case 12:K.cause=12;break}switch(U.effect){case"NO_SERVICE":case 1:K.effect=1;break;case"REDUCED_SERVICE":case 2:K.effect=2;break;case"SIGNIFICANT_DELAYS":case 3:K.effect=3;break;case"DETOUR":case 4:K.effect=4;break;case"ADDITIONAL_SERVICE":case 5:K.effect=5;break;case"MODIFIED_SERVICE":case 6:K.effect=6;break;case"OTHER_EFFECT":case 7:K.effect=7;break;default:if(typeof U.effect=="number"){K.effect=U.effect;break}break;case"UNKNOWN_EFFECT":case 8:K.effect=8;break;case"STOP_MOVED":case 9:K.effect=9;break;case"NO_EFFECT":case 10:K.effect=10;break;case"ACCESSIBILITY_ISSUE":case 11:K.effect=11;break}if(U.url!=null){if(typeof U.url!="object")throw TypeError(".transit_realtime.Alert.url: object expected");K.url=ne.transit_realtime.TranslatedString.fromObject(U.url)}if(U.header_text!=null){if(typeof U.header_text!="object")throw TypeError(".transit_realtime.Alert.header_text: object expected");K.header_text=ne.transit_realtime.TranslatedString.fromObject(U.header_text)}if(U.description_text!=null){if(typeof U.description_text!="object")throw TypeError(".transit_realtime.Alert.description_text: object expected");K.description_text=ne.transit_realtime.TranslatedString.fromObject(U.description_text)}if(U.tts_header_text!=null){if(typeof U.tts_header_text!="object")throw TypeError(".transit_realtime.Alert.tts_header_text: object expected");K.tts_header_text=ne.transit_realtime.TranslatedString.fromObject(U.tts_header_text)}if(U.tts_description_text!=null){if(typeof U.tts_description_text!="object")throw TypeError(".transit_realtime.Alert.tts_description_text: object expected");K.tts_description_text=ne.transit_realtime.TranslatedString.fromObject(U.tts_description_text)}switch(U.severity_level){default:if(typeof U.severity_level=="number"){K.severity_level=U.severity_level;break}break;case"UNKNOWN_SEVERITY":case 1:K.severity_level=1;break;case"INFO":case 2:K.severity_level=2;break;case"WARNING":case 3:K.severity_level=3;break;case"SEVERE":case 4:K.severity_level=4;break}if(U.image!=null){if(typeof U.image!="object")throw TypeError(".transit_realtime.Alert.image: object expected");K.image=ne.transit_realtime.TranslatedImage.fromObject(U.image)}if(U.image_alternative_text!=null){if(typeof U.image_alternative_text!="object")throw TypeError(".transit_realtime.Alert.image_alternative_text: object expected");K.image_alternative_text=ne.transit_realtime.TranslatedString.fromObject(U.image_alternative_text)}if(U.cause_detail!=null){if(typeof U.cause_detail!="object")throw TypeError(".transit_realtime.Alert.cause_detail: object expected");K.cause_detail=ne.transit_realtime.TranslatedString.fromObject(U.cause_detail)}if(U.effect_detail!=null){if(typeof U.effect_detail!="object")throw TypeError(".transit_realtime.Alert.effect_detail: object expected");K.effect_detail=ne.transit_realtime.TranslatedString.fromObject(U.effect_detail)}return K},ee.toObject=function(U,K){K||(K={});var oe={};if((K.arrays||K.defaults)&&(oe.active_period=[],oe.informed_entity=[]),K.defaults&&(oe.cause=K.enums===String?"UNKNOWN_CAUSE":1,oe.effect=K.enums===String?"UNKNOWN_EFFECT":8,oe.url=null,oe.header_text=null,oe.description_text=null,oe.tts_header_text=null,oe.tts_description_text=null,oe.severity_level=K.enums===String?"UNKNOWN_SEVERITY":1,oe.image=null,oe.image_alternative_text=null,oe.cause_detail=null,oe.effect_detail=null),U.active_period&&U.active_period.length){oe.active_period=[];for(var pe=0;pe<U.active_period.length;++pe)oe.active_period[pe]=ne.transit_realtime.TimeRange.toObject(U.active_period[pe],K)}if(U.informed_entity&&U.informed_entity.length){oe.informed_entity=[];for(var pe=0;pe<U.informed_entity.length;++pe)oe.informed_entity[pe]=ne.transit_realtime.EntitySelector.toObject(U.informed_entity[pe],K)}return U.cause!=null&&U.hasOwnProperty("cause")&&(oe.cause=K.enums===String?ne.transit_realtime.Alert.Cause[U.cause]===void 0?U.cause:ne.transit_realtime.Alert.Cause[U.cause]:U.cause),U.effect!=null&&U.hasOwnProperty("effect")&&(oe.effect=K.enums===String?ne.transit_realtime.Alert.Effect[U.effect]===void 0?U.effect:ne.transit_realtime.Alert.Effect[U.effect]:U.effect),U.url!=null&&U.hasOwnProperty("url")&&(oe.url=ne.transit_realtime.TranslatedString.toObject(U.url,K)),U.header_text!=null&&U.hasOwnProperty("header_text")&&(oe.header_text=ne.transit_realtime.TranslatedString.toObject(U.header_text,K)),U.description_text!=null&&U.hasOwnProperty("description_text")&&(oe.description_text=ne.transit_realtime.TranslatedString.toObject(U.description_text,K)),U.tts_header_text!=null&&U.hasOwnProperty("tts_header_text")&&(oe.tts_header_text=ne.transit_realtime.TranslatedString.toObject(U.tts_header_text,K)),U.tts_description_text!=null&&U.hasOwnProperty("tts_description_text")&&(oe.tts_description_text=ne.transit_realtime.TranslatedString.toObject(U.tts_description_text,K)),U.severity_level!=null&&U.hasOwnProperty("severity_level")&&(oe.severity_level=K.enums===String?ne.transit_realtime.Alert.SeverityLevel[U.severity_level]===void 0?U.severity_level:ne.transit_realtime.Alert.SeverityLevel[U.severity_level]:U.severity_level),U.image!=null&&U.hasOwnProperty("image")&&(oe.image=ne.transit_realtime.TranslatedImage.toObject(U.image,K)),U.image_alternative_text!=null&&U.hasOwnProperty("image_alternative_text")&&(oe.image_alternative_text=ne.transit_realtime.TranslatedString.toObject(U.image_alternative_text,K)),U.cause_detail!=null&&U.hasOwnProperty("cause_detail")&&(oe.cause_detail=ne.transit_realtime.TranslatedString.toObject(U.cause_detail,K)),U.effect_detail!=null&&U.hasOwnProperty("effect_detail")&&(oe.effect_detail=ne.transit_realtime.TranslatedString.toObject(U.effect_detail,K)),oe},ee.prototype.toJSON=function(){return this.constructor.toObject(this,J.util.toJSONOptions)},ee.getTypeUrl=function(U){return U===void 0&&(U="type.googleapis.com"),U+"/transit_realtime.Alert"},ee.Cause=(function(){var R={},U=Object.create(R);return U[R[1]="UNKNOWN_CAUSE"]=1,U[R[2]="OTHER_CAUSE"]=2,U[R[3]="TECHNICAL_PROBLEM"]=3,U[R[4]="STRIKE"]=4,U[R[5]="DEMONSTRATION"]=5,U[R[6]="ACCIDENT"]=6,U[R[7]="HOLIDAY"]=7,U[R[8]="WEATHER"]=8,U[R[9]="MAINTENANCE"]=9,U[R[10]="CONSTRUCTION"]=10,U[R[11]="POLICE_ACTIVITY"]=11,U[R[12]="MEDICAL_EMERGENCY"]=12,U})(),ee.Effect=(function(){var R={},U=Object.create(R);return U[R[1]="NO_SERVICE"]=1,U[R[2]="REDUCED_SERVICE"]=2,U[R[3]="SIGNIFICANT_DELAYS"]=3,U[R[4]="DETOUR"]=4,U[R[5]="ADDITIONAL_SERVICE"]=5,U[R[6]="MODIFIED_SERVICE"]=6,U[R[7]="OTHER_EFFECT"]=7,U[R[8]="UNKNOWN_EFFECT"]=8,U[R[9]="STOP_MOVED"]=9,U[R[10]="NO_EFFECT"]=10,U[R[11]="ACCESSIBILITY_ISSUE"]=11,U})(),ee.SeverityLevel=(function(){var R={},U=Object.create(R);return U[R[1]="UNKNOWN_SEVERITY"]=1,U[R[2]="INFO"]=2,U[R[3]="WARNING"]=3,U[R[4]="SEVERE"]=4,U})(),ee})(),ce.TimeRange=(function(){function ee(R){if(R)for(var U=Object.keys(R),K=0;K<U.length;++K)R[U[K]]!=null&&(this[U[K]]=R[U[K]])}return ee.prototype.start=ae.Long?ae.Long.fromBits(0,0,!0):0,ee.prototype.end=ae.Long?ae.Long.fromBits(0,0,!0):0,ee.create=function(U){return new ee(U)},ee.encode=function(U,K){return K||(K=re.create()),U.start!=null&&Object.hasOwnProperty.call(U,"start")&&K.uint32(8).uint64(U.start),U.end!=null&&Object.hasOwnProperty.call(U,"end")&&K.uint32(16).uint64(U.end),K},ee.encodeDelimited=function(U,K){return this.encode(U,K).ldelim()},ee.decode=function(U,K,oe){U instanceof Y||(U=Y.create(U));for(var pe=K===void 0?U.len:U.pos+K,_e=new ne.transit_realtime.TimeRange;U.pos<pe;){var me=U.uint32();if(me===oe)break;switch(me>>>3){case 1:{_e.start=U.uint64();break}case 2:{_e.end=U.uint64();break}default:U.skipType(me&7);break}}return _e},ee.decodeDelimited=function(U){return U instanceof Y||(U=new Y(U)),this.decode(U,U.uint32())},ee.verify=function(U){return typeof U!="object"||U===null?"object expected":U.start!=null&&U.hasOwnProperty("start")&&!ae.isInteger(U.start)&&!(U.start&&ae.isInteger(U.start.low)&&ae.isInteger(U.start.high))?"start: integer|Long expected":U.end!=null&&U.hasOwnProperty("end")&&!ae.isInteger(U.end)&&!(U.end&&ae.isInteger(U.end.low)&&ae.isInteger(U.end.high))?"end: integer|Long expected":null},ee.fromObject=function(U){if(U instanceof ne.transit_realtime.TimeRange)return U;var K=new ne.transit_realtime.TimeRange;return U.start!=null&&(ae.Long?(K.start=ae.Long.fromValue(U.start)).unsigned=!0:typeof U.start=="string"?K.start=parseInt(U.start,10):typeof U.start=="number"?K.start=U.start:typeof U.start=="object"&&(K.start=new ae.LongBits(U.start.low>>>0,U.start.high>>>0).toNumber(!0))),U.end!=null&&(ae.Long?(K.end=ae.Long.fromValue(U.end)).unsigned=!0:typeof U.end=="string"?K.end=parseInt(U.end,10):typeof U.end=="number"?K.end=U.end:typeof U.end=="object"&&(K.end=new ae.LongBits(U.end.low>>>0,U.end.high>>>0).toNumber(!0))),K},ee.toObject=function(U,K){K||(K={});var oe={};if(K.defaults){if(ae.Long){var pe=new ae.Long(0,0,!0);oe.start=K.longs===String?pe.toString():K.longs===Number?pe.toNumber():pe}else oe.start=K.longs===String?"0":0;if(ae.Long){var pe=new ae.Long(0,0,!0);oe.end=K.longs===String?pe.toString():K.longs===Number?pe.toNumber():pe}else oe.end=K.longs===String?"0":0}return U.start!=null&&U.hasOwnProperty("start")&&(typeof U.start=="number"?oe.start=K.longs===String?String(U.start):U.start:oe.start=K.longs===String?ae.Long.prototype.toString.call(U.start):K.longs===Number?new ae.LongBits(U.start.low>>>0,U.start.high>>>0).toNumber(!0):U.start),U.end!=null&&U.hasOwnProperty("end")&&(typeof U.end=="number"?oe.end=K.longs===String?String(U.end):U.end:oe.end=K.longs===String?ae.Long.prototype.toString.call(U.end):K.longs===Number?new ae.LongBits(U.end.low>>>0,U.end.high>>>0).toNumber(!0):U.end),oe},ee.prototype.toJSON=function(){return this.constructor.toObject(this,J.util.toJSONOptions)},ee.getTypeUrl=function(U){return U===void 0&&(U="type.googleapis.com"),U+"/transit_realtime.TimeRange"},ee})(),ce.Position=(function(){function ee(R){if(R)for(var U=Object.keys(R),K=0;K<U.length;++K)R[U[K]]!=null&&(this[U[K]]=R[U[K]])}return ee.prototype.latitude=0,ee.prototype.longitude=0,ee.prototype.bearing=0,ee.prototype.odometer=0,ee.prototype.speed=0,ee.create=function(U){return new ee(U)},ee.encode=function(U,K){return K||(K=re.create()),K.uint32(13).float(U.latitude),K.uint32(21).float(U.longitude),U.bearing!=null&&Object.hasOwnProperty.call(U,"bearing")&&K.uint32(29).float(U.bearing),U.odometer!=null&&Object.hasOwnProperty.call(U,"odometer")&&K.uint32(33).double(U.odometer),U.speed!=null&&Object.hasOwnProperty.call(U,"speed")&&K.uint32(45).float(U.speed),K},ee.encodeDelimited=function(U,K){return this.encode(U,K).ldelim()},ee.decode=function(U,K,oe){U instanceof Y||(U=Y.create(U));for(var pe=K===void 0?U.len:U.pos+K,_e=new ne.transit_realtime.Position;U.pos<pe;){var me=U.uint32();if(me===oe)break;switch(me>>>3){case 1:{_e.latitude=U.float();break}case 2:{_e.longitude=U.float();break}case 3:{_e.bearing=U.float();break}case 4:{_e.odometer=U.double();break}case 5:{_e.speed=U.float();break}default:U.skipType(me&7);break}}if(!_e.hasOwnProperty("latitude"))throw ae.ProtocolError("missing required 'latitude'",{instance:_e});if(!_e.hasOwnProperty("longitude"))throw ae.ProtocolError("missing required 'longitude'",{instance:_e});return _e},ee.decodeDelimited=function(U){return U instanceof Y||(U=new Y(U)),this.decode(U,U.uint32())},ee.verify=function(U){return typeof U!="object"||U===null?"object expected":typeof U.latitude!="number"?"latitude: number expected":typeof U.longitude!="number"?"longitude: number expected":U.bearing!=null&&U.hasOwnProperty("bearing")&&typeof U.bearing!="number"?"bearing: number expected":U.odometer!=null&&U.hasOwnProperty("odometer")&&typeof U.odometer!="number"?"odometer: number expected":U.speed!=null&&U.hasOwnProperty("speed")&&typeof U.speed!="number"?"speed: number expected":null},ee.fromObject=function(U){if(U instanceof ne.transit_realtime.Position)return U;var K=new ne.transit_realtime.Position;return U.latitude!=null&&(K.latitude=Number(U.latitude)),U.longitude!=null&&(K.longitude=Number(U.longitude)),U.bearing!=null&&(K.bearing=Number(U.bearing)),U.odometer!=null&&(K.odometer=Number(U.odometer)),U.speed!=null&&(K.speed=Number(U.speed)),K},ee.toObject=function(U,K){K||(K={});var oe={};return K.defaults&&(oe.latitude=0,oe.longitude=0,oe.bearing=0,oe.odometer=0,oe.speed=0),U.latitude!=null&&U.hasOwnProperty("latitude")&&(oe.latitude=K.json&&!isFinite(U.latitude)?String(U.latitude):U.latitude),U.longitude!=null&&U.hasOwnProperty("longitude")&&(oe.longitude=K.json&&!isFinite(U.longitude)?String(U.longitude):U.longitude),U.bearing!=null&&U.hasOwnProperty("bearing")&&(oe.bearing=K.json&&!isFinite(U.bearing)?String(U.bearing):U.bearing),U.odometer!=null&&U.hasOwnProperty("odometer")&&(oe.odometer=K.json&&!isFinite(U.odometer)?String(U.odometer):U.odometer),U.speed!=null&&U.hasOwnProperty("speed")&&(oe.speed=K.json&&!isFinite(U.speed)?String(U.speed):U.speed),oe},ee.prototype.toJSON=function(){return this.constructor.toObject(this,J.util.toJSONOptions)},ee.getTypeUrl=function(U){return U===void 0&&(U="type.googleapis.com"),U+"/transit_realtime.Position"},ee})(),ce.TripDescriptor=(function(){function ee(R){if(R)for(var U=Object.keys(R),K=0;K<U.length;++K)R[U[K]]!=null&&(this[U[K]]=R[U[K]])}return ee.prototype.trip_id="",ee.prototype.route_id="",ee.prototype.direction_id=0,ee.prototype.start_time="",ee.prototype.start_date="",ee.prototype.schedule_relationship=0,ee.prototype.modified_trip=null,ee.create=function(U){return new ee(U)},ee.encode=function(U,K){return K||(K=re.create()),U.trip_id!=null&&Object.hasOwnProperty.call(U,"trip_id")&&K.uint32(10).string(U.trip_id),U.start_time!=null&&Object.hasOwnProperty.call(U,"start_time")&&K.uint32(18).string(U.start_time),U.start_date!=null&&Object.hasOwnProperty.call(U,"start_date")&&K.uint32(26).string(U.start_date),U.schedule_relationship!=null&&Object.hasOwnProperty.call(U,"schedule_relationship")&&K.uint32(32).int32(U.schedule_relationship),U.route_id!=null&&Object.hasOwnProperty.call(U,"route_id")&&K.uint32(42).string(U.route_id),U.direction_id!=null&&Object.hasOwnProperty.call(U,"direction_id")&&K.uint32(48).uint32(U.direction_id),U.modified_trip!=null&&Object.hasOwnProperty.call(U,"modified_trip")&&ne.transit_realtime.TripDescriptor.ModifiedTripSelector.encode(U.modified_trip,K.uint32(58).fork()).ldelim(),K},ee.encodeDelimited=function(U,K){return this.encode(U,K).ldelim()},ee.decode=function(U,K,oe){U instanceof Y||(U=Y.create(U));for(var pe=K===void 0?U.len:U.pos+K,_e=new ne.transit_realtime.TripDescriptor;U.pos<pe;){var me=U.uint32();if(me===oe)break;switch(me>>>3){case 1:{_e.trip_id=U.string();break}case 5:{_e.route_id=U.string();break}case 6:{_e.direction_id=U.uint32();break}case 2:{_e.start_time=U.string();break}case 3:{_e.start_date=U.string();break}case 4:{_e.schedule_relationship=U.int32();break}case 7:{_e.modified_trip=ne.transit_realtime.TripDescriptor.ModifiedTripSelector.decode(U,U.uint32());break}default:U.skipType(me&7);break}}return _e},ee.decodeDelimited=function(U){return U instanceof Y||(U=new Y(U)),this.decode(U,U.uint32())},ee.verify=function(U){if(typeof U!="object"||U===null)return"object expected";if(U.trip_id!=null&&U.hasOwnProperty("trip_id")&&!ae.isString(U.trip_id))return"trip_id: string expected";if(U.route_id!=null&&U.hasOwnProperty("route_id")&&!ae.isString(U.route_id))return"route_id: string expected";if(U.direction_id!=null&&U.hasOwnProperty("direction_id")&&!ae.isInteger(U.direction_id))return"direction_id: integer expected";if(U.start_time!=null&&U.hasOwnProperty("start_time")&&!ae.isString(U.start_time))return"start_time: string expected";if(U.start_date!=null&&U.hasOwnProperty("start_date")&&!ae.isString(U.start_date))return"start_date: string expected";if(U.schedule_relationship!=null&&U.hasOwnProperty("schedule_relationship"))switch(U.schedule_relationship){default:return"schedule_relationship: enum value expected";case 0:case 1:case 2:case 3:case 5:case 6:case 7:case 8:break}if(U.modified_trip!=null&&U.hasOwnProperty("modified_trip")){var K=ne.transit_realtime.TripDescriptor.ModifiedTripSelector.verify(U.modified_trip);if(K)return"modified_trip."+K}return null},ee.fromObject=function(U){if(U instanceof ne.transit_realtime.TripDescriptor)return U;var K=new ne.transit_realtime.TripDescriptor;switch(U.trip_id!=null&&(K.trip_id=String(U.trip_id)),U.route_id!=null&&(K.route_id=String(U.route_id)),U.direction_id!=null&&(K.direction_id=U.direction_id>>>0),U.start_time!=null&&(K.start_time=String(U.start_time)),U.start_date!=null&&(K.start_date=String(U.start_date)),U.schedule_relationship){default:if(typeof U.schedule_relationship=="number"){K.schedule_relationship=U.schedule_relationship;break}break;case"SCHEDULED":case 0:K.schedule_relationship=0;break;case"ADDED":case 1:K.schedule_relationship=1;break;case"UNSCHEDULED":case 2:K.schedule_relationship=2;break;case"CANCELED":case 3:K.schedule_relationship=3;break;case"REPLACEMENT":case 5:K.schedule_relationship=5;break;case"DUPLICATED":case 6:K.schedule_relationship=6;break;case"DELETED":case 7:K.schedule_relationship=7;break;case"NEW":case 8:K.schedule_relationship=8;break}if(U.modified_trip!=null){if(typeof U.modified_trip!="object")throw TypeError(".transit_realtime.TripDescriptor.modified_trip: object expected");K.modified_trip=ne.transit_realtime.TripDescriptor.ModifiedTripSelector.fromObject(U.modified_trip)}return K},ee.toObject=function(U,K){K||(K={});var oe={};return K.defaults&&(oe.trip_id="",oe.start_time="",oe.start_date="",oe.schedule_relationship=K.enums===String?"SCHEDULED":0,oe.route_id="",oe.direction_id=0,oe.modified_trip=null),U.trip_id!=null&&U.hasOwnProperty("trip_id")&&(oe.trip_id=U.trip_id),U.start_time!=null&&U.hasOwnProperty("start_time")&&(oe.start_time=U.start_time),U.start_date!=null&&U.hasOwnProperty("start_date")&&(oe.start_date=U.start_date),U.schedule_relationship!=null&&U.hasOwnProperty("schedule_relationship")&&(oe.schedule_relationship=K.enums===String?ne.transit_realtime.TripDescriptor.ScheduleRelationship[U.schedule_relationship]===void 0?U.schedule_relationship:ne.transit_realtime.TripDescriptor.ScheduleRelationship[U.schedule_relationship]:U.schedule_relationship),U.route_id!=null&&U.hasOwnProperty("route_id")&&(oe.route_id=U.route_id),U.direction_id!=null&&U.hasOwnProperty("direction_id")&&(oe.direction_id=U.direction_id),U.modified_trip!=null&&U.hasOwnProperty("modified_trip")&&(oe.modified_trip=ne.transit_realtime.TripDescriptor.ModifiedTripSelector.toObject(U.modified_trip,K)),oe},ee.prototype.toJSON=function(){return this.constructor.toObject(this,J.util.toJSONOptions)},ee.getTypeUrl=function(U){return U===void 0&&(U="type.googleapis.com"),U+"/transit_realtime.TripDescriptor"},ee.ScheduleRelationship=(function(){var R={},U=Object.create(R);return U[R[0]="SCHEDULED"]=0,U[R[1]="ADDED"]=1,U[R[2]="UNSCHEDULED"]=2,U[R[3]="CANCELED"]=3,U[R[5]="REPLACEMENT"]=5,U[R[6]="DUPLICATED"]=6,U[R[7]="DELETED"]=7,U[R[8]="NEW"]=8,U})(),ee.ModifiedTripSelector=(function(){function R(U){if(U)for(var K=Object.keys(U),oe=0;oe<K.length;++oe)U[K[oe]]!=null&&(this[K[oe]]=U[K[oe]])}return R.prototype.modifications_id="",R.prototype.affected_trip_id="",R.prototype.start_time="",R.prototype.start_date="",R.create=function(K){return new R(K)},R.encode=function(K,oe){return oe||(oe=re.create()),K.modifications_id!=null&&Object.hasOwnProperty.call(K,"modifications_id")&&oe.uint32(10).string(K.modifications_id),K.affected_trip_id!=null&&Object.hasOwnProperty.call(K,"affected_trip_id")&&oe.uint32(18).string(K.affected_trip_id),K.start_time!=null&&Object.hasOwnProperty.call(K,"start_time")&&oe.uint32(26).string(K.start_time),K.start_date!=null&&Object.hasOwnProperty.call(K,"start_date")&&oe.uint32(34).string(K.start_date),oe},R.encodeDelimited=function(K,oe){return this.encode(K,oe).ldelim()},R.decode=function(K,oe,pe){K instanceof Y||(K=Y.create(K));for(var _e=oe===void 0?K.len:K.pos+oe,me=new ne.transit_realtime.TripDescriptor.ModifiedTripSelector;K.pos<_e;){var we=K.uint32();if(we===pe)break;switch(we>>>3){case 1:{me.modifications_id=K.string();break}case 2:{me.affected_trip_id=K.string();break}case 3:{me.start_time=K.string();break}case 4:{me.start_date=K.string();break}default:K.skipType(we&7);break}}return me},R.decodeDelimited=function(K){return K instanceof Y||(K=new Y(K)),this.decode(K,K.uint32())},R.verify=function(K){return typeof K!="object"||K===null?"object expected":K.modifications_id!=null&&K.hasOwnProperty("modifications_id")&&!ae.isString(K.modifications_id)?"modifications_id: string expected":K.affected_trip_id!=null&&K.hasOwnProperty("affected_trip_id")&&!ae.isString(K.affected_trip_id)?"affected_trip_id: string expected":K.start_time!=null&&K.hasOwnProperty("start_time")&&!ae.isString(K.start_time)?"start_time: string expected":K.start_date!=null&&K.hasOwnProperty("start_date")&&!ae.isString(K.start_date)?"start_date: string expected":null},R.fromObject=function(K){if(K instanceof ne.transit_realtime.TripDescriptor.ModifiedTripSelector)return K;var oe=new ne.transit_realtime.TripDescriptor.ModifiedTripSelector;return K.modifications_id!=null&&(oe.modifications_id=String(K.modifications_id)),K.affected_trip_id!=null&&(oe.affected_trip_id=String(K.affected_trip_id)),K.start_time!=null&&(oe.start_time=String(K.start_time)),K.start_date!=null&&(oe.start_date=String(K.start_date)),oe},R.toObject=function(K,oe){oe||(oe={});var pe={};return oe.defaults&&(pe.modifications_id="",pe.affected_trip_id="",pe.start_time="",pe.start_date=""),K.modifications_id!=null&&K.hasOwnProperty("modifications_id")&&(pe.modifications_id=K.modifications_id),K.affected_trip_id!=null&&K.hasOwnProperty("affected_trip_id")&&(pe.affected_trip_id=K.affected_trip_id),K.start_time!=null&&K.hasOwnProperty("start_time")&&(pe.start_time=K.start_time),K.start_date!=null&&K.hasOwnProperty("start_date")&&(pe.start_date=K.start_date),pe},R.prototype.toJSON=function(){return this.constructor.toObject(this,J.util.toJSONOptions)},R.getTypeUrl=function(K){return K===void 0&&(K="type.googleapis.com"),K+"/transit_realtime.TripDescriptor.ModifiedTripSelector"},R})(),ee})(),ce.VehicleDescriptor=(function(){function ee(R){if(R)for(var U=Object.keys(R),K=0;K<U.length;++K)R[U[K]]!=null&&(this[U[K]]=R[U[K]])}return ee.prototype.id="",ee.prototype.label="",ee.prototype.license_plate="",ee.prototype.wheelchair_accessible=0,ee.create=function(U){return new ee(U)},ee.encode=function(U,K){return K||(K=re.create()),U.id!=null&&Object.hasOwnProperty.call(U,"id")&&K.uint32(10).string(U.id),U.label!=null&&Object.hasOwnProperty.call(U,"label")&&K.uint32(18).string(U.label),U.license_plate!=null&&Object.hasOwnProperty.call(U,"license_plate")&&K.uint32(26).string(U.license_plate),U.wheelchair_accessible!=null&&Object.hasOwnProperty.call(U,"wheelchair_accessible")&&K.uint32(32).int32(U.wheelchair_accessible),K},ee.encodeDelimited=function(U,K){return this.encode(U,K).ldelim()},ee.decode=function(U,K,oe){U instanceof Y||(U=Y.create(U));for(var pe=K===void 0?U.len:U.pos+K,_e=new ne.transit_realtime.VehicleDescriptor;U.pos<pe;){var me=U.uint32();if(me===oe)break;switch(me>>>3){case 1:{_e.id=U.string();break}case 2:{_e.label=U.string();break}case 3:{_e.license_plate=U.string();break}case 4:{_e.wheelchair_accessible=U.int32();break}default:U.skipType(me&7);break}}return _e},ee.decodeDelimited=function(U){return U instanceof Y||(U=new Y(U)),this.decode(U,U.uint32())},ee.verify=function(U){if(typeof U!="object"||U===null)return"object expected";if(U.id!=null&&U.hasOwnProperty("id")&&!ae.isString(U.id))return"id: string expected";if(U.label!=null&&U.hasOwnProperty("label")&&!ae.isString(U.label))return"label: string expected";if(U.license_plate!=null&&U.hasOwnProperty("license_plate")&&!ae.isString(U.license_plate))return"license_plate: string expected";if(U.wheelchair_accessible!=null&&U.hasOwnProperty("wheelchair_accessible"))switch(U.wheelchair_accessible){default:return"wheelchair_accessible: enum value expected";case 0:case 1:case 2:case 3:break}return null},ee.fromObject=function(U){if(U instanceof ne.transit_realtime.VehicleDescriptor)return U;var K=new ne.transit_realtime.VehicleDescriptor;switch(U.id!=null&&(K.id=String(U.id)),U.label!=null&&(K.label=String(U.label)),U.license_plate!=null&&(K.license_plate=String(U.license_plate)),U.wheelchair_accessible){default:if(typeof U.wheelchair_accessible=="number"){K.wheelchair_accessible=U.wheelchair_accessible;break}break;case"NO_VALUE":case 0:K.wheelchair_accessible=0;break;case"UNKNOWN":case 1:K.wheelchair_accessible=1;break;case"WHEELCHAIR_ACCESSIBLE":case 2:K.wheelchair_accessible=2;break;case"WHEELCHAIR_INACCESSIBLE":case 3:K.wheelchair_accessible=3;break}return K},ee.toObject=function(U,K){K||(K={});var oe={};return K.defaults&&(oe.id="",oe.label="",oe.license_plate="",oe.wheelchair_accessible=K.enums===String?"NO_VALUE":0),U.id!=null&&U.hasOwnProperty("id")&&(oe.id=U.id),U.label!=null&&U.hasOwnProperty("label")&&(oe.label=U.label),U.license_plate!=null&&U.hasOwnProperty("license_plate")&&(oe.license_plate=U.license_plate),U.wheelchair_accessible!=null&&U.hasOwnProperty("wheelchair_accessible")&&(oe.wheelchair_accessible=K.enums===String?ne.transit_realtime.VehicleDescriptor.WheelchairAccessible[U.wheelchair_accessible]===void 0?U.wheelchair_accessible:ne.transit_realtime.VehicleDescriptor.WheelchairAccessible[U.wheelchair_accessible]:U.wheelchair_accessible),oe},ee.prototype.toJSON=function(){return this.constructor.toObject(this,J.util.toJSONOptions)},ee.getTypeUrl=function(U){return U===void 0&&(U="type.googleapis.com"),U+"/transit_realtime.VehicleDescriptor"},ee.WheelchairAccessible=(function(){var R={},U=Object.create(R);return U[R[0]="NO_VALUE"]=0,U[R[1]="UNKNOWN"]=1,U[R[2]="WHEELCHAIR_ACCESSIBLE"]=2,U[R[3]="WHEELCHAIR_INACCESSIBLE"]=3,U})(),ee})(),ce.EntitySelector=(function(){function ee(R){if(R)for(var U=Object.keys(R),K=0;K<U.length;++K)R[U[K]]!=null&&(this[U[K]]=R[U[K]])}return ee.prototype.agency_id="",ee.prototype.route_id="",ee.prototype.route_type=0,ee.prototype.trip=null,ee.prototype.stop_id="",ee.prototype.direction_id=0,ee.create=function(U){return new ee(U)},ee.encode=function(U,K){return K||(K=re.create()),U.agency_id!=null&&Object.hasOwnProperty.call(U,"agency_id")&&K.uint32(10).string(U.agency_id),U.route_id!=null&&Object.hasOwnProperty.call(U,"route_id")&&K.uint32(18).string(U.route_id),U.route_type!=null&&Object.hasOwnProperty.call(U,"route_type")&&K.uint32(24).int32(U.route_type),U.trip!=null&&Object.hasOwnProperty.call(U,"trip")&&ne.transit_realtime.TripDescriptor.encode(U.trip,K.uint32(34).fork()).ldelim(),U.stop_id!=null&&Object.hasOwnProperty.call(U,"stop_id")&&K.uint32(42).string(U.stop_id),U.direction_id!=null&&Object.hasOwnProperty.call(U,"direction_id")&&K.uint32(48).uint32(U.direction_id),K},ee.encodeDelimited=function(U,K){return this.encode(U,K).ldelim()},ee.decode=function(U,K,oe){U instanceof Y||(U=Y.create(U));for(var pe=K===void 0?U.len:U.pos+K,_e=new ne.transit_realtime.EntitySelector;U.pos<pe;){var me=U.uint32();if(me===oe)break;switch(me>>>3){case 1:{_e.agency_id=U.string();break}case 2:{_e.route_id=U.string();break}case 3:{_e.route_type=U.int32();break}case 4:{_e.trip=ne.transit_realtime.TripDescriptor.decode(U,U.uint32());break}case 5:{_e.stop_id=U.string();break}case 6:{_e.direction_id=U.uint32();break}default:U.skipType(me&7);break}}return _e},ee.decodeDelimited=function(U){return U instanceof Y||(U=new Y(U)),this.decode(U,U.uint32())},ee.verify=function(U){if(typeof U!="object"||U===null)return"object expected";if(U.agency_id!=null&&U.hasOwnProperty("agency_id")&&!ae.isString(U.agency_id))return"agency_id: string expected";if(U.route_id!=null&&U.hasOwnProperty("route_id")&&!ae.isString(U.route_id))return"route_id: string expected";if(U.route_type!=null&&U.hasOwnProperty("route_type")&&!ae.isInteger(U.route_type))return"route_type: integer expected";if(U.trip!=null&&U.hasOwnProperty("trip")){var K=ne.transit_realtime.TripDescriptor.verify(U.trip);if(K)return"trip."+K}return U.stop_id!=null&&U.hasOwnProperty("stop_id")&&!ae.isString(U.stop_id)?"stop_id: string expected":U.direction_id!=null&&U.hasOwnProperty("direction_id")&&!ae.isInteger(U.direction_id)?"direction_id: integer expected":null},ee.fromObject=function(U){if(U instanceof ne.transit_realtime.EntitySelector)return U;var K=new ne.transit_realtime.EntitySelector;if(U.agency_id!=null&&(K.agency_id=String(U.agency_id)),U.route_id!=null&&(K.route_id=String(U.route_id)),U.route_type!=null&&(K.route_type=U.route_type|0),U.trip!=null){if(typeof U.trip!="object")throw TypeError(".transit_realtime.EntitySelector.trip: object expected");K.trip=ne.transit_realtime.TripDescriptor.fromObject(U.trip)}return U.stop_id!=null&&(K.stop_id=String(U.stop_id)),U.direction_id!=null&&(K.direction_id=U.direction_id>>>0),K},ee.toObject=function(U,K){K||(K={});var oe={};return K.defaults&&(oe.agency_id="",oe.route_id="",oe.route_type=0,oe.trip=null,oe.stop_id="",oe.direction_id=0),U.agency_id!=null&&U.hasOwnProperty("agency_id")&&(oe.agency_id=U.agency_id),U.route_id!=null&&U.hasOwnProperty("route_id")&&(oe.route_id=U.route_id),U.route_type!=null&&U.hasOwnProperty("route_type")&&(oe.route_type=U.route_type),U.trip!=null&&U.hasOwnProperty("trip")&&(oe.trip=ne.transit_realtime.TripDescriptor.toObject(U.trip,K)),U.stop_id!=null&&U.hasOwnProperty("stop_id")&&(oe.stop_id=U.stop_id),U.direction_id!=null&&U.hasOwnProperty("direction_id")&&(oe.direction_id=U.direction_id),oe},ee.prototype.toJSON=function(){return this.constructor.toObject(this,J.util.toJSONOptions)},ee.getTypeUrl=function(U){return U===void 0&&(U="type.googleapis.com"),U+"/transit_realtime.EntitySelector"},ee})(),ce.TranslatedString=(function(){function ee(R){if(this.translation=[],R)for(var U=Object.keys(R),K=0;K<U.length;++K)R[U[K]]!=null&&(this[U[K]]=R[U[K]])}return ee.prototype.translation=ae.emptyArray,ee.create=function(U){return new ee(U)},ee.encode=function(U,K){if(K||(K=re.create()),U.translation!=null&&U.translation.length)for(var oe=0;oe<U.translation.length;++oe)ne.transit_realtime.TranslatedString.Translation.encode(U.translation[oe],K.uint32(10).fork()).ldelim();return K},ee.encodeDelimited=function(U,K){return this.encode(U,K).ldelim()},ee.decode=function(U,K,oe){U instanceof Y||(U=Y.create(U));for(var pe=K===void 0?U.len:U.pos+K,_e=new ne.transit_realtime.TranslatedString;U.pos<pe;){var me=U.uint32();if(me===oe)break;switch(me>>>3){case 1:{_e.translation&&_e.translation.length||(_e.translation=[]),_e.translation.push(ne.transit_realtime.TranslatedString.Translation.decode(U,U.uint32()));break}default:U.skipType(me&7);break}}return _e},ee.decodeDelimited=function(U){return U instanceof Y||(U=new Y(U)),this.decode(U,U.uint32())},ee.verify=function(U){if(typeof U!="object"||U===null)return"object expected";if(U.translation!=null&&U.hasOwnProperty("translation")){if(!Array.isArray(U.translation))return"translation: array expected";for(var K=0;K<U.translation.length;++K){var oe=ne.transit_realtime.TranslatedString.Translation.verify(U.translation[K]);if(oe)return"translation."+oe}}return null},ee.fromObject=function(U){if(U instanceof ne.transit_realtime.TranslatedString)return U;var K=new ne.transit_realtime.TranslatedString;if(U.translation){if(!Array.isArray(U.translation))throw TypeError(".transit_realtime.TranslatedString.translation: array expected");K.translation=[];for(var oe=0;oe<U.translation.length;++oe){if(typeof U.translation[oe]!="object")throw TypeError(".transit_realtime.TranslatedString.translation: object expected");K.translation[oe]=ne.transit_realtime.TranslatedString.Translation.fromObject(U.translation[oe])}}return K},ee.toObject=function(U,K){K||(K={});var oe={};if((K.arrays||K.defaults)&&(oe.translation=[]),U.translation&&U.translation.length){oe.translation=[];for(var pe=0;pe<U.translation.length;++pe)oe.translation[pe]=ne.transit_realtime.TranslatedString.Translation.toObject(U.translation[pe],K)}return oe},ee.prototype.toJSON=function(){return this.constructor.toObject(this,J.util.toJSONOptions)},ee.getTypeUrl=function(U){return U===void 0&&(U="type.googleapis.com"),U+"/transit_realtime.TranslatedString"},ee.Translation=(function(){function R(U){if(U)for(var K=Object.keys(U),oe=0;oe<K.length;++oe)U[K[oe]]!=null&&(this[K[oe]]=U[K[oe]])}return R.prototype.text="",R.prototype.language="",R.create=function(K){return new R(K)},R.encode=function(K,oe){return oe||(oe=re.create()),oe.uint32(10).string(K.text),K.language!=null&&Object.hasOwnProperty.call(K,"language")&&oe.uint32(18).string(K.language),oe},R.encodeDelimited=function(K,oe){return this.encode(K,oe).ldelim()},R.decode=function(K,oe,pe){K instanceof Y||(K=Y.create(K));for(var _e=oe===void 0?K.len:K.pos+oe,me=new ne.transit_realtime.TranslatedString.Translation;K.pos<_e;){var we=K.uint32();if(we===pe)break;switch(we>>>3){case 1:{me.text=K.string();break}case 2:{me.language=K.string();break}default:K.skipType(we&7);break}}if(!me.hasOwnProperty("text"))throw ae.ProtocolError("missing required 'text'",{instance:me});return me},R.decodeDelimited=function(K){return K instanceof Y||(K=new Y(K)),this.decode(K,K.uint32())},R.verify=function(K){return typeof K!="object"||K===null?"object expected":ae.isString(K.text)?K.language!=null&&K.hasOwnProperty("language")&&!ae.isString(K.language)?"language: string expected":null:"text: string expected"},R.fromObject=function(K){if(K instanceof ne.transit_realtime.TranslatedString.Translation)return K;var oe=new ne.transit_realtime.TranslatedString.Translation;return K.text!=null&&(oe.text=String(K.text)),K.language!=null&&(oe.language=String(K.language)),oe},R.toObject=function(K,oe){oe||(oe={});var pe={};return oe.defaults&&(pe.text="",pe.language=""),K.text!=null&&K.hasOwnProperty("text")&&(pe.text=K.text),K.language!=null&&K.hasOwnProperty("language")&&(pe.language=K.language),pe},R.prototype.toJSON=function(){return this.constructor.toObject(this,J.util.toJSONOptions)},R.getTypeUrl=function(K){return K===void 0&&(K="type.googleapis.com"),K+"/transit_realtime.TranslatedString.Translation"},R})(),ee})(),ce.TranslatedImage=(function(){function ee(R){if(this.localized_image=[],R)for(var U=Object.keys(R),K=0;K<U.length;++K)R[U[K]]!=null&&(this[U[K]]=R[U[K]])}return ee.prototype.localized_image=ae.emptyArray,ee.create=function(U){return new ee(U)},ee.encode=function(U,K){if(K||(K=re.create()),U.localized_image!=null&&U.localized_image.length)for(var oe=0;oe<U.localized_image.length;++oe)ne.transit_realtime.TranslatedImage.LocalizedImage.encode(U.localized_image[oe],K.uint32(10).fork()).ldelim();return K},ee.encodeDelimited=function(U,K){return this.encode(U,K).ldelim()},ee.decode=function(U,K,oe){U instanceof Y||(U=Y.create(U));for(var pe=K===void 0?U.len:U.pos+K,_e=new ne.transit_realtime.TranslatedImage;U.pos<pe;){var me=U.uint32();if(me===oe)break;switch(me>>>3){case 1:{_e.localized_image&&_e.localized_image.length||(_e.localized_image=[]),_e.localized_image.push(ne.transit_realtime.TranslatedImage.LocalizedImage.decode(U,U.uint32()));break}default:U.skipType(me&7);break}}return _e},ee.decodeDelimited=function(U){return U instanceof Y||(U=new Y(U)),this.decode(U,U.uint32())},ee.verify=function(U){if(typeof U!="object"||U===null)return"object expected";if(U.localized_image!=null&&U.hasOwnProperty("localized_image")){if(!Array.isArray(U.localized_image))return"localized_image: array expected";for(var K=0;K<U.localized_image.length;++K){var oe=ne.transit_realtime.TranslatedImage.LocalizedImage.verify(U.localized_image[K]);if(oe)return"localized_image."+oe}}return null},ee.fromObject=function(U){if(U instanceof ne.transit_realtime.TranslatedImage)return U;var K=new ne.transit_realtime.TranslatedImage;if(U.localized_image){if(!Array.isArray(U.localized_image))throw TypeError(".transit_realtime.TranslatedImage.localized_image: array expected");K.localized_image=[];for(var oe=0;oe<U.localized_image.length;++oe){if(typeof U.localized_image[oe]!="object")throw TypeError(".transit_realtime.TranslatedImage.localized_image: object expected");K.localized_image[oe]=ne.transit_realtime.TranslatedImage.LocalizedImage.fromObject(U.localized_image[oe])}}return K},ee.toObject=function(U,K){K||(K={});var oe={};if((K.arrays||K.defaults)&&(oe.localized_image=[]),U.localized_image&&U.localized_image.length){oe.localized_image=[];for(var pe=0;pe<U.localized_image.length;++pe)oe.localized_image[pe]=ne.transit_realtime.TranslatedImage.LocalizedImage.toObject(U.localized_image[pe],K)}return oe},ee.prototype.toJSON=function(){return this.constructor.toObject(this,J.util.toJSONOptions)},ee.getTypeUrl=function(U){return U===void 0&&(U="type.googleapis.com"),U+"/transit_realtime.TranslatedImage"},ee.LocalizedImage=(function(){function R(U){if(U)for(var K=Object.keys(U),oe=0;oe<K.length;++oe)U[K[oe]]!=null&&(this[K[oe]]=U[K[oe]])}return R.prototype.url="",R.prototype.media_type="",R.prototype.language="",R.create=function(K){return new R(K)},R.encode=function(K,oe){return oe||(oe=re.create()),oe.uint32(10).string(K.url),oe.uint32(18).string(K.media_type),K.language!=null&&Object.hasOwnProperty.call(K,"language")&&oe.uint32(26).string(K.language),oe},R.encodeDelimited=function(K,oe){return this.encode(K,oe).ldelim()},R.decode=function(K,oe,pe){K instanceof Y||(K=Y.create(K));for(var _e=oe===void 0?K.len:K.pos+oe,me=new ne.transit_realtime.TranslatedImage.LocalizedImage;K.pos<_e;){var we=K.uint32();if(we===pe)break;switch(we>>>3){case 1:{me.url=K.string();break}case 2:{me.media_type=K.string();break}case 3:{me.language=K.string();break}default:K.skipType(we&7);break}}if(!me.hasOwnProperty("url"))throw ae.ProtocolError("missing required 'url'",{instance:me});if(!me.hasOwnProperty("media_type"))throw ae.ProtocolError("missing required 'media_type'",{instance:me});return me},R.decodeDelimited=function(K){return K instanceof Y||(K=new Y(K)),this.decode(K,K.uint32())},R.verify=function(K){return typeof K!="object"||K===null?"object expected":ae.isString(K.url)?ae.isString(K.media_type)?K.language!=null&&K.hasOwnProperty("language")&&!ae.isString(K.language)?"language: string expected":null:"media_type: string expected":"url: string expected"},R.fromObject=function(K){if(K instanceof ne.transit_realtime.TranslatedImage.LocalizedImage)return K;var oe=new ne.transit_realtime.TranslatedImage.LocalizedImage;return K.url!=null&&(oe.url=String(K.url)),K.media_type!=null&&(oe.media_type=String(K.media_type)),K.language!=null&&(oe.language=String(K.language)),oe},R.toObject=function(K,oe){oe||(oe={});var pe={};return oe.defaults&&(pe.url="",pe.media_type="",pe.language=""),K.url!=null&&K.hasOwnProperty("url")&&(pe.url=K.url),K.media_type!=null&&K.hasOwnProperty("media_type")&&(pe.media_type=K.media_type),K.language!=null&&K.hasOwnProperty("language")&&(pe.language=K.language),pe},R.prototype.toJSON=function(){return this.constructor.toObject(this,J.util.toJSONOptions)},R.getTypeUrl=function(K){return K===void 0&&(K="type.googleapis.com"),K+"/transit_realtime.TranslatedImage.LocalizedImage"},R})(),ee})(),ce.Shape=(function(){function ee(R){if(R)for(var U=Object.keys(R),K=0;K<U.length;++K)R[U[K]]!=null&&(this[U[K]]=R[U[K]])}return ee.prototype.shape_id="",ee.prototype.encoded_polyline="",ee.create=function(U){return new ee(U)},ee.encode=function(U,K){return K||(K=re.create()),U.shape_id!=null&&Object.hasOwnProperty.call(U,"shape_id")&&K.uint32(10).string(U.shape_id),U.encoded_polyline!=null&&Object.hasOwnProperty.call(U,"encoded_polyline")&&K.uint32(18).string(U.encoded_polyline),K},ee.encodeDelimited=function(U,K){return this.encode(U,K).ldelim()},ee.decode=function(U,K,oe){U instanceof Y||(U=Y.create(U));for(var pe=K===void 0?U.len:U.pos+K,_e=new ne.transit_realtime.Shape;U.pos<pe;){var me=U.uint32();if(me===oe)break;switch(me>>>3){case 1:{_e.shape_id=U.string();break}case 2:{_e.encoded_polyline=U.string();break}default:U.skipType(me&7);break}}return _e},ee.decodeDelimited=function(U){return U instanceof Y||(U=new Y(U)),this.decode(U,U.uint32())},ee.verify=function(U){return typeof U!="object"||U===null?"object expected":U.shape_id!=null&&U.hasOwnProperty("shape_id")&&!ae.isString(U.shape_id)?"shape_id: string expected":U.encoded_polyline!=null&&U.hasOwnProperty("encoded_polyline")&&!ae.isString(U.encoded_polyline)?"encoded_polyline: string expected":null},ee.fromObject=function(U){if(U instanceof ne.transit_realtime.Shape)return U;var K=new ne.transit_realtime.Shape;return U.shape_id!=null&&(K.shape_id=String(U.shape_id)),U.encoded_polyline!=null&&(K.encoded_polyline=String(U.encoded_polyline)),K},ee.toObject=function(U,K){K||(K={});var oe={};return K.defaults&&(oe.shape_id="",oe.encoded_polyline=""),U.shape_id!=null&&U.hasOwnProperty("shape_id")&&(oe.shape_id=U.shape_id),U.encoded_polyline!=null&&U.hasOwnProperty("encoded_polyline")&&(oe.encoded_polyline=U.encoded_polyline),oe},ee.prototype.toJSON=function(){return this.constructor.toObject(this,J.util.toJSONOptions)},ee.getTypeUrl=function(U){return U===void 0&&(U="type.googleapis.com"),U+"/transit_realtime.Shape"},ee})(),ce.Stop=(function(){function ee(R){if(R)for(var U=Object.keys(R),K=0;K<U.length;++K)R[U[K]]!=null&&(this[U[K]]=R[U[K]])}return ee.prototype.stop_id="",ee.prototype.stop_code=null,ee.prototype.stop_name=null,ee.prototype.tts_stop_name=null,ee.prototype.stop_desc=null,ee.prototype.stop_lat=0,ee.prototype.stop_lon=0,ee.prototype.zone_id="",ee.prototype.stop_url=null,ee.prototype.parent_station="",ee.prototype.stop_timezone="",ee.prototype.wheelchair_boarding=0,ee.prototype.level_id="",ee.prototype.platform_code=null,ee.create=function(U){return new ee(U)},ee.encode=function(U,K){return K||(K=re.create()),U.stop_id!=null&&Object.hasOwnProperty.call(U,"stop_id")&&K.uint32(10).string(U.stop_id),U.stop_code!=null&&Object.hasOwnProperty.call(U,"stop_code")&&ne.transit_realtime.TranslatedString.encode(U.stop_code,K.uint32(18).fork()).ldelim(),U.stop_name!=null&&Object.hasOwnProperty.call(U,"stop_name")&&ne.transit_realtime.TranslatedString.encode(U.stop_name,K.uint32(26).fork()).ldelim(),U.tts_stop_name!=null&&Object.hasOwnProperty.call(U,"tts_stop_name")&&ne.transit_realtime.TranslatedString.encode(U.tts_stop_name,K.uint32(34).fork()).ldelim(),U.stop_desc!=null&&Object.hasOwnProperty.call(U,"stop_desc")&&ne.transit_realtime.TranslatedString.encode(U.stop_desc,K.uint32(42).fork()).ldelim(),U.stop_lat!=null&&Object.hasOwnProperty.call(U,"stop_lat")&&K.uint32(53).float(U.stop_lat),U.stop_lon!=null&&Object.hasOwnProperty.call(U,"stop_lon")&&K.uint32(61).float(U.stop_lon),U.zone_id!=null&&Object.hasOwnProperty.call(U,"zone_id")&&K.uint32(66).string(U.zone_id),U.stop_url!=null&&Object.hasOwnProperty.call(U,"stop_url")&&ne.transit_realtime.TranslatedString.encode(U.stop_url,K.uint32(74).fork()).ldelim(),U.parent_station!=null&&Object.hasOwnProperty.call(U,"parent_station")&&K.uint32(90).string(U.parent_station),U.stop_timezone!=null&&Object.hasOwnProperty.call(U,"stop_timezone")&&K.uint32(98).string(U.stop_timezone),U.wheelchair_boarding!=null&&Object.hasOwnProperty.call(U,"wheelchair_boarding")&&K.uint32(104).int32(U.wheelchair_boarding),U.level_id!=null&&Object.hasOwnProperty.call(U,"level_id")&&K.uint32(114).string(U.level_id),U.platform_code!=null&&Object.hasOwnProperty.call(U,"platform_code")&&ne.transit_realtime.TranslatedString.encode(U.platform_code,K.uint32(122).fork()).ldelim(),K},ee.encodeDelimited=function(U,K){return this.encode(U,K).ldelim()},ee.decode=function(U,K,oe){U instanceof Y||(U=Y.create(U));for(var pe=K===void 0?U.len:U.pos+K,_e=new ne.transit_realtime.Stop;U.pos<pe;){var me=U.uint32();if(me===oe)break;switch(me>>>3){case 1:{_e.stop_id=U.string();break}case 2:{_e.stop_code=ne.transit_realtime.TranslatedString.decode(U,U.uint32());break}case 3:{_e.stop_name=ne.transit_realtime.TranslatedString.decode(U,U.uint32());break}case 4:{_e.tts_stop_name=ne.transit_realtime.TranslatedString.decode(U,U.uint32());break}case 5:{_e.stop_desc=ne.transit_realtime.TranslatedString.decode(U,U.uint32());break}case 6:{_e.stop_lat=U.float();break}case 7:{_e.stop_lon=U.float();break}case 8:{_e.zone_id=U.string();break}case 9:{_e.stop_url=ne.transit_realtime.TranslatedString.decode(U,U.uint32());break}case 11:{_e.parent_station=U.string();break}case 12:{_e.stop_timezone=U.string();break}case 13:{_e.wheelchair_boarding=U.int32();break}case 14:{_e.level_id=U.string();break}case 15:{_e.platform_code=ne.transit_realtime.TranslatedString.decode(U,U.uint32());break}default:U.skipType(me&7);break}}return _e},ee.decodeDelimited=function(U){return U instanceof Y||(U=new Y(U)),this.decode(U,U.uint32())},ee.verify=function(U){if(typeof U!="object"||U===null)return"object expected";if(U.stop_id!=null&&U.hasOwnProperty("stop_id")&&!ae.isString(U.stop_id))return"stop_id: string expected";if(U.stop_code!=null&&U.hasOwnProperty("stop_code")){var K=ne.transit_realtime.TranslatedString.verify(U.stop_code);if(K)return"stop_code."+K}if(U.stop_name!=null&&U.hasOwnProperty("stop_name")){var K=ne.transit_realtime.TranslatedString.verify(U.stop_name);if(K)return"stop_name."+K}if(U.tts_stop_name!=null&&U.hasOwnProperty("tts_stop_name")){var K=ne.transit_realtime.TranslatedString.verify(U.tts_stop_name);if(K)return"tts_stop_name."+K}if(U.stop_desc!=null&&U.hasOwnProperty("stop_desc")){var K=ne.transit_realtime.TranslatedString.verify(U.stop_desc);if(K)return"stop_desc."+K}if(U.stop_lat!=null&&U.hasOwnProperty("stop_lat")&&typeof U.stop_lat!="number")return"stop_lat: number expected";if(U.stop_lon!=null&&U.hasOwnProperty("stop_lon")&&typeof U.stop_lon!="number")return"stop_lon: number expected";if(U.zone_id!=null&&U.hasOwnProperty("zone_id")&&!ae.isString(U.zone_id))return"zone_id: string expected";if(U.stop_url!=null&&U.hasOwnProperty("stop_url")){var K=ne.transit_realtime.TranslatedString.verify(U.stop_url);if(K)return"stop_url."+K}if(U.parent_station!=null&&U.hasOwnProperty("parent_station")&&!ae.isString(U.parent_station))return"parent_station: string expected";if(U.stop_timezone!=null&&U.hasOwnProperty("stop_timezone")&&!ae.isString(U.stop_timezone))return"stop_timezone: string expected";if(U.wheelchair_boarding!=null&&U.hasOwnProperty("wheelchair_boarding"))switch(U.wheelchair_boarding){default:return"wheelchair_boarding: enum value expected";case 0:case 1:case 2:break}if(U.level_id!=null&&U.hasOwnProperty("level_id")&&!ae.isString(U.level_id))return"level_id: string expected";if(U.platform_code!=null&&U.hasOwnProperty("platform_code")){var K=ne.transit_realtime.TranslatedString.verify(U.platform_code);if(K)return"platform_code."+K}return null},ee.fromObject=function(U){if(U instanceof ne.transit_realtime.Stop)return U;var K=new ne.transit_realtime.Stop;if(U.stop_id!=null&&(K.stop_id=String(U.stop_id)),U.stop_code!=null){if(typeof U.stop_code!="object")throw TypeError(".transit_realtime.Stop.stop_code: object expected");K.stop_code=ne.transit_realtime.TranslatedString.fromObject(U.stop_code)}if(U.stop_name!=null){if(typeof U.stop_name!="object")throw TypeError(".transit_realtime.Stop.stop_name: object expected");K.stop_name=ne.transit_realtime.TranslatedString.fromObject(U.stop_name)}if(U.tts_stop_name!=null){if(typeof U.tts_stop_name!="object")throw TypeError(".transit_realtime.Stop.tts_stop_name: object expected");K.tts_stop_name=ne.transit_realtime.TranslatedString.fromObject(U.tts_stop_name)}if(U.stop_desc!=null){if(typeof U.stop_desc!="object")throw TypeError(".transit_realtime.Stop.stop_desc: object expected");K.stop_desc=ne.transit_realtime.TranslatedString.fromObject(U.stop_desc)}if(U.stop_lat!=null&&(K.stop_lat=Number(U.stop_lat)),U.stop_lon!=null&&(K.stop_lon=Number(U.stop_lon)),U.zone_id!=null&&(K.zone_id=String(U.zone_id)),U.stop_url!=null){if(typeof U.stop_url!="object")throw TypeError(".transit_realtime.Stop.stop_url: object expected");K.stop_url=ne.transit_realtime.TranslatedString.fromObject(U.stop_url)}switch(U.parent_station!=null&&(K.parent_station=String(U.parent_station)),U.stop_timezone!=null&&(K.stop_timezone=String(U.stop_timezone)),U.wheelchair_boarding){default:if(typeof U.wheelchair_boarding=="number"){K.wheelchair_boarding=U.wheelchair_boarding;break}break;case"UNKNOWN":case 0:K.wheelchair_boarding=0;break;case"AVAILABLE":case 1:K.wheelchair_boarding=1;break;case"NOT_AVAILABLE":case 2:K.wheelchair_boarding=2;break}if(U.level_id!=null&&(K.level_id=String(U.level_id)),U.platform_code!=null){if(typeof U.platform_code!="object")throw TypeError(".transit_realtime.Stop.platform_code: object expected");K.platform_code=ne.transit_realtime.TranslatedString.fromObject(U.platform_code)}return K},ee.toObject=function(U,K){K||(K={});var oe={};return K.defaults&&(oe.stop_id="",oe.stop_code=null,oe.stop_name=null,oe.tts_stop_name=null,oe.stop_desc=null,oe.stop_lat=0,oe.stop_lon=0,oe.zone_id="",oe.stop_url=null,oe.parent_station="",oe.stop_timezone="",oe.wheelchair_boarding=K.enums===String?"UNKNOWN":0,oe.level_id="",oe.platform_code=null),U.stop_id!=null&&U.hasOwnProperty("stop_id")&&(oe.stop_id=U.stop_id),U.stop_code!=null&&U.hasOwnProperty("stop_code")&&(oe.stop_code=ne.transit_realtime.TranslatedString.toObject(U.stop_code,K)),U.stop_name!=null&&U.hasOwnProperty("stop_name")&&(oe.stop_name=ne.transit_realtime.TranslatedString.toObject(U.stop_name,K)),U.tts_stop_name!=null&&U.hasOwnProperty("tts_stop_name")&&(oe.tts_stop_name=ne.transit_realtime.TranslatedString.toObject(U.tts_stop_name,K)),U.stop_desc!=null&&U.hasOwnProperty("stop_desc")&&(oe.stop_desc=ne.transit_realtime.TranslatedString.toObject(U.stop_desc,K)),U.stop_lat!=null&&U.hasOwnProperty("stop_lat")&&(oe.stop_lat=K.json&&!isFinite(U.stop_lat)?String(U.stop_lat):U.stop_lat),U.stop_lon!=null&&U.hasOwnProperty("stop_lon")&&(oe.stop_lon=K.json&&!isFinite(U.stop_lon)?String(U.stop_lon):U.stop_lon),U.zone_id!=null&&U.hasOwnProperty("zone_id")&&(oe.zone_id=U.zone_id),U.stop_url!=null&&U.hasOwnProperty("stop_url")&&(oe.stop_url=ne.transit_realtime.TranslatedString.toObject(U.stop_url,K)),U.parent_station!=null&&U.hasOwnProperty("parent_station")&&(oe.parent_station=U.parent_station),U.stop_timezone!=null&&U.hasOwnProperty("stop_timezone")&&(oe.stop_timezone=U.stop_timezone),U.wheelchair_boarding!=null&&U.hasOwnProperty("wheelchair_boarding")&&(oe.wheelchair_boarding=K.enums===String?ne.transit_realtime.Stop.WheelchairBoarding[U.wheelchair_boarding]===void 0?U.wheelchair_boarding:ne.transit_realtime.Stop.WheelchairBoarding[U.wheelchair_boarding]:U.wheelchair_boarding),U.level_id!=null&&U.hasOwnProperty("level_id")&&(oe.level_id=U.level_id),U.platform_code!=null&&U.hasOwnProperty("platform_code")&&(oe.platform_code=ne.transit_realtime.TranslatedString.toObject(U.platform_code,K)),oe},ee.prototype.toJSON=function(){return this.constructor.toObject(this,J.util.toJSONOptions)},ee.getTypeUrl=function(U){return U===void 0&&(U="type.googleapis.com"),U+"/transit_realtime.Stop"},ee.WheelchairBoarding=(function(){var R={},U=Object.create(R);return U[R[0]="UNKNOWN"]=0,U[R[1]="AVAILABLE"]=1,U[R[2]="NOT_AVAILABLE"]=2,U})(),ee})(),ce.TripModifications=(function(){function ee(R){if(this.selected_trips=[],this.start_times=[],this.service_dates=[],this.modifications=[],R)for(var U=Object.keys(R),K=0;K<U.length;++K)R[U[K]]!=null&&(this[U[K]]=R[U[K]])}return ee.prototype.selected_trips=ae.emptyArray,ee.prototype.start_times=ae.emptyArray,ee.prototype.service_dates=ae.emptyArray,ee.prototype.modifications=ae.emptyArray,ee.create=function(U){return new ee(U)},ee.encode=function(U,K){if(K||(K=re.create()),U.selected_trips!=null&&U.selected_trips.length)for(var oe=0;oe<U.selected_trips.length;++oe)ne.transit_realtime.TripModifications.SelectedTrips.encode(U.selected_trips[oe],K.uint32(10).fork()).ldelim();if(U.start_times!=null&&U.start_times.length)for(var oe=0;oe<U.start_times.length;++oe)K.uint32(18).string(U.start_times[oe]);if(U.service_dates!=null&&U.service_dates.length)for(var oe=0;oe<U.service_dates.length;++oe)K.uint32(26).string(U.service_dates[oe]);if(U.modifications!=null&&U.modifications.length)for(var oe=0;oe<U.modifications.length;++oe)ne.transit_realtime.TripModifications.Modification.encode(U.modifications[oe],K.uint32(34).fork()).ldelim();return K},ee.encodeDelimited=function(U,K){return this.encode(U,K).ldelim()},ee.decode=function(U,K,oe){U instanceof Y||(U=Y.create(U));for(var pe=K===void 0?U.len:U.pos+K,_e=new ne.transit_realtime.TripModifications;U.pos<pe;){var me=U.uint32();if(me===oe)break;switch(me>>>3){case 1:{_e.selected_trips&&_e.selected_trips.length||(_e.selected_trips=[]),_e.selected_trips.push(ne.transit_realtime.TripModifications.SelectedTrips.decode(U,U.uint32()));break}case 2:{_e.start_times&&_e.start_times.length||(_e.start_times=[]),_e.start_times.push(U.string());break}case 3:{_e.service_dates&&_e.service_dates.length||(_e.service_dates=[]),_e.service_dates.push(U.string());break}case 4:{_e.modifications&&_e.modifications.length||(_e.modifications=[]),_e.modifications.push(ne.transit_realtime.TripModifications.Modification.decode(U,U.uint32()));break}default:U.skipType(me&7);break}}return _e},ee.decodeDelimited=function(U){return U instanceof Y||(U=new Y(U)),this.decode(U,U.uint32())},ee.verify=function(U){if(typeof U!="object"||U===null)return"object expected";if(U.selected_trips!=null&&U.hasOwnProperty("selected_trips")){if(!Array.isArray(U.selected_trips))return"selected_trips: array expected";for(var K=0;K<U.selected_trips.length;++K){var oe=ne.transit_realtime.TripModifications.SelectedTrips.verify(U.selected_trips[K]);if(oe)return"selected_trips."+oe}}if(U.start_times!=null&&U.hasOwnProperty("start_times")){if(!Array.isArray(U.start_times))return"start_times: array expected";for(var K=0;K<U.start_times.length;++K)if(!ae.isString(U.start_times[K]))return"start_times: string[] expected"}if(U.service_dates!=null&&U.hasOwnProperty("service_dates")){if(!Array.isArray(U.service_dates))return"service_dates: array expected";for(var K=0;K<U.service_dates.length;++K)if(!ae.isString(U.service_dates[K]))return"service_dates: string[] expected"}if(U.modifications!=null&&U.hasOwnProperty("modifications")){if(!Array.isArray(U.modifications))return"modifications: array expected";for(var K=0;K<U.modifications.length;++K){var oe=ne.transit_realtime.TripModifications.Modification.verify(U.modifications[K]);if(oe)return"modifications."+oe}}return null},ee.fromObject=function(U){if(U instanceof ne.transit_realtime.TripModifications)return U;var K=new ne.transit_realtime.TripModifications;if(U.selected_trips){if(!Array.isArray(U.selected_trips))throw TypeError(".transit_realtime.TripModifications.selected_trips: array expected");K.selected_trips=[];for(var oe=0;oe<U.selected_trips.length;++oe){if(typeof U.selected_trips[oe]!="object")throw TypeError(".transit_realtime.TripModifications.selected_trips: object expected");K.selected_trips[oe]=ne.transit_realtime.TripModifications.SelectedTrips.fromObject(U.selected_trips[oe])}}if(U.start_times){if(!Array.isArray(U.start_times))throw TypeError(".transit_realtime.TripModifications.start_times: array expected");K.start_times=[];for(var oe=0;oe<U.start_times.length;++oe)K.start_times[oe]=String(U.start_times[oe])}if(U.service_dates){if(!Array.isArray(U.service_dates))throw TypeError(".transit_realtime.TripModifications.service_dates: array expected");K.service_dates=[];for(var oe=0;oe<U.service_dates.length;++oe)K.service_dates[oe]=String(U.service_dates[oe])}if(U.modifications){if(!Array.isArray(U.modifications))throw TypeError(".transit_realtime.TripModifications.modifications: array expected");K.modifications=[];for(var oe=0;oe<U.modifications.length;++oe){if(typeof U.modifications[oe]!="object")throw TypeError(".transit_realtime.TripModifications.modifications: object expected");K.modifications[oe]=ne.transit_realtime.TripModifications.Modification.fromObject(U.modifications[oe])}}return K},ee.toObject=function(U,K){K||(K={});var oe={};if((K.arrays||K.defaults)&&(oe.selected_trips=[],oe.start_times=[],oe.service_dates=[],oe.modifications=[]),U.selected_trips&&U.selected_trips.length){oe.selected_trips=[];for(var pe=0;pe<U.selected_trips.length;++pe)oe.selected_trips[pe]=ne.transit_realtime.TripModifications.SelectedTrips.toObject(U.selected_trips[pe],K)}if(U.start_times&&U.start_times.length){oe.start_times=[];for(var pe=0;pe<U.start_times.length;++pe)oe.start_times[pe]=U.start_times[pe]}if(U.service_dates&&U.service_dates.length){oe.service_dates=[];for(var pe=0;pe<U.service_dates.length;++pe)oe.service_dates[pe]=U.service_dates[pe]}if(U.modifications&&U.modifications.length){oe.modifications=[];for(var pe=0;pe<U.modifications.length;++pe)oe.modifications[pe]=ne.transit_realtime.TripModifications.Modification.toObject(U.modifications[pe],K)}return oe},ee.prototype.toJSON=function(){return this.constructor.toObject(this,J.util.toJSONOptions)},ee.getTypeUrl=function(U){return U===void 0&&(U="type.googleapis.com"),U+"/transit_realtime.TripModifications"},ee.Modification=(function(){function R(U){if(this.replacement_stops=[],U)for(var K=Object.keys(U),oe=0;oe<K.length;++oe)U[K[oe]]!=null&&(this[K[oe]]=U[K[oe]])}return R.prototype.start_stop_selector=null,R.prototype.end_stop_selector=null,R.prototype.propagated_modification_delay=0,R.prototype.replacement_stops=ae.emptyArray,R.prototype.service_alert_id="",R.prototype.last_modified_time=ae.Long?ae.Long.fromBits(0,0,!0):0,R.create=function(K){return new R(K)},R.encode=function(K,oe){if(oe||(oe=re.create()),K.start_stop_selector!=null&&Object.hasOwnProperty.call(K,"start_stop_selector")&&ne.transit_realtime.StopSelector.encode(K.start_stop_selector,oe.uint32(10).fork()).ldelim(),K.end_stop_selector!=null&&Object.hasOwnProperty.call(K,"end_stop_selector")&&ne.transit_realtime.StopSelector.encode(K.end_stop_selector,oe.uint32(18).fork()).ldelim(),K.propagated_modification_delay!=null&&Object.hasOwnProperty.call(K,"propagated_modification_delay")&&oe.uint32(24).int32(K.propagated_modification_delay),K.replacement_stops!=null&&K.replacement_stops.length)for(var pe=0;pe<K.replacement_stops.length;++pe)ne.transit_realtime.ReplacementStop.encode(K.replacement_stops[pe],oe.uint32(34).fork()).ldelim();return K.service_alert_id!=null&&Object.hasOwnProperty.call(K,"service_alert_id")&&oe.uint32(42).string(K.service_alert_id),K.last_modified_time!=null&&Object.hasOwnProperty.call(K,"last_modified_time")&&oe.uint32(48).uint64(K.last_modified_time),oe},R.encodeDelimited=function(K,oe){return this.encode(K,oe).ldelim()},R.decode=function(K,oe,pe){K instanceof Y||(K=Y.create(K));for(var _e=oe===void 0?K.len:K.pos+oe,me=new ne.transit_realtime.TripModifications.Modification;K.pos<_e;){var we=K.uint32();if(we===pe)break;switch(we>>>3){case 1:{me.start_stop_selector=ne.transit_realtime.StopSelector.decode(K,K.uint32());break}case 2:{me.end_stop_selector=ne.transit_realtime.StopSelector.decode(K,K.uint32());break}case 3:{me.propagated_modification_delay=K.int32();break}case 4:{me.replacement_stops&&me.replacement_stops.length||(me.replacement_stops=[]),me.replacement_stops.push(ne.transit_realtime.ReplacementStop.decode(K,K.uint32()));break}case 5:{me.service_alert_id=K.string();break}case 6:{me.last_modified_time=K.uint64();break}default:K.skipType(we&7);break}}return me},R.decodeDelimited=function(K){return K instanceof Y||(K=new Y(K)),this.decode(K,K.uint32())},R.verify=function(K){if(typeof K!="object"||K===null)return"object expected";if(K.start_stop_selector!=null&&K.hasOwnProperty("start_stop_selector")){var oe=ne.transit_realtime.StopSelector.verify(K.start_stop_selector);if(oe)return"start_stop_selector."+oe}if(K.end_stop_selector!=null&&K.hasOwnProperty("end_stop_selector")){var oe=ne.transit_realtime.StopSelector.verify(K.end_stop_selector);if(oe)return"end_stop_selector."+oe}if(K.propagated_modification_delay!=null&&K.hasOwnProperty("propagated_modification_delay")&&!ae.isInteger(K.propagated_modification_delay))return"propagated_modification_delay: integer expected";if(K.replacement_stops!=null&&K.hasOwnProperty("replacement_stops")){if(!Array.isArray(K.replacement_stops))return"replacement_stops: array expected";for(var pe=0;pe<K.replacement_stops.length;++pe){var oe=ne.transit_realtime.ReplacementStop.verify(K.replacement_stops[pe]);if(oe)return"replacement_stops."+oe}}return K.service_alert_id!=null&&K.hasOwnProperty("service_alert_id")&&!ae.isString(K.service_alert_id)?"service_alert_id: string expected":K.last_modified_time!=null&&K.hasOwnProperty("last_modified_time")&&!ae.isInteger(K.last_modified_time)&&!(K.last_modified_time&&ae.isInteger(K.last_modified_time.low)&&ae.isInteger(K.last_modified_time.high))?"last_modified_time: integer|Long expected":null},R.fromObject=function(K){if(K instanceof ne.transit_realtime.TripModifications.Modification)return K;var oe=new ne.transit_realtime.TripModifications.Modification;if(K.start_stop_selector!=null){if(typeof K.start_stop_selector!="object")throw TypeError(".transit_realtime.TripModifications.Modification.start_stop_selector: object expected");oe.start_stop_selector=ne.transit_realtime.StopSelector.fromObject(K.start_stop_selector)}if(K.end_stop_selector!=null){if(typeof K.end_stop_selector!="object")throw TypeError(".transit_realtime.TripModifications.Modification.end_stop_selector: object expected");oe.end_stop_selector=ne.transit_realtime.StopSelector.fromObject(K.end_stop_selector)}if(K.propagated_modification_delay!=null&&(oe.propagated_modification_delay=K.propagated_modification_delay|0),K.replacement_stops){if(!Array.isArray(K.replacement_stops))throw TypeError(".transit_realtime.TripModifications.Modification.replacement_stops: array expected");oe.replacement_stops=[];for(var pe=0;pe<K.replacement_stops.length;++pe){if(typeof K.replacement_stops[pe]!="object")throw TypeError(".transit_realtime.TripModifications.Modification.replacement_stops: object expected");oe.replacement_stops[pe]=ne.transit_realtime.ReplacementStop.fromObject(K.replacement_stops[pe])}}return K.service_alert_id!=null&&(oe.service_alert_id=String(K.service_alert_id)),K.last_modified_time!=null&&(ae.Long?(oe.last_modified_time=ae.Long.fromValue(K.last_modified_time)).unsigned=!0:typeof K.last_modified_time=="string"?oe.last_modified_time=parseInt(K.last_modified_time,10):typeof K.last_modified_time=="number"?oe.last_modified_time=K.last_modified_time:typeof K.last_modified_time=="object"&&(oe.last_modified_time=new ae.LongBits(K.last_modified_time.low>>>0,K.last_modified_time.high>>>0).toNumber(!0))),oe},R.toObject=function(K,oe){oe||(oe={});var pe={};if((oe.arrays||oe.defaults)&&(pe.replacement_stops=[]),oe.defaults)if(pe.start_stop_selector=null,pe.end_stop_selector=null,pe.propagated_modification_delay=0,pe.service_alert_id="",ae.Long){var _e=new ae.Long(0,0,!0);pe.last_modified_time=oe.longs===String?_e.toString():oe.longs===Number?_e.toNumber():_e}else pe.last_modified_time=oe.longs===String?"0":0;if(K.start_stop_selector!=null&&K.hasOwnProperty("start_stop_selector")&&(pe.start_stop_selector=ne.transit_realtime.StopSelector.toObject(K.start_stop_selector,oe)),K.end_stop_selector!=null&&K.hasOwnProperty("end_stop_selector")&&(pe.end_stop_selector=ne.transit_realtime.StopSelector.toObject(K.end_stop_selector,oe)),K.propagated_modification_delay!=null&&K.hasOwnProperty("propagated_modification_delay")&&(pe.propagated_modification_delay=K.propagated_modification_delay),K.replacement_stops&&K.replacement_stops.length){pe.replacement_stops=[];for(var me=0;me<K.replacement_stops.length;++me)pe.replacement_stops[me]=ne.transit_realtime.ReplacementStop.toObject(K.replacement_stops[me],oe)}return K.service_alert_id!=null&&K.hasOwnProperty("service_alert_id")&&(pe.service_alert_id=K.service_alert_id),K.last_modified_time!=null&&K.hasOwnProperty("last_modified_time")&&(typeof K.last_modified_time=="number"?pe.last_modified_time=oe.longs===String?String(K.last_modified_time):K.last_modified_time:pe.last_modified_time=oe.longs===String?ae.Long.prototype.toString.call(K.last_modified_time):oe.longs===Number?new ae.LongBits(K.last_modified_time.low>>>0,K.last_modified_time.high>>>0).toNumber(!0):K.last_modified_time),pe},R.prototype.toJSON=function(){return this.constructor.toObject(this,J.util.toJSONOptions)},R.getTypeUrl=function(K){return K===void 0&&(K="type.googleapis.com"),K+"/transit_realtime.TripModifications.Modification"},R})(),ee.SelectedTrips=(function(){function R(U){if(this.trip_ids=[],U)for(var K=Object.keys(U),oe=0;oe<K.length;++oe)U[K[oe]]!=null&&(this[K[oe]]=U[K[oe]])}return R.prototype.trip_ids=ae.emptyArray,R.prototype.shape_id="",R.create=function(K){return new R(K)},R.encode=function(K,oe){if(oe||(oe=re.create()),K.trip_ids!=null&&K.trip_ids.length)for(var pe=0;pe<K.trip_ids.length;++pe)oe.uint32(10).string(K.trip_ids[pe]);return K.shape_id!=null&&Object.hasOwnProperty.call(K,"shape_id")&&oe.uint32(18).string(K.shape_id),oe},R.encodeDelimited=function(K,oe){return this.encode(K,oe).ldelim()},R.decode=function(K,oe,pe){K instanceof Y||(K=Y.create(K));for(var _e=oe===void 0?K.len:K.pos+oe,me=new ne.transit_realtime.TripModifications.SelectedTrips;K.pos<_e;){var we=K.uint32();if(we===pe)break;switch(we>>>3){case 1:{me.trip_ids&&me.trip_ids.length||(me.trip_ids=[]),me.trip_ids.push(K.string());break}case 2:{me.shape_id=K.string();break}default:K.skipType(we&7);break}}return me},R.decodeDelimited=function(K){return K instanceof Y||(K=new Y(K)),this.decode(K,K.uint32())},R.verify=function(K){if(typeof K!="object"||K===null)return"object expected";if(K.trip_ids!=null&&K.hasOwnProperty("trip_ids")){if(!Array.isArray(K.trip_ids))return"trip_ids: array expected";for(var oe=0;oe<K.trip_ids.length;++oe)if(!ae.isString(K.trip_ids[oe]))return"trip_ids: string[] expected"}return K.shape_id!=null&&K.hasOwnProperty("shape_id")&&!ae.isString(K.shape_id)?"shape_id: string expected":null},R.fromObject=function(K){if(K instanceof ne.transit_realtime.TripModifications.SelectedTrips)return K;var oe=new ne.transit_realtime.TripModifications.SelectedTrips;if(K.trip_ids){if(!Array.isArray(K.trip_ids))throw TypeError(".transit_realtime.TripModifications.SelectedTrips.trip_ids: array expected");oe.trip_ids=[];for(var pe=0;pe<K.trip_ids.length;++pe)oe.trip_ids[pe]=String(K.trip_ids[pe])}return K.shape_id!=null&&(oe.shape_id=String(K.shape_id)),oe},R.toObject=function(K,oe){oe||(oe={});var pe={};if((oe.arrays||oe.defaults)&&(pe.trip_ids=[]),oe.defaults&&(pe.shape_id=""),K.trip_ids&&K.trip_ids.length){pe.trip_ids=[];for(var _e=0;_e<K.trip_ids.length;++_e)pe.trip_ids[_e]=K.trip_ids[_e]}return K.shape_id!=null&&K.hasOwnProperty("shape_id")&&(pe.shape_id=K.shape_id),pe},R.prototype.toJSON=function(){return this.constructor.toObject(this,J.util.toJSONOptions)},R.getTypeUrl=function(K){return K===void 0&&(K="type.googleapis.com"),K+"/transit_realtime.TripModifications.SelectedTrips"},R})(),ee})(),ce.StopSelector=(function(){function ee(R){if(R)for(var U=Object.keys(R),K=0;K<U.length;++K)R[U[K]]!=null&&(this[U[K]]=R[U[K]])}return ee.prototype.stop_sequence=0,ee.prototype.stop_id="",ee.create=function(U){return new ee(U)},ee.encode=function(U,K){return K||(K=re.create()),U.stop_sequence!=null&&Object.hasOwnProperty.call(U,"stop_sequence")&&K.uint32(8).uint32(U.stop_sequence),U.stop_id!=null&&Object.hasOwnProperty.call(U,"stop_id")&&K.uint32(18).string(U.stop_id),K},ee.encodeDelimited=function(U,K){return this.encode(U,K).ldelim()},ee.decode=function(U,K,oe){U instanceof Y||(U=Y.create(U));for(var pe=K===void 0?U.len:U.pos+K,_e=new ne.transit_realtime.StopSelector;U.pos<pe;){var me=U.uint32();if(me===oe)break;switch(me>>>3){case 1:{_e.stop_sequence=U.uint32();break}case 2:{_e.stop_id=U.string();break}default:U.skipType(me&7);break}}return _e},ee.decodeDelimited=function(U){return U instanceof Y||(U=new Y(U)),this.decode(U,U.uint32())},ee.verify=function(U){return typeof U!="object"||U===null?"object expected":U.stop_sequence!=null&&U.hasOwnProperty("stop_sequence")&&!ae.isInteger(U.stop_sequence)?"stop_sequence: integer expected":U.stop_id!=null&&U.hasOwnProperty("stop_id")&&!ae.isString(U.stop_id)?"stop_id: string expected":null},ee.fromObject=function(U){if(U instanceof ne.transit_realtime.StopSelector)return U;var K=new ne.transit_realtime.StopSelector;return U.stop_sequence!=null&&(K.stop_sequence=U.stop_sequence>>>0),U.stop_id!=null&&(K.stop_id=String(U.stop_id)),K},ee.toObject=function(U,K){K||(K={});var oe={};return K.defaults&&(oe.stop_sequence=0,oe.stop_id=""),U.stop_sequence!=null&&U.hasOwnProperty("stop_sequence")&&(oe.stop_sequence=U.stop_sequence),U.stop_id!=null&&U.hasOwnProperty("stop_id")&&(oe.stop_id=U.stop_id),oe},ee.prototype.toJSON=function(){return this.constructor.toObject(this,J.util.toJSONOptions)},ee.getTypeUrl=function(U){return U===void 0&&(U="type.googleapis.com"),U+"/transit_realtime.StopSelector"},ee})(),ce.ReplacementStop=(function(){function ee(R){if(R)for(var U=Object.keys(R),K=0;K<U.length;++K)R[U[K]]!=null&&(this[U[K]]=R[U[K]])}return ee.prototype.travel_time_to_stop=0,ee.prototype.stop_id="",ee.create=function(U){return new ee(U)},ee.encode=function(U,K){return K||(K=re.create()),U.travel_time_to_stop!=null&&Object.hasOwnProperty.call(U,"travel_time_to_stop")&&K.uint32(8).int32(U.travel_time_to_stop),U.stop_id!=null&&Object.hasOwnProperty.call(U,"stop_id")&&K.uint32(18).string(U.stop_id),K},ee.encodeDelimited=function(U,K){return this.encode(U,K).ldelim()},ee.decode=function(U,K,oe){U instanceof Y||(U=Y.create(U));for(var pe=K===void 0?U.len:U.pos+K,_e=new ne.transit_realtime.ReplacementStop;U.pos<pe;){var me=U.uint32();if(me===oe)break;switch(me>>>3){case 1:{_e.travel_time_to_stop=U.int32();break}case 2:{_e.stop_id=U.string();break}default:U.skipType(me&7);break}}return _e},ee.decodeDelimited=function(U){return U instanceof Y||(U=new Y(U)),this.decode(U,U.uint32())},ee.verify=function(U){return typeof U!="object"||U===null?"object expected":U.travel_time_to_stop!=null&&U.hasOwnProperty("travel_time_to_stop")&&!ae.isInteger(U.travel_time_to_stop)?"travel_time_to_stop: integer expected":U.stop_id!=null&&U.hasOwnProperty("stop_id")&&!ae.isString(U.stop_id)?"stop_id: string expected":null},ee.fromObject=function(U){if(U instanceof ne.transit_realtime.ReplacementStop)return U;var K=new ne.transit_realtime.ReplacementStop;return U.travel_time_to_stop!=null&&(K.travel_time_to_stop=U.travel_time_to_stop|0),U.stop_id!=null&&(K.stop_id=String(U.stop_id)),K},ee.toObject=function(U,K){K||(K={});var oe={};return K.defaults&&(oe.travel_time_to_stop=0,oe.stop_id=""),U.travel_time_to_stop!=null&&U.hasOwnProperty("travel_time_to_stop")&&(oe.travel_time_to_stop=U.travel_time_to_stop),U.stop_id!=null&&U.hasOwnProperty("stop_id")&&(oe.stop_id=U.stop_id),oe},ee.prototype.toJSON=function(){return this.constructor.toObject(this,J.util.toJSONOptions)},ee.getTypeUrl=function(U){return U===void 0&&(U="type.googleapis.com"),U+"/transit_realtime.ReplacementStop"},ee})(),ce})(),gtfsRealtime_pbf=ne,gtfsRealtime_pbf}var gtfsRtBindings,hasRequiredGtfsRtBindings;function requireGtfsRtBindings(){if(hasRequiredGtfsRtBindings)return gtfsRtBindings;hasRequiredGtfsRtBindings=1;const{transit_realtime:J}=requireGtfsRealtime_pbf();return gtfsRtBindings=J,gtfsRtBindings}var gtfsRtBindingsExports=requireGtfsRtBindings(),fetchBrowser$1={exports:{}},fetchBrowser=fetchBrowser$1.exports,hasRequiredFetchBrowser;function requireFetchBrowser(){return hasRequiredFetchBrowser||(hasRequiredFetchBrowser=1,(function(J,Y){(function(re){function ae(ne){var ce=ne&&ne.Promise||re.Promise,ee=ne&&ne.XMLHttpRequest||re.XMLHttpRequest;return(function(){var R=Object.create(re,{fetch:{value:void 0,writable:!0}});return(function(U,K){K(Y)})(this,(function(U){var K=typeof R<"u"&&R||typeof self<"u"&&self||typeof K<"u"&&K,oe={searchParams:"URLSearchParams"in K,iterable:"Symbol"in K&&"iterator"in Symbol,blob:"FileReader"in K&&"Blob"in K&&(function(){try{return new Blob,!0}catch{return!1}})(),formData:"FormData"in K,arrayBuffer:"ArrayBuffer"in K};function pe(ht){return ht&&DataView.prototype.isPrototypeOf(ht)}if(oe.arrayBuffer)var _e=["[object Int8Array]","[object Uint8Array]","[object Uint8ClampedArray]","[object Int16Array]","[object Uint16Array]","[object Int32Array]","[object Uint32Array]","[object Float32Array]","[object Float64Array]"],me=ArrayBuffer.isView||function(ht){return ht&&_e.indexOf(Object.prototype.toString.call(ht))>-1};function we(ht){if(typeof ht!="string"&&(ht=String(ht)),/[^a-z0-9\-#$%&'*+.^_`|~!]/i.test(ht)||ht==="")throw new TypeError("Invalid character in header field name");return ht.toLowerCase()}function Oe(ht){return typeof ht!="string"&&(ht=String(ht)),ht}function De(ht){var St={next:function(){var ut=ht.shift();return{done:ut===void 0,value:ut}}};return oe.iterable&&(St[Symbol.iterator]=function(){return St}),St}function Ae(ht){this.map={},ht instanceof Ae?ht.forEach(function(St,ut){this.append(ut,St)},this):Array.isArray(ht)?ht.forEach(function(St){this.append(St[0],St[1])},this):ht&&Object.getOwnPropertyNames(ht).forEach(function(St){this.append(St,ht[St])},this)}Ae.prototype.append=function(ht,St){ht=we(ht),St=Oe(St);var ut=this.map[ht];this.map[ht]=ut?ut+", "+St:St},Ae.prototype.delete=function(ht){delete this.map[we(ht)]},Ae.prototype.get=function(ht){return ht=we(ht),this.has(ht)?this.map[ht]:null},Ae.prototype.has=function(ht){return this.map.hasOwnProperty(we(ht))},Ae.prototype.set=function(ht,St){this.map[we(ht)]=Oe(St)},Ae.prototype.forEach=function(ht,St){for(var ut in this.map)this.map.hasOwnProperty(ut)&&ht.call(St,this.map[ut],ut,this)},Ae.prototype.keys=function(){var ht=[];return this.forEach(function(St,ut){ht.push(ut)}),De(ht)},Ae.prototype.values=function(){var ht=[];return this.forEach(function(St){ht.push(St)}),De(ht)},Ae.prototype.entries=function(){var ht=[];return this.forEach(function(St,ut){ht.push([ut,St])}),De(ht)},oe.iterable&&(Ae.prototype[Symbol.iterator]=Ae.prototype.entries);function Ce(ht){if(ht.bodyUsed)return ce.reject(new TypeError("Already read"));ht.bodyUsed=!0}function je(ht){return new ce(function(St,ut){ht.onload=function(){St(ht.result)},ht.onerror=function(){ut(ht.error)}})}function ke(ht){var St=new FileReader,ut=je(St);return St.readAsArrayBuffer(ht),ut}function Be(ht){var St=new FileReader,ut=je(St);return St.readAsText(ht),ut}function We(ht){for(var St=new Uint8Array(ht),ut=new Array(St.length),Et=0;Et<St.length;Et++)ut[Et]=String.fromCharCode(St[Et]);return ut.join("")}function Je(ht){if(ht.slice)return ht.slice(0);var St=new Uint8Array(ht.byteLength);return St.set(new Uint8Array(ht)),St.buffer}function Ke(){return this.bodyUsed=!1,this._initBody=function(ht){this.bodyUsed=this.bodyUsed,this._bodyInit=ht,ht?typeof ht=="string"?this._bodyText=ht:oe.blob&&Blob.prototype.isPrototypeOf(ht)?this._bodyBlob=ht:oe.formData&&FormData.prototype.isPrototypeOf(ht)?this._bodyFormData=ht:oe.searchParams&&URLSearchParams.prototype.isPrototypeOf(ht)?this._bodyText=ht.toString():oe.arrayBuffer&&oe.blob&&pe(ht)?(this._bodyArrayBuffer=Je(ht.buffer),this._bodyInit=new Blob([this._bodyArrayBuffer])):oe.arrayBuffer&&(ArrayBuffer.prototype.isPrototypeOf(ht)||me(ht))?this._bodyArrayBuffer=Je(ht):this._bodyText=ht=Object.prototype.toString.call(ht):this._bodyText="",this.headers.get("content-type")||(typeof ht=="string"?this.headers.set("content-type","text/plain;charset=UTF-8"):this._bodyBlob&&this._bodyBlob.type?this.headers.set("content-type",this._bodyBlob.type):oe.searchParams&&URLSearchParams.prototype.isPrototypeOf(ht)&&this.headers.set("content-type","application/x-www-form-urlencoded;charset=UTF-8"))},oe.blob&&(this.blob=function(){var ht=Ce(this);if(ht)return ht;if(this._bodyBlob)return ce.resolve(this._bodyBlob);if(this._bodyArrayBuffer)return ce.resolve(new Blob([this._bodyArrayBuffer]));if(this._bodyFormData)throw new Error("could not read FormData body as blob");return ce.resolve(new Blob([this._bodyText]))},this.arrayBuffer=function(){if(this._bodyArrayBuffer){var ht=Ce(this);return ht||(ArrayBuffer.isView(this._bodyArrayBuffer)?ce.resolve(this._bodyArrayBuffer.buffer.slice(this._bodyArrayBuffer.byteOffset,this._bodyArrayBuffer.byteOffset+this._bodyArrayBuffer.byteLength)):ce.resolve(this._bodyArrayBuffer))}else return this.blob().then(ke)}),this.text=function(){var ht=Ce(this);if(ht)return ht;if(this._bodyBlob)return Be(this._bodyBlob);if(this._bodyArrayBuffer)return ce.resolve(We(this._bodyArrayBuffer));if(this._bodyFormData)throw new Error("could not read FormData body as text");return ce.resolve(this._bodyText)},oe.formData&&(this.formData=function(){return this.text().then(ct)}),this.json=function(){return this.text().then(JSON.parse)},this}var et=["DELETE","GET","HEAD","OPTIONS","POST","PUT"];function it(ht){var St=ht.toUpperCase();return et.indexOf(St)>-1?St:ht}function nt(ht,St){if(!(this instanceof nt))throw new TypeError('Please use the "new" operator, this DOM object constructor cannot be called as a function.');St=St||{};var ut=St.body;if(ht instanceof nt){if(ht.bodyUsed)throw new TypeError("Already read");this.url=ht.url,this.credentials=ht.credentials,St.headers||(this.headers=new Ae(ht.headers)),this.method=ht.method,this.mode=ht.mode,this.signal=ht.signal,!ut&&ht._bodyInit!=null&&(ut=ht._bodyInit,ht.bodyUsed=!0)}else this.url=String(ht);if(this.credentials=St.credentials||this.credentials||"same-origin",(St.headers||!this.headers)&&(this.headers=new Ae(St.headers)),this.method=it(St.method||this.method||"GET"),this.mode=St.mode||this.mode||null,this.signal=St.signal||this.signal,this.referrer=null,(this.method==="GET"||this.method==="HEAD")&&ut)throw new TypeError("Body not allowed for GET or HEAD requests");if(this._initBody(ut),(this.method==="GET"||this.method==="HEAD")&&(St.cache==="no-store"||St.cache==="no-cache")){var Et=/([?&])_=[^&]*/;if(Et.test(this.url))this.url=this.url.replace(Et,"$1_="+new Date().getTime());else{var bt=/\?/;this.url+=(bt.test(this.url)?"&":"?")+"_="+new Date().getTime()}}}nt.prototype.clone=function(){return new nt(this,{body:this._bodyInit})};function ct(ht){var St=new FormData;return ht.trim().split("&").forEach(function(ut){if(ut){var Et=ut.split("="),bt=Et.shift().replace(/\+/g," "),Dt=Et.join("=").replace(/\+/g," ");St.append(decodeURIComponent(bt),decodeURIComponent(Dt))}}),St}function ft(ht){var St=new Ae,ut=ht.replace(/\r?\n[\t ]+/g," ");return ut.split("\r").map(function(Et){return Et.indexOf(`
`)===0?Et.substr(1,Et.length):Et}).forEach(function(Et){var bt=Et.split(":"),Dt=bt.shift().trim();if(Dt){var Ut=bt.join(":").trim();St.append(Dt,Ut)}}),St}Ke.call(nt.prototype);function _t(ht,St){if(!(this instanceof _t))throw new TypeError('Please use the "new" operator, this DOM object constructor cannot be called as a function.');St||(St={}),this.type="default",this.status=St.status===void 0?200:St.status,this.ok=this.status>=200&&this.status<300,this.statusText="statusText"in St?St.statusText:"",this.headers=new Ae(St.headers),this.url=St.url||"",this._initBody(ht)}Ke.call(_t.prototype),_t.prototype.clone=function(){return new _t(this._bodyInit,{status:this.status,statusText:this.statusText,headers:new Ae(this.headers),url:this.url})},_t.error=function(){var ht=new _t(null,{status:0,statusText:""});return ht.type="error",ht};var Rt=[301,302,303,307,308];_t.redirect=function(ht,St){if(Rt.indexOf(St)===-1)throw new RangeError("Invalid status code");return new _t(null,{status:St,headers:{location:ht}})},U.DOMException=K.DOMException;try{new U.DOMException}catch{U.DOMException=function(St,ut){this.message=St,this.name=ut;var Et=Error(St);this.stack=Et.stack},U.DOMException.prototype=Object.create(Error.prototype),U.DOMException.prototype.constructor=U.DOMException}function Ft(ht,St){return new ce(function(ut,Et){var bt=new nt(ht,St);if(bt.signal&&bt.signal.aborted)return Et(new U.DOMException("Aborted","AbortError"));var Dt=new ee;function Ut(){Dt.abort()}Dt.onload=function(){var xr={status:Dt.status,statusText:Dt.statusText,headers:ft(Dt.getAllResponseHeaders()||"")};xr.url="responseURL"in Dt?Dt.responseURL:xr.headers.get("X-Request-URL");var ur="response"in Dt?Dt.response:Dt.responseText;setTimeout(function(){ut(new _t(ur,xr))},0)},Dt.onerror=function(){setTimeout(function(){Et(new TypeError("Network request failed"))},0)},Dt.ontimeout=function(){setTimeout(function(){Et(new TypeError("Network request failed"))},0)},Dt.onabort=function(){setTimeout(function(){Et(new U.DOMException("Aborted","AbortError"))},0)};function er(xr){try{return xr===""&&K.location.href?K.location.href:xr}catch{return xr}}Dt.open(bt.method,er(bt.url),!0),bt.credentials==="include"?Dt.withCredentials=!0:bt.credentials==="omit"&&(Dt.withCredentials=!1),"responseType"in Dt&&(oe.blob?Dt.responseType="blob":oe.arrayBuffer&&bt.headers.get("Content-Type")&&bt.headers.get("Content-Type").indexOf("application/octet-stream")!==-1&&(Dt.responseType="arraybuffer")),St&&typeof St.headers=="object"&&!(St.headers instanceof Ae)?Object.getOwnPropertyNames(St.headers).forEach(function(xr){Dt.setRequestHeader(xr,Oe(St.headers[xr]))}):bt.headers.forEach(function(xr,ur){Dt.setRequestHeader(ur,xr)}),bt.signal&&(bt.signal.addEventListener("abort",Ut),Dt.onreadystatechange=function(){Dt.readyState===4&&bt.signal.removeEventListener("abort",Ut)}),Dt.send(typeof bt._bodyInit>"u"?null:bt._bodyInit)})}Ft.polyfill=!0,K.fetch||(K.fetch=Ft,K.Headers=Ae,K.Request=nt,K.Response=_t),U.Headers=Ae,U.Request=nt,U.Response=_t,U.fetch=Ft,Object.defineProperty(U,"__esModule",{value:!0})})),{fetch:R.fetch,Headers:R.Headers,Request:R.Request,Response:R.Response,DOMException:R.DOMException}})()}J.exports=ae})(typeof globalThis<"u"?globalThis:typeof self<"u"?self:typeof commonjsGlobal<"u"?commonjsGlobal:fetchBrowser)})(fetchBrowser$1,fetchBrowser$1.exports)),fetchBrowser$1.exports}var fetchPeriodicSync,hasRequiredFetchPeriodicSync;function requireFetchPeriodicSync(){if(hasRequiredFetchPeriodicSync)return fetchPeriodicSync;hasRequiredFetchPeriodicSync=1;const{EventEmitter:J}=requireEvents(),{fetch:Y}=requireFetchBrowser()();return fetchPeriodicSync=(ae,ne={})=>{const{interval:ce,respectDataSaving:ee,respectPageVisibility:R,fetchOpts:U,setTimer:K,clearTimer:oe}={interval:3e4,respectDataSaving:!0,respectPageVisibility:!0,fetchOpts:{},setTimer:setTimeout,clearTimer:clearTimeout,...ne},pe="minInterval"in ne?ne.minInterval:ce*3,_e=new J;let me=null;const we=async()=>{const it={};me!==null&&(it["if-none-match"]=me);const nt=await Y(ae,{...U,headers:{...U.headers,...it}});if(!nt.ok&&nt.status!==304){const _t=new Error(nt.statusText);throw _t.response=nt,_t}let ct=!0;nt.status===304&&(ct=!1);const ft=nt.headers.get("etag");return ft&&(ft===me&&(ct=!1),me=ft),nt.headers.get("last-modified"),{changed:ct,response:nt}};let Oe=null;const De=()=>(Oe!==null||(_e.emit("fetch"),Oe=we().then(({changed:it,response:nt})=>(Oe=null,_e.emit("fetch-done"),it&&_e.emit("change",nt),nt),it=>{throw Oe=null,_e.emit("fetch-done"),_e.emit("error",it),it})),Oe),Ae=globalThis.document,Ce=()=>!R||!Ae?!1:typeof Ae.hidden=="boolean"?Ae.hidden:!1,je=globalThis.navigator&&globalThis.navigator.connection,ke=()=>ee&&je?je.saveData:!1;let Be=!1,We=null;const Je=()=>{De().catch(()=>{}).then(()=>{if(!Be)return;const it=Ce()||ke()?pe:ce;We=K(Je,it)})},Ke=()=>{Be||(Be=!0,Je(),_e.emit("start"))},et=()=>{Be&&(We===null&&(oe(We),We=null),Be=!1,_e.emit("stop"))};return Ke(),_e.url=()=>ae,_e.start=Ke,_e.stop=et,_e.isActive=()=>!!Be,_e.refetch=De,_e.isFetching=()=>!!Oe,_e},fetchPeriodicSync}var fetchPeriodicSyncExports=requireFetchPeriodicSync();const syncViaPeriodicFetch=getDefaultExportFromCjs(fetchPeriodicSyncExports),MAX_FEED_SIZE=128*1024*1024,CONTENT_TYPES=["application/octet-stream","application/x-protobuf","application/grtfeed"],feedStore=(J,Y)=>{J.feedUrl=null,J.feedSyncStopped=!1,J.feedSyncInterval=30,J.feedSyncing=!1,J.feedError=null,J.feedRawData=null,J.feedData=null;let re=null;const ae=async ee=>{const R=ee.headers.get("content-type"),U=R?contentTypeExports.parse(R):{};if(U.type&&!CONTENT_TYPES.includes(U.type)){const _e=new Error(`invalid content-type \`${U.type}\`, only ${CONTENT_TYPES.join(", ")} are supported`);throw _e.response=ee,_e}const K=ee.headers.get("content-length");if(K&&parseInt(K)>MAX_FEED_SIZE){const _e=new Error("response is too large");throw _e.response=ee,_e}const oe=bufferExports.Buffer.from(await ee.arrayBuffer()),pe=gtfsRtBindingsExports.FeedMessage.toObject(gtfsRtBindingsExports.FeedMessage.decode(oe));if(!pe||!pe.header||!Array.isArray(pe.entity)){const _e=new Error("couldn't parse feed");throw _e.rawFeed=oe,_e.response=ee,_e}J.feedError=null,J.feedRawData=oe,J.feedData=pe,Y.emit("feed:data-change"),Y.emit(Y.STATE_CHANGE)},ne=ee=>{J.feedSyncing=ee,Y.emit(Y.STATE_CHANGE)},ce=debounce(()=>{re=syncViaPeriodicFetch(J.feedUrl,{interval:J.feedSyncInterval*1e3}),re.on("fetch",()=>ne(!0)),re.on("fetch-done",()=>ne(!1)),re.on("change",ee=>{ae(ee).catch(R=>{J.feedError=R,Y.emit(Y.STATE_CHANGE)})}),re.on("error",ee=>{J.feedError=ee,Y.emit(Y.STATE_CHANGE)}),J.feedSyncStopped&&re.stop()},300);Y.on("feed:set-url",ee=>{ee!==J.feedUrl&&(re&&(re.stop(),re=null),J.feedUrl=ee,J.feedSyncing=!1,J.feedRawData=null,J.feedData=null,ee!==null&&ce(),Y.emit("feed:data-change"),Y.emit(Y.STATE_CHANGE))}),Y.on("feed:sync",()=>{re&&re.refetch()}),Y.on("feed:stop-sync",()=>{J.feedSyncStopped=!0,re&&re.stop(),Y.emit(Y.STATE_CHANGE)}),Y.on("feed:start-sync",()=>{J.feedSyncStopped=!1,re&&re.start(),Y.emit(Y.STATE_CHANGE)}),Y.on("feed:set-sync-interval",ee=>{ee=Math.max(ee,1),ee!==J.feedSyncInterval&&(re&&(re.stop(),re=null),J.feedSyncInterval=ee,J.feedUrl!==null&&ce(),Y.emit(Y.STATE_CHANGE))})},MAX_LOG_ITEMS=1e3,feedLogStore=(J,Y)=>{J.feedLogFilter=null,J.unfilteredFeedLog=[],J.feedLog=[];const re=()=>{if(!J.feedData){J.unfilteredFeedLog=[],J.feedLog=[];return}const ae=Date.now()/1e3|0,ne=J.feedData.header||{},ce=(J.feedData.entity||[]).filter(K=>!!K.trip_update).flatMap(K=>(K.trip_update.stop_time_update||[]).map(oe=>{var pe,_e,me,we,Oe,De,Ae,Ce;return{entityId:K.id,timestamp:K.trip_update.timestamp||ne.timestamp||null,routeId:(pe=K.trip_update.trip)==null?void 0:pe.route_id,directionId:(_e=K.trip_update.trip)==null?void 0:_e.direction_id,tripId:(me=K.trip_update.trip)==null?void 0:me.trip_id,vehicleId:(we=K.trip_update.vehicle)==null?void 0:we.id,vehicleLabel:(Oe=K.trip_update.vehicle)==null?void 0:Oe.label,stopId:oe.stop_id,scheduleRelationship:oe.schedule_relationship,tArrival:((De=oe.arrival)==null?void 0:De.time)??null,delay:((Ae=oe.arrival)==null?void 0:Ae.delay)??((Ce=oe.departure)==null?void 0:Ce.delay)}})).filter(({tArrival:K,delay:oe})=>K!==null?K>=ae:oe!==null).sort((K,oe)=>{const pe=typeof K.tArrival=="number"?K.tArrival-ae:Number.MAX_SAFE_INTEGER,_e=typeof oe.tArrival=="number"?oe.tArrival-ae:Number.MAX_SAFE_INTEGER,me=typeof K.delay=="number"?K.delay:0,we=typeof oe.delay=="number"?oe.delay:0;return pe/30===_e/30?Math.abs(we)-Math.abs(me):pe-_e}),ee=J.feedLogFilter??"",U=(ee?ce.filter(K=>JSON.stringify(K).toLowerCase().includes(ee)):ce).slice(0,MAX_LOG_ITEMS);J.unfilteredFeedLog=ce,J.feedLog=U,Y.emit(Y.STATE_CHANGE)};Y.on("feed-log:set-filter",ae=>{J.feedLogFilter!==ae&&(J.feedLogFilter=ae,re())}),Y.on("feed:data-change",re)},MAX_TRIP_UPDATES=1e3,MAX_VEHICLE_POSITIONS=1e3,inspectorStore=(J,Y)=>{J.inspectorFilter=null,J.unfilteredTripUpdates=[],J.tripUpdates=[],J.unfilteredVehiclePositions=[],J.vehiclePositions=[];const re=()=>{var pe;if(!J.feedData){J.unfilteredTripUpdates=[],J.tripUpdates=[];return}const ae=((pe=J.feedData)==null?void 0:pe.entity)??[],ne=J.inspectorFilter??"",ce=ae.filter(_e=>!!_e.trip_update),R=(ne?ce.filter(_e=>JSON.stringify(_e).toLowerCase().includes(ne)):ce).slice(0,MAX_TRIP_UPDATES),U=ae.filter(_e=>!!_e.vehicle),oe=(ne?U.filter(_e=>JSON.stringify(_e).toLowerCase().includes(ne)):U).slice(0,MAX_VEHICLE_POSITIONS);J.unfilteredTripUpdates=ce,J.tripUpdates=R,J.unfilteredVehiclePositions=U,J.vehiclePositions=oe,Y.emit(Y.STATE_CHANGE)};Y.on("inspector:set-filter",ae=>{J.inspectorFilter!==ae&&(J.inspectorFilter=ae,re())}),Y.on("feed:data-change",re)};var browser={exports:{}},hasRequiredBrowser;function requireBrowser(){if(hasRequiredBrowser)return browser.exports;hasRequiredBrowser=1;const{AbortController:J,AbortSignal:Y}=typeof self<"u"?self:typeof window<"u"?window:void 0;return browser.exports=J,browser.exports.AbortSignal=Y,browser.exports.default=J,browser.exports}var browserExports=requireBrowser();const AbortController$1=getDefaultExportFromCjs(browserExports);var fetchBrowserExports=requireFetchBrowser();const createFetch=getDefaultExportFromCjs(fetchBrowserExports);function encodeReserved(J){return J.split(/(%[0-9A-Fa-f]{2})/g).map(function(Y){return/%[0-9A-Fa-f]/.test(Y)||(Y=encodeURI(Y).replace(/%5B/g,"[").replace(/%5D/g,"]")),Y}).join("")}function encodeUnreserved(J){return encodeURIComponent(J).replace(/[!'()*]/g,function(Y){return"%"+Y.charCodeAt(0).toString(16).toUpperCase()})}function encodeValue(J,Y,re){return Y=J==="+"||J==="#"?encodeReserved(Y):encodeUnreserved(Y),re?encodeUnreserved(re)+"="+Y:Y}function isDefined(J){return J!=null}function isKeyOperator(J){return J===";"||J==="&"||J==="?"}function getValues(J,Y,re,ae){var ne=J[re],ce=[];if(isDefined(ne)&&ne!=="")if(typeof ne=="string"||typeof ne=="number"||typeof ne=="boolean")ne=ne.toString(),ae&&ae!=="*"&&(ne=ne.substring(0,parseInt(ae,10))),ce.push(encodeValue(Y,ne,isKeyOperator(Y)?re:null));else if(ae==="*")Array.isArray(ne)?ne.filter(isDefined).forEach(function(R){ce.push(encodeValue(Y,R,isKeyOperator(Y)?re:null))}):Object.keys(ne).forEach(function(R){isDefined(ne[R])&&ce.push(encodeValue(Y,ne[R],R))});else{var ee=[];Array.isArray(ne)?ne.filter(isDefined).forEach(function(R){ee.push(encodeValue(Y,R))}):Object.keys(ne).forEach(function(R){isDefined(ne[R])&&(ee.push(encodeUnreserved(R)),ee.push(encodeValue(Y,ne[R].toString())))}),isKeyOperator(Y)?ce.push(encodeUnreserved(re)+"="+ee.join(",")):ee.length!==0&&ce.push(ee.join(","))}else Y===";"?isDefined(ne)&&ce.push(encodeUnreserved(re)):ne===""&&(Y==="&"||Y==="?")?ce.push(encodeUnreserved(re)+"="):ne===""&&ce.push("");return ce}function parseTemplate(J){var Y=["+","#",".","/",";","?","&"];return{expand:function(re){return J.replace(/\{([^\{\}]+)\}|([^\{\}]+)/g,function(ae,ne,ce){if(ne){var ee=null,R=[];if(Y.indexOf(ne.charAt(0))!==-1&&(ee=ne.charAt(0),ne=ne.substr(1)),ne.split(/,/g).forEach(function(K){var oe=/([^:\*]*)(?::(\d+)|(\*))?/.exec(K);R.push.apply(R,getValues(re,ee,oe[1],oe[2]||oe[3]))}),ee&&ee!=="+"){var U=",";return ee==="?"?U="&":ee!=="#"&&(U=ee),(R.length!==0?ee:"")+R.join(U)}else return R.join(",")}else return encodeReserved(ce)})}}}const{Request:Request$1,fetch:fetch$1}=createFetch(),hasProp=(J,Y)=>Object.prototype.hasOwnProperty.call(J,Y),checkIfFeedContainsFocusedVehicleId=(J,Y)=>{const re=J==null?void 0:J.entity;return Array.isArray(re)?re.some(ae=>{var ne,ce;return((ce=(ne=ae.vehicle)==null?void 0:ne.vehicle)==null?void 0:ce.id)===Y}):!1},checkIfFeedContainsFocusedTripId=(J,Y)=>{const re=J==null?void 0:J.entity;if(Array.isArray(re))return re.some(ae=>{var ne,ce,ee,R;return((ce=(ne=ae.vehicle)==null?void 0:ne.trip)==null?void 0:ce.trip_id)===Y||((R=(ee=ae.trip_update)==null?void 0:ee.trip)==null?void 0:R.trip_id)===Y})},focusStore=(J,Y)=>{const re=async(me,we={})=>{const Oe=new Request$1(me,{mode:"cors",redirect:"follow",headers:{accept:"application/json"},...we}),De=await fetch$1(Oe);if(!De.ok){const Ae=new Error(`${De.url}: ${De.status} ${De.statusText}`);throw Ae.req=Oe,Ae.res=De,Ae}return await De.json()};J.shapeIdsByTripIdUrl="/shape-ids-by-trip-id.json",Y.on("shape-ids-by-trip-id-url:set",me=>{J.shapeIdsByTripIdUrl!==me&&(J.shapeIdsByTripIdUrl=me,ee(),Y.emit(Y.STATE_CHANGE))});let ae=new AbortController$1;const ne=async()=>(ae=new AbortController$1,console.debug(`fetching shape IDs from ${J.shapeIdsByTripIdUrl}`),await re(J.shapeIdsByTripIdUrl,{signal:ae.signal}));let ce={};const ee=()=>{ae.abort(),ne().then(me=>{ce=me,_e()}).catch(me=>{console.error("failed to fetch shape IDs",me)})};J.shapeUrl="/shapes/{shape_id}.geo.json";let R=parseTemplate(J.shapeUrl);Y.on("shape-url:set",me=>{J.shapeUrl!==me&&(J.shapeUrl=me,R=parseTemplate(J.shapeUrl),_e(),Y.emit(Y.STATE_CHANGE))}),J.focusedVehicleId=null,J.focusedVehiclePosition=null;const U=()=>{var we;if(J.focusedVehicleId===null)return;if(checkIfFeedContainsFocusedVehicleId(J.feedData,J.focusedVehicleId)){const Oe=J.focusedVehicleId,Ae=(((we=J.feedData)==null?void 0:we.entity)||[]).find(Ce=>{var je,ke;return((ke=(je=Ce.vehicle)==null?void 0:je.vehicle)==null?void 0:ke.id)===Oe});Ae?J.focusedVehiclePosition={type:"Feature",properties:{vehicleId:Oe},geometry:{type:"Point",coordinates:[Ae.vehicle.position.longitude,Ae.vehicle.position.latitude]}}:J.focusedVehiclePosition=null,Y.emit(Y.STATE_CHANGE)}};Y.on("feed:data-change",U),Y.on("focus-vehicle-id",me=>{me!==J.focusedVehicleId&&(J.focusedVehicleId=me,J.focusedVehiclePosition=null,U(),Y.emit(Y.STATE_CHANGE))}),J.focusedTripId=null,J.focusedTripShape=null;const K=()=>{J.focusedTripId!==null&&checkIfFeedContainsFocusedTripId(J.feedData,J.focusedTripId)};Y.on("feed:data-change",K);let oe=new AbortController$1;const pe=async(me,we)=>{oe=new AbortController$1;const Oe=R.expand({shape_id:me});console.debug(`fetching shape ${me} for trip ${we} from ${Oe}`);const De=Date.now(),Ae=await re(Oe,{signal:oe.signal});return console.debug(`fetched shape ${me} in ${Date.now()-De}ms`),Ae},_e=()=>{const me=J.focusedTripId;if(me!==null&&(oe.abort(),me!==null&&hasProp(ce,me))){const we=ce[me];pe(we,me).then(Oe=>{J.focusedTripShape=Oe,Y.emit(Y.STATE_CHANGE)}).catch(Oe=>{console.error(`failed to fetch shape ${we} for trip ${me}`,Oe)})}};Y.on("focus-trip-id",me=>{me!==J.focusedTripId&&(J.focusedTripId=me,J.focusedTripShape=null,K(),_e(),Y.emit(Y.STATE_CHANGE))})};var isFunction_1,hasRequiredIsFunction;function requireIsFunction(){if(hasRequiredIsFunction)return isFunction_1;hasRequiredIsFunction=1;var J=require_baseGetTag(),Y=requireIsObject(),re="[object AsyncFunction]",ae="[object Function]",ne="[object GeneratorFunction]",ce="[object Proxy]";function ee(R){if(!Y(R))return!1;var U=J(R);return U==ae||U==ne||U==re||U==ce}return isFunction_1=ee,isFunction_1}var _coreJsData,hasRequired_coreJsData;function require_coreJsData(){if(hasRequired_coreJsData)return _coreJsData;hasRequired_coreJsData=1;var J=require_root(),Y=J["__core-js_shared__"];return _coreJsData=Y,_coreJsData}var _isMasked,hasRequired_isMasked;function require_isMasked(){if(hasRequired_isMasked)return _isMasked;hasRequired_isMasked=1;var J=require_coreJsData(),Y=(function(){var ae=/[^.]+$/.exec(J&&J.keys&&J.keys.IE_PROTO||"");return ae?"Symbol(src)_1."+ae:""})();function re(ae){return!!Y&&Y in ae}return _isMasked=re,_isMasked}var _toSource,hasRequired_toSource;function require_toSource(){if(hasRequired_toSource)return _toSource;hasRequired_toSource=1;var J=Function.prototype,Y=J.toString;function re(ae){if(ae!=null){try{return Y.call(ae)}catch{}try{return ae+""}catch{}}return""}return _toSource=re,_toSource}var _baseIsNative,hasRequired_baseIsNative;function require_baseIsNative(){if(hasRequired_baseIsNative)return _baseIsNative;hasRequired_baseIsNative=1;var J=requireIsFunction(),Y=require_isMasked(),re=requireIsObject(),ae=require_toSource(),ne=/[\\^$.*+?()[\]{}|]/g,ce=/^\[object .+?Constructor\]$/,ee=Function.prototype,R=Object.prototype,U=ee.toString,K=R.hasOwnProperty,oe=RegExp("^"+U.call(K).replace(ne,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$");function pe(_e){if(!re(_e)||Y(_e))return!1;var me=J(_e)?oe:ce;return me.test(ae(_e))}return _baseIsNative=pe,_baseIsNative}var _getValue,hasRequired_getValue;function require_getValue(){if(hasRequired_getValue)return _getValue;hasRequired_getValue=1;function J(Y,re){return Y==null?void 0:Y[re]}return _getValue=J,_getValue}var _getNative,hasRequired_getNative;function require_getNative(){if(hasRequired_getNative)return _getNative;hasRequired_getNative=1;var J=require_baseIsNative(),Y=require_getValue();function re(ae,ne){var ce=Y(ae,ne);return J(ce)?ce:void 0}return _getNative=re,_getNative}var _nativeCreate,hasRequired_nativeCreate;function require_nativeCreate(){if(hasRequired_nativeCreate)return _nativeCreate;hasRequired_nativeCreate=1;var J=require_getNative(),Y=J(Object,"create");return _nativeCreate=Y,_nativeCreate}var _hashClear,hasRequired_hashClear;function require_hashClear(){if(hasRequired_hashClear)return _hashClear;hasRequired_hashClear=1;var J=require_nativeCreate();function Y(){this.__data__=J?J(null):{},this.size=0}return _hashClear=Y,_hashClear}var _hashDelete,hasRequired_hashDelete;function require_hashDelete(){if(hasRequired_hashDelete)return _hashDelete;hasRequired_hashDelete=1;function J(Y){var re=this.has(Y)&&delete this.__data__[Y];return this.size-=re?1:0,re}return _hashDelete=J,_hashDelete}var _hashGet,hasRequired_hashGet;function require_hashGet(){if(hasRequired_hashGet)return _hashGet;hasRequired_hashGet=1;var J=require_nativeCreate(),Y="__lodash_hash_undefined__",re=Object.prototype,ae=re.hasOwnProperty;function ne(ce){var ee=this.__data__;if(J){var R=ee[ce];return R===Y?void 0:R}return ae.call(ee,ce)?ee[ce]:void 0}return _hashGet=ne,_hashGet}var _hashHas,hasRequired_hashHas;function require_hashHas(){if(hasRequired_hashHas)return _hashHas;hasRequired_hashHas=1;var J=require_nativeCreate(),Y=Object.prototype,re=Y.hasOwnProperty;function ae(ne){var ce=this.__data__;return J?ce[ne]!==void 0:re.call(ce,ne)}return _hashHas=ae,_hashHas}var _hashSet,hasRequired_hashSet;function require_hashSet(){if(hasRequired_hashSet)return _hashSet;hasRequired_hashSet=1;var J=require_nativeCreate(),Y="__lodash_hash_undefined__";function re(ae,ne){var ce=this.__data__;return this.size+=this.has(ae)?0:1,ce[ae]=J&&ne===void 0?Y:ne,this}return _hashSet=re,_hashSet}var _Hash,hasRequired_Hash;function require_Hash(){if(hasRequired_Hash)return _Hash;hasRequired_Hash=1;var J=require_hashClear(),Y=require_hashDelete(),re=require_hashGet(),ae=require_hashHas(),ne=require_hashSet();function ce(ee){var R=-1,U=ee==null?0:ee.length;for(this.clear();++R<U;){var K=ee[R];this.set(K[0],K[1])}}return ce.prototype.clear=J,ce.prototype.delete=Y,ce.prototype.get=re,ce.prototype.has=ae,ce.prototype.set=ne,_Hash=ce,_Hash}var _listCacheClear,hasRequired_listCacheClear;function require_listCacheClear(){if(hasRequired_listCacheClear)return _listCacheClear;hasRequired_listCacheClear=1;function J(){this.__data__=[],this.size=0}return _listCacheClear=J,_listCacheClear}var eq_1,hasRequiredEq;function requireEq(){if(hasRequiredEq)return eq_1;hasRequiredEq=1;function J(Y,re){return Y===re||Y!==Y&&re!==re}return eq_1=J,eq_1}var _assocIndexOf,hasRequired_assocIndexOf;function require_assocIndexOf(){if(hasRequired_assocIndexOf)return _assocIndexOf;hasRequired_assocIndexOf=1;var J=requireEq();function Y(re,ae){for(var ne=re.length;ne--;)if(J(re[ne][0],ae))return ne;return-1}return _assocIndexOf=Y,_assocIndexOf}var _listCacheDelete,hasRequired_listCacheDelete;function require_listCacheDelete(){if(hasRequired_listCacheDelete)return _listCacheDelete;hasRequired_listCacheDelete=1;var J=require_assocIndexOf(),Y=Array.prototype,re=Y.splice;function ae(ne){var ce=this.__data__,ee=J(ce,ne);if(ee<0)return!1;var R=ce.length-1;return ee==R?ce.pop():re.call(ce,ee,1),--this.size,!0}return _listCacheDelete=ae,_listCacheDelete}var _listCacheGet,hasRequired_listCacheGet;function require_listCacheGet(){if(hasRequired_listCacheGet)return _listCacheGet;hasRequired_listCacheGet=1;var J=require_assocIndexOf();function Y(re){var ae=this.__data__,ne=J(ae,re);return ne<0?void 0:ae[ne][1]}return _listCacheGet=Y,_listCacheGet}var _listCacheHas,hasRequired_listCacheHas;function require_listCacheHas(){if(hasRequired_listCacheHas)return _listCacheHas;hasRequired_listCacheHas=1;var J=require_assocIndexOf();function Y(re){return J(this.__data__,re)>-1}return _listCacheHas=Y,_listCacheHas}var _listCacheSet,hasRequired_listCacheSet;function require_listCacheSet(){if(hasRequired_listCacheSet)return _listCacheSet;hasRequired_listCacheSet=1;var J=require_assocIndexOf();function Y(re,ae){var ne=this.__data__,ce=J(ne,re);return ce<0?(++this.size,ne.push([re,ae])):ne[ce][1]=ae,this}return _listCacheSet=Y,_listCacheSet}var _ListCache,hasRequired_ListCache;function require_ListCache(){if(hasRequired_ListCache)return _ListCache;hasRequired_ListCache=1;var J=require_listCacheClear(),Y=require_listCacheDelete(),re=require_listCacheGet(),ae=require_listCacheHas(),ne=require_listCacheSet();function ce(ee){var R=-1,U=ee==null?0:ee.length;for(this.clear();++R<U;){var K=ee[R];this.set(K[0],K[1])}}return ce.prototype.clear=J,ce.prototype.delete=Y,ce.prototype.get=re,ce.prototype.has=ae,ce.prototype.set=ne,_ListCache=ce,_ListCache}var _Map,hasRequired_Map;function require_Map(){if(hasRequired_Map)return _Map;hasRequired_Map=1;var J=require_getNative(),Y=require_root(),re=J(Y,"Map");return _Map=re,_Map}var _mapCacheClear,hasRequired_mapCacheClear;function require_mapCacheClear(){if(hasRequired_mapCacheClear)return _mapCacheClear;hasRequired_mapCacheClear=1;var J=require_Hash(),Y=require_ListCache(),re=require_Map();function ae(){this.size=0,this.__data__={hash:new J,map:new(re||Y),string:new J}}return _mapCacheClear=ae,_mapCacheClear}var _isKeyable,hasRequired_isKeyable;function require_isKeyable(){if(hasRequired_isKeyable)return _isKeyable;hasRequired_isKeyable=1;function J(Y){var re=typeof Y;return re=="string"||re=="number"||re=="symbol"||re=="boolean"?Y!=="__proto__":Y===null}return _isKeyable=J,_isKeyable}var _getMapData,hasRequired_getMapData;function require_getMapData(){if(hasRequired_getMapData)return _getMapData;hasRequired_getMapData=1;var J=require_isKeyable();function Y(re,ae){var ne=re.__data__;return J(ae)?ne[typeof ae=="string"?"string":"hash"]:ne.map}return _getMapData=Y,_getMapData}var _mapCacheDelete,hasRequired_mapCacheDelete;function require_mapCacheDelete(){if(hasRequired_mapCacheDelete)return _mapCacheDelete;hasRequired_mapCacheDelete=1;var J=require_getMapData();function Y(re){var ae=J(this,re).delete(re);return this.size-=ae?1:0,ae}return _mapCacheDelete=Y,_mapCacheDelete}var _mapCacheGet,hasRequired_mapCacheGet;function require_mapCacheGet(){if(hasRequired_mapCacheGet)return _mapCacheGet;hasRequired_mapCacheGet=1;var J=require_getMapData();function Y(re){return J(this,re).get(re)}return _mapCacheGet=Y,_mapCacheGet}var _mapCacheHas,hasRequired_mapCacheHas;function require_mapCacheHas(){if(hasRequired_mapCacheHas)return _mapCacheHas;hasRequired_mapCacheHas=1;var J=require_getMapData();function Y(re){return J(this,re).has(re)}return _mapCacheHas=Y,_mapCacheHas}var _mapCacheSet,hasRequired_mapCacheSet;function require_mapCacheSet(){if(hasRequired_mapCacheSet)return _mapCacheSet;hasRequired_mapCacheSet=1;var J=require_getMapData();function Y(re,ae){var ne=J(this,re),ce=ne.size;return ne.set(re,ae),this.size+=ne.size==ce?0:1,this}return _mapCacheSet=Y,_mapCacheSet}var _MapCache,hasRequired_MapCache;function require_MapCache(){if(hasRequired_MapCache)return _MapCache;hasRequired_MapCache=1;var J=require_mapCacheClear(),Y=require_mapCacheDelete(),re=require_mapCacheGet(),ae=require_mapCacheHas(),ne=require_mapCacheSet();function ce(ee){var R=-1,U=ee==null?0:ee.length;for(this.clear();++R<U;){var K=ee[R];this.set(K[0],K[1])}}return ce.prototype.clear=J,ce.prototype.delete=Y,ce.prototype.get=re,ce.prototype.has=ae,ce.prototype.set=ne,_MapCache=ce,_MapCache}var memoize_1,hasRequiredMemoize;function requireMemoize(){if(hasRequiredMemoize)return memoize_1;hasRequiredMemoize=1;var J=require_MapCache(),Y="Expected a function";function re(ae,ne){if(typeof ae!="function"||ne!=null&&typeof ne!="function")throw new TypeError(Y);var ce=function(){var ee=arguments,R=ne?ne.apply(this,ee):ee[0],U=ce.cache;if(U.has(R))return U.get(R);var K=ae.apply(this,ee);return ce.cache=U.set(R,K)||U,K};return ce.cache=new(re.Cache||J),ce}return re.Cache=J,memoize_1=re,memoize_1}var memoizeExports=requireMemoize();const memoize=getDefaultExportFromCjs(memoizeExports);var isArray_1,hasRequiredIsArray;function requireIsArray(){if(hasRequiredIsArray)return isArray_1;hasRequiredIsArray=1;var J=Array.isArray;return isArray_1=J,isArray_1}var _isKey,hasRequired_isKey;function require_isKey(){if(hasRequired_isKey)return _isKey;hasRequired_isKey=1;var J=requireIsArray(),Y=requireIsSymbol(),re=/\.|\[(?:[^[\]]*|(["'])(?:(?!\1)[^\\]|\\.)*?\1)\]/,ae=/^\w*$/;function ne(ce,ee){if(J(ce))return!1;var R=typeof ce;return R=="number"||R=="symbol"||R=="boolean"||ce==null||Y(ce)?!0:ae.test(ce)||!re.test(ce)||ee!=null&&ce in Object(ee)}return _isKey=ne,_isKey}var _memoizeCapped,hasRequired_memoizeCapped;function require_memoizeCapped(){if(hasRequired_memoizeCapped)return _memoizeCapped;hasRequired_memoizeCapped=1;var J=requireMemoize(),Y=500;function re(ae){var ne=J(ae,function(ee){return ce.size===Y&&ce.clear(),ee}),ce=ne.cache;return ne}return _memoizeCapped=re,_memoizeCapped}var _stringToPath,hasRequired_stringToPath;function require_stringToPath(){if(hasRequired_stringToPath)return _stringToPath;hasRequired_stringToPath=1;var J=require_memoizeCapped(),Y=/[^.[\]]+|\[(?:(-?\d+(?:\.\d+)?)|(["'])((?:(?!\2)[^\\]|\\.)*?)\2)\]|(?=(?:\.|\[\])(?:\.|\[\]|$))/g,re=/\\(\\)?/g,ae=J(function(ne){var ce=[];return ne.charCodeAt(0)===46&&ce.push(""),ne.replace(Y,function(ee,R,U,K){ce.push(U?K.replace(re,"$1"):R||ee)}),ce});return _stringToPath=ae,_stringToPath}var _arrayMap,hasRequired_arrayMap;function require_arrayMap(){if(hasRequired_arrayMap)return _arrayMap;hasRequired_arrayMap=1;function J(Y,re){for(var ae=-1,ne=Y==null?0:Y.length,ce=Array(ne);++ae<ne;)ce[ae]=re(Y[ae],ae,Y);return ce}return _arrayMap=J,_arrayMap}var _baseToString,hasRequired_baseToString;function require_baseToString(){if(hasRequired_baseToString)return _baseToString;hasRequired_baseToString=1;var J=require_Symbol(),Y=require_arrayMap(),re=requireIsArray(),ae=requireIsSymbol(),ne=J?J.prototype:void 0,ce=ne?ne.toString:void 0;function ee(R){if(typeof R=="string")return R;if(re(R))return Y(R,ee)+"";if(ae(R))return ce?ce.call(R):"";var U=R+"";return U=="0"&&1/R==-1/0?"-0":U}return _baseToString=ee,_baseToString}var toString_1,hasRequiredToString;function requireToString(){if(hasRequiredToString)return toString_1;hasRequiredToString=1;var J=require_baseToString();function Y(re){return re==null?"":J(re)}return toString_1=Y,toString_1}var _castPath,hasRequired_castPath;function require_castPath(){if(hasRequired_castPath)return _castPath;hasRequired_castPath=1;var J=requireIsArray(),Y=require_isKey(),re=require_stringToPath(),ae=requireToString();function ne(ce,ee){return J(ce)?ce:Y(ce,ee)?[ce]:re(ae(ce))}return _castPath=ne,_castPath}var _toKey,hasRequired_toKey;function require_toKey(){if(hasRequired_toKey)return _toKey;hasRequired_toKey=1;var J=requireIsSymbol();function Y(re){if(typeof re=="string"||J(re))return re;var ae=re+"";return ae=="0"&&1/re==-1/0?"-0":ae}return _toKey=Y,_toKey}var _baseGet,hasRequired_baseGet;function require_baseGet(){if(hasRequired_baseGet)return _baseGet;hasRequired_baseGet=1;var J=require_castPath(),Y=require_toKey();function re(ae,ne){ne=J(ne,ae);for(var ce=0,ee=ne.length;ae!=null&&ce<ee;)ae=ae[Y(ne[ce++])];return ce&&ce==ee?ae:void 0}return _baseGet=re,_baseGet}var _defineProperty,hasRequired_defineProperty;function require_defineProperty(){if(hasRequired_defineProperty)return _defineProperty;hasRequired_defineProperty=1;var J=require_getNative(),Y=(function(){try{var re=J(Object,"defineProperty");return re({},"",{}),re}catch{}})();return _defineProperty=Y,_defineProperty}var _baseAssignValue,hasRequired_baseAssignValue;function require_baseAssignValue(){if(hasRequired_baseAssignValue)return _baseAssignValue;hasRequired_baseAssignValue=1;var J=require_defineProperty();function Y(re,ae,ne){ae=="__proto__"&&J?J(re,ae,{configurable:!0,enumerable:!0,value:ne,writable:!0}):re[ae]=ne}return _baseAssignValue=Y,_baseAssignValue}var _assignValue,hasRequired_assignValue;function require_assignValue(){if(hasRequired_assignValue)return _assignValue;hasRequired_assignValue=1;var J=require_baseAssignValue(),Y=requireEq(),re=Object.prototype,ae=re.hasOwnProperty;function ne(ce,ee,R){var U=ce[ee];(!(ae.call(ce,ee)&&Y(U,R))||R===void 0&&!(ee in ce))&&J(ce,ee,R)}return _assignValue=ne,_assignValue}var _isIndex,hasRequired_isIndex;function require_isIndex(){if(hasRequired_isIndex)return _isIndex;hasRequired_isIndex=1;var J=9007199254740991,Y=/^(?:0|[1-9]\d*)$/;function re(ae,ne){var ce=typeof ae;return ne=ne??J,!!ne&&(ce=="number"||ce!="symbol"&&Y.test(ae))&&ae>-1&&ae%1==0&&ae<ne}return _isIndex=re,_isIndex}var _baseSet,hasRequired_baseSet;function require_baseSet(){if(hasRequired_baseSet)return _baseSet;hasRequired_baseSet=1;var J=require_assignValue(),Y=require_castPath(),re=require_isIndex(),ae=requireIsObject(),ne=require_toKey();function ce(ee,R,U,K){if(!ae(ee))return ee;R=Y(R,ee);for(var oe=-1,pe=R.length,_e=pe-1,me=ee;me!=null&&++oe<pe;){var we=ne(R[oe]),Oe=U;if(we==="__proto__"||we==="constructor"||we==="prototype")return ee;if(oe!=_e){var De=me[we];Oe=K?K(De,we,me):void 0,Oe===void 0&&(Oe=ae(De)?De:re(R[oe+1])?[]:{})}J(me,we,Oe),me=me[we]}return ee}return _baseSet=ce,_baseSet}var _basePickBy,hasRequired_basePickBy;function require_basePickBy(){if(hasRequired_basePickBy)return _basePickBy;hasRequired_basePickBy=1;var J=require_baseGet(),Y=require_baseSet(),re=require_castPath();function ae(ne,ce,ee){for(var R=-1,U=ce.length,K={};++R<U;){var oe=ce[R],pe=J(ne,oe);ee(pe,oe)&&Y(K,re(oe,ne),pe)}return K}return _basePickBy=ae,_basePickBy}var _baseHasIn,hasRequired_baseHasIn;function require_baseHasIn(){if(hasRequired_baseHasIn)return _baseHasIn;hasRequired_baseHasIn=1;function J(Y,re){return Y!=null&&re in Object(Y)}return _baseHasIn=J,_baseHasIn}var _baseIsArguments,hasRequired_baseIsArguments;function require_baseIsArguments(){if(hasRequired_baseIsArguments)return _baseIsArguments;hasRequired_baseIsArguments=1;var J=require_baseGetTag(),Y=requireIsObjectLike(),re="[object Arguments]";function ae(ne){return Y(ne)&&J(ne)==re}return _baseIsArguments=ae,_baseIsArguments}var isArguments_1,hasRequiredIsArguments;function requireIsArguments(){if(hasRequiredIsArguments)return isArguments_1;hasRequiredIsArguments=1;var J=require_baseIsArguments(),Y=requireIsObjectLike(),re=Object.prototype,ae=re.hasOwnProperty,ne=re.propertyIsEnumerable,ce=J((function(){return arguments})())?J:function(ee){return Y(ee)&&ae.call(ee,"callee")&&!ne.call(ee,"callee")};return isArguments_1=ce,isArguments_1}var isLength_1,hasRequiredIsLength;function requireIsLength(){if(hasRequiredIsLength)return isLength_1;hasRequiredIsLength=1;var J=9007199254740991;function Y(re){return typeof re=="number"&&re>-1&&re%1==0&&re<=J}return isLength_1=Y,isLength_1}var _hasPath,hasRequired_hasPath;function require_hasPath(){if(hasRequired_hasPath)return _hasPath;hasRequired_hasPath=1;var J=require_castPath(),Y=requireIsArguments(),re=requireIsArray(),ae=require_isIndex(),ne=requireIsLength(),ce=require_toKey();function ee(R,U,K){U=J(U,R);for(var oe=-1,pe=U.length,_e=!1;++oe<pe;){var me=ce(U[oe]);if(!(_e=R!=null&&K(R,me)))break;R=R[me]}return _e||++oe!=pe?_e:(pe=R==null?0:R.length,!!pe&&ne(pe)&&ae(me,pe)&&(re(R)||Y(R)))}return _hasPath=ee,_hasPath}var hasIn_1,hasRequiredHasIn;function requireHasIn(){if(hasRequiredHasIn)return hasIn_1;hasRequiredHasIn=1;var J=require_baseHasIn(),Y=require_hasPath();function re(ae,ne){return ae!=null&&Y(ae,ne,J)}return hasIn_1=re,hasIn_1}var _basePick,hasRequired_basePick;function require_basePick(){if(hasRequired_basePick)return _basePick;hasRequired_basePick=1;var J=require_basePickBy(),Y=requireHasIn();function re(ae,ne){return J(ae,ne,function(ce,ee){return Y(ae,ee)})}return _basePick=re,_basePick}var _arrayPush,hasRequired_arrayPush;function require_arrayPush(){if(hasRequired_arrayPush)return _arrayPush;hasRequired_arrayPush=1;function J(Y,re){for(var ae=-1,ne=re.length,ce=Y.length;++ae<ne;)Y[ce+ae]=re[ae];return Y}return _arrayPush=J,_arrayPush}var _isFlattenable,hasRequired_isFlattenable;function require_isFlattenable(){if(hasRequired_isFlattenable)return _isFlattenable;hasRequired_isFlattenable=1;var J=require_Symbol(),Y=requireIsArguments(),re=requireIsArray(),ae=J?J.isConcatSpreadable:void 0;function ne(ce){return re(ce)||Y(ce)||!!(ae&&ce&&ce[ae])}return _isFlattenable=ne,_isFlattenable}var _baseFlatten,hasRequired_baseFlatten;function require_baseFlatten(){if(hasRequired_baseFlatten)return _baseFlatten;hasRequired_baseFlatten=1;var J=require_arrayPush(),Y=require_isFlattenable();function re(ae,ne,ce,ee,R){var U=-1,K=ae.length;for(ce||(ce=Y),R||(R=[]);++U<K;){var oe=ae[U];ne>0&&ce(oe)?ne>1?re(oe,ne-1,ce,ee,R):J(R,oe):ee||(R[R.length]=oe)}return R}return _baseFlatten=re,_baseFlatten}var flatten_1,hasRequiredFlatten;function requireFlatten(){if(hasRequiredFlatten)return flatten_1;hasRequiredFlatten=1;var J=require_baseFlatten();function Y(re){var ae=re==null?0:re.length;return ae?J(re,1):[]}return flatten_1=Y,flatten_1}var _apply,hasRequired_apply;function require_apply(){if(hasRequired_apply)return _apply;hasRequired_apply=1;function J(Y,re,ae){switch(ae.length){case 0:return Y.call(re);case 1:return Y.call(re,ae[0]);case 2:return Y.call(re,ae[0],ae[1]);case 3:return Y.call(re,ae[0],ae[1],ae[2])}return Y.apply(re,ae)}return _apply=J,_apply}var _overRest,hasRequired_overRest;function require_overRest(){if(hasRequired_overRest)return _overRest;hasRequired_overRest=1;var J=require_apply(),Y=Math.max;function re(ae,ne,ce){return ne=Y(ne===void 0?ae.length-1:ne,0),function(){for(var ee=arguments,R=-1,U=Y(ee.length-ne,0),K=Array(U);++R<U;)K[R]=ee[ne+R];R=-1;for(var oe=Array(ne+1);++R<ne;)oe[R]=ee[R];return oe[ne]=ce(K),J(ae,this,oe)}}return _overRest=re,_overRest}var constant_1,hasRequiredConstant;function requireConstant(){if(hasRequiredConstant)return constant_1;hasRequiredConstant=1;function J(Y){return function(){return Y}}return constant_1=J,constant_1}var identity_1,hasRequiredIdentity;function requireIdentity(){if(hasRequiredIdentity)return identity_1;hasRequiredIdentity=1;function J(Y){return Y}return identity_1=J,identity_1}var _baseSetToString,hasRequired_baseSetToString;function require_baseSetToString(){if(hasRequired_baseSetToString)return _baseSetToString;hasRequired_baseSetToString=1;var J=requireConstant(),Y=require_defineProperty(),re=requireIdentity(),ae=Y?function(ne,ce){return Y(ne,"toString",{configurable:!0,enumerable:!1,value:J(ce),writable:!0})}:re;return _baseSetToString=ae,_baseSetToString}var _shortOut,hasRequired_shortOut;function require_shortOut(){if(hasRequired_shortOut)return _shortOut;hasRequired_shortOut=1;var J=800,Y=16,re=Date.now;function ae(ne){var ce=0,ee=0;return function(){var R=re(),U=Y-(R-ee);if(ee=R,U>0){if(++ce>=J)return arguments[0]}else ce=0;return ne.apply(void 0,arguments)}}return _shortOut=ae,_shortOut}var _setToString,hasRequired_setToString;function require_setToString(){if(hasRequired_setToString)return _setToString;hasRequired_setToString=1;var J=require_baseSetToString(),Y=require_shortOut(),re=Y(J);return _setToString=re,_setToString}var _flatRest,hasRequired_flatRest;function require_flatRest(){if(hasRequired_flatRest)return _flatRest;hasRequired_flatRest=1;var J=requireFlatten(),Y=require_overRest(),re=require_setToString();function ae(ne){return re(Y(ne,void 0,J),ne+"")}return _flatRest=ae,_flatRest}var pick_1,hasRequiredPick;function requirePick(){if(hasRequiredPick)return pick_1;hasRequiredPick=1;var J=require_basePick(),Y=require_flatRest(),re=Y(function(ae,ne){return ae==null?{}:J(ae,ne)});return pick_1=re,pick_1}var pickExports=requirePick();const pick$1=getDefaultExportFromCjs(pickExports),token="%[a-f0-9]{2}",singleMatcher=new RegExp("("+token+")|([^%]+?)","gi"),multiMatcher=new RegExp("("+token+")+","gi");function decodeComponents(J,Y){try{return[decodeURIComponent(J.join(""))]}catch{}if(J.length===1)return J;Y=Y||1;const re=J.slice(0,Y),ae=J.slice(Y);return Array.prototype.concat.call([],decodeComponents(re),decodeComponents(ae))}function decode$1(J){try{return decodeURIComponent(J)}catch{let Y=J.match(singleMatcher)||[];for(let re=1;re<Y.length;re++)J=decodeComponents(Y,re).join(""),Y=J.match(singleMatcher)||[];return J}}function customDecodeURIComponent(J){const Y={"%FE%FF":"ï¿½ï¿½","%FF%FE":"ï¿½ï¿½"};let re=multiMatcher.exec(J);for(;re;){try{Y[re[0]]=decodeURIComponent(re[0])}catch{const ne=decode$1(re[0]);ne!==re[0]&&(Y[re[0]]=ne)}re=multiMatcher.exec(J)}Y["%C2"]="ï¿½";const ae=Object.keys(Y);for(const ne of ae)J=J.replace(new RegExp(ne,"g"),Y[ne]);return J}function decodeUriComponent(J){if(typeof J!="string")throw new TypeError("Expected `encodedURI` to be of type `string`, got `"+typeof J+"`");try{return decodeURIComponent(J)}catch{return customDecodeURIComponent(J)}}function includeKeys(J,Y){const re={};if(Array.isArray(Y))for(const ae of Y){const ne=Object.getOwnPropertyDescriptor(J,ae);ne!=null&&ne.enumerable&&Object.defineProperty(re,ae,ne)}else for(const ae of Reflect.ownKeys(J)){const ne=Object.getOwnPropertyDescriptor(J,ae);if(ne.enumerable){const ce=J[ae];Y(ae,ce,J)&&Object.defineProperty(re,ae,ne)}}return re}function splitOnFirst(J,Y){if(!(typeof J=="string"&&typeof Y=="string"))throw new TypeError("Expected the arguments to be of type `string`");if(J===""||Y==="")return[];const re=J.indexOf(Y);return re===-1?[]:[J.slice(0,re),J.slice(re+Y.length)]}const isNullOrUndefined=J=>J==null,strictUriEncode=J=>encodeURIComponent(J).replaceAll(/[!'()*]/g,Y=>`%${Y.charCodeAt(0).toString(16).toUpperCase()}`),encodeFragmentIdentifier=Symbol("encodeFragmentIdentifier");function encoderForArrayFormat(J){switch(J.arrayFormat){case"index":return Y=>(re,ae)=>{const ne=re.length;return ae===void 0||J.skipNull&&ae===null||J.skipEmptyString&&ae===""?re:ae===null?[...re,[encode(Y,J),"[",ne,"]"].join("")]:[...re,[encode(Y,J),"[",encode(ne,J),"]=",encode(ae,J)].join("")]};case"bracket":return Y=>(re,ae)=>ae===void 0||J.skipNull&&ae===null||J.skipEmptyString&&ae===""?re:ae===null?[...re,[encode(Y,J),"[]"].join("")]:[...re,[encode(Y,J),"[]=",encode(ae,J)].join("")];case"colon-list-separator":return Y=>(re,ae)=>ae===void 0||J.skipNull&&ae===null||J.skipEmptyString&&ae===""?re:ae===null?[...re,[encode(Y,J),":list="].join("")]:[...re,[encode(Y,J),":list=",encode(ae,J)].join("")];case"comma":case"separator":case"bracket-separator":{const Y=J.arrayFormat==="bracket-separator"?"[]=":"=";return re=>(ae,ne)=>ne===void 0||J.skipNull&&ne===null||J.skipEmptyString&&ne===""?ae:(ne=ne===null?"":ne,ae.length===0?[[encode(re,J),Y,encode(ne,J)].join("")]:[[ae,encode(ne,J)].join(J.arrayFormatSeparator)])}default:return Y=>(re,ae)=>ae===void 0||J.skipNull&&ae===null||J.skipEmptyString&&ae===""?re:ae===null?[...re,encode(Y,J)]:[...re,[encode(Y,J),"=",encode(ae,J)].join("")]}}function parserForArrayFormat(J){let Y;switch(J.arrayFormat){case"index":return(re,ae,ne)=>{if(Y=/\[(\d*)]$/.exec(re),re=re.replace(/\[\d*]$/,""),!Y){ne[re]=ae;return}ne[re]===void 0&&(ne[re]={}),ne[re][Y[1]]=ae};case"bracket":return(re,ae,ne)=>{if(Y=/(\[])$/.exec(re),re=re.replace(/\[]$/,""),!Y){ne[re]=ae;return}if(ne[re]===void 0){ne[re]=[ae];return}ne[re]=[...ne[re],ae]};case"colon-list-separator":return(re,ae,ne)=>{if(Y=/(:list)$/.exec(re),re=re.replace(/:list$/,""),!Y){ne[re]=ae;return}if(ne[re]===void 0){ne[re]=[ae];return}ne[re]=[...ne[re],ae]};case"comma":case"separator":return(re,ae,ne)=>{const ee=typeof ae=="string"&&ae.includes(J.arrayFormatSeparator)?ae.split(J.arrayFormatSeparator).map(R=>decode(R,J)):ae===null?ae:decode(ae,J);ne[re]=ee};case"bracket-separator":return(re,ae,ne)=>{const ce=/(\[])$/.test(re);if(re=re.replace(/\[]$/,""),!ce){ne[re]=ae&&decode(ae,J);return}const ee=ae===null?[]:decode(ae,J).split(J.arrayFormatSeparator);if(ne[re]===void 0){ne[re]=ee;return}ne[re]=[...ne[re],...ee]};default:return(re,ae,ne)=>{if(ne[re]===void 0){ne[re]=ae;return}ne[re]=[...[ne[re]].flat(),ae]}}}function validateArrayFormatSeparator(J){if(typeof J!="string"||J.length!==1)throw new TypeError("arrayFormatSeparator must be single character string")}function encode(J,Y){return Y.encode?Y.strict?strictUriEncode(J):encodeURIComponent(J):J}function decode(J,Y){return Y.decode?decodeUriComponent(J):J}function keysSorter(J){return Array.isArray(J)?J.sort():typeof J=="object"?keysSorter(Object.keys(J)).sort((Y,re)=>Number(Y)-Number(re)).map(Y=>J[Y]):J}function removeHash(J){const Y=J.indexOf("#");return Y!==-1&&(J=J.slice(0,Y)),J}function getHash(J){let Y="";const re=J.indexOf("#");return re!==-1&&(Y=J.slice(re)),Y}function parseValue(J,Y,re){return re==="string"&&typeof J=="string"?J:typeof re=="function"&&typeof J=="string"?re(J):re==="boolean"&&J===null?!0:re==="boolean"&&J!==null&&(J.toLowerCase()==="true"||J.toLowerCase()==="false")?J.toLowerCase()==="true":re==="boolean"&&J!==null&&(J.toLowerCase()==="1"||J.toLowerCase()==="0")?J.toLowerCase()==="1":re==="string[]"&&Y.arrayFormat!=="none"&&typeof J=="string"?[J]:re==="number[]"&&Y.arrayFormat!=="none"&&!Number.isNaN(Number(J))&&typeof J=="string"&&J.trim()!==""?[Number(J)]:re==="number"&&!Number.isNaN(Number(J))&&typeof J=="string"&&J.trim()!==""?Number(J):Y.parseBooleans&&J!==null&&(J.toLowerCase()==="true"||J.toLowerCase()==="false")?J.toLowerCase()==="true":Y.parseNumbers&&!Number.isNaN(Number(J))&&typeof J=="string"&&J.trim()!==""?Number(J):J}function extract(J){J=removeHash(J);const Y=J.indexOf("?");return Y===-1?"":J.slice(Y+1)}function parse(J,Y){Y={decode:!0,sort:!0,arrayFormat:"none",arrayFormatSeparator:",",parseNumbers:!1,parseBooleans:!1,types:Object.create(null),...Y},validateArrayFormatSeparator(Y.arrayFormatSeparator);const re=parserForArrayFormat(Y),ae=Object.create(null);if(typeof J!="string"||(J=J.trim().replace(/^[?#&]/,""),!J))return ae;for(const ne of J.split("&")){if(ne==="")continue;const ce=Y.decode?ne.replaceAll("+"," "):ne;let[ee,R]=splitOnFirst(ce,"=");ee===void 0&&(ee=ce),R=R===void 0?null:["comma","separator","bracket-separator"].includes(Y.arrayFormat)?R:decode(R,Y),re(decode(ee,Y),R,ae)}for(const[ne,ce]of Object.entries(ae))if(typeof ce=="object"&&ce!==null&&Y.types[ne]!=="string")for(const[ee,R]of Object.entries(ce)){const U=Y.types[ne],K=typeof U=="function"?U:U?U.replace("[]",""):void 0;ce[ee]=parseValue(R,Y,K)}else typeof ce=="object"&&ce!==null&&Y.types[ne]==="string"?ae[ne]=Object.values(ce).join(Y.arrayFormatSeparator):ae[ne]=parseValue(ce,Y,Y.types[ne]);return Y.sort===!1?ae:(Y.sort===!0?Object.keys(ae).sort():Object.keys(ae).sort(Y.sort)).reduce((ne,ce)=>{const ee=ae[ce];return ne[ce]=ee&&typeof ee=="object"&&!Array.isArray(ee)?keysSorter(ee):ee,ne},Object.create(null))}function stringify(J,Y){if(!J)return"";Y={encode:!0,strict:!0,arrayFormat:"none",arrayFormatSeparator:",",...Y},validateArrayFormatSeparator(Y.arrayFormatSeparator);const re=ee=>Y.skipNull&&isNullOrUndefined(J[ee])||Y.skipEmptyString&&J[ee]==="",ae=encoderForArrayFormat(Y),ne={};for(const[ee,R]of Object.entries(J))re(ee)||(ne[ee]=R);const ce=Object.keys(ne);return Y.sort!==!1&&ce.sort(Y.sort),ce.map(ee=>{let R=J[ee];if(Y.replacer&&(R=Y.replacer(ee,R),R===void 0)||R===void 0)return"";if(R===null)return encode(ee,Y);if(Array.isArray(R)){if(R.length===0&&Y.arrayFormat==="bracket-separator")return encode(ee,Y)+"[]";let U=R;return Y.replacer&&(U=R.map((K,oe)=>Y.replacer(`${ee}[${oe}]`,K)).filter(K=>K!==void 0)),U.reduce(ae(ee),[]).join("&")}return encode(ee,Y)+"="+encode(R,Y)}).filter(ee=>ee.length>0).join("&")}function parseUrl(J,Y){var ne;Y={decode:!0,...Y};let[re,ae]=splitOnFirst(J,"#");return re===void 0&&(re=J),{url:((ne=re==null?void 0:re.split("?"))==null?void 0:ne[0])??"",query:parse(extract(J),Y),...Y&&Y.parseFragmentIdentifier&&ae?{fragmentIdentifier:decode(ae,Y)}:{}}}function stringifyUrl(J,Y){Y={encode:!0,strict:!0,[encodeFragmentIdentifier]:!0,...Y};const re=removeHash(J.url).split("?")[0]||"",ae=extract(J.url),ne={...parse(ae,{sort:!1,...Y}),...J.query};let ce=stringify(ne,Y);ce&&(ce=`?${ce}`);let ee=getHash(J.url);if(typeof J.fragmentIdentifier=="string"){const R=new URL(re);R.hash=J.fragmentIdentifier,ee=Y[encodeFragmentIdentifier]?R.hash:`#${J.fragmentIdentifier}`}return`${re}${ce}${ee}`}function pick(J,Y,re){re={parseFragmentIdentifier:!0,[encodeFragmentIdentifier]:!1,...re};const{url:ae,query:ne,fragmentIdentifier:ce}=parseUrl(J,re);return stringifyUrl({url:ae,query:includeKeys(ne,Y),fragmentIdentifier:ce},re)}function exclude(J,Y,re){const ae=Array.isArray(Y)?ne=>!Y.includes(ne):(ne,ce)=>!Y(ne,ce);return pick(J,ae,re)}const queryString=Object.freeze(Object.defineProperty({__proto__:null,exclude,extract,parse,parseUrl,pick,stringify,stringifyUrl},Symbol.toStringTag,{value:"Module"})),{parse:_qsParse,stringify:qsStringify}=queryString,qsParse=memoize(_qsParse),decodeString=J=>J,decodeBoolean=J=>J==="true",decodeInteger=J=>parseInt(J),PERSISTED_STATE_FIELDS={feedUrl:{decode:decodeString,apply:(J,Y)=>Y.emit("feed:set-url",J)},feedSyncStopped:{decode:decodeBoolean,apply:(J,Y)=>{Y.emit(`feed:${J?"stop":"start"}-sync`)}},feedSyncInterval:{decode:decodeInteger,apply:(J,Y)=>{Y.emit("feed:set-sync-interval",J)}},feedLogFilter:{decode:decodeString,apply:(J,Y)=>Y.emit("feed-log:set-filter",J)},inspectorFilter:{decode:decodeString,apply:(J,Y)=>Y.emit("inspector:set-filter",J)},view:{decode:decodeString,apply:(J,Y)=>Y.emit("view:set",J)},shapeIdsByTripIdUrl:{decode:decodeString,apply:(J,Y)=>Y.emit("shape-ids-by-trip-id-url:set",J)},shapeUrl:{decode:decodeString,apply:(J,Y)=>Y.emit("shape-url:set",J)},focusedTripId:{decode:decodeString,apply:(J,Y)=>Y.emit("focus-trip-id",J)},focusedVehicleId:{decode:decodeString,apply:(J,Y)=>Y.emit("focus-vehicle-id",J)}},pluckState=J=>pick$1(J,Object.keys(PERSISTED_STATE_FIELDS)),urlStore=(J,Y)=>{const re=ce=>{for(const[ee,R]of Object.entries(ce)){const{decode:U,apply:K}=PERSISTED_STATE_FIELDS[ee];K(U(R),Y)}Y.emit(Y.STATE_CHANGE)};window.addEventListener("popstate",ce=>{const ee=pluckState(ce.state||{});re(ee)});const ae=debounce(()=>{const ce=pluckState(J),ee={...qsParse(location.search.slice(1)),...ce},R="?"+qsStringify(ee);R!==location.search&&history.replaceState(ce,"_",R)},500,{leading:!0});Y.on(Y.STATE_CHANGE,ae);const ne=pluckState(qsParse(location.search.slice(1)));setTimeout(re,1,ne)},homepage="https://github.com/derhuerst/gtfs-rt-inspector",pkg={homepage},barView=({state:J,emit:Y})=>{const re=(K,oe)=>{const pe=_e=>{_e.metaKey||_e.ctrlKey||(_e.preventDefault(),Y("view:set",K))};return u("li",{class:oe?"active":null,children:u("a",{href:"?view="+K,onClick:pe,children:K})})},ae=u("ul",{class:"nav",children:[re("log",J.view==="log"),re("inspector",J.view==="inspector"),re("map",J.view==="map"),re("raw",J.view==="raw"),u("li",{children:u("a",{href:pkg.homepage,target:"_parent",title:name+" homepage",children:"?"})})]}),ne=K=>{Y("feed:set-url",K.target.value)},ce=()=>{Y("feed:sync")},ee=()=>{J.feedSyncStopped?Y("feed:start-sync"):Y("feed:stop-sync")},R=K=>{const oe=parseInt(K.target.value);Y("feed:set-sync-interval",oe)},U=u("div",{class:"feed",children:[u("input",{onInput:ne,value:J.feedUrl}),u("input",{class:"interval",type:"number",min:"1",step:"10",onChange:R,value:J.feedSyncInterval}),u("button",{class:J.feedSyncing?"sync syncing":"sync",onClick:ce,disabled:!J.feedUrl||!!J.feedSyncing,children:u("span",{children:"â»"})}),u("button",{onClick:ee,disabled:!J.feedUrl,children:J.feedSyncStopped?"â¶ï¸":"â¸"})]});return u("div",{class:"bar",children:[u("div",{class:"logo",children:"ðð"}),ae,U]})};var ms$1,hasRequiredMs;function requireMs(){if(hasRequiredMs)return ms$1;hasRequiredMs=1;var J=1e3,Y=J*60,re=Y*60,ae=re*24,ne=ae*7,ce=ae*365.25;ms$1=function(oe,pe){pe=pe||{};var _e=typeof oe;if(_e==="string"&&oe.length>0)return ee(oe);if(_e==="number"&&isFinite(oe))return pe.long?U(oe):R(oe);throw new Error("val is not a non-empty string or a valid number. val="+JSON.stringify(oe))};function ee(oe){if(oe=String(oe),!(oe.length>100)){var pe=/^(-?(?:\d+)?\.?\d+) *(milliseconds?|msecs?|ms|seconds?|secs?|s|minutes?|mins?|m|hours?|hrs?|h|days?|d|weeks?|w|years?|yrs?|y)?$/i.exec(oe);if(pe){var _e=parseFloat(pe[1]),me=(pe[2]||"ms").toLowerCase();switch(me){case"years":case"year":case"yrs":case"yr":case"y":return _e*ce;case"weeks":case"week":case"w":return _e*ne;case"days":case"day":case"d":return _e*ae;case"hours":case"hour":case"hrs":case"hr":case"h":return _e*re;case"minutes":case"minute":case"mins":case"min":case"m":return _e*Y;case"seconds":case"second":case"secs":case"sec":case"s":return _e*J;case"milliseconds":case"millisecond":case"msecs":case"msec":case"ms":return _e;default:return}}}}function R(oe){var pe=Math.abs(oe);return pe>=ae?Math.round(oe/ae)+"d":pe>=re?Math.round(oe/re)+"h":pe>=Y?Math.round(oe/Y)+"m":pe>=J?Math.round(oe/J)+"s":oe+"ms"}function U(oe){var pe=Math.abs(oe);return pe>=ae?K(oe,pe,ae,"day"):pe>=re?K(oe,pe,re,"hour"):pe>=Y?K(oe,pe,Y,"minute"):pe>=J?K(oe,pe,J,"second"):oe+" ms"}function K(oe,pe,_e,me){var we=pe>=_e*1.5;return Math.round(oe/_e)+" "+me+(we?"s":"")}return ms$1}var msExports=requireMs();const ms=getDefaultExportFromCjs(msExports),renderDelay=J=>typeof J!="number"?"?":J===0?"0s":ms(J*1e3),renderMaxItemsMsg=(J,Y)=>J<Y?null:u("p",{children:["Only ",Y," items are displayed. Use the filter search box above to get fewer items."]}),renderFilterInput=(J,Y)=>u("p",{children:u("input",{value:J??"",onChange:re=>Y(re.target.value),placeholder:"filter by text"})}),renderTimestamp=J=>J?new Date(J*1e3).toISOString():"?",{SCHEDULED:SCHEDULED$1,SKIPPED,NO_DATA}=gtfsRtBindingsExports.TripUpdate.StopTimeUpdate.ScheduleRelationship,renderStopTimeUpdateScheduleRelationship=J=>J===SCHEDULED$1?u("code",{children:u("abbr",{title:"SCHEDULED",children:"SCHED"})}):J===SKIPPED?u("code",{children:u("abbr",{title:"SKIPPED",children:"SKIP"})}):J===NO_DATA?u("code",{children:u("abbr",{title:"NO_DATA",children:"NO_DATA"})}):"?",renderFeedLogEntry=J=>{const{entityId:Y,timestamp:re,routeId:ae,directionId:ne,tripId:ce,vehicleId:ee,vehicleLabel:R,stopId:U,scheduleRelationship:K,tArrival:oe,delay:pe}=J;return u("tr",{id:"entity-"+Y,children:[u("td",{children:u("code",{children:Y})}),u("td",{children:renderTimestamp(re)}),u("td",{children:u("code",{children:ae})}),u("td",{children:u("code",{children:ne})}),u("td",{children:u("code",{children:ce})}),u("td",{children:u("code",{children:ee})}),u("td",{children:u("code",{children:R})}),u("td",{children:u("code",{children:U})}),u("td",{children:renderStopTimeUpdateScheduleRelationship(K)}),u("td",{children:renderTimestamp(oe)}),u("td",{children:renderDelay(pe)})]})},logView=({state:J,emit:Y})=>{const{feedLogFilter:re,feedLog:ae,unfilteredFeedLog:ne}=J,ce=ee=>{Y("feed-log:set-filter",ee)};return u("div",{class:"log",children:[u("h2",{children:["Upcoming ",u("code",{children:"StopTimeUpdate"}),"s (",ae.length," of ",ne.length,")"]}),renderFilterInput(re,ce),renderMaxItemsMsg(ae.length,MAX_LOG_ITEMS),u("table",{children:[u("thead",{children:[u("tr",{children:[u("th",{rowspan:"2",children:u("code",{children:u("abbr",{title:"entity.id",children:"e_id"})})}),u("th",{rowspan:"2",children:u("abbr",{title:"stop_time_update[].timestamp or feed timestamp",children:u("code",{children:"t"})})}),u("th",{colspan:"2",children:u("code",{children:"trip"})}),u("th",{colspan:"3",children:u("code",{children:"vehicle"})}),u("th",{colspan:"4",children:u("code",{children:"stop_time_update"})})]}),u("tr",{children:[u("th",{children:u("code",{children:"route_id"})}),u("th",{children:u("code",{children:u("abbr",{title:"trip.direction_id",children:"dir_id"})})}),u("th",{children:u("code",{children:"trip_id"})}),u("th",{children:u("code",{children:"id"})}),u("th",{children:u("code",{children:"label"})}),u("th",{children:u("code",{children:"stop_id"})}),u("th",{children:u("abbr",{title:"stop_time_update[].schedule_relationship",children:"s_rel"})}),u("th",{children:u("code",{children:u("abbr",{title:"stop_time_update[].arrival.time",children:"arr"})})}),u("th",{children:u("code",{children:u("abbr",{title:"stop_time_update[].arrival.delay",children:"delay"})})})]})]}),u("tbody",{children:ae.map(renderFeedLogEntry)})]})]})},renderStartDate=J=>typeof J!="string"||!J?"?":u("code",{children:u("abbr",{title:J,children:[J.slice(4,6),"-",J.slice(6,8)]})}),renderStartTime=J=>typeof J!="string"||!J?"?":u("code",{children:J}),{SCHEDULED,ADDED,UNSCHEDULED,CANCELED,DUPLICATED,DELETED}=gtfsRtBindingsExports.TripDescriptor.ScheduleRelationship,renderTripScheduleRelationship=J=>J===SCHEDULED?u("code",{children:u("abbr",{title:"SCHEDULED",children:"SCHED"})}):J===ADDED?u("code",{children:u("abbr",{title:"ADDED",children:"ADD"})}):J===UNSCHEDULED?u("code",{children:u("abbr",{title:"UNSCHEDULED",children:"UNSCHED"})}):J===CANCELED?u("code",{children:u("abbr",{title:"CANCELED",children:"CNCL"})}):J===DUPLICATED?u("code",{children:u("abbr",{title:"DUPLICATED",children:"DUPL"})}):J===DELETED?u("code",{children:u("abbr",{title:"DELETED",children:"DEL"})}):"?",{INCOMING_AT,STOPPED_AT,IN_TRANSIT_TO}=gtfsRtBindingsExports.VehiclePosition.VehicleStopStatus,renderVehicleStopStatus=J=>J===INCOMING_AT?u("code",{children:u("abbr",{title:"INCOMING_AT",children:"INC_AT"})}):J===STOPPED_AT?u("code",{children:u("abbr",{title:"STOPPED_AT",children:"STOP_AT"})}):J===IN_TRANSIT_TO?u("code",{children:u("abbr",{title:"IN_TRANSIT_TO",children:"IN_TR_TO"})}):"?",renderPosition=J=>{if(!J)return"?";const Y=[typeof J.latitude=="number"?J.latitude:"?",typeof J.longitude=="number"?J.longitude:"?"].join(" | "),re=typeof J.latitude=="number"?u("code",{children:J.latitude.toFixed(3)}):"?",ae=typeof J.longitude=="number"?u("code",{children:J.longitude.toFixed(3)}):"?";return u("abbr",{title:Y,children:[re," ",ae]})},{RUNNING_SMOOTHLY,STOP_AND_GO,CONGESTION,SEVERE_CONGESTION}=gtfsRtBindingsExports.VehiclePosition.CongestionLevel,renderCongestionLevel=J=>J===1?u("code",{children:u("abbr",{title:"RUNNING_SMOOTHLY",children:"SMOOTH"})}):J===2?u("code",{children:u("abbr",{title:"STOP_AND_GO",children:"STOP_GO"})}):J===3?u("code",{children:u("abbr",{title:"CONGESTION",children:"CONG"})}):J===4?u("code",{children:u("abbr",{title:"SEVERE_CONGESTION",children:"SEV_CONG"})}):"?",{EMPTY,MANY_SEATS_AVAILABLE,FEW_SEATS_AVAILABLE,STANDING_ROOM_ONLY,CRUSHED_STANDING_ROOM_ONLY,FULL,NOT_ACCEPTING_PASSENGERS}=gtfsRtBindingsExports.VehiclePosition.OccupancyStatus,renderOccupancyStatus=J=>J===0?u("code",{children:u("abbr",{title:"EMPTY",children:"EMPTY"})}):J===1?u("code",{children:u("abbr",{title:"MANY_SEATS_AVAILABLE",children:"MANY_SEATS"})}):J===2?u("code",{children:u("abbr",{title:"FEW_SEATS_AVAILABLE",children:"FEW_SEATS"})}):J===3?u("code",{children:u("abbr",{title:"STANDING_ROOM_ONLY",children:"STANDING"})}):J===4?u("code",{children:u("abbr",{title:"CRUSHED_STANDING_ROOM_ONLY",children:"CRUSHED"})}):J===5?u("code",{children:u("abbr",{title:"FULL",children:"FULL"})}):J===6?u("code",{children:u("abbr",{title:"NOT_ACCEPTING_PASSENGERS",children:"NOT_ACCEPT"})}):"?",renderVehicleId=(J,Y,re)=>u("a",{href:"#",onClick:ne=>{re("focus-vehicle-id",J),re("focus-trip-id",Y.trip.trip_id),re("view:set","map"),ne.preventDefault()},alt:"show vehicle on the map",children:u("code",{children:J})}),renderTripUpdate=(J,Y)=>{const re=J.trip_update.trip||{},ae=J.trip_update.vehicle||{};return u("tr",{id:"entity-"+J.id,children:[u("td",{children:u("code",{children:J.id})}),u("td",{children:u("code",{children:re.route_id})}),u("td",{children:u("code",{children:re.direction_id})}),u("td",{children:u("code",{children:re.trip_id})}),u("td",{children:renderStartDate(re.start_date)}),u("td",{children:renderStartTime(re.start_time)}),u("td",{children:renderTripScheduleRelationship(re.schedule_relationship)}),u("td",{children:u("code",{children:ae.id})}),u("td",{children:u("code",{children:ae.label})}),u("td",{children:u("code",{children:ae.license_plate})}),u("td",{children:renderDelay(J.trip_update.delay)})]})},renderTripUpdates=(J,Y)=>{const{tripUpdates:re,unfilteredTripUpdates:ae}=J;return u("div",{children:[u("h2",{children:[u("code",{children:"TripUpdate"}),"s (",re.length," of ",ae.length,")"]}),renderMaxItemsMsg(re.length,MAX_LOG_ITEMS),u("table",{class:"trip-updates",children:[u("thead",{children:[u("tr",{children:[u("th",{rowspan:"2",children:u("code",{children:u("abbr",{title:"entity_id",children:"e_id"})})}),u("th",{colspan:"5",children:u("code",{children:"trip"})}),u("th",{rowspan:"2",children:u("code",{children:u("abbr",{title:"schedule_relationship",children:"s_rel"})})}),u("th",{colspan:"3",children:u("code",{children:"vehicle"})}),u("th",{rowspan:"2",children:u("code",{children:"delay"})})]}),u("tr",{children:[u("th",{children:u("code",{children:"route_id"})}),u("th",{children:u("code",{children:u("abbr",{title:"direction_id",children:"dir_id"})})}),u("th",{children:u("code",{children:"trip_id"})}),u("th",{children:u("code",{children:u("abbr",{title:"start_date",children:"st_date"})})}),u("th",{children:u("code",{children:u("abbr",{title:"start_time",children:"st_time"})})}),u("th",{children:u("code",{children:"id"})}),u("th",{children:u("code",{children:"label"})}),u("th",{children:u("abbr",{title:"license_plate",children:u("code",{children:"lic_pl"})})})]})]}),u("tbody",{children:re.map(renderTripUpdate)})]})]})},renderVehiclePosition=(J,Y)=>{const re=J.vehicle.trip||{},ae=J.vehicle.vehicle||{};return u("tr",{id:"entity-"+J.id,children:[u("td",{children:u("code",{children:J.id})}),u("td",{children:u("code",{children:re.route_id})}),u("td",{children:u("code",{children:re.direction_id})}),u("td",{children:u("code",{children:re.trip_id})}),u("td",{children:renderStartDate(re.start_date)}),u("td",{children:renderStartTime(re.start_time)}),u("td",{children:renderVehicleId(ae.id,J.vehicle,Y)}),u("td",{children:u("code",{children:ae.label})}),u("td",{children:u("code",{children:ae.license_plate})}),u("td",{children:u("code",{children:J.vehicle.current_stop_sequence})}),u("td",{children:u("code",{children:J.vehicle.stop_id})}),u("td",{children:renderVehicleStopStatus(J.vehicle.current_status)}),u("td",{children:renderPosition(J.vehicle.position)}),u("td",{children:renderCongestionLevel(J.vehicle.congestion_level)}),u("td",{children:renderOccupancyStatus(J.vehicle.occupancy_status)})]})},renderVehiclePositions=(J,Y)=>{const{vehiclePositions:re,unfilteredVehiclePositions:ae}=J;return u("div",{children:[u("h2",{children:[u("code",{children:"VehiclePosition"}),"s (",re.length," of ",ae.length,")"]}),renderMaxItemsMsg(re.length,MAX_LOG_ITEMS),u("table",{class:"vehicle-positions",children:[u("thead",{children:[u("tr",{children:[u("th",{rowspan:"2",children:u("code",{children:u("abbr",{title:"entity_id",children:"e_id"})})}),u("th",{colspan:"5",children:u("code",{children:"trip"})}),u("th",{colspan:"3",children:u("code",{children:"vehicle"})}),u("th",{rowspan:"2",children:u("code",{children:u("abbr",{title:"current_stop_sequence",children:"st_seq"})})}),u("th",{rowspan:"2",children:u("code",{children:"stop_id"})}),u("th",{rowspan:"2",children:u("code",{children:u("abbr",{title:"current_status",children:"status"})})}),u("th",{rowspan:"2",children:u("code",{children:"position"})}),u("th",{rowspan:"2",children:u("code",{children:u("abbr",{title:"congestion_level",children:"cong_lvl"})})}),u("th",{rowspan:"2",children:u("code",{children:u("abbr",{title:"occupancy_status",children:"occu"})})})]}),u("tr",{children:[u("th",{children:u("code",{children:"route_id"})}),u("th",{children:u("code",{children:u("abbr",{title:"direction_id",children:"dir_id"})})}),u("th",{children:u("code",{children:"trip_id"})}),u("th",{children:u("code",{children:u("abbr",{title:"start_date",children:"st_date"})})}),u("th",{children:u("code",{children:u("abbr",{title:"start_time",children:"st_time"})})}),u("th",{children:u("code",{children:"id"})}),u("th",{children:u("code",{children:"label"})}),u("th",{children:u("abbr",{title:"license_plate",children:u("code",{children:"lic_plate"})})})]})]}),u("tbody",{children:re.map(ne=>renderVehiclePosition(ne,Y))})]})]})},inspectorView=({state:J,emit:Y})=>{const re=J.feedData;if(!Array.isArray(re.entity)||re.entity.length===0)return u("p",{children:["The feed has no ",u("code",{children:"FeedEntity"}),"s."]});const{inspectorFilter:ae}=J;return u("div",{class:"inspector",children:[renderFilterInput(ae,ce=>{Y("inspector:set-filter",ce)}),renderTripUpdates(J),renderVehiclePositions(J,Y)]})},MAX_BYTES=1024*1024,feedAsJsonCache=new WeakMap,downloadBlob=(J,Y)=>{const re=window.document.createElement("a");re.href=URL.createObjectURL(J),re.download=Y,document.body.appendChild(re),re.click(),document.body.removeChild(re),setTimeout(()=>{URL.revokeObjectURL(re.href)},1e3)},rawView=({state:J})=>{const Y=J.feedData,re=J.feedRawData;let ae;feedAsJsonCache.has(Y)?ae=feedAsJsonCache.get(Y):(ae=JSON.stringify(Y,null,2),feedAsJsonCache.set(Y,ae));const ne=new URL(J.feedUrl).pathname.split("/"),ee=`${ne[ne.length-1]||"gtfs-rt"}-${new Date().toISOString()}.json`,R=()=>{const K=new Blob([ae],{type:"application/json"});downloadBlob(K,ee)},U=()=>{const K=new Blob([re],{type:"application/vnd.google.protobuf"});downloadBlob(K,ee)};return u("div",{class:"raw",children:[ae.length>MAX_BYTES?u("p",{children:["Truncated to ",MAX_BYTES," of ",ae.length," characters."]}):null,u("p",{children:[u("button",{onClick:R,children:"download JSON-encoded feed"}),u("button",{onClick:U,children:"download raw Protocol-Buffers-encoded feed"})]}),u("pre",{children:ae.substring(0,MAX_BYTES)})]})};var maplibreGl$1={exports:{}};/**
 * MapLibre GL JS
 * @license 3-Clause BSD. Full text of license: https://github.com/maplibre/maplibre-gl-js/blob/v5.9.0/LICENSE.txt
 */var maplibreGl=maplibreGl$1.exports,hasRequiredMaplibreGl;function requireMaplibreGl(){return hasRequiredMaplibreGl||(hasRequiredMaplibreGl=1,(function(J,Y){(function(re,ae){J.exports=ae()})(maplibreGl,(function(){var re={},ae={};function ne(ee,R,U){if(ae[ee]=U,ee==="index"){var K="var sharedModule = {}; ("+ae.shared+")(sharedModule); ("+ae.worker+")(sharedModule);",oe={};return ae.shared(oe),ae.index(re,oe),typeof window<"u"&&re.setWorkerUrl(window.URL.createObjectURL(new Blob([K],{type:"text/javascript"}))),re}}ne("shared",["exports"],(function(ee){function R(H,h,W,X){return new(W||(W=Promise))((function(te,le){function he(be){try{ye(X.next(be))}catch(Ee){le(Ee)}}function fe(be){try{ye(X.throw(be))}catch(Ee){le(Ee)}}function ye(be){var Ee;be.done?te(be.value):(Ee=be.value,Ee instanceof W?Ee:new W((function(Pe){Pe(Ee)}))).then(he,fe)}ye((X=X.apply(H,h||[])).next())}))}function U(H,h){this.x=H,this.y=h}function K(H){return H&&H.__esModule&&Object.prototype.hasOwnProperty.call(H,"default")?H.default:H}var oe,pe;typeof SuppressedError=="function"&&SuppressedError,U.prototype={clone(){return new U(this.x,this.y)},add(H){return this.clone()._add(H)},sub(H){return this.clone()._sub(H)},multByPoint(H){return this.clone()._multByPoint(H)},divByPoint(H){return this.clone()._divByPoint(H)},mult(H){return this.clone()._mult(H)},div(H){return this.clone()._div(H)},rotate(H){return this.clone()._rotate(H)},rotateAround(H,h){return this.clone()._rotateAround(H,h)},matMult(H){return this.clone()._matMult(H)},unit(){return this.clone()._unit()},perp(){return this.clone()._perp()},round(){return this.clone()._round()},mag(){return Math.sqrt(this.x*this.x+this.y*this.y)},equals(H){return this.x===H.x&&this.y===H.y},dist(H){return Math.sqrt(this.distSqr(H))},distSqr(H){const h=H.x-this.x,W=H.y-this.y;return h*h+W*W},angle(){return Math.atan2(this.y,this.x)},angleTo(H){return Math.atan2(this.y-H.y,this.x-H.x)},angleWith(H){return this.angleWithSep(H.x,H.y)},angleWithSep(H,h){return Math.atan2(this.x*h-this.y*H,this.x*H+this.y*h)},_matMult(H){const h=H[2]*this.x+H[3]*this.y;return this.x=H[0]*this.x+H[1]*this.y,this.y=h,this},_add(H){return this.x+=H.x,this.y+=H.y,this},_sub(H){return this.x-=H.x,this.y-=H.y,this},_mult(H){return this.x*=H,this.y*=H,this},_div(H){return this.x/=H,this.y/=H,this},_multByPoint(H){return this.x*=H.x,this.y*=H.y,this},_divByPoint(H){return this.x/=H.x,this.y/=H.y,this},_unit(){return this._div(this.mag()),this},_perp(){const H=this.y;return this.y=this.x,this.x=-H,this},_rotate(H){const h=Math.cos(H),W=Math.sin(H),X=W*this.x+h*this.y;return this.x=h*this.x-W*this.y,this.y=X,this},_rotateAround(H,h){const W=Math.cos(H),X=Math.sin(H),te=h.y+X*(this.x-h.x)+W*(this.y-h.y);return this.x=h.x+W*(this.x-h.x)-X*(this.y-h.y),this.y=te,this},_round(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this},constructor:U},U.convert=function(H){if(H instanceof U)return H;if(Array.isArray(H))return new U(+H[0],+H[1]);if(H.x!==void 0&&H.y!==void 0)return new U(+H.x,+H.y);throw new Error("Expected [x, y] or {x, y} point format")};var _e=(function(){if(pe)return oe;function H(h,W,X,te){this.cx=3*h,this.bx=3*(X-h)-this.cx,this.ax=1-this.cx-this.bx,this.cy=3*W,this.by=3*(te-W)-this.cy,this.ay=1-this.cy-this.by,this.p1x=h,this.p1y=W,this.p2x=X,this.p2y=te}return pe=1,oe=H,H.prototype={sampleCurveX:function(h){return((this.ax*h+this.bx)*h+this.cx)*h},sampleCurveY:function(h){return((this.ay*h+this.by)*h+this.cy)*h},sampleCurveDerivativeX:function(h){return(3*this.ax*h+2*this.bx)*h+this.cx},solveCurveX:function(h,W){if(W===void 0&&(W=1e-6),h<0)return 0;if(h>1)return 1;for(var X=h,te=0;te<8;te++){var le=this.sampleCurveX(X)-h;if(Math.abs(le)<W)return X;var he=this.sampleCurveDerivativeX(X);if(Math.abs(he)<1e-6)break;X-=le/he}var fe=0,ye=1;for(X=h,te=0;te<20&&(le=this.sampleCurveX(X),!(Math.abs(le-h)<W));te++)h>le?fe=X:ye=X,X=.5*(ye-fe)+fe;return X},solve:function(h,W){return this.sampleCurveY(this.solveCurveX(h,W))}},oe})(),me=K(_e);let we,Oe;function De(){return we==null&&(we=typeof OffscreenCanvas<"u"&&new OffscreenCanvas(1,1).getContext("2d")&&typeof createImageBitmap=="function"),we}function Ae(){if(Oe==null&&(Oe=!1,De())){const h=new OffscreenCanvas(5,5).getContext("2d",{willReadFrequently:!0});if(h){for(let X=0;X<25;X++){const te=4*X;h.fillStyle=`rgb(${te},${te+1},${te+2})`,h.fillRect(X%5,Math.floor(X/5),1,1)}const W=h.getImageData(0,0,5,5).data;for(let X=0;X<100;X++)if(X%4!=3&&W[X]!==X){Oe=!0;break}}}return Oe||!1}var Ce=1e-6,je=typeof Float32Array<"u"?Float32Array:Array;function ke(){var H=new je(9);return je!=Float32Array&&(H[1]=0,H[2]=0,H[3]=0,H[5]=0,H[6]=0,H[7]=0),H[0]=1,H[4]=1,H[8]=1,H}function Be(H){return H[0]=1,H[1]=0,H[2]=0,H[3]=0,H[4]=0,H[5]=1,H[6]=0,H[7]=0,H[8]=0,H[9]=0,H[10]=1,H[11]=0,H[12]=0,H[13]=0,H[14]=0,H[15]=1,H}function We(){var H=new je(3);return je!=Float32Array&&(H[0]=0,H[1]=0,H[2]=0),H}function Je(H){var h=H[0],W=H[1],X=H[2];return Math.sqrt(h*h+W*W+X*X)}function Ke(H,h,W){var X=new je(3);return X[0]=H,X[1]=h,X[2]=W,X}function et(H,h,W){return H[0]=h[0]+W[0],H[1]=h[1]+W[1],H[2]=h[2]+W[2],H}function it(H,h,W){return H[0]=h[0]*W,H[1]=h[1]*W,H[2]=h[2]*W,H}function nt(H,h,W){var X=h[0],te=h[1],le=h[2],he=W[0],fe=W[1],ye=W[2];return H[0]=te*ye-le*fe,H[1]=le*he-X*ye,H[2]=X*fe-te*he,H}var ct,ft=Je;function _t(H,h,W){var X=h[0],te=h[1],le=h[2],he=h[3];return H[0]=W[0]*X+W[4]*te+W[8]*le+W[12]*he,H[1]=W[1]*X+W[5]*te+W[9]*le+W[13]*he,H[2]=W[2]*X+W[6]*te+W[10]*le+W[14]*he,H[3]=W[3]*X+W[7]*te+W[11]*le+W[15]*he,H}function Rt(){var H=new je(4);return je!=Float32Array&&(H[0]=0,H[1]=0,H[2]=0),H[3]=1,H}function Ft(H,h,W,X){var te=arguments.length>4&&arguments[4]!==void 0?arguments[4]:"zyx",le=Math.PI/360;h*=le,X*=le,W*=le;var he=Math.sin(h),fe=Math.cos(h),ye=Math.sin(W),be=Math.cos(W),Ee=Math.sin(X),Pe=Math.cos(X);switch(te){case"xyz":H[0]=he*be*Pe+fe*ye*Ee,H[1]=fe*ye*Pe-he*be*Ee,H[2]=fe*be*Ee+he*ye*Pe,H[3]=fe*be*Pe-he*ye*Ee;break;case"xzy":H[0]=he*be*Pe-fe*ye*Ee,H[1]=fe*ye*Pe-he*be*Ee,H[2]=fe*be*Ee+he*ye*Pe,H[3]=fe*be*Pe+he*ye*Ee;break;case"yxz":H[0]=he*be*Pe+fe*ye*Ee,H[1]=fe*ye*Pe-he*be*Ee,H[2]=fe*be*Ee-he*ye*Pe,H[3]=fe*be*Pe+he*ye*Ee;break;case"yzx":H[0]=he*be*Pe+fe*ye*Ee,H[1]=fe*ye*Pe+he*be*Ee,H[2]=fe*be*Ee-he*ye*Pe,H[3]=fe*be*Pe-he*ye*Ee;break;case"zxy":H[0]=he*be*Pe-fe*ye*Ee,H[1]=fe*ye*Pe+he*be*Ee,H[2]=fe*be*Ee+he*ye*Pe,H[3]=fe*be*Pe-he*ye*Ee;break;case"zyx":H[0]=he*be*Pe-fe*ye*Ee,H[1]=fe*ye*Pe+he*be*Ee,H[2]=fe*be*Ee-he*ye*Pe,H[3]=fe*be*Pe+he*ye*Ee;break;default:throw new Error("Unknown angle order "+te)}return H}function ht(){var H=new je(2);return je!=Float32Array&&(H[0]=0,H[1]=0),H}function St(H,h){var W=new je(2);return W[0]=H,W[1]=h,W}We(),ct=new je(4),je!=Float32Array&&(ct[0]=0,ct[1]=0,ct[2]=0,ct[3]=0),We(),Ke(1,0,0),Ke(0,1,0),Rt(),Rt(),ke(),ht();const ut=8192;function Et(H,h,W){return h*(ut/(H.tileSize*Math.pow(2,W-H.tileID.overscaledZ)))}function bt(H,h){return(H%h+h)%h}function Dt(H,h,W){return H*(1-W)+h*W}function Ut(H){if(H<=0)return 0;if(H>=1)return 1;const h=H*H,W=h*H;return 4*(H<.5?W:3*(H-h)+W-.75)}function er(H,h,W,X){const te=new me(H,h,W,X);return le=>te.solve(le)}const xr=er(.25,.1,.25,1);function ur(H,h,W){return Math.min(W,Math.max(h,H))}function yr(H,h,W){const X=W-h,te=((H-h)%X+X)%X+h;return te===h?W:te}function Wt(H,...h){for(const W of h)for(const X in W)H[X]=W[X];return H}let or=1;function wr(H,h,W){const X={};for(const te in H)X[te]=h.call(this,H[te],te,H);return X}function Ir(H,h,W){const X={};for(const te in H)h.call(this,H[te],te,H)&&(X[te]=H[te]);return X}function br(H){return Array.isArray(H)?H.map(br):typeof H=="object"&&H?wr(H,br):H}const gr={};function Mr(H){gr[H]||(typeof console<"u"&&console.warn(H),gr[H]=!0)}function Hr(H,h,W){return(W.y-H.y)*(h.x-H.x)>(h.y-H.y)*(W.x-H.x)}function jr(H){return typeof WorkerGlobalScope<"u"&&H!==void 0&&H instanceof WorkerGlobalScope}let Sr=null;function Nr(H){if(Sr==null){const h=H.navigator?H.navigator.userAgent:null;Sr=!!H.safari||!(!h||!(/\b(iPad|iPhone|iPod)\b/.test(h)||h.match("Safari")&&!h.match("Chrome")))}return Sr}function Dr(H){return typeof ImageBitmap<"u"&&H instanceof ImageBitmap}const Lr="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAAC0lEQVQYV2NgAAIAAAUAAarVyFEAAAAASUVORK5CYII=";function Yt(H,h,W,X,te){return R(this,void 0,void 0,(function*(){if(typeof VideoFrame>"u")throw new Error("VideoFrame not supported");const le=new VideoFrame(H,{timestamp:0});try{const he=le==null?void 0:le.format;if(!he||!he.startsWith("BGR")&&!he.startsWith("RGB"))throw new Error(`Unrecognized format ${he}`);const fe=he.startsWith("BGR"),ye=new Uint8ClampedArray(X*te*4);if(yield le.copyTo(ye,(function(be,Ee,Pe,Ne,Ue){const $e=4*Math.max(-Ee,0),Ye=(Math.max(0,Pe)-Pe)*Ne*4+$e,rt=4*Ne,dt=Math.max(0,Ee),Ct=Math.max(0,Pe);return{rect:{x:dt,y:Ct,width:Math.min(be.width,Ee+Ne)-dt,height:Math.min(be.height,Pe+Ue)-Ct},layout:[{offset:Ye,stride:rt}]}})(H,h,W,X,te)),fe)for(let be=0;be<ye.length;be+=4){const Ee=ye[be];ye[be]=ye[be+2],ye[be+2]=Ee}return ye}finally{le.close()}}))}let Jt,qr;function nr(H,h,W,X){return H.addEventListener(h,W,X),{unsubscribe:()=>{H.removeEventListener(h,W,X)}}}function dr(H){return H*Math.PI/180}function mr(H){return H/Math.PI*180}const Ge={touchstart:!0,touchmove:!0,touchmoveWindow:!0,touchend:!0,touchcancel:!0},Ie={dblclick:!0,click:!0,mouseover:!0,mouseout:!0,mousedown:!0,mousemove:!0,mousemoveWindow:!0,mouseup:!0,mouseupWindow:!0,contextmenu:!0,wheel:!0},Se="AbortError";function xe(){return new Error(Se)}const Te={MAX_PARALLEL_IMAGE_REQUESTS:16,MAX_PARALLEL_IMAGE_REQUESTS_PER_FRAME:8,MAX_TILE_CACHE_ZOOM_LEVELS:5,REGISTERED_PROTOCOLS:{},WORKER_URL:""};function Me(H){return Te.REGISTERED_PROTOCOLS[H.substring(0,H.indexOf("://"))]}const ze="global-dispatcher";class Qe extends Error{constructor(h,W,X,te){super(`AJAXError: ${W} (${h}): ${X}`),this.status=h,this.statusText=W,this.url=X,this.body=te}}const tt=()=>jr(self)?self.worker&&self.worker.referrer:(window.location.protocol==="blob:"?window.parent:window).location.href,He=function(H,h){if(/:\/\//.test(H.url)&&!/^https?:|^file:/.test(H.url)){const X=Me(H.url);if(X)return X(H,h);if(jr(self)&&self.worker&&self.worker.actor)return self.worker.actor.sendAsync({type:"GR",data:H,targetMapId:ze},h)}if(!(/^file:/.test(W=H.url)||/^file:/.test(tt())&&!/^\w+:/.test(W))){if(fetch&&Request&&AbortController&&Object.prototype.hasOwnProperty.call(Request.prototype,"signal"))return(function(X,te){return R(this,void 0,void 0,(function*(){const le=new Request(X.url,{method:X.method||"GET",body:X.body,credentials:X.credentials,headers:X.headers,cache:X.cache,referrer:tt(),signal:te.signal});let he,fe;X.type!=="json"||le.headers.has("Accept")||le.headers.set("Accept","application/json");try{he=yield fetch(le)}catch(be){throw new Qe(0,be.message,X.url,new Blob)}if(!he.ok){const be=yield he.blob();throw new Qe(he.status,he.statusText,X.url,be)}fe=X.type==="arrayBuffer"||X.type==="image"?he.arrayBuffer():X.type==="json"?he.json():he.text();const ye=yield fe;if(te.signal.aborted)throw xe();return{data:ye,cacheControl:he.headers.get("Cache-Control"),expires:he.headers.get("Expires")}}))})(H,h);if(jr(self)&&self.worker&&self.worker.actor)return self.worker.actor.sendAsync({type:"GR",data:H,mustQueue:!0,targetMapId:ze},h)}var W;return(function(X,te){return new Promise(((le,he)=>{var fe;const ye=new XMLHttpRequest;ye.open(X.method||"GET",X.url,!0),X.type!=="arrayBuffer"&&X.type!=="image"||(ye.responseType="arraybuffer");for(const be in X.headers)ye.setRequestHeader(be,X.headers[be]);X.type==="json"&&(ye.responseType="text",!((fe=X.headers)===null||fe===void 0)&&fe.Accept||ye.setRequestHeader("Accept","application/json")),ye.withCredentials=X.credentials==="include",ye.onerror=()=>{he(new Error(ye.statusText))},ye.onload=()=>{if(!te.signal.aborted)if((ye.status>=200&&ye.status<300||ye.status===0)&&ye.response!==null){let be=ye.response;if(X.type==="json")try{be=JSON.parse(ye.response)}catch(Ee){return void he(Ee)}le({data:be,cacheControl:ye.getResponseHeader("Cache-Control"),expires:ye.getResponseHeader("Expires")})}else{const be=new Blob([ye.response],{type:ye.getResponseHeader("Content-Type")});he(new Qe(ye.status,ye.statusText,X.url,be))}},te.signal.addEventListener("abort",(()=>{ye.abort(),he(xe())})),ye.send(X.body)}))})(H,h)};function Ze(H){if(!H||H.indexOf("://")<=0||H.indexOf("data:image/")===0||H.indexOf("blob:")===0)return!0;const h=new URL(H),W=window.location;return h.protocol===W.protocol&&h.host===W.host}function st(H,h,W){W[H]&&W[H].indexOf(h)!==-1||(W[H]=W[H]||[],W[H].push(h))}function At(H,h,W){if(W&&W[H]){const X=W[H].indexOf(h);X!==-1&&W[H].splice(X,1)}}class wt{constructor(h,W={}){Wt(this,W),this.type=h}}class Mt extends wt{constructor(h,W={}){super("error",Wt({error:h},W))}}class Zt{on(h,W){return this._listeners=this._listeners||{},st(h,W,this._listeners),{unsubscribe:()=>{this.off(h,W)}}}off(h,W){return At(h,W,this._listeners),At(h,W,this._oneTimeListeners),this}once(h,W){return W?(this._oneTimeListeners=this._oneTimeListeners||{},st(h,W,this._oneTimeListeners),this):new Promise((X=>this.once(h,X)))}fire(h,W){typeof h=="string"&&(h=new wt(h,W||{}));const X=h.type;if(this.listens(X)){h.target=this;const te=this._listeners&&this._listeners[X]?this._listeners[X].slice():[];for(const fe of te)fe.call(this,h);const le=this._oneTimeListeners&&this._oneTimeListeners[X]?this._oneTimeListeners[X].slice():[];for(const fe of le)At(X,fe,this._oneTimeListeners),fe.call(this,h);const he=this._eventedParent;he&&(Wt(h,typeof this._eventedParentData=="function"?this._eventedParentData():this._eventedParentData),he.fire(h))}else h instanceof Mt&&console.error(h.error);return this}listens(h){return this._listeners&&this._listeners[h]&&this._listeners[h].length>0||this._oneTimeListeners&&this._oneTimeListeners[h]&&this._oneTimeListeners[h].length>0||this._eventedParent&&this._eventedParent.listens(h)}setEventedParent(h,W){return this._eventedParent=h,this._eventedParentData=W,this}}var Tt={$version:8,$root:{version:{required:!0,type:"enum",values:[8]},name:{type:"string"},metadata:{type:"*"},center:{type:"array",value:"number"},centerAltitude:{type:"number"},zoom:{type:"number"},bearing:{type:"number",default:0,period:360,units:"degrees"},pitch:{type:"number",default:0,units:"degrees"},roll:{type:"number",default:0,units:"degrees"},state:{type:"state",default:{}},light:{type:"light"},sky:{type:"sky"},projection:{type:"projection"},terrain:{type:"terrain"},sources:{required:!0,type:"sources"},sprite:{type:"sprite"},glyphs:{type:"string"},"font-faces":{type:"array",value:"fontFaces"},transition:{type:"transition"},layers:{required:!0,type:"array",value:"layer"}},sources:{"*":{type:"source"}},source:["source_vector","source_raster","source_raster_dem","source_geojson","source_video","source_image"],source_vector:{type:{required:!0,type:"enum",values:{vector:{}}},url:{type:"string"},tiles:{type:"array",value:"string"},bounds:{type:"array",value:"number",length:4,default:[-180,-85.051129,180,85.051129]},scheme:{type:"enum",values:{xyz:{},tms:{}},default:"xyz"},minzoom:{type:"number",default:0},maxzoom:{type:"number",default:22},attribution:{type:"string"},promoteId:{type:"promoteId"},volatile:{type:"boolean",default:!1},"*":{type:"*"}},source_raster:{type:{required:!0,type:"enum",values:{raster:{}}},url:{type:"string"},tiles:{type:"array",value:"string"},bounds:{type:"array",value:"number",length:4,default:[-180,-85.051129,180,85.051129]},minzoom:{type:"number",default:0},maxzoom:{type:"number",default:22},tileSize:{type:"number",default:512,units:"pixels"},scheme:{type:"enum",values:{xyz:{},tms:{}},default:"xyz"},attribution:{type:"string"},volatile:{type:"boolean",default:!1},"*":{type:"*"}},source_raster_dem:{type:{required:!0,type:"enum",values:{"raster-dem":{}}},url:{type:"string"},tiles:{type:"array",value:"string"},bounds:{type:"array",value:"number",length:4,default:[-180,-85.051129,180,85.051129]},minzoom:{type:"number",default:0},maxzoom:{type:"number",default:22},tileSize:{type:"number",default:512,units:"pixels"},attribution:{type:"string"},encoding:{type:"enum",values:{terrarium:{},mapbox:{},custom:{}},default:"mapbox"},redFactor:{type:"number",default:1},blueFactor:{type:"number",default:1},greenFactor:{type:"number",default:1},baseShift:{type:"number",default:0},volatile:{type:"boolean",default:!1},"*":{type:"*"}},source_geojson:{type:{required:!0,type:"enum",values:{geojson:{}}},data:{required:!0,type:"*"},maxzoom:{type:"number",default:18},attribution:{type:"string"},buffer:{type:"number",default:128,maximum:512,minimum:0},filter:{type:"*"},tolerance:{type:"number",default:.375},cluster:{type:"boolean",default:!1},clusterRadius:{type:"number",default:50,minimum:0},clusterMaxZoom:{type:"number"},clusterMinPoints:{type:"number"},clusterProperties:{type:"*"},lineMetrics:{type:"boolean",default:!1},generateId:{type:"boolean",default:!1},promoteId:{type:"promoteId"}},source_video:{type:{required:!0,type:"enum",values:{video:{}}},urls:{required:!0,type:"array",value:"string"},coordinates:{required:!0,type:"array",length:4,value:{type:"array",length:2,value:"number"}}},source_image:{type:{required:!0,type:"enum",values:{image:{}}},url:{required:!0,type:"string"},coordinates:{required:!0,type:"array",length:4,value:{type:"array",length:2,value:"number"}}},layer:{id:{type:"string",required:!0},type:{type:"enum",values:{fill:{},line:{},symbol:{},circle:{},heatmap:{},"fill-extrusion":{},raster:{},hillshade:{},"color-relief":{},background:{}},required:!0},metadata:{type:"*"},source:{type:"string"},"source-layer":{type:"string"},minzoom:{type:"number",minimum:0,maximum:24},maxzoom:{type:"number",minimum:0,maximum:24},filter:{type:"filter"},layout:{type:"layout"},paint:{type:"paint"}},layout:["layout_fill","layout_line","layout_circle","layout_heatmap","layout_fill-extrusion","layout_symbol","layout_raster","layout_hillshade","layout_color-relief","layout_background"],layout_background:{visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_fill:{"fill-sort-key":{type:"number",expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_circle:{"circle-sort-key":{type:"number",expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_heatmap:{visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},"layout_fill-extrusion":{visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_line:{"line-cap":{type:"enum",values:{butt:{},round:{},square:{}},default:"butt",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"line-join":{type:"enum",values:{bevel:{},round:{},miter:{}},default:"miter",expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"line-miter-limit":{type:"number",default:2,requires:[{"line-join":"miter"}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"line-round-limit":{type:"number",default:1.05,requires:[{"line-join":"round"}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"line-sort-key":{type:"number",expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_symbol:{"symbol-placement":{type:"enum",values:{point:{},line:{},"line-center":{}},default:"point",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"symbol-spacing":{type:"number",default:250,minimum:1,units:"pixels",requires:[{"symbol-placement":"line"}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"symbol-avoid-edges":{type:"boolean",default:!1,expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"symbol-sort-key":{type:"number",expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"symbol-z-order":{type:"enum",values:{auto:{},"viewport-y":{},source:{}},default:"auto",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-allow-overlap":{type:"boolean",default:!1,requires:["icon-image",{"!":"icon-overlap"}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-overlap":{type:"enum",values:{never:{},always:{},cooperative:{}},requires:["icon-image"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-ignore-placement":{type:"boolean",default:!1,requires:["icon-image"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-optional":{type:"boolean",default:!1,requires:["icon-image","text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-rotation-alignment":{type:"enum",values:{map:{},viewport:{},auto:{}},default:"auto",requires:["icon-image"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-size":{type:"number",default:1,minimum:0,units:"factor of the original icon size",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-text-fit":{type:"enum",values:{none:{},width:{},height:{},both:{}},default:"none",requires:["icon-image","text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-text-fit-padding":{type:"array",value:"number",length:4,default:[0,0,0,0],units:"pixels",requires:["icon-image","text-field",{"icon-text-fit":["both","width","height"]}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"icon-image":{type:"resolvedImage",tokens:!0,expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-rotate":{type:"number",default:0,period:360,units:"degrees",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-padding":{type:"padding",default:[2],units:"pixels",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-keep-upright":{type:"boolean",default:!1,requires:["icon-image",{"icon-rotation-alignment":"map"},{"symbol-placement":["line","line-center"]}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-offset":{type:"array",value:"number",length:2,default:[0,0],requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-anchor":{type:"enum",values:{center:{},left:{},right:{},top:{},bottom:{},"top-left":{},"top-right":{},"bottom-left":{},"bottom-right":{}},default:"center",requires:["icon-image"],expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-pitch-alignment":{type:"enum",values:{map:{},viewport:{},auto:{}},default:"auto",requires:["icon-image"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-pitch-alignment":{type:"enum",values:{map:{},viewport:{},auto:{}},default:"auto",requires:["text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-rotation-alignment":{type:"enum",values:{map:{},viewport:{},"viewport-glyph":{},auto:{}},default:"auto",requires:["text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-field":{type:"formatted",default:"",tokens:!0,expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-font":{type:"array",value:"string",default:["Open Sans Regular","Arial Unicode MS Regular"],requires:["text-field"],expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-size":{type:"number",default:16,minimum:0,units:"pixels",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-max-width":{type:"number",default:10,minimum:0,units:"ems",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-line-height":{type:"number",default:1.2,units:"ems",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"text-letter-spacing":{type:"number",default:0,units:"ems",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-justify":{type:"enum",values:{auto:{},left:{},center:{},right:{}},default:"center",requires:["text-field"],expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-radial-offset":{type:"number",units:"ems",default:0,requires:["text-field"],"property-type":"data-driven",expression:{interpolated:!0,parameters:["zoom","feature"]}},"text-variable-anchor":{type:"array",value:"enum",values:{center:{},left:{},right:{},top:{},bottom:{},"top-left":{},"top-right":{},"bottom-left":{},"bottom-right":{}},requires:["text-field",{"symbol-placement":["point"]}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-variable-anchor-offset":{type:"variableAnchorOffsetCollection",requires:["text-field",{"symbol-placement":["point"]}],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-anchor":{type:"enum",values:{center:{},left:{},right:{},top:{},bottom:{},"top-left":{},"top-right":{},"bottom-left":{},"bottom-right":{}},default:"center",requires:["text-field",{"!":"text-variable-anchor"}],expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-max-angle":{type:"number",default:45,units:"degrees",requires:["text-field",{"symbol-placement":["line","line-center"]}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"text-writing-mode":{type:"array",value:"enum",values:{horizontal:{},vertical:{}},requires:["text-field",{"symbol-placement":["point"]}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-rotate":{type:"number",default:0,period:360,units:"degrees",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-padding":{type:"number",default:2,minimum:0,units:"pixels",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"text-keep-upright":{type:"boolean",default:!0,requires:["text-field",{"text-rotation-alignment":"map"},{"symbol-placement":["line","line-center"]}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-transform":{type:"enum",values:{none:{},uppercase:{},lowercase:{}},default:"none",requires:["text-field"],expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-offset":{type:"array",value:"number",units:"ems",length:2,default:[0,0],requires:["text-field",{"!":"text-radial-offset"}],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-allow-overlap":{type:"boolean",default:!1,requires:["text-field",{"!":"text-overlap"}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-overlap":{type:"enum",values:{never:{},always:{},cooperative:{}},requires:["text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-ignore-placement":{type:"boolean",default:!1,requires:["text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-optional":{type:"boolean",default:!1,requires:["text-field","icon-image"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_raster:{visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_hillshade:{visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},"layout_color-relief":{visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},filter:{type:"array",value:"*"},filter_operator:{type:"enum",values:{"==":{},"!=":{},">":{},">=":{},"<":{},"<=":{},in:{},"!in":{},all:{},any:{},none:{},has:{},"!has":{}}},geometry_type:{type:"enum",values:{Point:{},LineString:{},Polygon:{}}},function:{expression:{type:"expression"},stops:{type:"array",value:"function_stop"},base:{type:"number",default:1,minimum:0},property:{type:"string",default:"$zoom"},type:{type:"enum",values:{identity:{},exponential:{},interval:{},categorical:{}},default:"exponential"},colorSpace:{type:"enum",values:{rgb:{},lab:{},hcl:{}},default:"rgb"},default:{type:"*",required:!1}},function_stop:{type:"array",minimum:0,maximum:24,value:["number","color"],length:2},expression:{type:"array",value:"*",minimum:1},light:{anchor:{type:"enum",default:"viewport",values:{map:{},viewport:{}},"property-type":"data-constant",transition:!1,expression:{interpolated:!1,parameters:["zoom"]}},position:{type:"array",default:[1.15,210,30],length:3,value:"number","property-type":"data-constant",transition:!0,expression:{interpolated:!0,parameters:["zoom"]}},color:{type:"color","property-type":"data-constant",default:"#ffffff",expression:{interpolated:!0,parameters:["zoom"]},transition:!0},intensity:{type:"number","property-type":"data-constant",default:.5,minimum:0,maximum:1,expression:{interpolated:!0,parameters:["zoom"]},transition:!0}},sky:{"sky-color":{type:"color","property-type":"data-constant",default:"#88C6FC",expression:{interpolated:!0,parameters:["zoom"]},transition:!0},"horizon-color":{type:"color","property-type":"data-constant",default:"#ffffff",expression:{interpolated:!0,parameters:["zoom"]},transition:!0},"fog-color":{type:"color","property-type":"data-constant",default:"#ffffff",expression:{interpolated:!0,parameters:["zoom"]},transition:!0},"fog-ground-blend":{type:"number","property-type":"data-constant",default:.5,minimum:0,maximum:1,expression:{interpolated:!0,parameters:["zoom"]},transition:!0},"horizon-fog-blend":{type:"number","property-type":"data-constant",default:.8,minimum:0,maximum:1,expression:{interpolated:!0,parameters:["zoom"]},transition:!0},"sky-horizon-blend":{type:"number","property-type":"data-constant",default:.8,minimum:0,maximum:1,expression:{interpolated:!0,parameters:["zoom"]},transition:!0},"atmosphere-blend":{type:"number","property-type":"data-constant",default:.8,minimum:0,maximum:1,expression:{interpolated:!0,parameters:["zoom"]},transition:!0}},terrain:{source:{type:"string",required:!0},exaggeration:{type:"number",minimum:0,default:1}},projection:{type:{type:"projectionDefinition",default:"mercator","property-type":"data-constant",transition:!1,expression:{interpolated:!0,parameters:["zoom"]}}},paint:["paint_fill","paint_line","paint_circle","paint_heatmap","paint_fill-extrusion","paint_symbol","paint_raster","paint_hillshade","paint_color-relief","paint_background"],paint_fill:{"fill-antialias":{type:"boolean",default:!0,expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"fill-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-color":{type:"color",default:"#000000",transition:!0,requires:[{"!":"fill-pattern"}],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-outline-color":{type:"color",transition:!0,requires:[{"!":"fill-pattern"},{"fill-antialias":!0}],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"fill-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["fill-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"fill-pattern":{type:"resolvedImage",transition:!0,expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"cross-faded-data-driven"}},"paint_fill-extrusion":{"fill-extrusion-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"fill-extrusion-color":{type:"color",default:"#000000",transition:!0,requires:[{"!":"fill-extrusion-pattern"}],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-extrusion-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"fill-extrusion-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["fill-extrusion-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"fill-extrusion-pattern":{type:"resolvedImage",transition:!0,expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"cross-faded-data-driven"},"fill-extrusion-height":{type:"number",default:0,minimum:0,units:"meters",transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-extrusion-base":{type:"number",default:0,minimum:0,units:"meters",transition:!0,requires:["fill-extrusion-height"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-extrusion-vertical-gradient":{type:"boolean",default:!0,transition:!1,expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"}},paint_line:{"line-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-color":{type:"color",default:"#000000",transition:!0,requires:[{"!":"line-pattern"}],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"line-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["line-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"line-width":{type:"number",default:1,minimum:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-gap-width":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-offset":{type:"number",default:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-blur":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-dasharray":{type:"array",value:"number",minimum:0,transition:!0,units:"line widths",requires:[{"!":"line-pattern"}],expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"cross-faded-data-driven"},"line-pattern":{type:"resolvedImage",transition:!0,expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"cross-faded-data-driven"},"line-gradient":{type:"color",transition:!1,requires:[{"!":"line-dasharray"},{"!":"line-pattern"},{source:"geojson",has:{lineMetrics:!0}}],expression:{interpolated:!0,parameters:["line-progress"]},"property-type":"color-ramp"}},paint_circle:{"circle-radius":{type:"number",default:5,minimum:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-color":{type:"color",default:"#000000",transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-blur":{type:"number",default:0,transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"circle-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["circle-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"circle-pitch-scale":{type:"enum",values:{map:{},viewport:{}},default:"map",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"circle-pitch-alignment":{type:"enum",values:{map:{},viewport:{}},default:"viewport",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"circle-stroke-width":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-stroke-color":{type:"color",default:"#000000",transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-stroke-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"}},paint_heatmap:{"heatmap-radius":{type:"number",default:30,minimum:1,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"heatmap-weight":{type:"number",default:1,minimum:0,transition:!1,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"heatmap-intensity":{type:"number",default:1,minimum:0,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"heatmap-color":{type:"color",default:["interpolate",["linear"],["heatmap-density"],0,"rgba(0, 0, 255, 0)",.1,"royalblue",.3,"cyan",.5,"lime",.7,"yellow",1,"red"],transition:!1,expression:{interpolated:!0,parameters:["heatmap-density"]},"property-type":"color-ramp"},"heatmap-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"}},paint_symbol:{"icon-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-color":{type:"color",default:"#000000",transition:!0,requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-halo-color":{type:"color",default:"rgba(0, 0, 0, 0)",transition:!0,requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-halo-width":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-halo-blur":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"icon-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["icon-image","icon-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-color":{type:"color",default:"#000000",transition:!0,overridable:!0,requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-halo-color":{type:"color",default:"rgba(0, 0, 0, 0)",transition:!0,requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-halo-width":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-halo-blur":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"text-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["text-field","text-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"}},paint_raster:{"raster-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-hue-rotate":{type:"number",default:0,period:360,transition:!0,units:"degrees",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-brightness-min":{type:"number",default:0,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-brightness-max":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-saturation":{type:"number",default:0,minimum:-1,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-contrast":{type:"number",default:0,minimum:-1,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-resampling":{type:"enum",values:{linear:{},nearest:{}},default:"linear",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"raster-fade-duration":{type:"number",default:300,minimum:0,transition:!1,units:"milliseconds",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"}},paint_hillshade:{"hillshade-illumination-direction":{type:"numberArray",default:335,minimum:0,maximum:359,transition:!1,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-illumination-altitude":{type:"numberArray",default:45,minimum:0,maximum:90,transition:!1,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-illumination-anchor":{type:"enum",values:{map:{},viewport:{}},default:"viewport",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-exaggeration":{type:"number",default:.5,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-shadow-color":{type:"colorArray",default:"#000000",transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-highlight-color":{type:"colorArray",default:"#FFFFFF",transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-accent-color":{type:"color",default:"#000000",transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-method":{type:"enum",values:{standard:{},basic:{},combined:{},igor:{},multidirectional:{}},default:"standard",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"}},"paint_color-relief":{"color-relief-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"color-relief-color":{type:"color",transition:!1,expression:{interpolated:!0,parameters:["elevation"]},"property-type":"color-ramp"}},paint_background:{"background-color":{type:"color",default:"#000000",transition:!0,requires:[{"!":"background-pattern"}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"background-pattern":{type:"resolvedImage",transition:!0,expression:{interpolated:!1,parameters:["zoom"]},"property-type":"cross-faded"},"background-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"}},transition:{duration:{type:"number",default:300,minimum:0,units:"milliseconds"},delay:{type:"number",default:0,minimum:0,units:"milliseconds"}},"property-type":{"data-driven":{type:"property-type"},"cross-faded":{type:"property-type"},"cross-faded-data-driven":{type:"property-type"},"color-ramp":{type:"property-type"},"data-constant":{type:"property-type"},constant:{type:"property-type"}},promoteId:{"*":{type:"string"}}};const Er=["type","source","source-layer","minzoom","maxzoom","filter","layout"];function Or(H,h){const W={};for(const X in H)X!=="ref"&&(W[X]=H[X]);return Er.forEach((X=>{X in h&&(W[X]=h[X])})),W}function cr(H,h){if(Array.isArray(H)){if(!Array.isArray(h)||H.length!==h.length)return!1;for(let W=0;W<H.length;W++)if(!cr(H[W],h[W]))return!1;return!0}if(typeof H=="object"&&H!==null&&h!==null){if(typeof h!="object"||Object.keys(H).length!==Object.keys(h).length)return!1;for(const W in H)if(!cr(H[W],h[W]))return!1;return!0}return H===h}function Fr(H,h){H.push(h)}function Yr(H,h,W){Fr(W,{command:"addSource",args:[H,h[H]]})}function vi(H,h,W){Fr(h,{command:"removeSource",args:[H]}),W[H]=!0}function bi(H,h,W,X){vi(H,W,X),Yr(H,h,W)}function qi(H,h,W){let X;for(X in H[W])if(Object.prototype.hasOwnProperty.call(H[W],X)&&X!=="data"&&!cr(H[W][X],h[W][X]))return!1;for(X in h[W])if(Object.prototype.hasOwnProperty.call(h[W],X)&&X!=="data"&&!cr(H[W][X],h[W][X]))return!1;return!0}function Jr(H,h,W,X,te,le){H=H||{},h=h||{};for(const he in H)Object.prototype.hasOwnProperty.call(H,he)&&(cr(H[he],h[he])||W.push({command:le,args:[X,he,h[he],te]}));for(const he in h)Object.prototype.hasOwnProperty.call(h,he)&&!Object.prototype.hasOwnProperty.call(H,he)&&(cr(H[he],h[he])||W.push({command:le,args:[X,he,h[he],te]}))}function li(H){return H.id}function ri(H,h){return H[h.id]=h,H}class Ht{constructor(h,W,X,te){this.message=(h?`${h}: `:"")+X,te&&(this.identifier=te),W!=null&&W.__line__&&(this.line=W.__line__)}}function Ti(H,...h){for(const W of h)for(const X in W)H[X]=W[X];return H}class Ni extends Error{constructor(h,W){super(W),this.message=W,this.key=h}}class Pi{constructor(h,W=[]){this.parent=h,this.bindings={};for(const[X,te]of W)this.bindings[X]=te}concat(h){return new Pi(this,h)}get(h){if(this.bindings[h])return this.bindings[h];if(this.parent)return this.parent.get(h);throw new Error(`${h} not found in scope.`)}has(h){return!!this.bindings[h]||!!this.parent&&this.parent.has(h)}}const ii={kind:"null"},ir={kind:"number"},Zr={kind:"string"},Gr={kind:"boolean"},jt={kind:"color"},tr={kind:"projectionDefinition"},Vt={kind:"object"},Pt={kind:"value"},Qt={kind:"collator"},Ur={kind:"formatted"},Rr={kind:"padding"},yi={kind:"colorArray"},fi={kind:"numberArray"},Si={kind:"resolvedImage"},ui={kind:"variableAnchorOffsetCollection"};function rr(H,h){return{kind:"array",itemType:H,N:h}}function Kr(H){if(H.kind==="array"){const h=Kr(H.itemType);return typeof H.N=="number"?`array<${h}, ${H.N}>`:H.itemType.kind==="value"?"array":`array<${h}>`}return H.kind}const cn=[ii,ir,Zr,Gr,jt,tr,Ur,Vt,rr(Pt),Rr,fi,yi,Si,ui];function Gn(H,h){if(h.kind==="error")return null;if(H.kind==="array"){if(h.kind==="array"&&(h.N===0&&h.itemType.kind==="value"||!Gn(H.itemType,h.itemType))&&(typeof H.N!="number"||H.N===h.N))return null}else{if(H.kind===h.kind)return null;if(H.kind==="value"){for(const W of cn)if(!Gn(W,h))return null}}return`Expected ${Kr(H)} but found ${Kr(h)} instead.`}function Ba(H,h){return h.some((W=>W.kind===H.kind))}function $n(H,h){return h.some((W=>W==="null"?H===null:W==="array"?Array.isArray(H):W==="object"?H&&!Array.isArray(H)&&typeof H=="object":W===typeof H))}function xn(H,h){return H.kind==="array"&&h.kind==="array"?H.itemType.kind===h.itemType.kind&&typeof H.N=="number":H.kind===h.kind}const pu=.96422,al=.82521,_u=4/29,Na=6/29,mu=3*Na*Na,Ic=Na*Na*Na,Rc=Math.PI/180,Ac=180/Math.PI;function yu(H){return(H%=360)<0&&(H+=360),H}function ol([H,h,W,X]){let te,le;const he=sl((.2225045*(H=ya(H))+.7168786*(h=ya(h))+.0606169*(W=ya(W)))/1);H===h&&h===W?te=le=he:(te=sl((.4360747*H+.3850649*h+.1430804*W)/pu),le=sl((.0139322*H+.0971045*h+.7141733*W)/al));const fe=116*he-16;return[fe<0?0:fe,500*(te-he),200*(he-le),X]}function ya(H){return H<=.04045?H/12.92:Math.pow((H+.055)/1.055,2.4)}function sl(H){return H>Ic?Math.pow(H,1/3):H/mu+_u}function gu([H,h,W,X]){let te=(H+16)/116,le=isNaN(h)?te:te+h/500,he=isNaN(W)?te:te-W/200;return te=1*ll(te),le=pu*ll(le),he=al*ll(he),[ga(3.1338561*le-1.6168667*te-.4906146*he),ga(-.9787684*le+1.9161415*te+.033454*he),ga(.0719453*le-.2289914*te+1.4052427*he),X]}function ga(H){return(H=H<=.00304?12.92*H:1.055*Math.pow(H,1/2.4)-.055)<0?0:H>1?1:H}function ll(H){return H>Na?H*H*H:mu*(H-_u)}const Pc=Object.hasOwn||function(H,h){return Object.prototype.hasOwnProperty.call(H,h)};function _o(H,h){return Pc(H,h)?H[h]:void 0}function mo(H){return parseInt(H.padEnd(2,H),16)/255}function ul(H,h){return hn(h?H/100:H,0,1)}function hn(H,h,W){return Math.min(Math.max(h,H),W)}function oi(H){return!H.some(Number.isNaN)}const ja={aliceblue:[240,248,255],antiquewhite:[250,235,215],aqua:[0,255,255],aquamarine:[127,255,212],azure:[240,255,255],beige:[245,245,220],bisque:[255,228,196],black:[0,0,0],blanchedalmond:[255,235,205],blue:[0,0,255],blueviolet:[138,43,226],brown:[165,42,42],burlywood:[222,184,135],cadetblue:[95,158,160],chartreuse:[127,255,0],chocolate:[210,105,30],coral:[255,127,80],cornflowerblue:[100,149,237],cornsilk:[255,248,220],crimson:[220,20,60],cyan:[0,255,255],darkblue:[0,0,139],darkcyan:[0,139,139],darkgoldenrod:[184,134,11],darkgray:[169,169,169],darkgreen:[0,100,0],darkgrey:[169,169,169],darkkhaki:[189,183,107],darkmagenta:[139,0,139],darkolivegreen:[85,107,47],darkorange:[255,140,0],darkorchid:[153,50,204],darkred:[139,0,0],darksalmon:[233,150,122],darkseagreen:[143,188,143],darkslateblue:[72,61,139],darkslategray:[47,79,79],darkslategrey:[47,79,79],darkturquoise:[0,206,209],darkviolet:[148,0,211],deeppink:[255,20,147],deepskyblue:[0,191,255],dimgray:[105,105,105],dimgrey:[105,105,105],dodgerblue:[30,144,255],firebrick:[178,34,34],floralwhite:[255,250,240],forestgreen:[34,139,34],fuchsia:[255,0,255],gainsboro:[220,220,220],ghostwhite:[248,248,255],gold:[255,215,0],goldenrod:[218,165,32],gray:[128,128,128],green:[0,128,0],greenyellow:[173,255,47],grey:[128,128,128],honeydew:[240,255,240],hotpink:[255,105,180],indianred:[205,92,92],indigo:[75,0,130],ivory:[255,255,240],khaki:[240,230,140],lavender:[230,230,250],lavenderblush:[255,240,245],lawngreen:[124,252,0],lemonchiffon:[255,250,205],lightblue:[173,216,230],lightcoral:[240,128,128],lightcyan:[224,255,255],lightgoldenrodyellow:[250,250,210],lightgray:[211,211,211],lightgreen:[144,238,144],lightgrey:[211,211,211],lightpink:[255,182,193],lightsalmon:[255,160,122],lightseagreen:[32,178,170],lightskyblue:[135,206,250],lightslategray:[119,136,153],lightslategrey:[119,136,153],lightsteelblue:[176,196,222],lightyellow:[255,255,224],lime:[0,255,0],limegreen:[50,205,50],linen:[250,240,230],magenta:[255,0,255],maroon:[128,0,0],mediumaquamarine:[102,205,170],mediumblue:[0,0,205],mediumorchid:[186,85,211],mediumpurple:[147,112,219],mediumseagreen:[60,179,113],mediumslateblue:[123,104,238],mediumspringgreen:[0,250,154],mediumturquoise:[72,209,204],mediumvioletred:[199,21,133],midnightblue:[25,25,112],mintcream:[245,255,250],mistyrose:[255,228,225],moccasin:[255,228,181],navajowhite:[255,222,173],navy:[0,0,128],oldlace:[253,245,230],olive:[128,128,0],olivedrab:[107,142,35],orange:[255,165,0],orangered:[255,69,0],orchid:[218,112,214],palegoldenrod:[238,232,170],palegreen:[152,251,152],paleturquoise:[175,238,238],palevioletred:[219,112,147],papayawhip:[255,239,213],peachpuff:[255,218,185],peru:[205,133,63],pink:[255,192,203],plum:[221,160,221],powderblue:[176,224,230],purple:[128,0,128],rebeccapurple:[102,51,153],red:[255,0,0],rosybrown:[188,143,143],royalblue:[65,105,225],saddlebrown:[139,69,19],salmon:[250,128,114],sandybrown:[244,164,96],seagreen:[46,139,87],seashell:[255,245,238],sienna:[160,82,45],silver:[192,192,192],skyblue:[135,206,235],slateblue:[106,90,205],slategray:[112,128,144],slategrey:[112,128,144],snow:[255,250,250],springgreen:[0,255,127],steelblue:[70,130,180],tan:[210,180,140],teal:[0,128,128],thistle:[216,191,216],tomato:[255,99,71],turquoise:[64,224,208],violet:[238,130,238],wheat:[245,222,179],white:[255,255,255],whitesmoke:[245,245,245],yellow:[255,255,0],yellowgreen:[154,205,50]};function dn(H,h,W){return H+W*(h-H)}function va(H,h,W){return H.map(((X,te)=>dn(X,h[te],W)))}class Qr{constructor(h,W,X,te=1,le=!0){this.r=h,this.g=W,this.b=X,this.a=te,le||(this.r*=te,this.g*=te,this.b*=te,te||this.overwriteGetter("rgb",[h,W,X,te]))}static parse(h){if(h instanceof Qr)return h;if(typeof h!="string")return;const W=(function(X){if((X=X.toLowerCase().trim())==="transparent")return[0,0,0,0];const te=_o(ja,X);if(te){const[he,fe,ye]=te;return[he/255,fe/255,ye/255,1]}if(X.startsWith("#")&&/^#(?:[0-9a-f]{3,4}|[0-9a-f]{6}|[0-9a-f]{8})$/.test(X)){const he=X.length<6?1:2;let fe=1;return[mo(X.slice(fe,fe+=he)),mo(X.slice(fe,fe+=he)),mo(X.slice(fe,fe+=he)),mo(X.slice(fe,fe+he)||"ff")]}if(X.startsWith("rgb")){const he=X.match(/^rgba?\(\s*([\de.+-]+)(%)?(?:\s+|\s*(,)\s*)([\de.+-]+)(%)?(?:\s+|\s*(,)\s*)([\de.+-]+)(%)?(?:\s*([,\/])\s*([\de.+-]+)(%)?)?\s*\)$/);if(he){const[fe,ye,be,Ee,Pe,Ne,Ue,$e,Ye,rt,dt,Ct]=he,vt=[Ee||" ",Ue||" ",rt].join("");if(vt==="  "||vt==="  /"||vt===",,"||vt===",,,"){const qt=[be,Ne,Ye].join(""),Lt=qt==="%%%"?100:qt===""?255:0;if(Lt){const Gt=[hn(+ye/Lt,0,1),hn(+Pe/Lt,0,1),hn(+$e/Lt,0,1),dt?ul(+dt,Ct):1];if(oi(Gt))return Gt}}return}}const le=X.match(/^hsla?\(\s*([\de.+-]+)(?:deg)?(?:\s+|\s*(,)\s*)([\de.+-]+)%(?:\s+|\s*(,)\s*)([\de.+-]+)%(?:\s*([,\/])\s*([\de.+-]+)(%)?)?\s*\)$/);if(le){const[he,fe,ye,be,Ee,Pe,Ne,Ue,$e]=le,Ye=[ye||" ",Ee||" ",Ne].join("");if(Ye==="  "||Ye==="  /"||Ye===",,"||Ye===",,,"){const rt=[+fe,hn(+be,0,100),hn(+Pe,0,100),Ue?ul(+Ue,$e):1];if(oi(rt))return(function([dt,Ct,vt,qt]){function Lt(Gt){const Xt=(Gt+dt/30)%12,_r=Ct*Math.min(vt,1-vt);return vt-_r*Math.max(-1,Math.min(Xt-3,9-Xt,1))}return dt=yu(dt),Ct/=100,vt/=100,[Lt(0),Lt(8),Lt(4),qt]})(rt)}}})(h);return W?new Qr(...W,!1):void 0}get rgb(){const{r:h,g:W,b:X,a:te}=this,le=te||1/0;return this.overwriteGetter("rgb",[h/le,W/le,X/le,te])}get hcl(){return this.overwriteGetter("hcl",(function(h){const[W,X,te,le]=ol(h),he=Math.sqrt(X*X+te*te);return[Math.round(1e4*he)?yu(Math.atan2(te,X)*Ac):NaN,he,W,le]})(this.rgb))}get lab(){return this.overwriteGetter("lab",ol(this.rgb))}overwriteGetter(h,W){return Object.defineProperty(this,h,{value:W}),W}toString(){const[h,W,X,te]=this.rgb;return`rgba(${[h,W,X].map((le=>Math.round(255*le))).join(",")},${te})`}static interpolate(h,W,X,te="rgb"){switch(te){case"rgb":{const[le,he,fe,ye]=va(h.rgb,W.rgb,X);return new Qr(le,he,fe,ye,!1)}case"hcl":{const[le,he,fe,ye]=h.hcl,[be,Ee,Pe,Ne]=W.hcl;let Ue,$e;if(isNaN(le)||isNaN(be))isNaN(le)?isNaN(be)?Ue=NaN:(Ue=be,fe!==1&&fe!==0||($e=Ee)):(Ue=le,Pe!==1&&Pe!==0||($e=he));else{let vt=be-le;be>le&&vt>180?vt-=360:be<le&&le-be>180&&(vt+=360),Ue=le+X*vt}const[Ye,rt,dt,Ct]=(function([vt,qt,Lt,Gt]){return vt=isNaN(vt)?0:vt*Rc,gu([Lt,Math.cos(vt)*qt,Math.sin(vt)*qt,Gt])})([Ue,$e??dn(he,Ee,X),dn(fe,Pe,X),dn(ye,Ne,X)]);return new Qr(Ye,rt,dt,Ct,!1)}case"lab":{const[le,he,fe,ye]=gu(va(h.lab,W.lab,X));return new Qr(le,he,fe,ye,!1)}}}}Qr.black=new Qr(0,0,0,1),Qr.white=new Qr(1,1,1,1),Qr.transparent=new Qr(0,0,0,0),Qr.red=new Qr(1,0,0,1);class yo{constructor(h,W,X){this.sensitivity=h?W?"variant":"case":W?"accent":"base",this.locale=X,this.collator=new Intl.Collator(this.locale?this.locale:[],{sensitivity:this.sensitivity,usage:"search"})}compare(h,W){return this.collator.compare(h,W)}resolvedLocale(){return new Intl.Collator(this.locale?this.locale:[]).resolvedOptions().locale}}const go=["bottom","center","top"];class za{constructor(h,W,X,te,le,he){this.text=h,this.image=W,this.scale=X,this.fontStack=te,this.textColor=le,this.verticalAlign=he}}class yn{constructor(h){this.sections=h}static fromString(h){return new yn([new za(h,null,null,null,null,null)])}isEmpty(){return this.sections.length===0||!this.sections.some((h=>h.text.length!==0||h.image&&h.image.name.length!==0))}static factory(h){return h instanceof yn?h:yn.fromString(h)}toString(){return this.sections.length===0?"":this.sections.map((h=>h.text)).join("")}}class en{constructor(h){this.values=h.slice()}static parse(h){if(h instanceof en)return h;if(typeof h=="number")return new en([h,h,h,h]);if(Array.isArray(h)&&!(h.length<1||h.length>4)){for(const W of h)if(typeof W!="number")return;switch(h.length){case 1:h=[h[0],h[0],h[0],h[0]];break;case 2:h=[h[0],h[1],h[0],h[1]];break;case 3:h=[h[0],h[1],h[2],h[1]]}return new en(h)}}toString(){return JSON.stringify(this.values)}static interpolate(h,W,X){return new en(va(h.values,W.values,X))}}class $i{constructor(h){this.values=h.slice()}static parse(h){if(h instanceof $i)return h;if(typeof h=="number")return new $i([h]);if(Array.isArray(h)){for(const W of h)if(typeof W!="number")return;return new $i(h)}}toString(){return JSON.stringify(this.values)}static interpolate(h,W,X){return new $i(va(h.values,W.values,X))}}class tn{constructor(h){this.values=h.slice()}static parse(h){if(h instanceof tn)return h;if(typeof h=="string"){const X=Qr.parse(h);return X?new tn([X]):void 0}if(!Array.isArray(h))return;const W=[];for(const X of h){if(typeof X!="string")return;const te=Qr.parse(X);if(!te)return;W.push(te)}return new tn(W)}toString(){return JSON.stringify(this.values)}static interpolate(h,W,X,te="rgb"){const le=[];if(h.values.length!=W.values.length)throw new Error(`colorArray: Arrays have mismatched length (${h.values.length} vs. ${W.values.length}), cannot interpolate.`);for(let he=0;he<h.values.length;he++)le.push(Qr.interpolate(h.values[he],W.values[he],X,te));return new tn(le)}}class xi extends Error{constructor(h){super(h),this.name="RuntimeError"}toJSON(){return this.message}}const Ua=new Set(["center","left","right","top","bottom","top-left","top-right","bottom-left","bottom-right"]);class fn{constructor(h){this.values=h.slice()}static parse(h){if(h instanceof fn)return h;if(Array.isArray(h)&&!(h.length<1)&&h.length%2==0){for(let W=0;W<h.length;W+=2){const X=h[W],te=h[W+1];if(typeof X!="string"||!Ua.has(X)||!Array.isArray(te)||te.length!==2||typeof te[0]!="number"||typeof te[1]!="number")return}return new fn(h)}}toString(){return JSON.stringify(this.values)}static interpolate(h,W,X){const te=h.values,le=W.values;if(te.length!==le.length)throw new xi(`Cannot interpolate values of different length. from: ${h.toString()}, to: ${W.toString()}`);const he=[];for(let fe=0;fe<te.length;fe+=2){if(te[fe]!==le[fe])throw new xi(`Cannot interpolate values containing mismatched anchors. from[${fe}]: ${te[fe]}, to[${fe}]: ${le[fe]}`);he.push(te[fe]);const[ye,be]=te[fe+1],[Ee,Pe]=le[fe+1];he.push([dn(ye,Ee,X),dn(be,Pe,X)])}return new fn(he)}}class wn{constructor(h){this.name=h.name,this.available=h.available}toString(){return this.name}static fromString(h){return h?new wn({name:h,available:!1}):null}}class gn{constructor(h,W,X){this.from=h,this.to=W,this.transition=X}static interpolate(h,W,X){return new gn(h,W,X)}static parse(h){return h instanceof gn?h:Array.isArray(h)&&h.length===3&&typeof h[0]=="string"&&typeof h[1]=="string"&&typeof h[2]=="number"?new gn(h[0],h[1],h[2]):typeof h=="object"&&typeof h.from=="string"&&typeof h.to=="string"&&typeof h.transition=="number"?new gn(h.from,h.to,h.transition):typeof h=="string"?new gn(h,h,1):void 0}}function vo(H,h,W,X){return typeof H=="number"&&H>=0&&H<=255&&typeof h=="number"&&h>=0&&h<=255&&typeof W=="number"&&W>=0&&W<=255?X===void 0||typeof X=="number"&&X>=0&&X<=1?null:`Invalid rgba value [${[H,h,W,X].join(", ")}]: 'a' must be between 0 and 1.`:`Invalid rgba value [${(typeof X=="number"?[H,h,W,X]:[H,h,W]).join(", ")}]: 'r', 'g', and 'b' must be between 0 and 255.`}function pi(H){if(H===null||typeof H=="string"||typeof H=="boolean"||typeof H=="number"||H instanceof gn||H instanceof Qr||H instanceof yo||H instanceof yn||H instanceof en||H instanceof $i||H instanceof tn||H instanceof fn||H instanceof wn)return!0;if(Array.isArray(H)){for(const h of H)if(!pi(h))return!1;return!0}if(typeof H=="object"){for(const h in H)if(!pi(H[h]))return!1;return!0}return!1}function Oi(H){if(H===null)return ii;if(typeof H=="string")return Zr;if(typeof H=="boolean")return Gr;if(typeof H=="number")return ir;if(H instanceof Qr)return jt;if(H instanceof gn)return tr;if(H instanceof yo)return Qt;if(H instanceof yn)return Ur;if(H instanceof en)return Rr;if(H instanceof $i)return fi;if(H instanceof tn)return yi;if(H instanceof fn)return ui;if(H instanceof wn)return Si;if(Array.isArray(H)){const h=H.length;let W;for(const X of H){const te=Oi(X);if(W){if(W===te)continue;W=Pt;break}W=te}return rr(W||Pt,h)}return Vt}function ni(H){const h=typeof H;return H===null?"":h==="string"||h==="number"||h==="boolean"?String(H):H instanceof Qr||H instanceof gn||H instanceof yn||H instanceof en||H instanceof $i||H instanceof tn||H instanceof fn||H instanceof wn?H.toString():JSON.stringify(H)}class $r{constructor(h,W){this.type=h,this.value=W}static parse(h,W){if(h.length!==2)return W.error(`'literal' expression requires exactly one argument, but found ${h.length-1} instead.`);if(!pi(h[1]))return W.error("invalid value");const X=h[1];let te=Oi(X);const le=W.expectedType;return te.kind!=="array"||te.N!==0||!le||le.kind!=="array"||typeof le.N=="number"&&le.N!==0||(te=le),new $r(te,X)}evaluate(){return this.value}eachChild(){}outputDefined(){return!0}}const Va={string:Zr,number:ir,boolean:Gr,object:Vt};class Xr{constructor(h,W){this.type=h,this.args=W}static parse(h,W){if(h.length<2)return W.error("Expected at least one argument.");let X,te=1;const le=h[0];if(le==="array"){let fe,ye;if(h.length>2){const be=h[1];if(typeof be!="string"||!(be in Va)||be==="object")return W.error('The item type argument of "array" must be one of string, number, boolean',1);fe=Va[be],te++}else fe=Pt;if(h.length>3){if(h[2]!==null&&(typeof h[2]!="number"||h[2]<0||h[2]!==Math.floor(h[2])))return W.error('The length argument to "array" must be a positive integer literal',2);ye=h[2],te++}X=rr(fe,ye)}else{if(!Va[le])throw new Error(`Types doesn't contain name = ${le}`);X=Va[le]}const he=[];for(;te<h.length;te++){const fe=W.parse(h[te],te,Pt);if(!fe)return null;he.push(fe)}return new Xr(X,he)}evaluate(h){for(let W=0;W<this.args.length;W++){const X=this.args[W].evaluate(h);if(!Gn(this.type,Oi(X)))return X;if(W===this.args.length-1)throw new xi(`Expected value to be of type ${Kr(this.type)}, but found ${Kr(Oi(X))} instead.`)}throw new Error}eachChild(h){this.args.forEach(h)}outputDefined(){return this.args.every((h=>h.outputDefined()))}}const es={"to-boolean":Gr,"to-color":jt,"to-number":ir,"to-string":Zr};class sn{constructor(h,W){this.type=h,this.args=W}static parse(h,W){if(h.length<2)return W.error("Expected at least one argument.");const X=h[0];if(!es[X])throw new Error(`Can't parse ${X} as it is not part of the known types`);if((X==="to-boolean"||X==="to-string")&&h.length!==2)return W.error("Expected one argument.");const te=es[X],le=[];for(let he=1;he<h.length;he++){const fe=W.parse(h[he],he,Pt);if(!fe)return null;le.push(fe)}return new sn(te,le)}evaluate(h){switch(this.type.kind){case"boolean":return!!this.args[0].evaluate(h);case"color":{let W,X;for(const te of this.args){if(W=te.evaluate(h),X=null,W instanceof Qr)return W;if(typeof W=="string"){const le=h.parseColor(W);if(le)return le}else if(Array.isArray(W)&&(X=W.length<3||W.length>4?`Invalid rgba value ${JSON.stringify(W)}: expected an array containing either three or four numeric values.`:vo(W[0],W[1],W[2],W[3]),!X))return new Qr(W[0]/255,W[1]/255,W[2]/255,W[3])}throw new xi(X||`Could not parse color from value '${typeof W=="string"?W:JSON.stringify(W)}'`)}case"padding":{let W;for(const X of this.args){W=X.evaluate(h);const te=en.parse(W);if(te)return te}throw new xi(`Could not parse padding from value '${typeof W=="string"?W:JSON.stringify(W)}'`)}case"numberArray":{let W;for(const X of this.args){W=X.evaluate(h);const te=$i.parse(W);if(te)return te}throw new xi(`Could not parse numberArray from value '${typeof W=="string"?W:JSON.stringify(W)}'`)}case"colorArray":{let W;for(const X of this.args){W=X.evaluate(h);const te=tn.parse(W);if(te)return te}throw new xi(`Could not parse colorArray from value '${typeof W=="string"?W:JSON.stringify(W)}'`)}case"variableAnchorOffsetCollection":{let W;for(const X of this.args){W=X.evaluate(h);const te=fn.parse(W);if(te)return te}throw new xi(`Could not parse variableAnchorOffsetCollection from value '${typeof W=="string"?W:JSON.stringify(W)}'`)}case"number":{let W=null;for(const X of this.args){if(W=X.evaluate(h),W===null)return 0;const te=Number(W);if(!isNaN(te))return te}throw new xi(`Could not convert ${JSON.stringify(W)} to number.`)}case"formatted":return yn.fromString(ni(this.args[0].evaluate(h)));case"resolvedImage":return wn.fromString(ni(this.args[0].evaluate(h)));case"projectionDefinition":return this.args[0].evaluate(h);default:return ni(this.args[0].evaluate(h))}}eachChild(h){this.args.forEach(h)}outputDefined(){return this.args.every((h=>h.outputDefined()))}}const cl=["Unknown","Point","LineString","Polygon"];class bo{constructor(){this.globals=null,this.feature=null,this.featureState=null,this.formattedSection=null,this._parseColorCache=new Map,this.availableImages=null,this.canonical=null}id(){return this.feature&&"id"in this.feature?this.feature.id:null}geometryType(){return this.feature?typeof this.feature.type=="number"?cl[this.feature.type]:this.feature.type:null}geometry(){return this.feature&&"geometry"in this.feature?this.feature.geometry:null}canonicalID(){return this.canonical}properties(){return this.feature&&this.feature.properties||{}}parseColor(h){let W=this._parseColorCache.get(h);return W||(W=Qr.parse(h),this._parseColorCache.set(h,W)),W}}class xo{constructor(h,W,X=[],te,le=new Pi,he=[]){this.registry=h,this.path=X,this.key=X.map((fe=>`[${fe}]`)).join(""),this.scope=le,this.errors=he,this.expectedType=te,this._isConstant=W}parse(h,W,X,te,le={}){return W?this.concat(W,X,te)._parse(h,le):this._parse(h,le)}_parse(h,W){function X(te,le,he){return he==="assert"?new Xr(le,[te]):he==="coerce"?new sn(le,[te]):te}if(h!==null&&typeof h!="string"&&typeof h!="boolean"&&typeof h!="number"||(h=["literal",h]),Array.isArray(h)){if(h.length===0)return this.error('Expected an array with at least one element. If you wanted a literal array, use ["literal", []].');const te=h[0];if(typeof te!="string")return this.error(`Expression name must be a string, but found ${typeof te} instead. If you wanted a literal array, use ["literal", [...]].`,0),null;const le=this.registry[te];if(le){let he=le.parse(h,this);if(!he)return null;if(this.expectedType){const fe=this.expectedType,ye=he.type;if(fe.kind!=="string"&&fe.kind!=="number"&&fe.kind!=="boolean"&&fe.kind!=="object"&&fe.kind!=="array"||ye.kind!=="value"){if(fe.kind==="projectionDefinition"&&["string","array"].includes(ye.kind)||["color","formatted","resolvedImage"].includes(fe.kind)&&["value","string"].includes(ye.kind)||["padding","numberArray"].includes(fe.kind)&&["value","number","array"].includes(ye.kind)||fe.kind==="colorArray"&&["value","string","array"].includes(ye.kind)||fe.kind==="variableAnchorOffsetCollection"&&["value","array"].includes(ye.kind))he=X(he,fe,W.typeAnnotation||"coerce");else if(this.checkSubtype(fe,ye))return null}else he=X(he,fe,W.typeAnnotation||"assert")}if(!(he instanceof $r)&&he.type.kind!=="resolvedImage"&&this._isConstant(he)){const fe=new bo;try{he=new $r(he.type,he.evaluate(fe))}catch(ye){return this.error(ye.message),null}}return he}return this.error(`Unknown expression "${te}". If you wanted a literal array, use ["literal", [...]].`,0)}return this.error(h===void 0?"'undefined' value invalid. Use null instead.":typeof h=="object"?'Bare objects invalid. Use ["literal", {...}] instead.':`Expected an array, but found ${typeof h} instead.`)}concat(h,W,X){const te=typeof h=="number"?this.path.concat(h):this.path,le=X?this.scope.concat(X):this.scope;return new xo(this.registry,this._isConstant,te,W||null,le,this.errors)}error(h,...W){const X=`${this.key}${W.map((te=>`[${te}]`)).join("")}`;this.errors.push(new Ni(X,h))}checkSubtype(h,W){const X=Gn(h,W);return X&&this.error(X),X}}class Ga{constructor(h,W){this.type=W.type,this.bindings=[].concat(h),this.result=W}evaluate(h){return this.result.evaluate(h)}eachChild(h){for(const W of this.bindings)h(W[1]);h(this.result)}static parse(h,W){if(h.length<4)return W.error(`Expected at least 3 arguments, but found ${h.length-1} instead.`);const X=[];for(let le=1;le<h.length-1;le+=2){const he=h[le];if(typeof he!="string")return W.error(`Expected string, but found ${typeof he} instead.`,le);if(/[^a-zA-Z0-9_]/.test(he))return W.error("Variable names must contain only alphanumeric characters or '_'.",le);const fe=W.parse(h[le+1],le+1);if(!fe)return null;X.push([he,fe])}const te=W.parse(h[h.length-1],h.length-1,W.expectedType,X);return te?new Ga(X,te):null}outputDefined(){return this.result.outputDefined()}}class wo{constructor(h,W){this.type=W.type,this.name=h,this.boundExpression=W}static parse(h,W){if(h.length!==2||typeof h[1]!="string")return W.error("'var' expression requires exactly one string literal argument.");const X=h[1];return W.scope.has(X)?new wo(X,W.scope.get(X)):W.error(`Unknown variable "${X}". Make sure "${X}" has been bound in an enclosing "let" expression before using it.`,1)}evaluate(h){return this.boundExpression.evaluate(h)}eachChild(){}outputDefined(){return!1}}class hl{constructor(h,W,X){this.type=h,this.index=W,this.input=X}static parse(h,W){if(h.length!==3)return W.error(`Expected 2 arguments, but found ${h.length-1} instead.`);const X=W.parse(h[1],1,ir),te=W.parse(h[2],2,rr(W.expectedType||Pt));return X&&te?new hl(te.type.itemType,X,te):null}evaluate(h){const W=this.index.evaluate(h),X=this.input.evaluate(h);if(W<0)throw new xi(`Array index out of bounds: ${W} < 0.`);if(W>=X.length)throw new xi(`Array index out of bounds: ${W} > ${X.length-1}.`);if(W!==Math.floor(W))throw new xi(`Array index must be an integer, but found ${W} instead.`);return X[W]}eachChild(h){h(this.index),h(this.input)}outputDefined(){return!1}}class ts{constructor(h,W){this.type=Gr,this.needle=h,this.haystack=W}static parse(h,W){if(h.length!==3)return W.error(`Expected 2 arguments, but found ${h.length-1} instead.`);const X=W.parse(h[1],1,Pt),te=W.parse(h[2],2,Pt);return X&&te?Ba(X.type,[Gr,Zr,ir,ii,Pt])?new ts(X,te):W.error(`Expected first argument to be of type boolean, string, number or null, but found ${Kr(X.type)} instead`):null}evaluate(h){const W=this.needle.evaluate(h),X=this.haystack.evaluate(h);if(!X)return!1;if(!$n(W,["boolean","string","number","null"]))throw new xi(`Expected first argument to be of type boolean, string, number or null, but found ${Kr(Oi(W))} instead.`);if(!$n(X,["string","array"]))throw new xi(`Expected second argument to be of type array or string, but found ${Kr(Oi(X))} instead.`);return X.indexOf(W)>=0}eachChild(h){h(this.needle),h(this.haystack)}outputDefined(){return!0}}class So{constructor(h,W,X){this.type=ir,this.needle=h,this.haystack=W,this.fromIndex=X}static parse(h,W){if(h.length<=2||h.length>=5)return W.error(`Expected 2 or 3 arguments, but found ${h.length-1} instead.`);const X=W.parse(h[1],1,Pt),te=W.parse(h[2],2,Pt);if(!X||!te)return null;if(!Ba(X.type,[Gr,Zr,ir,ii,Pt]))return W.error(`Expected first argument to be of type boolean, string, number or null, but found ${Kr(X.type)} instead`);if(h.length===4){const le=W.parse(h[3],3,ir);return le?new So(X,te,le):null}return new So(X,te)}evaluate(h){const W=this.needle.evaluate(h),X=this.haystack.evaluate(h);if(!$n(W,["boolean","string","number","null"]))throw new xi(`Expected first argument to be of type boolean, string, number or null, but found ${Kr(Oi(W))} instead.`);let te;if(this.fromIndex&&(te=this.fromIndex.evaluate(h)),$n(X,["string"])){const le=X.indexOf(W,te);return le===-1?-1:[...X.slice(0,le)].length}if($n(X,["array"]))return X.indexOf(W,te);throw new xi(`Expected second argument to be of type array or string, but found ${Kr(Oi(X))} instead.`)}eachChild(h){h(this.needle),h(this.haystack),this.fromIndex&&h(this.fromIndex)}outputDefined(){return!1}}class Wn{constructor(h,W,X,te,le,he){this.inputType=h,this.type=W,this.input=X,this.cases=te,this.outputs=le,this.otherwise=he}static parse(h,W){if(h.length<5)return W.error(`Expected at least 4 arguments, but found only ${h.length-1}.`);if(h.length%2!=1)return W.error("Expected an even number of arguments.");let X,te;W.expectedType&&W.expectedType.kind!=="value"&&(te=W.expectedType);const le={},he=[];for(let be=2;be<h.length-1;be+=2){let Ee=h[be];const Pe=h[be+1];Array.isArray(Ee)||(Ee=[Ee]);const Ne=W.concat(be);if(Ee.length===0)return Ne.error("Expected at least one branch label.");for(const $e of Ee){if(typeof $e!="number"&&typeof $e!="string")return Ne.error("Branch labels must be numbers or strings.");if(typeof $e=="number"&&Math.abs($e)>Number.MAX_SAFE_INTEGER)return Ne.error(`Branch labels must be integers no larger than ${Number.MAX_SAFE_INTEGER}.`);if(typeof $e=="number"&&Math.floor($e)!==$e)return Ne.error("Numeric branch labels must be integer values.");if(X){if(Ne.checkSubtype(X,Oi($e)))return null}else X=Oi($e);if(le[String($e)]!==void 0)return Ne.error("Branch labels must be unique.");le[String($e)]=he.length}const Ue=W.parse(Pe,be,te);if(!Ue)return null;te=te||Ue.type,he.push(Ue)}const fe=W.parse(h[1],1,Pt);if(!fe)return null;const ye=W.parse(h[h.length-1],h.length-1,te);return ye?fe.type.kind!=="value"&&W.concat(1).checkSubtype(X,fe.type)?null:new Wn(X,te,fe,le,he,ye):null}evaluate(h){const W=this.input.evaluate(h);return(Oi(W)===this.inputType&&this.outputs[this.cases[W]]||this.otherwise).evaluate(h)}eachChild(h){h(this.input),this.outputs.forEach(h),h(this.otherwise)}outputDefined(){return this.outputs.every((h=>h.outputDefined()))&&this.otherwise.outputDefined()}}class Wi{constructor(h,W,X){this.type=h,this.branches=W,this.otherwise=X}static parse(h,W){if(h.length<4)return W.error(`Expected at least 3 arguments, but found only ${h.length-1}.`);if(h.length%2!=0)return W.error("Expected an odd number of arguments.");let X;W.expectedType&&W.expectedType.kind!=="value"&&(X=W.expectedType);const te=[];for(let he=1;he<h.length-1;he+=2){const fe=W.parse(h[he],he,Gr);if(!fe)return null;const ye=W.parse(h[he+1],he+1,X);if(!ye)return null;te.push([fe,ye]),X=X||ye.type}const le=W.parse(h[h.length-1],h.length-1,X);if(!le)return null;if(!X)throw new Error("Can't infer output type");return new Wi(X,te,le)}evaluate(h){for(const[W,X]of this.branches)if(W.evaluate(h))return X.evaluate(h);return this.otherwise.evaluate(h)}eachChild(h){for(const[W,X]of this.branches)h(W),h(X);h(this.otherwise)}outputDefined(){return this.branches.every((([h,W])=>W.outputDefined()))&&this.otherwise.outputDefined()}}class ba{constructor(h,W,X,te){this.type=h,this.input=W,this.beginIndex=X,this.endIndex=te}static parse(h,W){if(h.length<=2||h.length>=5)return W.error(`Expected 2 or 3 arguments, but found ${h.length-1} instead.`);const X=W.parse(h[1],1,Pt),te=W.parse(h[2],2,ir);if(!X||!te)return null;if(!Ba(X.type,[rr(Pt),Zr,Pt]))return W.error(`Expected first argument to be of type array or string, but found ${Kr(X.type)} instead`);if(h.length===4){const le=W.parse(h[3],3,ir);return le?new ba(X.type,X,te,le):null}return new ba(X.type,X,te)}evaluate(h){const W=this.input.evaluate(h),X=this.beginIndex.evaluate(h);let te;if(this.endIndex&&(te=this.endIndex.evaluate(h)),$n(W,["string"]))return[...W].slice(X,te).join("");if($n(W,["array"]))return W.slice(X,te);throw new xi(`Expected first argument to be of type array or string, but found ${Kr(Oi(W))} instead.`)}eachChild(h){h(this.input),h(this.beginIndex),this.endIndex&&h(this.endIndex)}outputDefined(){return!1}}function Eo(H,h){const W=H.length-1;let X,te,le=0,he=W,fe=0;for(;le<=he;)if(fe=Math.floor((le+he)/2),X=H[fe],te=H[fe+1],X<=h){if(fe===W||h<te)return fe;le=fe+1}else{if(!(X>h))throw new xi("Input is not a number.");he=fe-1}return 0}class aa{constructor(h,W,X){this.type=h,this.input=W,this.labels=[],this.outputs=[];for(const[te,le]of X)this.labels.push(te),this.outputs.push(le)}static parse(h,W){if(h.length-1<4)return W.error(`Expected at least 4 arguments, but found only ${h.length-1}.`);if((h.length-1)%2!=0)return W.error("Expected an even number of arguments.");const X=W.parse(h[1],1,ir);if(!X)return null;const te=[];let le=null;W.expectedType&&W.expectedType.kind!=="value"&&(le=W.expectedType);for(let he=1;he<h.length;he+=2){const fe=he===1?-1/0:h[he],ye=h[he+1],be=he,Ee=he+1;if(typeof fe!="number")return W.error('Input/output pairs for "step" expressions must be defined using literal numeric values (not computed expressions) for the input values.',be);if(te.length&&te[te.length-1][0]>=fe)return W.error('Input/output pairs for "step" expressions must be arranged with input values in strictly ascending order.',be);const Pe=W.parse(ye,Ee,le);if(!Pe)return null;le=le||Pe.type,te.push([fe,Pe])}return new aa(le,X,te)}evaluate(h){const W=this.labels,X=this.outputs;if(W.length===1)return X[0].evaluate(h);const te=this.input.evaluate(h);if(te<=W[0])return X[0].evaluate(h);const le=W.length;return te>=W[le-1]?X[le-1].evaluate(h):X[Eo(W,te)].evaluate(h)}eachChild(h){h(this.input);for(const W of this.outputs)h(W)}outputDefined(){return this.outputs.every((h=>h.outputDefined()))}}function Hi(H){return H&&H.__esModule&&Object.prototype.hasOwnProperty.call(H,"default")?H.default:H}var rs,is,vu=(function(){if(is)return rs;function H(h,W,X,te){this.cx=3*h,this.bx=3*(X-h)-this.cx,this.ax=1-this.cx-this.bx,this.cy=3*W,this.by=3*(te-W)-this.cy,this.ay=1-this.cy-this.by,this.p1x=h,this.p1y=W,this.p2x=X,this.p2y=te}return is=1,rs=H,H.prototype={sampleCurveX:function(h){return((this.ax*h+this.bx)*h+this.cx)*h},sampleCurveY:function(h){return((this.ay*h+this.by)*h+this.cy)*h},sampleCurveDerivativeX:function(h){return(3*this.ax*h+2*this.bx)*h+this.cx},solveCurveX:function(h,W){if(W===void 0&&(W=1e-6),h<0)return 0;if(h>1)return 1;for(var X=h,te=0;te<8;te++){var le=this.sampleCurveX(X)-h;if(Math.abs(le)<W)return X;var he=this.sampleCurveDerivativeX(X);if(Math.abs(he)<1e-6)break;X-=le/he}var fe=0,ye=1;for(X=h,te=0;te<20&&(le=this.sampleCurveX(X),!(Math.abs(le-h)<W));te++)h>le?fe=X:ye=X,X=.5*(ye-fe)+fe;return X},solve:function(h,W){return this.sampleCurveY(this.solveCurveX(h,W))}},rs})(),Oc=Hi(vu);class zi{constructor(h,W,X,te,le){this.type=h,this.operator=W,this.interpolation=X,this.input=te,this.labels=[],this.outputs=[];for(const[he,fe]of le)this.labels.push(he),this.outputs.push(fe)}static interpolationFactor(h,W,X,te){let le=0;if(h.name==="exponential")le=$a(W,h.base,X,te);else if(h.name==="linear")le=$a(W,1,X,te);else if(h.name==="cubic-bezier"){const he=h.controlPoints;le=new Oc(he[0],he[1],he[2],he[3]).solve($a(W,1,X,te))}return le}static parse(h,W){let[X,te,le,...he]=h;if(!Array.isArray(te)||te.length===0)return W.error("Expected an interpolation type expression.",1);if(te[0]==="linear")te={name:"linear"};else if(te[0]==="exponential"){const be=te[1];if(typeof be!="number")return W.error("Exponential interpolation requires a numeric base.",1,1);te={name:"exponential",base:be}}else{if(te[0]!=="cubic-bezier")return W.error(`Unknown interpolation type ${String(te[0])}`,1,0);{const be=te.slice(1);if(be.length!==4||be.some((Ee=>typeof Ee!="number"||Ee<0||Ee>1)))return W.error("Cubic bezier interpolation requires four numeric arguments with values between 0 and 1.",1);te={name:"cubic-bezier",controlPoints:be}}}if(h.length-1<4)return W.error(`Expected at least 4 arguments, but found only ${h.length-1}.`);if((h.length-1)%2!=0)return W.error("Expected an even number of arguments.");if(le=W.parse(le,2,ir),!le)return null;const fe=[];let ye=null;X!=="interpolate-hcl"&&X!=="interpolate-lab"||W.expectedType==yi?W.expectedType&&W.expectedType.kind!=="value"&&(ye=W.expectedType):ye=jt;for(let be=0;be<he.length;be+=2){const Ee=he[be],Pe=he[be+1],Ne=be+3,Ue=be+4;if(typeof Ee!="number")return W.error('Input/output pairs for "interpolate" expressions must be defined using literal numeric values (not computed expressions) for the input values.',Ne);if(fe.length&&fe[fe.length-1][0]>=Ee)return W.error('Input/output pairs for "interpolate" expressions must be arranged with input values in strictly ascending order.',Ne);const $e=W.parse(Pe,Ue,ye);if(!$e)return null;ye=ye||$e.type,fe.push([Ee,$e])}return xn(ye,ir)||xn(ye,tr)||xn(ye,jt)||xn(ye,Rr)||xn(ye,fi)||xn(ye,yi)||xn(ye,ui)||xn(ye,rr(ir))?new zi(ye,X,te,le,fe):W.error(`Type ${Kr(ye)} is not interpolatable.`)}evaluate(h){const W=this.labels,X=this.outputs;if(W.length===1)return X[0].evaluate(h);const te=this.input.evaluate(h);if(te<=W[0])return X[0].evaluate(h);const le=W.length;if(te>=W[le-1])return X[le-1].evaluate(h);const he=Eo(W,te),fe=zi.interpolationFactor(this.interpolation,te,W[he],W[he+1]),ye=X[he].evaluate(h),be=X[he+1].evaluate(h);switch(this.operator){case"interpolate":switch(this.type.kind){case"number":return dn(ye,be,fe);case"color":return Qr.interpolate(ye,be,fe);case"padding":return en.interpolate(ye,be,fe);case"colorArray":return tn.interpolate(ye,be,fe);case"numberArray":return $i.interpolate(ye,be,fe);case"variableAnchorOffsetCollection":return fn.interpolate(ye,be,fe);case"array":return va(ye,be,fe);case"projectionDefinition":return gn.interpolate(ye,be,fe)}case"interpolate-hcl":switch(this.type.kind){case"color":return Qr.interpolate(ye,be,fe,"hcl");case"colorArray":return tn.interpolate(ye,be,fe,"hcl")}case"interpolate-lab":switch(this.type.kind){case"color":return Qr.interpolate(ye,be,fe,"lab");case"colorArray":return tn.interpolate(ye,be,fe,"lab")}}}eachChild(h){h(this.input);for(const W of this.outputs)h(W)}outputDefined(){return this.outputs.every((h=>h.outputDefined()))}}function $a(H,h,W,X){const te=X-W,le=H-W;return te===0?0:h===1?le/te:(Math.pow(h,le)-1)/(Math.pow(h,te)-1)}const An={color:Qr.interpolate,number:dn,padding:en.interpolate,numberArray:$i.interpolate,colorArray:tn.interpolate,variableAnchorOffsetCollection:fn.interpolate,array:va};class ns{constructor(h,W){this.type=h,this.args=W}static parse(h,W){if(h.length<2)return W.error("Expected at least one argument.");let X=null;const te=W.expectedType;te&&te.kind!=="value"&&(X=te);const le=[];for(const fe of h.slice(1)){const ye=W.parse(fe,1+le.length,X,void 0,{typeAnnotation:"omit"});if(!ye)return null;X=X||ye.type,le.push(ye)}if(!X)throw new Error("No output type");const he=te&&le.some((fe=>Gn(te,fe.type)));return new ns(he?Pt:X,le)}evaluate(h){let W,X=null,te=0;for(const le of this.args)if(te++,X=le.evaluate(h),X&&X instanceof wn&&!X.available&&(W||(W=X.name),X=null,te===this.args.length&&(X=W)),X!==null)break;return X}eachChild(h){this.args.forEach(h)}outputDefined(){return this.args.every((h=>h.outputDefined()))}}function dl(H,h){return H==="=="||H==="!="?h.kind==="boolean"||h.kind==="string"||h.kind==="number"||h.kind==="null"||h.kind==="value":h.kind==="string"||h.kind==="number"||h.kind==="value"}function qo(H,h,W,X){return X.compare(h,W)===0}function Xn(H,h,W){const X=H!=="=="&&H!=="!=";return class gf{constructor(le,he,fe){this.type=Gr,this.lhs=le,this.rhs=he,this.collator=fe,this.hasUntypedArgument=le.type.kind==="value"||he.type.kind==="value"}static parse(le,he){if(le.length!==3&&le.length!==4)return he.error("Expected two or three arguments.");const fe=le[0];let ye=he.parse(le[1],1,Pt);if(!ye)return null;if(!dl(fe,ye.type))return he.concat(1).error(`"${fe}" comparisons are not supported for type '${Kr(ye.type)}'.`);let be=he.parse(le[2],2,Pt);if(!be)return null;if(!dl(fe,be.type))return he.concat(2).error(`"${fe}" comparisons are not supported for type '${Kr(be.type)}'.`);if(ye.type.kind!==be.type.kind&&ye.type.kind!=="value"&&be.type.kind!=="value")return he.error(`Cannot compare types '${Kr(ye.type)}' and '${Kr(be.type)}'.`);X&&(ye.type.kind==="value"&&be.type.kind!=="value"?ye=new Xr(be.type,[ye]):ye.type.kind!=="value"&&be.type.kind==="value"&&(be=new Xr(ye.type,[be])));let Ee=null;if(le.length===4){if(ye.type.kind!=="string"&&be.type.kind!=="string"&&ye.type.kind!=="value"&&be.type.kind!=="value")return he.error("Cannot use collator to compare non-string types.");if(Ee=he.parse(le[3],3,Qt),!Ee)return null}return new gf(ye,be,Ee)}evaluate(le){const he=this.lhs.evaluate(le),fe=this.rhs.evaluate(le);if(X&&this.hasUntypedArgument){const ye=Oi(he),be=Oi(fe);if(ye.kind!==be.kind||ye.kind!=="string"&&ye.kind!=="number")throw new xi(`Expected arguments for "${H}" to be (string, string) or (number, number), but found (${ye.kind}, ${be.kind}) instead.`)}if(this.collator&&!X&&this.hasUntypedArgument){const ye=Oi(he),be=Oi(fe);if(ye.kind!=="string"||be.kind!=="string")return h(le,he,fe)}return this.collator?W(le,he,fe,this.collator.evaluate(le)):h(le,he,fe)}eachChild(le){le(this.lhs),le(this.rhs),this.collator&&le(this.collator)}outputDefined(){return!0}}}const Dn=Xn("==",(function(H,h,W){return h===W}),qo),bu=Xn("!=",(function(H,h,W){return h!==W}),(function(H,h,W,X){return!qo(0,h,W,X)})),as=Xn("<",(function(H,h,W){return h<W}),(function(H,h,W,X){return X.compare(h,W)<0})),Cc=Xn(">",(function(H,h,W){return h>W}),(function(H,h,W,X){return X.compare(h,W)>0})),fl=Xn("<=",(function(H,h,W){return h<=W}),(function(H,h,W,X){return X.compare(h,W)<=0})),Mc=Xn(">=",(function(H,h,W){return h>=W}),(function(H,h,W,X){return X.compare(h,W)>=0}));class os{constructor(h,W,X){this.type=Qt,this.locale=X,this.caseSensitive=h,this.diacriticSensitive=W}static parse(h,W){if(h.length!==2)return W.error("Expected one argument.");const X=h[1];if(typeof X!="object"||Array.isArray(X))return W.error("Collator options argument must be an object.");const te=W.parse(X["case-sensitive"]!==void 0&&X["case-sensitive"],1,Gr);if(!te)return null;const le=W.parse(X["diacritic-sensitive"]!==void 0&&X["diacritic-sensitive"],1,Gr);if(!le)return null;let he=null;return X.locale&&(he=W.parse(X.locale,1,Zr),!he)?null:new os(te,le,he)}evaluate(h){return new yo(this.caseSensitive.evaluate(h),this.diacriticSensitive.evaluate(h),this.locale?this.locale.evaluate(h):null)}eachChild(h){h(this.caseSensitive),h(this.diacriticSensitive),this.locale&&h(this.locale)}outputDefined(){return!1}}class pl{constructor(h,W,X,te,le){this.type=Zr,this.number=h,this.locale=W,this.currency=X,this.minFractionDigits=te,this.maxFractionDigits=le}static parse(h,W){if(h.length!==3)return W.error("Expected two arguments.");const X=W.parse(h[1],1,ir);if(!X)return null;const te=h[2];if(typeof te!="object"||Array.isArray(te))return W.error("NumberFormat options argument must be an object.");let le=null;if(te.locale&&(le=W.parse(te.locale,1,Zr),!le))return null;let he=null;if(te.currency&&(he=W.parse(te.currency,1,Zr),!he))return null;let fe=null;if(te["min-fraction-digits"]&&(fe=W.parse(te["min-fraction-digits"],1,ir),!fe))return null;let ye=null;return te["max-fraction-digits"]&&(ye=W.parse(te["max-fraction-digits"],1,ir),!ye)?null:new pl(X,le,he,fe,ye)}evaluate(h){return new Intl.NumberFormat(this.locale?this.locale.evaluate(h):[],{style:this.currency?"currency":"decimal",currency:this.currency?this.currency.evaluate(h):void 0,minimumFractionDigits:this.minFractionDigits?this.minFractionDigits.evaluate(h):void 0,maximumFractionDigits:this.maxFractionDigits?this.maxFractionDigits.evaluate(h):void 0}).format(this.number.evaluate(h))}eachChild(h){h(this.number),this.locale&&h(this.locale),this.currency&&h(this.currency),this.minFractionDigits&&h(this.minFractionDigits),this.maxFractionDigits&&h(this.maxFractionDigits)}outputDefined(){return!1}}class ss{constructor(h){this.type=Ur,this.sections=h}static parse(h,W){if(h.length<2)return W.error("Expected at least one argument.");const X=h[1];if(!Array.isArray(X)&&typeof X=="object")return W.error("First argument must be an image or text section.");const te=[];let le=!1;for(let he=1;he<=h.length-1;++he){const fe=h[he];if(le&&typeof fe=="object"&&!Array.isArray(fe)){le=!1;let ye=null;if(fe["font-scale"]&&(ye=W.parse(fe["font-scale"],1,ir),!ye))return null;let be=null;if(fe["text-font"]&&(be=W.parse(fe["text-font"],1,rr(Zr)),!be))return null;let Ee=null;if(fe["text-color"]&&(Ee=W.parse(fe["text-color"],1,jt),!Ee))return null;let Pe=null;if(fe["vertical-align"]){if(typeof fe["vertical-align"]=="string"&&!go.includes(fe["vertical-align"]))return W.error(`'vertical-align' must be one of: 'bottom', 'center', 'top' but found '${fe["vertical-align"]}' instead.`);if(Pe=W.parse(fe["vertical-align"],1,Zr),!Pe)return null}const Ne=te[te.length-1];Ne.scale=ye,Ne.font=be,Ne.textColor=Ee,Ne.verticalAlign=Pe}else{const ye=W.parse(h[he],1,Pt);if(!ye)return null;const be=ye.type.kind;if(be!=="string"&&be!=="value"&&be!=="null"&&be!=="resolvedImage")return W.error("Formatted text type must be 'string', 'value', 'image' or 'null'.");le=!0,te.push({content:ye,scale:null,font:null,textColor:null,verticalAlign:null})}}return new ss(te)}evaluate(h){return new yn(this.sections.map((W=>{const X=W.content.evaluate(h);return Oi(X)===Si?new za("",X,null,null,null,W.verticalAlign?W.verticalAlign.evaluate(h):null):new za(ni(X),null,W.scale?W.scale.evaluate(h):null,W.font?W.font.evaluate(h).join(","):null,W.textColor?W.textColor.evaluate(h):null,W.verticalAlign?W.verticalAlign.evaluate(h):null)})))}eachChild(h){for(const W of this.sections)h(W.content),W.scale&&h(W.scale),W.font&&h(W.font),W.textColor&&h(W.textColor),W.verticalAlign&&h(W.verticalAlign)}outputDefined(){return!1}}class Wa{constructor(h){this.type=Si,this.input=h}static parse(h,W){if(h.length!==2)return W.error("Expected two arguments.");const X=W.parse(h[1],1,Zr);return X?new Wa(X):W.error("No image name provided.")}evaluate(h){const W=this.input.evaluate(h),X=wn.fromString(W);return X&&h.availableImages&&(X.available=h.availableImages.indexOf(W)>-1),X}eachChild(h){h(this.input)}outputDefined(){return!1}}class _l{constructor(h){this.type=ir,this.input=h}static parse(h,W){if(h.length!==2)return W.error(`Expected 1 argument, but found ${h.length-1} instead.`);const X=W.parse(h[1],1);return X?X.type.kind!=="array"&&X.type.kind!=="string"&&X.type.kind!=="value"?W.error(`Expected argument of type string or array, but found ${Kr(X.type)} instead.`):new _l(X):null}evaluate(h){const W=this.input.evaluate(h);if(typeof W=="string")return[...W].length;if(Array.isArray(W))return W.length;throw new xi(`Expected value to be of type string or array, but found ${Kr(Oi(W))} instead.`)}eachChild(h){h(this.input)}outputDefined(){return!1}}const Fn=8192;function xu(H,h){const W=(180+H[0])/360,X=(180-180/Math.PI*Math.log(Math.tan(Math.PI/4+H[1]*Math.PI/360)))/360,te=Math.pow(2,h.z);return[Math.round(W*te*Fn),Math.round(X*te*Fn)]}function ml(H,h){const W=Math.pow(2,h.z);return[(te=(H[0]/Fn+h.x)/W,360*te-180),(X=(H[1]/Fn+h.y)/W,360/Math.PI*Math.atan(Math.exp((180-360*X)*Math.PI/180))-90)];var X,te}function Ha(H,h){H[0]=Math.min(H[0],h[0]),H[1]=Math.min(H[1],h[1]),H[2]=Math.max(H[2],h[0]),H[3]=Math.max(H[3],h[1])}function To(H,h){return!(H[0]<=h[0]||H[2]>=h[2]||H[1]<=h[1]||H[3]>=h[3])}function Dc(H,h,W){const X=H[0]-h[0],te=H[1]-h[1],le=H[0]-W[0],he=H[1]-W[1];return X*he-le*te==0&&X*le<=0&&te*he<=0}function ls(H,h,W,X){return(te=[X[0]-W[0],X[1]-W[1]])[0]*(le=[h[0]-H[0],h[1]-H[1]])[1]-te[1]*le[0]!=0&&!(!Eu(H,h,W,X)||!Eu(W,X,H,h));var te,le}function Fc(H,h,W){for(const X of W)for(let te=0;te<X.length-1;++te)if(ls(H,h,X[te],X[te+1]))return!0;return!1}function Za(H,h,W=!1){let X=!1;for(const fe of h)for(let ye=0;ye<fe.length-1;ye++){if(Dc(H,fe[ye],fe[ye+1]))return W;(le=fe[ye])[1]>(te=H)[1]!=(he=fe[ye+1])[1]>te[1]&&te[0]<(he[0]-le[0])*(te[1]-le[1])/(he[1]-le[1])+le[0]&&(X=!X)}var te,le,he;return X}function wu(H,h){for(const W of h)if(Za(H,W))return!0;return!1}function yl(H,h){for(const W of H)if(!Za(W,h))return!1;for(let W=0;W<H.length-1;++W)if(Fc(H[W],H[W+1],h))return!1;return!0}function Su(H,h){for(const W of h)if(yl(H,W))return!0;return!1}function Eu(H,h,W,X){const te=X[0]-W[0],le=X[1]-W[1],he=(H[0]-W[0])*le-te*(H[1]-W[1]),fe=(h[0]-W[0])*le-te*(h[1]-W[1]);return he>0&&fe<0||he<0&&fe>0}function gl(H,h,W){const X=[];for(let te=0;te<H.length;te++){const le=[];for(let he=0;he<H[te].length;he++){const fe=xu(H[te][he],W);Ha(h,fe),le.push(fe)}X.push(le)}return X}function qu(H,h,W){const X=[];for(let te=0;te<H.length;te++){const le=gl(H[te],h,W);X.push(le)}return X}function Tu(H,h,W,X){if(H[0]<W[0]||H[0]>W[2]){const te=.5*X;let le=H[0]-W[0]>te?-X:W[0]-H[0]>te?X:0;le===0&&(le=H[0]-W[2]>te?-X:W[2]-H[0]>te?X:0),H[0]+=le}Ha(h,H)}function Io(H,h,W,X){const te=Math.pow(2,X.z)*Fn,le=[X.x*Fn,X.y*Fn],he=[];for(const fe of H)for(const ye of fe){const be=[ye.x+le[0],ye.y+le[1]];Tu(be,h,W,te),he.push(be)}return he}function Iu(H,h,W,X){const te=Math.pow(2,X.z)*Fn,le=[X.x*Fn,X.y*Fn],he=[];for(const ye of H){const be=[];for(const Ee of ye){const Pe=[Ee.x+le[0],Ee.y+le[1]];Ha(h,Pe),be.push(Pe)}he.push(be)}if(h[2]-h[0]<=te/2){(fe=h)[0]=fe[1]=1/0,fe[2]=fe[3]=-1/0;for(const ye of he)for(const be of ye)Tu(be,h,W,te)}var fe;return he}class xa{constructor(h,W){this.type=Gr,this.geojson=h,this.geometries=W}static parse(h,W){if(h.length!==2)return W.error(`'within' expression requires exactly one argument, but found ${h.length-1} instead.`);if(pi(h[1])){const X=h[1];if(X.type==="FeatureCollection"){const te=[];for(const le of X.features){const{type:he,coordinates:fe}=le.geometry;he==="Polygon"&&te.push(fe),he==="MultiPolygon"&&te.push(...fe)}if(te.length)return new xa(X,{type:"MultiPolygon",coordinates:te})}else if(X.type==="Feature"){const te=X.geometry.type;if(te==="Polygon"||te==="MultiPolygon")return new xa(X,X.geometry)}else if(X.type==="Polygon"||X.type==="MultiPolygon")return new xa(X,X)}return W.error("'within' expression requires valid geojson object that contains polygon geometry type.")}evaluate(h){if(h.geometry()!=null&&h.canonicalID()!=null){if(h.geometryType()==="Point")return(function(W,X){const te=[1/0,1/0,-1/0,-1/0],le=[1/0,1/0,-1/0,-1/0],he=W.canonicalID();if(X.type==="Polygon"){const fe=gl(X.coordinates,le,he),ye=Io(W.geometry(),te,le,he);if(!To(te,le))return!1;for(const be of ye)if(!Za(be,fe))return!1}if(X.type==="MultiPolygon"){const fe=qu(X.coordinates,le,he),ye=Io(W.geometry(),te,le,he);if(!To(te,le))return!1;for(const be of ye)if(!wu(be,fe))return!1}return!0})(h,this.geometries);if(h.geometryType()==="LineString")return(function(W,X){const te=[1/0,1/0,-1/0,-1/0],le=[1/0,1/0,-1/0,-1/0],he=W.canonicalID();if(X.type==="Polygon"){const fe=gl(X.coordinates,le,he),ye=Iu(W.geometry(),te,le,he);if(!To(te,le))return!1;for(const be of ye)if(!yl(be,fe))return!1}if(X.type==="MultiPolygon"){const fe=qu(X.coordinates,le,he),ye=Iu(W.geometry(),te,le,he);if(!To(te,le))return!1;for(const be of ye)if(!Su(be,fe))return!1}return!0})(h,this.geometries)}return!1}eachChild(){}outputDefined(){return!0}}let Ru=class{constructor(H=[],h=(W,X)=>W<X?-1:W>X?1:0){if(this.data=H,this.length=this.data.length,this.compare=h,this.length>0)for(let W=(this.length>>1)-1;W>=0;W--)this._down(W)}push(H){this.data.push(H),this._up(this.length++)}pop(){if(this.length===0)return;const H=this.data[0],h=this.data.pop();return--this.length>0&&(this.data[0]=h,this._down(0)),H}peek(){return this.data[0]}_up(H){const{data:h,compare:W}=this,X=h[H];for(;H>0;){const te=H-1>>1,le=h[te];if(W(X,le)>=0)break;h[H]=le,H=te}h[H]=X}_down(H){const{data:h,compare:W}=this,X=this.length>>1,te=h[H];for(;H<X;){let le=1+(H<<1);const he=le+1;if(he<this.length&&W(h[he],h[le])<0&&(le=he),W(h[le],te)>=0)break;h[H]=h[le],H=le}h[H]=te}};function Au(H,h,W=0,X=H.length-1,te=Pu){for(;X>W;){if(X-W>600){const ye=X-W+1,be=h-W+1,Ee=Math.log(ye),Pe=.5*Math.exp(2*Ee/3),Ne=.5*Math.sqrt(Ee*Pe*(ye-Pe)/ye)*(be-ye/2<0?-1:1);Au(H,h,Math.max(W,Math.floor(h-be*Pe/ye+Ne)),Math.min(X,Math.floor(h+(ye-be)*Pe/ye+Ne)),te)}const le=H[h];let he=W,fe=X;for(wa(H,W,h),te(H[X],le)>0&&wa(H,W,X);he<fe;){for(wa(H,he,fe),he++,fe--;te(H[he],le)<0;)he++;for(;te(H[fe],le)>0;)fe--}te(H[W],le)===0?wa(H,W,fe):(fe++,wa(H,fe,X)),fe<=h&&(W=fe+1),h<=fe&&(X=fe-1)}}function wa(H,h,W){const X=H[h];H[h]=H[W],H[W]=X}function Pu(H,h){return H<h?-1:H>h?1:0}function us(H,h){if(H.length<=1)return[H];const W=[];let X,te;for(const le of H){const he=Ou(le);he!==0&&(le.area=Math.abs(he),te===void 0&&(te=he<0),te===he<0?(X&&W.push(X),X=[le]):X.push(le))}if(X&&W.push(X),h>1)for(let le=0;le<W.length;le++)W[le].length<=h||(Au(W[le],h,1,W[le].length-1,kc),W[le]=W[le].slice(0,h));return W}function kc(H,h){return h.area-H.area}function Ou(H){let h=0;for(let W,X,te=0,le=H.length,he=le-1;te<le;he=te++)W=H[te],X=H[he],h+=(X.x-W.x)*(W.y+X.y);return h}const vl=1/298.257223563,Cu=vl*(2-vl),Mu=Math.PI/180;class bl{constructor(h){const W=6378.137*Mu*1e3,X=Math.cos(h*Mu),te=1/(1-Cu*(1-X*X)),le=Math.sqrt(te);this.kx=W*le*X,this.ky=W*le*te*(1-Cu)}distance(h,W){const X=this.wrap(h[0]-W[0])*this.kx,te=(h[1]-W[1])*this.ky;return Math.sqrt(X*X+te*te)}pointOnLine(h,W){let X,te,le,he,fe=1/0;for(let ye=0;ye<h.length-1;ye++){let be=h[ye][0],Ee=h[ye][1],Pe=this.wrap(h[ye+1][0]-be)*this.kx,Ne=(h[ye+1][1]-Ee)*this.ky,Ue=0;Pe===0&&Ne===0||(Ue=(this.wrap(W[0]-be)*this.kx*Pe+(W[1]-Ee)*this.ky*Ne)/(Pe*Pe+Ne*Ne),Ue>1?(be=h[ye+1][0],Ee=h[ye+1][1]):Ue>0&&(be+=Pe/this.kx*Ue,Ee+=Ne/this.ky*Ue)),Pe=this.wrap(W[0]-be)*this.kx,Ne=(W[1]-Ee)*this.ky;const $e=Pe*Pe+Ne*Ne;$e<fe&&(fe=$e,X=be,te=Ee,le=ye,he=Ue)}return{point:[X,te],index:le,t:Math.max(0,Math.min(1,he))}}wrap(h){for(;h<-180;)h+=360;for(;h>180;)h-=360;return h}}function xl(H,h){return h[0]-H[0]}function cs(H){return H[1]-H[0]+1}function Yn(H,h){return H[1]>=H[0]&&H[1]<h}function wl(H,h){if(H[0]>H[1])return[null,null];const W=cs(H);if(h){if(W===2)return[H,null];const te=Math.floor(W/2);return[[H[0],H[0]+te],[H[0]+te,H[1]]]}if(W===1)return[H,null];const X=Math.floor(W/2)-1;return[[H[0],H[0]+X],[H[0]+X+1,H[1]]]}function Sl(H,h){if(!Yn(h,H.length))return[1/0,1/0,-1/0,-1/0];const W=[1/0,1/0,-1/0,-1/0];for(let X=h[0];X<=h[1];++X)Ha(W,H[X]);return W}function ci(H){const h=[1/0,1/0,-1/0,-1/0];for(const W of H)for(const X of W)Ha(h,X);return h}function Du(H){return H[0]!==-1/0&&H[1]!==-1/0&&H[2]!==1/0&&H[3]!==1/0}function El(H,h,W){if(!Du(H)||!Du(h))return NaN;let X=0,te=0;return H[2]<h[0]&&(X=h[0]-H[2]),H[0]>h[2]&&(X=H[0]-h[2]),H[1]>h[3]&&(te=H[1]-h[3]),H[3]<h[1]&&(te=h[1]-H[3]),W.distance([0,0],[X,te])}function Sa(H,h,W){const X=W.pointOnLine(h,H);return W.distance(H,X.point)}function ql(H,h,W,X,te){const le=Math.min(Sa(H,[W,X],te),Sa(h,[W,X],te)),he=Math.min(Sa(W,[H,h],te),Sa(X,[H,h],te));return Math.min(le,he)}function Lc(H,h,W,X,te){if(!Yn(h,H.length)||!Yn(X,W.length))return 1/0;let le=1/0;for(let he=h[0];he<h[1];++he){const fe=H[he],ye=H[he+1];for(let be=X[0];be<X[1];++be){const Ee=W[be],Pe=W[be+1];if(ls(fe,ye,Ee,Pe))return 0;le=Math.min(le,ql(fe,ye,Ee,Pe,te))}}return le}function Bc(H,h,W,X,te){if(!Yn(h,H.length)||!Yn(X,W.length))return NaN;let le=1/0;for(let he=h[0];he<=h[1];++he)for(let fe=X[0];fe<=X[1];++fe)if(le=Math.min(le,te.distance(H[he],W[fe])),le===0)return le;return le}function Nc(H,h,W){if(Za(H,h,!0))return 0;let X=1/0;for(const te of h){const le=te[0],he=te[te.length-1];if(le!==he&&(X=Math.min(X,Sa(H,[he,le],W)),X===0))return X;const fe=W.pointOnLine(te,H);if(X=Math.min(X,W.distance(H,fe.point)),X===0)return X}return X}function jc(H,h,W,X){if(!Yn(h,H.length))return NaN;for(let le=h[0];le<=h[1];++le)if(Za(H[le],W,!0))return 0;let te=1/0;for(let le=h[0];le<h[1];++le){const he=H[le],fe=H[le+1];for(const ye of W)for(let be=0,Ee=ye.length,Pe=Ee-1;be<Ee;Pe=be++){const Ne=ye[Pe],Ue=ye[be];if(ls(he,fe,Ne,Ue))return 0;te=Math.min(te,ql(he,fe,Ne,Ue,X))}}return te}function Fu(H,h){for(const W of H)for(const X of W)if(Za(X,h,!0))return!0;return!1}function zc(H,h,W,X=1/0){const te=ci(H),le=ci(h);if(X!==1/0&&El(te,le,W)>=X)return X;if(To(te,le)){if(Fu(H,h))return 0}else if(Fu(h,H))return 0;let he=1/0;for(const fe of H)for(let ye=0,be=fe.length,Ee=be-1;ye<be;Ee=ye++){const Pe=fe[Ee],Ne=fe[ye];for(const Ue of h)for(let $e=0,Ye=Ue.length,rt=Ye-1;$e<Ye;rt=$e++){const dt=Ue[rt],Ct=Ue[$e];if(ls(Pe,Ne,dt,Ct))return 0;he=Math.min(he,ql(Pe,Ne,dt,Ct,W))}}return he}function ku(H,h,W,X,te,le){if(!le)return;const he=El(Sl(X,le),te,W);he<h&&H.push([he,le,[0,0]])}function hs(H,h,W,X,te,le,he){if(!le||!he)return;const fe=El(Sl(X,le),Sl(te,he),W);fe<h&&H.push([fe,le,he])}function ds(H,h,W,X,te=1/0){let le=Math.min(X.distance(H[0],W[0][0]),te);if(le===0)return le;const he=new Ru([[0,[0,H.length-1],[0,0]]],xl),fe=ci(W);for(;he.length>0;){const ye=he.pop();if(ye[0]>=le)continue;const be=ye[1],Ee=h?50:100;if(cs(be)<=Ee){if(!Yn(be,H.length))return NaN;if(h){const Pe=jc(H,be,W,X);if(isNaN(Pe)||Pe===0)return Pe;le=Math.min(le,Pe)}else for(let Pe=be[0];Pe<=be[1];++Pe){const Ne=Nc(H[Pe],W,X);if(le=Math.min(le,Ne),le===0)return 0}}else{const Pe=wl(be,h);ku(he,le,X,H,fe,Pe[0]),ku(he,le,X,H,fe,Pe[1])}}return le}function fs(H,h,W,X,te,le=1/0){let he=Math.min(le,te.distance(H[0],W[0]));if(he===0)return he;const fe=new Ru([[0,[0,H.length-1],[0,W.length-1]]],xl);for(;fe.length>0;){const ye=fe.pop();if(ye[0]>=he)continue;const be=ye[1],Ee=ye[2],Pe=h?50:100,Ne=X?50:100;if(cs(be)<=Pe&&cs(Ee)<=Ne){if(!Yn(be,H.length)&&Yn(Ee,W.length))return NaN;let Ue;if(h&&X)Ue=Lc(H,be,W,Ee,te),he=Math.min(he,Ue);else if(h&&!X){const $e=H.slice(be[0],be[1]+1);for(let Ye=Ee[0];Ye<=Ee[1];++Ye)if(Ue=Sa(W[Ye],$e,te),he=Math.min(he,Ue),he===0)return he}else if(!h&&X){const $e=W.slice(Ee[0],Ee[1]+1);for(let Ye=be[0];Ye<=be[1];++Ye)if(Ue=Sa(H[Ye],$e,te),he=Math.min(he,Ue),he===0)return he}else Ue=Bc(H,be,W,Ee,te),he=Math.min(he,Ue)}else{const Ue=wl(be,h),$e=wl(Ee,X);hs(fe,he,te,H,W,Ue[0],$e[0]),hs(fe,he,te,H,W,Ue[0],$e[1]),hs(fe,he,te,H,W,Ue[1],$e[0]),hs(fe,he,te,H,W,Ue[1],$e[1])}}return he}function Tl(H){return H.type==="MultiPolygon"?H.coordinates.map((h=>({type:"Polygon",coordinates:h}))):H.type==="MultiLineString"?H.coordinates.map((h=>({type:"LineString",coordinates:h}))):H.type==="MultiPoint"?H.coordinates.map((h=>({type:"Point",coordinates:h}))):[H]}class Ea{constructor(h,W){this.type=ir,this.geojson=h,this.geometries=W}static parse(h,W){if(h.length!==2)return W.error(`'distance' expression requires exactly one argument, but found ${h.length-1} instead.`);if(pi(h[1])){const X=h[1];if(X.type==="FeatureCollection")return new Ea(X,X.features.map((te=>Tl(te.geometry))).flat());if(X.type==="Feature")return new Ea(X,Tl(X.geometry));if("type"in X&&"coordinates"in X)return new Ea(X,Tl(X))}return W.error("'distance' expression requires valid geojson object that contains polygon geometry type.")}evaluate(h){if(h.geometry()!=null&&h.canonicalID()!=null){if(h.geometryType()==="Point")return(function(W,X){const te=W.geometry(),le=te.flat().map((ye=>ml([ye.x,ye.y],W.canonical)));if(te.length===0)return NaN;const he=new bl(le[0][1]);let fe=1/0;for(const ye of X){switch(ye.type){case"Point":fe=Math.min(fe,fs(le,!1,[ye.coordinates],!1,he,fe));break;case"LineString":fe=Math.min(fe,fs(le,!1,ye.coordinates,!0,he,fe));break;case"Polygon":fe=Math.min(fe,ds(le,!1,ye.coordinates,he,fe))}if(fe===0)return fe}return fe})(h,this.geometries);if(h.geometryType()==="LineString")return(function(W,X){const te=W.geometry(),le=te.flat().map((ye=>ml([ye.x,ye.y],W.canonical)));if(te.length===0)return NaN;const he=new bl(le[0][1]);let fe=1/0;for(const ye of X){switch(ye.type){case"Point":fe=Math.min(fe,fs(le,!0,[ye.coordinates],!1,he,fe));break;case"LineString":fe=Math.min(fe,fs(le,!0,ye.coordinates,!0,he,fe));break;case"Polygon":fe=Math.min(fe,ds(le,!0,ye.coordinates,he,fe))}if(fe===0)return fe}return fe})(h,this.geometries);if(h.geometryType()==="Polygon")return(function(W,X){const te=W.geometry();if(te.length===0||te[0].length===0)return NaN;const le=us(te,0).map((ye=>ye.map((be=>be.map((Ee=>ml([Ee.x,Ee.y],W.canonical))))))),he=new bl(le[0][0][0][1]);let fe=1/0;for(const ye of X)for(const be of le){switch(ye.type){case"Point":fe=Math.min(fe,ds([ye.coordinates],!1,be,he,fe));break;case"LineString":fe=Math.min(fe,ds(ye.coordinates,!0,be,he,fe));break;case"Polygon":fe=Math.min(fe,zc(be,ye.coordinates,he,fe))}if(fe===0)return fe}return fe})(h,this.geometries)}return NaN}eachChild(){}outputDefined(){return!0}}class Ro{constructor(h){this.type=Pt,this.key=h}static parse(h,W){if(h.length!==2)return W.error(`Expected 1 argument, but found ${h.length-1} instead.`);const X=h[1];return X==null?W.error("Global state property must be defined."):typeof X!="string"?W.error(`Global state property must be string, but found ${typeof h[1]} instead.`):new Ro(X)}evaluate(h){var W;const X=(W=h.globals)===null||W===void 0?void 0:W.globalState;return X&&Object.keys(X).length!==0?_o(X,this.key):null}eachChild(){}outputDefined(){return!1}}const Ka={"==":Dn,"!=":bu,">":Cc,"<":as,">=":Mc,"<=":fl,array:Xr,at:hl,boolean:Xr,case:Wi,coalesce:ns,collator:os,format:ss,image:Wa,in:ts,"index-of":So,interpolate:zi,"interpolate-hcl":zi,"interpolate-lab":zi,length:_l,let:Ga,literal:$r,match:Wn,number:Xr,"number-format":pl,object:Xr,slice:ba,step:aa,string:Xr,"to-boolean":sn,"to-color":sn,"to-number":sn,"to-string":sn,var:wo,within:xa,distance:Ea,"global-state":Ro};class Pn{constructor(h,W,X,te){this.name=h,this.type=W,this._evaluate=X,this.args=te}evaluate(h){return this._evaluate(h,this.args)}eachChild(h){this.args.forEach(h)}outputDefined(){return!1}static parse(h,W){const X=h[0],te=Pn.definitions[X];if(!te)return W.error(`Unknown expression "${X}". If you wanted a literal array, use ["literal", [...]].`,0);const le=Array.isArray(te)?te[0]:te.type,he=Array.isArray(te)?[[te[1],te[2]]]:te.overloads,fe=he.filter((([be])=>!Array.isArray(be)||be.length===h.length-1));let ye=null;for(const[be,Ee]of fe){ye=new xo(W.registry,ps,W.path,null,W.scope);const Pe=[];let Ne=!1;for(let Ue=1;Ue<h.length;Ue++){const $e=h[Ue],Ye=Array.isArray(be)?be[Ue-1]:be.type,rt=ye.parse($e,1+Pe.length,Ye);if(!rt){Ne=!0;break}Pe.push(rt)}if(!Ne)if(Array.isArray(be)&&be.length!==Pe.length)ye.error(`Expected ${be.length} arguments, but found ${Pe.length} instead.`);else{for(let Ue=0;Ue<Pe.length;Ue++){const $e=Array.isArray(be)?be[Ue]:be.type,Ye=Pe[Ue];ye.concat(Ue+1).checkSubtype($e,Ye.type)}if(ye.errors.length===0)return new Pn(X,le,Ee,Pe)}}if(fe.length===1)W.errors.push(...ye.errors);else{const be=(fe.length?fe:he).map((([Pe])=>{return Ne=Pe,Array.isArray(Ne)?`(${Ne.map(Kr).join(", ")})`:`(${Kr(Ne.type)}...)`;var Ne})).join(" | "),Ee=[];for(let Pe=1;Pe<h.length;Pe++){const Ne=W.parse(h[Pe],1+Ee.length);if(!Ne)return null;Ee.push(Kr(Ne.type))}W.error(`Expected arguments of type ${be}, but found (${Ee.join(", ")}) instead.`)}return null}static register(h,W){Pn.definitions=W;for(const X in W)h[X]=Pn}}function Lu(H,[h,W,X,te]){h=h.evaluate(H),W=W.evaluate(H),X=X.evaluate(H);const le=te?te.evaluate(H):1,he=vo(h,W,X,le);if(he)throw new xi(he);return new Qr(h/255,W/255,X/255,le,!1)}function Bu(H,h){return H in h}function Il(H,h){const W=h[H];return W===void 0?null:W}function qa(H){return{type:H}}function ps(H){if(H instanceof wo)return ps(H.boundExpression);if(H instanceof Pn&&H.name==="error"||H instanceof os||H instanceof xa||H instanceof Ea||H instanceof Ro)return!1;const h=H instanceof sn||H instanceof Xr;let W=!0;return H.eachChild((X=>{W=h?W&&ps(X):W&&X instanceof $r})),!!W&&_s(H)&&ys(H,["zoom","heatmap-density","elevation","line-progress","accumulated","is-supported-script"])}function _s(H){if(H instanceof Pn&&(H.name==="get"&&H.args.length===1||H.name==="feature-state"||H.name==="has"&&H.args.length===1||H.name==="properties"||H.name==="geometry-type"||H.name==="id"||/^filter-/.test(H.name))||H instanceof xa||H instanceof Ea)return!1;let h=!0;return H.eachChild((W=>{h&&!_s(W)&&(h=!1)})),h}function Ao(H){if(H instanceof Pn&&H.name==="feature-state")return!1;let h=!0;return H.eachChild((W=>{h&&!Ao(W)&&(h=!1)})),h}function ys(H,h){if(H instanceof Pn&&h.indexOf(H.name)>=0)return!1;let W=!0;return H.eachChild((X=>{W&&!ys(X,h)&&(W=!1)})),W}function Nu(H){return{result:"success",value:H}}function Xa(H){return{result:"error",value:H}}function Ya(H){return H["property-type"]==="data-driven"||H["property-type"]==="cross-faded-data-driven"}function ju(H){return!!H.expression&&H.expression.parameters.indexOf("zoom")>-1}function Po(H){return!!H.expression&&H.expression.interpolated}function ei(H){return H instanceof Number?"number":H instanceof String?"string":H instanceof Boolean?"boolean":Array.isArray(H)?"array":H===null?"null":typeof H}function gs(H){return typeof H=="object"&&H!==null&&!Array.isArray(H)&&Oi(H)===Vt}function Uc(H){return H}function Rl(H,h){const W=H.stops&&typeof H.stops[0][0]=="object",X=W||!(W||H.property!==void 0),te=H.type||(Po(h)?"exponential":"interval"),le=(function(Ee){switch(Ee.type){case"color":return Qr.parse;case"padding":return en.parse;case"numberArray":return $i.parse;case"colorArray":return tn.parse;default:return null}})(h);if(le&&((H=Ti({},H)).stops&&(H.stops=H.stops.map((Ee=>[Ee[0],le(Ee[1])]))),H.default=le(H.default?H.default:h.default)),H.colorSpace&&(he=H.colorSpace)!=="rgb"&&he!=="hcl"&&he!=="lab")throw new Error(`Unknown color space: "${H.colorSpace}"`);var he;const fe=(function(Ee){switch(Ee){case"exponential":return Al;case"interval":return vs;case"categorical":return Vc;case"identity":return Gc;default:throw new Error(`Unknown function type "${Ee}"`)}})(te);let ye,be;if(te==="categorical"){ye=Object.create(null);for(const Ee of H.stops)ye[Ee[0]]=Ee[1];be=typeof H.stops[0][0]}if(W){const Ee={},Pe=[];for(let $e=0;$e<H.stops.length;$e++){const Ye=H.stops[$e],rt=Ye[0].zoom;Ee[rt]===void 0&&(Ee[rt]={zoom:rt,type:H.type,property:H.property,default:H.default,stops:[]},Pe.push(rt)),Ee[rt].stops.push([Ye[0].value,Ye[1]])}const Ne=[];for(const $e of Pe)Ne.push([Ee[$e].zoom,Rl(Ee[$e],h)]);const Ue={name:"linear"};return{kind:"composite",interpolationType:Ue,interpolationFactor:zi.interpolationFactor.bind(void 0,Ue),zoomStops:Ne.map(($e=>$e[0])),evaluate:({zoom:$e},Ye)=>Al({stops:Ne,base:H.base},h,$e).evaluate($e,Ye)}}if(X){const Ee=te==="exponential"?{name:"exponential",base:H.base!==void 0?H.base:1}:null;return{kind:"camera",interpolationType:Ee,interpolationFactor:zi.interpolationFactor.bind(void 0,Ee),zoomStops:H.stops.map((Pe=>Pe[0])),evaluate:({zoom:Pe})=>fe(H,h,Pe,ye,be)}}return{kind:"source",evaluate(Ee,Pe){const Ne=Pe&&Pe.properties?Pe.properties[H.property]:void 0;return Ne===void 0?Oo(H.default,h.default):fe(H,h,Ne,ye,be)}}}function Oo(H,h,W){return H!==void 0?H:h!==void 0?h:W!==void 0?W:void 0}function Vc(H,h,W,X,te){return Oo(typeof W===te?X[W]:void 0,H.default,h.default)}function vs(H,h,W){if(ei(W)!=="number")return Oo(H.default,h.default);const X=H.stops.length;if(X===1||W<=H.stops[0][0])return H.stops[0][1];if(W>=H.stops[X-1][0])return H.stops[X-1][1];const te=Eo(H.stops.map((le=>le[0])),W);return H.stops[te][1]}function Al(H,h,W){const X=H.base!==void 0?H.base:1;if(ei(W)!=="number")return Oo(H.default,h.default);const te=H.stops.length;if(te===1||W<=H.stops[0][0])return H.stops[0][1];if(W>=H.stops[te-1][0])return H.stops[te-1][1];const le=Eo(H.stops.map((Ee=>Ee[0])),W),he=(function(Ee,Pe,Ne,Ue){const $e=Ue-Ne,Ye=Ee-Ne;return $e===0?0:Pe===1?Ye/$e:(Math.pow(Pe,Ye)-1)/(Math.pow(Pe,$e)-1)})(W,X,H.stops[le][0],H.stops[le+1][0]),fe=H.stops[le][1],ye=H.stops[le+1][1],be=An[h.type]||Uc;return typeof fe.evaluate=="function"?{evaluate(...Ee){const Pe=fe.evaluate.apply(void 0,Ee),Ne=ye.evaluate.apply(void 0,Ee);if(Pe!==void 0&&Ne!==void 0)return be(Pe,Ne,he,H.colorSpace)}}:be(fe,ye,he,H.colorSpace)}function Gc(H,h,W){switch(h.type){case"color":W=Qr.parse(W);break;case"formatted":W=yn.fromString(W.toString());break;case"resolvedImage":W=wn.fromString(W.toString());break;case"padding":W=en.parse(W);break;case"colorArray":W=tn.parse(W);break;case"numberArray":W=$i.parse(W);break;default:ei(W)===h.type||h.type==="enum"&&h.values[W]||(W=void 0)}return Oo(W,H.default,h.default)}Pn.register(Ka,{error:[{kind:"error"},[Zr],(H,[h])=>{throw new xi(h.evaluate(H))}],typeof:[Zr,[Pt],(H,[h])=>Kr(Oi(h.evaluate(H)))],"to-rgba":[rr(ir,4),[jt],(H,[h])=>{const[W,X,te,le]=h.evaluate(H).rgb;return[255*W,255*X,255*te,le]}],rgb:[jt,[ir,ir,ir],Lu],rgba:[jt,[ir,ir,ir,ir],Lu],has:{type:Gr,overloads:[[[Zr],(H,[h])=>Bu(h.evaluate(H),H.properties())],[[Zr,Vt],(H,[h,W])=>Bu(h.evaluate(H),W.evaluate(H))]]},get:{type:Pt,overloads:[[[Zr],(H,[h])=>Il(h.evaluate(H),H.properties())],[[Zr,Vt],(H,[h,W])=>Il(h.evaluate(H),W.evaluate(H))]]},"feature-state":[Pt,[Zr],(H,[h])=>Il(h.evaluate(H),H.featureState||{})],properties:[Vt,[],H=>H.properties()],"geometry-type":[Zr,[],H=>H.geometryType()],id:[Pt,[],H=>H.id()],zoom:[ir,[],H=>H.globals.zoom],"heatmap-density":[ir,[],H=>H.globals.heatmapDensity||0],elevation:[ir,[],H=>H.globals.elevation||0],"line-progress":[ir,[],H=>H.globals.lineProgress||0],accumulated:[Pt,[],H=>H.globals.accumulated===void 0?null:H.globals.accumulated],"+":[ir,qa(ir),(H,h)=>{let W=0;for(const X of h)W+=X.evaluate(H);return W}],"*":[ir,qa(ir),(H,h)=>{let W=1;for(const X of h)W*=X.evaluate(H);return W}],"-":{type:ir,overloads:[[[ir,ir],(H,[h,W])=>h.evaluate(H)-W.evaluate(H)],[[ir],(H,[h])=>-h.evaluate(H)]]},"/":[ir,[ir,ir],(H,[h,W])=>h.evaluate(H)/W.evaluate(H)],"%":[ir,[ir,ir],(H,[h,W])=>h.evaluate(H)%W.evaluate(H)],ln2:[ir,[],()=>Math.LN2],pi:[ir,[],()=>Math.PI],e:[ir,[],()=>Math.E],"^":[ir,[ir,ir],(H,[h,W])=>Math.pow(h.evaluate(H),W.evaluate(H))],sqrt:[ir,[ir],(H,[h])=>Math.sqrt(h.evaluate(H))],log10:[ir,[ir],(H,[h])=>Math.log(h.evaluate(H))/Math.LN10],ln:[ir,[ir],(H,[h])=>Math.log(h.evaluate(H))],log2:[ir,[ir],(H,[h])=>Math.log(h.evaluate(H))/Math.LN2],sin:[ir,[ir],(H,[h])=>Math.sin(h.evaluate(H))],cos:[ir,[ir],(H,[h])=>Math.cos(h.evaluate(H))],tan:[ir,[ir],(H,[h])=>Math.tan(h.evaluate(H))],asin:[ir,[ir],(H,[h])=>Math.asin(h.evaluate(H))],acos:[ir,[ir],(H,[h])=>Math.acos(h.evaluate(H))],atan:[ir,[ir],(H,[h])=>Math.atan(h.evaluate(H))],min:[ir,qa(ir),(H,h)=>Math.min(...h.map((W=>W.evaluate(H))))],max:[ir,qa(ir),(H,h)=>Math.max(...h.map((W=>W.evaluate(H))))],abs:[ir,[ir],(H,[h])=>Math.abs(h.evaluate(H))],round:[ir,[ir],(H,[h])=>{const W=h.evaluate(H);return W<0?-Math.round(-W):Math.round(W)}],floor:[ir,[ir],(H,[h])=>Math.floor(h.evaluate(H))],ceil:[ir,[ir],(H,[h])=>Math.ceil(h.evaluate(H))],"filter-==":[Gr,[Zr,Pt],(H,[h,W])=>H.properties()[h.value]===W.value],"filter-id-==":[Gr,[Pt],(H,[h])=>H.id()===h.value],"filter-type-==":[Gr,[Zr],(H,[h])=>H.geometryType()===h.value],"filter-<":[Gr,[Zr,Pt],(H,[h,W])=>{const X=H.properties()[h.value],te=W.value;return typeof X==typeof te&&X<te}],"filter-id-<":[Gr,[Pt],(H,[h])=>{const W=H.id(),X=h.value;return typeof W==typeof X&&W<X}],"filter->":[Gr,[Zr,Pt],(H,[h,W])=>{const X=H.properties()[h.value],te=W.value;return typeof X==typeof te&&X>te}],"filter-id->":[Gr,[Pt],(H,[h])=>{const W=H.id(),X=h.value;return typeof W==typeof X&&W>X}],"filter-<=":[Gr,[Zr,Pt],(H,[h,W])=>{const X=H.properties()[h.value],te=W.value;return typeof X==typeof te&&X<=te}],"filter-id-<=":[Gr,[Pt],(H,[h])=>{const W=H.id(),X=h.value;return typeof W==typeof X&&W<=X}],"filter->=":[Gr,[Zr,Pt],(H,[h,W])=>{const X=H.properties()[h.value],te=W.value;return typeof X==typeof te&&X>=te}],"filter-id->=":[Gr,[Pt],(H,[h])=>{const W=H.id(),X=h.value;return typeof W==typeof X&&W>=X}],"filter-has":[Gr,[Pt],(H,[h])=>h.value in H.properties()],"filter-has-id":[Gr,[],H=>H.id()!==null&&H.id()!==void 0],"filter-type-in":[Gr,[rr(Zr)],(H,[h])=>h.value.indexOf(H.geometryType())>=0],"filter-id-in":[Gr,[rr(Pt)],(H,[h])=>h.value.indexOf(H.id())>=0],"filter-in-small":[Gr,[Zr,rr(Pt)],(H,[h,W])=>W.value.indexOf(H.properties()[h.value])>=0],"filter-in-large":[Gr,[Zr,rr(Pt)],(H,[h,W])=>(function(X,te,le,he){for(;le<=he;){const fe=le+he>>1;if(te[fe]===X)return!0;te[fe]>X?he=fe-1:le=fe+1}return!1})(H.properties()[h.value],W.value,0,W.value.length-1)],all:{type:Gr,overloads:[[[Gr,Gr],(H,[h,W])=>h.evaluate(H)&&W.evaluate(H)],[qa(Gr),(H,h)=>{for(const W of h)if(!W.evaluate(H))return!1;return!0}]]},any:{type:Gr,overloads:[[[Gr,Gr],(H,[h,W])=>h.evaluate(H)||W.evaluate(H)],[qa(Gr),(H,h)=>{for(const W of h)if(W.evaluate(H))return!0;return!1}]]},"!":[Gr,[Gr],(H,[h])=>!h.evaluate(H)],"is-supported-script":[Gr,[Zr],(H,[h])=>{const W=H.globals&&H.globals.isSupportedScript;return!W||W(h.evaluate(H))}],upcase:[Zr,[Zr],(H,[h])=>h.evaluate(H).toUpperCase()],downcase:[Zr,[Zr],(H,[h])=>h.evaluate(H).toLowerCase()],concat:[Zr,qa(Pt),(H,h)=>h.map((W=>ni(W.evaluate(H)))).join("")],"resolved-locale":[Zr,[Qt],(H,[h])=>h.evaluate(H).resolvedLocale()]});class Pl{constructor(h,W,X){this.expression=h,this._warningHistory={},this._evaluator=new bo,this._defaultValue=W?(function(te){if(te.type==="color"&&gs(te.default))return new Qr(0,0,0,0);switch(te.type){case"color":return Qr.parse(te.default)||null;case"padding":return en.parse(te.default)||null;case"numberArray":return $i.parse(te.default)||null;case"colorArray":return tn.parse(te.default)||null;case"variableAnchorOffsetCollection":return fn.parse(te.default)||null;case"projectionDefinition":return gn.parse(te.default)||null;default:return te.default===void 0?null:te.default}})(W):null,this._enumValues=W&&W.type==="enum"?W.values:null,this._globalState=X}evaluateWithoutErrorHandling(h,W,X,te,le,he){return this._globalState&&(h=Ta(h,this._globalState)),this._evaluator.globals=h,this._evaluator.feature=W,this._evaluator.featureState=X,this._evaluator.canonical=te,this._evaluator.availableImages=le||null,this._evaluator.formattedSection=he,this.expression.evaluate(this._evaluator)}evaluate(h,W,X,te,le,he){this._globalState&&(h=Ta(h,this._globalState)),this._evaluator.globals=h,this._evaluator.feature=W||null,this._evaluator.featureState=X||null,this._evaluator.canonical=te,this._evaluator.availableImages=le||null,this._evaluator.formattedSection=he||null;try{const fe=this.expression.evaluate(this._evaluator);if(fe==null||typeof fe=="number"&&fe!=fe)return this._defaultValue;if(this._enumValues&&!(fe in this._enumValues))throw new xi(`Expected value to be one of ${Object.keys(this._enumValues).map((ye=>JSON.stringify(ye))).join(", ")}, but found ${JSON.stringify(fe)} instead.`);return fe}catch(fe){return this._warningHistory[fe.message]||(this._warningHistory[fe.message]=!0,typeof console<"u"&&console.warn(fe.message)),this._defaultValue}}}function bs(H){return Array.isArray(H)&&H.length>0&&typeof H[0]=="string"&&H[0]in Ka}function xs(H,h,W){const X=new xo(Ka,ps,[],h?(function(le){const he={color:jt,string:Zr,number:ir,enum:Zr,boolean:Gr,formatted:Ur,padding:Rr,numberArray:fi,colorArray:yi,projectionDefinition:tr,resolvedImage:Si,variableAnchorOffsetCollection:ui};return le.type==="array"?rr(he[le.value]||Pt,le.length):he[le.type]})(h):void 0),te=X.parse(H,void 0,void 0,void 0,h&&h.type==="string"?{typeAnnotation:"coerce"}:void 0);return te?Nu(new Pl(te,h,W)):Xa(X.errors)}class ws{constructor(h,W,X){this.kind=h,this._styleExpression=W,this.isStateDependent=h!=="constant"&&!Ao(W.expression),this.globalStateRefs=Co(W.expression),this._globalState=X}evaluateWithoutErrorHandling(h,W,X,te,le,he){return this._globalState&&(h=Ta(h,this._globalState)),this._styleExpression.evaluateWithoutErrorHandling(h,W,X,te,le,he)}evaluate(h,W,X,te,le,he){return this._globalState&&(h=Ta(h,this._globalState)),this._styleExpression.evaluate(h,W,X,te,le,he)}}class Ss{constructor(h,W,X,te,le){this.kind=h,this.zoomStops=X,this._styleExpression=W,this.isStateDependent=h!=="camera"&&!Ao(W.expression),this.globalStateRefs=Co(W.expression),this.interpolationType=te,this._globalState=le}evaluateWithoutErrorHandling(h,W,X,te,le,he){return this._globalState&&(h=Ta(h,this._globalState)),this._styleExpression.evaluateWithoutErrorHandling(h,W,X,te,le,he)}evaluate(h,W,X,te,le,he){return this._globalState&&(h=Ta(h,this._globalState)),this._styleExpression.evaluate(h,W,X,te,le,he)}interpolationFactor(h,W,X){return this.interpolationType?zi.interpolationFactor(this.interpolationType,h,W,X):0}}function Ol(H,h,W){const X=xs(H,h,W);if(X.result==="error")return X;const te=X.value.expression,le=_s(te);if(!le&&!Ya(h))return Xa([new Ni("","data expressions not supported")]);const he=ys(te,["zoom"]);if(!he&&!ju(h))return Xa([new Ni("","zoom expressions not supported")]);const fe=qs(te);return fe||he?fe instanceof Ni?Xa([fe]):fe instanceof zi&&!Po(h)?Xa([new Ni("",'"interpolate" expressions cannot be used with this property')]):Nu(fe?new Ss(le?"camera":"composite",X.value,fe.labels,fe instanceof zi?fe.interpolation:void 0,W):new ws(le?"constant":"source",X.value,W)):Xa([new Ni("",'"zoom" expression may only be used as input to a top-level "step" or "interpolate" expression.')])}class Es{constructor(h,W){this._parameters=h,this._specification=W,Ti(this,Rl(this._parameters,this._specification))}static deserialize(h){return new Es(h._parameters,h._specification)}static serialize(h){return{_parameters:h._parameters,_specification:h._specification}}}function qs(H){let h=null;if(H instanceof Ga)h=qs(H.result);else if(H instanceof ns){for(const W of H.args)if(h=qs(W),h)break}else(H instanceof aa||H instanceof zi)&&H.input instanceof Pn&&H.input.name==="zoom"&&(h=H);return h instanceof Ni||H.eachChild((W=>{const X=qs(W);X instanceof Ni?h=X:!h&&X?h=new Ni("",'"zoom" expression may only be used as input to a top-level "step" or "interpolate" expression.'):h&&X&&h!==X&&(h=new Ni("",'Only one zoom-based "step" or "interpolate" subexpression may be used in an expression.'))})),h}function Co(H,h=new Set){return H instanceof Ro&&h.add(H.key),H.eachChild((W=>{Co(W,h)})),h}function Ta(H,h){const{zoom:W,heatmapDensity:X,elevation:te,lineProgress:le,isSupportedScript:he,accumulated:fe}=H??{};return{zoom:W,heatmapDensity:X,elevation:te,lineProgress:le,isSupportedScript:he,accumulated:fe,globalState:h}}function Ts(H){if(H===!0||H===!1)return!0;if(!Array.isArray(H)||H.length===0)return!1;switch(H[0]){case"has":return H.length>=2&&H[1]!=="$id"&&H[1]!=="$type";case"in":return H.length>=3&&(typeof H[1]!="string"||Array.isArray(H[2]));case"!in":case"!has":case"none":return!1;case"==":case"!=":case">":case">=":case"<":case"<=":return H.length!==3||Array.isArray(H[1])||Array.isArray(H[2]);case"any":case"all":for(const h of H.slice(1))if(!Ts(h)&&typeof h!="boolean")return!1;return!0;default:return!0}}const $c={type:"boolean",default:!1,transition:!1,"property-type":"data-driven",expression:{interpolated:!1,parameters:["zoom","feature"]}};function Mo(H,h){if(H==null)return{filter:()=>!0,needGeometry:!1,getGlobalStateRefs:()=>new Set};Ts(H)||(H=Do(H));const W=xs(H,$c,h);if(W.result==="error")throw new Error(W.value.map((X=>`${X.key}: ${X.message}`)).join(", "));return{filter:(X,te,le)=>W.value.evaluate(X,te,{},le),needGeometry:zu(H),getGlobalStateRefs:()=>Co(W.value.expression)}}function Wc(H,h){return H<h?-1:H>h?1:0}function zu(H){if(!Array.isArray(H))return!1;if(H[0]==="within"||H[0]==="distance")return!0;for(let h=1;h<H.length;h++)if(zu(H[h]))return!0;return!1}function Do(H){if(!H)return!0;const h=H[0];return H.length<=1?h!=="any":h==="=="?Is(H[1],H[2],"=="):h==="!="?Ja(Is(H[1],H[2],"==")):h==="<"||h===">"||h==="<="||h===">="?Is(H[1],H[2],h):h==="any"?(W=H.slice(1),["any"].concat(W.map(Do))):h==="all"?["all"].concat(H.slice(1).map(Do)):h==="none"?["all"].concat(H.slice(1).map(Do).map(Ja)):h==="in"?Rs(H[1],H.slice(2)):h==="!in"?Ja(Rs(H[1],H.slice(2))):h==="has"?As(H[1]):h!=="!has"||Ja(As(H[1]));var W}function Is(H,h,W){switch(H){case"$type":return[`filter-type-${W}`,h];case"$id":return[`filter-id-${W}`,h];default:return[`filter-${W}`,H,h]}}function Rs(H,h){if(h.length===0)return!1;switch(H){case"$type":return["filter-type-in",["literal",h]];case"$id":return["filter-id-in",["literal",h]];default:return h.length>200&&!h.some((W=>typeof W!=typeof h[0]))?["filter-in-large",H,["literal",h.sort(Wc)]]:["filter-in-small",H,["literal",h]]}}function As(H){switch(H){case"$type":return!0;case"$id":return["filter-has-id"];default:return["filter-has",H]}}function Ja(H){return["!",H]}function Fo(H){const h=typeof H;if(h==="number"||h==="boolean"||h==="string"||H==null)return JSON.stringify(H);if(Array.isArray(H)){let te="[";for(const le of H)te+=`${Fo(le)},`;return`${te}]`}const W=Object.keys(H).sort();let X="{";for(let te=0;te<W.length;te++)X+=`${JSON.stringify(W[te])}:${Fo(H[W[te]])},`;return`${X}}`}function Ps(H){let h="";for(const W of Er)h+=`/${Fo(H[W])}`;return h}function Uu(H){const h=H.value;return h?[new Ht(H.key,h,"constants have been deprecated as of v8")]:[]}function Mi(H){return H instanceof Number||H instanceof String||H instanceof Boolean?H.valueOf():H}function Ia(H){if(Array.isArray(H))return H.map(Ia);if(H instanceof Object&&!(H instanceof Number||H instanceof String||H instanceof Boolean)){const h={};for(const W in H)h[W]=Ia(H[W]);return h}return Mi(H)}function On(H){const h=H.key,W=H.value,X=H.valueSpec||{},te=H.objectElementValidators||{},le=H.style,he=H.styleSpec,fe=H.validateSpec;let ye=[];const be=ei(W);if(be!=="object")return[new Ht(h,W,`object expected, ${be} found`)];for(const Ee in W){const Pe=Ee.split(".")[0],Ne=_o(X,Pe)||X["*"];let Ue;if(_o(te,Pe))Ue=te[Pe];else if(_o(X,Pe))Ue=fe;else if(te["*"])Ue=te["*"];else{if(!X["*"]){ye.push(new Ht(h,W[Ee],`unknown property "${Ee}"`));continue}Ue=fe}ye=ye.concat(Ue({key:(h&&`${h}.`)+Ee,value:W[Ee],valueSpec:Ne,style:le,styleSpec:he,object:W,objectKey:Ee,validateSpec:fe},W))}for(const Ee in X)te[Ee]||X[Ee].required&&X[Ee].default===void 0&&W[Ee]===void 0&&ye.push(new Ht(h,W,`missing required property "${Ee}"`));return ye}function Cl(H){const h=H.value,W=H.valueSpec,X=H.style,te=H.styleSpec,le=H.key,he=H.arrayElementValidator||H.validateSpec;if(ei(h)!=="array")return[new Ht(le,h,`array expected, ${ei(h)} found`)];if(W.length&&h.length!==W.length)return[new Ht(le,h,`array length ${W.length} expected, length ${h.length} found`)];if(W["min-length"]&&h.length<W["min-length"])return[new Ht(le,h,`array length at least ${W["min-length"]} expected, length ${h.length} found`)];let fe={type:W.value,values:W.values};te.$version<7&&(fe.function=W.function),ei(W.value)==="object"&&(fe=W.value);let ye=[];for(let be=0;be<h.length;be++)ye=ye.concat(he({array:h,arrayIndex:be,value:h[be],valueSpec:fe,validateSpec:H.validateSpec,style:X,styleSpec:te,key:`${le}[${be}]`}));return ye}function Os(H){const h=H.key,W=H.value,X=H.valueSpec;let te=ei(W);return te==="number"&&W!=W&&(te="NaN"),te!=="number"?[new Ht(h,W,`number expected, ${te} found`)]:"minimum"in X&&W<X.minimum?[new Ht(h,W,`${W} is less than the minimum value ${X.minimum}`)]:"maximum"in X&&W>X.maximum?[new Ht(h,W,`${W} is greater than the maximum value ${X.maximum}`)]:[]}function Ml(H){const h=H.valueSpec,W=Mi(H.value.type);let X,te,le,he={};const fe=W!=="categorical"&&H.value.property===void 0,ye=!fe,be=ei(H.value.stops)==="array"&&ei(H.value.stops[0])==="array"&&ei(H.value.stops[0][0])==="object",Ee=On({key:H.key,value:H.value,valueSpec:H.styleSpec.function,validateSpec:H.validateSpec,style:H.style,styleSpec:H.styleSpec,objectElementValidators:{stops:function(Ue){if(W==="identity")return[new Ht(Ue.key,Ue.value,'identity function may not have a "stops" property')];let $e=[];const Ye=Ue.value;return $e=$e.concat(Cl({key:Ue.key,value:Ye,valueSpec:Ue.valueSpec,validateSpec:Ue.validateSpec,style:Ue.style,styleSpec:Ue.styleSpec,arrayElementValidator:Pe})),ei(Ye)==="array"&&Ye.length===0&&$e.push(new Ht(Ue.key,Ye,"array must have at least one stop")),$e},default:function(Ue){return Ue.validateSpec({key:Ue.key,value:Ue.value,valueSpec:h,validateSpec:Ue.validateSpec,style:Ue.style,styleSpec:Ue.styleSpec})}}});return W==="identity"&&fe&&Ee.push(new Ht(H.key,H.value,'missing required property "property"')),W==="identity"||H.value.stops||Ee.push(new Ht(H.key,H.value,'missing required property "stops"')),W==="exponential"&&H.valueSpec.expression&&!Po(H.valueSpec)&&Ee.push(new Ht(H.key,H.value,"exponential functions not supported")),H.styleSpec.$version>=8&&(ye&&!Ya(H.valueSpec)?Ee.push(new Ht(H.key,H.value,"property functions not supported")):fe&&!ju(H.valueSpec)&&Ee.push(new Ht(H.key,H.value,"zoom functions not supported"))),W!=="categorical"&&!be||H.value.property!==void 0||Ee.push(new Ht(H.key,H.value,'"property" property is required')),Ee;function Pe(Ue){let $e=[];const Ye=Ue.value,rt=Ue.key;if(ei(Ye)!=="array")return[new Ht(rt,Ye,`array expected, ${ei(Ye)} found`)];if(Ye.length!==2)return[new Ht(rt,Ye,`array length 2 expected, length ${Ye.length} found`)];if(be){if(ei(Ye[0])!=="object")return[new Ht(rt,Ye,`object expected, ${ei(Ye[0])} found`)];if(Ye[0].zoom===void 0)return[new Ht(rt,Ye,"object stop key must have zoom")];if(Ye[0].value===void 0)return[new Ht(rt,Ye,"object stop key must have value")];if(le&&le>Mi(Ye[0].zoom))return[new Ht(rt,Ye[0].zoom,"stop zoom values must appear in ascending order")];Mi(Ye[0].zoom)!==le&&(le=Mi(Ye[0].zoom),te=void 0,he={}),$e=$e.concat(On({key:`${rt}[0]`,value:Ye[0],valueSpec:{zoom:{}},validateSpec:Ue.validateSpec,style:Ue.style,styleSpec:Ue.styleSpec,objectElementValidators:{zoom:Os,value:Ne}}))}else $e=$e.concat(Ne({key:`${rt}[0]`,value:Ye[0],validateSpec:Ue.validateSpec,style:Ue.style,styleSpec:Ue.styleSpec},Ye));return bs(Ia(Ye[1]))?$e.concat([new Ht(`${rt}[1]`,Ye[1],"expressions are not allowed in function stops.")]):$e.concat(Ue.validateSpec({key:`${rt}[1]`,value:Ye[1],valueSpec:h,validateSpec:Ue.validateSpec,style:Ue.style,styleSpec:Ue.styleSpec}))}function Ne(Ue,$e){const Ye=ei(Ue.value),rt=Mi(Ue.value),dt=Ue.value!==null?Ue.value:$e;if(X){if(Ye!==X)return[new Ht(Ue.key,dt,`${Ye} stop domain type must match previous stop domain type ${X}`)]}else X=Ye;if(Ye!=="number"&&Ye!=="string"&&Ye!=="boolean")return[new Ht(Ue.key,dt,"stop domain value must be a number, string, or boolean")];if(Ye!=="number"&&W!=="categorical"){let Ct=`number expected, ${Ye} found`;return Ya(h)&&W===void 0&&(Ct+='\nIf you intended to use a categorical function, specify `"type": "categorical"`.'),[new Ht(Ue.key,dt,Ct)]}return W!=="categorical"||Ye!=="number"||isFinite(rt)&&Math.floor(rt)===rt?W!=="categorical"&&Ye==="number"&&te!==void 0&&rt<te?[new Ht(Ue.key,dt,"stop domain values must appear in ascending order")]:(te=rt,W==="categorical"&&rt in he?[new Ht(Ue.key,dt,"stop domain values must be unique")]:(he[rt]=!0,[])):[new Ht(Ue.key,dt,`integer expected, found ${rt}`)]}}function Ra(H){const h=(H.expressionContext==="property"?Ol:xs)(Ia(H.value),H.valueSpec);if(h.result==="error")return h.value.map((X=>new Ht(`${H.key}${X.key}`,H.value,X.message)));const W=h.value.expression||h.value._styleExpression.expression;if(H.expressionContext==="property"&&H.propertyKey==="text-font"&&!W.outputDefined())return[new Ht(H.key,H.value,`Invalid data expression for "${H.propertyKey}". Output values must be contained as literals within the expression.`)];if(H.expressionContext==="property"&&H.propertyType==="layout"&&!Ao(W))return[new Ht(H.key,H.value,'"feature-state" data expressions are not supported with layout properties.')];if(H.expressionContext==="filter"&&!Ao(W))return[new Ht(H.key,H.value,'"feature-state" data expressions are not supported with filters.')];if(H.expressionContext&&H.expressionContext.indexOf("cluster")===0){if(!ys(W,["zoom","feature-state"]))return[new Ht(H.key,H.value,'"zoom" and "feature-state" expressions are not supported with cluster properties.')];if(H.expressionContext==="cluster-initial"&&!_s(W))return[new Ht(H.key,H.value,"Feature data expressions are not supported with initial expression part of cluster properties.")]}return[]}function Qa(H){const h=H.key,W=H.value,X=ei(W);return X!=="string"?[new Ht(h,W,`color expected, ${X} found`)]:Qr.parse(String(W))?[]:[new Ht(h,W,`color expected, "${W}" found`)]}function ko(H){const h=H.key,W=H.value,X=H.valueSpec,te=[];return Array.isArray(X.values)?X.values.indexOf(Mi(W))===-1&&te.push(new Ht(h,W,`expected one of [${X.values.join(", ")}], ${JSON.stringify(W)} found`)):Object.keys(X.values).indexOf(Mi(W))===-1&&te.push(new Ht(h,W,`expected one of [${Object.keys(X.values).join(", ")}], ${JSON.stringify(W)} found`)),te}function Cs(H){return Ts(Ia(H.value))?Ra(Ti({},H,{expressionContext:"filter",valueSpec:{value:"boolean"}})):Dl(H)}function Dl(H){const h=H.value,W=H.key;if(ei(h)!=="array")return[new Ht(W,h,`array expected, ${ei(h)} found`)];const X=H.styleSpec;let te,le=[];if(h.length<1)return[new Ht(W,h,"filter array must have at least 1 element")];switch(le=le.concat(ko({key:`${W}[0]`,value:h[0],valueSpec:X.filter_operator,style:H.style,styleSpec:H.styleSpec})),Mi(h[0])){case"<":case"<=":case">":case">=":h.length>=2&&Mi(h[1])==="$type"&&le.push(new Ht(W,h,`"$type" cannot be use with operator "${h[0]}"`));case"==":case"!=":h.length!==3&&le.push(new Ht(W,h,`filter array for operator "${h[0]}" must have 3 elements`));case"in":case"!in":h.length>=2&&(te=ei(h[1]),te!=="string"&&le.push(new Ht(`${W}[1]`,h[1],`string expected, ${te} found`)));for(let he=2;he<h.length;he++)te=ei(h[he]),Mi(h[1])==="$type"?le=le.concat(ko({key:`${W}[${he}]`,value:h[he],valueSpec:X.geometry_type,style:H.style,styleSpec:H.styleSpec})):te!=="string"&&te!=="number"&&te!=="boolean"&&le.push(new Ht(`${W}[${he}]`,h[he],`string, number, or boolean expected, ${te} found`));break;case"any":case"all":case"none":for(let he=1;he<h.length;he++)le=le.concat(Dl({key:`${W}[${he}]`,value:h[he],style:H.style,styleSpec:H.styleSpec}));break;case"has":case"!has":te=ei(h[1]),h.length!==2?le.push(new Ht(W,h,`filter array for "${h[0]}" operator must have 2 elements`)):te!=="string"&&le.push(new Ht(`${W}[1]`,h[1],`string expected, ${te} found`))}return le}function Vu(H,h){const W=H.key,X=H.validateSpec,te=H.style,le=H.styleSpec,he=H.value,fe=H.objectKey,ye=le[`${h}_${H.layerType}`];if(!ye)return[];const be=fe.match(/^(.*)-transition$/);if(h==="paint"&&be&&ye[be[1]]&&ye[be[1]].transition)return X({key:W,value:he,valueSpec:le.transition,style:te,styleSpec:le});const Ee=H.valueSpec||ye[fe];if(!Ee)return[new Ht(W,he,`unknown property "${fe}"`)];let Pe;if(ei(he)==="string"&&Ya(Ee)&&!Ee.tokens&&(Pe=/^{([^}]+)}$/.exec(he)))return[new Ht(W,he,`"${fe}" does not support interpolation syntax
Use an identity property function instead: \`{ "type": "identity", "property": ${JSON.stringify(Pe[1])} }\`.`)];const Ne=[];return H.layerType==="symbol"&&(fe==="text-field"&&te&&!te.glyphs&&Ne.push(new Ht(W,he,'use of "text-field" requires a style "glyphs" property')),fe==="text-font"&&gs(Ia(he))&&Mi(he.type)==="identity"&&Ne.push(new Ht(W,he,'"text-font" does not support identity functions'))),Ne.concat(X({key:H.key,value:he,valueSpec:Ee,style:te,styleSpec:le,expressionContext:"property",propertyType:h,propertyKey:fe}))}function Fl(H){return Vu(H,"paint")}function kl(H){return Vu(H,"layout")}function eo(H){let h=[];const W=H.value,X=H.key,te=H.style,le=H.styleSpec;if(ei(W)!=="object")return[new Ht(X,W,`object expected, ${ei(W)} found`)];W.type||W.ref||h.push(new Ht(X,W,'either "type" or "ref" is required'));let he=Mi(W.type);const fe=Mi(W.ref);if(W.id){const ye=Mi(W.id);for(let be=0;be<H.arrayIndex;be++){const Ee=te.layers[be];Mi(Ee.id)===ye&&h.push(new Ht(X,W.id,`duplicate layer id "${W.id}", previously used at line ${Ee.id.__line__}`))}}if("ref"in W){let ye;["type","source","source-layer","filter","layout"].forEach((be=>{be in W&&h.push(new Ht(X,W[be],`"${be}" is prohibited for ref layers`))})),te.layers.forEach((be=>{Mi(be.id)===fe&&(ye=be)})),ye?ye.ref?h.push(new Ht(X,W.ref,"ref cannot reference another ref layer")):he=Mi(ye.type):h.push(new Ht(X,W.ref,`ref layer "${fe}" not found`))}else if(he!=="background")if(W.source){const ye=te.sources&&te.sources[W.source],be=ye&&Mi(ye.type);ye?be==="vector"&&he==="raster"?h.push(new Ht(X,W.source,`layer "${W.id}" requires a raster source`)):be!=="raster-dem"&&he==="hillshade"||be!=="raster-dem"&&he==="color-relief"?h.push(new Ht(X,W.source,`layer "${W.id}" requires a raster-dem source`)):be==="raster"&&he!=="raster"?h.push(new Ht(X,W.source,`layer "${W.id}" requires a vector source`)):be!=="vector"||W["source-layer"]?be==="raster-dem"&&he!=="hillshade"&&he!=="color-relief"?h.push(new Ht(X,W.source,"raster-dem source can only be used with layer type 'hillshade' or 'color-relief'.")):he!=="line"||!W.paint||!W.paint["line-gradient"]||be==="geojson"&&ye.lineMetrics||h.push(new Ht(X,W,`layer "${W.id}" specifies a line-gradient, which requires a GeoJSON source with \`lineMetrics\` enabled.`)):h.push(new Ht(X,W,`layer "${W.id}" must specify a "source-layer"`)):h.push(new Ht(X,W.source,`source "${W.source}" not found`))}else h.push(new Ht(X,W,'missing required property "source"'));return h=h.concat(On({key:X,value:W,valueSpec:le.layer,style:H.style,styleSpec:H.styleSpec,validateSpec:H.validateSpec,objectElementValidators:{"*":()=>[],type:()=>H.validateSpec({key:`${X}.type`,value:W.type,valueSpec:le.layer.type,style:H.style,styleSpec:H.styleSpec,validateSpec:H.validateSpec,object:W,objectKey:"type"}),filter:Cs,layout:ye=>On({layer:W,key:ye.key,value:ye.value,style:ye.style,styleSpec:ye.styleSpec,validateSpec:ye.validateSpec,objectElementValidators:{"*":be=>kl(Ti({layerType:he},be))}}),paint:ye=>On({layer:W,key:ye.key,value:ye.value,style:ye.style,styleSpec:ye.styleSpec,validateSpec:ye.validateSpec,objectElementValidators:{"*":be=>Fl(Ti({layerType:he},be))}})}})),h}function Aa(H){const h=H.value,W=H.key,X=ei(h);return X!=="string"?[new Ht(W,h,`string expected, ${X} found`)]:[]}const Gu={promoteId:function({key:H,value:h}){if(ei(h)==="string")return Aa({key:H,value:h});{const W=[];for(const X in h)W.push(...Aa({key:`${H}.${X}`,value:h[X]}));return W}}};function $u(H){const h=H.value,W=H.key,X=H.styleSpec,te=H.style,le=H.validateSpec;if(!h.type)return[new Ht(W,h,'"type" is required')];const he=Mi(h.type);let fe;switch(he){case"vector":case"raster":return fe=On({key:W,value:h,valueSpec:X[`source_${he.replace("-","_")}`],style:H.style,styleSpec:X,objectElementValidators:Gu,validateSpec:le}),fe;case"raster-dem":return fe=(function(ye){var be;const Ee=(be=ye.sourceName)!==null&&be!==void 0?be:"",Pe=ye.value,Ne=ye.styleSpec,Ue=Ne.source_raster_dem,$e=ye.style;let Ye=[];const rt=ei(Pe);if(Pe===void 0)return Ye;if(rt!=="object")return Ye.push(new Ht("source_raster_dem",Pe,`object expected, ${rt} found`)),Ye;const dt=Mi(Pe.encoding)==="custom",Ct=["redFactor","greenFactor","blueFactor","baseShift"],vt=ye.value.encoding?`"${ye.value.encoding}"`:"Default";for(const qt in Pe)!dt&&Ct.includes(qt)?Ye.push(new Ht(qt,Pe[qt],`In "${Ee}": "${qt}" is only valid when "encoding" is set to "custom". ${vt} encoding found`)):Ue[qt]?Ye=Ye.concat(ye.validateSpec({key:qt,value:Pe[qt],valueSpec:Ue[qt],validateSpec:ye.validateSpec,style:$e,styleSpec:Ne})):Ye.push(new Ht(qt,Pe[qt],`unknown property "${qt}"`));return Ye})({sourceName:W,value:h,style:H.style,styleSpec:X,validateSpec:le}),fe;case"geojson":if(fe=On({key:W,value:h,valueSpec:X.source_geojson,style:te,styleSpec:X,validateSpec:le,objectElementValidators:Gu}),h.cluster)for(const ye in h.clusterProperties){const[be,Ee]=h.clusterProperties[ye],Pe=typeof be=="string"?[be,["accumulated"],["get",ye]]:be;fe.push(...Ra({key:`${W}.${ye}.map`,value:Ee,expressionContext:"cluster-map"})),fe.push(...Ra({key:`${W}.${ye}.reduce`,value:Pe,expressionContext:"cluster-reduce"}))}return fe;case"video":return On({key:W,value:h,valueSpec:X.source_video,style:te,validateSpec:le,styleSpec:X});case"image":return On({key:W,value:h,valueSpec:X.source_image,style:te,validateSpec:le,styleSpec:X});case"canvas":return[new Ht(W,null,"Please use runtime APIs to add canvas sources, rather than including them in stylesheets.","source.canvas")];default:return ko({key:`${W}.type`,value:h.type,valueSpec:{values:["vector","raster","raster-dem","geojson","video","image"]}})}}function Wu(H){const h=H.value,W=H.styleSpec,X=W.light,te=H.style;let le=[];const he=ei(h);if(h===void 0)return le;if(he!=="object")return le=le.concat([new Ht("light",h,`object expected, ${he} found`)]),le;for(const fe in h){const ye=fe.match(/^(.*)-transition$/);le=le.concat(ye&&X[ye[1]]&&X[ye[1]].transition?H.validateSpec({key:fe,value:h[fe],valueSpec:W.transition,validateSpec:H.validateSpec,style:te,styleSpec:W}):X[fe]?H.validateSpec({key:fe,value:h[fe],valueSpec:X[fe],validateSpec:H.validateSpec,style:te,styleSpec:W}):[new Ht(fe,h[fe],`unknown property "${fe}"`)])}return le}function Hu(H){const h=H.value,W=H.styleSpec,X=W.sky,te=H.style,le=ei(h);if(h===void 0)return[];if(le!=="object")return[new Ht("sky",h,`object expected, ${le} found`)];let he=[];for(const fe in h)he=he.concat(X[fe]?H.validateSpec({key:fe,value:h[fe],valueSpec:X[fe],style:te,styleSpec:W}):[new Ht(fe,h[fe],`unknown property "${fe}"`)]);return he}function Zu(H){const h=H.value,W=H.styleSpec,X=W.terrain,te=H.style;let le=[];const he=ei(h);if(h===void 0)return le;if(he!=="object")return le=le.concat([new Ht("terrain",h,`object expected, ${he} found`)]),le;for(const fe in h)le=le.concat(X[fe]?H.validateSpec({key:fe,value:h[fe],valueSpec:X[fe],validateSpec:H.validateSpec,style:te,styleSpec:W}):[new Ht(fe,h[fe],`unknown property "${fe}"`)]);return le}function to(H){let h=[];const W=H.value,X=H.key;if(Array.isArray(W)){const te=[],le=[];for(const he in W)W[he].id&&te.includes(W[he].id)&&h.push(new Ht(X,W,`all the sprites' ids must be unique, but ${W[he].id} is duplicated`)),te.push(W[he].id),W[he].url&&le.includes(W[he].url)&&h.push(new Ht(X,W,`all the sprites' URLs must be unique, but ${W[he].url} is duplicated`)),le.push(W[he].url),h=h.concat(On({key:`${X}[${he}]`,value:W[he],valueSpec:{id:{type:"string",required:!0},url:{type:"string",required:!0}},validateSpec:H.validateSpec}));return h}return Aa({key:X,value:W})}function ro(H){return h=H.value,h&&h.constructor===Object?[]:[new Ht(H.key,H.value,`object expected, ${ei(H.value)} found`)];var h}const vn={"*":()=>[],array:Cl,boolean:function(H){const h=H.value,W=H.key,X=ei(h);return X!=="boolean"?[new Ht(W,h,`boolean expected, ${X} found`)]:[]},number:Os,color:Qa,constants:Uu,enum:ko,filter:Cs,function:Ml,layer:eo,object:On,source:$u,light:Wu,sky:Hu,terrain:Zu,projection:function(H){const h=H.value,W=H.styleSpec,X=W.projection,te=H.style,le=ei(h);if(h===void 0)return[];if(le!=="object")return[new Ht("projection",h,`object expected, ${le} found`)];let he=[];for(const fe in h)he=he.concat(X[fe]?H.validateSpec({key:fe,value:h[fe],valueSpec:X[fe],style:te,styleSpec:W}):[new Ht(fe,h[fe],`unknown property "${fe}"`)]);return he},projectionDefinition:function(H){const h=H.key;let W=H.value;W=W instanceof String?W.valueOf():W;const X=ei(W);return X!=="array"||(function(te){return Array.isArray(te)&&te.length===3&&typeof te[0]=="string"&&typeof te[1]=="string"&&typeof te[2]=="number"})(W)||(function(te){return!!["interpolate","step","literal"].includes(te[0])})(W)?["array","string"].includes(X)?[]:[new Ht(h,W,`projection expected, invalid type "${X}" found`)]:[new Ht(h,W,`projection expected, invalid array ${JSON.stringify(W)} found`)]},string:Aa,formatted:function(H){return Aa(H).length===0?[]:Ra(H)},resolvedImage:function(H){return Aa(H).length===0?[]:Ra(H)},padding:function(H){const h=H.key,W=H.value;if(ei(W)==="array"){if(W.length<1||W.length>4)return[new Ht(h,W,`padding requires 1 to 4 values; ${W.length} values found`)];const X={type:"number"};let te=[];for(let le=0;le<W.length;le++)te=te.concat(H.validateSpec({key:`${h}[${le}]`,value:W[le],validateSpec:H.validateSpec,valueSpec:X}));return te}return Os({key:h,value:W,valueSpec:{}})},numberArray:function(H){const h=H.key,W=H.value;if(ei(W)==="array"){const X={type:"number"};if(W.length<1)return[new Ht(h,W,"array length at least 1 expected, length 0 found")];let te=[];for(let le=0;le<W.length;le++)te=te.concat(H.validateSpec({key:`${h}[${le}]`,value:W[le],validateSpec:H.validateSpec,valueSpec:X}));return te}return Os({key:h,value:W,valueSpec:{}})},colorArray:function(H){const h=H.key,W=H.value;if(ei(W)==="array"){if(W.length<1)return[new Ht(h,W,"array length at least 1 expected, length 0 found")];let X=[];for(let te=0;te<W.length;te++)X=X.concat(Qa({key:`${h}[${te}]`,value:W[te]}));return X}return Qa({key:h,value:W})},variableAnchorOffsetCollection:function(H){const h=H.key,W=H.value,X=ei(W),te=H.styleSpec;if(X!=="array"||W.length<1||W.length%2!=0)return[new Ht(h,W,"variableAnchorOffsetCollection requires a non-empty array of even length")];let le=[];for(let he=0;he<W.length;he+=2)le=le.concat(ko({key:`${h}[${he}]`,value:W[he],valueSpec:te.layout_symbol["text-anchor"]})),le=le.concat(Cl({key:`${h}[${he+1}]`,value:W[he+1],valueSpec:{length:2,value:"number"},validateSpec:H.validateSpec,style:H.style,styleSpec:te}));return le},sprite:to,state:ro};function oa(H){const h=H.value,W=H.valueSpec,X=H.styleSpec;return H.validateSpec=oa,W.expression&&gs(Mi(h))?Ml(H):W.expression&&bs(Ia(h))?Ra(H):W.type&&vn[W.type]?vn[W.type](H):On(Ti({},H,{valueSpec:W.type?X[W.type]:W}))}function Ll(H){const h=H.value,W=H.key,X=Aa(H);return X.length||(h.indexOf("{fontstack}")===-1&&X.push(new Ht(W,h,'"glyphs" url must include a "{fontstack}" token')),h.indexOf("{range}")===-1&&X.push(new Ht(W,h,'"glyphs" url must include a "{range}" token'))),X}function Cn(H,h=Tt){let W=[];return W=W.concat(oa({key:"",value:H,valueSpec:h.$root,styleSpec:h,style:H,validateSpec:oa,objectElementValidators:{glyphs:Ll,"*":()=>[]}})),H.constants&&(W=W.concat(Uu({key:"constants",value:H.constants}))),io(W)}function kn(H){return function(h){return H(Object.assign({},h,{validateSpec:oa}))}}function io(H){return[].concat(H).sort(((h,W)=>h.line-W.line))}function Mn(H){return function(...h){return io(H.apply(this,h))}}Cn.source=Mn(kn($u)),Cn.sprite=Mn(kn(to)),Cn.glyphs=Mn(kn(Ll)),Cn.light=Mn(kn(Wu)),Cn.sky=Mn(kn(Hu)),Cn.terrain=Mn(kn(Zu)),Cn.state=Mn(kn(ro)),Cn.layer=Mn(kn(eo)),Cn.filter=Mn(kn(Cs)),Cn.paintProperty=Mn(kn(Fl)),Cn.layoutProperty=Mn(kn(kl));const sa=Cn,Hc=sa.light,Bl=sa.sky,Zc=sa.paintProperty,Lo=sa.layoutProperty;function Ku(H,h){let W=!1;if(h&&h.length)for(const X of h)H.fire(new Mt(new Error(X.message))),W=!0;return W}class Bo{constructor(h,W,X){const te=this.cells=[];if(h instanceof ArrayBuffer){this.arrayBuffer=h;const he=new Int32Array(this.arrayBuffer);h=he[0],this.d=(W=he[1])+2*(X=he[2]);for(let ye=0;ye<this.d*this.d;ye++){const be=he[3+ye],Ee=he[3+ye+1];te.push(be===Ee?null:he.subarray(be,Ee))}const fe=he[3+te.length+1];this.keys=he.subarray(he[3+te.length],fe),this.bboxes=he.subarray(fe),this.insert=this._insertReadonly}else{this.d=W+2*X;for(let he=0;he<this.d*this.d;he++)te.push([]);this.keys=[],this.bboxes=[]}this.n=W,this.extent=h,this.padding=X,this.scale=W/h,this.uid=0;const le=X/W*h;this.min=-le,this.max=h+le}insert(h,W,X,te,le){this._forEachCell(W,X,te,le,this._insertCell,this.uid++,void 0,void 0),this.keys.push(h),this.bboxes.push(W),this.bboxes.push(X),this.bboxes.push(te),this.bboxes.push(le)}_insertReadonly(){throw new Error("Cannot insert into a GridIndex created from an ArrayBuffer.")}_insertCell(h,W,X,te,le,he){this.cells[le].push(he)}query(h,W,X,te,le){const he=this.min,fe=this.max;if(h<=he&&W<=he&&fe<=X&&fe<=te&&!le)return Array.prototype.slice.call(this.keys);{const ye=[];return this._forEachCell(h,W,X,te,this._queryCell,ye,{},le),ye}}_queryCell(h,W,X,te,le,he,fe,ye){const be=this.cells[le];if(be!==null){const Ee=this.keys,Pe=this.bboxes;for(let Ne=0;Ne<be.length;Ne++){const Ue=be[Ne];if(fe[Ue]===void 0){const $e=4*Ue;(ye?ye(Pe[$e+0],Pe[$e+1],Pe[$e+2],Pe[$e+3]):h<=Pe[$e+2]&&W<=Pe[$e+3]&&X>=Pe[$e+0]&&te>=Pe[$e+1])?(fe[Ue]=!0,he.push(Ee[Ue])):fe[Ue]=!1}}}}_forEachCell(h,W,X,te,le,he,fe,ye){const be=this._convertToCellCoord(h),Ee=this._convertToCellCoord(W),Pe=this._convertToCellCoord(X),Ne=this._convertToCellCoord(te);for(let Ue=be;Ue<=Pe;Ue++)for(let $e=Ee;$e<=Ne;$e++){const Ye=this.d*$e+Ue;if((!ye||ye(this._convertFromCellCoord(Ue),this._convertFromCellCoord($e),this._convertFromCellCoord(Ue+1),this._convertFromCellCoord($e+1)))&&le.call(this,h,W,X,te,Ye,he,fe,ye))return}}_convertFromCellCoord(h){return(h-this.padding)/this.scale}_convertToCellCoord(h){return Math.max(0,Math.min(this.d-1,Math.floor(h*this.scale)+this.padding))}toArrayBuffer(){if(this.arrayBuffer)return this.arrayBuffer;const h=this.cells,W=3+this.cells.length+1+1;let X=0;for(let he=0;he<this.cells.length;he++)X+=this.cells[he].length;const te=new Int32Array(W+X+this.keys.length+this.bboxes.length);te[0]=this.extent,te[1]=this.n,te[2]=this.padding;let le=W;for(let he=0;he<h.length;he++){const fe=h[he];te[3+he]=le,te.set(fe,le),le+=fe.length}return te[3+h.length]=le,te.set(this.keys,le),le+=this.keys.length,te[3+h.length+1]=le,te.set(this.bboxes,le),le+=this.bboxes.length,te.buffer}static serialize(h,W){const X=h.toArrayBuffer();return W&&W.push(X),{buffer:X}}static deserialize(h){return new Bo(h.buffer)}}const Jn={};function vr(H,h,W={}){if(Jn[H])throw new Error(`${H} is already registered.`);Object.defineProperty(h,"_classRegistryKey",{value:H,writeable:!1}),Jn[H]={klass:h,omit:W.omit||[],shallow:W.shallow||[]}}vr("Object",Object),vr("Set",Set),vr("TransferableGridIndex",Bo),vr("Color",Qr),vr("Error",Error),vr("AJAXError",Qe),vr("ResolvedImage",wn),vr("StylePropertyFunction",Es),vr("StyleExpression",Pl,{omit:["_evaluator"]}),vr("ZoomDependentExpression",Ss),vr("ZoomConstantExpression",ws),vr("CompoundExpression",Pn,{omit:["_evaluate"]});for(const H in Ka)Ka[H]._classRegistryKey||vr(`Expression_${H}`,Ka[H]);function Xu(H){return H&&typeof ArrayBuffer<"u"&&(H instanceof ArrayBuffer||H.constructor&&H.constructor.name==="ArrayBuffer")}function Nl(H){return H.$name||H.constructor._classRegistryKey}function No(H){return!(function(h){if(h===null||typeof h!="object")return!1;const W=Nl(h);return!(!W||W==="Object")})(H)&&(H==null||typeof H=="boolean"||typeof H=="number"||typeof H=="string"||H instanceof Boolean||H instanceof Number||H instanceof String||H instanceof Date||H instanceof RegExp||H instanceof Blob||H instanceof Error||Xu(H)||Dr(H)||ArrayBuffer.isView(H)||H instanceof ImageData)}function jo(H,h){if(No(H))return(Xu(H)||Dr(H))&&h&&h.push(H),ArrayBuffer.isView(H)&&h&&h.push(H.buffer),H instanceof ImageData&&h&&h.push(H.data.buffer),H;if(Array.isArray(H)){const le=[];for(const he of H)le.push(jo(he,h));return le}if(typeof H!="object")throw new Error("can't serialize object of type "+typeof H);const W=Nl(H);if(!W)throw new Error(`can't serialize object of unregistered class ${H.constructor.name}`);if(!Jn[W])throw new Error(`${W} is not registered.`);const{klass:X}=Jn[W],te=X.serialize?X.serialize(H,h):{};if(X.serialize){if(h&&te===h[h.length-1])throw new Error("statically serialized object won't survive transfer of $name property")}else{for(const le in H){if(!H.hasOwnProperty(le)||Jn[W].omit.indexOf(le)>=0)continue;const he=H[le];te[le]=Jn[W].shallow.indexOf(le)>=0?he:jo(he,h)}H instanceof Error&&(te.message=H.message)}if(te.$name)throw new Error("$name property is reserved for worker serialization logic.");return W!=="Object"&&(te.$name=W),te}function Pa(H){if(No(H))return H;if(Array.isArray(H))return H.map(Pa);if(typeof H!="object")throw new Error("can't deserialize object of type "+typeof H);const h=Nl(H)||"Object";if(!Jn[h])throw new Error(`can't deserialize unregistered class ${h}`);const{klass:W}=Jn[h];if(!W)throw new Error(`can't deserialize unregistered class ${h}`);if(W.deserialize)return W.deserialize(H);const X=Object.create(W.prototype);for(const te of Object.keys(H)){if(te==="$name")continue;const le=H[te];X[te]=Jn[h].shallow.indexOf(te)>=0?le:Pa(le)}return X}class no{constructor(){this.first=!0}update(h,W){const X=Math.floor(h);return this.first?(this.first=!1,this.lastIntegerZoom=X,this.lastIntegerZoomTime=0,this.lastZoom=h,this.lastFloorZoom=X,!0):(this.lastFloorZoom>X?(this.lastIntegerZoom=X+1,this.lastIntegerZoomTime=W):this.lastFloorZoom<X&&(this.lastIntegerZoom=X,this.lastIntegerZoomTime=W),h!==this.lastZoom&&(this.lastZoom=h,this.lastFloorZoom=X,!0))}}const ti={"Latin-1 Supplement":H=>H>=128&&H<=255,"Hangul Jamo":H=>H>=4352&&H<=4607,Khmer:H=>H>=6016&&H<=6143,"General Punctuation":H=>H>=8192&&H<=8303,"Letterlike Symbols":H=>H>=8448&&H<=8527,"Number Forms":H=>H>=8528&&H<=8591,"Miscellaneous Technical":H=>H>=8960&&H<=9215,"Control Pictures":H=>H>=9216&&H<=9279,"Optical Character Recognition":H=>H>=9280&&H<=9311,"Enclosed Alphanumerics":H=>H>=9312&&H<=9471,"Geometric Shapes":H=>H>=9632&&H<=9727,"Miscellaneous Symbols":H=>H>=9728&&H<=9983,"Miscellaneous Symbols and Arrows":H=>H>=11008&&H<=11263,"Ideographic Description Characters":H=>H>=12272&&H<=12287,"CJK Symbols and Punctuation":H=>H>=12288&&H<=12351,Hiragana:H=>H>=12352&&H<=12447,Katakana:H=>H>=12448&&H<=12543,Kanbun:H=>H>=12688&&H<=12703,"CJK Strokes":H=>H>=12736&&H<=12783,"Enclosed CJK Letters and Months":H=>H>=12800&&H<=13055,"CJK Compatibility":H=>H>=13056&&H<=13311,"Yijing Hexagram Symbols":H=>H>=19904&&H<=19967,"CJK Unified Ideographs":H=>H>=19968&&H<=40959,"Hangul Syllables":H=>H>=44032&&H<=55215,"Private Use Area":H=>H>=57344&&H<=63743,"Vertical Forms":H=>H>=65040&&H<=65055,"CJK Compatibility Forms":H=>H>=65072&&H<=65103,"Small Form Variants":H=>H>=65104&&H<=65135,"Halfwidth and Fullwidth Forms":H=>H>=65280&&H<=65519};function Ms(H){for(const h of H)if(Fs(h.charCodeAt(0)))return!0;return!1}function Yu(H){for(const h of H)if(!Ju(h.charCodeAt(0)))return!1;return!0}function Ds(H){const h=H.map((W=>{try{return new RegExp(`\\p{sc=${W}}`,"u").source}catch{return null}})).filter((W=>W));return new RegExp(h.join("|"),"u")}const jl=Ds(["Arab","Dupl","Mong","Ougr","Syrc"]);function Ju(H){return!jl.test(String.fromCodePoint(H))}const Qu=Ds(["Bopo","Hani","Hira","Kana","Kits","Nshu","Tang","Yiii"]);function Fs(H){return!(H!==746&&H!==747&&(H<4352||!(ti["CJK Compatibility Forms"](H)&&!(H>=65097&&H<=65103)||ti["CJK Compatibility"](H)||ti["CJK Strokes"](H)||!(!ti["CJK Symbols and Punctuation"](H)||H>=12296&&H<=12305||H>=12308&&H<=12319||H===12336)||ti["Enclosed CJK Letters and Months"](H)||ti["Ideographic Description Characters"](H)||ti.Kanbun(H)||ti.Katakana(H)&&H!==12540||!(!ti["Halfwidth and Fullwidth Forms"](H)||H===65288||H===65289||H===65293||H>=65306&&H<=65310||H===65339||H===65341||H===65343||H>=65371&&H<=65503||H===65507||H>=65512&&H<=65519)||!(!ti["Small Form Variants"](H)||H>=65112&&H<=65118||H>=65123&&H<=65126)||ti["Vertical Forms"](H)||ti["Yijing Hexagram Symbols"](H)||new RegExp("\\p{sc=Cans}","u").test(String.fromCodePoint(H))||new RegExp("\\p{sc=Hang}","u").test(String.fromCodePoint(H))||Qu.test(String.fromCodePoint(H)))))}function ec(H){return!(Fs(H)||(function(h){return!!(ti["Latin-1 Supplement"](h)&&(h===167||h===169||h===174||h===177||h===188||h===189||h===190||h===215||h===247)||ti["General Punctuation"](h)&&(h===8214||h===8224||h===8225||h===8240||h===8241||h===8251||h===8252||h===8258||h===8263||h===8264||h===8265||h===8273)||ti["Letterlike Symbols"](h)||ti["Number Forms"](h)||ti["Miscellaneous Technical"](h)&&(h>=8960&&h<=8967||h>=8972&&h<=8991||h>=8996&&h<=9e3||h===9003||h>=9085&&h<=9114||h>=9150&&h<=9165||h===9167||h>=9169&&h<=9179||h>=9186&&h<=9215)||ti["Control Pictures"](h)&&h!==9251||ti["Optical Character Recognition"](h)||ti["Enclosed Alphanumerics"](h)||ti["Geometric Shapes"](h)||ti["Miscellaneous Symbols"](h)&&!(h>=9754&&h<=9759)||ti["Miscellaneous Symbols and Arrows"](h)&&(h>=11026&&h<=11055||h>=11088&&h<=11097||h>=11192&&h<=11243)||ti["CJK Symbols and Punctuation"](h)||ti.Katakana(h)||ti["Private Use Area"](h)||ti["CJK Compatibility Forms"](h)||ti["Small Form Variants"](h)||ti["Halfwidth and Fullwidth Forms"](h)||h===8734||h===8756||h===8757||h>=9984&&h<=10087||h>=10102&&h<=10131||h===65532||h===65533)})(H))}const tc=Ds(["Adlm","Arab","Armi","Avst","Chrs","Cprt","Egyp","Elym","Gara","Hatr","Hebr","Hung","Khar","Lydi","Mand","Mani","Mend","Merc","Mero","Narb","Nbat","Nkoo","Orkh","Palm","Phli","Phlp","Phnx","Prti","Rohg","Samr","Sarb","Sogo","Syrc","Thaa","Todr","Yezi"]);function rc(H){return tc.test(String.fromCodePoint(H))}function ic(H,h){return!(!h&&rc(H)||H>=2304&&H<=3583||H>=3840&&H<=4255||ti.Khmer(H))}function nc(H){for(const h of H)if(rc(h.charCodeAt(0)))return!0;return!1}const la=new class{constructor(){this.TIMEOUT=5e3,this.applyArabicShaping=null,this.processBidirectionalText=null,this.processStyledBidirectionalText=null,this.pluginStatus="unavailable",this.pluginURL=null,this.loadScriptResolve=()=>{}}setState(H){this.pluginStatus=H.pluginStatus,this.pluginURL=H.pluginURL}getState(){return{pluginStatus:this.pluginStatus,pluginURL:this.pluginURL}}setMethods(H){if(la.isParsed())throw new Error("RTL text plugin already registered.");this.applyArabicShaping=H.applyArabicShaping,this.processBidirectionalText=H.processBidirectionalText,this.processStyledBidirectionalText=H.processStyledBidirectionalText,this.loadScriptResolve()}isParsed(){return this.applyArabicShaping!=null&&this.processBidirectionalText!=null&&this.processStyledBidirectionalText!=null}getRTLTextPluginStatus(){return this.pluginStatus}syncState(H,h){return R(this,void 0,void 0,(function*(){if(this.isParsed())return this.getState();if(H.pluginStatus!=="loading")return this.setState(H),H;const W=H.pluginURL,X=new Promise((le=>{this.loadScriptResolve=le}));h(W);const te=new Promise((le=>setTimeout((()=>le()),this.TIMEOUT)));if(yield Promise.race([X,te]),this.isParsed()){const le={pluginStatus:"loaded",pluginURL:W};return this.setState(le),le}throw this.setState({pluginStatus:"error",pluginURL:""}),new Error(`RTL Text Plugin failed to import scripts from ${W}`)}))}};class mi{constructor(h,W){this.isSupportedScript=ac,this.zoom=h,W?(this.now=W.now||0,this.fadeDuration=W.fadeDuration||0,this.zoomHistory=W.zoomHistory||new no,this.transition=W.transition||{}):(this.now=0,this.fadeDuration=0,this.zoomHistory=new no,this.transition={})}crossFadingFactor(){return this.fadeDuration===0?1:Math.min((this.now-this.zoomHistory.lastIntegerZoomTime)/this.fadeDuration,1)}getCrossfadeParameters(){const h=this.zoom,W=h-Math.floor(h),X=this.crossFadingFactor();return h>this.zoomHistory.lastIntegerZoom?{fromScale:2,toScale:1,t:W+(1-W)*X}:{fromScale:.5,toScale:1,t:1-(1-X)*W}}}function ac(H){return(function(h,W){for(const X of h)if(!ic(X.charCodeAt(0),W))return!1;return!0})(H,la.getRTLTextPluginStatus()==="loaded")}class zo{constructor(h,W,X){this.property=h,this.value=W,this.expression=(function(te,le,he){if(gs(te))return new Es(te,le);if(bs(te)){const fe=Ol(te,le,he);if(fe.result==="error")throw new Error(fe.value.map((ye=>`${ye.key}: ${ye.message}`)).join(", "));return fe.value}{let fe=te;return le.type==="color"&&typeof te=="string"?fe=Qr.parse(te):le.type!=="padding"||typeof te!="number"&&!Array.isArray(te)?le.type!=="numberArray"||typeof te!="number"&&!Array.isArray(te)?le.type!=="colorArray"||typeof te!="string"&&!Array.isArray(te)?le.type==="variableAnchorOffsetCollection"&&Array.isArray(te)?fe=fn.parse(te):le.type==="projectionDefinition"&&typeof te=="string"&&(fe=gn.parse(te)):fe=tn.parse(te):fe=$i.parse(te):fe=en.parse(te),{globalStateRefs:new Set,_globalState:null,kind:"constant",evaluate:()=>fe}}})(W===void 0?h.specification.default:W,h.specification,X)}isDataDriven(){return this.expression.kind==="source"||this.expression.kind==="composite"}getGlobalStateRefs(){return this.expression.globalStateRefs||new Set}possiblyEvaluate(h,W,X){return this.property.possiblyEvaluate(this,h,W,X)}}class ks{constructor(h,W){this.property=h,this.value=new zo(h,void 0,W)}transitioned(h,W){return new Uo(this.property,this.value,W,Wt({},h.transition,this.transition),h.now)}untransitioned(){return new Uo(this.property,this.value,null,{},0)}}class zl{constructor(h,W){this._properties=h,this._values=Object.create(h.defaultTransitionablePropertyValues),this._globalState=W}getValue(h){return br(this._values[h].value.value)}setValue(h,W){Object.prototype.hasOwnProperty.call(this._values,h)||(this._values[h]=new ks(this._values[h].property,this._globalState)),this._values[h].value=new zo(this._values[h].property,W===null?void 0:br(W),this._globalState)}getTransition(h){return br(this._values[h].transition)}setTransition(h,W){Object.prototype.hasOwnProperty.call(this._values,h)||(this._values[h]=new ks(this._values[h].property,this._globalState)),this._values[h].transition=br(W)||void 0}serialize(){const h={};for(const W of Object.keys(this._values)){const X=this.getValue(W);X!==void 0&&(h[W]=X);const te=this.getTransition(W);te!==void 0&&(h[`${W}-transition`]=te)}return h}transitioned(h,W){const X=new oc(this._properties);for(const te of Object.keys(this._values))X._values[te]=this._values[te].transitioned(h,W._values[te]);return X}untransitioned(){const h=new oc(this._properties);for(const W of Object.keys(this._values))h._values[W]=this._values[W].untransitioned();return h}}class Uo{constructor(h,W,X,te,le){this.property=h,this.value=W,this.begin=le+te.delay||0,this.end=this.begin+te.duration||0,h.specification.transition&&(te.delay||te.duration)&&(this.prior=X)}possiblyEvaluate(h,W,X){const te=h.now||0,le=this.value.possiblyEvaluate(h,W,X),he=this.prior;if(he){if(te>this.end)return this.prior=null,le;if(this.value.isDataDriven())return this.prior=null,le;if(te<this.begin)return he.possiblyEvaluate(h,W,X);{const fe=(te-this.begin)/(this.end-this.begin);return this.property.interpolate(he.possiblyEvaluate(h,W,X),le,Ut(fe))}}return le}}class oc{constructor(h){this._properties=h,this._values=Object.create(h.defaultTransitioningPropertyValues)}possiblyEvaluate(h,W,X){const te=new Ls(this._properties);for(const le of Object.keys(this._values))te._values[le]=this._values[le].possiblyEvaluate(h,W,X);return te}hasTransition(){for(const h of Object.keys(this._values))if(this._values[h].prior)return!0;return!1}}class Ul{constructor(h,W){this._properties=h,this._values=Object.create(h.defaultPropertyValues),this._globalState=W}hasValue(h){return this._values[h].value!==void 0}getValue(h){return br(this._values[h].value)}setValue(h,W){this._values[h]=new zo(this._values[h].property,W===null?void 0:br(W),this._globalState)}serialize(){const h={};for(const W of Object.keys(this._values)){const X=this.getValue(W);X!==void 0&&(h[W]=X)}return h}possiblyEvaluate(h,W,X){const te=new Ls(this._properties);for(const le of Object.keys(this._values))te._values[le]=this._values[le].possiblyEvaluate(h,W,X);return te}}class Hn{constructor(h,W,X){this.property=h,this.value=W,this.parameters=X}isConstant(){return this.value.kind==="constant"}constantOr(h){return this.value.kind==="constant"?this.value.value:h}evaluate(h,W,X,te){return this.property.evaluate(this.value,this.parameters,h,W,X,te)}}class Ls{constructor(h){this._properties=h,this._values=Object.create(h.defaultPossiblyEvaluatedValues)}get(h){return this._values[h]}}class Ar{constructor(h){this.specification=h}possiblyEvaluate(h,W){if(h.isDataDriven())throw new Error("Value should not be data driven");return h.expression.evaluate(W)}interpolate(h,W,X){const te=An[this.specification.type];return te?te(h,W,X):h}}class Br{constructor(h,W){this.specification=h,this.overrides=W}possiblyEvaluate(h,W,X,te){return new Hn(this,h.expression.kind==="constant"||h.expression.kind==="camera"?{kind:"constant",value:h.expression.evaluate(W,null,{},X,te)}:h.expression,W)}interpolate(h,W,X){if(h.value.kind!=="constant"||W.value.kind!=="constant")return h;if(h.value.value===void 0||W.value.value===void 0)return new Hn(this,{kind:"constant",value:void 0},h.parameters);const te=An[this.specification.type];if(te){const le=te(h.value.value,W.value.value,X);return new Hn(this,{kind:"constant",value:le},h.parameters)}return h}evaluate(h,W,X,te,le,he){return h.kind==="constant"?h.value:h.evaluate(W,X,te,le,he)}}class ao extends Br{possiblyEvaluate(h,W,X,te){if(h.value===void 0)return new Hn(this,{kind:"constant",value:void 0},W);if(h.expression.kind==="constant"){const le=h.expression.evaluate(W,null,{},X,te),he=h.property.specification.type==="resolvedImage"&&typeof le!="string"?le.name:le,fe=this._calculate(he,he,he,W);return new Hn(this,{kind:"constant",value:fe},W)}if(h.expression.kind==="camera"){const le=this._calculate(h.expression.evaluate({zoom:W.zoom-1}),h.expression.evaluate({zoom:W.zoom}),h.expression.evaluate({zoom:W.zoom+1}),W);return new Hn(this,{kind:"constant",value:le},W)}return new Hn(this,h.expression,W)}evaluate(h,W,X,te,le,he){if(h.kind==="source"){const fe=h.evaluate(W,X,te,le,he);return this._calculate(fe,fe,fe,W)}return h.kind==="composite"?this._calculate(h.evaluate({zoom:Math.floor(W.zoom)-1},X,te),h.evaluate({zoom:Math.floor(W.zoom)},X,te),h.evaluate({zoom:Math.floor(W.zoom)+1},X,te),W):h.value}_calculate(h,W,X,te){return te.zoom>te.zoomHistory.lastIntegerZoom?{from:h,to:W}:{from:X,to:W}}interpolate(h){return h}}class sc{constructor(h){this.specification=h}possiblyEvaluate(h,W,X,te){if(h.value!==void 0){if(h.expression.kind==="constant"){const le=h.expression.evaluate(W,null,{},X,te);return this._calculate(le,le,le,W)}return this._calculate(h.expression.evaluate(new mi(Math.floor(W.zoom-1),W)),h.expression.evaluate(new mi(Math.floor(W.zoom),W)),h.expression.evaluate(new mi(Math.floor(W.zoom+1),W)),W)}}_calculate(h,W,X,te){return te.zoom>te.zoomHistory.lastIntegerZoom?{from:h,to:W}:{from:X,to:W}}interpolate(h){return h}}class Bs{constructor(h){this.specification=h}possiblyEvaluate(h,W,X,te){return!!h.expression.evaluate(W,null,{},X,te)}interpolate(){return!1}}class pn{constructor(h){this.properties=h,this.defaultPropertyValues={},this.defaultTransitionablePropertyValues={},this.defaultTransitioningPropertyValues={},this.defaultPossiblyEvaluatedValues={},this.overridableProperties=[];for(const W in h){const X=h[W];X.specification.overridable&&this.overridableProperties.push(W);const te=this.defaultPropertyValues[W]=new zo(X,void 0,void 0),le=this.defaultTransitionablePropertyValues[W]=new ks(X,void 0);this.defaultTransitioningPropertyValues[W]=le.untransitioned(),this.defaultPossiblyEvaluatedValues[W]=te.possiblyEvaluate({})}}}vr("DataDrivenProperty",Br),vr("DataConstantProperty",Ar),vr("CrossFadedDataDrivenProperty",ao),vr("CrossFadedProperty",sc),vr("ColorRampProperty",Bs);const lc="-transition";class Ln extends Zt{constructor(h,W,X){if(super(),this.id=h.id,this.type=h.type,this._globalState=X,this._featureFilter={filter:()=>!0,needGeometry:!1,getGlobalStateRefs:()=>new Set},h.type!=="custom"&&(this.metadata=h.metadata,this.minzoom=h.minzoom,this.maxzoom=h.maxzoom,h.type!=="background"&&(this.source=h.source,this.sourceLayer=h["source-layer"],this.filter=h.filter,this._featureFilter=Mo(h.filter,X)),W.layout&&(this._unevaluatedLayout=new Ul(W.layout,X)),W.paint)){this._transitionablePaint=new zl(W.paint,X);for(const te in h.paint)this.setPaintProperty(te,h.paint[te],{validate:!1});for(const te in h.layout)this.setLayoutProperty(te,h.layout[te],{validate:!1});this._transitioningPaint=this._transitionablePaint.untransitioned(),this.paint=new Ls(W.paint)}}setFilter(h){this.filter=h,this._featureFilter=Mo(h,this._globalState)}getCrossfadeParameters(){return this._crossfadeParameters}getLayoutProperty(h){return h==="visibility"?this.visibility:this._unevaluatedLayout.getValue(h)}getLayoutAffectingGlobalStateRefs(){const h=new Set;if(this._unevaluatedLayout)for(const W in this._unevaluatedLayout._values){const X=this._unevaluatedLayout._values[W];for(const te of X.getGlobalStateRefs())h.add(te)}for(const W of this._featureFilter.getGlobalStateRefs())h.add(W);return h}getPaintAffectingGlobalStateRefs(){var h;const W=new globalThis.Map;if(this._transitionablePaint)for(const X in this._transitionablePaint._values){const te=this._transitionablePaint._values[X].value;for(const le of te.getGlobalStateRefs()){const he=(h=W.get(le))!==null&&h!==void 0?h:[];he.push({name:X,value:te.value}),W.set(le,he)}}return W}setLayoutProperty(h,W,X={}){W!=null&&this._validate(Lo,`layers.${this.id}.layout.${h}`,h,W,X)||(h!=="visibility"?this._unevaluatedLayout.setValue(h,W):this.visibility=W)}getPaintProperty(h){return h.endsWith(lc)?this._transitionablePaint.getTransition(h.slice(0,-11)):this._transitionablePaint.getValue(h)}setPaintProperty(h,W,X={}){if(W!=null&&this._validate(Zc,`layers.${this.id}.paint.${h}`,h,W,X))return!1;if(h.endsWith(lc))return this._transitionablePaint.setTransition(h.slice(0,-11),W||void 0),!1;{const te=this._transitionablePaint._values[h],le=te.property.specification["property-type"]==="cross-faded-data-driven",he=te.value.isDataDriven(),fe=te.value;this._transitionablePaint.setValue(h,W),this._handleSpecialPaintPropertyUpdate(h);const ye=this._transitionablePaint._values[h].value;return ye.isDataDriven()||he||le||this._handleOverridablePaintPropertyUpdate(h,fe,ye)}}_handleSpecialPaintPropertyUpdate(h){}_handleOverridablePaintPropertyUpdate(h,W,X){return!1}isHidden(h){return!!(this.minzoom&&h<this.minzoom)||!!(this.maxzoom&&h>=this.maxzoom)||this.visibility==="none"}updateTransitions(h){this._transitioningPaint=this._transitionablePaint.transitioned(h,this._transitioningPaint)}hasTransition(){return this._transitioningPaint.hasTransition()}recalculate(h,W){h.getCrossfadeParameters&&(this._crossfadeParameters=h.getCrossfadeParameters()),this._unevaluatedLayout&&(this.layout=this._unevaluatedLayout.possiblyEvaluate(h,void 0,W)),this.paint=this._transitioningPaint.possiblyEvaluate(h,void 0,W)}serialize(){const h={id:this.id,type:this.type,source:this.source,"source-layer":this.sourceLayer,metadata:this.metadata,minzoom:this.minzoom,maxzoom:this.maxzoom,filter:this.filter,layout:this._unevaluatedLayout&&this._unevaluatedLayout.serialize(),paint:this._transitionablePaint&&this._transitionablePaint.serialize()};return this.visibility&&(h.layout=h.layout||{},h.layout.visibility=this.visibility),Ir(h,((W,X)=>!(W===void 0||X==="layout"&&!Object.keys(W).length||X==="paint"&&!Object.keys(W).length)))}_validate(h,W,X,te,le={}){return(!le||le.validate!==!1)&&Ku(this,h.call(sa,{key:W,layerType:this.type,objectKey:X,value:te,styleSpec:Tt,style:{glyphs:!0,sprite:!0}}))}is3D(){return!1}isTileClipped(){return!1}hasOffscreenPass(){return!1}resize(){}isStateDependent(){for(const h in this.paint._values){const W=this.paint.get(h);if(W instanceof Hn&&Ya(W.property.specification)&&(W.value.kind==="source"||W.value.kind==="composite")&&W.value.isStateDependent)return!0}return!1}}let Oa;var Kc={get paint(){return Oa=Oa||new pn({"raster-opacity":new Ar(Tt.paint_raster["raster-opacity"]),"raster-hue-rotate":new Ar(Tt.paint_raster["raster-hue-rotate"]),"raster-brightness-min":new Ar(Tt.paint_raster["raster-brightness-min"]),"raster-brightness-max":new Ar(Tt.paint_raster["raster-brightness-max"]),"raster-saturation":new Ar(Tt.paint_raster["raster-saturation"]),"raster-contrast":new Ar(Tt.paint_raster["raster-contrast"]),"raster-resampling":new Ar(Tt.paint_raster["raster-resampling"]),"raster-fade-duration":new Ar(Tt.paint_raster["raster-fade-duration"])})}};class Xc extends Ln{constructor(h,W){super(h,Kc,W)}}const Yc={Int8:Int8Array,Uint8:Uint8Array,Int16:Int16Array,Uint16:Uint16Array,Int32:Int32Array,Uint32:Uint32Array,Float32:Float32Array};class oo{constructor(h,W){this._structArray=h,this._pos1=W*this.size,this._pos2=this._pos1/2,this._pos4=this._pos1/4,this._pos8=this._pos1/8}}class Ii{constructor(){this.isTransferred=!1,this.capacity=-1,this.resize(0)}static serialize(h,W){return h._trim(),W&&(h.isTransferred=!0,W.push(h.arrayBuffer)),{length:h.length,arrayBuffer:h.arrayBuffer}}static deserialize(h){const W=Object.create(this.prototype);return W.arrayBuffer=h.arrayBuffer,W.length=h.length,W.capacity=h.arrayBuffer.byteLength/W.bytesPerElement,W._refreshViews(),W}_trim(){this.length!==this.capacity&&(this.capacity=this.length,this.arrayBuffer=this.arrayBuffer.slice(0,this.length*this.bytesPerElement),this._refreshViews())}clear(){this.length=0}resize(h){this.reserve(h),this.length=h}reserve(h){if(h>this.capacity){this.capacity=Math.max(h,Math.floor(5*this.capacity),128),this.arrayBuffer=new ArrayBuffer(this.capacity*this.bytesPerElement);const W=this.uint8;this._refreshViews(),W&&this.uint8.set(W)}}_refreshViews(){throw new Error("_refreshViews() must be implemented by each concrete StructArray layout")}}function Di(H,h=1){let W=0,X=0;return{members:H.map((te=>{const le=Yc[te.type].BYTES_PER_ELEMENT,he=W=ua(W,Math.max(h,le)),fe=te.components||1;return X=Math.max(X,le),W+=le*fe,{name:te.name,type:te.type,components:fe,offset:he}})),size:ua(W,Math.max(X,h)),alignment:h}}function ua(H,h){return Math.ceil(H/h)*h}class so extends Ii{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(h,W){const X=this.length;return this.resize(X+1),this.emplace(X,h,W)}emplace(h,W,X){const te=2*h;return this.int16[te+0]=W,this.int16[te+1]=X,h}}so.prototype.bytesPerElement=4,vr("StructArrayLayout2i4",so);class lo extends Ii{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(h,W,X){const te=this.length;return this.resize(te+1),this.emplace(te,h,W,X)}emplace(h,W,X,te){const le=3*h;return this.int16[le+0]=W,this.int16[le+1]=X,this.int16[le+2]=te,h}}lo.prototype.bytesPerElement=6,vr("StructArrayLayout3i6",lo);class Ns extends Ii{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(h,W,X,te){const le=this.length;return this.resize(le+1),this.emplace(le,h,W,X,te)}emplace(h,W,X,te,le){const he=4*h;return this.int16[he+0]=W,this.int16[he+1]=X,this.int16[he+2]=te,this.int16[he+3]=le,h}}Ns.prototype.bytesPerElement=8,vr("StructArrayLayout4i8",Ns);class Vo extends Ii{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(h,W,X,te,le,he){const fe=this.length;return this.resize(fe+1),this.emplace(fe,h,W,X,te,le,he)}emplace(h,W,X,te,le,he,fe){const ye=6*h;return this.int16[ye+0]=W,this.int16[ye+1]=X,this.int16[ye+2]=te,this.int16[ye+3]=le,this.int16[ye+4]=he,this.int16[ye+5]=fe,h}}Vo.prototype.bytesPerElement=12,vr("StructArrayLayout2i4i12",Vo);class Vl extends Ii{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(h,W,X,te,le,he){const fe=this.length;return this.resize(fe+1),this.emplace(fe,h,W,X,te,le,he)}emplace(h,W,X,te,le,he,fe){const ye=4*h,be=8*h;return this.int16[ye+0]=W,this.int16[ye+1]=X,this.uint8[be+4]=te,this.uint8[be+5]=le,this.uint8[be+6]=he,this.uint8[be+7]=fe,h}}Vl.prototype.bytesPerElement=8,vr("StructArrayLayout2i4ub8",Vl);class ca extends Ii{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(h,W){const X=this.length;return this.resize(X+1),this.emplace(X,h,W)}emplace(h,W,X){const te=2*h;return this.float32[te+0]=W,this.float32[te+1]=X,h}}ca.prototype.bytesPerElement=8,vr("StructArrayLayout2f8",ca);class Ca extends Ii{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(h,W,X,te,le,he,fe,ye,be,Ee){const Pe=this.length;return this.resize(Pe+1),this.emplace(Pe,h,W,X,te,le,he,fe,ye,be,Ee)}emplace(h,W,X,te,le,he,fe,ye,be,Ee,Pe){const Ne=10*h;return this.uint16[Ne+0]=W,this.uint16[Ne+1]=X,this.uint16[Ne+2]=te,this.uint16[Ne+3]=le,this.uint16[Ne+4]=he,this.uint16[Ne+5]=fe,this.uint16[Ne+6]=ye,this.uint16[Ne+7]=be,this.uint16[Ne+8]=Ee,this.uint16[Ne+9]=Pe,h}}Ca.prototype.bytesPerElement=20,vr("StructArrayLayout10ui20",Ca);class Gl extends Ii{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(h,W,X,te,le,he,fe,ye){const be=this.length;return this.resize(be+1),this.emplace(be,h,W,X,te,le,he,fe,ye)}emplace(h,W,X,te,le,he,fe,ye,be){const Ee=8*h;return this.uint16[Ee+0]=W,this.uint16[Ee+1]=X,this.uint16[Ee+2]=te,this.uint16[Ee+3]=le,this.uint16[Ee+4]=he,this.uint16[Ee+5]=fe,this.uint16[Ee+6]=ye,this.uint16[Ee+7]=be,h}}Gl.prototype.bytesPerElement=16,vr("StructArrayLayout8ui16",Gl);class js extends Ii{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(h,W,X,te,le,he,fe,ye,be,Ee,Pe,Ne){const Ue=this.length;return this.resize(Ue+1),this.emplace(Ue,h,W,X,te,le,he,fe,ye,be,Ee,Pe,Ne)}emplace(h,W,X,te,le,he,fe,ye,be,Ee,Pe,Ne,Ue){const $e=12*h;return this.int16[$e+0]=W,this.int16[$e+1]=X,this.int16[$e+2]=te,this.int16[$e+3]=le,this.uint16[$e+4]=he,this.uint16[$e+5]=fe,this.uint16[$e+6]=ye,this.uint16[$e+7]=be,this.int16[$e+8]=Ee,this.int16[$e+9]=Pe,this.int16[$e+10]=Ne,this.int16[$e+11]=Ue,h}}js.prototype.bytesPerElement=24,vr("StructArrayLayout4i4ui4i24",js);class Ma extends Ii{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(h,W,X){const te=this.length;return this.resize(te+1),this.emplace(te,h,W,X)}emplace(h,W,X,te){const le=3*h;return this.float32[le+0]=W,this.float32[le+1]=X,this.float32[le+2]=te,h}}Ma.prototype.bytesPerElement=12,vr("StructArrayLayout3f12",Ma);class $l extends Ii{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer)}emplaceBack(h){const W=this.length;return this.resize(W+1),this.emplace(W,h)}emplace(h,W){return this.uint32[1*h+0]=W,h}}$l.prototype.bytesPerElement=4,vr("StructArrayLayout1ul4",$l);class Wl extends Ii{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(h,W,X,te,le,he,fe,ye,be){const Ee=this.length;return this.resize(Ee+1),this.emplace(Ee,h,W,X,te,le,he,fe,ye,be)}emplace(h,W,X,te,le,he,fe,ye,be,Ee){const Pe=10*h,Ne=5*h;return this.int16[Pe+0]=W,this.int16[Pe+1]=X,this.int16[Pe+2]=te,this.int16[Pe+3]=le,this.int16[Pe+4]=he,this.int16[Pe+5]=fe,this.uint32[Ne+3]=ye,this.uint16[Pe+8]=be,this.uint16[Pe+9]=Ee,h}}Wl.prototype.bytesPerElement=20,vr("StructArrayLayout6i1ul2ui20",Wl);class zs extends Ii{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(h,W,X,te,le,he){const fe=this.length;return this.resize(fe+1),this.emplace(fe,h,W,X,te,le,he)}emplace(h,W,X,te,le,he,fe){const ye=6*h;return this.int16[ye+0]=W,this.int16[ye+1]=X,this.int16[ye+2]=te,this.int16[ye+3]=le,this.int16[ye+4]=he,this.int16[ye+5]=fe,h}}zs.prototype.bytesPerElement=12,vr("StructArrayLayout2i2i2i12",zs);class Hl extends Ii{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(h,W,X,te,le){const he=this.length;return this.resize(he+1),this.emplace(he,h,W,X,te,le)}emplace(h,W,X,te,le,he){const fe=4*h,ye=8*h;return this.float32[fe+0]=W,this.float32[fe+1]=X,this.float32[fe+2]=te,this.int16[ye+6]=le,this.int16[ye+7]=he,h}}Hl.prototype.bytesPerElement=16,vr("StructArrayLayout2f1f2i16",Hl);class se extends Ii{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(h,W,X,te,le,he){const fe=this.length;return this.resize(fe+1),this.emplace(fe,h,W,X,te,le,he)}emplace(h,W,X,te,le,he,fe){const ye=16*h,be=4*h,Ee=8*h;return this.uint8[ye+0]=W,this.uint8[ye+1]=X,this.float32[be+1]=te,this.float32[be+2]=le,this.int16[Ee+6]=he,this.int16[Ee+7]=fe,h}}se.prototype.bytesPerElement=16,vr("StructArrayLayout2ub2f2i16",se);class t extends Ii{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(h,W,X){const te=this.length;return this.resize(te+1),this.emplace(te,h,W,X)}emplace(h,W,X,te){const le=3*h;return this.uint16[le+0]=W,this.uint16[le+1]=X,this.uint16[le+2]=te,h}}t.prototype.bytesPerElement=6,vr("StructArrayLayout3ui6",t);class Z extends Ii{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(h,W,X,te,le,he,fe,ye,be,Ee,Pe,Ne,Ue,$e,Ye,rt,dt){const Ct=this.length;return this.resize(Ct+1),this.emplace(Ct,h,W,X,te,le,he,fe,ye,be,Ee,Pe,Ne,Ue,$e,Ye,rt,dt)}emplace(h,W,X,te,le,he,fe,ye,be,Ee,Pe,Ne,Ue,$e,Ye,rt,dt,Ct){const vt=24*h,qt=12*h,Lt=48*h;return this.int16[vt+0]=W,this.int16[vt+1]=X,this.uint16[vt+2]=te,this.uint16[vt+3]=le,this.uint32[qt+2]=he,this.uint32[qt+3]=fe,this.uint32[qt+4]=ye,this.uint16[vt+10]=be,this.uint16[vt+11]=Ee,this.uint16[vt+12]=Pe,this.float32[qt+7]=Ne,this.float32[qt+8]=Ue,this.uint8[Lt+36]=$e,this.uint8[Lt+37]=Ye,this.uint8[Lt+38]=rt,this.uint32[qt+10]=dt,this.int16[vt+22]=Ct,h}}Z.prototype.bytesPerElement=48,vr("StructArrayLayout2i2ui3ul3ui2f3ub1ul1i48",Z);class Q extends Ii{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(h,W,X,te,le,he,fe,ye,be,Ee,Pe,Ne,Ue,$e,Ye,rt,dt,Ct,vt,qt,Lt,Gt,Xt,_r,lr,fr,Cr,hr){const pr=this.length;return this.resize(pr+1),this.emplace(pr,h,W,X,te,le,he,fe,ye,be,Ee,Pe,Ne,Ue,$e,Ye,rt,dt,Ct,vt,qt,Lt,Gt,Xt,_r,lr,fr,Cr,hr)}emplace(h,W,X,te,le,he,fe,ye,be,Ee,Pe,Ne,Ue,$e,Ye,rt,dt,Ct,vt,qt,Lt,Gt,Xt,_r,lr,fr,Cr,hr,pr){const $t=32*h,zr=16*h;return this.int16[$t+0]=W,this.int16[$t+1]=X,this.int16[$t+2]=te,this.int16[$t+3]=le,this.int16[$t+4]=he,this.int16[$t+5]=fe,this.int16[$t+6]=ye,this.int16[$t+7]=be,this.uint16[$t+8]=Ee,this.uint16[$t+9]=Pe,this.uint16[$t+10]=Ne,this.uint16[$t+11]=Ue,this.uint16[$t+12]=$e,this.uint16[$t+13]=Ye,this.uint16[$t+14]=rt,this.uint16[$t+15]=dt,this.uint16[$t+16]=Ct,this.uint16[$t+17]=vt,this.uint16[$t+18]=qt,this.uint16[$t+19]=Lt,this.uint16[$t+20]=Gt,this.uint16[$t+21]=Xt,this.uint16[$t+22]=_r,this.uint32[zr+12]=lr,this.float32[zr+13]=fr,this.float32[zr+14]=Cr,this.uint16[$t+30]=hr,this.uint16[$t+31]=pr,h}}Q.prototype.bytesPerElement=64,vr("StructArrayLayout8i15ui1ul2f2ui64",Q);class ie extends Ii{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(h){const W=this.length;return this.resize(W+1),this.emplace(W,h)}emplace(h,W){return this.float32[1*h+0]=W,h}}ie.prototype.bytesPerElement=4,vr("StructArrayLayout1f4",ie);class ue extends Ii{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(h,W,X){const te=this.length;return this.resize(te+1),this.emplace(te,h,W,X)}emplace(h,W,X,te){const le=3*h;return this.uint16[6*h+0]=W,this.float32[le+1]=X,this.float32[le+2]=te,h}}ue.prototype.bytesPerElement=12,vr("StructArrayLayout1ui2f12",ue);class de extends Ii{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(h,W,X){const te=this.length;return this.resize(te+1),this.emplace(te,h,W,X)}emplace(h,W,X,te){const le=4*h;return this.uint32[2*h+0]=W,this.uint16[le+2]=X,this.uint16[le+3]=te,h}}de.prototype.bytesPerElement=8,vr("StructArrayLayout1ul2ui8",de);class ge extends Ii{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(h,W){const X=this.length;return this.resize(X+1),this.emplace(X,h,W)}emplace(h,W,X){const te=2*h;return this.uint16[te+0]=W,this.uint16[te+1]=X,h}}ge.prototype.bytesPerElement=4,vr("StructArrayLayout2ui4",ge);class ve extends Ii{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(h){const W=this.length;return this.resize(W+1),this.emplace(W,h)}emplace(h,W){return this.uint16[1*h+0]=W,h}}ve.prototype.bytesPerElement=2,vr("StructArrayLayout1ui2",ve);class qe extends Ii{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(h,W,X,te){const le=this.length;return this.resize(le+1),this.emplace(le,h,W,X,te)}emplace(h,W,X,te,le){const he=4*h;return this.float32[he+0]=W,this.float32[he+1]=X,this.float32[he+2]=te,this.float32[he+3]=le,h}}qe.prototype.bytesPerElement=16,vr("StructArrayLayout4f16",qe);class Re extends oo{get anchorPointX(){return this._structArray.int16[this._pos2+0]}get anchorPointY(){return this._structArray.int16[this._pos2+1]}get x1(){return this._structArray.int16[this._pos2+2]}get y1(){return this._structArray.int16[this._pos2+3]}get x2(){return this._structArray.int16[this._pos2+4]}get y2(){return this._structArray.int16[this._pos2+5]}get featureIndex(){return this._structArray.uint32[this._pos4+3]}get sourceLayerIndex(){return this._structArray.uint16[this._pos2+8]}get bucketIndex(){return this._structArray.uint16[this._pos2+9]}get anchorPoint(){return new U(this.anchorPointX,this.anchorPointY)}}Re.prototype.size=20;class Le extends Wl{get(h){return new Re(this,h)}}vr("CollisionBoxArray",Le);class Fe extends oo{get anchorX(){return this._structArray.int16[this._pos2+0]}get anchorY(){return this._structArray.int16[this._pos2+1]}get glyphStartIndex(){return this._structArray.uint16[this._pos2+2]}get numGlyphs(){return this._structArray.uint16[this._pos2+3]}get vertexStartIndex(){return this._structArray.uint32[this._pos4+2]}get lineStartIndex(){return this._structArray.uint32[this._pos4+3]}get lineLength(){return this._structArray.uint32[this._pos4+4]}get segment(){return this._structArray.uint16[this._pos2+10]}get lowerSize(){return this._structArray.uint16[this._pos2+11]}get upperSize(){return this._structArray.uint16[this._pos2+12]}get lineOffsetX(){return this._structArray.float32[this._pos4+7]}get lineOffsetY(){return this._structArray.float32[this._pos4+8]}get writingMode(){return this._structArray.uint8[this._pos1+36]}get placedOrientation(){return this._structArray.uint8[this._pos1+37]}set placedOrientation(h){this._structArray.uint8[this._pos1+37]=h}get hidden(){return this._structArray.uint8[this._pos1+38]}set hidden(h){this._structArray.uint8[this._pos1+38]=h}get crossTileID(){return this._structArray.uint32[this._pos4+10]}set crossTileID(h){this._structArray.uint32[this._pos4+10]=h}get associatedIconIndex(){return this._structArray.int16[this._pos2+22]}}Fe.prototype.size=48;class Ve extends Z{get(h){return new Fe(this,h)}}vr("PlacedSymbolArray",Ve);class Xe extends oo{get anchorX(){return this._structArray.int16[this._pos2+0]}get anchorY(){return this._structArray.int16[this._pos2+1]}get rightJustifiedTextSymbolIndex(){return this._structArray.int16[this._pos2+2]}get centerJustifiedTextSymbolIndex(){return this._structArray.int16[this._pos2+3]}get leftJustifiedTextSymbolIndex(){return this._structArray.int16[this._pos2+4]}get verticalPlacedTextSymbolIndex(){return this._structArray.int16[this._pos2+5]}get placedIconSymbolIndex(){return this._structArray.int16[this._pos2+6]}get verticalPlacedIconSymbolIndex(){return this._structArray.int16[this._pos2+7]}get key(){return this._structArray.uint16[this._pos2+8]}get textBoxStartIndex(){return this._structArray.uint16[this._pos2+9]}get textBoxEndIndex(){return this._structArray.uint16[this._pos2+10]}get verticalTextBoxStartIndex(){return this._structArray.uint16[this._pos2+11]}get verticalTextBoxEndIndex(){return this._structArray.uint16[this._pos2+12]}get iconBoxStartIndex(){return this._structArray.uint16[this._pos2+13]}get iconBoxEndIndex(){return this._structArray.uint16[this._pos2+14]}get verticalIconBoxStartIndex(){return this._structArray.uint16[this._pos2+15]}get verticalIconBoxEndIndex(){return this._structArray.uint16[this._pos2+16]}get featureIndex(){return this._structArray.uint16[this._pos2+17]}get numHorizontalGlyphVertices(){return this._structArray.uint16[this._pos2+18]}get numVerticalGlyphVertices(){return this._structArray.uint16[this._pos2+19]}get numIconVertices(){return this._structArray.uint16[this._pos2+20]}get numVerticalIconVertices(){return this._structArray.uint16[this._pos2+21]}get useRuntimeCollisionCircles(){return this._structArray.uint16[this._pos2+22]}get crossTileID(){return this._structArray.uint32[this._pos4+12]}set crossTileID(h){this._structArray.uint32[this._pos4+12]=h}get textBoxScale(){return this._structArray.float32[this._pos4+13]}get collisionCircleDiameter(){return this._structArray.float32[this._pos4+14]}get textAnchorOffsetStartIndex(){return this._structArray.uint16[this._pos2+30]}get textAnchorOffsetEndIndex(){return this._structArray.uint16[this._pos2+31]}}Xe.prototype.size=64;class at extends Q{get(h){return new Xe(this,h)}}vr("SymbolInstanceArray",at);class ot extends ie{getoffsetX(h){return this.float32[1*h+0]}}vr("GlyphOffsetArray",ot);class lt extends lo{getx(h){return this.int16[3*h+0]}gety(h){return this.int16[3*h+1]}gettileUnitDistanceFromAnchor(h){return this.int16[3*h+2]}}vr("SymbolLineVertexArray",lt);class pt extends oo{get textAnchor(){return this._structArray.uint16[this._pos2+0]}get textOffset0(){return this._structArray.float32[this._pos4+1]}get textOffset1(){return this._structArray.float32[this._pos4+2]}}pt.prototype.size=12;class yt extends ue{get(h){return new pt(this,h)}}vr("TextAnchorOffsetArray",yt);class mt extends oo{get featureIndex(){return this._structArray.uint32[this._pos4+0]}get sourceLayerIndex(){return this._structArray.uint16[this._pos2+2]}get bucketIndex(){return this._structArray.uint16[this._pos2+3]}}mt.prototype.size=8;class xt extends de{get(h){return new mt(this,h)}}vr("FeatureIndexArray",xt);class It extends so{}class gt extends so{}class Ot extends so{}class zt extends Vo{}class kt extends Vl{}class Bt extends ca{}class Nt extends Ca{}class ar extends Gl{}class sr extends js{}class Kt extends Ma{}class Tr extends $l{}class Wr extends zs{}class hi extends se{}class di extends t{}class _i extends ge{}const Ri=Di([{name:"a_pos",components:2,type:"Int16"}],4),{members:gi}=Ri;class si{constructor(h=[]){this._forceNewSegmentOnNextPrepare=!1,this.segments=h}prepareSegment(h,W,X,te){const le=this.segments[this.segments.length-1];return h>si.MAX_VERTEX_ARRAY_LENGTH&&Mr(`Max vertices per segment is ${si.MAX_VERTEX_ARRAY_LENGTH}: bucket requested ${h}. Consider using the \`fillLargeMeshArrays\` function if you require meshes with more than ${si.MAX_VERTEX_ARRAY_LENGTH} vertices.`),this._forceNewSegmentOnNextPrepare||!le||le.vertexLength+h>si.MAX_VERTEX_ARRAY_LENGTH||le.sortKey!==te?this.createNewSegment(W,X,te):le}createNewSegment(h,W,X){const te={vertexOffset:h.length,primitiveOffset:W.length,vertexLength:0,primitiveLength:0,vaos:{}};return X!==void 0&&(te.sortKey=X),this._forceNewSegmentOnNextPrepare=!1,this.segments.push(te),te}getOrCreateLatestSegment(h,W,X){return this.prepareSegment(0,h,W,X)}forceNewSegmentOnNextPrepare(){this._forceNewSegmentOnNextPrepare=!0}get(){return this.segments}destroy(){for(const h of this.segments)for(const W in h.vaos)h.vaos[W].destroy()}static simpleSegment(h,W,X,te){return new si([{vertexOffset:h,primitiveOffset:W,vertexLength:X,primitiveLength:te,vaos:{},sortKey:0}])}}function Ei(H,h){return 256*(H=ur(Math.floor(H),0,255))+ur(Math.floor(h),0,255)}si.MAX_VERTEX_ARRAY_LENGTH=Math.pow(2,16)-1,vr("SegmentVector",si);const rn=Di([{name:"a_pattern_from",components:4,type:"Uint16"},{name:"a_pattern_to",components:4,type:"Uint16"},{name:"a_pixel_ratio_from",components:1,type:"Uint16"},{name:"a_pixel_ratio_to",components:1,type:"Uint16"}]),ki=Di([{name:"a_dasharray_from",components:4,type:"Uint16"},{name:"a_dasharray_to",components:4,type:"Uint16"}]);var Li,_n,ha,Bn={exports:{}},da={exports:{}},Da={exports:{}},Us=(function(){if(ha)return Bn.exports;ha=1;var H=(Li||(Li=1,da.exports=function(W,X){var te,le,he,fe,ye,be,Ee,Pe;for(le=W.length-(te=3&W.length),he=X,ye=3432918353,be=461845907,Pe=0;Pe<le;)Ee=255&W.charCodeAt(Pe)|(255&W.charCodeAt(++Pe))<<8|(255&W.charCodeAt(++Pe))<<16|(255&W.charCodeAt(++Pe))<<24,++Pe,he=27492+(65535&(fe=5*(65535&(he=(he^=Ee=(65535&(Ee=(Ee=(65535&Ee)*ye+(((Ee>>>16)*ye&65535)<<16)&4294967295)<<15|Ee>>>17))*be+(((Ee>>>16)*be&65535)<<16)&4294967295)<<13|he>>>19))+((5*(he>>>16)&65535)<<16)&4294967295))+((58964+(fe>>>16)&65535)<<16);switch(Ee=0,te){case 3:Ee^=(255&W.charCodeAt(Pe+2))<<16;case 2:Ee^=(255&W.charCodeAt(Pe+1))<<8;case 1:he^=Ee=(65535&(Ee=(Ee=(65535&(Ee^=255&W.charCodeAt(Pe)))*ye+(((Ee>>>16)*ye&65535)<<16)&4294967295)<<15|Ee>>>17))*be+(((Ee>>>16)*be&65535)<<16)&4294967295}return he^=W.length,he=2246822507*(65535&(he^=he>>>16))+((2246822507*(he>>>16)&65535)<<16)&4294967295,he=3266489909*(65535&(he^=he>>>13))+((3266489909*(he>>>16)&65535)<<16)&4294967295,(he^=he>>>16)>>>0}),da.exports),h=(_n||(_n=1,Da.exports=function(W,X){for(var te,le=W.length,he=X^le,fe=0;le>=4;)te=1540483477*(65535&(te=255&W.charCodeAt(fe)|(255&W.charCodeAt(++fe))<<8|(255&W.charCodeAt(++fe))<<16|(255&W.charCodeAt(++fe))<<24))+((1540483477*(te>>>16)&65535)<<16),he=1540483477*(65535&he)+((1540483477*(he>>>16)&65535)<<16)^(te=1540483477*(65535&(te^=te>>>24))+((1540483477*(te>>>16)&65535)<<16)),le-=4,++fe;switch(le){case 3:he^=(255&W.charCodeAt(fe+2))<<16;case 2:he^=(255&W.charCodeAt(fe+1))<<8;case 1:he=1540483477*(65535&(he^=255&W.charCodeAt(fe)))+((1540483477*(he>>>16)&65535)<<16)}return he=1540483477*(65535&(he^=he>>>13))+((1540483477*(he>>>16)&65535)<<16),(he^=he>>>15)>>>0}),Da.exports);return Bn.exports=H,Bn.exports.murmur3=H,Bn.exports.murmur2=h,Bn.exports})(),uo=K(Us);class Qn{constructor(){this.ids=[],this.positions=[],this.indexed=!1}add(h,W,X,te){this.ids.push(Sn(h)),this.positions.push(W,X,te)}getPositions(h){if(!this.indexed)throw new Error("Trying to get index, but feature positions are not indexed");const W=Sn(h);let X=0,te=this.ids.length-1;for(;X<te;){const he=X+te>>1;this.ids[he]>=W?te=he:X=he+1}const le=[];for(;this.ids[X]===W;)le.push({index:this.positions[3*X],start:this.positions[3*X+1],end:this.positions[3*X+2]}),X++;return le}static serialize(h,W){const X=new Float64Array(h.ids),te=new Uint32Array(h.positions);return Zn(X,te,0,X.length-1),W&&W.push(X.buffer,te.buffer),{ids:X,positions:te}}static deserialize(h){const W=new Qn;return W.ids=h.ids,W.positions=h.positions,W.indexed=!0,W}}function Sn(H){const h=+H;return!isNaN(h)&&h<=Number.MAX_SAFE_INTEGER?h:uo(String(H))}function Zn(H,h,W,X){for(;W<X;){const te=H[W+X>>1];let le=W-1,he=X+1;for(;;){do le++;while(H[le]<te);do he--;while(H[he]>te);if(le>=he)break;Kn(H,le,he),Kn(h,3*le,3*he),Kn(h,3*le+1,3*he+1),Kn(h,3*le+2,3*he+2)}he-W<X-he?(Zn(H,h,W,he),W=he+1):(Zn(H,h,he+1,X),X=he)}}function Kn(H,h,W){const X=H[h];H[h]=H[W],H[W]=X}vr("FeaturePositionMap",Qn);class En{constructor(h,W){this.gl=h.gl,this.location=W}}class Fi extends En{constructor(h,W){super(h,W),this.current=0}set(h){this.current!==h&&(this.current=h,this.gl.uniform1f(this.location,h))}}class Ui extends En{constructor(h,W){super(h,W),this.current=[0,0,0,0]}set(h){h[0]===this.current[0]&&h[1]===this.current[1]&&h[2]===this.current[2]&&h[3]===this.current[3]||(this.current=h,this.gl.uniform4f(this.location,h[0],h[1],h[2],h[3]))}}class qn extends En{constructor(h,W){super(h,W),this.current=Qr.transparent}set(h){h.r===this.current.r&&h.g===this.current.g&&h.b===this.current.b&&h.a===this.current.a||(this.current=h,this.gl.uniform4f(this.location,h.r,h.g,h.b,h.a))}}const Zi=new Float32Array(16);function Zl(H){return[Ei(255*H.r,255*H.g),Ei(255*H.b,255*H.a)]}class Go{constructor(h,W,X){this.value=h,this.uniformNames=W.map((te=>`u_${te}`)),this.type=X}setUniform(h,W,X){h.set(X.constantOr(this.value))}getBinding(h,W,X){return this.type==="color"?new qn(h,W):new Fi(h,W)}}class Fa{constructor(h,W){this.uniformNames=W.map((X=>`u_${X}`)),this.patternFrom=null,this.patternTo=null,this.pixelRatioFrom=1,this.pixelRatioTo=1}setConstantPatternPositions(h,W){this.pixelRatioFrom=W.pixelRatio,this.pixelRatioTo=h.pixelRatio,this.patternFrom=W.tlbr,this.patternTo=h.tlbr}setConstantDashPositions(h,W){this.dashTo=[0,h.y,h.height,h.width],this.dashFrom=[0,W.y,W.height,W.width]}setUniform(h,W,X,te){let le=null;te==="u_pattern_to"?le=this.patternTo:te==="u_pattern_from"?le=this.patternFrom:te==="u_dasharray_to"?le=this.dashTo:te==="u_dasharray_from"?le=this.dashFrom:te==="u_pixel_ratio_to"?le=this.pixelRatioTo:te==="u_pixel_ratio_from"&&(le=this.pixelRatioFrom),le!==null&&h.set(le)}getBinding(h,W,X){return X.substr(0,9)==="u_pattern"||X.substr(0,12)==="u_dasharray_"?new Ui(h,W):new Fi(h,W)}}class ea{constructor(h,W,X,te){this.expression=h,this.type=X,this.maxValue=0,this.paintVertexAttributes=W.map((le=>({name:`a_${le}`,type:"Float32",components:X==="color"?2:1,offset:0}))),this.paintVertexArray=new te}populatePaintArray(h,W,X){const te=this.paintVertexArray.length,le=this.expression.evaluate(new mi(0,X),W,{},X.canonical,[],X.formattedSection);this.paintVertexArray.resize(h),this._setPaintValue(te,h,le)}updatePaintArray(h,W,X,te,le){const he=this.expression.evaluate(new mi(0,le),X,te);this._setPaintValue(h,W,he)}_setPaintValue(h,W,X){if(this.type==="color"){const te=Zl(X);for(let le=h;le<W;le++)this.paintVertexArray.emplace(le,te[0],te[1])}else{for(let te=h;te<W;te++)this.paintVertexArray.emplace(te,X);this.maxValue=Math.max(this.maxValue,Math.abs(X))}}upload(h){this.paintVertexArray&&this.paintVertexArray.arrayBuffer&&(this.paintVertexBuffer&&this.paintVertexBuffer.buffer?this.paintVertexBuffer.updateData(this.paintVertexArray):this.paintVertexBuffer=h.createVertexBuffer(this.paintVertexArray,this.paintVertexAttributes,this.expression.isStateDependent))}destroy(){this.paintVertexBuffer&&this.paintVertexBuffer.destroy()}}class Nn{constructor(h,W,X,te,le,he){this.expression=h,this.uniformNames=W.map((fe=>`u_${fe}_t`)),this.type=X,this.useIntegerZoom=te,this.zoom=le,this.maxValue=0,this.paintVertexAttributes=W.map((fe=>({name:`a_${fe}`,type:"Float32",components:X==="color"?4:2,offset:0}))),this.paintVertexArray=new he}populatePaintArray(h,W,X){const te=this.expression.evaluate(new mi(this.zoom,X),W,{},X.canonical,[],X.formattedSection),le=this.expression.evaluate(new mi(this.zoom+1,X),W,{},X.canonical,[],X.formattedSection),he=this.paintVertexArray.length;this.paintVertexArray.resize(h),this._setPaintValue(he,h,te,le)}updatePaintArray(h,W,X,te,le){const he=this.expression.evaluate(new mi(this.zoom,le),X,te),fe=this.expression.evaluate(new mi(this.zoom+1,le),X,te);this._setPaintValue(h,W,he,fe)}_setPaintValue(h,W,X,te){if(this.type==="color"){const le=Zl(X),he=Zl(te);for(let fe=h;fe<W;fe++)this.paintVertexArray.emplace(fe,le[0],le[1],he[0],he[1])}else{for(let le=h;le<W;le++)this.paintVertexArray.emplace(le,X,te);this.maxValue=Math.max(this.maxValue,Math.abs(X),Math.abs(te))}}upload(h){this.paintVertexArray&&this.paintVertexArray.arrayBuffer&&(this.paintVertexBuffer&&this.paintVertexBuffer.buffer?this.paintVertexBuffer.updateData(this.paintVertexArray):this.paintVertexBuffer=h.createVertexBuffer(this.paintVertexArray,this.paintVertexAttributes,this.expression.isStateDependent))}destroy(){this.paintVertexBuffer&&this.paintVertexBuffer.destroy()}setUniform(h,W){const X=this.useIntegerZoom?Math.floor(W.zoom):W.zoom,te=ur(this.expression.interpolationFactor(X,this.zoom,this.zoom+1),0,1);h.set(te)}getBinding(h,W,X){return new Fi(h,W)}}class fa{constructor(h,W,X,te,le,he){this.expression=h,this.type=W,this.useIntegerZoom=X,this.zoom=te,this.layerId=he,this.zoomInPaintVertexArray=new le,this.zoomOutPaintVertexArray=new le}populatePaintArray(h,W,X){const te=this.zoomInPaintVertexArray.length;this.zoomInPaintVertexArray.resize(h),this.zoomOutPaintVertexArray.resize(h),this._setPaintValues(te,h,this.getPositionIds(W),X)}updatePaintArray(h,W,X,te,le){this._setPaintValues(h,W,this.getPositionIds(X),le)}_setPaintValues(h,W,X,te){const le=this.getPositions(te);if(!le||!X)return;const he=le[X.min],fe=le[X.mid],ye=le[X.max];if(he&&fe&&ye)for(let be=h;be<W;be++)this.emplace(this.zoomInPaintVertexArray,be,fe,he),this.emplace(this.zoomOutPaintVertexArray,be,fe,ye)}upload(h){if(this.zoomInPaintVertexArray&&this.zoomInPaintVertexArray.arrayBuffer&&this.zoomOutPaintVertexArray&&this.zoomOutPaintVertexArray.arrayBuffer){const W=this.getVertexAttributes();this.zoomInPaintVertexBuffer=h.createVertexBuffer(this.zoomInPaintVertexArray,W,this.expression.isStateDependent),this.zoomOutPaintVertexBuffer=h.createVertexBuffer(this.zoomOutPaintVertexArray,W,this.expression.isStateDependent)}}destroy(){this.zoomOutPaintVertexBuffer&&this.zoomOutPaintVertexBuffer.destroy(),this.zoomInPaintVertexBuffer&&this.zoomInPaintVertexBuffer.destroy()}}class pa extends fa{getPositions(h){return h.imagePositions}getPositionIds(h){return h.patterns&&h.patterns[this.layerId]}getVertexAttributes(){return rn.members}emplace(h,W,X,te){h.emplace(W,X.tlbr[0],X.tlbr[1],X.tlbr[2],X.tlbr[3],te.tlbr[0],te.tlbr[1],te.tlbr[2],te.tlbr[3],X.pixelRatio,te.pixelRatio)}}class Kl extends fa{getPositions(h){return h.dashPositions}getPositionIds(h){return h.dashes&&h.dashes[this.layerId]}getVertexAttributes(){return ki.members}emplace(h,W,X,te){h.emplace(W,0,X.y,X.height,X.width,0,te.y,te.height,te.width)}}class Xl{constructor(h,W,X){this.binders={},this._buffers=[];const te=[];for(const le in h.paint._values){if(!X(le))continue;const he=h.paint.get(le);if(!(he instanceof Hn&&Ya(he.property.specification)))continue;const fe=Yl(le,h.type),ye=he.value,be=he.property.specification.type,Ee=he.property.useIntegerZoom,Pe=he.property.specification["property-type"],Ne=Pe==="cross-faded"||Pe==="cross-faded-data-driven";if(ye.kind==="constant")this.binders[le]=Ne?new Fa(ye.value,fe):new Go(ye.value,fe,be),te.push(`/u_${le}`);else if(ye.kind==="source"||Ne){const Ue=Jl(le,be,"source");this.binders[le]=Ne?le==="line-dasharray"?new Kl(ye,be,Ee,W,Ue,h.id):new pa(ye,be,Ee,W,Ue,h.id):new ea(ye,fe,be,Ue),te.push(`/a_${le}`)}else{const Ue=Jl(le,be,"composite");this.binders[le]=new Nn(ye,fe,be,Ee,W,Ue),te.push(`/z_${le}`)}}this.cacheKey=te.sort().join("")}getMaxValue(h){const W=this.binders[h];return W instanceof ea||W instanceof Nn?W.maxValue:0}populatePaintArrays(h,W,X){for(const te in this.binders){const le=this.binders[te];(le instanceof ea||le instanceof Nn||le instanceof fa)&&le.populatePaintArray(h,W,X)}}setConstantPatternPositions(h,W){for(const X in this.binders){const te=this.binders[X];te instanceof Fa&&te.setConstantPatternPositions(h,W)}}setConstantDashPositions(h,W){for(const X in this.binders){const te=this.binders[X];te instanceof Fa&&te.setConstantDashPositions(h,W)}}updatePaintArrays(h,W,X,te,le){let he=!1;for(const fe in h){const ye=W.getPositions(fe);for(const be of ye){const Ee=X.feature(be.index);for(const Pe in this.binders){const Ne=this.binders[Pe];if((Ne instanceof ea||Ne instanceof Nn||Ne instanceof fa)&&Ne.expression.isStateDependent===!0){const Ue=te.paint.get(Pe);Ne.expression=Ue.value,Ne.updatePaintArray(be.start,be.end,Ee,h[fe],le),he=!0}}}}return he}defines(){const h=[];for(const W in this.binders){const X=this.binders[W];(X instanceof Go||X instanceof Fa)&&h.push(...X.uniformNames.map((te=>`#define HAS_UNIFORM_${te}`)))}return h}getBinderAttributes(){const h=[];for(const W in this.binders){const X=this.binders[W];if(X instanceof ea||X instanceof Nn)for(let te=0;te<X.paintVertexAttributes.length;te++)h.push(X.paintVertexAttributes[te].name);else if(X instanceof fa){const te=X.getVertexAttributes();for(const le of te)h.push(le.name)}}return h}getBinderUniforms(){const h=[];for(const W in this.binders){const X=this.binders[W];if(X instanceof Go||X instanceof Fa||X instanceof Nn)for(const te of X.uniformNames)h.push(te)}return h}getPaintVertexBuffers(){return this._buffers}getUniforms(h,W){const X=[];for(const te in this.binders){const le=this.binders[te];if(le instanceof Go||le instanceof Fa||le instanceof Nn){for(const he of le.uniformNames)if(W[he]){const fe=le.getBinding(h,W[he],he);X.push({name:he,property:te,binding:fe})}}}return X}setUniforms(h,W,X,te){for(const{name:le,property:he,binding:fe}of W)this.binders[he].setUniform(fe,te,X.get(he),le)}updatePaintBuffers(h){this._buffers=[];for(const W in this.binders){const X=this.binders[W];if(h&&X instanceof fa){const te=h.fromScale===2?X.zoomInPaintVertexBuffer:X.zoomOutPaintVertexBuffer;te&&this._buffers.push(te)}else(X instanceof ea||X instanceof Nn)&&X.paintVertexBuffer&&this._buffers.push(X.paintVertexBuffer)}}upload(h){for(const W in this.binders){const X=this.binders[W];(X instanceof ea||X instanceof Nn||X instanceof fa)&&X.upload(h)}this.updatePaintBuffers()}destroy(){for(const h in this.binders){const W=this.binders[h];(W instanceof ea||W instanceof Nn||W instanceof fa)&&W.destroy()}}}class _a{constructor(h,W,X=()=>!0){this.programConfigurations={};for(const te of h)this.programConfigurations[te.id]=new Xl(te,W,X);this.needsUpload=!1,this._featureMap=new Qn,this._bufferOffset=0}populatePaintArrays(h,W,X,te){for(const le in this.programConfigurations)this.programConfigurations[le].populatePaintArrays(h,W,te);W.id!==void 0&&this._featureMap.add(W.id,X,this._bufferOffset,h),this._bufferOffset=h,this.needsUpload=!0}updatePaintArrays(h,W,X,te){for(const le of X)this.needsUpload=this.programConfigurations[le.id].updatePaintArrays(h,this._featureMap,W,le,te)||this.needsUpload}get(h){return this.programConfigurations[h]}upload(h){if(this.needsUpload){for(const W in this.programConfigurations)this.programConfigurations[W].upload(h);this.needsUpload=!1}}destroy(){for(const h in this.programConfigurations)this.programConfigurations[h].destroy()}}function Yl(H,h){return{"text-opacity":["opacity"],"icon-opacity":["opacity"],"text-color":["fill_color"],"icon-color":["fill_color"],"text-halo-color":["halo_color"],"icon-halo-color":["halo_color"],"text-halo-blur":["halo_blur"],"icon-halo-blur":["halo_blur"],"text-halo-width":["halo_width"],"icon-halo-width":["halo_width"],"line-gap-width":["gapwidth"],"line-dasharray":["dasharray_to","dasharray_from"],"line-pattern":["pattern_to","pattern_from","pixel_ratio_to","pixel_ratio_from"],"fill-pattern":["pattern_to","pattern_from","pixel_ratio_to","pixel_ratio_from"],"fill-extrusion-pattern":["pattern_to","pattern_from","pixel_ratio_to","pixel_ratio_from"]}[H]||[H.replace(`${h}-`,"").replace(/-/g,"_")]}function Jl(H,h,W){const X={color:{source:ca,composite:qe},number:{source:ie,composite:ca}},te=(function(le){return{"line-pattern":{source:Nt,composite:Nt},"fill-pattern":{source:Nt,composite:Nt},"fill-extrusion-pattern":{source:Nt,composite:Nt},"line-dasharray":{source:ar,composite:ar}}[le]})(H);return te&&te[W]||X[h][W]}vr("ConstantBinder",Go),vr("CrossFadedConstantBinder",Fa),vr("SourceExpressionBinder",ea),vr("CrossFadedPatternBinder",pa),vr("CrossFadedDasharrayBinder",Kl),vr("CompositeExpressionBinder",Nn),vr("ProgramConfiguration",Xl,{omit:["_buffers"]}),vr("ProgramConfigurationSet",_a);const $o=Math.pow(2,14)-1,Lh=-$o-1;function Wo(H){const h=ut/H.extent,W=H.loadGeometry();for(let X=0;X<W.length;X++){const te=W[X];for(let le=0;le<te.length;le++){const he=te[le],fe=Math.round(he.x*h),ye=Math.round(he.y*h);he.x=ur(fe,Lh,$o),he.y=ur(ye,Lh,$o),(fe<he.x||fe>he.x+1||ye<he.y||ye>he.y+1)&&Mr("Geometry exceeds allowed extent, reduce your vector tile buffer size")}}return W}function Ho(H,h){return{type:H.type,id:H.id,properties:H.properties,geometry:h?Wo(H):[]}}const Bh=-32768;function vf(H,h,W,X,te){H.emplaceBack(Bh+8*h+X,Bh+8*W+te)}class Jc{constructor(h){this.zoom=h.zoom,this.overscaling=h.overscaling,this.layers=h.layers,this.layerIds=this.layers.map((W=>W.id)),this.index=h.index,this.hasDependencies=!1,this.layoutVertexArray=new gt,this.indexArray=new di,this.segments=new si,this.programConfigurations=new _a(h.layers,h.zoom),this.stateDependentLayerIds=this.layers.filter((W=>W.isStateDependent())).map((W=>W.id))}populate(h,W,X){const te=this.layers[0],le=[];let he=null,fe=!1,ye=te.type==="heatmap";if(te.type==="circle"){const Ee=te;he=Ee.layout.get("circle-sort-key"),fe=!he.isConstant(),ye=ye||Ee.paint.get("circle-pitch-alignment")==="map"}const be=ye?W.subdivisionGranularity.circle:1;for(const{feature:Ee,id:Pe,index:Ne,sourceLayerIndex:Ue}of h){const $e=this.layers[0]._featureFilter.needGeometry,Ye=Ho(Ee,$e);if(!this.layers[0]._featureFilter.filter(new mi(this.zoom),Ye,X))continue;const rt=fe?he.evaluate(Ye,{},X):void 0,dt={id:Pe,properties:Ee.properties,type:Ee.type,sourceLayerIndex:Ue,index:Ne,geometry:$e?Ye.geometry:Wo(Ee),patterns:{},sortKey:rt};le.push(dt)}fe&&le.sort(((Ee,Pe)=>Ee.sortKey-Pe.sortKey));for(const Ee of le){const{geometry:Pe,index:Ne,sourceLayerIndex:Ue}=Ee,$e=h[Ne].feature;this.addFeature(Ee,Pe,Ne,X,be),W.featureIndex.insert($e,Pe,Ne,Ue,this.index)}}update(h,W,X){this.stateDependentLayers.length&&this.programConfigurations.updatePaintArrays(h,W,this.stateDependentLayers,{imagePositions:X})}isEmpty(){return this.layoutVertexArray.length===0}uploadPending(){return!this.uploaded||this.programConfigurations.needsUpload}upload(h){this.uploaded||(this.layoutVertexBuffer=h.createVertexBuffer(this.layoutVertexArray,gi),this.indexBuffer=h.createIndexBuffer(this.indexArray)),this.programConfigurations.upload(h),this.uploaded=!0}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy())}addFeature(h,W,X,te,le=1){let he;switch(le){case 1:he=[0,7];break;case 3:he=[0,2,5,7];break;case 5:he=[0,1,3,4,6,7];break;case 7:he=[0,1,2,3,4,5,6,7];break;default:throw new Error(`Invalid circle bucket granularity: ${le}; valid values are 1, 3, 5, 7.`)}const fe=he.length;for(const ye of W)for(const be of ye){const Ee=be.x,Pe=be.y;if(Ee<0||Ee>=ut||Pe<0||Pe>=ut)continue;const Ne=this.segments.prepareSegment(fe*fe,this.layoutVertexArray,this.indexArray,h.sortKey),Ue=Ne.vertexLength;for(let $e=0;$e<fe;$e++)for(let Ye=0;Ye<fe;Ye++)vf(this.layoutVertexArray,Ee,Pe,he[Ye],he[$e]);for(let $e=0;$e<fe-1;$e++)for(let Ye=0;Ye<fe-1;Ye++){const rt=Ue+$e*fe+Ye,dt=Ue+($e+1)*fe+Ye;this.indexArray.emplaceBack(rt,dt+1,rt+1),this.indexArray.emplaceBack(rt,dt,dt+1)}Ne.vertexLength+=fe*fe,Ne.primitiveLength+=(fe-1)*(fe-1)*2}this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,h,X,{imagePositions:{},canonical:te})}}function Nh(H,h){for(let W=0;W<H.length;W++)if(Vs(h,H[W]))return!0;for(let W=0;W<h.length;W++)if(Vs(H,h[W]))return!0;return!!Qc(H,h)}function uc(H,h,W){return!!Vs(H,h)||!!eh(h,H,W)}function jh(H,h){if(H.length===1)return Uh(h,H[0]);for(let W=0;W<h.length;W++){const X=h[W];for(let te=0;te<X.length;te++)if(Vs(H,X[te]))return!0}for(let W=0;W<H.length;W++)if(Uh(h,H[W]))return!0;for(let W=0;W<h.length;W++)if(Qc(H,h[W]))return!0;return!1}function bf(H,h,W){if(H.length>1){if(Qc(H,h))return!0;for(let X=0;X<h.length;X++)if(eh(h[X],H,W))return!0}for(let X=0;X<H.length;X++)if(eh(H[X],h,W))return!0;return!1}function Qc(H,h){if(H.length===0||h.length===0)return!1;for(let W=0;W<H.length-1;W++){const X=H[W],te=H[W+1];for(let le=0;le<h.length-1;le++)if(xf(X,te,h[le],h[le+1]))return!0}return!1}function xf(H,h,W,X){return Hr(H,W,X)!==Hr(h,W,X)&&Hr(H,h,W)!==Hr(H,h,X)}function eh(H,h,W){const X=W*W;if(h.length===1)return H.distSqr(h[0])<X;for(let te=1;te<h.length;te++)if(zh(H,h[te-1],h[te])<X)return!0;return!1}function zh(H,h,W){const X=h.distSqr(W);if(X===0)return H.distSqr(h);const te=((H.x-h.x)*(W.x-h.x)+(H.y-h.y)*(W.y-h.y))/X;return H.distSqr(te<0?h:te>1?W:W.sub(h)._mult(te)._add(h))}function Uh(H,h){let W,X,te,le=!1;for(let he=0;he<H.length;he++){W=H[he];for(let fe=0,ye=W.length-1;fe<W.length;ye=fe++)X=W[fe],te=W[ye],X.y>h.y!=te.y>h.y&&h.x<(te.x-X.x)*(h.y-X.y)/(te.y-X.y)+X.x&&(le=!le)}return le}function Vs(H,h){let W=!1;for(let X=0,te=H.length-1;X<H.length;te=X++){const le=H[X],he=H[te];le.y>h.y!=he.y>h.y&&h.x<(he.x-le.x)*(h.y-le.y)/(he.y-le.y)+le.x&&(W=!W)}return W}function wf(H,h,W){const X=W[0],te=W[2];if(H.x<X.x&&h.x<X.x||H.x>te.x&&h.x>te.x||H.y<X.y&&h.y<X.y||H.y>te.y&&h.y>te.y)return!1;const le=Hr(H,h,W[0]);return le!==Hr(H,h,W[1])||le!==Hr(H,h,W[2])||le!==Hr(H,h,W[3])}function Gs(H,h,W){const X=h.paint.get(H).value;return X.kind==="constant"?X.value:W.programConfigurations.get(h.id).getMaxValue(H)}function cc(H){return Math.sqrt(H[0]*H[0]+H[1]*H[1])}function hc(H,h,W,X,te){if(!h[0]&&!h[1])return H;const le=U.convert(h)._mult(te);W==="viewport"&&le._rotate(-X);const he=[];for(let fe=0;fe<H.length;fe++)he.push(H[fe].sub(le));return he}function Sf({queryGeometry:H,size:h},W){return uc(H,W,h)}function Ef({queryGeometry:H,size:h,transform:W,unwrappedTileID:X,getElevation:te},le){return uc(H,le,h*(W.projectTileCoordinates(le.x,le.y,X,te).signedDistanceFromCamera/W.cameraToCenterDistance))}function qf({queryGeometry:H,size:h,transform:W,unwrappedTileID:X,getElevation:te},le){const he=W.projectTileCoordinates(le.x,le.y,X,te).signedDistanceFromCamera,fe=h*(W.cameraToCenterDistance/he);return uc(H,th(le,W,X,te),fe)}function Tf({queryGeometry:H,size:h,transform:W,unwrappedTileID:X,getElevation:te},le){return uc(H,th(le,W,X,te),h)}function Vh({queryGeometry:H,size:h,transform:W,unwrappedTileID:X,getElevation:te,pitchAlignment:le="map",pitchScale:he="map"},fe){const ye=le==="map"?he==="map"?Sf:Ef:he==="map"?qf:Tf,be={queryGeometry:H,size:h,transform:W,unwrappedTileID:X,getElevation:te};for(const Ee of fe)for(const Pe of Ee)if(ye(be,Pe))return!0;return!1}function th(H,h,W,X){const te=h.projectTileCoordinates(H.x,H.y,W,X).point;return new U((.5*te.x+.5)*h.width,(.5*-te.y+.5)*h.height)}let Gh,$h;vr("CircleBucket",Jc,{omit:["layers"]});var If={get paint(){return $h=$h||new pn({"circle-radius":new Br(Tt.paint_circle["circle-radius"]),"circle-color":new Br(Tt.paint_circle["circle-color"]),"circle-blur":new Br(Tt.paint_circle["circle-blur"]),"circle-opacity":new Br(Tt.paint_circle["circle-opacity"]),"circle-translate":new Ar(Tt.paint_circle["circle-translate"]),"circle-translate-anchor":new Ar(Tt.paint_circle["circle-translate-anchor"]),"circle-pitch-scale":new Ar(Tt.paint_circle["circle-pitch-scale"]),"circle-pitch-alignment":new Ar(Tt.paint_circle["circle-pitch-alignment"]),"circle-stroke-width":new Br(Tt.paint_circle["circle-stroke-width"]),"circle-stroke-color":new Br(Tt.paint_circle["circle-stroke-color"]),"circle-stroke-opacity":new Br(Tt.paint_circle["circle-stroke-opacity"])})},get layout(){return Gh=Gh||new pn({"circle-sort-key":new Br(Tt.layout_circle["circle-sort-key"])})}};class Rf extends Ln{constructor(h,W){super(h,If,W)}createBucket(h){return new Jc(h)}queryRadius(h){const W=h;return Gs("circle-radius",this,W)+Gs("circle-stroke-width",this,W)+cc(this.paint.get("circle-translate"))}queryIntersectsFeature({queryGeometry:h,feature:W,featureState:X,geometry:te,transform:le,pixelsToTileUnits:he,unwrappedTileID:fe,getElevation:ye}){const be=hc(h,this.paint.get("circle-translate"),this.paint.get("circle-translate-anchor"),-le.bearingInRadians,he),Ee=this.paint.get("circle-radius").evaluate(W,X)+this.paint.get("circle-stroke-width").evaluate(W,X),Pe=this.paint.get("circle-pitch-scale"),Ne=this.paint.get("circle-pitch-alignment");let Ue,$e;return Ne==="map"?(Ue=be,$e=Ee*he):(Ue=(function(Ye,rt,dt,Ct){return Ye.map((vt=>th(vt,rt,dt,Ct)))})(be,le,fe,ye),$e=Ee),Vh({queryGeometry:Ue,size:$e,transform:le,unwrappedTileID:fe,getElevation:ye,pitchAlignment:Ne,pitchScale:Pe},te)}}class Wh extends Jc{}let Hh;vr("HeatmapBucket",Wh,{omit:["layers"]});var Af={get paint(){return Hh=Hh||new pn({"heatmap-radius":new Br(Tt.paint_heatmap["heatmap-radius"]),"heatmap-weight":new Br(Tt.paint_heatmap["heatmap-weight"]),"heatmap-intensity":new Ar(Tt.paint_heatmap["heatmap-intensity"]),"heatmap-color":new Bs(Tt.paint_heatmap["heatmap-color"]),"heatmap-opacity":new Ar(Tt.paint_heatmap["heatmap-opacity"])})}};function rh(H,{width:h,height:W},X,te){if(te){if(te instanceof Uint8ClampedArray)te=new Uint8Array(te.buffer);else if(te.length!==h*W*X)throw new RangeError(`mismatched image size. expected: ${te.length} but got: ${h*W*X}`)}else te=new Uint8Array(h*W*X);return H.width=h,H.height=W,H.data=te,H}function Zh(H,{width:h,height:W},X){if(h===H.width&&W===H.height)return;const te=rh({},{width:h,height:W},X);ih(H,te,{x:0,y:0},{x:0,y:0},{width:Math.min(H.width,h),height:Math.min(H.height,W)},X),H.width=h,H.height=W,H.data=te.data}function ih(H,h,W,X,te,le){if(te.width===0||te.height===0)return h;if(te.width>H.width||te.height>H.height||W.x>H.width-te.width||W.y>H.height-te.height)throw new RangeError("out of range source coordinates for image copy");if(te.width>h.width||te.height>h.height||X.x>h.width-te.width||X.y>h.height-te.height)throw new RangeError("out of range destination coordinates for image copy");const he=H.data,fe=h.data;if(he===fe)throw new Error("srcData equals dstData, so image is already copied");for(let ye=0;ye<te.height;ye++){const be=((W.y+ye)*H.width+W.x)*le,Ee=((X.y+ye)*h.width+X.x)*le;for(let Pe=0;Pe<te.width*le;Pe++)fe[Ee+Pe]=he[be+Pe]}return h}class Ql{constructor(h,W){rh(this,h,1,W)}resize(h){Zh(this,h,1)}clone(){return new Ql({width:this.width,height:this.height},new Uint8Array(this.data))}static copy(h,W,X,te,le){ih(h,W,X,te,le,1)}}class Tn{constructor(h,W){rh(this,h,4,W)}resize(h){Zh(this,h,4)}replace(h,W){W?this.data.set(h):this.data=h instanceof Uint8ClampedArray?new Uint8Array(h.buffer):h}clone(){return new Tn({width:this.width,height:this.height},new Uint8Array(this.data))}static copy(h,W,X,te,le){ih(h,W,X,te,le,4)}setPixel(h,W,X){const te=4*(h*this.width+W);this.data[te+0]=Math.round(255*X.r/X.a),this.data[te+1]=Math.round(255*X.g/X.a),this.data[te+2]=Math.round(255*X.b/X.a),this.data[te+3]=Math.round(255*X.a)}}function Kh(H){const h={},W=H.resolution||256,X=H.clips?H.clips.length:1,te=H.image||new Tn({width:W,height:X});if(Math.log(W)/Math.LN2%1!=0)throw new Error(`width is not a power of 2 - ${W}`);const le=(he,fe,ye)=>{h[H.evaluationKey]=ye;const be=H.expression.evaluate(h);te.setPixel(he/4/W,fe/4,be)};if(H.clips)for(let he=0,fe=0;he<X;++he,fe+=4*W)for(let ye=0,be=0;ye<W;ye++,be+=4){const Ee=ye/(W-1),{start:Pe,end:Ne}=H.clips[he];le(fe,be,Pe*(1-Ee)+Ne*Ee)}else for(let he=0,fe=0;he<W;he++,fe+=4)le(0,fe,he/(W-1));return te}vr("AlphaImage",Ql),vr("RGBAImage",Tn);const nh="big-fb";class Pf extends Ln{createBucket(h){return new Wh(h)}constructor(h,W){super(h,Af,W),this.heatmapFbos=new Map,this._updateColorRamp()}_handleSpecialPaintPropertyUpdate(h){h==="heatmap-color"&&this._updateColorRamp()}_updateColorRamp(){this.colorRamp=Kh({expression:this._transitionablePaint._values["heatmap-color"].value.expression,evaluationKey:"heatmapDensity",image:this.colorRamp}),this.colorRampTexture=null}resize(){this.heatmapFbos.has(nh)&&this.heatmapFbos.delete(nh)}queryRadius(h){return Gs("heatmap-radius",this,h)}queryIntersectsFeature({queryGeometry:h,feature:W,featureState:X,geometry:te,transform:le,pixelsToTileUnits:he,unwrappedTileID:fe,getElevation:ye}){return Vh({queryGeometry:h,size:this.paint.get("heatmap-radius").evaluate(W,X)*he,transform:le,unwrappedTileID:fe,getElevation:ye},te)}hasOffscreenPass(){return this.paint.get("heatmap-opacity")!==0&&this.visibility!=="none"}}let Xh;var Of={get paint(){return Xh=Xh||new pn({"hillshade-illumination-direction":new Ar(Tt.paint_hillshade["hillshade-illumination-direction"]),"hillshade-illumination-altitude":new Ar(Tt.paint_hillshade["hillshade-illumination-altitude"]),"hillshade-illumination-anchor":new Ar(Tt.paint_hillshade["hillshade-illumination-anchor"]),"hillshade-exaggeration":new Ar(Tt.paint_hillshade["hillshade-exaggeration"]),"hillshade-shadow-color":new Ar(Tt.paint_hillshade["hillshade-shadow-color"]),"hillshade-highlight-color":new Ar(Tt.paint_hillshade["hillshade-highlight-color"]),"hillshade-accent-color":new Ar(Tt.paint_hillshade["hillshade-accent-color"]),"hillshade-method":new Ar(Tt.paint_hillshade["hillshade-method"])})}};class Cf extends Ln{constructor(h,W){super(h,Of,W),this.recalculate({zoom:0,zoomHistory:{}},void 0)}getIlluminationProperties(){let h=this.paint.get("hillshade-illumination-direction").values,W=this.paint.get("hillshade-illumination-altitude").values,X=this.paint.get("hillshade-highlight-color").values,te=this.paint.get("hillshade-shadow-color").values;const le=Math.max(h.length,W.length,X.length,te.length);h=h.concat(Array(le-h.length).fill(h.at(-1))),W=W.concat(Array(le-W.length).fill(W.at(-1))),X=X.concat(Array(le-X.length).fill(X.at(-1))),te=te.concat(Array(le-te.length).fill(te.at(-1)));const he=W.map(dr);return{directionRadians:h.map(dr),altitudeRadians:he,shadowColor:te,highlightColor:X}}hasOffscreenPass(){return this.paint.get("hillshade-exaggeration")!==0&&this.visibility!=="none"}}let Yh;var Mf={get paint(){return Yh=Yh||new pn({"color-relief-opacity":new Ar(Tt["paint_color-relief"]["color-relief-opacity"]),"color-relief-color":new Bs(Tt["paint_color-relief"]["color-relief-color"])})}};class ah{constructor(h,W,X,te){this.context=h,this.format=X,this.texture=h.gl.createTexture(),this.update(W,te)}update(h,W,X){const{width:te,height:le}=h,he=!(this.size&&this.size[0]===te&&this.size[1]===le||X),{context:fe}=this,{gl:ye}=fe;if(this.useMipmap=!!(W&&W.useMipmap),ye.bindTexture(ye.TEXTURE_2D,this.texture),fe.pixelStoreUnpackFlipY.set(!1),fe.pixelStoreUnpack.set(1),fe.pixelStoreUnpackPremultiplyAlpha.set(this.format===ye.RGBA&&(!W||W.premultiply!==!1)),he)this.size=[te,le],h instanceof HTMLImageElement||h instanceof HTMLCanvasElement||h instanceof HTMLVideoElement||h instanceof ImageData||Dr(h)?ye.texImage2D(ye.TEXTURE_2D,0,this.format,this.format,ye.UNSIGNED_BYTE,h):ye.texImage2D(ye.TEXTURE_2D,0,this.format,te,le,0,this.format,ye.UNSIGNED_BYTE,h.data);else{const{x:be,y:Ee}=X||{x:0,y:0};h instanceof HTMLImageElement||h instanceof HTMLCanvasElement||h instanceof HTMLVideoElement||h instanceof ImageData||Dr(h)?ye.texSubImage2D(ye.TEXTURE_2D,0,be,Ee,ye.RGBA,ye.UNSIGNED_BYTE,h):ye.texSubImage2D(ye.TEXTURE_2D,0,be,Ee,te,le,ye.RGBA,ye.UNSIGNED_BYTE,h.data)}this.useMipmap&&this.isSizePowerOfTwo()&&ye.generateMipmap(ye.TEXTURE_2D),fe.pixelStoreUnpackFlipY.setDefault(),fe.pixelStoreUnpack.setDefault(),fe.pixelStoreUnpackPremultiplyAlpha.setDefault()}bind(h,W,X){const{context:te}=this,{gl:le}=te;le.bindTexture(le.TEXTURE_2D,this.texture),X!==le.LINEAR_MIPMAP_NEAREST||this.isSizePowerOfTwo()||(X=le.LINEAR),h!==this.filter&&(le.texParameteri(le.TEXTURE_2D,le.TEXTURE_MAG_FILTER,h),le.texParameteri(le.TEXTURE_2D,le.TEXTURE_MIN_FILTER,X||h),this.filter=h),W!==this.wrap&&(le.texParameteri(le.TEXTURE_2D,le.TEXTURE_WRAP_S,W),le.texParameteri(le.TEXTURE_2D,le.TEXTURE_WRAP_T,W),this.wrap=W)}isSizePowerOfTwo(){return this.size[0]===this.size[1]&&Math.log(this.size[0])/Math.LN2%1==0}destroy(){const{gl:h}=this.context;h.deleteTexture(this.texture),this.texture=null}}class Jh{constructor(h,W,X,te=1,le=1,he=1,fe=0){if(this.uid=h,W.height!==W.width)throw new RangeError("DEM tiles must be square");if(X&&!["mapbox","terrarium","custom"].includes(X))return void Mr(`"${X}" is not a valid encoding type. Valid types include "mapbox", "terrarium" and "custom".`);this.stride=W.height;const ye=this.dim=W.height-2;switch(this.data=new Uint32Array(W.data.buffer),X){case"terrarium":this.redFactor=256,this.greenFactor=1,this.blueFactor=1/256,this.baseShift=32768;break;case"custom":this.redFactor=te,this.greenFactor=le,this.blueFactor=he,this.baseShift=fe;break;default:this.redFactor=6553.6,this.greenFactor=25.6,this.blueFactor=.1,this.baseShift=1e4}for(let be=0;be<ye;be++)this.data[this._idx(-1,be)]=this.data[this._idx(0,be)],this.data[this._idx(ye,be)]=this.data[this._idx(ye-1,be)],this.data[this._idx(be,-1)]=this.data[this._idx(be,0)],this.data[this._idx(be,ye)]=this.data[this._idx(be,ye-1)];this.data[this._idx(-1,-1)]=this.data[this._idx(0,0)],this.data[this._idx(ye,-1)]=this.data[this._idx(ye-1,0)],this.data[this._idx(-1,ye)]=this.data[this._idx(0,ye-1)],this.data[this._idx(ye,ye)]=this.data[this._idx(ye-1,ye-1)],this.min=Number.MAX_SAFE_INTEGER,this.max=Number.MIN_SAFE_INTEGER;for(let be=0;be<ye;be++)for(let Ee=0;Ee<ye;Ee++){const Pe=this.get(be,Ee);Pe>this.max&&(this.max=Pe),Pe<this.min&&(this.min=Pe)}}get(h,W){const X=new Uint8Array(this.data.buffer),te=4*this._idx(h,W);return this.unpack(X[te],X[te+1],X[te+2])}getUnpackVector(){return[this.redFactor,this.greenFactor,this.blueFactor,this.baseShift]}_idx(h,W){if(h<-1||h>=this.dim+1||W<-1||W>=this.dim+1)throw new RangeError("out of range source coordinates for DEM data");return(W+1)*this.stride+(h+1)}unpack(h,W,X){return h*this.redFactor+W*this.greenFactor+X*this.blueFactor-this.baseShift}pack(h){return Qh(h,this.getUnpackVector())}getPixels(){return new Tn({width:this.stride,height:this.stride},new Uint8Array(this.data.buffer))}backfillBorder(h,W,X){if(this.dim!==h.dim)throw new Error("dem dimension mismatch");let te=W*this.dim,le=W*this.dim+this.dim,he=X*this.dim,fe=X*this.dim+this.dim;switch(W){case-1:te=le-1;break;case 1:le=te+1}switch(X){case-1:he=fe-1;break;case 1:fe=he+1}const ye=-W*this.dim,be=-X*this.dim;for(let Ee=he;Ee<fe;Ee++)for(let Pe=te;Pe<le;Pe++)this.data[this._idx(Pe,Ee)]=h.data[this._idx(Pe+ye,Ee+be)]}}function Qh(H,h){const W=h[0],X=h[1],te=h[2],le=h[3],he=Math.min(W,X,te),fe=Math.round((H+le)/he);return{r:Math.floor(fe*he/W)%256,g:Math.floor(fe*he/X)%256,b:Math.floor(fe*he/te)%256}}vr("DEMData",Jh);class Df extends Ln{constructor(h,W){super(h,Mf,W)}_createColorRamp(h){const W={elevationStops:[],colorStops:[]},X=this._transitionablePaint._values["color-relief-color"].value.expression;if(X instanceof ws&&X._styleExpression.expression instanceof zi){this.colorRampExpression=X;const he=X._styleExpression.expression;W.elevationStops=he.labels,W.colorStops=[];for(const fe of W.elevationStops)W.colorStops.push(he.evaluate({globals:{elevation:fe}}))}if(W.elevationStops.length<1&&(W.elevationStops=[0],W.colorStops=[Qr.transparent]),W.elevationStops.length<2&&(W.elevationStops.push(W.elevationStops[0]+1),W.colorStops.push(W.colorStops[0])),W.elevationStops.length<=h)return W;const te={elevationStops:[],colorStops:[]},le=(W.elevationStops.length-1)/(h-1);for(let he=0;he<W.elevationStops.length-.5;he+=le)te.elevationStops.push(W.elevationStops[Math.round(he)]),te.colorStops.push(W.colorStops[Math.round(he)]);return Mr(`Too many colors in specification of ${this.id} color-relief layer, may not render properly.`),te}_colorRampChanged(){return this.colorRampExpression!=this._transitionablePaint._values["color-relief-color"].value.expression}getColorRampTextures(h,W,X){if(this.colorRampTextures&&!this._colorRampChanged())return this.colorRampTextures;const te=this._createColorRamp(W),le=new Tn({width:te.colorStops.length,height:1}),he=new Tn({width:te.colorStops.length,height:1});for(let fe=0;fe<te.elevationStops.length;fe++){const ye=Qh(te.elevationStops[fe],X);he.setPixel(0,fe,new Qr(ye.r/255,ye.g/255,ye.b/255,1)),le.setPixel(0,fe,te.colorStops[fe])}return this.colorRampTextures={elevationTexture:new ah(h,he,h.gl.RGBA),colorTexture:new ah(h,le,h.gl.RGBA)},this.colorRampTextures}hasOffscreenPass(){return this.visibility!=="none"&&!!this.colorRampTextures}}const Ff=Di([{name:"a_pos",components:2,type:"Int16"}],4),{members:kf}=Ff;function dc(H,h,W){const X=W.patternDependencies;let te=!1;for(const le of h){const he=le.paint.get(`${H}-pattern`);he.isConstant()||(te=!0);const fe=he.constantOr(null);fe&&(te=!0,X[fe.to]=!0,X[fe.from]=!0)}return te}function oh(H,h,W,X,te){const{zoom:le}=X,he=te.patternDependencies;for(const fe of h){const ye=fe.paint.get(`${H}-pattern`).value;if(ye.kind!=="constant"){let be=ye.evaluate({zoom:le-1},W,{},te.availableImages),Ee=ye.evaluate({zoom:le},W,{},te.availableImages),Pe=ye.evaluate({zoom:le+1},W,{},te.availableImages);be=be&&be.name?be.name:be,Ee=Ee&&Ee.name?Ee.name:Ee,Pe=Pe&&Pe.name?Pe.name:Pe,he[be]=!0,he[Ee]=!0,he[Pe]=!0,W.patterns[fe.id]={min:be,mid:Ee,max:Pe}}}return W}function ed(H,h,W,X,te){let le;if(te===(function(he,fe,ye,be){let Ee=0;for(let Pe=fe,Ne=ye-be;Pe<ye;Pe+=be)Ee+=(he[Ne]-he[Pe])*(he[Pe+1]+he[Ne+1]),Ne=Pe;return Ee})(H,h,W,X)>0)for(let he=h;he<W;he+=X)le=nd(he/X|0,H[he],H[he+1],le);else for(let he=W-X;he>=h;he-=X)le=nd(he/X|0,H[he],H[he+1],le);return le&&$s(le,le.next)&&(iu(le),le=le.next),le}function Zo(H,h){if(!H)return H;h||(h=H);let W,X=H;do if(W=!1,X.steiner||!$s(X,X.next)&&Bi(X.prev,X,X.next)!==0)X=X.next;else{if(iu(X),X=h=X.prev,X===X.next)break;W=!0}while(W||X!==h);return h}function eu(H,h,W,X,te,le,he){if(!H)return;!he&&le&&(function(ye,be,Ee,Pe){let Ne=ye;do Ne.z===0&&(Ne.z=sh(Ne.x,Ne.y,be,Ee,Pe)),Ne.prevZ=Ne.prev,Ne.nextZ=Ne.next,Ne=Ne.next;while(Ne!==ye);Ne.prevZ.nextZ=null,Ne.prevZ=null,(function(Ue){let $e,Ye=1;do{let rt,dt=Ue;Ue=null;let Ct=null;for($e=0;dt;){$e++;let vt=dt,qt=0;for(let Gt=0;Gt<Ye&&(qt++,vt=vt.nextZ,vt);Gt++);let Lt=Ye;for(;qt>0||Lt>0&&vt;)qt!==0&&(Lt===0||!vt||dt.z<=vt.z)?(rt=dt,dt=dt.nextZ,qt--):(rt=vt,vt=vt.nextZ,Lt--),Ct?Ct.nextZ=rt:Ue=rt,rt.prevZ=Ct,Ct=rt;dt=vt}Ct.nextZ=null,Ye*=2}while($e>1)})(Ne)})(H,X,te,le);let fe=H;for(;H.prev!==H.next;){const ye=H.prev,be=H.next;if(le?Bf(H,X,te,le):Lf(H))h.push(ye.i,H.i,be.i),iu(H),H=be.next,fe=be.next;else if((H=be)===fe){he?he===1?eu(H=Nf(Zo(H),h),h,W,X,te,le,2):he===2&&jf(H,h,W,X,te,le):eu(Zo(H),h,W,X,te,le,1);break}}}function Lf(H){const h=H.prev,W=H,X=H.next;if(Bi(h,W,X)>=0)return!1;const te=h.x,le=W.x,he=X.x,fe=h.y,ye=W.y,be=X.y,Ee=Math.min(te,le,he),Pe=Math.min(fe,ye,be),Ne=Math.max(te,le,he),Ue=Math.max(fe,ye,be);let $e=X.next;for(;$e!==h;){if($e.x>=Ee&&$e.x<=Ne&&$e.y>=Pe&&$e.y<=Ue&&tu(te,fe,le,ye,he,be,$e.x,$e.y)&&Bi($e.prev,$e,$e.next)>=0)return!1;$e=$e.next}return!0}function Bf(H,h,W,X){const te=H.prev,le=H,he=H.next;if(Bi(te,le,he)>=0)return!1;const fe=te.x,ye=le.x,be=he.x,Ee=te.y,Pe=le.y,Ne=he.y,Ue=Math.min(fe,ye,be),$e=Math.min(Ee,Pe,Ne),Ye=Math.max(fe,ye,be),rt=Math.max(Ee,Pe,Ne),dt=sh(Ue,$e,h,W,X),Ct=sh(Ye,rt,h,W,X);let vt=H.prevZ,qt=H.nextZ;for(;vt&&vt.z>=dt&&qt&&qt.z<=Ct;){if(vt.x>=Ue&&vt.x<=Ye&&vt.y>=$e&&vt.y<=rt&&vt!==te&&vt!==he&&tu(fe,Ee,ye,Pe,be,Ne,vt.x,vt.y)&&Bi(vt.prev,vt,vt.next)>=0||(vt=vt.prevZ,qt.x>=Ue&&qt.x<=Ye&&qt.y>=$e&&qt.y<=rt&&qt!==te&&qt!==he&&tu(fe,Ee,ye,Pe,be,Ne,qt.x,qt.y)&&Bi(qt.prev,qt,qt.next)>=0))return!1;qt=qt.nextZ}for(;vt&&vt.z>=dt;){if(vt.x>=Ue&&vt.x<=Ye&&vt.y>=$e&&vt.y<=rt&&vt!==te&&vt!==he&&tu(fe,Ee,ye,Pe,be,Ne,vt.x,vt.y)&&Bi(vt.prev,vt,vt.next)>=0)return!1;vt=vt.prevZ}for(;qt&&qt.z<=Ct;){if(qt.x>=Ue&&qt.x<=Ye&&qt.y>=$e&&qt.y<=rt&&qt!==te&&qt!==he&&tu(fe,Ee,ye,Pe,be,Ne,qt.x,qt.y)&&Bi(qt.prev,qt,qt.next)>=0)return!1;qt=qt.nextZ}return!0}function Nf(H,h){let W=H;do{const X=W.prev,te=W.next.next;!$s(X,te)&&rd(X,W,W.next,te)&&ru(X,te)&&ru(te,X)&&(h.push(X.i,W.i,te.i),iu(W),iu(W.next),W=H=te),W=W.next}while(W!==H);return Zo(W)}function jf(H,h,W,X,te,le){let he=H;do{let fe=he.next.next;for(;fe!==he.prev;){if(he.i!==fe.i&&$f(he,fe)){let ye=id(he,fe);return he=Zo(he,he.next),ye=Zo(ye,ye.next),eu(he,h,W,X,te,le,0),void eu(ye,h,W,X,te,le,0)}fe=fe.next}he=he.next}while(he!==H)}function zf(H,h){let W=H.x-h.x;return W===0&&(W=H.y-h.y,W===0)&&(W=(H.next.y-H.y)/(H.next.x-H.x)-(h.next.y-h.y)/(h.next.x-h.x)),W}function Uf(H,h){const W=(function(te,le){let he=le;const fe=te.x,ye=te.y;let be,Ee=-1/0;if($s(te,he))return he;do{if($s(te,he.next))return he.next;if(ye<=he.y&&ye>=he.next.y&&he.next.y!==he.y){const Ye=he.x+(ye-he.y)*(he.next.x-he.x)/(he.next.y-he.y);if(Ye<=fe&&Ye>Ee&&(Ee=Ye,be=he.x<he.next.x?he:he.next,Ye===fe))return be}he=he.next}while(he!==le);if(!be)return null;const Pe=be,Ne=be.x,Ue=be.y;let $e=1/0;he=be;do{if(fe>=he.x&&he.x>=Ne&&fe!==he.x&&td(ye<Ue?fe:Ee,ye,Ne,Ue,ye<Ue?Ee:fe,ye,he.x,he.y)){const Ye=Math.abs(ye-he.y)/(fe-he.x);ru(he,te)&&(Ye<$e||Ye===$e&&(he.x>be.x||he.x===be.x&&Vf(be,he)))&&(be=he,$e=Ye)}he=he.next}while(he!==Pe);return be})(H,h);if(!W)return h;const X=id(W,H);return Zo(X,X.next),Zo(W,W.next)}function Vf(H,h){return Bi(H.prev,H,h.prev)<0&&Bi(h.next,H,H.next)<0}function sh(H,h,W,X,te){return(H=1431655765&((H=858993459&((H=252645135&((H=16711935&((H=(H-W)*te|0)|H<<8))|H<<4))|H<<2))|H<<1))|(h=1431655765&((h=858993459&((h=252645135&((h=16711935&((h=(h-X)*te|0)|h<<8))|h<<4))|h<<2))|h<<1))<<1}function Gf(H){let h=H,W=H;do(h.x<W.x||h.x===W.x&&h.y<W.y)&&(W=h),h=h.next;while(h!==H);return W}function td(H,h,W,X,te,le,he,fe){return(te-he)*(h-fe)>=(H-he)*(le-fe)&&(H-he)*(X-fe)>=(W-he)*(h-fe)&&(W-he)*(le-fe)>=(te-he)*(X-fe)}function tu(H,h,W,X,te,le,he,fe){return!(H===he&&h===fe)&&td(H,h,W,X,te,le,he,fe)}function $f(H,h){return H.next.i!==h.i&&H.prev.i!==h.i&&!(function(W,X){let te=W;do{if(te.i!==W.i&&te.next.i!==W.i&&te.i!==X.i&&te.next.i!==X.i&&rd(te,te.next,W,X))return!0;te=te.next}while(te!==W);return!1})(H,h)&&(ru(H,h)&&ru(h,H)&&(function(W,X){let te=W,le=!1;const he=(W.x+X.x)/2,fe=(W.y+X.y)/2;do te.y>fe!=te.next.y>fe&&te.next.y!==te.y&&he<(te.next.x-te.x)*(fe-te.y)/(te.next.y-te.y)+te.x&&(le=!le),te=te.next;while(te!==W);return le})(H,h)&&(Bi(H.prev,H,h.prev)||Bi(H,h.prev,h))||$s(H,h)&&Bi(H.prev,H,H.next)>0&&Bi(h.prev,h,h.next)>0)}function Bi(H,h,W){return(h.y-H.y)*(W.x-h.x)-(h.x-H.x)*(W.y-h.y)}function $s(H,h){return H.x===h.x&&H.y===h.y}function rd(H,h,W,X){const te=pc(Bi(H,h,W)),le=pc(Bi(H,h,X)),he=pc(Bi(W,X,H)),fe=pc(Bi(W,X,h));return te!==le&&he!==fe||!(te!==0||!fc(H,W,h))||!(le!==0||!fc(H,X,h))||!(he!==0||!fc(W,H,X))||!(fe!==0||!fc(W,h,X))}function fc(H,h,W){return h.x<=Math.max(H.x,W.x)&&h.x>=Math.min(H.x,W.x)&&h.y<=Math.max(H.y,W.y)&&h.y>=Math.min(H.y,W.y)}function pc(H){return H>0?1:H<0?-1:0}function ru(H,h){return Bi(H.prev,H,H.next)<0?Bi(H,h,H.next)>=0&&Bi(H,H.prev,h)>=0:Bi(H,h,H.prev)<0||Bi(H,H.next,h)<0}function id(H,h){const W=lh(H.i,H.x,H.y),X=lh(h.i,h.x,h.y),te=H.next,le=h.prev;return H.next=h,h.prev=H,W.next=te,te.prev=W,X.next=W,W.prev=X,le.next=X,X.prev=le,X}function nd(H,h,W,X){const te=lh(H,h,W);return X?(te.next=X.next,te.prev=X,X.next.prev=te,X.next=te):(te.prev=te,te.next=te),te}function iu(H){H.next.prev=H.prev,H.prev.next=H.next,H.prevZ&&(H.prevZ.nextZ=H.nextZ),H.nextZ&&(H.nextZ.prevZ=H.prevZ)}function lh(H,h,W){return{i:H,x:h,y:W,prev:null,next:null,z:0,prevZ:null,nextZ:null,steiner:!1}}class Ws{constructor(h,W){if(W>h)throw new Error("Min granularity must not be greater than base granularity.");this._baseZoomGranularity=h,this._minGranularity=W}getGranularityForZoomLevel(h){return Math.max(Math.floor(this._baseZoomGranularity/(1<<h)),this._minGranularity,1)}}class _c{constructor(h){this.fill=h.fill,this.line=h.line,this.tile=h.tile,this.stencil=h.stencil,this.circle=h.circle}}_c.noSubdivision=new _c({fill:new Ws(0,0),line:new Ws(0,0),tile:new Ws(0,0),stencil:new Ws(0,0),circle:1}),vr("SubdivisionGranularityExpression",Ws),vr("SubdivisionGranularitySetting",_c);const Hs=-32768,nu=32767;class Wf{constructor(h,W){this._vertexBuffer=[],this._vertexDictionary=new Map,this._used=!1,this._granularity=h,this._granularityCellSize=ut/h,this._canonical=W}_getKey(h,W){return(h+=32768)<<16|W+32768}_vertexToIndex(h,W){if(h<-32768||W<-32768||h>32767||W>32767)throw new Error("Vertex coordinates are out of signed 16 bit integer range.");const X=0|Math.round(h),te=0|Math.round(W),le=this._getKey(X,te);if(this._vertexDictionary.has(le))return this._vertexDictionary.get(le);const he=this._vertexBuffer.length/2;return this._vertexDictionary.set(le,he),this._vertexBuffer.push(X,te),he}_subdivideTrianglesScanline(h){if(this._granularity<2)return(function(te,le){const he=[];for(let fe=0;fe<le.length;fe+=3){const ye=le[fe],be=le[fe+1],Ee=le[fe+2],Pe=te[2*ye],Ne=te[2*ye+1];(te[2*be]-Pe)*(te[2*Ee+1]-Ne)-(te[2*be+1]-Ne)*(te[2*Ee]-Pe)>0?(he.push(ye),he.push(Ee),he.push(be)):(he.push(ye),he.push(be),he.push(Ee))}return he})(this._vertexBuffer,h);const W=[],X=h.length;for(let te=0;te<X;te+=3){const le=[h[te+0],h[te+1],h[te+2]],he=[this._vertexBuffer[2*h[te+0]+0],this._vertexBuffer[2*h[te+0]+1],this._vertexBuffer[2*h[te+1]+0],this._vertexBuffer[2*h[te+1]+1],this._vertexBuffer[2*h[te+2]+0],this._vertexBuffer[2*h[te+2]+1]];let fe=1/0,ye=1/0,be=-1/0,Ee=-1/0;for(let Ye=0;Ye<3;Ye++){const rt=he[2*Ye],dt=he[2*Ye+1];fe=Math.min(fe,rt),be=Math.max(be,rt),ye=Math.min(ye,dt),Ee=Math.max(Ee,dt)}if(fe===be||ye===Ee)continue;const Pe=Math.floor(fe/this._granularityCellSize),Ne=Math.ceil(be/this._granularityCellSize),Ue=Math.floor(ye/this._granularityCellSize),$e=Math.ceil(Ee/this._granularityCellSize);if(Pe!==Ne||Ue!==$e)for(let Ye=Ue;Ye<$e;Ye++){const rt=this._scanlineGenerateVertexRingForCellRow(Ye,he,le);Hf(this._vertexBuffer,rt,W)}else W.push(...le)}return W}_scanlineGenerateVertexRingForCellRow(h,W,X){const te=h*this._granularityCellSize,le=te+this._granularityCellSize,he=[];for(let fe=0;fe<3;fe++){const ye=W[2*fe],be=W[2*fe+1],Ee=W[2*(fe+1)%6],Pe=W[(2*(fe+1)+1)%6],Ne=W[2*(fe+2)%6],Ue=W[(2*(fe+2)+1)%6],$e=Ee-ye,Ye=Pe-be,rt=$e===0,dt=Ye===0,Ct=(te-be)/Ye,vt=(le-be)/Ye,qt=Math.min(Ct,vt),Lt=Math.max(Ct,vt);if(!dt&&(qt>=1||Lt<=0)||dt&&(be<te||be>le)){Pe>=te&&Pe<=le&&he.push(X[(fe+1)%3]);continue}!dt&&qt>0&&he.push(this._vertexToIndex(ye+$e*qt,be+Ye*qt));const Gt=ye+$e*Math.max(qt,0),Xt=ye+$e*Math.min(Lt,1);rt||this._generateIntraEdgeVertices(he,ye,be,Ee,Pe,Gt,Xt),!dt&&Lt<1&&he.push(this._vertexToIndex(ye+$e*Lt,be+Ye*Lt)),(dt||Pe>=te&&Pe<=le)&&he.push(X[(fe+1)%3]),!dt&&(Pe<=te||Pe>=le)&&this._generateInterEdgeVertices(he,ye,be,Ee,Pe,Ne,Ue,Xt,te,le)}return he}_generateIntraEdgeVertices(h,W,X,te,le,he,fe){const ye=te-W,be=le-X,Ee=be===0,Pe=Ee?Math.min(W,te):Math.min(he,fe),Ne=Ee?Math.max(W,te):Math.max(he,fe),Ue=Math.floor(Pe/this._granularityCellSize)+1,$e=Math.ceil(Ne/this._granularityCellSize)-1;if(Ee?W<te:he<fe)for(let Ye=Ue;Ye<=$e;Ye++){const rt=Ye*this._granularityCellSize;h.push(this._vertexToIndex(rt,X+be*(rt-W)/ye))}else for(let Ye=$e;Ye>=Ue;Ye--){const rt=Ye*this._granularityCellSize;h.push(this._vertexToIndex(rt,X+be*(rt-W)/ye))}}_generateInterEdgeVertices(h,W,X,te,le,he,fe,ye,be,Ee){const Pe=le-X,Ne=he-te,Ue=fe-le,$e=(be-le)/Ue,Ye=(Ee-le)/Ue,rt=Math.min($e,Ye),dt=Math.max($e,Ye),Ct=te+Ne*rt;let vt=Math.floor(Math.min(Ct,ye)/this._granularityCellSize)+1,qt=Math.ceil(Math.max(Ct,ye)/this._granularityCellSize)-1,Lt=ye<Ct;const Gt=Ue===0;if(Gt&&(fe===be||fe===Ee))return;if(Gt||rt>=1||dt<=0){const _r=X-fe,lr=he+(W-he)*Math.min((be-fe)/_r,(Ee-fe)/_r);vt=Math.floor(Math.min(lr,ye)/this._granularityCellSize)+1,qt=Math.ceil(Math.max(lr,ye)/this._granularityCellSize)-1,Lt=ye<lr}const Xt=Pe>0?Ee:be;if(Lt)for(let _r=vt;_r<=qt;_r++)h.push(this._vertexToIndex(_r*this._granularityCellSize,Xt));else for(let _r=qt;_r>=vt;_r--)h.push(this._vertexToIndex(_r*this._granularityCellSize,Xt))}_generateOutline(h){const W=[];for(const X of h){const te=Ko(X,this._granularity,!0),le=this._pointArrayToIndices(te),he=[];for(let fe=1;fe<le.length;fe++)he.push(le[fe-1]),he.push(le[fe]);W.push(he)}return W}_handlePoles(h){let W=!1,X=!1;this._canonical&&(this._canonical.y===0&&(W=!0),this._canonical.y===(1<<this._canonical.z)-1&&(X=!0)),(W||X)&&this._fillPoles(h,W,X)}_ensureNoPoleVertices(){const h=this._vertexBuffer;for(let W=0;W<h.length;W+=2){const X=h[W+1];X===Hs&&(h[W+1]=-32767),X===nu&&(h[W+1]=32766)}}_generatePoleQuad(h,W,X,te,le,he){te>le!=(he===Hs)?(h.push(W),h.push(X),h.push(this._vertexToIndex(te,he)),h.push(X),h.push(this._vertexToIndex(le,he)),h.push(this._vertexToIndex(te,he))):(h.push(X),h.push(W),h.push(this._vertexToIndex(te,he)),h.push(this._vertexToIndex(le,he)),h.push(X),h.push(this._vertexToIndex(te,he)))}_fillPoles(h,W,X){const te=this._vertexBuffer,le=ut,he=h.length;for(let fe=2;fe<he;fe+=3){const ye=h[fe-2],be=h[fe-1],Ee=h[fe],Pe=te[2*ye],Ne=te[2*ye+1],Ue=te[2*be],$e=te[2*be+1],Ye=te[2*Ee],rt=te[2*Ee+1];W&&(Ne===0&&$e===0&&this._generatePoleQuad(h,ye,be,Pe,Ue,Hs),$e===0&&rt===0&&this._generatePoleQuad(h,be,Ee,Ue,Ye,Hs),rt===0&&Ne===0&&this._generatePoleQuad(h,Ee,ye,Ye,Pe,Hs)),X&&(Ne===le&&$e===le&&this._generatePoleQuad(h,ye,be,Pe,Ue,nu),$e===le&&rt===le&&this._generatePoleQuad(h,be,Ee,Ue,Ye,nu),rt===le&&Ne===le&&this._generatePoleQuad(h,Ee,ye,Ye,Pe,nu))}}_initializeVertices(h){for(let W=0;W<h.length;W+=2)this._vertexToIndex(h[W],h[W+1])}subdividePolygonInternal(h,W){if(this._used)throw new Error("Subdivision: multiple use not allowed.");this._used=!0;const{flattened:X,holeIndices:te}=(function(fe){const ye=[],be=[];for(const Ee of fe)if(Ee.length!==0){Ee!==fe[0]&&ye.push(be.length/2);for(let Pe=0;Pe<Ee.length;Pe++)be.push(Ee[Pe].x),be.push(Ee[Pe].y)}return{flattened:be,holeIndices:ye}})(h);let le;this._initializeVertices(X);try{const fe=(function(be,Ee,Pe=2){const Ne=Ee&&Ee.length,Ue=Ne?Ee[0]*Pe:be.length;let $e=ed(be,0,Ue,Pe,!0);const Ye=[];if(!$e||$e.next===$e.prev)return Ye;let rt,dt,Ct;if(Ne&&($e=(function(vt,qt,Lt,Gt){const Xt=[];for(let _r=0,lr=qt.length;_r<lr;_r++){const fr=ed(vt,qt[_r]*Gt,_r<lr-1?qt[_r+1]*Gt:vt.length,Gt,!1);fr===fr.next&&(fr.steiner=!0),Xt.push(Gf(fr))}Xt.sort(zf);for(let _r=0;_r<Xt.length;_r++)Lt=Uf(Xt[_r],Lt);return Lt})(be,Ee,$e,Pe)),be.length>80*Pe){rt=be[0],dt=be[1];let vt=rt,qt=dt;for(let Lt=Pe;Lt<Ue;Lt+=Pe){const Gt=be[Lt],Xt=be[Lt+1];Gt<rt&&(rt=Gt),Xt<dt&&(dt=Xt),Gt>vt&&(vt=Gt),Xt>qt&&(qt=Xt)}Ct=Math.max(vt-rt,qt-dt),Ct=Ct!==0?32767/Ct:0}return eu($e,Ye,Pe,rt,dt,Ct,0),Ye})(X,te),ye=this._convertIndices(X,fe);le=this._subdivideTrianglesScanline(ye)}catch(fe){console.error(fe)}let he=[];return W&&(he=this._generateOutline(h)),this._ensureNoPoleVertices(),this._handlePoles(le),{verticesFlattened:this._vertexBuffer,indicesTriangles:le,indicesLineList:he}}_convertIndices(h,W){const X=[];for(let te=0;te<W.length;te++)X.push(this._vertexToIndex(h[2*W[te]],h[2*W[te]+1]));return X}_pointArrayToIndices(h){const W=[];for(let X=0;X<h.length;X++){const te=h[X];W.push(this._vertexToIndex(te.x,te.y))}return W}}function ad(H,h,W,X=!0){return new Wf(W,h).subdividePolygonInternal(H,X)}function Ko(H,h,W=!1){if(!H||H.length<1)return[];if(H.length<2)return[];const X=H[0],te=H[H.length-1],le=W&&(X.x!==te.x||X.y!==te.y);if(h<2)return le?[...H,H[0]]:[...H];const he=Math.floor(ut/h),fe=[];fe.push(new U(H[0].x,H[0].y));const ye=H.length,be=le?ye:ye-1;for(let Ee=0;Ee<be;Ee++){const Pe=H[Ee],Ne=Ee<ye-1?H[Ee+1]:H[0],Ue=Pe.x,$e=Pe.y,Ye=Ne.x,rt=Ne.y,dt=Ue!==Ye,Ct=$e!==rt;if(!dt&&!Ct)continue;const vt=Ye-Ue,qt=rt-$e,Lt=Math.abs(vt),Gt=Math.abs(qt);let Xt=Ue,_r=$e;for(;;){const fr=vt>0?(Math.floor(Xt/he)+1)*he:(Math.ceil(Xt/he)-1)*he,Cr=qt>0?(Math.floor(_r/he)+1)*he:(Math.ceil(_r/he)-1)*he,hr=Math.abs(Xt-fr),pr=Math.abs(_r-Cr),$t=Math.abs(Xt-Ye),zr=Math.abs(_r-rt),Vr=dt?hr/Lt:Number.POSITIVE_INFINITY,kr=Ct?pr/Gt:Number.POSITIVE_INFINITY;if(($t<=hr||!dt)&&(zr<=pr||!Ct))break;if(Vr<kr&&dt||!Ct){Xt=fr,_r+=qt*Vr;const Pr=new U(Xt,Math.round(_r));fe[fe.length-1].x===Pr.x&&fe[fe.length-1].y===Pr.y||fe.push(Pr)}else{Xt+=vt*kr,_r=Cr;const Pr=new U(Math.round(Xt),_r);fe[fe.length-1].x===Pr.x&&fe[fe.length-1].y===Pr.y||fe.push(Pr)}}const lr=new U(Ye,rt);fe[fe.length-1].x===lr.x&&fe[fe.length-1].y===lr.y||fe.push(lr)}return fe}function Hf(H,h,W){if(h.length===0)throw new Error("Subdivision vertex ring is empty.");let X=0,te=H[2*h[0]];for(let ye=1;ye<h.length;ye++){const be=H[2*h[ye]];be<te&&(te=be,X=ye)}const le=h.length;let he=X,fe=(he+1)%le;for(;;){const ye=he-1>=0?he-1:le-1,be=(fe+1)%le,Ee=H[2*h[ye]],Pe=H[2*h[be]],Ne=H[2*h[he]],Ue=H[2*h[he]+1],$e=H[2*h[fe]+1];let Ye=!1;if(Ee<Pe)Ye=!0;else if(Ee>Pe)Ye=!1;else{const rt=$e-Ue,dt=-(H[2*h[fe]]-Ne),Ct=Ue<$e?1:-1;((Ee-Ne)*rt+(H[2*h[ye]+1]-Ue)*dt)*Ct>((Pe-Ne)*rt+(H[2*h[be]+1]-Ue)*dt)*Ct&&(Ye=!0)}if(Ye){const rt=h[ye],dt=h[he],Ct=h[fe];rt!==dt&&rt!==Ct&&dt!==Ct&&W.push(Ct,dt,rt),he--,he<0&&(he=le-1)}else{const rt=h[be],dt=h[he],Ct=h[fe];rt!==dt&&rt!==Ct&&dt!==Ct&&W.push(Ct,dt,rt),fe++,fe>=le&&(fe=0)}if(ye===be)break}}function od(H,h,W,X,te,le,he,fe,ye){const be=te.length/2,Ee=he&&fe&&ye;if(be<si.MAX_VERTEX_ARRAY_LENGTH){const Pe=h.prepareSegment(be,W,X),Ne=Pe.vertexLength;for(let Ye=0;Ye<le.length;Ye+=3)X.emplaceBack(Ne+le[Ye],Ne+le[Ye+1],Ne+le[Ye+2]);let Ue,$e;Pe.vertexLength+=be,Pe.primitiveLength+=le.length/3,Ee&&($e=he.prepareSegment(be,W,fe),Ue=$e.vertexLength,$e.vertexLength+=be);for(let Ye=0;Ye<te.length;Ye+=2)H(te[Ye],te[Ye+1]);if(Ee)for(let Ye=0;Ye<ye.length;Ye++){const rt=ye[Ye];for(let dt=1;dt<rt.length;dt+=2)fe.emplaceBack(Ue+rt[dt-1],Ue+rt[dt]);$e.primitiveLength+=rt.length/2}}else(function(Pe,Ne,Ue,$e,Ye,rt){const dt=[];for(let Gt=0;Gt<$e.length/2;Gt++)dt.push(-1);const Ct={count:0};let vt=0,qt=Pe.getOrCreateLatestSegment(Ne,Ue),Lt=qt.vertexLength;for(let Gt=2;Gt<Ye.length;Gt+=3){const Xt=Ye[Gt-2],_r=Ye[Gt-1],lr=Ye[Gt];let fr=dt[Xt]<vt,Cr=dt[_r]<vt,hr=dt[lr]<vt;qt.vertexLength+((fr?1:0)+(Cr?1:0)+(hr?1:0))>si.MAX_VERTEX_ARRAY_LENGTH&&(qt=Pe.createNewSegment(Ne,Ue),vt=Ct.count,fr=!0,Cr=!0,hr=!0,Lt=0);const pr=au(dt,$e,rt,Ct,Xt,fr,qt),$t=au(dt,$e,rt,Ct,_r,Cr,qt),zr=au(dt,$e,rt,Ct,lr,hr,qt);Ue.emplaceBack(Lt+pr-vt,Lt+$t-vt,Lt+zr-vt),qt.primitiveLength++}})(h,W,X,te,le,H),Ee&&(function(Pe,Ne,Ue,$e,Ye,rt){const dt=[];for(let Gt=0;Gt<$e.length/2;Gt++)dt.push(-1);const Ct={count:0};let vt=0,qt=Pe.getOrCreateLatestSegment(Ne,Ue),Lt=qt.vertexLength;for(let Gt=0;Gt<Ye.length;Gt++){const Xt=Ye[Gt];for(let _r=1;_r<Ye[Gt].length;_r+=2){const lr=Xt[_r-1],fr=Xt[_r];let Cr=dt[lr]<vt,hr=dt[fr]<vt;qt.vertexLength+((Cr?1:0)+(hr?1:0))>si.MAX_VERTEX_ARRAY_LENGTH&&(qt=Pe.createNewSegment(Ne,Ue),vt=Ct.count,Cr=!0,hr=!0,Lt=0);const pr=au(dt,$e,rt,Ct,lr,Cr,qt),$t=au(dt,$e,rt,Ct,fr,hr,qt);Ue.emplaceBack(Lt+pr-vt,Lt+$t-vt),qt.primitiveLength++}}})(he,W,fe,te,ye,H),h.forceNewSegmentOnNextPrepare(),he==null||he.forceNewSegmentOnNextPrepare()}function au(H,h,W,X,te,le,he){if(le){const fe=X.count;return W(h[2*te],h[2*te+1]),H[te]=X.count,X.count++,he.vertexLength++,fe}return H[te]}class uh{constructor(h){this.zoom=h.zoom,this.overscaling=h.overscaling,this.layers=h.layers,this.layerIds=this.layers.map((W=>W.id)),this.index=h.index,this.hasDependencies=!1,this.patternFeatures=[],this.layoutVertexArray=new Ot,this.indexArray=new di,this.indexArray2=new _i,this.programConfigurations=new _a(h.layers,h.zoom),this.segments=new si,this.segments2=new si,this.stateDependentLayerIds=this.layers.filter((W=>W.isStateDependent())).map((W=>W.id))}populate(h,W,X){this.hasDependencies=dc("fill",this.layers,W);const te=this.layers[0].layout.get("fill-sort-key"),le=!te.isConstant(),he=[];for(const{feature:fe,id:ye,index:be,sourceLayerIndex:Ee}of h){const Pe=this.layers[0]._featureFilter.needGeometry,Ne=Ho(fe,Pe);if(!this.layers[0]._featureFilter.filter(new mi(this.zoom),Ne,X))continue;const Ue=le?te.evaluate(Ne,{},X,W.availableImages):void 0,$e={id:ye,properties:fe.properties,type:fe.type,sourceLayerIndex:Ee,index:be,geometry:Pe?Ne.geometry:Wo(fe),patterns:{},sortKey:Ue};he.push($e)}le&&he.sort(((fe,ye)=>fe.sortKey-ye.sortKey));for(const fe of he){const{geometry:ye,index:be,sourceLayerIndex:Ee}=fe;if(this.hasDependencies){const Pe=oh("fill",this.layers,fe,{zoom:this.zoom},W);this.patternFeatures.push(Pe)}else this.addFeature(fe,ye,be,X,{},W.subdivisionGranularity);W.featureIndex.insert(h[be].feature,ye,be,Ee,this.index)}}update(h,W,X){this.stateDependentLayers.length&&this.programConfigurations.updatePaintArrays(h,W,this.stateDependentLayers,{imagePositions:X})}addFeatures(h,W,X){for(const te of this.patternFeatures)this.addFeature(te,te.geometry,te.index,W,X,h.subdivisionGranularity)}isEmpty(){return this.layoutVertexArray.length===0}uploadPending(){return!this.uploaded||this.programConfigurations.needsUpload}upload(h){this.uploaded||(this.layoutVertexBuffer=h.createVertexBuffer(this.layoutVertexArray,kf),this.indexBuffer=h.createIndexBuffer(this.indexArray),this.indexBuffer2=h.createIndexBuffer(this.indexArray2)),this.programConfigurations.upload(h),this.uploaded=!0}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.indexBuffer2.destroy(),this.programConfigurations.destroy(),this.segments.destroy(),this.segments2.destroy())}addFeature(h,W,X,te,le,he){for(const fe of us(W,500)){const ye=ad(fe,te,he.fill.getGranularityForZoomLevel(te.z)),be=this.layoutVertexArray;od(((Ee,Pe)=>{be.emplaceBack(Ee,Pe)}),this.segments,this.layoutVertexArray,this.indexArray,ye.verticesFlattened,ye.indicesTriangles,this.segments2,this.indexArray2,ye.indicesLineList)}this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,h,X,{imagePositions:le,canonical:te})}}let sd,ld;vr("FillBucket",uh,{omit:["layers","patternFeatures"]});var Zf={get paint(){return ld=ld||new pn({"fill-antialias":new Ar(Tt.paint_fill["fill-antialias"]),"fill-opacity":new Br(Tt.paint_fill["fill-opacity"]),"fill-color":new Br(Tt.paint_fill["fill-color"]),"fill-outline-color":new Br(Tt.paint_fill["fill-outline-color"]),"fill-translate":new Ar(Tt.paint_fill["fill-translate"]),"fill-translate-anchor":new Ar(Tt.paint_fill["fill-translate-anchor"]),"fill-pattern":new ao(Tt.paint_fill["fill-pattern"])})},get layout(){return sd=sd||new pn({"fill-sort-key":new Br(Tt.layout_fill["fill-sort-key"])})}};class Kf extends Ln{constructor(h,W){super(h,Zf,W)}recalculate(h,W){super.recalculate(h,W);const X=this.paint._values["fill-outline-color"];X.value.kind==="constant"&&X.value.value===void 0&&(this.paint._values["fill-outline-color"]=this.paint._values["fill-color"])}createBucket(h){return new uh(h)}queryRadius(){return cc(this.paint.get("fill-translate"))}queryIntersectsFeature({queryGeometry:h,geometry:W,transform:X,pixelsToTileUnits:te}){return jh(hc(h,this.paint.get("fill-translate"),this.paint.get("fill-translate-anchor"),-X.bearingInRadians,te),W)}isTileClipped(){return!0}}const Xf=Di([{name:"a_pos",components:2,type:"Int16"},{name:"a_normal_ed",components:4,type:"Int16"}],4),Yf=Di([{name:"a_centroid",components:2,type:"Int16"}],4),{members:Jf}=Xf;class Zs{constructor(h,W,X,te,le){this.properties={},this.extent=X,this.type=0,this.id=void 0,this._pbf=h,this._geometry=-1,this._keys=te,this._values=le,h.readFields(Qf,this,W)}loadGeometry(){const h=this._pbf;h.pos=this._geometry;const W=h.readVarint()+h.pos,X=[];let te,le=1,he=0,fe=0,ye=0;for(;h.pos<W;){if(he<=0){const be=h.readVarint();le=7&be,he=be>>3}if(he--,le===1||le===2)fe+=h.readSVarint(),ye+=h.readSVarint(),le===1&&(te&&X.push(te),te=[]),te&&te.push(new U(fe,ye));else{if(le!==7)throw new Error(`unknown command ${le}`);te&&te.push(te[0].clone())}}return te&&X.push(te),X}bbox(){const h=this._pbf;h.pos=this._geometry;const W=h.readVarint()+h.pos;let X=1,te=0,le=0,he=0,fe=1/0,ye=-1/0,be=1/0,Ee=-1/0;for(;h.pos<W;){if(te<=0){const Pe=h.readVarint();X=7&Pe,te=Pe>>3}if(te--,X===1||X===2)le+=h.readSVarint(),he+=h.readSVarint(),le<fe&&(fe=le),le>ye&&(ye=le),he<be&&(be=he),he>Ee&&(Ee=he);else if(X!==7)throw new Error(`unknown command ${X}`)}return[fe,be,ye,Ee]}toGeoJSON(h,W,X){const te=this.extent*Math.pow(2,X),le=this.extent*h,he=this.extent*W,fe=this.loadGeometry();function ye(Ne){return[360*(Ne.x+le)/te-180,360/Math.PI*Math.atan(Math.exp((1-2*(Ne.y+he)/te)*Math.PI))-90]}function be(Ne){return Ne.map(ye)}let Ee;if(this.type===1){const Ne=[];for(const $e of fe)Ne.push($e[0]);const Ue=be(Ne);Ee=Ne.length===1?{type:"Point",coordinates:Ue[0]}:{type:"MultiPoint",coordinates:Ue}}else if(this.type===2){const Ne=fe.map(be);Ee=Ne.length===1?{type:"LineString",coordinates:Ne[0]}:{type:"MultiLineString",coordinates:Ne}}else{if(this.type!==3)throw new Error("unknown feature type");{const Ne=(function($e){const Ye=$e.length;if(Ye<=1)return[$e];const rt=[];let dt,Ct;for(let vt=0;vt<Ye;vt++){const qt=ep($e[vt]);qt!==0&&(Ct===void 0&&(Ct=qt<0),Ct===qt<0?(dt&&rt.push(dt),dt=[$e[vt]]):dt&&dt.push($e[vt]))}return dt&&rt.push(dt),rt})(fe),Ue=[];for(const $e of Ne)Ue.push($e.map(be));Ee=Ue.length===1?{type:"Polygon",coordinates:Ue[0]}:{type:"MultiPolygon",coordinates:Ue}}}const Pe={type:"Feature",geometry:Ee,properties:this.properties};return this.id!=null&&(Pe.id=this.id),Pe}}function Qf(H,h,W){H===1?h.id=W.readVarint():H===2?(function(X,te){const le=X.readVarint()+X.pos;for(;X.pos<le;){const he=te._keys[X.readVarint()],fe=te._values[X.readVarint()];te.properties[he]=fe}})(W,h):H===3?h.type=W.readVarint():H===4&&(h._geometry=W.pos)}function ep(H){let h=0;for(let W,X,te=0,le=H.length,he=le-1;te<le;he=te++)W=H[te],X=H[he],h+=(X.x-W.x)*(W.y+X.y);return h}Zs.types=["Unknown","Point","LineString","Polygon"];class ud{constructor(h,W){this.version=1,this.name="",this.extent=4096,this.length=0,this._pbf=h,this._keys=[],this._values=[],this._features=[],h.readFields(tp,this,W),this.length=this._features.length}feature(h){if(h<0||h>=this._features.length)throw new Error("feature index out of bounds");this._pbf.pos=this._features[h];const W=this._pbf.readVarint()+this._pbf.pos;return new Zs(this._pbf,W,this.extent,this._keys,this._values)}}function tp(H,h,W){H===15?h.version=W.readVarint():H===1?h.name=W.readString():H===5?h.extent=W.readVarint():H===2?h._features.push(W.pos):H===3?h._keys.push(W.readString()):H===4&&h._values.push((function(X){let te=null;const le=X.readVarint()+X.pos;for(;X.pos<le;){const he=X.readVarint()>>3;te=he===1?X.readString():he===2?X.readFloat():he===3?X.readDouble():he===4?X.readVarint64():he===5?X.readVarint():he===6?X.readSVarint():he===7?X.readBoolean():null}if(te==null)throw new Error("unknown feature value");return te})(W))}class cd{constructor(h,W){this.layers=h.readFields(rp,{},W)}}function rp(H,h,W){if(H===3){const X=new ud(W,W.readVarint()+W.pos);X.length&&(h[X.name]=X)}}const ch=Math.pow(2,13);function ou(H,h,W,X,te,le,he,fe){H.emplaceBack(h,W,2*Math.floor(X*ch)+he,te*ch*2,le*ch*2,Math.round(fe))}class hh{constructor(h){this.zoom=h.zoom,this.overscaling=h.overscaling,this.layers=h.layers,this.layerIds=this.layers.map((W=>W.id)),this.index=h.index,this.hasDependencies=!1,this.layoutVertexArray=new zt,this.centroidVertexArray=new It,this.indexArray=new di,this.programConfigurations=new _a(h.layers,h.zoom),this.segments=new si,this.stateDependentLayerIds=this.layers.filter((W=>W.isStateDependent())).map((W=>W.id))}populate(h,W,X){this.features=[],this.hasDependencies=dc("fill-extrusion",this.layers,W);for(const{feature:te,id:le,index:he,sourceLayerIndex:fe}of h){const ye=this.layers[0]._featureFilter.needGeometry,be=Ho(te,ye);if(!this.layers[0]._featureFilter.filter(new mi(this.zoom),be,X))continue;const Ee={id:le,sourceLayerIndex:fe,index:he,geometry:ye?be.geometry:Wo(te),properties:te.properties,type:te.type,patterns:{}};this.hasDependencies?this.features.push(oh("fill-extrusion",this.layers,Ee,{zoom:this.zoom},W)):this.addFeature(Ee,Ee.geometry,he,X,{},W.subdivisionGranularity),W.featureIndex.insert(te,Ee.geometry,he,fe,this.index,!0)}}addFeatures(h,W,X){for(const te of this.features){const{geometry:le}=te;this.addFeature(te,le,te.index,W,X,h.subdivisionGranularity)}}update(h,W,X){this.stateDependentLayers.length&&this.programConfigurations.updatePaintArrays(h,W,this.stateDependentLayers,{imagePositions:X})}isEmpty(){return this.layoutVertexArray.length===0&&this.centroidVertexArray.length===0}uploadPending(){return!this.uploaded||this.programConfigurations.needsUpload}upload(h){this.uploaded||(this.layoutVertexBuffer=h.createVertexBuffer(this.layoutVertexArray,Jf),this.centroidVertexBuffer=h.createVertexBuffer(this.centroidVertexArray,Yf.members,!0),this.indexBuffer=h.createIndexBuffer(this.indexArray)),this.programConfigurations.upload(h),this.uploaded=!0}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy(),this.centroidVertexBuffer.destroy())}addFeature(h,W,X,te,le,he){for(const fe of us(W,500)){const ye={x:0,y:0,sampleCount:0},be=this.layoutVertexArray.length;this.processPolygon(ye,te,h,fe,he);const Ee=this.layoutVertexArray.length-be,Pe=Math.floor(ye.x/ye.sampleCount),Ne=Math.floor(ye.y/ye.sampleCount);for(let Ue=0;Ue<Ee;Ue++)this.centroidVertexArray.emplaceBack(Pe,Ne)}this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,h,X,{imagePositions:le,canonical:te})}processPolygon(h,W,X,te,le){if(te.length<1||hd(te[0]))return;for(const Pe of te)Pe.length!==0&&ip(h,Pe);const he={segment:this.segments.prepareSegment(4,this.layoutVertexArray,this.indexArray)},fe=le.fill.getGranularityForZoomLevel(W.z),ye=Zs.types[X.type]==="Polygon";for(const Pe of te){if(Pe.length===0||hd(Pe))continue;const Ne=Ko(Pe,fe,ye);this._generateSideFaces(Ne,he)}if(!ye)return;const be=ad(te,W,fe,!1),Ee=this.layoutVertexArray;od(((Pe,Ne)=>{ou(Ee,Pe,Ne,0,0,1,1,0)}),this.segments,this.layoutVertexArray,this.indexArray,be.verticesFlattened,be.indicesTriangles)}_generateSideFaces(h,W){let X=0;for(let te=1;te<h.length;te++){const le=h[te],he=h[te-1];if(np(le,he))continue;W.segment.vertexLength+4>si.MAX_VERTEX_ARRAY_LENGTH&&(W.segment=this.segments.prepareSegment(4,this.layoutVertexArray,this.indexArray));const fe=le.sub(he)._perp()._unit(),ye=he.dist(le);X+ye>32768&&(X=0),ou(this.layoutVertexArray,le.x,le.y,fe.x,fe.y,0,0,X),ou(this.layoutVertexArray,le.x,le.y,fe.x,fe.y,0,1,X),X+=ye,ou(this.layoutVertexArray,he.x,he.y,fe.x,fe.y,0,0,X),ou(this.layoutVertexArray,he.x,he.y,fe.x,fe.y,0,1,X);const be=W.segment.vertexLength;this.indexArray.emplaceBack(be,be+2,be+1),this.indexArray.emplaceBack(be+1,be+2,be+3),W.segment.vertexLength+=4,W.segment.primitiveLength+=2}}}function ip(H,h){for(let W=0;W<h.length;W++){const X=h[W];W===h.length-1&&h[0].x===X.x&&h[0].y===X.y||(H.x+=X.x,H.y+=X.y,H.sampleCount++)}}function np(H,h){return H.x===h.x&&(H.x<0||H.x>ut)||H.y===h.y&&(H.y<0||H.y>ut)}function hd(H){return H.every((h=>h.x<0))||H.every((h=>h.x>ut))||H.every((h=>h.y<0))||H.every((h=>h.y>ut))}let dd;vr("FillExtrusionBucket",hh,{omit:["layers","features"]});var ap={get paint(){return dd=dd||new pn({"fill-extrusion-opacity":new Ar(Tt["paint_fill-extrusion"]["fill-extrusion-opacity"]),"fill-extrusion-color":new Br(Tt["paint_fill-extrusion"]["fill-extrusion-color"]),"fill-extrusion-translate":new Ar(Tt["paint_fill-extrusion"]["fill-extrusion-translate"]),"fill-extrusion-translate-anchor":new Ar(Tt["paint_fill-extrusion"]["fill-extrusion-translate-anchor"]),"fill-extrusion-pattern":new ao(Tt["paint_fill-extrusion"]["fill-extrusion-pattern"]),"fill-extrusion-height":new Br(Tt["paint_fill-extrusion"]["fill-extrusion-height"]),"fill-extrusion-base":new Br(Tt["paint_fill-extrusion"]["fill-extrusion-base"]),"fill-extrusion-vertical-gradient":new Ar(Tt["paint_fill-extrusion"]["fill-extrusion-vertical-gradient"])})}};class op extends Ln{constructor(h,W){super(h,ap,W)}createBucket(h){return new hh(h)}queryRadius(){return cc(this.paint.get("fill-extrusion-translate"))}is3D(){return!0}queryIntersectsFeature({queryGeometry:h,feature:W,featureState:X,geometry:te,transform:le,pixelsToTileUnits:he,pixelPosMatrix:fe}){const ye=hc(h,this.paint.get("fill-extrusion-translate"),this.paint.get("fill-extrusion-translate-anchor"),-le.bearingInRadians,he),be=this.paint.get("fill-extrusion-height").evaluate(W,X),Ee=this.paint.get("fill-extrusion-base").evaluate(W,X),Pe=(function(Ue,$e){const Ye=[];for(const rt of Ue){const dt=[rt.x,rt.y,0,1];_t(dt,dt,$e),Ye.push(new U(dt[0]/dt[3],dt[1]/dt[3]))}return Ye})(ye,fe),Ne=(function(Ue,$e,Ye,rt){const dt=[],Ct=[],vt=rt[8]*$e,qt=rt[9]*$e,Lt=rt[10]*$e,Gt=rt[11]*$e,Xt=rt[8]*Ye,_r=rt[9]*Ye,lr=rt[10]*Ye,fr=rt[11]*Ye;for(const Cr of Ue){const hr=[],pr=[];for(const $t of Cr){const zr=$t.x,Vr=$t.y,kr=rt[0]*zr+rt[4]*Vr+rt[12],Pr=rt[1]*zr+rt[5]*Vr+rt[13],ai=rt[2]*zr+rt[6]*Vr+rt[14],Ci=rt[3]*zr+rt[7]*Vr+rt[15],Vi=ai+Lt,un=Ci+Gt,zn=kr+Xt,In=Pr+_r,nn=ai+lr,Ai=Ci+fr,Xi=new U((kr+vt)/un,(Pr+qt)/un);Xi.z=Vi/un,hr.push(Xi);const an=new U(zn/Ai,In/Ai);an.z=nn/Ai,pr.push(an)}dt.push(hr),Ct.push(pr)}return[dt,Ct]})(te,Ee,be,fe);return(function(Ue,$e,Ye){let rt=1/0;jh(Ye,$e)&&(rt=fd(Ye,$e[0]));for(let dt=0;dt<$e.length;dt++){const Ct=$e[dt],vt=Ue[dt];for(let qt=0;qt<Ct.length-1;qt++){const Lt=Ct[qt],Gt=[Lt,Ct[qt+1],vt[qt+1],vt[qt],Lt];Nh(Ye,Gt)&&(rt=Math.min(rt,fd(Ye,Gt)))}}return rt!==1/0&&rt})(Ne[0],Ne[1],Pe)}}function su(H,h){return H.x*h.x+H.y*h.y}function fd(H,h){if(H.length===1){let W=0;const X=h[W++];let te;for(;!te||X.equals(te);)if(te=h[W++],!te)return 1/0;for(;W<h.length;W++){const le=h[W],he=H[0],fe=te.sub(X),ye=le.sub(X),be=he.sub(X),Ee=su(fe,fe),Pe=su(fe,ye),Ne=su(ye,ye),Ue=su(be,fe),$e=su(be,ye),Ye=Ee*Ne-Pe*Pe,rt=(Ne*Ue-Pe*$e)/Ye,dt=(Ee*$e-Pe*Ue)/Ye,Ct=X.z*(1-rt-dt)+te.z*rt+le.z*dt;if(isFinite(Ct))return Ct}return 1/0}{let W=1/0;for(const X of h)W=Math.min(W,X.z);return W}}const sp=Di([{name:"a_pos_normal",components:2,type:"Int16"},{name:"a_data",components:4,type:"Uint8"}],4),{members:lp}=sp,up=Di([{name:"a_uv_x",components:1,type:"Float32"},{name:"a_split_index",components:1,type:"Float32"}]),{members:cp}=up,hp=Math.cos(Math.PI/180*37.5),pd=Math.pow(2,14)/.5;class dh{constructor(h){this.zoom=h.zoom,this.overscaling=h.overscaling,this.layers=h.layers,this.layerIds=this.layers.map((W=>W.id)),this.index=h.index,this.hasDependencies=!1,this.patternFeatures=[],this.lineClipsArray=[],this.gradients={},this.layers.forEach((W=>{this.gradients[W.id]={}})),this.layoutVertexArray=new kt,this.layoutVertexArray2=new Bt,this.indexArray=new di,this.programConfigurations=new _a(h.layers,h.zoom),this.segments=new si,this.maxLineLength=0,this.stateDependentLayerIds=this.layers.filter((W=>W.isStateDependent())).map((W=>W.id))}populate(h,W,X){this.hasDependencies=dc("line",this.layers,W)||this.hasLineDasharray(this.layers);const te=this.layers[0].layout.get("line-sort-key"),le=!te.isConstant(),he=[];for(const{feature:fe,id:ye,index:be,sourceLayerIndex:Ee}of h){const Pe=this.layers[0]._featureFilter.needGeometry,Ne=Ho(fe,Pe);if(!this.layers[0]._featureFilter.filter(new mi(this.zoom),Ne,X))continue;const Ue=le?te.evaluate(Ne,{},X):void 0,$e={id:ye,properties:fe.properties,type:fe.type,sourceLayerIndex:Ee,index:be,geometry:Pe?Ne.geometry:Wo(fe),patterns:{},dashes:{},sortKey:Ue};he.push($e)}le&&he.sort(((fe,ye)=>fe.sortKey-ye.sortKey));for(const fe of he){const{geometry:ye,index:be,sourceLayerIndex:Ee}=fe;this.hasDependencies?(dc("line",this.layers,W)?oh("line",this.layers,fe,{zoom:this.zoom},W):this.hasLineDasharray(this.layers)&&this.addLineDashDependencies(this.layers,fe,this.zoom,W),this.patternFeatures.push(fe)):this.addFeature(fe,ye,be,X,{},{},W.subdivisionGranularity),W.featureIndex.insert(h[be].feature,ye,be,Ee,this.index)}}update(h,W,X,te){this.stateDependentLayers.length&&this.programConfigurations.updatePaintArrays(h,W,this.stateDependentLayers,{imagePositions:X,dashPositions:te})}addFeatures(h,W,X,te){for(const le of this.patternFeatures)this.addFeature(le,le.geometry,le.index,W,X,te,h.subdivisionGranularity)}isEmpty(){return this.layoutVertexArray.length===0}uploadPending(){return!this.uploaded||this.programConfigurations.needsUpload}upload(h){this.uploaded||(this.layoutVertexArray2.length!==0&&(this.layoutVertexBuffer2=h.createVertexBuffer(this.layoutVertexArray2,cp)),this.layoutVertexBuffer=h.createVertexBuffer(this.layoutVertexArray,lp),this.indexBuffer=h.createIndexBuffer(this.indexArray)),this.programConfigurations.upload(h),this.uploaded=!0}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy())}lineFeatureClips(h){if(h.properties&&Object.prototype.hasOwnProperty.call(h.properties,"mapbox_clip_start")&&Object.prototype.hasOwnProperty.call(h.properties,"mapbox_clip_end"))return{start:+h.properties.mapbox_clip_start,end:+h.properties.mapbox_clip_end}}addFeature(h,W,X,te,le,he,fe){const ye=this.layers[0].layout,be=ye.get("line-join").evaluate(h,{}),Ee=ye.get("line-cap"),Pe=ye.get("line-miter-limit"),Ne=ye.get("line-round-limit");this.lineClips=this.lineFeatureClips(h);for(const Ue of W)this.addLine(Ue,h,be,Ee,Pe,Ne,te,fe);this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,h,X,{imagePositions:le,dashPositions:he,canonical:te})}addLine(h,W,X,te,le,he,fe,ye){if(this.distance=0,this.scaledDistance=0,this.totalDistance=0,h=Ko(h,fe?ye.line.getGranularityForZoomLevel(fe.z):1),this.lineClips){this.lineClipsArray.push(this.lineClips);for(let vt=0;vt<h.length-1;vt++)this.totalDistance+=h[vt].dist(h[vt+1]);this.updateScaledDistance(),this.maxLineLength=Math.max(this.maxLineLength,this.totalDistance)}const be=Zs.types[W.type]==="Polygon";let Ee=h.length;for(;Ee>=2&&h[Ee-1].equals(h[Ee-2]);)Ee--;let Pe=0;for(;Pe<Ee-1&&h[Pe].equals(h[Pe+1]);)Pe++;if(Ee<(be?3:2))return;X==="bevel"&&(le=1.05);const Ne=this.overscaling<=16?122880/(512*this.overscaling):0,Ue=this.segments.prepareSegment(10*Ee,this.layoutVertexArray,this.indexArray);let $e,Ye,rt,dt,Ct;this.e1=this.e2=-1,be&&($e=h[Ee-2],Ct=h[Pe].sub($e)._unit()._perp());for(let vt=Pe;vt<Ee;vt++){if(rt=vt===Ee-1?be?h[Pe+1]:void 0:h[vt+1],rt&&h[vt].equals(rt))continue;Ct&&(dt=Ct),$e&&(Ye=$e),$e=h[vt],Ct=rt?rt.sub($e)._unit()._perp():dt,dt=dt||Ct;let qt=dt.add(Ct);qt.x===0&&qt.y===0||qt._unit();const Lt=dt.x*Ct.x+dt.y*Ct.y,Gt=qt.x*Ct.x+qt.y*Ct.y,Xt=Gt!==0?1/Gt:1/0,_r=2*Math.sqrt(2-2*Gt),lr=Gt<hp&&Ye&&rt,fr=dt.x*Ct.y-dt.y*Ct.x>0;if(lr&&vt>Pe){const pr=$e.dist(Ye);if(pr>2*Ne){const $t=$e.sub($e.sub(Ye)._mult(Ne/pr)._round());this.updateDistance(Ye,$t),this.addCurrentVertex($t,dt,0,0,Ue),Ye=$t}}const Cr=Ye&&rt;let hr=Cr?X:be?"butt":te;if(Cr&&hr==="round"&&(Xt<he?hr="miter":Xt<=2&&(hr="fakeround")),hr==="miter"&&Xt>le&&(hr="bevel"),hr==="bevel"&&(Xt>2&&(hr="flipbevel"),Xt<le&&(hr="miter")),Ye&&this.updateDistance(Ye,$e),hr==="miter")qt._mult(Xt),this.addCurrentVertex($e,qt,0,0,Ue);else if(hr==="flipbevel"){if(Xt>100)qt=Ct.mult(-1);else{const pr=Xt*dt.add(Ct).mag()/dt.sub(Ct).mag();qt._perp()._mult(pr*(fr?-1:1))}this.addCurrentVertex($e,qt,0,0,Ue),this.addCurrentVertex($e,qt.mult(-1),0,0,Ue)}else if(hr==="bevel"||hr==="fakeround"){const pr=-Math.sqrt(Xt*Xt-1),$t=fr?pr:0,zr=fr?0:pr;if(Ye&&this.addCurrentVertex($e,dt,$t,zr,Ue),hr==="fakeround"){const Vr=Math.round(180*_r/Math.PI/20);for(let kr=1;kr<Vr;kr++){let Pr=kr/Vr;if(Pr!==.5){const Ci=Pr-.5;Pr+=Pr*Ci*(Pr-1)*((1.0904+Lt*(Lt*(3.55645-1.43519*Lt)-3.2452))*Ci*Ci+(.848013+Lt*(.215638*Lt-1.06021)))}const ai=Ct.sub(dt)._mult(Pr)._add(dt)._unit()._mult(fr?-1:1);this.addHalfVertex($e,ai.x,ai.y,!1,fr,0,Ue)}}rt&&this.addCurrentVertex($e,Ct,-$t,-zr,Ue)}else if(hr==="butt")this.addCurrentVertex($e,qt,0,0,Ue);else if(hr==="square"){const pr=Ye?1:-1;this.addCurrentVertex($e,qt,pr,pr,Ue)}else hr==="round"&&(Ye&&(this.addCurrentVertex($e,dt,0,0,Ue),this.addCurrentVertex($e,dt,1,1,Ue,!0)),rt&&(this.addCurrentVertex($e,Ct,-1,-1,Ue,!0),this.addCurrentVertex($e,Ct,0,0,Ue)));if(lr&&vt<Ee-1){const pr=$e.dist(rt);if(pr>2*Ne){const $t=$e.add(rt.sub($e)._mult(Ne/pr)._round());this.updateDistance($e,$t),this.addCurrentVertex($t,Ct,0,0,Ue),$e=$t}}}}addCurrentVertex(h,W,X,te,le,he=!1){const fe=W.y*te-W.x,ye=-W.y-W.x*te;this.addHalfVertex(h,W.x+W.y*X,W.y-W.x*X,he,!1,X,le),this.addHalfVertex(h,fe,ye,he,!0,-te,le),this.distance>pd/2&&this.totalDistance===0&&(this.distance=0,this.updateScaledDistance(),this.addCurrentVertex(h,W,X,te,le,he))}addHalfVertex({x:h,y:W},X,te,le,he,fe,ye){const be=.5*(this.lineClips?this.scaledDistance*(pd-1):this.scaledDistance);this.layoutVertexArray.emplaceBack((h<<1)+(le?1:0),(W<<1)+(he?1:0),Math.round(63*X)+128,Math.round(63*te)+128,1+(fe===0?0:fe<0?-1:1)|(63&be)<<2,be>>6),this.lineClips&&this.layoutVertexArray2.emplaceBack((this.scaledDistance-this.lineClips.start)/(this.lineClips.end-this.lineClips.start),this.lineClipsArray.length);const Ee=ye.vertexLength++;this.e1>=0&&this.e2>=0&&(this.indexArray.emplaceBack(this.e1,Ee,this.e2),ye.primitiveLength++),he?this.e2=Ee:this.e1=Ee}updateScaledDistance(){this.scaledDistance=this.lineClips?this.lineClips.start+(this.lineClips.end-this.lineClips.start)*this.distance/this.totalDistance:this.distance}updateDistance(h,W){this.distance+=h.dist(W),this.updateScaledDistance()}hasLineDasharray(h){for(const W of h){const X=W.paint.get("line-dasharray");if(X&&!X.isConstant())return!0}return!1}addLineDashDependencies(h,W,X,te){for(const le of h){const he=le.paint.get("line-dasharray");if(!he||he.value.kind==="constant")continue;const fe=le.layout.get("line-cap")==="round",ye={dasharray:he.value.evaluate({zoom:X-1},W,{}),round:fe},be={dasharray:he.value.evaluate({zoom:X},W,{}),round:fe},Ee={dasharray:he.value.evaluate({zoom:X+1},W,{}),round:fe},Pe=`${ye.dasharray.join(",")},${ye.round}`,Ne=`${be.dasharray.join(",")},${be.round}`,Ue=`${Ee.dasharray.join(",")},${Ee.round}`;te.dashDependencies[Pe]=ye,te.dashDependencies[Ne]=be,te.dashDependencies[Ue]=Ee,W.dashes[le.id]={min:Pe,mid:Ne,max:Ue}}}}let _d,md;vr("LineBucket",dh,{omit:["layers","patternFeatures"]});var yd={get paint(){return md=md||new pn({"line-opacity":new Br(Tt.paint_line["line-opacity"]),"line-color":new Br(Tt.paint_line["line-color"]),"line-translate":new Ar(Tt.paint_line["line-translate"]),"line-translate-anchor":new Ar(Tt.paint_line["line-translate-anchor"]),"line-width":new Br(Tt.paint_line["line-width"]),"line-gap-width":new Br(Tt.paint_line["line-gap-width"]),"line-offset":new Br(Tt.paint_line["line-offset"]),"line-blur":new Br(Tt.paint_line["line-blur"]),"line-dasharray":new ao(Tt.paint_line["line-dasharray"]),"line-pattern":new ao(Tt.paint_line["line-pattern"]),"line-gradient":new Bs(Tt.paint_line["line-gradient"])})},get layout(){return _d=_d||new pn({"line-cap":new Ar(Tt.layout_line["line-cap"]),"line-join":new Br(Tt.layout_line["line-join"]),"line-miter-limit":new Ar(Tt.layout_line["line-miter-limit"]),"line-round-limit":new Ar(Tt.layout_line["line-round-limit"]),"line-sort-key":new Br(Tt.layout_line["line-sort-key"])})}};class dp extends Br{possiblyEvaluate(h,W){return W=new mi(Math.floor(W.zoom),{now:W.now,fadeDuration:W.fadeDuration,zoomHistory:W.zoomHistory,transition:W.transition}),super.possiblyEvaluate(h,W)}evaluate(h,W,X,te){return W=Wt({},W,{zoom:Math.floor(W.zoom)}),super.evaluate(h,W,X,te)}}let mc;class fp extends Ln{constructor(h,W){super(h,yd,W),this.gradientVersion=0,mc||(mc=new dp(yd.paint.properties["line-width"].specification),mc.useIntegerZoom=!0)}_handleSpecialPaintPropertyUpdate(h){if(h==="line-gradient"){const W=this.gradientExpression();this.stepInterpolant=!!(function(X){return X._styleExpression!==void 0})(W)&&W._styleExpression.expression instanceof aa,this.gradientVersion=(this.gradientVersion+1)%Number.MAX_SAFE_INTEGER}}gradientExpression(){return this._transitionablePaint._values["line-gradient"].value.expression}recalculate(h,W){super.recalculate(h,W),this.paint._values["line-floorwidth"]=mc.possiblyEvaluate(this._transitioningPaint._values["line-width"].value,h)}createBucket(h){return new dh(h)}queryRadius(h){const W=h,X=gd(Gs("line-width",this,W),Gs("line-gap-width",this,W)),te=Gs("line-offset",this,W);return X/2+Math.abs(te)+cc(this.paint.get("line-translate"))}queryIntersectsFeature({queryGeometry:h,feature:W,featureState:X,geometry:te,transform:le,pixelsToTileUnits:he}){const fe=hc(h,this.paint.get("line-translate"),this.paint.get("line-translate-anchor"),-le.bearingInRadians,he),ye=he/2*gd(this.paint.get("line-width").evaluate(W,X),this.paint.get("line-gap-width").evaluate(W,X)),be=this.paint.get("line-offset").evaluate(W,X);return be&&(te=(function(Ee,Pe){const Ne=[];for(let Ue=0;Ue<Ee.length;Ue++){const $e=Ee[Ue],Ye=[];for(let rt=0;rt<$e.length;rt++){const dt=$e[rt-1],Ct=$e[rt],vt=$e[rt+1],qt=rt===0?new U(0,0):Ct.sub(dt)._unit()._perp(),Lt=rt===$e.length-1?new U(0,0):vt.sub(Ct)._unit()._perp(),Gt=qt._add(Lt)._unit(),Xt=Gt.x*Lt.x+Gt.y*Lt.y;Xt!==0&&Gt._mult(1/Xt),Ye.push(Gt._mult(Pe)._add(Ct))}Ne.push(Ye)}return Ne})(te,be*he)),(function(Ee,Pe,Ne){for(let Ue=0;Ue<Pe.length;Ue++){const $e=Pe[Ue];if(Ee.length>=3){for(let Ye=0;Ye<$e.length;Ye++)if(Vs(Ee,$e[Ye]))return!0}if(bf(Ee,$e,Ne))return!0}return!1})(fe,te,ye)}isTileClipped(){return!0}}function gd(H,h){return h>0?h+2*H:H}const pp=Di([{name:"a_pos_offset",components:4,type:"Int16"},{name:"a_data",components:4,type:"Uint16"},{name:"a_pixeloffset",components:4,type:"Int16"}],4),_p=Di([{name:"a_projected_pos",components:3,type:"Float32"}],4);Di([{name:"a_fade_opacity",components:1,type:"Uint32"}],4);const mp=Di([{name:"a_placed",components:2,type:"Uint8"},{name:"a_shift",components:2,type:"Float32"},{name:"a_box_real",components:2,type:"Int16"}]);Di([{type:"Int16",name:"anchorPointX"},{type:"Int16",name:"anchorPointY"},{type:"Int16",name:"x1"},{type:"Int16",name:"y1"},{type:"Int16",name:"x2"},{type:"Int16",name:"y2"},{type:"Uint32",name:"featureIndex"},{type:"Uint16",name:"sourceLayerIndex"},{type:"Uint16",name:"bucketIndex"}]);const vd=Di([{name:"a_pos",components:2,type:"Int16"},{name:"a_anchor_pos",components:2,type:"Int16"},{name:"a_extrude",components:2,type:"Int16"}],4),yp=Di([{name:"a_pos",components:2,type:"Float32"},{name:"a_radius",components:1,type:"Float32"},{name:"a_flags",components:2,type:"Int16"}],4);function gp(H,h,W){return H.sections.forEach((X=>{X.text=(function(te,le,he){const fe=le.layout.get("text-transform").evaluate(he,{});return fe==="uppercase"?te=te.toLocaleUpperCase():fe==="lowercase"&&(te=te.toLocaleLowerCase()),la.applyArabicShaping&&(te=la.applyArabicShaping(te)),te})(X.text,h,W)})),H}Di([{name:"triangle",components:3,type:"Uint16"}]),Di([{type:"Int16",name:"anchorX"},{type:"Int16",name:"anchorY"},{type:"Uint16",name:"glyphStartIndex"},{type:"Uint16",name:"numGlyphs"},{type:"Uint32",name:"vertexStartIndex"},{type:"Uint32",name:"lineStartIndex"},{type:"Uint32",name:"lineLength"},{type:"Uint16",name:"segment"},{type:"Uint16",name:"lowerSize"},{type:"Uint16",name:"upperSize"},{type:"Float32",name:"lineOffsetX"},{type:"Float32",name:"lineOffsetY"},{type:"Uint8",name:"writingMode"},{type:"Uint8",name:"placedOrientation"},{type:"Uint8",name:"hidden"},{type:"Uint32",name:"crossTileID"},{type:"Int16",name:"associatedIconIndex"}]),Di([{type:"Int16",name:"anchorX"},{type:"Int16",name:"anchorY"},{type:"Int16",name:"rightJustifiedTextSymbolIndex"},{type:"Int16",name:"centerJustifiedTextSymbolIndex"},{type:"Int16",name:"leftJustifiedTextSymbolIndex"},{type:"Int16",name:"verticalPlacedTextSymbolIndex"},{type:"Int16",name:"placedIconSymbolIndex"},{type:"Int16",name:"verticalPlacedIconSymbolIndex"},{type:"Uint16",name:"key"},{type:"Uint16",name:"textBoxStartIndex"},{type:"Uint16",name:"textBoxEndIndex"},{type:"Uint16",name:"verticalTextBoxStartIndex"},{type:"Uint16",name:"verticalTextBoxEndIndex"},{type:"Uint16",name:"iconBoxStartIndex"},{type:"Uint16",name:"iconBoxEndIndex"},{type:"Uint16",name:"verticalIconBoxStartIndex"},{type:"Uint16",name:"verticalIconBoxEndIndex"},{type:"Uint16",name:"featureIndex"},{type:"Uint16",name:"numHorizontalGlyphVertices"},{type:"Uint16",name:"numVerticalGlyphVertices"},{type:"Uint16",name:"numIconVertices"},{type:"Uint16",name:"numVerticalIconVertices"},{type:"Uint16",name:"useRuntimeCollisionCircles"},{type:"Uint32",name:"crossTileID"},{type:"Float32",name:"textBoxScale"},{type:"Float32",name:"collisionCircleDiameter"},{type:"Uint16",name:"textAnchorOffsetStartIndex"},{type:"Uint16",name:"textAnchorOffsetEndIndex"}]),Di([{type:"Float32",name:"offsetX"}]),Di([{type:"Int16",name:"x"},{type:"Int16",name:"y"},{type:"Int16",name:"tileUnitDistanceFromAnchor"}]),Di([{type:"Uint16",name:"textAnchor"},{type:"Float32",components:2,name:"textOffset"}]);const lu={"!":"ï¸","#":"ï¼",$:"ï¼","%":"ï¼","&":"ï¼","(":"ï¸µ",")":"ï¸¶","*":"ï¼","+":"ï¼",",":"ï¸","-":"ï¸²",".":"ã»","/":"ï¼",":":"ï¸",";":"ï¸","<":"ï¸¿","=":"ï¼",">":"ï¹","?":"ï¸","@":"ï¼ ","[":"ï¹","\\":"ï¼¼","]":"ï¹","^":"ï¼¾",_:"ï¸³","`":"ï½","{":"ï¸·","|":"â","}":"ï¸¸","~":"ï½","Â¢":"ï¿ ","Â£":"ï¿¡","Â¥":"ï¿¥","Â¦":"ï¿¤","Â¬":"ï¿¢","Â¯":"ï¿£","â":"ï¸²","â":"ï¸±","â":"ï¹","â":"ï¹","â":"ï¹","â":"ï¹","â¦":"ï¸","â§":"ã»","â©":"ï¿¦","ã":"ï¸","ã":"ï¸","ã":"ï¸¿","ã":"ï¹","ã":"ï¸½","ã":"ï¸¾","ã":"ï¹","ã":"ï¹","ã":"ï¹","ã":"ï¹","ã":"ï¸»","ã":"ï¸¼","ã":"ï¸¹","ã":"ï¸º","ã":"ï¸","ã":"ï¸","ï¼":"ï¸","ï¼":"ï¸µ","ï¼":"ï¸¶","ï¼":"ï¸","ï¼":"ï¸²","ï¼":"ã»","ï¼":"ï¸","ï¼":"ï¸","ï¼":"ï¸¿","ï¼":"ï¹","ï¼":"ï¸","ï¼»":"ï¹","ï¼½":"ï¹","ï¼¿":"ï¸³","ï½":"ï¸·","ï½":"â","ï½":"ï¸¸","ï½":"ï¸µ","ï½ ":"ï¸¶","ï½¡":"ï¸","ï½¢":"ï¹","ï½£":"ï¹"};var Ki=24;const fh=4294967296,bd=1/fh,xd=typeof TextDecoder>"u"?null:new TextDecoder("utf-8");class ph{constructor(h=new Uint8Array(16)){this.buf=ArrayBuffer.isView(h)?h:new Uint8Array(h),this.dataView=new DataView(this.buf.buffer),this.pos=0,this.type=0,this.length=this.buf.length}readFields(h,W,X=this.length){for(;this.pos<X;){const te=this.readVarint(),le=te>>3,he=this.pos;this.type=7&te,h(le,W,this),this.pos===he&&this.skip(te)}return W}readMessage(h,W){return this.readFields(h,W,this.readVarint()+this.pos)}readFixed32(){const h=this.dataView.getUint32(this.pos,!0);return this.pos+=4,h}readSFixed32(){const h=this.dataView.getInt32(this.pos,!0);return this.pos+=4,h}readFixed64(){const h=this.dataView.getUint32(this.pos,!0)+this.dataView.getUint32(this.pos+4,!0)*fh;return this.pos+=8,h}readSFixed64(){const h=this.dataView.getUint32(this.pos,!0)+this.dataView.getInt32(this.pos+4,!0)*fh;return this.pos+=8,h}readFloat(){const h=this.dataView.getFloat32(this.pos,!0);return this.pos+=4,h}readDouble(){const h=this.dataView.getFloat64(this.pos,!0);return this.pos+=8,h}readVarint(h){const W=this.buf;let X,te;return te=W[this.pos++],X=127&te,te<128?X:(te=W[this.pos++],X|=(127&te)<<7,te<128?X:(te=W[this.pos++],X|=(127&te)<<14,te<128?X:(te=W[this.pos++],X|=(127&te)<<21,te<128?X:(te=W[this.pos],X|=(15&te)<<28,(function(le,he,fe){const ye=fe.buf;let be,Ee;if(Ee=ye[fe.pos++],be=(112&Ee)>>4,Ee<128||(Ee=ye[fe.pos++],be|=(127&Ee)<<3,Ee<128)||(Ee=ye[fe.pos++],be|=(127&Ee)<<10,Ee<128)||(Ee=ye[fe.pos++],be|=(127&Ee)<<17,Ee<128)||(Ee=ye[fe.pos++],be|=(127&Ee)<<24,Ee<128)||(Ee=ye[fe.pos++],be|=(1&Ee)<<31,Ee<128))return Ks(le,be,he);throw new Error("Expected varint not more than 10 bytes")})(X,h,this)))))}readVarint64(){return this.readVarint(!0)}readSVarint(){const h=this.readVarint();return h%2==1?(h+1)/-2:h/2}readBoolean(){return!!this.readVarint()}readString(){const h=this.readVarint()+this.pos,W=this.pos;return this.pos=h,h-W>=12&&xd?xd.decode(this.buf.subarray(W,h)):(function(X,te,le){let he="",fe=te;for(;fe<le;){const ye=X[fe];let be,Ee,Pe,Ne=null,Ue=ye>239?4:ye>223?3:ye>191?2:1;if(fe+Ue>le)break;Ue===1?ye<128&&(Ne=ye):Ue===2?(be=X[fe+1],(192&be)==128&&(Ne=(31&ye)<<6|63&be,Ne<=127&&(Ne=null))):Ue===3?(be=X[fe+1],Ee=X[fe+2],(192&be)==128&&(192&Ee)==128&&(Ne=(15&ye)<<12|(63&be)<<6|63&Ee,(Ne<=2047||Ne>=55296&&Ne<=57343)&&(Ne=null))):Ue===4&&(be=X[fe+1],Ee=X[fe+2],Pe=X[fe+3],(192&be)==128&&(192&Ee)==128&&(192&Pe)==128&&(Ne=(15&ye)<<18|(63&be)<<12|(63&Ee)<<6|63&Pe,(Ne<=65535||Ne>=1114112)&&(Ne=null))),Ne===null?(Ne=65533,Ue=1):Ne>65535&&(Ne-=65536,he+=String.fromCharCode(Ne>>>10&1023|55296),Ne=56320|1023&Ne),he+=String.fromCharCode(Ne),fe+=Ue}return he})(this.buf,W,h)}readBytes(){const h=this.readVarint()+this.pos,W=this.buf.subarray(this.pos,h);return this.pos=h,W}readPackedVarint(h=[],W){const X=this.readPackedEnd();for(;this.pos<X;)h.push(this.readVarint(W));return h}readPackedSVarint(h=[]){const W=this.readPackedEnd();for(;this.pos<W;)h.push(this.readSVarint());return h}readPackedBoolean(h=[]){const W=this.readPackedEnd();for(;this.pos<W;)h.push(this.readBoolean());return h}readPackedFloat(h=[]){const W=this.readPackedEnd();for(;this.pos<W;)h.push(this.readFloat());return h}readPackedDouble(h=[]){const W=this.readPackedEnd();for(;this.pos<W;)h.push(this.readDouble());return h}readPackedFixed32(h=[]){const W=this.readPackedEnd();for(;this.pos<W;)h.push(this.readFixed32());return h}readPackedSFixed32(h=[]){const W=this.readPackedEnd();for(;this.pos<W;)h.push(this.readSFixed32());return h}readPackedFixed64(h=[]){const W=this.readPackedEnd();for(;this.pos<W;)h.push(this.readFixed64());return h}readPackedSFixed64(h=[]){const W=this.readPackedEnd();for(;this.pos<W;)h.push(this.readSFixed64());return h}readPackedEnd(){return this.type===2?this.readVarint()+this.pos:this.pos+1}skip(h){const W=7&h;if(W===0)for(;this.buf[this.pos++]>127;);else if(W===2)this.pos=this.readVarint()+this.pos;else if(W===5)this.pos+=4;else{if(W!==1)throw new Error(`Unimplemented type: ${W}`);this.pos+=8}}writeTag(h,W){this.writeVarint(h<<3|W)}realloc(h){let W=this.length||16;for(;W<this.pos+h;)W*=2;if(W!==this.length){const X=new Uint8Array(W);X.set(this.buf),this.buf=X,this.dataView=new DataView(X.buffer),this.length=W}}finish(){return this.length=this.pos,this.pos=0,this.buf.subarray(0,this.length)}writeFixed32(h){this.realloc(4),this.dataView.setInt32(this.pos,h,!0),this.pos+=4}writeSFixed32(h){this.realloc(4),this.dataView.setInt32(this.pos,h,!0),this.pos+=4}writeFixed64(h){this.realloc(8),this.dataView.setInt32(this.pos,-1&h,!0),this.dataView.setInt32(this.pos+4,Math.floor(h*bd),!0),this.pos+=8}writeSFixed64(h){this.realloc(8),this.dataView.setInt32(this.pos,-1&h,!0),this.dataView.setInt32(this.pos+4,Math.floor(h*bd),!0),this.pos+=8}writeVarint(h){(h=+h||0)>268435455||h<0?(function(W,X){let te,le;if(W>=0?(te=W%4294967296|0,le=W/4294967296|0):(te=~(-W%4294967296),le=~(-W/4294967296),4294967295^te?te=te+1|0:(te=0,le=le+1|0)),W>=18446744073709552e3||W<-18446744073709552e3)throw new Error("Given varint doesn't fit into 10 bytes");X.realloc(10),(function(he,fe,ye){ye.buf[ye.pos++]=127&he|128,he>>>=7,ye.buf[ye.pos++]=127&he|128,he>>>=7,ye.buf[ye.pos++]=127&he|128,he>>>=7,ye.buf[ye.pos++]=127&he|128,ye.buf[ye.pos]=127&(he>>>=7)})(te,0,X),(function(he,fe){const ye=(7&he)<<4;fe.buf[fe.pos++]|=ye|((he>>>=3)?128:0),he&&(fe.buf[fe.pos++]=127&he|((he>>>=7)?128:0),he&&(fe.buf[fe.pos++]=127&he|((he>>>=7)?128:0),he&&(fe.buf[fe.pos++]=127&he|((he>>>=7)?128:0),he&&(fe.buf[fe.pos++]=127&he|((he>>>=7)?128:0),he&&(fe.buf[fe.pos++]=127&he)))))})(le,X)})(h,this):(this.realloc(4),this.buf[this.pos++]=127&h|(h>127?128:0),h<=127||(this.buf[this.pos++]=127&(h>>>=7)|(h>127?128:0),h<=127||(this.buf[this.pos++]=127&(h>>>=7)|(h>127?128:0),h<=127||(this.buf[this.pos++]=h>>>7&127))))}writeSVarint(h){this.writeVarint(h<0?2*-h-1:2*h)}writeBoolean(h){this.writeVarint(+h)}writeString(h){h=String(h),this.realloc(4*h.length),this.pos++;const W=this.pos;this.pos=(function(te,le,he){for(let fe,ye,be=0;be<le.length;be++){if(fe=le.charCodeAt(be),fe>55295&&fe<57344){if(!ye){fe>56319||be+1===le.length?(te[he++]=239,te[he++]=191,te[he++]=189):ye=fe;continue}if(fe<56320){te[he++]=239,te[he++]=191,te[he++]=189,ye=fe;continue}fe=ye-55296<<10|fe-56320|65536,ye=null}else ye&&(te[he++]=239,te[he++]=191,te[he++]=189,ye=null);fe<128?te[he++]=fe:(fe<2048?te[he++]=fe>>6|192:(fe<65536?te[he++]=fe>>12|224:(te[he++]=fe>>18|240,te[he++]=fe>>12&63|128),te[he++]=fe>>6&63|128),te[he++]=63&fe|128)}return he})(this.buf,h,this.pos);const X=this.pos-W;X>=128&&wd(W,X,this),this.pos=W-1,this.writeVarint(X),this.pos+=X}writeFloat(h){this.realloc(4),this.dataView.setFloat32(this.pos,h,!0),this.pos+=4}writeDouble(h){this.realloc(8),this.dataView.setFloat64(this.pos,h,!0),this.pos+=8}writeBytes(h){const W=h.length;this.writeVarint(W),this.realloc(W);for(let X=0;X<W;X++)this.buf[this.pos++]=h[X]}writeRawMessage(h,W){this.pos++;const X=this.pos;h(W,this);const te=this.pos-X;te>=128&&wd(X,te,this),this.pos=X-1,this.writeVarint(te),this.pos+=te}writeMessage(h,W,X){this.writeTag(h,2),this.writeRawMessage(W,X)}writePackedVarint(h,W){W.length&&this.writeMessage(h,vp,W)}writePackedSVarint(h,W){W.length&&this.writeMessage(h,bp,W)}writePackedBoolean(h,W){W.length&&this.writeMessage(h,Sp,W)}writePackedFloat(h,W){W.length&&this.writeMessage(h,xp,W)}writePackedDouble(h,W){W.length&&this.writeMessage(h,wp,W)}writePackedFixed32(h,W){W.length&&this.writeMessage(h,Ep,W)}writePackedSFixed32(h,W){W.length&&this.writeMessage(h,qp,W)}writePackedFixed64(h,W){W.length&&this.writeMessage(h,Tp,W)}writePackedSFixed64(h,W){W.length&&this.writeMessage(h,Ip,W)}writeBytesField(h,W){this.writeTag(h,2),this.writeBytes(W)}writeFixed32Field(h,W){this.writeTag(h,5),this.writeFixed32(W)}writeSFixed32Field(h,W){this.writeTag(h,5),this.writeSFixed32(W)}writeFixed64Field(h,W){this.writeTag(h,1),this.writeFixed64(W)}writeSFixed64Field(h,W){this.writeTag(h,1),this.writeSFixed64(W)}writeVarintField(h,W){this.writeTag(h,0),this.writeVarint(W)}writeSVarintField(h,W){this.writeTag(h,0),this.writeSVarint(W)}writeStringField(h,W){this.writeTag(h,2),this.writeString(W)}writeFloatField(h,W){this.writeTag(h,5),this.writeFloat(W)}writeDoubleField(h,W){this.writeTag(h,1),this.writeDouble(W)}writeBooleanField(h,W){this.writeVarintField(h,+W)}}function Ks(H,h,W){return W?4294967296*h+(H>>>0):4294967296*(h>>>0)+(H>>>0)}function wd(H,h,W){const X=h<=16383?1:h<=2097151?2:h<=268435455?3:Math.floor(Math.log(h)/(7*Math.LN2));W.realloc(X);for(let te=W.pos-1;te>=H;te--)W.buf[te+X]=W.buf[te]}function vp(H,h){for(let W=0;W<H.length;W++)h.writeVarint(H[W])}function bp(H,h){for(let W=0;W<H.length;W++)h.writeSVarint(H[W])}function xp(H,h){for(let W=0;W<H.length;W++)h.writeFloat(H[W])}function wp(H,h){for(let W=0;W<H.length;W++)h.writeDouble(H[W])}function Sp(H,h){for(let W=0;W<H.length;W++)h.writeBoolean(H[W])}function Ep(H,h){for(let W=0;W<H.length;W++)h.writeFixed32(H[W])}function qp(H,h){for(let W=0;W<H.length;W++)h.writeSFixed32(H[W])}function Tp(H,h){for(let W=0;W<H.length;W++)h.writeFixed64(H[W])}function Ip(H,h){for(let W=0;W<H.length;W++)h.writeSFixed64(H[W])}function Rp(H,h,W){H===1&&W.readMessage(Ap,h)}function Ap(H,h,W){if(H===3){const{id:X,bitmap:te,width:le,height:he,left:fe,top:ye,advance:be}=W.readMessage(Pp,{});h.push({id:X,bitmap:new Ql({width:le+6,height:he+6},te),metrics:{width:le,height:he,left:fe,top:ye,advance:be}})}}function Pp(H,h,W){H===1?h.id=W.readVarint():H===2?h.bitmap=W.readBytes():H===3?h.width=W.readVarint():H===4?h.height=W.readVarint():H===5?h.left=W.readSVarint():H===6?h.top=W.readSVarint():H===7&&(h.advance=W.readVarint())}function Sd(H){let h=0,W=0;for(const he of H)h+=he.w*he.h,W=Math.max(W,he.w);H.sort(((he,fe)=>fe.h-he.h));const X=[{x:0,y:0,w:Math.max(Math.ceil(Math.sqrt(h/.95)),W),h:1/0}];let te=0,le=0;for(const he of H)for(let fe=X.length-1;fe>=0;fe--){const ye=X[fe];if(!(he.w>ye.w||he.h>ye.h)){if(he.x=ye.x,he.y=ye.y,le=Math.max(le,he.y+he.h),te=Math.max(te,he.x+he.w),he.w===ye.w&&he.h===ye.h){const be=X.pop();be&&fe<X.length&&(X[fe]=be)}else he.h===ye.h?(ye.x+=he.w,ye.w-=he.w):he.w===ye.w?(ye.y+=he.h,ye.h-=he.h):(X.push({x:ye.x+he.w,y:ye.y,w:ye.w-he.w,h:he.h}),ye.y+=he.h,ye.h-=he.h);break}}return{w:te,h:le,fill:h/(te*le)||0}}class _h{constructor(h,{pixelRatio:W,version:X,stretchX:te,stretchY:le,content:he,textFitWidth:fe,textFitHeight:ye}){this.paddedRect=h,this.pixelRatio=W,this.stretchX=te,this.stretchY=le,this.content=he,this.version=X,this.textFitWidth=fe,this.textFitHeight=ye}get tl(){return[this.paddedRect.x+1,this.paddedRect.y+1]}get br(){return[this.paddedRect.x+this.paddedRect.w-1,this.paddedRect.y+this.paddedRect.h-1]}get tlbr(){return this.tl.concat(this.br)}get displaySize(){return[(this.paddedRect.w-2)/this.pixelRatio,(this.paddedRect.h-2)/this.pixelRatio]}}class Ed{constructor(h,W){const X={},te={};this.haveRenderCallbacks=[];const le=[];this.addImages(h,X,le),this.addImages(W,te,le);const{w:he,h:fe}=Sd(le),ye=new Tn({width:he||1,height:fe||1});for(const be in h){const Ee=h[be],Pe=X[be].paddedRect;Tn.copy(Ee.data,ye,{x:0,y:0},{x:Pe.x+1,y:Pe.y+1},Ee.data)}for(const be in W){const Ee=W[be],Pe=te[be].paddedRect,Ne=Pe.x+1,Ue=Pe.y+1,$e=Ee.data.width,Ye=Ee.data.height;Tn.copy(Ee.data,ye,{x:0,y:0},{x:Ne,y:Ue},Ee.data),Tn.copy(Ee.data,ye,{x:0,y:Ye-1},{x:Ne,y:Ue-1},{width:$e,height:1}),Tn.copy(Ee.data,ye,{x:0,y:0},{x:Ne,y:Ue+Ye},{width:$e,height:1}),Tn.copy(Ee.data,ye,{x:$e-1,y:0},{x:Ne-1,y:Ue},{width:1,height:Ye}),Tn.copy(Ee.data,ye,{x:0,y:0},{x:Ne+$e,y:Ue},{width:1,height:Ye})}this.image=ye,this.iconPositions=X,this.patternPositions=te}addImages(h,W,X){for(const te in h){const le=h[te],he={x:0,y:0,w:le.data.width+2,h:le.data.height+2};X.push(he),W[te]=new _h(he,le),le.hasRenderCallback&&this.haveRenderCallbacks.push(te)}}patchUpdatedImages(h,W){h.dispatchRenderCallbacks(this.haveRenderCallbacks);for(const X in h.updatedImages)this.patchUpdatedImage(this.iconPositions[X],h.getImage(X),W),this.patchUpdatedImage(this.patternPositions[X],h.getImage(X),W)}patchUpdatedImage(h,W,X){if(!h||!W||h.version===W.version)return;h.version=W.version;const[te,le]=h.tl;X.update(W.data,void 0,{x:te,y:le})}}var co;vr("ImagePosition",_h),vr("ImageAtlas",Ed),ee.ao=void 0,(co=ee.ao||(ee.ao={}))[co.none=0]="none",co[co.horizontal=1]="horizontal",co[co.vertical=2]="vertical",co[co.horizontalOnly=3]="horizontalOnly";class uu{constructor(){this.scale=1,this.fontStack="",this.imageName=null,this.verticalAlign="bottom"}static forText(h,W,X){const te=new uu;return te.scale=h||1,te.fontStack=W,te.verticalAlign=X||"bottom",te}static forImage(h,W){const X=new uu;return X.imageName=h,X.verticalAlign=W||"bottom",X}}class Xs{constructor(){this.text="",this.sectionIndex=[],this.sections=[],this.imageSectionID=null}static fromFeature(h,W){const X=new Xs;for(let te=0;te<h.sections.length;te++){const le=h.sections[te];le.image?X.addImageSection(le):X.addTextSection(le,W)}return X}length(){return this.text.length}getSection(h){return this.sections[this.sectionIndex[h]]}getSectionIndex(h){return this.sectionIndex[h]}getCharCode(h){return this.text.charCodeAt(h)}verticalizePunctuation(){this.text=(function(h){let W="";for(let X=0;X<h.length;X++){const te=h.charCodeAt(X+1)||null,le=h.charCodeAt(X-1)||null;W+=te&&ec(te)&&!lu[h[X+1]]||le&&ec(le)&&!lu[h[X-1]]||!lu[h[X]]?h[X]:lu[h[X]]}return W})(this.text)}trim(){let h=0;for(let X=0;X<this.text.length&&gc[this.text.charCodeAt(X)];X++)h++;let W=this.text.length;for(let X=this.text.length-1;X>=0&&X>=h&&gc[this.text.charCodeAt(X)];X--)W--;this.text=this.text.substring(h,W),this.sectionIndex=this.sectionIndex.slice(h,W)}substring(h,W){const X=new Xs;return X.text=this.text.substring(h,W),X.sectionIndex=this.sectionIndex.slice(h,W),X.sections=this.sections,X}toString(){return this.text}getMaxScale(){return this.sectionIndex.reduce(((h,W)=>Math.max(h,this.sections[W].scale)),0)}getMaxImageSize(h){let W=0,X=0;for(let te=0;te<this.length();te++){const le=this.getSection(te);if(le.imageName){const he=h[le.imageName];if(!he)continue;const fe=he.displaySize;W=Math.max(W,fe[0]),X=Math.max(X,fe[1])}}return{maxImageWidth:W,maxImageHeight:X}}addTextSection(h,W){this.text+=h.text,this.sections.push(uu.forText(h.scale,h.fontStack||W,h.verticalAlign));const X=this.sections.length-1;for(let te=0;te<h.text.length;++te)this.sectionIndex.push(X)}addImageSection(h){const W=h.image?h.image.name:"";if(W.length===0)return void Mr("Can't add FormattedSection with an empty image.");const X=this.getNextImageSectionCharCode();X?(this.text+=String.fromCharCode(X),this.sections.push(uu.forImage(W,h.verticalAlign)),this.sectionIndex.push(this.sections.length-1)):Mr("Reached maximum number of images 6401")}getNextImageSectionCharCode(){return this.imageSectionID?this.imageSectionID>=63743?null:++this.imageSectionID:(this.imageSectionID=57344,this.imageSectionID)}}function yc(H,h,W,X,te,le,he,fe,ye,be,Ee,Pe,Ne,Ue,$e){const Ye=Xs.fromFeature(H,te);let rt;Pe===ee.ao.vertical&&Ye.verticalizePunctuation();const{processBidirectionalText:dt,processStyledBidirectionalText:Ct}=la;if(dt&&Ye.sections.length===1){rt=[];const Lt=dt(Ye.toString(),mh(Ye,be,le,h,X,Ue));for(const Gt of Lt){const Xt=new Xs;Xt.text=Gt,Xt.sections=Ye.sections;for(let _r=0;_r<Gt.length;_r++)Xt.sectionIndex.push(0);rt.push(Xt)}}else if(Ct){rt=[];const Lt=Ct(Ye.text,Ye.sectionIndex,mh(Ye,be,le,h,X,Ue));for(const Gt of Lt){const Xt=new Xs;Xt.text=Gt[0],Xt.sectionIndex=Gt[1],Xt.sections=Ye.sections,rt.push(Xt)}}else rt=(function(Lt,Gt){const Xt=[],_r=Lt.text;let lr=0;for(const fr of Gt)Xt.push(Lt.substring(lr,fr)),lr=fr;return lr<_r.length&&Xt.push(Lt.substring(lr,_r.length)),Xt})(Ye,mh(Ye,be,le,h,X,Ue));const vt=[],qt={positionedLines:vt,text:Ye.toString(),top:Ee[1],bottom:Ee[1],left:Ee[0],right:Ee[0],writingMode:Pe,iconsInText:!1,verticalizable:!1};return(function(Lt,Gt,Xt,_r,lr,fr,Cr,hr,pr,$t,zr,Vr){let kr=0,Pr=0,ai=0,Ci=0;const Vi=hr==="right"?1:hr==="left"?0:.5,un=Ki/Vr;let zn=0;for(const Ai of lr){Ai.trim();const Xi=Ai.getMaxScale(),an={positionedGlyphs:[],lineOffset:0};Lt.positionedLines[zn]=an;const on=an.positionedGlyphs;let bn=0;if(!Ai.length()){Pr+=fr,++zn;continue}const Un=Dp(_r,Ai,un);for(let Rn=0;Rn<Ai.length();Rn++){const Gi=Ai.getSection(Rn),Ji=Ai.getSectionIndex(Rn),Qi=Ai.getCharCode(Rn),ji=Fp(pr,zr,Qi);let wi;if(Gi.imageName){if(Lt.iconsInText=!0,Gi.scale=Gi.scale*un,wi=Lp(Gi,ji,Xi,Un,_r),!wi)continue;bn=Math.max(bn,wi.imageOffset)}else if(wi=kp(Gi,Qi,ji,Un,Gt,Xt),!wi)continue;const{rect:ta,metrics:el,baselineOffset:ra}=wi;on.push({glyph:Qi,imageName:Gi.imageName,x:kr,y:Pr+ra+-17,vertical:ji,scale:Gi.scale,fontStack:Gi.fontStack,sectionIndex:Ji,metrics:el,rect:ta}),ji?(Lt.verticalizable=!0,kr+=(Gi.imageName?el.advance:Ki)*Gi.scale+$t):kr+=el.advance*Gi.scale+$t}on.length!==0&&(ai=Math.max(kr-$t,ai),Bp(on,0,on.length-1,Vi)),kr=0,an.lineOffset=Math.max(bn,(Xi-1)*Ki);const Yi=fr*Xi+bn;Pr+=Yi,Ci=Math.max(Yi,Ci),++zn}const{horizontalAlign:In,verticalAlign:nn}=yh(Cr);(function(Ai,Xi,an,on,bn,Un,Yi,Rn,Gi){const Ji=(Xi-an)*bn;let Qi=0;Qi=Un!==Yi?-Rn*on- -17:-on*Gi*Yi+.5*Yi;for(const ji of Ai)for(const wi of ji.positionedGlyphs)wi.x+=Ji,wi.y+=Qi})(Lt.positionedLines,Vi,In,nn,ai,Ci,fr,Pr,lr.length),Lt.top+=-nn*Pr,Lt.bottom=Lt.top+Pr,Lt.left+=-In*ai,Lt.right=Lt.left+ai})(qt,h,W,X,rt,he,fe,ye,Pe,be,Ne,$e),!(function(Lt){for(const Gt of Lt)if(Gt.positionedGlyphs.length!==0)return!1;return!0})(vt)&&qt}const gc={9:!0,10:!0,11:!0,12:!0,13:!0,32:!0},Op={10:!0,32:!0,38:!0,41:!0,43:!0,45:!0,47:!0,173:!0,183:!0,8203:!0,8208:!0,8211:!0,8231:!0},Cp={40:!0};function qd(H,h,W,X,te,le){if(h.imageName){const he=X[h.imageName];return he?he.displaySize[0]*h.scale*Ki/le+te:0}{const he=W[h.fontStack],fe=he&&he[H];return fe?fe.metrics.advance*h.scale+te:0}}function Td(H,h,W,X){const te=Math.pow(H-h,2);return X?H<h?te/2:2*te:te+Math.abs(W)*W}function Mp(H,h,W){let X=0;return H===10&&(X-=1e4),W&&(X+=150),H!==40&&H!==65288||(X+=50),h!==41&&h!==65289||(X+=50),X}function Id(H,h,W,X,te,le){let he=null,fe=Td(h,W,te,le);for(const ye of X){const be=Td(h-ye.x,W,te,le)+ye.badness;be<=fe&&(he=ye,fe=be)}return{index:H,x:h,priorBreak:he,badness:fe}}function Rd(H){return H?Rd(H.priorBreak).concat(H.index):[]}function mh(H,h,W,X,te,le){if(!H)return[];const he=[],fe=(function(Pe,Ne,Ue,$e,Ye,rt){let dt=0;for(let Ct=0;Ct<Pe.length();Ct++){const vt=Pe.getSection(Ct);dt+=qd(Pe.getCharCode(Ct),vt,$e,Ye,Ne,rt)}return dt/Math.max(1,Math.ceil(dt/Ue))})(H,h,W,X,te,le),ye=H.text.indexOf("â")>=0;let be=0;for(let Pe=0;Pe<H.length();Pe++){const Ne=H.getSection(Pe),Ue=H.getCharCode(Pe);if(gc[Ue]||(be+=qd(Ue,Ne,X,te,h,le)),Pe<H.length()-1){const $e=!((Ee=Ue)<11904)&&(!!ti["CJK Compatibility Forms"](Ee)||!!ti["CJK Compatibility"](Ee)||!!ti["CJK Strokes"](Ee)||!!ti["CJK Symbols and Punctuation"](Ee)||!!ti["Enclosed CJK Letters and Months"](Ee)||!!ti["Halfwidth and Fullwidth Forms"](Ee)||!!ti["Ideographic Description Characters"](Ee)||!!ti["Vertical Forms"](Ee)||Qu.test(String.fromCodePoint(Ee)));(Op[Ue]||$e||Ne.imageName||Pe!==H.length()-2&&Cp[H.getCharCode(Pe+1)])&&he.push(Id(Pe+1,be,fe,he,Mp(Ue,H.getCharCode(Pe+1),$e&&ye),!1))}}var Ee;return Rd(Id(H.length(),be,fe,he,0,!0))}function yh(H){let h=.5,W=.5;switch(H){case"right":case"top-right":case"bottom-right":h=1;break;case"left":case"top-left":case"bottom-left":h=0}switch(H){case"bottom":case"bottom-right":case"bottom-left":W=1;break;case"top":case"top-right":case"top-left":W=0}return{horizontalAlign:h,verticalAlign:W}}function Dp(H,h,W){const X=h.getMaxScale()*Ki,{maxImageWidth:te,maxImageHeight:le}=h.getMaxImageSize(H),he=Math.max(X,le*W);return{verticalLineContentWidth:Math.max(X,te*W),horizontalLineContentHeight:he}}function Ad(H){switch(H){case"top":return 0;case"center":return .5;default:return 1}}function Fp(H,h,W){return!(H===ee.ao.horizontal||!h&&!Fs(W)||h&&(gc[W]||(X=W,new RegExp("\\p{sc=Arab}","u").test(String.fromCodePoint(X)))));var X}function kp(H,h,W,X,te,le){const he=le[H.fontStack],fe=(function(be,Ee,Pe,Ne){if(be&&be.rect)return be;const Ue=Ee[Pe.fontStack],$e=Ue&&Ue[Ne];return $e?{rect:null,metrics:$e.metrics}:null})(he&&he[h],te,H,h);if(fe===null)return null;let ye;if(W)ye=X.verticalLineContentWidth-H.scale*Ki;else{const be=Ad(H.verticalAlign);ye=(X.horizontalLineContentHeight-H.scale*Ki)*be}return{rect:fe.rect,metrics:fe.metrics,baselineOffset:ye}}function Lp(H,h,W,X,te){const le=te[H.imageName];if(!le)return null;const he=le.paddedRect,fe=le.displaySize,ye={width:fe[0],height:fe[1],left:1,top:-3,advance:h?fe[1]:fe[0]};let be;if(h)be=X.verticalLineContentWidth-fe[1]*H.scale;else{const Ee=Ad(H.verticalAlign);be=(X.horizontalLineContentHeight-fe[1]*H.scale)*Ee}return{rect:he,metrics:ye,baselineOffset:be,imageOffset:(h?fe[0]:fe[1])*H.scale-Ki*W}}function Bp(H,h,W,X){if(X===0)return;const te=H[W],le=(H[W].x+te.metrics.advance*te.scale)*X;for(let he=h;he<=W;he++)H[he].x-=le}function Np(H,h,W){const{horizontalAlign:X,verticalAlign:te}=yh(W),le=h[0]-H.displaySize[0]*X,he=h[1]-H.displaySize[1]*te;return{image:H,top:he,bottom:he+H.displaySize[1],left:le,right:le+H.displaySize[0]}}function Pd(H){var h,W;let X=H.left,te=H.top,le=H.right-X,he=H.bottom-te;const fe=(h=H.image.textFitWidth)!==null&&h!==void 0?h:"stretchOrShrink",ye=(W=H.image.textFitHeight)!==null&&W!==void 0?W:"stretchOrShrink",be=(H.image.content[2]-H.image.content[0])/(H.image.content[3]-H.image.content[1]);if(ye==="proportional"){if(fe==="stretchOnly"&&le/he<be||fe==="proportional"){const Ee=Math.ceil(he*be);X*=Ee/le,le=Ee}}else if(fe==="proportional"&&ye==="stretchOnly"&&be!==0&&le/he>be){const Ee=Math.ceil(le/be);te*=Ee/he,he=Ee}return{x1:X,y1:te,x2:X+le,y2:te+he}}function Od(H,h,W,X,te,le){const he=H.image;let fe;if(he.content){const rt=he.content,dt=he.pixelRatio||1;fe=[rt[0]/dt,rt[1]/dt,he.displaySize[0]-rt[2]/dt,he.displaySize[1]-rt[3]/dt]}const ye=h.left*le,be=h.right*le;let Ee,Pe,Ne,Ue;W==="width"||W==="both"?(Ue=te[0]+ye-X[3],Pe=te[0]+be+X[1]):(Ue=te[0]+(ye+be-he.displaySize[0])/2,Pe=Ue+he.displaySize[0]);const $e=h.top*le,Ye=h.bottom*le;return W==="height"||W==="both"?(Ee=te[1]+$e-X[0],Ne=te[1]+Ye+X[2]):(Ee=te[1]+($e+Ye-he.displaySize[1])/2,Ne=Ee+he.displaySize[1]),{image:he,top:Ee,right:Pe,bottom:Ne,left:Ue,collisionPadding:fe}}const ka=128,ho=32640;function Cd(H,h){const{expression:W}=h;if(W.kind==="constant")return{kind:"constant",layoutSize:W.evaluate(new mi(H+1))};if(W.kind==="source")return{kind:"source"};{const{zoomStops:X,interpolationType:te}=W;let le=0;for(;le<X.length&&X[le]<=H;)le++;le=Math.max(0,le-1);let he=le;for(;he<X.length&&X[he]<H+1;)he++;he=Math.min(X.length-1,he);const fe=X[le],ye=X[he];return W.kind==="composite"?{kind:"composite",minZoom:fe,maxZoom:ye,interpolationType:te}:{kind:"camera",minZoom:fe,maxZoom:ye,minSize:W.evaluate(new mi(fe)),maxSize:W.evaluate(new mi(ye)),interpolationType:te}}}function gh(H,h,W){let X="never";const te=H.get(h);return te?X=te:H.get(W)&&(X="always"),X}const jp=[{name:"a_fade_opacity",components:1,type:"Uint8",offset:0}];function vc(H,h,W,X,te,le,he,fe,ye,be,Ee,Pe,Ne){const Ue=fe?Math.min(ho,Math.round(fe[0])):0,$e=fe?Math.min(ho,Math.round(fe[1])):0;H.emplaceBack(h,W,Math.round(32*X),Math.round(32*te),le,he,(Ue<<1)+(ye?1:0),$e,16*be,16*Ee,256*Pe,256*Ne)}function vh(H,h,W){H.emplaceBack(h.x,h.y,W),H.emplaceBack(h.x,h.y,W),H.emplaceBack(h.x,h.y,W),H.emplaceBack(h.x,h.y,W)}function zp(H){for(const h of H.sections)if(nc(h.text))return!0;return!1}class bh{constructor(h){this.layoutVertexArray=new sr,this.indexArray=new di,this.programConfigurations=h,this.segments=new si,this.dynamicLayoutVertexArray=new Kt,this.opacityVertexArray=new Tr,this.hasVisibleVertices=!1,this.placedSymbolArray=new Ve}isEmpty(){return this.layoutVertexArray.length===0&&this.indexArray.length===0&&this.dynamicLayoutVertexArray.length===0&&this.opacityVertexArray.length===0}upload(h,W,X,te){this.isEmpty()||(X&&(this.layoutVertexBuffer=h.createVertexBuffer(this.layoutVertexArray,pp.members),this.indexBuffer=h.createIndexBuffer(this.indexArray,W),this.dynamicLayoutVertexBuffer=h.createVertexBuffer(this.dynamicLayoutVertexArray,_p.members,!0),this.opacityVertexBuffer=h.createVertexBuffer(this.opacityVertexArray,jp,!0),this.opacityVertexBuffer.itemSize=1),(X||te)&&this.programConfigurations.upload(h))}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy(),this.dynamicLayoutVertexBuffer.destroy(),this.opacityVertexBuffer.destroy())}}vr("SymbolBuffers",bh);class xh{constructor(h,W,X){this.layoutVertexArray=new h,this.layoutAttributes=W,this.indexArray=new X,this.segments=new si,this.collisionVertexArray=new hi}upload(h){this.layoutVertexBuffer=h.createVertexBuffer(this.layoutVertexArray,this.layoutAttributes),this.indexBuffer=h.createIndexBuffer(this.indexArray),this.collisionVertexBuffer=h.createVertexBuffer(this.collisionVertexArray,mp.members,!0)}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.segments.destroy(),this.collisionVertexBuffer.destroy())}}vr("CollisionBuffers",xh);class Ys{constructor(h){this.collisionBoxArray=h.collisionBoxArray,this.zoom=h.zoom,this.overscaling=Nr(globalThis)?Math.min(h.overscaling,128):h.overscaling,this.layers=h.layers,this.layerIds=this.layers.map((he=>he.id)),this.index=h.index,this.pixelRatio=h.pixelRatio,this.sourceLayerIndex=h.sourceLayerIndex,this.hasDependencies=!1,this.hasRTLText=!1,this.sortKeyRanges=[],this.collisionCircleArray=[];const W=this.layers[0]._unevaluatedLayout._values;this.textSizeData=Cd(this.zoom,W["text-size"]),this.iconSizeData=Cd(this.zoom,W["icon-size"]);const X=this.layers[0].layout,te=X.get("symbol-sort-key"),le=X.get("symbol-z-order");this.canOverlap=gh(X,"text-overlap","text-allow-overlap")!=="never"||gh(X,"icon-overlap","icon-allow-overlap")!=="never"||X.get("text-ignore-placement")||X.get("icon-ignore-placement"),this.sortFeaturesByKey=le!=="viewport-y"&&!te.isConstant(),this.sortFeaturesByY=(le==="viewport-y"||le==="auto"&&!this.sortFeaturesByKey)&&this.canOverlap,X.get("symbol-placement")==="point"&&(this.writingModes=X.get("text-writing-mode").map((he=>ee.ao[he]))),this.stateDependentLayerIds=this.layers.filter((he=>he.isStateDependent())).map((he=>he.id)),this.sourceID=h.sourceID}createArrays(){this.text=new bh(new _a(this.layers,this.zoom,(h=>/^text/.test(h)))),this.icon=new bh(new _a(this.layers,this.zoom,(h=>/^icon/.test(h)))),this.glyphOffsetArray=new ot,this.lineVertexArray=new lt,this.symbolInstances=new at,this.textAnchorOffsets=new yt}calculateGlyphDependencies(h,W,X,te,le){for(let he=0;he<h.length;he++)if(W[h.charCodeAt(he)]=!0,(X||te)&&le){const fe=lu[h.charAt(he)];fe&&(W[fe.charCodeAt(0)]=!0)}}populate(h,W,X){const te=this.layers[0],le=te.layout,he=le.get("text-font"),fe=le.get("text-field"),ye=le.get("icon-image"),be=(fe.value.kind!=="constant"||fe.value.value instanceof yn&&!fe.value.value.isEmpty()||fe.value.value.toString().length>0)&&(he.value.kind!=="constant"||he.value.value.length>0),Ee=ye.value.kind!=="constant"||!!ye.value.value||Object.keys(ye.parameters).length>0,Pe=le.get("symbol-sort-key");if(this.features=[],!be&&!Ee)return;const Ne=W.iconDependencies,Ue=W.glyphDependencies,$e=W.availableImages,Ye=new mi(this.zoom);for(const{feature:rt,id:dt,index:Ct,sourceLayerIndex:vt}of h){const qt=te._featureFilter.needGeometry,Lt=Ho(rt,qt);if(!te._featureFilter.filter(Ye,Lt,X))continue;let Gt,Xt;if(qt||(Lt.geometry=Wo(rt)),be){const lr=te.getValueAndResolveTokens("text-field",Lt,X,$e),fr=yn.factory(lr),Cr=this.hasRTLText=this.hasRTLText||zp(fr);(!Cr||la.getRTLTextPluginStatus()==="unavailable"||Cr&&la.isParsed())&&(Gt=gp(fr,te,Lt))}if(Ee){const lr=te.getValueAndResolveTokens("icon-image",Lt,X,$e);Xt=lr instanceof wn?lr:wn.fromString(lr)}if(!Gt&&!Xt)continue;const _r=this.sortFeaturesByKey?Pe.evaluate(Lt,{},X):void 0;if(this.features.push({id:dt,text:Gt,icon:Xt,index:Ct,sourceLayerIndex:vt,geometry:Lt.geometry,properties:rt.properties,type:Zs.types[rt.type],sortKey:_r}),Xt&&(Ne[Xt.name]=!0),Gt){const lr=he.evaluate(Lt,{},X).join(","),fr=le.get("text-rotation-alignment")!=="viewport"&&le.get("symbol-placement")!=="point";this.allowVerticalPlacement=this.writingModes&&this.writingModes.indexOf(ee.ao.vertical)>=0;for(const Cr of Gt.sections)if(Cr.image)Ne[Cr.image.name]=!0;else{const hr=Ms(Gt.toString()),pr=Cr.fontStack||lr,$t=Ue[pr]=Ue[pr]||{};this.calculateGlyphDependencies(Cr.text,$t,fr,this.allowVerticalPlacement,hr)}}}le.get("symbol-placement")==="line"&&(this.features=(function(rt){const dt={},Ct={},vt=[];let qt=0;function Lt(lr){vt.push(rt[lr]),qt++}function Gt(lr,fr,Cr){const hr=Ct[lr];return delete Ct[lr],Ct[fr]=hr,vt[hr].geometry[0].pop(),vt[hr].geometry[0]=vt[hr].geometry[0].concat(Cr[0]),hr}function Xt(lr,fr,Cr){const hr=dt[fr];return delete dt[fr],dt[lr]=hr,vt[hr].geometry[0].shift(),vt[hr].geometry[0]=Cr[0].concat(vt[hr].geometry[0]),hr}function _r(lr,fr,Cr){const hr=Cr?fr[0][fr[0].length-1]:fr[0][0];return`${lr}:${hr.x}:${hr.y}`}for(let lr=0;lr<rt.length;lr++){const fr=rt[lr],Cr=fr.geometry,hr=fr.text?fr.text.toString():null;if(!hr){Lt(lr);continue}const pr=_r(hr,Cr),$t=_r(hr,Cr,!0);if(pr in Ct&&$t in dt&&Ct[pr]!==dt[$t]){const zr=Xt(pr,$t,Cr),Vr=Gt(pr,$t,vt[zr].geometry);delete dt[pr],delete Ct[$t],Ct[_r(hr,vt[Vr].geometry,!0)]=Vr,vt[zr].geometry=null}else pr in Ct?Gt(pr,$t,Cr):$t in dt?Xt(pr,$t,Cr):(Lt(lr),dt[pr]=qt-1,Ct[$t]=qt-1)}return vt.filter((lr=>lr.geometry))})(this.features)),this.sortFeaturesByKey&&this.features.sort(((rt,dt)=>rt.sortKey-dt.sortKey))}update(h,W,X){this.stateDependentLayers.length&&(this.text.programConfigurations.updatePaintArrays(h,W,this.layers,{imagePositions:X}),this.icon.programConfigurations.updatePaintArrays(h,W,this.layers,{imagePositions:X}))}isEmpty(){return this.symbolInstances.length===0&&!this.hasRTLText}uploadPending(){return!this.uploaded||this.text.programConfigurations.needsUpload||this.icon.programConfigurations.needsUpload}upload(h){!this.uploaded&&this.hasDebugData()&&(this.textCollisionBox.upload(h),this.iconCollisionBox.upload(h)),this.text.upload(h,this.sortFeaturesByY,!this.uploaded,this.text.programConfigurations.needsUpload),this.icon.upload(h,this.sortFeaturesByY,!this.uploaded,this.icon.programConfigurations.needsUpload),this.uploaded=!0}destroyDebugData(){this.textCollisionBox.destroy(),this.iconCollisionBox.destroy()}destroy(){this.text.destroy(),this.icon.destroy(),this.hasDebugData()&&this.destroyDebugData()}addToLineVertexArray(h,W){const X=this.lineVertexArray.length;if(h.segment!==void 0){let te=h.dist(W[h.segment+1]),le=h.dist(W[h.segment]);const he={};for(let fe=h.segment+1;fe<W.length;fe++)he[fe]={x:W[fe].x,y:W[fe].y,tileUnitDistanceFromAnchor:te},fe<W.length-1&&(te+=W[fe+1].dist(W[fe]));for(let fe=h.segment||0;fe>=0;fe--)he[fe]={x:W[fe].x,y:W[fe].y,tileUnitDistanceFromAnchor:le},fe>0&&(le+=W[fe-1].dist(W[fe]));for(let fe=0;fe<W.length;fe++){const ye=he[fe];this.lineVertexArray.emplaceBack(ye.x,ye.y,ye.tileUnitDistanceFromAnchor)}}return{lineStartIndex:X,lineLength:this.lineVertexArray.length-X}}addSymbols(h,W,X,te,le,he,fe,ye,be,Ee,Pe,Ne){const Ue=h.indexArray,$e=h.layoutVertexArray,Ye=h.segments.prepareSegment(4*W.length,$e,Ue,this.canOverlap?he.sortKey:void 0),rt=this.glyphOffsetArray.length,dt=Ye.vertexLength,Ct=this.allowVerticalPlacement&&fe===ee.ao.vertical?Math.PI/2:0,vt=he.text&&he.text.sections;for(let qt=0;qt<W.length;qt++){const{tl:Lt,tr:Gt,bl:Xt,br:_r,tex:lr,pixelOffsetTL:fr,pixelOffsetBR:Cr,minFontScaleX:hr,minFontScaleY:pr,glyphOffset:$t,isSDF:zr,sectionIndex:Vr}=W[qt],kr=Ye.vertexLength,Pr=$t[1];vc($e,ye.x,ye.y,Lt.x,Pr+Lt.y,lr.x,lr.y,X,zr,fr.x,fr.y,hr,pr),vc($e,ye.x,ye.y,Gt.x,Pr+Gt.y,lr.x+lr.w,lr.y,X,zr,Cr.x,fr.y,hr,pr),vc($e,ye.x,ye.y,Xt.x,Pr+Xt.y,lr.x,lr.y+lr.h,X,zr,fr.x,Cr.y,hr,pr),vc($e,ye.x,ye.y,_r.x,Pr+_r.y,lr.x+lr.w,lr.y+lr.h,X,zr,Cr.x,Cr.y,hr,pr),vh(h.dynamicLayoutVertexArray,ye,Ct),Ue.emplaceBack(kr,kr+2,kr+1),Ue.emplaceBack(kr+1,kr+2,kr+3),Ye.vertexLength+=4,Ye.primitiveLength+=2,this.glyphOffsetArray.emplaceBack($t[0]),qt!==W.length-1&&Vr===W[qt+1].sectionIndex||h.programConfigurations.populatePaintArrays($e.length,he,he.index,{imagePositions:{},canonical:Ne,formattedSection:vt&&vt[Vr]})}h.placedSymbolArray.emplaceBack(ye.x,ye.y,rt,this.glyphOffsetArray.length-rt,dt,be,Ee,ye.segment,X?X[0]:0,X?X[1]:0,te[0],te[1],fe,0,!1,0,Pe)}_addCollisionDebugVertex(h,W,X,te,le,he){return W.emplaceBack(0,0),h.emplaceBack(X.x,X.y,te,le,Math.round(he.x),Math.round(he.y))}addCollisionDebugVertices(h,W,X,te,le,he,fe){const ye=le.segments.prepareSegment(4,le.layoutVertexArray,le.indexArray),be=ye.vertexLength,Ee=le.layoutVertexArray,Pe=le.collisionVertexArray,Ne=fe.anchorX,Ue=fe.anchorY;this._addCollisionDebugVertex(Ee,Pe,he,Ne,Ue,new U(h,W)),this._addCollisionDebugVertex(Ee,Pe,he,Ne,Ue,new U(X,W)),this._addCollisionDebugVertex(Ee,Pe,he,Ne,Ue,new U(X,te)),this._addCollisionDebugVertex(Ee,Pe,he,Ne,Ue,new U(h,te)),ye.vertexLength+=4;const $e=le.indexArray;$e.emplaceBack(be,be+1),$e.emplaceBack(be+1,be+2),$e.emplaceBack(be+2,be+3),$e.emplaceBack(be+3,be),ye.primitiveLength+=4}addDebugCollisionBoxes(h,W,X,te){for(let le=h;le<W;le++){const he=this.collisionBoxArray.get(le);this.addCollisionDebugVertices(he.x1,he.y1,he.x2,he.y2,te?this.textCollisionBox:this.iconCollisionBox,he.anchorPoint,X)}}generateCollisionDebugBuffers(){this.hasDebugData()&&this.destroyDebugData(),this.textCollisionBox=new xh(Wr,vd.members,_i),this.iconCollisionBox=new xh(Wr,vd.members,_i);for(let h=0;h<this.symbolInstances.length;h++){const W=this.symbolInstances.get(h);this.addDebugCollisionBoxes(W.textBoxStartIndex,W.textBoxEndIndex,W,!0),this.addDebugCollisionBoxes(W.verticalTextBoxStartIndex,W.verticalTextBoxEndIndex,W,!0),this.addDebugCollisionBoxes(W.iconBoxStartIndex,W.iconBoxEndIndex,W,!1),this.addDebugCollisionBoxes(W.verticalIconBoxStartIndex,W.verticalIconBoxEndIndex,W,!1)}}_deserializeCollisionBoxesForSymbol(h,W,X,te,le,he,fe,ye,be){const Ee={};for(let Pe=W;Pe<X;Pe++){const Ne=h.get(Pe);Ee.textBox={x1:Ne.x1,y1:Ne.y1,x2:Ne.x2,y2:Ne.y2,anchorPointX:Ne.anchorPointX,anchorPointY:Ne.anchorPointY},Ee.textFeatureIndex=Ne.featureIndex;break}for(let Pe=te;Pe<le;Pe++){const Ne=h.get(Pe);Ee.verticalTextBox={x1:Ne.x1,y1:Ne.y1,x2:Ne.x2,y2:Ne.y2,anchorPointX:Ne.anchorPointX,anchorPointY:Ne.anchorPointY},Ee.verticalTextFeatureIndex=Ne.featureIndex;break}for(let Pe=he;Pe<fe;Pe++){const Ne=h.get(Pe);Ee.iconBox={x1:Ne.x1,y1:Ne.y1,x2:Ne.x2,y2:Ne.y2,anchorPointX:Ne.anchorPointX,anchorPointY:Ne.anchorPointY},Ee.iconFeatureIndex=Ne.featureIndex;break}for(let Pe=ye;Pe<be;Pe++){const Ne=h.get(Pe);Ee.verticalIconBox={x1:Ne.x1,y1:Ne.y1,x2:Ne.x2,y2:Ne.y2,anchorPointX:Ne.anchorPointX,anchorPointY:Ne.anchorPointY},Ee.verticalIconFeatureIndex=Ne.featureIndex;break}return Ee}deserializeCollisionBoxes(h){this.collisionArrays=[];for(let W=0;W<this.symbolInstances.length;W++){const X=this.symbolInstances.get(W);this.collisionArrays.push(this._deserializeCollisionBoxesForSymbol(h,X.textBoxStartIndex,X.textBoxEndIndex,X.verticalTextBoxStartIndex,X.verticalTextBoxEndIndex,X.iconBoxStartIndex,X.iconBoxEndIndex,X.verticalIconBoxStartIndex,X.verticalIconBoxEndIndex))}}hasTextData(){return this.text.segments.get().length>0}hasIconData(){return this.icon.segments.get().length>0}hasDebugData(){return this.textCollisionBox&&this.iconCollisionBox}hasTextCollisionBoxData(){return this.hasDebugData()&&this.textCollisionBox.segments.get().length>0}hasIconCollisionBoxData(){return this.hasDebugData()&&this.iconCollisionBox.segments.get().length>0}addIndicesForPlacedSymbol(h,W){const X=h.placedSymbolArray.get(W),te=X.vertexStartIndex+4*X.numGlyphs;for(let le=X.vertexStartIndex;le<te;le+=4)h.indexArray.emplaceBack(le,le+2,le+1),h.indexArray.emplaceBack(le+1,le+2,le+3)}getSortedSymbolIndexes(h){if(this.sortedAngle===h&&this.symbolInstanceIndexes!==void 0)return this.symbolInstanceIndexes;const W=Math.sin(h),X=Math.cos(h),te=[],le=[],he=[];for(let fe=0;fe<this.symbolInstances.length;++fe){he.push(fe);const ye=this.symbolInstances.get(fe);te.push(0|Math.round(W*ye.anchorX+X*ye.anchorY)),le.push(ye.featureIndex)}return he.sort(((fe,ye)=>te[fe]-te[ye]||le[ye]-le[fe])),he}addToSortKeyRanges(h,W){const X=this.sortKeyRanges[this.sortKeyRanges.length-1];X&&X.sortKey===W?X.symbolInstanceEnd=h+1:this.sortKeyRanges.push({sortKey:W,symbolInstanceStart:h,symbolInstanceEnd:h+1})}sortFeatures(h){if(this.sortFeaturesByY&&this.sortedAngle!==h&&!(this.text.segments.get().length>1||this.icon.segments.get().length>1)){this.symbolInstanceIndexes=this.getSortedSymbolIndexes(h),this.sortedAngle=h,this.text.indexArray.clear(),this.icon.indexArray.clear(),this.featureSortOrder=[];for(const W of this.symbolInstanceIndexes){const X=this.symbolInstances.get(W);this.featureSortOrder.push(X.featureIndex),[X.rightJustifiedTextSymbolIndex,X.centerJustifiedTextSymbolIndex,X.leftJustifiedTextSymbolIndex].forEach(((te,le,he)=>{te>=0&&he.indexOf(te)===le&&this.addIndicesForPlacedSymbol(this.text,te)})),X.verticalPlacedTextSymbolIndex>=0&&this.addIndicesForPlacedSymbol(this.text,X.verticalPlacedTextSymbolIndex),X.placedIconSymbolIndex>=0&&this.addIndicesForPlacedSymbol(this.icon,X.placedIconSymbolIndex),X.verticalPlacedIconSymbolIndex>=0&&this.addIndicesForPlacedSymbol(this.icon,X.verticalPlacedIconSymbolIndex)}this.text.indexBuffer&&this.text.indexBuffer.updateData(this.text.indexArray),this.icon.indexBuffer&&this.icon.indexBuffer.updateData(this.icon.indexArray)}}}let Md,Dd;vr("SymbolBucket",Ys,{omit:["layers","collisionBoxArray","features","compareText"]}),Ys.MAX_GLYPHS=65535,Ys.addDynamicAttributes=vh;var wh={get paint(){return Dd=Dd||new pn({"icon-opacity":new Br(Tt.paint_symbol["icon-opacity"]),"icon-color":new Br(Tt.paint_symbol["icon-color"]),"icon-halo-color":new Br(Tt.paint_symbol["icon-halo-color"]),"icon-halo-width":new Br(Tt.paint_symbol["icon-halo-width"]),"icon-halo-blur":new Br(Tt.paint_symbol["icon-halo-blur"]),"icon-translate":new Ar(Tt.paint_symbol["icon-translate"]),"icon-translate-anchor":new Ar(Tt.paint_symbol["icon-translate-anchor"]),"text-opacity":new Br(Tt.paint_symbol["text-opacity"]),"text-color":new Br(Tt.paint_symbol["text-color"],{runtimeType:jt,getOverride:H=>H.textColor,hasOverride:H=>!!H.textColor}),"text-halo-color":new Br(Tt.paint_symbol["text-halo-color"]),"text-halo-width":new Br(Tt.paint_symbol["text-halo-width"]),"text-halo-blur":new Br(Tt.paint_symbol["text-halo-blur"]),"text-translate":new Ar(Tt.paint_symbol["text-translate"]),"text-translate-anchor":new Ar(Tt.paint_symbol["text-translate-anchor"])})},get layout(){return Md=Md||new pn({"symbol-placement":new Ar(Tt.layout_symbol["symbol-placement"]),"symbol-spacing":new Ar(Tt.layout_symbol["symbol-spacing"]),"symbol-avoid-edges":new Ar(Tt.layout_symbol["symbol-avoid-edges"]),"symbol-sort-key":new Br(Tt.layout_symbol["symbol-sort-key"]),"symbol-z-order":new Ar(Tt.layout_symbol["symbol-z-order"]),"icon-allow-overlap":new Ar(Tt.layout_symbol["icon-allow-overlap"]),"icon-overlap":new Ar(Tt.layout_symbol["icon-overlap"]),"icon-ignore-placement":new Ar(Tt.layout_symbol["icon-ignore-placement"]),"icon-optional":new Ar(Tt.layout_symbol["icon-optional"]),"icon-rotation-alignment":new Ar(Tt.layout_symbol["icon-rotation-alignment"]),"icon-size":new Br(Tt.layout_symbol["icon-size"]),"icon-text-fit":new Ar(Tt.layout_symbol["icon-text-fit"]),"icon-text-fit-padding":new Ar(Tt.layout_symbol["icon-text-fit-padding"]),"icon-image":new Br(Tt.layout_symbol["icon-image"]),"icon-rotate":new Br(Tt.layout_symbol["icon-rotate"]),"icon-padding":new Br(Tt.layout_symbol["icon-padding"]),"icon-keep-upright":new Ar(Tt.layout_symbol["icon-keep-upright"]),"icon-offset":new Br(Tt.layout_symbol["icon-offset"]),"icon-anchor":new Br(Tt.layout_symbol["icon-anchor"]),"icon-pitch-alignment":new Ar(Tt.layout_symbol["icon-pitch-alignment"]),"text-pitch-alignment":new Ar(Tt.layout_symbol["text-pitch-alignment"]),"text-rotation-alignment":new Ar(Tt.layout_symbol["text-rotation-alignment"]),"text-field":new Br(Tt.layout_symbol["text-field"]),"text-font":new Br(Tt.layout_symbol["text-font"]),"text-size":new Br(Tt.layout_symbol["text-size"]),"text-max-width":new Br(Tt.layout_symbol["text-max-width"]),"text-line-height":new Ar(Tt.layout_symbol["text-line-height"]),"text-letter-spacing":new Br(Tt.layout_symbol["text-letter-spacing"]),"text-justify":new Br(Tt.layout_symbol["text-justify"]),"text-radial-offset":new Br(Tt.layout_symbol["text-radial-offset"]),"text-variable-anchor":new Ar(Tt.layout_symbol["text-variable-anchor"]),"text-variable-anchor-offset":new Br(Tt.layout_symbol["text-variable-anchor-offset"]),"text-anchor":new Br(Tt.layout_symbol["text-anchor"]),"text-max-angle":new Ar(Tt.layout_symbol["text-max-angle"]),"text-writing-mode":new Ar(Tt.layout_symbol["text-writing-mode"]),"text-rotate":new Br(Tt.layout_symbol["text-rotate"]),"text-padding":new Ar(Tt.layout_symbol["text-padding"]),"text-keep-upright":new Ar(Tt.layout_symbol["text-keep-upright"]),"text-transform":new Br(Tt.layout_symbol["text-transform"]),"text-offset":new Br(Tt.layout_symbol["text-offset"]),"text-allow-overlap":new Ar(Tt.layout_symbol["text-allow-overlap"]),"text-overlap":new Ar(Tt.layout_symbol["text-overlap"]),"text-ignore-placement":new Ar(Tt.layout_symbol["text-ignore-placement"]),"text-optional":new Ar(Tt.layout_symbol["text-optional"])})}};class Fd{constructor(h){if(h.property.overrides===void 0)throw new Error("overrides must be provided to instantiate FormatSectionOverride class");this.type=h.property.overrides?h.property.overrides.runtimeType:ii,this.defaultValue=h}evaluate(h){if(h.formattedSection){const W=this.defaultValue.property.overrides;if(W&&W.hasOverride(h.formattedSection))return W.getOverride(h.formattedSection)}return h.feature&&h.featureState?this.defaultValue.evaluate(h.feature,h.featureState):this.defaultValue.property.specification.default}eachChild(h){this.defaultValue.isConstant()||h(this.defaultValue.value._styleExpression.expression)}outputDefined(){return!1}serialize(){return null}}vr("FormatSectionOverride",Fd,{omit:["defaultValue"]});class bc extends Ln{constructor(h,W){super(h,wh,W)}recalculate(h,W){if(super.recalculate(h,W),this.layout.get("icon-rotation-alignment")==="auto"&&(this.layout._values["icon-rotation-alignment"]=this.layout.get("symbol-placement")!=="point"?"map":"viewport"),this.layout.get("text-rotation-alignment")==="auto"&&(this.layout._values["text-rotation-alignment"]=this.layout.get("symbol-placement")!=="point"?"map":"viewport"),this.layout.get("text-pitch-alignment")==="auto"&&(this.layout._values["text-pitch-alignment"]=this.layout.get("text-rotation-alignment")==="map"?"map":"viewport"),this.layout.get("icon-pitch-alignment")==="auto"&&(this.layout._values["icon-pitch-alignment"]=this.layout.get("icon-rotation-alignment")),this.layout.get("symbol-placement")==="point"){const X=this.layout.get("text-writing-mode");if(X){const te=[];for(const le of X)te.indexOf(le)<0&&te.push(le);this.layout._values["text-writing-mode"]=te}else this.layout._values["text-writing-mode"]=["horizontal"]}this._setPaintOverrides()}getValueAndResolveTokens(h,W,X,te){const le=this.layout.get(h).evaluate(W,{},X,te),he=this._unevaluatedLayout._values[h];return he.isDataDriven()||bs(he.value)||!le?le:(function(fe,ye){return ye.replace(/{([^{}]+)}/g,((be,Ee)=>fe&&Ee in fe?String(fe[Ee]):""))})(W.properties,le)}createBucket(h){return new Ys(h)}queryRadius(){return 0}queryIntersectsFeature(){throw new Error("Should take a different path in FeatureIndex")}_setPaintOverrides(){for(const h of wh.paint.overridableProperties){if(!bc.hasPaintOverride(this.layout,h))continue;const W=this.paint.get(h),X=new Fd(W),te=new Pl(X,W.property.specification);let le=null;le=W.value.kind==="constant"||W.value.kind==="source"?new ws("source",te):new Ss("composite",te,W.value.zoomStops),this.paint._values[h]=new Hn(W.property,le,W.parameters)}}_handleOverridablePaintPropertyUpdate(h,W,X){return!(!this.layout||W.isDataDriven()||X.isDataDriven())&&bc.hasPaintOverride(this.layout,h)}static hasPaintOverride(h,W){const X=h.get("text-field"),te=wh.paint.properties[W];let le=!1;const he=fe=>{for(const ye of fe)if(te.overrides&&te.overrides.hasOverride(ye))return void(le=!0)};if(X.value.kind==="constant"&&X.value.value instanceof yn)he(X.value.value.sections);else if(X.value.kind==="source"||X.value.kind==="composite"){const fe=be=>{le||(be instanceof $r&&Oi(be.value)===Ur?he(be.value.sections):be instanceof ss?he(be.sections):be.eachChild(fe))},ye=X.value;ye._styleExpression&&fe(ye._styleExpression.expression)}return le}}let kd;var Up={get paint(){return kd=kd||new pn({"background-color":new Ar(Tt.paint_background["background-color"]),"background-pattern":new sc(Tt.paint_background["background-pattern"]),"background-opacity":new Ar(Tt.paint_background["background-opacity"])})}};class Vp extends Ln{constructor(h,W){super(h,Up,W)}}class Gp extends Ln{constructor(h,W){super(h,{},W),this.onAdd=X=>{this.implementation.onAdd&&this.implementation.onAdd(X,X.painter.context.gl)},this.onRemove=X=>{this.implementation.onRemove&&this.implementation.onRemove(X,X.painter.context.gl)},this.implementation=h}is3D(){return this.implementation.renderingMode==="3d"}hasOffscreenPass(){return this.implementation.prerender!==void 0}recalculate(){}updateTransitions(){}hasTransition(){return!1}serialize(){throw new Error("Custom layers cannot be serialized")}}class $p{constructor(h){this._methodToThrottle=h,this._triggered=!1,typeof MessageChannel<"u"&&(this._channel=new MessageChannel,this._channel.port2.onmessage=()=>{this._triggered=!1,this._methodToThrottle()})}trigger(){this._triggered||(this._triggered=!0,this._channel?this._channel.port1.postMessage(!0):setTimeout((()=>{this._triggered=!1,this._methodToThrottle()}),0))}remove(){delete this._channel,this._methodToThrottle=()=>{}}}const Wp={once:!0},Sh=63710088e-1;class fo{constructor(h,W){if(isNaN(h)||isNaN(W))throw new Error(`Invalid LngLat object: (${h}, ${W})`);if(this.lng=+h,this.lat=+W,this.lat>90||this.lat<-90)throw new Error("Invalid LngLat latitude value: must be between -90 and 90")}wrap(){return new fo(yr(this.lng,-180,180),this.lat)}toArray(){return[this.lng,this.lat]}toString(){return`LngLat(${this.lng}, ${this.lat})`}distanceTo(h){const W=Math.PI/180,X=this.lat*W,te=h.lat*W,le=Math.sin(X)*Math.sin(te)+Math.cos(X)*Math.cos(te)*Math.cos((h.lng-this.lng)*W);return Sh*Math.acos(Math.min(le,1))}static convert(h){if(h instanceof fo)return h;if(Array.isArray(h)&&(h.length===2||h.length===3))return new fo(Number(h[0]),Number(h[1]));if(!Array.isArray(h)&&typeof h=="object"&&h!==null)return new fo(Number("lng"in h?h.lng:h.lon),Number(h.lat));throw new Error("`LngLatLike` argument must be specified as a LngLat instance, an object {lng: <lng>, lat: <lat>}, an object {lon: <lng>, lat: <lat>}, or an array of [<lng>, <lat>]")}}const Ld=2*Math.PI*Sh;function Bd(H){return Ld*Math.cos(H*Math.PI/180)}function Nd(H){return(180+H)/360}function jd(H){return(180-180/Math.PI*Math.log(Math.tan(Math.PI/4+H*Math.PI/360)))/360}function zd(H,h){return H/Bd(h)}function Eh(H){return 360/Math.PI*Math.atan(Math.exp((180-360*H)*Math.PI/180))-90}function Ud(H,h){return H*Bd(Eh(h))}class cu{constructor(h,W,X=0){this.x=+h,this.y=+W,this.z=+X}static fromLngLat(h,W=0){const X=fo.convert(h);return new cu(Nd(X.lng),jd(X.lat),zd(W,X.lat))}toLngLat(){return new fo(360*this.x-180,Eh(this.y))}toAltitude(){return Ud(this.z,this.y)}meterInMercatorCoordinateUnits(){return 1/Ld*(h=Eh(this.y),1/Math.cos(h*Math.PI/180));var h}}function Vd(H,h,W){var X=2*Math.PI*6378137/256/Math.pow(2,W);return[H*X-2*Math.PI*6378137/2,h*X-2*Math.PI*6378137/2]}class qh{constructor(h,W,X){if(!(function(te,le,he){return!(te<0||te>25||he<0||he>=Math.pow(2,te)||le<0||le>=Math.pow(2,te))})(h,W,X))throw new Error(`x=${W}, y=${X}, z=${h} outside of bounds. 0<=x<${Math.pow(2,h)}, 0<=y<${Math.pow(2,h)} 0<=z<=25 `);this.z=h,this.x=W,this.y=X,this.key=Js(0,h,h,W,X)}equals(h){return this.z===h.z&&this.x===h.x&&this.y===h.y}url(h,W,X){const te=(he=this.y,fe=this.z,ye=Vd(256*(le=this.x),256*(he=Math.pow(2,fe)-he-1),fe),be=Vd(256*(le+1),256*(he+1),fe),ye[0]+","+ye[1]+","+be[0]+","+be[1]);var le,he,fe,ye,be;const Ee=(function(Pe,Ne,Ue){let $e,Ye="";for(let rt=Pe;rt>0;rt--)$e=1<<rt-1,Ye+=(Ne&$e?1:0)+(Ue&$e?2:0);return Ye})(this.z,this.x,this.y);return h[(this.x+this.y)%h.length].replace(/{prefix}/g,(this.x%16).toString(16)+(this.y%16).toString(16)).replace(/{z}/g,String(this.z)).replace(/{x}/g,String(this.x)).replace(/{y}/g,String(X==="tms"?Math.pow(2,this.z)-this.y-1:this.y)).replace(/{ratio}/g,W>1?"@2x":"").replace(/{quadkey}/g,Ee).replace(/{bbox-epsg-3857}/g,te)}isChildOf(h){const W=this.z-h.z;return W>0&&h.x===this.x>>W&&h.y===this.y>>W}getTilePoint(h){const W=Math.pow(2,this.z);return new U((h.x*W-this.x)*ut,(h.y*W-this.y)*ut)}toString(){return`${this.z}/${this.x}/${this.y}`}}class Gd{constructor(h,W){this.wrap=h,this.canonical=W,this.key=Js(h,W.z,W.z,W.x,W.y)}}class jn{constructor(h,W,X,te,le){if(this.terrainRttPosMatrix32f=null,h<X)throw new Error(`overscaledZ should be >= z; overscaledZ = ${h}; z = ${X}`);this.overscaledZ=h,this.wrap=W,this.canonical=new qh(X,+te,+le),this.key=Js(W,h,X,te,le)}clone(){return new jn(this.overscaledZ,this.wrap,this.canonical.z,this.canonical.x,this.canonical.y)}equals(h){return this.overscaledZ===h.overscaledZ&&this.wrap===h.wrap&&this.canonical.equals(h.canonical)}scaledTo(h){if(h>this.overscaledZ)throw new Error(`targetZ > this.overscaledZ; targetZ = ${h}; overscaledZ = ${this.overscaledZ}`);const W=this.canonical.z-h;return h>this.canonical.z?new jn(h,this.wrap,this.canonical.z,this.canonical.x,this.canonical.y):new jn(h,this.wrap,h,this.canonical.x>>W,this.canonical.y>>W)}isOverscaled(){return this.overscaledZ>this.canonical.z}calculateScaledKey(h,W){if(h>this.overscaledZ)throw new Error(`targetZ > this.overscaledZ; targetZ = ${h}; overscaledZ = ${this.overscaledZ}`);const X=this.canonical.z-h;return h>this.canonical.z?Js(this.wrap*+W,h,this.canonical.z,this.canonical.x,this.canonical.y):Js(this.wrap*+W,h,h,this.canonical.x>>X,this.canonical.y>>X)}isChildOf(h){if(h.wrap!==this.wrap||this.overscaledZ-h.overscaledZ<=0)return!1;if(h.overscaledZ===0)return this.overscaledZ>0;const W=this.canonical.z-h.canonical.z;return!(W<0)&&h.canonical.x===this.canonical.x>>W&&h.canonical.y===this.canonical.y>>W}children(h){if(this.overscaledZ>=h)return[new jn(this.overscaledZ+1,this.wrap,this.canonical.z,this.canonical.x,this.canonical.y)];const W=this.canonical.z+1,X=2*this.canonical.x,te=2*this.canonical.y;return[new jn(W,this.wrap,W,X,te),new jn(W,this.wrap,W,X+1,te),new jn(W,this.wrap,W,X,te+1),new jn(W,this.wrap,W,X+1,te+1)]}isLessThan(h){return this.wrap<h.wrap||!(this.wrap>h.wrap)&&(this.overscaledZ<h.overscaledZ||!(this.overscaledZ>h.overscaledZ)&&(this.canonical.x<h.canonical.x||!(this.canonical.x>h.canonical.x)&&this.canonical.y<h.canonical.y))}wrapped(){return new jn(this.overscaledZ,0,this.canonical.z,this.canonical.x,this.canonical.y)}unwrapTo(h){return new jn(this.overscaledZ,h,this.canonical.z,this.canonical.x,this.canonical.y)}overscaleFactor(){return Math.pow(2,this.overscaledZ-this.canonical.z)}toUnwrapped(){return new Gd(this.wrap,this.canonical)}toString(){return`${this.overscaledZ}/${this.canonical.x}/${this.canonical.y}`}getTilePoint(h){return this.canonical.getTilePoint(new cu(h.x-this.wrap,h.y))}}function Js(H,h,W,X,te){(H*=2)<0&&(H=-1*H-1);const le=1<<W;return(le*le*H+le*te+X).toString(36)+W.toString(36)+h.toString(36)}function hu(H,h){return h?H.properties[h]:H.id}vr("CanonicalTileID",qh),vr("OverscaledTileID",jn,{omit:["terrainRttPosMatrix32f"]});class Xo{constructor(){this.minX=1/0,this.maxX=-1/0,this.minY=1/0,this.maxY=-1/0}extend(h){return this.minX=Math.min(this.minX,h.x),this.minY=Math.min(this.minY,h.y),this.maxX=Math.max(this.maxX,h.x),this.maxY=Math.max(this.maxY,h.y),this}expandBy(h){return this.minX-=h,this.minY-=h,this.maxX+=h,this.maxY+=h,(this.minX>this.maxX||this.minY>this.maxY)&&(this.minX=1/0,this.maxX=-1/0,this.minY=1/0,this.maxY=-1/0),this}shrinkBy(h){return this.expandBy(-h)}map(h){const W=new Xo;return W.extend(h(new U(this.minX,this.minY))),W.extend(h(new U(this.maxX,this.minY))),W.extend(h(new U(this.minX,this.maxY))),W.extend(h(new U(this.maxX,this.maxY))),W}static fromPoints(h){const W=new Xo;for(const X of h)W.extend(X);return W}contains(h){return h.x>=this.minX&&h.x<=this.maxX&&h.y>=this.minY&&h.y<=this.maxY}empty(){return this.minX>this.maxX}width(){return this.maxX-this.minX}height(){return this.maxY-this.minY}covers(h){return!this.empty()&&!h.empty()&&h.minX>=this.minX&&h.maxX<=this.maxX&&h.minY>=this.minY&&h.maxY<=this.maxY}intersects(h){return!this.empty()&&!h.empty()&&h.minX<=this.maxX&&h.maxX>=this.minX&&h.minY<=this.maxY&&h.maxY>=this.minY}}class $d{constructor(h){this._stringToNumber={},this._numberToString=[];for(let W=0;W<h.length;W++){const X=h[W];this._stringToNumber[X]=W,this._numberToString[W]=X}}encode(h){return this._stringToNumber[h]}decode(h){if(h>=this._numberToString.length)throw new Error(`Out of bounds. Index requested n=${h} can't be >= this._numberToString.length ${this._numberToString.length}`);return this._numberToString[h]}}class Wd{constructor(h,W,X,te,le){this.type="Feature",this._vectorTileFeature=h,h._z=W,h._x=X,h._y=te,this.properties=h.properties,this.id=le}get geometry(){return this._geometry===void 0&&(this._geometry=this._vectorTileFeature.toGeoJSON(this._vectorTileFeature._x,this._vectorTileFeature._y,this._vectorTileFeature._z).geometry),this._geometry}set geometry(h){this._geometry=h}toJSON(){const h={geometry:this.geometry};for(const W in this)W!=="_geometry"&&W!=="_vectorTileFeature"&&(h[W]=this[W]);return h}}class Hd{constructor(h,W){this.tileID=h,this.x=h.canonical.x,this.y=h.canonical.y,this.z=h.canonical.z,this.grid=new Bo(ut,16,0),this.grid3D=new Bo(ut,16,0),this.featureIndexArray=new xt,this.promoteId=W}insert(h,W,X,te,le,he){const fe=this.featureIndexArray.length;this.featureIndexArray.emplaceBack(X,te,le);const ye=he?this.grid3D:this.grid;for(let be=0;be<W.length;be++){const Ee=W[be],Pe=[1/0,1/0,-1/0,-1/0];for(let Ne=0;Ne<Ee.length;Ne++){const Ue=Ee[Ne];Pe[0]=Math.min(Pe[0],Ue.x),Pe[1]=Math.min(Pe[1],Ue.y),Pe[2]=Math.max(Pe[2],Ue.x),Pe[3]=Math.max(Pe[3],Ue.y)}Pe[0]<ut&&Pe[1]<ut&&Pe[2]>=0&&Pe[3]>=0&&ye.insert(fe,Pe[0],Pe[1],Pe[2],Pe[3])}}loadVTLayers(){return this.vtLayers||(this.vtLayers=new cd(new ph(this.rawTileData)).layers,this.sourceLayerCoder=new $d(this.vtLayers?Object.keys(this.vtLayers).sort():["_geojsonTileLayer"])),this.vtLayers}query(h,W,X,te){this.loadVTLayers();const le=h.params,he=ut/h.tileSize/h.scale,fe=Mo(le.filter,le.globalState),ye=h.queryGeometry,be=h.queryPadding*he,Ee=Xo.fromPoints(ye),Pe=this.grid.query(Ee.minX-be,Ee.minY-be,Ee.maxX+be,Ee.maxY+be),Ne=Xo.fromPoints(h.cameraQueryGeometry).expandBy(be),Ue=this.grid3D.query(Ne.minX,Ne.minY,Ne.maxX,Ne.maxY,((rt,dt,Ct,vt)=>(function(qt,Lt,Gt,Xt,_r){for(const fr of qt)if(Lt<=fr.x&&Gt<=fr.y&&Xt>=fr.x&&_r>=fr.y)return!0;const lr=[new U(Lt,Gt),new U(Lt,_r),new U(Xt,_r),new U(Xt,Gt)];if(qt.length>2){for(const fr of lr)if(Vs(qt,fr))return!0}for(let fr=0;fr<qt.length-1;fr++)if(wf(qt[fr],qt[fr+1],lr))return!0;return!1})(h.cameraQueryGeometry,rt-be,dt-be,Ct+be,vt+be)));for(const rt of Ue)Pe.push(rt);Pe.sort(Hp);const $e={};let Ye;for(let rt=0;rt<Pe.length;rt++){const dt=Pe[rt];if(dt===Ye)continue;Ye=dt;const Ct=this.featureIndexArray.get(dt);let vt=null;this.loadMatchingFeature($e,Ct.bucketIndex,Ct.sourceLayerIndex,Ct.featureIndex,fe,le.layers,le.availableImages,W,X,te,((qt,Lt,Gt)=>(vt||(vt=Wo(qt)),Lt.queryIntersectsFeature({queryGeometry:ye,feature:qt,featureState:Gt,geometry:vt,zoom:this.z,transform:h.transform,pixelsToTileUnits:he,pixelPosMatrix:h.pixelPosMatrix,unwrappedTileID:this.tileID.toUnwrapped(),getElevation:h.getElevation}))))}return $e}loadMatchingFeature(h,W,X,te,le,he,fe,ye,be,Ee,Pe){const Ne=this.bucketLayerIDs[W];if(he&&!Ne.some((rt=>he.has(rt))))return;const Ue=this.sourceLayerCoder.decode(X),$e=this.vtLayers[Ue].feature(te);if(le.needGeometry){const rt=Ho($e,!0);if(!le.filter(new mi(this.tileID.overscaledZ),rt,this.tileID.canonical))return}else if(!le.filter(new mi(this.tileID.overscaledZ),$e))return;const Ye=this.getId($e,Ue);for(let rt=0;rt<Ne.length;rt++){const dt=Ne[rt];if(he&&!he.has(dt))continue;const Ct=ye[dt];if(!Ct)continue;let vt={};Ye&&Ee&&(vt=Ee.getState(Ct.sourceLayer||"_geojsonTileLayer",Ye));const qt=Wt({},be[dt]);qt.paint=Zd(qt.paint,Ct.paint,$e,vt,fe),qt.layout=Zd(qt.layout,Ct.layout,$e,vt,fe);const Lt=!Pe||Pe($e,Ct,vt);if(!Lt)continue;const Gt=new Wd($e,this.z,this.x,this.y,Ye);Gt.layer=qt;let Xt=h[dt];Xt===void 0&&(Xt=h[dt]=[]),Xt.push({featureIndex:te,feature:Gt,intersectionZ:Lt})}}lookupSymbolFeatures(h,W,X,te,le,he,fe,ye){const be={};this.loadVTLayers();const Ee=Mo(le.filterSpec,le.globalState);for(const Pe of h)this.loadMatchingFeature(be,X,te,Pe,Ee,he,fe,ye,W);return be}hasLayer(h){for(const W of this.bucketLayerIDs)for(const X of W)if(h===X)return!0;return!1}getId(h,W){var X;let te=h.id;return this.promoteId&&(te=h.properties[typeof this.promoteId=="string"?this.promoteId:this.promoteId[W]],typeof te=="boolean"&&(te=Number(te)),te===void 0&&(!((X=h.properties)===null||X===void 0)&&X.cluster)&&this.promoteId&&(te=Number(h.properties.cluster_id))),te}}function Zd(H,h,W,X,te){return wr(H,((le,he)=>{const fe=h instanceof Ls?h.get(he):null;return fe&&fe.evaluate?fe.evaluate(W,X,te):fe}))}function Hp(H,h){return h-H}function Kd(H,h,W,X,te){const le=[];for(let he=0;he<H.length;he++){const fe=H[he];let ye;for(let be=0;be<fe.length-1;be++){let Ee=fe[be],Pe=fe[be+1];Ee.x<h&&Pe.x<h||(Ee.x<h?Ee=new U(h,Ee.y+(h-Ee.x)/(Pe.x-Ee.x)*(Pe.y-Ee.y))._round():Pe.x<h&&(Pe=new U(h,Ee.y+(h-Ee.x)/(Pe.x-Ee.x)*(Pe.y-Ee.y))._round()),Ee.y<W&&Pe.y<W||(Ee.y<W?Ee=new U(Ee.x+(W-Ee.y)/(Pe.y-Ee.y)*(Pe.x-Ee.x),W)._round():Pe.y<W&&(Pe=new U(Ee.x+(W-Ee.y)/(Pe.y-Ee.y)*(Pe.x-Ee.x),W)._round()),Ee.x>=X&&Pe.x>=X||(Ee.x>=X?Ee=new U(X,Ee.y+(X-Ee.x)/(Pe.x-Ee.x)*(Pe.y-Ee.y))._round():Pe.x>=X&&(Pe=new U(X,Ee.y+(X-Ee.x)/(Pe.x-Ee.x)*(Pe.y-Ee.y))._round()),Ee.y>=te&&Pe.y>=te||(Ee.y>=te?Ee=new U(Ee.x+(te-Ee.y)/(Pe.y-Ee.y)*(Pe.x-Ee.x),te)._round():Pe.y>=te&&(Pe=new U(Ee.x+(te-Ee.y)/(Pe.y-Ee.y)*(Pe.x-Ee.x),te)._round()),ye&&Ee.equals(ye[ye.length-1])||(ye=[Ee],le.push(ye)),ye.push(Pe)))))}}return le}vr("FeatureIndex",Hd,{omit:["rawTileData","sourceLayerCoder"]});class po extends U{constructor(h,W,X,te){super(h,W),this.angle=X,te!==void 0&&(this.segment=te)}clone(){return new po(this.x,this.y,this.angle,this.segment)}}function Xd(H,h,W,X,te){if(h.segment===void 0||W===0)return!0;let le=h,he=h.segment+1,fe=0;for(;fe>-W/2;){if(he--,he<0)return!1;fe-=H[he].dist(le),le=H[he]}fe+=H[he].dist(H[he+1]),he++;const ye=[];let be=0;for(;fe<W/2;){const Ee=H[he],Pe=H[he+1];if(!Pe)return!1;let Ne=H[he-1].angleTo(Ee)-Ee.angleTo(Pe);for(Ne=Math.abs((Ne+3*Math.PI)%(2*Math.PI)-Math.PI),ye.push({distance:fe,angleDelta:Ne}),be+=Ne;fe-ye[0].distance>X;)be-=ye.shift().angleDelta;if(be>te)return!1;he++,fe+=Ee.dist(Pe)}return!0}function Yd(H){let h=0;for(let W=0;W<H.length-1;W++)h+=H[W].dist(H[W+1]);return h}function Jd(H,h,W){return H?.6*h*W:0}function Qd(H,h){return Math.max(H?H.right-H.left:0,h?h.right-h.left:0)}function Zp(H,h,W,X,te,le){const he=Jd(W,te,le),fe=Qd(W,X)*le;let ye=0;const be=Yd(H)/2;for(let Ee=0;Ee<H.length-1;Ee++){const Pe=H[Ee],Ne=H[Ee+1],Ue=Pe.dist(Ne);if(ye+Ue>be){const $e=(be-ye)/Ue,Ye=An.number(Pe.x,Ne.x,$e),rt=An.number(Pe.y,Ne.y,$e),dt=new po(Ye,rt,Ne.angleTo(Pe),Ee);return dt._round(),!he||Xd(H,dt,fe,he,h)?dt:void 0}ye+=Ue}}function Kp(H,h,W,X,te,le,he,fe,ye){const be=Jd(X,le,he),Ee=Qd(X,te),Pe=Ee*he,Ne=H[0].x===0||H[0].x===ye||H[0].y===0||H[0].y===ye;return h-Pe<h/4&&(h=Pe+h/4),ef(H,Ne?h/2*fe%h:(Ee/2+2*le)*he*fe%h,h,be,W,Pe,Ne,!1,ye)}function ef(H,h,W,X,te,le,he,fe,ye){const be=le/2,Ee=Yd(H);let Pe=0,Ne=h-W,Ue=[];for(let $e=0;$e<H.length-1;$e++){const Ye=H[$e],rt=H[$e+1],dt=Ye.dist(rt),Ct=rt.angleTo(Ye);for(;Ne+W<Pe+dt;){Ne+=W;const vt=(Ne-Pe)/dt,qt=An.number(Ye.x,rt.x,vt),Lt=An.number(Ye.y,rt.y,vt);if(qt>=0&&qt<ye&&Lt>=0&&Lt<ye&&Ne-be>=0&&Ne+be<=Ee){const Gt=new po(qt,Lt,Ct,$e);Gt._round(),X&&!Xd(H,Gt,le,X,te)||Ue.push(Gt)}}Pe+=dt}return fe||Ue.length||he||(Ue=ef(H,Pe/2,W,X,te,le,he,!0,ye)),Ue}function tf(H,h,W,X){const te=[],le=H.image,he=le.pixelRatio,fe=le.paddedRect.w-2,ye=le.paddedRect.h-2;let be={x1:H.left,y1:H.top,x2:H.right,y2:H.bottom};const Ee=le.stretchX||[[0,fe]],Pe=le.stretchY||[[0,ye]],Ne=($t,zr)=>$t+zr[1]-zr[0],Ue=Ee.reduce(Ne,0),$e=Pe.reduce(Ne,0),Ye=fe-Ue,rt=ye-$e;let dt=0,Ct=Ue,vt=0,qt=$e,Lt=0,Gt=Ye,Xt=0,_r=rt;if(le.content&&X){const $t=le.content,zr=$t[2]-$t[0],Vr=$t[3]-$t[1];(le.textFitWidth||le.textFitHeight)&&(be=Pd(H)),dt=xc(Ee,0,$t[0]),vt=xc(Pe,0,$t[1]),Ct=xc(Ee,$t[0],$t[2]),qt=xc(Pe,$t[1],$t[3]),Lt=$t[0]-dt,Xt=$t[1]-vt,Gt=zr-Ct,_r=Vr-qt}const lr=be.x1,fr=be.y1,Cr=be.x2-lr,hr=be.y2-fr,pr=($t,zr,Vr,kr)=>{const Pr=wc($t.stretch-dt,Ct,Cr,lr),ai=Sc($t.fixed-Lt,Gt,$t.stretch,Ue),Ci=wc(zr.stretch-vt,qt,hr,fr),Vi=Sc(zr.fixed-Xt,_r,zr.stretch,$e),un=wc(Vr.stretch-dt,Ct,Cr,lr),zn=Sc(Vr.fixed-Lt,Gt,Vr.stretch,Ue),In=wc(kr.stretch-vt,qt,hr,fr),nn=Sc(kr.fixed-Xt,_r,kr.stretch,$e),Ai=new U(Pr,Ci),Xi=new U(un,Ci),an=new U(un,In),on=new U(Pr,In),bn=new U(ai/he,Vi/he),Un=new U(zn/he,nn/he),Yi=h*Math.PI/180;if(Yi){const Ji=Math.sin(Yi),Qi=Math.cos(Yi),ji=[Qi,-Ji,Ji,Qi];Ai._matMult(ji),Xi._matMult(ji),on._matMult(ji),an._matMult(ji)}const Rn=$t.stretch+$t.fixed,Gi=zr.stretch+zr.fixed;return{tl:Ai,tr:Xi,bl:on,br:an,tex:{x:le.paddedRect.x+1+Rn,y:le.paddedRect.y+1+Gi,w:Vr.stretch+Vr.fixed-Rn,h:kr.stretch+kr.fixed-Gi},writingMode:void 0,glyphOffset:[0,0],sectionIndex:0,pixelOffsetTL:bn,pixelOffsetBR:Un,minFontScaleX:Gt/he/Cr,minFontScaleY:_r/he/hr,isSDF:W}};if(X&&(le.stretchX||le.stretchY)){const $t=rf(Ee,Ye,Ue),zr=rf(Pe,rt,$e);for(let Vr=0;Vr<$t.length-1;Vr++){const kr=$t[Vr],Pr=$t[Vr+1];for(let ai=0;ai<zr.length-1;ai++)te.push(pr(kr,zr[ai],Pr,zr[ai+1]))}}else te.push(pr({fixed:0,stretch:-1},{fixed:0,stretch:-1},{fixed:0,stretch:fe+1},{fixed:0,stretch:ye+1}));return te}function xc(H,h,W){let X=0;for(const te of H)X+=Math.max(h,Math.min(W,te[1]))-Math.max(h,Math.min(W,te[0]));return X}function rf(H,h,W){const X=[{fixed:-1,stretch:0}];for(const[te,le]of H){const he=X[X.length-1];X.push({fixed:te-he.stretch,stretch:he.stretch}),X.push({fixed:te-he.stretch,stretch:he.stretch+(le-te)})}return X.push({fixed:h+1,stretch:W}),X}function wc(H,h,W,X){return H/h*W+X}function Sc(H,h,W,X){return H-h*W/X}vr("Anchor",po);class Ec{constructor(h,W,X,te,le,he,fe,ye,be,Ee){var Pe;if(this.boxStartIndex=h.length,be){let Ne=he.top,Ue=he.bottom;const $e=he.collisionPadding;$e&&(Ne-=$e[1],Ue+=$e[3]);let Ye=Ue-Ne;Ye>0&&(Ye=Math.max(10,Ye),this.circleDiameter=Ye)}else{const Ne=!((Pe=he.image)===null||Pe===void 0)&&Pe.content&&(he.image.textFitWidth||he.image.textFitHeight)?Pd(he):{x1:he.left,y1:he.top,x2:he.right,y2:he.bottom};Ne.y1=Ne.y1*fe-ye[0],Ne.y2=Ne.y2*fe+ye[2],Ne.x1=Ne.x1*fe-ye[3],Ne.x2=Ne.x2*fe+ye[1];const Ue=he.collisionPadding;if(Ue&&(Ne.x1-=Ue[0]*fe,Ne.y1-=Ue[1]*fe,Ne.x2+=Ue[2]*fe,Ne.y2+=Ue[3]*fe),Ee){const $e=new U(Ne.x1,Ne.y1),Ye=new U(Ne.x2,Ne.y1),rt=new U(Ne.x1,Ne.y2),dt=new U(Ne.x2,Ne.y2),Ct=Ee*Math.PI/180;$e._rotate(Ct),Ye._rotate(Ct),rt._rotate(Ct),dt._rotate(Ct),Ne.x1=Math.min($e.x,Ye.x,rt.x,dt.x),Ne.x2=Math.max($e.x,Ye.x,rt.x,dt.x),Ne.y1=Math.min($e.y,Ye.y,rt.y,dt.y),Ne.y2=Math.max($e.y,Ye.y,rt.y,dt.y)}h.emplaceBack(W.x,W.y,Ne.x1,Ne.y1,Ne.x2,Ne.y2,X,te,le)}this.boxEndIndex=h.length}}class Xp{constructor(h=[],W=(X,te)=>X<te?-1:X>te?1:0){if(this.data=h,this.length=this.data.length,this.compare=W,this.length>0)for(let X=(this.length>>1)-1;X>=0;X--)this._down(X)}push(h){this.data.push(h),this._up(this.length++)}pop(){if(this.length===0)return;const h=this.data[0],W=this.data.pop();return--this.length>0&&(this.data[0]=W,this._down(0)),h}peek(){return this.data[0]}_up(h){const{data:W,compare:X}=this,te=W[h];for(;h>0;){const le=h-1>>1,he=W[le];if(X(te,he)>=0)break;W[h]=he,h=le}W[h]=te}_down(h){const{data:W,compare:X}=this,te=this.length>>1,le=W[h];for(;h<te;){let he=1+(h<<1);const fe=he+1;if(fe<this.length&&X(W[fe],W[he])<0&&(he=fe),X(W[he],le)>=0)break;W[h]=W[he],h=he}W[h]=le}}function Yp(H,h=1,W=!1){const X=Xo.fromPoints(H[0]),te=Math.min(X.width(),X.height());let le=te/2;const he=new Xp([],Jp),{minX:fe,minY:ye,maxX:be,maxY:Ee}=X;if(te===0)return new U(fe,ye);for(let Ue=fe;Ue<be;Ue+=te)for(let $e=ye;$e<Ee;$e+=te)he.push(new Qs(Ue+le,$e+le,le,H));let Pe=(function(Ue){let $e=0,Ye=0,rt=0;const dt=Ue[0];for(let Ct=0,vt=dt.length,qt=vt-1;Ct<vt;qt=Ct++){const Lt=dt[Ct],Gt=dt[qt],Xt=Lt.x*Gt.y-Gt.x*Lt.y;Ye+=(Lt.x+Gt.x)*Xt,rt+=(Lt.y+Gt.y)*Xt,$e+=3*Xt}return new Qs(Ye/$e,rt/$e,0,Ue)})(H),Ne=he.length;for(;he.length;){const Ue=he.pop();(Ue.d>Pe.d||!Pe.d)&&(Pe=Ue,W&&console.log("found best %d after %d probes",Math.round(1e4*Ue.d)/1e4,Ne)),Ue.max-Pe.d<=h||(le=Ue.h/2,he.push(new Qs(Ue.p.x-le,Ue.p.y-le,le,H)),he.push(new Qs(Ue.p.x+le,Ue.p.y-le,le,H)),he.push(new Qs(Ue.p.x-le,Ue.p.y+le,le,H)),he.push(new Qs(Ue.p.x+le,Ue.p.y+le,le,H)),Ne+=4)}return W&&(console.log(`num probes: ${Ne}`),console.log(`best distance: ${Pe.d}`)),Pe.p}function Jp(H,h){return h.max-H.max}function Qs(H,h,W,X){this.p=new U(H,h),this.h=W,this.d=(function(te,le){let he=!1,fe=1/0;for(let ye=0;ye<le.length;ye++){const be=le[ye];for(let Ee=0,Pe=be.length,Ne=Pe-1;Ee<Pe;Ne=Ee++){const Ue=be[Ee],$e=be[Ne];Ue.y>te.y!=$e.y>te.y&&te.x<($e.x-Ue.x)*(te.y-Ue.y)/($e.y-Ue.y)+Ue.x&&(he=!he),fe=Math.min(fe,zh(te,Ue,$e))}}return(he?1:-1)*Math.sqrt(fe)})(this.p,X),this.max=this.d+this.h*Math.SQRT2}var ln;ee.aE=void 0,(ln=ee.aE||(ee.aE={}))[ln.center=1]="center",ln[ln.left=2]="left",ln[ln.right=3]="right",ln[ln.top=4]="top",ln[ln.bottom=5]="bottom",ln[ln["top-left"]=6]="top-left",ln[ln["top-right"]=7]="top-right",ln[ln["bottom-left"]=8]="bottom-left",ln[ln["bottom-right"]=9]="bottom-right";const Th=Number.POSITIVE_INFINITY;function nf(H,h){return h[1]!==Th?(function(W,X,te){let le=0,he=0;switch(X=Math.abs(X),te=Math.abs(te),W){case"top-right":case"top-left":case"top":he=te-7;break;case"bottom-right":case"bottom-left":case"bottom":he=7-te}switch(W){case"top-right":case"bottom-right":case"right":le=-X;break;case"top-left":case"bottom-left":case"left":le=X}return[le,he]})(H,h[0],h[1]):(function(W,X){let te=0,le=0;X<0&&(X=0);const he=X/Math.SQRT2;switch(W){case"top-right":case"top-left":le=he-7;break;case"bottom-right":case"bottom-left":le=7-he;break;case"bottom":le=7-X;break;case"top":le=X-7}switch(W){case"top-right":case"bottom-right":te=-he;break;case"top-left":case"bottom-left":te=he;break;case"left":te=X;break;case"right":te=-X}return[te,le]})(H,h[0])}function af(H,h,W){var X;const te=H.layout,le=(X=te.get("text-variable-anchor-offset"))===null||X===void 0?void 0:X.evaluate(h,{},W);if(le){const fe=le.values,ye=[];for(let be=0;be<fe.length;be+=2){const Ee=ye[be]=fe[be],Pe=fe[be+1].map((Ne=>Ne*Ki));Ee.startsWith("top")?Pe[1]-=7:Ee.startsWith("bottom")&&(Pe[1]+=7),ye[be+1]=Pe}return new fn(ye)}const he=te.get("text-variable-anchor");if(he){let fe;fe=H._unevaluatedLayout.getValue("text-radial-offset")!==void 0?[te.get("text-radial-offset").evaluate(h,{},W)*Ki,Th]:te.get("text-offset").evaluate(h,{},W).map((be=>be*Ki));const ye=[];for(const be of he)ye.push(be,nf(be,fe));return new fn(ye)}return null}function Ih(H){switch(H){case"right":case"top-right":case"bottom-right":return"right";case"left":case"top-left":case"bottom-left":return"left"}return"center"}function Qp(H,h,W,X,te,le,he,fe,ye,be,Ee,Pe){let Ne=le.textMaxSize.evaluate(h,{});Ne===void 0&&(Ne=he);const Ue=H.layers[0].layout,$e=Ue.get("icon-offset").evaluate(h,{},Ee),Ye=sf(W.horizontal),rt=he/24,dt=H.tilePixelRatio*rt,Ct=H.tilePixelRatio*Ne/24,vt=H.tilePixelRatio*fe,qt=H.tilePixelRatio*Ue.get("symbol-spacing"),Lt=Ue.get("text-padding")*H.tilePixelRatio,Gt=(function(Vr,kr,Pr,ai=1){const Ci=Vr.get("icon-padding").evaluate(kr,{},Pr),Vi=Ci&&Ci.values;return[Vi[0]*ai,Vi[1]*ai,Vi[2]*ai,Vi[3]*ai]})(Ue,h,Ee,H.tilePixelRatio),Xt=Ue.get("text-max-angle")/180*Math.PI,_r=Ue.get("text-rotation-alignment")!=="viewport"&&Ue.get("symbol-placement")!=="point",lr=Ue.get("icon-rotation-alignment")==="map"&&Ue.get("symbol-placement")!=="point",fr=Ue.get("symbol-placement"),Cr=qt/2,hr=Ue.get("icon-text-fit");let pr;X&&hr!=="none"&&(H.allowVerticalPlacement&&W.vertical&&(pr=Od(X,W.vertical,hr,Ue.get("icon-text-fit-padding"),$e,rt)),Ye&&(X=Od(X,Ye,hr,Ue.get("icon-text-fit-padding"),$e,rt)));const $t=Ee?Pe.line.getGranularityForZoomLevel(Ee.z):1,zr=(Vr,kr)=>{kr.x<0||kr.x>=ut||kr.y<0||kr.y>=ut||(function(Pr,ai,Ci,Vi,un,zn,In,nn,Ai,Xi,an,on,bn,Un,Yi,Rn,Gi,Ji,Qi,ji,wi,ta,el,ra,r_){const tl=Pr.addToLineVertexArray(ai,Ci);let Yo,rl,il,nl,hf=0,df=0,ff=0,pf=0,Fh=-1,kh=-1;const La={};let _f=uo("");if(Pr.allowVerticalPlacement&&Vi.vertical){const mn=nn.layout.get("text-rotate").evaluate(wi,{},ra)+90;il=new Ec(Ai,ai,Xi,an,on,Vi.vertical,bn,Un,Yi,mn),In&&(nl=new Ec(Ai,ai,Xi,an,on,In,Gi,Ji,Yi,mn))}if(un){const mn=nn.layout.get("icon-rotate").evaluate(wi,{}),Vn=nn.layout.get("icon-text-fit")!=="none",Jo=tf(un,mn,el,Vn),na=In?tf(In,mn,el,Vn):void 0;rl=new Ec(Ai,ai,Xi,an,on,un,Gi,Ji,!1,mn),hf=4*Jo.length;const Qo=Pr.iconSizeData;let ma=null;Qo.kind==="source"?(ma=[ka*nn.layout.get("icon-size").evaluate(wi,{})],ma[0]>ho&&Mr(`${Pr.layerIds[0]}: Value for "icon-size" is >= 255. Reduce your "icon-size".`)):Qo.kind==="composite"&&(ma=[ka*ta.compositeIconSizes[0].evaluate(wi,{},ra),ka*ta.compositeIconSizes[1].evaluate(wi,{},ra)],(ma[0]>ho||ma[1]>ho)&&Mr(`${Pr.layerIds[0]}: Value for "icon-size" is >= 255. Reduce your "icon-size".`)),Pr.addSymbols(Pr.icon,Jo,ma,ji,Qi,wi,ee.ao.none,ai,tl.lineStartIndex,tl.lineLength,-1,ra),Fh=Pr.icon.placedSymbolArray.length-1,na&&(df=4*na.length,Pr.addSymbols(Pr.icon,na,ma,ji,Qi,wi,ee.ao.vertical,ai,tl.lineStartIndex,tl.lineLength,-1,ra),kh=Pr.icon.placedSymbolArray.length-1)}const mf=Object.keys(Vi.horizontal);for(const mn of mf){const Vn=Vi.horizontal[mn];if(!Yo){_f=uo(Vn.text);const na=nn.layout.get("text-rotate").evaluate(wi,{},ra);Yo=new Ec(Ai,ai,Xi,an,on,Vn,bn,Un,Yi,na)}const Jo=Vn.positionedLines.length===1;if(ff+=of(Pr,ai,Vn,zn,nn,Yi,wi,Rn,tl,Vi.vertical?ee.ao.horizontal:ee.ao.horizontalOnly,Jo?mf:[mn],La,Fh,ta,ra),Jo)break}Vi.vertical&&(pf+=of(Pr,ai,Vi.vertical,zn,nn,Yi,wi,Rn,tl,ee.ao.vertical,["vertical"],La,kh,ta,ra));const i_=Yo?Yo.boxStartIndex:Pr.collisionBoxArray.length,n_=Yo?Yo.boxEndIndex:Pr.collisionBoxArray.length,a_=il?il.boxStartIndex:Pr.collisionBoxArray.length,o_=il?il.boxEndIndex:Pr.collisionBoxArray.length,s_=rl?rl.boxStartIndex:Pr.collisionBoxArray.length,l_=rl?rl.boxEndIndex:Pr.collisionBoxArray.length,u_=nl?nl.boxStartIndex:Pr.collisionBoxArray.length,c_=nl?nl.boxEndIndex:Pr.collisionBoxArray.length;let ia=-1;const Tc=(mn,Vn)=>mn&&mn.circleDiameter?Math.max(mn.circleDiameter,Vn):Vn;ia=Tc(Yo,ia),ia=Tc(il,ia),ia=Tc(rl,ia),ia=Tc(nl,ia);const yf=ia>-1?1:0;yf&&(ia*=r_/Ki),Pr.glyphOffsetArray.length>=Ys.MAX_GLYPHS&&Mr("Too many glyphs being rendered in a tile. See https://github.com/mapbox/mapbox-gl-js/issues/2907"),wi.sortKey!==void 0&&Pr.addToSortKeyRanges(Pr.symbolInstances.length,wi.sortKey);const h_=af(nn,wi,ra),[d_,f_]=(function(mn,Vn){const Jo=mn.length,na=Vn==null?void 0:Vn.values;if((na==null?void 0:na.length)>0)for(let Qo=0;Qo<na.length;Qo+=2){const ma=na[Qo+1];mn.emplaceBack(ee.aE[na[Qo]],ma[0],ma[1])}return[Jo,mn.length]})(Pr.textAnchorOffsets,h_);Pr.symbolInstances.emplaceBack(ai.x,ai.y,La.right>=0?La.right:-1,La.center>=0?La.center:-1,La.left>=0?La.left:-1,La.vertical||-1,Fh,kh,_f,i_,n_,a_,o_,s_,l_,u_,c_,Xi,ff,pf,hf,df,yf,0,bn,ia,d_,f_)})(H,kr,Vr,W,X,te,pr,H.layers[0],H.collisionBoxArray,h.index,h.sourceLayerIndex,H.index,dt,[Lt,Lt,Lt,Lt],_r,ye,vt,Gt,lr,$e,h,le,be,Ee,he)};if(fr==="line")for(const Vr of Kd(h.geometry,0,0,ut,ut)){const kr=Ko(Vr,$t),Pr=Kp(kr,qt,Xt,W.vertical||Ye,X,24,Ct,H.overscaling,ut);for(const ai of Pr)Ye&&e_(H,Ye.text,Cr,ai)||zr(kr,ai)}else if(fr==="line-center"){for(const Vr of h.geometry)if(Vr.length>1){const kr=Ko(Vr,$t),Pr=Zp(kr,Xt,W.vertical||Ye,X,24,Ct);Pr&&zr(kr,Pr)}}else if(h.type==="Polygon")for(const Vr of us(h.geometry,0)){const kr=Yp(Vr,16);zr(Ko(Vr[0],$t,!0),new po(kr.x,kr.y,0))}else if(h.type==="LineString")for(const Vr of h.geometry){const kr=Ko(Vr,$t);zr(kr,new po(kr[0].x,kr[0].y,0))}else if(h.type==="Point")for(const Vr of h.geometry)for(const kr of Vr)zr([kr],new po(kr.x,kr.y,0))}function of(H,h,W,X,te,le,he,fe,ye,be,Ee,Pe,Ne,Ue,$e){const Ye=(function(Ct,vt,qt,Lt,Gt,Xt,_r,lr){const fr=Lt.layout.get("text-rotate").evaluate(Xt,{})*Math.PI/180,Cr=[];for(const hr of vt.positionedLines)for(const pr of hr.positionedGlyphs){if(!pr.rect)continue;const $t=pr.rect||{};let zr=4,Vr=!0,kr=1,Pr=0;const ai=(Gt||lr)&&pr.vertical,Ci=pr.metrics.advance*pr.scale/2;if(lr&&vt.verticalizable&&(Pr=hr.lineOffset/2-(pr.imageName?-(Ki-pr.metrics.width*pr.scale)/2:(pr.scale-1)*Ki)),pr.imageName){const Ji=_r[pr.imageName];Vr=Ji.sdf,kr=Ji.pixelRatio,zr=1/kr}const Vi=Gt?[pr.x+Ci,pr.y]:[0,0];let un=Gt?[0,0]:[pr.x+Ci+qt[0],pr.y+qt[1]-Pr],zn=[0,0];ai&&(zn=un,un=[0,0]);const In=pr.metrics.isDoubleResolution?2:1,nn=(pr.metrics.left-zr)*pr.scale-Ci+un[0],Ai=(-pr.metrics.top-zr)*pr.scale+un[1],Xi=nn+$t.w/In*pr.scale/kr,an=Ai+$t.h/In*pr.scale/kr,on=new U(nn,Ai),bn=new U(Xi,Ai),Un=new U(nn,an),Yi=new U(Xi,an);if(ai){const Ji=new U(-Ci,Ci- -17),Qi=-Math.PI/2,ji=12-Ci,wi=new U(22-ji,-(pr.imageName?ji:0)),ta=new U(...zn);on._rotateAround(Qi,Ji)._add(wi)._add(ta),bn._rotateAround(Qi,Ji)._add(wi)._add(ta),Un._rotateAround(Qi,Ji)._add(wi)._add(ta),Yi._rotateAround(Qi,Ji)._add(wi)._add(ta)}if(fr){const Ji=Math.sin(fr),Qi=Math.cos(fr),ji=[Qi,-Ji,Ji,Qi];on._matMult(ji),bn._matMult(ji),Un._matMult(ji),Yi._matMult(ji)}const Rn=new U(0,0),Gi=new U(0,0);Cr.push({tl:on,tr:bn,bl:Un,br:Yi,tex:$t,writingMode:vt.writingMode,glyphOffset:Vi,sectionIndex:pr.sectionIndex,isSDF:Vr,pixelOffsetTL:Rn,pixelOffsetBR:Gi,minFontScaleX:0,minFontScaleY:0})}return Cr})(0,W,fe,te,le,he,X,H.allowVerticalPlacement),rt=H.textSizeData;let dt=null;rt.kind==="source"?(dt=[ka*te.layout.get("text-size").evaluate(he,{})],dt[0]>ho&&Mr(`${H.layerIds[0]}: Value for "text-size" is >= 255. Reduce your "text-size".`)):rt.kind==="composite"&&(dt=[ka*Ue.compositeTextSizes[0].evaluate(he,{},$e),ka*Ue.compositeTextSizes[1].evaluate(he,{},$e)],(dt[0]>ho||dt[1]>ho)&&Mr(`${H.layerIds[0]}: Value for "text-size" is >= 255. Reduce your "text-size".`)),H.addSymbols(H.text,Ye,dt,fe,le,he,be,h,ye.lineStartIndex,ye.lineLength,Ne,$e);for(const Ct of Ee)Pe[Ct]=H.text.placedSymbolArray.length-1;return 4*Ye.length}function sf(H){for(const h in H)return H[h];return null}function e_(H,h,W,X){const te=H.compareText;if(h in te){const le=te[h];for(let he=le.length-1;he>=0;he--)if(X.dist(le[he])<W)return!0}else te[h]=[];return te[h].push(X),!1}const lf=[Int8Array,Uint8Array,Uint8ClampedArray,Int16Array,Uint16Array,Int32Array,Uint32Array,Float32Array,Float64Array];class Rh{static from(h){if(!(h instanceof ArrayBuffer))throw new Error("Data must be an instance of ArrayBuffer.");const[W,X]=new Uint8Array(h,0,2);if(W!==219)throw new Error("Data does not appear to be in a KDBush format.");const te=X>>4;if(te!==1)throw new Error(`Got v${te} data when expected v1.`);const le=lf[15&X];if(!le)throw new Error("Unrecognized array type.");const[he]=new Uint16Array(h,2,1),[fe]=new Uint32Array(h,4,1);return new Rh(fe,he,le,h)}constructor(h,W=64,X=Float64Array,te){if(isNaN(h)||h<0)throw new Error(`Unpexpected numItems value: ${h}.`);this.numItems=+h,this.nodeSize=Math.min(Math.max(+W,2),65535),this.ArrayType=X,this.IndexArrayType=h<65536?Uint16Array:Uint32Array;const le=lf.indexOf(this.ArrayType),he=2*h*this.ArrayType.BYTES_PER_ELEMENT,fe=h*this.IndexArrayType.BYTES_PER_ELEMENT,ye=(8-fe%8)%8;if(le<0)throw new Error(`Unexpected typed array class: ${X}.`);te&&te instanceof ArrayBuffer?(this.data=te,this.ids=new this.IndexArrayType(this.data,8,h),this.coords=new this.ArrayType(this.data,8+fe+ye,2*h),this._pos=2*h,this._finished=!0):(this.data=new ArrayBuffer(8+he+fe+ye),this.ids=new this.IndexArrayType(this.data,8,h),this.coords=new this.ArrayType(this.data,8+fe+ye,2*h),this._pos=0,this._finished=!1,new Uint8Array(this.data,0,2).set([219,16+le]),new Uint16Array(this.data,2,1)[0]=W,new Uint32Array(this.data,4,1)[0]=h)}add(h,W){const X=this._pos>>1;return this.ids[X]=X,this.coords[this._pos++]=h,this.coords[this._pos++]=W,X}finish(){const h=this._pos>>1;if(h!==this.numItems)throw new Error(`Added ${h} items when expected ${this.numItems}.`);return Ah(this.ids,this.coords,this.nodeSize,0,this.numItems-1,0),this._finished=!0,this}range(h,W,X,te){if(!this._finished)throw new Error("Data not yet indexed - call index.finish().");const{ids:le,coords:he,nodeSize:fe}=this,ye=[0,le.length-1,0],be=[];for(;ye.length;){const Ee=ye.pop()||0,Pe=ye.pop()||0,Ne=ye.pop()||0;if(Pe-Ne<=fe){for(let rt=Ne;rt<=Pe;rt++){const dt=he[2*rt],Ct=he[2*rt+1];dt>=h&&dt<=X&&Ct>=W&&Ct<=te&&be.push(le[rt])}continue}const Ue=Ne+Pe>>1,$e=he[2*Ue],Ye=he[2*Ue+1];$e>=h&&$e<=X&&Ye>=W&&Ye<=te&&be.push(le[Ue]),(Ee===0?h<=$e:W<=Ye)&&(ye.push(Ne),ye.push(Ue-1),ye.push(1-Ee)),(Ee===0?X>=$e:te>=Ye)&&(ye.push(Ue+1),ye.push(Pe),ye.push(1-Ee))}return be}within(h,W,X){if(!this._finished)throw new Error("Data not yet indexed - call index.finish().");const{ids:te,coords:le,nodeSize:he}=this,fe=[0,te.length-1,0],ye=[],be=X*X;for(;fe.length;){const Ee=fe.pop()||0,Pe=fe.pop()||0,Ne=fe.pop()||0;if(Pe-Ne<=he){for(let rt=Ne;rt<=Pe;rt++)cf(le[2*rt],le[2*rt+1],h,W)<=be&&ye.push(te[rt]);continue}const Ue=Ne+Pe>>1,$e=le[2*Ue],Ye=le[2*Ue+1];cf($e,Ye,h,W)<=be&&ye.push(te[Ue]),(Ee===0?h-X<=$e:W-X<=Ye)&&(fe.push(Ne),fe.push(Ue-1),fe.push(1-Ee)),(Ee===0?h+X>=$e:W+X>=Ye)&&(fe.push(Ue+1),fe.push(Pe),fe.push(1-Ee))}return ye}}function Ah(H,h,W,X,te,le){if(te-X<=W)return;const he=X+te>>1;uf(H,h,he,X,te,le),Ah(H,h,W,X,he-1,1-le),Ah(H,h,W,he+1,te,1-le)}function uf(H,h,W,X,te,le){for(;te>X;){if(te-X>600){const be=te-X+1,Ee=W-X+1,Pe=Math.log(be),Ne=.5*Math.exp(2*Pe/3),Ue=.5*Math.sqrt(Pe*Ne*(be-Ne)/be)*(Ee-be/2<0?-1:1);uf(H,h,W,Math.max(X,Math.floor(W-Ee*Ne/be+Ue)),Math.min(te,Math.floor(W+(be-Ee)*Ne/be+Ue)),le)}const he=h[2*W+le];let fe=X,ye=te;for(du(H,h,X,W),h[2*te+le]>he&&du(H,h,X,te);fe<ye;){for(du(H,h,fe,ye),fe++,ye--;h[2*fe+le]<he;)fe++;for(;h[2*ye+le]>he;)ye--}h[2*X+le]===he?du(H,h,X,ye):(ye++,du(H,h,ye,te)),ye<=W&&(X=ye+1),W<=ye&&(te=ye-1)}}function du(H,h,W,X){Ph(H,W,X),Ph(h,2*W,2*X),Ph(h,2*W+1,2*X+1)}function Ph(H,h,W){const X=H[h];H[h]=H[W],H[W]=X}function cf(H,h,W,X){const te=H-W,le=h-X;return te*te+le*le}var Oh;ee.cx=void 0,(Oh=ee.cx||(ee.cx={})).create="create",Oh.load="load",Oh.fullLoad="fullLoad";let qc=null,fu=[];const Ch=1e3/60,Mh="loadTime",Dh="fullLoadTime",t_={mark(H){performance.mark(H)},frame(H){const h=H;qc!=null&&fu.push(h-qc),qc=h},clearMetrics(){qc=null,fu=[],performance.clearMeasures(Mh),performance.clearMeasures(Dh);for(const H in ee.cx)performance.clearMarks(ee.cx[H])},getPerformanceMetrics(){performance.measure(Mh,ee.cx.create,ee.cx.load),performance.measure(Dh,ee.cx.create,ee.cx.fullLoad);const H=performance.getEntriesByName(Mh)[0].duration,h=performance.getEntriesByName(Dh)[0].duration,W=fu.length,X=1/(fu.reduce(((le,he)=>le+he),0)/W/1e3),te=fu.filter((le=>le>Ch)).reduce(((le,he)=>le+(he-Ch)/Ch),0);return{loadTime:H,fullLoadTime:h,fps:X,percentDroppedFrames:te/(W+te)*100,totalFrames:W}}};ee.$=ut,ee.A=je,ee.B=function([H,h,W]){return h+=90,h*=Math.PI/180,W*=Math.PI/180,{x:H*Math.cos(h)*Math.sin(W),y:H*Math.sin(h)*Math.sin(W),z:H*Math.cos(W)}},ee.C=An,ee.D=Ar,ee.E=Zt,ee.F=mi,ee.G=Bl,ee.H=Nr,ee.I=_h,ee.J=class{constructor(H,h){this.target=H,this.mapId=h,this.resolveRejects={},this.tasks={},this.taskQueue=[],this.abortControllers={},this.messageHandlers={},this.invoker=new $p((()=>this.process())),this.subscription=nr(this.target,"message",(W=>this.receive(W)),!1),this.globalScope=jr(self)?H:window}registerMessageHandler(H,h){this.messageHandlers[H]=h}sendAsync(H,h){return new Promise(((W,X)=>{const te=Math.round(1e18*Math.random()).toString(36).substring(0,10),le=h?nr(h.signal,"abort",(()=>{le==null||le.unsubscribe(),delete this.resolveRejects[te];const ye={id:te,type:"<cancel>",origin:location.origin,targetMapId:H.targetMapId,sourceMapId:this.mapId};this.target.postMessage(ye)}),Wp):null;this.resolveRejects[te]={resolve:ye=>{le==null||le.unsubscribe(),W(ye)},reject:ye=>{le==null||le.unsubscribe(),X(ye)}};const he=[],fe=Object.assign(Object.assign({},H),{id:te,sourceMapId:this.mapId,origin:location.origin,data:jo(H.data,he)});this.target.postMessage(fe,{transfer:he})}))}receive(H){const h=H.data,W=h.id;if(!(h.origin!=="file://"&&location.origin!=="file://"&&h.origin!=="resource://android"&&location.origin!=="resource://android"&&h.origin!==location.origin||h.targetMapId&&this.mapId!==h.targetMapId)){if(h.type==="<cancel>"){delete this.tasks[W];const X=this.abortControllers[W];return delete this.abortControllers[W],void(X&&X.abort())}if(jr(self)||h.mustQueue)return this.tasks[W]=h,this.taskQueue.push(W),void this.invoker.trigger();this.processTask(W,h)}}process(){if(this.taskQueue.length===0)return;const H=this.taskQueue.shift(),h=this.tasks[H];delete this.tasks[H],this.taskQueue.length>0&&this.invoker.trigger(),h&&this.processTask(H,h)}processTask(H,h){return R(this,void 0,void 0,(function*(){if(h.type==="<response>"){const te=this.resolveRejects[H];return delete this.resolveRejects[H],te?void(h.error?te.reject(Pa(h.error)):te.resolve(Pa(h.data))):void 0}if(!this.messageHandlers[h.type])return void this.completeTask(H,new Error(`Could not find a registered handler for ${h.type}, map ID: ${this.mapId}, available handlers: ${Object.keys(this.messageHandlers).join(", ")}`));const W=Pa(h.data),X=new AbortController;this.abortControllers[H]=X;try{const te=yield this.messageHandlers[h.type](h.sourceMapId,W,X);this.completeTask(H,null,te)}catch(te){this.completeTask(H,te)}}))}completeTask(H,h,W){const X=[];delete this.abortControllers[H];const te={id:H,type:"<response>",sourceMapId:this.mapId,origin:location.origin,error:h?jo(h):null,data:jo(W,X)};this.target.postMessage(te,{transfer:X})}remove(){this.invoker.remove(),this.subscription.unsubscribe()}},ee.K=ze,ee.L=function(){var H=new je(16);return je!=Float32Array&&(H[1]=0,H[2]=0,H[3]=0,H[4]=0,H[6]=0,H[7]=0,H[8]=0,H[9]=0,H[11]=0,H[12]=0,H[13]=0,H[14]=0),H[0]=1,H[5]=1,H[10]=1,H[15]=1,H},ee.M=function(H,h,W){var X,te,le,he,fe,ye,be,Ee,Pe,Ne,Ue,$e,Ye=W[0],rt=W[1],dt=W[2];return h===H?(H[12]=h[0]*Ye+h[4]*rt+h[8]*dt+h[12],H[13]=h[1]*Ye+h[5]*rt+h[9]*dt+h[13],H[14]=h[2]*Ye+h[6]*rt+h[10]*dt+h[14],H[15]=h[3]*Ye+h[7]*rt+h[11]*dt+h[15]):(te=h[1],le=h[2],he=h[3],fe=h[4],ye=h[5],be=h[6],Ee=h[7],Pe=h[8],Ne=h[9],Ue=h[10],$e=h[11],H[0]=X=h[0],H[1]=te,H[2]=le,H[3]=he,H[4]=fe,H[5]=ye,H[6]=be,H[7]=Ee,H[8]=Pe,H[9]=Ne,H[10]=Ue,H[11]=$e,H[12]=X*Ye+fe*rt+Pe*dt+h[12],H[13]=te*Ye+ye*rt+Ne*dt+h[13],H[14]=le*Ye+be*rt+Ue*dt+h[14],H[15]=he*Ye+Ee*rt+$e*dt+h[15]),H},ee.N=function(H,h,W){var X=W[0],te=W[1],le=W[2];return H[0]=h[0]*X,H[1]=h[1]*X,H[2]=h[2]*X,H[3]=h[3]*X,H[4]=h[4]*te,H[5]=h[5]*te,H[6]=h[6]*te,H[7]=h[7]*te,H[8]=h[8]*le,H[9]=h[9]*le,H[10]=h[10]*le,H[11]=h[11]*le,H[12]=h[12],H[13]=h[13],H[14]=h[14],H[15]=h[15],H},ee.O=function(H,h,W){var X=h[0],te=h[1],le=h[2],he=h[3],fe=h[4],ye=h[5],be=h[6],Ee=h[7],Pe=h[8],Ne=h[9],Ue=h[10],$e=h[11],Ye=h[12],rt=h[13],dt=h[14],Ct=h[15],vt=W[0],qt=W[1],Lt=W[2],Gt=W[3];return H[0]=vt*X+qt*fe+Lt*Pe+Gt*Ye,H[1]=vt*te+qt*ye+Lt*Ne+Gt*rt,H[2]=vt*le+qt*be+Lt*Ue+Gt*dt,H[3]=vt*he+qt*Ee+Lt*$e+Gt*Ct,H[4]=(vt=W[4])*X+(qt=W[5])*fe+(Lt=W[6])*Pe+(Gt=W[7])*Ye,H[5]=vt*te+qt*ye+Lt*Ne+Gt*rt,H[6]=vt*le+qt*be+Lt*Ue+Gt*dt,H[7]=vt*he+qt*Ee+Lt*$e+Gt*Ct,H[8]=(vt=W[8])*X+(qt=W[9])*fe+(Lt=W[10])*Pe+(Gt=W[11])*Ye,H[9]=vt*te+qt*ye+Lt*Ne+Gt*rt,H[10]=vt*le+qt*be+Lt*Ue+Gt*dt,H[11]=vt*he+qt*Ee+Lt*$e+Gt*Ct,H[12]=(vt=W[12])*X+(qt=W[13])*fe+(Lt=W[14])*Pe+(Gt=W[15])*Ye,H[13]=vt*te+qt*ye+Lt*Ne+Gt*rt,H[14]=vt*le+qt*be+Lt*Ue+Gt*dt,H[15]=vt*he+qt*Ee+Lt*$e+Gt*Ct,H},ee.P=U,ee.Q=function(H,h){const W={};for(let X=0;X<h.length;X++){const te=h[X];te in H&&(W[te]=H[te])}return W},ee.R=Tn,ee.S=fo,ee.T=ah,ee.U=jd,ee.V=Nd,ee.W=De,ee.X=Ae,ee.Y=Yt,ee.Z=jn,ee._=R,ee.a=Te,ee.a$=ft,ee.a0=function(H,h){var W,X,te,le,he;if(!H)return h??{};if(!h)return H;let fe=Object.assign({},H);if(h.removeAll&&(fe={removeAll:!0}),h.remove){const ye=new Set(h.remove);fe.add&&(fe.add=fe.add.filter((Ee=>!ye.has(Ee.id)))),fe.update&&(fe.update=fe.update.filter((Ee=>!ye.has(Ee.id))));const be=new Set(((W=H.add)!==null&&W!==void 0?W:[]).map((Ee=>Ee.id)));h.remove=h.remove.filter((Ee=>!be.has(Ee)))}if(h.remove){const ye=new Set(fe.remove?fe.remove.concat(h.remove):h.remove);fe.remove=Array.from(ye.values())}if(h.add){const ye=fe.add?fe.add.concat(h.add):h.add,be=new Map(ye.map((Ee=>[Ee.id,Ee])));fe.add=Array.from(be.values())}if(h.update){const ye=new Map((X=fe.update)===null||X===void 0?void 0:X.map((be=>[be.id,be])));for(const be of h.update){const Ee=(te=ye.get(be.id))!==null&&te!==void 0?te:{id:be.id};be.newGeometry&&(Ee.newGeometry=be.newGeometry),be.addOrUpdateProperties&&(Ee.addOrUpdateProperties=((le=Ee.addOrUpdateProperties)!==null&&le!==void 0?le:[]).concat(be.addOrUpdateProperties)),be.removeProperties&&(Ee.removeProperties=((he=Ee.removeProperties)!==null&&he!==void 0?he:[]).concat(be.removeProperties)),be.removeAllProperties&&(Ee.removeAllProperties=!0),ye.set(be.id,Ee)}fe.update=Array.from(ye.values())}return fe.remove&&fe.add&&(fe.remove=fe.remove.filter((ye=>fe.add.findIndex((be=>be.id===ye))===-1))),fe},ee.a1=cu,ee.a2=Xo,ee.a3=25,ee.a4=qh,ee.a5=H=>{const h=window.document.createElement("video");return h.muted=!0,new Promise((W=>{h.onloadstart=()=>{W(h)};for(const X of H){const te=window.document.createElement("source");Ze(X)||(h.crossOrigin="Anonymous"),te.src=X,h.appendChild(te)}}))},ee.a6=Ht,ee.a7=function(){return or++},ee.a8=Le,ee.a9=Ys,ee.aA=function(H){let h=1/0,W=1/0,X=-1/0,te=-1/0;for(const le of H)h=Math.min(h,le.x),W=Math.min(W,le.y),X=Math.max(X,le.x),te=Math.max(te,le.y);return[h,W,X,te]},ee.aB=Ki,ee.aC=Et,ee.aD=function(H,h,W,X,te=!1){if(!W[0]&&!W[1])return[0,0];const le=te?X==="map"?-H.bearingInRadians:0:X==="viewport"?H.bearingInRadians:0;if(le){const he=Math.sin(le),fe=Math.cos(le);W=[W[0]*fe-W[1]*he,W[0]*he+W[1]*fe]}return[te?W[0]:Et(h,W[0],H.zoom),te?W[1]:Et(h,W[1],H.zoom)]},ee.aF=gh,ee.aG=Ih,ee.aH=yh,ee.aI=Rh,ee.aJ=Di,ee.aK=_c,ee.aL=It,ee.aM=si,ee.aN=di,ee.aO=yr,ee.aP=mr,ee.aQ=Ud,ee.aR=it,ee.aS=et,ee.aT=function(H){var h=new je(3);return h[0]=H[0],h[1]=H[1],h[2]=H[2],h},ee.aU=function(H,h,W){return H[0]=h[0]-W[0],H[1]=h[1]-W[1],H[2]=h[2]-W[2],H},ee.aV=function(H,h){var W=h[0],X=h[1],te=h[2],le=W*W+X*X+te*te;return le>0&&(le=1/Math.sqrt(le)),H[0]=h[0]*le,H[1]=h[1]*le,H[2]=h[2]*le,H},ee.aW=nt,ee.aX=function(H,h){return H[0]*h[0]+H[1]*h[1]+H[2]*h[2]},ee.aY=function(H,h,W){return H[0]=h[0]*W[0],H[1]=h[1]*W[1],H[2]=h[2]*W[2],H[3]=h[3]*W[3],H},ee.aZ=Je,ee.a_=function(H,h,W){const X=h[0]*W[0]+h[1]*W[1]+h[2]*W[2];return X===0?null:(-(H[0]*W[0]+H[1]*W[1]+H[2]*W[2])-W[3])/X},ee.aa=Mo,ee.ab=Ho,ee.ac=Wd,ee.ad=function(H){const h={};if(H.replace(/(?:^|(?:\s*\,\s*))([^\x00-\x20\(\)<>@\,;\:\\"\/\[\]\?\=\{\}\x7F]+)(?:\=(?:([^\x00-\x20\(\)<>@\,;\:\\"\/\[\]\?\=\{\}\x7F]+)|(?:\"((?:[^"\\]|\\.)*)\")))?/g,((W,X,te,le)=>{const he=te||le;return h[X]=!he||he.toLowerCase(),""})),h["max-age"]){const W=parseInt(h["max-age"],10);isNaN(W)?delete h["max-age"]:h["max-age"]=W}return h},ee.ae=dr,ee.af=function(H){return Math.pow(2,H)},ee.ag=Be,ee.ah=ur,ee.ai=85.051129,ee.aj=zd,ee.ak=function(H){return Math.log(H)/Math.LN2},ee.al=function(H){var h=H[0],W=H[1];return h*h+W*W},ee.am=function(H){if(!H.length)return new Set;const h=Math.max(...H.map((ye=>ye.canonical.z)));let W=1/0,X=-1/0,te=1/0,le=-1/0;const he=[];for(const ye of H){const{x:be,y:Ee,z:Pe}=ye.canonical,Ne=Math.pow(2,h-Pe),Ue=be*Ne,$e=Ee*Ne;he.push({id:ye,x:Ue,y:$e}),Ue<W&&(W=Ue),Ue>X&&(X=Ue),$e<te&&(te=$e),$e>le&&(le=$e)}const fe=new Set;for(const ye of he)ye.x!==W&&ye.x!==X&&ye.y!==te&&ye.y!==le||fe.add(ye.id);return fe},ee.an=function(H,h){let W=0,X=0;if(H.kind==="constant")X=H.layoutSize;else if(H.kind!=="source"){const{interpolationType:te,minZoom:le,maxZoom:he}=H,fe=te?ur(zi.interpolationFactor(te,h,le,he),0,1):0;H.kind==="camera"?X=An.number(H.minSize,H.maxSize,fe):W=fe}return{uSizeT:W,uSize:X}},ee.ap=function(H,{uSize:h,uSizeT:W},{lowerSize:X,upperSize:te}){return H.kind==="source"?X/ka:H.kind==="composite"?An.number(X/ka,te/ka,W):h},ee.aq=function(H,h){var W=h[0],X=h[1],te=h[2],le=h[3],he=h[4],fe=h[5],ye=h[6],be=h[7],Ee=h[8],Pe=h[9],Ne=h[10],Ue=h[11],$e=h[12],Ye=h[13],rt=h[14],dt=h[15],Ct=W*fe-X*he,vt=W*ye-te*he,qt=W*be-le*he,Lt=X*ye-te*fe,Gt=X*be-le*fe,Xt=te*be-le*ye,_r=Ee*Ye-Pe*$e,lr=Ee*rt-Ne*$e,fr=Ee*dt-Ue*$e,Cr=Pe*rt-Ne*Ye,hr=Pe*dt-Ue*Ye,pr=Ne*dt-Ue*rt,$t=Ct*pr-vt*hr+qt*Cr+Lt*fr-Gt*lr+Xt*_r;return $t?(H[0]=(fe*pr-ye*hr+be*Cr)*($t=1/$t),H[1]=(te*hr-X*pr-le*Cr)*$t,H[2]=(Ye*Xt-rt*Gt+dt*Lt)*$t,H[3]=(Ne*Gt-Pe*Xt-Ue*Lt)*$t,H[4]=(ye*fr-he*pr-be*lr)*$t,H[5]=(W*pr-te*fr+le*lr)*$t,H[6]=(rt*qt-$e*Xt-dt*vt)*$t,H[7]=(Ee*Xt-Ne*qt+Ue*vt)*$t,H[8]=(he*hr-fe*fr+be*_r)*$t,H[9]=(X*fr-W*hr-le*_r)*$t,H[10]=($e*Gt-Ye*qt+dt*Ct)*$t,H[11]=(Pe*qt-Ee*Gt-Ue*Ct)*$t,H[12]=(fe*lr-he*Cr-ye*_r)*$t,H[13]=(W*Cr-X*lr+te*_r)*$t,H[14]=(Ye*vt-$e*Lt-rt*Ct)*$t,H[15]=(Ee*Lt-Pe*vt+Ne*Ct)*$t,H):null},ee.ar=ht,ee.as=function(H){var h=H[0],W=H[1];return Math.sqrt(h*h+W*W)},ee.at=function(H){return H[0]=0,H[1]=0,H},ee.au=function(H,h,W){return H[0]=h[0]*W,H[1]=h[1]*W,H},ee.av=vh,ee.aw=_t,ee.ax=function(H,h,W,X){const te=h.y-H.y,le=h.x-H.x,he=X.y-W.y,fe=X.x-W.x,ye=he*le-fe*te;if(ye===0)return null;const be=(fe*(H.y-W.y)-he*(H.x-W.x))/ye;return new U(H.x+be*le,H.y+be*te)},ee.ay=Kd,ee.az=Nh,ee.b=Dr,ee.b$=class extends En{constructor(H,h){super(H,h),this.current=new Array}set(H){if(H!=this.current){this.current=H;const h=new Float32Array(H);this.gl.uniform1fv(this.location,h)}}},ee.b0=function(H,h,W){return H[0]=h[0]*W,H[1]=h[1]*W,H[2]=h[2]*W,H[3]=h[3]*W,H},ee.b1=function(H,h){return H[0]*h[0]+H[1]*h[1]+H[2]*h[2]+H[3]},ee.b2=Gd,ee.b3=Js,ee.b4=function(H,h,W,X,te){var le=1/Math.tan(h/2);if(H[0]=le/W,H[1]=0,H[2]=0,H[3]=0,H[4]=0,H[5]=le,H[6]=0,H[7]=0,H[8]=0,H[9]=0,H[11]=-1,H[12]=0,H[13]=0,H[15]=0,te!=null&&te!==1/0){var he=1/(X-te);H[10]=(te+X)*he,H[14]=2*te*X*he}else H[10]=-1,H[14]=-2*X;return H},ee.b5=function(H){var h=new je(16);return h[0]=H[0],h[1]=H[1],h[2]=H[2],h[3]=H[3],h[4]=H[4],h[5]=H[5],h[6]=H[6],h[7]=H[7],h[8]=H[8],h[9]=H[9],h[10]=H[10],h[11]=H[11],h[12]=H[12],h[13]=H[13],h[14]=H[14],h[15]=H[15],h},ee.b6=function(H,h,W){var X=Math.sin(W),te=Math.cos(W),le=h[0],he=h[1],fe=h[2],ye=h[3],be=h[4],Ee=h[5],Pe=h[6],Ne=h[7];return h!==H&&(H[8]=h[8],H[9]=h[9],H[10]=h[10],H[11]=h[11],H[12]=h[12],H[13]=h[13],H[14]=h[14],H[15]=h[15]),H[0]=le*te+be*X,H[1]=he*te+Ee*X,H[2]=fe*te+Pe*X,H[3]=ye*te+Ne*X,H[4]=be*te-le*X,H[5]=Ee*te-he*X,H[6]=Pe*te-fe*X,H[7]=Ne*te-ye*X,H},ee.b7=function(H,h,W){var X=Math.sin(W),te=Math.cos(W),le=h[4],he=h[5],fe=h[6],ye=h[7],be=h[8],Ee=h[9],Pe=h[10],Ne=h[11];return h!==H&&(H[0]=h[0],H[1]=h[1],H[2]=h[2],H[3]=h[3],H[12]=h[12],H[13]=h[13],H[14]=h[14],H[15]=h[15]),H[4]=le*te+be*X,H[5]=he*te+Ee*X,H[6]=fe*te+Pe*X,H[7]=ye*te+Ne*X,H[8]=be*te-le*X,H[9]=Ee*te-he*X,H[10]=Pe*te-fe*X,H[11]=Ne*te-ye*X,H},ee.b8=function(){const H=new Float32Array(16);return Be(H),H},ee.b9=function(){const H=new Float64Array(16);return Be(H),H},ee.bA=function(H,h){const W=bt(H,360),X=bt(h,360),te=X-W,le=X>W?te-360:te+360;return Math.abs(te)<Math.abs(le)?te:le},ee.bB=function(H){return H[0]=0,H[1]=0,H[2]=0,H},ee.bC=function(H,h,W,X){const te=Math.sqrt(H*H+h*h),le=Math.sqrt(W*W+X*X);H/=te,h/=te,W/=le,X/=le;const he=Math.acos(H*W+h*X);return-h*W+H*X>0?he:-he},ee.bD=function(H,h){const W=bt(H,2*Math.PI),X=bt(h,2*Math.PI);return Math.min(Math.abs(W-X),Math.abs(W-X+2*Math.PI),Math.abs(W-X-2*Math.PI))},ee.bE=function(){const H={},h=Tt.$version;for(const W in Tt.$root){const X=Tt.$root[W];if(X.required){let te=null;te=W==="version"?h:X.type==="array"?[]:{},te!=null&&(H[W]=te)}}return H},ee.bF=no,ee.bG=tt,ee.bH=function H(h,W){if(Array.isArray(h)){if(!Array.isArray(W)||h.length!==W.length)return!1;for(let X=0;X<h.length;X++)if(!H(h[X],W[X]))return!1;return!0}if(typeof h=="object"&&h!==null&&W!==null){if(typeof W!="object"||Object.keys(h).length!==Object.keys(W).length)return!1;for(const X in h)if(!H(h[X],W[X]))return!1;return!0}return h===W},ee.bI=function(H){H=H.slice();const h=Object.create(null);for(let W=0;W<H.length;W++)h[H[W].id]=H[W];for(let W=0;W<H.length;W++)"ref"in H[W]&&(H[W]=Or(H[W],h[H[W].ref]));return H},ee.bJ=function(H,h){if(H.type==="custom")return new Gp(H,h);switch(H.type){case"background":return new Vp(H,h);case"circle":return new Rf(H,h);case"color-relief":return new Df(H,h);case"fill":return new Kf(H,h);case"fill-extrusion":return new op(H,h);case"heatmap":return new Pf(H,h);case"hillshade":return new Cf(H,h);case"line":return new fp(H,h);case"raster":return new Xc(H,h);case"symbol":return new bc(H,h)}},ee.bK=H=>H.type==="raster",ee.bL=br,ee.bM=function(H,h){if(!H)return[{command:"setStyle",args:[h]}];let W=[];try{if(!cr(H.version,h.version))return[{command:"setStyle",args:[h]}];cr(H.center,h.center)||W.push({command:"setCenter",args:[h.center]}),cr(H.state,h.state)||W.push({command:"setGlobalState",args:[h.state]}),cr(H.centerAltitude,h.centerAltitude)||W.push({command:"setCenterAltitude",args:[h.centerAltitude]}),cr(H.zoom,h.zoom)||W.push({command:"setZoom",args:[h.zoom]}),cr(H.bearing,h.bearing)||W.push({command:"setBearing",args:[h.bearing]}),cr(H.pitch,h.pitch)||W.push({command:"setPitch",args:[h.pitch]}),cr(H.roll,h.roll)||W.push({command:"setRoll",args:[h.roll]}),cr(H.sprite,h.sprite)||W.push({command:"setSprite",args:[h.sprite]}),cr(H.glyphs,h.glyphs)||W.push({command:"setGlyphs",args:[h.glyphs]}),cr(H.transition,h.transition)||W.push({command:"setTransition",args:[h.transition]}),cr(H.light,h.light)||W.push({command:"setLight",args:[h.light]}),cr(H.terrain,h.terrain)||W.push({command:"setTerrain",args:[h.terrain]}),cr(H.sky,h.sky)||W.push({command:"setSky",args:[h.sky]}),cr(H.projection,h.projection)||W.push({command:"setProjection",args:[h.projection]});const X={},te=[];(function(he,fe,ye,be){let Ee;for(Ee in fe=fe||{},he=he||{})Object.prototype.hasOwnProperty.call(he,Ee)&&(Object.prototype.hasOwnProperty.call(fe,Ee)||vi(Ee,ye,be));for(Ee in fe)Object.prototype.hasOwnProperty.call(fe,Ee)&&(Object.prototype.hasOwnProperty.call(he,Ee)?cr(he[Ee],fe[Ee])||(he[Ee].type==="geojson"&&fe[Ee].type==="geojson"&&qi(he,fe,Ee)?Fr(ye,{command:"setGeoJSONSourceData",args:[Ee,fe[Ee].data]}):bi(Ee,fe,ye,be)):Yr(Ee,fe,ye))})(H.sources,h.sources,te,X);const le=[];H.layers&&H.layers.forEach((he=>{"source"in he&&X[he.source]?W.push({command:"removeLayer",args:[he.id]}):le.push(he)})),W=W.concat(te),(function(he,fe,ye){fe=fe||[];const be=(he=he||[]).map(li),Ee=fe.map(li),Pe=he.reduce(ri,{}),Ne=fe.reduce(ri,{}),Ue=be.slice(),$e=Object.create(null);let Ye,rt,dt,Ct,vt;for(let qt=0,Lt=0;qt<be.length;qt++)Ye=be[qt],Object.prototype.hasOwnProperty.call(Ne,Ye)?Lt++:(Fr(ye,{command:"removeLayer",args:[Ye]}),Ue.splice(Ue.indexOf(Ye,Lt),1));for(let qt=0,Lt=0;qt<Ee.length;qt++)Ye=Ee[Ee.length-1-qt],Ue[Ue.length-1-qt]!==Ye&&(Object.prototype.hasOwnProperty.call(Pe,Ye)?(Fr(ye,{command:"removeLayer",args:[Ye]}),Ue.splice(Ue.lastIndexOf(Ye,Ue.length-Lt),1)):Lt++,Ct=Ue[Ue.length-qt],Fr(ye,{command:"addLayer",args:[Ne[Ye],Ct]}),Ue.splice(Ue.length-qt,0,Ye),$e[Ye]=!0);for(let qt=0;qt<Ee.length;qt++)if(Ye=Ee[qt],rt=Pe[Ye],dt=Ne[Ye],!$e[Ye]&&!cr(rt,dt))if(cr(rt.source,dt.source)&&cr(rt["source-layer"],dt["source-layer"])&&cr(rt.type,dt.type)){for(vt in Jr(rt.layout,dt.layout,ye,Ye,null,"setLayoutProperty"),Jr(rt.paint,dt.paint,ye,Ye,null,"setPaintProperty"),cr(rt.filter,dt.filter)||Fr(ye,{command:"setFilter",args:[Ye,dt.filter]}),cr(rt.minzoom,dt.minzoom)&&cr(rt.maxzoom,dt.maxzoom)||Fr(ye,{command:"setLayerZoomRange",args:[Ye,dt.minzoom,dt.maxzoom]}),rt)Object.prototype.hasOwnProperty.call(rt,vt)&&vt!=="layout"&&vt!=="paint"&&vt!=="filter"&&vt!=="metadata"&&vt!=="minzoom"&&vt!=="maxzoom"&&(vt.indexOf("paint.")===0?Jr(rt[vt],dt[vt],ye,Ye,vt.slice(6),"setPaintProperty"):cr(rt[vt],dt[vt])||Fr(ye,{command:"setLayerProperty",args:[Ye,vt,dt[vt]]}));for(vt in dt)Object.prototype.hasOwnProperty.call(dt,vt)&&!Object.prototype.hasOwnProperty.call(rt,vt)&&vt!=="layout"&&vt!=="paint"&&vt!=="filter"&&vt!=="metadata"&&vt!=="minzoom"&&vt!=="maxzoom"&&(vt.indexOf("paint.")===0?Jr(rt[vt],dt[vt],ye,Ye,vt.slice(6),"setPaintProperty"):cr(rt[vt],dt[vt])||Fr(ye,{command:"setLayerProperty",args:[Ye,vt,dt[vt]]}))}else Fr(ye,{command:"removeLayer",args:[Ye]}),Ct=Ue[Ue.lastIndexOf(Ye)+1],Fr(ye,{command:"addLayer",args:[dt,Ct]})})(le,h.layers,W)}catch(X){console.warn("Unable to compute style diff:",X),W=[{command:"setStyle",args:[h]}]}return W},ee.bN=function(H){const h=[],W=H.id;return W===void 0&&h.push({message:`layers.${W}: missing required property "id"`}),H.render===void 0&&h.push({message:`layers.${W}: missing required method "render"`}),H.renderingMode&&H.renderingMode!=="2d"&&H.renderingMode!=="3d"&&h.push({message:`layers.${W}: property "renderingMode" must be either "2d" or "3d"`}),h},ee.bO=wr,ee.bP=Ir,ee.bQ=class extends En{constructor(H,h){super(H,h),this.current=0}set(H){this.current!==H&&(this.current=H,this.gl.uniform1i(this.location,H))}},ee.bR=qn,ee.bS=class extends En{constructor(H,h){super(H,h),this.current=Zi}set(H){if(H[12]!==this.current[12]||H[0]!==this.current[0])return this.current=H,void this.gl.uniformMatrix4fv(this.location,!1,H);for(let h=1;h<16;h++)if(H[h]!==this.current[h]){this.current=H,this.gl.uniformMatrix4fv(this.location,!1,H);break}}},ee.bT=Ui,ee.bU=class extends En{constructor(H,h){super(H,h),this.current=[0,0,0]}set(H){H[0]===this.current[0]&&H[1]===this.current[1]&&H[2]===this.current[2]||(this.current=H,this.gl.uniform3f(this.location,H[0],H[1],H[2]))}},ee.bV=class extends En{constructor(H,h){super(H,h),this.current=[0,0]}set(H){H[0]===this.current[0]&&H[1]===this.current[1]||(this.current=H,this.gl.uniform2f(this.location,H[0],H[1]))}},ee.bW=ke,ee.bX=function(H,h){var W=Math.sin(h),X=Math.cos(h);return H[0]=X,H[1]=W,H[2]=0,H[3]=-W,H[4]=X,H[5]=0,H[6]=0,H[7]=0,H[8]=1,H},ee.bY=function(H,h,W){var X=h[0],te=h[1],le=h[2];return H[0]=X*W[0]+te*W[3]+le*W[6],H[1]=X*W[1]+te*W[4]+le*W[7],H[2]=X*W[2]+te*W[5]+le*W[8],H},ee.bZ=function(H,h,W,X,te,le,he){var fe=1/(h-W),ye=1/(X-te),be=1/(le-he);return H[0]=-2*fe,H[1]=0,H[2]=0,H[3]=0,H[4]=0,H[5]=-2*ye,H[6]=0,H[7]=0,H[8]=0,H[9]=0,H[10]=2*be,H[11]=0,H[12]=(h+W)*fe,H[13]=(te+X)*ye,H[14]=(he+le)*be,H[15]=1,H},ee.b_=class extends En{constructor(H,h){super(H,h),this.current=new Array}set(H){if(H!=this.current){this.current=H;const h=new Float32Array(4*H.length);for(let W=0;W<H.length;W++)h[4*W]=H[W].r,h[4*W+1]=H[W].g,h[4*W+2]=H[W].b,h[4*W+3]=H[W].a;this.gl.uniform4fv(this.location,h)}}},ee.ba=function(){return new Float64Array(16)},ee.bb=function(H,h,W){const X=new Float64Array(4);return Ft(X,H,h-90,W),X},ee.bc=function(H,h,W,X){var te,le,he,fe,ye,be=h[0],Ee=h[1],Pe=h[2],Ne=h[3],Ue=W[0],$e=W[1],Ye=W[2],rt=W[3];return(le=be*Ue+Ee*$e+Pe*Ye+Ne*rt)<0&&(le=-le,Ue=-Ue,$e=-$e,Ye=-Ye,rt=-rt),1-le>Ce?(te=Math.acos(le),he=Math.sin(te),fe=Math.sin((1-X)*te)/he,ye=Math.sin(X*te)/he):(fe=1-X,ye=X),H[0]=fe*be+ye*Ue,H[1]=fe*Ee+ye*$e,H[2]=fe*Pe+ye*Ye,H[3]=fe*Ne+ye*rt,H},ee.bd=function(H){const h=new Float64Array(9);var W,X,te,le,he,fe,ye,be,Ee,Pe,Ne,Ue,$e,Ye,rt,dt,Ct,vt;Pe=(te=(X=H)[0])*(ye=te+te),Ne=(le=X[1])*ye,$e=(he=X[2])*ye,Ye=he*(be=le+le),dt=(fe=X[3])*ye,Ct=fe*be,vt=fe*(Ee=he+he),(W=h)[0]=1-(Ue=le*be)-(rt=he*Ee),W[3]=Ne-vt,W[6]=$e+Ct,W[1]=Ne+vt,W[4]=1-Pe-rt,W[7]=Ye-dt,W[2]=$e-Ct,W[5]=Ye+dt,W[8]=1-Pe-Ue;const qt=mr(-Math.asin(ur(h[2],-1,1)));let Lt,Gt;return Math.hypot(h[5],h[8])<.001?(Lt=0,Gt=-mr(Math.atan2(h[3],h[4]))):(Lt=mr(h[5]===0&&h[8]===0?0:Math.atan2(h[5],h[8])),Gt=mr(h[1]===0&&h[0]===0?0:Math.atan2(h[1],h[0]))),{roll:Lt,pitch:qt+90,bearing:Gt}},ee.be=function(H,h){return H.roll==h.roll&&H.pitch==h.pitch&&H.bearing==h.bearing},ee.bf=Qr,ee.bg=Fi,ee.bh=Hs,ee.bi=nu,ee.bj=Ws,ee.bk=Dt,ee.bl=Ut,ee.bm=gn,ee.bn=function(H,h,W,X,te){return Dt(X,te,ur((H-h)/(W-h),0,1))},ee.bo=bt,ee.bp=function(){return new Float64Array(3)},ee.bq=function(H,h,W,X){return H[0]=h[0]+W[0]*X,H[1]=h[1]+W[1]*X,H[2]=h[2]+W[2]*X,H},ee.br=Ft,ee.bs=function(H,h,W){var X=W[0],te=W[1],le=W[2],he=W[3],fe=h[0],ye=h[1],be=h[2],Ee=te*be-le*ye,Pe=le*fe-X*be,Ne=X*ye-te*fe;return H[0]=fe+he*(Ee+=Ee)+te*(Ne+=Ne)-le*(Pe+=Pe),H[1]=ye+he*Pe+le*Ee-X*Ne,H[2]=be+he*Ne+X*Pe-te*Ee,H},ee.bt=function(H,h,W){const X=(te=[H[0],H[1],H[2],h[0],h[1],h[2],W[0],W[1],W[2]])[0]*((Ee=te[8])*(he=te[4])-(fe=te[5])*(be=te[7]))+te[1]*(-Ee*(le=te[3])+fe*(ye=te[6]))+te[2]*(be*le-he*ye);var te,le,he,fe,ye,be,Ee;if(X===0)return null;const Pe=nt([],[h[0],h[1],h[2]],[W[0],W[1],W[2]]),Ne=nt([],[W[0],W[1],W[2]],[H[0],H[1],H[2]]),Ue=nt([],[H[0],H[1],H[2]],[h[0],h[1],h[2]]),$e=it([],Pe,-H[3]);return et($e,$e,it([],Ne,-h[3])),et($e,$e,it([],Ue,-W[3])),it($e,$e,1/X),$e},ee.bu=Sh,ee.bv=function(){return new Float64Array(4)},ee.bw=function(H,h,W,X){var te=[],le=[];return te[0]=h[0]-W[0],te[1]=h[1]-W[1],te[2]=h[2]-W[2],le[0]=te[0]*Math.cos(X)-te[1]*Math.sin(X),le[1]=te[0]*Math.sin(X)+te[1]*Math.cos(X),le[2]=te[2],H[0]=le[0]+W[0],H[1]=le[1]+W[1],H[2]=le[2]+W[2],H},ee.bx=function(H,h,W,X){var te=[],le=[];return te[0]=h[0]-W[0],te[1]=h[1]-W[1],te[2]=h[2]-W[2],le[0]=te[0],le[1]=te[1]*Math.cos(X)-te[2]*Math.sin(X),le[2]=te[1]*Math.sin(X)+te[2]*Math.cos(X),H[0]=le[0]+W[0],H[1]=le[1]+W[1],H[2]=le[2]+W[2],H},ee.by=function(H,h,W,X){var te=[],le=[];return te[0]=h[0]-W[0],te[1]=h[1]-W[1],te[2]=h[2]-W[2],le[0]=te[2]*Math.sin(X)+te[0]*Math.cos(X),le[1]=te[1],le[2]=te[2]*Math.cos(X)-te[0]*Math.sin(X),H[0]=le[0]+W[0],H[1]=le[1]+W[1],H[2]=le[2]+W[2],H},ee.bz=function(H,h,W){var X=Math.sin(W),te=Math.cos(W),le=h[0],he=h[1],fe=h[2],ye=h[3],be=h[8],Ee=h[9],Pe=h[10],Ne=h[11];return h!==H&&(H[4]=h[4],H[5]=h[5],H[6]=h[6],H[7]=h[7],H[12]=h[12],H[13]=h[13],H[14]=h[14],H[15]=h[15]),H[0]=le*te-be*X,H[1]=he*te-Ee*X,H[2]=fe*te-Pe*X,H[3]=ye*te-Ne*X,H[8]=le*X+be*te,H[9]=he*X+Ee*te,H[10]=fe*X+Pe*te,H[11]=ye*X+Ne*te,H},ee.c=xe,ee.c0=class extends Hl{},ee.c1=yp,ee.c2=class extends t{},ee.c3=nh,ee.c4=function(H){return H<=1?1:Math.pow(2,Math.ceil(Math.log(H)/Math.LN2))},ee.c5=Kh,ee.c6=function(H,h,W){var X=h[0],te=h[1],le=h[2],he=W[3]*X+W[7]*te+W[11]*le+W[15];return H[0]=(W[0]*X+W[4]*te+W[8]*le+W[12])/(he=he||1),H[1]=(W[1]*X+W[5]*te+W[9]*le+W[13])/he,H[2]=(W[2]*X+W[6]*te+W[10]*le+W[14])/he,H},ee.c7=class extends Ns{},ee.c8=class extends ve{},ee.c9=function(H,h){return H[0]===h[0]&&H[1]===h[1]&&H[2]===h[2]&&H[3]===h[3]&&H[4]===h[4]&&H[5]===h[5]&&H[6]===h[6]&&H[7]===h[7]&&H[8]===h[8]&&H[9]===h[9]&&H[10]===h[10]&&H[11]===h[11]&&H[12]===h[12]&&H[13]===h[13]&&H[14]===h[14]&&H[15]===h[15]},ee.cA=function(H,h){Te.REGISTERED_PROTOCOLS[H]=h},ee.cB=function(H){delete Te.REGISTERED_PROTOCOLS[H]},ee.cC=function(H,h){const W={};for(let te=0;te<H.length;te++){const le=h&&h[H[te].id]||Ps(H[te]);h&&(h[H[te].id]=le);let he=W[le];he||(he=W[le]=[]),he.push(H[te])}const X=[];for(const te in W)X.push(W[te]);return X},ee.cD=vr,ee.cE=$d,ee.cF=Hd,ee.cG=Ed,ee.cH=function(H){H.bucket.createArrays(),H.bucket.tilePixelRatio=ut/(512*H.bucket.overscaling),H.bucket.compareText={},H.bucket.iconsNeedLinear=!1;const h=H.bucket.layers[0],W=h.layout,X=h._unevaluatedLayout._values,te={layoutIconSize:X["icon-size"].possiblyEvaluate(new mi(H.bucket.zoom+1),H.canonical),layoutTextSize:X["text-size"].possiblyEvaluate(new mi(H.bucket.zoom+1),H.canonical),textMaxSize:X["text-size"].possiblyEvaluate(new mi(18))};if(H.bucket.textSizeData.kind==="composite"){const{minZoom:be,maxZoom:Ee}=H.bucket.textSizeData;te.compositeTextSizes=[X["text-size"].possiblyEvaluate(new mi(be),H.canonical),X["text-size"].possiblyEvaluate(new mi(Ee),H.canonical)]}if(H.bucket.iconSizeData.kind==="composite"){const{minZoom:be,maxZoom:Ee}=H.bucket.iconSizeData;te.compositeIconSizes=[X["icon-size"].possiblyEvaluate(new mi(be),H.canonical),X["icon-size"].possiblyEvaluate(new mi(Ee),H.canonical)]}const le=W.get("text-line-height")*Ki,he=W.get("text-rotation-alignment")!=="viewport"&&W.get("symbol-placement")!=="point",fe=W.get("text-keep-upright"),ye=W.get("text-size");for(const be of H.bucket.features){const Ee=W.get("text-font").evaluate(be,{},H.canonical).join(","),Pe=ye.evaluate(be,{},H.canonical),Ne=te.layoutTextSize.evaluate(be,{},H.canonical),Ue=te.layoutIconSize.evaluate(be,{},H.canonical),$e={horizontal:{},vertical:void 0},Ye=be.text;let rt,dt=[0,0];if(Ye){const qt=Ye.toString(),Lt=W.get("text-letter-spacing").evaluate(be,{},H.canonical)*Ki,Gt=Yu(qt)?Lt:0,Xt=W.get("text-anchor").evaluate(be,{},H.canonical),_r=af(h,be,H.canonical);if(!_r){const hr=W.get("text-radial-offset").evaluate(be,{},H.canonical);dt=hr?nf(Xt,[hr*Ki,Th]):W.get("text-offset").evaluate(be,{},H.canonical).map((pr=>pr*Ki))}let lr=he?"center":W.get("text-justify").evaluate(be,{},H.canonical);const fr=W.get("symbol-placement")==="point"?W.get("text-max-width").evaluate(be,{},H.canonical)*Ki:1/0,Cr=()=>{H.bucket.allowVerticalPlacement&&Ms(qt)&&($e.vertical=yc(Ye,H.glyphMap,H.glyphPositions,H.imagePositions,Ee,fr,le,Xt,"left",Gt,dt,ee.ao.vertical,!0,Ne,Pe))};if(!he&&_r){const hr=new Set;if(lr==="auto")for(let $t=0;$t<_r.values.length;$t+=2)hr.add(Ih(_r.values[$t]));else hr.add(lr);let pr=!1;for(const $t of hr)if(!$e.horizontal[$t])if(pr)$e.horizontal[$t]=$e.horizontal[0];else{const zr=yc(Ye,H.glyphMap,H.glyphPositions,H.imagePositions,Ee,fr,le,"center",$t,Gt,dt,ee.ao.horizontal,!1,Ne,Pe);zr&&($e.horizontal[$t]=zr,pr=zr.positionedLines.length===1)}Cr()}else{lr==="auto"&&(lr=Ih(Xt));const hr=yc(Ye,H.glyphMap,H.glyphPositions,H.imagePositions,Ee,fr,le,Xt,lr,Gt,dt,ee.ao.horizontal,!1,Ne,Pe);hr&&($e.horizontal[lr]=hr),Cr(),Ms(qt)&&he&&fe&&($e.vertical=yc(Ye,H.glyphMap,H.glyphPositions,H.imagePositions,Ee,fr,le,Xt,lr,Gt,dt,ee.ao.vertical,!1,Ne,Pe))}}let Ct=!1;if(be.icon&&be.icon.name){const qt=H.imageMap[be.icon.name];qt&&(rt=Np(H.imagePositions[be.icon.name],W.get("icon-offset").evaluate(be,{},H.canonical),W.get("icon-anchor").evaluate(be,{},H.canonical)),Ct=!!qt.sdf,H.bucket.sdfIcons===void 0?H.bucket.sdfIcons=Ct:H.bucket.sdfIcons!==Ct&&Mr("Style sheet warning: Cannot mix SDF and non-SDF icons in one buffer"),(qt.pixelRatio!==H.bucket.pixelRatio||W.get("icon-rotate").constantOr(1)!==0)&&(H.bucket.iconsNeedLinear=!0))}const vt=sf($e.horizontal)||$e.vertical;H.bucket.iconsInText=!!vt&&vt.iconsInText,(vt||rt)&&Qp(H.bucket,be,$e,rt,H.imageMap,te,Ne,Ue,dt,Ct,H.canonical,H.subdivisionGranularity)}H.showCollisionBoxes&&H.bucket.generateCollisionDebugBuffers()},ee.cI=uh,ee.cJ=hh,ee.cK=dh,ee.cL=cd,ee.cM=ph,ee.cN=class{constructor(H){this._marks={start:[H.url,"start"].join("#"),end:[H.url,"end"].join("#"),measure:H.url.toString()},performance.mark(this._marks.start)}finish(){performance.mark(this._marks.end);let H=performance.getEntriesByName(this._marks.measure);return H.length===0&&(performance.measure(this._marks.measure,this._marks.start,this._marks.end),H=performance.getEntriesByName(this._marks.measure),performance.clearMarks(this._marks.start),performance.clearMarks(this._marks.end),performance.clearMeasures(this._marks.measure)),H}},ee.cO=function(H,h,W,X,te){return R(this,void 0,void 0,(function*(){if(Ae())try{return yield Yt(H,h,W,X,te)}catch{}return(function(le,he,fe,ye,be){const Ee=le.width,Pe=le.height;Jt&&qr||(Jt=new OffscreenCanvas(Ee,Pe),qr=Jt.getContext("2d",{willReadFrequently:!0})),Jt.width=Ee,Jt.height=Pe,qr.drawImage(le,0,0,Ee,Pe);const Ne=qr.getImageData(he,fe,ye,be);return qr.clearRect(0,0,Ee,Pe),Ne.data})(H,h,W,X,te)}))},ee.cP=Jh,ee.cQ=K,ee.cR=ud,ee.cS=Zs,ee.cT=xs,ee.cU=function(H,h){const W=new Map;if(H!=null)if(H.type==="Feature")W.set(hu(H,h),H);else for(const X of H.features)W.set(hu(X,h),X);return W},ee.cV=function(H,h){if(H==null)return!0;if(H.type==="Feature")return hu(H,h)!=null;if(H.type==="FeatureCollection"){const W=new Set;for(const X of H.features){const te=hu(X,h);if(te==null||W.has(te))return!1;W.add(te)}return!0}return!1},ee.cW=function(H,h,W){var X,te,le,he;if(h.removeAll&&H.clear(),h.remove)for(const fe of h.remove)H.delete(fe);if(h.add)for(const fe of h.add){const ye=hu(fe,W);ye!=null&&H.set(ye,fe)}if(h.update)for(const fe of h.update){let ye=H.get(fe.id);if(ye==null)continue;const be=!fe.removeAllProperties&&(((X=fe.removeProperties)===null||X===void 0?void 0:X.length)>0||((te=fe.addOrUpdateProperties)===null||te===void 0?void 0:te.length)>0);if((fe.newGeometry||fe.removeAllProperties||be)&&(ye=Object.assign({},ye),H.set(fe.id,ye),be&&(ye.properties=Object.assign({},ye.properties))),fe.newGeometry&&(ye.geometry=fe.newGeometry),fe.removeAllProperties)ye.properties={};else if(((le=fe.removeProperties)===null||le===void 0?void 0:le.length)>0)for(const Ee of fe.removeProperties)Object.prototype.hasOwnProperty.call(ye.properties,Ee)&&delete ye.properties[Ee];if(((he=fe.addOrUpdateProperties)===null||he===void 0?void 0:he.length)>0)for(const{key:Ee,value:Pe}of fe.addOrUpdateProperties)ye.properties[Ee]=Pe}},ee.cX=la,ee.ca=function(H,h){var W=H[0],X=H[1],te=H[2],le=H[3],he=H[4],fe=H[5],ye=H[6],be=H[7],Ee=H[8],Pe=H[9],Ne=H[10],Ue=H[11],$e=H[12],Ye=H[13],rt=H[14],dt=H[15],Ct=h[0],vt=h[1],qt=h[2],Lt=h[3],Gt=h[4],Xt=h[5],_r=h[6],lr=h[7],fr=h[8],Cr=h[9],hr=h[10],pr=h[11],$t=h[12],zr=h[13],Vr=h[14],kr=h[15];return Math.abs(W-Ct)<=Ce*Math.max(1,Math.abs(W),Math.abs(Ct))&&Math.abs(X-vt)<=Ce*Math.max(1,Math.abs(X),Math.abs(vt))&&Math.abs(te-qt)<=Ce*Math.max(1,Math.abs(te),Math.abs(qt))&&Math.abs(le-Lt)<=Ce*Math.max(1,Math.abs(le),Math.abs(Lt))&&Math.abs(he-Gt)<=Ce*Math.max(1,Math.abs(he),Math.abs(Gt))&&Math.abs(fe-Xt)<=Ce*Math.max(1,Math.abs(fe),Math.abs(Xt))&&Math.abs(ye-_r)<=Ce*Math.max(1,Math.abs(ye),Math.abs(_r))&&Math.abs(be-lr)<=Ce*Math.max(1,Math.abs(be),Math.abs(lr))&&Math.abs(Ee-fr)<=Ce*Math.max(1,Math.abs(Ee),Math.abs(fr))&&Math.abs(Pe-Cr)<=Ce*Math.max(1,Math.abs(Pe),Math.abs(Cr))&&Math.abs(Ne-hr)<=Ce*Math.max(1,Math.abs(Ne),Math.abs(hr))&&Math.abs(Ue-pr)<=Ce*Math.max(1,Math.abs(Ue),Math.abs(pr))&&Math.abs($e-$t)<=Ce*Math.max(1,Math.abs($e),Math.abs($t))&&Math.abs(Ye-zr)<=Ce*Math.max(1,Math.abs(Ye),Math.abs(zr))&&Math.abs(rt-Vr)<=Ce*Math.max(1,Math.abs(rt),Math.abs(Vr))&&Math.abs(dt-kr)<=Ce*Math.max(1,Math.abs(dt),Math.abs(kr))},ee.cb=function(H,h){return H[0]=h[0],H[1]=h[1],H[2]=h[2],H[3]=h[3],H[4]=h[4],H[5]=h[5],H[6]=h[6],H[7]=h[7],H[8]=h[8],H[9]=h[9],H[10]=h[10],H[11]=h[11],H[12]=h[12],H[13]=h[13],H[14]=h[14],H[15]=h[15],H},ee.cc=H=>H.type==="symbol",ee.cd=H=>H.type==="circle",ee.ce=H=>H.type==="heatmap",ee.cf=H=>H.type==="line",ee.cg=H=>H.type==="fill",ee.ch=H=>H.type==="fill-extrusion",ee.ci=H=>H.type==="hillshade",ee.cj=H=>H.type==="color-relief",ee.ck=H=>H.type==="background",ee.cl=H=>H.type==="custom",ee.cm=er,ee.cn=function(H,h,W){const X=St(h.x-W.x,h.y-W.y),te=St(H.x-W.x,H.y-W.y);var le,he;return mr(Math.atan2(X[0]*te[1]-X[1]*te[0],(le=X)[0]*(he=te)[0]+le[1]*he[1]))},ee.co=xr,ee.cp=function(H,h){return Ie[h]&&(H instanceof MouseEvent||H instanceof WheelEvent)},ee.cq=function(H,h){return Ge[h]&&"touches"in H},ee.cr=function(H){return Ge[H]||Ie[H]},ee.cs=function(H,h,W){var X=h[0],te=h[1];return H[0]=W[0]*X+W[4]*te+W[12],H[1]=W[1]*X+W[5]*te+W[13],H},ee.ct=function(H,h){const{x:W,y:X}=cu.fromLngLat(h);return!(H<0||H>25||X<0||X>=1||W<0||W>=1)},ee.cu=function(H,h){return H[0]=h[0],H[1]=0,H[2]=0,H[3]=0,H[4]=0,H[5]=h[1],H[6]=0,H[7]=0,H[8]=0,H[9]=0,H[10]=h[2],H[11]=0,H[12]=0,H[13]=0,H[14]=0,H[15]=1,H},ee.cv=class extends lo{},ee.cw=t_,ee.cy=function(H){return H.message===Se},ee.cz=Qe,ee.d=Ze,ee.e=Wt,ee.f=H=>R(void 0,void 0,void 0,(function*(){if(H.byteLength===0)return createImageBitmap(new ImageData(1,1));const h=new Blob([new Uint8Array(H)],{type:"image/png"});try{return createImageBitmap(h)}catch(W){throw new Error(`Could not load image because of ${W.message}. Please make sure to use a supported image type such as PNG or JPEG. Note that SVGs are not supported.`)}})),ee.g=Me,ee.h=H=>new Promise(((h,W)=>{const X=new Image;X.onload=()=>{h(X),URL.revokeObjectURL(X.src),X.onload=null,window.requestAnimationFrame((()=>{X.src=Lr}))},X.onerror=()=>W(new Error("Could not load image. Please make sure to use a supported image type such as PNG or JPEG. Note that SVGs are not supported."));const te=new Blob([new Uint8Array(H)],{type:"image/png"});X.src=H.byteLength?URL.createObjectURL(te):Lr})),ee.i=jr,ee.j=(H,h)=>He(Wt(H,{type:"json"}),h),ee.k=Mt,ee.l=wt,ee.m=He,ee.n=(H,h)=>He(Wt(H,{type:"arrayBuffer"}),h),ee.o=function(H){return new ph(H).readFields(Rp,[])},ee.p=Sd,ee.q=Ql,ee.r=pn,ee.s=nr,ee.t=zl,ee.u=ti,ee.v=Tt,ee.w=Mr,ee.x=Hc,ee.y=Ku,ee.z=sa})),ne("worker",["./shared"],(function(ee){class R{constructor(xe,Te){this.keyCache={},xe&&this.replace(xe,Te)}replace(xe,Te){this._layerConfigs={},this._layers={},this.update(xe,[],Te)}update(xe,Te,Me){for(const Qe of xe){this._layerConfigs[Qe.id]=Qe;const tt=this._layers[Qe.id]=ee.bJ(Qe,Me);tt._featureFilter=ee.aa(tt.filter,Me),this.keyCache[Qe.id]&&delete this.keyCache[Qe.id]}for(const Qe of Te)delete this.keyCache[Qe],delete this._layerConfigs[Qe],delete this._layers[Qe];this.familiesBySource={};const ze=ee.cC(Object.values(this._layerConfigs),this.keyCache);for(const Qe of ze){const tt=Qe.map((Mt=>this._layers[Mt.id])),He=tt[0];if(He.visibility==="none")continue;const Ze=He.source||"";let st=this.familiesBySource[Ze];st||(st=this.familiesBySource[Ze]={});const At=He.sourceLayer||"_geojsonTileLayer";let wt=st[At];wt||(wt=st[At]=[]),wt.push(tt)}}}class U{constructor(xe){const Te={},Me=[];for(const He in xe){const Ze=xe[He],st=Te[He]={};for(const At in Ze){const wt=Ze[+At];if(!wt||wt.bitmap.width===0||wt.bitmap.height===0)continue;const Mt={x:0,y:0,w:wt.bitmap.width+2,h:wt.bitmap.height+2};Me.push(Mt),st[At]={rect:Mt,metrics:wt.metrics}}}const{w:ze,h:Qe}=ee.p(Me),tt=new ee.q({width:ze||1,height:Qe||1});for(const He in xe){const Ze=xe[He];for(const st in Ze){const At=Ze[+st];if(!At||At.bitmap.width===0||At.bitmap.height===0)continue;const wt=Te[He][st].rect;ee.q.copy(At.bitmap,tt,{x:0,y:0},{x:wt.x+1,y:wt.y+1},At.bitmap)}}this.image=tt,this.positions=Te}}ee.cD("GlyphAtlas",U);class K{constructor(xe){this.tileID=new ee.Z(xe.tileID.overscaledZ,xe.tileID.wrap,xe.tileID.canonical.z,xe.tileID.canonical.x,xe.tileID.canonical.y),this.uid=xe.uid,this.zoom=xe.zoom,this.pixelRatio=xe.pixelRatio,this.tileSize=xe.tileSize,this.source=xe.source,this.overscaling=this.tileID.overscaleFactor(),this.showCollisionBoxes=xe.showCollisionBoxes,this.collectResourceTiming=!!xe.collectResourceTiming,this.returnDependencies=!!xe.returnDependencies,this.promoteId=xe.promoteId,this.inFlightDependencies=[]}parse(xe,Te,Me,ze,Qe){return ee._(this,void 0,void 0,(function*(){this.status="parsing",this.data=xe,this.collisionBoxArray=new ee.a8;const tt=new ee.cE(Object.keys(xe.layers).sort()),He=new ee.cF(this.tileID,this.promoteId);He.bucketLayerIDs=[];const Ze={},st={featureIndex:He,iconDependencies:{},patternDependencies:{},glyphDependencies:{},dashDependencies:{},availableImages:Me,subdivisionGranularity:Qe},At=Te.familiesBySource[this.source];for(const ri in At){const Ht=xe.layers[ri];if(!Ht)continue;Ht.version===1&&ee.w(`Vector tile source "${this.source}" layer "${ri}" does not use vector tile spec v2 and therefore may have some rendering errors.`);const Ti=tt.encode(ri),Ni=[];for(let Pi=0;Pi<Ht.length;Pi++){const ii=Ht.feature(Pi),ir=He.getId(ii,ri);Ni.push({feature:ii,id:ir,index:Pi,sourceLayerIndex:Ti})}for(const Pi of At[ri]){const ii=Pi[0];ii.source!==this.source&&ee.w(`layer.source = ${ii.source} does not equal this.source = ${this.source}`),ii.minzoom&&this.zoom<Math.floor(ii.minzoom)||ii.maxzoom&&this.zoom>=ii.maxzoom||ii.visibility!=="none"&&(oe(Pi,this.zoom,Me),(Ze[ii.id]=ii.createBucket({index:He.bucketLayerIDs.length,layers:Pi,zoom:this.zoom,pixelRatio:this.pixelRatio,overscaling:this.overscaling,collisionBoxArray:this.collisionBoxArray,sourceLayerIndex:Ti,sourceID:this.source})).populate(Ni,st,this.tileID.canonical),He.bucketLayerIDs.push(Pi.map((ir=>ir.id))))}}const wt=ee.bO(st.glyphDependencies,(ri=>Object.keys(ri).map(Number)));this.inFlightDependencies.forEach((ri=>ri==null?void 0:ri.abort())),this.inFlightDependencies=[];let Mt=Promise.resolve({});if(Object.keys(wt).length){const ri=new AbortController;this.inFlightDependencies.push(ri),Mt=ze.sendAsync({type:"GG",data:{stacks:wt,source:this.source,tileID:this.tileID,type:"glyphs"}},ri)}const Zt=Object.keys(st.iconDependencies);let Tt=Promise.resolve({});if(Zt.length){const ri=new AbortController;this.inFlightDependencies.push(ri),Tt=ze.sendAsync({type:"GI",data:{icons:Zt,source:this.source,tileID:this.tileID,type:"icons"}},ri)}const Er=Object.keys(st.patternDependencies);let Or=Promise.resolve({});if(Er.length){const ri=new AbortController;this.inFlightDependencies.push(ri),Or=ze.sendAsync({type:"GI",data:{icons:Er,source:this.source,tileID:this.tileID,type:"patterns"}},ri)}const cr=st.dashDependencies;let Fr=Promise.resolve({});if(Object.keys(cr).length){const ri=new AbortController;this.inFlightDependencies.push(ri),Fr=ze.sendAsync({type:"GDA",data:{dashes:cr}},ri)}const[Yr,vi,bi,qi]=yield Promise.all([Mt,Tt,Or,Fr]),Jr=new U(Yr),li=new ee.cG(vi,bi);for(const ri in Ze){const Ht=Ze[ri];Ht instanceof ee.a9?(oe(Ht.layers,this.zoom,Me),ee.cH({bucket:Ht,glyphMap:Yr,glyphPositions:Jr.positions,imageMap:vi,imagePositions:li.iconPositions,showCollisionBoxes:this.showCollisionBoxes,canonical:this.tileID.canonical,subdivisionGranularity:st.subdivisionGranularity})):Ht.hasDependencies&&(Ht instanceof ee.cI||Ht instanceof ee.cJ||Ht instanceof ee.cK)&&(oe(Ht.layers,this.zoom,Me),Ht.addFeatures(st,this.tileID.canonical,li.patternPositions,qi))}return this.status="done",{buckets:Object.values(Ze).filter((ri=>!ri.isEmpty())),featureIndex:He,collisionBoxArray:this.collisionBoxArray,glyphAtlasImage:Jr.image,imageAtlas:li,dashPositions:qi,glyphMap:this.returnDependencies?Yr:null,iconMap:this.returnDependencies?vi:null,glyphPositions:this.returnDependencies?Jr.positions:null}}))}}function oe(Se,xe,Te){const Me=new ee.F(xe);for(const ze of Se)ze.recalculate(Me,Te)}class pe{constructor(xe,Te,Me){this.actor=xe,this.layerIndex=Te,this.availableImages=Me,this.fetching={},this.loading={},this.loaded={}}loadVectorTile(xe,Te){return ee._(this,void 0,void 0,(function*(){const Me=yield ee.n(xe.request,Te);try{return{vectorTile:new ee.cL(new ee.cM(Me.data)),rawData:Me.data,cacheControl:Me.cacheControl,expires:Me.expires}}catch(ze){const Qe=new Uint8Array(Me.data);let tt=`Unable to parse the tile at ${xe.request.url}, `;throw tt+=Qe[0]===31&&Qe[1]===139?"please make sure the data is not gzipped and that you have configured the relevant header in the server":`got error: ${ze.message}`,new Error(tt)}}))}loadTile(xe){return ee._(this,void 0,void 0,(function*(){const Te=xe.uid,Me=!!(xe&&xe.request&&xe.request.collectResourceTiming)&&new ee.cN(xe.request),ze=new K(xe);this.loading[Te]=ze;const Qe=new AbortController;ze.abort=Qe;try{const tt=yield this.loadVectorTile(xe,Qe);if(delete this.loading[Te],!tt)return null;const He=tt.rawData,Ze={};tt.expires&&(Ze.expires=tt.expires),tt.cacheControl&&(Ze.cacheControl=tt.cacheControl);const st={};if(Me){const wt=Me.finish();wt&&(st.resourceTiming=JSON.parse(JSON.stringify(wt)))}ze.vectorTile=tt.vectorTile;const At=ze.parse(tt.vectorTile,this.layerIndex,this.availableImages,this.actor,xe.subdivisionGranularity);this.loaded[Te]=ze,this.fetching[Te]={rawTileData:He,cacheControl:Ze,resourceTiming:st};try{const wt=yield At;return ee.e({rawTileData:He.slice(0)},wt,Ze,st)}finally{delete this.fetching[Te]}}catch(tt){throw delete this.loading[Te],ze.status="done",this.loaded[Te]=ze,tt}}))}reloadTile(xe){return ee._(this,void 0,void 0,(function*(){const Te=xe.uid;if(!this.loaded||!this.loaded[Te])throw new Error("Should not be trying to reload a tile that was never loaded or has been removed");const Me=this.loaded[Te];if(Me.showCollisionBoxes=xe.showCollisionBoxes,Me.status==="parsing"){const ze=yield Me.parse(Me.vectorTile,this.layerIndex,this.availableImages,this.actor,xe.subdivisionGranularity);let Qe;if(this.fetching[Te]){const{rawTileData:tt,cacheControl:He,resourceTiming:Ze}=this.fetching[Te];delete this.fetching[Te],Qe=ee.e({rawTileData:tt.slice(0)},ze,He,Ze)}else Qe=ze;return Qe}if(Me.status==="done"&&Me.vectorTile)return Me.parse(Me.vectorTile,this.layerIndex,this.availableImages,this.actor,xe.subdivisionGranularity)}))}abortTile(xe){return ee._(this,void 0,void 0,(function*(){const Te=this.loading,Me=xe.uid;Te&&Te[Me]&&Te[Me].abort&&(Te[Me].abort.abort(),delete Te[Me])}))}removeTile(xe){return ee._(this,void 0,void 0,(function*(){this.loaded&&this.loaded[xe.uid]&&delete this.loaded[xe.uid]}))}}class _e{constructor(){this.loaded={}}loadTile(xe){return ee._(this,void 0,void 0,(function*(){const{uid:Te,encoding:Me,rawImageData:ze,redFactor:Qe,greenFactor:tt,blueFactor:He,baseShift:Ze}=xe,st=ze.width+2,At=ze.height+2,wt=ee.b(ze)?new ee.R({width:st,height:At},yield ee.cO(ze,-1,-1,st,At)):ze,Mt=new ee.cP(Te,wt,Me,Qe,tt,He,Ze);return this.loaded=this.loaded||{},this.loaded[Te]=Mt,Mt}))}removeTile(xe){const Te=this.loaded,Me=xe.uid;Te&&Te[Me]&&delete Te[Me]}}var me,we,Oe=(function(){if(we)return me;function Se(Te,Me){if(Te.length!==0){xe(Te[0],Me);for(var ze=1;ze<Te.length;ze++)xe(Te[ze],!Me)}}function xe(Te,Me){for(var ze=0,Qe=0,tt=0,He=Te.length,Ze=He-1;tt<He;Ze=tt++){var st=(Te[tt][0]-Te[Ze][0])*(Te[Ze][1]+Te[tt][1]),At=ze+st;Qe+=Math.abs(ze)>=Math.abs(st)?ze-At+st:st-At+ze,ze=At}ze+Qe>=0!=!!Me&&Te.reverse()}return we=1,me=function Te(Me,ze){var Qe,tt=Me&&Me.type;if(tt==="FeatureCollection")for(Qe=0;Qe<Me.features.length;Qe++)Te(Me.features[Qe],ze);else if(tt==="GeometryCollection")for(Qe=0;Qe<Me.geometries.length;Qe++)Te(Me.geometries[Qe],ze);else if(tt==="Feature")Te(Me.geometry,ze);else if(tt==="Polygon")Se(Me.coordinates,ze);else if(tt==="MultiPolygon")for(Qe=0;Qe<Me.coordinates.length;Qe++)Se(Me.coordinates[Qe],ze);return Me}})(),De=ee.cQ(Oe);class Ae extends ee.cS{constructor(xe,Te){super(new ee.cM,0,Te,[],[]),this.feature=xe,this.type=xe.type,this.properties=xe.tags?xe.tags:{},"id"in xe&&(typeof xe.id=="string"?this.id=parseInt(xe.id,10):typeof xe.id!="number"||isNaN(xe.id)||(this.id=xe.id))}loadGeometry(){const xe=[],Te=this.feature.type===1?[this.feature.geometry]:this.feature.geometry;for(const Me of Te){const ze=[];for(const Qe of Me)ze.push(new ee.P(Qe[0],Qe[1]));xe.push(ze)}return xe}}class Ce extends ee.cR{constructor(xe,Te){super(new ee.cM),this.layers={_geojsonTileLayer:this},this.name="_geojsonTileLayer",this.version=Te?Te.version:1,this.extent=Te?Te.extent:4096,this.length=xe.length,this.features=xe}feature(xe){return new Ae(this.features[xe],this.extent)}}function je(Se,xe){xe.writeVarintField(15,Se.version||1),xe.writeStringField(1,Se.name||""),xe.writeVarintField(5,Se.extent||4096);const Te={keys:[],values:[],keycache:{},valuecache:{}};for(let Qe=0;Qe<Se.length;Qe++)Te.feature=Se.feature(Qe),xe.writeMessage(2,ke,Te);const Me=Te.keys;for(const Qe of Me)xe.writeStringField(3,Qe);const ze=Te.values;for(const Qe of ze)xe.writeMessage(4,et,Qe)}function ke(Se,xe){if(!Se.feature)return;const Te=Se.feature;Te.id!==void 0&&xe.writeVarintField(1,Te.id),xe.writeMessage(2,Be,Se),xe.writeVarintField(3,Te.type),xe.writeMessage(4,Ke,Te)}function Be(Se,xe){var Te;for(const Me in(Te=Se.feature)==null?void 0:Te.properties){let ze=Se.feature.properties[Me],Qe=Se.keycache[Me];if(ze===null)continue;Qe===void 0&&(Se.keys.push(Me),Qe=Se.keys.length-1,Se.keycache[Me]=Qe),xe.writeVarint(Qe),typeof ze!="string"&&typeof ze!="boolean"&&typeof ze!="number"&&(ze=JSON.stringify(ze));const tt=typeof ze+":"+ze;let He=Se.valuecache[tt];He===void 0&&(Se.values.push(ze),He=Se.values.length-1,Se.valuecache[tt]=He),xe.writeVarint(He)}}function We(Se,xe){return(xe<<3)+(7&Se)}function Je(Se){return Se<<1^Se>>31}function Ke(Se,xe){const Te=Se.loadGeometry(),Me=Se.type;let ze=0,Qe=0;for(const tt of Te){let He=1;Me===1&&(He=tt.length),xe.writeVarint(We(1,He));const Ze=Me===3?tt.length-1:tt.length;for(let st=0;st<Ze;st++){st===1&&Me!==1&&xe.writeVarint(We(2,Ze-1));const At=tt[st].x-ze,wt=tt[st].y-Qe;xe.writeVarint(Je(At)),xe.writeVarint(Je(wt)),ze+=At,Qe+=wt}Se.type===3&&xe.writeVarint(We(7,1))}}function et(Se,xe){const Te=typeof Se;Te==="string"?xe.writeStringField(1,Se):Te==="boolean"?xe.writeBooleanField(7,Se):Te==="number"&&(Se%1!=0?xe.writeDoubleField(3,Se):Se<0?xe.writeSVarintField(6,Se):xe.writeVarintField(5,Se))}const it={minZoom:0,maxZoom:16,minPoints:2,radius:40,extent:512,nodeSize:64,log:!1,generateId:!1,reduce:null,map:Se=>Se},nt=Math.fround||(ct=new Float32Array(1),Se=>(ct[0]=+Se,ct[0]));var ct;class ft{constructor(xe){this.options=Object.assign(Object.create(it),xe),this.trees=new Array(this.options.maxZoom+1),this.stride=this.options.reduce?7:6,this.clusterProps=[]}load(xe){const{log:Te,minZoom:Me,maxZoom:ze}=this.options;Te&&console.time("total time");const Qe=`prepare ${xe.length} points`;Te&&console.time(Qe),this.points=xe;const tt=[];for(let Ze=0;Ze<xe.length;Ze++){const st=xe[Ze];if(!st.geometry)continue;const[At,wt]=st.geometry.coordinates,Mt=nt(Ft(At)),Zt=nt(ht(wt));tt.push(Mt,Zt,1/0,Ze,-1,1),this.options.reduce&&tt.push(0)}let He=this.trees[ze+1]=this._createTree(tt);Te&&console.timeEnd(Qe);for(let Ze=ze;Ze>=Me;Ze--){const st=+Date.now();He=this.trees[Ze]=this._createTree(this._cluster(He,Ze)),Te&&console.log("z%d: %d clusters in %dms",Ze,He.numItems,+Date.now()-st)}return Te&&console.timeEnd("total time"),this}getClusters(xe,Te){let Me=((xe[0]+180)%360+360)%360-180;const ze=Math.max(-90,Math.min(90,xe[1]));let Qe=xe[2]===180?180:((xe[2]+180)%360+360)%360-180;const tt=Math.max(-90,Math.min(90,xe[3]));if(xe[2]-xe[0]>=360)Me=-180,Qe=180;else if(Me>Qe){const wt=this.getClusters([Me,ze,180,tt],Te),Mt=this.getClusters([-180,ze,Qe,tt],Te);return wt.concat(Mt)}const He=this.trees[this._limitZoom(Te)],Ze=He.range(Ft(Me),ht(tt),Ft(Qe),ht(ze)),st=He.data,At=[];for(const wt of Ze){const Mt=this.stride*wt;At.push(st[Mt+5]>1?_t(st,Mt,this.clusterProps):this.points[st[Mt+3]])}return At}getChildren(xe){const Te=this._getOriginId(xe),Me=this._getOriginZoom(xe),ze="No cluster with the specified id.",Qe=this.trees[Me];if(!Qe)throw new Error(ze);const tt=Qe.data;if(Te*this.stride>=tt.length)throw new Error(ze);const He=this.options.radius/(this.options.extent*Math.pow(2,Me-1)),Ze=Qe.within(tt[Te*this.stride],tt[Te*this.stride+1],He),st=[];for(const At of Ze){const wt=At*this.stride;tt[wt+4]===xe&&st.push(tt[wt+5]>1?_t(tt,wt,this.clusterProps):this.points[tt[wt+3]])}if(st.length===0)throw new Error(ze);return st}getLeaves(xe,Te,Me){const ze=[];return this._appendLeaves(ze,xe,Te=Te||10,Me=Me||0,0),ze}getTile(xe,Te,Me){const ze=this.trees[this._limitZoom(xe)],Qe=Math.pow(2,xe),{extent:tt,radius:He}=this.options,Ze=He/tt,st=(Me-Ze)/Qe,At=(Me+1+Ze)/Qe,wt={features:[]};return this._addTileFeatures(ze.range((Te-Ze)/Qe,st,(Te+1+Ze)/Qe,At),ze.data,Te,Me,Qe,wt),Te===0&&this._addTileFeatures(ze.range(1-Ze/Qe,st,1,At),ze.data,Qe,Me,Qe,wt),Te===Qe-1&&this._addTileFeatures(ze.range(0,st,Ze/Qe,At),ze.data,-1,Me,Qe,wt),wt.features.length?wt:null}getClusterExpansionZoom(xe){let Te=this._getOriginZoom(xe)-1;for(;Te<=this.options.maxZoom;){const Me=this.getChildren(xe);if(Te++,Me.length!==1)break;xe=Me[0].properties.cluster_id}return Te}_appendLeaves(xe,Te,Me,ze,Qe){const tt=this.getChildren(Te);for(const He of tt){const Ze=He.properties;if(Ze&&Ze.cluster?Qe+Ze.point_count<=ze?Qe+=Ze.point_count:Qe=this._appendLeaves(xe,Ze.cluster_id,Me,ze,Qe):Qe<ze?Qe++:xe.push(He),xe.length===Me)break}return Qe}_createTree(xe){const Te=new ee.aI(xe.length/this.stride|0,this.options.nodeSize,Float32Array);for(let Me=0;Me<xe.length;Me+=this.stride)Te.add(xe[Me],xe[Me+1]);return Te.finish(),Te.data=xe,Te}_addTileFeatures(xe,Te,Me,ze,Qe,tt){for(const He of xe){const Ze=He*this.stride,st=Te[Ze+5]>1;let At,wt,Mt;if(st)At=Rt(Te,Ze,this.clusterProps),wt=Te[Ze],Mt=Te[Ze+1];else{const Er=this.points[Te[Ze+3]];At=Er.properties;const[Or,cr]=Er.geometry.coordinates;wt=Ft(Or),Mt=ht(cr)}const Zt={type:1,geometry:[[Math.round(this.options.extent*(wt*Qe-Me)),Math.round(this.options.extent*(Mt*Qe-ze))]],tags:At};let Tt;Tt=st||this.options.generateId?Te[Ze+3]:this.points[Te[Ze+3]].id,Tt!==void 0&&(Zt.id=Tt),tt.features.push(Zt)}}_limitZoom(xe){return Math.max(this.options.minZoom,Math.min(Math.floor(+xe),this.options.maxZoom+1))}_cluster(xe,Te){const{radius:Me,extent:ze,reduce:Qe,minPoints:tt}=this.options,He=Me/(ze*Math.pow(2,Te)),Ze=xe.data,st=[],At=this.stride;for(let wt=0;wt<Ze.length;wt+=At){if(Ze[wt+2]<=Te)continue;Ze[wt+2]=Te;const Mt=Ze[wt],Zt=Ze[wt+1],Tt=xe.within(Ze[wt],Ze[wt+1],He),Er=Ze[wt+5];let Or=Er;for(const cr of Tt){const Fr=cr*At;Ze[Fr+2]>Te&&(Or+=Ze[Fr+5])}if(Or>Er&&Or>=tt){let cr,Fr=Mt*Er,Yr=Zt*Er,vi=-1;const bi=(wt/At<<5)+(Te+1)+this.points.length;for(const qi of Tt){const Jr=qi*At;if(Ze[Jr+2]<=Te)continue;Ze[Jr+2]=Te;const li=Ze[Jr+5];Fr+=Ze[Jr]*li,Yr+=Ze[Jr+1]*li,Ze[Jr+4]=bi,Qe&&(cr||(cr=this._map(Ze,wt,!0),vi=this.clusterProps.length,this.clusterProps.push(cr)),Qe(cr,this._map(Ze,Jr)))}Ze[wt+4]=bi,st.push(Fr/Or,Yr/Or,1/0,bi,-1,Or),Qe&&st.push(vi)}else{for(let cr=0;cr<At;cr++)st.push(Ze[wt+cr]);if(Or>1)for(const cr of Tt){const Fr=cr*At;if(!(Ze[Fr+2]<=Te)){Ze[Fr+2]=Te;for(let Yr=0;Yr<At;Yr++)st.push(Ze[Fr+Yr])}}}}return st}_getOriginId(xe){return xe-this.points.length>>5}_getOriginZoom(xe){return(xe-this.points.length)%32}_map(xe,Te,Me){if(xe[Te+5]>1){const tt=this.clusterProps[xe[Te+6]];return Me?Object.assign({},tt):tt}const ze=this.points[xe[Te+3]].properties,Qe=this.options.map(ze);return Me&&Qe===ze?Object.assign({},Qe):Qe}}function _t(Se,xe,Te){return{type:"Feature",id:Se[xe+3],properties:Rt(Se,xe,Te),geometry:{type:"Point",coordinates:[(Me=Se[xe],360*(Me-.5)),St(Se[xe+1])]}};var Me}function Rt(Se,xe,Te){const Me=Se[xe+5],ze=Me>=1e4?`${Math.round(Me/1e3)}k`:Me>=1e3?Math.round(Me/100)/10+"k":Me,Qe=Se[xe+6],tt=Qe===-1?{}:Object.assign({},Te[Qe]);return Object.assign(tt,{cluster:!0,cluster_id:Se[xe+3],point_count:Me,point_count_abbreviated:ze})}function Ft(Se){return Se/360+.5}function ht(Se){const xe=Math.sin(Se*Math.PI/180),Te=.5-.25*Math.log((1+xe)/(1-xe))/Math.PI;return Te<0?0:Te>1?1:Te}function St(Se){const xe=(180-360*Se)*Math.PI/180;return 360*Math.atan(Math.exp(xe))/Math.PI-90}function ut(Se,xe,Te,Me){let ze=Me;const Qe=xe+(Te-xe>>1);let tt,He=Te-xe;const Ze=Se[xe],st=Se[xe+1],At=Se[Te],wt=Se[Te+1];for(let Mt=xe+3;Mt<Te;Mt+=3){const Zt=Et(Se[Mt],Se[Mt+1],Ze,st,At,wt);if(Zt>ze)tt=Mt,ze=Zt;else if(Zt===ze){const Tt=Math.abs(Mt-Qe);Tt<He&&(tt=Mt,He=Tt)}}ze>Me&&(tt-xe>3&&ut(Se,xe,tt,Me),Se[tt+2]=ze,Te-tt>3&&ut(Se,tt,Te,Me))}function Et(Se,xe,Te,Me,ze,Qe){let tt=ze-Te,He=Qe-Me;if(tt!==0||He!==0){const Ze=((Se-Te)*tt+(xe-Me)*He)/(tt*tt+He*He);Ze>1?(Te=ze,Me=Qe):Ze>0&&(Te+=tt*Ze,Me+=He*Ze)}return tt=Se-Te,He=xe-Me,tt*tt+He*He}function bt(Se,xe,Te,Me){const ze={id:Se??null,type:xe,geometry:Te,tags:Me,minX:1/0,minY:1/0,maxX:-1/0,maxY:-1/0};if(xe==="Point"||xe==="MultiPoint"||xe==="LineString")Dt(ze,Te);else if(xe==="Polygon")Dt(ze,Te[0]);else if(xe==="MultiLineString")for(const Qe of Te)Dt(ze,Qe);else if(xe==="MultiPolygon")for(const Qe of Te)Dt(ze,Qe[0]);return ze}function Dt(Se,xe){for(let Te=0;Te<xe.length;Te+=3)Se.minX=Math.min(Se.minX,xe[Te]),Se.minY=Math.min(Se.minY,xe[Te+1]),Se.maxX=Math.max(Se.maxX,xe[Te]),Se.maxY=Math.max(Se.maxY,xe[Te+1])}function Ut(Se,xe,Te,Me){if(!xe.geometry)return;const ze=xe.geometry.coordinates;if(ze&&ze.length===0)return;const Qe=xe.geometry.type,tt=Math.pow(Te.tolerance/((1<<Te.maxZoom)*Te.extent),2);let He=[],Ze=xe.id;if(Te.promoteId?Ze=xe.properties[Te.promoteId]:Te.generateId&&(Ze=Me||0),Qe==="Point")er(ze,He);else if(Qe==="MultiPoint")for(const st of ze)er(st,He);else if(Qe==="LineString")xr(ze,He,tt,!1);else if(Qe==="MultiLineString"){if(Te.lineMetrics){for(const st of ze)He=[],xr(st,He,tt,!1),Se.push(bt(Ze,"LineString",He,xe.properties));return}ur(ze,He,tt,!1)}else if(Qe==="Polygon")ur(ze,He,tt,!0);else{if(Qe!=="MultiPolygon"){if(Qe==="GeometryCollection"){for(const st of xe.geometry.geometries)Ut(Se,{id:Ze,geometry:st,properties:xe.properties},Te,Me);return}throw new Error("Input data is not a valid GeoJSON object.")}for(const st of ze){const At=[];ur(st,At,tt,!0),He.push(At)}}Se.push(bt(Ze,Qe,He,xe.properties))}function er(Se,xe){xe.push(yr(Se[0]),Wt(Se[1]),0)}function xr(Se,xe,Te,Me){let ze,Qe,tt=0;for(let Ze=0;Ze<Se.length;Ze++){const st=yr(Se[Ze][0]),At=Wt(Se[Ze][1]);xe.push(st,At,0),Ze>0&&(tt+=Me?(ze*At-st*Qe)/2:Math.sqrt(Math.pow(st-ze,2)+Math.pow(At-Qe,2))),ze=st,Qe=At}const He=xe.length-3;xe[2]=1,ut(xe,0,He,Te),xe[He+2]=1,xe.size=Math.abs(tt),xe.start=0,xe.end=xe.size}function ur(Se,xe,Te,Me){for(let ze=0;ze<Se.length;ze++){const Qe=[];xr(Se[ze],Qe,Te,Me),xe.push(Qe)}}function yr(Se){return Se/360+.5}function Wt(Se){const xe=Math.sin(Se*Math.PI/180),Te=.5-.25*Math.log((1+xe)/(1-xe))/Math.PI;return Te<0?0:Te>1?1:Te}function or(Se,xe,Te,Me,ze,Qe,tt,He){if(Me/=xe,Qe>=(Te/=xe)&&tt<Me)return Se;if(tt<Te||Qe>=Me)return null;const Ze=[];for(const st of Se){const At=st.geometry;let wt=st.type;const Mt=ze===0?st.minX:st.minY,Zt=ze===0?st.maxX:st.maxY;if(Mt>=Te&&Zt<Me){Ze.push(st);continue}if(Zt<Te||Mt>=Me)continue;let Tt=[];if(wt==="Point"||wt==="MultiPoint")wr(At,Tt,Te,Me,ze);else if(wt==="LineString")Ir(At,Tt,Te,Me,ze,!1,He.lineMetrics);else if(wt==="MultiLineString")gr(At,Tt,Te,Me,ze,!1);else if(wt==="Polygon")gr(At,Tt,Te,Me,ze,!0);else if(wt==="MultiPolygon")for(const Er of At){const Or=[];gr(Er,Or,Te,Me,ze,!0),Or.length&&Tt.push(Or)}if(Tt.length){if(He.lineMetrics&&wt==="LineString"){for(const Er of Tt)Ze.push(bt(st.id,wt,Er,st.tags));continue}wt!=="LineString"&&wt!=="MultiLineString"||(Tt.length===1?(wt="LineString",Tt=Tt[0]):wt="MultiLineString"),wt!=="Point"&&wt!=="MultiPoint"||(wt=Tt.length===3?"Point":"MultiPoint"),Ze.push(bt(st.id,wt,Tt,st.tags))}}return Ze.length?Ze:null}function wr(Se,xe,Te,Me,ze){for(let Qe=0;Qe<Se.length;Qe+=3){const tt=Se[Qe+ze];tt>=Te&&tt<=Me&&Mr(xe,Se[Qe],Se[Qe+1],Se[Qe+2])}}function Ir(Se,xe,Te,Me,ze,Qe,tt){let He=br(Se);const Ze=ze===0?Hr:jr;let st,At,wt=Se.start;for(let Or=0;Or<Se.length-3;Or+=3){const cr=Se[Or],Fr=Se[Or+1],Yr=Se[Or+2],vi=Se[Or+3],bi=Se[Or+4],qi=ze===0?cr:Fr,Jr=ze===0?vi:bi;let li=!1;tt&&(st=Math.sqrt(Math.pow(cr-vi,2)+Math.pow(Fr-bi,2))),qi<Te?Jr>Te&&(At=Ze(He,cr,Fr,vi,bi,Te),tt&&(He.start=wt+st*At)):qi>Me?Jr<Me&&(At=Ze(He,cr,Fr,vi,bi,Me),tt&&(He.start=wt+st*At)):Mr(He,cr,Fr,Yr),Jr<Te&&qi>=Te&&(At=Ze(He,cr,Fr,vi,bi,Te),li=!0),Jr>Me&&qi<=Me&&(At=Ze(He,cr,Fr,vi,bi,Me),li=!0),!Qe&&li&&(tt&&(He.end=wt+st*At),xe.push(He),He=br(Se)),tt&&(wt+=st)}let Mt=Se.length-3;const Zt=Se[Mt],Tt=Se[Mt+1],Er=ze===0?Zt:Tt;Er>=Te&&Er<=Me&&Mr(He,Zt,Tt,Se[Mt+2]),Mt=He.length-3,Qe&&Mt>=3&&(He[Mt]!==He[0]||He[Mt+1]!==He[1])&&Mr(He,He[0],He[1],He[2]),He.length&&xe.push(He)}function br(Se){const xe=[];return xe.size=Se.size,xe.start=Se.start,xe.end=Se.end,xe}function gr(Se,xe,Te,Me,ze,Qe){for(const tt of Se)Ir(tt,xe,Te,Me,ze,Qe,!1)}function Mr(Se,xe,Te,Me){Se.push(xe,Te,Me)}function Hr(Se,xe,Te,Me,ze,Qe){const tt=(Qe-xe)/(Me-xe);return Mr(Se,Qe,Te+(ze-Te)*tt,1),tt}function jr(Se,xe,Te,Me,ze,Qe){const tt=(Qe-Te)/(ze-Te);return Mr(Se,xe+(Me-xe)*tt,Qe,1),tt}function Sr(Se,xe){const Te=[];for(let Me=0;Me<Se.length;Me++){const ze=Se[Me],Qe=ze.type;let tt;if(Qe==="Point"||Qe==="MultiPoint"||Qe==="LineString")tt=Nr(ze.geometry,xe);else if(Qe==="MultiLineString"||Qe==="Polygon"){tt=[];for(const He of ze.geometry)tt.push(Nr(He,xe))}else if(Qe==="MultiPolygon"){tt=[];for(const He of ze.geometry){const Ze=[];for(const st of He)Ze.push(Nr(st,xe));tt.push(Ze)}}Te.push(bt(ze.id,Qe,tt,ze.tags))}return Te}function Nr(Se,xe){const Te=[];Te.size=Se.size,Se.start!==void 0&&(Te.start=Se.start,Te.end=Se.end);for(let Me=0;Me<Se.length;Me+=3)Te.push(Se[Me]+xe,Se[Me+1],Se[Me+2]);return Te}function Dr(Se,xe){if(Se.transformed)return Se;const Te=1<<Se.z,Me=Se.x,ze=Se.y;for(const Qe of Se.features){const tt=Qe.geometry,He=Qe.type;if(Qe.geometry=[],He===1)for(let Ze=0;Ze<tt.length;Ze+=2)Qe.geometry.push(Lr(tt[Ze],tt[Ze+1],xe,Te,Me,ze));else for(let Ze=0;Ze<tt.length;Ze++){const st=[];for(let At=0;At<tt[Ze].length;At+=2)st.push(Lr(tt[Ze][At],tt[Ze][At+1],xe,Te,Me,ze));Qe.geometry.push(st)}}return Se.transformed=!0,Se}function Lr(Se,xe,Te,Me,ze,Qe){return[Math.round(Te*(Se*Me-ze)),Math.round(Te*(xe*Me-Qe))]}function Yt(Se,xe,Te,Me,ze){const Qe=xe===ze.maxZoom?0:ze.tolerance/((1<<xe)*ze.extent),tt={features:[],numPoints:0,numSimplified:0,numFeatures:Se.length,source:null,x:Te,y:Me,z:xe,transformed:!1,minX:2,minY:1,maxX:-1,maxY:0};for(const He of Se)Jt(tt,He,Qe,ze);return tt}function Jt(Se,xe,Te,Me){const ze=xe.geometry,Qe=xe.type,tt=[];if(Se.minX=Math.min(Se.minX,xe.minX),Se.minY=Math.min(Se.minY,xe.minY),Se.maxX=Math.max(Se.maxX,xe.maxX),Se.maxY=Math.max(Se.maxY,xe.maxY),Qe==="Point"||Qe==="MultiPoint")for(let He=0;He<ze.length;He+=3)tt.push(ze[He],ze[He+1]),Se.numPoints++,Se.numSimplified++;else if(Qe==="LineString")qr(tt,ze,Se,Te,!1,!1);else if(Qe==="MultiLineString"||Qe==="Polygon")for(let He=0;He<ze.length;He++)qr(tt,ze[He],Se,Te,Qe==="Polygon",He===0);else if(Qe==="MultiPolygon")for(let He=0;He<ze.length;He++){const Ze=ze[He];for(let st=0;st<Ze.length;st++)qr(tt,Ze[st],Se,Te,!0,st===0)}if(tt.length){let He=xe.tags||null;if(Qe==="LineString"&&Me.lineMetrics){He={};for(const st in xe.tags)He[st]=xe.tags[st];He.mapbox_clip_start=ze.start/ze.size,He.mapbox_clip_end=ze.end/ze.size}const Ze={geometry:tt,type:Qe==="Polygon"||Qe==="MultiPolygon"?3:Qe==="LineString"||Qe==="MultiLineString"?2:1,tags:He};xe.id!==null&&(Ze.id=xe.id),Se.features.push(Ze)}}function qr(Se,xe,Te,Me,ze,Qe){const tt=Me*Me;if(Me>0&&xe.size<(ze?tt:Me))return void(Te.numPoints+=xe.length/3);const He=[];for(let Ze=0;Ze<xe.length;Ze+=3)(Me===0||xe[Ze+2]>tt)&&(Te.numSimplified++,He.push(xe[Ze],xe[Ze+1])),Te.numPoints++;ze&&(function(Ze,st){let At=0;for(let wt=0,Mt=Ze.length,Zt=Mt-2;wt<Mt;Zt=wt,wt+=2)At+=(Ze[wt]-Ze[Zt])*(Ze[wt+1]+Ze[Zt+1]);if(At>0===st)for(let wt=0,Mt=Ze.length;wt<Mt/2;wt+=2){const Zt=Ze[wt],Tt=Ze[wt+1];Ze[wt]=Ze[Mt-2-wt],Ze[wt+1]=Ze[Mt-1-wt],Ze[Mt-2-wt]=Zt,Ze[Mt-1-wt]=Tt}})(He,Qe),Se.push(He)}const nr={maxZoom:14,indexMaxZoom:5,indexMaxPoints:1e5,tolerance:3,extent:4096,buffer:64,lineMetrics:!1,promoteId:null,generateId:!1,debug:0};class dr{constructor(xe,Te){const Me=(Te=this.options=(function(Qe,tt){for(const He in tt)Qe[He]=tt[He];return Qe})(Object.create(nr),Te)).debug;if(Me&&console.time("preprocess data"),Te.maxZoom<0||Te.maxZoom>24)throw new Error("maxZoom should be in the 0-24 range");if(Te.promoteId&&Te.generateId)throw new Error("promoteId and generateId cannot be used together.");let ze=(function(Qe,tt){const He=[];if(Qe.type==="FeatureCollection")for(let Ze=0;Ze<Qe.features.length;Ze++)Ut(He,Qe.features[Ze],tt,Ze);else Ut(He,Qe.type==="Feature"?Qe:{geometry:Qe},tt);return He})(xe,Te);this.tiles={},this.tileCoords=[],Me&&(console.timeEnd("preprocess data"),console.log("index: maxZoom: %d, maxPoints: %d",Te.indexMaxZoom,Te.indexMaxPoints),console.time("generate tiles"),this.stats={},this.total=0),ze=(function(Qe,tt){const He=tt.buffer/tt.extent;let Ze=Qe;const st=or(Qe,1,-1-He,He,0,-1,2,tt),At=or(Qe,1,1-He,2+He,0,-1,2,tt);return(st||At)&&(Ze=or(Qe,1,-He,1+He,0,-1,2,tt)||[],st&&(Ze=Sr(st,1).concat(Ze)),At&&(Ze=Ze.concat(Sr(At,-1)))),Ze})(ze,Te),ze.length&&this.splitTile(ze,0,0,0),Me&&(ze.length&&console.log("features: %d, points: %d",this.tiles[0].numFeatures,this.tiles[0].numPoints),console.timeEnd("generate tiles"),console.log("tiles generated:",this.total,JSON.stringify(this.stats)))}splitTile(xe,Te,Me,ze,Qe,tt,He){const Ze=[xe,Te,Me,ze],st=this.options,At=st.debug;for(;Ze.length;){ze=Ze.pop(),Me=Ze.pop(),Te=Ze.pop(),xe=Ze.pop();const wt=1<<Te,Mt=mr(Te,Me,ze);let Zt=this.tiles[Mt];if(!Zt&&(At>1&&console.time("creation"),Zt=this.tiles[Mt]=Yt(xe,Te,Me,ze,st),this.tileCoords.push({z:Te,x:Me,y:ze}),At)){At>1&&(console.log("tile z%d-%d-%d (features: %d, points: %d, simplified: %d)",Te,Me,ze,Zt.numFeatures,Zt.numPoints,Zt.numSimplified),console.timeEnd("creation"));const li=`z${Te}`;this.stats[li]=(this.stats[li]||0)+1,this.total++}if(Zt.source=xe,Qe==null){if(Te===st.indexMaxZoom||Zt.numPoints<=st.indexMaxPoints)continue}else{if(Te===st.maxZoom||Te===Qe)continue;if(Qe!=null){const li=Qe-Te;if(Me!==tt>>li||ze!==He>>li)continue}}if(Zt.source=null,xe.length===0)continue;At>1&&console.time("clipping");const Tt=.5*st.buffer/st.extent,Er=.5-Tt,Or=.5+Tt,cr=1+Tt;let Fr=null,Yr=null,vi=null,bi=null,qi=or(xe,wt,Me-Tt,Me+Or,0,Zt.minX,Zt.maxX,st),Jr=or(xe,wt,Me+Er,Me+cr,0,Zt.minX,Zt.maxX,st);xe=null,qi&&(Fr=or(qi,wt,ze-Tt,ze+Or,1,Zt.minY,Zt.maxY,st),Yr=or(qi,wt,ze+Er,ze+cr,1,Zt.minY,Zt.maxY,st),qi=null),Jr&&(vi=or(Jr,wt,ze-Tt,ze+Or,1,Zt.minY,Zt.maxY,st),bi=or(Jr,wt,ze+Er,ze+cr,1,Zt.minY,Zt.maxY,st),Jr=null),At>1&&console.timeEnd("clipping"),Ze.push(Fr||[],Te+1,2*Me,2*ze),Ze.push(Yr||[],Te+1,2*Me,2*ze+1),Ze.push(vi||[],Te+1,2*Me+1,2*ze),Ze.push(bi||[],Te+1,2*Me+1,2*ze+1)}}getTile(xe,Te,Me){xe=+xe,Te=+Te,Me=+Me;const ze=this.options,{extent:Qe,debug:tt}=ze;if(xe<0||xe>24)return null;const He=1<<xe,Ze=mr(xe,Te=Te+He&He-1,Me);if(this.tiles[Ze])return Dr(this.tiles[Ze],Qe);tt>1&&console.log("drilling down to z%d-%d-%d",xe,Te,Me);let st,At=xe,wt=Te,Mt=Me;for(;!st&&At>0;)At--,wt>>=1,Mt>>=1,st=this.tiles[mr(At,wt,Mt)];return st&&st.source?(tt>1&&(console.log("found parent tile z%d-%d-%d",At,wt,Mt),console.time("drilling down")),this.splitTile(st.source,At,wt,Mt,xe,Te,Me),tt>1&&console.timeEnd("drilling down"),this.tiles[Ze]?Dr(this.tiles[Ze],Qe):null):null}}function mr(Se,xe,Te){return 32*((1<<Se)*Te+xe)+Se}class Ge extends pe{constructor(){super(...arguments),this._dataUpdateable=new Map}loadVectorTile(xe,Te){return ee._(this,void 0,void 0,(function*(){const Me=xe.tileID.canonical;if(!this._geoJSONIndex)throw new Error("Unable to parse the data into a cluster or geojson");const ze=this._geoJSONIndex.getTile(Me.z,Me.x,Me.y);if(!ze)return null;const Qe=new Ce(ze.features,{version:2,extent:ee.$});let tt=(function(He){const Ze=new ee.cM;return(function(st,At){for(const wt in st.layers)At.writeMessage(3,je,st.layers[wt])})(He,Ze),Ze.finish()})(Qe);return tt.byteOffset===0&&tt.byteLength===tt.buffer.byteLength||(tt=new Uint8Array(tt)),{vectorTile:Qe,rawData:tt.buffer}}))}loadData(xe){return ee._(this,void 0,void 0,(function*(){var Te;(Te=this._pendingRequest)===null||Te===void 0||Te.abort();const Me=!!(xe&&xe.request&&xe.request.collectResourceTiming)&&new ee.cN(xe.request);this._pendingRequest=new AbortController;try{this._pendingData=this.loadAndProcessGeoJSON(xe,this._pendingRequest);const ze=yield this._pendingData;this._geoJSONIndex=xe.cluster?new ft((function({superclusterOptions:tt,clusterProperties:He}){if(!He||!tt)return tt;const Ze={},st={},At={accumulated:null,zoom:0},wt={properties:null},Mt=Object.keys(He);for(const Zt of Mt){const[Tt,Er]=He[Zt],Or=ee.cT(Er),cr=ee.cT(typeof Tt=="string"?[Tt,["accumulated"],["get",Zt]]:Tt);Ze[Zt]=Or.value,st[Zt]=cr.value}return tt.map=Zt=>{wt.properties=Zt;const Tt={};for(const Er of Mt)Tt[Er]=Ze[Er].evaluate(At,wt);return Tt},tt.reduce=(Zt,Tt)=>{wt.properties=Tt;for(const Er of Mt)At.accumulated=Zt[Er],Zt[Er]=st[Er].evaluate(At,wt)},tt})(xe)).load(ze.features):(function(tt,He){return new dr(tt,He)})(ze,xe.geojsonVtOptions),this.loaded={};const Qe={data:ze};if(Me){const tt=Me.finish();tt&&(Qe.resourceTiming={},Qe.resourceTiming[xe.source]=JSON.parse(JSON.stringify(tt)))}return Qe}catch(ze){if(delete this._pendingRequest,ee.cy(ze))return{abandoned:!0};throw ze}}))}getData(){return ee._(this,void 0,void 0,(function*(){return this._pendingData}))}reloadTile(xe){const Te=this.loaded;return Te&&Te[xe.uid]?super.reloadTile(xe):this.loadTile(xe)}loadAndProcessGeoJSON(xe,Te){return ee._(this,void 0,void 0,(function*(){let Me=yield this.loadGeoJSON(xe,Te);if(delete this._pendingRequest,typeof Me!="object")throw new Error(`Input data given to '${xe.source}' is not a valid GeoJSON object.`);if(De(Me,!0),xe.filter){const ze=ee.cT(xe.filter,{type:"boolean","property-type":"data-driven",overridable:!1,transition:!1});if(ze.result==="error")throw new Error(ze.value.map((tt=>`${tt.key}: ${tt.message}`)).join(", "));Me={type:"FeatureCollection",features:Me.features.filter((tt=>ze.value.evaluate({zoom:0},tt)))}}return Me}))}loadGeoJSON(xe,Te){return ee._(this,void 0,void 0,(function*(){const{promoteId:Me}=xe;if(xe.request){const ze=yield ee.j(xe.request,Te);return this._dataUpdateable=ee.cV(ze.data,Me)?ee.cU(ze.data,Me):void 0,ze.data}if(typeof xe.data=="string")try{const ze=JSON.parse(xe.data);return this._dataUpdateable=ee.cV(ze,Me)?ee.cU(ze,Me):void 0,ze}catch{throw new Error(`Input data given to '${xe.source}' is not a valid GeoJSON object.`)}if(!xe.dataDiff)throw new Error(`Input data given to '${xe.source}' is not a valid GeoJSON object.`);if(!this._dataUpdateable)throw new Error(`Cannot update existing geojson data in ${xe.source}`);return ee.cW(this._dataUpdateable,xe.dataDiff,Me),{type:"FeatureCollection",features:Array.from(this._dataUpdateable.values())}}))}removeSource(xe){return ee._(this,void 0,void 0,(function*(){this._pendingRequest&&this._pendingRequest.abort()}))}getClusterExpansionZoom(xe){return this._geoJSONIndex.getClusterExpansionZoom(xe.clusterId)}getClusterChildren(xe){return this._geoJSONIndex.getChildren(xe.clusterId)}getClusterLeaves(xe){return this._geoJSONIndex.getLeaves(xe.clusterId,xe.limit,xe.offset)}}class Ie{constructor(xe){this.self=xe,this.actor=new ee.J(xe),this.layerIndexes={},this.availableImages={},this.workerSources={},this.demWorkerSources={},this.externalWorkerSourceTypes={},this.globalStates=new Map,this.self.registerWorkerSource=(Te,Me)=>{if(this.externalWorkerSourceTypes[Te])throw new Error(`Worker source with name "${Te}" already registered.`);this.externalWorkerSourceTypes[Te]=Me},this.self.addProtocol=ee.cA,this.self.removeProtocol=ee.cB,this.self.registerRTLTextPlugin=Te=>{ee.cX.setMethods(Te)},this.actor.registerMessageHandler("LDT",((Te,Me)=>this._getDEMWorkerSource(Te,Me.source).loadTile(Me))),this.actor.registerMessageHandler("RDT",((Te,Me)=>ee._(this,void 0,void 0,(function*(){this._getDEMWorkerSource(Te,Me.source).removeTile(Me)})))),this.actor.registerMessageHandler("GCEZ",((Te,Me)=>ee._(this,void 0,void 0,(function*(){return this._getWorkerSource(Te,Me.type,Me.source).getClusterExpansionZoom(Me)})))),this.actor.registerMessageHandler("GCC",((Te,Me)=>ee._(this,void 0,void 0,(function*(){return this._getWorkerSource(Te,Me.type,Me.source).getClusterChildren(Me)})))),this.actor.registerMessageHandler("GCL",((Te,Me)=>ee._(this,void 0,void 0,(function*(){return this._getWorkerSource(Te,Me.type,Me.source).getClusterLeaves(Me)})))),this.actor.registerMessageHandler("LD",((Te,Me)=>this._getWorkerSource(Te,Me.type,Me.source).loadData(Me))),this.actor.registerMessageHandler("GD",((Te,Me)=>this._getWorkerSource(Te,Me.type,Me.source).getData())),this.actor.registerMessageHandler("LT",((Te,Me)=>this._getWorkerSource(Te,Me.type,Me.source).loadTile(Me))),this.actor.registerMessageHandler("RT",((Te,Me)=>this._getWorkerSource(Te,Me.type,Me.source).reloadTile(Me))),this.actor.registerMessageHandler("AT",((Te,Me)=>this._getWorkerSource(Te,Me.type,Me.source).abortTile(Me))),this.actor.registerMessageHandler("RMT",((Te,Me)=>this._getWorkerSource(Te,Me.type,Me.source).removeTile(Me))),this.actor.registerMessageHandler("RS",((Te,Me)=>ee._(this,void 0,void 0,(function*(){if(!this.workerSources[Te]||!this.workerSources[Te][Me.type]||!this.workerSources[Te][Me.type][Me.source])return;const ze=this.workerSources[Te][Me.type][Me.source];delete this.workerSources[Te][Me.type][Me.source],ze.removeSource!==void 0&&ze.removeSource(Me)})))),this.actor.registerMessageHandler("RM",(Te=>ee._(this,void 0,void 0,(function*(){delete this.layerIndexes[Te],delete this.availableImages[Te],delete this.workerSources[Te],delete this.demWorkerSources[Te],this.globalStates.delete(Te)})))),this.actor.registerMessageHandler("SR",((Te,Me)=>ee._(this,void 0,void 0,(function*(){this.referrer=Me})))),this.actor.registerMessageHandler("SRPS",((Te,Me)=>this._syncRTLPluginState(Te,Me))),this.actor.registerMessageHandler("IS",((Te,Me)=>ee._(this,void 0,void 0,(function*(){this.self.importScripts(Me)})))),this.actor.registerMessageHandler("SI",((Te,Me)=>this._setImages(Te,Me))),this.actor.registerMessageHandler("UL",((Te,Me)=>ee._(this,void 0,void 0,(function*(){this._getLayerIndex(Te).update(Me.layers,Me.removedIds,this._getGlobalState(Te))})))),this.actor.registerMessageHandler("UGS",((Te,Me)=>ee._(this,void 0,void 0,(function*(){const ze=this._getGlobalState(Te);for(const Qe in Me)ze[Qe]=Me[Qe]})))),this.actor.registerMessageHandler("SL",((Te,Me)=>ee._(this,void 0,void 0,(function*(){this._getLayerIndex(Te).replace(Me,this._getGlobalState(Te))}))))}_getGlobalState(xe){let Te=this.globalStates.get(xe);return Te||(Te={},this.globalStates.set(xe,Te)),Te}_setImages(xe,Te){return ee._(this,void 0,void 0,(function*(){this.availableImages[xe]=Te;for(const Me in this.workerSources[xe]){const ze=this.workerSources[xe][Me];for(const Qe in ze)ze[Qe].availableImages=Te}}))}_syncRTLPluginState(xe,Te){return ee._(this,void 0,void 0,(function*(){return yield ee.cX.syncState(Te,this.self.importScripts)}))}_getAvailableImages(xe){let Te=this.availableImages[xe];return Te||(Te=[]),Te}_getLayerIndex(xe){let Te=this.layerIndexes[xe];return Te||(Te=this.layerIndexes[xe]=new R),Te}_getWorkerSource(xe,Te,Me){if(this.workerSources[xe]||(this.workerSources[xe]={}),this.workerSources[xe][Te]||(this.workerSources[xe][Te]={}),!this.workerSources[xe][Te][Me]){const ze={sendAsync:(Qe,tt)=>(Qe.targetMapId=xe,this.actor.sendAsync(Qe,tt))};switch(Te){case"vector":this.workerSources[xe][Te][Me]=new pe(ze,this._getLayerIndex(xe),this._getAvailableImages(xe));break;case"geojson":this.workerSources[xe][Te][Me]=new Ge(ze,this._getLayerIndex(xe),this._getAvailableImages(xe));break;default:this.workerSources[xe][Te][Me]=new this.externalWorkerSourceTypes[Te](ze,this._getLayerIndex(xe),this._getAvailableImages(xe))}}return this.workerSources[xe][Te][Me]}_getDEMWorkerSource(xe,Te){return this.demWorkerSources[xe]||(this.demWorkerSources[xe]={}),this.demWorkerSources[xe][Te]||(this.demWorkerSources[xe][Te]=new _e),this.demWorkerSources[xe][Te]}}return ee.i(self)&&(self.worker=new Ie(self)),Ie})),ne("index",["exports","./shared"],(function(ee,R){var U="5.9.0";function K(){var se=new R.A(4);return R.A!=Float32Array&&(se[1]=0,se[2]=0),se[0]=1,se[3]=1,se}let oe,pe;const _e={now:typeof performance<"u"&&performance&&performance.now?performance.now.bind(performance):Date.now.bind(Date),frame(se,t,Z){const Q=requestAnimationFrame((ue=>{ie(),t(ue)})),{unsubscribe:ie}=R.s(se.signal,"abort",(()=>{ie(),cancelAnimationFrame(Q),Z(R.c())}),!1)},frameAsync(se){return new Promise(((t,Z)=>{this.frame(se,t,Z)}))},getImageData(se,t=0){return this.getImageCanvasContext(se).getImageData(-t,-t,se.width+2*t,se.height+2*t)},getImageCanvasContext(se){const t=window.document.createElement("canvas"),Z=t.getContext("2d",{willReadFrequently:!0});if(!Z)throw new Error("failed to create canvas 2d context");return t.width=se.width,t.height=se.height,Z.drawImage(se,0,0,se.width,se.height),Z},resolveURL:se=>(oe||(oe=document.createElement("a")),oe.href=se,oe.href),hardwareConcurrency:typeof navigator<"u"&&navigator.hardwareConcurrency||4,get prefersReducedMotion(){return!!matchMedia&&(pe==null&&(pe=matchMedia("(prefers-reduced-motion: reduce)")),pe.matches)}};class me{static testProp(t){if(!me.docStyle)return t[0];for(let Z=0;Z<t.length;Z++)if(t[Z]in me.docStyle)return t[Z];return t[0]}static create(t,Z,Q){const ie=window.document.createElement(t);return Z!==void 0&&(ie.className=Z),Q&&Q.appendChild(ie),ie}static createNS(t,Z){return window.document.createElementNS(t,Z)}static disableDrag(){me.docStyle&&me.selectProp&&(me.userSelect=me.docStyle[me.selectProp],me.docStyle[me.selectProp]="none")}static enableDrag(){me.docStyle&&me.selectProp&&(me.docStyle[me.selectProp]=me.userSelect)}static setTransform(t,Z){t.style[me.transformProp]=Z}static addEventListener(t,Z,Q,ie={}){t.addEventListener(Z,Q,"passive"in ie?ie:ie.capture)}static removeEventListener(t,Z,Q,ie={}){t.removeEventListener(Z,Q,"passive"in ie?ie:ie.capture)}static suppressClickInternal(t){t.preventDefault(),t.stopPropagation(),window.removeEventListener("click",me.suppressClickInternal,!0)}static suppressClick(){window.addEventListener("click",me.suppressClickInternal,!0),window.setTimeout((()=>{window.removeEventListener("click",me.suppressClickInternal,!0)}),0)}static getScale(t){const Z=t.getBoundingClientRect();return{x:Z.width/t.offsetWidth||1,y:Z.height/t.offsetHeight||1,boundingClientRect:Z}}static getPoint(t,Z,Q){const ie=Z.boundingClientRect;return new R.P((Q.clientX-ie.left)/Z.x-t.clientLeft,(Q.clientY-ie.top)/Z.y-t.clientTop)}static mousePos(t,Z){const Q=me.getScale(t);return me.getPoint(t,Q,Z)}static touchPos(t,Z){const Q=[],ie=me.getScale(t);for(let ue=0;ue<Z.length;ue++)Q.push(me.getPoint(t,ie,Z[ue]));return Q}static mouseButton(t){return t.button}static remove(t){t.parentNode&&t.parentNode.removeChild(t)}static sanitize(t){const Z=new DOMParser().parseFromString(t,"text/html").body||document.createElement("body"),Q=Z.querySelectorAll("script");for(const ie of Q)ie.remove();return me.clean(Z),Z.innerHTML}static isPossiblyDangerous(t,Z){const Q=Z.replace(/\s+/g,"").toLowerCase();return!(!["src","href","xlink:href"].includes(t)||!Q.includes("javascript:")&&!Q.includes("data:"))||!!t.startsWith("on")||void 0}static clean(t){const Z=t.children;for(const Q of Z)me.removeAttributes(Q),me.clean(Q)}static removeAttributes(t){for(const{name:Z,value:Q}of t.attributes)me.isPossiblyDangerous(Z,Q)&&t.removeAttribute(Z)}}me.docStyle=typeof window<"u"&&window.document&&window.document.documentElement.style,me.selectProp=me.testProp(["userSelect","MozUserSelect","WebkitUserSelect","msUserSelect"]),me.transformProp=me.testProp(["transform","WebkitTransform"]);const we={supported:!1,testSupport:function(se){!Ae&&De&&(Ce?je(se):Oe=se)}};let Oe,De,Ae=!1,Ce=!1;function je(se){const t=se.createTexture();se.bindTexture(se.TEXTURE_2D,t);try{if(se.texImage2D(se.TEXTURE_2D,0,se.RGBA,se.RGBA,se.UNSIGNED_BYTE,De),se.isContextLost())return;we.supported=!0}catch{}se.deleteTexture(t),Ae=!0}var ke;typeof document<"u"&&(De=document.createElement("img"),De.onload=()=>{Oe&&je(Oe),Oe=null,Ce=!0},De.onerror=()=>{Ae=!0,Oe=null},De.src="data:image/webp;base64,UklGRh4AAABXRUJQVlA4TBEAAAAvAQAAAAfQ//73v/+BiOh/AAA="),(function(se){let t,Z,Q,ie;se.resetRequestQueue=()=>{t=[],Z=0,Q=0,ie={}},se.addThrottleControl=ve=>{const qe=Q++;return ie[qe]=ve,qe},se.removeThrottleControl=ve=>{delete ie[ve],de()},se.getImage=(ve,qe,Re=!0)=>new Promise(((Le,Fe)=>{we.supported&&(ve.headers||(ve.headers={}),ve.headers.accept="image/webp,*/*"),R.e(ve,{type:"image"}),t.push({abortController:qe,requestParameters:ve,supportImageRefresh:Re,state:"queued",onError:Ve=>{Fe(Ve)},onSuccess:Ve=>{Le(Ve)}}),de()}));const ue=ve=>R._(this,void 0,void 0,(function*(){ve.state="running";const{requestParameters:qe,supportImageRefresh:Re,onError:Le,onSuccess:Fe,abortController:Ve}=ve,Xe=Re===!1&&!R.i(self)&&!R.g(qe.url)&&(!qe.headers||Object.keys(qe.headers).reduce(((lt,pt)=>lt&&pt==="accept"),!0));Z++;const at=Xe?ge(qe,Ve):R.m(qe,Ve);try{const lt=yield at;delete ve.abortController,ve.state="completed",lt.data instanceof HTMLImageElement||R.b(lt.data)?Fe(lt):lt.data&&Fe({data:yield(ot=lt.data,typeof createImageBitmap=="function"?R.f(ot):R.h(ot)),cacheControl:lt.cacheControl,expires:lt.expires})}catch(lt){delete ve.abortController,Le(lt)}finally{Z--,de()}var ot})),de=()=>{const ve=(()=>{for(const qe of Object.keys(ie))if(ie[qe]())return!0;return!1})()?R.a.MAX_PARALLEL_IMAGE_REQUESTS_PER_FRAME:R.a.MAX_PARALLEL_IMAGE_REQUESTS;for(let qe=Z;qe<ve&&t.length>0;qe++){const Re=t.shift();Re.abortController.signal.aborted?qe--:ue(Re)}},ge=(ve,qe)=>new Promise(((Re,Le)=>{const Fe=new Image,Ve=ve.url,Xe=ve.credentials;Xe&&Xe==="include"?Fe.crossOrigin="use-credentials":(Xe&&Xe==="same-origin"||!R.d(Ve))&&(Fe.crossOrigin="anonymous"),qe.signal.addEventListener("abort",(()=>{Fe.src="",Le(R.c())})),Fe.fetchPriority="high",Fe.onload=()=>{Fe.onerror=Fe.onload=null,Re({data:Fe})},Fe.onerror=()=>{Fe.onerror=Fe.onload=null,qe.signal.aborted||Le(new Error("Could not load image. Please make sure to use a supported image type such as PNG or JPEG. Note that SVGs are not supported."))},Fe.src=Ve}))})(ke||(ke={})),ke.resetRequestQueue();class Be{constructor(t){this._transformRequestFn=t??null}transformRequest(t,Z){return this._transformRequestFn&&this._transformRequestFn(t,Z)||{url:t}}setTransformRequest(t){this._transformRequestFn=t}}function We(se){const t=[];if(typeof se=="string")t.push({id:"default",url:se});else if(se&&se.length>0){const Z=[];for(const{id:Q,url:ie}of se){const ue=`${Q}${ie}`;Z.indexOf(ue)===-1&&(Z.push(ue),t.push({id:Q,url:ie}))}}return t}function Je(se,t,Z){try{const Q=new URL(se);return Q.pathname+=`${t}${Z}`,Q.toString()}catch{throw new Error(`Invalid sprite URL "${se}", must be absolute. Modify style specification directly or use TransformStyleFunction to correct the issue dynamically`)}}function Ke(se){const{userImage:t}=se;return!!(t&&t.render&&t.render())&&(se.data.replace(new Uint8Array(t.data.buffer)),!0)}class et extends R.E{constructor(){super(),this.images={},this.updatedImages={},this.callbackDispatchedThisFrame={},this.loaded=!1,this.requestors=[],this.patterns={},this.atlasImage=new R.R({width:1,height:1}),this.dirty=!0}isLoaded(){return this.loaded}setLoaded(t){if(this.loaded!==t&&(this.loaded=t,t)){for(const{ids:Z,promiseResolve:Q}of this.requestors)Q(this._getImagesForIds(Z));this.requestors=[]}}getImage(t){const Z=this.images[t];if(Z&&!Z.data&&Z.spriteData){const Q=Z.spriteData;Z.data=new R.R({width:Q.width,height:Q.height},Q.context.getImageData(Q.x,Q.y,Q.width,Q.height).data),Z.spriteData=null}return Z}addImage(t,Z){if(this.images[t])throw new Error(`Image id ${t} already exist, use updateImage instead`);this._validate(t,Z)&&(this.images[t]=Z)}_validate(t,Z){let Q=!0;const ie=Z.data||Z.spriteData;return this._validateStretch(Z.stretchX,ie&&ie.width)||(this.fire(new R.k(new Error(`Image "${t}" has invalid "stretchX" value`))),Q=!1),this._validateStretch(Z.stretchY,ie&&ie.height)||(this.fire(new R.k(new Error(`Image "${t}" has invalid "stretchY" value`))),Q=!1),this._validateContent(Z.content,Z)||(this.fire(new R.k(new Error(`Image "${t}" has invalid "content" value`))),Q=!1),Q}_validateStretch(t,Z){if(!t)return!0;let Q=0;for(const ie of t){if(ie[0]<Q||ie[1]<ie[0]||Z<ie[1])return!1;Q=ie[1]}return!0}_validateContent(t,Z){if(!t)return!0;if(t.length!==4)return!1;const Q=Z.spriteData,ie=Q&&Q.width||Z.data.width,ue=Q&&Q.height||Z.data.height;return!(t[0]<0||ie<t[0]||t[1]<0||ue<t[1]||t[2]<0||ie<t[2]||t[3]<0||ue<t[3]||t[2]<t[0]||t[3]<t[1])}updateImage(t,Z,Q=!0){const ie=this.getImage(t);if(Q&&(ie.data.width!==Z.data.width||ie.data.height!==Z.data.height))throw new Error(`size mismatch between old image (${ie.data.width}x${ie.data.height}) and new image (${Z.data.width}x${Z.data.height}).`);Z.version=ie.version+1,this.images[t]=Z,this.updatedImages[t]=!0}removeImage(t){const Z=this.images[t];delete this.images[t],delete this.patterns[t],Z.userImage&&Z.userImage.onRemove&&Z.userImage.onRemove()}listImages(){return Object.keys(this.images)}getImages(t){return new Promise(((Z,Q)=>{let ie=!0;if(!this.isLoaded())for(const ue of t)this.images[ue]||(ie=!1);this.isLoaded()||ie?Z(this._getImagesForIds(t)):this.requestors.push({ids:t,promiseResolve:Z})}))}_getImagesForIds(t){const Z={};for(const Q of t){let ie=this.getImage(Q);ie||(this.fire(new R.l("styleimagemissing",{id:Q})),ie=this.getImage(Q)),ie?Z[Q]={data:ie.data.clone(),pixelRatio:ie.pixelRatio,sdf:ie.sdf,version:ie.version,stretchX:ie.stretchX,stretchY:ie.stretchY,content:ie.content,textFitWidth:ie.textFitWidth,textFitHeight:ie.textFitHeight,hasRenderCallback:!!(ie.userImage&&ie.userImage.render)}:R.w(`Image "${Q}" could not be loaded. Please make sure you have added the image with map.addImage() or a "sprite" property in your style. You can provide missing images by listening for the "styleimagemissing" map event.`)}return Z}getPixelSize(){const{width:t,height:Z}=this.atlasImage;return{width:t,height:Z}}getPattern(t){const Z=this.patterns[t],Q=this.getImage(t);if(!Q)return null;if(Z&&Z.position.version===Q.version)return Z.position;if(Z)Z.position.version=Q.version;else{const ie={w:Q.data.width+2,h:Q.data.height+2,x:0,y:0},ue=new R.I(ie,Q);this.patterns[t]={bin:ie,position:ue}}return this._updatePatternAtlas(),this.patterns[t].position}bind(t){const Z=t.gl;this.atlasTexture?this.dirty&&(this.atlasTexture.update(this.atlasImage),this.dirty=!1):this.atlasTexture=new R.T(t,this.atlasImage,Z.RGBA),this.atlasTexture.bind(Z.LINEAR,Z.CLAMP_TO_EDGE)}_updatePatternAtlas(){const t=[];for(const ue in this.patterns)t.push(this.patterns[ue].bin);const{w:Z,h:Q}=R.p(t),ie=this.atlasImage;ie.resize({width:Z||1,height:Q||1});for(const ue in this.patterns){const{bin:de}=this.patterns[ue],ge=de.x+1,ve=de.y+1,qe=this.getImage(ue).data,Re=qe.width,Le=qe.height;R.R.copy(qe,ie,{x:0,y:0},{x:ge,y:ve},{width:Re,height:Le}),R.R.copy(qe,ie,{x:0,y:Le-1},{x:ge,y:ve-1},{width:Re,height:1}),R.R.copy(qe,ie,{x:0,y:0},{x:ge,y:ve+Le},{width:Re,height:1}),R.R.copy(qe,ie,{x:Re-1,y:0},{x:ge-1,y:ve},{width:1,height:Le}),R.R.copy(qe,ie,{x:0,y:0},{x:ge+Re,y:ve},{width:1,height:Le})}this.dirty=!0}beginFrame(){this.callbackDispatchedThisFrame={}}dispatchRenderCallbacks(t){for(const Z of t){if(this.callbackDispatchedThisFrame[Z])continue;this.callbackDispatchedThisFrame[Z]=!0;const Q=this.getImage(Z);Q||R.w(`Image with ID: "${Z}" was not found`),Ke(Q)&&this.updateImage(Z,Q)}}}const it=1e20;function nt(se,t,Z,Q,ie,ue,de,ge,ve){for(let qe=t;qe<t+Q;qe++)ct(se,Z*ue+qe,ue,ie,de,ge,ve);for(let qe=Z;qe<Z+ie;qe++)ct(se,qe*ue+t,1,Q,de,ge,ve)}function ct(se,t,Z,Q,ie,ue,de){ue[0]=0,de[0]=-it,de[1]=it,ie[0]=se[t];for(let ge=1,ve=0,qe=0;ge<Q;ge++){ie[ge]=se[t+ge*Z];const Re=ge*ge;do{const Le=ue[ve];qe=(ie[ge]-ie[Le]+Re-Le*Le)/(ge-Le)/2}while(qe<=de[ve]&&--ve>-1);ve++,ue[ve]=ge,de[ve]=qe,de[ve+1]=it}for(let ge=0,ve=0;ge<Q;ge++){for(;de[ve+1]<ge;)ve++;const qe=ue[ve],Re=ge-qe;se[t+ge*Z]=ie[qe]+Re*Re}}class ft{constructor(t,Z,Q){this.requestManager=t,this.localIdeographFontFamily=Z,this.entries={},this.lang=Q}setURL(t){this.url=t}getGlyphs(t){return R._(this,void 0,void 0,(function*(){const Z=[];for(const ue in t)for(const de of t[ue])Z.push(this._getAndCacheGlyphsPromise(ue,de));const Q=yield Promise.all(Z),ie={};for(const{stack:ue,id:de,glyph:ge}of Q)ie[ue]||(ie[ue]={}),ie[ue][de]=ge&&{id:ge.id,bitmap:ge.bitmap.clone(),metrics:ge.metrics};return ie}))}_getAndCacheGlyphsPromise(t,Z){return R._(this,void 0,void 0,(function*(){let Q=this.entries[t];Q||(Q=this.entries[t]={glyphs:{},requests:{},ranges:{}});let ie=Q.glyphs[Z];if(ie!==void 0)return{stack:t,id:Z,glyph:ie};if(ie=this._tinySDF(Q,t,Z),ie)return Q.glyphs[Z]=ie,{stack:t,id:Z,glyph:ie};const ue=Math.floor(Z/256);if(256*ue>65535)throw new Error("glyphs > 65535 not supported");if(Q.ranges[ue])return{stack:t,id:Z,glyph:ie};if(!this.url)throw new Error("glyphsUrl is not set");if(!Q.requests[ue]){const ge=ft.loadGlyphRange(t,ue,this.url,this.requestManager);Q.requests[ue]=ge}const de=yield Q.requests[ue];for(const ge in de)this._doesCharSupportLocalGlyph(+ge)||(Q.glyphs[+ge]=de[+ge]);return Q.ranges[ue]=!0,{stack:t,id:Z,glyph:de[Z]||null}}))}_doesCharSupportLocalGlyph(t){return!!this.localIdeographFontFamily&&(new RegExp("\\p{Ideo}|\\p{sc=Hang}|\\p{sc=Hira}|\\p{sc=Kana}","u").test(String.fromCodePoint(t))||R.u["CJK Unified Ideographs"](t)||R.u["Hangul Syllables"](t)||R.u.Hiragana(t)||R.u.Katakana(t)||R.u["CJK Symbols and Punctuation"](t)||R.u["Halfwidth and Fullwidth Forms"](t))}_tinySDF(t,Z,Q){const ie=this.localIdeographFontFamily;if(!ie||!this._doesCharSupportLocalGlyph(Q))return;let ue=t.tinySDF;if(!ue){let ge="400";/bold/i.test(Z)?ge="900":/medium/i.test(Z)?ge="500":/light/i.test(Z)&&(ge="200"),ue=t.tinySDF=new ft.TinySDF({fontSize:48,buffer:6,radius:16,cutoff:.25,lang:this.lang,fontFamily:ie,fontWeight:ge})}const de=ue.draw(String.fromCharCode(Q));return{id:Q,bitmap:new R.q({width:de.width||60,height:de.height||60},de.data),metrics:{width:de.glyphWidth/2||24,height:de.glyphHeight/2||24,left:de.glyphLeft/2+.5||0,top:de.glyphTop/2-27.5||-8,advance:de.glyphAdvance/2||24,isDoubleResolution:!0}}}}ft.loadGlyphRange=function(se,t,Z,Q){return R._(this,void 0,void 0,(function*(){const ie=256*t,ue=ie+255,de=Q.transformRequest(Z.replace("{fontstack}",se).replace("{range}",`${ie}-${ue}`),"Glyphs"),ge=yield R.n(de,new AbortController);if(!ge||!ge.data)throw new Error(`Could not load glyph range. range: ${t}, ${ie}-${ue}`);const ve={};for(const qe of R.o(ge.data))ve[qe.id]=qe;return ve}))},ft.TinySDF=class{constructor({fontSize:se=24,buffer:t=3,radius:Z=8,cutoff:Q=.25,fontFamily:ie="sans-serif",fontWeight:ue="normal",fontStyle:de="normal",lang:ge=null}={}){this.buffer=t,this.cutoff=Q,this.radius=Z,this.lang=ge;const ve=this.size=se+4*t,qe=this._createCanvas(ve),Re=this.ctx=qe.getContext("2d",{willReadFrequently:!0});Re.font=`${de} ${ue} ${se}px ${ie}`,Re.textBaseline="alphabetic",Re.textAlign="left",Re.fillStyle="black",this.gridOuter=new Float64Array(ve*ve),this.gridInner=new Float64Array(ve*ve),this.f=new Float64Array(ve),this.z=new Float64Array(ve+1),this.v=new Uint16Array(ve)}_createCanvas(se){const t=document.createElement("canvas");return t.width=t.height=se,t}draw(se){const{width:t,actualBoundingBoxAscent:Z,actualBoundingBoxDescent:Q,actualBoundingBoxLeft:ie,actualBoundingBoxRight:ue}=this.ctx.measureText(se),de=Math.ceil(Z),ge=Math.max(0,Math.min(this.size-this.buffer,Math.ceil(ue-ie))),ve=Math.min(this.size-this.buffer,de+Math.ceil(Q)),qe=ge+2*this.buffer,Re=ve+2*this.buffer,Le=Math.max(qe*Re,0),Fe=new Uint8ClampedArray(Le),Ve={data:Fe,width:qe,height:Re,glyphWidth:ge,glyphHeight:ve,glyphTop:de,glyphLeft:0,glyphAdvance:t};if(ge===0||ve===0)return Ve;const{ctx:Xe,buffer:at,gridInner:ot,gridOuter:lt}=this;this.lang&&(Xe.lang=this.lang),Xe.clearRect(at,at,ge,ve),Xe.fillText(se,at,at+de);const pt=Xe.getImageData(at,at,ge,ve);lt.fill(it,0,Le),ot.fill(0,0,Le);for(let yt=0;yt<ve;yt++)for(let mt=0;mt<ge;mt++){const xt=pt.data[4*(yt*ge+mt)+3]/255;if(xt===0)continue;const It=(yt+at)*qe+mt+at;if(xt===1)lt[It]=0,ot[It]=it;else{const gt=.5-xt;lt[It]=gt>0?gt*gt:0,ot[It]=gt<0?gt*gt:0}}nt(lt,0,0,qe,Re,qe,this.f,this.v,this.z),nt(ot,at,at,ge,ve,qe,this.f,this.v,this.z);for(let yt=0;yt<Le;yt++){const mt=Math.sqrt(lt[yt])-Math.sqrt(ot[yt]);Fe[yt]=Math.round(255-255*(mt/this.radius+this.cutoff))}return Ve}};class _t{constructor(){this.specification=R.v.light.position}possiblyEvaluate(t,Z){return R.B(t.expression.evaluate(Z))}interpolate(t,Z,Q){return{x:R.C.number(t.x,Z.x,Q),y:R.C.number(t.y,Z.y,Q),z:R.C.number(t.z,Z.z,Q)}}}let Rt;class Ft extends R.E{constructor(t){super(),Rt=Rt||new R.r({anchor:new R.D(R.v.light.anchor),position:new _t,color:new R.D(R.v.light.color),intensity:new R.D(R.v.light.intensity)}),this._transitionable=new R.t(Rt,void 0),this.setLight(t),this._transitioning=this._transitionable.untransitioned()}getLight(){return this._transitionable.serialize()}setLight(t,Z={}){if(!this._validate(R.x,t,Z))for(const Q in t){const ie=t[Q];Q.endsWith("-transition")?this._transitionable.setTransition(Q.slice(0,-11),ie):this._transitionable.setValue(Q,ie)}}updateTransitions(t){this._transitioning=this._transitionable.transitioned(t,this._transitioning)}hasTransition(){return this._transitioning.hasTransition()}recalculate(t){this.properties=this._transitioning.possiblyEvaluate(t)}_validate(t,Z,Q){return(!Q||Q.validate!==!1)&&R.y(this,t.call(R.z,{value:Z,style:{glyphs:!0,sprite:!0},styleSpec:R.v}))}}const ht=new R.r({"sky-color":new R.D(R.v.sky["sky-color"]),"horizon-color":new R.D(R.v.sky["horizon-color"]),"fog-color":new R.D(R.v.sky["fog-color"]),"fog-ground-blend":new R.D(R.v.sky["fog-ground-blend"]),"horizon-fog-blend":new R.D(R.v.sky["horizon-fog-blend"]),"sky-horizon-blend":new R.D(R.v.sky["sky-horizon-blend"]),"atmosphere-blend":new R.D(R.v.sky["atmosphere-blend"])});class St extends R.E{constructor(t){super(),this._transitionable=new R.t(ht,void 0),this.setSky(t),this._transitioning=this._transitionable.untransitioned(),this.recalculate(new R.F(0))}setSky(t,Z={}){if(!this._validate(R.G,t,Z)){t||(t={"sky-color":"transparent","horizon-color":"transparent","fog-color":"transparent","fog-ground-blend":1,"atmosphere-blend":0});for(const Q in t){const ie=t[Q];Q.endsWith("-transition")?this._transitionable.setTransition(Q.slice(0,-11),ie):this._transitionable.setValue(Q,ie)}}}getSky(){return this._transitionable.serialize()}updateTransitions(t){this._transitioning=this._transitionable.transitioned(t,this._transitioning)}hasTransition(){return this._transitioning.hasTransition()}recalculate(t){this.properties=this._transitioning.possiblyEvaluate(t)}_validate(t,Z,Q={}){return(Q==null?void 0:Q.validate)!==!1&&R.y(this,t.call(R.z,R.e({value:Z,style:{glyphs:!0,sprite:!0},styleSpec:R.v})))}calculateFogBlendOpacity(t){return t<60?0:t<70?(t-60)/10:1}}class ut{constructor(t,Z){this.width=t,this.height=Z,this.nextRow=0,this.data=new Uint8Array(this.width*this.height),this.dashEntry={}}getDash(t,Z){const Q=t.join(",")+String(Z);return this.dashEntry[Q]||(this.dashEntry[Q]=this.addDash(t,Z)),this.dashEntry[Q]}getDashRanges(t,Z,Q){const ie=[];let ue=t.length%2==1?-t[t.length-1]*Q:0,de=t[0]*Q,ge=!0;ie.push({left:ue,right:de,isDash:ge,zeroLength:t[0]===0});let ve=t[0];for(let qe=1;qe<t.length;qe++){ge=!ge;const Re=t[qe];ue=ve*Q,ve+=Re,de=ve*Q,ie.push({left:ue,right:de,isDash:ge,zeroLength:Re===0})}return ie}addRoundDash(t,Z,Q){const ie=Z/2;for(let ue=-Q;ue<=Q;ue++){const de=this.width*(this.nextRow+Q+ue);let ge=0,ve=t[ge];for(let qe=0;qe<this.width;qe++){qe/ve.right>1&&(ve=t[++ge]);const Re=Math.abs(qe-ve.left),Le=Math.abs(qe-ve.right),Fe=Math.min(Re,Le);let Ve;const Xe=ue/Q*(ie+1);if(ve.isDash){const at=ie-Math.abs(Xe);Ve=Math.sqrt(Fe*Fe+at*at)}else Ve=ie-Math.sqrt(Fe*Fe+Xe*Xe);this.data[de+qe]=Math.max(0,Math.min(255,Ve+128))}}}addRegularDash(t){for(let ge=t.length-1;ge>=0;--ge){const ve=t[ge],qe=t[ge+1];ve.zeroLength?t.splice(ge,1):qe&&qe.isDash===ve.isDash&&(qe.left=ve.left,t.splice(ge,1))}const Z=t[0],Q=t[t.length-1];Z.isDash===Q.isDash&&(Z.left=Q.left-this.width,Q.right=Z.right+this.width);const ie=this.width*this.nextRow;let ue=0,de=t[ue];for(let ge=0;ge<this.width;ge++){ge/de.right>1&&(de=t[++ue]);const ve=Math.abs(ge-de.left),qe=Math.abs(ge-de.right),Re=Math.min(ve,qe);this.data[ie+ge]=Math.max(0,Math.min(255,(de.isDash?Re:-Re)+128))}}addDash(t,Z){const Q=Z?7:0,ie=2*Q+1;if(this.nextRow+ie>this.height)return R.w("LineAtlas out of space"),null;let ue=0;for(let ge=0;ge<t.length;ge++)ue+=t[ge];if(ue!==0){const ge=this.width/ue,ve=this.getDashRanges(t,this.width,ge);Z?this.addRoundDash(ve,ge,Q):this.addRegularDash(ve)}const de={y:this.nextRow+Q,height:2*Q,width:ue};return this.nextRow+=ie,this.dirty=!0,de}bind(t){const Z=t.gl;this.texture?(Z.bindTexture(Z.TEXTURE_2D,this.texture),this.dirty&&(this.dirty=!1,Z.texSubImage2D(Z.TEXTURE_2D,0,0,0,this.width,this.height,Z.ALPHA,Z.UNSIGNED_BYTE,this.data))):(this.texture=Z.createTexture(),Z.bindTexture(Z.TEXTURE_2D,this.texture),Z.texParameteri(Z.TEXTURE_2D,Z.TEXTURE_WRAP_S,Z.REPEAT),Z.texParameteri(Z.TEXTURE_2D,Z.TEXTURE_WRAP_T,Z.REPEAT),Z.texParameteri(Z.TEXTURE_2D,Z.TEXTURE_MIN_FILTER,Z.LINEAR),Z.texParameteri(Z.TEXTURE_2D,Z.TEXTURE_MAG_FILTER,Z.LINEAR),Z.texImage2D(Z.TEXTURE_2D,0,Z.ALPHA,this.width,this.height,0,Z.ALPHA,Z.UNSIGNED_BYTE,this.data))}}const Et="maplibre_preloaded_worker_pool";class bt{constructor(){this.active={}}acquire(t){if(!this.workers)for(this.workers=[];this.workers.length<bt.workerCount;)this.workers.push(new Worker(R.a.WORKER_URL));return this.active[t]=!0,this.workers.slice()}release(t){delete this.active[t],this.numActive()===0&&(this.workers.forEach((Z=>{Z.terminate()})),this.workers=null)}isPreloaded(){return!!this.active[Et]}numActive(){return Object.keys(this.active).length}}const Dt=Math.floor(_e.hardwareConcurrency/2);let Ut,er;function xr(){return Ut||(Ut=new bt),Ut}bt.workerCount=R.H(globalThis)?Math.max(Math.min(Dt,3),1):1;class ur{constructor(t,Z){this.workerPool=t,this.actors=[],this.currentActor=0,this.id=Z;const Q=this.workerPool.acquire(Z);for(let ie=0;ie<Q.length;ie++){const ue=new R.J(Q[ie],Z);ue.name=`Worker ${ie}`,this.actors.push(ue)}if(!this.actors.length)throw new Error("No actors found")}broadcast(t,Z){const Q=[];for(const ie of this.actors)Q.push(ie.sendAsync({type:t,data:Z}));return Promise.all(Q)}getActor(){return this.currentActor=(this.currentActor+1)%this.actors.length,this.actors[this.currentActor]}remove(t=!0){this.actors.forEach((Z=>{Z.remove()})),this.actors=[],t&&this.workerPool.release(this.id)}registerMessageHandler(t,Z){for(const Q of this.actors)Q.registerMessageHandler(t,Z)}}function yr(){return er||(er=new ur(xr(),R.K),er.registerMessageHandler("GR",((se,t,Z)=>R.m(t,Z)))),er}function Wt(se,t){const Z=R.L();return R.M(Z,Z,[1,1,0]),R.N(Z,Z,[.5*se.width,.5*se.height,1]),se.calculatePosMatrix?R.O(Z,Z,se.calculatePosMatrix(t.toUnwrapped())):Z}function or(se,t,Z,Q,ie,ue,de){var ge;const ve=(function(Fe,Ve,Xe){if(Fe)for(const at of Fe){const ot=Ve[at];if(ot&&ot.source===Xe&&ot.type==="fill-extrusion")return!0}else for(const at in Ve){const ot=Ve[at];if(ot.source===Xe&&ot.type==="fill-extrusion")return!0}return!1})((ge=ie==null?void 0:ie.layers)!==null&&ge!==void 0?ge:null,t,se.id),qe=ue.maxPitchScaleFactor(),Re=se.tilesIn(Q,qe,ve);Re.sort(wr);const Le=[];for(const Fe of Re)Le.push({wrappedTileID:Fe.tileID.wrapped().key,queryResults:Fe.tile.queryRenderedFeatures(t,Z,se._state,Fe.queryGeometry,Fe.cameraQueryGeometry,Fe.scale,ie,ue,qe,Wt(se.transform,Fe.tileID),de?(Ve,Xe)=>de(Fe.tileID,Ve,Xe):void 0)});return(function(Fe,Ve){for(const Xe in Fe)for(const at of Fe[Xe])Ir(at,Ve);return Fe})((function(Fe){const Ve={},Xe={};for(const at of Fe){const ot=at.queryResults,lt=at.wrappedTileID,pt=Xe[lt]=Xe[lt]||{};for(const yt in ot){const mt=ot[yt],xt=pt[yt]=pt[yt]||{},It=Ve[yt]=Ve[yt]||[];for(const gt of mt)xt[gt.featureIndex]||(xt[gt.featureIndex]=!0,It.push(gt))}}return Ve})(Le),se)}function wr(se,t){const Z=se.tileID,Q=t.tileID;return Z.overscaledZ-Q.overscaledZ||Z.canonical.y-Q.canonical.y||Z.wrap-Q.wrap||Z.canonical.x-Q.canonical.x}function Ir(se,t){const Z=se.feature,Q=t.getFeatureState(Z.layer["source-layer"],Z.id);Z.source=Z.layer.source,Z.layer["source-layer"]&&(Z.sourceLayer=Z.layer["source-layer"]),Z.state=Q}function br(se,t,Z){return R._(this,void 0,void 0,(function*(){let Q=se;if(se.url?Q=(yield R.j(t.transformRequest(se.url,"Source"),Z)).data:yield _e.frameAsync(Z),!Q)return null;const ie=R.Q(R.e(Q,se),["tiles","minzoom","maxzoom","attribution","bounds","scheme","tileSize","encoding"]);return"vector_layers"in Q&&Q.vector_layers&&(ie.vectorLayerIds=Q.vector_layers.map((ue=>ue.id))),ie}))}class gr{constructor(t,Z){t&&(Z?this.setSouthWest(t).setNorthEast(Z):Array.isArray(t)&&(t.length===4?this.setSouthWest([t[0],t[1]]).setNorthEast([t[2],t[3]]):this.setSouthWest(t[0]).setNorthEast(t[1])))}setNorthEast(t){return this._ne=t instanceof R.S?new R.S(t.lng,t.lat):R.S.convert(t),this}setSouthWest(t){return this._sw=t instanceof R.S?new R.S(t.lng,t.lat):R.S.convert(t),this}extend(t){const Z=this._sw,Q=this._ne;let ie,ue;if(t instanceof R.S)ie=t,ue=t;else{if(!(t instanceof gr))return Array.isArray(t)?t.length===4||t.every(Array.isArray)?this.extend(gr.convert(t)):this.extend(R.S.convert(t)):t&&("lng"in t||"lon"in t)&&"lat"in t?this.extend(R.S.convert(t)):this;if(ie=t._sw,ue=t._ne,!ie||!ue)return this}return Z||Q?(Z.lng=Math.min(ie.lng,Z.lng),Z.lat=Math.min(ie.lat,Z.lat),Q.lng=Math.max(ue.lng,Q.lng),Q.lat=Math.max(ue.lat,Q.lat)):(this._sw=new R.S(ie.lng,ie.lat),this._ne=new R.S(ue.lng,ue.lat)),this}getCenter(){return new R.S((this._sw.lng+this._ne.lng)/2,(this._sw.lat+this._ne.lat)/2)}getSouthWest(){return this._sw}getNorthEast(){return this._ne}getNorthWest(){return new R.S(this.getWest(),this.getNorth())}getSouthEast(){return new R.S(this.getEast(),this.getSouth())}getWest(){return this._sw.lng}getSouth(){return this._sw.lat}getEast(){return this._ne.lng}getNorth(){return this._ne.lat}toArray(){return[this._sw.toArray(),this._ne.toArray()]}toString(){return`LngLatBounds(${this._sw.toString()}, ${this._ne.toString()})`}isEmpty(){return!(this._sw&&this._ne)}contains(t){const{lng:Z,lat:Q}=R.S.convert(t);let ie=this._sw.lng<=Z&&Z<=this._ne.lng;return this._sw.lng>this._ne.lng&&(ie=this._sw.lng>=Z&&Z>=this._ne.lng),this._sw.lat<=Q&&Q<=this._ne.lat&&ie}static convert(t){return t instanceof gr?t:t&&new gr(t)}static fromLngLat(t,Z=0){const Q=360*Z/40075017,ie=Q/Math.cos(Math.PI/180*t.lat);return new gr(new R.S(t.lng-ie,t.lat-Q),new R.S(t.lng+ie,t.lat+Q))}adjustAntiMeridian(){const t=new R.S(this._sw.lng,this._sw.lat),Z=new R.S(this._ne.lng,this._ne.lat);return new gr(t,t.lng>Z.lng?new R.S(Z.lng+360,Z.lat):Z)}}class Mr{constructor(t,Z,Q){this.bounds=gr.convert(this.validateBounds(t)),this.minzoom=Z||0,this.maxzoom=Q||24}validateBounds(t){return Array.isArray(t)&&t.length===4?[Math.max(-180,t[0]),Math.max(-90,t[1]),Math.min(180,t[2]),Math.min(90,t[3])]:[-180,-90,180,90]}contains(t){const Z=Math.pow(2,t.z),Q=Math.floor(R.V(this.bounds.getWest())*Z),ie=Math.floor(R.U(this.bounds.getNorth())*Z),ue=Math.ceil(R.V(this.bounds.getEast())*Z),de=Math.ceil(R.U(this.bounds.getSouth())*Z);return t.x>=Q&&t.x<ue&&t.y>=ie&&t.y<de}}class Hr extends R.E{constructor(t,Z,Q,ie){if(super(),this.id=t,this.dispatcher=Q,this.type="vector",this.minzoom=0,this.maxzoom=22,this.scheme="xyz",this.tileSize=512,this.reparseOverscaled=!0,this.isTileClipped=!0,this._loaded=!1,R.e(this,R.Q(Z,["url","scheme","tileSize","promoteId"])),this._options=R.e({type:"vector"},Z),this._collectResourceTiming=Z.collectResourceTiming,this.tileSize!==512)throw new Error("vector tile sources must have a tileSize of 512");this.setEventedParent(ie)}load(){return R._(this,void 0,void 0,(function*(){this._loaded=!1,this.fire(new R.l("dataloading",{dataType:"source"})),this._tileJSONRequest=new AbortController;try{const t=yield br(this._options,this.map._requestManager,this._tileJSONRequest);this._tileJSONRequest=null,this._loaded=!0,this.map.style.sourceCaches[this.id].clearTiles(),t&&(R.e(this,t),t.bounds&&(this.tileBounds=new Mr(t.bounds,this.minzoom,this.maxzoom)),this.fire(new R.l("data",{dataType:"source",sourceDataType:"metadata"})),this.fire(new R.l("data",{dataType:"source",sourceDataType:"content"})))}catch(t){this._tileJSONRequest=null,this._loaded=!0,this.fire(new R.k(t))}}))}loaded(){return this._loaded}hasTile(t){return!this.tileBounds||this.tileBounds.contains(t.canonical)}onAdd(t){this.map=t,this.load()}setSourceProperty(t){this._tileJSONRequest&&this._tileJSONRequest.abort(),t(),this.load()}setTiles(t){return this.setSourceProperty((()=>{this._options.tiles=t})),this}setUrl(t){return this.setSourceProperty((()=>{this.url=t,this._options.url=t})),this}onRemove(){this._tileJSONRequest&&(this._tileJSONRequest.abort(),this._tileJSONRequest=null)}serialize(){return R.e({},this._options)}loadTile(t){return R._(this,void 0,void 0,(function*(){const Z=t.tileID.canonical.url(this.tiles,this.map.getPixelRatio(),this.scheme),Q={request:this.map._requestManager.transformRequest(Z,"Tile"),uid:t.uid,tileID:t.tileID,zoom:t.tileID.overscaledZ,tileSize:this.tileSize*t.tileID.overscaleFactor(),type:this.type,source:this.id,pixelRatio:this.map.getPixelRatio(),showCollisionBoxes:this.map.showCollisionBoxes,promoteId:this.promoteId,subdivisionGranularity:this.map.style.projection.subdivisionGranularity};Q.request.collectResourceTiming=this._collectResourceTiming;let ie="RT";if(t.actor&&t.state!=="expired"){if(t.state==="loading")return new Promise(((ue,de)=>{t.reloadPromise={resolve:ue,reject:de}}))}else t.actor=this.dispatcher.getActor(),ie="LT";t.abortController=new AbortController;try{const ue=yield t.actor.sendAsync({type:ie,data:Q},t.abortController);if(delete t.abortController,t.aborted)return;this._afterTileLoadWorkerResponse(t,ue)}catch(ue){if(delete t.abortController,t.aborted)return;if(ue&&ue.status!==404)throw ue;this._afterTileLoadWorkerResponse(t,null)}}))}_afterTileLoadWorkerResponse(t,Z){if(Z&&Z.resourceTiming&&(t.resourceTiming=Z.resourceTiming),Z&&this.map._refreshExpiredTiles&&t.setExpiryData(Z),t.loadVectorData(Z,this.map.painter),t.reloadPromise){const Q=t.reloadPromise;t.reloadPromise=null,this.loadTile(t).then(Q.resolve).catch(Q.reject)}}abortTile(t){return R._(this,void 0,void 0,(function*(){t.abortController&&(t.abortController.abort(),delete t.abortController),t.actor&&(yield t.actor.sendAsync({type:"AT",data:{uid:t.uid,type:this.type,source:this.id}}))}))}unloadTile(t){return R._(this,void 0,void 0,(function*(){t.unloadVectorData(),t.actor&&(yield t.actor.sendAsync({type:"RMT",data:{uid:t.uid,type:this.type,source:this.id}}))}))}hasTransition(){return!1}}class jr extends R.E{constructor(t,Z,Q,ie){super(),this.id=t,this.dispatcher=Q,this.setEventedParent(ie),this.type="raster",this.minzoom=0,this.maxzoom=22,this.roundZoom=!0,this.scheme="xyz",this.tileSize=512,this._loaded=!1,this._options=R.e({type:"raster"},Z),R.e(this,R.Q(Z,["url","scheme","tileSize"]))}load(){return R._(this,arguments,void 0,(function*(t=!1){this._loaded=!1,this.fire(new R.l("dataloading",{dataType:"source"})),this._tileJSONRequest=new AbortController;try{const Z=yield br(this._options,this.map._requestManager,this._tileJSONRequest);this._tileJSONRequest=null,this._loaded=!0,Z&&(R.e(this,Z),Z.bounds&&(this.tileBounds=new Mr(Z.bounds,this.minzoom,this.maxzoom)),this.fire(new R.l("data",{dataType:"source",sourceDataType:"metadata"})),this.fire(new R.l("data",{dataType:"source",sourceDataType:"content",sourceDataChanged:t})))}catch(Z){this._tileJSONRequest=null,this._loaded=!0,this.fire(new R.k(Z))}}))}loaded(){return this._loaded}onAdd(t){this.map=t,this.load()}onRemove(){this._tileJSONRequest&&(this._tileJSONRequest.abort(),this._tileJSONRequest=null)}setSourceProperty(t){this._tileJSONRequest&&(this._tileJSONRequest.abort(),this._tileJSONRequest=null),t(),this.load(!0)}setTiles(t){return this.setSourceProperty((()=>{this._options.tiles=t})),this}setUrl(t){return this.setSourceProperty((()=>{this.url=t,this._options.url=t})),this}serialize(){return R.e({},this._options)}hasTile(t){return!this.tileBounds||this.tileBounds.contains(t.canonical)}loadTile(t){return R._(this,void 0,void 0,(function*(){const Z=t.tileID.canonical.url(this.tiles,this.map.getPixelRatio(),this.scheme);t.abortController=new AbortController;try{const Q=yield ke.getImage(this.map._requestManager.transformRequest(Z,"Tile"),t.abortController,this.map._refreshExpiredTiles);if(delete t.abortController,t.aborted)return void(t.state="unloaded");if(Q&&Q.data){this.map._refreshExpiredTiles&&(Q.cacheControl||Q.expires)&&t.setExpiryData({cacheControl:Q.cacheControl,expires:Q.expires});const ie=this.map.painter.context,ue=ie.gl,de=Q.data;t.texture=this.map.painter.getTileTexture(de.width),t.texture?t.texture.update(de,{useMipmap:!0}):(t.texture=new R.T(ie,de,ue.RGBA,{useMipmap:!0}),t.texture.bind(ue.LINEAR,ue.CLAMP_TO_EDGE,ue.LINEAR_MIPMAP_NEAREST)),t.state="loaded"}}catch(Q){if(delete t.abortController,t.aborted)t.state="unloaded";else if(Q)throw t.state="errored",Q}}))}abortTile(t){return R._(this,void 0,void 0,(function*(){t.abortController&&(t.abortController.abort(),delete t.abortController)}))}unloadTile(t){return R._(this,void 0,void 0,(function*(){t.texture&&this.map.painter.saveTileTexture(t.texture)}))}hasTransition(){return!1}}class Sr extends jr{constructor(t,Z,Q,ie){super(t,Z,Q,ie),this.type="raster-dem",this.maxzoom=22,this._options=R.e({type:"raster-dem"},Z),this.encoding=Z.encoding||"mapbox",this.redFactor=Z.redFactor,this.greenFactor=Z.greenFactor,this.blueFactor=Z.blueFactor,this.baseShift=Z.baseShift}loadTile(t){return R._(this,void 0,void 0,(function*(){const Z=t.tileID.canonical.url(this.tiles,this.map.getPixelRatio(),this.scheme),Q=this.map._requestManager.transformRequest(Z,"Tile");t.neighboringTiles=this._getNeighboringTiles(t.tileID),t.abortController=new AbortController;try{const ie=yield ke.getImage(Q,t.abortController,this.map._refreshExpiredTiles);if(delete t.abortController,t.aborted)return void(t.state="unloaded");if(ie&&ie.data){const ue=ie.data;this.map._refreshExpiredTiles&&(ie.cacheControl||ie.expires)&&t.setExpiryData({cacheControl:ie.cacheControl,expires:ie.expires});const de=R.b(ue)&&R.W()?ue:yield this.readImageNow(ue),ge={type:this.type,uid:t.uid,source:this.id,rawImageData:de,encoding:this.encoding,redFactor:this.redFactor,greenFactor:this.greenFactor,blueFactor:this.blueFactor,baseShift:this.baseShift};if(!t.actor||t.state==="expired"){t.actor=this.dispatcher.getActor();const ve=yield t.actor.sendAsync({type:"LDT",data:ge});t.dem=ve,t.needsHillshadePrepare=!0,t.needsTerrainPrepare=!0,t.state="loaded"}}}catch(ie){if(delete t.abortController,t.aborted)t.state="unloaded";else if(ie)throw t.state="errored",ie}}))}readImageNow(t){return R._(this,void 0,void 0,(function*(){if(typeof VideoFrame<"u"&&R.X()){const Z=t.width+2,Q=t.height+2;try{return new R.R({width:Z,height:Q},yield R.Y(t,-1,-1,Z,Q))}catch{}}return _e.getImageData(t,1)}))}_getNeighboringTiles(t){const Z=t.canonical,Q=Math.pow(2,Z.z),ie=(Z.x-1+Q)%Q,ue=Z.x===0?t.wrap-1:t.wrap,de=(Z.x+1+Q)%Q,ge=Z.x+1===Q?t.wrap+1:t.wrap,ve={};return ve[new R.Z(t.overscaledZ,ue,Z.z,ie,Z.y).key]={backfilled:!1},ve[new R.Z(t.overscaledZ,ge,Z.z,de,Z.y).key]={backfilled:!1},Z.y>0&&(ve[new R.Z(t.overscaledZ,ue,Z.z,ie,Z.y-1).key]={backfilled:!1},ve[new R.Z(t.overscaledZ,t.wrap,Z.z,Z.x,Z.y-1).key]={backfilled:!1},ve[new R.Z(t.overscaledZ,ge,Z.z,de,Z.y-1).key]={backfilled:!1}),Z.y+1<Q&&(ve[new R.Z(t.overscaledZ,ue,Z.z,ie,Z.y+1).key]={backfilled:!1},ve[new R.Z(t.overscaledZ,t.wrap,Z.z,Z.x,Z.y+1).key]={backfilled:!1},ve[new R.Z(t.overscaledZ,ge,Z.z,de,Z.y+1).key]={backfilled:!1}),ve}unloadTile(t){return R._(this,void 0,void 0,(function*(){t.demTexture&&this.map.painter.saveTileTexture(t.demTexture),t.fbo&&(t.fbo.destroy(),delete t.fbo),t.dem&&delete t.dem,delete t.neighboringTiles,t.state="unloaded",t.actor&&(yield t.actor.sendAsync({type:"RDT",data:{type:this.type,uid:t.uid,source:this.id}}))}))}}class Nr extends R.E{constructor(t,Z,Q,ie){super(),this.id=t,this.type="geojson",this.minzoom=0,this.maxzoom=18,this.tileSize=512,this.isTileClipped=!0,this.reparseOverscaled=!0,this._removed=!1,this._isUpdatingWorker=!1,this._pendingWorkerUpdate={data:Z.data},this.actor=Q.getActor(),this.setEventedParent(ie),this._data=Z.data,this._options=R.e({},Z),this._collectResourceTiming=Z.collectResourceTiming,Z.maxzoom!==void 0&&(this.maxzoom=Z.maxzoom),Z.type&&(this.type=Z.type),Z.attribution&&(this.attribution=Z.attribution),this.promoteId=Z.promoteId,Z.clusterMaxZoom!==void 0&&this.maxzoom<=Z.clusterMaxZoom&&R.w(`The maxzoom value "${this.maxzoom}" is expected to be greater than the clusterMaxZoom value "${Z.clusterMaxZoom}".`),this.workerOptions=R.e({source:this.id,cluster:Z.cluster||!1,geojsonVtOptions:{buffer:this._pixelsToTileUnits(Z.buffer!==void 0?Z.buffer:128),tolerance:this._pixelsToTileUnits(Z.tolerance!==void 0?Z.tolerance:.375),extent:R.$,maxZoom:this.maxzoom,lineMetrics:Z.lineMetrics||!1,generateId:Z.generateId||!1},superclusterOptions:{maxZoom:this._getClusterMaxZoom(Z.clusterMaxZoom),minPoints:Math.max(2,Z.clusterMinPoints||2),extent:R.$,radius:this._pixelsToTileUnits(Z.clusterRadius||50),log:!1,generateId:Z.generateId||!1},clusterProperties:Z.clusterProperties,filter:Z.filter},Z.workerOptions),typeof this.promoteId=="string"&&(this.workerOptions.promoteId=this.promoteId)}_pixelsToTileUnits(t){return t*(R.$/this.tileSize)}_getClusterMaxZoom(t){const Z=t?Math.round(t):this.maxzoom-1;return Number.isInteger(t)||t===void 0||R.w(`Integer expected for option 'clusterMaxZoom': provided value "${t}" rounded to "${Z}"`),Z}load(){return R._(this,void 0,void 0,(function*(){yield this._updateWorkerData()}))}onAdd(t){this.map=t,this.load()}setData(t){return this._data=t,this._pendingWorkerUpdate={data:t},this._updateWorkerData(),this}updateData(t){return this._pendingWorkerUpdate.diff=R.a0(this._pendingWorkerUpdate.diff,t),this._updateWorkerData(),this}getData(){return R._(this,void 0,void 0,(function*(){const t=R.e({type:this.type},this.workerOptions);return this.actor.sendAsync({type:"GD",data:t})}))}getCoordinatesFromGeometry(t){return t.type==="GeometryCollection"?t.geometries.map((Z=>Z.coordinates)).flat(1/0):t.coordinates.flat(1/0)}getBounds(){return R._(this,void 0,void 0,(function*(){const t=new gr,Z=yield this.getData();let Q;switch(Z.type){case"FeatureCollection":Q=Z.features.map((ie=>this.getCoordinatesFromGeometry(ie.geometry))).flat(1/0);break;case"Feature":Q=this.getCoordinatesFromGeometry(Z.geometry);break;default:Q=this.getCoordinatesFromGeometry(Z)}if(Q.length==0)return t;for(let ie=0;ie<Q.length-1;ie+=2)t.extend([Q[ie],Q[ie+1]]);return t}))}setClusterOptions(t){return this.workerOptions.cluster=t.cluster,t&&(t.clusterRadius!==void 0&&(this.workerOptions.superclusterOptions.radius=this._pixelsToTileUnits(t.clusterRadius)),t.clusterMaxZoom!==void 0&&(this.workerOptions.superclusterOptions.maxZoom=this._getClusterMaxZoom(t.clusterMaxZoom))),this._updateWorkerData(),this}getClusterExpansionZoom(t){return this.actor.sendAsync({type:"GCEZ",data:{type:this.type,clusterId:t,source:this.id}})}getClusterChildren(t){return this.actor.sendAsync({type:"GCC",data:{type:this.type,clusterId:t,source:this.id}})}getClusterLeaves(t,Z,Q){return this.actor.sendAsync({type:"GCL",data:{type:this.type,source:this.id,clusterId:t,limit:Z,offset:Q}})}_updateWorkerData(){return R._(this,void 0,void 0,(function*(){if(this._isUpdatingWorker)return;const{data:t,diff:Z}=this._pendingWorkerUpdate;if(!t&&!Z)return void R.w(`No data or diff provided to GeoJSONSource ${this.id}.`);const Q=R.e({type:this.type},this.workerOptions);t?(typeof t=="string"?(Q.request=this.map._requestManager.transformRequest(_e.resolveURL(t),"Source"),Q.request.collectResourceTiming=this._collectResourceTiming):Q.data=JSON.stringify(t),this._pendingWorkerUpdate.data=void 0):Z&&(Q.dataDiff=Z,this._pendingWorkerUpdate.diff=void 0),this._isUpdatingWorker=!0,this.fire(new R.l("dataloading",{dataType:"source"}));try{const ie=yield this.actor.sendAsync({type:"LD",data:Q});if(this._isUpdatingWorker=!1,this._removed||ie.abandoned)return void this.fire(new R.l("dataabort",{dataType:"source"}));this._data=ie.data;let ue=null;ie.resourceTiming&&ie.resourceTiming[this.id]&&(ue=ie.resourceTiming[this.id].slice(0));const de={dataType:"source"};this._collectResourceTiming&&ue&&ue.length>0&&R.e(de,{resourceTiming:ue}),this.fire(new R.l("data",Object.assign(Object.assign({},de),{sourceDataType:"metadata"}))),this.fire(new R.l("data",Object.assign(Object.assign({},de),{sourceDataType:"content"})))}catch(ie){if(this._isUpdatingWorker=!1,this._removed)return void this.fire(new R.l("dataabort",{dataType:"source"}));this.fire(new R.k(ie))}finally{(this._pendingWorkerUpdate.data||this._pendingWorkerUpdate.diff)&&this._updateWorkerData()}}))}loaded(){return!this._isUpdatingWorker&&this._pendingWorkerUpdate.data===void 0&&this._pendingWorkerUpdate.diff===void 0}loadTile(t){return R._(this,void 0,void 0,(function*(){const Z=t.actor?"RT":"LT";t.actor=this.actor;const Q={type:this.type,uid:t.uid,tileID:t.tileID,zoom:t.tileID.overscaledZ,maxZoom:this.maxzoom,tileSize:this.tileSize,source:this.id,pixelRatio:this.map.getPixelRatio(),showCollisionBoxes:this.map.showCollisionBoxes,promoteId:this.promoteId,subdivisionGranularity:this.map.style.projection.subdivisionGranularity};t.abortController=new AbortController;const ie=yield this.actor.sendAsync({type:Z,data:Q},t.abortController);delete t.abortController,t.unloadVectorData(),t.aborted||t.loadVectorData(ie,this.map.painter,Z==="RT")}))}abortTile(t){return R._(this,void 0,void 0,(function*(){t.abortController&&(t.abortController.abort(),delete t.abortController),t.aborted=!0}))}unloadTile(t){return R._(this,void 0,void 0,(function*(){t.unloadVectorData(),yield this.actor.sendAsync({type:"RMT",data:{uid:t.uid,type:this.type,source:this.id}})}))}onRemove(){this._removed=!0,this.actor.sendAsync({type:"RS",data:{type:this.type,source:this.id}})}serialize(){return R.e({},this._options,{type:this.type,data:this._data})}hasTransition(){return!1}}class Dr extends R.E{constructor(t,Z,Q,ie){super(),this.flippedWindingOrder=!1,this.id=t,this.dispatcher=Q,this.coordinates=Z.coordinates,this.type="image",this.minzoom=0,this.maxzoom=22,this.tileSize=512,this.tiles={},this._loaded=!1,this.setEventedParent(ie),this.options=Z}load(t){return R._(this,void 0,void 0,(function*(){this._loaded=!1,this.fire(new R.l("dataloading",{dataType:"source"})),this.url=this.options.url,this._request=new AbortController;try{const Z=yield ke.getImage(this.map._requestManager.transformRequest(this.url,"Image"),this._request);this._request=null,this._loaded=!0,Z&&Z.data&&(this.image=Z.data,t&&(this.coordinates=t),this._finishLoading())}catch(Z){this._request=null,this._loaded=!0,this.fire(new R.k(Z))}}))}loaded(){return this._loaded}updateImage(t){return t.url?(this._request&&(this._request.abort(),this._request=null),this.options.url=t.url,this.load(t.coordinates).finally((()=>{this.texture=null})),this):this}_finishLoading(){this.map&&(this.setCoordinates(this.coordinates),this.fire(new R.l("data",{dataType:"source",sourceDataType:"metadata"})))}onAdd(t){this.map=t,this.load()}onRemove(){this._request&&(this._request.abort(),this._request=null)}setCoordinates(t){this.coordinates=t;const Z=t.map(R.a1.fromLngLat);var Q;return this.tileID=(function(ie){const ue=R.a2.fromPoints(ie),de=ue.width(),ge=ue.height(),ve=Math.max(de,ge),qe=Math.max(0,Math.floor(-Math.log(ve)/Math.LN2)),Re=Math.pow(2,qe);return new R.a4(qe,Math.floor((ue.minX+ue.maxX)/2*Re),Math.floor((ue.minY+ue.maxY)/2*Re))})(Z),this.terrainTileRanges=this._getOverlappingTileRanges(Z),this.minzoom=this.maxzoom=this.tileID.z,this.tileCoords=Z.map((ie=>this.tileID.getTilePoint(ie)._round())),this.flippedWindingOrder=((Q=this.tileCoords)[1].x-Q[0].x)*(Q[2].y-Q[0].y)-(Q[1].y-Q[0].y)*(Q[2].x-Q[0].x)<0,this.fire(new R.l("data",{dataType:"source",sourceDataType:"content"})),this}prepare(){if(Object.keys(this.tiles).length===0||!this.image)return;const t=this.map.painter.context,Z=t.gl;this.texture||(this.texture=new R.T(t,this.image,Z.RGBA),this.texture.bind(Z.LINEAR,Z.CLAMP_TO_EDGE));let Q=!1;for(const ie in this.tiles){const ue=this.tiles[ie];ue.state!=="loaded"&&(ue.state="loaded",ue.texture=this.texture,Q=!0)}Q&&this.fire(new R.l("data",{dataType:"source",sourceDataType:"idle",sourceId:this.id}))}loadTile(t){return R._(this,void 0,void 0,(function*(){this.tileID&&this.tileID.equals(t.tileID.canonical)?(this.tiles[String(t.tileID.wrap)]=t,t.buckets={}):t.state="errored"}))}serialize(){return{type:"image",url:this.options.url,coordinates:this.coordinates}}hasTransition(){return!1}_getOverlappingTileRanges(t){const{minX:Z,minY:Q,maxX:ie,maxY:ue}=R.a2.fromPoints(t),de={};for(let ge=0;ge<=R.a3;ge++){const ve=Math.pow(2,ge),qe=Math.floor(Z*ve),Re=Math.floor(Q*ve),Le=Math.floor(ie*ve),Fe=Math.floor(ue*ve);de[ge]={minTileX:qe,minTileY:Re,maxTileX:Le,maxTileY:Fe}}return de}}class Lr extends Dr{constructor(t,Z,Q,ie){super(t,Z,Q,ie),this.roundZoom=!0,this.type="video",this.options=Z}load(){return R._(this,void 0,void 0,(function*(){this._loaded=!1;const t=this.options;this.urls=[];for(const Z of t.urls)this.urls.push(this.map._requestManager.transformRequest(Z,"Source").url);try{const Z=yield R.a5(this.urls);if(this._loaded=!0,!Z)return;this.video=Z,this.video.loop=!0,this.video.addEventListener("playing",(()=>{this.map.triggerRepaint()})),this.map&&this.video.play(),this._finishLoading()}catch(Z){this.fire(new R.k(Z))}}))}pause(){this.video&&this.video.pause()}play(){this.video&&this.video.play()}seek(t){if(this.video){const Z=this.video.seekable;t<Z.start(0)||t>Z.end(0)?this.fire(new R.k(new R.a6(`sources.${this.id}`,null,`Playback for this video can be set only between the ${Z.start(0)} and ${Z.end(0)}-second mark.`))):this.video.currentTime=t}}getVideo(){return this.video}onAdd(t){this.map||(this.map=t,this.load(),this.video&&(this.video.play(),this.setCoordinates(this.coordinates)))}prepare(){if(Object.keys(this.tiles).length===0||this.video.readyState<2)return;const t=this.map.painter.context,Z=t.gl;this.texture?this.video.paused||(this.texture.bind(Z.LINEAR,Z.CLAMP_TO_EDGE),Z.texSubImage2D(Z.TEXTURE_2D,0,0,0,Z.RGBA,Z.UNSIGNED_BYTE,this.video)):(this.texture=new R.T(t,this.video,Z.RGBA),this.texture.bind(Z.LINEAR,Z.CLAMP_TO_EDGE));let Q=!1;for(const ie in this.tiles){const ue=this.tiles[ie];ue.state!=="loaded"&&(ue.state="loaded",ue.texture=this.texture,Q=!0)}Q&&this.fire(new R.l("data",{dataType:"source",sourceDataType:"idle",sourceId:this.id}))}serialize(){return{type:"video",urls:this.urls,coordinates:this.coordinates}}hasTransition(){return this.video&&!this.video.paused}}class Yt extends Dr{constructor(t,Z,Q,ie){super(t,Z,Q,ie),Z.coordinates?Array.isArray(Z.coordinates)&&Z.coordinates.length===4&&!Z.coordinates.some((ue=>!Array.isArray(ue)||ue.length!==2||ue.some((de=>typeof de!="number"))))||this.fire(new R.k(new R.a6(`sources.${t}`,null,'"coordinates" property must be an array of 4 longitude/latitude array pairs'))):this.fire(new R.k(new R.a6(`sources.${t}`,null,'missing required property "coordinates"'))),Z.animate&&typeof Z.animate!="boolean"&&this.fire(new R.k(new R.a6(`sources.${t}`,null,'optional "animate" property must be a boolean value'))),Z.canvas?typeof Z.canvas=="string"||Z.canvas instanceof HTMLCanvasElement||this.fire(new R.k(new R.a6(`sources.${t}`,null,'"canvas" must be either a string representing the ID of the canvas element from which to read, or an HTMLCanvasElement instance'))):this.fire(new R.k(new R.a6(`sources.${t}`,null,'missing required property "canvas"'))),this.options=Z,this.animate=Z.animate===void 0||Z.animate}load(){return R._(this,void 0,void 0,(function*(){this._loaded=!0,this.canvas||(this.canvas=this.options.canvas instanceof HTMLCanvasElement?this.options.canvas:document.getElementById(this.options.canvas)),this.width=this.canvas.width,this.height=this.canvas.height,this._hasInvalidDimensions()?this.fire(new R.k(new Error("Canvas dimensions cannot be less than or equal to zero."))):(this.play=function(){this._playing=!0,this.map.triggerRepaint()},this.pause=function(){this._playing&&(this.prepare(),this._playing=!1)},this._finishLoading())}))}getCanvas(){return this.canvas}onAdd(t){this.map=t,this.load(),this.canvas&&this.animate&&this.play()}onRemove(){this.pause()}prepare(){let t=!1;if(this.canvas.width!==this.width&&(this.width=this.canvas.width,t=!0),this.canvas.height!==this.height&&(this.height=this.canvas.height,t=!0),this._hasInvalidDimensions()||Object.keys(this.tiles).length===0)return;const Z=this.map.painter.context,Q=Z.gl;this.texture?(t||this._playing)&&this.texture.update(this.canvas,{premultiply:!0}):this.texture=new R.T(Z,this.canvas,Q.RGBA,{premultiply:!0});let ie=!1;for(const ue in this.tiles){const de=this.tiles[ue];de.state!=="loaded"&&(de.state="loaded",de.texture=this.texture,ie=!0)}ie&&this.fire(new R.l("data",{dataType:"source",sourceDataType:"idle",sourceId:this.id}))}serialize(){return{type:"canvas",coordinates:this.coordinates}}hasTransition(){return this._playing}_hasInvalidDimensions(){for(const t of[this.canvas.width,this.canvas.height])if(isNaN(t)||t<=0)return!0;return!1}}const Jt={},qr=se=>{switch(se){case"geojson":return Nr;case"image":return Dr;case"raster":return jr;case"raster-dem":return Sr;case"vector":return Hr;case"video":return Lr;case"canvas":return Yt}return Jt[se]},nr="RTLPluginLoaded";class dr extends R.E{constructor(){super(...arguments),this.status="unavailable",this.url=null,this.dispatcher=yr()}_syncState(t){return this.status=t,this.dispatcher.broadcast("SRPS",{pluginStatus:t,pluginURL:this.url}).catch((Z=>{throw this.status="error",Z}))}getRTLTextPluginStatus(){return this.status}clearRTLTextPlugin(){this.status="unavailable",this.url=null}setRTLTextPlugin(t){return R._(this,arguments,void 0,(function*(Z,Q=!1){if(this.url)throw new Error("setRTLTextPlugin cannot be called multiple times.");if(this.url=_e.resolveURL(Z),!this.url)throw new Error(`requested url ${Z} is invalid`);if(this.status==="unavailable"){if(!Q)return this._requestImport();this.status="deferred",this._syncState(this.status)}else if(this.status==="requested")return this._requestImport()}))}_requestImport(){return R._(this,void 0,void 0,(function*(){yield this._syncState("loading"),this.status="loaded",this.fire(new R.l(nr))}))}lazyLoad(){this.status==="unavailable"?this.status="requested":this.status==="deferred"&&this._requestImport()}}let mr=null;function Ge(){return mr||(mr=new dr),mr}var Ie,Se;(function(se){se[se.Base=0]="Base",se[se.Parent=1]="Parent"})(Ie||(Ie={})),(function(se){se[se.Departing=0]="Departing",se[se.Incoming=1]="Incoming"})(Se||(Se={}));class xe{constructor(t,Z){this.timeAdded=0,this.fadeEndTime=0,this.fadeOpacity=1,this.tileID=t,this.uid=R.a7(),this.uses=0,this.tileSize=Z,this.buckets={},this.expirationTime=null,this.queryPadding=0,this.hasSymbolBuckets=!1,this.hasRTLText=!1,this.dependencies={},this.rtt=[],this.rttCoords={},this.expiredRequestCount=0,this.state="loading"}isRenderable(t){return this.hasData()&&(!this.fadeEndTime||this.fadeOpacity>0)&&(t||!this.holdingForSymbolFade())}setCrossFadeLogic({fadingRole:t,fadingDirection:Z,fadingParentID:Q,fadeEndTime:ie}){this.resetFadeLogic(),this.fadingRole=t,this.fadingDirection=Z,this.fadingParentID=Q,this.fadeEndTime=ie}setSelfFadeLogic(t){this.resetFadeLogic(),this.selfFading=!0,this.fadeEndTime=t}resetFadeLogic(){this.fadingRole=null,this.fadingDirection=null,this.fadingParentID=null,this.selfFading=!1,this.timeAdded=_e.now(),this.fadeEndTime=0,this.fadeOpacity=1}wasRequested(){return this.state==="errored"||this.state==="loaded"||this.state==="reloading"}clearTextures(t){this.demTexture&&t.saveTileTexture(this.demTexture),this.demTexture=null}loadVectorData(t,Z,Q){if(this.hasData()&&this.unloadVectorData(),this.state="loaded",t){t.featureIndex&&(this.latestFeatureIndex=t.featureIndex,t.rawTileData?(this.latestRawTileData=t.rawTileData,this.latestFeatureIndex.rawTileData=t.rawTileData):this.latestRawTileData&&(this.latestFeatureIndex.rawTileData=this.latestRawTileData)),this.collisionBoxArray=t.collisionBoxArray,this.buckets=(function(ie,ue){const de={};if(!ue)return de;for(const ge of ie){const ve=ge.layerIds.map((qe=>ue.getLayer(qe))).filter(Boolean);if(ve.length!==0){ge.layers=ve,ge.stateDependentLayerIds&&(ge.stateDependentLayers=ge.stateDependentLayerIds.map((qe=>ve.filter((Re=>Re.id===qe))[0])));for(const qe of ve)de[qe.id]=ge}}return de})(t.buckets,Z==null?void 0:Z.style),this.hasSymbolBuckets=!1;for(const ie in this.buckets){const ue=this.buckets[ie];if(ue instanceof R.a9){if(this.hasSymbolBuckets=!0,!Q)break;ue.justReloaded=!0}}if(this.hasRTLText=!1,this.hasSymbolBuckets)for(const ie in this.buckets){const ue=this.buckets[ie];if(ue instanceof R.a9&&ue.hasRTLText){this.hasRTLText=!0,Ge().lazyLoad();break}}this.queryPadding=0;for(const ie in this.buckets){const ue=this.buckets[ie];this.queryPadding=Math.max(this.queryPadding,Z.style.getLayer(ie).queryRadius(ue))}t.imageAtlas&&(this.imageAtlas=t.imageAtlas),t.glyphAtlasImage&&(this.glyphAtlasImage=t.glyphAtlasImage),this.dashPositions=t.dashPositions}else this.collisionBoxArray=new R.a8}unloadVectorData(){for(const t in this.buckets)this.buckets[t].destroy();this.buckets={},this.imageAtlasTexture&&this.imageAtlasTexture.destroy(),this.imageAtlas&&(this.imageAtlas=null),this.glyphAtlasTexture&&this.glyphAtlasTexture.destroy(),this.dashPositions&&(this.dashPositions=null),this.latestFeatureIndex=null,this.state="unloaded"}getBucket(t){return this.buckets[t.id]}upload(t){for(const Q in this.buckets){const ie=this.buckets[Q];ie.uploadPending()&&ie.upload(t)}const Z=t.gl;this.imageAtlas&&!this.imageAtlas.uploaded&&(this.imageAtlasTexture=new R.T(t,this.imageAtlas.image,Z.RGBA),this.imageAtlas.uploaded=!0),this.glyphAtlasImage&&(this.glyphAtlasTexture=new R.T(t,this.glyphAtlasImage,Z.ALPHA),this.glyphAtlasImage=null)}prepare(t){this.imageAtlas&&this.imageAtlas.patchUpdatedImages(t,this.imageAtlasTexture)}queryRenderedFeatures(t,Z,Q,ie,ue,de,ge,ve,qe,Re,Le){return this.latestFeatureIndex&&this.latestFeatureIndex.rawTileData?this.latestFeatureIndex.query({queryGeometry:ie,cameraQueryGeometry:ue,scale:de,tileSize:this.tileSize,pixelPosMatrix:Re,transform:ve,params:ge,queryPadding:this.queryPadding*qe,getElevation:Le},t,Z,Q):{}}querySourceFeatures(t,Z){const Q=this.latestFeatureIndex;if(!Q||!Q.rawTileData)return;const ie=Q.loadVTLayers(),ue=Z&&Z.sourceLayer?Z.sourceLayer:"",de=ie._geojsonTileLayer||ie[ue];if(!de)return;const ge=R.aa(Z==null?void 0:Z.filter,Z==null?void 0:Z.globalState),{z:ve,x:qe,y:Re}=this.tileID.canonical,Le={z:ve,x:qe,y:Re};for(let Fe=0;Fe<de.length;Fe++){const Ve=de.feature(Fe);if(ge.needGeometry){const ot=R.ab(Ve,!0);if(!ge.filter(new R.F(this.tileID.overscaledZ),ot,this.tileID.canonical))continue}else if(!ge.filter(new R.F(this.tileID.overscaledZ),Ve))continue;const Xe=Q.getId(Ve,ue),at=new R.ac(Ve,ve,qe,Re,Xe);at.tile=Le,t.push(at)}}hasData(){return this.state==="loaded"||this.state==="reloading"||this.state==="expired"}patternsLoaded(){return this.imageAtlas&&!!Object.keys(this.imageAtlas.patternPositions).length}setExpiryData(t){const Z=this.expirationTime;if(t.cacheControl){const Q=R.ad(t.cacheControl);Q["max-age"]&&(this.expirationTime=Date.now()+1e3*Q["max-age"])}else t.expires&&(this.expirationTime=new Date(t.expires).getTime());if(this.expirationTime){const Q=Date.now();let ie=!1;if(this.expirationTime>Q)ie=!1;else if(Z)if(this.expirationTime<Z)ie=!0;else{const ue=this.expirationTime-Z;ue?this.expirationTime=Q+Math.max(ue,3e4):ie=!0}else ie=!0;ie?(this.expiredRequestCount++,this.state="expired"):this.expiredRequestCount=0}}getExpiryTimeout(){if(this.expirationTime)return this.expiredRequestCount?1e3*(1<<Math.min(this.expiredRequestCount-1,31)):Math.min(this.expirationTime-new Date().getTime(),Math.pow(2,31)-1)}setFeatureState(t,Z){if(!this.latestFeatureIndex||!this.latestFeatureIndex.rawTileData||Object.keys(t).length===0)return;const Q=this.latestFeatureIndex.loadVTLayers();for(const ie in this.buckets){if(!Z.style.hasLayer(ie))continue;const ue=this.buckets[ie],de=ue.layers[0].sourceLayer||"_geojsonTileLayer",ge=Q[de],ve=t[de];if(!ge||!ve||Object.keys(ve).length===0)continue;ue.update(ve,ge,this.imageAtlas&&this.imageAtlas.patternPositions||{},this.dashPositions||{});const qe=Z&&Z.style&&Z.style.getLayer(ie);qe&&(this.queryPadding=Math.max(this.queryPadding,qe.queryRadius(ue)))}}holdingForSymbolFade(){return this.symbolFadeHoldUntil!==void 0}symbolFadeFinished(){return!this.symbolFadeHoldUntil||this.symbolFadeHoldUntil<_e.now()}clearSymbolFadeHold(){this.symbolFadeHoldUntil=void 0}setSymbolHoldDuration(t){this.symbolFadeHoldUntil=_e.now()+t}setDependencies(t,Z){const Q={};for(const ie of Z)Q[ie]=!0;this.dependencies[t]=Q}hasDependency(t,Z){for(const Q of t){const ie=this.dependencies[Q];if(ie){for(const ue of Z)if(ie[ue])return!0}}return!1}}class Te{constructor(t,Z){this.max=t,this.onRemove=Z,this.reset()}reset(){for(const t in this.data)for(const Z of this.data[t])Z.timeout&&clearTimeout(Z.timeout),this.onRemove(Z.value);return this.data={},this.order=[],this}add(t,Z,Q){const ie=t.wrapped().key;this.data[ie]===void 0&&(this.data[ie]=[]);const ue={value:Z,timeout:void 0};if(Q!==void 0&&(ue.timeout=setTimeout((()=>{this.remove(t,ue)}),Q)),this.data[ie].push(ue),this.order.push(ie),this.order.length>this.max){const de=this._getAndRemoveByKey(this.order[0]);de&&this.onRemove(de)}return this}has(t){return t.wrapped().key in this.data}getAndRemove(t){return this.has(t)?this._getAndRemoveByKey(t.wrapped().key):null}_getAndRemoveByKey(t){const Z=this.data[t].shift();return Z.timeout&&clearTimeout(Z.timeout),this.data[t].length===0&&delete this.data[t],this.order.splice(this.order.indexOf(t),1),Z.value}getByKey(t){const Z=this.data[t];return Z?Z[0].value:null}get(t){return this.has(t)?this.data[t.wrapped().key][0].value:null}remove(t,Z){if(!this.has(t))return this;const Q=t.wrapped().key,ie=Z===void 0?0:this.data[Q].indexOf(Z),ue=this.data[Q][ie];return this.data[Q].splice(ie,1),ue.timeout&&clearTimeout(ue.timeout),this.data[Q].length===0&&delete this.data[Q],this.onRemove(ue.value),this.order.splice(this.order.indexOf(Q),1),this}setMaxSize(t){for(this.max=t;this.order.length>this.max;){const Z=this._getAndRemoveByKey(this.order[0]);Z&&this.onRemove(Z)}return this}filter(t){const Z=[];for(const Q in this.data)for(const ie of this.data[Q])t(ie.value)||Z.push(ie);for(const Q of Z)this.remove(Q.value.tileID,Q)}}class Me{constructor(){this.state={},this.stateChanges={},this.deletedStates={}}updateState(t,Z,Q){const ie=String(Z);if(this.stateChanges[t]=this.stateChanges[t]||{},this.stateChanges[t][ie]=this.stateChanges[t][ie]||{},R.e(this.stateChanges[t][ie],Q),this.deletedStates[t]===null){this.deletedStates[t]={};for(const ue in this.state[t])ue!==ie&&(this.deletedStates[t][ue]=null)}else if(this.deletedStates[t]&&this.deletedStates[t][ie]===null){this.deletedStates[t][ie]={};for(const ue in this.state[t][ie])Q[ue]||(this.deletedStates[t][ie][ue]=null)}else for(const ue in Q)this.deletedStates[t]&&this.deletedStates[t][ie]&&this.deletedStates[t][ie][ue]===null&&delete this.deletedStates[t][ie][ue]}removeFeatureState(t,Z,Q){if(this.deletedStates[t]===null)return;const ie=String(Z);if(this.deletedStates[t]=this.deletedStates[t]||{},Q&&Z!==void 0)this.deletedStates[t][ie]!==null&&(this.deletedStates[t][ie]=this.deletedStates[t][ie]||{},this.deletedStates[t][ie][Q]=null);else if(Z!==void 0)if(this.stateChanges[t]&&this.stateChanges[t][ie])for(Q in this.deletedStates[t][ie]={},this.stateChanges[t][ie])this.deletedStates[t][ie][Q]=null;else this.deletedStates[t][ie]=null;else this.deletedStates[t]=null}getState(t,Z){const Q=String(Z),ie=R.e({},(this.state[t]||{})[Q],(this.stateChanges[t]||{})[Q]);if(this.deletedStates[t]===null)return{};if(this.deletedStates[t]){const ue=this.deletedStates[t][Z];if(ue===null)return{};for(const de in ue)delete ie[de]}return ie}initializeTileState(t,Z){t.setFeatureState(this.state,Z)}coalesceChanges(t,Z){const Q={};for(const ie in this.stateChanges){this.state[ie]=this.state[ie]||{};const ue={};for(const de in this.stateChanges[ie])this.state[ie][de]||(this.state[ie][de]={}),R.e(this.state[ie][de],this.stateChanges[ie][de]),ue[de]=this.state[ie][de];Q[ie]=ue}for(const ie in this.deletedStates){this.state[ie]=this.state[ie]||{};const ue={};if(this.deletedStates[ie]===null)for(const de in this.state[ie])ue[de]={},this.state[ie][de]={};else for(const de in this.deletedStates[ie]){if(this.deletedStates[ie][de]===null)this.state[ie][de]={};else for(const ge of Object.keys(this.deletedStates[ie][de]))delete this.state[ie][de][ge];ue[de]=this.state[ie][de]}Q[ie]=Q[ie]||{},R.e(Q[ie],ue)}if(this.stateChanges={},this.deletedStates={},Object.keys(Q).length!==0)for(const ie in t)t[ie].setFeatureState(Q,Z)}}const ze=89.25;function Qe(se,t){const Z=R.ah(t.lat,-R.ai,R.ai);return new R.P(R.V(t.lng)*se,R.U(Z)*se)}function tt(se,t){return new R.a1(t.x/se,t.y/se).toLngLat()}function He(se){return se.cameraToCenterDistance*Math.min(.85*Math.tan(R.ae(90-se.pitch)),Math.tan(R.ae(ze-se.pitch)))}function Ze(se,t){const Z=se.canonical,Q=t/R.af(Z.z),ie=Z.x+Math.pow(2,Z.z)*se.wrap,ue=R.ag(new Float64Array(16));return R.M(ue,ue,[ie*Q,Z.y*Q,0]),R.N(ue,ue,[Q/R.$,Q/R.$,1]),ue}function st(se,t,Z,Q,ie){const ue=R.a1.fromLngLat(se,t),de=ie*R.aj(1,se.lat),ge=de*Math.cos(R.ae(Z)),ve=Math.sqrt(de*de-ge*ge),qe=ve*Math.sin(R.ae(-Q)),Re=ve*Math.cos(R.ae(-Q));return new R.a1(ue.x+qe,ue.y+Re,ue.z+ge)}function At(se,t,Z){const Q=t.intersectsFrustum(se);if(!Z||Q===0)return Q;const ie=t.intersectsPlane(Z);return ie===0?0:Q===2&&ie===2?2:1}function wt(se,t,Z){let Q=0;const ie=(Z-t)/10;for(let ue=0;ue<10;ue++)Q+=ie*Math.pow(Math.cos(t+(ue+.5)/10*(Z-t)),se);return Q}function Mt(se,t){return function(Z,Q,ie,ue,de){const ge=2*((se-1)/R.ak(Math.cos(R.ae(ze-de))/Math.cos(R.ae(ze)))-1),ve=Math.acos(ie/ue),qe=2*wt(ge-1,0,R.ae(de/2)),Re=Math.min(R.ae(ze),ve+R.ae(de/2)),Le=wt(ge-1,Math.min(Re,ve-R.ae(de/2)),Re),Fe=Math.atan(Q/ie),Ve=Math.hypot(Q,ie);let Xe=Z;return Xe+=R.ak(ue/Ve/Math.max(.5,Math.cos(R.ae(de/2)))),Xe+=ge*R.ak(Math.cos(Fe))/2,Xe-=R.ak(Math.max(1,Le/qe/t))/2,Xe}}const Zt=Mt(9.314,3);function Tt(se,t){const Z=(t.roundZoom?Math.round:Math.floor)(se.zoom+R.ak(se.tileSize/t.tileSize));return Math.max(0,Z)}function Er(se,t){const Z=se.getCameraFrustum(),Q=se.getClippingPlane(),ie=se.screenPointToMercatorCoordinate(se.getCameraPoint()),ue=R.a1.fromLngLat(se.center,se.elevation);ie.z=ue.z+Math.cos(se.pitchInRadians)*se.cameraToCenterDistance/se.worldSize;const de=se.getCoveringTilesDetailsProvider(),ge=de.allowVariableZoom(se,t),ve=Tt(se,t),qe=t.minzoom||0,Re=t.maxzoom!==void 0?t.maxzoom:se.maxZoom,Le=Math.min(Math.max(0,ve),Re),Fe=Math.pow(2,Le),Ve=[Fe*ie.x,Fe*ie.y,0],Xe=[Fe*ue.x,Fe*ue.y,0],at=Math.hypot(ue.x-ie.x,ue.y-ie.y),ot=Math.abs(ue.z-ie.z),lt=Math.hypot(at,ot),pt=xt=>({zoom:0,x:0,y:0,wrap:xt,fullyVisible:!1}),yt=[],mt=[];if(se.renderWorldCopies&&de.allowWorldCopies())for(let xt=1;xt<=3;xt++)yt.push(pt(-xt)),yt.push(pt(xt));for(yt.push(pt(0));yt.length>0;){const xt=yt.pop(),It=xt.x,gt=xt.y;let Ot=xt.fullyVisible;const zt={x:It,y:gt,z:xt.zoom},kt=de.getTileBoundingVolume(zt,xt.wrap,se.elevation,t);if(!Ot){const sr=At(Z,kt,Q);if(sr===0)continue;Ot=sr===2}const Bt=de.distanceToTile2d(ie.x,ie.y,zt,kt);let Nt=ve;ge&&(Nt=(t.calculateTileZoom||Zt)(se.zoom+R.ak(se.tileSize/t.tileSize),Bt,ot,lt,se.fov)),Nt=(t.roundZoom?Math.round:Math.floor)(Nt),Nt=Math.max(0,Nt);const ar=Math.min(Nt,Re);if(xt.wrap=de.getWrap(ue,zt,xt.wrap),xt.zoom>=ar){if(xt.zoom<qe)continue;const sr=Le-xt.zoom,Kt=Ve[0]-.5-(It<<sr),Tr=Ve[1]-.5-(gt<<sr),Wr=t.reparseOverscaled?Math.max(xt.zoom,Nt):xt.zoom;mt.push({tileID:new R.Z(xt.zoom===Re?Wr:xt.zoom,xt.wrap,xt.zoom,It,gt),distanceSq:R.al([Xe[0]-.5-It,Xe[1]-.5-gt]),tileDistanceToCamera:Math.sqrt(Kt*Kt+Tr*Tr)})}else for(let sr=0;sr<4;sr++)yt.push({zoom:xt.zoom+1,x:(It<<1)+sr%2,y:(gt<<1)+(sr>>1),wrap:xt.wrap,fullyVisible:Ot})}return mt.sort(((xt,It)=>xt.distanceSq-It.distanceSq)).map((xt=>xt.tileID))}const Or=R.a2.fromPoints([new R.P(0,0),new R.P(R.$,R.$)]);class cr extends R.E{constructor(t,Z,Q){super(),this.id=t,this.dispatcher=Q,this.on("data",(ie=>this._dataHandler(ie))),this.on("dataloading",(()=>{this._sourceErrored=!1})),this.on("error",(()=>{this._sourceErrored=this._source.loaded()})),this._source=((ie,ue,de,ge)=>{const ve=new(qr(ue.type))(ie,ue,de,ge);if(ve.id!==ie)throw new Error(`Expected Source id to be ${ie} instead of ${ve.id}`);return ve})(t,Z,Q,this),this._tiles={},this._cache=new Te(0,(ie=>this._unloadTile(ie))),this._timers={},this._cacheTimers={},this._maxTileCacheSize=null,this._maxTileCacheZoomLevels=null,this._rasterFadeDuration=0,this._maxFadingAncestorLevels=5,this._state=new Me,this._didEmitContent=!1,this._updated=!1}onAdd(t){this.map=t,this._maxTileCacheSize=t?t._maxTileCacheSize:null,this._maxTileCacheZoomLevels=t?t._maxTileCacheZoomLevels:null,this._source&&this._source.onAdd&&this._source.onAdd(t)}onRemove(t){this.clearTiles(),this._source&&this._source.onRemove&&this._source.onRemove(t)}loaded(){if(this._sourceErrored)return!0;if(!this._sourceLoaded||!this._source.loaded())return!1;if(!(this.used===void 0&&this.usedForTerrain===void 0||this.used||this.usedForTerrain))return!0;if(!this._updated)return!1;for(const t in this._tiles){const Z=this._tiles[t];if(Z.state!=="loaded"&&Z.state!=="errored")return!1}return!0}getSource(){return this._source}pause(){this._paused=!0}resume(){if(!this._paused)return;const t=this._shouldReloadOnResume;this._paused=!1,this._shouldReloadOnResume=!1,t&&this.reload(),this.transform&&this.update(this.transform,this.terrain)}_loadTile(t,Z,Q){return R._(this,void 0,void 0,(function*(){try{yield this._source.loadTile(t),this._tileLoaded(t,Z,Q)}catch(ie){t.state="errored",ie.status!==404?this._source.fire(new R.k(ie,{tile:t})):this.update(this.transform,this.terrain)}}))}_unloadTile(t){this._source.unloadTile&&this._source.unloadTile(t)}_abortTile(t){this._source.abortTile&&this._source.abortTile(t),this._source.fire(new R.l("dataabort",{tile:t,coord:t.tileID,dataType:"source"}))}serialize(){return this._source.serialize()}prepare(t){this._source.prepare&&this._source.prepare(),this._state.coalesceChanges(this._tiles,this.map?this.map.painter:null);for(const Z in this._tiles){const Q=this._tiles[Z];Q.upload(t),Q.prepare(this.map.style.imageManager)}}getIds(){return Object.values(this._tiles).map((t=>t.tileID)).sort(Fr).map((t=>t.key))}getRenderableIds(t){const Z=[];for(const Q in this._tiles)this._isIdRenderable(Q,t)&&Z.push(this._tiles[Q]);return t?Z.sort(((Q,ie)=>{const ue=Q.tileID,de=ie.tileID,ge=new R.P(ue.canonical.x,ue.canonical.y)._rotate(-this.transform.bearingInRadians),ve=new R.P(de.canonical.x,de.canonical.y)._rotate(-this.transform.bearingInRadians);return ue.overscaledZ-de.overscaledZ||ve.y-ge.y||ve.x-ge.x})).map((Q=>Q.tileID.key)):Z.map((Q=>Q.tileID)).sort(Fr).map((Q=>Q.key))}hasRenderableParent(t){const Z=t.overscaledZ-1;if(Z>=this._source.minzoom){const Q=this._getLoadedTile(t.scaledTo(Z));if(Q)return this._isIdRenderable(Q.tileID.key)}return!1}_isIdRenderable(t,Z=!1){var Q;return(Q=this._tiles[t])===null||Q===void 0?void 0:Q.isRenderable(Z)}reload(t){if(this._paused)this._shouldReloadOnResume=!0;else{this._cache.reset();for(const Z in this._tiles)t?this._reloadTile(Z,"expired"):this._tiles[Z].state!=="errored"&&this._reloadTile(Z,"reloading")}}_reloadTile(t,Z){return R._(this,void 0,void 0,(function*(){const Q=this._tiles[t];Q&&(Q.state!=="loading"&&(Q.state=Z),yield this._loadTile(Q,t,Z))}))}_tileLoaded(t,Z,Q){t.timeAdded=_e.now(),Q==="expired"&&(t.refreshedUponExpiration=!0),this._setTileReloadTimer(Z,t),this.getSource().type==="raster-dem"&&t.dem&&this._backfillDEM(t),this._state.initializeTileState(t,this.map?this.map.painter:null),t.aborted||this._source.fire(new R.l("data",{dataType:"source",tile:t,coord:t.tileID}))}_backfillDEM(t){const Z=this.getRenderableIds();for(let ie=0;ie<Z.length;ie++){const ue=Z[ie];if(t.neighboringTiles&&t.neighboringTiles[ue]){const de=this.getTileByID(ue);Q(t,de),Q(de,t)}}function Q(ie,ue){ie.needsHillshadePrepare=!0,ie.needsTerrainPrepare=!0;let de=ue.tileID.canonical.x-ie.tileID.canonical.x;const ge=ue.tileID.canonical.y-ie.tileID.canonical.y,ve=Math.pow(2,ie.tileID.canonical.z),qe=ue.tileID.key;de===0&&ge===0||Math.abs(ge)>1||(Math.abs(de)>1&&(Math.abs(de+ve)===1?de+=ve:Math.abs(de-ve)===1&&(de-=ve)),ue.dem&&ie.dem&&(ie.dem.backfillBorder(ue.dem,de,ge),ie.neighboringTiles&&ie.neighboringTiles[qe]&&(ie.neighboringTiles[qe].backfilled=!0)))}}getTile(t){return this.getTileByID(t.key)}getTileByID(t){return this._tiles[t]}_retainLoadedChildren(t,Z){const Q=Object.values(t),ie=this._getLoadedDescendents(Q),ue={};for(const de of Q){const ge=ie[de.key];if(!(ge!=null&&ge.length)){ue[de.key]=de;continue}const ve=de.overscaledZ+cr.maxUnderzooming,qe=ge.filter((Fe=>Fe.tileID.overscaledZ<=ve));if(!qe.length){ue[de.key]=de;continue}const Re=Math.min(...qe.map((Fe=>Fe.tileID.overscaledZ))),Le=qe.filter((Fe=>Fe.tileID.overscaledZ===Re)).map((Fe=>Fe.tileID));for(const Fe of Le)Z[Fe.key]=Fe;this._areDescendentsComplete(Le,Re,de.overscaledZ)||(ue[de.key]=de)}return ue}_getLoadedDescendents(t){var Z;const Q={};for(const ie in this._tiles){const ue=this._tiles[ie];if(ue.hasData())for(const de of t)ue.tileID.isChildOf(de)&&(Q[Z=de.key]||(Q[Z]=[])).push(ue)}return Q}_areDescendentsComplete(t,Z,Q){return t.length===1&&t[0].isOverscaled()?t[0].overscaledZ===Z:Math.pow(4,Z-Q)===t.length}_getLoadedTile(t){const Z=this._tiles[t.key];return Z!=null&&Z.hasData()?Z:null}updateCacheSize(t){const Z=Math.ceil(t.width/this._source.tileSize)+1,Q=Math.ceil(t.height/this._source.tileSize)+1,ie=Math.floor(Z*Q*(this._maxTileCacheZoomLevels===null?R.a.MAX_TILE_CACHE_ZOOM_LEVELS:this._maxTileCacheZoomLevels)),ue=typeof this._maxTileCacheSize=="number"?Math.min(this._maxTileCacheSize,ie):ie;this._cache.setMaxSize(ue)}handleWrapJump(t){const Z=Math.round((t-(this._prevLng===void 0?t:this._prevLng))/360);if(this._prevLng=t,Z){const Q={};for(const ie in this._tiles){const ue=this._tiles[ie];ue.tileID=ue.tileID.unwrapTo(ue.tileID.wrap+Z),Q[ue.tileID.key]=ue}this._tiles=Q;for(const ie in this._timers)clearTimeout(this._timers[ie]),delete this._timers[ie];for(const ie in this._tiles)this._setTileReloadTimer(ie,this._tiles[ie])}}update(t,Z){if(!this._sourceLoaded||this._paused)return;let Q;this.transform=t,this.terrain=Z,this.updateCacheSize(t),this.handleWrapJump(this.transform.center.lng),this.used||this.usedForTerrain?this._source.tileID?Q=t.getVisibleUnwrappedCoordinates(this._source.tileID).map((ve=>new R.Z(ve.canonical.z,ve.wrap,ve.canonical.z,ve.canonical.x,ve.canonical.y))):(Q=Er(t,{tileSize:this.usedForTerrain?this.tileSize:this._source.tileSize,minzoom:this._source.minzoom,maxzoom:this._source.maxzoom,roundZoom:!this.usedForTerrain&&this._source.roundZoom,reparseOverscaled:this._source.reparseOverscaled,terrain:Z,calculateTileZoom:this._source.calculateTileZoom}),this._source.hasTile&&(Q=Q.filter((ve=>this._source.hasTile(ve))))):Q=[],this.usedForTerrain&&(Q=this._addTerrainIdealTiles(Q));const ie=Q.length===0&&!this._updated&&this._didEmitContent;this._updated=!0,ie&&this.fire(new R.l("data",{sourceDataType:"idle",dataType:"source",sourceId:this.id}));const ue=Tt(t,this._source),de=this._updateRetainedTiles(Q,ue),ge=Yr(this._source.type);ge&&this._rasterFadeDuration>0&&!Z&&this._updateFadingTiles(Q,de),ge?this._cleanUpRasterTiles(de):this._cleanUpVectorTiles(de)}_cleanUpRasterTiles(t){for(const Z in this._tiles)t[Z]||this._removeTile(Z)}_cleanUpVectorTiles(t){for(const Z in this._tiles){const Q=this._tiles[Z];t[Z]?Q.clearSymbolFadeHold():Q.hasSymbolBuckets?Q.holdingForSymbolFade()?Q.symbolFadeFinished()&&this._removeTile(Z):Q.setSymbolHoldDuration(this.map._fadeDuration):this._removeTile(Z)}}_addTerrainIdealTiles(t){const Z=[];for(const Q of t)if(Q.canonical.z>this._source.minzoom){const ie=Q.scaledTo(Q.canonical.z-1);Z.push(ie);const ue=Q.scaledTo(Math.max(this._source.minzoom,Math.min(Q.canonical.z,5)));Z.push(ue)}return t.concat(Z)}releaseSymbolFadeTiles(){for(const t in this._tiles)this._tiles[t].holdingForSymbolFade()&&this._removeTile(t)}_updateRetainedTiles(t,Z){var Q;const ie={},ue={},de=Math.max(Z-cr.maxOverzooming,this._source.minzoom);let ge={};for(const ve of t){const qe=this._addTile(ve);ie[ve.key]=ve,qe.hasData()||(ge[ve.key]=ve)}ge=this._retainLoadedChildren(ge,ie);for(const ve in ge){const qe=ge[ve];let Re=this._tiles[ve],Le=Re==null?void 0:Re.wasRequested();for(let Fe=qe.overscaledZ-1;Fe>=de;--Fe){const Ve=qe.scaledTo(Fe);if(ue[Ve.key])break;if(ue[Ve.key]=!0,Re=this.getTile(Ve),!Re&&Le&&(Re=this._addTile(Ve)),Re){const Xe=Re.hasData();if((Xe||!(!((Q=this.map)===null||Q===void 0)&&Q.cancelPendingTileRequestsWhileZooming)||Le)&&(ie[Ve.key]=Ve),Le=Re.wasRequested(),Xe)break}}}return ie}_updateFadingTiles(t,Z){const Q=_e.now(),ie=R.am(t);for(const ue of t){const de=this._tiles[ue.key];de.fadingDirection!==Se.Departing&&de.fadeOpacity!==0||de.resetFadeLogic(),this._updateFadingAncestor(de,Z,Q)||this._updateFadingDescendents(de,Z,Q)||this._updateFadingEdge(de,ie,Q)||de.resetFadeLogic()}}_updateFadingAncestor(t,Z,Q){if(!t.hasData())return!1;const{tileID:ie,fadingRole:ue,fadingDirection:de,fadingParentID:ge}=t;if(ue===Ie.Base&&de===Se.Incoming&&ge)return Z[ge.key]=ge,!0;const ve=Math.max(ie.overscaledZ-this._maxFadingAncestorLevels,this._source.minzoom);for(let qe=ie.overscaledZ-1;qe>=ve;qe--){const Re=ie.scaledTo(qe),Le=this._getLoadedTile(Re);if(Le)return t.setCrossFadeLogic({fadingRole:Ie.Base,fadingDirection:Se.Incoming,fadingParentID:Le.tileID,fadeEndTime:Q+this._rasterFadeDuration}),Le.setCrossFadeLogic({fadingRole:Ie.Parent,fadingDirection:Se.Departing,fadeEndTime:Q+this._rasterFadeDuration}),Z[Re.key]=Re,!0}return!1}_updateFadingDescendents(t,Z,Q){if(!t.hasData())return!1;const ie=t.tileID.children(this._source.maxzoom);let ue=this._updateFadingChildren(t,ie,Z,Q);if(ue)return!0;for(const de of ie){const ge=de.children(this._source.maxzoom);this._updateFadingChildren(t,ge,Z,Q)&&(ue=!0)}return ue}_updateFadingChildren(t,Z,Q,ie){if(Z[0].overscaledZ>=this._source.maxzoom)return!1;let ue=!1;for(const de of Z){const ge=this._getLoadedTile(de);if(!ge)continue;const{fadingRole:ve,fadingDirection:qe,fadingParentID:Re}=ge;ve===Ie.Base&&qe===Se.Departing&&Re||(ge.setCrossFadeLogic({fadingRole:Ie.Base,fadingDirection:Se.Departing,fadingParentID:t.tileID,fadeEndTime:ie+this._rasterFadeDuration}),t.setCrossFadeLogic({fadingRole:Ie.Parent,fadingDirection:Se.Incoming,fadeEndTime:ie+this._rasterFadeDuration})),Q[de.key]=de,ue=!0}return ue}_updateFadingEdge(t,Z,Q){const ie=t.tileID;return!!t.selfFading||!t.hasData()&&!!Z.has(ie)&&(t.setSelfFadeLogic(Q+this._rasterFadeDuration),!0)}_addTile(t){let Z=this._tiles[t.key];if(Z)return Z;Z=this._cache.getAndRemove(t),Z&&(Z.resetFadeLogic(),this._setTileReloadTimer(t.key,Z),Z.tileID=t,this._state.initializeTileState(Z,this.map?this.map.painter:null),this._cacheTimers[t.key]&&(clearTimeout(this._cacheTimers[t.key]),delete this._cacheTimers[t.key],this._setTileReloadTimer(t.key,Z)));const Q=Z;return Z||(Z=new xe(t,this._source.tileSize*t.overscaleFactor()),this._loadTile(Z,t.key,Z.state)),Z.uses++,this._tiles[t.key]=Z,Q||this._source.fire(new R.l("dataloading",{tile:Z,coord:Z.tileID,dataType:"source"})),Z}_setTileReloadTimer(t,Z){t in this._timers&&(clearTimeout(this._timers[t]),delete this._timers[t]);const Q=Z.getExpiryTimeout();Q&&(this._timers[t]=setTimeout((()=>{this._reloadTile(t,"expired"),delete this._timers[t]}),Q))}refreshTiles(t){for(const Z in this._tiles)(this._isIdRenderable(Z)||this._tiles[Z].state=="errored")&&t.some((Q=>Q.equals(this._tiles[Z].tileID.canonical)))&&this._reloadTile(Z,"expired")}_removeTile(t){const Z=this._tiles[t];Z&&(Z.uses--,delete this._tiles[t],this._timers[t]&&(clearTimeout(this._timers[t]),delete this._timers[t]),Z.uses>0||(Z.hasData()&&Z.state!=="reloading"?this._cache.add(Z.tileID,Z,Z.getExpiryTimeout()):(Z.aborted=!0,this._abortTile(Z),this._unloadTile(Z))))}_dataHandler(t){t.dataType==="source"&&(t.sourceDataType!=="metadata"?t.sourceDataType==="content"&&this._sourceLoaded&&!this._paused&&(this.reload(t.sourceDataChanged),this.transform&&this.update(this.transform,this.terrain),this._didEmitContent=!0):this._sourceLoaded=!0)}clearTiles(){this._shouldReloadOnResume=!1,this._paused=!1;for(const t in this._tiles)this._removeTile(t);this._cache.reset()}tilesIn(t,Z,Q){const ie=[],ue=this.transform;if(!ue)return ie;const de=ue.getCoveringTilesDetailsProvider().allowWorldCopies(),ge=Q?ue.getCameraQueryGeometry(t):t,ve=Ve=>ue.screenPointToMercatorCoordinate(Ve,this.terrain),qe=this.transformBbox(t,ve,!de),Re=this.transformBbox(ge,ve,!de),Le=this.getIds(),Fe=R.a2.fromPoints(Re);for(let Ve=0;Ve<Le.length;Ve++){const Xe=this._tiles[Le[Ve]];if(Xe.holdingForSymbolFade())continue;const at=de?[Xe.tileID]:[Xe.tileID.unwrapTo(-1),Xe.tileID.unwrapTo(0)],ot=Math.pow(2,ue.zoom-Xe.tileID.overscaledZ),lt=Z*Xe.queryPadding*R.$/Xe.tileSize/ot;for(const pt of at){const yt=Fe.map((mt=>pt.getTilePoint(new R.a1(mt.x,mt.y))));if(yt.expandBy(lt),yt.intersects(Or)){const mt=qe.map((It=>pt.getTilePoint(It))),xt=Re.map((It=>pt.getTilePoint(It)));ie.push({tile:Xe,tileID:de?pt:pt.unwrapTo(0),queryGeometry:mt,cameraQueryGeometry:xt,scale:ot})}}}return ie}transformBbox(t,Z,Q){let ie=t.map(Z);if(Q){const ue=R.a2.fromPoints(t);ue.shrinkBy(.001*Math.min(ue.width(),ue.height()));const de=ue.map(Z);R.a2.fromPoints(ie).covers(de)||(ie=ie.map((ge=>ge.x>.5?new R.a1(ge.x-1,ge.y,ge.z):ge)))}return ie}getVisibleCoordinates(t){const Z=this.getRenderableIds(t).map((Q=>this._tiles[Q].tileID));return this.transform&&this.transform.populateCache(Z),Z}hasTransition(){if(this._source.hasTransition())return!0;if(Yr(this._source.type)&&this._rasterFadeDuration>0){const t=_e.now();for(const Z in this._tiles)if(this._tiles[Z].fadeEndTime>=t)return!0}return!1}setRasterFadeDuration(t){this._rasterFadeDuration=t}setFeatureState(t,Z,Q){this._state.updateState(t=t||"_geojsonTileLayer",Z,Q)}removeFeatureState(t,Z,Q){this._state.removeFeatureState(t=t||"_geojsonTileLayer",Z,Q)}getFeatureState(t,Z){return this._state.getState(t=t||"_geojsonTileLayer",Z)}setDependencies(t,Z,Q){const ie=this._tiles[t];ie&&ie.setDependencies(Z,Q)}reloadTilesForDependencies(t,Z){for(const Q in this._tiles)this._tiles[Q].hasDependency(t,Z)&&this._reloadTile(Q,"reloading");this._cache.filter((Q=>!Q.hasDependency(t,Z)))}}function Fr(se,t){const Z=Math.abs(2*se.wrap)-+(se.wrap<0),Q=Math.abs(2*t.wrap)-+(t.wrap<0);return se.overscaledZ-t.overscaledZ||Q-Z||t.canonical.y-se.canonical.y||t.canonical.x-se.canonical.x}function Yr(se){return se==="raster"||se==="image"||se==="video"}cr.maxOverzooming=10,cr.maxUnderzooming=3;class vi{constructor(t,Z){this.reset(t,Z)}reset(t,Z){this.points=t||[],this._distances=[0];for(let Q=1;Q<this.points.length;Q++)this._distances[Q]=this._distances[Q-1]+this.points[Q].dist(this.points[Q-1]);this.length=this._distances[this._distances.length-1],this.padding=Math.min(Z||0,.5*this.length),this.paddedLength=this.length-2*this.padding}lerp(t){if(this.points.length===1)return this.points[0];t=R.ah(t,0,1);let Z=1,Q=this._distances[Z];const ie=t*this.paddedLength+this.padding;for(;Q<ie&&Z<this._distances.length;)Q=this._distances[++Z];const ue=Z-1,de=this._distances[ue],ge=Q-de,ve=ge>0?(ie-de)/ge:0;return this.points[ue].mult(1-ve).add(this.points[Z].mult(ve))}}function bi(se,t){let Z=!0;return se==="always"||se!=="never"&&t!=="never"||(Z=!1),Z}class qi{constructor(t,Z,Q){const ie=this.boxCells=[],ue=this.circleCells=[];this.xCellCount=Math.ceil(t/Q),this.yCellCount=Math.ceil(Z/Q);for(let de=0;de<this.xCellCount*this.yCellCount;de++)ie.push([]),ue.push([]);this.circleKeys=[],this.boxKeys=[],this.bboxes=[],this.circles=[],this.width=t,this.height=Z,this.xScale=this.xCellCount/t,this.yScale=this.yCellCount/Z,this.boxUid=0,this.circleUid=0}keysLength(){return this.boxKeys.length+this.circleKeys.length}insert(t,Z,Q,ie,ue){this._forEachCell(Z,Q,ie,ue,this._insertBoxCell,this.boxUid++),this.boxKeys.push(t),this.bboxes.push(Z),this.bboxes.push(Q),this.bboxes.push(ie),this.bboxes.push(ue)}insertCircle(t,Z,Q,ie){this._forEachCell(Z-ie,Q-ie,Z+ie,Q+ie,this._insertCircleCell,this.circleUid++),this.circleKeys.push(t),this.circles.push(Z),this.circles.push(Q),this.circles.push(ie)}_insertBoxCell(t,Z,Q,ie,ue,de){this.boxCells[ue].push(de)}_insertCircleCell(t,Z,Q,ie,ue,de){this.circleCells[ue].push(de)}_query(t,Z,Q,ie,ue,de,ge){if(Q<0||t>this.width||ie<0||Z>this.height)return[];const ve=[];if(t<=0&&Z<=0&&this.width<=Q&&this.height<=ie){if(ue)return[{key:null,x1:t,y1:Z,x2:Q,y2:ie}];for(let qe=0;qe<this.boxKeys.length;qe++)ve.push({key:this.boxKeys[qe],x1:this.bboxes[4*qe],y1:this.bboxes[4*qe+1],x2:this.bboxes[4*qe+2],y2:this.bboxes[4*qe+3]});for(let qe=0;qe<this.circleKeys.length;qe++){const Re=this.circles[3*qe],Le=this.circles[3*qe+1],Fe=this.circles[3*qe+2];ve.push({key:this.circleKeys[qe],x1:Re-Fe,y1:Le-Fe,x2:Re+Fe,y2:Le+Fe})}}else this._forEachCell(t,Z,Q,ie,this._queryCell,ve,{hitTest:ue,overlapMode:de,seenUids:{box:{},circle:{}}},ge);return ve}query(t,Z,Q,ie){return this._query(t,Z,Q,ie,!1,null)}hitTest(t,Z,Q,ie,ue,de){return this._query(t,Z,Q,ie,!0,ue,de).length>0}hitTestCircle(t,Z,Q,ie,ue){const de=t-Q,ge=t+Q,ve=Z-Q,qe=Z+Q;if(ge<0||de>this.width||qe<0||ve>this.height)return!1;const Re=[];return this._forEachCell(de,ve,ge,qe,this._queryCellCircle,Re,{hitTest:!0,overlapMode:ie,circle:{x:t,y:Z,radius:Q},seenUids:{box:{},circle:{}}},ue),Re.length>0}_queryCell(t,Z,Q,ie,ue,de,ge,ve){const{seenUids:qe,hitTest:Re,overlapMode:Le}=ge,Fe=this.boxCells[ue];if(Fe!==null){const Xe=this.bboxes;for(const at of Fe)if(!qe.box[at]){qe.box[at]=!0;const ot=4*at,lt=this.boxKeys[at];if(t<=Xe[ot+2]&&Z<=Xe[ot+3]&&Q>=Xe[ot+0]&&ie>=Xe[ot+1]&&(!ve||ve(lt))&&(!Re||!bi(Le,lt.overlapMode))&&(de.push({key:lt,x1:Xe[ot],y1:Xe[ot+1],x2:Xe[ot+2],y2:Xe[ot+3]}),Re))return!0}}const Ve=this.circleCells[ue];if(Ve!==null){const Xe=this.circles;for(const at of Ve)if(!qe.circle[at]){qe.circle[at]=!0;const ot=3*at,lt=this.circleKeys[at];if(this._circleAndRectCollide(Xe[ot],Xe[ot+1],Xe[ot+2],t,Z,Q,ie)&&(!ve||ve(lt))&&(!Re||!bi(Le,lt.overlapMode))){const pt=Xe[ot],yt=Xe[ot+1],mt=Xe[ot+2];if(de.push({key:lt,x1:pt-mt,y1:yt-mt,x2:pt+mt,y2:yt+mt}),Re)return!0}}}return!1}_queryCellCircle(t,Z,Q,ie,ue,de,ge,ve){const{circle:qe,seenUids:Re,overlapMode:Le}=ge,Fe=this.boxCells[ue];if(Fe!==null){const Xe=this.bboxes;for(const at of Fe)if(!Re.box[at]){Re.box[at]=!0;const ot=4*at,lt=this.boxKeys[at];if(this._circleAndRectCollide(qe.x,qe.y,qe.radius,Xe[ot+0],Xe[ot+1],Xe[ot+2],Xe[ot+3])&&(!ve||ve(lt))&&!bi(Le,lt.overlapMode))return de.push(!0),!0}}const Ve=this.circleCells[ue];if(Ve!==null){const Xe=this.circles;for(const at of Ve)if(!Re.circle[at]){Re.circle[at]=!0;const ot=3*at,lt=this.circleKeys[at];if(this._circlesCollide(Xe[ot],Xe[ot+1],Xe[ot+2],qe.x,qe.y,qe.radius)&&(!ve||ve(lt))&&!bi(Le,lt.overlapMode))return de.push(!0),!0}}}_forEachCell(t,Z,Q,ie,ue,de,ge,ve){const qe=this._convertToXCellCoord(t),Re=this._convertToYCellCoord(Z),Le=this._convertToXCellCoord(Q),Fe=this._convertToYCellCoord(ie);for(let Ve=qe;Ve<=Le;Ve++)for(let Xe=Re;Xe<=Fe;Xe++)if(ue.call(this,t,Z,Q,ie,this.xCellCount*Xe+Ve,de,ge,ve))return}_convertToXCellCoord(t){return Math.max(0,Math.min(this.xCellCount-1,Math.floor(t*this.xScale)))}_convertToYCellCoord(t){return Math.max(0,Math.min(this.yCellCount-1,Math.floor(t*this.yScale)))}_circlesCollide(t,Z,Q,ie,ue,de){const ge=ie-t,ve=ue-Z,qe=Q+de;return qe*qe>ge*ge+ve*ve}_circleAndRectCollide(t,Z,Q,ie,ue,de,ge){const ve=(de-ie)/2,qe=Math.abs(t-(ie+ve));if(qe>ve+Q)return!1;const Re=(ge-ue)/2,Le=Math.abs(Z-(ue+Re));if(Le>Re+Q)return!1;if(qe<=ve||Le<=Re)return!0;const Fe=qe-ve,Ve=Le-Re;return Fe*Fe+Ve*Ve<=Q*Q}}function Jr(se,t,Z){const Q=R.L();if(!se){const{vecSouth:Le,vecEast:Fe}=ri(t),Ve=K();Ve[0]=Fe[0],Ve[1]=Fe[1],Ve[2]=Le[0],Ve[3]=Le[1],ie=Ve,(Re=(de=(ue=Ve)[0])*(qe=ue[3])-(ve=ue[2])*(ge=ue[1]))&&(ie[0]=qe*(Re=1/Re),ie[1]=-ge*Re,ie[2]=-ve*Re,ie[3]=de*Re),Q[0]=Ve[0],Q[1]=Ve[1],Q[4]=Ve[2],Q[5]=Ve[3]}var ie,ue,de,ge,ve,qe,Re;return R.N(Q,Q,[1/Z,1/Z,1]),Q}function li(se,t,Z,Q){if(se){const ie=R.L();if(!t){const{vecSouth:ue,vecEast:de}=ri(Z);ie[0]=de[0],ie[1]=de[1],ie[4]=ue[0],ie[5]=ue[1]}return R.N(ie,ie,[Q,Q,1]),ie}return Z.pixelsToClipSpaceMatrix}function ri(se){const t=Math.cos(se.rollInRadians),Z=Math.sin(se.rollInRadians),Q=Math.cos(se.pitchInRadians),ie=Math.cos(se.bearingInRadians),ue=Math.sin(se.bearingInRadians),de=R.ar();de[0]=-ie*Q*Z-ue*t,de[1]=-ue*Q*Z+ie*t;const ge=R.as(de);ge<1e-9?R.at(de):R.au(de,de,1/ge);const ve=R.ar();ve[0]=ie*Q*t-ue*Z,ve[1]=ue*Q*t+ie*Z;const qe=R.as(ve);return qe<1e-9?R.at(ve):R.au(ve,ve,1/qe),{vecEast:ve,vecSouth:de}}function Ht(se,t,Z,Q){let ie;Q?(ie=[se,t,Q(se,t),1],R.aw(ie,ie,Z)):(ie=[se,t,0,1],Si(ie,ie,Z));const ue=ie[3];return{point:new R.P(ie[0]/ue,ie[1]/ue),signedDistanceFromCamera:ue,isOccluded:!1}}function Ti(se,t){return .5+se/t*.5}function Ni(se,t){return se.x>=-t[0]&&se.x<=t[0]&&se.y>=-t[1]&&se.y<=t[1]}function Pi(se,t,Z,Q,ie,ue,de,ge,ve,qe,Re,Le,Fe){const Ve=Z?se.textSizeData:se.iconSizeData,Xe=R.an(Ve,t.transform.zoom),at=[256/t.width*2+1,256/t.height*2+1],ot=Z?se.text.dynamicLayoutVertexArray:se.icon.dynamicLayoutVertexArray;ot.clear();const lt=se.lineVertexArray,pt=Z?se.text.placedSymbolArray:se.icon.placedSymbolArray,yt=t.transform.width/t.transform.height;let mt=!1;for(let xt=0;xt<pt.length;xt++){const It=pt.get(xt);if(It.hidden||It.writingMode===R.ao.vertical&&!mt){fi(It.numGlyphs,ot);continue}mt=!1;const gt=new R.P(It.anchorX,It.anchorY),Ot={getElevation:Fe,pitchedLabelPlaneMatrix:Q,lineVertexArray:lt,pitchWithMap:ue,projectionCache:{projections:{},offsets:{},cachedAnchorPoint:void 0,anyProjectionOccluded:!1},transform:t.transform,tileAnchorPoint:gt,unwrappedTileID:ve,width:qe,height:Re,translation:Le},zt=Pt(It.anchorX,It.anchorY,Ot);if(!Ni(zt.point,at)){fi(It.numGlyphs,ot);continue}const kt=Ti(t.transform.cameraToCenterDistance,zt.signedDistanceFromCamera),Bt=R.ap(Ve,Xe,It),Nt=ue?Bt*t.transform.getPitchedTextCorrection(It.anchorX,It.anchorY,ve)/kt:Bt*kt,ar=Zr({projectionContext:Ot,pitchedLabelPlaneMatrixInverse:ie,symbol:It,fontSize:Nt,flip:!1,keepUpright:de,glyphOffsetArray:se.glyphOffsetArray,dynamicLayoutVertexArray:ot,aspectRatio:yt,rotateToLine:ge});mt=ar.useVertical,(ar.notEnoughRoom||mt||ar.needsFlipping&&Zr({projectionContext:Ot,pitchedLabelPlaneMatrixInverse:ie,symbol:It,fontSize:Nt,flip:!0,keepUpright:de,glyphOffsetArray:se.glyphOffsetArray,dynamicLayoutVertexArray:ot,aspectRatio:yt,rotateToLine:ge}).notEnoughRoom)&&fi(It.numGlyphs,ot)}Z?se.text.dynamicLayoutVertexBuffer.updateData(ot):se.icon.dynamicLayoutVertexBuffer.updateData(ot)}function ii(se,t,Z,Q,ie,ue,de,ge){const ve=ue.glyphStartIndex+ue.numGlyphs,qe=ue.lineStartIndex,Re=ue.lineStartIndex+ue.lineLength,Le=t.getoffsetX(ue.glyphStartIndex),Fe=t.getoffsetX(ve-1),Ve=Rr(se*Le,Z,Q,ie,ue.segment,qe,Re,ge,de);if(!Ve)return null;const Xe=Rr(se*Fe,Z,Q,ie,ue.segment,qe,Re,ge,de);return Xe?ge.projectionCache.anyProjectionOccluded?null:{first:Ve,last:Xe}:null}function ir(se,t,Z,Q){return se===R.ao.horizontal&&Math.abs(Z.y-t.y)>Math.abs(Z.x-t.x)*Q?{useVertical:!0}:(se===R.ao.vertical?t.y<Z.y:t.x>Z.x)?{needsFlipping:!0}:null}function Zr(se){const{projectionContext:t,pitchedLabelPlaneMatrixInverse:Z,symbol:Q,fontSize:ie,flip:ue,keepUpright:de,glyphOffsetArray:ge,dynamicLayoutVertexArray:ve,aspectRatio:qe,rotateToLine:Re}=se,Le=ie/24,Fe=Q.lineOffsetX*Le,Ve=Q.lineOffsetY*Le;let Xe;if(Q.numGlyphs>1){const at=Q.glyphStartIndex+Q.numGlyphs,ot=Q.lineStartIndex,lt=Q.lineStartIndex+Q.lineLength,pt=ii(Le,ge,Fe,Ve,ue,Q,Re,t);if(!pt)return{notEnoughRoom:!0};const yt=Vt(pt.first.point.x,pt.first.point.y,t,Z),mt=Vt(pt.last.point.x,pt.last.point.y,t,Z);if(de&&!ue){const xt=ir(Q.writingMode,yt,mt,qe);if(xt)return xt}Xe=[pt.first];for(let xt=Q.glyphStartIndex+1;xt<at-1;xt++){const It=Rr(Le*ge.getoffsetX(xt),Fe,Ve,ue,Q.segment,ot,lt,t,Re);if(!It)return{notEnoughRoom:!0};Xe.push(It)}Xe.push(pt.last)}else{if(de&&!ue){const ot=tr(t.tileAnchorPoint.x,t.tileAnchorPoint.y,t).point,lt=Q.lineStartIndex+Q.segment+1,pt=new R.P(t.lineVertexArray.getx(lt),t.lineVertexArray.gety(lt)),yt=tr(pt.x,pt.y,t),mt=yt.signedDistanceFromCamera>0?yt.point:Gr(t.tileAnchorPoint,pt,ot,1,t),xt=Vt(ot.x,ot.y,t,Z),It=Vt(mt.x,mt.y,t,Z),gt=ir(Q.writingMode,xt,It,qe);if(gt)return gt}const at=Rr(Le*ge.getoffsetX(Q.glyphStartIndex),Fe,Ve,ue,Q.segment,Q.lineStartIndex,Q.lineStartIndex+Q.lineLength,t,Re);if(!at||t.projectionCache.anyProjectionOccluded)return{notEnoughRoom:!0};Xe=[at]}for(const at of Xe)R.av(ve,at.point,at.angle);return{}}function Gr(se,t,Z,Q,ie){const ue=se.add(se.sub(t)._unit()),de=tr(ue.x,ue.y,ie).point,ge=Z.sub(de);return Z.add(ge._mult(Q/ge.mag()))}function jt(se,t,Z){const Q=t.projectionCache;if(Q.projections[se])return Q.projections[se];const ie=new R.P(t.lineVertexArray.getx(se),t.lineVertexArray.gety(se)),ue=tr(ie.x,ie.y,t);if(ue.signedDistanceFromCamera>0)return Q.projections[se]=ue.point,Q.anyProjectionOccluded=Q.anyProjectionOccluded||ue.isOccluded,ue.point;const de=se-Z.direction;return Gr(Z.distanceFromAnchor===0?t.tileAnchorPoint:new R.P(t.lineVertexArray.getx(de),t.lineVertexArray.gety(de)),ie,Z.previousVertex,Z.absOffsetX-Z.distanceFromAnchor+1,t)}function tr(se,t,Z){const Q=se+Z.translation[0],ie=t+Z.translation[1];let ue;return Z.pitchWithMap?(ue=Ht(Q,ie,Z.pitchedLabelPlaneMatrix,Z.getElevation),ue.isOccluded=!1):(ue=Z.transform.projectTileCoordinates(Q,ie,Z.unwrappedTileID,Z.getElevation),ue.point.x=(.5*ue.point.x+.5)*Z.width,ue.point.y=(.5*-ue.point.y+.5)*Z.height),ue}function Vt(se,t,Z,Q){if(Z.pitchWithMap){const ie=[se,t,0,1];return R.aw(ie,ie,Q),Z.transform.projectTileCoordinates(ie[0]/ie[3],ie[1]/ie[3],Z.unwrappedTileID,Z.getElevation).point}return{x:se/Z.width*2-1,y:1-t/Z.height*2}}function Pt(se,t,Z){return Z.transform.projectTileCoordinates(se,t,Z.unwrappedTileID,Z.getElevation)}function Qt(se,t,Z){return se._unit()._perp()._mult(t*Z)}function Ur(se,t,Z,Q,ie,ue,de,ge,ve){if(ge.projectionCache.offsets[se])return ge.projectionCache.offsets[se];const qe=Z.add(t);if(se+ve.direction<Q||se+ve.direction>=ie)return ge.projectionCache.offsets[se]=qe,qe;const Re=jt(se+ve.direction,ge,ve),Le=Qt(Re.sub(Z),de,ve.direction),Fe=Z.add(Le),Ve=Re.add(Le);return ge.projectionCache.offsets[se]=R.ax(ue,qe,Fe,Ve)||qe,ge.projectionCache.offsets[se]}function Rr(se,t,Z,Q,ie,ue,de,ge,ve){const qe=Q?se-t:se+t;let Re=qe>0?1:-1,Le=0;Q&&(Re*=-1,Le=Math.PI),Re<0&&(Le+=Math.PI);let Fe,Ve=Re>0?ue+ie:ue+ie+1;ge.projectionCache.cachedAnchorPoint?Fe=ge.projectionCache.cachedAnchorPoint:(Fe=tr(ge.tileAnchorPoint.x,ge.tileAnchorPoint.y,ge).point,ge.projectionCache.cachedAnchorPoint=Fe);let Xe,at,ot=Fe,lt=Fe,pt=0,yt=0;const mt=Math.abs(qe),xt=[];let It;for(;pt+yt<=mt;){if(Ve+=Re,Ve<ue||Ve>=de)return null;pt+=yt,lt=ot,at=Xe;const zt={absOffsetX:mt,direction:Re,distanceFromAnchor:pt,previousVertex:lt};if(ot=jt(Ve,ge,zt),Z===0)xt.push(lt),It=ot.sub(lt);else{let kt;const Bt=ot.sub(lt);kt=Bt.mag()===0?Qt(jt(Ve+Re,ge,zt).sub(ot),Z,Re):Qt(Bt,Z,Re),at||(at=lt.add(kt)),Xe=Ur(Ve,kt,ot,ue,de,at,Z,ge,zt),xt.push(at),It=Xe.sub(at)}yt=It.mag()}const gt=It._mult((mt-pt)/yt)._add(at||lt),Ot=Le+Math.atan2(ot.y-lt.y,ot.x-lt.x);return xt.push(gt),{point:gt,angle:ve?Ot:0,path:xt}}const yi=new Float32Array([-1/0,-1/0,0,-1/0,-1/0,0,-1/0,-1/0,0,-1/0,-1/0,0]);function fi(se,t){for(let Z=0;Z<se;Z++){const Q=t.length;t.resize(Q+4),t.float32.set(yi,3*Q)}}function Si(se,t,Z){const Q=t[0],ie=t[1];return se[0]=Z[0]*Q+Z[4]*ie+Z[12],se[1]=Z[1]*Q+Z[5]*ie+Z[13],se[3]=Z[3]*Q+Z[7]*ie+Z[15],se}const ui=100;class rr{constructor(t,Z=new qi(t.width+200,t.height+200,25),Q=new qi(t.width+200,t.height+200,25)){this.transform=t,this.grid=Z,this.ignoredGrid=Q,this.pitchFactor=Math.cos(t.pitch*Math.PI/180)*t.cameraToCenterDistance,this.screenRightBoundary=t.width+ui,this.screenBottomBoundary=t.height+ui,this.gridRightBoundary=t.width+200,this.gridBottomBoundary=t.height+200,this.perspectiveRatioCutoff=.6}placeCollisionBox(t,Z,Q,ie,ue,de,ge,ve,qe,Re,Le,Fe){const Ve=this.projectAndGetPerspectiveRatio(t.anchorPointX+ve[0],t.anchorPointY+ve[1],ue,Re,Fe),Xe=Q*Ve.perspectiveRatio;let at;if(de||ge)at=this._projectCollisionBox(t,Xe,ie,ue,de,ge,ve,Ve,Re,Le,Fe);else{const It=Ve.x+(Le?Le.x*Xe:0),gt=Ve.y+(Le?Le.y*Xe:0);at={allPointsOccluded:!1,box:[It+t.x1*Xe,gt+t.y1*Xe,It+t.x2*Xe,gt+t.y2*Xe]}}const[ot,lt,pt,yt]=at.box,mt=de?at.allPointsOccluded:Ve.isOccluded;let xt=mt;return xt||(xt=Ve.perspectiveRatio<this.perspectiveRatioCutoff),xt||(xt=!this.isInsideGrid(ot,lt,pt,yt)),xt||Z!=="always"&&this.grid.hitTest(ot,lt,pt,yt,Z,qe)?{box:[ot,lt,pt,yt],placeable:!1,offscreen:!1,occluded:mt}:{box:[ot,lt,pt,yt],placeable:!0,offscreen:this.isOffscreen(ot,lt,pt,yt),occluded:mt}}placeCollisionCircles(t,Z,Q,ie,ue,de,ge,ve,qe,Re,Le,Fe,Ve,Xe){const at=[],ot=new R.P(Z.anchorX,Z.anchorY),lt=this.getPerspectiveRatio(ot.x,ot.y,de,Xe),pt=(qe?ue*this.transform.getPitchedTextCorrection(Z.anchorX,Z.anchorY,de)/lt:ue*lt)/R.aB,yt={getElevation:Xe,pitchedLabelPlaneMatrix:ge,lineVertexArray:Q,pitchWithMap:qe,projectionCache:{projections:{},offsets:{},cachedAnchorPoint:void 0,anyProjectionOccluded:!1},transform:this.transform,tileAnchorPoint:ot,unwrappedTileID:de,width:this.transform.width,height:this.transform.height,translation:Ve},mt=ii(pt,ie,Z.lineOffsetX*pt,Z.lineOffsetY*pt,!1,Z,!1,yt);let xt=!1,It=!1,gt=!0;if(mt){const Ot=.5*Le*lt+Fe,zt=new R.P(-100,-100),kt=new R.P(this.screenRightBoundary,this.screenBottomBoundary),Bt=new vi,Nt=mt.first,ar=mt.last;let sr=[];for(let Wr=Nt.path.length-1;Wr>=1;Wr--)sr.push(Nt.path[Wr]);for(let Wr=1;Wr<ar.path.length;Wr++)sr.push(ar.path[Wr]);const Kt=2.5*Ot;if(qe){const Wr=this.projectPathToScreenSpace(sr,yt);sr=Wr.some((hi=>hi.signedDistanceFromCamera<=0))?[]:Wr.map((hi=>hi.point))}let Tr=[];if(sr.length>0){const Wr=sr[0].clone(),hi=sr[0].clone();for(let di=1;di<sr.length;di++)Wr.x=Math.min(Wr.x,sr[di].x),Wr.y=Math.min(Wr.y,sr[di].y),hi.x=Math.max(hi.x,sr[di].x),hi.y=Math.max(hi.y,sr[di].y);Tr=Wr.x>=zt.x&&hi.x<=kt.x&&Wr.y>=zt.y&&hi.y<=kt.y?[sr]:hi.x<zt.x||Wr.x>kt.x||hi.y<zt.y||Wr.y>kt.y?[]:R.ay([sr],zt.x,zt.y,kt.x,kt.y)}for(const Wr of Tr){Bt.reset(Wr,.25*Ot);let hi=0;hi=Bt.length<=.5*Ot?1:Math.ceil(Bt.paddedLength/Kt)+1;for(let di=0;di<hi;di++){const _i=di/Math.max(hi-1,1),Ri=Bt.lerp(_i),gi=Ri.x+ui,si=Ri.y+ui;at.push(gi,si,Ot,0);const Ei=gi-Ot,rn=si-Ot,ki=gi+Ot,Li=si+Ot;if(gt=gt&&this.isOffscreen(Ei,rn,ki,Li),It=It||this.isInsideGrid(Ei,rn,ki,Li),t!=="always"&&this.grid.hitTestCircle(gi,si,Ot,t,Re)&&(xt=!0,!ve))return{circles:[],offscreen:!1,collisionDetected:xt}}}}return{circles:!ve&&xt||!It||lt<this.perspectiveRatioCutoff?[]:at,offscreen:gt,collisionDetected:xt}}projectPathToScreenSpace(t,Z){const Q=(function(ie,ue){const de=R.L();return R.aq(de,ue.pitchedLabelPlaneMatrix),ie.map((ge=>{const ve=Ht(ge.x,ge.y,de,ue.getElevation),qe=ue.transform.projectTileCoordinates(ve.point.x,ve.point.y,ue.unwrappedTileID,ue.getElevation);return qe.point.x=(.5*qe.point.x+.5)*ue.width,qe.point.y=(.5*-qe.point.y+.5)*ue.height,qe}))})(t,Z);return(function(ie){let ue=0,de=0,ge=0,ve=0;for(let qe=0;qe<ie.length;qe++)ie[qe].isOccluded?(ge=qe+1,ve=0):(ve++,ve>de&&(de=ve,ue=ge));return ie.slice(ue,ue+de)})(Q)}queryRenderedSymbols(t){if(t.length===0||this.grid.keysLength()===0&&this.ignoredGrid.keysLength()===0)return{};const Z=[],Q=new R.a2;for(const Le of t){const Fe=new R.P(Le.x+ui,Le.y+ui);Q.extend(Fe),Z.push(Fe)}const{minX:ie,minY:ue,maxX:de,maxY:ge}=Q,ve=this.grid.query(ie,ue,de,ge).concat(this.ignoredGrid.query(ie,ue,de,ge)),qe={},Re={};for(const Le of ve){const Fe=Le.key;if(qe[Fe.bucketInstanceId]===void 0&&(qe[Fe.bucketInstanceId]={}),qe[Fe.bucketInstanceId][Fe.featureIndex])continue;const Ve=[new R.P(Le.x1,Le.y1),new R.P(Le.x2,Le.y1),new R.P(Le.x2,Le.y2),new R.P(Le.x1,Le.y2)];R.az(Z,Ve)&&(qe[Fe.bucketInstanceId][Fe.featureIndex]=!0,Re[Fe.bucketInstanceId]===void 0&&(Re[Fe.bucketInstanceId]=[]),Re[Fe.bucketInstanceId].push(Fe.featureIndex))}return Re}insertCollisionBox(t,Z,Q,ie,ue,de){(Q?this.ignoredGrid:this.grid).insert({bucketInstanceId:ie,featureIndex:ue,collisionGroupID:de,overlapMode:Z},t[0],t[1],t[2],t[3])}insertCollisionCircles(t,Z,Q,ie,ue,de){const ge=Q?this.ignoredGrid:this.grid,ve={bucketInstanceId:ie,featureIndex:ue,collisionGroupID:de,overlapMode:Z};for(let qe=0;qe<t.length;qe+=4)ge.insertCircle(ve,t[qe],t[qe+1],t[qe+2])}projectAndGetPerspectiveRatio(t,Z,Q,ie,ue){if(ue){let de;ie?(de=[t,Z,ie(t,Z),1],R.aw(de,de,ue)):(de=[t,Z,0,1],Si(de,de,ue));const ge=de[3];return{x:(de[0]/ge+1)/2*this.transform.width+ui,y:(-de[1]/ge+1)/2*this.transform.height+ui,perspectiveRatio:.5+this.transform.cameraToCenterDistance/ge*.5,isOccluded:!1,signedDistanceFromCamera:ge}}{const de=this.transform.projectTileCoordinates(t,Z,Q,ie);return{x:(de.point.x+1)/2*this.transform.width+ui,y:(1-de.point.y)/2*this.transform.height+ui,perspectiveRatio:.5+this.transform.cameraToCenterDistance/de.signedDistanceFromCamera*.5,isOccluded:de.isOccluded,signedDistanceFromCamera:de.signedDistanceFromCamera}}}getPerspectiveRatio(t,Z,Q,ie){const ue=this.transform.projectTileCoordinates(t,Z,Q,ie);return .5+this.transform.cameraToCenterDistance/ue.signedDistanceFromCamera*.5}isOffscreen(t,Z,Q,ie){return Q<ui||t>=this.screenRightBoundary||ie<ui||Z>this.screenBottomBoundary}isInsideGrid(t,Z,Q,ie){return Q>=0&&t<this.gridRightBoundary&&ie>=0&&Z<this.gridBottomBoundary}getViewportMatrix(){const t=R.ag([]);return R.M(t,t,[-100,-100,0]),t}_projectCollisionBox(t,Z,Q,ie,ue,de,ge,ve,qe,Re,Le){let Fe=1,Ve=0,Xe=0,at=1;const ot=t.anchorPointX+ge[0],lt=t.anchorPointY+ge[1];if(de&&!ue){const sr=this.projectAndGetPerspectiveRatio(ot+1,lt,ie,qe,Le),Kt=sr.x-ve.x,Tr=Math.atan((sr.y-ve.y)/Kt)+(Kt<0?Math.PI:0),Wr=Math.sin(Tr),hi=Math.cos(Tr);Fe=hi,Ve=Wr,Xe=-Wr,at=hi}else if(!de&&ue){const sr=ri(this.transform);Fe=sr.vecEast[0],Ve=sr.vecEast[1],Xe=sr.vecSouth[0],at=sr.vecSouth[1]}let pt=ve.x,yt=ve.y,mt=Z;ue&&(pt=ot,yt=lt,mt=Math.pow(2,-(this.transform.zoom-Q.overscaledZ)),mt*=this.transform.getPitchedTextCorrection(ot,lt,ie),Re||(mt*=R.ah(.5+ve.signedDistanceFromCamera/this.transform.cameraToCenterDistance*.5,0,4))),Re&&(pt+=Fe*Re.x*mt+Xe*Re.y*mt,yt+=Ve*Re.x*mt+at*Re.y*mt);const xt=t.x1*mt,It=t.x2*mt,gt=(xt+It)/2,Ot=t.y1*mt,zt=t.y2*mt,kt=(Ot+zt)/2,Bt=[{offsetX:xt,offsetY:Ot},{offsetX:gt,offsetY:Ot},{offsetX:It,offsetY:Ot},{offsetX:It,offsetY:kt},{offsetX:It,offsetY:zt},{offsetX:gt,offsetY:zt},{offsetX:xt,offsetY:zt},{offsetX:xt,offsetY:kt}];let Nt=[];for(const{offsetX:sr,offsetY:Kt}of Bt)Nt.push(new R.P(pt+Fe*sr+Xe*Kt,yt+Ve*sr+at*Kt));let ar=!1;if(ue){const sr=Nt.map((Kt=>this.projectAndGetPerspectiveRatio(Kt.x,Kt.y,ie,qe,Le)));ar=sr.some((Kt=>!Kt.isOccluded)),Nt=sr.map((Kt=>new R.P(Kt.x,Kt.y)))}else ar=!0;return{box:R.aA(Nt),allPointsOccluded:!ar}}}class Kr{constructor(t,Z,Q,ie){this.opacity=t?Math.max(0,Math.min(1,t.opacity+(t.placed?Z:-Z))):ie&&Q?1:0,this.placed=Q}isHidden(){return this.opacity===0&&!this.placed}}class cn{constructor(t,Z,Q,ie,ue){this.text=new Kr(t?t.text:null,Z,Q,ue),this.icon=new Kr(t?t.icon:null,Z,ie,ue)}isHidden(){return this.text.isHidden()&&this.icon.isHidden()}}class Gn{constructor(t,Z,Q){this.text=t,this.icon=Z,this.skipFade=Q}}class Ba{constructor(t,Z,Q,ie,ue){this.bucketInstanceId=t,this.featureIndex=Z,this.sourceLayerIndex=Q,this.bucketIndex=ie,this.tileID=ue}}class $n{constructor(t){this.crossSourceCollisions=t,this.maxGroupID=0,this.collisionGroups={}}get(t){if(this.crossSourceCollisions)return{ID:0,predicate:null};if(!this.collisionGroups[t]){const Z=++this.maxGroupID;this.collisionGroups[t]={ID:Z,predicate:Q=>Q.collisionGroupID===Z}}return this.collisionGroups[t]}}function xn(se,t,Z,Q,ie){const{horizontalAlign:ue,verticalAlign:de}=R.aH(se);return new R.P(-(ue-.5)*t+Q[0]*ie,-(de-.5)*Z+Q[1]*ie)}class pu{constructor(t,Z,Q,ie,ue){this.transform=t.clone(),this.terrain=Z,this.collisionIndex=new rr(this.transform),this.placements={},this.opacities={},this.variableOffsets={},this.stale=!1,this.commitTime=0,this.fadeDuration=Q,this.retainedQueryData={},this.collisionGroups=new $n(ie),this.collisionCircleArrays={},this.collisionBoxArrays=new Map,this.prevPlacement=ue,ue&&(ue.prevPlacement=void 0),this.placedOrientations={}}_getTerrainElevationFunc(t){const Z=this.terrain;return Z?(Q,ie)=>Z.getElevation(t,Q,ie):null}getBucketParts(t,Z,Q,ie){const ue=Q.getBucket(Z),de=Q.latestFeatureIndex;if(!ue||!de||Z.id!==ue.layerIds[0])return;const ge=Q.collisionBoxArray,ve=ue.layers[0].layout,qe=ue.layers[0].paint,Re=Math.pow(2,this.transform.zoom-Q.tileID.overscaledZ),Le=Q.tileSize/R.$,Fe=Q.tileID.toUnwrapped(),Ve=ve.get("text-rotation-alignment")==="map",Xe=R.aC(Q,1,this.transform.zoom),at=R.aD(this.collisionIndex.transform,Q,qe.get("text-translate"),qe.get("text-translate-anchor")),ot=R.aD(this.collisionIndex.transform,Q,qe.get("icon-translate"),qe.get("icon-translate-anchor")),lt=Jr(Ve,this.transform,Xe);this.retainedQueryData[ue.bucketInstanceId]=new Ba(ue.bucketInstanceId,de,ue.sourceLayerIndex,ue.index,Q.tileID);const pt={bucket:ue,layout:ve,translationText:at,translationIcon:ot,unwrappedTileID:Fe,pitchedLabelPlaneMatrix:lt,scale:Re,textPixelRatio:Le,holdingForFade:Q.holdingForSymbolFade(),collisionBoxArray:ge,partiallyEvaluatedTextSize:R.an(ue.textSizeData,this.transform.zoom),collisionGroup:this.collisionGroups.get(ue.sourceID)};if(ie)for(const yt of ue.sortKeyRanges){const{sortKey:mt,symbolInstanceStart:xt,symbolInstanceEnd:It}=yt;t.push({sortKey:mt,symbolInstanceStart:xt,symbolInstanceEnd:It,parameters:pt})}else t.push({symbolInstanceStart:0,symbolInstanceEnd:ue.symbolInstances.length,parameters:pt})}attemptAnchorPlacement(t,Z,Q,ie,ue,de,ge,ve,qe,Re,Le,Fe,Ve,Xe,at,ot,lt,pt,yt,mt){const xt=R.aE[t.textAnchor],It=[t.textOffset0,t.textOffset1],gt=xn(xt,Q,ie,It,ue),Ot=this.collisionIndex.placeCollisionBox(Z,Fe,ve,qe,Re,ge,de,ot,Le.predicate,yt,gt,mt);if((!pt||this.collisionIndex.placeCollisionBox(pt,Fe,ve,qe,Re,ge,de,lt,Le.predicate,yt,gt,mt).placeable)&&Ot.placeable){let zt;if(this.prevPlacement&&this.prevPlacement.variableOffsets[Ve.crossTileID]&&this.prevPlacement.placements[Ve.crossTileID]&&this.prevPlacement.placements[Ve.crossTileID].text&&(zt=this.prevPlacement.variableOffsets[Ve.crossTileID].anchor),Ve.crossTileID===0)throw new Error("symbolInstance.crossTileID can't be 0");return this.variableOffsets[Ve.crossTileID]={textOffset:It,width:Q,height:ie,anchor:xt,textBoxScale:ue,prevAnchor:zt},this.markUsedJustification(Xe,xt,Ve,at),Xe.allowVerticalPlacement&&(this.markUsedOrientation(Xe,at,Ve),this.placedOrientations[Ve.crossTileID]=at),{shift:gt,placedGlyphBoxes:Ot}}}placeLayerBucketPart(t,Z,Q){const{bucket:ie,layout:ue,translationText:de,translationIcon:ge,unwrappedTileID:ve,pitchedLabelPlaneMatrix:qe,textPixelRatio:Re,holdingForFade:Le,collisionBoxArray:Fe,partiallyEvaluatedTextSize:Ve,collisionGroup:Xe}=t.parameters,at=ue.get("text-optional"),ot=ue.get("icon-optional"),lt=R.aF(ue,"text-overlap","text-allow-overlap"),pt=lt==="always",yt=R.aF(ue,"icon-overlap","icon-allow-overlap"),mt=yt==="always",xt=ue.get("text-rotation-alignment")==="map",It=ue.get("text-pitch-alignment")==="map",gt=ue.get("icon-text-fit")!=="none",Ot=ue.get("symbol-z-order")==="viewport-y",zt=pt&&(mt||!ie.hasIconData()||ot),kt=mt&&(pt||!ie.hasTextData()||at);!ie.collisionArrays&&Fe&&ie.deserializeCollisionBoxes(Fe);const Bt=this.retainedQueryData[ie.bucketInstanceId].tileID,Nt=this._getTerrainElevationFunc(Bt),ar=this.transform.getFastPathSimpleProjectionMatrix(Bt),sr=(Kt,Tr,Wr)=>{var hi,di;if(Z[Kt.crossTileID])return;if(Le)return void(this.placements[Kt.crossTileID]=new Gn(!1,!1,!1));let _i=!1,Ri=!1,gi=!0,si=null,Ei={box:null,placeable:!1,offscreen:null,occluded:!1},rn={placeable:!1},ki=null,Li=null,_n=null,ha=0,Bn=0,da=0;Tr.textFeatureIndex?ha=Tr.textFeatureIndex:Kt.useRuntimeCollisionCircles&&(ha=Kt.featureIndex),Tr.verticalTextFeatureIndex&&(Bn=Tr.verticalTextFeatureIndex);const Da=Tr.textBox;if(Da){const Sn=Fi=>{let Ui=R.ao.horizontal;if(ie.allowVerticalPlacement&&!Fi&&this.prevPlacement){const qn=this.prevPlacement.placedOrientations[Kt.crossTileID];qn&&(this.placedOrientations[Kt.crossTileID]=qn,Ui=qn,this.markUsedOrientation(ie,Ui,Kt))}return Ui},Zn=(Fi,Ui)=>{if(ie.allowVerticalPlacement&&Kt.numVerticalGlyphVertices>0&&Tr.verticalTextBox){for(const qn of ie.writingModes)if(qn===R.ao.vertical?(Ei=Ui(),rn=Ei):Ei=Fi(),Ei&&Ei.placeable)break}else Ei=Fi()},Kn=Kt.textAnchorOffsetStartIndex,En=Kt.textAnchorOffsetEndIndex;if(En===Kn){const Fi=(Ui,qn)=>{const Zi=this.collisionIndex.placeCollisionBox(Ui,lt,Re,Bt,ve,It,xt,de,Xe.predicate,Nt,void 0,ar);return Zi&&Zi.placeable&&(this.markUsedOrientation(ie,qn,Kt),this.placedOrientations[Kt.crossTileID]=qn),Zi};Zn((()=>Fi(Da,R.ao.horizontal)),(()=>{const Ui=Tr.verticalTextBox;return ie.allowVerticalPlacement&&Kt.numVerticalGlyphVertices>0&&Ui?Fi(Ui,R.ao.vertical):{box:null,offscreen:null}})),Sn(Ei&&Ei.placeable)}else{let Fi=R.aE[(di=(hi=this.prevPlacement)===null||hi===void 0?void 0:hi.variableOffsets[Kt.crossTileID])===null||di===void 0?void 0:di.anchor];const Ui=(Zi,Zl,Go)=>{const Fa=Zi.x2-Zi.x1,ea=Zi.y2-Zi.y1,Nn=Kt.textBoxScale,fa=gt&&yt==="never"?Zl:null;let pa=null,Kl=lt==="never"?1:2,Xl="never";Fi&&Kl++;for(let _a=0;_a<Kl;_a++){for(let Yl=Kn;Yl<En;Yl++){const Jl=ie.textAnchorOffsets.get(Yl);if(Fi&&Jl.textAnchor!==Fi)continue;const $o=this.attemptAnchorPlacement(Jl,Zi,Fa,ea,Nn,xt,It,Re,Bt,ve,Xe,Xl,Kt,ie,Go,de,ge,fa,Nt);if($o&&(pa=$o.placedGlyphBoxes,pa&&pa.placeable))return _i=!0,si=$o.shift,pa}Fi?Fi=null:Xl=lt}return Q&&!pa&&(pa={box:this.collisionIndex.placeCollisionBox(Da,"always",Re,Bt,ve,It,xt,de,Xe.predicate,Nt,void 0,ar).box,offscreen:!1,placeable:!1,occluded:!1}),pa};Zn((()=>Ui(Da,Tr.iconBox,R.ao.horizontal)),(()=>{const Zi=Tr.verticalTextBox;return ie.allowVerticalPlacement&&(!Ei||!Ei.placeable)&&Kt.numVerticalGlyphVertices>0&&Zi?Ui(Zi,Tr.verticalIconBox,R.ao.vertical):{box:null,occluded:!0,offscreen:null}})),Ei&&(_i=Ei.placeable,gi=Ei.offscreen);const qn=Sn(Ei&&Ei.placeable);if(!_i&&this.prevPlacement){const Zi=this.prevPlacement.variableOffsets[Kt.crossTileID];Zi&&(this.variableOffsets[Kt.crossTileID]=Zi,this.markUsedJustification(ie,Zi.anchor,Kt,qn))}}}if(ki=Ei,_i=ki&&ki.placeable,gi=ki&&ki.offscreen,Kt.useRuntimeCollisionCircles&&Kt.centerJustifiedTextSymbolIndex>=0){const Sn=ie.text.placedSymbolArray.get(Kt.centerJustifiedTextSymbolIndex),Zn=R.ap(ie.textSizeData,Ve,Sn),Kn=ue.get("text-padding");Li=this.collisionIndex.placeCollisionCircles(lt,Sn,ie.lineVertexArray,ie.glyphOffsetArray,Zn,ve,qe,Q,It,Xe.predicate,Kt.collisionCircleDiameter,Kn,de,Nt),Li.circles.length&&Li.collisionDetected&&!Q&&R.w("Collisions detected, but collision boxes are not shown"),_i=pt||Li.circles.length>0&&!Li.collisionDetected,gi=gi&&Li.offscreen}if(Tr.iconFeatureIndex&&(da=Tr.iconFeatureIndex),Tr.iconBox){const Sn=Zn=>this.collisionIndex.placeCollisionBox(Zn,yt,Re,Bt,ve,It,xt,ge,Xe.predicate,Nt,gt&&si?si:void 0,ar);rn&&rn.placeable&&Tr.verticalIconBox?(_n=Sn(Tr.verticalIconBox),Ri=_n.placeable):(_n=Sn(Tr.iconBox),Ri=_n.placeable),gi=gi&&_n.offscreen}const Us=at||Kt.numHorizontalGlyphVertices===0&&Kt.numVerticalGlyphVertices===0,uo=ot||Kt.numIconVertices===0;Us||uo?uo?Us||(Ri=Ri&&_i):_i=Ri&&_i:Ri=_i=Ri&&_i;const Qn=Ri&&_n.placeable;if(_i&&ki.placeable&&this.collisionIndex.insertCollisionBox(ki.box,lt,ue.get("text-ignore-placement"),ie.bucketInstanceId,rn&&rn.placeable&&Bn?Bn:ha,Xe.ID),Qn&&this.collisionIndex.insertCollisionBox(_n.box,yt,ue.get("icon-ignore-placement"),ie.bucketInstanceId,da,Xe.ID),Li&&_i&&this.collisionIndex.insertCollisionCircles(Li.circles,lt,ue.get("text-ignore-placement"),ie.bucketInstanceId,ha,Xe.ID),Q&&this.storeCollisionData(ie.bucketInstanceId,Wr,Tr,ki,_n,Li),Kt.crossTileID===0)throw new Error("symbolInstance.crossTileID can't be 0");if(ie.bucketInstanceId===0)throw new Error("bucket.bucketInstanceId can't be 0");this.placements[Kt.crossTileID]=new Gn((_i||zt)&&!(ki!=null&&ki.occluded),(Ri||kt)&&!(_n!=null&&_n.occluded),gi||ie.justReloaded),Z[Kt.crossTileID]=!0};if(Ot){if(t.symbolInstanceStart!==0)throw new Error("bucket.bucketInstanceId should be 0");const Kt=ie.getSortedSymbolIndexes(-this.transform.bearingInRadians);for(let Tr=Kt.length-1;Tr>=0;--Tr){const Wr=Kt[Tr];sr(ie.symbolInstances.get(Wr),ie.collisionArrays[Wr],Wr)}}else for(let Kt=t.symbolInstanceStart;Kt<t.symbolInstanceEnd;Kt++)sr(ie.symbolInstances.get(Kt),ie.collisionArrays[Kt],Kt);ie.justReloaded=!1}storeCollisionData(t,Z,Q,ie,ue,de){if(Q.textBox||Q.iconBox){let ge,ve;this.collisionBoxArrays.has(t)?ge=this.collisionBoxArrays.get(t):(ge=new Map,this.collisionBoxArrays.set(t,ge)),ge.has(Z)?ve=ge.get(Z):(ve={text:null,icon:null},ge.set(Z,ve)),Q.textBox&&(ve.text=ie.box),Q.iconBox&&(ve.icon=ue.box)}if(de){let ge=this.collisionCircleArrays[t];ge===void 0&&(ge=this.collisionCircleArrays[t]=[]);for(let ve=0;ve<de.circles.length;ve+=4)ge.push(de.circles[ve+0]-ui),ge.push(de.circles[ve+1]-ui),ge.push(de.circles[ve+2]),ge.push(de.collisionDetected?1:0)}}markUsedJustification(t,Z,Q,ie){let ue;ue=ie===R.ao.vertical?Q.verticalPlacedTextSymbolIndex:{left:Q.leftJustifiedTextSymbolIndex,center:Q.centerJustifiedTextSymbolIndex,right:Q.rightJustifiedTextSymbolIndex}[R.aG(Z)];const de=[Q.leftJustifiedTextSymbolIndex,Q.centerJustifiedTextSymbolIndex,Q.rightJustifiedTextSymbolIndex,Q.verticalPlacedTextSymbolIndex];for(const ge of de)ge>=0&&(t.text.placedSymbolArray.get(ge).crossTileID=ue>=0&&ge!==ue?0:Q.crossTileID)}markUsedOrientation(t,Z,Q){const ie=Z===R.ao.horizontal||Z===R.ao.horizontalOnly?Z:0,ue=Z===R.ao.vertical?Z:0,de=[Q.leftJustifiedTextSymbolIndex,Q.centerJustifiedTextSymbolIndex,Q.rightJustifiedTextSymbolIndex];for(const ge of de)t.text.placedSymbolArray.get(ge).placedOrientation=ie;Q.verticalPlacedTextSymbolIndex&&(t.text.placedSymbolArray.get(Q.verticalPlacedTextSymbolIndex).placedOrientation=ue)}commit(t){this.commitTime=t,this.zoomAtLastRecencyCheck=this.transform.zoom;const Z=this.prevPlacement;let Q=!1;this.prevZoomAdjustment=Z?Z.zoomAdjustment(this.transform.zoom):0;const ie=Z?Z.symbolFadeChange(t):1,ue=Z?Z.opacities:{},de=Z?Z.variableOffsets:{},ge=Z?Z.placedOrientations:{};for(const ve in this.placements){const qe=this.placements[ve],Re=ue[ve];Re?(this.opacities[ve]=new cn(Re,ie,qe.text,qe.icon),Q=Q||qe.text!==Re.text.placed||qe.icon!==Re.icon.placed):(this.opacities[ve]=new cn(null,ie,qe.text,qe.icon,qe.skipFade),Q=Q||qe.text||qe.icon)}for(const ve in ue){const qe=ue[ve];if(!this.opacities[ve]){const Re=new cn(qe,ie,!1,!1);Re.isHidden()||(this.opacities[ve]=Re,Q=Q||qe.text.placed||qe.icon.placed)}}for(const ve in de)this.variableOffsets[ve]||!this.opacities[ve]||this.opacities[ve].isHidden()||(this.variableOffsets[ve]=de[ve]);for(const ve in ge)this.placedOrientations[ve]||!this.opacities[ve]||this.opacities[ve].isHidden()||(this.placedOrientations[ve]=ge[ve]);if(Z&&Z.lastPlacementChangeTime===void 0)throw new Error("Last placement time for previous placement is not defined");Q?this.lastPlacementChangeTime=t:typeof this.lastPlacementChangeTime!="number"&&(this.lastPlacementChangeTime=Z?Z.lastPlacementChangeTime:t)}updateLayerOpacities(t,Z){const Q={};for(const ie of Z){const ue=ie.getBucket(t);ue&&ie.latestFeatureIndex&&t.id===ue.layerIds[0]&&this.updateBucketOpacities(ue,ie.tileID,Q,ie.collisionBoxArray)}}updateBucketOpacities(t,Z,Q,ie){t.hasTextData()&&(t.text.opacityVertexArray.clear(),t.text.hasVisibleVertices=!1),t.hasIconData()&&(t.icon.opacityVertexArray.clear(),t.icon.hasVisibleVertices=!1),t.hasIconCollisionBoxData()&&t.iconCollisionBox.collisionVertexArray.clear(),t.hasTextCollisionBoxData()&&t.textCollisionBox.collisionVertexArray.clear();const ue=t.layers[0],de=ue.layout,ge=new cn(null,0,!1,!1,!0),ve=de.get("text-allow-overlap"),qe=de.get("icon-allow-overlap"),Re=ue._unevaluatedLayout.hasValue("text-variable-anchor")||ue._unevaluatedLayout.hasValue("text-variable-anchor-offset"),Le=de.get("text-rotation-alignment")==="map",Fe=de.get("text-pitch-alignment")==="map",Ve=de.get("icon-text-fit")!=="none",Xe=new cn(null,0,ve&&(qe||!t.hasIconData()||de.get("icon-optional")),qe&&(ve||!t.hasTextData()||de.get("text-optional")),!0);!t.collisionArrays&&ie&&(t.hasIconCollisionBoxData()||t.hasTextCollisionBoxData())&&t.deserializeCollisionBoxes(ie);const at=(lt,pt,yt)=>{for(let mt=0;mt<pt/4;mt++)lt.opacityVertexArray.emplaceBack(yt);lt.hasVisibleVertices=lt.hasVisibleVertices||yt!==ya},ot=this.collisionBoxArrays.get(t.bucketInstanceId);for(let lt=0;lt<t.symbolInstances.length;lt++){const pt=t.symbolInstances.get(lt),{numHorizontalGlyphVertices:yt,numVerticalGlyphVertices:mt,crossTileID:xt}=pt;let It=this.opacities[xt];Q[xt]?It=ge:It||(It=Xe,this.opacities[xt]=It),Q[xt]=!0;const gt=pt.numIconVertices>0,Ot=this.placedOrientations[pt.crossTileID],zt=Ot===R.ao.vertical,kt=Ot===R.ao.horizontal||Ot===R.ao.horizontalOnly;if(yt>0||mt>0){const Nt=ol(It.text);at(t.text,yt,zt?ya:Nt),at(t.text,mt,kt?ya:Nt);const ar=It.text.isHidden();[pt.rightJustifiedTextSymbolIndex,pt.centerJustifiedTextSymbolIndex,pt.leftJustifiedTextSymbolIndex].forEach((Tr=>{Tr>=0&&(t.text.placedSymbolArray.get(Tr).hidden=ar||zt?1:0)})),pt.verticalPlacedTextSymbolIndex>=0&&(t.text.placedSymbolArray.get(pt.verticalPlacedTextSymbolIndex).hidden=ar||kt?1:0);const sr=this.variableOffsets[pt.crossTileID];sr&&this.markUsedJustification(t,sr.anchor,pt,Ot);const Kt=this.placedOrientations[pt.crossTileID];Kt&&(this.markUsedJustification(t,"left",pt,Kt),this.markUsedOrientation(t,Kt,pt))}if(gt){const Nt=ol(It.icon),ar=!(Ve&&pt.verticalPlacedIconSymbolIndex&&zt);pt.placedIconSymbolIndex>=0&&(at(t.icon,pt.numIconVertices,ar?Nt:ya),t.icon.placedSymbolArray.get(pt.placedIconSymbolIndex).hidden=It.icon.isHidden()),pt.verticalPlacedIconSymbolIndex>=0&&(at(t.icon,pt.numVerticalIconVertices,ar?ya:Nt),t.icon.placedSymbolArray.get(pt.verticalPlacedIconSymbolIndex).hidden=It.icon.isHidden())}const Bt=ot&&ot.has(lt)?ot.get(lt):{text:null,icon:null};if(t.hasIconCollisionBoxData()||t.hasTextCollisionBoxData()){const Nt=t.collisionArrays[lt];if(Nt){let ar=new R.P(0,0);if(Nt.textBox||Nt.verticalTextBox){let sr=!0;if(Re){const Kt=this.variableOffsets[xt];Kt?(ar=xn(Kt.anchor,Kt.width,Kt.height,Kt.textOffset,Kt.textBoxScale),Le&&ar._rotate(Fe?-this.transform.bearingInRadians:this.transform.bearingInRadians)):sr=!1}if(Nt.textBox||Nt.verticalTextBox){let Kt;Nt.textBox&&(Kt=zt),Nt.verticalTextBox&&(Kt=kt),al(t.textCollisionBox.collisionVertexArray,It.text.placed,!sr||Kt,Bt.text,ar.x,ar.y)}}if(Nt.iconBox||Nt.verticalIconBox){const sr=!!(!kt&&Nt.verticalIconBox);let Kt;Nt.iconBox&&(Kt=sr),Nt.verticalIconBox&&(Kt=!sr),al(t.iconCollisionBox.collisionVertexArray,It.icon.placed,Kt,Bt.icon,Ve?ar.x:0,Ve?ar.y:0)}}}}if(t.sortFeatures(-this.transform.bearingInRadians),this.retainedQueryData[t.bucketInstanceId]&&(this.retainedQueryData[t.bucketInstanceId].featureSortOrder=t.featureSortOrder),t.hasTextData()&&t.text.opacityVertexBuffer&&t.text.opacityVertexBuffer.updateData(t.text.opacityVertexArray),t.hasIconData()&&t.icon.opacityVertexBuffer&&t.icon.opacityVertexBuffer.updateData(t.icon.opacityVertexArray),t.hasIconCollisionBoxData()&&t.iconCollisionBox.collisionVertexBuffer&&t.iconCollisionBox.collisionVertexBuffer.updateData(t.iconCollisionBox.collisionVertexArray),t.hasTextCollisionBoxData()&&t.textCollisionBox.collisionVertexBuffer&&t.textCollisionBox.collisionVertexBuffer.updateData(t.textCollisionBox.collisionVertexArray),t.text.opacityVertexArray.length!==t.text.layoutVertexArray.length/4)throw new Error(`bucket.text.opacityVertexArray.length (= ${t.text.opacityVertexArray.length}) !== bucket.text.layoutVertexArray.length (= ${t.text.layoutVertexArray.length}) / 4`);if(t.icon.opacityVertexArray.length!==t.icon.layoutVertexArray.length/4)throw new Error(`bucket.icon.opacityVertexArray.length (= ${t.icon.opacityVertexArray.length}) !== bucket.icon.layoutVertexArray.length (= ${t.icon.layoutVertexArray.length}) / 4`);t.bucketInstanceId in this.collisionCircleArrays&&(t.collisionCircleArray=this.collisionCircleArrays[t.bucketInstanceId],delete this.collisionCircleArrays[t.bucketInstanceId])}symbolFadeChange(t){return this.fadeDuration===0?1:(t-this.commitTime)/this.fadeDuration+this.prevZoomAdjustment}zoomAdjustment(t){return Math.max(0,(this.transform.zoom-t)/1.5)}hasTransitions(t){return this.stale||t-this.lastPlacementChangeTime<this.fadeDuration}stillRecent(t,Z){const Q=this.zoomAtLastRecencyCheck===Z?1-this.zoomAdjustment(Z):1;return this.zoomAtLastRecencyCheck=Z,this.commitTime+this.fadeDuration*Q>t}setStale(){this.stale=!0}}function al(se,t,Z,Q,ie,ue){Q&&Q.length!==0||(Q=[0,0,0,0]);const de=Q[0]-ui,ge=Q[1]-ui,ve=Q[2]-ui,qe=Q[3]-ui;se.emplaceBack(t?1:0,Z?1:0,ie||0,ue||0,de,ge),se.emplaceBack(t?1:0,Z?1:0,ie||0,ue||0,ve,ge),se.emplaceBack(t?1:0,Z?1:0,ie||0,ue||0,ve,qe),se.emplaceBack(t?1:0,Z?1:0,ie||0,ue||0,de,qe)}const _u=Math.pow(2,25),Na=Math.pow(2,24),mu=Math.pow(2,17),Ic=Math.pow(2,16),Rc=Math.pow(2,9),Ac=Math.pow(2,8),yu=Math.pow(2,1);function ol(se){if(se.opacity===0&&!se.placed)return 0;if(se.opacity===1&&se.placed)return 4294967295;const t=se.placed?1:0,Z=Math.floor(127*se.opacity);return Z*_u+t*Na+Z*mu+t*Ic+Z*Rc+t*Ac+Z*yu+t}const ya=0;class sl{constructor(t){this._sortAcrossTiles=t.layout.get("symbol-z-order")!=="viewport-y"&&!t.layout.get("symbol-sort-key").isConstant(),this._currentTileIndex=0,this._currentPartIndex=0,this._seenCrossTileIDs={},this._bucketParts=[]}continuePlacement(t,Z,Q,ie,ue){const de=this._bucketParts;for(;this._currentTileIndex<t.length;)if(Z.getBucketParts(de,ie,t[this._currentTileIndex],this._sortAcrossTiles),this._currentTileIndex++,ue())return!0;for(this._sortAcrossTiles&&(this._sortAcrossTiles=!1,de.sort(((ge,ve)=>ge.sortKey-ve.sortKey)));this._currentPartIndex<de.length;)if(Z.placeLayerBucketPart(de[this._currentPartIndex],this._seenCrossTileIDs,Q),this._currentPartIndex++,ue())return!0;return!1}}class gu{constructor(t,Z,Q,ie,ue,de,ge,ve){this.placement=new pu(t,Z,de,ge,ve),this._currentPlacementIndex=Q.length-1,this._forceFullPlacement=ie,this._showCollisionBoxes=ue,this._done=!1}isDone(){return this._done}continuePlacement(t,Z,Q){const ie=_e.now(),ue=()=>!this._forceFullPlacement&&_e.now()-ie>2;for(;this._currentPlacementIndex>=0;){const de=Z[t[this._currentPlacementIndex]],ge=this.placement.collisionIndex.transform.zoom;if(de.type==="symbol"&&(!de.minzoom||de.minzoom<=ge)&&(!de.maxzoom||de.maxzoom>ge)){if(this._inProgressLayer||(this._inProgressLayer=new sl(de)),this._inProgressLayer.continuePlacement(Q[de.source],this.placement,this._showCollisionBoxes,de,ue))return;delete this._inProgressLayer}this._currentPlacementIndex--}this._done=!0}commit(t){return this.placement.commit(t),this.placement}}const ga=512/R.$/2;class ll{constructor(t,Z,Q){this.tileID=t,this.bucketInstanceId=Q,this._symbolsByKey={};const ie=new Map;for(let ue=0;ue<Z.length;ue++){const de=Z.get(ue),ge=de.key,ve=ie.get(ge);ve?ve.push(de):ie.set(ge,[de])}for(const[ue,de]of ie){const ge={positions:de.map((ve=>({x:Math.floor(ve.anchorX*ga),y:Math.floor(ve.anchorY*ga)}))),crossTileIDs:de.map((ve=>ve.crossTileID))};if(ge.positions.length>128){const ve=new R.aI(ge.positions.length,16,Uint16Array);for(const{x:qe,y:Re}of ge.positions)ve.add(qe,Re);ve.finish(),delete ge.positions,ge.index=ve}this._symbolsByKey[ue]=ge}}getScaledCoordinates(t,Z){const{x:Q,y:ie,z:ue}=this.tileID.canonical,{x:de,y:ge,z:ve}=Z.canonical,qe=ga/Math.pow(2,ve-ue),Re=(ge*R.$+t.anchorY)*qe,Le=ie*R.$*ga;return{x:Math.floor((de*R.$+t.anchorX)*qe-Q*R.$*ga),y:Math.floor(Re-Le)}}findMatches(t,Z,Q){const ie=this.tileID.canonical.z<Z.canonical.z?1:Math.pow(2,this.tileID.canonical.z-Z.canonical.z);for(let ue=0;ue<t.length;ue++){const de=t.get(ue);if(de.crossTileID)continue;const ge=this._symbolsByKey[de.key];if(!ge)continue;const ve=this.getScaledCoordinates(de,Z);if(ge.index){const qe=ge.index.range(ve.x-ie,ve.y-ie,ve.x+ie,ve.y+ie).sort();for(const Re of qe){const Le=ge.crossTileIDs[Re];if(!Q[Le]){Q[Le]=!0,de.crossTileID=Le;break}}}else if(ge.positions)for(let qe=0;qe<ge.positions.length;qe++){const Re=ge.positions[qe],Le=ge.crossTileIDs[qe];if(Math.abs(Re.x-ve.x)<=ie&&Math.abs(Re.y-ve.y)<=ie&&!Q[Le]){Q[Le]=!0,de.crossTileID=Le;break}}}}getCrossTileIDsLists(){return Object.values(this._symbolsByKey).map((({crossTileIDs:t})=>t))}}class Pc{constructor(){this.maxCrossTileID=0}generate(){return++this.maxCrossTileID}}class _o{constructor(){this.indexes={},this.usedCrossTileIDs={},this.lng=0}handleWrapJump(t){const Z=Math.round((t-this.lng)/360);if(Z!==0)for(const Q in this.indexes){const ie=this.indexes[Q],ue={};for(const de in ie){const ge=ie[de];ge.tileID=ge.tileID.unwrapTo(ge.tileID.wrap+Z),ue[ge.tileID.key]=ge}this.indexes[Q]=ue}this.lng=t}addBucket(t,Z,Q){if(this.indexes[t.overscaledZ]&&this.indexes[t.overscaledZ][t.key]){if(this.indexes[t.overscaledZ][t.key].bucketInstanceId===Z.bucketInstanceId)return!1;this.removeBucketCrossTileIDs(t.overscaledZ,this.indexes[t.overscaledZ][t.key])}for(let ue=0;ue<Z.symbolInstances.length;ue++)Z.symbolInstances.get(ue).crossTileID=0;this.usedCrossTileIDs[t.overscaledZ]||(this.usedCrossTileIDs[t.overscaledZ]={});const ie=this.usedCrossTileIDs[t.overscaledZ];for(const ue in this.indexes){const de=this.indexes[ue];if(Number(ue)>t.overscaledZ)for(const ge in de){const ve=de[ge];ve.tileID.isChildOf(t)&&ve.findMatches(Z.symbolInstances,t,ie)}else{const ge=de[t.scaledTo(Number(ue)).key];ge&&ge.findMatches(Z.symbolInstances,t,ie)}}for(let ue=0;ue<Z.symbolInstances.length;ue++){const de=Z.symbolInstances.get(ue);de.crossTileID||(de.crossTileID=Q.generate(),ie[de.crossTileID]=!0)}return this.indexes[t.overscaledZ]===void 0&&(this.indexes[t.overscaledZ]={}),this.indexes[t.overscaledZ][t.key]=new ll(t,Z.symbolInstances,Z.bucketInstanceId),!0}removeBucketCrossTileIDs(t,Z){for(const Q of Z.getCrossTileIDsLists())for(const ie of Q)delete this.usedCrossTileIDs[t][ie]}removeStaleBuckets(t){let Z=!1;for(const Q in this.indexes){const ie=this.indexes[Q];for(const ue in ie)t[ie[ue].bucketInstanceId]||(this.removeBucketCrossTileIDs(Q,ie[ue]),delete ie[ue],Z=!0)}return Z}}class mo{constructor(){this.layerIndexes={},this.crossTileIDs=new Pc,this.maxBucketInstanceId=0,this.bucketsInCurrentPlacement={}}addLayer(t,Z,Q){let ie=this.layerIndexes[t.id];ie===void 0&&(ie=this.layerIndexes[t.id]=new _o);let ue=!1;const de={};ie.handleWrapJump(Q);for(const ge of Z){const ve=ge.getBucket(t);ve&&t.id===ve.layerIds[0]&&(ve.bucketInstanceId||(ve.bucketInstanceId=++this.maxBucketInstanceId),ie.addBucket(ge.tileID,ve,this.crossTileIDs)&&(ue=!0),de[ve.bucketInstanceId]=!0)}return ie.removeStaleBuckets(de)&&(ue=!0),ue}pruneUnusedLayers(t){const Z={};t.forEach((Q=>{Z[Q]=!0}));for(const Q in this.layerIndexes)Z[Q]||delete this.layerIndexes[Q]}}var ul="void main() {fragColor=vec4(1.0);}";const hn={prelude:oi(`#ifdef GL_ES
precision mediump float;
#else
#if !defined(lowp)
#define lowp
#endif
#if !defined(mediump)
#define mediump
#endif
#if !defined(highp)
#define highp
#endif
#endif
out highp vec4 fragColor;`,`#ifdef GL_ES
precision highp float;
#else
#if !defined(lowp)
#define lowp
#endif
#if !defined(mediump)
#define mediump
#endif
#if !defined(highp)
#define highp
#endif
#endif
vec2 unpack_float(const float packedValue) {int packedIntValue=int(packedValue);int v0=packedIntValue/256;return vec2(v0,packedIntValue-v0*256);}vec2 unpack_opacity(const float packedOpacity) {int intOpacity=int(packedOpacity)/2;return vec2(float(intOpacity)/127.0,mod(packedOpacity,2.0));}vec4 decode_color(const vec2 encodedColor) {return vec4(unpack_float(encodedColor[0])/255.0,unpack_float(encodedColor[1])/255.0
);}float unpack_mix_vec2(const vec2 packedValue,const float t) {return mix(packedValue[0],packedValue[1],t);}vec4 unpack_mix_color(const vec4 packedColors,const float t) {vec4 minColor=decode_color(vec2(packedColors[0],packedColors[1]));vec4 maxColor=decode_color(vec2(packedColors[2],packedColors[3]));return mix(minColor,maxColor,t);}vec2 get_pattern_pos(const vec2 pixel_coord_upper,const vec2 pixel_coord_lower,const vec2 pattern_size,const float tile_units_to_pixels,const vec2 pos) {vec2 offset=mod(mod(mod(pixel_coord_upper,pattern_size)*256.0,pattern_size)*256.0+pixel_coord_lower,pattern_size);return (tile_units_to_pixels*pos+offset)/pattern_size;}mat3 rotationMatrixFromAxisAngle(vec3 u,float angle) {float c=cos(angle);float s=sin(angle);float c2=1.0-c;return mat3(u.x*u.x*c2+      c,u.x*u.y*c2-u.z*s,u.x*u.z*c2+u.y*s,u.y*u.x*c2+u.z*s,u.y*u.y*c2+    c,u.y*u.z*c2-u.x*s,u.z*u.x*c2-u.y*s,u.z*u.y*c2+u.x*s,u.z*u.z*c2+    c
);}
#ifdef TERRAIN3D
uniform sampler2D u_terrain;uniform float u_terrain_dim;uniform mat4 u_terrain_matrix;uniform vec4 u_terrain_unpack;uniform float u_terrain_exaggeration;uniform highp sampler2D u_depth;
#endif
const highp vec4 bitSh=vec4(256.*256.*256.,256.*256.,256.,1.);const highp vec4 bitShifts=vec4(1.)/bitSh;highp float unpack(highp vec4 color) {return dot(color,bitShifts);}highp float depthOpacity(vec3 frag) {
#ifdef TERRAIN3D
highp float d=unpack(texture(u_depth,frag.xy*0.5+0.5))+0.0001-frag.z;return 1.0-max(0.0,min(1.0,-d*500.0));
#else
return 1.0;
#endif
}float calculate_visibility(vec4 pos) {
#ifdef TERRAIN3D
vec3 frag=pos.xyz/pos.w;highp float d=depthOpacity(frag);if (d > 0.95) return 1.0;return (d+depthOpacity(frag+vec3(0.0,0.01,0.0)))/2.0;
#else
return 1.0;
#endif
}float ele(vec2 pos) {
#ifdef TERRAIN3D
vec4 rgb=(texture(u_terrain,pos)*255.0)*u_terrain_unpack;return rgb.r+rgb.g+rgb.b-u_terrain_unpack.a;
#else
return 0.0;
#endif
}float get_elevation(vec2 pos) {
#ifdef TERRAIN3D
#ifdef GLOBE
if ((pos.y <-32767.5) || (pos.y > 32766.5)) {return 0.0;}
#endif
vec2 coord=(u_terrain_matrix*vec4(pos,0.0,1.0)).xy*u_terrain_dim+1.0;vec2 f=fract(coord);vec2 c=(floor(coord)+0.5)/(u_terrain_dim+2.0);float d=1.0/(u_terrain_dim+2.0);float tl=ele(c);float tr=ele(c+vec2(d,0.0));float bl=ele(c+vec2(0.0,d));float br=ele(c+vec2(d,d));float elevation=mix(mix(tl,tr,f.x),mix(bl,br,f.x),f.y);return elevation*u_terrain_exaggeration;
#else
return 0.0;
#endif
}const float PI=3.141592653589793;uniform mat4 u_projection_matrix;`),projectionMercator:oi("","float projectLineThickness(float tileY) {return 1.0;}float projectCircleRadius(float tileY) {return 1.0;}vec4 projectTile(vec2 p) {vec4 result=u_projection_matrix*vec4(p,0.0,1.0);return result;}vec4 projectTile(vec2 p,vec2 rawPos) {vec4 result=u_projection_matrix*vec4(p,0.0,1.0);if (rawPos.y <-32767.5 || rawPos.y > 32766.5) {result.z=-10000000.0;}return result;}vec4 projectTileWithElevation(vec2 posInTile,float elevation) {return u_projection_matrix*vec4(posInTile,elevation,1.0);}vec4 projectTileFor3D(vec2 posInTile,float elevation) {return projectTileWithElevation(posInTile,elevation);}"),projectionGlobe:oi("",`#define GLOBE_RADIUS 6371008.8
uniform highp vec4 u_projection_tile_mercator_coords;uniform highp vec4 u_projection_clipping_plane;uniform highp float u_projection_transition;uniform mat4 u_projection_fallback_matrix;vec3 globeRotateVector(vec3 vec,vec2 angles) {vec3 axisRight=vec3(vec.z,0.0,-vec.x);vec3 axisUp=cross(axisRight,vec);axisRight=normalize(axisRight);axisUp=normalize(axisUp);vec2 t=tan(angles);return normalize(vec+axisRight*t.x+axisUp*t.y);}mat3 globeGetRotationMatrix(vec3 spherePos) {vec3 axisRight=vec3(spherePos.z,0.0,-spherePos.x);vec3 axisDown=cross(axisRight,spherePos);axisRight=normalize(axisRight);axisDown=normalize(axisDown);return mat3(axisRight,axisDown,spherePos
);}float circumferenceRatioAtTileY(float tileY) {float mercator_pos_y=u_projection_tile_mercator_coords.y+u_projection_tile_mercator_coords.w*tileY;float spherical_y=2.0*atan(exp(PI-(mercator_pos_y*PI*2.0)))-PI*0.5;return cos(spherical_y);}float projectLineThickness(float tileY) {float thickness=1.0/circumferenceRatioAtTileY(tileY); 
if (u_projection_transition < 0.999) {return mix(1.0,thickness,u_projection_transition);} else {return thickness;}}vec3 projectToSphere(vec2 translatedPos,vec2 rawPos) {vec2 mercator_pos=u_projection_tile_mercator_coords.xy+u_projection_tile_mercator_coords.zw*translatedPos;vec2 spherical;spherical.x=mercator_pos.x*PI*2.0+PI;spherical.y=2.0*atan(exp(PI-(mercator_pos.y*PI*2.0)))-PI*0.5;float len=cos(spherical.y);vec3 pos=vec3(sin(spherical.x)*len,sin(spherical.y),cos(spherical.x)*len
);if (rawPos.y <-32767.5) {pos=vec3(0.0,1.0,0.0);}if (rawPos.y > 32766.5) {pos=vec3(0.0,-1.0,0.0);}return pos;}vec3 projectToSphere(vec2 posInTile) {return projectToSphere(posInTile,vec2(0.0,0.0));}float globeComputeClippingZ(vec3 spherePos) {return (1.0-(dot(spherePos,u_projection_clipping_plane.xyz)+u_projection_clipping_plane.w));}vec4 interpolateProjection(vec2 posInTile,vec3 spherePos,float elevation) {vec3 elevatedPos=spherePos*(1.0+elevation/GLOBE_RADIUS);vec4 globePosition=u_projection_matrix*vec4(elevatedPos,1.0);globePosition.z=globeComputeClippingZ(elevatedPos)*globePosition.w;if (u_projection_transition > 0.999) {return globePosition;}vec4 flatPosition=u_projection_fallback_matrix*vec4(posInTile,elevation,1.0);const float z_globeness_threshold=0.2;vec4 result=globePosition;result.z=mix(0.0,globePosition.z,clamp((u_projection_transition-z_globeness_threshold)/(1.0-z_globeness_threshold),0.0,1.0));result.xyw=mix(flatPosition.xyw,globePosition.xyw,u_projection_transition);if ((posInTile.y <-32767.5) || (posInTile.y > 32766.5)) {result=globePosition;const float poles_hidden_anim_percentage=0.02;result.z=mix(globePosition.z,100.0,pow(max((1.0-u_projection_transition)/poles_hidden_anim_percentage,0.0),8.0));}return result;}vec4 interpolateProjectionFor3D(vec2 posInTile,vec3 spherePos,float elevation) {vec3 elevatedPos=spherePos*(1.0+elevation/GLOBE_RADIUS);vec4 globePosition=u_projection_matrix*vec4(elevatedPos,1.0);if (u_projection_transition > 0.999) {return globePosition;}vec4 fallbackPosition=u_projection_fallback_matrix*vec4(posInTile,elevation,1.0);return mix(fallbackPosition,globePosition,u_projection_transition);}vec4 projectTile(vec2 posInTile) {return interpolateProjection(posInTile,projectToSphere(posInTile),0.0);}vec4 projectTile(vec2 posInTile,vec2 rawPos) {return interpolateProjection(posInTile,projectToSphere(posInTile,rawPos),0.0);}vec4 projectTileWithElevation(vec2 posInTile,float elevation) {return interpolateProjection(posInTile,projectToSphere(posInTile),elevation);}vec4 projectTileFor3D(vec2 posInTile,float elevation) {vec3 spherePos=projectToSphere(posInTile,posInTile);return interpolateProjectionFor3D(posInTile,spherePos,elevation);}`),background:oi(`uniform vec4 u_color;uniform float u_opacity;void main() {fragColor=u_color*u_opacity;
#ifdef OVERDRAW_INSPECTOR
fragColor=vec4(1.0);
#endif
}`,"in vec2 a_pos;void main() {gl_Position=projectTile(a_pos);}"),backgroundPattern:oi(`uniform vec2 u_pattern_tl_a;uniform vec2 u_pattern_br_a;uniform vec2 u_pattern_tl_b;uniform vec2 u_pattern_br_b;uniform vec2 u_texsize;uniform float u_mix;uniform float u_opacity;uniform sampler2D u_image;in vec2 v_pos_a;in vec2 v_pos_b;void main() {vec2 imagecoord=mod(v_pos_a,1.0);vec2 pos=mix(u_pattern_tl_a/u_texsize,u_pattern_br_a/u_texsize,imagecoord);vec4 color1=texture(u_image,pos);vec2 imagecoord_b=mod(v_pos_b,1.0);vec2 pos2=mix(u_pattern_tl_b/u_texsize,u_pattern_br_b/u_texsize,imagecoord_b);vec4 color2=texture(u_image,pos2);fragColor=mix(color1,color2,u_mix)*u_opacity;
#ifdef OVERDRAW_INSPECTOR
fragColor=vec4(1.0);
#endif
}`,"uniform vec2 u_pattern_size_a;uniform vec2 u_pattern_size_b;uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform float u_scale_a;uniform float u_scale_b;uniform float u_tile_units_to_pixels;in vec2 a_pos;out vec2 v_pos_a;out vec2 v_pos_b;void main() {gl_Position=projectTile(a_pos);v_pos_a=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,u_scale_a*u_pattern_size_a,u_tile_units_to_pixels,a_pos);v_pos_b=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,u_scale_b*u_pattern_size_b,u_tile_units_to_pixels,a_pos);}"),circle:oi(`in vec3 v_data;in float v_visibility;
#pragma mapbox: define highp vec4 color
#pragma mapbox: define mediump float radius
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define highp vec4 stroke_color
#pragma mapbox: define mediump float stroke_width
#pragma mapbox: define lowp float stroke_opacity
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize mediump float radius
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize highp vec4 stroke_color
#pragma mapbox: initialize mediump float stroke_width
#pragma mapbox: initialize lowp float stroke_opacity
vec2 extrude=v_data.xy;float extrude_length=length(extrude);float antialiased_blur=v_data.z;float opacity_t=smoothstep(0.0,antialiased_blur,extrude_length-1.0);float color_t=stroke_width < 0.01 ? 0.0 : smoothstep(antialiased_blur,0.0,extrude_length-radius/(radius+stroke_width));fragColor=v_visibility*opacity_t*mix(color*opacity,stroke_color*stroke_opacity,color_t);const float epsilon=0.5/255.0;if (fragColor.r < epsilon && fragColor.g < epsilon && fragColor.b < epsilon && fragColor.a < epsilon) {discard;}
#ifdef OVERDRAW_INSPECTOR
fragColor=vec4(1.0);
#endif
}`,`uniform bool u_scale_with_map;uniform bool u_pitch_with_map;uniform vec2 u_extrude_scale;uniform highp float u_globe_extrude_scale;uniform lowp float u_device_pixel_ratio;uniform highp float u_camera_to_center_distance;uniform vec2 u_translate;in vec2 a_pos;out vec3 v_data;out float v_visibility;
#pragma mapbox: define highp vec4 color
#pragma mapbox: define mediump float radius
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define highp vec4 stroke_color
#pragma mapbox: define mediump float stroke_width
#pragma mapbox: define lowp float stroke_opacity
void main(void) {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize mediump float radius
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize highp vec4 stroke_color
#pragma mapbox: initialize mediump float stroke_width
#pragma mapbox: initialize lowp float stroke_opacity
vec2 pos_raw=a_pos+32768.0;vec2 extrude=vec2(mod(pos_raw,8.0)/7.0*2.0-1.0);vec2 circle_center=floor(pos_raw/8.0)+u_translate;float ele=get_elevation(circle_center);v_visibility=calculate_visibility(projectTileWithElevation(circle_center,ele));if (u_pitch_with_map) {
#ifdef GLOBE
vec3 center_vector=projectToSphere(circle_center);
#endif
float angle_scale=u_globe_extrude_scale;vec2 corner_position=circle_center;if (u_scale_with_map) {angle_scale*=(radius+stroke_width);corner_position+=extrude*u_extrude_scale*(radius+stroke_width);} else {
#ifdef GLOBE
vec4 projected_center=interpolateProjection(circle_center,center_vector,ele);
#else
vec4 projected_center=projectTileWithElevation(circle_center,ele);
#endif
corner_position+=extrude*u_extrude_scale*(radius+stroke_width)*(projected_center.w/u_camera_to_center_distance);angle_scale*=(radius+stroke_width)*(projected_center.w/u_camera_to_center_distance);}
#ifdef GLOBE
vec2 angles=extrude*angle_scale;vec3 corner_vector=globeRotateVector(center_vector,angles);gl_Position=interpolateProjection(corner_position,corner_vector,ele);
#else
gl_Position=projectTileWithElevation(corner_position,ele);
#endif
} else {gl_Position=projectTileWithElevation(circle_center,ele);if (gl_Position.z/gl_Position.w > 1.0) {gl_Position.xy=vec2(10000.0);}if (u_scale_with_map) {gl_Position.xy+=extrude*(radius+stroke_width)*u_extrude_scale*u_camera_to_center_distance;} else {gl_Position.xy+=extrude*(radius+stroke_width)*u_extrude_scale*gl_Position.w;}}float antialiasblur=-max(1.0/u_device_pixel_ratio/(radius+stroke_width),blur);v_data=vec3(extrude.x,extrude.y,antialiasblur);}`),clippingMask:oi(ul,"in vec2 a_pos;void main() {gl_Position=projectTile(a_pos);}"),heatmap:oi(`uniform highp float u_intensity;in vec2 v_extrude;
#pragma mapbox: define highp float weight
#define GAUSS_COEF 0.3989422804014327
void main() {
#pragma mapbox: initialize highp float weight
float d=-0.5*3.0*3.0*dot(v_extrude,v_extrude);float val=weight*u_intensity*GAUSS_COEF*exp(d);fragColor=vec4(val,1.0,1.0,1.0);
#ifdef OVERDRAW_INSPECTOR
fragColor=vec4(1.0);
#endif
}`,`uniform float u_extrude_scale;uniform float u_opacity;uniform float u_intensity;uniform highp float u_globe_extrude_scale;in vec2 a_pos;out vec2 v_extrude;
#pragma mapbox: define highp float weight
#pragma mapbox: define mediump float radius
const highp float ZERO=1.0/255.0/16.0;
#define GAUSS_COEF 0.3989422804014327
void main(void) {
#pragma mapbox: initialize highp float weight
#pragma mapbox: initialize mediump float radius
vec2 pos_raw=a_pos+32768.0;vec2 unscaled_extrude=vec2(mod(pos_raw,8.0)/7.0*2.0-1.0);float S=sqrt(-2.0*log(ZERO/weight/u_intensity/GAUSS_COEF))/3.0;v_extrude=S*unscaled_extrude;vec2 extrude=v_extrude*radius*u_extrude_scale;vec2 circle_center=floor(pos_raw/8.0);
#ifdef GLOBE
vec2 angles=v_extrude*radius*u_globe_extrude_scale;vec3 center_vector=projectToSphere(circle_center);vec3 corner_vector=globeRotateVector(center_vector,angles);gl_Position=interpolateProjection(circle_center+extrude,corner_vector,0.0);
#else
gl_Position=projectTileFor3D(circle_center+extrude,get_elevation(circle_center));
#endif
}`),heatmapTexture:oi(`uniform sampler2D u_image;uniform sampler2D u_color_ramp;uniform float u_opacity;in vec2 v_pos;void main() {float t=texture(u_image,v_pos).r;vec4 color=texture(u_color_ramp,vec2(t,0.5));fragColor=color*u_opacity;
#ifdef OVERDRAW_INSPECTOR
fragColor=vec4(0.0);
#endif
}`,"uniform mat4 u_matrix;uniform vec2 u_world;in vec2 a_pos;out vec2 v_pos;void main() {gl_Position=u_matrix*vec4(a_pos*u_world,0,1);v_pos.x=a_pos.x;v_pos.y=1.0-a_pos.y;}"),collisionBox:oi("in float v_placed;in float v_notUsed;void main() {float alpha=0.5;fragColor=vec4(1.0,0.0,0.0,1.0)*alpha;if (v_placed > 0.5) {fragColor=vec4(0.0,0.0,1.0,0.5)*alpha;}if (v_notUsed > 0.5) {fragColor*=.1;}}","in vec2 a_anchor_pos;in vec2 a_placed;in vec2 a_box_real;uniform vec2 u_pixel_extrude_scale;out float v_placed;out float v_notUsed;void main() {gl_Position=projectTileWithElevation(a_anchor_pos,get_elevation(a_anchor_pos));gl_Position.xy=((a_box_real+0.5)*u_pixel_extrude_scale*2.0-1.0)*vec2(1.0,-1.0)*gl_Position.w;if (gl_Position.z/gl_Position.w < 1.1) {gl_Position.z=0.5;}v_placed=a_placed.x;v_notUsed=a_placed.y;}"),collisionCircle:oi("in float v_radius;in vec2 v_extrude;in float v_collision;void main() {float alpha=0.5;float stroke_radius=0.9;float distance_to_center=length(v_extrude);float distance_to_edge=abs(distance_to_center-v_radius);float opacity_t=smoothstep(-stroke_radius,0.0,-distance_to_edge);vec4 color=mix(vec4(0.0,0.0,1.0,0.5),vec4(1.0,0.0,0.0,1.0),v_collision);fragColor=color*alpha*opacity_t;}","in vec2 a_pos;in float a_radius;in vec2 a_flags;uniform vec2 u_viewport_size;out float v_radius;out vec2 v_extrude;out float v_collision;void main() {float radius=a_radius;float collision=a_flags.x;float vertexIdx=a_flags.y;vec2 quadVertexOffset=vec2(mix(-1.0,1.0,float(vertexIdx >=2.0)),mix(-1.0,1.0,float(vertexIdx >=1.0 && vertexIdx <=2.0)));vec2 quadVertexExtent=quadVertexOffset*radius;float padding_factor=1.2;v_radius=radius;v_extrude=quadVertexExtent*padding_factor;v_collision=collision;gl_Position=vec4((a_pos/u_viewport_size*2.0-1.0)*vec2(1.0,-1.0),0.0,1.0)+vec4(quadVertexExtent*padding_factor/u_viewport_size*2.0,0.0,0.0);}"),colorRelief:oi(`#ifdef GL_ES
precision highp float;
#endif
uniform sampler2D u_image;uniform vec4 u_unpack;uniform sampler2D u_elevation_stops;uniform sampler2D u_color_stops;uniform int u_color_ramp_size;uniform float u_opacity;in vec2 v_pos;float getElevation(vec2 coord) {vec4 data=texture(u_image,coord)*255.0;data.a=-1.0;return dot(data,u_unpack);}float getElevationStop(int stop) {float x=(float(stop)+0.5)/float(u_color_ramp_size);vec4 data=texture(u_elevation_stops,vec2(x,0))*255.0;data.a=-1.0;return dot(data,u_unpack);}void main() {float el=getElevation(v_pos);int r=(u_color_ramp_size-1);int l=0;float el_l=getElevationStop(l);float el_r=getElevationStop(r);while(r-l > 1){int m=(r+l)/2;float el_m=getElevationStop(m);if(el < el_m){r=m;el_r=el_m;}else
{l=m;el_l=el_m;}}float x=(float(l)+(el-el_l)/(el_r-el_l)+0.5)/float(u_color_ramp_size);fragColor=u_opacity*texture(u_color_stops,vec2(x,0));
#ifdef OVERDRAW_INSPECTOR
fragColor=vec4(1.0);
#endif
}`,"uniform vec2 u_dimension;in vec2 a_pos;out vec2 v_pos;void main() {gl_Position=projectTile(a_pos,a_pos);highp vec2 epsilon=1.0/u_dimension;float scale=(u_dimension.x-2.0)/u_dimension.x;v_pos=(a_pos/8192.0)*scale+epsilon;if (a_pos.y <-32767.5) {v_pos.y=0.0;}if (a_pos.y > 32766.5) {v_pos.y=1.0;}}"),debug:oi("uniform highp vec4 u_color;uniform sampler2D u_overlay;in vec2 v_uv;void main() {vec4 overlay_color=texture(u_overlay,v_uv);fragColor=mix(u_color,overlay_color,overlay_color.a);}","in vec2 a_pos;out vec2 v_uv;uniform float u_overlay_scale;void main() {v_uv=a_pos/8192.0;gl_Position=projectTileWithElevation(a_pos*u_overlay_scale,get_elevation(a_pos));}"),depth:oi(ul,`in vec2 a_pos;void main() {
#ifdef GLOBE
gl_Position=projectTileFor3D(a_pos,0.0);
#else
gl_Position=u_projection_matrix*vec4(a_pos,0.0,1.0);
#endif
}`),fill:oi(`#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float opacity
fragColor=color*opacity;
#ifdef OVERDRAW_INSPECTOR
fragColor=vec4(1.0);
#endif
}`,`uniform vec2 u_fill_translate;in vec2 a_pos;
#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float opacity
gl_Position=projectTile(a_pos+u_fill_translate,a_pos);}`),fillOutline:oi(`in vec2 v_pos;
#ifdef GLOBE
in float v_depth;
#endif
#pragma mapbox: define highp vec4 outline_color
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize highp vec4 outline_color
#pragma mapbox: initialize lowp float opacity
float dist=length(v_pos-gl_FragCoord.xy);float alpha=1.0-smoothstep(0.0,1.0,dist);fragColor=outline_color*(alpha*opacity);
#ifdef GLOBE
if (v_depth > 1.0) {discard;}
#endif
#ifdef OVERDRAW_INSPECTOR
fragColor=vec4(1.0);
#endif
}`,`uniform vec2 u_world;uniform vec2 u_fill_translate;in vec2 a_pos;out vec2 v_pos;
#ifdef GLOBE
out float v_depth;
#endif
#pragma mapbox: define highp vec4 outline_color
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize highp vec4 outline_color
#pragma mapbox: initialize lowp float opacity
gl_Position=projectTile(a_pos+u_fill_translate,a_pos);v_pos=(gl_Position.xy/gl_Position.w+1.0)/2.0*u_world;
#ifdef GLOBE
v_depth=gl_Position.z/gl_Position.w;
#endif
}`),fillOutlinePattern:oi(`uniform vec2 u_texsize;uniform sampler2D u_image;uniform float u_fade;in vec2 v_pos_a;in vec2 v_pos_b;in vec2 v_pos;
#ifdef GLOBE
in float v_depth;
#endif
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
void main() {
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
vec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;vec2 imagecoord=mod(v_pos_a,1.0);vec2 pos=mix(pattern_tl_a/u_texsize,pattern_br_a/u_texsize,imagecoord);vec4 color1=texture(u_image,pos);vec2 imagecoord_b=mod(v_pos_b,1.0);vec2 pos2=mix(pattern_tl_b/u_texsize,pattern_br_b/u_texsize,imagecoord_b);vec4 color2=texture(u_image,pos2);float dist=length(v_pos-gl_FragCoord.xy);float alpha=1.0-smoothstep(0.0,1.0,dist);fragColor=mix(color1,color2,u_fade)*alpha*opacity;
#ifdef GLOBE
if (v_depth > 1.0) {discard;}
#endif
#ifdef OVERDRAW_INSPECTOR
fragColor=vec4(1.0);
#endif
}`,`uniform vec2 u_world;uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform vec3 u_scale;uniform vec2 u_fill_translate;in vec2 a_pos;out vec2 v_pos_a;out vec2 v_pos_b;out vec2 v_pos;
#ifdef GLOBE
out float v_depth;
#endif
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
#pragma mapbox: define lowp float pixel_ratio_from
#pragma mapbox: define lowp float pixel_ratio_to
void main() {
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
#pragma mapbox: initialize lowp float pixel_ratio_from
#pragma mapbox: initialize lowp float pixel_ratio_to
vec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;float tileRatio=u_scale.x;float fromScale=u_scale.y;float toScale=u_scale.z;gl_Position=projectTile(a_pos+u_fill_translate,a_pos);vec2 display_size_a=(pattern_br_a-pattern_tl_a)/pixel_ratio_from;vec2 display_size_b=(pattern_br_b-pattern_tl_b)/pixel_ratio_to;v_pos_a=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,fromScale*display_size_a,tileRatio,a_pos);v_pos_b=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,toScale*display_size_b,tileRatio,a_pos);v_pos=(gl_Position.xy/gl_Position.w+1.0)/2.0*u_world;
#ifdef GLOBE
v_depth=gl_Position.z/gl_Position.w;
#endif
}`),fillPattern:oi(`#ifdef GL_ES
precision highp float;
#endif
uniform vec2 u_texsize;uniform float u_fade;uniform sampler2D u_image;in vec2 v_pos_a;in vec2 v_pos_b;
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
void main() {
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
vec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;vec2 imagecoord=mod(v_pos_a,1.0);vec2 pos=mix(pattern_tl_a/u_texsize,pattern_br_a/u_texsize,imagecoord);vec4 color1=texture(u_image,pos);vec2 imagecoord_b=mod(v_pos_b,1.0);vec2 pos2=mix(pattern_tl_b/u_texsize,pattern_br_b/u_texsize,imagecoord_b);vec4 color2=texture(u_image,pos2);fragColor=mix(color1,color2,u_fade)*opacity;
#ifdef OVERDRAW_INSPECTOR
fragColor=vec4(1.0);
#endif
}`,`uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform vec3 u_scale;uniform vec2 u_fill_translate;in vec2 a_pos;out vec2 v_pos_a;out vec2 v_pos_b;
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
#pragma mapbox: define lowp float pixel_ratio_from
#pragma mapbox: define lowp float pixel_ratio_to
void main() {
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
#pragma mapbox: initialize lowp float pixel_ratio_from
#pragma mapbox: initialize lowp float pixel_ratio_to
vec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;float tileZoomRatio=u_scale.x;float fromScale=u_scale.y;float toScale=u_scale.z;vec2 display_size_a=(pattern_br_a-pattern_tl_a)/pixel_ratio_from;vec2 display_size_b=(pattern_br_b-pattern_tl_b)/pixel_ratio_to;gl_Position=projectTile(a_pos+u_fill_translate,a_pos);v_pos_a=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,fromScale*display_size_a,tileZoomRatio,a_pos);v_pos_b=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,toScale*display_size_b,tileZoomRatio,a_pos);}`),fillExtrusion:oi(`in vec4 v_color;void main() {fragColor=v_color;
#ifdef OVERDRAW_INSPECTOR
fragColor=vec4(1.0);
#endif
}`,`uniform vec3 u_lightcolor;uniform lowp vec3 u_lightpos;uniform lowp vec3 u_lightpos_globe;uniform lowp float u_lightintensity;uniform float u_vertical_gradient;uniform lowp float u_opacity;uniform vec2 u_fill_translate;in vec2 a_pos;in vec4 a_normal_ed;
#ifdef TERRAIN3D
in vec2 a_centroid;
#endif
out vec4 v_color;
#pragma mapbox: define highp float base
#pragma mapbox: define highp float height
#pragma mapbox: define highp vec4 color
void main() {
#pragma mapbox: initialize highp float base
#pragma mapbox: initialize highp float height
#pragma mapbox: initialize highp vec4 color
vec3 normal=a_normal_ed.xyz;
#ifdef TERRAIN3D
float height_terrain3d_offset=get_elevation(a_centroid);float base_terrain3d_offset=height_terrain3d_offset-(base > 0.0 ? 0.0 : 10.0);
#else
float height_terrain3d_offset=0.0;float base_terrain3d_offset=0.0;
#endif
base=max(0.0,base)+base_terrain3d_offset;height=max(0.0,height)+height_terrain3d_offset;float t=mod(normal.x,2.0);float elevation=t > 0.0 ? height : base;vec2 posInTile=a_pos+u_fill_translate;
#ifdef GLOBE
vec3 spherePos=projectToSphere(posInTile,a_pos);gl_Position=interpolateProjectionFor3D(posInTile,spherePos,elevation);
#else
gl_Position=u_projection_matrix*vec4(posInTile,elevation,1.0);
#endif
float colorvalue=color.r*0.2126+color.g*0.7152+color.b*0.0722;v_color=vec4(0.0,0.0,0.0,1.0);vec4 ambientlight=vec4(0.03,0.03,0.03,1.0);color+=ambientlight;vec3 normalForLighting=normal/16384.0;float directional=clamp(dot(normalForLighting,u_lightpos),0.0,1.0);
#ifdef GLOBE
mat3 rotMatrix=globeGetRotationMatrix(spherePos);normalForLighting=rotMatrix*normalForLighting;directional=mix(directional,clamp(dot(normalForLighting,u_lightpos_globe),0.0,1.0),u_projection_transition);
#endif
directional=mix((1.0-u_lightintensity),max((1.0-colorvalue+u_lightintensity),1.0),directional);if (normal.y !=0.0) {directional*=((1.0-u_vertical_gradient)+(u_vertical_gradient*clamp((t+base)*pow(height/150.0,0.5),mix(0.7,0.98,1.0-u_lightintensity),1.0)));}v_color.r+=clamp(color.r*directional*u_lightcolor.r,mix(0.0,0.3,1.0-u_lightcolor.r),1.0);v_color.g+=clamp(color.g*directional*u_lightcolor.g,mix(0.0,0.3,1.0-u_lightcolor.g),1.0);v_color.b+=clamp(color.b*directional*u_lightcolor.b,mix(0.0,0.3,1.0-u_lightcolor.b),1.0);v_color*=u_opacity;}`),fillExtrusionPattern:oi(`uniform vec2 u_texsize;uniform float u_fade;uniform sampler2D u_image;in vec2 v_pos_a;in vec2 v_pos_b;in vec4 v_lighting;
#pragma mapbox: define lowp float base
#pragma mapbox: define lowp float height
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
#pragma mapbox: define lowp float pixel_ratio_from
#pragma mapbox: define lowp float pixel_ratio_to
void main() {
#pragma mapbox: initialize lowp float base
#pragma mapbox: initialize lowp float height
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
#pragma mapbox: initialize lowp float pixel_ratio_from
#pragma mapbox: initialize lowp float pixel_ratio_to
vec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;vec2 imagecoord=mod(v_pos_a,1.0);vec2 pos=mix(pattern_tl_a/u_texsize,pattern_br_a/u_texsize,imagecoord);vec4 color1=texture(u_image,pos);vec2 imagecoord_b=mod(v_pos_b,1.0);vec2 pos2=mix(pattern_tl_b/u_texsize,pattern_br_b/u_texsize,imagecoord_b);vec4 color2=texture(u_image,pos2);vec4 mixedColor=mix(color1,color2,u_fade);fragColor=mixedColor*v_lighting;
#ifdef OVERDRAW_INSPECTOR
fragColor=vec4(1.0);
#endif
}`,`uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform float u_height_factor;uniform vec3 u_scale;uniform float u_vertical_gradient;uniform lowp float u_opacity;uniform vec2 u_fill_translate;uniform vec3 u_lightcolor;uniform lowp vec3 u_lightpos;uniform lowp vec3 u_lightpos_globe;uniform lowp float u_lightintensity;in vec2 a_pos;in vec4 a_normal_ed;
#ifdef TERRAIN3D
in vec2 a_centroid;
#endif
#ifdef GLOBE
out vec3 v_sphere_pos;
#endif
out vec2 v_pos_a;out vec2 v_pos_b;out vec4 v_lighting;
#pragma mapbox: define lowp float base
#pragma mapbox: define lowp float height
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
#pragma mapbox: define lowp float pixel_ratio_from
#pragma mapbox: define lowp float pixel_ratio_to
void main() {
#pragma mapbox: initialize lowp float base
#pragma mapbox: initialize lowp float height
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
#pragma mapbox: initialize lowp float pixel_ratio_from
#pragma mapbox: initialize lowp float pixel_ratio_to
vec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;float tileRatio=u_scale.x;float fromScale=u_scale.y;float toScale=u_scale.z;vec3 normal=a_normal_ed.xyz;float edgedistance=a_normal_ed.w;vec2 display_size_a=(pattern_br_a-pattern_tl_a)/pixel_ratio_from;vec2 display_size_b=(pattern_br_b-pattern_tl_b)/pixel_ratio_to;
#ifdef TERRAIN3D
float height_terrain3d_offset=get_elevation(a_centroid);float base_terrain3d_offset=height_terrain3d_offset-(base > 0.0 ? 0.0 : 10.0);
#else
float height_terrain3d_offset=0.0;float base_terrain3d_offset=0.0;
#endif
base=max(0.0,base)+base_terrain3d_offset;height=max(0.0,height)+height_terrain3d_offset;float t=mod(normal.x,2.0);float elevation=t > 0.0 ? height : base;vec2 posInTile=a_pos+u_fill_translate;
#ifdef GLOBE
vec3 spherePos=projectToSphere(posInTile,a_pos);vec3 elevatedPos=spherePos*(1.0+elevation/GLOBE_RADIUS);v_sphere_pos=elevatedPos;gl_Position=interpolateProjectionFor3D(posInTile,spherePos,elevation);
#else
gl_Position=u_projection_matrix*vec4(posInTile,elevation,1.0);
#endif
vec2 pos=normal.x==1.0 && normal.y==0.0 && normal.z==16384.0
? a_pos
: vec2(edgedistance,elevation*u_height_factor);v_pos_a=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,fromScale*display_size_a,tileRatio,pos);v_pos_b=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,toScale*display_size_b,tileRatio,pos);v_lighting=vec4(0.0,0.0,0.0,1.0);float directional=clamp(dot(normal/16383.0,u_lightpos),0.0,1.0);directional=mix((1.0-u_lightintensity),max((0.5+u_lightintensity),1.0),directional);if (normal.y !=0.0) {directional*=((1.0-u_vertical_gradient)+(u_vertical_gradient*clamp((t+base)*pow(height/150.0,0.5),mix(0.7,0.98,1.0-u_lightintensity),1.0)));}v_lighting.rgb+=clamp(directional*u_lightcolor,mix(vec3(0.0),vec3(0.3),1.0-u_lightcolor),vec3(1.0));v_lighting*=u_opacity;}`),hillshadePrepare:oi(`#ifdef GL_ES
precision highp float;
#endif
uniform sampler2D u_image;in vec2 v_pos;uniform vec2 u_dimension;uniform float u_zoom;uniform vec4 u_unpack;float getElevation(vec2 coord,float bias) {vec4 data=texture(u_image,coord)*255.0;data.a=-1.0;return dot(data,u_unpack);}void main() {vec2 epsilon=1.0/u_dimension;float tileSize=u_dimension.x-2.0;float a=getElevation(v_pos+vec2(-epsilon.x,-epsilon.y),0.0);float b=getElevation(v_pos+vec2(0,-epsilon.y),0.0);float c=getElevation(v_pos+vec2(epsilon.x,-epsilon.y),0.0);float d=getElevation(v_pos+vec2(-epsilon.x,0),0.0);float e=getElevation(v_pos,0.0);float f=getElevation(v_pos+vec2(epsilon.x,0),0.0);float g=getElevation(v_pos+vec2(-epsilon.x,epsilon.y),0.0);float h=getElevation(v_pos+vec2(0,epsilon.y),0.0);float i=getElevation(v_pos+vec2(epsilon.x,epsilon.y),0.0);float exaggerationFactor=u_zoom < 2.0 ? 0.4 : u_zoom < 4.5 ? 0.35 : 0.3;float exaggeration=u_zoom < 15.0 ? (u_zoom-15.0)*exaggerationFactor : 0.0;vec2 deriv=vec2((c+f+f+i)-(a+d+d+g),(g+h+h+i)-(a+b+b+c))*tileSize/pow(2.0,exaggeration+(28.2562-u_zoom));fragColor=clamp(vec4(deriv.x/8.0+0.5,deriv.y/8.0+0.5,1.0,1.0),0.0,1.0);
#ifdef OVERDRAW_INSPECTOR
fragColor=vec4(1.0);
#endif
}`,"uniform mat4 u_matrix;uniform vec2 u_dimension;in vec2 a_pos;in vec2 a_texture_pos;out vec2 v_pos;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);highp vec2 epsilon=1.0/u_dimension;float scale=(u_dimension.x-2.0)/u_dimension.x;v_pos=(a_texture_pos/8192.0)*scale+epsilon;}"),hillshade:oi(`uniform sampler2D u_image;in vec2 v_pos;uniform vec2 u_latrange;uniform float u_exaggeration;uniform vec4 u_accent;uniform int u_method;uniform float u_altitudes[NUM_ILLUMINATION_SOURCES];uniform float u_azimuths[NUM_ILLUMINATION_SOURCES];uniform vec4 u_shadows[NUM_ILLUMINATION_SOURCES];uniform vec4 u_highlights[NUM_ILLUMINATION_SOURCES];
#define PI 3.141592653589793
#define STANDARD 0
#define COMBINED 1
#define IGOR 2
#define MULTIDIRECTIONAL 3
#define BASIC 4
float get_aspect(vec2 deriv){return deriv.x !=0.0 ? atan(deriv.y,-deriv.x) : PI/2.0*(deriv.y > 0.0 ? 1.0 :-1.0);}void igor_hillshade(vec2 deriv){deriv=deriv*u_exaggeration*2.0;float aspect=get_aspect(deriv);float azimuth=u_azimuths[0]+PI;float slope_stength=atan(length(deriv))*2.0/PI;float aspect_strength=1.0-abs(mod((aspect+azimuth)/PI+0.5,2.0)-1.0);float shadow_strength=slope_stength*aspect_strength;float highlight_strength=slope_stength*(1.0-aspect_strength);fragColor=u_shadows[0]*shadow_strength+u_highlights[0]*highlight_strength;}void standard_hillshade(vec2 deriv){float azimuth=u_azimuths[0]+PI;float slope=atan(0.625*length(deriv));float aspect=get_aspect(deriv);float intensity=u_exaggeration;float base=1.875-intensity*1.75;float maxValue=0.5*PI;float scaledSlope=intensity !=0.5 ? ((pow(base,slope)-1.0)/(pow(base,maxValue)-1.0))*maxValue : slope;float accent=cos(scaledSlope);vec4 accent_color=(1.0-accent)*u_accent*clamp(intensity*2.0,0.0,1.0);float shade=abs(mod((aspect+azimuth)/PI+0.5,2.0)-1.0);vec4 shade_color=mix(u_shadows[0],u_highlights[0],shade)*sin(scaledSlope)*clamp(intensity*2.0,0.0,1.0);fragColor=accent_color*(1.0-shade_color.a)+shade_color;}void basic_hillshade(vec2 deriv){deriv=deriv*u_exaggeration*2.0;float azimuth=u_azimuths[0]+PI;float cos_az=cos(azimuth);float sin_az=sin(azimuth);float cos_alt=cos(u_altitudes[0]);float sin_alt=sin(u_altitudes[0]);float cang=(sin_alt-(deriv.y*cos_az*cos_alt-deriv.x*sin_az*cos_alt))/sqrt(1.0+dot(deriv,deriv));float shade=clamp(cang,0.0,1.0);if(shade > 0.5){fragColor=u_highlights[0]*(2.0*shade-1.0);}else
{fragColor=u_shadows[0]*(1.0-2.0*shade);}}void multidirectional_hillshade(vec2 deriv){deriv=deriv*u_exaggeration*2.0;fragColor=vec4(0,0,0,0);for(int i=0; i < NUM_ILLUMINATION_SOURCES; i++){float cos_alt=cos(u_altitudes[i]);float sin_alt=sin(u_altitudes[i]);float cos_az=-cos(u_azimuths[i]);float sin_az=-sin(u_azimuths[i]);float cang=(sin_alt-(deriv.y*cos_az*cos_alt-deriv.x*sin_az*cos_alt))/sqrt(1.0+dot(deriv,deriv));float shade=clamp(cang,0.0,1.0);if(shade > 0.5){fragColor+=u_highlights[i]*(2.0*shade-1.0)/float(NUM_ILLUMINATION_SOURCES);}else
{fragColor+=u_shadows[i]*(1.0-2.0*shade)/float(NUM_ILLUMINATION_SOURCES);}}}void combined_hillshade(vec2 deriv){deriv=deriv*u_exaggeration*2.0;float azimuth=u_azimuths[0]+PI;float cos_az=cos(azimuth);float sin_az=sin(azimuth);float cos_alt=cos(u_altitudes[0]);float sin_alt=sin(u_altitudes[0]);float cang=acos((sin_alt-(deriv.y*cos_az*cos_alt-deriv.x*sin_az*cos_alt))/sqrt(1.0+dot(deriv,deriv)));cang=clamp(cang,0.0,PI/2.0);float shade=cang*atan(length(deriv))*4.0/PI/PI;float highlight=(PI/2.0-cang)*atan(length(deriv))*4.0/PI/PI;fragColor=u_shadows[0]*shade+u_highlights[0]*highlight;}void main() {vec4 pixel=texture(u_image,v_pos);float scaleFactor=cos(radians((u_latrange[0]-u_latrange[1])*(1.0-v_pos.y)+u_latrange[1]));vec2 deriv=((pixel.rg*8.0)-4.0)/scaleFactor;if (u_method==BASIC) {basic_hillshade(deriv);} else if (u_method==COMBINED) {combined_hillshade(deriv);} else if (u_method==IGOR) {igor_hillshade(deriv);} else if (u_method==MULTIDIRECTIONAL) {multidirectional_hillshade(deriv);} else if (u_method==STANDARD) {standard_hillshade(deriv);} else {standard_hillshade(deriv);}
#ifdef OVERDRAW_INSPECTOR
fragColor=vec4(1.0);
#endif
}`,"uniform mat4 u_matrix;in vec2 a_pos;out vec2 v_pos;void main() {gl_Position=projectTile(a_pos,a_pos);v_pos=a_pos/8192.0;if (a_pos.y <-32767.5) {v_pos.y=0.0;}if (a_pos.y > 32766.5) {v_pos.y=1.0;}}"),line:oi(`uniform lowp float u_device_pixel_ratio;in vec2 v_width2;in vec2 v_normal;in float v_gamma_scale;
#ifdef GLOBE
in float v_depth;
#endif
#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
float dist=length(v_normal)*v_width2.s;float blur2=(blur+1.0/u_device_pixel_ratio)*v_gamma_scale;float alpha=clamp(min(dist-(v_width2.t-blur2),v_width2.s-dist)/blur2,0.0,1.0);fragColor=color*(alpha*opacity);
#ifdef GLOBE
if (v_depth > 1.0) {discard;}
#endif
#ifdef OVERDRAW_INSPECTOR
fragColor=vec4(1.0);
#endif
}`,`
#define scale 0.015873016
in vec2 a_pos_normal;in vec4 a_data;uniform vec2 u_translation;uniform mediump float u_ratio;uniform vec2 u_units_to_pixels;uniform lowp float u_device_pixel_ratio;out vec2 v_normal;out vec2 v_width2;out float v_gamma_scale;out highp float v_linesofar;
#ifdef GLOBE
out float v_depth;
#endif
#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define mediump float gapwidth
#pragma mapbox: define lowp float offset
#pragma mapbox: define mediump float width
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump float gapwidth
#pragma mapbox: initialize lowp float offset
#pragma mapbox: initialize mediump float width
float ANTIALIASING=1.0/u_device_pixel_ratio/2.0;vec2 a_extrude=a_data.xy-128.0;float a_direction=mod(a_data.z,4.0)-1.0;v_linesofar=(floor(a_data.z/4.0)+a_data.w*64.0)*2.0;vec2 pos=floor(a_pos_normal*0.5);mediump vec2 normal=a_pos_normal-2.0*pos;normal.y=normal.y*2.0-1.0;v_normal=normal;gapwidth=gapwidth/2.0;float halfwidth=width/2.0;offset=-1.0*offset;float inset=gapwidth+(gapwidth > 0.0 ? ANTIALIASING : 0.0);float outset=gapwidth+halfwidth*(gapwidth > 0.0 ? 2.0 : 1.0)+(halfwidth==0.0 ? 0.0 : ANTIALIASING);mediump vec2 dist=outset*a_extrude*scale;mediump float u=0.5*a_direction;mediump float t=1.0-abs(u);mediump vec2 offset2=offset*a_extrude*scale*normal.y*mat2(t,-u,u,t);float adjustedThickness=projectLineThickness(pos.y);vec4 projected_no_extrude=projectTile(pos+offset2/u_ratio*adjustedThickness+u_translation);vec4 projected_with_extrude=projectTile(pos+offset2/u_ratio*adjustedThickness+u_translation+dist/u_ratio*adjustedThickness);gl_Position=projected_with_extrude;
#ifdef GLOBE
v_depth=gl_Position.z/gl_Position.w;
#endif
#ifdef TERRAIN3D
v_gamma_scale=1.0;
#else
float extrude_length_without_perspective=length(dist);float extrude_length_with_perspective=length((projected_with_extrude.xy-projected_no_extrude.xy)/projected_with_extrude.w*u_units_to_pixels);v_gamma_scale=extrude_length_without_perspective/extrude_length_with_perspective;
#endif
v_width2=vec2(outset,inset);}`),lineGradient:oi(`uniform lowp float u_device_pixel_ratio;uniform sampler2D u_image;in vec2 v_width2;in vec2 v_normal;in float v_gamma_scale;in highp vec2 v_uv;
#ifdef GLOBE
in float v_depth;
#endif
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
float dist=length(v_normal)*v_width2.s;float blur2=(blur+1.0/u_device_pixel_ratio)*v_gamma_scale;float alpha=clamp(min(dist-(v_width2.t-blur2),v_width2.s-dist)/blur2,0.0,1.0);vec4 color=texture(u_image,v_uv);fragColor=color*(alpha*opacity);
#ifdef GLOBE
if (v_depth > 1.0) {discard;}
#endif
#ifdef OVERDRAW_INSPECTOR
fragColor=vec4(1.0);
#endif
}`,`
#define scale 0.015873016
in vec2 a_pos_normal;in vec4 a_data;in float a_uv_x;in float a_split_index;uniform vec2 u_translation;uniform mediump float u_ratio;uniform lowp float u_device_pixel_ratio;uniform vec2 u_units_to_pixels;uniform float u_image_height;out vec2 v_normal;out vec2 v_width2;out float v_gamma_scale;out highp vec2 v_uv;
#ifdef GLOBE
out float v_depth;
#endif
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define mediump float gapwidth
#pragma mapbox: define lowp float offset
#pragma mapbox: define mediump float width
void main() {
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump float gapwidth
#pragma mapbox: initialize lowp float offset
#pragma mapbox: initialize mediump float width
float ANTIALIASING=1.0/u_device_pixel_ratio/2.0;vec2 a_extrude=a_data.xy-128.0;float a_direction=mod(a_data.z,4.0)-1.0;highp float texel_height=1.0/u_image_height;highp float half_texel_height=0.5*texel_height;v_uv=vec2(a_uv_x,a_split_index*texel_height-half_texel_height);vec2 pos=floor(a_pos_normal*0.5);mediump vec2 normal=a_pos_normal-2.0*pos;normal.y=normal.y*2.0-1.0;v_normal=normal;gapwidth=gapwidth/2.0;float halfwidth=width/2.0;offset=-1.0*offset;float inset=gapwidth+(gapwidth > 0.0 ? ANTIALIASING : 0.0);float outset=gapwidth+halfwidth*(gapwidth > 0.0 ? 2.0 : 1.0)+(halfwidth==0.0 ? 0.0 : ANTIALIASING);mediump vec2 dist=outset*a_extrude*scale;mediump float u=0.5*a_direction;mediump float t=1.0-abs(u);mediump vec2 offset2=offset*a_extrude*scale*normal.y*mat2(t,-u,u,t);float adjustedThickness=projectLineThickness(pos.y);vec4 projected_no_extrude=projectTile(pos+offset2/u_ratio*adjustedThickness+u_translation);vec4 projected_with_extrude=projectTile(pos+offset2/u_ratio*adjustedThickness+u_translation+dist/u_ratio*adjustedThickness);gl_Position=projected_with_extrude;
#ifdef GLOBE
v_depth=gl_Position.z/gl_Position.w;
#endif
#ifdef TERRAIN3D
v_gamma_scale=1.0;
#else
float extrude_length_without_perspective=length(dist);float extrude_length_with_perspective=length((projected_with_extrude.xy-projected_no_extrude.xy)/projected_with_extrude.w*u_units_to_pixels);v_gamma_scale=extrude_length_without_perspective/extrude_length_with_perspective;
#endif
v_width2=vec2(outset,inset);}`),linePattern:oi(`#ifdef GL_ES
precision highp float;
#endif
uniform lowp float u_device_pixel_ratio;uniform vec2 u_texsize;uniform float u_fade;uniform mediump vec3 u_scale;uniform sampler2D u_image;in vec2 v_normal;in vec2 v_width2;in float v_linesofar;in float v_gamma_scale;in float v_width;
#ifdef GLOBE
in float v_depth;
#endif
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
#pragma mapbox: define lowp float pixel_ratio_from
#pragma mapbox: define lowp float pixel_ratio_to
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
#pragma mapbox: initialize lowp float pixel_ratio_from
#pragma mapbox: initialize lowp float pixel_ratio_to
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
vec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;float tileZoomRatio=u_scale.x;float fromScale=u_scale.y;float toScale=u_scale.z;vec2 display_size_a=(pattern_br_a-pattern_tl_a)/pixel_ratio_from;vec2 display_size_b=(pattern_br_b-pattern_tl_b)/pixel_ratio_to;vec2 pattern_size_a=vec2(display_size_a.x*fromScale/tileZoomRatio,display_size_a.y);vec2 pattern_size_b=vec2(display_size_b.x*toScale/tileZoomRatio,display_size_b.y);float aspect_a=display_size_a.y/v_width;float aspect_b=display_size_b.y/v_width;float dist=length(v_normal)*v_width2.s;float blur2=(blur+1.0/u_device_pixel_ratio)*v_gamma_scale;float alpha=clamp(min(dist-(v_width2.t-blur2),v_width2.s-dist)/blur2,0.0,1.0);float x_a=mod(v_linesofar/pattern_size_a.x*aspect_a,1.0);float x_b=mod(v_linesofar/pattern_size_b.x*aspect_b,1.0);float y=0.5*v_normal.y+0.5;vec2 texel_size=1.0/u_texsize;vec2 pos_a=mix(pattern_tl_a*texel_size-texel_size,pattern_br_a*texel_size+texel_size,vec2(x_a,y));vec2 pos_b=mix(pattern_tl_b*texel_size-texel_size,pattern_br_b*texel_size+texel_size,vec2(x_b,y));vec4 color=mix(texture(u_image,pos_a),texture(u_image,pos_b),u_fade);fragColor=color*alpha*opacity;
#ifdef GLOBE
if (v_depth > 1.0) {discard;}
#endif
#ifdef OVERDRAW_INSPECTOR
fragColor=vec4(1.0);
#endif
}`,`
#define scale 0.015873016
#define LINE_DISTANCE_SCALE 2.0
in vec2 a_pos_normal;in vec4 a_data;uniform vec2 u_translation;uniform vec2 u_units_to_pixels;uniform mediump float u_ratio;uniform lowp float u_device_pixel_ratio;out vec2 v_normal;out vec2 v_width2;out float v_linesofar;out float v_gamma_scale;out float v_width;
#ifdef GLOBE
out float v_depth;
#endif
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp float offset
#pragma mapbox: define mediump float gapwidth
#pragma mapbox: define mediump float width
#pragma mapbox: define lowp float floorwidth
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
#pragma mapbox: define lowp float pixel_ratio_from
#pragma mapbox: define lowp float pixel_ratio_to
void main() {
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize lowp float offset
#pragma mapbox: initialize mediump float gapwidth
#pragma mapbox: initialize mediump float width
#pragma mapbox: initialize lowp float floorwidth
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
#pragma mapbox: initialize lowp float pixel_ratio_from
#pragma mapbox: initialize lowp float pixel_ratio_to
float ANTIALIASING=1.0/u_device_pixel_ratio/2.0;vec2 a_extrude=a_data.xy-128.0;float a_direction=mod(a_data.z,4.0)-1.0;float a_linesofar=(floor(a_data.z/4.0)+a_data.w*64.0)*LINE_DISTANCE_SCALE;vec2 pos=floor(a_pos_normal*0.5);mediump vec2 normal=a_pos_normal-2.0*pos;normal.y=normal.y*2.0-1.0;v_normal=normal;gapwidth=gapwidth/2.0;float halfwidth=width/2.0;offset=-1.0*offset;float inset=gapwidth+(gapwidth > 0.0 ? ANTIALIASING : 0.0);float outset=gapwidth+halfwidth*(gapwidth > 0.0 ? 2.0 : 1.0)+(halfwidth==0.0 ? 0.0 : ANTIALIASING);mediump vec2 dist=outset*a_extrude*scale;mediump float u=0.5*a_direction;mediump float t=1.0-abs(u);mediump vec2 offset2=offset*a_extrude*scale*normal.y*mat2(t,-u,u,t);float adjustedThickness=projectLineThickness(pos.y);vec4 projected_no_extrude=projectTile(pos+offset2/u_ratio*adjustedThickness+u_translation);vec4 projected_with_extrude=projectTile(pos+offset2/u_ratio*adjustedThickness+u_translation+dist/u_ratio*adjustedThickness);gl_Position=projected_with_extrude;
#ifdef GLOBE
v_depth=gl_Position.z/gl_Position.w;
#endif
#ifdef TERRAIN3D
v_gamma_scale=1.0;
#else
float extrude_length_without_perspective=length(dist);float extrude_length_with_perspective=length((projected_with_extrude.xy-projected_no_extrude.xy)/projected_with_extrude.w*u_units_to_pixels);v_gamma_scale=extrude_length_without_perspective/extrude_length_with_perspective;
#endif
v_linesofar=a_linesofar;v_width2=vec2(outset,inset);v_width=floorwidth;}`),lineSDF:oi(`uniform lowp float u_device_pixel_ratio;uniform lowp float u_lineatlas_width;uniform sampler2D u_image;uniform float u_mix;in vec2 v_normal;in vec2 v_width2;in vec2 v_tex_a;in vec2 v_tex_b;in float v_gamma_scale;
#ifdef GLOBE
in float v_depth;
#endif
#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define mediump float width
#pragma mapbox: define lowp float floorwidth
#pragma mapbox: define mediump vec4 dasharray_from
#pragma mapbox: define mediump vec4 dasharray_to
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump float width
#pragma mapbox: initialize lowp float floorwidth
#pragma mapbox: initialize mediump vec4 dasharray_from
#pragma mapbox: initialize mediump vec4 dasharray_to
float dist=length(v_normal)*v_width2.s;float blur2=(blur+1.0/u_device_pixel_ratio)*v_gamma_scale;float alpha=clamp(min(dist-(v_width2.t-blur2),v_width2.s-dist)/blur2,0.0,1.0);float sdfdist_a=texture(u_image,v_tex_a).a;float sdfdist_b=texture(u_image,v_tex_b).a;float sdfdist=mix(sdfdist_a,sdfdist_b,u_mix);float sdfgamma=(u_lineatlas_width/256.0)/min(dasharray_from.w,dasharray_to.w);alpha*=smoothstep(0.5-sdfgamma/floorwidth,0.5+sdfgamma/floorwidth,sdfdist);fragColor=color*(alpha*opacity);
#ifdef GLOBE
if (v_depth > 1.0) {discard;}
#endif
#ifdef OVERDRAW_INSPECTOR
fragColor=vec4(1.0);
#endif
}`,`
#define scale 0.015873016
#define LINE_DISTANCE_SCALE 2.0
in vec2 a_pos_normal;in vec4 a_data;uniform vec2 u_translation;uniform mediump float u_ratio;uniform lowp float u_device_pixel_ratio;uniform vec2 u_units_to_pixels;uniform float u_tileratio;uniform float u_crossfade_from;uniform float u_crossfade_to;uniform float u_lineatlas_height;out vec2 v_normal;out vec2 v_width2;out vec2 v_tex_a;out vec2 v_tex_b;out float v_gamma_scale;
#ifdef GLOBE
out float v_depth;
#endif
#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define mediump float gapwidth
#pragma mapbox: define lowp float offset
#pragma mapbox: define mediump float width
#pragma mapbox: define lowp float floorwidth
#pragma mapbox: define mediump vec4 dasharray_from
#pragma mapbox: define mediump vec4 dasharray_to
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump float gapwidth
#pragma mapbox: initialize lowp float offset
#pragma mapbox: initialize mediump float width
#pragma mapbox: initialize lowp float floorwidth
#pragma mapbox: initialize mediump vec4 dasharray_from
#pragma mapbox: initialize mediump vec4 dasharray_to
float ANTIALIASING=1.0/u_device_pixel_ratio/2.0;vec2 a_extrude=a_data.xy-128.0;float a_direction=mod(a_data.z,4.0)-1.0;float a_linesofar=(floor(a_data.z/4.0)+a_data.w*64.0)*LINE_DISTANCE_SCALE;vec2 pos=floor(a_pos_normal*0.5);mediump vec2 normal=a_pos_normal-2.0*pos;normal.y=normal.y*2.0-1.0;v_normal=normal;gapwidth=gapwidth/2.0;float halfwidth=width/2.0;offset=-1.0*offset;float inset=gapwidth+(gapwidth > 0.0 ? ANTIALIASING : 0.0);float outset=gapwidth+halfwidth*(gapwidth > 0.0 ? 2.0 : 1.0)+(halfwidth==0.0 ? 0.0 : ANTIALIASING);mediump vec2 dist=outset*a_extrude*scale;mediump float u=0.5*a_direction;mediump float t=1.0-abs(u);mediump vec2 offset2=offset*a_extrude*scale*normal.y*mat2(t,-u,u,t);float adjustedThickness=projectLineThickness(pos.y);vec4 projected_no_extrude=projectTile(pos+offset2/u_ratio*adjustedThickness+u_translation);vec4 projected_with_extrude=projectTile(pos+offset2/u_ratio*adjustedThickness+u_translation+dist/u_ratio*adjustedThickness);gl_Position=projected_with_extrude;
#ifdef GLOBE
v_depth=gl_Position.z/gl_Position.w;
#endif
#ifdef TERRAIN3D
v_gamma_scale=1.0;
#else
float extrude_length_without_perspective=length(dist);float extrude_length_with_perspective=length((projected_with_extrude.xy-projected_no_extrude.xy)/projected_with_extrude.w*u_units_to_pixels);v_gamma_scale=extrude_length_without_perspective/extrude_length_with_perspective;
#endif
float u_patternscale_a_x=u_tileratio/dasharray_from.w/u_crossfade_from;float u_patternscale_a_y=-dasharray_from.z/2.0/u_lineatlas_height;float u_patternscale_b_x=u_tileratio/dasharray_to.w/u_crossfade_to;float u_patternscale_b_y=-dasharray_to.z/2.0/u_lineatlas_height;v_tex_a=vec2(a_linesofar*u_patternscale_a_x/floorwidth,normal.y*u_patternscale_a_y+(float(dasharray_from.y)+0.5)/u_lineatlas_height);v_tex_b=vec2(a_linesofar*u_patternscale_b_x/floorwidth,normal.y*u_patternscale_b_y+(float(dasharray_to.y)+0.5)/u_lineatlas_height);v_width2=vec2(outset,inset);}`),lineGradientSDF:oi(`uniform lowp float u_device_pixel_ratio;uniform sampler2D u_image;uniform sampler2D u_image_dash;uniform float u_mix;uniform lowp float u_lineatlas_width;in vec2 v_normal;in vec2 v_width2;in vec2 v_tex_a;in vec2 v_tex_b;in float v_gamma_scale;in highp vec2 v_uv;
#ifdef GLOBE
in float v_depth;
#endif
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define mediump float width
#pragma mapbox: define lowp float floorwidth
#pragma mapbox: define mediump vec4 dasharray_from
#pragma mapbox: define mediump vec4 dasharray_to
void main() {
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump float width
#pragma mapbox: initialize lowp float floorwidth
#pragma mapbox: initialize mediump vec4 dasharray_from
#pragma mapbox: initialize mediump vec4 dasharray_to
float dist=length(v_normal)*v_width2.s;float blur2=(blur+1.0/u_device_pixel_ratio)*v_gamma_scale;float alpha=clamp(min(dist-(v_width2.t-blur2),v_width2.s-dist)/blur2,0.0,1.0);vec4 color=texture(u_image,v_uv);float sdfdist_a=texture(u_image_dash,v_tex_a).a;float sdfdist_b=texture(u_image_dash,v_tex_b).a;float sdfdist=mix(sdfdist_a,sdfdist_b,u_mix);float sdfgamma=(u_lineatlas_width/256.0)/min(dasharray_from.w,dasharray_to.w);float dash_alpha=smoothstep(0.5-sdfgamma/floorwidth,0.5+sdfgamma/floorwidth,sdfdist);fragColor=color*(alpha*dash_alpha*opacity);
#ifdef GLOBE
if (v_depth > 1.0) {discard;}
#endif
#ifdef OVERDRAW_INSPECTOR
fragColor=vec4(1.0);
#endif
}`,`
#define scale 0.015873016
#define LINE_DISTANCE_SCALE 2.0
in vec2 a_pos_normal;in vec4 a_data;in float a_uv_x;in float a_split_index;uniform vec2 u_translation;uniform mediump float u_ratio;uniform lowp float u_device_pixel_ratio;uniform vec2 u_units_to_pixels;uniform float u_image_height;uniform float u_tileratio;uniform float u_crossfade_from;uniform float u_crossfade_to;uniform float u_lineatlas_height;out vec2 v_normal;out vec2 v_width2;out float v_gamma_scale;out highp vec2 v_uv;out vec2 v_tex_a;out vec2 v_tex_b;
#ifdef GLOBE
out float v_depth;
#endif
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define mediump float gapwidth
#pragma mapbox: define lowp float offset
#pragma mapbox: define mediump float width
#pragma mapbox: define lowp float floorwidth
#pragma mapbox: define mediump vec4 dasharray_from
#pragma mapbox: define mediump vec4 dasharray_to
void main() {
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump float gapwidth
#pragma mapbox: initialize lowp float offset
#pragma mapbox: initialize mediump float width
#pragma mapbox: initialize lowp float floorwidth
#pragma mapbox: initialize mediump vec4 dasharray_from
#pragma mapbox: initialize mediump vec4 dasharray_to
float ANTIALIASING=1.0/u_device_pixel_ratio/2.0;vec2 a_extrude=a_data.xy-128.0;float a_direction=mod(a_data.z,4.0)-1.0;float a_linesofar=(floor(a_data.z/4.0)+a_data.w*64.0)*LINE_DISTANCE_SCALE;float texel_height=1.0/u_image_height;float half_texel_height=0.5*texel_height;v_uv=vec2(a_uv_x,a_split_index*texel_height-half_texel_height);vec2 pos=floor(a_pos_normal*0.5);mediump vec2 normal=a_pos_normal-2.0*pos;normal.y=normal.y*2.0-1.0;v_normal=normal;gapwidth=gapwidth/2.0;float halfwidth=width/2.0;offset=-1.0*offset;float inset=gapwidth+(gapwidth > 0.0 ? ANTIALIASING : 0.0);float outset=gapwidth+halfwidth*(gapwidth > 0.0 ? 2.0 : 1.0)+(halfwidth==0.0 ? 0.0 : ANTIALIASING);mediump vec2 dist=outset*a_extrude*scale;mediump float u=0.5*a_direction;mediump float t=1.0-abs(u);mediump vec2 offset2=offset*a_extrude*scale*normal.y*mat2(t,-u,u,t);float adjustedThickness=projectLineThickness(pos.y);vec4 projected_no_extrude=projectTile(pos+offset2/u_ratio*adjustedThickness+u_translation);vec4 projected_with_extrude=projectTile(pos+offset2/u_ratio*adjustedThickness+u_translation+dist/u_ratio*adjustedThickness);gl_Position=projected_with_extrude;
#ifdef GLOBE
v_depth=gl_Position.z/gl_Position.w;
#endif
#ifdef TERRAIN3D
v_gamma_scale=1.0;
#else
float extrude_length_without_perspective=length(dist);float extrude_length_with_perspective=length((projected_with_extrude.xy-projected_no_extrude.xy)/projected_with_extrude.w*u_units_to_pixels);v_gamma_scale=extrude_length_without_perspective/extrude_length_with_perspective;
#endif
float u_patternscale_a_x=u_tileratio/dasharray_from.w/u_crossfade_from;float u_patternscale_a_y=-dasharray_from.z/2.0/u_lineatlas_height;float u_patternscale_b_x=u_tileratio/dasharray_to.w/u_crossfade_to;float u_patternscale_b_y=-dasharray_to.z/2.0/u_lineatlas_height;v_tex_a=vec2(a_linesofar*u_patternscale_a_x/floorwidth,normal.y*u_patternscale_a_y+(float(dasharray_from.y)+0.5)/u_lineatlas_height);v_tex_b=vec2(a_linesofar*u_patternscale_b_x/floorwidth,normal.y*u_patternscale_b_y+(float(dasharray_to.y)+0.5)/u_lineatlas_height);v_width2=vec2(outset,inset);}`),raster:oi(`uniform float u_fade_t;uniform float u_opacity;uniform sampler2D u_image0;uniform sampler2D u_image1;in vec2 v_pos0;in vec2 v_pos1;uniform float u_brightness_low;uniform float u_brightness_high;uniform float u_saturation_factor;uniform float u_contrast_factor;uniform vec3 u_spin_weights;void main() {vec4 color0=texture(u_image0,v_pos0);vec4 color1=texture(u_image1,v_pos1);if (color0.a > 0.0) {color0.rgb=color0.rgb/color0.a;}if (color1.a > 0.0) {color1.rgb=color1.rgb/color1.a;}vec4 color=mix(color0,color1,u_fade_t);color.a*=u_opacity;vec3 rgb=color.rgb;rgb=vec3(dot(rgb,u_spin_weights.xyz),dot(rgb,u_spin_weights.zxy),dot(rgb,u_spin_weights.yzx));float average=(color.r+color.g+color.b)/3.0;rgb+=(average-rgb)*u_saturation_factor;rgb=(rgb-0.5)*u_contrast_factor+0.5;vec3 u_high_vec=vec3(u_brightness_low,u_brightness_low,u_brightness_low);vec3 u_low_vec=vec3(u_brightness_high,u_brightness_high,u_brightness_high);fragColor=vec4(mix(u_high_vec,u_low_vec,rgb)*color.a,color.a);
#ifdef OVERDRAW_INSPECTOR
fragColor=vec4(1.0);
#endif
}`,`uniform vec2 u_tl_parent;uniform float u_scale_parent;uniform float u_buffer_scale;uniform vec4 u_coords_top;uniform vec4 u_coords_bottom;in vec2 a_pos;out vec2 v_pos0;out vec2 v_pos1;void main() {vec2 fractionalPos=a_pos/8192.0;vec2 position=mix(mix(u_coords_top.xy,u_coords_top.zw,fractionalPos.x),mix(u_coords_bottom.xy,u_coords_bottom.zw,fractionalPos.x),fractionalPos.y);gl_Position=projectTile(position,position);v_pos0=((fractionalPos-0.5)/u_buffer_scale)+0.5;
#ifdef GLOBE
if (a_pos.y <-32767.5) {v_pos0.y=0.0;}if (a_pos.y > 32766.5) {v_pos0.y=1.0;}
#endif
v_pos1=(v_pos0*u_scale_parent)+u_tl_parent;}`),symbolIcon:oi(`uniform sampler2D u_texture;in vec2 v_tex;in float v_fade_opacity;
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize lowp float opacity
lowp float alpha=opacity*v_fade_opacity;fragColor=texture(u_texture,v_tex)*alpha;
#ifdef OVERDRAW_INSPECTOR
fragColor=vec4(1.0);
#endif
}`,`in vec4 a_pos_offset;in vec4 a_data;in vec4 a_pixeloffset;in vec3 a_projected_pos;in float a_fade_opacity;uniform bool u_is_size_zoom_constant;uniform bool u_is_size_feature_constant;uniform highp float u_size_t;uniform highp float u_size;uniform highp float u_camera_to_center_distance;uniform highp float u_pitch;uniform bool u_rotate_symbol;uniform highp float u_aspect_ratio;uniform float u_fade_change;uniform mat4 u_label_plane_matrix;uniform mat4 u_coord_matrix;uniform bool u_is_text;uniform bool u_pitch_with_map;uniform vec2 u_texsize;uniform bool u_is_along_line;uniform bool u_is_variable_anchor;uniform vec2 u_translation;uniform float u_pitched_scale;out vec2 v_tex;out float v_fade_opacity;
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize lowp float opacity
vec2 a_pos=a_pos_offset.xy;vec2 a_offset=a_pos_offset.zw;vec2 a_tex=a_data.xy;vec2 a_size=a_data.zw;float a_size_min=floor(a_size[0]*0.5);vec2 a_pxoffset=a_pixeloffset.xy;vec2 a_minFontScale=a_pixeloffset.zw/256.0;float ele=get_elevation(a_pos);highp float segment_angle=-a_projected_pos[2];float size;if (!u_is_size_zoom_constant && !u_is_size_feature_constant) {size=mix(a_size_min,a_size[1],u_size_t)/128.0;} else if (u_is_size_zoom_constant && !u_is_size_feature_constant) {size=a_size_min/128.0;} else {size=u_size;}vec2 translated_a_pos=a_pos+u_translation;vec4 projectedPoint=projectTileWithElevation(translated_a_pos,ele);highp float camera_to_anchor_distance=projectedPoint.w;highp float distance_ratio=u_pitch_with_map ?
camera_to_anchor_distance/u_camera_to_center_distance :
u_camera_to_center_distance/camera_to_anchor_distance;highp float perspective_ratio=clamp(0.5+0.5*distance_ratio,0.0,4.0);size*=perspective_ratio;float fontScale=u_is_text ? size/24.0 : size;highp float symbol_rotation=0.0;if (u_rotate_symbol) {vec4 offsetProjectedPoint=projectTileWithElevation(translated_a_pos+vec2(1,0),ele);vec2 a=projectedPoint.xy/projectedPoint.w;vec2 b=offsetProjectedPoint.xy/offsetProjectedPoint.w;symbol_rotation=atan((b.y-a.y)/u_aspect_ratio,b.x-a.x);}highp float angle_sin=sin(segment_angle+symbol_rotation);highp float angle_cos=cos(segment_angle+symbol_rotation);mat2 rotation_matrix=mat2(angle_cos,-1.0*angle_sin,angle_sin,angle_cos);vec4 projected_pos;if (u_is_along_line || u_is_variable_anchor) {projected_pos=vec4(a_projected_pos.xy,ele,1.0);} else if (u_pitch_with_map) {projected_pos=u_label_plane_matrix*vec4(a_projected_pos.xy+u_translation,ele,1.0);} else {projected_pos=u_label_plane_matrix*projectTileWithElevation(a_projected_pos.xy+u_translation,ele);}float z=float(u_pitch_with_map)*projected_pos.z/projected_pos.w;float projectionScaling=1.0;
#ifdef GLOBE
if(u_pitch_with_map) {float anchor_pos_tile_y=(u_coord_matrix*vec4(projected_pos.xy/projected_pos.w,z,1.0)).y;projectionScaling=mix(projectionScaling,1.0/circumferenceRatioAtTileY(anchor_pos_tile_y)*u_pitched_scale,u_projection_transition);}
#endif
vec4 finalPos=u_coord_matrix*vec4(projected_pos.xy/projected_pos.w+rotation_matrix*(a_offset/32.0*max(a_minFontScale,fontScale)+a_pxoffset/16.0)*projectionScaling,z,1.0);if(u_pitch_with_map) {finalPos=projectTileWithElevation(finalPos.xy,finalPos.z);}gl_Position=finalPos;v_tex=a_tex/u_texsize;vec2 fade_opacity=unpack_opacity(a_fade_opacity);float fade_change=fade_opacity[1] > 0.5 ? u_fade_change :-u_fade_change;float visibility=calculate_visibility(projectedPoint);v_fade_opacity=max(0.0,min(visibility,fade_opacity[0]+fade_change));}`),symbolSDF:oi(`#define SDF_PX 8.0
uniform bool u_is_halo;uniform sampler2D u_texture;uniform highp float u_gamma_scale;uniform lowp float u_device_pixel_ratio;uniform bool u_is_text;in vec2 v_data0;in vec3 v_data1;
#pragma mapbox: define highp vec4 fill_color
#pragma mapbox: define highp vec4 halo_color
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp float halo_width
#pragma mapbox: define lowp float halo_blur
void main() {
#pragma mapbox: initialize highp vec4 fill_color
#pragma mapbox: initialize highp vec4 halo_color
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize lowp float halo_width
#pragma mapbox: initialize lowp float halo_blur
float EDGE_GAMMA=0.105/u_device_pixel_ratio;vec2 tex=v_data0.xy;float gamma_scale=v_data1.x;float size=v_data1.y;float fade_opacity=v_data1[2];float fontScale=u_is_text ? size/24.0 : size;lowp vec4 color=fill_color;highp float gamma=EDGE_GAMMA/(fontScale*u_gamma_scale);lowp float inner_edge=(256.0-64.0)/256.0;if (u_is_halo) {color=halo_color;gamma=(halo_blur*1.19/SDF_PX+EDGE_GAMMA)/(fontScale*u_gamma_scale);inner_edge=inner_edge+gamma*gamma_scale;}lowp float dist=texture(u_texture,tex).a;highp float gamma_scaled=gamma*gamma_scale;highp float alpha=smoothstep(inner_edge-gamma_scaled,inner_edge+gamma_scaled,dist);if (u_is_halo) {lowp float halo_edge=(6.0-halo_width/fontScale)/SDF_PX;alpha=min(smoothstep(halo_edge-gamma_scaled,halo_edge+gamma_scaled,dist),1.0-alpha);}fragColor=color*(alpha*opacity*fade_opacity);
#ifdef OVERDRAW_INSPECTOR
fragColor=vec4(1.0);
#endif
}`,`in vec4 a_pos_offset;in vec4 a_data;in vec4 a_pixeloffset;in vec3 a_projected_pos;in float a_fade_opacity;uniform bool u_is_size_zoom_constant;uniform bool u_is_size_feature_constant;uniform highp float u_size_t;uniform highp float u_size;uniform mat4 u_label_plane_matrix;uniform mat4 u_coord_matrix;uniform bool u_is_text;uniform bool u_pitch_with_map;uniform bool u_is_along_line;uniform bool u_is_variable_anchor;uniform highp float u_pitch;uniform bool u_rotate_symbol;uniform highp float u_aspect_ratio;uniform highp float u_camera_to_center_distance;uniform float u_fade_change;uniform vec2 u_texsize;uniform vec2 u_translation;uniform float u_pitched_scale;out vec2 v_data0;out vec3 v_data1;
#pragma mapbox: define highp vec4 fill_color
#pragma mapbox: define highp vec4 halo_color
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp float halo_width
#pragma mapbox: define lowp float halo_blur
void main() {
#pragma mapbox: initialize highp vec4 fill_color
#pragma mapbox: initialize highp vec4 halo_color
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize lowp float halo_width
#pragma mapbox: initialize lowp float halo_blur
vec2 a_pos=a_pos_offset.xy;vec2 a_offset=a_pos_offset.zw;vec2 a_tex=a_data.xy;vec2 a_size=a_data.zw;float a_size_min=floor(a_size[0]*0.5);vec2 a_pxoffset=a_pixeloffset.xy;float ele=get_elevation(a_pos);highp float segment_angle=-a_projected_pos[2];float size;if (!u_is_size_zoom_constant && !u_is_size_feature_constant) {size=mix(a_size_min,a_size[1],u_size_t)/128.0;} else if (u_is_size_zoom_constant && !u_is_size_feature_constant) {size=a_size_min/128.0;} else {size=u_size;}vec2 translated_a_pos=a_pos+u_translation;vec4 projectedPoint=projectTileWithElevation(translated_a_pos,ele);highp float camera_to_anchor_distance=projectedPoint.w;highp float distance_ratio=u_pitch_with_map ?
camera_to_anchor_distance/u_camera_to_center_distance :
u_camera_to_center_distance/camera_to_anchor_distance;highp float perspective_ratio=clamp(0.5+0.5*distance_ratio,0.0,4.0);size*=perspective_ratio;float fontScale=u_is_text ? size/24.0 : size;highp float symbol_rotation=0.0;if (u_rotate_symbol) {vec4 offsetProjectedPoint=projectTileWithElevation(translated_a_pos+vec2(1,0),ele);vec2 a=projectedPoint.xy/projectedPoint.w;vec2 b=offsetProjectedPoint.xy/offsetProjectedPoint.w;symbol_rotation=atan((b.y-a.y)/u_aspect_ratio,b.x-a.x);}highp float angle_sin=sin(segment_angle+symbol_rotation);highp float angle_cos=cos(segment_angle+symbol_rotation);mat2 rotation_matrix=mat2(angle_cos,-1.0*angle_sin,angle_sin,angle_cos);vec4 projected_pos;if (u_is_along_line || u_is_variable_anchor) {projected_pos=vec4(a_projected_pos.xy,ele,1.0);} else if (u_pitch_with_map) {projected_pos=u_label_plane_matrix*vec4(a_projected_pos.xy+u_translation,ele,1.0);} else {projected_pos=u_label_plane_matrix*projectTileWithElevation(a_projected_pos.xy+u_translation,ele);}float z=float(u_pitch_with_map)*projected_pos.z/projected_pos.w;float projectionScaling=1.0;
#ifdef GLOBE
if(u_pitch_with_map) {float anchor_pos_tile_y=(u_coord_matrix*vec4(projected_pos.xy/projected_pos.w,z,1.0)).y;projectionScaling=mix(projectionScaling,1.0/circumferenceRatioAtTileY(anchor_pos_tile_y)*u_pitched_scale,u_projection_transition);}
#endif
vec4 finalPos=u_coord_matrix*vec4(projected_pos.xy/projected_pos.w+rotation_matrix*(a_offset/32.0*fontScale+a_pxoffset)*projectionScaling,z,1.0);if(u_pitch_with_map) {finalPos=projectTileWithElevation(finalPos.xy,finalPos.z);}float gamma_scale=finalPos.w;gl_Position=finalPos;vec2 fade_opacity=unpack_opacity(a_fade_opacity);float visibility=calculate_visibility(projectedPoint);float fade_change=fade_opacity[1] > 0.5 ? u_fade_change :-u_fade_change;float interpolated_fade_opacity=max(0.0,min(visibility,fade_opacity[0]+fade_change));v_data0=a_tex/u_texsize;v_data1=vec3(gamma_scale,size,interpolated_fade_opacity);}`),symbolTextAndIcon:oi(`#define SDF_PX 8.0
#define SDF 1.0
#define ICON 0.0
uniform bool u_is_halo;uniform sampler2D u_texture;uniform sampler2D u_texture_icon;uniform highp float u_gamma_scale;uniform lowp float u_device_pixel_ratio;in vec4 v_data0;in vec4 v_data1;
#pragma mapbox: define highp vec4 fill_color
#pragma mapbox: define highp vec4 halo_color
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp float halo_width
#pragma mapbox: define lowp float halo_blur
void main() {
#pragma mapbox: initialize highp vec4 fill_color
#pragma mapbox: initialize highp vec4 halo_color
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize lowp float halo_width
#pragma mapbox: initialize lowp float halo_blur
float fade_opacity=v_data1[2];if (v_data1.w==ICON) {vec2 tex_icon=v_data0.zw;lowp float alpha=opacity*fade_opacity;fragColor=texture(u_texture_icon,tex_icon)*alpha;
#ifdef OVERDRAW_INSPECTOR
fragColor=vec4(1.0);
#endif
return;}vec2 tex=v_data0.xy;float EDGE_GAMMA=0.105/u_device_pixel_ratio;float gamma_scale=v_data1.x;float size=v_data1.y;float fontScale=size/24.0;lowp vec4 color=fill_color;highp float gamma=EDGE_GAMMA/(fontScale*u_gamma_scale);lowp float buff=(256.0-64.0)/256.0;if (u_is_halo) {color=halo_color;gamma=(halo_blur*1.19/SDF_PX+EDGE_GAMMA)/(fontScale*u_gamma_scale);buff=(6.0-halo_width/fontScale)/SDF_PX;}lowp float dist=texture(u_texture,tex).a;highp float gamma_scaled=gamma*gamma_scale;highp float alpha=smoothstep(buff-gamma_scaled,buff+gamma_scaled,dist);fragColor=color*(alpha*opacity*fade_opacity);
#ifdef OVERDRAW_INSPECTOR
fragColor=vec4(1.0);
#endif
}`,`in vec4 a_pos_offset;in vec4 a_data;in vec3 a_projected_pos;in float a_fade_opacity;uniform bool u_is_size_zoom_constant;uniform bool u_is_size_feature_constant;uniform highp float u_size_t;uniform highp float u_size;uniform mat4 u_label_plane_matrix;uniform mat4 u_coord_matrix;uniform bool u_is_text;uniform bool u_pitch_with_map;uniform highp float u_pitch;uniform bool u_rotate_symbol;uniform highp float u_aspect_ratio;uniform highp float u_camera_to_center_distance;uniform float u_fade_change;uniform vec2 u_texsize;uniform vec2 u_texsize_icon;uniform bool u_is_along_line;uniform bool u_is_variable_anchor;uniform vec2 u_translation;uniform float u_pitched_scale;out vec4 v_data0;out vec4 v_data1;
#pragma mapbox: define highp vec4 fill_color
#pragma mapbox: define highp vec4 halo_color
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp float halo_width
#pragma mapbox: define lowp float halo_blur
void main() {
#pragma mapbox: initialize highp vec4 fill_color
#pragma mapbox: initialize highp vec4 halo_color
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize lowp float halo_width
#pragma mapbox: initialize lowp float halo_blur
vec2 a_pos=a_pos_offset.xy;vec2 a_offset=a_pos_offset.zw;vec2 a_tex=a_data.xy;vec2 a_size=a_data.zw;float a_size_min=floor(a_size[0]*0.5);float is_sdf=a_size[0]-2.0*a_size_min;float ele=get_elevation(a_pos);highp float segment_angle=-a_projected_pos[2];float size;if (!u_is_size_zoom_constant && !u_is_size_feature_constant) {size=mix(a_size_min,a_size[1],u_size_t)/128.0;} else if (u_is_size_zoom_constant && !u_is_size_feature_constant) {size=a_size_min/128.0;} else {size=u_size;}vec2 translated_a_pos=a_pos+u_translation;vec4 projectedPoint=projectTileWithElevation(translated_a_pos,ele);highp float camera_to_anchor_distance=projectedPoint.w;highp float distance_ratio=u_pitch_with_map ?
camera_to_anchor_distance/u_camera_to_center_distance :
u_camera_to_center_distance/camera_to_anchor_distance;highp float perspective_ratio=clamp(0.5+0.5*distance_ratio,0.0,4.0);size*=perspective_ratio;float fontScale=size/24.0;highp float symbol_rotation=0.0;if (u_rotate_symbol) {vec4 offsetProjectedPoint=projectTileWithElevation(translated_a_pos+vec2(1,0),ele);vec2 a=projectedPoint.xy/projectedPoint.w;vec2 b=offsetProjectedPoint.xy/offsetProjectedPoint.w;symbol_rotation=atan((b.y-a.y)/u_aspect_ratio,b.x-a.x);}highp float angle_sin=sin(segment_angle+symbol_rotation);highp float angle_cos=cos(segment_angle+symbol_rotation);mat2 rotation_matrix=mat2(angle_cos,-1.0*angle_sin,angle_sin,angle_cos);vec4 projected_pos;if (u_is_along_line || u_is_variable_anchor) {projected_pos=vec4(a_projected_pos.xy,ele,1.0);} else if (u_pitch_with_map) {projected_pos=u_label_plane_matrix*vec4(a_projected_pos.xy+u_translation,ele,1.0);} else {projected_pos=u_label_plane_matrix*projectTileWithElevation(a_projected_pos.xy+u_translation,ele);}float z=float(u_pitch_with_map)*projected_pos.z/projected_pos.w;float projectionScaling=1.0;
#ifdef GLOBE
if(u_pitch_with_map && !u_is_along_line) {float anchor_pos_tile_y=(u_coord_matrix*vec4(projected_pos.xy/projected_pos.w,z,1.0)).y;projectionScaling=mix(projectionScaling,1.0/circumferenceRatioAtTileY(anchor_pos_tile_y)*u_pitched_scale,u_projection_transition);}
#endif
vec4 finalPos=u_coord_matrix*vec4(projected_pos.xy/projected_pos.w+rotation_matrix*(a_offset/32.0*fontScale)*projectionScaling,z,1.0);if(u_pitch_with_map) {finalPos=projectTileWithElevation(finalPos.xy,finalPos.z);}float gamma_scale=finalPos.w;gl_Position=finalPos;vec2 fade_opacity=unpack_opacity(a_fade_opacity);float visibility=calculate_visibility(projectedPoint);float fade_change=fade_opacity[1] > 0.5 ? u_fade_change :-u_fade_change;float interpolated_fade_opacity=max(0.0,min(visibility,fade_opacity[0]+fade_change));v_data0.xy=a_tex/u_texsize;v_data0.zw=a_tex/u_texsize_icon;v_data1=vec4(gamma_scale,size,interpolated_fade_opacity,is_sdf);}`),terrain:oi("uniform sampler2D u_texture;uniform vec4 u_fog_color;uniform vec4 u_horizon_color;uniform float u_fog_ground_blend;uniform float u_fog_ground_blend_opacity;uniform float u_horizon_fog_blend;uniform bool u_is_globe_mode;in vec2 v_texture_pos;in float v_fog_depth;const float gamma=2.2;vec4 gammaToLinear(vec4 color) {return pow(color,vec4(gamma));}vec4 linearToGamma(vec4 color) {return pow(color,vec4(1.0/gamma));}void main() {vec4 surface_color=texture(u_texture,vec2(v_texture_pos.x,1.0-v_texture_pos.y));if (!u_is_globe_mode && v_fog_depth > u_fog_ground_blend) {vec4 surface_color_linear=gammaToLinear(surface_color);float blend_color=smoothstep(0.0,1.0,max((v_fog_depth-u_horizon_fog_blend)/(1.0-u_horizon_fog_blend),0.0));vec4 fog_horizon_color_linear=mix(gammaToLinear(u_fog_color),gammaToLinear(u_horizon_color),blend_color);float factor_fog=max(v_fog_depth-u_fog_ground_blend,0.0)/(1.0-u_fog_ground_blend);fragColor=linearToGamma(mix(surface_color_linear,fog_horizon_color_linear,pow(factor_fog,2.0)*u_fog_ground_blend_opacity));} else {fragColor=surface_color;}}","in vec3 a_pos3d;uniform mat4 u_fog_matrix;uniform float u_ele_delta;out vec2 v_texture_pos;out float v_fog_depth;void main() {float ele=get_elevation(a_pos3d.xy);float ele_delta=a_pos3d.z==1.0 ? u_ele_delta : 0.0;v_texture_pos=a_pos3d.xy/8192.0;gl_Position=projectTileFor3D(a_pos3d.xy,get_elevation(a_pos3d.xy)-ele_delta);vec4 pos=u_fog_matrix*vec4(a_pos3d.xy,ele,1.0);v_fog_depth=pos.z/pos.w*0.5+0.5;}"),terrainDepth:oi("in float v_depth;const highp vec4 bitSh=vec4(256.*256.*256.,256.*256.,256.,1.);const highp vec4 bitMsk=vec4(0.,vec3(1./256.0));highp vec4 pack(highp float value) {highp vec4 comp=fract(value*bitSh);comp-=comp.xxyz*bitMsk;return comp;}void main() {fragColor=pack(v_depth);}","in vec3 a_pos3d;uniform float u_ele_delta;out float v_depth;void main() {float ele=get_elevation(a_pos3d.xy);float ele_delta=a_pos3d.z==1.0 ? u_ele_delta : 0.0;gl_Position=projectTileFor3D(a_pos3d.xy,ele-ele_delta);v_depth=gl_Position.z/gl_Position.w;}"),terrainCoords:oi("precision mediump float;uniform sampler2D u_texture;uniform float u_terrain_coords_id;in vec2 v_texture_pos;void main() {vec4 rgba=texture(u_texture,v_texture_pos);fragColor=vec4(rgba.r,rgba.g,rgba.b,u_terrain_coords_id);}","in vec3 a_pos3d;uniform float u_ele_delta;out vec2 v_texture_pos;void main() {float ele=get_elevation(a_pos3d.xy);float ele_delta=a_pos3d.z==1.0 ? u_ele_delta : 0.0;v_texture_pos=a_pos3d.xy/8192.0;gl_Position=projectTileFor3D(a_pos3d.xy,ele-ele_delta);}"),projectionErrorMeasurement:oi("in vec4 v_output_error_encoded;void main() {fragColor=v_output_error_encoded;}","in vec2 a_pos;uniform highp float u_input;uniform highp float u_output_expected;out vec4 v_output_error_encoded;void main() {float real_output=2.0*atan(exp(PI-(u_input*PI*2.0)))-PI*0.5;float error=real_output-u_output_expected;float abs_error=abs(error)*128.0;v_output_error_encoded.x=min(floor(abs_error*256.0),255.0)/255.0;abs_error-=v_output_error_encoded.x;v_output_error_encoded.y=min(floor(abs_error*65536.0),255.0)/255.0;abs_error-=v_output_error_encoded.x/255.0;v_output_error_encoded.z=min(floor(abs_error*16777216.0),255.0)/255.0;v_output_error_encoded.w=error >=0.0 ? 1.0 : 0.0;gl_Position=vec4(a_pos,0.0,1.0);}"),atmosphere:oi(`in vec3 view_direction;uniform vec3 u_sun_pos;uniform vec3 u_globe_position;uniform float u_globe_radius;uniform float u_atmosphere_blend;/**Shader use from https:*Made some change to adapt to MapLibre Globe geometry*/const float PI=3.141592653589793;const int iSteps=5;const int jSteps=3;/*radius of the planet*/const float EARTH_RADIUS=6371e3;/*radius of the atmosphere*/const float ATMOS_RADIUS=6471e3;vec2 rsi(vec3 r0,vec3 rd,float sr) {float a=dot(rd,rd);float b=2.0*dot(rd,r0);float c=dot(r0,r0)-(sr*sr);float d=(b*b)-4.0*a*c;if (d < 0.0) return vec2(1e5,-1e5);return vec2((-b-sqrt(d))/(2.0*a),(-b+sqrt(d))/(2.0*a));}vec4 atmosphere(vec3 r,vec3 r0,vec3 pSun,float iSun,float rPlanet,float rAtmos,vec3 kRlh,float kMie,float shRlh,float shMie,float g) {pSun=normalize(pSun);r=normalize(r);vec2 p=rsi(r0,r,rAtmos);if (p.x > p.y) {return vec4(0.0,0.0,0.0,1.0);}if (p.x < 0.0) {p.x=0.0;}vec3 pos=r0+r*p.x;vec2 p2=rsi(r0,r,rPlanet);if (p2.x <=p2.y && p2.x > 0.0) {p.y=min(p.y,p2.x);}float iStepSize=(p.y-p.x)/float(iSteps);float iTime=p.x+iStepSize*0.5;vec3 totalRlh=vec3(0,0,0);vec3 totalMie=vec3(0,0,0);float iOdRlh=0.0;float iOdMie=0.0;float mu=dot(r,pSun);float mumu=mu*mu;float gg=g*g;float pRlh=3.0/(16.0*PI)*(1.0+mumu);float pMie=3.0/(8.0*PI)*((1.0-gg)*(mumu+1.0))/(pow(1.0+gg-2.0*mu*g,1.5)*(2.0+gg));for (int i=0; i < iSteps; i++) {vec3 iPos=r0+r*iTime;float iHeight=length(iPos)-rPlanet;float odStepRlh=exp(-iHeight/shRlh)*iStepSize;float odStepMie=exp(-iHeight/shMie)*iStepSize;iOdRlh+=odStepRlh;iOdMie+=odStepMie;float jStepSize=rsi(iPos,pSun,rAtmos).y/float(jSteps);float jTime=jStepSize*0.5;float jOdRlh=0.0;float jOdMie=0.0;for (int j=0; j < jSteps; j++) {vec3 jPos=iPos+pSun*jTime;float jHeight=length(jPos)-rPlanet;jOdRlh+=exp(-jHeight/shRlh)*jStepSize;jOdMie+=exp(-jHeight/shMie)*jStepSize;jTime+=jStepSize;}vec3 attn=exp(-(kMie*(iOdMie+jOdMie)+kRlh*(iOdRlh+jOdRlh)));totalRlh+=odStepRlh*attn;totalMie+=odStepMie*attn;iTime+=iStepSize;}float opacity=exp(-(length(kRlh)*length(totalRlh)+kMie*length(totalMie)));vec3 color=iSun*(pRlh*kRlh*totalRlh+pMie*kMie*totalMie);return vec4(color,opacity);}void main() {vec3 scale_camera_pos=-u_globe_position*EARTH_RADIUS/u_globe_radius;vec4 color=atmosphere(normalize(view_direction),scale_camera_pos,u_sun_pos,22.0,EARTH_RADIUS,ATMOS_RADIUS,vec3(5.5e-6,13.0e-6,22.4e-6),21e-6,8e3,1.2e3,0.758
);color.rgb=1.0-exp(-1.0*color.rgb);color=pow(color,vec4(1.0/2.2));fragColor=vec4(color.rgb,1.0-color.a)*u_atmosphere_blend;}`,"in vec2 a_pos;uniform mat4 u_inv_proj_matrix;out vec3 view_direction;void main() {view_direction=(u_inv_proj_matrix*vec4(a_pos,0.0,1.0)).xyz;gl_Position=vec4(a_pos,0.0,1.0);}"),sky:oi("uniform vec4 u_sky_color;uniform vec4 u_horizon_color;uniform vec2 u_horizon;uniform vec2 u_horizon_normal;uniform float u_sky_horizon_blend;uniform float u_sky_blend;void main() {float x=gl_FragCoord.x;float y=gl_FragCoord.y;float blend=(y-u_horizon.y)*u_horizon_normal.y+(x-u_horizon.x)*u_horizon_normal.x;if (blend > 0.0) {if (blend < u_sky_horizon_blend) {fragColor=mix(u_sky_color,u_horizon_color,pow(1.0-blend/u_sky_horizon_blend,2.0));} else {fragColor=u_sky_color;}}fragColor=mix(fragColor,vec4(vec3(0.0),0.0),u_sky_blend);}","in vec2 a_pos;void main() {gl_Position=vec4(a_pos,1.0,1.0);}")};function oi(se,t){const Z=/#pragma mapbox: ([\w]+) ([\w]+) ([\w]+) ([\w]+)/g,Q=t.match(/in ([\w]+) ([\w]+)/g),ie=se.match(/uniform ([\w]+) ([\w]+)([\s]*)([\w]*)/g),ue=t.match(/uniform ([\w]+) ([\w]+)([\s]*)([\w]*)/g),de=ue?ue.concat(ie):ie,ge={};return{fragmentSource:se=se.replace(Z,((ve,qe,Re,Le,Fe)=>(ge[Fe]=!0,qe==="define"?`
#ifndef HAS_UNIFORM_u_${Fe}
in ${Re} ${Le} ${Fe};
#else
uniform ${Re} ${Le} u_${Fe};
#endif
`:`
#ifdef HAS_UNIFORM_u_${Fe}
    ${Re} ${Le} ${Fe} = u_${Fe};
#endif
`))),vertexSource:t=t.replace(Z,((ve,qe,Re,Le,Fe)=>{const Ve=Le==="float"?"vec2":"vec4",Xe=Fe.match(/color/)?"color":Ve;return ge[Fe]?qe==="define"?`
#ifndef HAS_UNIFORM_u_${Fe}
uniform lowp float u_${Fe}_t;
in ${Re} ${Ve} a_${Fe};
out ${Re} ${Le} ${Fe};
#else
uniform ${Re} ${Le} u_${Fe};
#endif
`:Xe==="vec4"?`
#ifndef HAS_UNIFORM_u_${Fe}
    ${Fe} = a_${Fe};
#else
    ${Re} ${Le} ${Fe} = u_${Fe};
#endif
`:`
#ifndef HAS_UNIFORM_u_${Fe}
    ${Fe} = unpack_mix_${Xe}(a_${Fe}, u_${Fe}_t);
#else
    ${Re} ${Le} ${Fe} = u_${Fe};
#endif
`:qe==="define"?`
#ifndef HAS_UNIFORM_u_${Fe}
uniform lowp float u_${Fe}_t;
in ${Re} ${Ve} a_${Fe};
#else
uniform ${Re} ${Le} u_${Fe};
#endif
`:Xe==="vec4"?`
#ifndef HAS_UNIFORM_u_${Fe}
    ${Re} ${Le} ${Fe} = a_${Fe};
#else
    ${Re} ${Le} ${Fe} = u_${Fe};
#endif
`:`
#ifndef HAS_UNIFORM_u_${Fe}
    ${Re} ${Le} ${Fe} = unpack_mix_${Xe}(a_${Fe}, u_${Fe}_t);
#else
    ${Re} ${Le} ${Fe} = u_${Fe};
#endif
`})),staticAttributes:Q,staticUniforms:de}}class ja{constructor(t,Z,Q){this.vertexBuffer=t,this.indexBuffer=Z,this.segments=Q}destroy(){this.vertexBuffer.destroy(),this.indexBuffer.destroy(),this.segments.destroy(),this.vertexBuffer=null,this.indexBuffer=null,this.segments=null}}var dn=R.aJ([{name:"a_pos",type:"Int16",components:2}]);const va="#define PROJECTION_MERCATOR",Qr="mercator";class yo{constructor(){this._cachedMesh=null}get name(){return"mercator"}get useSubdivision(){return!1}get shaderVariantName(){return Qr}get shaderDefine(){return va}get shaderPreludeCode(){return hn.projectionMercator}get vertexShaderPreludeCode(){return hn.projectionMercator.vertexSource}get subdivisionGranularity(){return R.aK.noSubdivision}get useGlobeControls(){return!1}get transitionState(){return 0}get latitudeErrorCorrectionRadians(){return 0}destroy(){}updateGPUdependent(t){}getMeshFromTileID(t,Z,Q,ie,ue){if(this._cachedMesh)return this._cachedMesh;const de=new R.aL;de.emplaceBack(0,0),de.emplaceBack(R.$,0),de.emplaceBack(0,R.$),de.emplaceBack(R.$,R.$);const ge=t.createVertexBuffer(de,dn.members),ve=R.aM.simpleSegment(0,0,4,2),qe=new R.aN;qe.emplaceBack(1,0,2),qe.emplaceBack(1,2,3);const Re=t.createIndexBuffer(qe);return this._cachedMesh=new ja(ge,Re,ve),this._cachedMesh}recalculate(){}hasTransition(){return!1}setErrorQueryLatitudeDegrees(t){}}class go{constructor(t=0,Z=0,Q=0,ie=0){if(isNaN(t)||t<0||isNaN(Z)||Z<0||isNaN(Q)||Q<0||isNaN(ie)||ie<0)throw new Error("Invalid value for edge-insets, top, bottom, left and right must all be numbers");this.top=t,this.bottom=Z,this.left=Q,this.right=ie}interpolate(t,Z,Q){return Z.top!=null&&t.top!=null&&(this.top=R.C.number(t.top,Z.top,Q)),Z.bottom!=null&&t.bottom!=null&&(this.bottom=R.C.number(t.bottom,Z.bottom,Q)),Z.left!=null&&t.left!=null&&(this.left=R.C.number(t.left,Z.left,Q)),Z.right!=null&&t.right!=null&&(this.right=R.C.number(t.right,Z.right,Q)),this}getCenter(t,Z){const Q=R.ah((this.left+t-this.right)/2,0,t),ie=R.ah((this.top+Z-this.bottom)/2,0,Z);return new R.P(Q,ie)}equals(t){return this.top===t.top&&this.bottom===t.bottom&&this.left===t.left&&this.right===t.right}clone(){return new go(this.top,this.bottom,this.left,this.right)}toJSON(){return{top:this.top,bottom:this.bottom,left:this.left,right:this.right}}}function za(se,t){if(!se.renderWorldCopies||se.lngRange)return;const Z=t.lng-se.center.lng;t.lng+=Z>180?-360:Z<-180?360:0}function yn(se){return Math.max(0,Math.floor(se))}class en{constructor(t,Z,Q,ie,ue,de){this._callbacks=t,this._tileSize=512,this._renderWorldCopies=de===void 0||!!de,this._minZoom=Z||0,this._maxZoom=Q||22,this._minPitch=ie??0,this._maxPitch=ue??60,this.setMaxBounds(),this._width=0,this._height=0,this._center=new R.S(0,0),this._elevation=0,this._zoom=0,this._tileZoom=yn(this._zoom),this._scale=R.af(this._zoom),this._bearingInRadians=0,this._fovInRadians=.6435011087932844,this._pitchInRadians=0,this._rollInRadians=0,this._unmodified=!0,this._edgeInsets=new go,this._minElevationForCurrentTile=0,this._autoCalculateNearFarZ=!0}apply(t,Z,Q){this._latRange=t.latRange,this._lngRange=t.lngRange,this._width=t.width,this._height=t.height,this._center=t.center,this._elevation=t.elevation,this._minElevationForCurrentTile=t.minElevationForCurrentTile,this._zoom=t.zoom,this._tileZoom=yn(this._zoom),this._scale=R.af(this._zoom),this._bearingInRadians=t.bearingInRadians,this._fovInRadians=t.fovInRadians,this._pitchInRadians=t.pitchInRadians,this._rollInRadians=t.rollInRadians,this._unmodified=t.unmodified,this._edgeInsets=new go(t.padding.top,t.padding.bottom,t.padding.left,t.padding.right),this._minZoom=t.minZoom,this._maxZoom=t.maxZoom,this._minPitch=t.minPitch,this._maxPitch=t.maxPitch,this._renderWorldCopies=t.renderWorldCopies,this._cameraToCenterDistance=t.cameraToCenterDistance,this._nearZ=t.nearZ,this._farZ=t.farZ,this._autoCalculateNearFarZ=!Q&&t.autoCalculateNearFarZ,Z&&this._constrain(),this._calcMatrices()}get pixelsToClipSpaceMatrix(){return this._pixelsToClipSpaceMatrix}get clipSpaceToPixelsMatrix(){return this._clipSpaceToPixelsMatrix}get minElevationForCurrentTile(){return this._minElevationForCurrentTile}setMinElevationForCurrentTile(t){this._minElevationForCurrentTile=t}get tileSize(){return this._tileSize}get tileZoom(){return this._tileZoom}get scale(){return this._scale}get width(){return this._width}get height(){return this._height}get bearingInRadians(){return this._bearingInRadians}get lngRange(){return this._lngRange}get latRange(){return this._latRange}get pixelsToGLUnits(){return this._pixelsToGLUnits}get minZoom(){return this._minZoom}setMinZoom(t){this._minZoom!==t&&(this._minZoom=t,this.setZoom(this.getConstrained(this._center,this.zoom).zoom))}get maxZoom(){return this._maxZoom}setMaxZoom(t){this._maxZoom!==t&&(this._maxZoom=t,this.setZoom(this.getConstrained(this._center,this.zoom).zoom))}get minPitch(){return this._minPitch}setMinPitch(t){this._minPitch!==t&&(this._minPitch=t,this.setPitch(Math.max(this.pitch,t)))}get maxPitch(){return this._maxPitch}setMaxPitch(t){this._maxPitch!==t&&(this._maxPitch=t,this.setPitch(Math.min(this.pitch,t)))}get renderWorldCopies(){return this._renderWorldCopies}setRenderWorldCopies(t){t===void 0?t=!0:t===null&&(t=!1),this._renderWorldCopies=t}get worldSize(){return this._tileSize*this._scale}get centerOffset(){return this.centerPoint._sub(this.size._div(2))}get size(){return new R.P(this._width,this._height)}get bearing(){return this._bearingInRadians/Math.PI*180}setBearing(t){const Z=R.aO(t,-180,180)*Math.PI/180;var Q,ie,ue,de,ge,ve,qe,Re,Le;this._bearingInRadians!==Z&&(this._unmodified=!1,this._bearingInRadians=Z,this._calcMatrices(),this._rotationMatrix=K(),Q=this._rotationMatrix,ue=-this._bearingInRadians,de=(ie=this._rotationMatrix)[0],ge=ie[1],ve=ie[2],qe=ie[3],Re=Math.sin(ue),Le=Math.cos(ue),Q[0]=de*Le+ve*Re,Q[1]=ge*Le+qe*Re,Q[2]=de*-Re+ve*Le,Q[3]=ge*-Re+qe*Le)}get rotationMatrix(){return this._rotationMatrix}get pitchInRadians(){return this._pitchInRadians}get pitch(){return this._pitchInRadians/Math.PI*180}setPitch(t){const Z=R.ah(t,this.minPitch,this.maxPitch)/180*Math.PI;this._pitchInRadians!==Z&&(this._unmodified=!1,this._pitchInRadians=Z,this._calcMatrices())}get rollInRadians(){return this._rollInRadians}get roll(){return this._rollInRadians/Math.PI*180}setRoll(t){const Z=t/180*Math.PI;this._rollInRadians!==Z&&(this._unmodified=!1,this._rollInRadians=Z,this._calcMatrices())}get fovInRadians(){return this._fovInRadians}get fov(){return R.aP(this._fovInRadians)}setFov(t){t=R.ah(t,.1,150),this.fov!==t&&(this._unmodified=!1,this._fovInRadians=R.ae(t),this._calcMatrices())}get zoom(){return this._zoom}setZoom(t){const Z=this.getConstrained(this._center,t).zoom;this._zoom!==Z&&(this._unmodified=!1,this._zoom=Z,this._tileZoom=Math.max(0,Math.floor(Z)),this._scale=R.af(Z),this._constrain(),this._calcMatrices())}get center(){return this._center}setCenter(t){t.lat===this._center.lat&&t.lng===this._center.lng||(this._unmodified=!1,this._center=t,this._constrain(),this._calcMatrices())}get elevation(){return this._elevation}setElevation(t){t!==this._elevation&&(this._elevation=t,this._constrain(),this._calcMatrices())}get padding(){return this._edgeInsets.toJSON()}setPadding(t){this._edgeInsets.equals(t)||(this._unmodified=!1,this._edgeInsets.interpolate(this._edgeInsets,t,1),this._calcMatrices())}get centerPoint(){return this._edgeInsets.getCenter(this._width,this._height)}get pixelsPerMeter(){return this._pixelPerMeter}get unmodified(){return this._unmodified}get cameraToCenterDistance(){return this._cameraToCenterDistance}get nearZ(){return this._nearZ}get farZ(){return this._farZ}get autoCalculateNearFarZ(){return this._autoCalculateNearFarZ}overrideNearFarZ(t,Z){this._autoCalculateNearFarZ=!1,this._nearZ=t,this._farZ=Z,this._calcMatrices()}clearNearFarZOverride(){this._autoCalculateNearFarZ=!0,this._calcMatrices()}isPaddingEqual(t){return this._edgeInsets.equals(t)}interpolatePadding(t,Z,Q){this._unmodified=!1,this._edgeInsets.interpolate(t,Z,Q),this._constrain(),this._calcMatrices()}resize(t,Z,Q=!0){this._width=t,this._height=Z,Q&&this._constrain(),this._calcMatrices()}getMaxBounds(){return this._latRange&&this._latRange.length===2&&this._lngRange&&this._lngRange.length===2?new gr([this._lngRange[0],this._latRange[0]],[this._lngRange[1],this._latRange[1]]):null}setMaxBounds(t){t?(this._lngRange=[t.getWest(),t.getEast()],this._latRange=[t.getSouth(),t.getNorth()],this._constrain()):(this._lngRange=null,this._latRange=[-R.ai,R.ai])}getConstrained(t,Z){return this._callbacks.getConstrained(t,Z)}getCameraQueryGeometry(t,Z){if(Z.length===1)return[Z[0],t];{const{minX:Q,minY:ie,maxX:ue,maxY:de}=R.a2.fromPoints(Z).extend(t);return[new R.P(Q,ie),new R.P(ue,ie),new R.P(ue,de),new R.P(Q,de),new R.P(Q,ie)]}}_constrain(){if(!this.center||!this._width||!this._height||this._constraining)return;this._constraining=!0;const t=this._unmodified,{center:Z,zoom:Q}=this.getConstrained(this.center,this.zoom);this.setCenter(Z),this.setZoom(Q),this._unmodified=t,this._constraining=!1}_calcMatrices(){if(this._width&&this._height){this._pixelsToGLUnits=[2/this._width,-2/this._height];let t=R.ag(new Float64Array(16));R.N(t,t,[this._width/2,-this._height/2,1]),R.M(t,t,[1,-1,0]),this._clipSpaceToPixelsMatrix=t,t=R.ag(new Float64Array(16)),R.N(t,t,[1,-1,1]),R.M(t,t,[-1,-1,0]),R.N(t,t,[2/this._width,2/this._height,1]),this._pixelsToClipSpaceMatrix=t,this._cameraToCenterDistance=.5/Math.tan(this.fovInRadians/2)*this._height}this._callbacks.calcMatrices()}calculateCenterFromCameraLngLatAlt(t,Z,Q,ie){const ue=Q!==void 0?Q:this.bearing,de=ie=ie!==void 0?ie:this.pitch,ge=R.a1.fromLngLat(t,Z),ve=-Math.cos(R.ae(de)),qe=Math.sin(R.ae(de)),Re=qe*Math.sin(R.ae(ue)),Le=-qe*Math.cos(R.ae(ue));let Fe=this.elevation;const Ve=Z-Fe;let Xe;ve*Ve>=0||Math.abs(ve)<.1?(Xe=1e4,Fe=Z+Xe*ve):Xe=-Ve/ve;let at,ot,lt=R.aQ(1,ge.y),pt=0;do{if(pt+=1,pt>10)break;ot=Xe/lt,at=new R.a1(ge.x+Re*ot,ge.y+Le*ot),lt=1/at.meterInMercatorCoordinateUnits()}while(Math.abs(Xe-ot*lt)>1e-12);return{center:at.toLngLat(),elevation:Fe,zoom:R.ak(this.height/2/Math.tan(this.fovInRadians/2)/ot/this.tileSize)}}recalculateZoomAndCenter(t){if(this.elevation-t==0)return;const Z=R.aj(1,this.center.lat)*this.worldSize,Q=this.cameraToCenterDistance/Z,ie=R.a1.fromLngLat(this.center,this.elevation),ue=st(this.center,this.elevation,this.pitch,this.bearing,Q);this._elevation=t;const de=this.calculateCenterFromCameraLngLatAlt(ue.toLngLat(),R.aQ(ue.z,ie.y),this.bearing,this.pitch);this._elevation=de.elevation,this._center=de.center,this.setZoom(de.zoom)}getCameraPoint(){const t=Math.tan(this.pitchInRadians)*(this.cameraToCenterDistance||1);return this.centerPoint.add(new R.P(t*Math.sin(this.rollInRadians),t*Math.cos(this.rollInRadians)))}getCameraAltitude(){return Math.cos(this.pitchInRadians)*this._cameraToCenterDistance/this._pixelPerMeter+this.elevation}getCameraLngLat(){const t=R.aj(1,this.center.lat)*this.worldSize;return st(this.center,this.elevation,this.pitch,this.bearing,this.cameraToCenterDistance/t).toLngLat()}getMercatorTileCoordinates(t){if(!t)return[0,0,1,1];const Z=t.canonical.z>=0?1<<t.canonical.z:Math.pow(2,t.canonical.z);return[t.canonical.x/Z,t.canonical.y/Z,1/Z/R.$,1/Z/R.$]}}class $i{constructor(t,Z){this.min=t,this.max=Z,this.center=R.aR([],R.aS([],this.min,this.max),.5)}quadrant(t){const Z=[t%2==0,t<2],Q=R.aT(this.min),ie=R.aT(this.max);for(let ue=0;ue<Z.length;ue++)Q[ue]=Z[ue]?this.min[ue]:this.center[ue],ie[ue]=Z[ue]?this.center[ue]:this.max[ue];return ie[2]=this.max[2],new $i(Q,ie)}distanceX(t){return Math.max(Math.min(this.max[0],t[0]),this.min[0])-t[0]}distanceY(t){return Math.max(Math.min(this.max[1],t[1]),this.min[1])-t[1]}intersectsFrustum(t){let Z=!0;for(let Q=0;Q<t.planes.length;Q++){const ie=this.intersectsPlane(t.planes[Q]);if(ie===0)return 0;ie===1&&(Z=!1)}return Z?2:t.aabb.min[0]>this.max[0]||t.aabb.min[1]>this.max[1]||t.aabb.min[2]>this.max[2]||t.aabb.max[0]<this.min[0]||t.aabb.max[1]<this.min[1]||t.aabb.max[2]<this.min[2]?0:1}intersectsPlane(t){let Z=t[3],Q=t[3];for(let ie=0;ie<3;ie++)t[ie]>0?(Z+=t[ie]*this.min[ie],Q+=t[ie]*this.max[ie]):(Q+=t[ie]*this.min[ie],Z+=t[ie]*this.max[ie]);return Z>=0?2:Q<0?0:1}}class tn{distanceToTile2d(t,Z,Q,ie){const ue=ie.distanceX([t,Z]),de=ie.distanceY([t,Z]);return Math.hypot(ue,de)}getWrap(t,Z,Q){return Q}getTileBoundingVolume(t,Z,Q,ie){var ue,de;let ge=0,ve=0;if(ie!=null&&ie.terrain){const Re=new R.Z(t.z,Z,t.z,t.x,t.y),Le=ie.terrain.getMinMaxElevation(Re);ge=(ue=Le.minElevation)!==null&&ue!==void 0?ue:Math.min(0,Q),ve=(de=Le.maxElevation)!==null&&de!==void 0?de:Math.max(0,Q)}const qe=1<<t.z;return new $i([Z+t.x/qe,t.y/qe,ge],[Z+(t.x+1)/qe,(t.y+1)/qe,ve])}allowVariableZoom(t,Z){const Q=t.fov*(Math.abs(Math.cos(t.rollInRadians))*t.height+Math.abs(Math.sin(t.rollInRadians))*t.width)/t.height,ie=R.ah(78.5-Q/2,0,60);return!!Z.terrain||t.pitch>ie}allowWorldCopies(){return!0}prepareNextFrame(){}}class xi{constructor(t,Z,Q){this.points=t,this.planes=Z,this.aabb=Q}static fromInvProjectionMatrix(t,Z=1,Q=0,ie,ue){const de=ue?[[6,5,4],[0,1,2],[0,3,7],[2,1,5],[3,2,6],[0,4,5]]:[[0,1,2],[6,5,4],[0,3,7],[2,1,5],[3,2,6],[0,4,5]],ge=Math.pow(2,Q),ve=[[-1,1,-1,1],[1,1,-1,1],[1,-1,-1,1],[-1,-1,-1,1],[-1,1,1,1],[1,1,1,1],[1,-1,1,1],[-1,-1,1,1]].map((Fe=>(function(Ve,Xe,at,ot){const lt=R.aw([],Ve,Xe),pt=1/lt[3]/at*ot;return R.aY(lt,lt,[pt,pt,1/lt[3],pt])})(Fe,t,Z,ge)));ie&&(function(Fe,Ve,Xe,at){const ot=at?4:0,lt=at?0:4;let pt=0;const yt=[],mt=[];for(let gt=0;gt<4;gt++){const Ot=R.aU([],Fe[gt+lt],Fe[gt+ot]),zt=R.aZ(Ot);R.aR(Ot,Ot,1/zt),yt.push(zt),mt.push(Ot)}for(let gt=0;gt<4;gt++){const Ot=R.a_(Fe[gt+ot],mt[gt],Xe);pt=Ot!==null&&Ot>=0?Math.max(pt,Ot):Math.max(pt,yt[gt])}const xt=(function(gt,Ot){const zt=R.aU([],gt[Ot[0]],gt[Ot[1]]),kt=R.aU([],gt[Ot[2]],gt[Ot[1]]),Bt=[0,0,0,0];return R.aV(Bt,R.aW([],zt,kt)),Bt[3]=-R.aX(Bt,gt[Ot[0]]),Bt})(Fe,Ve),It=(function(gt,Ot){const zt=R.a$(gt),kt=R.b0([],gt,1/zt),Bt=R.aU([],Ot,R.aR([],kt,R.aX(Ot,kt))),Nt=R.a$(Bt);if(Nt>0){const ar=Math.sqrt(1-kt[3]*kt[3]),sr=R.aR([],kt,-kt[3]),Kt=R.aS([],sr,R.aR([],Bt,ar/Nt));return R.b1(Ot,Kt)}return null})(Xe,xt);if(It!==null){const gt=It/R.aX(mt[0],xt);pt=Math.min(pt,gt)}for(let gt=0;gt<4;gt++){const Ot=Math.min(pt,yt[gt]);Fe[gt+lt]=[Fe[gt+ot][0]+mt[gt][0]*Ot,Fe[gt+ot][1]+mt[gt][1]*Ot,Fe[gt+ot][2]+mt[gt][2]*Ot,1]}})(ve,de[0],ie,ue);const qe=de.map((Fe=>{const Ve=R.aU([],ve[Fe[0]],ve[Fe[1]]),Xe=R.aU([],ve[Fe[2]],ve[Fe[1]]),at=R.aV([],R.aW([],Ve,Xe)),ot=-R.aX(at,ve[Fe[1]]);return at.concat(ot)})),Re=[Number.POSITIVE_INFINITY,Number.POSITIVE_INFINITY,Number.POSITIVE_INFINITY],Le=[Number.NEGATIVE_INFINITY,Number.NEGATIVE_INFINITY,Number.NEGATIVE_INFINITY];for(const Fe of ve)for(let Ve=0;Ve<3;Ve++)Re[Ve]=Math.min(Re[Ve],Fe[Ve]),Le[Ve]=Math.max(Le[Ve],Fe[Ve]);return new xi(ve,qe,new $i(Re,Le))}}class Ua{get pixelsToClipSpaceMatrix(){return this._helper.pixelsToClipSpaceMatrix}get clipSpaceToPixelsMatrix(){return this._helper.clipSpaceToPixelsMatrix}get pixelsToGLUnits(){return this._helper.pixelsToGLUnits}get centerOffset(){return this._helper.centerOffset}get size(){return this._helper.size}get rotationMatrix(){return this._helper.rotationMatrix}get centerPoint(){return this._helper.centerPoint}get pixelsPerMeter(){return this._helper.pixelsPerMeter}setMinZoom(t){this._helper.setMinZoom(t)}setMaxZoom(t){this._helper.setMaxZoom(t)}setMinPitch(t){this._helper.setMinPitch(t)}setMaxPitch(t){this._helper.setMaxPitch(t)}setRenderWorldCopies(t){this._helper.setRenderWorldCopies(t)}setBearing(t){this._helper.setBearing(t)}setPitch(t){this._helper.setPitch(t)}setRoll(t){this._helper.setRoll(t)}setFov(t){this._helper.setFov(t)}setZoom(t){this._helper.setZoom(t)}setCenter(t){this._helper.setCenter(t)}setElevation(t){this._helper.setElevation(t)}setMinElevationForCurrentTile(t){this._helper.setMinElevationForCurrentTile(t)}setPadding(t){this._helper.setPadding(t)}interpolatePadding(t,Z,Q){return this._helper.interpolatePadding(t,Z,Q)}isPaddingEqual(t){return this._helper.isPaddingEqual(t)}resize(t,Z,Q=!0){this._helper.resize(t,Z,Q)}getMaxBounds(){return this._helper.getMaxBounds()}setMaxBounds(t){this._helper.setMaxBounds(t)}overrideNearFarZ(t,Z){this._helper.overrideNearFarZ(t,Z)}clearNearFarZOverride(){this._helper.clearNearFarZOverride()}getCameraQueryGeometry(t){return this._helper.getCameraQueryGeometry(this.getCameraPoint(),t)}get tileSize(){return this._helper.tileSize}get tileZoom(){return this._helper.tileZoom}get scale(){return this._helper.scale}get worldSize(){return this._helper.worldSize}get width(){return this._helper.width}get height(){return this._helper.height}get lngRange(){return this._helper.lngRange}get latRange(){return this._helper.latRange}get minZoom(){return this._helper.minZoom}get maxZoom(){return this._helper.maxZoom}get zoom(){return this._helper.zoom}get center(){return this._helper.center}get minPitch(){return this._helper.minPitch}get maxPitch(){return this._helper.maxPitch}get pitch(){return this._helper.pitch}get pitchInRadians(){return this._helper.pitchInRadians}get roll(){return this._helper.roll}get rollInRadians(){return this._helper.rollInRadians}get bearing(){return this._helper.bearing}get bearingInRadians(){return this._helper.bearingInRadians}get fov(){return this._helper.fov}get fovInRadians(){return this._helper.fovInRadians}get elevation(){return this._helper.elevation}get minElevationForCurrentTile(){return this._helper.minElevationForCurrentTile}get padding(){return this._helper.padding}get unmodified(){return this._helper.unmodified}get renderWorldCopies(){return this._helper.renderWorldCopies}get cameraToCenterDistance(){return this._helper.cameraToCenterDistance}get nearZ(){return this._helper.nearZ}get farZ(){return this._helper.farZ}get autoCalculateNearFarZ(){return this._helper.autoCalculateNearFarZ}setTransitionState(t,Z){}constructor(t,Z,Q,ie,ue){this._posMatrixCache=new Map,this._alignedPosMatrixCache=new Map,this._fogMatrixCacheF32=new Map,this._helper=new en({calcMatrices:()=>{this._calcMatrices()},getConstrained:(de,ge)=>this.getConstrained(de,ge)},t,Z,Q,ie,ue),this._coveringTilesDetailsProvider=new tn}clone(){const t=new Ua;return t.apply(this),t}apply(t,Z,Q){this._helper.apply(t,Z,Q)}get cameraPosition(){return this._cameraPosition}get projectionMatrix(){return this._projectionMatrix}get modelViewProjectionMatrix(){return this._viewProjMatrix}get inverseProjectionMatrix(){return this._invProjMatrix}get mercatorMatrix(){return this._mercatorMatrix}getVisibleUnwrappedCoordinates(t){const Z=[new R.b2(0,t)];if(this._helper._renderWorldCopies){const Q=this.screenPointToMercatorCoordinate(new R.P(0,0)),ie=this.screenPointToMercatorCoordinate(new R.P(this._helper._width,0)),ue=this.screenPointToMercatorCoordinate(new R.P(this._helper._width,this._helper._height)),de=this.screenPointToMercatorCoordinate(new R.P(0,this._helper._height)),ge=Math.floor(Math.min(Q.x,ie.x,ue.x,de.x)),ve=Math.floor(Math.max(Q.x,ie.x,ue.x,de.x)),qe=1;for(let Re=ge-qe;Re<=ve+qe;Re++)Re!==0&&Z.push(new R.b2(Re,t))}return Z}getCameraFrustum(){return xi.fromInvProjectionMatrix(this._invViewProjMatrix,this.worldSize)}getClippingPlane(){return null}getCoveringTilesDetailsProvider(){return this._coveringTilesDetailsProvider}recalculateZoomAndCenter(t){const Z=this.screenPointToLocation(this.centerPoint,t),Q=t?t.getElevationForLngLatZoom(Z,this._helper._tileZoom):0;this._helper.recalculateZoomAndCenter(Q)}setLocationAtPoint(t,Z){const Q=R.aj(this.elevation,this.center.lat),ie=this.screenPointToMercatorCoordinateAtZ(Z,Q),ue=this.screenPointToMercatorCoordinateAtZ(this.centerPoint,Q),de=R.a1.fromLngLat(t),ge=new R.a1(de.x-(ie.x-ue.x),de.y-(ie.y-ue.y));this.setCenter(ge==null?void 0:ge.toLngLat()),this._helper._renderWorldCopies&&this.setCenter(this.center.wrap())}locationToScreenPoint(t,Z){return Z?this.coordinatePoint(R.a1.fromLngLat(t),Z.getElevationForLngLatZoom(t,this._helper._tileZoom),this._pixelMatrix3D):this.coordinatePoint(R.a1.fromLngLat(t))}screenPointToLocation(t,Z){var Q;return(Q=this.screenPointToMercatorCoordinate(t,Z))===null||Q===void 0?void 0:Q.toLngLat()}screenPointToMercatorCoordinate(t,Z){if(Z){const Q=Z.pointCoordinate(t);if(Q!=null)return Q}return this.screenPointToMercatorCoordinateAtZ(t)}screenPointToMercatorCoordinateAtZ(t,Z){const Q=Z||0,ie=[t.x,t.y,0,1],ue=[t.x,t.y,1,1];R.aw(ie,ie,this._pixelMatrixInverse),R.aw(ue,ue,this._pixelMatrixInverse);const de=ie[3],ge=ue[3],ve=ie[1]/de,qe=ue[1]/ge,Re=ie[2]/de,Le=ue[2]/ge,Fe=Re===Le?0:(Q-Re)/(Le-Re);return new R.a1(R.C.number(ie[0]/de,ue[0]/ge,Fe)/this.worldSize,R.C.number(ve,qe,Fe)/this.worldSize,Q)}coordinatePoint(t,Z=0,Q=this._pixelMatrix){const ie=[t.x*this.worldSize,t.y*this.worldSize,Z,1];return R.aw(ie,ie,Q),new R.P(ie[0]/ie[3],ie[1]/ie[3])}getBounds(){const t=Math.max(0,this._helper._height/2-He(this));return new gr().extend(this.screenPointToLocation(new R.P(0,t))).extend(this.screenPointToLocation(new R.P(this._helper._width,t))).extend(this.screenPointToLocation(new R.P(this._helper._width,this._helper._height))).extend(this.screenPointToLocation(new R.P(0,this._helper._height)))}isPointOnMapSurface(t,Z){return Z?Z.pointCoordinate(t)!=null:t.y>this.height/2-He(this)}calculatePosMatrix(t,Z=!1,Q){var ie;const ue=(ie=t.key)!==null&&ie!==void 0?ie:R.b3(t.wrap,t.canonical.z,t.canonical.z,t.canonical.x,t.canonical.y),de=Z?this._alignedPosMatrixCache:this._posMatrixCache;if(de.has(ue)){const qe=de.get(ue);return Q?qe.f32:qe.f64}const ge=Ze(t,this.worldSize);R.O(ge,Z?this._alignedProjMatrix:this._viewProjMatrix,ge);const ve={f64:ge,f32:new Float32Array(ge)};return de.set(ue,ve),Q?ve.f32:ve.f64}calculateFogMatrix(t){const Z=t.key,Q=this._fogMatrixCacheF32;if(Q.has(Z))return Q.get(Z);const ie=Ze(t,this.worldSize);return R.O(ie,this._fogMatrix,ie),Q.set(Z,new Float32Array(ie)),Q.get(Z)}getConstrained(t,Z){Z=R.ah(+Z,this.minZoom,this.maxZoom);const Q={center:new R.S(t.lng,t.lat),zoom:Z};let ie=this._helper._lngRange;if(!this._helper._renderWorldCopies&&ie===null){const yt=179.9999999999;ie=[-yt,yt]}const ue=this.tileSize*R.af(Q.zoom);let de=0,ge=ue,ve=0,qe=ue,Re=0,Le=0;const{x:Fe,y:Ve}=this.size;if(this._helper._latRange){const yt=this._helper._latRange;de=R.U(yt[1])*ue,ge=R.U(yt[0])*ue,ge-de<Ve&&(Re=Ve/(ge-de))}ie&&(ve=R.aO(R.V(ie[0])*ue,0,ue),qe=R.aO(R.V(ie[1])*ue,0,ue),qe<ve&&(qe+=ue),qe-ve<Fe&&(Le=Fe/(qe-ve)));const{x:Xe,y:at}=Qe(ue,t);let ot,lt;const pt=Math.max(Le||0,Re||0);if(pt){const yt=new R.P(Le?(qe+ve)/2:Xe,Re?(ge+de)/2:at);return Q.center=tt(ue,yt).wrap(),Q.zoom+=R.ak(pt),Q}if(this._helper._latRange){const yt=Ve/2;at-yt<de&&(lt=de+yt),at+yt>ge&&(lt=ge-yt)}if(ie){const yt=(ve+qe)/2;let mt=Xe;this._helper._renderWorldCopies&&(mt=R.aO(Xe,yt-ue/2,yt+ue/2));const xt=Fe/2;mt-xt<ve&&(ot=ve+xt),mt+xt>qe&&(ot=qe-xt)}if(ot!==void 0||lt!==void 0){const yt=new R.P(ot??Xe,lt??at);Q.center=tt(ue,yt).wrap()}return Q}calculateCenterFromCameraLngLatAlt(t,Z,Q,ie){return this._helper.calculateCenterFromCameraLngLatAlt(t,Z,Q,ie)}_calculateNearFarZIfNeeded(t,Z,Q){if(!this._helper.autoCalculateNearFarZ)return;const ie=Math.min(this.elevation,this.minElevationForCurrentTile,this.getCameraAltitude()-100),ue=t-ie*this._helper._pixelPerMeter/Math.cos(Z),de=ie<0?ue:t,ge=Math.PI/2+this.pitchInRadians,ve=R.ae(this.fov)*(Math.abs(Math.cos(R.ae(this.roll)))*this.height+Math.abs(Math.sin(R.ae(this.roll)))*this.width)/this.height*(.5+Q.y/this.height),qe=Math.sin(ve)*de/Math.sin(R.ah(Math.PI-ge-ve,.01,Math.PI-.01)),Re=He(this),Le=Math.atan(Re/this._helper.cameraToCenterDistance),Fe=R.ae(.75),Ve=Le>Fe?2*Le*(.5+Q.y/(2*Re)):Fe,Xe=Math.sin(Ve)*de/Math.sin(R.ah(Math.PI-ge-Ve,.01,Math.PI-.01)),at=Math.min(qe,Xe);this._helper._farZ=1.01*(Math.cos(Math.PI/2-Z)*at+de),this._helper._nearZ=this._helper._height/50}_calcMatrices(){if(!this._helper._height)return;const t=this.centerOffset,Z=Qe(this.worldSize,this.center),Q=Z.x,ie=Z.y;this._helper._pixelPerMeter=R.aj(1,this.center.lat)*this.worldSize;const ue=R.ae(Math.min(this.pitch,ze)),de=Math.max(this._helper.cameraToCenterDistance/2,this._helper.cameraToCenterDistance+this._helper._elevation*this._helper._pixelPerMeter/Math.cos(ue));let ge;this._calculateNearFarZIfNeeded(de,ue,t),ge=new Float64Array(16),R.b4(ge,this.fovInRadians,this._helper._width/this._helper._height,this._helper._nearZ,this._helper._farZ),this._invProjMatrix=new Float64Array(16),R.aq(this._invProjMatrix,ge),ge[8]=2*-t.x/this._helper._width,ge[9]=2*t.y/this._helper._height,this._projectionMatrix=R.b5(ge),R.N(ge,ge,[1,-1,1]),R.M(ge,ge,[0,0,-this._helper.cameraToCenterDistance]),R.b6(ge,ge,-this.rollInRadians),R.b7(ge,ge,this.pitchInRadians),R.b6(ge,ge,-this.bearingInRadians),R.M(ge,ge,[-Q,-ie,0]),this._mercatorMatrix=R.N([],ge,[this.worldSize,this.worldSize,this.worldSize]),R.N(ge,ge,[1,1,this._helper._pixelPerMeter]),this._pixelMatrix=R.O(new Float64Array(16),this.clipSpaceToPixelsMatrix,ge),R.M(ge,ge,[0,0,-this.elevation]),this._viewProjMatrix=ge,this._invViewProjMatrix=R.aq([],ge);const ve=[0,0,-1,1];R.aw(ve,ve,this._invViewProjMatrix),this._cameraPosition=[ve[0]/ve[3],ve[1]/ve[3],ve[2]/ve[3]],this._fogMatrix=new Float64Array(16),R.b4(this._fogMatrix,this.fovInRadians,this.width/this.height,de,this._helper._farZ),this._fogMatrix[8]=2*-t.x/this.width,this._fogMatrix[9]=2*t.y/this.height,R.N(this._fogMatrix,this._fogMatrix,[1,-1,1]),R.M(this._fogMatrix,this._fogMatrix,[0,0,-this.cameraToCenterDistance]),R.b6(this._fogMatrix,this._fogMatrix,-this.rollInRadians),R.b7(this._fogMatrix,this._fogMatrix,this.pitchInRadians),R.b6(this._fogMatrix,this._fogMatrix,-this.bearingInRadians),R.M(this._fogMatrix,this._fogMatrix,[-Q,-ie,0]),R.N(this._fogMatrix,this._fogMatrix,[1,1,this._helper._pixelPerMeter]),R.M(this._fogMatrix,this._fogMatrix,[0,0,-this.elevation]),this._pixelMatrix3D=R.O(new Float64Array(16),this.clipSpaceToPixelsMatrix,ge);const qe=this._helper._width%2/2,Re=this._helper._height%2/2,Le=Math.cos(this.bearingInRadians),Fe=Math.sin(-this.bearingInRadians),Ve=Q-Math.round(Q)+Le*qe+Fe*Re,Xe=ie-Math.round(ie)+Le*Re+Fe*qe,at=new Float64Array(ge);if(R.M(at,at,[Ve>.5?Ve-1:Ve,Xe>.5?Xe-1:Xe,0]),this._alignedProjMatrix=at,ge=R.aq(new Float64Array(16),this._pixelMatrix),!ge)throw new Error("failed to invert matrix");this._pixelMatrixInverse=ge,this._clearMatrixCaches()}_clearMatrixCaches(){this._posMatrixCache.clear(),this._alignedPosMatrixCache.clear(),this._fogMatrixCacheF32.clear()}maxPitchScaleFactor(){if(!this._pixelMatrixInverse)return 1;const t=this.screenPointToMercatorCoordinate(new R.P(0,0)),Z=[t.x*this.worldSize,t.y*this.worldSize,0,1];return R.aw(Z,Z,this._pixelMatrix)[3]/this._helper.cameraToCenterDistance}getCameraPoint(){return this._helper.getCameraPoint()}getCameraAltitude(){return this._helper.getCameraAltitude()}getCameraLngLat(){const t=R.aj(1,this.center.lat)*this.worldSize;return st(this.center,this.elevation,this.pitch,this.bearing,this._helper.cameraToCenterDistance/t).toLngLat()}lngLatToCameraDepth(t,Z){const Q=R.a1.fromLngLat(t),ie=[Q.x*this.worldSize,Q.y*this.worldSize,Z,1];return R.aw(ie,ie,this._viewProjMatrix),ie[2]/ie[3]}getProjectionData(t){const{overscaledTileID:Z,aligned:Q,applyTerrainMatrix:ie}=t,ue=this._helper.getMercatorTileCoordinates(Z),de=Z?this.calculatePosMatrix(Z,Q,!0):null;let ge;return ge=Z&&Z.terrainRttPosMatrix32f&&ie?Z.terrainRttPosMatrix32f:de||R.b8(),{mainMatrix:ge,tileMercatorCoords:ue,clippingPlane:[0,0,0,0],projectionTransition:0,fallbackMatrix:ge}}isLocationOccluded(t){return!1}getPixelScale(){return 1}getCircleRadiusCorrection(){return 1}getPitchedTextCorrection(t,Z,Q){return 1}transformLightDirection(t){return R.aT(t)}getRayDirectionFromPixel(t){throw new Error("Not implemented.")}projectTileCoordinates(t,Z,Q,ie){const ue=this.calculatePosMatrix(Q);let de;ie?(de=[t,Z,ie(t,Z),1],R.aw(de,de,ue)):(de=[t,Z,0,1],Si(de,de,ue));const ge=de[3];return{point:new R.P(de[0]/ge,de[1]/ge),signedDistanceFromCamera:ge,isOccluded:!1}}populateCache(t){for(const Z of t)this.calculatePosMatrix(Z)}getMatrixForModel(t,Z){const Q=R.a1.fromLngLat(t,Z),ie=Q.meterInMercatorCoordinateUnits(),ue=R.b9();return R.M(ue,ue,[Q.x,Q.y,Q.z]),R.b6(ue,ue,Math.PI),R.b7(ue,ue,Math.PI/2),R.N(ue,ue,[-ie,ie,ie]),ue}getProjectionDataForCustomLayer(t=!0){const Z=new R.Z(0,0,0,0,0),Q=this.getProjectionData({overscaledTileID:Z,applyGlobeMatrix:t}),ie=Ze(Z,this.worldSize);R.O(ie,this._viewProjMatrix,ie),Q.tileMercatorCoords=[0,0,1,1];const ue=[R.$,R.$,this.worldSize/this._helper.pixelsPerMeter],de=R.ba();return R.N(de,ie,ue),Q.fallbackMatrix=de,Q.mainMatrix=de,Q}getFastPathSimpleProjectionMatrix(t){return this.calculatePosMatrix(t)}}function fn(){R.w("Map cannot fit within canvas with the given bounds, padding, and/or offset.")}function wn(se){if(se.useSlerp)if(se.k<1){const t=R.bb(se.startEulerAngles.roll,se.startEulerAngles.pitch,se.startEulerAngles.bearing),Z=R.bb(se.endEulerAngles.roll,se.endEulerAngles.pitch,se.endEulerAngles.bearing),Q=new Float64Array(4);R.bc(Q,t,Z,se.k);const ie=R.bd(Q);se.tr.setRoll(ie.roll),se.tr.setPitch(ie.pitch),se.tr.setBearing(ie.bearing)}else se.tr.setRoll(se.endEulerAngles.roll),se.tr.setPitch(se.endEulerAngles.pitch),se.tr.setBearing(se.endEulerAngles.bearing);else se.tr.setRoll(R.C.number(se.startEulerAngles.roll,se.endEulerAngles.roll,se.k)),se.tr.setPitch(R.C.number(se.startEulerAngles.pitch,se.endEulerAngles.pitch,se.k)),se.tr.setBearing(R.C.number(se.startEulerAngles.bearing,se.endEulerAngles.bearing,se.k))}function gn(se,t,Z,Q,ie){const ue=ie.padding,de=Qe(ie.worldSize,Z.getNorthWest()),ge=Qe(ie.worldSize,Z.getNorthEast()),ve=Qe(ie.worldSize,Z.getSouthEast()),qe=Qe(ie.worldSize,Z.getSouthWest()),Re=R.ae(-Q),Le=de.rotate(Re),Fe=ge.rotate(Re),Ve=ve.rotate(Re),Xe=qe.rotate(Re),at=new R.P(Math.max(Le.x,Fe.x,Xe.x,Ve.x),Math.max(Le.y,Fe.y,Xe.y,Ve.y)),ot=new R.P(Math.min(Le.x,Fe.x,Xe.x,Ve.x),Math.min(Le.y,Fe.y,Xe.y,Ve.y)),lt=at.sub(ot),pt=(ie.width-(ue.left+ue.right+t.left+t.right))/lt.x,yt=(ie.height-(ue.top+ue.bottom+t.top+t.bottom))/lt.y;if(yt<0||pt<0)return void fn();const mt=Math.min(R.ak(ie.scale*Math.min(pt,yt)),se.maxZoom),xt=R.P.convert(se.offset),It=new R.P((t.left-t.right)/2,(t.top-t.bottom)/2).rotate(R.ae(Q)),gt=xt.add(It).mult(ie.scale/R.af(mt));return{center:tt(ie.worldSize,de.add(ve).div(2).sub(gt)),zoom:mt,bearing:Q}}class vo{get useGlobeControls(){return!1}handlePanInertia(t,Z){const Q=t.mag(),ie=Math.abs(He(Z));return{easingOffset:t.mult(Math.min(.75*ie/Q,1)),easingCenter:Z.center}}handleMapControlsRollPitchBearingZoom(t,Z){t.bearingDelta&&Z.setBearing(Z.bearing+t.bearingDelta),t.pitchDelta&&Z.setPitch(Z.pitch+t.pitchDelta),t.rollDelta&&Z.setRoll(Z.roll+t.rollDelta),t.zoomDelta&&Z.setZoom(Z.zoom+t.zoomDelta)}handleMapControlsPan(t,Z,Q){t.around.distSqr(Z.centerPoint)<.01||Z.setLocationAtPoint(Q,t.around)}cameraForBoxAndBearing(t,Z,Q,ie,ue){return gn(t,Z,Q,ie,ue)}handleJumpToCenterZoom(t,Z){t.zoom!==(Z.zoom!==void 0?+Z.zoom:t.zoom)&&t.setZoom(+Z.zoom),Z.center!==void 0&&t.setCenter(R.S.convert(Z.center))}handleEaseTo(t,Z){const Q=t.zoom,ie=t.padding,ue={roll:t.roll,pitch:t.pitch,bearing:t.bearing},de={roll:Z.roll===void 0?t.roll:Z.roll,pitch:Z.pitch===void 0?t.pitch:Z.pitch,bearing:Z.bearing===void 0?t.bearing:Z.bearing},ge=Z.zoom!==void 0,ve=!t.isPaddingEqual(Z.padding);let qe=!1;const Re=ge?+Z.zoom:t.zoom;let Le=t.centerPoint.add(Z.offsetAsPoint);const Fe=t.screenPointToLocation(Le),{center:Ve,zoom:Xe}=t.getConstrained(R.S.convert(Z.center||Fe),Re??Q);za(t,Ve);const at=Qe(t.worldSize,Fe),ot=Qe(t.worldSize,Ve).sub(at),lt=R.af(Xe-Q);return qe=Xe!==Q,{easeFunc:pt=>{if(qe&&t.setZoom(R.C.number(Q,Xe,pt)),R.be(ue,de)||wn({startEulerAngles:ue,endEulerAngles:de,tr:t,k:pt,useSlerp:ue.roll!=de.roll}),ve&&(t.interpolatePadding(ie,Z.padding,pt),Le=t.centerPoint.add(Z.offsetAsPoint)),Z.around)t.setLocationAtPoint(Z.around,Z.aroundPoint);else{const yt=R.af(t.zoom-Q),mt=Xe>Q?Math.min(2,lt):Math.max(.5,lt),xt=Math.pow(mt,1-pt),It=tt(t.worldSize,at.add(ot.mult(pt*xt)).mult(yt));t.setLocationAtPoint(t.renderWorldCopies?It.wrap():It,Le)}},isZooming:qe,elevationCenter:Ve}}handleFlyTo(t,Z){const Q=Z.zoom!==void 0,ie=t.zoom,ue=t.getConstrained(R.S.convert(Z.center||Z.locationAtOffset),Q?+Z.zoom:ie),de=ue.center,ge=ue.zoom;za(t,de);const ve=Qe(t.worldSize,Z.locationAtOffset),qe=Qe(t.worldSize,de).sub(ve),Re=qe.mag(),Le=R.af(ge-ie);let Fe;if(Z.minZoom!==void 0){const Ve=Math.min(+Z.minZoom,ie,ge),Xe=t.getConstrained(de,Ve).zoom;Fe=R.af(Xe-ie)}return{easeFunc:(Ve,Xe,at,ot)=>{t.setZoom(Ve===1?ge:ie+R.ak(Xe));const lt=Ve===1?de:tt(t.worldSize,ve.add(qe.mult(at)).mult(Xe));t.setLocationAtPoint(t.renderWorldCopies?lt.wrap():lt,ot)},scaleOfZoom:Le,targetCenter:de,scaleOfMinZoom:Fe,pixelPathLength:Re}}}class pi{constructor(t,Z,Q){this.blendFunction=t,this.blendColor=Z,this.mask=Q}}pi.Replace=[1,0],pi.disabled=new pi(pi.Replace,R.bf.transparent,[!1,!1,!1,!1]),pi.unblended=new pi(pi.Replace,R.bf.transparent,[!0,!0,!0,!0]),pi.alphaBlended=new pi([1,771],R.bf.transparent,[!0,!0,!0,!0]);const Oi=2305;class ni{constructor(t,Z,Q){this.enable=t,this.mode=Z,this.frontFace=Q}}ni.disabled=new ni(!1,1029,Oi),ni.backCCW=new ni(!0,1029,Oi),ni.frontCCW=new ni(!0,1028,Oi);class $r{constructor(t,Z,Q){this.func=t,this.mask=Z,this.range=Q}}$r.ReadOnly=!1,$r.ReadWrite=!0,$r.disabled=new $r(519,$r.ReadOnly,[0,1]);const Va=7680;class Xr{constructor(t,Z,Q,ie,ue,de){this.test=t,this.ref=Z,this.mask=Q,this.fail=ie,this.depthFail=ue,this.pass=de}}Xr.disabled=new Xr({func:519,mask:0},0,0,Va,Va,Va);const es=new WeakMap;function sn(se){var t;if(es.has(se))return es.get(se);{const Z=(t=se.getParameter(se.VERSION))===null||t===void 0?void 0:t.startsWith("WebGL 2.0");return es.set(se,Z),Z}}class cl{get awaitingQuery(){return!!this._readbackQueue}constructor(t){this._readbackWaitFrames=4,this._measureWaitFrames=6,this._texWidth=1,this._texHeight=1,this._measuredError=0,this._updateCount=0,this._lastReadbackFrame=-1e3,this._readbackQueue=null,this._cachedRenderContext=t;const Z=t.context,Q=Z.gl;this._texFormat=Q.RGBA,this._texType=Q.UNSIGNED_BYTE;const ie=new R.aL;ie.emplaceBack(-1,-1),ie.emplaceBack(2,-1),ie.emplaceBack(-1,2);const ue=new R.aN;ue.emplaceBack(0,1,2),this._fullscreenTriangle=new ja(Z.createVertexBuffer(ie,dn.members),Z.createIndexBuffer(ue),R.aM.simpleSegment(0,0,ie.length,ue.length)),this._resultBuffer=new Uint8Array(4),Z.activeTexture.set(Q.TEXTURE1);const de=Q.createTexture();Q.bindTexture(Q.TEXTURE_2D,de),Q.texParameteri(Q.TEXTURE_2D,Q.TEXTURE_WRAP_S,Q.CLAMP_TO_EDGE),Q.texParameteri(Q.TEXTURE_2D,Q.TEXTURE_WRAP_T,Q.CLAMP_TO_EDGE),Q.texParameteri(Q.TEXTURE_2D,Q.TEXTURE_MIN_FILTER,Q.NEAREST),Q.texParameteri(Q.TEXTURE_2D,Q.TEXTURE_MAG_FILTER,Q.NEAREST),Q.texImage2D(Q.TEXTURE_2D,0,this._texFormat,this._texWidth,this._texHeight,0,this._texFormat,this._texType,null),this._fbo=Z.createFramebuffer(this._texWidth,this._texHeight,!1,!1),this._fbo.colorAttachment.set(de),sn(Q)&&(this._pbo=Q.createBuffer(),Q.bindBuffer(Q.PIXEL_PACK_BUFFER,this._pbo),Q.bufferData(Q.PIXEL_PACK_BUFFER,4,Q.STREAM_READ),Q.bindBuffer(Q.PIXEL_PACK_BUFFER,null))}destroy(){const t=this._cachedRenderContext.context.gl;this._fullscreenTriangle.destroy(),this._fbo.destroy(),t.deleteBuffer(this._pbo),this._fullscreenTriangle=null,this._fbo=null,this._pbo=null,this._resultBuffer=null}updateErrorLoop(t,Z){const Q=this._updateCount;return this._readbackQueue?Q>=this._readbackQueue.frameNumberIssued+this._readbackWaitFrames&&this._tryReadback():Q>=this._lastReadbackFrame+this._measureWaitFrames&&this._renderErrorTexture(t,Z),this._updateCount++,this._measuredError}_bindFramebuffer(){const t=this._cachedRenderContext.context,Z=t.gl;t.activeTexture.set(Z.TEXTURE1),Z.bindTexture(Z.TEXTURE_2D,this._fbo.colorAttachment.get()),t.bindFramebuffer.set(this._fbo.framebuffer)}_renderErrorTexture(t,Z){const Q=this._cachedRenderContext.context,ie=Q.gl;if(this._bindFramebuffer(),Q.viewport.set([0,0,this._texWidth,this._texHeight]),Q.clear({color:R.bf.transparent}),this._cachedRenderContext.useProgram("projectionErrorMeasurement").draw(Q,ie.TRIANGLES,$r.disabled,Xr.disabled,pi.unblended,ni.disabled,((ue,de)=>({u_input:ue,u_output_expected:de}))(t,Z),null,null,"$clipping",this._fullscreenTriangle.vertexBuffer,this._fullscreenTriangle.indexBuffer,this._fullscreenTriangle.segments),this._pbo&&sn(ie)){ie.bindBuffer(ie.PIXEL_PACK_BUFFER,this._pbo),ie.readBuffer(ie.COLOR_ATTACHMENT0),ie.readPixels(0,0,this._texWidth,this._texHeight,this._texFormat,this._texType,0),ie.bindBuffer(ie.PIXEL_PACK_BUFFER,null);const ue=ie.fenceSync(ie.SYNC_GPU_COMMANDS_COMPLETE,0);ie.flush(),this._readbackQueue={frameNumberIssued:this._updateCount,sync:ue}}else this._readbackQueue={frameNumberIssued:this._updateCount,sync:null}}_tryReadback(){const t=this._cachedRenderContext.context.gl;if(this._pbo&&this._readbackQueue&&sn(t)){const Z=t.clientWaitSync(this._readbackQueue.sync,0,0);if(Z===t.WAIT_FAILED)return R.w("WebGL2 clientWaitSync failed."),this._readbackQueue=null,void(this._lastReadbackFrame=this._updateCount);if(Z===t.TIMEOUT_EXPIRED)return;t.bindBuffer(t.PIXEL_PACK_BUFFER,this._pbo),t.getBufferSubData(t.PIXEL_PACK_BUFFER,0,this._resultBuffer,0,4),t.bindBuffer(t.PIXEL_PACK_BUFFER,null)}else this._bindFramebuffer(),t.readPixels(0,0,this._texWidth,this._texHeight,this._texFormat,this._texType,this._resultBuffer);this._readbackQueue=null,this._measuredError=cl._parseRGBA8float(this._resultBuffer),this._lastReadbackFrame=this._updateCount}static _parseRGBA8float(t){let Z=0;return Z+=t[0]/256,Z+=t[1]/65536,Z+=t[2]/16777216,t[3]<127&&(Z=-Z),Z/128}}const bo=R.$/128;function xo(se,t){const Z=se.granularity!==void 0?Math.max(se.granularity,1):1,Q=Z+(se.generateBorders?2:0),ie=Z+(se.extendToNorthPole||se.generateBorders?1:0)+(se.extendToSouthPole||se.generateBorders?1:0),ue=Q+1,de=ie+1,ge=se.generateBorders?-1:0,ve=se.generateBorders||se.extendToNorthPole?-1:0,qe=Z+(se.generateBorders?1:0),Re=Z+(se.generateBorders||se.extendToSouthPole?1:0),Le=ue*de,Fe=Q*ie*6,Ve=ue*de>65536;if(Ve&&t==="16bit")throw new Error("Granularity is too large and meshes would not fit inside 16 bit vertex indices.");const Xe=Ve||t==="32bit",at=new Int16Array(2*Le);let ot=0;for(let yt=ve;yt<=Re;yt++)for(let mt=ge;mt<=qe;mt++){let xt=mt/Z*R.$;mt===-1&&(xt=-bo),mt===Z+1&&(xt=R.$+bo);let It=yt/Z*R.$;yt===-1&&(It=se.extendToNorthPole?R.bh:-bo),yt===Z+1&&(It=se.extendToSouthPole?R.bi:R.$+bo),at[ot++]=xt,at[ot++]=It}const lt=Xe?new Uint32Array(Fe):new Uint16Array(Fe);let pt=0;for(let yt=0;yt<ie;yt++)for(let mt=0;mt<Q;mt++){const xt=mt+1+yt*ue,It=mt+(yt+1)*ue,gt=mt+1+(yt+1)*ue;lt[pt++]=mt+yt*ue,lt[pt++]=It,lt[pt++]=xt,lt[pt++]=xt,lt[pt++]=It,lt[pt++]=gt}return{vertices:at.buffer.slice(0),indices:lt.buffer.slice(0),uses32bitIndices:Xe}}const Ga=new R.aK({fill:new R.bj(128,2),line:new R.bj(512,0),tile:new R.bj(128,32),stencil:new R.bj(128,1),circle:3});class wo{constructor(){this._tileMeshCache={},this._errorCorrectionUsable=0,this._errorMeasurementLastValue=0,this._errorCorrectionPreviousValue=0,this._errorMeasurementLastChangeTime=-1e3}get name(){return"vertical-perspective"}get transitionState(){return 1}get useSubdivision(){return!0}get shaderVariantName(){return"globe"}get shaderDefine(){return"#define GLOBE"}get shaderPreludeCode(){return hn.projectionGlobe}get vertexShaderPreludeCode(){return hn.projectionMercator.vertexSource}get subdivisionGranularity(){return Ga}get useGlobeControls(){return!0}get latitudeErrorCorrectionRadians(){return this._errorCorrectionUsable}destroy(){this._errorMeasurement&&this._errorMeasurement.destroy()}updateGPUdependent(t){this._errorMeasurement||(this._errorMeasurement=new cl(t));const Z=R.U(this._errorQueryLatitudeDegrees),Q=2*Math.atan(Math.exp(Math.PI-Z*Math.PI*2))-.5*Math.PI,ie=this._errorMeasurement.updateErrorLoop(Z,Q),ue=_e.now();ie!==this._errorMeasurementLastValue&&(this._errorCorrectionPreviousValue=this._errorCorrectionUsable,this._errorMeasurementLastValue=ie,this._errorMeasurementLastChangeTime=ue);const de=Math.min(Math.max((ue-this._errorMeasurementLastChangeTime)/1e3/.5,0),1);this._errorCorrectionUsable=R.bk(this._errorCorrectionPreviousValue,-this._errorMeasurementLastValue,R.bl(de))}_getMeshKey(t){return`${t.granularity.toString(36)}_${t.generateBorders?"b":""}${t.extendToNorthPole?"n":""}${t.extendToSouthPole?"s":""}`}getMeshFromTileID(t,Z,Q,ie,ue){const de=(ue==="stencil"?Ga.stencil:Ga.tile).getGranularityForZoomLevel(Z.z);return this._getMesh(t,{granularity:de,generateBorders:Q,extendToNorthPole:Z.y===0&&ie,extendToSouthPole:Z.y===(1<<Z.z)-1&&ie})}_getMesh(t,Z){const Q=this._getMeshKey(Z);if(Q in this._tileMeshCache)return this._tileMeshCache[Q];const ie=(function(ue,de){const ge=xo(de,"16bit"),ve=R.aL.deserialize({arrayBuffer:ge.vertices,length:ge.vertices.byteLength/2/2}),qe=R.aN.deserialize({arrayBuffer:ge.indices,length:ge.indices.byteLength/2/3});return new ja(ue.createVertexBuffer(ve,dn.members),ue.createIndexBuffer(qe),R.aM.simpleSegment(0,0,ve.length,qe.length))})(t,Z);return this._tileMeshCache[Q]=ie,ie}recalculate(t){}hasTransition(){const t=_e.now();let Z=!1;return Z=Z||(t-this._errorMeasurementLastChangeTime)/1e3<.7,Z=Z||this._errorMeasurement&&this._errorMeasurement.awaitingQuery,Z}setErrorQueryLatitudeDegrees(t){this._errorQueryLatitudeDegrees=t}}const hl=new R.r({type:new R.D(R.v.projection.type)});class ts extends R.E{constructor(t){super(),this._transitionable=new R.t(hl,void 0),this.setProjection(t),this._transitioning=this._transitionable.untransitioned(),this.recalculate(new R.F(0)),this._mercatorProjection=new yo,this._verticalPerspectiveProjection=new wo}get transitionState(){const t=this.properties.get("type");if(typeof t=="string"&&t==="mercator")return 0;if(typeof t=="string"&&t==="vertical-perspective")return 1;if(t instanceof R.bm){if(t.from==="vertical-perspective"&&t.to==="mercator")return 1-t.transition;if(t.from==="mercator"&&t.to==="vertical-perspective")return t.transition}return 1}get useGlobeRendering(){return this.transitionState>0}get latitudeErrorCorrectionRadians(){return this._verticalPerspectiveProjection.latitudeErrorCorrectionRadians}get currentProjection(){return this.useGlobeRendering?this._verticalPerspectiveProjection:this._mercatorProjection}get name(){return"globe"}get useSubdivision(){return this.currentProjection.useSubdivision}get shaderVariantName(){return this.currentProjection.shaderVariantName}get shaderDefine(){return this.currentProjection.shaderDefine}get shaderPreludeCode(){return this.currentProjection.shaderPreludeCode}get vertexShaderPreludeCode(){return this.currentProjection.vertexShaderPreludeCode}get subdivisionGranularity(){return this.currentProjection.subdivisionGranularity}get useGlobeControls(){return this.transitionState>0}destroy(){this._mercatorProjection.destroy(),this._verticalPerspectiveProjection.destroy()}updateGPUdependent(t){this._mercatorProjection.updateGPUdependent(t),this._verticalPerspectiveProjection.updateGPUdependent(t)}getMeshFromTileID(t,Z,Q,ie,ue){return this.currentProjection.getMeshFromTileID(t,Z,Q,ie,ue)}setProjection(t){this._transitionable.setValue("type",(t==null?void 0:t.type)||"mercator")}updateTransitions(t){this._transitioning=this._transitionable.transitioned(t,this._transitioning)}hasTransition(){return this._transitioning.hasTransition()||this.currentProjection.hasTransition()}recalculate(t){this.properties=this._transitioning.possiblyEvaluate(t)}setErrorQueryLatitudeDegrees(t){this._verticalPerspectiveProjection.setErrorQueryLatitudeDegrees(t),this._mercatorProjection.setErrorQueryLatitudeDegrees(t)}}function So(se){const t=ba(se.worldSize,se.center.lat);return 2*Math.PI*t}function Wn(se,t,Z,Q,ie){const ue=1/(1<<ie),de=t/R.$*ue+Q*ue,ge=R.bo((se/R.$*ue+Z*ue)*Math.PI*2+Math.PI,2*Math.PI),ve=2*Math.atan(Math.exp(Math.PI-de*Math.PI*2))-.5*Math.PI,qe=Math.cos(ve),Re=new Float64Array(3);return Re[0]=Math.sin(ge)*qe,Re[1]=Math.sin(ve),Re[2]=Math.cos(ge)*qe,Re}function Wi(se){return(function(t,Z){const Q=Math.cos(Z),ie=new Float64Array(3);return ie[0]=Math.sin(t)*Q,ie[1]=Math.sin(Z),ie[2]=Math.cos(t)*Q,ie})(se.lng*Math.PI/180,se.lat*Math.PI/180)}function ba(se,t){return se/(2*Math.PI)/Math.cos(t*Math.PI/180)}function Eo(se){const t=Math.asin(se[1])/Math.PI*180,Z=Math.sqrt(se[0]*se[0]+se[2]*se[2]);if(Z>1e-6){const Q=se[0]/Z,ie=Math.acos(se[2]/Z),ue=(Q>0?ie:-ie)/Math.PI*180;return new R.S(R.aO(ue,-180,180),t)}return new R.S(0,t)}function aa(se){return Math.cos(se*Math.PI/180)}function Hi(se,t){const Z=aa(se),Q=aa(t);return R.ak(Q/Z)}function rs(se,t){const Z=se.rotate(t.bearingInRadians),Q=t.zoom+Hi(t.center.lat,0),ie=R.bk(1/aa(t.center.lat),1/aa(Math.min(Math.abs(t.center.lat),60)),R.bn(Q,7,3,0,1)),ue=360/So({worldSize:t.worldSize,center:{lat:t.center.lat}});return new R.S(t.center.lng-Z.x*ue*ie,R.ah(t.center.lat+Z.y*ue,-R.ai,R.ai))}function is(se){const t=.5*se,Z=Math.sin(t),Q=Math.cos(t);return Math.log(Z+Q)-Math.log(Q-Z)}function vu(se,t,Z,Q){const ie=se.lat+Z*Q;if(Math.abs(Z)>1){const ue=(Math.sign(se.lat+Z)!==Math.sign(se.lat)?-Math.abs(se.lat):Math.abs(se.lat))*Math.PI/180,de=Math.abs(se.lat+Z)*Math.PI/180,ge=is(ue+Q*(de-ue)),ve=is(ue),qe=is(de);return new R.S(se.lng+t*((ge-ve)/(qe-ve)),ie)}return new R.S(se.lng+t*Q,ie)}class Oc{constructor(t){this._cachePrevious=new Map,this._cache=new Map,this._hadAnyChanges=!1,this._boundingVolumeFactory=t}swapBuffers(){if(!this._hadAnyChanges)return;const t=this._cachePrevious;this._cachePrevious=this._cache,this._cache=t,this._cache.clear(),this._hadAnyChanges=!1}getTileBoundingVolume(t,Z,Q,ie){const ue=`${t.z}_${t.x}_${t.y}_${ie!=null&&ie.terrain?"t":""}`,de=this._cache.get(ue);if(de)return de;const ge=this._cachePrevious.get(ue);if(ge)return this._cache.set(ue,ge),ge;const ve=this._boundingVolumeFactory(t,Z,Q,ie);return this._cache.set(ue,ve),this._hadAnyChanges=!0,ve}}class zi{constructor(t,Z,Q,ie){this.min=Q,this.max=ie,this.points=t,this.planes=Z}static fromAabb(t,Z){const Q=[];for(let ie=0;ie<8;ie++)Q.push([1&~ie?t[0]:Z[0],(ie>>1&1)==1?Z[1]:t[1],(ie>>2&1)==1?Z[2]:t[2]]);return new zi(Q,[[-1,0,0,Z[0]],[1,0,0,-t[0]],[0,-1,0,Z[1]],[0,1,0,-t[1]],[0,0,-1,Z[2]],[0,0,1,-t[2]]],t,Z)}static fromCenterSizeAngles(t,Z,Q){const ie=R.br([],Q[0],Q[1],Q[2]),ue=R.bs([],[Z[0],0,0],ie),de=R.bs([],[0,Z[1],0],ie),ge=R.bs([],[0,0,Z[2]],ie),ve=[...t],qe=[...t];for(let Le=0;Le<8;Le++)for(let Fe=0;Fe<3;Fe++){const Ve=t[Fe]+ue[Fe]*(1&~Le?-1:1)+de[Fe]*((Le>>1&1)==1?1:-1)+ge[Fe]*((Le>>2&1)==1?1:-1);ve[Fe]=Math.min(ve[Fe],Ve),qe[Fe]=Math.max(qe[Fe],Ve)}const Re=[];for(let Le=0;Le<8;Le++){const Fe=[...t];R.aS(Fe,Fe,R.aR([],ue,1&~Le?-1:1)),R.aS(Fe,Fe,R.aR([],de,(Le>>1&1)==1?1:-1)),R.aS(Fe,Fe,R.aR([],ge,(Le>>2&1)==1?1:-1)),Re.push(Fe)}return new zi(Re,[[...ue,-R.aX(ue,Re[0])],[...de,-R.aX(de,Re[0])],[...ge,-R.aX(ge,Re[0])],[-ue[0],-ue[1],-ue[2],-R.aX(ue,Re[7])],[-de[0],-de[1],-de[2],-R.aX(de,Re[7])],[-ge[0],-ge[1],-ge[2],-R.aX(ge,Re[7])]],ve,qe)}intersectsFrustum(t){let Z=!0;const Q=this.points.length,ie=this.planes.length,ue=t.planes.length,de=t.points.length;for(let ge=0;ge<ue;ge++){const ve=t.planes[ge];let qe=0;for(let Re=0;Re<Q;Re++){const Le=this.points[Re];ve[0]*Le[0]+ve[1]*Le[1]+ve[2]*Le[2]+ve[3]>=0&&qe++}if(qe===0)return 0;qe<Q&&(Z=!1)}if(Z)return 2;for(let ge=0;ge<ie;ge++){const ve=this.planes[ge];let qe=0;for(let Re=0;Re<de;Re++){const Le=t.points[Re];ve[0]*Le[0]+ve[1]*Le[1]+ve[2]*Le[2]+ve[3]>=0&&qe++}if(qe===0)return 0}return 1}intersectsPlane(t){const Z=this.points.length;let Q=0;for(let ie=0;ie<Z;ie++){const ue=this.points[ie];t[0]*ue[0]+t[1]*ue[1]+t[2]*ue[2]+t[3]>=0&&Q++}return Q===Z?2:Q===0?0:1}}function $a(se,t,Z){const Q=se-t;return Q<0?-Q:Math.max(0,Q-Z)}function An(se,t,Z,Q,ie){const ue=se-Z;let de;return de=ue<0?Math.min(-ue,1+ue-ie):ue>1?Math.min(Math.max(ue-ie,0),1-ue):0,Math.max(de,$a(t,Q,ie))}class ns{constructor(){this._boundingVolumeCache=new Oc(this._computeTileBoundingVolume)}prepareNextFrame(){this._boundingVolumeCache.swapBuffers()}distanceToTile2d(t,Z,Q,ie){const ue=1<<Q.z,de=1/ue,ge=Q.x/ue,ve=Q.y/ue;let qe=2;return qe=Math.min(qe,An(t,Z,ge,ve,de)),qe=Math.min(qe,An(t,Z,ge+.5,-ve-de,de)),qe=Math.min(qe,An(t,Z,ge+.5,2-ve-de,de)),qe}getWrap(t,Z,Q){const ie=1<<Z.z,ue=1/ie,de=Z.x/ie,ge=$a(t.x,de,ue),ve=$a(t.x,de-1,ue),qe=$a(t.x,de+1,ue),Re=Math.min(ge,ve,qe);return Re===qe?1:Re===ve?-1:0}allowVariableZoom(t,Z){return Tt(t,Z)>4}allowWorldCopies(){return!1}getTileBoundingVolume(t,Z,Q,ie){return this._boundingVolumeCache.getTileBoundingVolume(t,Z,Q,ie)}_computeTileBoundingVolume(t,Z,Q,ie){var ue,de;let ge=0,ve=0;if(ie!=null&&ie.terrain){const qe=new R.Z(t.z,Z,t.z,t.x,t.y),Re=ie.terrain.getMinMaxElevation(qe);ge=(ue=Re.minElevation)!==null&&ue!==void 0?ue:Math.min(0,Q),ve=(de=Re.maxElevation)!==null&&de!==void 0?de:Math.max(0,Q)}if(ge/=R.bu,ve/=R.bu,ge+=1,ve+=1,t.z<=0)return zi.fromAabb([-ve,-ve,-ve],[ve,ve,ve]);if(t.z===1)return zi.fromAabb([t.x===0?-ve:0,t.y===0?0:-ve,-ve],[t.x===0?0:ve,t.y===0?ve:0,ve]);{const qe=[Wn(0,0,t.x,t.y,t.z),Wn(R.$,0,t.x,t.y,t.z),Wn(R.$,R.$,t.x,t.y,t.z),Wn(0,R.$,t.x,t.y,t.z)],Re=[];for(const Bt of qe)Re.push(R.aR([],Bt,ve));if(ve!==ge)for(const Bt of qe)Re.push(R.aR([],Bt,ge));t.y===0&&Re.push([0,1,0]),t.y===(1<<t.z)-1&&Re.push([0,-1,0]);const Le=[1,1,1],Fe=[-1,-1,-1];for(const Bt of Re)for(let Nt=0;Nt<3;Nt++)Le[Nt]=Math.min(Le[Nt],Bt[Nt]),Fe[Nt]=Math.max(Fe[Nt],Bt[Nt]);const Ve=Wn(R.$/2,R.$/2,t.x,t.y,t.z),Xe=R.aW([],[0,1,0],Ve);R.aV(Xe,Xe);const at=R.aW([],Ve,Xe);R.aV(at,at);const ot=R.aW([],qe[2],qe[1]);R.aV(ot,ot);const lt=R.aW([],qe[0],qe[3]);R.aV(lt,lt),Re.push(R.aR([],Ve,ve)),t.y>=(1<<t.z)/2&&Re.push(R.aR([],Wn(R.$/2,0,t.x,t.y,t.z),ve)),t.y<(1<<t.z)/2&&Re.push(R.aR([],Wn(R.$/2,R.$,t.x,t.y,t.z),ve));const pt=dl(Ve,Re),yt=dl(at,Re),mt=[-Ve[0],-Ve[1],-Ve[2],pt.max],xt=[Ve[0],Ve[1],Ve[2],-pt.min],It=[-at[0],-at[1],-at[2],yt.max],gt=[at[0],at[1],at[2],-yt.min],Ot=[...ot,0],zt=[...lt,0],kt=[];return t.y===0?kt.push(R.bt(zt,Ot,mt),R.bt(zt,Ot,xt)):kt.push(R.bt(It,Ot,mt),R.bt(It,Ot,xt),R.bt(It,zt,mt),R.bt(It,zt,xt)),t.y===(1<<t.z)-1?kt.push(R.bt(zt,Ot,mt),R.bt(zt,Ot,xt)):kt.push(R.bt(gt,Ot,mt),R.bt(gt,Ot,xt),R.bt(gt,zt,mt),R.bt(gt,zt,xt)),new zi(kt,[mt,xt,It,gt,Ot,zt],Le,Fe)}}}function dl(se,t){let Z=1/0,Q=-1/0;for(const ie of t){const ue=R.aX(se,ie);Z=Math.min(Z,ue),Q=Math.max(Q,ue)}return{min:Z,max:Q}}class qo{get pixelsToClipSpaceMatrix(){return this._helper.pixelsToClipSpaceMatrix}get clipSpaceToPixelsMatrix(){return this._helper.clipSpaceToPixelsMatrix}get pixelsToGLUnits(){return this._helper.pixelsToGLUnits}get centerOffset(){return this._helper.centerOffset}get size(){return this._helper.size}get rotationMatrix(){return this._helper.rotationMatrix}get centerPoint(){return this._helper.centerPoint}get pixelsPerMeter(){return this._helper.pixelsPerMeter}setMinZoom(t){this._helper.setMinZoom(t)}setMaxZoom(t){this._helper.setMaxZoom(t)}setMinPitch(t){this._helper.setMinPitch(t)}setMaxPitch(t){this._helper.setMaxPitch(t)}setRenderWorldCopies(t){this._helper.setRenderWorldCopies(t)}setBearing(t){this._helper.setBearing(t)}setPitch(t){this._helper.setPitch(t)}setRoll(t){this._helper.setRoll(t)}setFov(t){this._helper.setFov(t)}setZoom(t){this._helper.setZoom(t)}setCenter(t){this._helper.setCenter(t)}setElevation(t){this._helper.setElevation(t)}setMinElevationForCurrentTile(t){this._helper.setMinElevationForCurrentTile(t)}setPadding(t){this._helper.setPadding(t)}interpolatePadding(t,Z,Q){return this._helper.interpolatePadding(t,Z,Q)}isPaddingEqual(t){return this._helper.isPaddingEqual(t)}resize(t,Z){this._helper.resize(t,Z)}getMaxBounds(){return this._helper.getMaxBounds()}setMaxBounds(t){this._helper.setMaxBounds(t)}overrideNearFarZ(t,Z){this._helper.overrideNearFarZ(t,Z)}clearNearFarZOverride(){this._helper.clearNearFarZOverride()}getCameraQueryGeometry(t){return this._helper.getCameraQueryGeometry(this.getCameraPoint(),t)}get tileSize(){return this._helper.tileSize}get tileZoom(){return this._helper.tileZoom}get scale(){return this._helper.scale}get worldSize(){return this._helper.worldSize}get width(){return this._helper.width}get height(){return this._helper.height}get lngRange(){return this._helper.lngRange}get latRange(){return this._helper.latRange}get minZoom(){return this._helper.minZoom}get maxZoom(){return this._helper.maxZoom}get zoom(){return this._helper.zoom}get center(){return this._helper.center}get minPitch(){return this._helper.minPitch}get maxPitch(){return this._helper.maxPitch}get pitch(){return this._helper.pitch}get pitchInRadians(){return this._helper.pitchInRadians}get roll(){return this._helper.roll}get rollInRadians(){return this._helper.rollInRadians}get bearing(){return this._helper.bearing}get bearingInRadians(){return this._helper.bearingInRadians}get fov(){return this._helper.fov}get fovInRadians(){return this._helper.fovInRadians}get elevation(){return this._helper.elevation}get minElevationForCurrentTile(){return this._helper.minElevationForCurrentTile}get padding(){return this._helper.padding}get unmodified(){return this._helper.unmodified}get renderWorldCopies(){return this._helper.renderWorldCopies}get nearZ(){return this._helper.nearZ}get farZ(){return this._helper.farZ}get autoCalculateNearFarZ(){return this._helper.autoCalculateNearFarZ}setTransitionState(t){}constructor(){this._cachedClippingPlane=R.bv(),this._projectionMatrix=R.b9(),this._globeViewProjMatrix32f=R.b8(),this._globeViewProjMatrixNoCorrection=R.b9(),this._globeViewProjMatrixNoCorrectionInverted=R.b9(),this._globeProjMatrixInverted=R.b9(),this._cameraPosition=R.bp(),this._globeLatitudeErrorCorrectionRadians=0,this._helper=new en({calcMatrices:()=>{this._calcMatrices()},getConstrained:(t,Z)=>this.getConstrained(t,Z)}),this._coveringTilesDetailsProvider=new ns}clone(){const t=new qo;return t.apply(this),t}apply(t,Z){this._globeLatitudeErrorCorrectionRadians=Z||0,this._helper.apply(t)}get projectionMatrix(){return this._projectionMatrix}get modelViewProjectionMatrix(){return this._globeViewProjMatrixNoCorrection}get inverseProjectionMatrix(){return this._globeProjMatrixInverted}get cameraPosition(){const t=R.bp();return t[0]=this._cameraPosition[0],t[1]=this._cameraPosition[1],t[2]=this._cameraPosition[2],t}get cameraToCenterDistance(){return this._helper.cameraToCenterDistance}getProjectionData(t){const{overscaledTileID:Z,applyGlobeMatrix:Q}=t,ie=this._helper.getMercatorTileCoordinates(Z);return{mainMatrix:this._globeViewProjMatrix32f,tileMercatorCoords:ie,clippingPlane:this._cachedClippingPlane,projectionTransition:Q?1:0,fallbackMatrix:this._globeViewProjMatrix32f}}_computeClippingPlane(t){const Z=this.pitchInRadians,Q=this.cameraToCenterDistance/t,ie=Math.sin(Z)*Q,ue=Math.cos(Z)*Q+1,de=1/Math.sqrt(ie*ie+ue*ue)*1;let ge=-ie,ve=ue;const qe=Math.sqrt(ge*ge+ve*ve);ge/=qe,ve/=qe;const Re=[0,ge,ve];R.bw(Re,Re,[0,0,0],-this.bearingInRadians),R.bx(Re,Re,[0,0,0],-1*this.center.lat*Math.PI/180),R.by(Re,Re,[0,0,0],this.center.lng*Math.PI/180);const Le=1/R.aZ(Re);return R.aR(Re,Re,Le),[...Re,-de*Le]}isLocationOccluded(t){return!this.isSurfacePointVisible(Wi(t))}transformLightDirection(t){const Z=this._helper._center.lng*Math.PI/180,Q=this._helper._center.lat*Math.PI/180,ie=Math.cos(Q),ue=[Math.sin(Z)*ie,Math.sin(Q),Math.cos(Z)*ie],de=[ue[2],0,-ue[0]],ge=[0,0,0];R.aW(ge,de,ue),R.aV(de,de),R.aV(ge,ge);const ve=[0,0,0];return R.aV(ve,[de[0]*t[0]+ge[0]*t[1]+ue[0]*t[2],de[1]*t[0]+ge[1]*t[1]+ue[1]*t[2],de[2]*t[0]+ge[2]*t[1]+ue[2]*t[2]]),ve}getPixelScale(){return 1/Math.cos(this._helper._center.lat*Math.PI/180)}getCircleRadiusCorrection(){return Math.cos(this._helper._center.lat*Math.PI/180)}getPitchedTextCorrection(t,Z,Q){const ie=(function(ge,ve,qe){const Re=1/(1<<qe.z);return new R.a1(ge/R.$*Re+qe.x*Re,ve/R.$*Re+qe.y*Re)})(t,Z,Q.canonical),ue=(de=ie.y,[R.bo(ie.x*Math.PI*2+Math.PI,2*Math.PI),2*Math.atan(Math.exp(Math.PI-de*Math.PI*2))-.5*Math.PI]);var de;return this.getCircleRadiusCorrection()/Math.cos(ue[1])}projectTileCoordinates(t,Z,Q,ie){const ue=Q.canonical,de=Wn(t,Z,ue.x,ue.y,ue.z),ge=1+(ie?ie(t,Z):0)/R.bu,ve=[de[0]*ge,de[1]*ge,de[2]*ge,1];R.aw(ve,ve,this._globeViewProjMatrixNoCorrection);const qe=this._cachedClippingPlane,Re=qe[0]*de[0]+qe[1]*de[1]+qe[2]*de[2]+qe[3]<0;return{point:new R.P(ve[0]/ve[3],ve[1]/ve[3]),signedDistanceFromCamera:ve[3],isOccluded:Re}}_calcMatrices(){if(!this._helper._width||!this._helper._height)return;const t=ba(this.worldSize,this.center.lat),Z=R.ba(),Q=R.ba();this._helper.autoCalculateNearFarZ&&(this._helper._nearZ=.5,this._helper._farZ=this.cameraToCenterDistance+2*t),R.b4(Z,this.fovInRadians,this.width/this.height,this._helper._nearZ,this._helper._farZ);const ie=this.centerOffset;Z[8]=2*-ie.x/this._helper._width,Z[9]=2*ie.y/this._helper._height,this._projectionMatrix=R.b5(Z),this._globeProjMatrixInverted=R.ba(),R.aq(this._globeProjMatrixInverted,Z),R.M(Z,Z,[0,0,-this.cameraToCenterDistance]),R.b6(Z,Z,this.rollInRadians),R.b7(Z,Z,-this.pitchInRadians),R.b6(Z,Z,this.bearingInRadians),R.M(Z,Z,[0,0,-t]);const ue=R.bp();ue[0]=t,ue[1]=t,ue[2]=t,R.b7(Q,Z,this.center.lat*Math.PI/180),R.bz(Q,Q,-this.center.lng*Math.PI/180),R.N(Q,Q,ue),this._globeViewProjMatrixNoCorrection=Q,R.b7(Z,Z,this.center.lat*Math.PI/180-this._globeLatitudeErrorCorrectionRadians),R.bz(Z,Z,-this.center.lng*Math.PI/180),R.N(Z,Z,ue),this._globeViewProjMatrix32f=new Float32Array(Z),this._globeViewProjMatrixNoCorrectionInverted=R.ba(),R.aq(this._globeViewProjMatrixNoCorrectionInverted,Q);const de=R.bp();this._cameraPosition=R.bp(),this._cameraPosition[2]=this.cameraToCenterDistance/t,R.bw(this._cameraPosition,this._cameraPosition,de,-this.rollInRadians),R.bx(this._cameraPosition,this._cameraPosition,de,this.pitchInRadians),R.bw(this._cameraPosition,this._cameraPosition,de,-this.bearingInRadians),R.aS(this._cameraPosition,this._cameraPosition,[0,0,1]),R.bx(this._cameraPosition,this._cameraPosition,de,-this.center.lat*Math.PI/180),R.by(this._cameraPosition,this._cameraPosition,de,this.center.lng*Math.PI/180),this._cachedClippingPlane=this._computeClippingPlane(t);const ge=R.b5(this._globeViewProjMatrixNoCorrectionInverted);R.N(ge,ge,[1,1,-1]),this._cachedFrustum=xi.fromInvProjectionMatrix(ge,1,0,this._cachedClippingPlane,!0)}calculateFogMatrix(t){R.w("calculateFogMatrix is not supported on globe projection.");const Z=R.ba();return R.ag(Z),Z}getVisibleUnwrappedCoordinates(t){return[new R.b2(0,t)]}getCameraFrustum(){return this._cachedFrustum}getClippingPlane(){return this._cachedClippingPlane}getCoveringTilesDetailsProvider(){return this._coveringTilesDetailsProvider}recalculateZoomAndCenter(t){t&&R.w("terrain is not fully supported on vertical perspective projection."),this._helper.recalculateZoomAndCenter(0)}maxPitchScaleFactor(){return 1}getCameraPoint(){return this._helper.getCameraPoint()}getCameraAltitude(){return this._helper.getCameraAltitude()}getCameraLngLat(){return this._helper.getCameraLngLat()}lngLatToCameraDepth(t,Z){if(!this._globeViewProjMatrixNoCorrection)return 1;const Q=Wi(t);R.aR(Q,Q,1+Z/R.bu);const ie=R.bv();return R.aw(ie,[Q[0],Q[1],Q[2],1],this._globeViewProjMatrixNoCorrection),ie[2]/ie[3]}populateCache(t){}getBounds(){const t=.5*this.width,Z=.5*this.height,Q=[new R.P(0,0),new R.P(t,0),new R.P(this.width,0),new R.P(this.width,Z),new R.P(this.width,this.height),new R.P(t,this.height),new R.P(0,this.height),new R.P(0,Z)],ie=[];for(const Le of Q)ie.push(this.unprojectScreenPoint(Le));let ue=0,de=0,ge=0,ve=0;const qe=this.center;for(const Le of ie){const Fe=R.bA(qe.lng,Le.lng),Ve=R.bA(qe.lat,Le.lat);Fe<de&&(de=Fe),Fe>ue&&(ue=Fe),Ve<ve&&(ve=Ve),Ve>ge&&(ge=Ve)}const Re=[qe.lng+de,qe.lat+ve,qe.lng+ue,qe.lat+ge];return this.isSurfacePointOnScreen([0,1,0])&&(Re[3]=90,Re[0]=-180,Re[2]=180),this.isSurfacePointOnScreen([0,-1,0])&&(Re[1]=-90,Re[0]=-180,Re[2]=180),new gr(Re)}getConstrained(t,Z){const Q=R.ah(t.lat,-R.ai,R.ai),ie=R.ah(+Z,this.minZoom+Hi(0,Q),this.maxZoom);return{center:new R.S(t.lng,Q),zoom:ie}}calculateCenterFromCameraLngLatAlt(t,Z,Q,ie){return this._helper.calculateCenterFromCameraLngLatAlt(t,Z,Q,ie)}setLocationAtPoint(t,Z){const Q=Wi(this.unprojectScreenPoint(Z)),ie=Wi(t),ue=R.bp();R.bB(ue);const de=R.bp();R.by(de,Q,ue,-this.center.lng*Math.PI/180),R.bx(de,de,ue,this.center.lat*Math.PI/180);const ge=ie[0]*ie[0]+ie[2]*ie[2],ve=de[0]*de[0];if(ge<ve)return;const qe=Math.sqrt(ge-ve),Re=-qe,Le=R.bC(ie[0],ie[2],de[0],qe),Fe=R.bC(ie[0],ie[2],de[0],Re),Ve=R.bp();R.by(Ve,ie,ue,-Le);const Xe=R.bC(Ve[1],Ve[2],de[1],de[2]),at=R.bp();R.by(at,ie,ue,-Fe);const ot=R.bC(at[1],at[2],de[1],de[2]),lt=.5*Math.PI,pt=Xe>=-lt&&Xe<=lt,yt=ot>=-lt&&ot<=lt;let mt,xt;if(pt&&yt){const zt=this.center.lng*Math.PI/180,kt=this.center.lat*Math.PI/180;R.bD(Le,zt)+R.bD(Xe,kt)<R.bD(Fe,zt)+R.bD(ot,kt)?(mt=Le,xt=Xe):(mt=Fe,xt=ot)}else if(pt)mt=Le,xt=Xe;else{if(!yt)return;mt=Fe,xt=ot}const It=mt/Math.PI*180,gt=xt/Math.PI*180,Ot=this.center.lat;this.setCenter(new R.S(It,R.ah(gt,-90,90))),this.setZoom(this.zoom+Hi(Ot,this.center.lat))}locationToScreenPoint(t,Z){const Q=Wi(t);if(Z){const ie=Z.getElevationForLngLatZoom(t,this._helper._tileZoom);R.aR(Q,Q,1+ie/R.bu)}return this._projectSurfacePointToScreen(Q)}_projectSurfacePointToScreen(t){const Z=R.bv();return R.aw(Z,[...t,1],this._globeViewProjMatrixNoCorrection),Z[0]/=Z[3],Z[1]/=Z[3],new R.P((.5*Z[0]+.5)*this.width,(.5*-Z[1]+.5)*this.height)}screenPointToMercatorCoordinate(t,Z){if(Z){const Q=Z.pointCoordinate(t);if(Q)return Q}return R.a1.fromLngLat(this.unprojectScreenPoint(t))}screenPointToLocation(t,Z){var Q;return(Q=this.screenPointToMercatorCoordinate(t,Z))===null||Q===void 0?void 0:Q.toLngLat()}isPointOnMapSurface(t,Z){const Q=this._cameraPosition,ie=this.getRayDirectionFromPixel(t);return!!this.rayPlanetIntersection(Q,ie)}getRayDirectionFromPixel(t){const Z=R.bv();Z[0]=t.x/this.width*2-1,Z[1]=-1*(t.y/this.height*2-1),Z[2]=1,Z[3]=1,R.aw(Z,Z,this._globeViewProjMatrixNoCorrectionInverted),Z[0]/=Z[3],Z[1]/=Z[3],Z[2]/=Z[3];const Q=R.bp();Q[0]=Z[0]-this._cameraPosition[0],Q[1]=Z[1]-this._cameraPosition[1],Q[2]=Z[2]-this._cameraPosition[2];const ie=R.bp();return R.aV(ie,Q),ie}isSurfacePointVisible(t){const Z=this._cachedClippingPlane;return Z[0]*t[0]+Z[1]*t[1]+Z[2]*t[2]+Z[3]>=0}isSurfacePointOnScreen(t){if(!this.isSurfacePointVisible(t))return!1;const Z=R.bv();return R.aw(Z,[...t,1],this._globeViewProjMatrixNoCorrection),Z[0]/=Z[3],Z[1]/=Z[3],Z[2]/=Z[3],Z[0]>-1&&Z[0]<1&&Z[1]>-1&&Z[1]<1&&Z[2]>-1&&Z[2]<1}rayPlanetIntersection(t,Z){const Q=R.aX(t,Z),ie=R.bp(),ue=R.bp();R.aR(ue,Z,Q),R.aU(ie,t,ue);const de=1-R.aX(ie,ie);if(de<0)return null;const ge=R.aX(t,t)-1,ve=-Q+(Q<0?1:-1)*Math.sqrt(de),qe=ge/ve,Re=ve;return{tMin:Math.min(qe,Re),tMax:Math.max(qe,Re)}}unprojectScreenPoint(t){const Z=this._cameraPosition,Q=this.getRayDirectionFromPixel(t),ie=this.rayPlanetIntersection(Z,Q);if(ie){const Re=R.bp();R.aS(Re,Z,[Q[0]*ie.tMin,Q[1]*ie.tMin,Q[2]*ie.tMin]);const Le=R.bp();return R.aV(Le,Re),Eo(Le)}const ue=this._cachedClippingPlane,de=ue[0]*Q[0]+ue[1]*Q[1]+ue[2]*Q[2],ge=-R.b1(ue,Z)/de,ve=R.bp();if(ge>0)R.aS(ve,Z,[Q[0]*ge,Q[1]*ge,Q[2]*ge]);else{const Re=R.bp();R.aS(Re,Z,[2*Q[0],2*Q[1],2*Q[2]]);const Le=R.b1(this._cachedClippingPlane,Re);R.aU(ve,Re,[this._cachedClippingPlane[0]*Le,this._cachedClippingPlane[1]*Le,this._cachedClippingPlane[2]*Le])}const qe=(function(Re){const Le=R.bp();return Le[0]=Re[0]*-Re[3],Le[1]=Re[1]*-Re[3],Le[2]=Re[2]*-Re[3],{center:Le,radius:Math.sqrt(1-Re[3]*Re[3])}})(ue);return Eo((function(Re,Le,Fe){const Ve=R.bp();R.aU(Ve,Fe,Re);const Xe=R.bp();return R.bq(Xe,Re,Ve,Le/R.a$(Ve)),Xe})(qe.center,qe.radius,ve))}getMatrixForModel(t,Z){const Q=R.S.convert(t),ie=1/R.bu,ue=R.b9();return R.bz(ue,ue,Q.lng/180*Math.PI),R.b7(ue,ue,-Q.lat/180*Math.PI),R.M(ue,ue,[0,0,1+Z/R.bu]),R.b7(ue,ue,.5*Math.PI),R.N(ue,ue,[ie,ie,ie]),ue}getProjectionDataForCustomLayer(t=!0){const Z=this.getProjectionData({overscaledTileID:new R.Z(0,0,0,0,0),applyGlobeMatrix:t});return Z.tileMercatorCoords=[0,0,1,1],Z}getFastPathSimpleProjectionMatrix(t){}}class Xn{get pixelsToClipSpaceMatrix(){return this._helper.pixelsToClipSpaceMatrix}get clipSpaceToPixelsMatrix(){return this._helper.clipSpaceToPixelsMatrix}get pixelsToGLUnits(){return this._helper.pixelsToGLUnits}get centerOffset(){return this._helper.centerOffset}get size(){return this._helper.size}get rotationMatrix(){return this._helper.rotationMatrix}get centerPoint(){return this._helper.centerPoint}get pixelsPerMeter(){return this._helper.pixelsPerMeter}setMinZoom(t){this._helper.setMinZoom(t)}setMaxZoom(t){this._helper.setMaxZoom(t)}setMinPitch(t){this._helper.setMinPitch(t)}setMaxPitch(t){this._helper.setMaxPitch(t)}setRenderWorldCopies(t){this._helper.setRenderWorldCopies(t)}setBearing(t){this._helper.setBearing(t)}setPitch(t){this._helper.setPitch(t)}setRoll(t){this._helper.setRoll(t)}setFov(t){this._helper.setFov(t)}setZoom(t){this._helper.setZoom(t)}setCenter(t){this._helper.setCenter(t)}setElevation(t){this._helper.setElevation(t)}setMinElevationForCurrentTile(t){this._helper.setMinElevationForCurrentTile(t)}setPadding(t){this._helper.setPadding(t)}interpolatePadding(t,Z,Q){return this._helper.interpolatePadding(t,Z,Q)}isPaddingEqual(t){return this._helper.isPaddingEqual(t)}resize(t,Z,Q=!0){this._helper.resize(t,Z,Q)}getMaxBounds(){return this._helper.getMaxBounds()}setMaxBounds(t){this._helper.setMaxBounds(t)}overrideNearFarZ(t,Z){this._helper.overrideNearFarZ(t,Z)}clearNearFarZOverride(){this._helper.clearNearFarZOverride()}getCameraQueryGeometry(t){return this._helper.getCameraQueryGeometry(this.getCameraPoint(),t)}get tileSize(){return this._helper.tileSize}get tileZoom(){return this._helper.tileZoom}get scale(){return this._helper.scale}get worldSize(){return this._helper.worldSize}get width(){return this._helper.width}get height(){return this._helper.height}get lngRange(){return this._helper.lngRange}get latRange(){return this._helper.latRange}get minZoom(){return this._helper.minZoom}get maxZoom(){return this._helper.maxZoom}get zoom(){return this._helper.zoom}get center(){return this._helper.center}get minPitch(){return this._helper.minPitch}get maxPitch(){return this._helper.maxPitch}get pitch(){return this._helper.pitch}get pitchInRadians(){return this._helper.pitchInRadians}get roll(){return this._helper.roll}get rollInRadians(){return this._helper.rollInRadians}get bearing(){return this._helper.bearing}get bearingInRadians(){return this._helper.bearingInRadians}get fov(){return this._helper.fov}get fovInRadians(){return this._helper.fovInRadians}get elevation(){return this._helper.elevation}get minElevationForCurrentTile(){return this._helper.minElevationForCurrentTile}get padding(){return this._helper.padding}get unmodified(){return this._helper.unmodified}get renderWorldCopies(){return this._helper.renderWorldCopies}get cameraToCenterDistance(){return this._helper.cameraToCenterDistance}get nearZ(){return this._helper.nearZ}get farZ(){return this._helper.farZ}get autoCalculateNearFarZ(){return this._helper.autoCalculateNearFarZ}get isGlobeRendering(){return this._globeness>0}setTransitionState(t,Z){this._globeness=t,this._globeLatitudeErrorCorrectionRadians=Z,this._calcMatrices(),this._verticalPerspectiveTransform.getCoveringTilesDetailsProvider().prepareNextFrame(),this._mercatorTransform.getCoveringTilesDetailsProvider().prepareNextFrame()}get currentTransform(){return this.isGlobeRendering?this._verticalPerspectiveTransform:this._mercatorTransform}constructor(){this._globeLatitudeErrorCorrectionRadians=0,this._globeness=1,this._helper=new en({calcMatrices:()=>{this._calcMatrices()},getConstrained:(t,Z)=>this.getConstrained(t,Z)}),this._globeness=1,this._mercatorTransform=new Ua,this._verticalPerspectiveTransform=new qo}clone(){const t=new Xn;return t._globeness=this._globeness,t._globeLatitudeErrorCorrectionRadians=this._globeLatitudeErrorCorrectionRadians,t.apply(this),t}apply(t){this._helper.apply(t),this._mercatorTransform.apply(this),this._verticalPerspectiveTransform.apply(this,this._globeLatitudeErrorCorrectionRadians)}get projectionMatrix(){return this.currentTransform.projectionMatrix}get modelViewProjectionMatrix(){return this.currentTransform.modelViewProjectionMatrix}get inverseProjectionMatrix(){return this.currentTransform.inverseProjectionMatrix}get cameraPosition(){return this.currentTransform.cameraPosition}getProjectionData(t){const Z=this._mercatorTransform.getProjectionData(t),Q=this._verticalPerspectiveTransform.getProjectionData(t);return{mainMatrix:this.isGlobeRendering?Q.mainMatrix:Z.mainMatrix,clippingPlane:Q.clippingPlane,tileMercatorCoords:Q.tileMercatorCoords,projectionTransition:t.applyGlobeMatrix?this._globeness:0,fallbackMatrix:Z.fallbackMatrix}}isLocationOccluded(t){return this.currentTransform.isLocationOccluded(t)}transformLightDirection(t){return this.currentTransform.transformLightDirection(t)}getPixelScale(){return R.bk(this._mercatorTransform.getPixelScale(),this._verticalPerspectiveTransform.getPixelScale(),this._globeness)}getCircleRadiusCorrection(){return R.bk(this._mercatorTransform.getCircleRadiusCorrection(),this._verticalPerspectiveTransform.getCircleRadiusCorrection(),this._globeness)}getPitchedTextCorrection(t,Z,Q){const ie=this._mercatorTransform.getPitchedTextCorrection(t,Z,Q),ue=this._verticalPerspectiveTransform.getPitchedTextCorrection(t,Z,Q);return R.bk(ie,ue,this._globeness)}projectTileCoordinates(t,Z,Q,ie){return this.currentTransform.projectTileCoordinates(t,Z,Q,ie)}_calcMatrices(){this._helper._width&&this._helper._height&&(this._verticalPerspectiveTransform.apply(this,this._globeLatitudeErrorCorrectionRadians),this._helper._nearZ=this._verticalPerspectiveTransform.nearZ,this._helper._farZ=this._verticalPerspectiveTransform.farZ,this._mercatorTransform.apply(this,!0,this.isGlobeRendering),this._helper._nearZ=this._mercatorTransform.nearZ,this._helper._farZ=this._mercatorTransform.farZ)}calculateFogMatrix(t){return this.currentTransform.calculateFogMatrix(t)}getVisibleUnwrappedCoordinates(t){return this.currentTransform.getVisibleUnwrappedCoordinates(t)}getCameraFrustum(){return this.currentTransform.getCameraFrustum()}getClippingPlane(){return this.currentTransform.getClippingPlane()}getCoveringTilesDetailsProvider(){return this.currentTransform.getCoveringTilesDetailsProvider()}recalculateZoomAndCenter(t){this._mercatorTransform.recalculateZoomAndCenter(t),this._verticalPerspectiveTransform.recalculateZoomAndCenter(t)}maxPitchScaleFactor(){return this._mercatorTransform.maxPitchScaleFactor()}getCameraPoint(){return this._helper.getCameraPoint()}getCameraAltitude(){return this._helper.getCameraAltitude()}getCameraLngLat(){return this._helper.getCameraLngLat()}lngLatToCameraDepth(t,Z){return this.currentTransform.lngLatToCameraDepth(t,Z)}populateCache(t){this._mercatorTransform.populateCache(t),this._verticalPerspectiveTransform.populateCache(t)}getBounds(){return this.currentTransform.getBounds()}getConstrained(t,Z){return this.currentTransform.getConstrained(t,Z)}calculateCenterFromCameraLngLatAlt(t,Z,Q,ie){return this._helper.calculateCenterFromCameraLngLatAlt(t,Z,Q,ie)}setLocationAtPoint(t,Z){if(!this.isGlobeRendering)return this._mercatorTransform.setLocationAtPoint(t,Z),void this.apply(this._mercatorTransform);this._verticalPerspectiveTransform.setLocationAtPoint(t,Z),this.apply(this._verticalPerspectiveTransform)}locationToScreenPoint(t,Z){return this.currentTransform.locationToScreenPoint(t,Z)}screenPointToMercatorCoordinate(t,Z){return this.currentTransform.screenPointToMercatorCoordinate(t,Z)}screenPointToLocation(t,Z){return this.currentTransform.screenPointToLocation(t,Z)}isPointOnMapSurface(t,Z){return this.currentTransform.isPointOnMapSurface(t,Z)}getRayDirectionFromPixel(t){return this._verticalPerspectiveTransform.getRayDirectionFromPixel(t)}getMatrixForModel(t,Z){return this.currentTransform.getMatrixForModel(t,Z)}getProjectionDataForCustomLayer(t=!0){const Z=this._mercatorTransform.getProjectionDataForCustomLayer(t);if(!this.isGlobeRendering)return Z;const Q=this._verticalPerspectiveTransform.getProjectionDataForCustomLayer(t);return Q.fallbackMatrix=Z.mainMatrix,Q}getFastPathSimpleProjectionMatrix(t){return this.currentTransform.getFastPathSimpleProjectionMatrix(t)}}class Dn{get useGlobeControls(){return!0}handlePanInertia(t,Z){const Q=rs(t,Z);return Math.abs(Q.lng-Z.center.lng)>180&&(Q.lng=Z.center.lng+179.5*Math.sign(Q.lng-Z.center.lng)),{easingCenter:Q,easingOffset:new R.P(0,0)}}handleMapControlsRollPitchBearingZoom(t,Z){const Q=t.around,ie=Z.screenPointToLocation(Q);t.bearingDelta&&Z.setBearing(Z.bearing+t.bearingDelta),t.pitchDelta&&Z.setPitch(Z.pitch+t.pitchDelta),t.rollDelta&&Z.setRoll(Z.roll+t.rollDelta);const ue=Z.zoom;t.zoomDelta&&Z.setZoom(Z.zoom+t.zoomDelta);const de=Z.zoom-ue;if(de===0)return;const ge=R.bA(Z.center.lng,ie.lng),ve=ge/(Math.abs(ge/180)+1),qe=R.bA(Z.center.lat,ie.lat),Re=Z.getRayDirectionFromPixel(Q),Le=Z.cameraPosition,Fe=-1*R.aX(Le,Re),Ve=R.bp();R.aS(Ve,Le,[Re[0]*Fe,Re[1]*Fe,Re[2]*Fe]);const Xe=R.aZ(Ve)-1,at=Math.exp(.5*-Math.max(Xe-.3,0)),ot=ba(Z.worldSize,Z.center.lat)/Math.min(Z.width,Z.height),lt=R.bn(ot,.9,.5,1,.25),pt=(1-R.af(-de))*Math.min(at,lt),yt=Z.center.lat,mt=Z.zoom,xt=new R.S(Z.center.lng+ve*pt,R.ah(Z.center.lat+qe*pt,-R.ai,R.ai));Z.setLocationAtPoint(ie,Q);const It=Z.center,gt=R.bn(Math.abs(ge),45,85,0,1),Ot=R.bn(ot,.75,.35,0,1),zt=Math.pow(Math.max(gt,Ot),.25),kt=R.bA(It.lng,xt.lng),Bt=R.bA(It.lat,xt.lat);Z.setCenter(new R.S(It.lng+kt*zt,It.lat+Bt*zt).wrap()),Z.setZoom(mt+Hi(yt,Z.center.lat))}handleMapControlsPan(t,Z,Q){if(!t.panDelta)return;const ie=Z.center.lat,ue=Z.zoom;Z.setCenter(rs(t.panDelta,Z).wrap()),Z.setZoom(ue+Hi(ie,Z.center.lat))}cameraForBoxAndBearing(t,Z,Q,ie,ue){const de=gn(t,Z,Q,ie,ue),ge=Z.left/ue.width*2-1,ve=(ue.width-Z.right)/ue.width*2-1,qe=Z.top/ue.height*-2+1,Re=(ue.height-Z.bottom)/ue.height*-2+1,Le=R.bA(Q.getWest(),Q.getEast())<0,Fe=Le?Q.getEast():Q.getWest(),Ve=Le?Q.getWest():Q.getEast(),Xe=Math.max(Q.getNorth(),Q.getSouth()),at=Math.min(Q.getNorth(),Q.getSouth()),ot=Fe+.5*R.bA(Fe,Ve),lt=Xe+.5*R.bA(Xe,at),pt=ue.clone();pt.setCenter(de.center),pt.setBearing(de.bearing),pt.setPitch(0),pt.setRoll(0),pt.setZoom(de.zoom);const yt=pt.modelViewProjectionMatrix,mt=[Wi(Q.getNorthWest()),Wi(Q.getNorthEast()),Wi(Q.getSouthWest()),Wi(Q.getSouthEast()),Wi(new R.S(Ve,lt)),Wi(new R.S(Fe,lt)),Wi(new R.S(ot,Xe)),Wi(new R.S(ot,at))],xt=Wi(de.center);let It=Number.POSITIVE_INFINITY;for(const gt of mt)ge<0&&(It=Dn.getLesserNonNegativeNonNull(It,Dn.solveVectorScale(gt,xt,yt,"x",ge))),ve>0&&(It=Dn.getLesserNonNegativeNonNull(It,Dn.solveVectorScale(gt,xt,yt,"x",ve))),qe>0&&(It=Dn.getLesserNonNegativeNonNull(It,Dn.solveVectorScale(gt,xt,yt,"y",qe))),Re<0&&(It=Dn.getLesserNonNegativeNonNull(It,Dn.solveVectorScale(gt,xt,yt,"y",Re)));if(Number.isFinite(It)&&It!==0)return de.zoom=pt.zoom+R.ak(It),de;fn()}handleJumpToCenterZoom(t,Z){const Q=t.center.lat,ie=t.getConstrained(Z.center?R.S.convert(Z.center):t.center,t.zoom).center;t.setCenter(ie.wrap());const ue=Z.zoom!==void 0?+Z.zoom:t.zoom+Hi(Q,ie.lat);t.zoom!==ue&&t.setZoom(ue)}handleEaseTo(t,Z){const Q=t.zoom,ie=t.center,ue=t.padding,de={roll:t.roll,pitch:t.pitch,bearing:t.bearing},ge={roll:Z.roll===void 0?t.roll:Z.roll,pitch:Z.pitch===void 0?t.pitch:Z.pitch,bearing:Z.bearing===void 0?t.bearing:Z.bearing},ve=Z.zoom!==void 0,qe=!t.isPaddingEqual(Z.padding);let Re=!1;const Le=Z.center?R.S.convert(Z.center):ie,Fe=t.getConstrained(Le,Q).center;za(t,Fe);const Ve=t.clone();Ve.setCenter(Fe),Ve.setZoom(ve?+Z.zoom:Q+Hi(ie.lat,Le.lat)),Ve.setBearing(Z.bearing);const Xe=new R.P(R.ah(t.centerPoint.x+Z.offsetAsPoint.x,0,t.width),R.ah(t.centerPoint.y+Z.offsetAsPoint.y,0,t.height));Ve.setLocationAtPoint(Fe,Xe);const at=(Z.offset&&Z.offsetAsPoint.mag())>0?Ve.center:Fe,ot=ve?+Z.zoom:Q+Hi(ie.lat,at.lat),lt=Q+Hi(ie.lat,0),pt=ot+Hi(at.lat,0),yt=R.bA(ie.lng,at.lng),mt=R.bA(ie.lat,at.lat),xt=R.af(pt-lt);return Re=ot!==Q,{easeFunc:It=>{if(R.be(de,ge)||wn({startEulerAngles:de,endEulerAngles:ge,tr:t,k:It,useSlerp:de.roll!=ge.roll}),qe&&t.interpolatePadding(ue,Z.padding,It),Z.around)R.w("Easing around a point is not supported under globe projection."),t.setLocationAtPoint(Z.around,Z.aroundPoint);else{const gt=pt>lt?Math.min(2,xt):Math.max(.5,xt),Ot=Math.pow(gt,1-It),zt=vu(ie,yt,mt,It*Ot);t.setCenter(zt.wrap())}if(Re){const gt=R.C.number(lt,pt,It)+Hi(0,t.center.lat);t.setZoom(gt)}},isZooming:Re,elevationCenter:at}}handleFlyTo(t,Z){const Q=Z.zoom!==void 0,ie=t.center,ue=t.zoom,de=t.padding,ge=!t.isPaddingEqual(Z.padding),ve=t.getConstrained(R.S.convert(Z.center||Z.locationAtOffset),ue).center,qe=Q?+Z.zoom:t.zoom+Hi(t.center.lat,ve.lat),Re=t.clone();Re.setCenter(ve),Re.setZoom(qe),Re.setBearing(Z.bearing);const Le=new R.P(R.ah(t.centerPoint.x+Z.offsetAsPoint.x,0,t.width),R.ah(t.centerPoint.y+Z.offsetAsPoint.y,0,t.height));Re.setLocationAtPoint(ve,Le);const Fe=Re.center;za(t,Fe);const Ve=(function(mt,xt,It){const gt=Wi(xt),Ot=Wi(It),zt=R.aX(gt,Ot),kt=Math.acos(zt),Bt=So(mt);return kt/(2*Math.PI)*Bt})(t,ie,Fe),Xe=ue+Hi(ie.lat,0),at=qe+Hi(Fe.lat,0),ot=R.af(at-Xe);let lt;if(typeof Z.minZoom=="number"){const mt=+Z.minZoom+Hi(Fe.lat,0),xt=Math.min(mt,Xe,at)+Hi(0,Fe.lat),It=t.getConstrained(Fe,xt).zoom+Hi(Fe.lat,0);lt=R.af(It-Xe)}const pt=R.bA(ie.lng,Fe.lng),yt=R.bA(ie.lat,Fe.lat);return{easeFunc:(mt,xt,It,gt)=>{const Ot=vu(ie,pt,yt,It);ge&&t.interpolatePadding(de,Z.padding,mt);const zt=mt===1?Fe:Ot;t.setCenter(zt.wrap());const kt=Xe+R.ak(xt);t.setZoom(mt===1?qe:kt+Hi(0,zt.lat))},scaleOfZoom:ot,targetCenter:Fe,scaleOfMinZoom:lt,pixelPathLength:Ve}}static solveVectorScale(t,Z,Q,ie,ue){const de=ie==="x"?[Q[0],Q[4],Q[8],Q[12]]:[Q[1],Q[5],Q[9],Q[13]],ge=[Q[3],Q[7],Q[11],Q[15]],ve=t[0]*de[0]+t[1]*de[1]+t[2]*de[2],qe=t[0]*ge[0]+t[1]*ge[1]+t[2]*ge[2],Re=Z[0]*de[0]+Z[1]*de[1]+Z[2]*de[2],Le=Z[0]*ge[0]+Z[1]*ge[1]+Z[2]*ge[2];return Re+ue*qe===ve+ue*Le||ge[3]*(ve-Re)+de[3]*(Le-qe)+ve*Le==Re*qe?null:(Re+de[3]-ue*Le-ue*ge[3])/(Re-ve-ue*Le+ue*qe)}static getLesserNonNegativeNonNull(t,Z){return Z!==null&&Z>=0&&Z<t?Z:t}}class bu{constructor(t){this._globe=t,this._mercatorCameraHelper=new vo,this._verticalPerspectiveCameraHelper=new Dn}get useGlobeControls(){return this._globe.useGlobeRendering}get currentHelper(){return this.useGlobeControls?this._verticalPerspectiveCameraHelper:this._mercatorCameraHelper}handlePanInertia(t,Z){return this.currentHelper.handlePanInertia(t,Z)}handleMapControlsRollPitchBearingZoom(t,Z){return this.currentHelper.handleMapControlsRollPitchBearingZoom(t,Z)}handleMapControlsPan(t,Z,Q){this.currentHelper.handleMapControlsPan(t,Z,Q)}cameraForBoxAndBearing(t,Z,Q,ie,ue){return this.currentHelper.cameraForBoxAndBearing(t,Z,Q,ie,ue)}handleJumpToCenterZoom(t,Z){this.currentHelper.handleJumpToCenterZoom(t,Z)}handleEaseTo(t,Z){return this.currentHelper.handleEaseTo(t,Z)}handleFlyTo(t,Z){return this.currentHelper.handleFlyTo(t,Z)}}const as=(se,t)=>R.y(se,t&&t.filter((Z=>Z.identifier!=="source.canvas"))),Cc=R.bE();class fl extends R.E{constructor(t,Z={}){var Q,ie;super(),this._rtlPluginLoaded=()=>{for(const de in this.sourceCaches){const ge=this.sourceCaches[de].getSource().type;ge!=="vector"&&ge!=="geojson"||this.sourceCaches[de].reload()}},this.map=t,this.dispatcher=new ur(xr(),t._getMapId()),this.dispatcher.registerMessageHandler("GG",((de,ge)=>this.getGlyphs(de,ge))),this.dispatcher.registerMessageHandler("GI",((de,ge)=>this.getImages(de,ge))),this.dispatcher.registerMessageHandler("GDA",((de,ge)=>this.getDashes(de,ge))),this.imageManager=new et,this.imageManager.setEventedParent(this);const ue=((Q=t._container)===null||Q===void 0?void 0:Q.lang)||typeof document<"u"&&((ie=document.documentElement)===null||ie===void 0?void 0:ie.lang)||void 0;this.glyphManager=new ft(t._requestManager,Z.localIdeographFontFamily,ue),this.lineAtlas=new ut(256,512),this.crossTileSymbolIndex=new mo,this._spritesImagesIds={},this._layers={},this._order=[],this.sourceCaches={},this.zoomHistory=new R.bF,this._loaded=!1,this._availableImages=[],this._globalState={},this._resetUpdates(),this.dispatcher.broadcast("SR",R.bG()),Ge().on(nr,this._rtlPluginLoaded),this.on("data",(de=>{if(de.dataType!=="source"||de.sourceDataType!=="metadata")return;const ge=this.sourceCaches[de.sourceId];if(!ge)return;const ve=ge.getSource();if(ve&&ve.vectorLayerIds)for(const qe in this._layers){const Re=this._layers[qe];Re.source===ve.id&&this._validateLayer(Re)}}))}setGlobalStateProperty(t,Z){var Q,ie,ue;this._checkLoaded();const de=Z===null?(ue=(ie=(Q=this.stylesheet.state)===null||Q===void 0?void 0:Q[t])===null||ie===void 0?void 0:ie.default)!==null&&ue!==void 0?ue:null:Z;if(R.bH(de,this._globalState[t]))return this;this._globalState[t]=de,this._applyGlobalStateChanges([t])}getGlobalState(){return this._globalState}setGlobalState(t){this._checkLoaded();const Z=[];for(const Q in t)!R.bH(this._globalState[Q],t[Q].default)&&(Z.push(Q),this._globalState[Q]=t[Q].default);this._applyGlobalStateChanges(Z)}_applyGlobalStateChanges(t){if(t.length===0)return;const Z=new Set,Q={};for(const ie of t){Q[ie]=this._globalState[ie];for(const ue in this._layers){const de=this._layers[ue],ge=de.getLayoutAffectingGlobalStateRefs(),ve=de.getPaintAffectingGlobalStateRefs();if(ge.has(ie)&&Z.add(de.source),ve.has(ie))for(const{name:qe,value:Re}of ve.get(ie))this._updatePaintProperty(de,qe,Re)}}this.dispatcher.broadcast("UGS",Q);for(const ie in this.sourceCaches)Z.has(ie)&&(this._reloadSource(ie),this._changed=!0)}loadURL(t,Z={},Q){this.fire(new R.l("dataloading",{dataType:"style"})),Z.validate=typeof Z.validate!="boolean"||Z.validate;const ie=this.map._requestManager.transformRequest(t,"Style");this._loadStyleRequest=new AbortController;const ue=this._loadStyleRequest;R.j(ie,this._loadStyleRequest).then((de=>{this._loadStyleRequest=null,this._load(de.data,Z,Q)})).catch((de=>{this._loadStyleRequest=null,de&&!ue.signal.aborted&&this.fire(new R.k(de))}))}loadJSON(t,Z={},Q){this.fire(new R.l("dataloading",{dataType:"style"})),this._frameRequest=new AbortController,_e.frameAsync(this._frameRequest).then((()=>{this._frameRequest=null,Z.validate=Z.validate!==!1,this._load(t,Z,Q)})).catch((()=>{}))}loadEmpty(){this.fire(new R.l("dataloading",{dataType:"style"})),this._load(Cc,{validate:!1})}_load(t,Z,Q){var ie,ue;let de=Z.transformStyle?Z.transformStyle(Q,t):t;if(!Z.validate||!as(this,R.z(de))){de=Object.assign({},de),this._loaded=!0,this.stylesheet=de;for(const ge in de.sources)this.addSource(ge,de.sources[ge],{validate:!1});de.sprite?this._loadSprite(de.sprite):this.imageManager.setLoaded(!0),this.glyphManager.setURL(de.glyphs),this._createLayers(),this.light=new Ft(this.stylesheet.light),this._setProjectionInternal(((ie=this.stylesheet.projection)===null||ie===void 0?void 0:ie.type)||"mercator"),this.sky=new St(this.stylesheet.sky),this.map.setTerrain((ue=this.stylesheet.terrain)!==null&&ue!==void 0?ue:null),this.fire(new R.l("data",{dataType:"style"})),this.fire(new R.l("style.load"))}}_createLayers(){var t,Z,Q;const ie=R.bI(this.stylesheet.layers);this.setGlobalState((t=this.stylesheet.state)!==null&&t!==void 0?t:null),this.dispatcher.broadcast("SL",ie),this._order=ie.map((ue=>ue.id)),this._layers={},this._serializedLayers=null;for(const ue of ie){const de=R.bJ(ue,this._globalState);if(de.setEventedParent(this,{layer:{id:ue.id}}),this._layers[ue.id]=de,R.bK(de)&&this.sourceCaches[de.source]){const ge=(Q=(Z=ue.paint)===null||Z===void 0?void 0:Z["raster-fade-duration"])!==null&&Q!==void 0?Q:de.paint.get("raster-fade-duration");this.sourceCaches[de.source].setRasterFadeDuration(ge)}}}_loadSprite(t,Z=!1,Q=void 0){let ie;this.imageManager.setLoaded(!1),this._spriteRequest=new AbortController,(function(ue,de,ge,ve){return R._(this,void 0,void 0,(function*(){const qe=We(ue),Re=ge>1?"@2x":"",Le={},Fe={};for(const{id:Ve,url:Xe}of qe){const at=de.transformRequest(Je(Xe,Re,".json"),"SpriteJSON");Le[Ve]=R.j(at,ve);const ot=de.transformRequest(Je(Xe,Re,".png"),"SpriteImage");Fe[Ve]=ke.getImage(ot,ve)}return yield Promise.all([...Object.values(Le),...Object.values(Fe)]),(function(Ve,Xe){return R._(this,void 0,void 0,(function*(){const at={};for(const ot in Ve){at[ot]={};const lt=_e.getImageCanvasContext((yield Xe[ot]).data),pt=(yield Ve[ot]).data;for(const yt in pt){const{width:mt,height:xt,x:It,y:gt,sdf:Ot,pixelRatio:zt,stretchX:kt,stretchY:Bt,content:Nt,textFitWidth:ar,textFitHeight:sr}=pt[yt];at[ot][yt]={data:null,pixelRatio:zt,sdf:Ot,stretchX:kt,stretchY:Bt,content:Nt,textFitWidth:ar,textFitHeight:sr,spriteData:{width:mt,height:xt,x:It,y:gt,context:lt}}}}return at}))})(Le,Fe)}))})(t,this.map._requestManager,this.map.getPixelRatio(),this._spriteRequest).then((ue=>{if(this._spriteRequest=null,ue)for(const de in ue){this._spritesImagesIds[de]=[];const ge=this._spritesImagesIds[de]?this._spritesImagesIds[de].filter((ve=>!(ve in ue))):[];for(const ve of ge)this.imageManager.removeImage(ve),this._changedImages[ve]=!0;for(const ve in ue[de]){const qe=de==="default"?ve:`${de}:${ve}`;this._spritesImagesIds[de].push(qe),qe in this.imageManager.images?this.imageManager.updateImage(qe,ue[de][ve],!1):this.imageManager.addImage(qe,ue[de][ve]),Z&&(this._changedImages[qe]=!0)}}})).catch((ue=>{this._spriteRequest=null,ie=ue,this.fire(new R.k(ie))})).finally((()=>{this.imageManager.setLoaded(!0),this._availableImages=this.imageManager.listImages(),Z&&(this._changed=!0),this.dispatcher.broadcast("SI",this._availableImages),this.fire(new R.l("data",{dataType:"style"})),Q&&Q(ie)}))}_unloadSprite(){for(const t of Object.values(this._spritesImagesIds).flat())this.imageManager.removeImage(t),this._changedImages[t]=!0;this._spritesImagesIds={},this._availableImages=this.imageManager.listImages(),this._changed=!0,this.dispatcher.broadcast("SI",this._availableImages),this.fire(new R.l("data",{dataType:"style"}))}_validateLayer(t){const Z=this.sourceCaches[t.source];if(!Z)return;const Q=t.sourceLayer;if(!Q)return;const ie=Z.getSource();(ie.type==="geojson"||ie.vectorLayerIds&&ie.vectorLayerIds.indexOf(Q)===-1)&&this.fire(new R.k(new Error(`Source layer "${Q}" does not exist on source "${ie.id}" as specified by style layer "${t.id}".`)))}loaded(){if(!this._loaded||Object.keys(this._updatedSources).length)return!1;for(const t in this.sourceCaches)if(!this.sourceCaches[t].loaded())return!1;return!!this.imageManager.isLoaded()}_serializeByIds(t,Z=!1){const Q=this._serializedAllLayers();if(!t||t.length===0)return Object.values(Z?R.bL(Q):Q);const ie=[];for(const ue of t)if(Q[ue]){const de=Z?R.bL(Q[ue]):Q[ue];ie.push(de)}return ie}_serializedAllLayers(){let t=this._serializedLayers;if(t)return t;t=this._serializedLayers={};const Z=Object.keys(this._layers);for(const Q of Z){const ie=this._layers[Q];ie.type!=="custom"&&(t[Q]=ie.serialize())}return t}hasTransitions(){var t,Z,Q;if(!((t=this.light)===null||t===void 0)&&t.hasTransition()||!((Z=this.sky)===null||Z===void 0)&&Z.hasTransition()||!((Q=this.projection)===null||Q===void 0)&&Q.hasTransition())return!0;for(const ie in this.sourceCaches)if(this.sourceCaches[ie].hasTransition())return!0;for(const ie in this._layers)if(this._layers[ie].hasTransition())return!0;return!1}_checkLoaded(){if(!this._loaded)throw new Error("Style is not done loading.")}update(t){if(!this._loaded)return;const Z=this._changed;if(Z){const ie=Object.keys(this._updatedLayers),ue=Object.keys(this._removedLayers);(ie.length||ue.length)&&this._updateWorkerLayers(ie,ue);for(const de in this._updatedSources){const ge=this._updatedSources[de];if(ge==="reload")this._reloadSource(de);else{if(ge!=="clear")throw new Error(`Invalid action ${ge}`);this._clearSource(de)}}this._updateTilesForChangedImages(),this._updateTilesForChangedGlyphs();for(const de in this._updatedPaintProps)this._layers[de].updateTransitions(t);this.light.updateTransitions(t),this.sky.updateTransitions(t),this._resetUpdates()}const Q={};for(const ie in this.sourceCaches){const ue=this.sourceCaches[ie];Q[ie]=ue.used,ue.used=!1}for(const ie of this._order){const ue=this._layers[ie];ue.recalculate(t,this._availableImages),!ue.isHidden(t.zoom)&&ue.source&&(this.sourceCaches[ue.source].used=!0)}for(const ie in Q){const ue=this.sourceCaches[ie];!!Q[ie]!=!!ue.used&&ue.fire(new R.l("data",{sourceDataType:"visibility",dataType:"source",sourceId:ie}))}this.light.recalculate(t),this.sky.recalculate(t),this.projection.recalculate(t),this.z=t.zoom,Z&&this.fire(new R.l("data",{dataType:"style"}))}_updateTilesForChangedImages(){const t=Object.keys(this._changedImages);if(t.length){for(const Z in this.sourceCaches)this.sourceCaches[Z].reloadTilesForDependencies(["icons","patterns"],t);this._changedImages={}}}_updateTilesForChangedGlyphs(){if(this._glyphsDidChange){for(const t in this.sourceCaches)this.sourceCaches[t].reloadTilesForDependencies(["glyphs"],[""]);this._glyphsDidChange=!1}}_updateWorkerLayers(t,Z){this.dispatcher.broadcast("UL",{layers:this._serializeByIds(t,!1),removedIds:Z})}_resetUpdates(){this._changed=!1,this._updatedLayers={},this._removedLayers={},this._updatedSources={},this._updatedPaintProps={},this._changedImages={},this._glyphsDidChange=!1}setState(t,Z={}){var Q;this._checkLoaded();const ie=this.serialize();if(t=Z.transformStyle?Z.transformStyle(ie,t):t,((Q=Z.validate)===null||Q===void 0||Q)&&as(this,R.z(t)))return!1;(t=R.bL(t)).layers=R.bI(t.layers);const ue=R.bM(ie,t),de=this._getOperationsToPerform(ue);if(de.unimplemented.length>0)throw new Error(`Unimplemented: ${de.unimplemented.join(", ")}.`);if(de.operations.length===0)return!1;for(const ge of de.operations)ge();return this.stylesheet=t,this._serializedLayers=null,!0}_getOperationsToPerform(t){const Z=[],Q=[];for(const ie of t)switch(ie.command){case"setCenter":case"setZoom":case"setBearing":case"setPitch":case"setRoll":continue;case"addLayer":Z.push((()=>this.addLayer.apply(this,ie.args)));break;case"removeLayer":Z.push((()=>this.removeLayer.apply(this,ie.args)));break;case"setPaintProperty":Z.push((()=>this.setPaintProperty.apply(this,ie.args)));break;case"setLayoutProperty":Z.push((()=>this.setLayoutProperty.apply(this,ie.args)));break;case"setFilter":Z.push((()=>this.setFilter.apply(this,ie.args)));break;case"addSource":Z.push((()=>this.addSource.apply(this,ie.args)));break;case"removeSource":Z.push((()=>this.removeSource.apply(this,ie.args)));break;case"setLayerZoomRange":Z.push((()=>this.setLayerZoomRange.apply(this,ie.args)));break;case"setLight":Z.push((()=>this.setLight.apply(this,ie.args)));break;case"setGeoJSONSourceData":Z.push((()=>this.setGeoJSONSourceData.apply(this,ie.args)));break;case"setGlyphs":Z.push((()=>this.setGlyphs.apply(this,ie.args)));break;case"setSprite":Z.push((()=>this.setSprite.apply(this,ie.args)));break;case"setTerrain":Z.push((()=>this.map.setTerrain.apply(this,ie.args)));break;case"setSky":Z.push((()=>this.setSky.apply(this,ie.args)));break;case"setProjection":this.setProjection.apply(this,ie.args);break;case"setGlobalState":Z.push((()=>this.setGlobalState.apply(this,ie.args)));break;case"setTransition":Z.push((()=>{}));break;default:Q.push(ie.command)}return{operations:Z,unimplemented:Q}}addImage(t,Z){if(this.getImage(t))return this.fire(new R.k(new Error(`An image named "${t}" already exists.`)));this.imageManager.addImage(t,Z),this._afterImageUpdated(t)}updateImage(t,Z){this.imageManager.updateImage(t,Z)}getImage(t){return this.imageManager.getImage(t)}removeImage(t){if(!this.getImage(t))return this.fire(new R.k(new Error(`An image named "${t}" does not exist.`)));this.imageManager.removeImage(t),this._afterImageUpdated(t)}_afterImageUpdated(t){this._availableImages=this.imageManager.listImages(),this._changedImages[t]=!0,this._changed=!0,this.dispatcher.broadcast("SI",this._availableImages),this.fire(new R.l("data",{dataType:"style"}))}listImages(){return this._checkLoaded(),this.imageManager.listImages()}addSource(t,Z,Q={}){if(this._checkLoaded(),this.sourceCaches[t]!==void 0)throw new Error(`Source "${t}" already exists.`);if(!Z.type)throw new Error(`The type property must be defined, but only the following properties were given: ${Object.keys(Z).join(", ")}.`);if(["vector","raster","geojson","video","image"].indexOf(Z.type)>=0&&this._validate(R.z.source,`sources.${t}`,Z,null,Q))return;this.map&&this.map._collectResourceTiming&&(Z.collectResourceTiming=!0);const ie=this.sourceCaches[t]=new cr(t,Z,this.dispatcher);ie.style=this,ie.setEventedParent(this,(()=>({isSourceLoaded:ie.loaded(),source:ie.serialize(),sourceId:t}))),ie.onAdd(this.map),this._changed=!0}removeSource(t){if(this._checkLoaded(),this.sourceCaches[t]===void 0)throw new Error("There is no source with this ID");for(const Q in this._layers)if(this._layers[Q].source===t)return this.fire(new R.k(new Error(`Source "${t}" cannot be removed while layer "${Q}" is using it.`)));const Z=this.sourceCaches[t];delete this.sourceCaches[t],delete this._updatedSources[t],Z.fire(new R.l("data",{sourceDataType:"metadata",dataType:"source",sourceId:t})),Z.setEventedParent(null),Z.onRemove(this.map),this._changed=!0}setGeoJSONSourceData(t,Z){if(this._checkLoaded(),this.sourceCaches[t]===void 0)throw new Error(`There is no source with this ID=${t}`);const Q=this.sourceCaches[t].getSource();if(Q.type!=="geojson")throw new Error(`geojsonSource.type is ${Q.type}, which is !== 'geojson`);Q.setData(Z),this._changed=!0}getSource(t){return this.sourceCaches[t]&&this.sourceCaches[t].getSource()}addLayer(t,Z,Q={}){this._checkLoaded();const ie=t.id;if(this.getLayer(ie))return void this.fire(new R.k(new Error(`Layer "${ie}" already exists on this map.`)));let ue;if(t.type==="custom"){if(as(this,R.bN(t)))return;ue=R.bJ(t,this._globalState)}else{if("source"in t&&typeof t.source=="object"&&(this.addSource(ie,t.source),t=R.bL(t),t=R.e(t,{source:ie})),this._validate(R.z.layer,`layers.${ie}`,t,{arrayIndex:-1},Q))return;ue=R.bJ(t,this._globalState),this._validateLayer(ue),ue.setEventedParent(this,{layer:{id:ie}})}const de=Z?this._order.indexOf(Z):this._order.length;if(Z&&de===-1)this.fire(new R.k(new Error(`Cannot add layer "${ie}" before non-existing layer "${Z}".`)));else{if(this._order.splice(de,0,ie),this._layerOrderChanged=!0,this._layers[ie]=ue,this._removedLayers[ie]&&ue.source&&ue.type!=="custom"){const ge=this._removedLayers[ie];delete this._removedLayers[ie],ge.type!==ue.type?this._updatedSources[ue.source]="clear":(this._updatedSources[ue.source]="reload",this.sourceCaches[ue.source].pause())}this._updateLayer(ue),ue.onAdd&&ue.onAdd(this.map)}}moveLayer(t,Z){if(this._checkLoaded(),this._changed=!0,!this._layers[t])return void this.fire(new R.k(new Error(`The layer '${t}' does not exist in the map's style and cannot be moved.`)));if(t===Z)return;const Q=this._order.indexOf(t);this._order.splice(Q,1);const ie=Z?this._order.indexOf(Z):this._order.length;Z&&ie===-1?this.fire(new R.k(new Error(`Cannot move layer "${t}" before non-existing layer "${Z}".`))):(this._order.splice(ie,0,t),this._layerOrderChanged=!0)}removeLayer(t){this._checkLoaded();const Z=this._layers[t];if(!Z)return void this.fire(new R.k(new Error(`Cannot remove non-existing layer "${t}".`)));Z.setEventedParent(null);const Q=this._order.indexOf(t);this._order.splice(Q,1),this._layerOrderChanged=!0,this._changed=!0,this._removedLayers[t]=Z,delete this._layers[t],this._serializedLayers&&delete this._serializedLayers[t],delete this._updatedLayers[t],delete this._updatedPaintProps[t],Z.onRemove&&Z.onRemove(this.map)}getLayer(t){return this._layers[t]}getLayersOrder(){return[...this._order]}hasLayer(t){return t in this._layers}setLayerZoomRange(t,Z,Q){this._checkLoaded();const ie=this.getLayer(t);ie?ie.minzoom===Z&&ie.maxzoom===Q||(Z!=null&&(ie.minzoom=Z),Q!=null&&(ie.maxzoom=Q),this._updateLayer(ie)):this.fire(new R.k(new Error(`Cannot set the zoom range of non-existing layer "${t}".`)))}setFilter(t,Z,Q={}){this._checkLoaded();const ie=this.getLayer(t);if(ie){if(!R.bH(ie.filter,Z))return Z==null?(ie.setFilter(void 0),void this._updateLayer(ie)):void(this._validate(R.z.filter,`layers.${ie.id}.filter`,Z,null,Q)||(ie.setFilter(R.bL(Z)),this._updateLayer(ie)))}else this.fire(new R.k(new Error(`Cannot filter non-existing layer "${t}".`)))}getFilter(t){return R.bL(this.getLayer(t).filter)}setLayoutProperty(t,Z,Q,ie={}){this._checkLoaded();const ue=this.getLayer(t);ue?R.bH(ue.getLayoutProperty(Z),Q)||(ue.setLayoutProperty(Z,Q,ie),this._updateLayer(ue)):this.fire(new R.k(new Error(`Cannot style non-existing layer "${t}".`)))}getLayoutProperty(t,Z){const Q=this.getLayer(t);if(Q)return Q.getLayoutProperty(Z);this.fire(new R.k(new Error(`Cannot get style of non-existing layer "${t}".`)))}setPaintProperty(t,Z,Q,ie={}){this._checkLoaded();const ue=this.getLayer(t);ue?R.bH(ue.getPaintProperty(Z),Q)||this._updatePaintProperty(ue,Z,Q,ie):this.fire(new R.k(new Error(`Cannot style non-existing layer "${t}".`)))}_updatePaintProperty(t,Z,Q,ie={}){t.setPaintProperty(Z,Q,ie)&&this._updateLayer(t),R.bK(t)&&Z==="raster-fade-duration"&&this.sourceCaches[t.source].setRasterFadeDuration(Q),this._changed=!0,this._updatedPaintProps[t.id]=!0,this._serializedLayers=null}getPaintProperty(t,Z){return this.getLayer(t).getPaintProperty(Z)}setFeatureState(t,Z){this._checkLoaded();const Q=t.source,ie=t.sourceLayer,ue=this.sourceCaches[Q];if(ue===void 0)return void this.fire(new R.k(new Error(`The source '${Q}' does not exist in the map's style.`)));const de=ue.getSource().type;de==="geojson"&&ie?this.fire(new R.k(new Error("GeoJSON sources cannot have a sourceLayer parameter."))):de!=="vector"||ie?(t.id===void 0&&this.fire(new R.k(new Error("The feature id parameter must be provided."))),ue.setFeatureState(ie,t.id,Z)):this.fire(new R.k(new Error("The sourceLayer parameter must be provided for vector source types.")))}removeFeatureState(t,Z){this._checkLoaded();const Q=t.source,ie=this.sourceCaches[Q];if(ie===void 0)return void this.fire(new R.k(new Error(`The source '${Q}' does not exist in the map's style.`)));const ue=ie.getSource().type,de=ue==="vector"?t.sourceLayer:void 0;ue!=="vector"||de?Z&&typeof t.id!="string"&&typeof t.id!="number"?this.fire(new R.k(new Error("A feature id is required to remove its specific state property."))):ie.removeFeatureState(de,t.id,Z):this.fire(new R.k(new Error("The sourceLayer parameter must be provided for vector source types.")))}getFeatureState(t){this._checkLoaded();const Z=t.source,Q=t.sourceLayer,ie=this.sourceCaches[Z];if(ie!==void 0)return ie.getSource().type!=="vector"||Q?(t.id===void 0&&this.fire(new R.k(new Error("The feature id parameter must be provided."))),ie.getFeatureState(Q,t.id)):void this.fire(new R.k(new Error("The sourceLayer parameter must be provided for vector source types.")));this.fire(new R.k(new Error(`The source '${Z}' does not exist in the map's style.`)))}getTransition(){return R.e({duration:300,delay:0},this.stylesheet&&this.stylesheet.transition)}serialize(){if(!this._loaded)return;const t=R.bO(this.sourceCaches,(ue=>ue.serialize())),Z=this._serializeByIds(this._order,!0),Q=this.map.getTerrain()||void 0,ie=this.stylesheet;return R.bP({version:ie.version,name:ie.name,metadata:ie.metadata,light:ie.light,sky:ie.sky,center:ie.center,zoom:ie.zoom,bearing:ie.bearing,pitch:ie.pitch,sprite:ie.sprite,glyphs:ie.glyphs,transition:ie.transition,projection:ie.projection,sources:t,layers:Z,terrain:Q},(ue=>ue!==void 0))}_updateLayer(t){this._updatedLayers[t.id]=!0,t.source&&!this._updatedSources[t.source]&&this.sourceCaches[t.source].getSource().type!=="raster"&&(this._updatedSources[t.source]="reload",this.sourceCaches[t.source].pause()),this._serializedLayers=null,this._changed=!0}_flattenAndSortRenderedFeatures(t){const Z=de=>this._layers[de].type==="fill-extrusion",Q={},ie=[];for(let de=this._order.length-1;de>=0;de--){const ge=this._order[de];if(Z(ge)){Q[ge]=de;for(const ve of t){const qe=ve[ge];if(qe)for(const Re of qe)ie.push(Re)}}}ie.sort(((de,ge)=>ge.intersectionZ-de.intersectionZ));const ue=[];for(let de=this._order.length-1;de>=0;de--){const ge=this._order[de];if(Z(ge))for(let ve=ie.length-1;ve>=0;ve--){const qe=ie[ve].feature;if(Q[qe.layer.id]<de)break;ue.push(qe),ie.pop()}else for(const ve of t){const qe=ve[ge];if(qe)for(const Re of qe)ue.push(Re.feature)}}return ue}queryRenderedFeatures(t,Z,Q){Z&&Z.filter&&this._validate(R.z.filter,"queryRenderedFeatures.filter",Z.filter,null,Z);const ie={};if(Z&&Z.layers){if(!(Array.isArray(Z.layers)||Z.layers instanceof Set))return this.fire(new R.k(new Error("parameters.layers must be an Array or a Set of strings"))),[];for(const qe of Z.layers){const Re=this._layers[qe];if(!Re)return this.fire(new R.k(new Error(`The layer '${qe}' does not exist in the map's style and cannot be queried for features.`))),[];ie[Re.source]=!0}}const ue=[];Z.availableImages=this._availableImages;const de=this._serializedAllLayers(),ge=Z.layers instanceof Set?Z.layers:Array.isArray(Z.layers)?new Set(Z.layers):null,ve=Object.assign(Object.assign({},Z),{layers:ge,globalState:this._globalState});for(const qe in this.sourceCaches)Z.layers&&!ie[qe]||ue.push(or(this.sourceCaches[qe],this._layers,de,t,ve,Q,this.map.terrain?(Re,Le,Fe)=>this.map.terrain.getElevation(Re,Le,Fe):void 0));return this.placement&&ue.push((function(qe,Re,Le,Fe,Ve,Xe,at){const ot={},lt=Xe.queryRenderedSymbols(Fe),pt=[];for(const yt of Object.keys(lt).map(Number))pt.push(at[yt]);pt.sort(wr);for(const yt of pt){const mt=yt.featureIndex.lookupSymbolFeatures(lt[yt.bucketInstanceId],Re,yt.bucketIndex,yt.sourceLayerIndex,{filterSpec:Ve.filter,globalState:Ve.globalState},Ve.layers,Ve.availableImages,qe);for(const xt in mt){const It=ot[xt]=ot[xt]||[],gt=mt[xt];gt.sort(((Ot,zt)=>{const kt=yt.featureSortOrder;if(kt){const Bt=kt.indexOf(Ot.featureIndex);return kt.indexOf(zt.featureIndex)-Bt}return zt.featureIndex-Ot.featureIndex}));for(const Ot of gt)It.push(Ot)}}return(function(yt,mt,xt){for(const It in yt)for(const gt of yt[It])Ir(gt,xt[mt[It].source]);return yt})(ot,qe,Le)})(this._layers,de,this.sourceCaches,t,ve,this.placement.collisionIndex,this.placement.retainedQueryData)),this._flattenAndSortRenderedFeatures(ue)}querySourceFeatures(t,Z){Z!=null&&Z.filter&&this._validate(R.z.filter,"querySourceFeatures.filter",Z.filter,null,Z);const Q=this.sourceCaches[t];return Q?(function(ie,ue){const de=ie.getRenderableIds().map((qe=>ie.getTileByID(qe))),ge=[],ve={};for(let qe=0;qe<de.length;qe++){const Re=de[qe],Le=Re.tileID.canonical.key;ve[Le]||(ve[Le]=!0,Re.querySourceFeatures(ge,ue))}return ge})(Q,Z?Object.assign(Object.assign({},Z),{globalState:this._globalState}):{globalState:this._globalState}):[]}getLight(){return this.light.getLight()}setLight(t,Z={}){this._checkLoaded();const Q=this.light.getLight();let ie=!1;for(const de in t)if(!R.bH(t[de],Q[de])){ie=!0;break}if(!ie)return;const ue={now:_e.now(),transition:R.e({duration:300,delay:0},this.stylesheet.transition)};this.light.setLight(t,Z),this.light.updateTransitions(ue)}getProjection(){var t;return(t=this.stylesheet)===null||t===void 0?void 0:t.projection}setProjection(t){if(this._checkLoaded(),this.projection){if(this.projection.name===t.type)return;this.projection.destroy(),delete this.projection}this.stylesheet.projection=t,this._setProjectionInternal(t.type)}getSky(){var t;return(t=this.stylesheet)===null||t===void 0?void 0:t.sky}setSky(t,Z={}){this._checkLoaded();const Q=this.getSky();let ie=!1;if(!t&&!Q)return;if(t&&!Q)ie=!0;else if(!t&&Q)ie=!0;else for(const de in t)if(!R.bH(t[de],Q[de])){ie=!0;break}if(!ie)return;const ue={now:_e.now(),transition:R.e({duration:300,delay:0},this.stylesheet.transition)};this.stylesheet.sky=t,this.sky.setSky(t,Z),this.sky.updateTransitions(ue)}_setProjectionInternal(t){const Z=(function(Q){if(Array.isArray(Q)){const ie=new ts({type:Q});return{projection:ie,transform:new Xn,cameraHelper:new bu(ie)}}switch(Q){case"mercator":return{projection:new yo,transform:new Ua,cameraHelper:new vo};case"globe":{const ie=new ts({type:["interpolate",["linear"],["zoom"],11,"vertical-perspective",12,"mercator"]});return{projection:ie,transform:new Xn,cameraHelper:new bu(ie)}}case"vertical-perspective":return{projection:new wo,transform:new qo,cameraHelper:new Dn};default:return R.w(`Unknown projection name: ${Q}. Falling back to mercator projection.`),{projection:new yo,transform:new Ua,cameraHelper:new vo}}})(t);this.projection=Z.projection,this.map.migrateProjection(Z.transform,Z.cameraHelper);for(const Q in this.sourceCaches)this.sourceCaches[Q].reload()}_validate(t,Z,Q,ie,ue={}){return(!ue||ue.validate!==!1)&&as(this,t.call(R.z,R.e({key:Z,style:this.serialize(),value:Q,styleSpec:R.v},ie)))}_remove(t=!0){this._frameRequest&&(this._frameRequest.abort(),this._frameRequest=null),this._loadStyleRequest&&(this._loadStyleRequest.abort(),this._loadStyleRequest=null),this._spriteRequest&&(this._spriteRequest.abort(),this._spriteRequest=null),Ge().off(nr,this._rtlPluginLoaded);for(const Z in this._layers)this._layers[Z].setEventedParent(null);for(const Z in this.sourceCaches){const Q=this.sourceCaches[Z];Q.setEventedParent(null),Q.onRemove(this.map)}this.imageManager.setEventedParent(null),this.setEventedParent(null),t&&this.dispatcher.broadcast("RM",void 0),this.dispatcher.remove(t)}_clearSource(t){this.sourceCaches[t].clearTiles()}_reloadSource(t){this.sourceCaches[t].resume(),this.sourceCaches[t].reload()}_updateSources(t){for(const Z in this.sourceCaches)this.sourceCaches[Z].update(t,this.map.terrain)}_generateCollisionBoxes(){for(const t in this.sourceCaches)this._reloadSource(t)}_updatePlacement(t,Z,Q,ie,ue=!1){let de=!1,ge=!1;const ve={};for(const qe of this._order){const Re=this._layers[qe];if(Re.type!=="symbol")continue;if(!ve[Re.source]){const Fe=this.sourceCaches[Re.source];ve[Re.source]=Fe.getRenderableIds(!0).map((Ve=>Fe.getTileByID(Ve))).sort(((Ve,Xe)=>Xe.tileID.overscaledZ-Ve.tileID.overscaledZ||(Ve.tileID.isLessThan(Xe.tileID)?-1:1)))}const Le=this.crossTileSymbolIndex.addLayer(Re,ve[Re.source],t.center.lng);de=de||Le}if(this.crossTileSymbolIndex.pruneUnusedLayers(this._order),((ue=ue||this._layerOrderChanged||Q===0)||!this.pauseablePlacement||this.pauseablePlacement.isDone()&&!this.placement.stillRecent(_e.now(),t.zoom))&&(this.pauseablePlacement=new gu(t,this.map.terrain,this._order,ue,Z,Q,ie,this.placement),this._layerOrderChanged=!1),this.pauseablePlacement.isDone()?this.placement.setStale():(this.pauseablePlacement.continuePlacement(this._order,this._layers,ve),this.pauseablePlacement.isDone()&&(this.placement=this.pauseablePlacement.commit(_e.now()),ge=!0),de&&this.pauseablePlacement.placement.setStale()),ge||de)for(const qe of this._order){const Re=this._layers[qe];Re.type==="symbol"&&this.placement.updateLayerOpacities(Re,ve[Re.source])}return!this.pauseablePlacement.isDone()||this.placement.hasTransitions(_e.now())}_releaseSymbolFadeTiles(){for(const t in this.sourceCaches)this.sourceCaches[t].releaseSymbolFadeTiles()}getImages(t,Z){return R._(this,void 0,void 0,(function*(){const Q=yield this.imageManager.getImages(Z.icons);this._updateTilesForChangedImages();const ie=this.sourceCaches[Z.source];return ie&&ie.setDependencies(Z.tileID.key,Z.type,Z.icons),Q}))}getGlyphs(t,Z){return R._(this,void 0,void 0,(function*(){const Q=yield this.glyphManager.getGlyphs(Z.stacks),ie=this.sourceCaches[Z.source];return ie&&ie.setDependencies(Z.tileID.key,Z.type,[""]),Q}))}getGlyphsUrl(){return this.stylesheet.glyphs||null}setGlyphs(t,Z={}){this._checkLoaded(),t&&this._validate(R.z.glyphs,"glyphs",t,null,Z)||(this._glyphsDidChange=!0,this.stylesheet.glyphs=t,this.glyphManager.entries={},this.glyphManager.setURL(t))}getDashes(t,Z){return R._(this,void 0,void 0,(function*(){const Q={};for(const[ie,ue]of Object.entries(Z.dashes))Q[ie]=this.lineAtlas.getDash(ue.dasharray,ue.round);return Q}))}addSprite(t,Z,Q={},ie){this._checkLoaded();const ue=[{id:t,url:Z}],de=[...We(this.stylesheet.sprite),...ue];this._validate(R.z.sprite,"sprite",de,null,Q)||(this.stylesheet.sprite=de,this._loadSprite(ue,!0,ie))}removeSprite(t){this._checkLoaded();const Z=We(this.stylesheet.sprite);if(Z.find((Q=>Q.id===t))){if(this._spritesImagesIds[t])for(const Q of this._spritesImagesIds[t])this.imageManager.removeImage(Q),this._changedImages[Q]=!0;Z.splice(Z.findIndex((Q=>Q.id===t)),1),this.stylesheet.sprite=Z.length>0?Z:void 0,delete this._spritesImagesIds[t],this._availableImages=this.imageManager.listImages(),this._changed=!0,this.dispatcher.broadcast("SI",this._availableImages),this.fire(new R.l("data",{dataType:"style"}))}else this.fire(new R.k(new Error(`Sprite "${t}" doesn't exists on this map.`)))}getSprite(){return We(this.stylesheet.sprite)}setSprite(t,Z={},Q){this._checkLoaded(),t&&this._validate(R.z.sprite,"sprite",t,null,Z)||(this.stylesheet.sprite=t,t?this._loadSprite(t,!0,Q):(this._unloadSprite(),Q&&Q(null)))}}var Mc=R.aJ([{name:"a_pos",type:"Int16",components:2},{name:"a_texture_pos",type:"Int16",components:2}]);class os{constructor(){this.boundProgram=null,this.boundLayoutVertexBuffer=null,this.boundPaintVertexBuffers=[],this.boundIndexBuffer=null,this.boundVertexOffset=null,this.boundDynamicVertexBuffer=null,this.vao=null}bind(t,Z,Q,ie,ue,de,ge,ve,qe){this.context=t;let Re=this.boundPaintVertexBuffers.length!==ie.length;for(let Le=0;!Re&&Le<ie.length;Le++)this.boundPaintVertexBuffers[Le]!==ie[Le]&&(Re=!0);!this.vao||this.boundProgram!==Z||this.boundLayoutVertexBuffer!==Q||Re||this.boundIndexBuffer!==ue||this.boundVertexOffset!==de||this.boundDynamicVertexBuffer!==ge||this.boundDynamicVertexBuffer2!==ve||this.boundDynamicVertexBuffer3!==qe?this.freshBind(Z,Q,ie,ue,de,ge,ve,qe):(t.bindVertexArray.set(this.vao),ge&&ge.bind(),ue&&ue.dynamicDraw&&ue.bind(),ve&&ve.bind(),qe&&qe.bind())}freshBind(t,Z,Q,ie,ue,de,ge,ve){const qe=t.numAttributes,Re=this.context,Le=Re.gl;this.vao&&this.destroy(),this.vao=Re.createVertexArray(),Re.bindVertexArray.set(this.vao),this.boundProgram=t,this.boundLayoutVertexBuffer=Z,this.boundPaintVertexBuffers=Q,this.boundIndexBuffer=ie,this.boundVertexOffset=ue,this.boundDynamicVertexBuffer=de,this.boundDynamicVertexBuffer2=ge,this.boundDynamicVertexBuffer3=ve,Z.enableAttributes(Le,t);for(const Fe of Q)Fe.enableAttributes(Le,t);de&&de.enableAttributes(Le,t),ge&&ge.enableAttributes(Le,t),ve&&ve.enableAttributes(Le,t),Z.bind(),Z.setVertexAttribPointers(Le,t,ue);for(const Fe of Q)Fe.bind(),Fe.setVertexAttribPointers(Le,t,ue);de&&(de.bind(),de.setVertexAttribPointers(Le,t,ue)),ie&&ie.bind(),ge&&(ge.bind(),ge.setVertexAttribPointers(Le,t,ue)),ve&&(ve.bind(),ve.setVertexAttribPointers(Le,t,ue)),Re.currentNumAttributes=qe}destroy(){this.vao&&(this.context.deleteVertexArray(this.vao),this.vao=null)}}const pl=(se,t,Z,Q,ie)=>({u_texture:0,u_ele_delta:se,u_fog_matrix:t,u_fog_color:Z?Z.properties.get("fog-color"):R.bf.white,u_fog_ground_blend:Z?Z.properties.get("fog-ground-blend"):1,u_fog_ground_blend_opacity:ie?0:Z?Z.calculateFogBlendOpacity(Q):0,u_horizon_color:Z?Z.properties.get("horizon-color"):R.bf.white,u_horizon_fog_blend:Z?Z.properties.get("horizon-fog-blend"):1,u_is_globe_mode:ie?1:0}),ss={mainMatrix:"u_projection_matrix",tileMercatorCoords:"u_projection_tile_mercator_coords",clippingPlane:"u_projection_clipping_plane",projectionTransition:"u_projection_transition",fallbackMatrix:"u_projection_fallback_matrix"};function Wa(se){const t=[];for(let Z=0;Z<se.length;Z++){if(se[Z]===null)continue;const Q=se[Z].split(" ");t.push(Q.pop())}return t}class _l{constructor(t,Z,Q,ie,ue,de,ge,ve,qe=[]){const Re=t.gl;this.program=Re.createProgram();const Le=Wa(Z.staticAttributes),Fe=Q?Q.getBinderAttributes():[],Ve=Le.concat(Fe),Xe=hn.prelude.staticUniforms?Wa(hn.prelude.staticUniforms):[],at=ge.staticUniforms?Wa(ge.staticUniforms):[],ot=Z.staticUniforms?Wa(Z.staticUniforms):[],lt=Q?Q.getBinderUniforms():[],pt=Xe.concat(at).concat(ot).concat(lt),yt=[];for(const kt of pt)yt.indexOf(kt)<0&&yt.push(kt);const mt=Q?Q.defines():[];sn(Re)&&mt.unshift("#version 300 es"),ue&&mt.push("#define OVERDRAW_INSPECTOR;"),de&&mt.push("#define TERRAIN3D;"),ve&&mt.push(ve),qe&&mt.push(...qe);let xt=mt.concat(hn.prelude.fragmentSource,ge.fragmentSource,Z.fragmentSource).join(`
`),It=mt.concat(hn.prelude.vertexSource,ge.vertexSource,Z.vertexSource).join(`
`);sn(Re)||(xt=(function(kt){return kt.replace(/\bin\s/g,"varying ").replace("out highp vec4 fragColor;","").replace(/fragColor/g,"gl_FragColor").replace(/texture\(/g,"texture2D(")})(xt),It=(function(kt){return kt.replace(/\bin\s/g,"attribute ").replace(/\bout\s/g,"varying ").replace(/texture\(/g,"texture2D(")})(It));const gt=Re.createShader(Re.FRAGMENT_SHADER);if(Re.isContextLost())return void(this.failedToCreate=!0);if(Re.shaderSource(gt,xt),Re.compileShader(gt),!Re.getShaderParameter(gt,Re.COMPILE_STATUS))throw new Error(`Could not compile fragment shader: ${Re.getShaderInfoLog(gt)}`);Re.attachShader(this.program,gt);const Ot=Re.createShader(Re.VERTEX_SHADER);if(Re.isContextLost())return void(this.failedToCreate=!0);if(Re.shaderSource(Ot,It),Re.compileShader(Ot),!Re.getShaderParameter(Ot,Re.COMPILE_STATUS))throw new Error(`Could not compile vertex shader: ${Re.getShaderInfoLog(Ot)}`);Re.attachShader(this.program,Ot),this.attributes={};const zt={};this.numAttributes=Ve.length;for(let kt=0;kt<this.numAttributes;kt++)Ve[kt]&&(Re.bindAttribLocation(this.program,kt,Ve[kt]),this.attributes[Ve[kt]]=kt);if(Re.linkProgram(this.program),!Re.getProgramParameter(this.program,Re.LINK_STATUS))throw new Error(`Program failed to link: ${Re.getProgramInfoLog(this.program)}`);Re.deleteShader(Ot),Re.deleteShader(gt);for(let kt=0;kt<yt.length;kt++){const Bt=yt[kt];if(Bt&&!zt[Bt]){const Nt=Re.getUniformLocation(this.program,Bt);Nt&&(zt[Bt]=Nt)}}this.fixedUniforms=ie(t,zt),this.terrainUniforms=((kt,Bt)=>({u_depth:new R.bQ(kt,Bt.u_depth),u_terrain:new R.bQ(kt,Bt.u_terrain),u_terrain_dim:new R.bg(kt,Bt.u_terrain_dim),u_terrain_matrix:new R.bS(kt,Bt.u_terrain_matrix),u_terrain_unpack:new R.bT(kt,Bt.u_terrain_unpack),u_terrain_exaggeration:new R.bg(kt,Bt.u_terrain_exaggeration)}))(t,zt),this.projectionUniforms=((kt,Bt)=>({u_projection_matrix:new R.bS(kt,Bt.u_projection_matrix),u_projection_tile_mercator_coords:new R.bT(kt,Bt.u_projection_tile_mercator_coords),u_projection_clipping_plane:new R.bT(kt,Bt.u_projection_clipping_plane),u_projection_transition:new R.bg(kt,Bt.u_projection_transition),u_projection_fallback_matrix:new R.bS(kt,Bt.u_projection_fallback_matrix)}))(t,zt),this.binderUniforms=Q?Q.getUniforms(t,zt):[]}draw(t,Z,Q,ie,ue,de,ge,ve,qe,Re,Le,Fe,Ve,Xe,at,ot,lt,pt,yt){const mt=t.gl;if(this.failedToCreate)return;if(t.program.set(this.program),t.setDepthMode(Q),t.setStencilMode(ie),t.setColorMode(ue),t.setCullFace(de),ve){t.activeTexture.set(mt.TEXTURE2),mt.bindTexture(mt.TEXTURE_2D,ve.depthTexture),t.activeTexture.set(mt.TEXTURE3),mt.bindTexture(mt.TEXTURE_2D,ve.texture);for(const It in this.terrainUniforms)this.terrainUniforms[It].set(ve[It])}if(qe)for(const It in qe)this.projectionUniforms[ss[It]].set(qe[It]);if(ge)for(const It in this.fixedUniforms)this.fixedUniforms[It].set(ge[It]);ot&&ot.setUniforms(t,this.binderUniforms,Xe,{zoom:at});let xt=0;switch(Z){case mt.LINES:xt=2;break;case mt.TRIANGLES:xt=3;break;case mt.LINE_STRIP:xt=1}for(const It of Ve.get()){const gt=It.vaos||(It.vaos={});(gt[Re]||(gt[Re]=new os)).bind(t,this,Le,ot?ot.getPaintVertexBuffers():[],Fe,It.vertexOffset,lt,pt,yt),mt.drawElements(Z,It.primitiveLength*xt,mt.UNSIGNED_SHORT,It.primitiveOffset*xt*2)}}}function Fn(se,t,Z){const Q=1/R.aC(Z,1,t.transform.tileZoom),ie=Math.pow(2,Z.tileID.overscaledZ),ue=Z.tileSize*Math.pow(2,t.transform.tileZoom)/ie,de=ue*(Z.tileID.canonical.x+Z.tileID.wrap*ie),ge=ue*Z.tileID.canonical.y;return{u_image:0,u_texsize:Z.imageAtlasTexture.size,u_scale:[Q,se.fromScale,se.toScale],u_fade:se.t,u_pixel_coord_upper:[de>>16,ge>>16],u_pixel_coord_lower:[65535&de,65535&ge]}}const xu=(se,t,Z,Q)=>{const ie=se.style.light,ue=ie.properties.get("position"),de=[ue.x,ue.y,ue.z],ge=R.bW();ie.properties.get("anchor")==="viewport"&&R.bX(ge,se.transform.bearingInRadians),R.bY(de,de,ge);const ve=se.transform.transformLightDirection(de),qe=ie.properties.get("color");return{u_lightpos:de,u_lightpos_globe:ve,u_lightintensity:ie.properties.get("intensity"),u_lightcolor:[qe.r,qe.g,qe.b],u_vertical_gradient:+t,u_opacity:Z,u_fill_translate:Q}},ml=(se,t,Z,Q,ie,ue,de)=>R.e(xu(se,t,Z,Q),Fn(ue,se,de),{u_height_factor:-Math.pow(2,ie.overscaledZ)/de.tileSize/8}),Ha=(se,t,Z,Q)=>R.e(Fn(t,se,Z),{u_fill_translate:Q}),To=(se,t)=>({u_world:se,u_fill_translate:t}),Dc=(se,t,Z,Q,ie)=>R.e(Ha(se,t,Z,ie),{u_world:Q}),ls=(se,t,Z,Q,ie)=>{const ue=se.transform;let de,ge,ve=0;if(Z.paint.get("circle-pitch-alignment")==="map"){const qe=R.aC(t,1,ue.zoom);de=!0,ge=[qe,qe],ve=qe/(R.$*Math.pow(2,t.tileID.overscaledZ))*2*Math.PI*ie}else de=!1,ge=ue.pixelsToGLUnits;return{u_camera_to_center_distance:ue.cameraToCenterDistance,u_scale_with_map:+(Z.paint.get("circle-pitch-scale")==="map"),u_pitch_with_map:+de,u_device_pixel_ratio:se.pixelRatio,u_extrude_scale:ge,u_globe_extrude_scale:ve,u_translate:Q}},Fc=se=>({u_pixel_extrude_scale:[1/se.width,1/se.height]}),Za=se=>({u_viewport_size:[se.width,se.height]}),wu=(se,t=1)=>({u_color:se,u_overlay:0,u_overlay_scale:t}),yl=(se,t,Z,Q)=>{const ie=R.aC(se,1,t)/(R.$*Math.pow(2,se.tileID.overscaledZ))*2*Math.PI*Q;return{u_extrude_scale:R.aC(se,1,t),u_intensity:Z,u_globe_extrude_scale:ie}},Su=(se,t,Z,Q)=>{const ie=R.L();R.bZ(ie,0,se.width,se.height,0,0,1);const ue=se.context.gl;return{u_matrix:ie,u_world:[ue.drawingBufferWidth,ue.drawingBufferHeight],u_image:Z,u_color_ramp:Q,u_opacity:t.paint.get("heatmap-opacity")}},Eu=(se,t,Z)=>{const Q=Z.paint.get("hillshade-accent-color");let ie;switch(Z.paint.get("hillshade-method")){case"basic":ie=4;break;case"combined":ie=1;break;case"igor":ie=2;break;case"multidirectional":ie=3;break;default:ie=0}const ue=Z.getIlluminationProperties();for(let de=0;de<ue.directionRadians.length;de++)Z.paint.get("hillshade-illumination-anchor")==="viewport"&&(ue.directionRadians[de]+=se.transform.bearingInRadians);return{u_image:0,u_latrange:qu(0,t.tileID),u_exaggeration:Z.paint.get("hillshade-exaggeration"),u_altitudes:ue.altitudeRadians,u_azimuths:ue.directionRadians,u_accent:Q,u_method:ie,u_highlights:ue.highlightColor,u_shadows:ue.shadowColor}},gl=(se,t)=>{const Z=t.stride,Q=R.L();return R.bZ(Q,0,R.$,-R.$,0,0,1),R.M(Q,Q,[0,-R.$,0]),{u_matrix:Q,u_image:1,u_dimension:[Z,Z],u_zoom:se.overscaledZ,u_unpack:t.getUnpackVector()}};function qu(se,t){const Z=Math.pow(2,t.canonical.z),Q=t.canonical.y;return[new R.a1(0,Q/Z).toLngLat().lat,new R.a1(0,(Q+1)/Z).toLngLat().lat]}const Tu=(se,t,Z=0)=>({u_image:0,u_unpack:t.getUnpackVector(),u_dimension:[t.stride,t.stride],u_elevation_stops:1,u_color_stops:4,u_color_ramp_size:Z,u_opacity:se.paint.get("color-relief-opacity")}),Io=(se,t,Z,Q)=>{const ie=se.transform;return{u_translation:Pu(se,t,Z),u_ratio:Q/R.aC(t,1,ie.zoom),u_device_pixel_ratio:se.pixelRatio,u_units_to_pixels:[1/ie.pixelsToGLUnits[0],1/ie.pixelsToGLUnits[1]]}},Iu=(se,t,Z,Q,ie)=>R.e(Io(se,t,Z,Q),{u_image:0,u_image_height:ie}),xa=(se,t,Z,Q,ie)=>{const ue=se.transform,de=wa(t,ue);return{u_translation:Pu(se,t,Z),u_texsize:t.imageAtlasTexture.size,u_ratio:Q/R.aC(t,1,ue.zoom),u_device_pixel_ratio:se.pixelRatio,u_image:0,u_scale:[de,ie.fromScale,ie.toScale],u_fade:ie.t,u_units_to_pixels:[1/ue.pixelsToGLUnits[0],1/ue.pixelsToGLUnits[1]]}},Ru=(se,t,Z,Q,ie)=>{const ue=wa(t,se.transform);return R.e(Io(se,t,Z,Q),{u_tileratio:ue,u_crossfade_from:ie.fromScale,u_crossfade_to:ie.toScale,u_image:0,u_mix:ie.t,u_lineatlas_width:se.lineAtlas.width,u_lineatlas_height:se.lineAtlas.height})},Au=(se,t,Z,Q,ie,ue)=>{const de=wa(t,se.transform);return R.e(Io(se,t,Z,Q),{u_image:0,u_image_height:ue,u_tileratio:de,u_crossfade_from:ie.fromScale,u_crossfade_to:ie.toScale,u_image_dash:1,u_mix:ie.t,u_lineatlas_width:se.lineAtlas.width,u_lineatlas_height:se.lineAtlas.height})};function wa(se,t){return 1/R.aC(se,1,t.tileZoom)}function Pu(se,t,Z){return R.aD(se.transform,t,Z.paint.get("line-translate"),Z.paint.get("line-translate-anchor"))}const us=(se,t,Z,Q,ie)=>{return{u_tl_parent:se,u_scale_parent:t,u_buffer_scale:1,u_fade_t:Z.mix,u_opacity:Z.opacity*Q.paint.get("raster-opacity"),u_image0:0,u_image1:1,u_brightness_low:Q.paint.get("raster-brightness-min"),u_brightness_high:Q.paint.get("raster-brightness-max"),u_saturation_factor:(de=Q.paint.get("raster-saturation"),de>0?1-1/(1.001-de):-de),u_contrast_factor:(ue=Q.paint.get("raster-contrast"),ue>0?1/(1-ue):1+ue),u_spin_weights:kc(Q.paint.get("raster-hue-rotate")),u_coords_top:[ie[0].x,ie[0].y,ie[1].x,ie[1].y],u_coords_bottom:[ie[3].x,ie[3].y,ie[2].x,ie[2].y]};var ue,de};function kc(se){se*=Math.PI/180;const t=Math.sin(se),Z=Math.cos(se);return[(2*Z+1)/3,(-Math.sqrt(3)*t-Z+1)/3,(Math.sqrt(3)*t-Z+1)/3]}const Ou=(se,t,Z,Q,ie,ue,de,ge,ve,qe,Re,Le,Fe)=>{const Ve=de.transform;return{u_is_size_zoom_constant:+(se==="constant"||se==="source"),u_is_size_feature_constant:+(se==="constant"||se==="camera"),u_size_t:t?t.uSizeT:0,u_size:t?t.uSize:0,u_camera_to_center_distance:Ve.cameraToCenterDistance,u_pitch:Ve.pitch/360*2*Math.PI,u_rotate_symbol:+Z,u_aspect_ratio:Ve.width/Ve.height,u_fade_change:de.options.fadeDuration?de.symbolFadeChange:1,u_label_plane_matrix:ge,u_coord_matrix:ve,u_is_text:+Re,u_pitch_with_map:+Q,u_is_along_line:ie,u_is_variable_anchor:ue,u_texsize:Le,u_texture:0,u_translation:qe,u_pitched_scale:Fe}},vl=(se,t,Z,Q,ie,ue,de,ge,ve,qe,Re,Le,Fe,Ve)=>{const Xe=de.transform;return R.e(Ou(se,t,Z,Q,ie,ue,de,ge,ve,qe,Re,Le,Ve),{u_gamma_scale:Q?Math.cos(Xe.pitch*Math.PI/180)*Xe.cameraToCenterDistance:1,u_device_pixel_ratio:de.pixelRatio,u_is_halo:1})},Cu=(se,t,Z,Q,ie,ue,de,ge,ve,qe,Re,Le,Fe)=>R.e(vl(se,t,Z,Q,ie,ue,de,ge,ve,qe,!0,Re,0,Fe),{u_texsize_icon:Le,u_texture_icon:1}),Mu=(se,t)=>({u_opacity:se,u_color:t}),bl=(se,t,Z,Q,ie)=>R.e((function(ue,de,ge,ve){const qe=ge.imageManager.getPattern(ue.from.toString()),Re=ge.imageManager.getPattern(ue.to.toString()),{width:Le,height:Fe}=ge.imageManager.getPixelSize(),Ve=Math.pow(2,ve.tileID.overscaledZ),Xe=ve.tileSize*Math.pow(2,ge.transform.tileZoom)/Ve,at=Xe*(ve.tileID.canonical.x+ve.tileID.wrap*Ve),ot=Xe*ve.tileID.canonical.y;return{u_image:0,u_pattern_tl_a:qe.tl,u_pattern_br_a:qe.br,u_pattern_tl_b:Re.tl,u_pattern_br_b:Re.br,u_texsize:[Le,Fe],u_mix:de.t,u_pattern_size_a:qe.displaySize,u_pattern_size_b:Re.displaySize,u_scale_a:de.fromScale,u_scale_b:de.toScale,u_tile_units_to_pixels:1/R.aC(ve,1,ge.transform.tileZoom),u_pixel_coord_upper:[at>>16,ot>>16],u_pixel_coord_lower:[65535&at,65535&ot]}})(Z,ie,t,Q),{u_opacity:se}),xl=(se,t)=>{},cs={fillExtrusion:(se,t)=>({u_lightpos:new R.bU(se,t.u_lightpos),u_lightpos_globe:new R.bU(se,t.u_lightpos_globe),u_lightintensity:new R.bg(se,t.u_lightintensity),u_lightcolor:new R.bU(se,t.u_lightcolor),u_vertical_gradient:new R.bg(se,t.u_vertical_gradient),u_opacity:new R.bg(se,t.u_opacity),u_fill_translate:new R.bV(se,t.u_fill_translate)}),fillExtrusionPattern:(se,t)=>({u_lightpos:new R.bU(se,t.u_lightpos),u_lightpos_globe:new R.bU(se,t.u_lightpos_globe),u_lightintensity:new R.bg(se,t.u_lightintensity),u_lightcolor:new R.bU(se,t.u_lightcolor),u_vertical_gradient:new R.bg(se,t.u_vertical_gradient),u_height_factor:new R.bg(se,t.u_height_factor),u_opacity:new R.bg(se,t.u_opacity),u_fill_translate:new R.bV(se,t.u_fill_translate),u_image:new R.bQ(se,t.u_image),u_texsize:new R.bV(se,t.u_texsize),u_pixel_coord_upper:new R.bV(se,t.u_pixel_coord_upper),u_pixel_coord_lower:new R.bV(se,t.u_pixel_coord_lower),u_scale:new R.bU(se,t.u_scale),u_fade:new R.bg(se,t.u_fade)}),fill:(se,t)=>({u_fill_translate:new R.bV(se,t.u_fill_translate)}),fillPattern:(se,t)=>({u_image:new R.bQ(se,t.u_image),u_texsize:new R.bV(se,t.u_texsize),u_pixel_coord_upper:new R.bV(se,t.u_pixel_coord_upper),u_pixel_coord_lower:new R.bV(se,t.u_pixel_coord_lower),u_scale:new R.bU(se,t.u_scale),u_fade:new R.bg(se,t.u_fade),u_fill_translate:new R.bV(se,t.u_fill_translate)}),fillOutline:(se,t)=>({u_world:new R.bV(se,t.u_world),u_fill_translate:new R.bV(se,t.u_fill_translate)}),fillOutlinePattern:(se,t)=>({u_world:new R.bV(se,t.u_world),u_image:new R.bQ(se,t.u_image),u_texsize:new R.bV(se,t.u_texsize),u_pixel_coord_upper:new R.bV(se,t.u_pixel_coord_upper),u_pixel_coord_lower:new R.bV(se,t.u_pixel_coord_lower),u_scale:new R.bU(se,t.u_scale),u_fade:new R.bg(se,t.u_fade),u_fill_translate:new R.bV(se,t.u_fill_translate)}),circle:(se,t)=>({u_camera_to_center_distance:new R.bg(se,t.u_camera_to_center_distance),u_scale_with_map:new R.bQ(se,t.u_scale_with_map),u_pitch_with_map:new R.bQ(se,t.u_pitch_with_map),u_extrude_scale:new R.bV(se,t.u_extrude_scale),u_device_pixel_ratio:new R.bg(se,t.u_device_pixel_ratio),u_globe_extrude_scale:new R.bg(se,t.u_globe_extrude_scale),u_translate:new R.bV(se,t.u_translate)}),collisionBox:(se,t)=>({u_pixel_extrude_scale:new R.bV(se,t.u_pixel_extrude_scale)}),collisionCircle:(se,t)=>({u_viewport_size:new R.bV(se,t.u_viewport_size)}),debug:(se,t)=>({u_color:new R.bR(se,t.u_color),u_overlay:new R.bQ(se,t.u_overlay),u_overlay_scale:new R.bg(se,t.u_overlay_scale)}),depth:xl,clippingMask:xl,heatmap:(se,t)=>({u_extrude_scale:new R.bg(se,t.u_extrude_scale),u_intensity:new R.bg(se,t.u_intensity),u_globe_extrude_scale:new R.bg(se,t.u_globe_extrude_scale)}),heatmapTexture:(se,t)=>({u_matrix:new R.bS(se,t.u_matrix),u_world:new R.bV(se,t.u_world),u_image:new R.bQ(se,t.u_image),u_color_ramp:new R.bQ(se,t.u_color_ramp),u_opacity:new R.bg(se,t.u_opacity)}),hillshade:(se,t)=>({u_image:new R.bQ(se,t.u_image),u_latrange:new R.bV(se,t.u_latrange),u_exaggeration:new R.bg(se,t.u_exaggeration),u_altitudes:new R.b$(se,t.u_altitudes),u_azimuths:new R.b$(se,t.u_azimuths),u_accent:new R.bR(se,t.u_accent),u_method:new R.bQ(se,t.u_method),u_shadows:new R.b_(se,t.u_shadows),u_highlights:new R.b_(se,t.u_highlights)}),hillshadePrepare:(se,t)=>({u_matrix:new R.bS(se,t.u_matrix),u_image:new R.bQ(se,t.u_image),u_dimension:new R.bV(se,t.u_dimension),u_zoom:new R.bg(se,t.u_zoom),u_unpack:new R.bT(se,t.u_unpack)}),colorRelief:(se,t)=>({u_image:new R.bQ(se,t.u_image),u_unpack:new R.bT(se,t.u_unpack),u_dimension:new R.bV(se,t.u_dimension),u_elevation_stops:new R.bQ(se,t.u_elevation_stops),u_color_stops:new R.bQ(se,t.u_color_stops),u_color_ramp_size:new R.bQ(se,t.u_color_ramp_size),u_opacity:new R.bg(se,t.u_opacity)}),line:(se,t)=>({u_translation:new R.bV(se,t.u_translation),u_ratio:new R.bg(se,t.u_ratio),u_device_pixel_ratio:new R.bg(se,t.u_device_pixel_ratio),u_units_to_pixels:new R.bV(se,t.u_units_to_pixels)}),lineGradient:(se,t)=>({u_translation:new R.bV(se,t.u_translation),u_ratio:new R.bg(se,t.u_ratio),u_device_pixel_ratio:new R.bg(se,t.u_device_pixel_ratio),u_units_to_pixels:new R.bV(se,t.u_units_to_pixels),u_image:new R.bQ(se,t.u_image),u_image_height:new R.bg(se,t.u_image_height)}),linePattern:(se,t)=>({u_translation:new R.bV(se,t.u_translation),u_texsize:new R.bV(se,t.u_texsize),u_ratio:new R.bg(se,t.u_ratio),u_device_pixel_ratio:new R.bg(se,t.u_device_pixel_ratio),u_image:new R.bQ(se,t.u_image),u_units_to_pixels:new R.bV(se,t.u_units_to_pixels),u_scale:new R.bU(se,t.u_scale),u_fade:new R.bg(se,t.u_fade)}),lineSDF:(se,t)=>({u_translation:new R.bV(se,t.u_translation),u_ratio:new R.bg(se,t.u_ratio),u_device_pixel_ratio:new R.bg(se,t.u_device_pixel_ratio),u_units_to_pixels:new R.bV(se,t.u_units_to_pixels),u_image:new R.bQ(se,t.u_image),u_mix:new R.bg(se,t.u_mix),u_tileratio:new R.bg(se,t.u_tileratio),u_crossfade_from:new R.bg(se,t.u_crossfade_from),u_crossfade_to:new R.bg(se,t.u_crossfade_to),u_lineatlas_width:new R.bg(se,t.u_lineatlas_width),u_lineatlas_height:new R.bg(se,t.u_lineatlas_height)}),lineGradientSDF:(se,t)=>({u_translation:new R.bV(se,t.u_translation),u_ratio:new R.bg(se,t.u_ratio),u_device_pixel_ratio:new R.bg(se,t.u_device_pixel_ratio),u_units_to_pixels:new R.bV(se,t.u_units_to_pixels),u_image:new R.bQ(se,t.u_image),u_image_height:new R.bg(se,t.u_image_height),u_tileratio:new R.bg(se,t.u_tileratio),u_crossfade_from:new R.bg(se,t.u_crossfade_from),u_crossfade_to:new R.bg(se,t.u_crossfade_to),u_image_dash:new R.bQ(se,t.u_image_dash),u_mix:new R.bg(se,t.u_mix),u_lineatlas_width:new R.bg(se,t.u_lineatlas_width),u_lineatlas_height:new R.bg(se,t.u_lineatlas_height)}),raster:(se,t)=>({u_tl_parent:new R.bV(se,t.u_tl_parent),u_scale_parent:new R.bg(se,t.u_scale_parent),u_buffer_scale:new R.bg(se,t.u_buffer_scale),u_fade_t:new R.bg(se,t.u_fade_t),u_opacity:new R.bg(se,t.u_opacity),u_image0:new R.bQ(se,t.u_image0),u_image1:new R.bQ(se,t.u_image1),u_brightness_low:new R.bg(se,t.u_brightness_low),u_brightness_high:new R.bg(se,t.u_brightness_high),u_saturation_factor:new R.bg(se,t.u_saturation_factor),u_contrast_factor:new R.bg(se,t.u_contrast_factor),u_spin_weights:new R.bU(se,t.u_spin_weights),u_coords_top:new R.bT(se,t.u_coords_top),u_coords_bottom:new R.bT(se,t.u_coords_bottom)}),symbolIcon:(se,t)=>({u_is_size_zoom_constant:new R.bQ(se,t.u_is_size_zoom_constant),u_is_size_feature_constant:new R.bQ(se,t.u_is_size_feature_constant),u_size_t:new R.bg(se,t.u_size_t),u_size:new R.bg(se,t.u_size),u_camera_to_center_distance:new R.bg(se,t.u_camera_to_center_distance),u_pitch:new R.bg(se,t.u_pitch),u_rotate_symbol:new R.bQ(se,t.u_rotate_symbol),u_aspect_ratio:new R.bg(se,t.u_aspect_ratio),u_fade_change:new R.bg(se,t.u_fade_change),u_label_plane_matrix:new R.bS(se,t.u_label_plane_matrix),u_coord_matrix:new R.bS(se,t.u_coord_matrix),u_is_text:new R.bQ(se,t.u_is_text),u_pitch_with_map:new R.bQ(se,t.u_pitch_with_map),u_is_along_line:new R.bQ(se,t.u_is_along_line),u_is_variable_anchor:new R.bQ(se,t.u_is_variable_anchor),u_texsize:new R.bV(se,t.u_texsize),u_texture:new R.bQ(se,t.u_texture),u_translation:new R.bV(se,t.u_translation),u_pitched_scale:new R.bg(se,t.u_pitched_scale)}),symbolSDF:(se,t)=>({u_is_size_zoom_constant:new R.bQ(se,t.u_is_size_zoom_constant),u_is_size_feature_constant:new R.bQ(se,t.u_is_size_feature_constant),u_size_t:new R.bg(se,t.u_size_t),u_size:new R.bg(se,t.u_size),u_camera_to_center_distance:new R.bg(se,t.u_camera_to_center_distance),u_pitch:new R.bg(se,t.u_pitch),u_rotate_symbol:new R.bQ(se,t.u_rotate_symbol),u_aspect_ratio:new R.bg(se,t.u_aspect_ratio),u_fade_change:new R.bg(se,t.u_fade_change),u_label_plane_matrix:new R.bS(se,t.u_label_plane_matrix),u_coord_matrix:new R.bS(se,t.u_coord_matrix),u_is_text:new R.bQ(se,t.u_is_text),u_pitch_with_map:new R.bQ(se,t.u_pitch_with_map),u_is_along_line:new R.bQ(se,t.u_is_along_line),u_is_variable_anchor:new R.bQ(se,t.u_is_variable_anchor),u_texsize:new R.bV(se,t.u_texsize),u_texture:new R.bQ(se,t.u_texture),u_gamma_scale:new R.bg(se,t.u_gamma_scale),u_device_pixel_ratio:new R.bg(se,t.u_device_pixel_ratio),u_is_halo:new R.bQ(se,t.u_is_halo),u_translation:new R.bV(se,t.u_translation),u_pitched_scale:new R.bg(se,t.u_pitched_scale)}),symbolTextAndIcon:(se,t)=>({u_is_size_zoom_constant:new R.bQ(se,t.u_is_size_zoom_constant),u_is_size_feature_constant:new R.bQ(se,t.u_is_size_feature_constant),u_size_t:new R.bg(se,t.u_size_t),u_size:new R.bg(se,t.u_size),u_camera_to_center_distance:new R.bg(se,t.u_camera_to_center_distance),u_pitch:new R.bg(se,t.u_pitch),u_rotate_symbol:new R.bQ(se,t.u_rotate_symbol),u_aspect_ratio:new R.bg(se,t.u_aspect_ratio),u_fade_change:new R.bg(se,t.u_fade_change),u_label_plane_matrix:new R.bS(se,t.u_label_plane_matrix),u_coord_matrix:new R.bS(se,t.u_coord_matrix),u_is_text:new R.bQ(se,t.u_is_text),u_pitch_with_map:new R.bQ(se,t.u_pitch_with_map),u_is_along_line:new R.bQ(se,t.u_is_along_line),u_is_variable_anchor:new R.bQ(se,t.u_is_variable_anchor),u_texsize:new R.bV(se,t.u_texsize),u_texsize_icon:new R.bV(se,t.u_texsize_icon),u_texture:new R.bQ(se,t.u_texture),u_texture_icon:new R.bQ(se,t.u_texture_icon),u_gamma_scale:new R.bg(se,t.u_gamma_scale),u_device_pixel_ratio:new R.bg(se,t.u_device_pixel_ratio),u_is_halo:new R.bQ(se,t.u_is_halo),u_translation:new R.bV(se,t.u_translation),u_pitched_scale:new R.bg(se,t.u_pitched_scale)}),background:(se,t)=>({u_opacity:new R.bg(se,t.u_opacity),u_color:new R.bR(se,t.u_color)}),backgroundPattern:(se,t)=>({u_opacity:new R.bg(se,t.u_opacity),u_image:new R.bQ(se,t.u_image),u_pattern_tl_a:new R.bV(se,t.u_pattern_tl_a),u_pattern_br_a:new R.bV(se,t.u_pattern_br_a),u_pattern_tl_b:new R.bV(se,t.u_pattern_tl_b),u_pattern_br_b:new R.bV(se,t.u_pattern_br_b),u_texsize:new R.bV(se,t.u_texsize),u_mix:new R.bg(se,t.u_mix),u_pattern_size_a:new R.bV(se,t.u_pattern_size_a),u_pattern_size_b:new R.bV(se,t.u_pattern_size_b),u_scale_a:new R.bg(se,t.u_scale_a),u_scale_b:new R.bg(se,t.u_scale_b),u_pixel_coord_upper:new R.bV(se,t.u_pixel_coord_upper),u_pixel_coord_lower:new R.bV(se,t.u_pixel_coord_lower),u_tile_units_to_pixels:new R.bg(se,t.u_tile_units_to_pixels)}),terrain:(se,t)=>({u_texture:new R.bQ(se,t.u_texture),u_ele_delta:new R.bg(se,t.u_ele_delta),u_fog_matrix:new R.bS(se,t.u_fog_matrix),u_fog_color:new R.bR(se,t.u_fog_color),u_fog_ground_blend:new R.bg(se,t.u_fog_ground_blend),u_fog_ground_blend_opacity:new R.bg(se,t.u_fog_ground_blend_opacity),u_horizon_color:new R.bR(se,t.u_horizon_color),u_horizon_fog_blend:new R.bg(se,t.u_horizon_fog_blend),u_is_globe_mode:new R.bg(se,t.u_is_globe_mode)}),terrainDepth:(se,t)=>({u_ele_delta:new R.bg(se,t.u_ele_delta)}),terrainCoords:(se,t)=>({u_texture:new R.bQ(se,t.u_texture),u_terrain_coords_id:new R.bg(se,t.u_terrain_coords_id),u_ele_delta:new R.bg(se,t.u_ele_delta)}),projectionErrorMeasurement:(se,t)=>({u_input:new R.bg(se,t.u_input),u_output_expected:new R.bg(se,t.u_output_expected)}),atmosphere:(se,t)=>({u_sun_pos:new R.bU(se,t.u_sun_pos),u_atmosphere_blend:new R.bg(se,t.u_atmosphere_blend),u_globe_position:new R.bU(se,t.u_globe_position),u_globe_radius:new R.bg(se,t.u_globe_radius),u_inv_proj_matrix:new R.bS(se,t.u_inv_proj_matrix)}),sky:(se,t)=>({u_sky_color:new R.bR(se,t.u_sky_color),u_horizon_color:new R.bR(se,t.u_horizon_color),u_horizon:new R.bV(se,t.u_horizon),u_horizon_normal:new R.bV(se,t.u_horizon_normal),u_sky_horizon_blend:new R.bg(se,t.u_sky_horizon_blend),u_sky_blend:new R.bg(se,t.u_sky_blend)})};class Yn{constructor(t,Z,Q){this.context=t;const ie=t.gl;this.buffer=ie.createBuffer(),this.dynamicDraw=!!Q,this.context.unbindVAO(),t.bindElementBuffer.set(this.buffer),ie.bufferData(ie.ELEMENT_ARRAY_BUFFER,Z.arrayBuffer,this.dynamicDraw?ie.DYNAMIC_DRAW:ie.STATIC_DRAW),this.dynamicDraw||delete Z.arrayBuffer}bind(){this.context.bindElementBuffer.set(this.buffer)}updateData(t){const Z=this.context.gl;if(!this.dynamicDraw)throw new Error("Attempted to update data while not in dynamic mode.");this.context.unbindVAO(),this.bind(),Z.bufferSubData(Z.ELEMENT_ARRAY_BUFFER,0,t.arrayBuffer)}destroy(){this.buffer&&(this.context.gl.deleteBuffer(this.buffer),delete this.buffer)}}const wl={Int8:"BYTE",Uint8:"UNSIGNED_BYTE",Int16:"SHORT",Uint16:"UNSIGNED_SHORT",Int32:"INT",Uint32:"UNSIGNED_INT",Float32:"FLOAT"};class Sl{constructor(t,Z,Q,ie){this.length=Z.length,this.attributes=Q,this.itemSize=Z.bytesPerElement,this.dynamicDraw=ie,this.context=t;const ue=t.gl;this.buffer=ue.createBuffer(),t.bindVertexBuffer.set(this.buffer),ue.bufferData(ue.ARRAY_BUFFER,Z.arrayBuffer,this.dynamicDraw?ue.DYNAMIC_DRAW:ue.STATIC_DRAW),this.dynamicDraw||delete Z.arrayBuffer}bind(){this.context.bindVertexBuffer.set(this.buffer)}updateData(t){if(t.length!==this.length)throw new Error(`Length of new data is ${t.length}, which doesn't match current length of ${this.length}`);const Z=this.context.gl;this.bind(),Z.bufferSubData(Z.ARRAY_BUFFER,0,t.arrayBuffer)}enableAttributes(t,Z){for(let Q=0;Q<this.attributes.length;Q++){const ie=Z.attributes[this.attributes[Q].name];ie!==void 0&&t.enableVertexAttribArray(ie)}}setVertexAttribPointers(t,Z,Q){for(let ie=0;ie<this.attributes.length;ie++){const ue=this.attributes[ie],de=Z.attributes[ue.name];de!==void 0&&t.vertexAttribPointer(de,ue.components,t[wl[ue.type]],!1,this.itemSize,ue.offset+this.itemSize*(Q||0))}}destroy(){this.buffer&&(this.context.gl.deleteBuffer(this.buffer),delete this.buffer)}}class ci{constructor(t){this.gl=t.gl,this.default=this.getDefault(),this.current=this.default,this.dirty=!1}get(){return this.current}set(t){}getDefault(){return this.default}setDefault(){this.set(this.default)}}class Du extends ci{getDefault(){return R.bf.transparent}set(t){const Z=this.current;(t.r!==Z.r||t.g!==Z.g||t.b!==Z.b||t.a!==Z.a||this.dirty)&&(this.gl.clearColor(t.r,t.g,t.b,t.a),this.current=t,this.dirty=!1)}}class El extends ci{getDefault(){return 1}set(t){(t!==this.current||this.dirty)&&(this.gl.clearDepth(t),this.current=t,this.dirty=!1)}}class Sa extends ci{getDefault(){return 0}set(t){(t!==this.current||this.dirty)&&(this.gl.clearStencil(t),this.current=t,this.dirty=!1)}}class ql extends ci{getDefault(){return[!0,!0,!0,!0]}set(t){const Z=this.current;(t[0]!==Z[0]||t[1]!==Z[1]||t[2]!==Z[2]||t[3]!==Z[3]||this.dirty)&&(this.gl.colorMask(t[0],t[1],t[2],t[3]),this.current=t,this.dirty=!1)}}class Lc extends ci{getDefault(){return!0}set(t){(t!==this.current||this.dirty)&&(this.gl.depthMask(t),this.current=t,this.dirty=!1)}}class Bc extends ci{getDefault(){return 255}set(t){(t!==this.current||this.dirty)&&(this.gl.stencilMask(t),this.current=t,this.dirty=!1)}}class Nc extends ci{getDefault(){return{func:this.gl.ALWAYS,ref:0,mask:255}}set(t){const Z=this.current;(t.func!==Z.func||t.ref!==Z.ref||t.mask!==Z.mask||this.dirty)&&(this.gl.stencilFunc(t.func,t.ref,t.mask),this.current=t,this.dirty=!1)}}class jc extends ci{getDefault(){const t=this.gl;return[t.KEEP,t.KEEP,t.KEEP]}set(t){const Z=this.current;(t[0]!==Z[0]||t[1]!==Z[1]||t[2]!==Z[2]||this.dirty)&&(this.gl.stencilOp(t[0],t[1],t[2]),this.current=t,this.dirty=!1)}}class Fu extends ci{getDefault(){return!1}set(t){if(t===this.current&&!this.dirty)return;const Z=this.gl;t?Z.enable(Z.STENCIL_TEST):Z.disable(Z.STENCIL_TEST),this.current=t,this.dirty=!1}}class zc extends ci{getDefault(){return[0,1]}set(t){const Z=this.current;(t[0]!==Z[0]||t[1]!==Z[1]||this.dirty)&&(this.gl.depthRange(t[0],t[1]),this.current=t,this.dirty=!1)}}class ku extends ci{getDefault(){return!1}set(t){if(t===this.current&&!this.dirty)return;const Z=this.gl;t?Z.enable(Z.DEPTH_TEST):Z.disable(Z.DEPTH_TEST),this.current=t,this.dirty=!1}}class hs extends ci{getDefault(){return this.gl.LESS}set(t){(t!==this.current||this.dirty)&&(this.gl.depthFunc(t),this.current=t,this.dirty=!1)}}class ds extends ci{getDefault(){return!1}set(t){if(t===this.current&&!this.dirty)return;const Z=this.gl;t?Z.enable(Z.BLEND):Z.disable(Z.BLEND),this.current=t,this.dirty=!1}}class fs extends ci{getDefault(){const t=this.gl;return[t.ONE,t.ZERO]}set(t){const Z=this.current;(t[0]!==Z[0]||t[1]!==Z[1]||this.dirty)&&(this.gl.blendFunc(t[0],t[1]),this.current=t,this.dirty=!1)}}class Tl extends ci{getDefault(){return R.bf.transparent}set(t){const Z=this.current;(t.r!==Z.r||t.g!==Z.g||t.b!==Z.b||t.a!==Z.a||this.dirty)&&(this.gl.blendColor(t.r,t.g,t.b,t.a),this.current=t,this.dirty=!1)}}class Ea extends ci{getDefault(){return this.gl.FUNC_ADD}set(t){(t!==this.current||this.dirty)&&(this.gl.blendEquation(t),this.current=t,this.dirty=!1)}}class Ro extends ci{getDefault(){return!1}set(t){if(t===this.current&&!this.dirty)return;const Z=this.gl;t?Z.enable(Z.CULL_FACE):Z.disable(Z.CULL_FACE),this.current=t,this.dirty=!1}}class Ka extends ci{getDefault(){return this.gl.BACK}set(t){(t!==this.current||this.dirty)&&(this.gl.cullFace(t),this.current=t,this.dirty=!1)}}class Pn extends ci{getDefault(){return this.gl.CCW}set(t){(t!==this.current||this.dirty)&&(this.gl.frontFace(t),this.current=t,this.dirty=!1)}}class Lu extends ci{getDefault(){return null}set(t){(t!==this.current||this.dirty)&&(this.gl.useProgram(t),this.current=t,this.dirty=!1)}}class Bu extends ci{getDefault(){return this.gl.TEXTURE0}set(t){(t!==this.current||this.dirty)&&(this.gl.activeTexture(t),this.current=t,this.dirty=!1)}}class Il extends ci{getDefault(){const t=this.gl;return[0,0,t.drawingBufferWidth,t.drawingBufferHeight]}set(t){const Z=this.current;(t[0]!==Z[0]||t[1]!==Z[1]||t[2]!==Z[2]||t[3]!==Z[3]||this.dirty)&&(this.gl.viewport(t[0],t[1],t[2],t[3]),this.current=t,this.dirty=!1)}}class qa extends ci{getDefault(){return null}set(t){if(t===this.current&&!this.dirty)return;const Z=this.gl;Z.bindFramebuffer(Z.FRAMEBUFFER,t),this.current=t,this.dirty=!1}}class ps extends ci{getDefault(){return null}set(t){if(t===this.current&&!this.dirty)return;const Z=this.gl;Z.bindRenderbuffer(Z.RENDERBUFFER,t),this.current=t,this.dirty=!1}}class _s extends ci{getDefault(){return null}set(t){if(t===this.current&&!this.dirty)return;const Z=this.gl;Z.bindTexture(Z.TEXTURE_2D,t),this.current=t,this.dirty=!1}}class Ao extends ci{getDefault(){return null}set(t){if(t===this.current&&!this.dirty)return;const Z=this.gl;Z.bindBuffer(Z.ARRAY_BUFFER,t),this.current=t,this.dirty=!1}}class ys extends ci{getDefault(){return null}set(t){const Z=this.gl;Z.bindBuffer(Z.ELEMENT_ARRAY_BUFFER,t),this.current=t,this.dirty=!1}}class Nu extends ci{getDefault(){return null}set(t){var Z;if(t===this.current&&!this.dirty)return;const Q=this.gl;sn(Q)?Q.bindVertexArray(t):(Z=Q.getExtension("OES_vertex_array_object"))===null||Z===void 0||Z.bindVertexArrayOES(t),this.current=t,this.dirty=!1}}class Xa extends ci{getDefault(){return 4}set(t){if(t===this.current&&!this.dirty)return;const Z=this.gl;Z.pixelStorei(Z.UNPACK_ALIGNMENT,t),this.current=t,this.dirty=!1}}class Ya extends ci{getDefault(){return!1}set(t){if(t===this.current&&!this.dirty)return;const Z=this.gl;Z.pixelStorei(Z.UNPACK_PREMULTIPLY_ALPHA_WEBGL,t),this.current=t,this.dirty=!1}}class ju extends ci{getDefault(){return!1}set(t){if(t===this.current&&!this.dirty)return;const Z=this.gl;Z.pixelStorei(Z.UNPACK_FLIP_Y_WEBGL,t),this.current=t,this.dirty=!1}}class Po extends ci{constructor(t,Z){super(t),this.context=t,this.parent=Z}getDefault(){return null}}class ei extends Po{setDirty(){this.dirty=!0}set(t){if(t===this.current&&!this.dirty)return;this.context.bindFramebuffer.set(this.parent);const Z=this.gl;Z.framebufferTexture2D(Z.FRAMEBUFFER,Z.COLOR_ATTACHMENT0,Z.TEXTURE_2D,t,0),this.current=t,this.dirty=!1}}class gs extends Po{set(t){if(t===this.current&&!this.dirty)return;this.context.bindFramebuffer.set(this.parent);const Z=this.gl;Z.framebufferRenderbuffer(Z.FRAMEBUFFER,Z.DEPTH_ATTACHMENT,Z.RENDERBUFFER,t),this.current=t,this.dirty=!1}}class Uc extends Po{set(t){if(t===this.current&&!this.dirty)return;this.context.bindFramebuffer.set(this.parent);const Z=this.gl;Z.framebufferRenderbuffer(Z.FRAMEBUFFER,Z.DEPTH_STENCIL_ATTACHMENT,Z.RENDERBUFFER,t),this.current=t,this.dirty=!1}}const Rl="Framebuffer is not complete";class Oo{constructor(t,Z,Q,ie,ue){this.context=t,this.width=Z,this.height=Q;const de=t.gl,ge=this.framebuffer=de.createFramebuffer();if(this.colorAttachment=new ei(t,ge),ie)this.depthAttachment=ue?new Uc(t,ge):new gs(t,ge);else if(ue)throw new Error("Stencil cannot be set without depth");if(de.checkFramebufferStatus(de.FRAMEBUFFER)!==de.FRAMEBUFFER_COMPLETE)throw new Error(Rl)}destroy(){const t=this.context.gl,Z=this.colorAttachment.get();if(Z&&t.deleteTexture(Z),this.depthAttachment){const Q=this.depthAttachment.get();Q&&t.deleteRenderbuffer(Q)}t.deleteFramebuffer(this.framebuffer)}}class Vc{constructor(t){var Z,Q;if(this.gl=t,this.clearColor=new Du(this),this.clearDepth=new El(this),this.clearStencil=new Sa(this),this.colorMask=new ql(this),this.depthMask=new Lc(this),this.stencilMask=new Bc(this),this.stencilFunc=new Nc(this),this.stencilOp=new jc(this),this.stencilTest=new Fu(this),this.depthRange=new zc(this),this.depthTest=new ku(this),this.depthFunc=new hs(this),this.blend=new ds(this),this.blendFunc=new fs(this),this.blendColor=new Tl(this),this.blendEquation=new Ea(this),this.cullFace=new Ro(this),this.cullFaceSide=new Ka(this),this.frontFace=new Pn(this),this.program=new Lu(this),this.activeTexture=new Bu(this),this.viewport=new Il(this),this.bindFramebuffer=new qa(this),this.bindRenderbuffer=new ps(this),this.bindTexture=new _s(this),this.bindVertexBuffer=new Ao(this),this.bindElementBuffer=new ys(this),this.bindVertexArray=new Nu(this),this.pixelStoreUnpack=new Xa(this),this.pixelStoreUnpackPremultiplyAlpha=new Ya(this),this.pixelStoreUnpackFlipY=new ju(this),this.extTextureFilterAnisotropic=t.getExtension("EXT_texture_filter_anisotropic")||t.getExtension("MOZ_EXT_texture_filter_anisotropic")||t.getExtension("WEBKIT_EXT_texture_filter_anisotropic"),this.extTextureFilterAnisotropic&&(this.extTextureFilterAnisotropicMax=t.getParameter(this.extTextureFilterAnisotropic.MAX_TEXTURE_MAX_ANISOTROPY_EXT)),this.maxTextureSize=t.getParameter(t.MAX_TEXTURE_SIZE),sn(t)){this.HALF_FLOAT=t.HALF_FLOAT;const ie=t.getExtension("EXT_color_buffer_half_float");this.RGBA16F=(Z=t.RGBA16F)!==null&&Z!==void 0?Z:ie==null?void 0:ie.RGBA16F_EXT,this.RGB16F=(Q=t.RGB16F)!==null&&Q!==void 0?Q:ie==null?void 0:ie.RGB16F_EXT,t.getExtension("EXT_color_buffer_float")}else{t.getExtension("EXT_color_buffer_half_float"),t.getExtension("OES_texture_half_float_linear");const ie=t.getExtension("OES_texture_half_float");this.HALF_FLOAT=ie==null?void 0:ie.HALF_FLOAT_OES}}setDefault(){this.unbindVAO(),this.clearColor.setDefault(),this.clearDepth.setDefault(),this.clearStencil.setDefault(),this.colorMask.setDefault(),this.depthMask.setDefault(),this.stencilMask.setDefault(),this.stencilFunc.setDefault(),this.stencilOp.setDefault(),this.stencilTest.setDefault(),this.depthRange.setDefault(),this.depthTest.setDefault(),this.depthFunc.setDefault(),this.blend.setDefault(),this.blendFunc.setDefault(),this.blendColor.setDefault(),this.blendEquation.setDefault(),this.cullFace.setDefault(),this.cullFaceSide.setDefault(),this.frontFace.setDefault(),this.program.setDefault(),this.activeTexture.setDefault(),this.bindFramebuffer.setDefault(),this.pixelStoreUnpack.setDefault(),this.pixelStoreUnpackPremultiplyAlpha.setDefault(),this.pixelStoreUnpackFlipY.setDefault()}setDirty(){this.clearColor.dirty=!0,this.clearDepth.dirty=!0,this.clearStencil.dirty=!0,this.colorMask.dirty=!0,this.depthMask.dirty=!0,this.stencilMask.dirty=!0,this.stencilFunc.dirty=!0,this.stencilOp.dirty=!0,this.stencilTest.dirty=!0,this.depthRange.dirty=!0,this.depthTest.dirty=!0,this.depthFunc.dirty=!0,this.blend.dirty=!0,this.blendFunc.dirty=!0,this.blendColor.dirty=!0,this.blendEquation.dirty=!0,this.cullFace.dirty=!0,this.cullFaceSide.dirty=!0,this.frontFace.dirty=!0,this.program.dirty=!0,this.activeTexture.dirty=!0,this.viewport.dirty=!0,this.bindFramebuffer.dirty=!0,this.bindRenderbuffer.dirty=!0,this.bindTexture.dirty=!0,this.bindVertexBuffer.dirty=!0,this.bindElementBuffer.dirty=!0,this.bindVertexArray.dirty=!0,this.pixelStoreUnpack.dirty=!0,this.pixelStoreUnpackPremultiplyAlpha.dirty=!0,this.pixelStoreUnpackFlipY.dirty=!0}createIndexBuffer(t,Z){return new Yn(this,t,Z)}createVertexBuffer(t,Z,Q){return new Sl(this,t,Z,Q)}createRenderbuffer(t,Z,Q){const ie=this.gl,ue=ie.createRenderbuffer();return this.bindRenderbuffer.set(ue),ie.renderbufferStorage(ie.RENDERBUFFER,t,Z,Q),this.bindRenderbuffer.set(null),ue}createFramebuffer(t,Z,Q,ie){return new Oo(this,t,Z,Q,ie)}clear({color:t,depth:Z,stencil:Q}){const ie=this.gl;let ue=0;t&&(ue|=ie.COLOR_BUFFER_BIT,this.clearColor.set(t),this.colorMask.set([!0,!0,!0,!0])),Z!==void 0&&(ue|=ie.DEPTH_BUFFER_BIT,this.depthRange.set([0,1]),this.clearDepth.set(Z),this.depthMask.set(!0)),Q!==void 0&&(ue|=ie.STENCIL_BUFFER_BIT,this.clearStencil.set(Q),this.stencilMask.set(255)),ie.clear(ue)}setCullFace(t){t.enable===!1?this.cullFace.set(!1):(this.cullFace.set(!0),this.cullFaceSide.set(t.mode),this.frontFace.set(t.frontFace))}setDepthMode(t){t.func!==this.gl.ALWAYS||t.mask?(this.depthTest.set(!0),this.depthFunc.set(t.func),this.depthMask.set(t.mask),this.depthRange.set(t.range)):this.depthTest.set(!1)}setStencilMode(t){t.test.func!==this.gl.ALWAYS||t.mask?(this.stencilTest.set(!0),this.stencilMask.set(t.mask),this.stencilOp.set([t.fail,t.depthFail,t.pass]),this.stencilFunc.set({func:t.test.func,ref:t.ref,mask:t.test.mask})):this.stencilTest.set(!1)}setColorMode(t){R.bH(t.blendFunction,pi.Replace)?this.blend.set(!1):(this.blend.set(!0),this.blendFunc.set(t.blendFunction),this.blendColor.set(t.blendColor)),this.colorMask.set(t.mask)}createVertexArray(){var t;return sn(this.gl)?this.gl.createVertexArray():(t=this.gl.getExtension("OES_vertex_array_object"))===null||t===void 0?void 0:t.createVertexArrayOES()}deleteVertexArray(t){var Z;return sn(this.gl)?this.gl.deleteVertexArray(t):(Z=this.gl.getExtension("OES_vertex_array_object"))===null||Z===void 0?void 0:Z.deleteVertexArrayOES(t)}unbindVAO(){this.bindVertexArray.set(null)}}let vs;function Al(se,t,Z,Q,ie){const ue=se.context,de=se.transform,ge=ue.gl,ve=se.useProgram("collisionBox"),qe=[];let Re=0,Le=0;for(let lt=0;lt<Q.length;lt++){const pt=Q[lt],yt=t.getTile(pt).getBucket(Z);if(!yt)continue;const mt=ie?yt.textCollisionBox:yt.iconCollisionBox,xt=yt.collisionCircleArray;xt.length>0&&(qe.push({circleArray:xt,circleOffset:Le,coord:pt}),Re+=xt.length/4,Le=Re),mt&&ve.draw(ue,ge.LINES,$r.disabled,Xr.disabled,se.colorModeForRenderPass(),ni.disabled,Fc(se.transform),se.style.map.terrain&&se.style.map.terrain.getTerrainData(pt),de.getProjectionData({overscaledTileID:pt,applyGlobeMatrix:!0,applyTerrainMatrix:!0}),Z.id,mt.layoutVertexBuffer,mt.indexBuffer,mt.segments,null,se.transform.zoom,null,null,mt.collisionVertexBuffer)}if(!ie||!qe.length)return;const Fe=se.useProgram("collisionCircle"),Ve=new R.c0;Ve.resize(4*Re),Ve._trim();let Xe=0;for(const lt of qe)for(let pt=0;pt<lt.circleArray.length/4;pt++){const yt=4*pt,mt=lt.circleArray[yt+0],xt=lt.circleArray[yt+1],It=lt.circleArray[yt+2],gt=lt.circleArray[yt+3];Ve.emplace(Xe++,mt,xt,It,gt,0),Ve.emplace(Xe++,mt,xt,It,gt,1),Ve.emplace(Xe++,mt,xt,It,gt,2),Ve.emplace(Xe++,mt,xt,It,gt,3)}(!vs||vs.length<2*Re)&&(vs=(function(lt){const pt=2*lt,yt=new R.c2;yt.resize(pt),yt._trim();for(let mt=0;mt<pt;mt++){const xt=6*mt;yt.uint16[xt+0]=4*mt+0,yt.uint16[xt+1]=4*mt+1,yt.uint16[xt+2]=4*mt+2,yt.uint16[xt+3]=4*mt+2,yt.uint16[xt+4]=4*mt+3,yt.uint16[xt+5]=4*mt+0}return yt})(Re));const at=ue.createIndexBuffer(vs,!0),ot=ue.createVertexBuffer(Ve,R.c1.members,!0);for(const lt of qe){const pt=Za(se.transform);Fe.draw(ue,ge.TRIANGLES,$r.disabled,Xr.disabled,se.colorModeForRenderPass(),ni.disabled,pt,se.style.map.terrain&&se.style.map.terrain.getTerrainData(lt.coord),null,Z.id,ot,at,R.aM.simpleSegment(0,2*lt.circleOffset,lt.circleArray.length,lt.circleArray.length/2),null,se.transform.zoom,null,null,null)}ot.destroy(),at.destroy()}const Gc=R.ag(new Float32Array(16));function Pl(se,t,Z,Q,ie,ue){const{horizontalAlign:de,verticalAlign:ge}=R.aH(se);return new R.P((-(de-.5)*t/ie+Q[0])*ue,(-(ge-.5)*Z/ie+Q[1])*ue)}function bs(se,t,Z,Q,ie,ue){const de=t.tileAnchorPoint.add(new R.P(t.translation[0],t.translation[1]));if(t.pitchWithMap){let ge=Q.mult(ue);Z||(ge=ge.rotate(-ie));const ve=de.add(ge);return Ht(ve.x,ve.y,t.pitchedLabelPlaneMatrix,t.getElevation).point}if(Z){const ge=tr(t.tileAnchorPoint.x+1,t.tileAnchorPoint.y,t).point.sub(se),ve=Math.atan(ge.y/ge.x)+(ge.x<0?Math.PI:0);return se.add(Q.rotate(ve))}return se.add(Q)}function xs(se,t,Z,Q,ie,ue,de,ge,ve,qe,Re,Le){const Fe=se.text.placedSymbolArray,Ve=se.text.dynamicLayoutVertexArray,Xe=se.icon.dynamicLayoutVertexArray,at={};Ve.clear();for(let ot=0;ot<Fe.length;ot++){const lt=Fe.get(ot),pt=lt.hidden||!lt.crossTileID||se.allowVerticalPlacement&&!lt.placedOrientation?null:Q[lt.crossTileID];if(pt){const yt=new R.P(lt.anchorX,lt.anchorY),mt={getElevation:Le,width:ie.width,height:ie.height,pitchedLabelPlaneMatrix:ue,pitchWithMap:Z,transform:ie,tileAnchorPoint:yt,translation:qe,unwrappedTileID:Re},xt=Z?Pt(yt.x,yt.y,mt):tr(yt.x,yt.y,mt),It=Ti(ie.cameraToCenterDistance,xt.signedDistanceFromCamera);let gt=R.ap(se.textSizeData,ge,lt)*It/R.aB;Z&&(gt*=se.tilePixelRatio/de);const{width:Ot,height:zt,anchor:kt,textOffset:Bt,textBoxScale:Nt}=pt,ar=Pl(kt,Ot,zt,Bt,Nt,gt),sr=ie.getPitchedTextCorrection(yt.x+qe[0],yt.y+qe[1],Re),Kt=bs(xt.point,mt,t,ar,-ie.bearingInRadians,sr),Tr=se.allowVerticalPlacement&&lt.placedOrientation===R.ao.vertical?Math.PI/2:0;for(let Wr=0;Wr<lt.numGlyphs;Wr++)R.av(Ve,Kt,Tr);ve&&lt.associatedIconIndex>=0&&(at[lt.associatedIconIndex]={shiftedAnchor:Kt,angle:Tr})}else fi(lt.numGlyphs,Ve)}if(ve){Xe.clear();const ot=se.icon.placedSymbolArray;for(let lt=0;lt<ot.length;lt++){const pt=ot.get(lt);if(pt.hidden)fi(pt.numGlyphs,Xe);else{const yt=at[lt];if(yt)for(let mt=0;mt<pt.numGlyphs;mt++)R.av(Xe,yt.shiftedAnchor,yt.angle);else fi(pt.numGlyphs,Xe)}}se.icon.dynamicLayoutVertexBuffer.updateData(Xe)}se.text.dynamicLayoutVertexBuffer.updateData(Ve)}function ws(se,t,Z){return Z.iconsInText&&t?"symbolTextAndIcon":se?"symbolSDF":"symbolIcon"}function Ss(se,t,Z,Q,ie,ue,de,ge,ve,qe,Re,Le,Fe){const Ve=se.context,Xe=Ve.gl,at=se.transform,ot=ge==="map",lt=ve==="map",pt=ge!=="viewport"&&Z.layout.get("symbol-placement")!=="point",yt=ot&&!lt&&!pt,mt=!Z.layout.get("symbol-sort-key").isConstant();let xt=!1;const It=se.getDepthModeForSublayer(0,$r.ReadOnly),gt=Z._unevaluatedLayout.hasValue("text-variable-anchor")||Z._unevaluatedLayout.hasValue("text-variable-anchor-offset"),Ot=[],zt=at.getCircleRadiusCorrection();for(const kt of Q){const Bt=t.getTile(kt),Nt=Bt.getBucket(Z);if(!Nt)continue;const ar=ie?Nt.text:Nt.icon;if(!ar||!ar.segments.get().length||!ar.hasVisibleVertices)continue;const sr=ar.programConfigurations.get(Z.id),Kt=ie||Nt.sdfIcons,Tr=ie?Nt.textSizeData:Nt.iconSizeData,Wr=lt||at.pitch!==0,hi=se.useProgram(ws(Kt,ie,Nt),sr),di=R.an(Tr,at.zoom),_i=se.style.map.terrain&&se.style.map.terrain.getTerrainData(kt);let Ri,gi,si,Ei,rn=[0,0],ki=null;if(ie)gi=Bt.glyphAtlasTexture,si=Xe.LINEAR,Ri=Bt.glyphAtlasTexture.size,Nt.iconsInText&&(rn=Bt.imageAtlasTexture.size,ki=Bt.imageAtlasTexture,Ei=Wr||se.options.rotating||se.options.zooming||Tr.kind==="composite"||Tr.kind==="camera"?Xe.LINEAR:Xe.NEAREST);else{const Fi=Z.layout.get("icon-size").constantOr(0)!==1||Nt.iconsNeedLinear;gi=Bt.imageAtlasTexture,si=Kt||se.options.rotating||se.options.zooming||Fi||Wr?Xe.LINEAR:Xe.NEAREST,Ri=Bt.imageAtlasTexture.size}const Li=R.aC(Bt,1,se.transform.zoom),_n=Jr(ot,se.transform,Li),ha=R.L();R.aq(ha,_n);const Bn=li(lt,ot,se.transform,Li),da=R.aD(at,Bt,ue,de),Da=at.getProjectionData({overscaledTileID:kt,applyGlobeMatrix:!Fe,applyTerrainMatrix:!0}),Us=gt&&Nt.hasTextData(),uo=Z.layout.get("icon-text-fit")!=="none"&&Us&&Nt.hasIconData();if(pt){const Fi=se.style.map.terrain?(qn,Zi)=>se.style.map.terrain.getElevation(kt,qn,Zi):null,Ui=Z.layout.get("text-rotation-alignment")==="map";Pi(Nt,se,ie,_n,ha,lt,qe,Ui,kt.toUnwrapped(),at.width,at.height,da,Fi)}const Qn=ie&&gt||uo,Sn=pt||Qn?Gc:lt?_n:se.transform.clipSpaceToPixelsMatrix,Zn=Kt&&Z.paint.get(ie?"text-halo-width":"icon-halo-width").constantOr(1)!==0;let Kn;Kn=Kt?Nt.iconsInText?Cu(Tr.kind,di,yt,lt,pt,Qn,se,Sn,Bn,da,Ri,rn,zt):vl(Tr.kind,di,yt,lt,pt,Qn,se,Sn,Bn,da,ie,Ri,0,zt):Ou(Tr.kind,di,yt,lt,pt,Qn,se,Sn,Bn,da,ie,Ri,zt);const En={program:hi,buffers:ar,uniformValues:Kn,projectionData:Da,atlasTexture:gi,atlasTextureIcon:ki,atlasInterpolation:si,atlasInterpolationIcon:Ei,isSDF:Kt,hasHalo:Zn};if(mt&&Nt.canOverlap){xt=!0;const Fi=ar.segments.get();for(const Ui of Fi)Ot.push({segments:new R.aM([Ui]),sortKey:Ui.sortKey,state:En,terrainData:_i})}else Ot.push({segments:ar.segments,sortKey:0,state:En,terrainData:_i})}xt&&Ot.sort(((kt,Bt)=>kt.sortKey-Bt.sortKey));for(const kt of Ot){const Bt=kt.state;if(Ve.activeTexture.set(Xe.TEXTURE0),Bt.atlasTexture.bind(Bt.atlasInterpolation,Xe.CLAMP_TO_EDGE),Bt.atlasTextureIcon&&(Ve.activeTexture.set(Xe.TEXTURE1),Bt.atlasTextureIcon&&Bt.atlasTextureIcon.bind(Bt.atlasInterpolationIcon,Xe.CLAMP_TO_EDGE)),Bt.isSDF){const Nt=Bt.uniformValues;Bt.hasHalo&&(Nt.u_is_halo=1,Ol(Bt.buffers,kt.segments,Z,se,Bt.program,It,Re,Le,Nt,Bt.projectionData,kt.terrainData)),Nt.u_is_halo=0}Ol(Bt.buffers,kt.segments,Z,se,Bt.program,It,Re,Le,Bt.uniformValues,Bt.projectionData,kt.terrainData)}}function Ol(se,t,Z,Q,ie,ue,de,ge,ve,qe,Re){const Le=Q.context;ie.draw(Le,Le.gl.TRIANGLES,ue,de,ge,ni.backCCW,ve,Re,qe,Z.id,se.layoutVertexBuffer,se.indexBuffer,t,Z.paint,Q.transform.zoom,se.programConfigurations.get(Z.id),se.dynamicLayoutVertexBuffer,se.opacityVertexBuffer)}function Es(se,t,Z,Q,ie){const ue=se.context,de=ue.gl,ge=Xr.disabled,ve=new pi([de.ONE,de.ONE],R.bf.transparent,[!0,!0,!0,!0]),qe=t.getBucket(Z);if(!qe)return;const Re=Q.key;let Le=Z.heatmapFbos.get(Re);Le||(Le=Co(ue,t.tileSize,t.tileSize),Z.heatmapFbos.set(Re,Le)),ue.bindFramebuffer.set(Le.framebuffer),ue.viewport.set([0,0,t.tileSize,t.tileSize]),ue.clear({color:R.bf.transparent});const Fe=qe.programConfigurations.get(Z.id),Ve=se.useProgram("heatmap",Fe,!ie),Xe=se.transform.getProjectionData({overscaledTileID:t.tileID,applyGlobeMatrix:!0,applyTerrainMatrix:!0}),at=se.style.map.terrain.getTerrainData(Q);Ve.draw(ue,de.TRIANGLES,$r.disabled,ge,ve,ni.disabled,yl(t,se.transform.zoom,Z.paint.get("heatmap-intensity"),1),at,Xe,Z.id,qe.layoutVertexBuffer,qe.indexBuffer,qe.segments,Z.paint,se.transform.zoom,Fe)}function qs(se,t,Z,Q,ie){const ue=se.context,de=ue.gl,ge=se.transform;ue.setColorMode(se.colorModeForRenderPass());const ve=Ta(ue,t),qe=Z.key,Re=t.heatmapFbos.get(qe);if(!Re)return;ue.activeTexture.set(de.TEXTURE0),de.bindTexture(de.TEXTURE_2D,Re.colorAttachment.get()),ue.activeTexture.set(de.TEXTURE1),ve.bind(de.LINEAR,de.CLAMP_TO_EDGE);const Le=ge.getProjectionData({overscaledTileID:Z,applyTerrainMatrix:ie,applyGlobeMatrix:!Q});se.useProgram("heatmapTexture").draw(ue,de.TRIANGLES,$r.disabled,Xr.disabled,se.colorModeForRenderPass(),ni.disabled,Su(se,t,0,1),null,Le,t.id,se.rasterBoundsBuffer,se.quadTriangleIndexBuffer,se.rasterBoundsSegments,t.paint,ge.zoom),Re.destroy(),t.heatmapFbos.delete(qe)}function Co(se,t,Z){var Q,ie;const ue=se.gl,de=ue.createTexture();ue.bindTexture(ue.TEXTURE_2D,de),ue.texParameteri(ue.TEXTURE_2D,ue.TEXTURE_WRAP_S,ue.CLAMP_TO_EDGE),ue.texParameteri(ue.TEXTURE_2D,ue.TEXTURE_WRAP_T,ue.CLAMP_TO_EDGE),ue.texParameteri(ue.TEXTURE_2D,ue.TEXTURE_MIN_FILTER,ue.LINEAR),ue.texParameteri(ue.TEXTURE_2D,ue.TEXTURE_MAG_FILTER,ue.LINEAR);const ge=(Q=se.HALF_FLOAT)!==null&&Q!==void 0?Q:ue.UNSIGNED_BYTE,ve=(ie=se.RGBA16F)!==null&&ie!==void 0?ie:ue.RGBA;ue.texImage2D(ue.TEXTURE_2D,0,ve,t,Z,0,ue.RGBA,ge,null);const qe=se.createFramebuffer(t,Z,!1,!1);return qe.colorAttachment.set(de),qe}function Ta(se,t){return t.colorRampTexture||(t.colorRampTexture=new R.T(se,t.colorRamp,se.gl.RGBA)),t.colorRampTexture}function Ts(se,t,Z,Q,ie,ue,de,ge){let ve=256;if(ie.stepInterpolant){const qe=t.getSource().maxzoom,Re=de.canonical.z===qe?Math.ceil(1<<se.transform.maxZoom-de.canonical.z):1;ve=R.ah(R.c4(ue.maxLineLength/R.$*1024*Re),256,Z.maxTextureSize)}return ge.gradient=R.c5({expression:ie.gradientExpression(),evaluationKey:"lineProgress",resolution:ve,image:ge.gradient||void 0,clips:ue.lineClipsArray}),ge.texture?ge.texture.update(ge.gradient):ge.texture=new R.T(Z,ge.gradient,Q.RGBA),ge.version=ie.gradientVersion,ge.texture}function $c(se,t,Z,Q,ie){se.activeTexture.set(t.TEXTURE0),Z.imageAtlasTexture.bind(t.LINEAR,t.CLAMP_TO_EDGE),Q.updatePaintBuffers(ie)}function Mo(se,t,Z,Q,ie,ue){(ie||se.lineAtlas.dirty)&&(t.activeTexture.set(Z.TEXTURE0),se.lineAtlas.bind(t)),Q.updatePaintBuffers(ue)}function Wc(se,t,Z,Q,ie,ue,de){const ge=ue.gradients[ie.id];let ve=ge.texture;ie.gradientVersion!==ge.version&&(ve=Ts(se,t,Z,Q,ie,ue,de,ge)),Z.activeTexture.set(Q.TEXTURE0),ve.bind(ie.stepInterpolant?Q.NEAREST:Q.LINEAR,Q.CLAMP_TO_EDGE)}function zu(se,t,Z,Q,ie,ue,de,ge,ve){const qe=ue.gradients[ie.id];let Re=qe.texture;ie.gradientVersion!==qe.version&&(Re=Ts(se,t,Z,Q,ie,ue,de,qe)),Z.activeTexture.set(Q.TEXTURE0),Re.bind(ie.stepInterpolant?Q.NEAREST:Q.LINEAR,Q.CLAMP_TO_EDGE),Z.activeTexture.set(Q.TEXTURE1),se.lineAtlas.bind(Z),ge.updatePaintBuffers(ve)}function Do(se,t,Z,Q,ie){if(!Z||!Q||!Q.imageAtlas)return;const ue=Q.imageAtlas.patternPositions;let de=ue[Z.to.toString()],ge=ue[Z.from.toString()];if(!de&&ge&&(de=ge),!ge&&de&&(ge=de),!de||!ge){const ve=ie.getPaintProperty(t);de=ue[ve],ge=ue[ve]}de&&ge&&se.setConstantPatternPositions(de,ge)}function Is(se,t,Z,Q,ie,ue,de,ge){const ve=se.context.gl,qe="fill-pattern",Re=Z.paint.get(qe),Le=Re&&Re.constantOr(1),Fe=Z.getCrossfadeParameters();let Ve,Xe,at,ot,lt;const pt=se.transform,yt=Z.paint.get("fill-translate"),mt=Z.paint.get("fill-translate-anchor");de?(Xe=Le&&!Z.getPaintProperty("fill-outline-color")?"fillOutlinePattern":"fillOutline",Ve=ve.LINES):(Xe=Le?"fillPattern":"fill",Ve=ve.TRIANGLES);const xt=Re.constantOr(null);for(const It of Q){const gt=t.getTile(It);if(Le&&!gt.patternsLoaded())continue;const Ot=gt.getBucket(Z);if(!Ot)continue;const zt=Ot.programConfigurations.get(Z.id),kt=se.useProgram(Xe,zt),Bt=se.style.map.terrain&&se.style.map.terrain.getTerrainData(It);Le&&(se.context.activeTexture.set(ve.TEXTURE0),gt.imageAtlasTexture.bind(ve.LINEAR,ve.CLAMP_TO_EDGE),zt.updatePaintBuffers(Fe)),Do(zt,qe,xt,gt,Z);const Nt=pt.getProjectionData({overscaledTileID:It,applyGlobeMatrix:!ge,applyTerrainMatrix:!0}),ar=R.aD(pt,gt,yt,mt);if(de){ot=Ot.indexBuffer2,lt=Ot.segments2;const Kt=[ve.drawingBufferWidth,ve.drawingBufferHeight];at=Xe==="fillOutlinePattern"&&Le?Dc(se,Fe,gt,Kt,ar):To(Kt,ar)}else ot=Ot.indexBuffer,lt=Ot.segments,at=Le?Ha(se,Fe,gt,ar):{u_fill_translate:ar};const sr=se.stencilModeForClipping(It);kt.draw(se.context,Ve,ie,sr,ue,ni.backCCW,at,Bt,Nt,Z.id,Ot.layoutVertexBuffer,ot,lt,Z.paint,se.transform.zoom,zt)}}function Rs(se,t,Z,Q,ie,ue,de,ge){const ve=se.context,qe=ve.gl,Re="fill-extrusion-pattern",Le=Z.paint.get(Re),Fe=Le.constantOr(1),Ve=Z.getCrossfadeParameters(),Xe=Z.paint.get("fill-extrusion-opacity"),at=Le.constantOr(null),ot=se.transform;for(const lt of Q){const pt=t.getTile(lt),yt=pt.getBucket(Z);if(!yt)continue;const mt=se.style.map.terrain&&se.style.map.terrain.getTerrainData(lt),xt=yt.programConfigurations.get(Z.id),It=se.useProgram(Fe?"fillExtrusionPattern":"fillExtrusion",xt);Fe&&(se.context.activeTexture.set(qe.TEXTURE0),pt.imageAtlasTexture.bind(qe.LINEAR,qe.CLAMP_TO_EDGE),xt.updatePaintBuffers(Ve));const gt=ot.getProjectionData({overscaledTileID:lt,applyGlobeMatrix:!ge,applyTerrainMatrix:!0});Do(xt,Re,at,pt,Z);const Ot=R.aD(ot,pt,Z.paint.get("fill-extrusion-translate"),Z.paint.get("fill-extrusion-translate-anchor")),zt=Z.paint.get("fill-extrusion-vertical-gradient"),kt=Fe?ml(se,zt,Xe,Ot,lt,Ve,pt):xu(se,zt,Xe,Ot);It.draw(ve,ve.gl.TRIANGLES,ie,ue,de,ni.backCCW,kt,mt,gt,Z.id,yt.layoutVertexBuffer,yt.indexBuffer,yt.segments,Z.paint,se.transform.zoom,xt,se.style.map.terrain&&yt.centroidVertexBuffer)}}function As(se,t,Z,Q,ie,ue,de,ge,ve){var qe;const Re=se.style.projection,Le=se.context,Fe=se.transform,Ve=Le.gl,Xe=[`#define NUM_ILLUMINATION_SOURCES ${Z.paint.get("hillshade-highlight-color").values.length}`],at=se.useProgram("hillshade",null,!1,Xe),ot=!se.options.moving;for(const lt of Q){const pt=t.getTile(lt),yt=pt.fbo;if(!yt)continue;const mt=Re.getMeshFromTileID(Le,lt.canonical,ge,!0,"raster"),xt=(qe=se.style.map.terrain)===null||qe===void 0?void 0:qe.getTerrainData(lt);Le.activeTexture.set(Ve.TEXTURE0),Ve.bindTexture(Ve.TEXTURE_2D,yt.colorAttachment.get());const It=Fe.getProjectionData({overscaledTileID:lt,aligned:ot,applyGlobeMatrix:!ve,applyTerrainMatrix:!0});at.draw(Le,Ve.TRIANGLES,ue,ie[lt.overscaledZ],de,ni.backCCW,Eu(se,pt,Z),xt,It,Z.id,mt.vertexBuffer,mt.indexBuffer,mt.segments)}}function Ja(se,t,Z,Q,ie,ue,de,ge,ve){var qe;const Re=se.style.projection,Le=se.context,Fe=se.transform,Ve=Le.gl,Xe=se.useProgram("colorRelief"),at=!se.options.moving;let ot=!0,lt=0;for(const pt of Q){const yt=t.getTile(pt),mt=yt.dem;if(ot){const kt=Ve.getParameter(Ve.MAX_TEXTURE_SIZE),{elevationTexture:Bt,colorTexture:Nt}=Z.getColorRampTextures(Le,kt,mt.getUnpackVector());Le.activeTexture.set(Ve.TEXTURE1),Bt.bind(Ve.NEAREST,Ve.CLAMP_TO_EDGE),Le.activeTexture.set(Ve.TEXTURE4),Nt.bind(Ve.LINEAR,Ve.CLAMP_TO_EDGE),ot=!1,lt=Bt.size[0]}if(!mt||!mt.data)continue;const xt=mt.stride,It=mt.getPixels();if(Le.activeTexture.set(Ve.TEXTURE0),Le.pixelStoreUnpackPremultiplyAlpha.set(!1),yt.demTexture=yt.demTexture||se.getTileTexture(xt),yt.demTexture){const kt=yt.demTexture;kt.update(It,{premultiply:!1}),kt.bind(Ve.LINEAR,Ve.CLAMP_TO_EDGE)}else yt.demTexture=new R.T(Le,It,Ve.RGBA,{premultiply:!1}),yt.demTexture.bind(Ve.LINEAR,Ve.CLAMP_TO_EDGE);const gt=Re.getMeshFromTileID(Le,pt.canonical,ge,!0,"raster"),Ot=(qe=se.style.map.terrain)===null||qe===void 0?void 0:qe.getTerrainData(pt),zt=Fe.getProjectionData({overscaledTileID:pt,aligned:at,applyGlobeMatrix:!ve,applyTerrainMatrix:!0});Xe.draw(Le,Ve.TRIANGLES,ue,ie[pt.overscaledZ],de,ni.backCCW,Tu(Z,yt.dem,lt),Ot,zt,Z.id,gt.vertexBuffer,gt.indexBuffer,gt.segments)}}const Fo=[new R.P(0,0),new R.P(R.$,0),new R.P(R.$,R.$),new R.P(0,R.$)];function Ps(se,t,Z,Q,ie,ue,de,ge,ve=!1,qe=!1){const Re=Q[Q.length-1].overscaledZ,Le=se.context,Fe=Le.gl,Ve=se.useProgram("raster"),Xe=se.transform,at=se.style.projection,ot=se.colorModeForRenderPass(),lt=!se.options.moving,pt=Z.paint.get("raster-opacity"),yt=Z.paint.get("raster-resampling"),mt=Z.paint.get("raster-fade-duration"),xt=!!se.style.map.terrain;for(const It of Q){const gt=se.getDepthModeForSublayer(It.overscaledZ-Re,pt===1?$r.ReadWrite:$r.ReadOnly,Fe.LESS),Ot=t.getTile(It),zt=yt==="nearest"?Fe.NEAREST:Fe.LINEAR;Le.activeTexture.set(Fe.TEXTURE0),Ot.texture.bind(zt,Fe.CLAMP_TO_EDGE,Fe.LINEAR_MIPMAP_NEAREST),Le.activeTexture.set(Fe.TEXTURE1);const{parentTile:kt,parentScaleBy:Bt,parentTopLeft:Nt,fadeValues:ar}=Uu(Ot,t,mt,xt);Ot.fadeOpacity=ar.tileOpacity,kt?(kt.fadeOpacity=ar.parentTileOpacity,kt.texture.bind(zt,Fe.CLAMP_TO_EDGE,Fe.LINEAR_MIPMAP_NEAREST)):Ot.texture.bind(zt,Fe.CLAMP_TO_EDGE,Fe.LINEAR_MIPMAP_NEAREST),Ot.texture.useMipmap&&Le.extTextureFilterAnisotropic&&se.transform.pitch>20&&Fe.texParameterf(Fe.TEXTURE_2D,Le.extTextureFilterAnisotropic.TEXTURE_MAX_ANISOTROPY_EXT,Le.extTextureFilterAnisotropicMax);const sr=se.style.map.terrain&&se.style.map.terrain.getTerrainData(It),Kt=Xe.getProjectionData({overscaledTileID:It,aligned:lt,applyGlobeMatrix:!qe,applyTerrainMatrix:!0}),Tr=us(Nt,Bt,ar.fadeMix,Z,ge),Wr=at.getMeshFromTileID(Le,It.canonical,ue,de,"raster");Ve.draw(Le,Fe.TRIANGLES,gt,ie?ie[It.overscaledZ]:Xr.disabled,ot,ve?ni.frontCCW:ni.backCCW,Tr,sr,Kt,Z.id,Wr.vertexBuffer,Wr.indexBuffer,Wr.segments)}}function Uu(se,t,Z,Q){const ie={parentTile:null,parentScaleBy:1,parentTopLeft:[0,0],fadeValues:{tileOpacity:1,parentTileOpacity:1,fadeMix:{opacity:1,mix:0}}};if(Z===0||Q)return ie;if(se.fadingParentID){const ue=t._getLoadedTile(se.fadingParentID);if(!ue)return ie;const de=Math.pow(2,ue.tileID.overscaledZ-se.tileID.overscaledZ),ge=[se.tileID.canonical.x*de%1,se.tileID.canonical.y*de%1],ve=(function(qe,Re,Le){const Fe=_e.now(),Ve=(Fe-Re.timeAdded)/Le,Xe=qe.fadingDirection===Se.Incoming,at=R.ah((Fe-qe.timeAdded)/Le,0,1),ot=R.ah(1-Ve,0,1),lt=Xe?at:ot;return{tileOpacity:lt,parentTileOpacity:Xe?ot:at,fadeMix:{opacity:1,mix:1-lt}}})(se,ue,Z);return{parentTile:ue,parentScaleBy:de,parentTopLeft:ge,fadeValues:ve}}if(se.selfFading){const ue=(function(de,ge){const ve=_e.now(),qe=R.ah((ve-de.timeAdded)/ge,0,1);return{tileOpacity:qe,fadeMix:{opacity:qe,mix:0}}})(se,Z);return{parentTile:null,parentScaleBy:1,parentTopLeft:[0,0],fadeValues:ue}}return ie}const Mi=new R.bf(1,0,0,1),Ia=new R.bf(0,1,0,1),On=new R.bf(0,0,1,1),Cl=new R.bf(1,0,1,1),Os=new R.bf(0,1,1,1);function Ml(se,t,Z,Q){Qa(se,0,t+Z/2,se.transform.width,Z,Q)}function Ra(se,t,Z,Q){Qa(se,t-Z/2,0,Z,se.transform.height,Q)}function Qa(se,t,Z,Q,ie,ue){const de=se.context,ge=de.gl;ge.enable(ge.SCISSOR_TEST),ge.scissor(t*se.pixelRatio,Z*se.pixelRatio,Q*se.pixelRatio,ie*se.pixelRatio),de.clear({color:ue}),ge.disable(ge.SCISSOR_TEST)}function ko(se,t,Z){const Q=se.context,ie=Q.gl,ue=se.useProgram("debug"),de=$r.disabled,ge=Xr.disabled,ve=se.colorModeForRenderPass(),qe="$debug",Re=se.style.map.terrain&&se.style.map.terrain.getTerrainData(Z);Q.activeTexture.set(ie.TEXTURE0);const Le=t.getTileByID(Z.key).latestRawTileData,Fe=Math.floor((Le&&Le.byteLength||0)/1024),Ve=t.getTile(Z).tileSize,Xe=512/Math.min(Ve,512)*(Z.overscaledZ/se.transform.zoom)*.5;let at=Z.canonical.toString();Z.overscaledZ!==Z.canonical.z&&(at+=` => ${Z.overscaledZ}`),(function(lt,pt){lt.initDebugOverlayCanvas();const yt=lt.debugOverlayCanvas,mt=lt.context.gl,xt=lt.debugOverlayCanvas.getContext("2d");xt.clearRect(0,0,yt.width,yt.height),xt.shadowColor="white",xt.shadowBlur=2,xt.lineWidth=1.5,xt.strokeStyle="white",xt.textBaseline="top",xt.font="bold 36px Open Sans, sans-serif",xt.fillText(pt,5,5),xt.strokeText(pt,5,5),lt.debugOverlayTexture.update(yt),lt.debugOverlayTexture.bind(mt.LINEAR,mt.CLAMP_TO_EDGE)})(se,`${at} ${Fe}kB`);const ot=se.transform.getProjectionData({overscaledTileID:Z,applyGlobeMatrix:!0,applyTerrainMatrix:!0});ue.draw(Q,ie.TRIANGLES,de,ge,pi.alphaBlended,ni.disabled,wu(R.bf.transparent,Xe),null,ot,qe,se.debugBuffer,se.quadTriangleIndexBuffer,se.debugSegments),ue.draw(Q,ie.LINE_STRIP,de,ge,ve,ni.disabled,wu(R.bf.red),Re,ot,qe,se.debugBuffer,se.tileBorderIndexBuffer,se.debugSegments)}function Cs(se,t,Z,Q){const{isRenderingGlobe:ie}=Q,ue=se.context,de=ue.gl,ge=se.transform,ve=se.colorModeForRenderPass(),qe=se.getDepthModeFor3D(),Re=se.useProgram("terrain");ue.bindFramebuffer.set(null),ue.viewport.set([0,0,se.width,se.height]);for(const Le of Z){const Fe=t.getTerrainMesh(Le.tileID),Ve=se.renderToTexture.getTexture(Le),Xe=t.getTerrainData(Le.tileID);ue.activeTexture.set(de.TEXTURE0),de.bindTexture(de.TEXTURE_2D,Ve.texture);const at=t.getMeshFrameDelta(ge.zoom),ot=ge.calculateFogMatrix(Le.tileID.toUnwrapped()),lt=pl(at,ot,se.style.sky,ge.pitch,ie),pt=ge.getProjectionData({overscaledTileID:Le.tileID,applyTerrainMatrix:!1,applyGlobeMatrix:!0});Re.draw(ue,de.TRIANGLES,qe,Xr.disabled,ve,ni.backCCW,lt,Xe,pt,"terrain",Fe.vertexBuffer,Fe.indexBuffer,Fe.segments)}}function Dl(se,t){if(!t.mesh){const Z=new R.aL;Z.emplaceBack(-1,-1),Z.emplaceBack(1,-1),Z.emplaceBack(1,1),Z.emplaceBack(-1,1);const Q=new R.aN;Q.emplaceBack(0,1,2),Q.emplaceBack(0,2,3),t.mesh=new ja(se.createVertexBuffer(Z,dn.members),se.createIndexBuffer(Q),R.aM.simpleSegment(0,0,Z.length,Q.length))}return t.mesh}class Vu{constructor(t,Z){this.context=new Vc(t),this.transform=Z,this._tileTextures={},this.terrainFacilitator={dirty:!0,matrix:R.ag(new Float64Array(16)),renderTime:0},this.setup(),this.numSublayers=cr.maxUnderzooming+cr.maxOverzooming+1,this.depthEpsilon=1/Math.pow(2,16),this.crossTileSymbolIndex=new mo}resize(t,Z,Q){if(this.width=Math.floor(t*Q),this.height=Math.floor(Z*Q),this.pixelRatio=Q,this.context.viewport.set([0,0,this.width,this.height]),this.style)for(const ie of this.style._order)this.style._layers[ie].resize()}setup(){const t=this.context,Z=new R.aL;Z.emplaceBack(0,0),Z.emplaceBack(R.$,0),Z.emplaceBack(0,R.$),Z.emplaceBack(R.$,R.$),this.tileExtentBuffer=t.createVertexBuffer(Z,dn.members),this.tileExtentSegments=R.aM.simpleSegment(0,0,4,2);const Q=new R.aL;Q.emplaceBack(0,0),Q.emplaceBack(R.$,0),Q.emplaceBack(0,R.$),Q.emplaceBack(R.$,R.$),this.debugBuffer=t.createVertexBuffer(Q,dn.members),this.debugSegments=R.aM.simpleSegment(0,0,4,5);const ie=new R.c7;ie.emplaceBack(0,0,0,0),ie.emplaceBack(R.$,0,R.$,0),ie.emplaceBack(0,R.$,0,R.$),ie.emplaceBack(R.$,R.$,R.$,R.$),this.rasterBoundsBuffer=t.createVertexBuffer(ie,Mc.members),this.rasterBoundsSegments=R.aM.simpleSegment(0,0,4,2);const ue=new R.aL;ue.emplaceBack(0,0),ue.emplaceBack(R.$,0),ue.emplaceBack(0,R.$),ue.emplaceBack(R.$,R.$),this.rasterBoundsBufferPosOnly=t.createVertexBuffer(ue,dn.members),this.rasterBoundsSegmentsPosOnly=R.aM.simpleSegment(0,0,4,5);const de=new R.aL;de.emplaceBack(0,0),de.emplaceBack(1,0),de.emplaceBack(0,1),de.emplaceBack(1,1),this.viewportBuffer=t.createVertexBuffer(de,dn.members),this.viewportSegments=R.aM.simpleSegment(0,0,4,2);const ge=new R.c8;ge.emplaceBack(0),ge.emplaceBack(1),ge.emplaceBack(3),ge.emplaceBack(2),ge.emplaceBack(0),this.tileBorderIndexBuffer=t.createIndexBuffer(ge);const ve=new R.aN;ve.emplaceBack(1,0,2),ve.emplaceBack(1,2,3),this.quadTriangleIndexBuffer=t.createIndexBuffer(ve);const qe=this.context.gl;this.stencilClearMode=new Xr({func:qe.ALWAYS,mask:0},0,255,qe.ZERO,qe.ZERO,qe.ZERO),this.tileExtentMesh=new ja(this.tileExtentBuffer,this.quadTriangleIndexBuffer,this.tileExtentSegments)}clearStencil(){const t=this.context,Z=t.gl;this.nextStencilID=1,this.currentStencilSource=void 0;const Q=R.L();R.bZ(Q,0,this.width,this.height,0,0,1),R.N(Q,Q,[Z.drawingBufferWidth,Z.drawingBufferHeight,0]);const ie={mainMatrix:Q,tileMercatorCoords:[0,0,1,1],clippingPlane:[0,0,0,0],projectionTransition:0,fallbackMatrix:Q};this.useProgram("clippingMask",null,!0).draw(t,Z.TRIANGLES,$r.disabled,this.stencilClearMode,pi.disabled,ni.disabled,null,null,ie,"$clipping",this.viewportBuffer,this.quadTriangleIndexBuffer,this.viewportSegments)}_renderTileClippingMasks(t,Z,Q){if(this.currentStencilSource===t.source||!t.isTileClipped()||!Z||!Z.length)return;this.currentStencilSource=t.source,this.nextStencilID+Z.length>256&&this.clearStencil();const ie=this.context;ie.setColorMode(pi.disabled),ie.setDepthMode($r.disabled);const ue={};for(const de of Z)ue[de.key]=this.nextStencilID++;this._renderTileMasks(ue,Z,Q,!0),this._renderTileMasks(ue,Z,Q,!1),this._tileClippingMaskIDs=ue}_renderTileMasks(t,Z,Q,ie){const ue=this.context,de=ue.gl,ge=this.style.projection,ve=this.transform,qe=this.useProgram("clippingMask");for(const Re of Z){const Le=t[Re.key],Fe=this.style.map.terrain&&this.style.map.terrain.getTerrainData(Re),Ve=ge.getMeshFromTileID(this.context,Re.canonical,ie,!0,"stencil"),Xe=ve.getProjectionData({overscaledTileID:Re,applyGlobeMatrix:!Q,applyTerrainMatrix:!0});qe.draw(ue,de.TRIANGLES,$r.disabled,new Xr({func:de.ALWAYS,mask:0},Le,255,de.KEEP,de.KEEP,de.REPLACE),pi.disabled,Q?ni.disabled:ni.backCCW,null,Fe,Xe,"$clipping",Ve.vertexBuffer,Ve.indexBuffer,Ve.segments)}}_renderTilesDepthBuffer(){const t=this.context,Z=t.gl,Q=this.style.projection,ie=this.transform,ue=this.useProgram("depth"),de=this.getDepthModeFor3D(),ge=Er(ie,{tileSize:ie.tileSize});for(const ve of ge){const qe=this.style.map.terrain&&this.style.map.terrain.getTerrainData(ve),Re=Q.getMeshFromTileID(this.context,ve.canonical,!0,!0,"raster"),Le=ie.getProjectionData({overscaledTileID:ve,applyGlobeMatrix:!0,applyTerrainMatrix:!0});ue.draw(t,Z.TRIANGLES,de,Xr.disabled,pi.disabled,ni.backCCW,null,qe,Le,"$clipping",Re.vertexBuffer,Re.indexBuffer,Re.segments)}}stencilModeFor3D(){this.currentStencilSource=void 0,this.nextStencilID+1>256&&this.clearStencil();const t=this.nextStencilID++,Z=this.context.gl;return new Xr({func:Z.NOTEQUAL,mask:255},t,255,Z.KEEP,Z.KEEP,Z.REPLACE)}stencilModeForClipping(t){const Z=this.context.gl;return new Xr({func:Z.EQUAL,mask:255},this._tileClippingMaskIDs[t.key],0,Z.KEEP,Z.KEEP,Z.REPLACE)}getStencilConfigForOverlapAndUpdateStencilID(t){const Z=this.context.gl,Q=t.sort(((de,ge)=>ge.overscaledZ-de.overscaledZ)),ie=Q[Q.length-1].overscaledZ,ue=Q[0].overscaledZ-ie+1;if(ue>1){this.currentStencilSource=void 0,this.nextStencilID+ue>256&&this.clearStencil();const de={};for(let ge=0;ge<ue;ge++)de[ge+ie]=new Xr({func:Z.GEQUAL,mask:255},ge+this.nextStencilID,255,Z.KEEP,Z.KEEP,Z.REPLACE);return this.nextStencilID+=ue,[de,Q]}return[{[ie]:Xr.disabled},Q]}stencilConfigForOverlapTwoPass(t){const Z=this.context.gl,Q=t.sort(((de,ge)=>ge.overscaledZ-de.overscaledZ)),ie=Q[Q.length-1].overscaledZ,ue=Q[0].overscaledZ-ie+1;if(this.clearStencil(),ue>1){const de={},ge={};for(let ve=0;ve<ue;ve++)de[ve+ie]=new Xr({func:Z.GREATER,mask:255},ue+1+ve,255,Z.KEEP,Z.KEEP,Z.REPLACE),ge[ve+ie]=new Xr({func:Z.GREATER,mask:255},1+ve,255,Z.KEEP,Z.KEEP,Z.REPLACE);return this.nextStencilID=2*ue+1,[de,ge,Q]}return this.nextStencilID=3,[{[ie]:new Xr({func:Z.GREATER,mask:255},2,255,Z.KEEP,Z.KEEP,Z.REPLACE)},{[ie]:new Xr({func:Z.GREATER,mask:255},1,255,Z.KEEP,Z.KEEP,Z.REPLACE)},Q]}colorModeForRenderPass(){const t=this.context.gl;return this._showOverdrawInspector?new pi([t.CONSTANT_COLOR,t.ONE],new R.bf(.125,.125,.125,0),[!0,!0,!0,!0]):this.renderPass==="opaque"?pi.unblended:pi.alphaBlended}getDepthModeForSublayer(t,Z,Q){if(!this.opaquePassEnabledForLayer())return $r.disabled;const ie=1-((1+this.currentLayer)*this.numSublayers+t)*this.depthEpsilon;return new $r(Q||this.context.gl.LEQUAL,Z,[ie,ie])}getDepthModeFor3D(){return new $r(this.context.gl.LEQUAL,$r.ReadWrite,this.depthRangeFor3D)}opaquePassEnabledForLayer(){return this.currentLayer<this.opaquePassCutoff}render(t,Z){var Q,ie;this.style=t,this.options=Z,this.lineAtlas=t.lineAtlas,this.imageManager=t.imageManager,this.glyphManager=t.glyphManager,this.symbolFadeChange=t.placement.symbolFadeChange(_e.now()),this.imageManager.beginFrame();const ue=this.style._order,de=this.style.sourceCaches,ge={},ve={},qe={},Re={isRenderingToTexture:!1,isRenderingGlobe:((Q=t.projection)===null||Q===void 0?void 0:Q.transitionState)>0};for(const Fe in de){const Ve=de[Fe];Ve.used&&Ve.prepare(this.context),ge[Fe]=Ve.getVisibleCoordinates(!1),ve[Fe]=ge[Fe].slice().reverse(),qe[Fe]=Ve.getVisibleCoordinates(!0).reverse()}this.opaquePassCutoff=1/0;for(let Fe=0;Fe<ue.length;Fe++)if(this.style._layers[ue[Fe]].is3D()){this.opaquePassCutoff=Fe;break}this.maybeDrawDepthAndCoords(!1),this.renderToTexture&&(this.renderToTexture.prepareForRender(this.style,this.transform.zoom),this.opaquePassCutoff=0),this.renderPass="offscreen";for(const Fe of ue){const Ve=this.style._layers[Fe];if(!Ve.hasOffscreenPass()||Ve.isHidden(this.transform.zoom))continue;const Xe=ve[Ve.source];(Ve.type==="custom"||Xe.length)&&this.renderLayer(this,de[Ve.source],Ve,Xe,Re)}if((ie=this.style.projection)===null||ie===void 0||ie.updateGPUdependent({context:this.context,useProgram:Fe=>this.useProgram(Fe)}),this.context.viewport.set([0,0,this.width,this.height]),this.context.bindFramebuffer.set(null),this.context.clear({color:Z.showOverdrawInspector?R.bf.black:R.bf.transparent,depth:1}),this.clearStencil(),this.style.sky&&(function(Fe,Ve){const Xe=Fe.context,at=Xe.gl,ot=((It,gt,Ot)=>{const zt=Math.cos(gt.rollInRadians),kt=Math.sin(gt.rollInRadians),Bt=He(gt),Nt=gt.getProjectionData({overscaledTileID:null,applyGlobeMatrix:!0,applyTerrainMatrix:!0}).projectionTransition;return{u_sky_color:It.properties.get("sky-color"),u_horizon_color:It.properties.get("horizon-color"),u_horizon:[(gt.width/2-Bt*kt)*Ot,(gt.height/2+Bt*zt)*Ot],u_horizon_normal:[-kt,zt],u_sky_horizon_blend:It.properties.get("sky-horizon-blend")*gt.height/2*Ot,u_sky_blend:Nt}})(Ve,Fe.style.map.transform,Fe.pixelRatio),lt=new $r(at.LEQUAL,$r.ReadWrite,[0,1]),pt=Xr.disabled,yt=Fe.colorModeForRenderPass(),mt=Fe.useProgram("sky"),xt=Dl(Xe,Ve);mt.draw(Xe,at.TRIANGLES,lt,pt,yt,ni.disabled,ot,null,void 0,"sky",xt.vertexBuffer,xt.indexBuffer,xt.segments)})(this,this.style.sky),this._showOverdrawInspector=Z.showOverdrawInspector,this.depthRangeFor3D=[0,1-(t._order.length+2)*this.numSublayers*this.depthEpsilon],!this.renderToTexture)for(this.renderPass="opaque",this.currentLayer=ue.length-1;this.currentLayer>=0;this.currentLayer--){const Fe=this.style._layers[ue[this.currentLayer]],Ve=de[Fe.source],Xe=ge[Fe.source];this._renderTileClippingMasks(Fe,Xe,!1),this.renderLayer(this,Ve,Fe,Xe,Re)}this.renderPass="translucent";let Le=!1;for(this.currentLayer=0;this.currentLayer<ue.length;this.currentLayer++){const Fe=this.style._layers[ue[this.currentLayer]],Ve=de[Fe.source];if(this.renderToTexture&&this.renderToTexture.renderLayer(Fe,Re))continue;this.opaquePassEnabledForLayer()||Le||(Le=!0,Re.isRenderingGlobe&&!this.style.map.terrain&&this._renderTilesDepthBuffer());const Xe=(Fe.type==="symbol"?qe:ve)[Fe.source];this._renderTileClippingMasks(Fe,ge[Fe.source],!!this.renderToTexture),this.renderLayer(this,Ve,Fe,Xe,Re)}if(Re.isRenderingGlobe&&(function(Fe,Ve,Xe){const at=Fe.context,ot=at.gl,lt=Fe.useProgram("atmosphere"),pt=new $r(ot.LEQUAL,$r.ReadOnly,[0,1]),yt=Fe.transform,mt=(function(Nt,ar){const sr=Nt.properties.get("position"),Kt=[-sr.x,-sr.y,-sr.z],Tr=R.ag(new Float64Array(16));return Nt.properties.get("anchor")==="map"&&(R.b6(Tr,Tr,ar.rollInRadians),R.b7(Tr,Tr,-ar.pitchInRadians),R.b6(Tr,Tr,ar.bearingInRadians),R.b7(Tr,Tr,ar.center.lat*Math.PI/180),R.bz(Tr,Tr,-ar.center.lng*Math.PI/180)),R.c6(Kt,Kt,Tr),Kt})(Xe,Fe.transform),xt=yt.getProjectionData({overscaledTileID:null,applyGlobeMatrix:!0,applyTerrainMatrix:!0}),It=Ve.properties.get("atmosphere-blend")*xt.projectionTransition;if(It===0)return;const gt=ba(yt.worldSize,yt.center.lat),Ot=yt.inverseProjectionMatrix,zt=new Float64Array(4);zt[3]=1,R.aw(zt,zt,yt.modelViewProjectionMatrix),zt[0]/=zt[3],zt[1]/=zt[3],zt[2]/=zt[3],zt[3]=1,R.aw(zt,zt,Ot),zt[0]/=zt[3],zt[1]/=zt[3],zt[2]/=zt[3],zt[3]=1;const kt=((Nt,ar,sr,Kt,Tr)=>({u_sun_pos:Nt,u_atmosphere_blend:ar,u_globe_position:sr,u_globe_radius:Kt,u_inv_proj_matrix:Tr}))(mt,It,[zt[0],zt[1],zt[2]],gt,Ot),Bt=Dl(at,Ve);lt.draw(at,ot.TRIANGLES,pt,Xr.disabled,pi.alphaBlended,ni.disabled,kt,null,null,"atmosphere",Bt.vertexBuffer,Bt.indexBuffer,Bt.segments)})(this,this.style.sky,this.style.light),this.options.showTileBoundaries){const Fe=(function(Ve,Xe){let at=null;const ot=Object.values(Ve._layers).flatMap((mt=>mt.source&&!mt.isHidden(Xe)?[Ve.sourceCaches[mt.source]]:[])),lt=ot.filter((mt=>mt.getSource().type==="vector")),pt=ot.filter((mt=>mt.getSource().type!=="vector")),yt=mt=>{(!at||at.getSource().maxzoom<mt.getSource().maxzoom)&&(at=mt)};return lt.forEach((mt=>yt(mt))),at||pt.forEach((mt=>yt(mt))),at})(this.style,this.transform.zoom);Fe&&(function(Ve,Xe,at){for(let ot=0;ot<at.length;ot++)ko(Ve,Xe,at[ot])})(this,Fe,Fe.getVisibleCoordinates())}this.options.showPadding&&(function(Fe){const Ve=Fe.transform.padding;Ml(Fe,Fe.transform.height-(Ve.top||0),3,Mi),Ml(Fe,Ve.bottom||0,3,Ia),Ra(Fe,Ve.left||0,3,On),Ra(Fe,Fe.transform.width-(Ve.right||0),3,Cl);const Xe=Fe.transform.centerPoint;(function(at,ot,lt,pt){Qa(at,ot-1,lt-10,2,20,pt),Qa(at,ot-10,lt-1,20,2,pt)})(Fe,Xe.x,Fe.transform.height-Xe.y,Os)})(this),this.context.setDefault()}maybeDrawDepthAndCoords(t){if(!this.style||!this.style.map||!this.style.map.terrain)return;const Z=this.terrainFacilitator.matrix,Q=this.transform.modelViewProjectionMatrix;let ie=this.terrainFacilitator.dirty;ie||(ie=t?!R.c9(Z,Q):!R.ca(Z,Q)),ie||(ie=this.style.map.terrain.sourceCache.anyTilesAfterTime(this.terrainFacilitator.renderTime)),ie&&(R.cb(Z,Q),this.terrainFacilitator.renderTime=Date.now(),this.terrainFacilitator.dirty=!1,(function(ue,de){const ge=ue.context,ve=ge.gl,qe=ue.transform,Re=pi.unblended,Le=new $r(ve.LEQUAL,$r.ReadWrite,[0,1]),Fe=de.sourceCache.getRenderableTiles(),Ve=ue.useProgram("terrainDepth");ge.bindFramebuffer.set(de.getFramebuffer("depth").framebuffer),ge.viewport.set([0,0,ue.width/devicePixelRatio,ue.height/devicePixelRatio]),ge.clear({color:R.bf.transparent,depth:1});for(const Xe of Fe){const at=de.getTerrainMesh(Xe.tileID),ot=de.getTerrainData(Xe.tileID),lt=qe.getProjectionData({overscaledTileID:Xe.tileID,applyTerrainMatrix:!1,applyGlobeMatrix:!0}),pt={u_ele_delta:de.getMeshFrameDelta(qe.zoom)};Ve.draw(ge,ve.TRIANGLES,Le,Xr.disabled,Re,ni.backCCW,pt,ot,lt,"terrain",at.vertexBuffer,at.indexBuffer,at.segments)}ge.bindFramebuffer.set(null),ge.viewport.set([0,0,ue.width,ue.height])})(this,this.style.map.terrain),(function(ue,de){const ge=ue.context,ve=ge.gl,qe=ue.transform,Re=pi.unblended,Le=new $r(ve.LEQUAL,$r.ReadWrite,[0,1]),Fe=de.getCoordsTexture(),Ve=de.sourceCache.getRenderableTiles(),Xe=ue.useProgram("terrainCoords");ge.bindFramebuffer.set(de.getFramebuffer("coords").framebuffer),ge.viewport.set([0,0,ue.width/devicePixelRatio,ue.height/devicePixelRatio]),ge.clear({color:R.bf.transparent,depth:1}),de.coordsIndex=[];for(const at of Ve){const ot=de.getTerrainMesh(at.tileID),lt=de.getTerrainData(at.tileID);ge.activeTexture.set(ve.TEXTURE0),ve.bindTexture(ve.TEXTURE_2D,Fe.texture);const pt={u_terrain_coords_id:(255-de.coordsIndex.length)/255,u_texture:0,u_ele_delta:de.getMeshFrameDelta(qe.zoom)},yt=qe.getProjectionData({overscaledTileID:at.tileID,applyTerrainMatrix:!1,applyGlobeMatrix:!0});Xe.draw(ge,ve.TRIANGLES,Le,Xr.disabled,Re,ni.backCCW,pt,lt,yt,"terrain",ot.vertexBuffer,ot.indexBuffer,ot.segments),de.coordsIndex.push(at.tileID.key)}ge.bindFramebuffer.set(null),ge.viewport.set([0,0,ue.width,ue.height])})(this,this.style.map.terrain))}renderLayer(t,Z,Q,ie,ue){Q.isHidden(this.transform.zoom)||(Q.type==="background"||Q.type==="custom"||(ie||[]).length)&&(this.id=Q.id,R.cc(Q)?(function(de,ge,ve,qe,Re,Le){if(de.renderPass!=="translucent")return;const{isRenderingToTexture:Fe}=Le,Ve=Xr.disabled,Xe=de.colorModeForRenderPass();(ve._unevaluatedLayout.hasValue("text-variable-anchor")||ve._unevaluatedLayout.hasValue("text-variable-anchor-offset"))&&(function(at,ot,lt,pt,yt,mt,xt,It,gt){const Ot=ot.transform,zt=ot.style.map.terrain,kt=yt==="map",Bt=mt==="map";for(const Nt of at){const ar=pt.getTile(Nt),sr=ar.getBucket(lt);if(!sr||!sr.text||!sr.text.segments.get().length)continue;const Kt=R.an(sr.textSizeData,Ot.zoom),Tr=R.aC(ar,1,ot.transform.zoom),Wr=Jr(kt,ot.transform,Tr),hi=lt.layout.get("icon-text-fit")!=="none"&&sr.hasIconData();if(Kt){const di=Math.pow(2,Ot.zoom-ar.tileID.overscaledZ),_i=zt?(Ri,gi)=>zt.getElevation(Nt,Ri,gi):null;xs(sr,kt,Bt,gt,Ot,Wr,di,Kt,hi,R.aD(Ot,ar,xt,It),Nt.toUnwrapped(),_i)}}})(qe,de,ve,ge,ve.layout.get("text-rotation-alignment"),ve.layout.get("text-pitch-alignment"),ve.paint.get("text-translate"),ve.paint.get("text-translate-anchor"),Re),ve.paint.get("icon-opacity").constantOr(1)!==0&&Ss(de,ge,ve,qe,!1,ve.paint.get("icon-translate"),ve.paint.get("icon-translate-anchor"),ve.layout.get("icon-rotation-alignment"),ve.layout.get("icon-pitch-alignment"),ve.layout.get("icon-keep-upright"),Ve,Xe,Fe),ve.paint.get("text-opacity").constantOr(1)!==0&&Ss(de,ge,ve,qe,!0,ve.paint.get("text-translate"),ve.paint.get("text-translate-anchor"),ve.layout.get("text-rotation-alignment"),ve.layout.get("text-pitch-alignment"),ve.layout.get("text-keep-upright"),Ve,Xe,Fe),ge.map.showCollisionBoxes&&(Al(de,ge,ve,qe,!0),Al(de,ge,ve,qe,!1))})(t,Z,Q,ie,this.style.placement.variableOffsets,ue):R.cd(Q)?(function(de,ge,ve,qe,Re){if(de.renderPass!=="translucent")return;const{isRenderingToTexture:Le}=Re,Fe=ve.paint.get("circle-opacity"),Ve=ve.paint.get("circle-stroke-width"),Xe=ve.paint.get("circle-stroke-opacity"),at=!ve.layout.get("circle-sort-key").isConstant();if(Fe.constantOr(1)===0&&(Ve.constantOr(1)===0||Xe.constantOr(1)===0))return;const ot=de.context,lt=ot.gl,pt=de.transform,yt=de.getDepthModeForSublayer(0,$r.ReadOnly),mt=Xr.disabled,xt=de.colorModeForRenderPass(),It=[],gt=pt.getCircleRadiusCorrection();for(let Ot=0;Ot<qe.length;Ot++){const zt=qe[Ot],kt=ge.getTile(zt),Bt=kt.getBucket(ve);if(!Bt)continue;const Nt=ve.paint.get("circle-translate"),ar=ve.paint.get("circle-translate-anchor"),sr=R.aD(pt,kt,Nt,ar),Kt=Bt.programConfigurations.get(ve.id),Tr=de.useProgram("circle",Kt),Wr=Bt.layoutVertexBuffer,hi=Bt.indexBuffer,di=de.style.map.terrain&&de.style.map.terrain.getTerrainData(zt),_i={programConfiguration:Kt,program:Tr,layoutVertexBuffer:Wr,indexBuffer:hi,uniformValues:ls(de,kt,ve,sr,gt),terrainData:di,projectionData:pt.getProjectionData({overscaledTileID:zt,applyGlobeMatrix:!Le,applyTerrainMatrix:!0})};if(at){const Ri=Bt.segments.get();for(const gi of Ri)It.push({segments:new R.aM([gi]),sortKey:gi.sortKey,state:_i})}else It.push({segments:Bt.segments,sortKey:0,state:_i})}at&&It.sort(((Ot,zt)=>Ot.sortKey-zt.sortKey));for(const Ot of It){const{programConfiguration:zt,program:kt,layoutVertexBuffer:Bt,indexBuffer:Nt,uniformValues:ar,terrainData:sr,projectionData:Kt}=Ot.state;kt.draw(ot,lt.TRIANGLES,yt,mt,xt,ni.backCCW,ar,sr,Kt,ve.id,Bt,Nt,Ot.segments,ve.paint,de.transform.zoom,zt)}})(t,Z,Q,ie,ue):R.ce(Q)?(function(de,ge,ve,qe,Re){if(ve.paint.get("heatmap-opacity")===0)return;const Le=de.context,{isRenderingToTexture:Fe,isRenderingGlobe:Ve}=Re;if(de.style.map.terrain){for(const Xe of qe){const at=ge.getTile(Xe);ge.hasRenderableParent(Xe)||(de.renderPass==="offscreen"?Es(de,at,ve,Xe,Ve):de.renderPass==="translucent"&&qs(de,ve,Xe,Fe,Ve))}Le.viewport.set([0,0,de.width,de.height])}else de.renderPass==="offscreen"?(function(Xe,at,ot,lt){const pt=Xe.context,yt=pt.gl,mt=Xe.transform,xt=Xr.disabled,It=new pi([yt.ONE,yt.ONE],R.bf.transparent,[!0,!0,!0,!0]);(function(gt,Ot,zt){const kt=gt.gl;gt.activeTexture.set(kt.TEXTURE1),gt.viewport.set([0,0,Ot.width/4,Ot.height/4]);let Bt=zt.heatmapFbos.get(R.c3);Bt?(kt.bindTexture(kt.TEXTURE_2D,Bt.colorAttachment.get()),gt.bindFramebuffer.set(Bt.framebuffer)):(Bt=Co(gt,Ot.width/4,Ot.height/4),zt.heatmapFbos.set(R.c3,Bt))})(pt,Xe,ot),pt.clear({color:R.bf.transparent});for(let gt=0;gt<lt.length;gt++){const Ot=lt[gt];if(at.hasRenderableParent(Ot))continue;const zt=at.getTile(Ot),kt=zt.getBucket(ot);if(!kt)continue;const Bt=kt.programConfigurations.get(ot.id),Nt=Xe.useProgram("heatmap",Bt),ar=mt.getProjectionData({overscaledTileID:Ot,applyGlobeMatrix:!0,applyTerrainMatrix:!1}),sr=mt.getCircleRadiusCorrection();Nt.draw(pt,yt.TRIANGLES,$r.disabled,xt,It,ni.backCCW,yl(zt,mt.zoom,ot.paint.get("heatmap-intensity"),sr),null,ar,ot.id,kt.layoutVertexBuffer,kt.indexBuffer,kt.segments,ot.paint,mt.zoom,Bt)}pt.viewport.set([0,0,Xe.width,Xe.height])})(de,ge,ve,qe):de.renderPass==="translucent"&&(function(Xe,at){const ot=Xe.context,lt=ot.gl;ot.setColorMode(Xe.colorModeForRenderPass());const pt=at.heatmapFbos.get(R.c3);pt&&(ot.activeTexture.set(lt.TEXTURE0),lt.bindTexture(lt.TEXTURE_2D,pt.colorAttachment.get()),ot.activeTexture.set(lt.TEXTURE1),Ta(ot,at).bind(lt.LINEAR,lt.CLAMP_TO_EDGE),Xe.useProgram("heatmapTexture").draw(ot,lt.TRIANGLES,$r.disabled,Xr.disabled,Xe.colorModeForRenderPass(),ni.disabled,Su(Xe,at,0,1),null,null,at.id,Xe.viewportBuffer,Xe.quadTriangleIndexBuffer,Xe.viewportSegments,at.paint,Xe.transform.zoom))})(de,ve)})(t,Z,Q,ie,ue):R.cf(Q)?(function(de,ge,ve,qe,Re){if(de.renderPass!=="translucent")return;const{isRenderingToTexture:Le}=Re,Fe=ve.paint.get("line-opacity"),Ve=ve.paint.get("line-width");if(Fe.constantOr(1)===0||Ve.constantOr(1)===0)return;const Xe=de.getDepthModeForSublayer(0,$r.ReadOnly),at=de.colorModeForRenderPass(),ot=ve.paint.get("line-dasharray"),lt=ot.constantOr(1),pt=ve.paint.get("line-pattern"),yt=pt.constantOr(1),mt=ve.paint.get("line-gradient"),xt=ve.getCrossfadeParameters();let It;It=yt?"linePattern":lt&&mt?"lineGradientSDF":lt?"lineSDF":mt?"lineGradient":"line";const gt=de.context,Ot=gt.gl,zt=de.transform;let kt=!0;for(const Bt of qe){const Nt=ge.getTile(Bt);if(yt&&!Nt.patternsLoaded())continue;const ar=Nt.getBucket(ve);if(!ar)continue;const sr=ar.programConfigurations.get(ve.id),Kt=de.context.program.get(),Tr=de.useProgram(It,sr),Wr=kt||Tr.program!==Kt,hi=de.style.map.terrain&&de.style.map.terrain.getTerrainData(Bt),di=pt.constantOr(null),_i=ot&&ot.constantOr(null);if(di&&Nt.imageAtlas){const rn=Nt.imageAtlas,ki=rn.patternPositions[di.to.toString()],Li=rn.patternPositions[di.from.toString()];ki&&Li&&sr.setConstantPatternPositions(ki,Li)}else if(_i){const rn=ve.layout.get("line-cap")==="round",ki=de.lineAtlas.getDash(_i.to,rn),Li=de.lineAtlas.getDash(_i.from,rn);sr.setConstantDashPositions(ki,Li)}const Ri=zt.getProjectionData({overscaledTileID:Bt,applyGlobeMatrix:!Le,applyTerrainMatrix:!0}),gi=zt.getPixelScale();let si;yt?(si=xa(de,Nt,ve,gi,xt),$c(gt,Ot,Nt,sr,xt)):lt&&mt?(si=Au(de,Nt,ve,gi,xt,ar.lineClipsArray.length),zu(de,ge,gt,Ot,ve,ar,Bt,sr,xt)):lt?(si=Ru(de,Nt,ve,gi,xt),Mo(de,gt,Ot,sr,Wr,xt)):mt?(si=Iu(de,Nt,ve,gi,ar.lineClipsArray.length),Wc(de,ge,gt,Ot,ve,ar,Bt)):si=Io(de,Nt,ve,gi);const Ei=de.stencilModeForClipping(Bt);Tr.draw(gt,Ot.TRIANGLES,Xe,Ei,at,ni.disabled,si,hi,Ri,ve.id,ar.layoutVertexBuffer,ar.indexBuffer,ar.segments,ve.paint,de.transform.zoom,sr,ar.layoutVertexBuffer2),kt=!1}})(t,Z,Q,ie,ue):R.cg(Q)?(function(de,ge,ve,qe,Re){const Le=ve.paint.get("fill-color"),Fe=ve.paint.get("fill-opacity");if(Fe.constantOr(1)===0)return;const{isRenderingToTexture:Ve}=Re,Xe=de.colorModeForRenderPass(),at=ve.paint.get("fill-pattern"),ot=de.opaquePassEnabledForLayer()&&!at.constantOr(1)&&Le.constantOr(R.bf.transparent).a===1&&Fe.constantOr(0)===1?"opaque":"translucent";if(de.renderPass===ot){const lt=de.getDepthModeForSublayer(1,de.renderPass==="opaque"?$r.ReadWrite:$r.ReadOnly);Is(de,ge,ve,qe,lt,Xe,!1,Ve)}if(de.renderPass==="translucent"&&ve.paint.get("fill-antialias")){const lt=de.getDepthModeForSublayer(ve.getPaintProperty("fill-outline-color")?2:0,$r.ReadOnly);Is(de,ge,ve,qe,lt,Xe,!0,Ve)}})(t,Z,Q,ie,ue):R.ch(Q)?(function(de,ge,ve,qe,Re){const Le=ve.paint.get("fill-extrusion-opacity");if(Le===0)return;const{isRenderingToTexture:Fe}=Re;if(de.renderPass==="translucent"){const Ve=new $r(de.context.gl.LEQUAL,$r.ReadWrite,de.depthRangeFor3D);if(Le!==1||ve.paint.get("fill-extrusion-pattern").constantOr(1))Rs(de,ge,ve,qe,Ve,Xr.disabled,pi.disabled,Fe),Rs(de,ge,ve,qe,Ve,de.stencilModeFor3D(),de.colorModeForRenderPass(),Fe);else{const Xe=de.colorModeForRenderPass();Rs(de,ge,ve,qe,Ve,Xr.disabled,Xe,Fe)}}})(t,Z,Q,ie,ue):R.ci(Q)?(function(de,ge,ve,qe,Re){if(de.renderPass!=="offscreen"&&de.renderPass!=="translucent")return;const{isRenderingToTexture:Le}=Re,Fe=de.context,Ve=de.style.projection.useSubdivision,Xe=de.getDepthModeForSublayer(0,$r.ReadOnly),at=de.colorModeForRenderPass();if(de.renderPass==="offscreen")(function(ot,lt,pt,yt,mt,xt,It){const gt=ot.context,Ot=gt.gl;for(const zt of pt){const kt=lt.getTile(zt),Bt=kt.dem;if(!Bt||!Bt.data||!kt.needsHillshadePrepare)continue;const Nt=Bt.dim,ar=Bt.stride,sr=Bt.getPixels();if(gt.activeTexture.set(Ot.TEXTURE1),gt.pixelStoreUnpackPremultiplyAlpha.set(!1),kt.demTexture=kt.demTexture||ot.getTileTexture(ar),kt.demTexture){const Tr=kt.demTexture;Tr.update(sr,{premultiply:!1}),Tr.bind(Ot.NEAREST,Ot.CLAMP_TO_EDGE)}else kt.demTexture=new R.T(gt,sr,Ot.RGBA,{premultiply:!1}),kt.demTexture.bind(Ot.NEAREST,Ot.CLAMP_TO_EDGE);gt.activeTexture.set(Ot.TEXTURE0);let Kt=kt.fbo;if(!Kt){const Tr=new R.T(gt,{width:Nt,height:Nt,data:null},Ot.RGBA);Tr.bind(Ot.LINEAR,Ot.CLAMP_TO_EDGE),Kt=kt.fbo=gt.createFramebuffer(Nt,Nt,!0,!1),Kt.colorAttachment.set(Tr.texture)}gt.bindFramebuffer.set(Kt.framebuffer),gt.viewport.set([0,0,Nt,Nt]),ot.useProgram("hillshadePrepare").draw(gt,Ot.TRIANGLES,mt,xt,It,ni.disabled,gl(kt.tileID,Bt),null,null,yt.id,ot.rasterBoundsBuffer,ot.quadTriangleIndexBuffer,ot.rasterBoundsSegments),kt.needsHillshadePrepare=!1}})(de,ge,qe,ve,Xe,Xr.disabled,at),Fe.viewport.set([0,0,de.width,de.height]);else if(de.renderPass==="translucent")if(Ve){const[ot,lt,pt]=de.stencilConfigForOverlapTwoPass(qe);As(de,ge,ve,pt,ot,Xe,at,!1,Le),As(de,ge,ve,pt,lt,Xe,at,!0,Le)}else{const[ot,lt]=de.getStencilConfigForOverlapAndUpdateStencilID(qe);As(de,ge,ve,lt,ot,Xe,at,!1,Le)}})(t,Z,Q,ie,ue):R.cj(Q)?(function(de,ge,ve,qe,Re){if(de.renderPass!=="translucent"||!qe.length)return;const{isRenderingToTexture:Le}=Re,Fe=de.style.projection.useSubdivision,Ve=de.getDepthModeForSublayer(0,$r.ReadOnly),Xe=de.colorModeForRenderPass();if(Fe){const[at,ot,lt]=de.stencilConfigForOverlapTwoPass(qe);Ja(de,ge,ve,lt,at,Ve,Xe,!1,Le),Ja(de,ge,ve,lt,ot,Ve,Xe,!0,Le)}else{const[at,ot]=de.getStencilConfigForOverlapAndUpdateStencilID(qe);Ja(de,ge,ve,ot,at,Ve,Xe,!1,Le)}})(t,Z,Q,ie,ue):R.bK(Q)?(function(de,ge,ve,qe,Re){if(de.renderPass!=="translucent"||ve.paint.get("raster-opacity")===0||!qe.length)return;const{isRenderingToTexture:Le}=Re,Fe=ge.getSource(),Ve=de.style.projection.useSubdivision;if(Fe instanceof Dr)Ps(de,ge,ve,qe,null,!1,!1,Fe.tileCoords,Fe.flippedWindingOrder,Le);else if(Ve){const[Xe,at,ot]=de.stencilConfigForOverlapTwoPass(qe);Ps(de,ge,ve,ot,Xe,!1,!0,Fo,!1,Le),Ps(de,ge,ve,ot,at,!0,!0,Fo,!1,Le)}else{const[Xe,at]=de.getStencilConfigForOverlapAndUpdateStencilID(qe);Ps(de,ge,ve,at,Xe,!1,!0,Fo,!1,Le)}})(t,Z,Q,ie,ue):R.ck(Q)?(function(de,ge,ve,qe,Re){const Le=ve.paint.get("background-color"),Fe=ve.paint.get("background-opacity");if(Fe===0)return;const{isRenderingToTexture:Ve}=Re,Xe=de.context,at=Xe.gl,ot=de.style.projection,lt=de.transform,pt=lt.tileSize,yt=ve.paint.get("background-pattern");if(de.isPatternMissing(yt))return;const mt=!yt&&Le.a===1&&Fe===1&&de.opaquePassEnabledForLayer()?"opaque":"translucent";if(de.renderPass!==mt)return;const xt=Xr.disabled,It=de.getDepthModeForSublayer(0,mt==="opaque"?$r.ReadWrite:$r.ReadOnly),gt=de.colorModeForRenderPass(),Ot=de.useProgram(yt?"backgroundPattern":"background"),zt=qe||Er(lt,{tileSize:pt,terrain:de.style.map.terrain});yt&&(Xe.activeTexture.set(at.TEXTURE0),de.imageManager.bind(de.context));const kt=ve.getCrossfadeParameters();for(const Bt of zt){const Nt=lt.getProjectionData({overscaledTileID:Bt,applyGlobeMatrix:!Ve,applyTerrainMatrix:!0}),ar=yt?bl(Fe,de,yt,{tileID:Bt,tileSize:pt},kt):Mu(Fe,Le),sr=de.style.map.terrain&&de.style.map.terrain.getTerrainData(Bt),Kt=ot.getMeshFromTileID(Xe,Bt.canonical,!1,!0,"raster");Ot.draw(Xe,at.TRIANGLES,It,xt,gt,ni.backCCW,ar,sr,Nt,ve.id,Kt.vertexBuffer,Kt.indexBuffer,Kt.segments)}})(t,0,Q,ie,ue):R.cl(Q)&&(function(de,ge,ve,qe){const{isRenderingGlobe:Re}=qe,Le=de.context,Fe=ve.implementation,Ve=de.style.projection,Xe=de.transform,at=Xe.getProjectionDataForCustomLayer(Re),ot={farZ:Xe.farZ,nearZ:Xe.nearZ,fov:Xe.fov*Math.PI/180,modelViewProjectionMatrix:Xe.modelViewProjectionMatrix,projectionMatrix:Xe.projectionMatrix,shaderData:{variantName:Ve.shaderVariantName,vertexShaderPrelude:`const float PI = 3.141592653589793;
uniform mat4 u_projection_matrix;
${Ve.shaderPreludeCode.vertexSource}`,define:Ve.shaderDefine},defaultProjectionData:at},lt=Fe.renderingMode?Fe.renderingMode:"2d";if(de.renderPass==="offscreen"){const pt=Fe.prerender;pt&&(de.setCustomLayerDefaults(),Le.setColorMode(de.colorModeForRenderPass()),pt.call(Fe,Le.gl,ot),Le.setDirty(),de.setBaseState())}else if(de.renderPass==="translucent"){de.setCustomLayerDefaults(),Le.setColorMode(de.colorModeForRenderPass()),Le.setStencilMode(Xr.disabled);const pt=lt==="3d"?de.getDepthModeFor3D():de.getDepthModeForSublayer(0,$r.ReadOnly);Le.setDepthMode(pt),Fe.render(Le.gl,ot),Le.setDirty(),de.setBaseState(),Le.bindFramebuffer.set(null)}})(t,0,Q,ue))}saveTileTexture(t){const Z=this._tileTextures[t.size[0]];Z?Z.push(t):this._tileTextures[t.size[0]]=[t]}getTileTexture(t){const Z=this._tileTextures[t];return Z&&Z.length>0?Z.pop():null}isPatternMissing(t){if(!t)return!1;if(!t.from||!t.to)return!0;const Z=this.imageManager.getPattern(t.from.toString()),Q=this.imageManager.getPattern(t.to.toString());return!Z||!Q}useProgram(t,Z,Q=!1,ie=[]){this.cache=this.cache||{};const ue=!!this.style.map.terrain,de=this.style.projection,ge=Q?hn.projectionMercator:de.shaderPreludeCode,ve=Q?va:de.shaderDefine,qe=t+(Z?Z.cacheKey:"")+`/${Q?Qr:de.shaderVariantName}`+(this._showOverdrawInspector?"/overdraw":"")+(ue?"/terrain":"")+(ie?`/${ie.join("/")}`:"");return this.cache[qe]||(this.cache[qe]=new _l(this.context,hn[t],Z,cs[t],this._showOverdrawInspector,ue,ge,ve,ie)),this.cache[qe]}setCustomLayerDefaults(){this.context.unbindVAO(),this.context.cullFace.setDefault(),this.context.activeTexture.setDefault(),this.context.pixelStoreUnpack.setDefault(),this.context.pixelStoreUnpackPremultiplyAlpha.setDefault(),this.context.pixelStoreUnpackFlipY.setDefault()}setBaseState(){const t=this.context.gl;this.context.cullFace.set(!1),this.context.viewport.set([0,0,this.width,this.height]),this.context.blendEquation.set(t.FUNC_ADD)}initDebugOverlayCanvas(){this.debugOverlayCanvas==null&&(this.debugOverlayCanvas=document.createElement("canvas"),this.debugOverlayCanvas.width=512,this.debugOverlayCanvas.height=512,this.debugOverlayTexture=new R.T(this.context,this.debugOverlayCanvas,this.context.gl.RGBA))}destroy(){this.debugOverlayTexture&&this.debugOverlayTexture.destroy()}overLimit(){const{drawingBufferWidth:t,drawingBufferHeight:Z}=this.context.gl;return this.width!==t||this.height!==Z}}function Fl(se,t){let Z,Q=!1,ie=null,ue=null;const de=()=>{ie=null,Q&&(se.apply(ue,Z),ie=setTimeout(de,t),Q=!1)};return(...ge)=>(Q=!0,ue=this,Z=ge,ie||de(),ie)}class kl{constructor(t){this._getCurrentHash=()=>{const Z=window.location.hash.replace("#","");if(this._hashName){let Q;return Z.split("&").map((ie=>ie.split("="))).forEach((ie=>{ie[0]===this._hashName&&(Q=ie)})),(Q&&Q[1]||"").split("/")}return Z.split("/")},this._onHashChange=()=>{const Z=this._getCurrentHash();if(!this._isValidHash(Z))return!1;const Q=this._map.dragRotate.isEnabled()&&this._map.touchZoomRotate.isEnabled()?+(Z[3]||0):this._map.getBearing();return this._map.jumpTo({center:[+Z[2],+Z[1]],zoom:+Z[0],bearing:Q,pitch:+(Z[4]||0)}),!0},this._updateHashUnthrottled=()=>{const Z=window.location.href.replace(/(#.*)?$/,this.getHashString());window.history.replaceState(window.history.state,null,Z)},this._removeHash=()=>{const Z=this._getCurrentHash();if(Z.length===0)return;const Q=Z.join("/");let ie=Q;ie.split("&").length>0&&(ie=ie.split("&")[0]),this._hashName&&(ie=`${this._hashName}=${Q}`);let ue=window.location.hash.replace(ie,"");ue.startsWith("#&")?ue=ue.slice(0,1)+ue.slice(2):ue==="#"&&(ue="");let de=window.location.href.replace(/(#.+)?$/,ue);de=de.replace("&&","&"),window.history.replaceState(window.history.state,null,de)},this._updateHash=Fl(this._updateHashUnthrottled,300),this._hashName=t&&encodeURIComponent(t)}addTo(t){return this._map=t,addEventListener("hashchange",this._onHashChange,!1),this._map.on("moveend",this._updateHash),this}remove(){return removeEventListener("hashchange",this._onHashChange,!1),this._map.off("moveend",this._updateHash),clearTimeout(this._updateHash()),this._removeHash(),delete this._map,this}getHashString(t){const Z=this._map.getCenter(),Q=Math.round(100*this._map.getZoom())/100,ie=Math.ceil((Q*Math.LN2+Math.log(512/360/.5))/Math.LN10),ue=Math.pow(10,ie),de=Math.round(Z.lng*ue)/ue,ge=Math.round(Z.lat*ue)/ue,ve=this._map.getBearing(),qe=this._map.getPitch();let Re="";if(Re+=t?`/${de}/${ge}/${Q}`:`${Q}/${ge}/${de}`,(ve||qe)&&(Re+="/"+Math.round(10*ve)/10),qe&&(Re+=`/${Math.round(qe)}`),this._hashName){const Le=this._hashName;let Fe=!1;const Ve=window.location.hash.slice(1).split("&").map((Xe=>{const at=Xe.split("=")[0];return at===Le?(Fe=!0,`${at}=${Re}`):Xe})).filter((Xe=>Xe));return Fe||Ve.push(`${Le}=${Re}`),`#${Ve.join("&")}`}return`#${Re}`}_isValidHash(t){if(t.length<3||t.some(isNaN))return!1;try{new R.S(+t[2],+t[1])}catch{return!1}const Z=+t[0],Q=+(t[3]||0),ie=+(t[4]||0);return Z>=this._map.getMinZoom()&&Z<=this._map.getMaxZoom()&&Q>=-180&&Q<=180&&ie>=this._map.getMinPitch()&&ie<=this._map.getMaxPitch()}}const eo={linearity:.3,easing:R.cm(0,0,.3,1)},Aa=R.e({deceleration:2500,maxSpeed:1400},eo),Gu=R.e({deceleration:20,maxSpeed:1400},eo),$u=R.e({deceleration:1e3,maxSpeed:360},eo),Wu=R.e({deceleration:1e3,maxSpeed:90},eo),Hu=R.e({deceleration:1e3,maxSpeed:360},eo);class Zu{constructor(t){this._map=t,this.clear()}clear(){this._inertiaBuffer=[]}record(t){this._drainInertiaBuffer(),this._inertiaBuffer.push({time:_e.now(),settings:t})}_drainInertiaBuffer(){const t=this._inertiaBuffer,Z=_e.now();for(;t.length>0&&Z-t[0].time>160;)t.shift()}_onMoveEnd(t){if(this._drainInertiaBuffer(),this._inertiaBuffer.length<2)return;const Z={zoom:0,bearing:0,pitch:0,roll:0,pan:new R.P(0,0),pinchAround:void 0,around:void 0};for(const{settings:ue}of this._inertiaBuffer)Z.zoom+=ue.zoomDelta||0,Z.bearing+=ue.bearingDelta||0,Z.pitch+=ue.pitchDelta||0,Z.roll+=ue.rollDelta||0,ue.panDelta&&Z.pan._add(ue.panDelta),ue.around&&(Z.around=ue.around),ue.pinchAround&&(Z.pinchAround=ue.pinchAround);const Q=this._inertiaBuffer[this._inertiaBuffer.length-1].time-this._inertiaBuffer[0].time,ie={};if(Z.pan.mag()){const ue=ro(Z.pan.mag(),Q,R.e({},Aa,t||{})),de=Z.pan.mult(ue.amount/Z.pan.mag()),ge=this._map.cameraHelper.handlePanInertia(de,this._map.transform);ie.center=ge.easingCenter,ie.offset=ge.easingOffset,to(ie,ue)}if(Z.zoom){const ue=ro(Z.zoom,Q,Gu);ie.zoom=this._map.transform.zoom+ue.amount,to(ie,ue)}if(Z.bearing){const ue=ro(Z.bearing,Q,$u);ie.bearing=this._map.transform.bearing+R.ah(ue.amount,-179,179),to(ie,ue)}if(Z.pitch){const ue=ro(Z.pitch,Q,Wu);ie.pitch=this._map.transform.pitch+ue.amount,to(ie,ue)}if(Z.roll){const ue=ro(Z.roll,Q,Hu);ie.roll=this._map.transform.roll+R.ah(ue.amount,-179,179),to(ie,ue)}if(ie.zoom||ie.bearing){const ue=Z.pinchAround===void 0?Z.around:Z.pinchAround;ie.around=ue?this._map.unproject(ue):this._map.getCenter()}return this.clear(),R.e(ie,{noMoveStart:!0})}}function to(se,t){(!se.duration||se.duration<t.duration)&&(se.duration=t.duration,se.easing=t.easing)}function ro(se,t,Z){const{maxSpeed:Q,linearity:ie,deceleration:ue}=Z,de=R.ah(se*ie/(t/1e3),-Q,Q),ge=Math.abs(de)/(ue*ie);return{easing:Z.easing,duration:1e3*ge,amount:de*(ge/2)}}class vn extends R.l{preventDefault(){this._defaultPrevented=!0}get defaultPrevented(){return this._defaultPrevented}constructor(t,Z,Q,ie={}){Q=Q instanceof MouseEvent?Q:new MouseEvent(t,Q);const ue=me.mousePos(Z.getCanvas(),Q),de=Z.unproject(ue);super(t,R.e({point:ue,lngLat:de,originalEvent:Q},ie)),this._defaultPrevented=!1,this.target=Z}}class oa extends R.l{preventDefault(){this._defaultPrevented=!0}get defaultPrevented(){return this._defaultPrevented}constructor(t,Z,Q){const ie=t==="touchend"?Q.changedTouches:Q.touches,ue=me.touchPos(Z.getCanvasContainer(),ie),de=ue.map((ve=>Z.unproject(ve))),ge=ue.reduce(((ve,qe,Re,Le)=>ve.add(qe.div(Le.length))),new R.P(0,0));super(t,{points:ue,point:ge,lngLats:de,lngLat:Z.unproject(ge),originalEvent:Q}),this._defaultPrevented=!1}}class Ll extends R.l{preventDefault(){this._defaultPrevented=!0}get defaultPrevented(){return this._defaultPrevented}constructor(t,Z,Q){super(t,{originalEvent:Q}),this._defaultPrevented=!1}}class Cn{constructor(t,Z){this._map=t,this._clickTolerance=Z.clickTolerance}reset(){delete this._mousedownPos}wheel(t){return this._firePreventable(new Ll(t.type,this._map,t))}mousedown(t,Z){return this._mousedownPos=Z,this._firePreventable(new vn(t.type,this._map,t))}mouseup(t){this._map.fire(new vn(t.type,this._map,t))}click(t,Z){this._mousedownPos&&this._mousedownPos.dist(Z)>=this._clickTolerance||this._map.fire(new vn(t.type,this._map,t))}dblclick(t){return this._firePreventable(new vn(t.type,this._map,t))}mouseover(t){this._map.fire(new vn(t.type,this._map,t))}mouseout(t){this._map.fire(new vn(t.type,this._map,t))}touchstart(t){return this._firePreventable(new oa(t.type,this._map,t))}touchmove(t){this._map.fire(new oa(t.type,this._map,t))}touchend(t){this._map.fire(new oa(t.type,this._map,t))}touchcancel(t){this._map.fire(new oa(t.type,this._map,t))}_firePreventable(t){if(this._map.fire(t),t.defaultPrevented)return{}}isEnabled(){return!0}isActive(){return!1}enable(){}disable(){}}class kn{constructor(t){this._map=t}reset(){this._delayContextMenu=!1,this._ignoreContextMenu=!0,delete this._contextMenuEvent}mousemove(t){this._map.fire(new vn(t.type,this._map,t))}mousedown(){this._delayContextMenu=!0,this._ignoreContextMenu=!1}mouseup(){this._delayContextMenu=!1,this._contextMenuEvent&&(this._map.fire(new vn("contextmenu",this._map,this._contextMenuEvent)),delete this._contextMenuEvent)}contextmenu(t){this._delayContextMenu?this._contextMenuEvent=t:this._ignoreContextMenu||this._map.fire(new vn(t.type,this._map,t)),this._map.listens("contextmenu")&&t.preventDefault()}isEnabled(){return!0}isActive(){return!1}enable(){}disable(){}}class io{constructor(t){this._map=t}get transform(){return this._map._requestedCameraState||this._map.transform}get center(){return{lng:this.transform.center.lng,lat:this.transform.center.lat}}get zoom(){return this.transform.zoom}get pitch(){return this.transform.pitch}get bearing(){return this.transform.bearing}unproject(t){return this.transform.screenPointToLocation(R.P.convert(t),this._map.terrain)}}class Mn{constructor(t,Z){this._map=t,this._tr=new io(t),this._el=t.getCanvasContainer(),this._container=t.getContainer(),this._clickTolerance=Z.clickTolerance||1}isEnabled(){return!!this._enabled}isActive(){return!!this._active}enable(){this.isEnabled()||(this._enabled=!0)}disable(){this.isEnabled()&&(this._enabled=!1)}mousedown(t,Z){this.isEnabled()&&t.shiftKey&&t.button===0&&(me.disableDrag(),this._startPos=this._lastPos=Z,this._active=!0)}mousemoveWindow(t,Z){if(!this._active)return;const Q=Z;if(this._lastPos.equals(Q)||!this._box&&Q.dist(this._startPos)<this._clickTolerance)return;const ie=this._startPos;this._lastPos=Q,this._box||(this._box=me.create("div","maplibregl-boxzoom",this._container),this._container.classList.add("maplibregl-crosshair"),this._fireEvent("boxzoomstart",t));const ue=Math.min(ie.x,Q.x),de=Math.max(ie.x,Q.x),ge=Math.min(ie.y,Q.y),ve=Math.max(ie.y,Q.y);me.setTransform(this._box,`translate(${ue}px,${ge}px)`),this._box.style.width=de-ue+"px",this._box.style.height=ve-ge+"px"}mouseupWindow(t,Z){if(!this._active||t.button!==0)return;const Q=this._startPos,ie=Z;if(this.reset(),me.suppressClick(),Q.x!==ie.x||Q.y!==ie.y)return this._map.fire(new R.l("boxzoomend",{originalEvent:t})),{cameraAnimation:ue=>ue.fitScreenCoordinates(Q,ie,this._tr.bearing,{linear:!0})};this._fireEvent("boxzoomcancel",t)}keydown(t){this._active&&t.keyCode===27&&(this.reset(),this._fireEvent("boxzoomcancel",t))}reset(){this._active=!1,this._container.classList.remove("maplibregl-crosshair"),this._box&&(me.remove(this._box),this._box=null),me.enableDrag(),delete this._startPos,delete this._lastPos}_fireEvent(t,Z){return this._map.fire(new R.l(t,{originalEvent:Z}))}}function sa(se,t){if(se.length!==t.length)throw new Error(`The number of touches and points are not equal - touches ${se.length}, points ${t.length}`);const Z={};for(let Q=0;Q<se.length;Q++)Z[se[Q].identifier]=t[Q];return Z}class Hc{constructor(t){this.reset(),this.numTouches=t.numTouches}reset(){delete this.centroid,delete this.startTime,delete this.touches,this.aborted=!1}touchstart(t,Z,Q){(this.centroid||Q.length>this.numTouches)&&(this.aborted=!0),this.aborted||(this.startTime===void 0&&(this.startTime=t.timeStamp),Q.length===this.numTouches&&(this.centroid=(function(ie){const ue=new R.P(0,0);for(const de of ie)ue._add(de);return ue.div(ie.length)})(Z),this.touches=sa(Q,Z)))}touchmove(t,Z,Q){if(this.aborted||!this.centroid)return;const ie=sa(Q,Z);for(const ue in this.touches){const de=ie[ue];(!de||de.dist(this.touches[ue])>30)&&(this.aborted=!0)}}touchend(t,Z,Q){if((!this.centroid||t.timeStamp-this.startTime>500)&&(this.aborted=!0),Q.length===0){const ie=!this.aborted&&this.centroid;if(this.reset(),ie)return ie}}}class Bl{constructor(t){this.singleTap=new Hc(t),this.numTaps=t.numTaps,this.reset()}reset(){this.lastTime=1/0,delete this.lastTap,this.count=0,this.singleTap.reset()}touchstart(t,Z,Q){this.singleTap.touchstart(t,Z,Q)}touchmove(t,Z,Q){this.singleTap.touchmove(t,Z,Q)}touchend(t,Z,Q){const ie=this.singleTap.touchend(t,Z,Q);if(ie){const ue=t.timeStamp-this.lastTime<500,de=!this.lastTap||this.lastTap.dist(ie)<30;if(ue&&de||this.reset(),this.count++,this.lastTime=t.timeStamp,this.lastTap=ie,this.count===this.numTaps)return this.reset(),ie}}}class Zc{constructor(t){this._tr=new io(t),this._zoomIn=new Bl({numTouches:1,numTaps:2}),this._zoomOut=new Bl({numTouches:2,numTaps:1}),this.reset()}reset(){this._active=!1,this._zoomIn.reset(),this._zoomOut.reset()}touchstart(t,Z,Q){this._zoomIn.touchstart(t,Z,Q),this._zoomOut.touchstart(t,Z,Q)}touchmove(t,Z,Q){this._zoomIn.touchmove(t,Z,Q),this._zoomOut.touchmove(t,Z,Q)}touchend(t,Z,Q){const ie=this._zoomIn.touchend(t,Z,Q),ue=this._zoomOut.touchend(t,Z,Q),de=this._tr;return ie?(this._active=!0,t.preventDefault(),setTimeout((()=>this.reset()),0),{cameraAnimation:ge=>ge.easeTo({duration:300,zoom:de.zoom+1,around:de.unproject(ie)},{originalEvent:t})}):ue?(this._active=!0,t.preventDefault(),setTimeout((()=>this.reset()),0),{cameraAnimation:ge=>ge.easeTo({duration:300,zoom:de.zoom-1,around:de.unproject(ue)},{originalEvent:t})}):void 0}touchcancel(){this.reset()}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}}class Lo{constructor(t){this._enabled=!!t.enable,this._moveStateManager=t.moveStateManager,this._clickTolerance=t.clickTolerance||1,this._moveFunction=t.move,this._activateOnStart=!!t.activateOnStart,t.assignEvents(this),this.reset()}reset(t){this._active=!1,this._moved=!1,delete this._lastPoint,this._moveStateManager.endMove(t)}_move(...t){const Z=this._moveFunction(...t);if(Z.bearingDelta||Z.pitchDelta||Z.rollDelta||Z.around||Z.panDelta)return this._active=!0,Z}dragStart(t,Z){this.isEnabled()&&!this._lastPoint&&this._moveStateManager.isValidStartEvent(t)&&(this._moveStateManager.startMove(t),this._lastPoint=Array.isArray(Z)?Z[0]:Z,this._activateOnStart&&this._lastPoint&&(this._active=!0))}dragMove(t,Z){if(!this.isEnabled())return;const Q=this._lastPoint;if(!Q)return;if(t.preventDefault(),!this._moveStateManager.isValidMoveEvent(t))return void this.reset(t);const ie=Array.isArray(Z)?Z[0]:Z;return!this._moved&&ie.dist(Q)<this._clickTolerance?void 0:(this._moved=!0,this._lastPoint=ie,this._move(Q,ie))}dragEnd(t){this.isEnabled()&&this._lastPoint&&this._moveStateManager.isValidEndEvent(t)&&(this._moved&&me.suppressClick(),this.reset(t))}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}getClickTolerance(){return this._clickTolerance}}const Ku=0,Bo=2,Jn={[Ku]:1,[Bo]:2};class vr{constructor(t){this._correctEvent=t.checkCorrectEvent}startMove(t){const Z=me.mouseButton(t);this._eventButton=Z}endMove(t){delete this._eventButton}isValidStartEvent(t){return this._correctEvent(t)}isValidMoveEvent(t){return!(function(Z,Q){const ie=Jn[Q];return Z.buttons===void 0||(Z.buttons&ie)!==ie})(t,this._eventButton)}isValidEndEvent(t){return me.mouseButton(t)===this._eventButton}}class Xu{constructor(){this._firstTouch=void 0}_isOneFingerTouch(t){return t.targetTouches.length===1}_isSameTouchEvent(t){return t.targetTouches[0].identifier===this._firstTouch}startMove(t){this._firstTouch=t.targetTouches[0].identifier}endMove(t){delete this._firstTouch}isValidStartEvent(t){return this._isOneFingerTouch(t)}isValidMoveEvent(t){return this._isOneFingerTouch(t)&&this._isSameTouchEvent(t)}isValidEndEvent(t){return this._isOneFingerTouch(t)&&this._isSameTouchEvent(t)}}class Nl{constructor(t=new vr({checkCorrectEvent:()=>!0}),Z=new Xu){this.mouseMoveStateManager=t,this.oneFingerTouchMoveStateManager=Z}_executeRelevantHandler(t,Z,Q){return t instanceof MouseEvent?Z(t):typeof TouchEvent<"u"&&t instanceof TouchEvent?Q(t):void 0}startMove(t){this._executeRelevantHandler(t,(Z=>this.mouseMoveStateManager.startMove(Z)),(Z=>this.oneFingerTouchMoveStateManager.startMove(Z)))}endMove(t){this._executeRelevantHandler(t,(Z=>this.mouseMoveStateManager.endMove(Z)),(Z=>this.oneFingerTouchMoveStateManager.endMove(Z)))}isValidStartEvent(t){return this._executeRelevantHandler(t,(Z=>this.mouseMoveStateManager.isValidStartEvent(Z)),(Z=>this.oneFingerTouchMoveStateManager.isValidStartEvent(Z)))}isValidMoveEvent(t){return this._executeRelevantHandler(t,(Z=>this.mouseMoveStateManager.isValidMoveEvent(Z)),(Z=>this.oneFingerTouchMoveStateManager.isValidMoveEvent(Z)))}isValidEndEvent(t){return this._executeRelevantHandler(t,(Z=>this.mouseMoveStateManager.isValidEndEvent(Z)),(Z=>this.oneFingerTouchMoveStateManager.isValidEndEvent(Z)))}}const No=se=>{se.mousedown=se.dragStart,se.mousemoveWindow=se.dragMove,se.mouseup=se.dragEnd,se.contextmenu=t=>{t.preventDefault()}};class jo{constructor(t,Z){this._clickTolerance=t.clickTolerance||1,this._map=Z,this.reset()}reset(){this._active=!1,this._touches={},this._sum=new R.P(0,0)}_shouldBePrevented(t){return t<(this._map.cooperativeGestures.isEnabled()?2:1)}touchstart(t,Z,Q){return this._calculateTransform(t,Z,Q)}touchmove(t,Z,Q){if(this._active){if(!this._shouldBePrevented(Q.length))return t.preventDefault(),this._calculateTransform(t,Z,Q);this._map.cooperativeGestures.notifyGestureBlocked("touch_pan",t)}}touchend(t,Z,Q){this._calculateTransform(t,Z,Q),this._active&&this._shouldBePrevented(Q.length)&&this.reset()}touchcancel(){this.reset()}_calculateTransform(t,Z,Q){Q.length>0&&(this._active=!0);const ie=sa(Q,Z),ue=new R.P(0,0),de=new R.P(0,0);let ge=0;for(const qe in ie){const Re=ie[qe],Le=this._touches[qe];Le&&(ue._add(Re),de._add(Re.sub(Le)),ge++,ie[qe]=Re)}if(this._touches=ie,this._shouldBePrevented(ge)||!de.mag())return;const ve=de.div(ge);return this._sum._add(ve),this._sum.mag()<this._clickTolerance?void 0:{around:ue.div(ge),panDelta:ve}}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}}class Pa{constructor(){this.reset()}reset(){this._active=!1,delete this._firstTwoTouches}touchstart(t,Z,Q){this._firstTwoTouches||Q.length<2||(this._firstTwoTouches=[Q[0].identifier,Q[1].identifier],this._start([Z[0],Z[1]]))}touchmove(t,Z,Q){if(!this._firstTwoTouches)return;t.preventDefault();const[ie,ue]=this._firstTwoTouches,de=no(Q,Z,ie),ge=no(Q,Z,ue);if(!de||!ge)return;const ve=this._aroundCenter?null:de.add(ge).div(2);return this._move([de,ge],ve,t)}touchend(t,Z,Q){if(!this._firstTwoTouches)return;const[ie,ue]=this._firstTwoTouches,de=no(Q,Z,ie),ge=no(Q,Z,ue);de&&ge||(this._active&&me.suppressClick(),this.reset())}touchcancel(){this.reset()}enable(t){this._enabled=!0,this._aroundCenter=!!t&&t.around==="center"}disable(){this._enabled=!1,this.reset()}isEnabled(){return!!this._enabled}isActive(){return!!this._active}}function no(se,t,Z){for(let Q=0;Q<se.length;Q++)if(se[Q].identifier===Z)return t[Q]}function ti(se,t){return Math.log(se/t)/Math.LN2}class Ms extends Pa{reset(){super.reset(),delete this._distance,delete this._startDistance}_start(t){this._startDistance=this._distance=t[0].dist(t[1])}_move(t,Z){const Q=this._distance;if(this._distance=t[0].dist(t[1]),this._active||!(Math.abs(ti(this._distance,this._startDistance))<.1))return this._active=!0,{zoomDelta:ti(this._distance,Q),pinchAround:Z}}}function Yu(se,t){return 180*se.angleWith(t)/Math.PI}class Ds extends Pa{reset(){super.reset(),delete this._minDiameter,delete this._startVector,delete this._vector}_start(t){this._startVector=this._vector=t[0].sub(t[1]),this._minDiameter=t[0].dist(t[1])}_move(t,Z,Q){const ie=this._vector;if(this._vector=t[0].sub(t[1]),this._active||!this._isBelowThreshold(this._vector))return this._active=!0,{bearingDelta:Yu(this._vector,ie),pinchAround:Z}}_isBelowThreshold(t){this._minDiameter=Math.min(this._minDiameter,t.mag());const Z=25/(Math.PI*this._minDiameter)*360,Q=Yu(t,this._startVector);return Math.abs(Q)<Z}}function jl(se){return Math.abs(se.y)>Math.abs(se.x)}class Ju extends Pa{constructor(t){super(),this._currentTouchCount=0,this._map=t}reset(){super.reset(),this._valid=void 0,delete this._firstMove,delete this._lastPoints}touchstart(t,Z,Q){super.touchstart(t,Z,Q),this._currentTouchCount=Q.length}_start(t){this._lastPoints=t,jl(t[0].sub(t[1]))&&(this._valid=!1)}_move(t,Z,Q){if(this._map.cooperativeGestures.isEnabled()&&this._currentTouchCount<3)return;const ie=t[0].sub(this._lastPoints[0]),ue=t[1].sub(this._lastPoints[1]);return this._valid=this.gestureBeginsVertically(ie,ue,Q.timeStamp),this._valid?(this._lastPoints=t,this._active=!0,{pitchDelta:(ie.y+ue.y)/2*-.5}):void 0}gestureBeginsVertically(t,Z,Q){if(this._valid!==void 0)return this._valid;const ie=t.mag()>=2,ue=Z.mag()>=2;if(!ie&&!ue)return;if(!ie||!ue)return this._firstMove===void 0&&(this._firstMove=Q),Q-this._firstMove<100&&void 0;const de=t.y>0==Z.y>0;return jl(t)&&jl(Z)&&de}}const Qu={panStep:100,bearingStep:15,pitchStep:10};class Fs{constructor(t){this._tr=new io(t);const Z=Qu;this._panStep=Z.panStep,this._bearingStep=Z.bearingStep,this._pitchStep=Z.pitchStep,this._rotationDisabled=!1}reset(){this._active=!1}keydown(t){if(t.altKey||t.ctrlKey||t.metaKey)return;let Z=0,Q=0,ie=0,ue=0,de=0;switch(t.keyCode){case 61:case 107:case 171:case 187:Z=1;break;case 189:case 109:case 173:Z=-1;break;case 37:t.shiftKey?Q=-1:(t.preventDefault(),ue=-1);break;case 39:t.shiftKey?Q=1:(t.preventDefault(),ue=1);break;case 38:t.shiftKey?ie=1:(t.preventDefault(),de=-1);break;case 40:t.shiftKey?ie=-1:(t.preventDefault(),de=1);break;default:return}return this._rotationDisabled&&(Q=0,ie=0),{cameraAnimation:ge=>{const ve=this._tr;ge.easeTo({duration:300,easeId:"keyboardHandler",easing:ec,zoom:Z?Math.round(ve.zoom)+Z*(t.shiftKey?2:1):ve.zoom,bearing:ve.bearing+Q*this._bearingStep,pitch:ve.pitch+ie*this._pitchStep,offset:[-ue*this._panStep,-de*this._panStep],center:ve.center},{originalEvent:t})}}}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}disableRotation(){this._rotationDisabled=!0}enableRotation(){this._rotationDisabled=!1}}function ec(se){return se*(2-se)}const tc=4.000244140625,rc=1/450;class ic{constructor(t,Z){this._onTimeout=Q=>{this._type="wheel",this._delta-=this._lastValue,this._active||this._start(Q)},this._map=t,this._tr=new io(t),this._triggerRenderFrame=Z,this._delta=0,this._defaultZoomRate=.01,this._wheelZoomRate=rc}setZoomRate(t){this._defaultZoomRate=t}setWheelZoomRate(t){this._wheelZoomRate=t}isEnabled(){return!!this._enabled}isActive(){return!!this._active||this._finishTimeout!==void 0}isZooming(){return!!this._zooming}enable(t){this.isEnabled()||(this._enabled=!0,this._aroundCenter=!!t&&t.around==="center")}disable(){this.isEnabled()&&(this._enabled=!1)}_shouldBePrevented(t){return!!this._map.cooperativeGestures.isEnabled()&&!(t.ctrlKey||this._map.cooperativeGestures.isBypassed(t))}wheel(t){if(!this.isEnabled())return;if(this._shouldBePrevented(t))return void this._map.cooperativeGestures.notifyGestureBlocked("wheel_zoom",t);let Z=t.deltaMode===WheelEvent.DOM_DELTA_LINE?40*t.deltaY:t.deltaY;const Q=_e.now(),ie=Q-(this._lastWheelEventTime||0);this._lastWheelEventTime=Q,Z!==0&&Z%tc==0?this._type="wheel":Z!==0&&Math.abs(Z)<4?this._type="trackpad":ie>400?(this._type=null,this._lastValue=Z,this._timeout=setTimeout(this._onTimeout,40,t)):this._type||(this._type=Math.abs(ie*Z)<200?"trackpad":"wheel",this._timeout&&(clearTimeout(this._timeout),this._timeout=null,Z+=this._lastValue)),t.shiftKey&&Z&&(Z/=4),this._type&&(this._lastWheelEvent=t,this._delta-=Z,this._active||this._start(t)),t.preventDefault()}_start(t){if(!this._delta)return;this._frameId&&(this._frameId=null),this._active=!0,this.isZooming()||(this._zooming=!0),this._finishTimeout&&(clearTimeout(this._finishTimeout),delete this._finishTimeout);const Z=me.mousePos(this._map.getCanvas(),t),Q=this._tr;this._aroundPoint=this._aroundCenter?Q.transform.locationToScreenPoint(R.S.convert(Q.center)):Z,this._frameId||(this._frameId=!0,this._triggerRenderFrame())}renderFrame(){if(!this._frameId||(this._frameId=null,!this.isActive()))return;const t=this._tr.transform;if(typeof this._lastExpectedZoom=="number"){const ge=t.zoom-this._lastExpectedZoom;typeof this._startZoom=="number"&&(this._startZoom+=ge),typeof this._targetZoom=="number"&&(this._targetZoom+=ge)}if(this._delta!==0){const ge=this._type==="wheel"&&Math.abs(this._delta)>tc?this._wheelZoomRate:this._defaultZoomRate;let ve=2/(1+Math.exp(-Math.abs(this._delta*ge)));this._delta<0&&ve!==0&&(ve=1/ve);const qe=typeof this._targetZoom!="number"?t.scale:R.af(this._targetZoom);this._targetZoom=t.getConstrained(t.getCameraLngLat(),R.ak(qe*ve)).zoom,this._type==="wheel"&&(this._startZoom=t.zoom,this._easing=this._smoothOutEasing(200)),this._delta=0}const Z=typeof this._targetZoom!="number"?t.zoom:this._targetZoom,Q=this._startZoom,ie=this._easing;let ue,de=!1;if(this._type==="wheel"&&Q&&ie){const ge=_e.now()-this._lastWheelEventTime,ve=Math.min((ge+5)/200,1),qe=ie(ve);ue=R.C.number(Q,Z,qe),ve<1?this._frameId||(this._frameId=!0):de=!0}else ue=Z,de=!0;return this._active=!0,de&&(this._active=!1,this._finishTimeout=setTimeout((()=>{this._zooming=!1,this._triggerRenderFrame(),delete this._targetZoom,delete this._lastExpectedZoom,delete this._finishTimeout}),200)),this._lastExpectedZoom=ue,{noInertia:!0,needsRenderFrame:!de,zoomDelta:ue-t.zoom,around:this._aroundPoint,originalEvent:this._lastWheelEvent}}_smoothOutEasing(t){let Z=R.co;if(this._prevEase){const Q=this._prevEase,ie=(_e.now()-Q.start)/Q.duration,ue=Q.easing(ie+.01)-Q.easing(ie),de=.27/Math.sqrt(ue*ue+1e-4)*.01,ge=Math.sqrt(.0729-de*de);Z=R.cm(de,ge,.25,1)}return this._prevEase={start:_e.now(),duration:t,easing:Z},Z}reset(){this._active=!1,this._zooming=!1,delete this._targetZoom,delete this._lastExpectedZoom,this._finishTimeout&&(clearTimeout(this._finishTimeout),delete this._finishTimeout)}}class nc{constructor(t,Z){this._clickZoom=t,this._tapZoom=Z}enable(){this._clickZoom.enable(),this._tapZoom.enable()}disable(){this._clickZoom.disable(),this._tapZoom.disable()}isEnabled(){return this._clickZoom.isEnabled()&&this._tapZoom.isEnabled()}isActive(){return this._clickZoom.isActive()||this._tapZoom.isActive()}}class la{constructor(t){this._tr=new io(t),this.reset()}reset(){this._active=!1}dblclick(t,Z){return t.preventDefault(),{cameraAnimation:Q=>{Q.easeTo({duration:300,zoom:this._tr.zoom+(t.shiftKey?-1:1),around:this._tr.unproject(Z)},{originalEvent:t})}}}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}}class mi{constructor(){this._tap=new Bl({numTouches:1,numTaps:1}),this.reset()}reset(){this._active=!1,delete this._swipePoint,delete this._swipeTouch,delete this._tapTime,delete this._tapPoint,this._tap.reset()}touchstart(t,Z,Q){if(!this._swipePoint)if(this._tapTime){const ie=Z[0],ue=t.timeStamp-this._tapTime<500,de=this._tapPoint.dist(ie)<30;ue&&de?Q.length>0&&(this._swipePoint=ie,this._swipeTouch=Q[0].identifier):this.reset()}else this._tap.touchstart(t,Z,Q)}touchmove(t,Z,Q){if(this._tapTime){if(this._swipePoint){if(Q[0].identifier!==this._swipeTouch)return;const ie=Z[0],ue=ie.y-this._swipePoint.y;return this._swipePoint=ie,t.preventDefault(),this._active=!0,{zoomDelta:ue/128}}}else this._tap.touchmove(t,Z,Q)}touchend(t,Z,Q){if(this._tapTime)this._swipePoint&&Q.length===0&&this.reset();else{const ie=this._tap.touchend(t,Z,Q);ie&&(this._tapTime=t.timeStamp,this._tapPoint=ie)}}touchcancel(){this.reset()}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}}class ac{constructor(t,Z,Q){this._el=t,this._mousePan=Z,this._touchPan=Q}enable(t){this._inertiaOptions=t||{},this._mousePan.enable(),this._touchPan.enable(),this._el.classList.add("maplibregl-touch-drag-pan")}disable(){this._mousePan.disable(),this._touchPan.disable(),this._el.classList.remove("maplibregl-touch-drag-pan")}isEnabled(){return this._mousePan.isEnabled()&&this._touchPan.isEnabled()}isActive(){return this._mousePan.isActive()||this._touchPan.isActive()}}class zo{constructor(t,Z,Q,ie){this._pitchWithRotate=t.pitchWithRotate,this._rollEnabled=t.rollEnabled,this._mouseRotate=Z,this._mousePitch=Q,this._mouseRoll=ie}enable(){this._mouseRotate.enable(),this._pitchWithRotate&&this._mousePitch.enable(),this._rollEnabled&&this._mouseRoll.enable()}disable(){this._mouseRotate.disable(),this._mousePitch.disable(),this._mouseRoll.disable()}isEnabled(){return this._mouseRotate.isEnabled()&&(!this._pitchWithRotate||this._mousePitch.isEnabled())&&(!this._rollEnabled||this._mouseRoll.isEnabled())}isActive(){return this._mouseRotate.isActive()||this._mousePitch.isActive()||this._mouseRoll.isActive()}}class ks{constructor(t,Z,Q,ie){this._el=t,this._touchZoom=Z,this._touchRotate=Q,this._tapDragZoom=ie,this._rotationDisabled=!1,this._enabled=!0}enable(t){this._touchZoom.enable(t),this._rotationDisabled||this._touchRotate.enable(t),this._tapDragZoom.enable(),this._el.classList.add("maplibregl-touch-zoom-rotate")}disable(){this._touchZoom.disable(),this._touchRotate.disable(),this._tapDragZoom.disable(),this._el.classList.remove("maplibregl-touch-zoom-rotate")}isEnabled(){return this._touchZoom.isEnabled()&&(this._rotationDisabled||this._touchRotate.isEnabled())&&this._tapDragZoom.isEnabled()}isActive(){return this._touchZoom.isActive()||this._touchRotate.isActive()||this._tapDragZoom.isActive()}disableRotation(){this._rotationDisabled=!0,this._touchRotate.disable()}enableRotation(){this._rotationDisabled=!1,this._touchZoom.isEnabled()&&this._touchRotate.enable()}}class zl{constructor(t,Z){this._bypassKey=navigator.userAgent.indexOf("Mac")!==-1?"metaKey":"ctrlKey",this._map=t,this._options=Z,this._enabled=!1}isActive(){return!1}reset(){}_setupUI(){if(this._container)return;const t=this._map.getCanvasContainer();t.classList.add("maplibregl-cooperative-gestures"),this._container=me.create("div","maplibregl-cooperative-gesture-screen",t);let Z=this._map._getUIString("CooperativeGesturesHandler.WindowsHelpText");this._bypassKey==="metaKey"&&(Z=this._map._getUIString("CooperativeGesturesHandler.MacHelpText"));const Q=this._map._getUIString("CooperativeGesturesHandler.MobileHelpText"),ie=document.createElement("div");ie.className="maplibregl-desktop-message",ie.textContent=Z,this._container.appendChild(ie);const ue=document.createElement("div");ue.className="maplibregl-mobile-message",ue.textContent=Q,this._container.appendChild(ue),this._container.setAttribute("aria-hidden","true")}_destroyUI(){this._container&&(me.remove(this._container),this._map.getCanvasContainer().classList.remove("maplibregl-cooperative-gestures")),delete this._container}enable(){this._setupUI(),this._enabled=!0}disable(){this._enabled=!1,this._destroyUI()}isEnabled(){return this._enabled}isBypassed(t){return t[this._bypassKey]}notifyGestureBlocked(t,Z){this._enabled&&(this._map.fire(new R.l("cooperativegestureprevented",{gestureType:t,originalEvent:Z})),this._container.classList.add("maplibregl-show"),setTimeout((()=>{this._container.classList.remove("maplibregl-show")}),100))}}const Uo=se=>se.zoom||se.drag||se.roll||se.pitch||se.rotate;class oc extends R.l{}function Ul(se){return se.panDelta&&se.panDelta.mag()||se.zoomDelta||se.bearingDelta||se.pitchDelta||se.rollDelta}class Hn{constructor(t,Z){this.handleWindowEvent=ie=>{this.handleEvent(ie,`${ie.type}Window`)},this.handleEvent=(ie,ue)=>{if(ie.type==="blur")return void this.stop(!0);this._updatingCamera=!0;const de=ie.type==="renderFrame"?void 0:ie,ge={needsRenderFrame:!1},ve={},qe={};for(const{handlerName:Fe,handler:Ve,allowed:Xe}of this._handlers){if(!Ve.isEnabled())continue;let at;if(this._blockedByActive(qe,Xe,Fe))Ve.reset();else if(Ve[ue||ie.type]){if(R.cp(ie,ue||ie.type)){const ot=me.mousePos(this._map.getCanvas(),ie);at=Ve[ue||ie.type](ie,ot)}else if(R.cq(ie,ue||ie.type)){const ot=this._getMapTouches(ie.touches),lt=me.touchPos(this._map.getCanvas(),ot);at=Ve[ue||ie.type](ie,lt,ot)}else R.cr(ue||ie.type)||(at=Ve[ue||ie.type](ie));this.mergeHandlerResult(ge,ve,at,Fe,de),at&&at.needsRenderFrame&&this._triggerRenderFrame()}(at||Ve.isActive())&&(qe[Fe]=Ve)}const Re={};for(const Fe in this._previousActiveHandlers)qe[Fe]||(Re[Fe]=de);this._previousActiveHandlers=qe,(Object.keys(Re).length||Ul(ge))&&(this._changes.push([ge,ve,Re]),this._triggerRenderFrame()),(Object.keys(qe).length||Ul(ge))&&this._map._stop(!0),this._updatingCamera=!1;const{cameraAnimation:Le}=ge;Le&&(this._inertia.clear(),this._fireEvents({},{},!0),this._changes=[],Le(this._map))},this._map=t,this._el=this._map.getCanvasContainer(),this._handlers=[],this._handlersById={},this._changes=[],this._inertia=new Zu(t),this._bearingSnap=Z.bearingSnap,this._previousActiveHandlers={},this._eventsInProgress={},this._addDefaultHandlers(Z);const Q=this._el;this._listeners=[[Q,"touchstart",{passive:!0}],[Q,"touchmove",{passive:!1}],[Q,"touchend",void 0],[Q,"touchcancel",void 0],[Q,"mousedown",void 0],[Q,"mousemove",void 0],[Q,"mouseup",void 0],[document,"mousemove",{capture:!0}],[document,"mouseup",void 0],[Q,"mouseover",void 0],[Q,"mouseout",void 0],[Q,"dblclick",void 0],[Q,"click",void 0],[Q,"keydown",{capture:!1}],[Q,"keyup",void 0],[Q,"wheel",{passive:!1}],[Q,"contextmenu",void 0],[window,"blur",void 0]];for(const[ie,ue,de]of this._listeners)me.addEventListener(ie,ue,ie===document?this.handleWindowEvent:this.handleEvent,de)}destroy(){for(const[t,Z,Q]of this._listeners)me.removeEventListener(t,Z,t===document?this.handleWindowEvent:this.handleEvent,Q)}_addDefaultHandlers(t){const Z=this._map,Q=Z.getCanvasContainer();this._add("mapEvent",new Cn(Z,t));const ie=Z.boxZoom=new Mn(Z,t);this._add("boxZoom",ie),t.interactive&&t.boxZoom&&ie.enable();const ue=Z.cooperativeGestures=new zl(Z,t.cooperativeGestures);this._add("cooperativeGestures",ue),t.cooperativeGestures&&ue.enable();const de=new Zc(Z),ge=new la(Z);Z.doubleClickZoom=new nc(ge,de),this._add("tapZoom",de),this._add("clickZoom",ge),t.interactive&&t.doubleClickZoom&&Z.doubleClickZoom.enable();const ve=new mi;this._add("tapDragZoom",ve);const qe=Z.touchPitch=new Ju(Z);this._add("touchPitch",qe),t.interactive&&t.touchPitch&&Z.touchPitch.enable(t.touchPitch);const Re=()=>Z.project(Z.getCenter()),Le=(function({enable:mt,clickTolerance:xt,aroundCenter:It=!0,minPixelCenterThreshold:gt=100,rotateDegreesPerPixelMoved:Ot=.8},zt){const kt=new vr({checkCorrectEvent:Bt=>me.mouseButton(Bt)===0&&Bt.ctrlKey||me.mouseButton(Bt)===2&&!Bt.ctrlKey});return new Lo({clickTolerance:xt,move:(Bt,Nt)=>{const ar=zt();if(It&&Math.abs(ar.y-Bt.y)>gt)return{bearingDelta:R.cn(new R.P(Bt.x,Nt.y),Nt,ar)};let sr=(Nt.x-Bt.x)*Ot;return It&&Nt.y<ar.y&&(sr=-sr),{bearingDelta:sr}},moveStateManager:kt,enable:mt,assignEvents:No})})(t,Re),Fe=(function({enable:mt,clickTolerance:xt,pitchDegreesPerPixelMoved:It=-.5}){const gt=new vr({checkCorrectEvent:Ot=>me.mouseButton(Ot)===0&&Ot.ctrlKey||me.mouseButton(Ot)===2});return new Lo({clickTolerance:xt,move:(Ot,zt)=>({pitchDelta:(zt.y-Ot.y)*It}),moveStateManager:gt,enable:mt,assignEvents:No})})(t),Ve=(function({enable:mt,clickTolerance:xt,rollDegreesPerPixelMoved:It=.3},gt){const Ot=new vr({checkCorrectEvent:zt=>me.mouseButton(zt)===2&&zt.ctrlKey});return new Lo({clickTolerance:xt,move:(zt,kt)=>{const Bt=gt();let Nt=(kt.x-zt.x)*It;return kt.y<Bt.y&&(Nt=-Nt),{rollDelta:Nt}},moveStateManager:Ot,enable:mt,assignEvents:No})})(t,Re);Z.dragRotate=new zo(t,Le,Fe,Ve),this._add("mouseRotate",Le,["mousePitch"]),this._add("mousePitch",Fe,["mouseRotate","mouseRoll"]),this._add("mouseRoll",Ve,["mousePitch"]),t.interactive&&t.dragRotate&&Z.dragRotate.enable();const Xe=(function({enable:mt,clickTolerance:xt}){const It=new vr({checkCorrectEvent:gt=>me.mouseButton(gt)===0&&!gt.ctrlKey});return new Lo({clickTolerance:xt,move:(gt,Ot)=>({around:Ot,panDelta:Ot.sub(gt)}),activateOnStart:!0,moveStateManager:It,enable:mt,assignEvents:No})})(t),at=new jo(t,Z);Z.dragPan=new ac(Q,Xe,at),this._add("mousePan",Xe),this._add("touchPan",at,["touchZoom","touchRotate"]),t.interactive&&t.dragPan&&Z.dragPan.enable(t.dragPan);const ot=new Ds,lt=new Ms;Z.touchZoomRotate=new ks(Q,lt,ot,ve),this._add("touchRotate",ot,["touchPan","touchZoom"]),this._add("touchZoom",lt,["touchPan","touchRotate"]),t.interactive&&t.touchZoomRotate&&Z.touchZoomRotate.enable(t.touchZoomRotate);const pt=Z.scrollZoom=new ic(Z,(()=>this._triggerRenderFrame()));this._add("scrollZoom",pt,["mousePan"]),t.interactive&&t.scrollZoom&&Z.scrollZoom.enable(t.scrollZoom);const yt=Z.keyboard=new Fs(Z);this._add("keyboard",yt),t.interactive&&t.keyboard&&Z.keyboard.enable(),this._add("blockableMapEvent",new kn(Z))}_add(t,Z,Q){this._handlers.push({handlerName:t,handler:Z,allowed:Q}),this._handlersById[t]=Z}stop(t){if(!this._updatingCamera){for(const{handler:Z}of this._handlers)Z.reset();this._inertia.clear(),this._fireEvents({},{},t),this._changes=[]}}isActive(){for(const{handler:t}of this._handlers)if(t.isActive())return!0;return!1}isZooming(){return!!this._eventsInProgress.zoom||this._map.scrollZoom.isZooming()}isRotating(){return!!this._eventsInProgress.rotate}isMoving(){return!!Uo(this._eventsInProgress)||this.isZooming()}_blockedByActive(t,Z,Q){for(const ie in t)if(ie!==Q&&(!Z||Z.indexOf(ie)<0))return!0;return!1}_getMapTouches(t){const Z=[];for(const Q of t)this._el.contains(Q.target)&&Z.push(Q);return Z}mergeHandlerResult(t,Z,Q,ie,ue){if(!Q)return;R.e(t,Q);const de={handlerName:ie,originalEvent:Q.originalEvent||ue};Q.zoomDelta!==void 0&&(Z.zoom=de),Q.panDelta!==void 0&&(Z.drag=de),Q.rollDelta!==void 0&&(Z.roll=de),Q.pitchDelta!==void 0&&(Z.pitch=de),Q.bearingDelta!==void 0&&(Z.rotate=de)}_applyChanges(){const t={},Z={},Q={};for(const[ie,ue,de]of this._changes)ie.panDelta&&(t.panDelta=(t.panDelta||new R.P(0,0))._add(ie.panDelta)),ie.zoomDelta&&(t.zoomDelta=(t.zoomDelta||0)+ie.zoomDelta),ie.bearingDelta&&(t.bearingDelta=(t.bearingDelta||0)+ie.bearingDelta),ie.pitchDelta&&(t.pitchDelta=(t.pitchDelta||0)+ie.pitchDelta),ie.rollDelta&&(t.rollDelta=(t.rollDelta||0)+ie.rollDelta),ie.around!==void 0&&(t.around=ie.around),ie.pinchAround!==void 0&&(t.pinchAround=ie.pinchAround),ie.noInertia&&(t.noInertia=ie.noInertia),R.e(Z,ue),R.e(Q,de);this._updateMapTransform(t,Z,Q),this._changes=[]}_updateMapTransform(t,Z,Q){const ie=this._map,ue=ie._getTransformForUpdate(),de=ie.terrain;if(!(Ul(t)||de&&this._terrainMovement))return this._fireEvents(Z,Q,!0);ie._stop(!0);let{panDelta:ge,zoomDelta:ve,bearingDelta:qe,pitchDelta:Re,rollDelta:Le,around:Fe,pinchAround:Ve}=t;Ve!==void 0&&(Fe=Ve),Fe=Fe||ie.transform.centerPoint,de&&!ue.isPointOnMapSurface(Fe)&&(Fe=ue.centerPoint);const Xe={panDelta:ge,zoomDelta:ve,rollDelta:Le,pitchDelta:Re,bearingDelta:qe,around:Fe};this._map.cameraHelper.useGlobeControls&&!ue.isPointOnMapSurface(Fe)&&(Fe=ue.centerPoint);const at=Fe.distSqr(ue.centerPoint)<.01?ue.center:ue.screenPointToLocation(ge?Fe.sub(ge):Fe);this._handleMapControls({terrain:de,tr:ue,deltasForHelper:Xe,preZoomAroundLoc:at,combinedEventsInProgress:Z,panDelta:ge}),ie._applyUpdatedTransform(ue),this._map._update(),t.noInertia||this._inertia.record(t),this._fireEvents(Z,Q,!0)}_handleMapControls({terrain:t,tr:Z,deltasForHelper:Q,preZoomAroundLoc:ie,combinedEventsInProgress:ue,panDelta:de}){const ge=this._map.cameraHelper;if(ge.handleMapControlsRollPitchBearingZoom(Q,Z),t)return ge.useGlobeControls?(this._terrainMovement||!ue.drag&&!ue.zoom||(this._terrainMovement=!0,this._map._elevationFreeze=!0),void ge.handleMapControlsPan(Q,Z,ie)):this._terrainMovement||!ue.drag&&!ue.zoom?void(ue.drag&&this._terrainMovement&&de?Z.setCenter(Z.screenPointToLocation(Z.centerPoint.sub(de))):ge.handleMapControlsPan(Q,Z,ie)):(this._terrainMovement=!0,this._map._elevationFreeze=!0,void ge.handleMapControlsPan(Q,Z,ie));ge.handleMapControlsPan(Q,Z,ie)}_fireEvents(t,Z,Q){const ie=Uo(this._eventsInProgress),ue=Uo(t),de={};for(const Le in t){const{originalEvent:Fe}=t[Le];this._eventsInProgress[Le]||(de[`${Le}start`]=Fe),this._eventsInProgress[Le]=t[Le]}!ie&&ue&&this._fireEvent("movestart",ue.originalEvent);for(const Le in de)this._fireEvent(Le,de[Le]);ue&&this._fireEvent("move",ue.originalEvent);for(const Le in t){const{originalEvent:Fe}=t[Le];this._fireEvent(Le,Fe)}const ge={};let ve;for(const Le in this._eventsInProgress){const{handlerName:Fe,originalEvent:Ve}=this._eventsInProgress[Le];this._handlersById[Fe].isActive()||(delete this._eventsInProgress[Le],ve=Z[Fe]||Ve,ge[`${Le}end`]=ve)}for(const Le in ge)this._fireEvent(Le,ge[Le]);const qe=Uo(this._eventsInProgress),Re=(ie||ue)&&!qe;if(Re&&this._terrainMovement){this._map._elevationFreeze=!1,this._terrainMovement=!1;const Le=this._map._getTransformForUpdate();this._map.getCenterClampedToGround()&&Le.recalculateZoomAndCenter(this._map.terrain),this._map._applyUpdatedTransform(Le)}if(Q&&Re){this._updatingCamera=!0;const Le=this._inertia._onMoveEnd(this._map.dragPan._inertiaOptions),Fe=Ve=>Ve!==0&&-this._bearingSnap<Ve&&Ve<this._bearingSnap;!Le||!Le.essential&&_e.prefersReducedMotion?(this._map.fire(new R.l("moveend",{originalEvent:ve})),Fe(this._map.getBearing())&&this._map.resetNorth()):(Fe(Le.bearing||this._map.getBearing())&&(Le.bearing=0),Le.freezeElevation=!0,this._map.easeTo(Le,{originalEvent:ve})),this._updatingCamera=!1}}_fireEvent(t,Z){this._map.fire(new R.l(t,Z?{originalEvent:Z}:{}))}_requestFrame(){return this._map.triggerRepaint(),this._map._renderTaskQueue.add((t=>{delete this._frameId,this.handleEvent(new oc("renderFrame",{timeStamp:t})),this._applyChanges()}))}_triggerRenderFrame(){this._frameId===void 0&&(this._frameId=this._requestFrame())}}class Ls extends R.E{constructor(t,Z,Q){super(),this._renderFrameCallback=()=>{const ie=Math.min((_e.now()-this._easeStart)/this._easeOptions.duration,1);this._onEaseFrame(this._easeOptions.easing(ie)),ie<1&&this._easeFrameId?this._easeFrameId=this._requestRenderFrame(this._renderFrameCallback):this.stop()},this._moving=!1,this._zooming=!1,this.transform=t,this._bearingSnap=Q.bearingSnap,this.cameraHelper=Z,this.on("moveend",(()=>{delete this._requestedCameraState}))}migrateProjection(t,Z){t.apply(this.transform),this.transform=t,this.cameraHelper=Z}getCenter(){return new R.S(this.transform.center.lng,this.transform.center.lat)}setCenter(t,Z){return this.jumpTo({center:t},Z)}getCenterElevation(){return this.transform.elevation}setCenterElevation(t,Z){return this.jumpTo({elevation:t},Z),this}getCenterClampedToGround(){return this._centerClampedToGround}setCenterClampedToGround(t){this._centerClampedToGround=t}panBy(t,Z,Q){return t=R.P.convert(t).mult(-1),this.panTo(this.transform.center,R.e({offset:t},Z),Q)}panTo(t,Z,Q){return this.easeTo(R.e({center:t},Z),Q)}getZoom(){return this.transform.zoom}setZoom(t,Z){return this.jumpTo({zoom:t},Z),this}zoomTo(t,Z,Q){return this.easeTo(R.e({zoom:t},Z),Q)}zoomIn(t,Z){return this.zoomTo(this.getZoom()+1,t,Z),this}zoomOut(t,Z){return this.zoomTo(this.getZoom()-1,t,Z),this}getVerticalFieldOfView(){return this.transform.fov}setVerticalFieldOfView(t,Z){return t!=this.transform.fov&&(this.transform.setFov(t),this.fire(new R.l("movestart",Z)).fire(new R.l("move",Z)).fire(new R.l("moveend",Z))),this}getBearing(){return this.transform.bearing}setBearing(t,Z){return this.jumpTo({bearing:t},Z),this}getPadding(){return this.transform.padding}setPadding(t,Z){return this.jumpTo({padding:t},Z),this}rotateTo(t,Z,Q){return this.easeTo(R.e({bearing:t},Z),Q)}resetNorth(t,Z){return this.rotateTo(0,R.e({duration:1e3},t),Z),this}resetNorthPitch(t,Z){return this.easeTo(R.e({bearing:0,pitch:0,roll:0,duration:1e3},t),Z),this}snapToNorth(t,Z){return Math.abs(this.getBearing())<this._bearingSnap?this.resetNorth(t,Z):this}getPitch(){return this.transform.pitch}setPitch(t,Z){return this.jumpTo({pitch:t},Z),this}getRoll(){return this.transform.roll}setRoll(t,Z){return this.jumpTo({roll:t},Z),this}cameraForBounds(t,Z){t=gr.convert(t).adjustAntiMeridian();const Q=Z&&Z.bearing||0;return this._cameraForBoxAndBearing(t.getNorthWest(),t.getSouthEast(),Q,Z)}_cameraForBoxAndBearing(t,Z,Q,ie){const ue={top:0,bottom:0,right:0,left:0};if(typeof(ie=R.e({padding:ue,offset:[0,0],maxZoom:this.transform.maxZoom},ie)).padding=="number"){const qe=ie.padding;ie.padding={top:qe,bottom:qe,right:qe,left:qe}}const de=R.e(ue,ie.padding);ie.padding=de;const ge=this.transform,ve=new gr(t,Z);return this.cameraHelper.cameraForBoxAndBearing(ie,de,ve,Q,ge)}fitBounds(t,Z,Q){return this._fitInternal(this.cameraForBounds(t,Z),Z,Q)}fitScreenCoordinates(t,Z,Q,ie,ue){return this._fitInternal(this._cameraForBoxAndBearing(this.transform.screenPointToLocation(R.P.convert(t)),this.transform.screenPointToLocation(R.P.convert(Z)),Q,ie),ie,ue)}_fitInternal(t,Z,Q){return t?(delete(Z=R.e(t,Z)).padding,Z.linear?this.easeTo(Z,Q):this.flyTo(Z,Q)):this}jumpTo(t,Z){this.stop();const Q=this._getTransformForUpdate();let ie=!1,ue=!1,de=!1;const ge=Q.zoom;this.cameraHelper.handleJumpToCenterZoom(Q,t);const ve=Q.zoom!==ge;return"elevation"in t&&Q.elevation!==+t.elevation&&Q.setElevation(+t.elevation),"bearing"in t&&Q.bearing!==+t.bearing&&(ie=!0,Q.setBearing(+t.bearing)),"pitch"in t&&Q.pitch!==+t.pitch&&(ue=!0,Q.setPitch(+t.pitch)),"roll"in t&&Q.roll!==+t.roll&&(de=!0,Q.setRoll(+t.roll)),t.padding==null||Q.isPaddingEqual(t.padding)||Q.setPadding(t.padding),this._applyUpdatedTransform(Q),this.fire(new R.l("movestart",Z)).fire(new R.l("move",Z)),ve&&this.fire(new R.l("zoomstart",Z)).fire(new R.l("zoom",Z)).fire(new R.l("zoomend",Z)),ie&&this.fire(new R.l("rotatestart",Z)).fire(new R.l("rotate",Z)).fire(new R.l("rotateend",Z)),ue&&this.fire(new R.l("pitchstart",Z)).fire(new R.l("pitch",Z)).fire(new R.l("pitchend",Z)),de&&this.fire(new R.l("rollstart",Z)).fire(new R.l("roll",Z)).fire(new R.l("rollend",Z)),this.fire(new R.l("moveend",Z))}calculateCameraOptionsFromTo(t,Z,Q,ie=0){const ue=R.a1.fromLngLat(t,Z),de=R.a1.fromLngLat(Q,ie),ge=de.x-ue.x,ve=de.y-ue.y,qe=de.z-ue.z,Re=Math.hypot(ge,ve,qe);if(Re===0)throw new Error("Can't calculate camera options with same From and To");const Le=Math.hypot(ge,ve),Fe=R.ak(this.transform.cameraToCenterDistance/Re/this.transform.tileSize),Ve=180*Math.atan2(ge,-ve)/Math.PI;let Xe=180*Math.acos(Le/Re)/Math.PI;return Xe=qe<0?90-Xe:90+Xe,{center:de.toLngLat(),elevation:ie,zoom:Fe,pitch:Xe,bearing:Ve}}calculateCameraOptionsFromCameraLngLatAltRotation(t,Z,Q,ie,ue){const de=this.transform.calculateCenterFromCameraLngLatAlt(t,Z,Q,ie);return{center:de.center,elevation:de.elevation,zoom:de.zoom,bearing:Q,pitch:ie,roll:ue}}easeTo(t,Z){this._stop(!1,t.easeId),((t=R.e({offset:[0,0],duration:500,easing:R.co},t)).animate===!1||!t.essential&&_e.prefersReducedMotion)&&(t.duration=0);const Q=this._getTransformForUpdate(),ie=this.getBearing(),ue=Q.pitch,de=Q.roll,ge="bearing"in t?this._normalizeBearing(t.bearing,ie):ie,ve="pitch"in t?+t.pitch:ue,qe="roll"in t?this._normalizeBearing(t.roll,de):de,Re="padding"in t?t.padding:Q.padding,Le=R.P.convert(t.offset);let Fe,Ve;t.around&&(Fe=R.S.convert(t.around),Ve=Q.locationToScreenPoint(Fe));const Xe={moving:this._moving,zooming:this._zooming,rotating:this._rotating,pitching:this._pitching,rolling:this._rolling},at=this.cameraHelper.handleEaseTo(Q,{bearing:ge,pitch:ve,roll:qe,padding:Re,around:Fe,aroundPoint:Ve,offsetAsPoint:Le,offset:t.offset,zoom:t.zoom,center:t.center});return this._rotating=this._rotating||ie!==ge,this._pitching=this._pitching||ve!==ue,this._rolling=this._rolling||qe!==de,this._padding=!Q.isPaddingEqual(Re),this._zooming=this._zooming||at.isZooming,this._easeId=t.easeId,this._prepareEase(Z,t.noMoveStart,Xe),this.terrain&&this._prepareElevation(at.elevationCenter),this._ease((ot=>{at.easeFunc(ot),this.terrain&&!t.freezeElevation&&this._updateElevation(ot),this._applyUpdatedTransform(Q),this._fireMoveEvents(Z)}),(ot=>{this.terrain&&t.freezeElevation&&this._finalizeElevation(),this._afterEase(Z,ot)}),t),this}_prepareEase(t,Z,Q={}){this._moving=!0,Z||Q.moving||this.fire(new R.l("movestart",t)),this._zooming&&!Q.zooming&&this.fire(new R.l("zoomstart",t)),this._rotating&&!Q.rotating&&this.fire(new R.l("rotatestart",t)),this._pitching&&!Q.pitching&&this.fire(new R.l("pitchstart",t)),this._rolling&&!Q.rolling&&this.fire(new R.l("rollstart",t))}_prepareElevation(t){this._elevationCenter=t,this._elevationStart=this.transform.elevation,this._elevationTarget=this.terrain.getElevationForLngLatZoom(t,this.transform.tileZoom),this._elevationFreeze=!0}_updateElevation(t){this._elevationStart!==void 0&&this._elevationCenter!==void 0||this._prepareElevation(this.transform.center),this.transform.setMinElevationForCurrentTile(this.terrain.getMinTileElevationForLngLatZoom(this._elevationCenter,this.transform.tileZoom));const Z=this.terrain.getElevationForLngLatZoom(this._elevationCenter,this.transform.tileZoom);if(t<1&&Z!==this._elevationTarget){const Q=this._elevationTarget-this._elevationStart;this._elevationStart+=t*(Q-(Z-(Q*t+this._elevationStart))/(1-t)),this._elevationTarget=Z}this.transform.setElevation(R.C.number(this._elevationStart,this._elevationTarget,t))}_finalizeElevation(){this._elevationFreeze=!1,this.getCenterClampedToGround()&&this.transform.recalculateZoomAndCenter(this.terrain)}_getTransformForUpdate(){return this.transformCameraUpdate||this.terrain?(this._requestedCameraState||(this._requestedCameraState=this.transform.clone()),this._requestedCameraState):this.transform}_elevateCameraIfInsideTerrain(t){if(!this.terrain&&t.elevation>=0&&t.pitch<=90)return{};const Z=t.getCameraLngLat(),Q=t.getCameraAltitude(),ie=this.terrain?this.terrain.getElevationForLngLatZoom(Z,t.zoom):0;if(Q<ie){const ue=this.calculateCameraOptionsFromTo(Z,ie,t.center,t.elevation);return{pitch:ue.pitch,zoom:ue.zoom}}return{}}_applyUpdatedTransform(t){const Z=[];if(Z.push((ie=>this._elevateCameraIfInsideTerrain(ie))),this.transformCameraUpdate&&Z.push((ie=>this.transformCameraUpdate(ie))),!Z.length)return;const Q=t.clone();for(const ie of Z){const ue=Q.clone(),{center:de,zoom:ge,roll:ve,pitch:qe,bearing:Re,elevation:Le}=ie(ue);de&&ue.setCenter(de),Le!==void 0&&ue.setElevation(Le),ge!==void 0&&ue.setZoom(ge),ve!==void 0&&ue.setRoll(ve),qe!==void 0&&ue.setPitch(qe),Re!==void 0&&ue.setBearing(Re),Q.apply(ue)}this.transform.apply(Q)}_fireMoveEvents(t){this.fire(new R.l("move",t)),this._zooming&&this.fire(new R.l("zoom",t)),this._rotating&&this.fire(new R.l("rotate",t)),this._pitching&&this.fire(new R.l("pitch",t)),this._rolling&&this.fire(new R.l("roll",t))}_afterEase(t,Z){if(this._easeId&&Z&&this._easeId===Z)return;delete this._easeId;const Q=this._zooming,ie=this._rotating,ue=this._pitching,de=this._rolling;this._moving=!1,this._zooming=!1,this._rotating=!1,this._pitching=!1,this._rolling=!1,this._padding=!1,Q&&this.fire(new R.l("zoomend",t)),ie&&this.fire(new R.l("rotateend",t)),ue&&this.fire(new R.l("pitchend",t)),de&&this.fire(new R.l("rollend",t)),this.fire(new R.l("moveend",t))}flyTo(t,Z){if(!t.essential&&_e.prefersReducedMotion){const Nt=R.Q(t,["center","zoom","bearing","pitch","roll","elevation"]);return this.jumpTo(Nt,Z)}this.stop(),t=R.e({offset:[0,0],speed:1.2,curve:1.42,easing:R.co},t);const Q=this._getTransformForUpdate(),ie=Q.bearing,ue=Q.pitch,de=Q.roll,ge=Q.padding,ve="bearing"in t?this._normalizeBearing(t.bearing,ie):ie,qe="pitch"in t?+t.pitch:ue,Re="roll"in t?this._normalizeBearing(t.roll,de):de,Le="padding"in t?t.padding:Q.padding,Fe=R.P.convert(t.offset);let Ve=Q.centerPoint.add(Fe);const Xe=Q.screenPointToLocation(Ve),at=this.cameraHelper.handleFlyTo(Q,{bearing:ve,pitch:qe,roll:Re,padding:Le,locationAtOffset:Xe,offsetAsPoint:Fe,center:t.center,minZoom:t.minZoom,zoom:t.zoom});let ot=t.curve;const lt=Math.max(Q.width,Q.height),pt=lt/at.scaleOfZoom,yt=at.pixelPathLength;typeof at.scaleOfMinZoom=="number"&&(ot=Math.sqrt(lt/at.scaleOfMinZoom/yt*2));const mt=ot*ot;function xt(Nt){const ar=(pt*pt-lt*lt+(Nt?-1:1)*mt*mt*yt*yt)/(2*(Nt?pt:lt)*mt*yt);return Math.log(Math.sqrt(ar*ar+1)-ar)}function It(Nt){return(Math.exp(Nt)-Math.exp(-Nt))/2}function gt(Nt){return(Math.exp(Nt)+Math.exp(-Nt))/2}const Ot=xt(!1);let zt=function(Nt){return gt(Ot)/gt(Ot+ot*Nt)},kt=function(Nt){return lt*((gt(Ot)*(It(ar=Ot+ot*Nt)/gt(ar))-It(Ot))/mt)/yt;var ar},Bt=(xt(!0)-Ot)/ot;if(Math.abs(yt)<2e-6||!isFinite(Bt)){if(Math.abs(lt-pt)<1e-6)return this.easeTo(t,Z);const Nt=pt<lt?-1:1;Bt=Math.abs(Math.log(pt/lt))/ot,kt=()=>0,zt=ar=>Math.exp(Nt*ot*ar)}return t.duration="duration"in t?+t.duration:1e3*Bt/("screenSpeed"in t?+t.screenSpeed/ot:+t.speed),t.maxDuration&&t.duration>t.maxDuration&&(t.duration=0),this._zooming=!0,this._rotating=ie!==ve,this._pitching=qe!==ue,this._rolling=Re!==de,this._padding=!Q.isPaddingEqual(Le),this._prepareEase(Z,!1),this.terrain&&this._prepareElevation(at.targetCenter),this._ease((Nt=>{const ar=Nt*Bt,sr=1/zt(ar),Kt=kt(ar);this._rotating&&Q.setBearing(R.C.number(ie,ve,Nt)),this._pitching&&Q.setPitch(R.C.number(ue,qe,Nt)),this._rolling&&Q.setRoll(R.C.number(de,Re,Nt)),this._padding&&(Q.interpolatePadding(ge,Le,Nt),Ve=Q.centerPoint.add(Fe)),at.easeFunc(Nt,sr,Kt,Ve),this.terrain&&!t.freezeElevation&&this._updateElevation(Nt),this._applyUpdatedTransform(Q),this._fireMoveEvents(Z)}),(()=>{this.terrain&&t.freezeElevation&&this._finalizeElevation(),this._afterEase(Z)}),t),this}isEasing(){return!!this._easeFrameId}stop(){return this._stop()}_stop(t,Z){var Q;if(this._easeFrameId&&(this._cancelRenderFrame(this._easeFrameId),delete this._easeFrameId,delete this._onEaseFrame),this._onEaseEnd){const ie=this._onEaseEnd;delete this._onEaseEnd,ie.call(this,Z)}return t||(Q=this.handlers)===null||Q===void 0||Q.stop(!1),this}_ease(t,Z,Q){Q.animate===!1||Q.duration===0?(t(1),Z()):(this._easeStart=_e.now(),this._easeOptions=Q,this._onEaseFrame=t,this._onEaseEnd=Z,this._easeFrameId=this._requestRenderFrame(this._renderFrameCallback))}_normalizeBearing(t,Z){t=R.aO(t,-180,180);const Q=Math.abs(t-Z);return Math.abs(t-360-Z)<Q&&(t-=360),Math.abs(t+360-Z)<Q&&(t+=360),t}queryTerrainElevation(t){return this.terrain?this.terrain.getElevationForLngLatZoom(R.S.convert(t),this.transform.tileZoom):null}}const Ar={compact:!0,customAttribution:'<a href="https://maplibre.org/" target="_blank">MapLibre</a>'};class Br{constructor(t=Ar){this._toggleAttribution=()=>{this._container.classList.contains("maplibregl-compact")&&(this._container.classList.contains("maplibregl-compact-show")?(this._container.setAttribute("open",""),this._container.classList.remove("maplibregl-compact-show")):(this._container.classList.add("maplibregl-compact-show"),this._container.removeAttribute("open")))},this._updateData=Z=>{!Z||Z.sourceDataType!=="metadata"&&Z.sourceDataType!=="visibility"&&Z.dataType!=="style"&&Z.type!=="terrain"||this._updateAttributions()},this._updateCompact=()=>{this._map.getCanvasContainer().offsetWidth<=640||this._compact?this._compact===!1?this._container.setAttribute("open",""):this._container.classList.contains("maplibregl-compact")||this._container.classList.contains("maplibregl-attrib-empty")||(this._container.setAttribute("open",""),this._container.classList.add("maplibregl-compact","maplibregl-compact-show")):(this._container.setAttribute("open",""),this._container.classList.contains("maplibregl-compact")&&this._container.classList.remove("maplibregl-compact","maplibregl-compact-show"))},this._updateCompactMinimize=()=>{this._container.classList.contains("maplibregl-compact")&&this._container.classList.contains("maplibregl-compact-show")&&this._container.classList.remove("maplibregl-compact-show")},this.options=t}getDefaultPosition(){return"bottom-right"}onAdd(t){return this._map=t,this._compact=this.options.compact,this._container=me.create("details","maplibregl-ctrl maplibregl-ctrl-attrib"),this._compactButton=me.create("summary","maplibregl-ctrl-attrib-button",this._container),this._compactButton.addEventListener("click",this._toggleAttribution),this._setElementTitle(this._compactButton,"ToggleAttribution"),this._innerContainer=me.create("div","maplibregl-ctrl-attrib-inner",this._container),this._updateAttributions(),this._updateCompact(),this._map.on("styledata",this._updateData),this._map.on("sourcedata",this._updateData),this._map.on("terrain",this._updateData),this._map.on("resize",this._updateCompact),this._map.on("drag",this._updateCompactMinimize),this._container}onRemove(){me.remove(this._container),this._map.off("styledata",this._updateData),this._map.off("sourcedata",this._updateData),this._map.off("terrain",this._updateData),this._map.off("resize",this._updateCompact),this._map.off("drag",this._updateCompactMinimize),this._map=void 0,this._compact=void 0,this._attribHTML=void 0}_setElementTitle(t,Z){const Q=this._map._getUIString(`AttributionControl.${Z}`);t.title=Q,t.setAttribute("aria-label",Q)}_updateAttributions(){if(!this._map.style)return;let t=[];if(this.options.customAttribution&&(Array.isArray(this.options.customAttribution)?t=t.concat(this.options.customAttribution.map((ie=>typeof ie!="string"?"":ie))):typeof this.options.customAttribution=="string"&&t.push(this.options.customAttribution)),this._map.style.stylesheet){const ie=this._map.style.stylesheet;this.styleOwner=ie.owner,this.styleId=ie.id}const Z=this._map.style.sourceCaches;for(const ie in Z){const ue=Z[ie];if(ue.used||ue.usedForTerrain){const de=ue.getSource();de.attribution&&t.indexOf(de.attribution)<0&&t.push(de.attribution)}}t=t.filter((ie=>String(ie).trim())),t.sort(((ie,ue)=>ie.length-ue.length)),t=t.filter(((ie,ue)=>{for(let de=ue+1;de<t.length;de++)if(t[de].indexOf(ie)>=0)return!1;return!0}));const Q=t.join(" | ");Q!==this._attribHTML&&(this._attribHTML=Q,t.length?(this._innerContainer.innerHTML=me.sanitize(Q),this._container.classList.remove("maplibregl-attrib-empty")):this._container.classList.add("maplibregl-attrib-empty"),this._updateCompact(),this._editLink=null)}}class ao{constructor(t={}){this._updateCompact=()=>{const Z=this._container.children;if(Z.length){const Q=Z[0];this._map.getCanvasContainer().offsetWidth<=640||this._compact?this._compact!==!1&&Q.classList.add("maplibregl-compact"):Q.classList.remove("maplibregl-compact")}},this.options=t}getDefaultPosition(){return"bottom-left"}onAdd(t){this._map=t,this._compact=this.options&&this.options.compact,this._container=me.create("div","maplibregl-ctrl");const Z=me.create("a","maplibregl-ctrl-logo");return Z.target="_blank",Z.rel="noopener nofollow",Z.href="https://maplibre.org/",Z.setAttribute("aria-label",this._map._getUIString("LogoControl.Title")),Z.setAttribute("rel","noopener nofollow"),this._container.appendChild(Z),this._container.style.display="block",this._map.on("resize",this._updateCompact),this._updateCompact(),this._container}onRemove(){me.remove(this._container),this._map.off("resize",this._updateCompact),this._map=void 0,this._compact=void 0}}class sc{constructor(){this._queue=[],this._id=0,this._cleared=!1,this._currentlyRunning=!1}add(t){const Z=++this._id;return this._queue.push({callback:t,id:Z,cancelled:!1}),Z}remove(t){const Z=this._currentlyRunning,Q=Z?this._queue.concat(Z):this._queue;for(const ie of Q)if(ie.id===t)return void(ie.cancelled=!0)}run(t=0){if(this._currentlyRunning)throw new Error("Attempting to run(), but is already running.");const Z=this._currentlyRunning=this._queue;this._queue=[];for(const Q of Z)if(!Q.cancelled&&(Q.callback(t),this._cleared))break;this._cleared=!1,this._currentlyRunning=!1}clear(){this._currentlyRunning&&(this._cleared=!0),this._queue=[]}}var Bs=R.aJ([{name:"a_pos3d",type:"Int16",components:3}]);class pn extends R.E{constructor(t){super(),this._lastTilesetChange=_e.now(),this.sourceCache=t,this._tiles={},this._renderableTilesKeys=[],this._sourceTileCache={},this.minzoom=0,this.maxzoom=22,this.deltaZoom=1,this.tileSize=t._source.tileSize*2**this.deltaZoom,t.usedForTerrain=!0,t.tileSize=this.tileSize}destruct(){this.sourceCache.usedForTerrain=!1,this.sourceCache.tileSize=null}update(t,Z){this.sourceCache.update(t,Z),this._renderableTilesKeys=[];const Q={};for(const ie of Er(t,{tileSize:this.tileSize,minzoom:this.minzoom,maxzoom:this.maxzoom,reparseOverscaled:!1,terrain:Z,calculateTileZoom:this.sourceCache._source.calculateTileZoom}))Q[ie.key]=!0,this._renderableTilesKeys.push(ie.key),this._tiles[ie.key]||(ie.terrainRttPosMatrix32f=new Float64Array(16),R.bZ(ie.terrainRttPosMatrix32f,0,R.$,R.$,0,0,1),this._tiles[ie.key]=new xe(ie,this.tileSize),this._lastTilesetChange=_e.now());for(const ie in this._tiles)Q[ie]||delete this._tiles[ie]}freeRtt(t){for(const Z in this._tiles){const Q=this._tiles[Z];(!t||Q.tileID.equals(t)||Q.tileID.isChildOf(t)||t.isChildOf(Q.tileID))&&(Q.rtt=[])}}getRenderableTiles(){return this._renderableTilesKeys.map((t=>this.getTileByID(t)))}getTileByID(t){return this._tiles[t]}getTerrainCoords(t,Z){return Z?this._getTerrainCoordsForTileRanges(t,Z):this._getTerrainCoordsForRegularTile(t)}_getTerrainCoordsForRegularTile(t){const Z={};for(const Q of this._renderableTilesKeys){const ie=this._tiles[Q].tileID,ue=t.clone(),de=R.ba();if(ie.canonical.equals(t.canonical))R.bZ(de,0,R.$,R.$,0,0,1);else if(ie.canonical.isChildOf(t.canonical)){const ge=ie.canonical.z-t.canonical.z,ve=ie.canonical.x-(ie.canonical.x>>ge<<ge),qe=ie.canonical.y-(ie.canonical.y>>ge<<ge),Re=R.$>>ge;R.bZ(de,0,Re,Re,0,0,1),R.M(de,de,[-ve*Re,-qe*Re,0])}else{if(!t.canonical.isChildOf(ie.canonical))continue;{const ge=t.canonical.z-ie.canonical.z,ve=t.canonical.x-(t.canonical.x>>ge<<ge),qe=t.canonical.y-(t.canonical.y>>ge<<ge),Re=R.$>>ge;R.bZ(de,0,R.$,R.$,0,0,1),R.M(de,de,[ve*Re,qe*Re,0]),R.N(de,de,[1/2**ge,1/2**ge,0])}}ue.terrainRttPosMatrix32f=new Float32Array(de),Z[Q]=ue}return Z}_getTerrainCoordsForTileRanges(t,Z){const Q={};for(const ie of this._renderableTilesKeys){const ue=this._tiles[ie].tileID;if(!this._isWithinTileRanges(ue,Z))continue;const de=t.clone(),ge=R.ba();if(ue.canonical.z===t.canonical.z){const ve=t.canonical.x-ue.canonical.x,qe=t.canonical.y-ue.canonical.y;R.bZ(ge,0,R.$,R.$,0,0,1),R.M(ge,ge,[ve*R.$,qe*R.$,0])}else if(ue.canonical.z>t.canonical.z){const ve=ue.canonical.z-t.canonical.z,qe=ue.canonical.x-(ue.canonical.x>>ve<<ve),Re=ue.canonical.y-(ue.canonical.y>>ve<<ve),Le=t.canonical.x-(ue.canonical.x>>ve),Fe=t.canonical.y-(ue.canonical.y>>ve),Ve=R.$>>ve;R.bZ(ge,0,Ve,Ve,0,0,1),R.M(ge,ge,[-qe*Ve+Le*R.$,-Re*Ve+Fe*R.$,0])}else{const ve=t.canonical.z-ue.canonical.z,qe=t.canonical.x-(t.canonical.x>>ve<<ve),Re=t.canonical.y-(t.canonical.y>>ve<<ve),Le=(t.canonical.x>>ve)-ue.canonical.x,Fe=(t.canonical.y>>ve)-ue.canonical.y,Ve=R.$<<ve;R.bZ(ge,0,Ve,Ve,0,0,1),R.M(ge,ge,[qe*R.$+Le*Ve,Re*R.$+Fe*Ve,0])}de.terrainRttPosMatrix32f=new Float32Array(ge),Q[ie]=de}return Q}getSourceTile(t,Z){const Q=this.sourceCache._source;let ie=t.overscaledZ-this.deltaZoom;if(ie>Q.maxzoom&&(ie=Q.maxzoom),ie<Q.minzoom)return null;this._sourceTileCache[t.key]||(this._sourceTileCache[t.key]=t.scaledTo(ie).key);let ue=this.sourceCache.getTileByID(this._sourceTileCache[t.key]);if((!ue||!ue.dem)&&Z)for(;ie>=Q.minzoom&&(!ue||!ue.dem);)ue=this.sourceCache.getTileByID(t.scaledTo(ie--).key);return ue}anyTilesAfterTime(t=Date.now()){return this._lastTilesetChange>=t}_isWithinTileRanges(t,Z){return Z[t.canonical.z]&&t.canonical.x>=Z[t.canonical.z].minTileX&&t.canonical.x<=Z[t.canonical.z].maxTileX&&t.canonical.y>=Z[t.canonical.z].minTileY&&t.canonical.y<=Z[t.canonical.z].maxTileY}}class lc{constructor(t,Z,Q){this._meshCache={},this.painter=t,this.sourceCache=new pn(Z),this.options=Q,this.exaggeration=typeof Q.exaggeration=="number"?Q.exaggeration:1,this.qualityFactor=2,this.meshSize=128,this._demMatrixCache={},this.coordsIndex=[],this._coordsTextureSize=1024}getDEMElevation(t,Z,Q,ie=R.$){var ue;if(!(Z>=0&&Z<ie&&Q>=0&&Q<ie))return 0;const de=this.getTerrainData(t),ge=(ue=de.tile)===null||ue===void 0?void 0:ue.dem;if(!ge)return 0;const ve=R.cs([],[Z/ie*R.$,Q/ie*R.$],de.u_terrain_matrix),qe=[ve[0]*ge.dim,ve[1]*ge.dim],Re=Math.floor(qe[0]),Le=Math.floor(qe[1]),Fe=qe[0]-Re,Ve=qe[1]-Le;return ge.get(Re,Le)*(1-Fe)*(1-Ve)+ge.get(Re+1,Le)*Fe*(1-Ve)+ge.get(Re,Le+1)*(1-Fe)*Ve+ge.get(Re+1,Le+1)*Fe*Ve}getElevationForLngLatZoom(t,Z){if(!R.ct(Z,t.wrap()))return 0;const{tileID:Q,mercatorX:ie,mercatorY:ue}=this._getOverscaledTileIDFromLngLatZoom(t,Z);return this.getElevation(Q,ie%R.$,ue%R.$,R.$)}getElevation(t,Z,Q,ie=R.$){return this.getDEMElevation(t,Z,Q,ie)*this.exaggeration}getTerrainData(t){if(!this._emptyDemTexture){const ie=this.painter.context,ue=new R.R({width:1,height:1},new Uint8Array(4));this._emptyDepthTexture=new R.T(ie,ue,ie.gl.RGBA,{premultiply:!1}),this._emptyDemUnpack=[0,0,0,0],this._emptyDemTexture=new R.T(ie,new R.R({width:1,height:1}),ie.gl.RGBA,{premultiply:!1}),this._emptyDemTexture.bind(ie.gl.NEAREST,ie.gl.CLAMP_TO_EDGE),this._emptyDemMatrix=R.ag([])}const Z=this.sourceCache.getSourceTile(t,!0);if(Z&&Z.dem&&(!Z.demTexture||Z.needsTerrainPrepare)){const ie=this.painter.context;Z.demTexture=this.painter.getTileTexture(Z.dem.stride),Z.demTexture?Z.demTexture.update(Z.dem.getPixels(),{premultiply:!1}):Z.demTexture=new R.T(ie,Z.dem.getPixels(),ie.gl.RGBA,{premultiply:!1}),Z.demTexture.bind(ie.gl.NEAREST,ie.gl.CLAMP_TO_EDGE),Z.needsTerrainPrepare=!1}const Q=Z&&Z+Z.tileID.key+t.key;if(Q&&!this._demMatrixCache[Q]){const ie=this.sourceCache.sourceCache._source.maxzoom;let ue=t.canonical.z-Z.tileID.canonical.z;t.overscaledZ>t.canonical.z&&(t.canonical.z>=ie?ue=t.canonical.z-ie:R.w("cannot calculate elevation if elevation maxzoom > source.maxzoom"));const de=t.canonical.x-(t.canonical.x>>ue<<ue),ge=t.canonical.y-(t.canonical.y>>ue<<ue),ve=R.cu(new Float64Array(16),[1/(R.$<<ue),1/(R.$<<ue),0]);R.M(ve,ve,[de*R.$,ge*R.$,0]),this._demMatrixCache[t.key]={matrix:ve,coord:t}}return{u_depth:2,u_terrain:3,u_terrain_dim:Z&&Z.dem&&Z.dem.dim||1,u_terrain_matrix:Q?this._demMatrixCache[t.key].matrix:this._emptyDemMatrix,u_terrain_unpack:Z&&Z.dem&&Z.dem.getUnpackVector()||this._emptyDemUnpack,u_terrain_exaggeration:this.exaggeration,texture:(Z&&Z.demTexture||this._emptyDemTexture).texture,depthTexture:(this._fboDepthTexture||this._emptyDepthTexture).texture,tile:Z}}getFramebuffer(t){const Z=this.painter,Q=Z.width/devicePixelRatio,ie=Z.height/devicePixelRatio;return!this._fbo||this._fbo.width===Q&&this._fbo.height===ie||(this._fbo.destroy(),this._fboCoordsTexture.destroy(),this._fboDepthTexture.destroy(),delete this._fbo,delete this._fboDepthTexture,delete this._fboCoordsTexture),this._fboCoordsTexture||(this._fboCoordsTexture=new R.T(Z.context,{width:Q,height:ie,data:null},Z.context.gl.RGBA,{premultiply:!1}),this._fboCoordsTexture.bind(Z.context.gl.NEAREST,Z.context.gl.CLAMP_TO_EDGE)),this._fboDepthTexture||(this._fboDepthTexture=new R.T(Z.context,{width:Q,height:ie,data:null},Z.context.gl.RGBA,{premultiply:!1}),this._fboDepthTexture.bind(Z.context.gl.NEAREST,Z.context.gl.CLAMP_TO_EDGE)),this._fbo||(this._fbo=Z.context.createFramebuffer(Q,ie,!0,!1),this._fbo.depthAttachment.set(Z.context.createRenderbuffer(Z.context.gl.DEPTH_COMPONENT16,Q,ie))),this._fbo.colorAttachment.set(t==="coords"?this._fboCoordsTexture.texture:this._fboDepthTexture.texture),this._fbo}getCoordsTexture(){const t=this.painter.context;if(this._coordsTexture)return this._coordsTexture;const Z=new Uint8Array(this._coordsTextureSize*this._coordsTextureSize*4);for(let ue=0,de=0;ue<this._coordsTextureSize;ue++)for(let ge=0;ge<this._coordsTextureSize;ge++,de+=4)Z[de+0]=255&ge,Z[de+1]=255&ue,Z[de+2]=ge>>8<<4|ue>>8,Z[de+3]=0;const Q=new R.R({width:this._coordsTextureSize,height:this._coordsTextureSize},new Uint8Array(Z.buffer)),ie=new R.T(t,Q,t.gl.RGBA,{premultiply:!1});return ie.bind(t.gl.NEAREST,t.gl.CLAMP_TO_EDGE),this._coordsTexture=ie,ie}pointCoordinate(t){this.painter.maybeDrawDepthAndCoords(!0);const Z=new Uint8Array(4),Q=this.painter.context,ie=Q.gl,ue=Math.round(t.x*this.painter.pixelRatio/devicePixelRatio),de=Math.round(t.y*this.painter.pixelRatio/devicePixelRatio),ge=Math.round(this.painter.height/devicePixelRatio);Q.bindFramebuffer.set(this.getFramebuffer("coords").framebuffer),ie.readPixels(ue,ge-de-1,1,1,ie.RGBA,ie.UNSIGNED_BYTE,Z),Q.bindFramebuffer.set(null);const ve=Z[0]+(Z[2]>>4<<8),qe=Z[1]+((15&Z[2])<<8),Re=this.coordsIndex[255-Z[3]],Le=Re&&this.sourceCache.getTileByID(Re);if(!Le)return null;const Fe=this._coordsTextureSize,Ve=(1<<Le.tileID.canonical.z)*Fe;return new R.a1((Le.tileID.canonical.x*Fe+ve)/Ve+Le.tileID.wrap,(Le.tileID.canonical.y*Fe+qe)/Ve,this.getElevation(Le.tileID,ve,qe,Fe))}depthAtPoint(t){const Z=new Uint8Array(4),Q=this.painter.context,ie=Q.gl;return Q.bindFramebuffer.set(this.getFramebuffer("depth").framebuffer),ie.readPixels(t.x,this.painter.height/devicePixelRatio-t.y-1,1,1,ie.RGBA,ie.UNSIGNED_BYTE,Z),Q.bindFramebuffer.set(null),(Z[0]/16777216+Z[1]/65536+Z[2]/256+Z[3])/256}getTerrainMesh(t){var Z;const Q=((Z=this.painter.style.projection)===null||Z===void 0?void 0:Z.transitionState)>0,ie=Q&&t.canonical.y===0,ue=Q&&t.canonical.y===(1<<t.canonical.z)-1,de=`m_${ie?"n":""}_${ue?"s":""}`;if(this._meshCache[de])return this._meshCache[de];const ge=this.painter.context,ve=new R.cv,qe=new R.aN,Re=this.meshSize,Le=R.$/Re,Fe=Re*Re;for(let gt=0;gt<=Re;gt++)for(let Ot=0;Ot<=Re;Ot++)ve.emplaceBack(Ot*Le,gt*Le,0);for(let gt=0;gt<Fe;gt+=Re+1)for(let Ot=0;Ot<Re;Ot++)qe.emplaceBack(Ot+gt,Re+Ot+gt+1,Re+Ot+gt+2),qe.emplaceBack(Ot+gt,Re+Ot+gt+2,Ot+gt+1);const Ve=ve.length,Xe=Ve+(Re+1),at=(Re+1)*Re,ot=ie?R.bh:0,lt=ie?0:1,pt=ue?R.bi:R.$,yt=ue?0:1;for(let gt=0;gt<=Re;gt++)ve.emplaceBack(gt*Le,ot,lt);for(let gt=0;gt<=Re;gt++)ve.emplaceBack(gt*Le,pt,yt);for(let gt=0;gt<Re;gt++)qe.emplaceBack(at+gt,Xe+gt,Xe+gt+1),qe.emplaceBack(at+gt,Xe+gt+1,at+gt+1),qe.emplaceBack(0+gt,Ve+gt+1,Ve+gt),qe.emplaceBack(0+gt,0+gt+1,Ve+gt+1);const mt=ve.length,xt=mt+2*(Re+1);for(const gt of[0,1])for(let Ot=0;Ot<=Re;Ot++)for(const zt of[0,1])ve.emplaceBack(gt*R.$,Ot*Le,zt);for(let gt=0;gt<2*Re;gt+=2)qe.emplaceBack(mt+gt,mt+gt+1,mt+gt+3),qe.emplaceBack(mt+gt,mt+gt+3,mt+gt+2),qe.emplaceBack(xt+gt,xt+gt+3,xt+gt+1),qe.emplaceBack(xt+gt,xt+gt+2,xt+gt+3);const It=new ja(ge.createVertexBuffer(ve,Bs.members),ge.createIndexBuffer(qe),R.aM.simpleSegment(0,0,ve.length,qe.length));return this._meshCache[de]=It,It}getMeshFrameDelta(t){return 2*Math.PI*R.bu/Math.pow(2,Math.max(t,0))/5}getMinTileElevationForLngLatZoom(t,Z){var Q;const{tileID:ie}=this._getOverscaledTileIDFromLngLatZoom(t,Z);return(Q=this.getMinMaxElevation(ie).minElevation)!==null&&Q!==void 0?Q:0}getMinMaxElevation(t){const Z=this.getTerrainData(t).tile,Q={minElevation:null,maxElevation:null};return Z&&Z.dem&&(Q.minElevation=Z.dem.min*this.exaggeration,Q.maxElevation=Z.dem.max*this.exaggeration),Q}_getOverscaledTileIDFromLngLatZoom(t,Z){const Q=R.a1.fromLngLat(t.wrap()),ie=(1<<Z)*R.$,ue=Q.x*ie,de=Q.y*ie,ge=Math.floor(ue/R.$),ve=Math.floor(de/R.$);return{tileID:new R.Z(Z,0,Z,ge,ve),mercatorX:ue,mercatorY:de}}}class Ln{constructor(t,Z,Q){this._context=t,this._size=Z,this._tileSize=Q,this._objects=[],this._recentlyUsed=[],this._stamp=0}destruct(){for(const t of this._objects)t.texture.destroy(),t.fbo.destroy()}_createObject(t){const Z=this._context.createFramebuffer(this._tileSize,this._tileSize,!0,!0),Q=new R.T(this._context,{width:this._tileSize,height:this._tileSize,data:null},this._context.gl.RGBA);return Q.bind(this._context.gl.LINEAR,this._context.gl.CLAMP_TO_EDGE),this._context.extTextureFilterAnisotropic&&this._context.gl.texParameterf(this._context.gl.TEXTURE_2D,this._context.extTextureFilterAnisotropic.TEXTURE_MAX_ANISOTROPY_EXT,this._context.extTextureFilterAnisotropicMax),Z.depthAttachment.set(this._context.createRenderbuffer(this._context.gl.DEPTH_STENCIL,this._tileSize,this._tileSize)),Z.colorAttachment.set(Q.texture),{id:t,fbo:Z,texture:Q,stamp:-1,inUse:!1}}getObjectForId(t){return this._objects[t]}useObject(t){t.inUse=!0,this._recentlyUsed=this._recentlyUsed.filter((Z=>t.id!==Z)),this._recentlyUsed.push(t.id)}stampObject(t){t.stamp=++this._stamp}getOrCreateFreeObject(){for(const Z of this._recentlyUsed)if(!this._objects[Z].inUse)return this._objects[Z];if(this._objects.length>=this._size)throw new Error("No free RenderPool available, call freeAllObjects() required!");const t=this._createObject(this._objects.length);return this._objects.push(t),t}freeObject(t){t.inUse=!1}freeAllObjects(){for(const t of this._objects)this.freeObject(t)}isFull(){return!(this._objects.length<this._size)&&this._objects.some((t=>!t.inUse))===!1}}const Oa={background:!0,fill:!0,line:!0,raster:!0,hillshade:!0,"color-relief":!0};class Kc{constructor(t,Z){this.painter=t,this.terrain=Z,this.pool=new Ln(t.context,30,Z.sourceCache.tileSize*Z.qualityFactor)}destruct(){this.pool.destruct()}getTexture(t){return this.pool.getObjectForId(t.rtt[this._stacks.length-1].id).texture}prepareForRender(t,Z){this._stacks=[],this._prevType=null,this._rttTiles=[],this._renderableTiles=this.terrain.sourceCache.getRenderableTiles(),this._renderableLayerIds=t._order.filter((Q=>!t._layers[Q].isHidden(Z))),this._coordsAscending={};for(const Q in t.sourceCaches){this._coordsAscending[Q]={};const ie=t.sourceCaches[Q].getVisibleCoordinates(),ue=t.sourceCaches[Q].getSource(),de=ue instanceof Dr?ue.terrainTileRanges:null;for(const ge of ie){const ve=this.terrain.sourceCache.getTerrainCoords(ge,de);for(const qe in ve)this._coordsAscending[Q][qe]||(this._coordsAscending[Q][qe]=[]),this._coordsAscending[Q][qe].push(ve[qe])}}this._coordsAscendingStr={};for(const Q of t._order){const ie=t._layers[Q],ue=ie.source;if(Oa[ie.type]&&!this._coordsAscendingStr[ue]){this._coordsAscendingStr[ue]={};for(const de in this._coordsAscending[ue])this._coordsAscendingStr[ue][de]=this._coordsAscending[ue][de].map((ge=>ge.key)).sort().join()}}for(const Q of this._renderableTiles)for(const ie in this._coordsAscendingStr){const ue=this._coordsAscendingStr[ie][Q.tileID.key];ue&&ue!==Q.rttCoords[ie]&&(Q.rtt=[])}}renderLayer(t,Z){if(t.isHidden(this.painter.transform.zoom))return!1;const Q=Object.assign(Object.assign({},Z),{isRenderingToTexture:!0}),ie=t.type,ue=this.painter,de=this._renderableLayerIds[this._renderableLayerIds.length-1]===t.id;if(Oa[ie]&&(this._prevType&&Oa[this._prevType]||this._stacks.push([]),this._prevType=ie,this._stacks[this._stacks.length-1].push(t.id),!de))return!0;if(Oa[this._prevType]||Oa[ie]&&de){this._prevType=ie;const ge=this._stacks.length-1,ve=this._stacks[ge]||[];for(const qe of this._renderableTiles){if(this.pool.isFull()&&(Cs(this.painter,this.terrain,this._rttTiles,Q),this._rttTiles=[],this.pool.freeAllObjects()),this._rttTiles.push(qe),qe.rtt[ge]){const Le=this.pool.getObjectForId(qe.rtt[ge].id);if(Le.stamp===qe.rtt[ge].stamp){this.pool.useObject(Le);continue}}const Re=this.pool.getOrCreateFreeObject();this.pool.useObject(Re),this.pool.stampObject(Re),qe.rtt[ge]={id:Re.id,stamp:Re.stamp},ue.context.bindFramebuffer.set(Re.fbo.framebuffer),ue.context.clear({color:R.bf.transparent,stencil:0}),ue.currentStencilSource=void 0;for(let Le=0;Le<ve.length;Le++){const Fe=ue.style._layers[ve[Le]],Ve=Fe.source?this._coordsAscending[Fe.source][qe.tileID.key]:[qe.tileID];ue.context.viewport.set([0,0,Re.fbo.width,Re.fbo.height]),ue._renderTileClippingMasks(Fe,Ve,!0),ue.renderLayer(ue,ue.style.sourceCaches[Fe.source],Fe,Ve,Q),Fe.source&&(qe.rttCoords[Fe.source]=this._coordsAscendingStr[Fe.source][qe.tileID.key])}}return Cs(this.painter,this.terrain,this._rttTiles,Q),this._rttTiles=[],this.pool.freeAllObjects(),Oa[ie]}return!1}}const Xc={"AttributionControl.ToggleAttribution":"Toggle attribution","AttributionControl.MapFeedback":"Map feedback","FullscreenControl.Enter":"Enter fullscreen","FullscreenControl.Exit":"Exit fullscreen","GeolocateControl.FindMyLocation":"Find my location","GeolocateControl.LocationNotAvailable":"Location not available","LogoControl.Title":"MapLibre logo","Map.Title":"Map","Marker.Title":"Map marker","NavigationControl.ResetBearing":"Reset bearing to north","NavigationControl.ZoomIn":"Zoom in","NavigationControl.ZoomOut":"Zoom out","Popup.Close":"Close popup","ScaleControl.Feet":"ft","ScaleControl.Meters":"m","ScaleControl.Kilometers":"km","ScaleControl.Miles":"mi","ScaleControl.NauticalMiles":"nm","GlobeControl.Enable":"Enable globe","GlobeControl.Disable":"Disable globe","TerrainControl.Enable":"Enable terrain","TerrainControl.Disable":"Disable terrain","CooperativeGesturesHandler.WindowsHelpText":"Use Ctrl + scroll to zoom the map","CooperativeGesturesHandler.MacHelpText":"Use â + scroll to zoom the map","CooperativeGesturesHandler.MobileHelpText":"Use two fingers to move the map"},Yc=U,oo={hash:!1,interactive:!0,bearingSnap:7,attributionControl:Ar,maplibreLogo:!1,refreshExpiredTiles:!0,canvasContextAttributes:{antialias:!1,preserveDrawingBuffer:!1,powerPreference:"high-performance",failIfMajorPerformanceCaveat:!1,desynchronized:!1,contextType:void 0},scrollZoom:!0,minZoom:-2,maxZoom:22,minPitch:0,maxPitch:60,boxZoom:!0,dragRotate:!0,dragPan:!0,keyboard:!0,doubleClickZoom:!0,touchZoomRotate:!0,touchPitch:!0,cooperativeGestures:!1,trackResize:!0,center:[0,0],elevation:0,zoom:0,bearing:0,pitch:0,roll:0,renderWorldCopies:!0,maxTileCacheSize:null,maxTileCacheZoomLevels:R.a.MAX_TILE_CACHE_ZOOM_LEVELS,transformRequest:null,transformCameraUpdate:null,fadeDuration:300,crossSourceCollisions:!0,clickTolerance:3,localIdeographFontFamily:"sans-serif",pitchWithRotate:!0,rollEnabled:!1,validateStyle:!0,maxCanvasSize:[4096,4096],cancelPendingTileRequestsWhileZooming:!0,centerClampedToGround:!0},Ii={showCompass:!0,showZoom:!0,visualizePitch:!1,visualizeRoll:!0};class Di{constructor(t,Z,Q=!1){this.mousedown=ue=>{this.startMove(ue,me.mousePos(this.element,ue)),me.addEventListener(window,"mousemove",this.mousemove),me.addEventListener(window,"mouseup",this.mouseup)},this.mousemove=ue=>{this.move(ue,me.mousePos(this.element,ue))},this.mouseup=ue=>{this._rotatePitchHandler.dragEnd(ue),this.offTemp()},this.touchstart=ue=>{ue.targetTouches.length!==1?this.reset():(this._startPos=this._lastPos=me.touchPos(this.element,ue.targetTouches)[0],this.startMove(ue,this._startPos),me.addEventListener(window,"touchmove",this.touchmove,{passive:!1}),me.addEventListener(window,"touchend",this.touchend))},this.touchmove=ue=>{ue.targetTouches.length!==1?this.reset():(this._lastPos=me.touchPos(this.element,ue.targetTouches)[0],this.move(ue,this._lastPos))},this.touchend=ue=>{ue.targetTouches.length===0&&this._startPos&&this._lastPos&&this._startPos.dist(this._lastPos)<this._clickTolerance&&this.element.click(),delete this._startPos,delete this._lastPos,this.offTemp()},this.reset=()=>{this._rotatePitchHandler.reset(),delete this._startPos,delete this._lastPos,this.offTemp()},this._clickTolerance=10,this.element=Z;const ie=new Nl;this._rotatePitchHandler=new Lo({clickTolerance:3,move:(ue,de)=>{const ge=Z.getBoundingClientRect(),ve=new R.P((ge.bottom-ge.top)/2,(ge.right-ge.left)/2);return{bearingDelta:R.cn(new R.P(ue.x,de.y),de,ve),pitchDelta:Q?-.5*(de.y-ue.y):void 0}},moveStateManager:ie,enable:!0,assignEvents:()=>{}}),this.map=t,me.addEventListener(Z,"mousedown",this.mousedown),me.addEventListener(Z,"touchstart",this.touchstart,{passive:!1}),me.addEventListener(Z,"touchcancel",this.reset)}startMove(t,Z){this._rotatePitchHandler.dragStart(t,Z),me.disableDrag()}move(t,Z){const Q=this.map,{bearingDelta:ie,pitchDelta:ue}=this._rotatePitchHandler.dragMove(t,Z)||{};ie&&Q.setBearing(Q.getBearing()+ie),ue&&Q.setPitch(Q.getPitch()+ue)}off(){const t=this.element;me.removeEventListener(t,"mousedown",this.mousedown),me.removeEventListener(t,"touchstart",this.touchstart,{passive:!1}),me.removeEventListener(window,"touchmove",this.touchmove,{passive:!1}),me.removeEventListener(window,"touchend",this.touchend),me.removeEventListener(t,"touchcancel",this.reset),this.offTemp()}offTemp(){me.enableDrag(),me.removeEventListener(window,"mousemove",this.mousemove),me.removeEventListener(window,"mouseup",this.mouseup),me.removeEventListener(window,"touchmove",this.touchmove,{passive:!1}),me.removeEventListener(window,"touchend",this.touchend)}}let ua;function so(se,t,Z,Q=!1){if(Q||!Z.getCoveringTilesDetailsProvider().allowWorldCopies())return se==null?void 0:se.wrap();const ie=new R.S(se.lng,se.lat);if(se=new R.S(se.lng,se.lat),t){const ue=new R.S(se.lng-360,se.lat),de=new R.S(se.lng+360,se.lat),ge=Z.locationToScreenPoint(se).distSqr(t);Z.locationToScreenPoint(ue).distSqr(t)<ge?se=ue:Z.locationToScreenPoint(de).distSqr(t)<ge&&(se=de)}for(;Math.abs(se.lng-Z.center.lng)>180;){const ue=Z.locationToScreenPoint(se);if(ue.x>=0&&ue.y>=0&&ue.x<=Z.width&&ue.y<=Z.height)break;se.lng>Z.center.lng?se.lng-=360:se.lng+=360}return se.lng!==ie.lng&&Z.isPointOnMapSurface(Z.locationToScreenPoint(se))?se:ie}const lo={center:"translate(-50%,-50%)",top:"translate(-50%,0)","top-left":"translate(0,0)","top-right":"translate(-100%,0)",bottom:"translate(-50%,-100%)","bottom-left":"translate(0,-100%)","bottom-right":"translate(-100%,-100%)",left:"translate(0,-50%)",right:"translate(-100%,-50%)"};function Ns(se,t,Z){const Q=se.classList;for(const ie in lo)Q.remove(`maplibregl-${Z}-anchor-${ie}`);Q.add(`maplibregl-${Z}-anchor-${t}`)}class Vo extends R.E{constructor(t){if(super(),this._onKeyPress=Z=>{const Q=Z.code,ie=Z.charCode||Z.keyCode;Q!=="Space"&&Q!=="Enter"&&ie!==32&&ie!==13||this.togglePopup()},this._onMapClick=Z=>{const Q=Z.originalEvent.target,ie=this._element;this._popup&&(Q===ie||ie.contains(Q))&&this.togglePopup()},this._update=Z=>{if(!this._map)return;const Q=this._map.loaded()&&!this._map.isMoving();((Z==null?void 0:Z.type)==="terrain"||(Z==null?void 0:Z.type)==="render"&&!Q)&&this._map.once("render",this._update),this._lngLat=so(this._lngLat,this._flatPos,this._map.transform),this._flatPos=this._pos=this._map.project(this._lngLat)._add(this._offset),this._map.terrain&&(this._flatPos=this._map.transform.locationToScreenPoint(this._lngLat)._add(this._offset));let ie="";this._rotationAlignment==="viewport"||this._rotationAlignment==="auto"?ie=`rotateZ(${this._rotation}deg)`:this._rotationAlignment==="map"&&(ie=`rotateZ(${this._rotation-this._map.getBearing()}deg)`);let ue="";this._pitchAlignment==="viewport"||this._pitchAlignment==="auto"?ue="rotateX(0deg)":this._pitchAlignment==="map"&&(ue=`rotateX(${this._map.getPitch()}deg)`),this._subpixelPositioning||Z&&Z.type!=="moveend"||(this._pos=this._pos.round()),me.setTransform(this._element,`${lo[this._anchor]} translate(${this._pos.x}px, ${this._pos.y}px) ${ue} ${ie}`),_e.frameAsync(new AbortController).then((()=>{this._updateOpacity(Z&&Z.type==="moveend")})).catch((()=>{}))},this._onMove=Z=>{if(!this._isDragging){const Q=this._clickTolerance||this._map._clickTolerance;this._isDragging=Z.point.dist(this._pointerdownPos)>=Q}this._isDragging&&(this._pos=Z.point.sub(this._positionDelta),this._lngLat=this._map.unproject(this._pos),this.setLngLat(this._lngLat),this._element.style.pointerEvents="none",this._state==="pending"&&(this._state="active",this.fire(new R.l("dragstart"))),this.fire(new R.l("drag")))},this._onUp=()=>{this._element.style.pointerEvents="auto",this._positionDelta=null,this._pointerdownPos=null,this._isDragging=!1,this._map.off("mousemove",this._onMove),this._map.off("touchmove",this._onMove),this._state==="active"&&this.fire(new R.l("dragend")),this._state="inactive"},this._addDragHandler=Z=>{this._element.contains(Z.originalEvent.target)&&(Z.preventDefault(),this._positionDelta=Z.point.sub(this._pos).add(this._offset),this._pointerdownPos=Z.point,this._state="pending",this._map.on("mousemove",this._onMove),this._map.on("touchmove",this._onMove),this._map.once("mouseup",this._onUp),this._map.once("touchend",this._onUp))},this._anchor=t&&t.anchor||"center",this._color=t&&t.color||"#3FB1CE",this._scale=t&&t.scale||1,this._draggable=t&&t.draggable||!1,this._clickTolerance=t&&t.clickTolerance||0,this._subpixelPositioning=t&&t.subpixelPositioning||!1,this._isDragging=!1,this._state="inactive",this._rotation=t&&t.rotation||0,this._rotationAlignment=t&&t.rotationAlignment||"auto",this._pitchAlignment=t&&t.pitchAlignment&&t.pitchAlignment!=="auto"?t.pitchAlignment:this._rotationAlignment,this.setOpacity(t==null?void 0:t.opacity,t==null?void 0:t.opacityWhenCovered),t&&t.element)this._element=t.element,this._offset=R.P.convert(t&&t.offset||[0,0]);else{this._defaultMarker=!0,this._element=me.create("div");const Z=me.createNS("http://www.w3.org/2000/svg","svg"),Q=41,ie=27;Z.setAttributeNS(null,"display","block"),Z.setAttributeNS(null,"height",`${Q}px`),Z.setAttributeNS(null,"width",`${ie}px`),Z.setAttributeNS(null,"viewBox",`0 0 ${ie} ${Q}`);const ue=me.createNS("http://www.w3.org/2000/svg","g");ue.setAttributeNS(null,"stroke","none"),ue.setAttributeNS(null,"stroke-width","1"),ue.setAttributeNS(null,"fill","none"),ue.setAttributeNS(null,"fill-rule","evenodd");const de=me.createNS("http://www.w3.org/2000/svg","g");de.setAttributeNS(null,"fill-rule","nonzero");const ge=me.createNS("http://www.w3.org/2000/svg","g");ge.setAttributeNS(null,"transform","translate(3.0, 29.0)"),ge.setAttributeNS(null,"fill","#000000");const ve=[{rx:"10.5",ry:"5.25002273"},{rx:"10.5",ry:"5.25002273"},{rx:"9.5",ry:"4.77275007"},{rx:"8.5",ry:"4.29549936"},{rx:"7.5",ry:"3.81822308"},{rx:"6.5",ry:"3.34094679"},{rx:"5.5",ry:"2.86367051"},{rx:"4.5",ry:"2.38636864"}];for(const lt of ve){const pt=me.createNS("http://www.w3.org/2000/svg","ellipse");pt.setAttributeNS(null,"opacity","0.04"),pt.setAttributeNS(null,"cx","10.5"),pt.setAttributeNS(null,"cy","5.80029008"),pt.setAttributeNS(null,"rx",lt.rx),pt.setAttributeNS(null,"ry",lt.ry),ge.appendChild(pt)}const qe=me.createNS("http://www.w3.org/2000/svg","g");qe.setAttributeNS(null,"fill",this._color);const Re=me.createNS("http://www.w3.org/2000/svg","path");Re.setAttributeNS(null,"d","M27,13.5 C27,19.074644 20.250001,27.000002 14.75,34.500002 C14.016665,35.500004 12.983335,35.500004 12.25,34.500002 C6.7499993,27.000002 0,19.222562 0,13.5 C0,6.0441559 6.0441559,0 13.5,0 C20.955844,0 27,6.0441559 27,13.5 Z"),qe.appendChild(Re);const Le=me.createNS("http://www.w3.org/2000/svg","g");Le.setAttributeNS(null,"opacity","0.25"),Le.setAttributeNS(null,"fill","#000000");const Fe=me.createNS("http://www.w3.org/2000/svg","path");Fe.setAttributeNS(null,"d","M13.5,0 C6.0441559,0 0,6.0441559 0,13.5 C0,19.222562 6.7499993,27 12.25,34.5 C13,35.522727 14.016664,35.500004 14.75,34.5 C20.250001,27 27,19.074644 27,13.5 C27,6.0441559 20.955844,0 13.5,0 Z M13.5,1 C20.415404,1 26,6.584596 26,13.5 C26,15.898657 24.495584,19.181431 22.220703,22.738281 C19.945823,26.295132 16.705119,30.142167 13.943359,33.908203 C13.743445,34.180814 13.612715,34.322738 13.5,34.441406 C13.387285,34.322738 13.256555,34.180814 13.056641,33.908203 C10.284481,30.127985 7.4148684,26.314159 5.015625,22.773438 C2.6163816,19.232715 1,15.953538 1,13.5 C1,6.584596 6.584596,1 13.5,1 Z"),Le.appendChild(Fe);const Ve=me.createNS("http://www.w3.org/2000/svg","g");Ve.setAttributeNS(null,"transform","translate(6.0, 7.0)"),Ve.setAttributeNS(null,"fill","#FFFFFF");const Xe=me.createNS("http://www.w3.org/2000/svg","g");Xe.setAttributeNS(null,"transform","translate(8.0, 8.0)");const at=me.createNS("http://www.w3.org/2000/svg","circle");at.setAttributeNS(null,"fill","#000000"),at.setAttributeNS(null,"opacity","0.25"),at.setAttributeNS(null,"cx","5.5"),at.setAttributeNS(null,"cy","5.5"),at.setAttributeNS(null,"r","5.4999962");const ot=me.createNS("http://www.w3.org/2000/svg","circle");ot.setAttributeNS(null,"fill","#FFFFFF"),ot.setAttributeNS(null,"cx","5.5"),ot.setAttributeNS(null,"cy","5.5"),ot.setAttributeNS(null,"r","5.4999962"),Xe.appendChild(at),Xe.appendChild(ot),de.appendChild(ge),de.appendChild(qe),de.appendChild(Le),de.appendChild(Ve),de.appendChild(Xe),Z.appendChild(de),Z.setAttributeNS(null,"height",Q*this._scale+"px"),Z.setAttributeNS(null,"width",ie*this._scale+"px"),this._element.appendChild(Z),this._offset=R.P.convert(t&&t.offset||[0,-14])}if(this._element.classList.add("maplibregl-marker"),this._element.addEventListener("dragstart",(Z=>{Z.preventDefault()})),this._element.addEventListener("mousedown",(Z=>{Z.preventDefault()})),Ns(this._element,this._anchor,"marker"),t&&t.className)for(const Z of t.className.split(" "))this._element.classList.add(Z);this._popup=null}addTo(t){return this.remove(),this._map=t,this._element.hasAttribute("aria-label")||this._element.setAttribute("aria-label",t._getUIString("Marker.Title")),this._element.hasAttribute("role")||this._element.setAttribute("role","button"),t.getCanvasContainer().appendChild(this._element),t.on("move",this._update),t.on("moveend",this._update),t.on("terrain",this._update),t.on("projectiontransition",this._update),this.setDraggable(this._draggable),this._update(),this._map.on("click",this._onMapClick),this}remove(){return this._opacityTimeout&&(clearTimeout(this._opacityTimeout),delete this._opacityTimeout),this._map&&(this._map.off("click",this._onMapClick),this._map.off("move",this._update),this._map.off("moveend",this._update),this._map.off("terrain",this._update),this._map.off("projectiontransition",this._update),this._map.off("mousedown",this._addDragHandler),this._map.off("touchstart",this._addDragHandler),this._map.off("mouseup",this._onUp),this._map.off("touchend",this._onUp),this._map.off("mousemove",this._onMove),this._map.off("touchmove",this._onMove),delete this._map),me.remove(this._element),this._popup&&this._popup.remove(),this}getLngLat(){return this._lngLat}setLngLat(t){return this._lngLat=R.S.convert(t),this._pos=null,this._popup&&this._popup.setLngLat(this._lngLat),this._update(),this}getElement(){return this._element}setPopup(t){if(this._popup&&(this._popup.remove(),this._popup=null,this._element.removeEventListener("keypress",this._onKeyPress),this._originalTabIndex||this._element.removeAttribute("tabindex")),t){if(!("offset"in t.options)){const ie=Math.abs(13.5)/Math.SQRT2;t.options.offset=this._defaultMarker?{top:[0,0],"top-left":[0,0],"top-right":[0,0],bottom:[0,-38.1],"bottom-left":[ie,-1*(38.1-13.5+ie)],"bottom-right":[-ie,-1*(38.1-13.5+ie)],left:[13.5,-1*(38.1-13.5)],right:[-13.5,-1*(38.1-13.5)]}:this._offset}this._popup=t,this._originalTabIndex=this._element.getAttribute("tabindex"),this._originalTabIndex||this._element.setAttribute("tabindex","0"),this._element.addEventListener("keypress",this._onKeyPress)}return this}setSubpixelPositioning(t){return this._subpixelPositioning=t,this}getPopup(){return this._popup}togglePopup(){const t=this._popup;return this._element.style.opacity===this._opacityWhenCovered?this:t?(t.isOpen()?t.remove():(t.setLngLat(this._lngLat),t.addTo(this._map)),this):this}_updateOpacity(t=!1){var Z,Q;const ie=(Z=this._map)===null||Z===void 0?void 0:Z.terrain,ue=this._map.transform.isLocationOccluded(this._lngLat);if(!ie||ue){const Ve=ue?this._opacityWhenCovered:this._opacity;return void(this._element.style.opacity!==Ve&&(this._element.style.opacity=Ve))}if(t)this._opacityTimeout=null;else{if(this._opacityTimeout)return;this._opacityTimeout=setTimeout((()=>{this._opacityTimeout=null}),100)}const de=this._map,ge=de.terrain.depthAtPoint(this._pos),ve=de.terrain.getElevationForLngLatZoom(this._lngLat,de.transform.tileZoom);if(de.transform.lngLatToCameraDepth(this._lngLat,ve)-ge<.006)return void(this._element.style.opacity=this._opacity);const qe=-this._offset.y/de.transform.pixelsPerMeter,Re=Math.sin(de.getPitch()*Math.PI/180)*qe,Le=de.terrain.depthAtPoint(new R.P(this._pos.x,this._pos.y-this._offset.y)),Fe=de.transform.lngLatToCameraDepth(this._lngLat,ve+Re)-Le>.006;!((Q=this._popup)===null||Q===void 0)&&Q.isOpen()&&Fe&&this._popup.remove(),this._element.style.opacity=Fe?this._opacityWhenCovered:this._opacity}getOffset(){return this._offset}setOffset(t){return this._offset=R.P.convert(t),this._update(),this}addClassName(t){this._element.classList.add(t)}removeClassName(t){this._element.classList.remove(t)}toggleClassName(t){return this._element.classList.toggle(t)}setDraggable(t){return this._draggable=!!t,this._map&&(t?(this._map.on("mousedown",this._addDragHandler),this._map.on("touchstart",this._addDragHandler)):(this._map.off("mousedown",this._addDragHandler),this._map.off("touchstart",this._addDragHandler))),this}isDraggable(){return this._draggable}setRotation(t){return this._rotation=t||0,this._update(),this}getRotation(){return this._rotation}setRotationAlignment(t){return this._rotationAlignment=t||"auto",this._update(),this}getRotationAlignment(){return this._rotationAlignment}setPitchAlignment(t){return this._pitchAlignment=t&&t!=="auto"?t:this._rotationAlignment,this._update(),this}getPitchAlignment(){return this._pitchAlignment}setOpacity(t,Z){return(this._opacity===void 0||t===void 0&&Z===void 0)&&(this._opacity="1",this._opacityWhenCovered="0.2"),t!==void 0&&(this._opacity=t),Z!==void 0&&(this._opacityWhenCovered=Z),this._map&&this._updateOpacity(!0),this}}const Vl={positionOptions:{enableHighAccuracy:!1,maximumAge:0,timeout:6e3},fitBoundsOptions:{maxZoom:15},trackUserLocation:!1,showAccuracyCircle:!0,showUserLocation:!0};let ca=0,Ca=!1;const Gl={maxWidth:100,unit:"metric"};function js(se,t,Z){const Q=Z&&Z.maxWidth||100,ie=se._container.clientHeight/2,ue=se._container.clientWidth/2,de=se.unproject([ue-Q/2,ie]),ge=se.unproject([ue+Q/2,ie]),ve=Math.round(se.project(ge).x-se.project(de).x),qe=Math.min(Q,ve,se._container.clientWidth),Re=de.distanceTo(ge);if(Z&&Z.unit==="imperial"){const Le=3.2808*Re;Le>5280?Ma(t,qe,Le/5280,se._getUIString("ScaleControl.Miles")):Ma(t,qe,Le,se._getUIString("ScaleControl.Feet"))}else Z&&Z.unit==="nautical"?Ma(t,qe,Re/1852,se._getUIString("ScaleControl.NauticalMiles")):Re>=1e3?Ma(t,qe,Re/1e3,se._getUIString("ScaleControl.Kilometers")):Ma(t,qe,Re,se._getUIString("ScaleControl.Meters"))}function Ma(se,t,Z,Q){const ie=(function(ue){const de=Math.pow(10,`${Math.floor(ue)}`.length-1);let ge=ue/de;return ge=ge>=10?10:ge>=5?5:ge>=3?3:ge>=2?2:ge>=1?1:(function(ve){const qe=Math.pow(10,Math.ceil(-Math.log(ve)/Math.LN10));return Math.round(ve*qe)/qe})(ge),de*ge})(Z);se.style.width=t*(ie/Z)+"px",se.innerHTML=`${ie}&nbsp;${Q}`}const $l={closeButton:!0,closeOnClick:!0,focusAfterOpen:!0,className:"",maxWidth:"240px",subpixelPositioning:!1,locationOccludedOpacity:void 0},Wl=["a[href]","[tabindex]:not([tabindex='-1'])","[contenteditable]:not([contenteditable='false'])","button:not([disabled])","input:not([disabled])","select:not([disabled])","textarea:not([disabled])"].join(", ");function zs(se){if(se){if(typeof se=="number"){const t=Math.round(Math.abs(se)/Math.SQRT2);return{center:new R.P(0,0),top:new R.P(0,se),"top-left":new R.P(t,t),"top-right":new R.P(-t,t),bottom:new R.P(0,-se),"bottom-left":new R.P(t,-t),"bottom-right":new R.P(-t,-t),left:new R.P(se,0),right:new R.P(-se,0)}}if(se instanceof R.P||Array.isArray(se)){const t=R.P.convert(se);return{center:t,top:t,"top-left":t,"top-right":t,bottom:t,"bottom-left":t,"bottom-right":t,left:t,right:t}}return{center:R.P.convert(se.center||[0,0]),top:R.P.convert(se.top||[0,0]),"top-left":R.P.convert(se["top-left"]||[0,0]),"top-right":R.P.convert(se["top-right"]||[0,0]),bottom:R.P.convert(se.bottom||[0,0]),"bottom-left":R.P.convert(se["bottom-left"]||[0,0]),"bottom-right":R.P.convert(se["bottom-right"]||[0,0]),left:R.P.convert(se.left||[0,0]),right:R.P.convert(se.right||[0,0])}}return zs(new R.P(0,0))}const Hl=U;ee.AJAXError=R.cz,ee.Event=R.l,ee.Evented=R.E,ee.LngLat=R.S,ee.MercatorCoordinate=R.a1,ee.Point=R.P,ee.addProtocol=R.cA,ee.config=R.a,ee.removeProtocol=R.cB,ee.AttributionControl=Br,ee.BoxZoomHandler=Mn,ee.CanvasSource=Yt,ee.CooperativeGesturesHandler=zl,ee.DoubleClickZoomHandler=nc,ee.DragPanHandler=ac,ee.DragRotateHandler=zo,ee.EdgeInsets=go,ee.FullscreenControl=class extends R.E{constructor(se={}){super(),this._onFullscreenChange=()=>{var t;let Z=window.document.fullscreenElement||window.document.mozFullScreenElement||window.document.webkitFullscreenElement||window.document.msFullscreenElement;for(;!((t=Z==null?void 0:Z.shadowRoot)===null||t===void 0)&&t.fullscreenElement;)Z=Z.shadowRoot.fullscreenElement;Z===this._container!==this._fullscreen&&this._handleFullscreenChange()},this._onClickFullscreen=()=>{this._isFullscreen()?this._exitFullscreen():this._requestFullscreen()},this._fullscreen=!1,se&&se.container&&(se.container instanceof HTMLElement?this._container=se.container:R.w("Full screen control 'container' must be a DOM element.")),"onfullscreenchange"in document?this._fullscreenchange="fullscreenchange":"onmozfullscreenchange"in document?this._fullscreenchange="mozfullscreenchange":"onwebkitfullscreenchange"in document?this._fullscreenchange="webkitfullscreenchange":"onmsfullscreenchange"in document&&(this._fullscreenchange="MSFullscreenChange")}onAdd(se){return this._map=se,this._container||(this._container=this._map.getContainer()),this._controlContainer=me.create("div","maplibregl-ctrl maplibregl-ctrl-group"),this._setupUI(),this._controlContainer}onRemove(){me.remove(this._controlContainer),this._map=null,window.document.removeEventListener(this._fullscreenchange,this._onFullscreenChange)}_setupUI(){const se=this._fullscreenButton=me.create("button","maplibregl-ctrl-fullscreen",this._controlContainer);me.create("span","maplibregl-ctrl-icon",se).setAttribute("aria-hidden","true"),se.type="button",this._updateTitle(),this._fullscreenButton.addEventListener("click",this._onClickFullscreen),window.document.addEventListener(this._fullscreenchange,this._onFullscreenChange)}_updateTitle(){const se=this._getTitle();this._fullscreenButton.setAttribute("aria-label",se),this._fullscreenButton.title=se}_getTitle(){return this._map._getUIString(this._isFullscreen()?"FullscreenControl.Exit":"FullscreenControl.Enter")}_isFullscreen(){return this._fullscreen}_handleFullscreenChange(){this._fullscreen=!this._fullscreen,this._fullscreenButton.classList.toggle("maplibregl-ctrl-shrink"),this._fullscreenButton.classList.toggle("maplibregl-ctrl-fullscreen"),this._updateTitle(),this._fullscreen?(this.fire(new R.l("fullscreenstart")),this._prevCooperativeGesturesEnabled=this._map.cooperativeGestures.isEnabled(),this._map.cooperativeGestures.disable()):(this.fire(new R.l("fullscreenend")),this._prevCooperativeGesturesEnabled&&this._map.cooperativeGestures.enable())}_exitFullscreen(){window.document.exitFullscreen?window.document.exitFullscreen():window.document.mozCancelFullScreen?window.document.mozCancelFullScreen():window.document.msExitFullscreen?window.document.msExitFullscreen():window.document.webkitCancelFullScreen?window.document.webkitCancelFullScreen():this._togglePseudoFullScreen()}_requestFullscreen(){this._container.requestFullscreen?this._container.requestFullscreen():this._container.mozRequestFullScreen?this._container.mozRequestFullScreen():this._container.msRequestFullscreen?this._container.msRequestFullscreen():this._container.webkitRequestFullscreen?this._container.webkitRequestFullscreen():this._togglePseudoFullScreen()}_togglePseudoFullScreen(){this._container.classList.toggle("maplibregl-pseudo-fullscreen"),this._handleFullscreenChange(),this._map.resize()}},ee.GeoJSONSource=Nr,ee.GeolocateControl=class extends R.E{constructor(se){super(),this._onSuccess=t=>{if(this._map){if(this._isOutOfMapMaxBounds(t))return this._setErrorState(),this.fire(new R.l("outofmaxbounds",t)),this._updateMarker(),void this._finish();if(this.options.trackUserLocation)switch(this._lastKnownPosition=t,this._watchState){case"WAITING_ACTIVE":case"ACTIVE_LOCK":case"ACTIVE_ERROR":this._watchState="ACTIVE_LOCK",this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-active-error"),this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-active");break;case"BACKGROUND":case"BACKGROUND_ERROR":this._watchState="BACKGROUND",this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-background-error"),this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-background");break;default:throw new Error(`Unexpected watchState ${this._watchState}`)}this.options.showUserLocation&&this._watchState!=="OFF"&&this._updateMarker(t),this.options.trackUserLocation&&this._watchState!=="ACTIVE_LOCK"||this._updateCamera(t),this.options.showUserLocation&&this._dotElement.classList.remove("maplibregl-user-location-dot-stale"),this.fire(new R.l("geolocate",t)),this._finish()}},this._updateCamera=t=>{const Z=new R.S(t.coords.longitude,t.coords.latitude),Q=t.coords.accuracy,ie=this._map.getBearing(),ue=R.e({bearing:ie},this.options.fitBoundsOptions),de=gr.fromLngLat(Z,Q);this._map.fitBounds(de,ue,{geolocateSource:!0})},this._updateMarker=t=>{if(t){const Z=new R.S(t.coords.longitude,t.coords.latitude);this._accuracyCircleMarker.setLngLat(Z).addTo(this._map),this._userLocationDotMarker.setLngLat(Z).addTo(this._map),this._accuracy=t.coords.accuracy,this._updateCircleRadiusIfNeeded()}else this._userLocationDotMarker.remove(),this._accuracyCircleMarker.remove()},this._onUpdate=()=>{this._updateCircleRadiusIfNeeded()},this._onError=t=>{if(this._map){if(t.code===1){this._watchState="OFF",this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-active"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-active-error"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-background"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-background-error"),this._geolocateButton.disabled=!0;const Z=this._map._getUIString("GeolocateControl.LocationNotAvailable");this._geolocateButton.title=Z,this._geolocateButton.setAttribute("aria-label",Z),this._geolocationWatchID!==void 0&&this._clearWatch()}else{if(t.code===3&&Ca)return;this._setErrorState()}this._watchState!=="OFF"&&this.options.showUserLocation&&this._dotElement.classList.add("maplibregl-user-location-dot-stale"),this.fire(new R.l("error",t)),this._finish()}},this._finish=()=>{this._timeoutId&&clearTimeout(this._timeoutId),this._timeoutId=void 0},this._setupUI=()=>{this._map&&(this._container.addEventListener("contextmenu",(t=>t.preventDefault())),this._geolocateButton=me.create("button","maplibregl-ctrl-geolocate",this._container),me.create("span","maplibregl-ctrl-icon",this._geolocateButton).setAttribute("aria-hidden","true"),this._geolocateButton.type="button",this._geolocateButton.disabled=!0)},this._finishSetupUI=t=>{if(this._map){if(t===!1){R.w("Geolocation support is not available so the GeolocateControl will be disabled.");const Z=this._map._getUIString("GeolocateControl.LocationNotAvailable");this._geolocateButton.disabled=!0,this._geolocateButton.title=Z,this._geolocateButton.setAttribute("aria-label",Z)}else{const Z=this._map._getUIString("GeolocateControl.FindMyLocation");this._geolocateButton.disabled=!1,this._geolocateButton.title=Z,this._geolocateButton.setAttribute("aria-label",Z)}this.options.trackUserLocation&&(this._geolocateButton.setAttribute("aria-pressed","false"),this._watchState="OFF"),this.options.showUserLocation&&(this._dotElement=me.create("div","maplibregl-user-location-dot"),this._userLocationDotMarker=new Vo({element:this._dotElement}),this._circleElement=me.create("div","maplibregl-user-location-accuracy-circle"),this._accuracyCircleMarker=new Vo({element:this._circleElement,pitchAlignment:"map"}),this.options.trackUserLocation&&(this._watchState="OFF"),this._map.on("zoom",this._onUpdate),this._map.on("move",this._onUpdate),this._map.on("rotate",this._onUpdate),this._map.on("pitch",this._onUpdate)),this._geolocateButton.addEventListener("click",(()=>this.trigger())),this._setup=!0,this.options.trackUserLocation&&this._map.on("movestart",(Z=>{const Q=(Z==null?void 0:Z[0])instanceof ResizeObserverEntry;Z.geolocateSource||this._watchState!=="ACTIVE_LOCK"||Q||this._map.isZooming()||(this._watchState="BACKGROUND",this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-background"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-active"),this.fire(new R.l("trackuserlocationend")),this.fire(new R.l("userlocationlostfocus")))}))}},this.options=R.e({},Vl,se)}onAdd(se){return this._map=se,this._container=me.create("div","maplibregl-ctrl maplibregl-ctrl-group"),this._setupUI(),(function(){return R._(this,arguments,void 0,(function*(t=!1){if(ua!==void 0&&!t)return ua;if(window.navigator.permissions===void 0)return ua=!!window.navigator.geolocation,ua;try{ua=(yield window.navigator.permissions.query({name:"geolocation"})).state!=="denied"}catch{ua=!!window.navigator.geolocation}return ua}))})().then((t=>this._finishSetupUI(t))),this._container}onRemove(){this._geolocationWatchID!==void 0&&(window.navigator.geolocation.clearWatch(this._geolocationWatchID),this._geolocationWatchID=void 0),this.options.showUserLocation&&this._userLocationDotMarker&&this._userLocationDotMarker.remove(),this.options.showAccuracyCircle&&this._accuracyCircleMarker&&this._accuracyCircleMarker.remove(),me.remove(this._container),this._map.off("zoom",this._onUpdate),this._map.off("move",this._onUpdate),this._map.off("rotate",this._onUpdate),this._map.off("pitch",this._onUpdate),this._map=void 0,ca=0,Ca=!1}_isOutOfMapMaxBounds(se){const t=this._map.getMaxBounds(),Z=se.coords;return t&&(Z.longitude<t.getWest()||Z.longitude>t.getEast()||Z.latitude<t.getSouth()||Z.latitude>t.getNorth())}_setErrorState(){switch(this._watchState){case"WAITING_ACTIVE":this._watchState="ACTIVE_ERROR",this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-active"),this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-active-error");break;case"ACTIVE_LOCK":this._watchState="ACTIVE_ERROR",this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-active"),this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-active-error"),this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-waiting");break;case"BACKGROUND":this._watchState="BACKGROUND_ERROR",this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-background"),this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-background-error"),this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-waiting");break;case"ACTIVE_ERROR":case"BACKGROUND_ERROR":case"OFF":case void 0:break;default:throw new Error(`Unexpected watchState ${this._watchState}`)}}_updateCircleRadiusIfNeeded(){const se=this._userLocationDotMarker.getLngLat();if(!(this.options.showUserLocation&&this.options.showAccuracyCircle&&this._accuracy&&se))return;const t=this._map.project(se),Z=this._map.unproject([t.x+100,t.y]),Q=se.distanceTo(Z)/100,ie=2*this._accuracy/Q;this._circleElement.style.width=`${ie.toFixed(2)}px`,this._circleElement.style.height=`${ie.toFixed(2)}px`}trigger(){if(!this._setup)return R.w("Geolocate control triggered before added to a map"),!1;if(this.options.trackUserLocation){switch(this._watchState){case"OFF":this._watchState="WAITING_ACTIVE",this.fire(new R.l("trackuserlocationstart"));break;case"WAITING_ACTIVE":case"ACTIVE_LOCK":case"ACTIVE_ERROR":case"BACKGROUND_ERROR":ca--,Ca=!1,this._watchState="OFF",this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-active"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-active-error"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-background"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-background-error"),this.fire(new R.l("trackuserlocationend"));break;case"BACKGROUND":this._watchState="ACTIVE_LOCK",this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-background"),this._lastKnownPosition&&this._updateCamera(this._lastKnownPosition),this.fire(new R.l("trackuserlocationstart")),this.fire(new R.l("userlocationfocus"));break;default:throw new Error(`Unexpected watchState ${this._watchState}`)}switch(this._watchState){case"WAITING_ACTIVE":this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-waiting"),this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-active");break;case"ACTIVE_LOCK":this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-active");break;case"OFF":break;default:throw new Error(`Unexpected watchState ${this._watchState}`)}if(this._watchState==="OFF"&&this._geolocationWatchID!==void 0)this._clearWatch();else if(this._geolocationWatchID===void 0){let se;this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-waiting"),this._geolocateButton.setAttribute("aria-pressed","true"),ca++,ca>1?(se={maximumAge:6e5,timeout:0},Ca=!0):(se=this.options.positionOptions,Ca=!1),this._geolocationWatchID=window.navigator.geolocation.watchPosition(this._onSuccess,this._onError,se)}}else window.navigator.geolocation.getCurrentPosition(this._onSuccess,this._onError,this.options.positionOptions),this._timeoutId=setTimeout(this._finish,1e4);return!0}_clearWatch(){window.navigator.geolocation.clearWatch(this._geolocationWatchID),this._geolocationWatchID=void 0,this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-waiting"),this._geolocateButton.setAttribute("aria-pressed","false"),this.options.showUserLocation&&this._updateMarker(null)}},ee.GlobeControl=class{constructor(){this._toggleProjection=()=>{var se;const t=(se=this._map.getProjection())===null||se===void 0?void 0:se.type;this._map.setProjection(t!=="mercator"&&t?{type:"mercator"}:{type:"globe"}),this._updateGlobeIcon()},this._updateGlobeIcon=()=>{var se;this._globeButton.classList.remove("maplibregl-ctrl-globe"),this._globeButton.classList.remove("maplibregl-ctrl-globe-enabled"),((se=this._map.getProjection())===null||se===void 0?void 0:se.type)==="globe"?(this._globeButton.classList.add("maplibregl-ctrl-globe-enabled"),this._globeButton.title=this._map._getUIString("GlobeControl.Disable")):(this._globeButton.classList.add("maplibregl-ctrl-globe"),this._globeButton.title=this._map._getUIString("GlobeControl.Enable"))}}onAdd(se){return this._map=se,this._container=me.create("div","maplibregl-ctrl maplibregl-ctrl-group"),this._globeButton=me.create("button","maplibregl-ctrl-globe",this._container),me.create("span","maplibregl-ctrl-icon",this._globeButton).setAttribute("aria-hidden","true"),this._globeButton.type="button",this._globeButton.addEventListener("click",this._toggleProjection),this._updateGlobeIcon(),this._map.on("styledata",this._updateGlobeIcon),this._container}onRemove(){me.remove(this._container),this._map.off("styledata",this._updateGlobeIcon),this._globeButton.removeEventListener("click",this._toggleProjection),this._map=void 0}},ee.Hash=kl,ee.ImageSource=Dr,ee.KeyboardHandler=Fs,ee.LngLatBounds=gr,ee.LogoControl=ao,ee.Map=class extends Ls{constructor(se){var t,Z;R.cw.mark(R.cx.create);const Q=Object.assign(Object.assign(Object.assign({},oo),se),{canvasContextAttributes:Object.assign(Object.assign({},oo.canvasContextAttributes),se.canvasContextAttributes)});if(Q.minZoom!=null&&Q.maxZoom!=null&&Q.minZoom>Q.maxZoom)throw new Error("maxZoom must be greater than or equal to minZoom");if(Q.minPitch!=null&&Q.maxPitch!=null&&Q.minPitch>Q.maxPitch)throw new Error("maxPitch must be greater than or equal to minPitch");if(Q.minPitch!=null&&Q.minPitch<0)throw new Error("minPitch must be greater than or equal to 0");if(Q.maxPitch!=null&&Q.maxPitch>180)throw new Error("maxPitch must be less than or equal to 180");const ie=new Ua,ue=new vo;if(Q.minZoom!==void 0&&ie.setMinZoom(Q.minZoom),Q.maxZoom!==void 0&&ie.setMaxZoom(Q.maxZoom),Q.minPitch!==void 0&&ie.setMinPitch(Q.minPitch),Q.maxPitch!==void 0&&ie.setMaxPitch(Q.maxPitch),Q.renderWorldCopies!==void 0&&ie.setRenderWorldCopies(Q.renderWorldCopies),super(ie,ue,{bearingSnap:Q.bearingSnap}),this._idleTriggered=!1,this._crossFadingFactor=1,this._renderTaskQueue=new sc,this._controls=[],this._mapId=R.a7(),this._contextLost=ge=>{ge.preventDefault(),this._frameRequest&&(this._frameRequest.abort(),this._frameRequest=null),this.fire(new R.l("webglcontextlost",{originalEvent:ge}))},this._contextRestored=ge=>{this._setupPainter(),this.resize(),this._update(),this.fire(new R.l("webglcontextrestored",{originalEvent:ge}))},this._onMapScroll=ge=>{if(ge.target===this._container)return this._container.scrollTop=0,this._container.scrollLeft=0,!1},this._onWindowOnline=()=>{this._update()},this._interactive=Q.interactive,this._maxTileCacheSize=Q.maxTileCacheSize,this._maxTileCacheZoomLevels=Q.maxTileCacheZoomLevels,this._canvasContextAttributes=Object.assign({},Q.canvasContextAttributes),this._trackResize=Q.trackResize===!0,this._bearingSnap=Q.bearingSnap,this._centerClampedToGround=Q.centerClampedToGround,this._refreshExpiredTiles=Q.refreshExpiredTiles===!0,this._fadeDuration=Q.fadeDuration,this._crossSourceCollisions=Q.crossSourceCollisions===!0,this._collectResourceTiming=Q.collectResourceTiming===!0,this._locale=Object.assign(Object.assign({},Xc),Q.locale),this._clickTolerance=Q.clickTolerance,this._overridePixelRatio=Q.pixelRatio,this._maxCanvasSize=Q.maxCanvasSize,this.transformCameraUpdate=Q.transformCameraUpdate,this.cancelPendingTileRequestsWhileZooming=Q.cancelPendingTileRequestsWhileZooming===!0,this._imageQueueHandle=ke.addThrottleControl((()=>this.isMoving())),this._requestManager=new Be(Q.transformRequest),typeof Q.container=="string"){if(this._container=document.getElementById(Q.container),!this._container)throw new Error(`Container '${Q.container}' not found.`)}else{if(!(Q.container instanceof HTMLElement))throw new Error("Invalid type: 'container' must be a String or HTMLElement.");this._container=Q.container}if(Q.maxBounds&&this.setMaxBounds(Q.maxBounds),this._setupContainer(),this._setupPainter(),this.on("move",(()=>this._update(!1))),this.on("moveend",(()=>this._update(!1))),this.on("zoom",(()=>this._update(!0))),this.on("terrain",(()=>{this.painter.terrainFacilitator.dirty=!0,this._update(!0)})),this.once("idle",(()=>{this._idleTriggered=!0})),typeof window<"u"){addEventListener("online",this._onWindowOnline,!1);let ge=!1;const ve=Fl((qe=>{this._trackResize&&!this._removed&&(this.resize(qe),this.redraw())}),50);this._resizeObserver=new ResizeObserver((qe=>{ge?ve(qe):ge=!0})),this._resizeObserver.observe(this._container)}this.handlers=new Hn(this,Q),this._hash=Q.hash&&new kl(typeof Q.hash=="string"&&Q.hash||void 0).addTo(this),this._hash&&this._hash._onHashChange()||(this.jumpTo({center:Q.center,elevation:Q.elevation,zoom:Q.zoom,bearing:Q.bearing,pitch:Q.pitch,roll:Q.roll}),Q.bounds&&(this.resize(),this.fitBounds(Q.bounds,R.e({},Q.fitBoundsOptions,{duration:0}))));const de=typeof Q.style=="string"||((Z=(t=Q.style)===null||t===void 0?void 0:t.projection)===null||Z===void 0?void 0:Z.type)!=="globe";this.resize(null,de),this._localIdeographFontFamily=Q.localIdeographFontFamily,this._validateStyle=Q.validateStyle,Q.style&&this.setStyle(Q.style,{localIdeographFontFamily:Q.localIdeographFontFamily}),Q.attributionControl&&this.addControl(new Br(typeof Q.attributionControl=="boolean"?void 0:Q.attributionControl)),Q.maplibreLogo&&this.addControl(new ao,Q.logoPosition),this.on("style.load",(()=>{if(de||this._resizeTransform(),this.transform.unmodified){const ge=R.Q(this.style.stylesheet,["center","zoom","bearing","pitch","roll"]);this.jumpTo(ge)}})),this.on("data",(ge=>{this._update(ge.dataType==="style"),this.fire(new R.l(`${ge.dataType}data`,ge))})),this.on("dataloading",(ge=>{this.fire(new R.l(`${ge.dataType}dataloading`,ge))})),this.on("dataabort",(ge=>{this.fire(new R.l("sourcedataabort",ge))}))}_getMapId(){return this._mapId}setGlobalStateProperty(se,t){return this.style.setGlobalStateProperty(se,t),this._update(!0)}getGlobalState(){return this.style.getGlobalState()}addControl(se,t){if(t===void 0&&(t=se.getDefaultPosition?se.getDefaultPosition():"top-right"),!se||!se.onAdd)return this.fire(new R.k(new Error("Invalid argument to map.addControl(). Argument must be a control with onAdd and onRemove methods.")));const Z=se.onAdd(this);this._controls.push(se);const Q=this._controlPositions[t];return t.indexOf("bottom")!==-1?Q.insertBefore(Z,Q.firstChild):Q.appendChild(Z),this}removeControl(se){if(!se||!se.onRemove)return this.fire(new R.k(new Error("Invalid argument to map.removeControl(). Argument must be a control with onAdd and onRemove methods.")));const t=this._controls.indexOf(se);return t>-1&&this._controls.splice(t,1),se.onRemove(this),this}hasControl(se){return this._controls.indexOf(se)>-1}coveringTiles(se){return Er(this.transform,se)}calculateCameraOptionsFromTo(se,t,Z,Q){return Q==null&&this.terrain&&(Q=this.terrain.getElevationForLngLatZoom(Z,this.transform.tileZoom)),super.calculateCameraOptionsFromTo(se,t,Z,Q)}resize(se,t=!0){const[Z,Q]=this._containerDimensions(),ie=this._getClampedPixelRatio(Z,Q);if(this._resizeCanvas(Z,Q,ie),this.painter.resize(Z,Q,ie),this.painter.overLimit()){const de=this.painter.context.gl;this._maxCanvasSize=[de.drawingBufferWidth,de.drawingBufferHeight];const ge=this._getClampedPixelRatio(Z,Q);this._resizeCanvas(Z,Q,ge),this.painter.resize(Z,Q,ge)}this._resizeTransform(t);const ue=!this._moving;return ue&&(this.stop(),this.fire(new R.l("movestart",se)).fire(new R.l("move",se))),this.fire(new R.l("resize",se)),ue&&this.fire(new R.l("moveend",se)),this}_resizeTransform(se=!0){var t;const[Z,Q]=this._containerDimensions();this.transform.resize(Z,Q,se),(t=this._requestedCameraState)===null||t===void 0||t.resize(Z,Q,se)}_getClampedPixelRatio(se,t){const{0:Z,1:Q}=this._maxCanvasSize,ie=this.getPixelRatio(),ue=se*ie,de=t*ie;return Math.min(ue>Z?Z/ue:1,de>Q?Q/de:1)*ie}getPixelRatio(){var se;return(se=this._overridePixelRatio)!==null&&se!==void 0?se:devicePixelRatio}setPixelRatio(se){this._overridePixelRatio=se,this.resize()}getBounds(){return this.transform.getBounds()}getMaxBounds(){return this.transform.getMaxBounds()}setMaxBounds(se){return this.transform.setMaxBounds(gr.convert(se)),this._update()}setMinZoom(se){if((se=se??-2)>=-2&&se<=this.transform.maxZoom)return this.transform.setMinZoom(se),this._update(),this.getZoom()<se&&this.setZoom(se),this;throw new Error("minZoom must be between -2 and the current maxZoom, inclusive")}getMinZoom(){return this.transform.minZoom}setMaxZoom(se){if((se=se??22)>=this.transform.minZoom)return this.transform.setMaxZoom(se),this._update(),this.getZoom()>se&&this.setZoom(se),this;throw new Error("maxZoom must be greater than the current minZoom")}getMaxZoom(){return this.transform.maxZoom}setMinPitch(se){if((se=se??0)<0)throw new Error("minPitch must be greater than or equal to 0");if(se>=0&&se<=this.transform.maxPitch)return this.transform.setMinPitch(se),this._update(),this.getPitch()<se&&this.setPitch(se),this;throw new Error("minPitch must be between 0 and the current maxPitch, inclusive")}getMinPitch(){return this.transform.minPitch}setMaxPitch(se){if((se=se??60)>180)throw new Error("maxPitch must be less than or equal to 180");if(se>=this.transform.minPitch)return this.transform.setMaxPitch(se),this._update(),this.getPitch()>se&&this.setPitch(se),this;throw new Error("maxPitch must be greater than the current minPitch")}getMaxPitch(){return this.transform.maxPitch}getRenderWorldCopies(){return this.transform.renderWorldCopies}setRenderWorldCopies(se){return this.transform.setRenderWorldCopies(se),this._update()}project(se){return this.transform.locationToScreenPoint(R.S.convert(se),this.style&&this.terrain)}unproject(se){return this.transform.screenPointToLocation(R.P.convert(se),this.terrain)}isMoving(){var se;return this._moving||((se=this.handlers)===null||se===void 0?void 0:se.isMoving())}isZooming(){var se;return this._zooming||((se=this.handlers)===null||se===void 0?void 0:se.isZooming())}isRotating(){var se;return this._rotating||((se=this.handlers)===null||se===void 0?void 0:se.isRotating())}_createDelegatedListener(se,t,Z){if(se==="mouseenter"||se==="mouseover"){let Q=!1;return{layers:t,listener:Z,delegates:{mousemove:ue=>{const de=t.filter((ve=>this.getLayer(ve))),ge=de.length!==0?this.queryRenderedFeatures(ue.point,{layers:de}):[];ge.length?Q||(Q=!0,Z.call(this,new vn(se,this,ue.originalEvent,{features:ge}))):Q=!1},mouseout:()=>{Q=!1}}}}if(se==="mouseleave"||se==="mouseout"){let Q=!1;return{layers:t,listener:Z,delegates:{mousemove:de=>{const ge=t.filter((ve=>this.getLayer(ve)));(ge.length!==0?this.queryRenderedFeatures(de.point,{layers:ge}):[]).length?Q=!0:Q&&(Q=!1,Z.call(this,new vn(se,this,de.originalEvent)))},mouseout:de=>{Q&&(Q=!1,Z.call(this,new vn(se,this,de.originalEvent)))}}}}{const Q=ie=>{const ue=t.filter((ge=>this.getLayer(ge))),de=ue.length!==0?this.queryRenderedFeatures(ie.point,{layers:ue}):[];de.length&&(ie.features=de,Z.call(this,ie),delete ie.features)};return{layers:t,listener:Z,delegates:{[se]:Q}}}}_saveDelegatedListener(se,t){this._delegatedListeners=this._delegatedListeners||{},this._delegatedListeners[se]=this._delegatedListeners[se]||[],this._delegatedListeners[se].push(t)}_removeDelegatedListener(se,t,Z){if(!this._delegatedListeners||!this._delegatedListeners[se])return;const Q=this._delegatedListeners[se];for(let ie=0;ie<Q.length;ie++){const ue=Q[ie];if(ue.listener===Z&&ue.layers.length===t.length&&ue.layers.every((de=>t.includes(de)))){for(const de in ue.delegates)this.off(de,ue.delegates[de]);return void Q.splice(ie,1)}}}on(se,t,Z){if(Z===void 0)return super.on(se,t);const Q=typeof t=="string"?[t]:t,ie=this._createDelegatedListener(se,Q,Z);this._saveDelegatedListener(se,ie);for(const ue in ie.delegates)this.on(ue,ie.delegates[ue]);return{unsubscribe:()=>{this._removeDelegatedListener(se,Q,Z)}}}once(se,t,Z){if(Z===void 0)return super.once(se,t);const Q=typeof t=="string"?[t]:t,ie=this._createDelegatedListener(se,Q,Z);for(const ue in ie.delegates){const de=ie.delegates[ue];ie.delegates[ue]=(...ge)=>{this._removeDelegatedListener(se,Q,Z),de(...ge)}}this._saveDelegatedListener(se,ie);for(const ue in ie.delegates)this.once(ue,ie.delegates[ue]);return this}off(se,t,Z){return Z===void 0?super.off(se,t):(this._removeDelegatedListener(se,typeof t=="string"?[t]:t,Z),this)}queryRenderedFeatures(se,t){if(!this.style)return[];let Z;const Q=se instanceof R.P||Array.isArray(se),ie=Q?se:[[0,0],[this.transform.width,this.transform.height]];if(t=t||(Q?{}:se)||{},ie instanceof R.P||typeof ie[0]=="number")Z=[R.P.convert(ie)];else{const ue=R.P.convert(ie[0]),de=R.P.convert(ie[1]);Z=[ue,new R.P(de.x,ue.y),de,new R.P(ue.x,de.y),ue]}return this.style.queryRenderedFeatures(Z,t,this.transform)}querySourceFeatures(se,t){return this.style.querySourceFeatures(se,t)}setStyle(se,t){return(t=R.e({},{localIdeographFontFamily:this._localIdeographFontFamily,validate:this._validateStyle},t)).diff!==!1&&t.localIdeographFontFamily===this._localIdeographFontFamily&&this.style&&se?(this._diffStyle(se,t),this):(this._localIdeographFontFamily=t.localIdeographFontFamily,this._updateStyle(se,t))}setTransformRequest(se){return this._requestManager.setTransformRequest(se),this}_getUIString(se){const t=this._locale[se];if(t==null)throw new Error(`Missing UI string '${se}'`);return t}_updateStyle(se,t){var Z,Q;if(t.transformStyle&&this.style&&!this.style._loaded)return void this.style.once("style.load",(()=>this._updateStyle(se,t)));const ie=this.style&&t.transformStyle?this.style.serialize():void 0;return this.style&&(this.style.setEventedParent(null),this.style._remove(!se)),se?(this.style=new fl(this,t||{}),this.style.setEventedParent(this,{style:this.style}),typeof se=="string"?this.style.loadURL(se,t,ie):this.style.loadJSON(se,t,ie),this):((Q=(Z=this.style)===null||Z===void 0?void 0:Z.projection)===null||Q===void 0||Q.destroy(),delete this.style,this)}_lazyInitEmptyStyle(){this.style||(this.style=new fl(this,{}),this.style.setEventedParent(this,{style:this.style}),this.style.loadEmpty())}_diffStyle(se,t){if(typeof se=="string"){const Z=this._requestManager.transformRequest(se,"Style");R.j(Z,new AbortController).then((Q=>{this._updateDiff(Q.data,t)})).catch((Q=>{Q&&this.fire(new R.k(Q))}))}else typeof se=="object"&&this._updateDiff(se,t)}_updateDiff(se,t){try{this.style.setState(se,t)&&this._update(!0)}catch(Z){R.w(`Unable to perform style diff: ${Z.message||Z.error||Z}.  Rebuilding the style from scratch.`),this._updateStyle(se,t)}}getStyle(){if(this.style)return this.style.serialize()}isStyleLoaded(){return this.style?this.style.loaded():R.w("There is no style added to the map.")}addSource(se,t){return this._lazyInitEmptyStyle(),this.style.addSource(se,t),this._update(!0)}isSourceLoaded(se){const t=this.style&&this.style.sourceCaches[se];if(t!==void 0)return t.loaded();this.fire(new R.k(new Error(`There is no source with ID '${se}'`)))}setTerrain(se){if(this.style._checkLoaded(),this._terrainDataCallback&&this.style.off("data",this._terrainDataCallback),se){const t=this.style.sourceCaches[se.source];if(!t)throw new Error(`cannot load terrain, because there exists no source with ID: ${se.source}`);this.terrain===null&&t.reload();for(const Z in this.style._layers){const Q=this.style._layers[Z];Q.type==="hillshade"&&Q.source===se.source&&R.w("You are using the same source for a hillshade layer and for 3D terrain. Please consider using two separate sources to improve rendering quality."),Q.type==="color-relief"&&Q.source===se.source&&R.w("You are using the same source for a color-relief layer and for 3D terrain. Please consider using two separate sources to improve rendering quality.")}this.terrain=new lc(this.painter,t,se),this.painter.renderToTexture=new Kc(this.painter,this.terrain),this.transform.setMinElevationForCurrentTile(this.terrain.getMinTileElevationForLngLatZoom(this.transform.center,this.transform.tileZoom)),this.transform.setElevation(this.terrain.getElevationForLngLatZoom(this.transform.center,this.transform.tileZoom)),this._terrainDataCallback=Z=>{var Q;Z.dataType==="style"?this.terrain.sourceCache.freeRtt():Z.dataType==="source"&&Z.tile&&(Z.sourceId!==se.source||this._elevationFreeze||(this.transform.setMinElevationForCurrentTile(this.terrain.getMinTileElevationForLngLatZoom(this.transform.center,this.transform.tileZoom)),this._centerClampedToGround&&this.transform.setElevation(this.terrain.getElevationForLngLatZoom(this.transform.center,this.transform.tileZoom))),((Q=Z.source)===null||Q===void 0?void 0:Q.type)==="image"?this.terrain.sourceCache.freeRtt():this.terrain.sourceCache.freeRtt(Z.tile.tileID))},this.style.on("data",this._terrainDataCallback)}else this.terrain&&this.terrain.sourceCache.destruct(),this.terrain=null,this.painter.renderToTexture&&this.painter.renderToTexture.destruct(),this.painter.renderToTexture=null,this.transform.setMinElevationForCurrentTile(0),this._centerClampedToGround&&this.transform.setElevation(0);return this.fire(new R.l("terrain",{terrain:se})),this}getTerrain(){var se,t;return(t=(se=this.terrain)===null||se===void 0?void 0:se.options)!==null&&t!==void 0?t:null}areTilesLoaded(){const se=this.style&&this.style.sourceCaches;for(const t in se){const Z=se[t]._tiles;for(const Q in Z){const ie=Z[Q];if(ie.state!=="loaded"&&ie.state!=="errored")return!1}}return!0}removeSource(se){return this.style.removeSource(se),this._update(!0)}getSource(se){return this.style.getSource(se)}setSourceTileLodParams(se,t,Z){if(Z){const Q=this.getSource(Z);if(!Q)throw new Error(`There is no source with ID "${Z}", cannot set LOD parameters`);Q.calculateTileZoom=Mt(Math.max(1,se),Math.max(1,t))}else for(const Q in this.style.sourceCaches)this.style.sourceCaches[Q].getSource().calculateTileZoom=Mt(Math.max(1,se),Math.max(1,t));return this._update(!0),this}refreshTiles(se,t){const Z=this.style.sourceCaches[se];if(!Z)throw new Error(`There is no source cache with ID "${se}", cannot refresh tile`);t===void 0?Z.reload(!0):Z.refreshTiles(t.map((Q=>new R.a4(Q.z,Q.x,Q.y))))}addImage(se,t,Z={}){const{pixelRatio:Q=1,sdf:ie=!1,stretchX:ue,stretchY:de,content:ge,textFitWidth:ve,textFitHeight:qe}=Z;if(this._lazyInitEmptyStyle(),!(t instanceof HTMLImageElement||R.b(t))){if(t.width===void 0||t.height===void 0)return this.fire(new R.k(new Error("Invalid arguments to map.addImage(). The second argument must be an `HTMLImageElement`, `ImageData`, `ImageBitmap`, or object with `width`, `height`, and `data` properties with the same format as `ImageData`")));{const{width:Re,height:Le,data:Fe}=t,Ve=t;return this.style.addImage(se,{data:new R.R({width:Re,height:Le},new Uint8Array(Fe)),pixelRatio:Q,stretchX:ue,stretchY:de,content:ge,textFitWidth:ve,textFitHeight:qe,sdf:ie,version:0,userImage:Ve}),Ve.onAdd&&Ve.onAdd(this,se),this}}{const{width:Re,height:Le,data:Fe}=_e.getImageData(t);this.style.addImage(se,{data:new R.R({width:Re,height:Le},Fe),pixelRatio:Q,stretchX:ue,stretchY:de,content:ge,textFitWidth:ve,textFitHeight:qe,sdf:ie,version:0})}}updateImage(se,t){const Z=this.style.getImage(se);if(!Z)return this.fire(new R.k(new Error("The map has no image with that id. If you are adding a new image use `map.addImage(...)` instead.")));const Q=t instanceof HTMLImageElement||R.b(t)?_e.getImageData(t):t,{width:ie,height:ue,data:de}=Q;if(ie===void 0||ue===void 0)return this.fire(new R.k(new Error("Invalid arguments to map.updateImage(). The second argument must be an `HTMLImageElement`, `ImageData`, `ImageBitmap`, or object with `width`, `height`, and `data` properties with the same format as `ImageData`")));if(ie!==Z.data.width||ue!==Z.data.height)return this.fire(new R.k(new Error("The width and height of the updated image must be that same as the previous version of the image")));const ge=!(t instanceof HTMLImageElement||R.b(t));return Z.data.replace(de,ge),this.style.updateImage(se,Z),this}getImage(se){return this.style.getImage(se)}hasImage(se){return se?!!this.style.getImage(se):(this.fire(new R.k(new Error("Missing required image id"))),!1)}removeImage(se){this.style.removeImage(se)}loadImage(se){return ke.getImage(this._requestManager.transformRequest(se,"Image"),new AbortController)}listImages(){return this.style.listImages()}addLayer(se,t){return this._lazyInitEmptyStyle(),this.style.addLayer(se,t),this._update(!0)}moveLayer(se,t){return this.style.moveLayer(se,t),this._update(!0)}removeLayer(se){return this.style.removeLayer(se),this._update(!0)}getLayer(se){return this.style.getLayer(se)}getLayersOrder(){return this.style.getLayersOrder()}setLayerZoomRange(se,t,Z){return this.style.setLayerZoomRange(se,t,Z),this._update(!0)}setFilter(se,t,Z={}){return this.style.setFilter(se,t,Z),this._update(!0)}getFilter(se){return this.style.getFilter(se)}setPaintProperty(se,t,Z,Q={}){return this.style.setPaintProperty(se,t,Z,Q),this._update(!0)}getPaintProperty(se,t){return this.style.getPaintProperty(se,t)}setLayoutProperty(se,t,Z,Q={}){return this.style.setLayoutProperty(se,t,Z,Q),this._update(!0)}getLayoutProperty(se,t){return this.style.getLayoutProperty(se,t)}setGlyphs(se,t={}){return this._lazyInitEmptyStyle(),this.style.setGlyphs(se,t),this._update(!0)}getGlyphs(){return this.style.getGlyphsUrl()}addSprite(se,t,Z={}){return this._lazyInitEmptyStyle(),this.style.addSprite(se,t,Z,(Q=>{Q||this._update(!0)})),this}removeSprite(se){return this._lazyInitEmptyStyle(),this.style.removeSprite(se),this._update(!0)}getSprite(){return this.style.getSprite()}setSprite(se,t={}){return this._lazyInitEmptyStyle(),this.style.setSprite(se,t,(Z=>{Z||this._update(!0)})),this}setLight(se,t={}){return this._lazyInitEmptyStyle(),this.style.setLight(se,t),this._update(!0)}getLight(){return this.style.getLight()}setSky(se,t={}){return this._lazyInitEmptyStyle(),this.style.setSky(se,t),this._update(!0)}getSky(){return this.style.getSky()}setFeatureState(se,t){return this.style.setFeatureState(se,t),this._update()}removeFeatureState(se,t){return this.style.removeFeatureState(se,t),this._update()}getFeatureState(se){return this.style.getFeatureState(se)}getContainer(){return this._container}getCanvasContainer(){return this._canvasContainer}getCanvas(){return this._canvas}_containerDimensions(){let se=0,t=0;return this._container&&(se=this._container.clientWidth||400,t=this._container.clientHeight||300),[se,t]}_setupContainer(){const se=this._container;se.classList.add("maplibregl-map");const t=this._canvasContainer=me.create("div","maplibregl-canvas-container",se);this._interactive&&t.classList.add("maplibregl-interactive"),this._canvas=me.create("canvas","maplibregl-canvas",t),this._canvas.addEventListener("webglcontextlost",this._contextLost,!1),this._canvas.addEventListener("webglcontextrestored",this._contextRestored,!1),this._canvas.setAttribute("tabindex",this._interactive?"0":"-1"),this._canvas.setAttribute("aria-label",this._getUIString("Map.Title")),this._canvas.setAttribute("role","region");const Z=this._containerDimensions(),Q=this._getClampedPixelRatio(Z[0],Z[1]);this._resizeCanvas(Z[0],Z[1],Q);const ie=this._controlContainer=me.create("div","maplibregl-control-container",se),ue=this._controlPositions={};["top-left","top-right","bottom-left","bottom-right"].forEach((de=>{ue[de]=me.create("div",`maplibregl-ctrl-${de} `,ie)})),this._container.addEventListener("scroll",this._onMapScroll,!1)}_resizeCanvas(se,t,Z){this._canvas.width=Math.floor(Z*se),this._canvas.height=Math.floor(Z*t),this._canvas.style.width=`${se}px`,this._canvas.style.height=`${t}px`}_setupPainter(){const se=Object.assign(Object.assign({},this._canvasContextAttributes),{alpha:!0,depth:!0,stencil:!0,premultipliedAlpha:!0});let t=null;this._canvas.addEventListener("webglcontextcreationerror",(Q=>{t={requestedAttributes:se},Q&&(t.statusMessage=Q.statusMessage,t.type=Q.type)}),{once:!0});let Z=null;if(Z=this._canvasContextAttributes.contextType?this._canvas.getContext(this._canvasContextAttributes.contextType,se):this._canvas.getContext("webgl2",se)||this._canvas.getContext("webgl",se),!Z){const Q="Failed to initialize WebGL";throw t?(t.message=Q,new Error(JSON.stringify(t))):new Error(Q)}this.painter=new Vu(Z,this.transform),we.testSupport(Z)}migrateProjection(se,t){super.migrateProjection(se,t),this.painter.transform=se,this.fire(new R.l("projectiontransition",{newProjection:this.style.projection.name}))}loaded(){return!this._styleDirty&&!this._sourcesDirty&&!!this.style&&this.style.loaded()}_update(se){return this.style&&this.style._loaded?(this._styleDirty=this._styleDirty||se,this._sourcesDirty=!0,this.triggerRepaint(),this):this}_requestRenderFrame(se){return this._update(),this._renderTaskQueue.add(se)}_cancelRenderFrame(se){this._renderTaskQueue.remove(se)}_render(se){var t,Z,Q,ie,ue;const de=this._idleTriggered?this._fadeDuration:0,ge=((t=this.style.projection)===null||t===void 0?void 0:t.transitionState)>0;if(this.painter.context.setDirty(),this.painter.setBaseState(),this._renderTaskQueue.run(se),this._removed)return;let ve=!1;if(this.style&&this._styleDirty){this._styleDirty=!1;const Le=this.transform.zoom,Fe=_e.now();this.style.zoomHistory.update(Le,Fe);const Ve=new R.F(Le,{now:Fe,fadeDuration:de,zoomHistory:this.style.zoomHistory,transition:this.style.getTransition()}),Xe=Ve.crossFadingFactor();Xe===1&&Xe===this._crossFadingFactor||(ve=!0,this._crossFadingFactor=Xe),this.style.update(Ve)}const qe=((Z=this.style.projection)===null||Z===void 0?void 0:Z.transitionState)>0!==ge;(Q=this.style.projection)===null||Q===void 0||Q.setErrorQueryLatitudeDegrees(this.transform.center.lat),this.transform.setTransitionState((ie=this.style.projection)===null||ie===void 0?void 0:ie.transitionState,(ue=this.style.projection)===null||ue===void 0?void 0:ue.latitudeErrorCorrectionRadians),this.style&&(this._sourcesDirty||qe)&&(this._sourcesDirty=!1,this.style._updateSources(this.transform)),this.terrain?(this.terrain.sourceCache.update(this.transform,this.terrain),this.transform.setMinElevationForCurrentTile(this.terrain.getMinTileElevationForLngLatZoom(this.transform.center,this.transform.tileZoom)),!this._elevationFreeze&&this._centerClampedToGround&&this.transform.setElevation(this.terrain.getElevationForLngLatZoom(this.transform.center,this.transform.tileZoom))):(this.transform.setMinElevationForCurrentTile(0),this._centerClampedToGround&&this.transform.setElevation(0)),this._placementDirty=this.style&&this.style._updatePlacement(this.transform,this.showCollisionBoxes,de,this._crossSourceCollisions,qe),this.painter.render(this.style,{showTileBoundaries:this.showTileBoundaries,showOverdrawInspector:this._showOverdrawInspector,rotating:this.isRotating(),zooming:this.isZooming(),moving:this.isMoving(),fadeDuration:de,showPadding:this.showPadding}),this.fire(new R.l("render")),this.loaded()&&!this._loaded&&(this._loaded=!0,R.cw.mark(R.cx.load),this.fire(new R.l("load"))),this.style&&(this.style.hasTransitions()||ve)&&(this._styleDirty=!0),this.style&&!this._placementDirty&&this.style._releaseSymbolFadeTiles();const Re=this._sourcesDirty||this._styleDirty||this._placementDirty;return Re||this._repaint?this.triggerRepaint():!this.isMoving()&&this.loaded()&&this.fire(new R.l("idle")),!this._loaded||this._fullyLoaded||Re||(this._fullyLoaded=!0,R.cw.mark(R.cx.fullLoad)),this}redraw(){return this.style&&(this._frameRequest&&(this._frameRequest.abort(),this._frameRequest=null),this._render(0)),this}remove(){var se;this._hash&&this._hash.remove();for(const Z of this._controls)Z.onRemove(this);this._controls=[],this._frameRequest&&(this._frameRequest.abort(),this._frameRequest=null),this._renderTaskQueue.clear(),this.painter.destroy(),this.handlers.destroy(),delete this.handlers,this.setStyle(null),typeof window<"u"&&removeEventListener("online",this._onWindowOnline,!1),ke.removeThrottleControl(this._imageQueueHandle),(se=this._resizeObserver)===null||se===void 0||se.disconnect();const t=this.painter.context.gl.getExtension("WEBGL_lose_context");t!=null&&t.loseContext&&t.loseContext(),this._canvas.removeEventListener("webglcontextrestored",this._contextRestored,!1),this._canvas.removeEventListener("webglcontextlost",this._contextLost,!1),me.remove(this._canvasContainer),me.remove(this._controlContainer),this._container.removeEventListener("scroll",this._onMapScroll,!1),this._container.classList.remove("maplibregl-map"),R.cw.clearMetrics(),this._removed=!0,this.fire(new R.l("remove"))}triggerRepaint(){this.style&&!this._frameRequest&&(this._frameRequest=new AbortController,_e.frame(this._frameRequest,(se=>{R.cw.frame(se),this._frameRequest=null;try{this._render(se)}catch(t){if(!R.cy(t)&&!(function(Z){return Z.message===Rl})(t))throw t}}),(()=>{})))}get showTileBoundaries(){return!!this._showTileBoundaries}set showTileBoundaries(se){this._showTileBoundaries!==se&&(this._showTileBoundaries=se,this._update())}get showPadding(){return!!this._showPadding}set showPadding(se){this._showPadding!==se&&(this._showPadding=se,this._update())}get showCollisionBoxes(){return!!this._showCollisionBoxes}set showCollisionBoxes(se){this._showCollisionBoxes!==se&&(this._showCollisionBoxes=se,se?this.style._generateCollisionBoxes():this._update())}get showOverdrawInspector(){return!!this._showOverdrawInspector}set showOverdrawInspector(se){this._showOverdrawInspector!==se&&(this._showOverdrawInspector=se,this._update())}get repaint(){return!!this._repaint}set repaint(se){this._repaint!==se&&(this._repaint=se,this.triggerRepaint())}get vertices(){return!!this._vertices}set vertices(se){this._vertices=se,this._update()}get version(){return Yc}getCameraTargetElevation(){return this.transform.elevation}getProjection(){return this.style.getProjection()}setProjection(se){return this._lazyInitEmptyStyle(),this.style.setProjection(se),this._update(!0)}},ee.MapMouseEvent=vn,ee.MapTouchEvent=oa,ee.MapWheelEvent=Ll,ee.Marker=Vo,ee.NavigationControl=class{constructor(se){this._updateZoomButtons=()=>{const t=this._map.getZoom(),Z=t===this._map.getMaxZoom(),Q=t===this._map.getMinZoom();this._zoomInButton.disabled=Z,this._zoomOutButton.disabled=Q,this._zoomInButton.setAttribute("aria-disabled",Z.toString()),this._zoomOutButton.setAttribute("aria-disabled",Q.toString())},this._rotateCompassArrow=()=>{this._compassIcon.style.transform=this.options.visualizePitch&&this.options.visualizeRoll?`scale(${1/Math.pow(Math.cos(this._map.transform.pitchInRadians),.5)}) rotateZ(${-this._map.transform.roll}deg) rotateX(${this._map.transform.pitch}deg) rotateZ(${-this._map.transform.bearing}deg)`:this.options.visualizePitch?`scale(${1/Math.pow(Math.cos(this._map.transform.pitchInRadians),.5)}) rotateX(${this._map.transform.pitch}deg) rotateZ(${-this._map.transform.bearing}deg)`:this.options.visualizeRoll?`rotate(${-this._map.transform.bearing-this._map.transform.roll}deg)`:`rotate(${-this._map.transform.bearing}deg)`},this._setButtonTitle=(t,Z)=>{const Q=this._map._getUIString(`NavigationControl.${Z}`);t.title=Q,t.setAttribute("aria-label",Q)},this.options=R.e({},Ii,se),this._container=me.create("div","maplibregl-ctrl maplibregl-ctrl-group"),this._container.addEventListener("contextmenu",(t=>t.preventDefault())),this.options.showZoom&&(this._zoomInButton=this._createButton("maplibregl-ctrl-zoom-in",(t=>this._map.zoomIn({},{originalEvent:t}))),me.create("span","maplibregl-ctrl-icon",this._zoomInButton).setAttribute("aria-hidden","true"),this._zoomOutButton=this._createButton("maplibregl-ctrl-zoom-out",(t=>this._map.zoomOut({},{originalEvent:t}))),me.create("span","maplibregl-ctrl-icon",this._zoomOutButton).setAttribute("aria-hidden","true")),this.options.showCompass&&(this._compass=this._createButton("maplibregl-ctrl-compass",(t=>{this.options.visualizePitch?this._map.resetNorthPitch({},{originalEvent:t}):this._map.resetNorth({},{originalEvent:t})})),this._compassIcon=me.create("span","maplibregl-ctrl-icon",this._compass),this._compassIcon.setAttribute("aria-hidden","true"))}onAdd(se){return this._map=se,this.options.showZoom&&(this._setButtonTitle(this._zoomInButton,"ZoomIn"),this._setButtonTitle(this._zoomOutButton,"ZoomOut"),this._map.on("zoom",this._updateZoomButtons),this._updateZoomButtons()),this.options.showCompass&&(this._setButtonTitle(this._compass,"ResetBearing"),this.options.visualizePitch&&this._map.on("pitch",this._rotateCompassArrow),this.options.visualizeRoll&&this._map.on("roll",this._rotateCompassArrow),this._map.on("rotate",this._rotateCompassArrow),this._rotateCompassArrow(),this._handler=new Di(this._map,this._compass,this.options.visualizePitch)),this._container}onRemove(){me.remove(this._container),this.options.showZoom&&this._map.off("zoom",this._updateZoomButtons),this.options.showCompass&&(this.options.visualizePitch&&this._map.off("pitch",this._rotateCompassArrow),this.options.visualizeRoll&&this._map.off("roll",this._rotateCompassArrow),this._map.off("rotate",this._rotateCompassArrow),this._handler.off(),delete this._handler),delete this._map}_createButton(se,t){const Z=me.create("button",se,this._container);return Z.type="button",Z.addEventListener("click",t),Z}},ee.Popup=class extends R.E{constructor(se){super(),this._updateOpacity=()=>{this.options.locationOccludedOpacity!==void 0&&(this._container.style.opacity=this._map.transform.isLocationOccluded(this.getLngLat())?`${this.options.locationOccludedOpacity}`:"")},this.remove=()=>(this._content&&me.remove(this._content),this._container&&(me.remove(this._container),delete this._container),this._map&&(this._map.off("move",this._update),this._map.off("move",this._onClose),this._map.off("click",this._onClose),this._map.off("remove",this.remove),this._map.off("mousemove",this._onMouseMove),this._map.off("mouseup",this._onMouseUp),this._map.off("drag",this._onDrag),this._map._canvasContainer.classList.remove("maplibregl-track-pointer"),delete this._map,this.fire(new R.l("close"))),this),this._onMouseUp=t=>{this._update(t.point)},this._onMouseMove=t=>{this._update(t.point)},this._onDrag=t=>{this._update(t.point)},this._update=t=>{if(!this._map||!this._lngLat&&!this._trackPointer||!this._content)return;if(!this._container){if(this._container=me.create("div","maplibregl-popup",this._map.getContainer()),this._tip=me.create("div","maplibregl-popup-tip",this._container),this._container.appendChild(this._content),this.options.className)for(const de of this.options.className.split(" "))this._container.classList.add(de);this._closeButton&&this._closeButton.setAttribute("aria-label",this._map._getUIString("Popup.Close")),this._trackPointer&&this._container.classList.add("maplibregl-popup-track-pointer")}if(this.options.maxWidth&&this._container.style.maxWidth!==this.options.maxWidth&&(this._container.style.maxWidth=this.options.maxWidth),this._lngLat=so(this._lngLat,this._flatPos,this._map.transform,this._trackPointer),this._trackPointer&&!t)return;const Z=this._flatPos=this._pos=this._trackPointer&&t?t:this._map.project(this._lngLat);this._map.terrain&&(this._flatPos=this._trackPointer&&t?t:this._map.transform.locationToScreenPoint(this._lngLat));let Q=this.options.anchor;const ie=zs(this.options.offset);if(!Q){const de=this._container.offsetWidth,ge=this._container.offsetHeight;let ve;ve=Z.y+ie.bottom.y<ge?["top"]:Z.y>this._map.transform.height-ge?["bottom"]:[],Z.x<de/2?ve.push("left"):Z.x>this._map.transform.width-de/2&&ve.push("right"),Q=ve.length===0?"bottom":ve.join("-")}let ue=Z.add(ie[Q]);this.options.subpixelPositioning||(ue=ue.round()),me.setTransform(this._container,`${lo[Q]} translate(${ue.x}px,${ue.y}px)`),Ns(this._container,Q,"popup"),this._updateOpacity()},this._onClose=()=>{this.remove()},this.options=R.e(Object.create($l),se)}addTo(se){return this._map&&this.remove(),this._map=se,this.options.closeOnClick&&this._map.on("click",this._onClose),this.options.closeOnMove&&this._map.on("move",this._onClose),this._map.on("remove",this.remove),this._update(),this._focusFirstElement(),this._trackPointer?(this._map.on("mousemove",this._onMouseMove),this._map.on("mouseup",this._onMouseUp),this._container&&this._container.classList.add("maplibregl-popup-track-pointer"),this._map._canvasContainer.classList.add("maplibregl-track-pointer")):this._map.on("move",this._update),this.fire(new R.l("open")),this}isOpen(){return!!this._map}getLngLat(){return this._lngLat}setLngLat(se){return this._lngLat=R.S.convert(se),this._pos=null,this._flatPos=null,this._trackPointer=!1,this._update(),this._map&&(this._map.on("move",this._update),this._map.off("mousemove",this._onMouseMove),this._container&&this._container.classList.remove("maplibregl-popup-track-pointer"),this._map._canvasContainer.classList.remove("maplibregl-track-pointer")),this}trackPointer(){return this._trackPointer=!0,this._pos=null,this._flatPos=null,this._update(),this._map&&(this._map.off("move",this._update),this._map.on("mousemove",this._onMouseMove),this._map.on("drag",this._onDrag),this._container&&this._container.classList.add("maplibregl-popup-track-pointer"),this._map._canvasContainer.classList.add("maplibregl-track-pointer")),this}getElement(){return this._container}setText(se){return this.setDOMContent(document.createTextNode(se))}setHTML(se){const t=document.createDocumentFragment(),Z=document.createElement("body");let Q;for(Z.innerHTML=se;Q=Z.firstChild,Q;)t.appendChild(Q);return this.setDOMContent(t)}getMaxWidth(){var se;return(se=this._container)===null||se===void 0?void 0:se.style.maxWidth}setMaxWidth(se){return this.options.maxWidth=se,this._update(),this}setDOMContent(se){if(this._content)for(;this._content.hasChildNodes();)this._content.firstChild&&this._content.removeChild(this._content.firstChild);else this._content=me.create("div","maplibregl-popup-content",this._container);return this._content.appendChild(se),this._createCloseButton(),this._update(),this._focusFirstElement(),this}addClassName(se){return this._container&&this._container.classList.add(se),this}removeClassName(se){return this._container&&this._container.classList.remove(se),this}setOffset(se){return this.options.offset=se,this._update(),this}toggleClassName(se){if(this._container)return this._container.classList.toggle(se)}setSubpixelPositioning(se){this.options.subpixelPositioning=se}_createCloseButton(){this.options.closeButton&&(this._closeButton=me.create("button","maplibregl-popup-close-button",this._content),this._closeButton.type="button",this._closeButton.innerHTML="&#215;",this._closeButton.addEventListener("click",this._onClose))}_focusFirstElement(){if(!this.options.focusAfterOpen||!this._container)return;const se=this._container.querySelector(Wl);se&&se.focus()}},ee.RasterDEMTileSource=Sr,ee.RasterTileSource=jr,ee.ScaleControl=class{constructor(se){this._onMove=()=>{js(this._map,this._container,this.options)},this.setUnit=t=>{this.options.unit=t,js(this._map,this._container,this.options)},this.options=Object.assign(Object.assign({},Gl),se)}getDefaultPosition(){return"bottom-left"}onAdd(se){return this._map=se,this._container=me.create("div","maplibregl-ctrl maplibregl-ctrl-scale",se.getContainer()),this._map.on("move",this._onMove),this._onMove(),this._container}onRemove(){me.remove(this._container),this._map.off("move",this._onMove),this._map=void 0}},ee.ScrollZoomHandler=ic,ee.Style=fl,ee.TerrainControl=class{constructor(se){this._toggleTerrain=()=>{this._map.getTerrain()?this._map.setTerrain(null):this._map.setTerrain(this.options),this._updateTerrainIcon()},this._updateTerrainIcon=()=>{this._terrainButton.classList.remove("maplibregl-ctrl-terrain"),this._terrainButton.classList.remove("maplibregl-ctrl-terrain-enabled"),this._map.terrain?(this._terrainButton.classList.add("maplibregl-ctrl-terrain-enabled"),this._terrainButton.title=this._map._getUIString("TerrainControl.Disable")):(this._terrainButton.classList.add("maplibregl-ctrl-terrain"),this._terrainButton.title=this._map._getUIString("TerrainControl.Enable"))},this.options=se}onAdd(se){return this._map=se,this._container=me.create("div","maplibregl-ctrl maplibregl-ctrl-group"),this._terrainButton=me.create("button","maplibregl-ctrl-terrain",this._container),me.create("span","maplibregl-ctrl-icon",this._terrainButton).setAttribute("aria-hidden","true"),this._terrainButton.type="button",this._terrainButton.addEventListener("click",this._toggleTerrain),this._updateTerrainIcon(),this._map.on("terrain",this._updateTerrainIcon),this._container}onRemove(){me.remove(this._container),this._map.off("terrain",this._updateTerrainIcon),this._map=void 0}},ee.TwoFingersTouchPitchHandler=Ju,ee.TwoFingersTouchRotateHandler=Ds,ee.TwoFingersTouchZoomHandler=Ms,ee.TwoFingersTouchZoomRotateHandler=ks,ee.VectorTileSource=Hr,ee.VideoSource=Lr,ee.addSourceType=(se,t)=>R._(void 0,void 0,void 0,(function*(){if(qr(se))throw new Error(`A source type called "${se}" already exists.`);((Z,Q)=>{Jt[Z]=Q})(se,t)})),ee.clearPrewarmedResources=function(){const se=Ut;se&&(se.isPreloaded()&&se.numActive()===1?(se.release(Et),Ut=null):console.warn("Could not clear WebWorkers since there are active Map instances that still reference it. The pre-warmed WebWorker pool can only be cleared when all map instances have been removed with map.remove()"))},ee.createTileMesh=xo,ee.getMaxParallelImageRequests=function(){return R.a.MAX_PARALLEL_IMAGE_REQUESTS},ee.getRTLTextPluginStatus=function(){return Ge().getRTLTextPluginStatus()},ee.getVersion=function(){return Hl},ee.getWorkerCount=function(){return bt.workerCount},ee.getWorkerUrl=function(){return R.a.WORKER_URL},ee.importScriptInWorkers=function(se){return yr().broadcast("IS",se)},ee.prewarm=function(){xr().acquire(Et)},ee.setMaxParallelImageRequests=function(se){R.a.MAX_PARALLEL_IMAGE_REQUESTS=se},ee.setRTLTextPlugin=function(se,t){return Ge().setRTLTextPlugin(se,t)},ee.setWorkerCount=function(se){bt.workerCount=se},ee.setWorkerUrl=function(se){R.a.WORKER_URL=se}}));var ce=re;return ce}))})(maplibreGl$1)),maplibreGl$1.exports}var maplibreGlExports=requireMaplibreGl();const maplibre=getDefaultExportFromCjs(maplibreGlExports),TRIP_SHAPE_ARROW_URL="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAFAAAABkCAMAAAAmJEckAAAAnFBMVEUAAAAA//+AgP9Vqv9JtttAr+9HqvFJqudDpulHo+tFp+tHqupFpepBpu1EquhFp+tDqu1EqelFqepFp+xEqOtFqetEqOxDqOxDp+pEp+tEp+tFqexEqOpEqOxEqOtEqOxEqOtEqOtEqOtEqOtEqOtDqOxEqOtEqOtEqOtEqOtEqOtEqOtEqOtEqOtEqOtEqOtEqOtEqOtEqOv///+CAFIPAAAAMnRSTlMAAQIGBxASFRcZGiQlKy00OUdKXWZoaWpudICRk6qzuLzLzNHb3+Hi5Ofo6vL29/n7/gX8zyAAAAABYktHRDM31XxeAAABlElEQVRYw+2ZWVICQRBEQWVwFBVEodVW3FHEhbz/4fxVp7eqSmL8mDzAiyDm0V2V3et16WJMNTsfMHmjJbCaEHkvALC52qXyANyPuDxgPeXyAFybv021xK88nhiBc/zJ50XfBJyhkcW+BThYNYk2JSebJtGmpEcgFiX3HkLE9ZmeePQeIlqUdEEgnsZaYP8mTPy63FESh69hIm4PiO4AAN5Ome5YlAy7Y1Ey4o5BSYd4VErG3NErGXVHrWTUHbWSPgXUKJlwR6lkwh2lki4NlCuZdEelZNIdlZJpdzRKemQjUzLjjkLJnDtyJR0KIlEy745Uybw7UiXz7kiV9EVAgZIl7siUPP4oJD5XTHcAYN4SkP2Tyz9K3Y42bLHZf73Cw2Ha2vHFPmDpV4DnybeVa5R90dNHEceTbyvjHH3gZI/EmaG9lvLYawV98WGvZqnlUVOx0ddb9gLOrgjiJUat4tFrFnYRxK6qImWavt9l133sQpJemdJLXXrtTC/G6dU9/3HhB/Hu8J8+0PCfkPiPXF26lOUbWqrC+sGueMcAAAAASUVORK5CYII=",VEHICLE_POINT_COLOR=["case",["!=",["get","delay"],null],["interpolate",["linear"],["get","delay"],0,["to-color","#2ecc71"],90,["to-color","#eebb00"],210,["to-color","#ee2200"]],"#e0e0e0"],FOCUSED_TRIP_SHAPE_OPACITY={base:.3,stops:[[9,.3],[15,.8]]};class MapView extends x{constructor(){super(),this.ref=b()}updateVehiclePositions(){const{feedData:Y}=this.props.state,ae=(Y.entity||[]).filter(R=>R.vehicle&&R.vehicle.position);if(ae.length===0)return;const ne=this.map.getSource("vehicle-positions");if(!ne)return;ne.setData({type:"FeatureCollection",features:ae.map(R=>{var U,K;return{type:"Feature",properties:{vehicleId:(U=R.vehicle.vehicle)==null?void 0:U.id,trip_id:(K=R.vehicle.trip)==null?void 0:K.trip_id,delay:R.vehicle.delay},geometry:{type:"Point",coordinates:[R.vehicle.position.longitude,R.vehicle.position.latitude]}}})});const ce=[ae[0].vehicle.position.longitude,ae[0].vehicle.position.latitude],ee=new maplibre.LngLatBounds(ce,ce);for(const R of ae)ee.extend([R.vehicle.position.longitude,R.vehicle.position.latitude]);this.map.fitBounds(ee,{padding:50})}updateFocusedTripShape(){const{focusedTripShape:Y}=this.props.state,re=this.map.getSource("focused-trip-shape");re&&(Y===null?re.setData({type:"FeatureCollection",features:[]}):re.setData(Y))}updateFocusedVehiclePosition(){const{focusedVehiclePosition:Y}=this.props.state,re=this.map.getSource("focused-vehicle-position");re&&(Y===null?re.setData({type:"FeatureCollection",features:[]}):re.setData(Y))}updateMap(){this.map&&(this.updateVehiclePositions(),this.updateFocusedTripShape(),this.updateFocusedVehiclePosition())}componentDidMount(){const{emit:Y}=this.props;this.map=new maplibre.Map({container:this.ref.current,style:"https://api.protomaps.com/styles/v5/black/en.json?key=67e5c585710a7b49",center:[-74.5,40],zoom:9}),this.map.once("load",()=>{this.map.addSource("vehicle-positions",{type:"geojson",data:{type:"FeatureCollection",features:[]}}),this.map.addLayer({id:"vehicle-positions",source:"vehicle-positions",type:"circle",paint:{"circle-radius":{base:1.5,stops:[[1,1],[20,35]]},"circle-color":VEHICLE_POINT_COLOR}}),this.map.on("mouseenter","vehicle-positions",()=>{this.map.getCanvas().style.cursor="pointer"}),this.map.on("mouseleave","vehicle-positions",()=>{this.map.getCanvas().style.cursor=""}),this.map.on("click","vehicle-positions",ae=>{var ee,R;const ne=((ee=ae.features[0])==null?void 0:ee.properties.vehicleId)||null;Y("focus-vehicle-id",ne);const ce=((R=ae.features[0])==null?void 0:R.properties.trip_id)||null;Y("focus-trip-id",ce)}),this.map.addSource("focused-trip-shape",{type:"geojson",data:null}),this.map.addLayer({id:"focused-trip-shape",source:"focused-trip-shape",type:"line",paint:{"line-width":{base:1,stops:[[1,.6],[20,4]]},"line-color":"#44a8eb","line-opacity":FOCUSED_TRIP_SHAPE_OPACITY}});const re=this.map;re.loadImage(TRIP_SHAPE_ARROW_URL,(ae,ne)=>{if(ae){console.error("failed to load trip shape arrow",ae);return}re.addImage("focused-trip-shape-arrow",ne),re.addLayer({id:"focused-trip-shape-arrows",type:"symbol",source:"focused-trip-shape",paint:{"icon-opacity":FOCUSED_TRIP_SHAPE_OPACITY},layout:{"symbol-placement":"line","icon-ignore-placement":!0,"icon-image":"focused-trip-shape-arrow","icon-size":.15}})}),this.map.addSource("focused-vehicle-position",{type:"geojson",data:null}),this.map.addLayer({id:"focused-vehicle-position",source:"focused-vehicle-position",type:"circle",paint:{"circle-radius":{base:5,stops:[[1,5],[20,100]]},"circle-color":VEHICLE_POINT_COLOR}}),this.updateMap()})}componentDidUpdate(){this.updateMap()}componentWillUnmount(){this.map&&(this.map.remove(),this.map=null)}render(){return u("div",{class:"map",ref:this.ref})}}const __viteBrowserExternal={},__viteBrowserExternal$1=Object.freeze(Object.defineProperty({__proto__:null,default:__viteBrowserExternal},Symbol.toStringTag,{value:"Module"})),require$$0=getAugmentedNamespace(__viteBrowserExternal$1);var objectInspect,hasRequiredObjectInspect;function requireObjectInspect(){if(hasRequiredObjectInspect)return objectInspect;hasRequiredObjectInspect=1;var J=typeof Map=="function"&&Map.prototype,Y=Object.getOwnPropertyDescriptor&&J?Object.getOwnPropertyDescriptor(Map.prototype,"size"):null,re=J&&Y&&typeof Y.get=="function"?Y.get:null,ae=J&&Map.prototype.forEach,ne=typeof Set=="function"&&Set.prototype,ce=Object.getOwnPropertyDescriptor&&ne?Object.getOwnPropertyDescriptor(Set.prototype,"size"):null,ee=ne&&ce&&typeof ce.get=="function"?ce.get:null,R=ne&&Set.prototype.forEach,U=typeof WeakMap=="function"&&WeakMap.prototype,K=U?WeakMap.prototype.has:null,oe=typeof WeakSet=="function"&&WeakSet.prototype,pe=oe?WeakSet.prototype.has:null,_e=typeof WeakRef=="function"&&WeakRef.prototype,me=_e?WeakRef.prototype.deref:null,we=Boolean.prototype.valueOf,Oe=Object.prototype.toString,De=Function.prototype.toString,Ae=String.prototype.match,Ce=String.prototype.slice,je=String.prototype.replace,ke=String.prototype.toUpperCase,Be=String.prototype.toLowerCase,We=RegExp.prototype.test,Je=Array.prototype.concat,Ke=Array.prototype.join,et=Array.prototype.slice,it=Math.floor,nt=typeof BigInt=="function"?BigInt.prototype.valueOf:null,ct=Object.getOwnPropertySymbols,ft=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?Symbol.prototype.toString:null,_t=typeof Symbol=="function"&&typeof Symbol.iterator=="object",Rt=typeof Symbol=="function"&&Symbol.toStringTag&&(typeof Symbol.toStringTag===_t||!0)?Symbol.toStringTag:null,Ft=Object.prototype.propertyIsEnumerable,ht=(typeof Reflect=="function"?Reflect.getPrototypeOf:Object.getPrototypeOf)||([].__proto__===Array.prototype?function(He){return He.__proto__}:null);function St(He,Ze){if(He===1/0||He===-1/0||He!==He||He&&He>-1e3&&He<1e3||We.call(/e/,Ze))return Ze;var st=/[0-9](?=(?:[0-9]{3})+(?![0-9]))/g;if(typeof He=="number"){var At=He<0?-it(-He):it(He);if(At!==He){var wt=String(At),Mt=Ce.call(Ze,wt.length+1);return je.call(wt,st,"$&_")+"."+je.call(je.call(Mt,/([0-9]{3})/g,"$&_"),/_$/,"")}}return je.call(Ze,st,"$&_")}var ut=require$$0,Et=ut.custom,bt=Mr(Et)?Et:null,Dt={__proto__:null,double:'"',single:"'"},Ut={__proto__:null,double:/(["\\])/g,single:/(['\\])/g};objectInspect=function He(Ze,st,At,wt){var Mt=st||{};if(Sr(Mt,"quoteStyle")&&!Sr(Dt,Mt.quoteStyle))throw new TypeError('option "quoteStyle" must be "single" or "double"');if(Sr(Mt,"maxStringLength")&&(typeof Mt.maxStringLength=="number"?Mt.maxStringLength<0&&Mt.maxStringLength!==1/0:Mt.maxStringLength!==null))throw new TypeError('option "maxStringLength", if provided, must be a positive integer, Infinity, or `null`');var Zt=Sr(Mt,"customInspect")?Mt.customInspect:!0;if(typeof Zt!="boolean"&&Zt!=="symbol")throw new TypeError("option \"customInspect\", if provided, must be `true`, `false`, or `'symbol'`");if(Sr(Mt,"indent")&&Mt.indent!==null&&Mt.indent!=="	"&&!(parseInt(Mt.indent,10)===Mt.indent&&Mt.indent>0))throw new TypeError('option "indent" must be "\\t", an integer > 0, or `null`');if(Sr(Mt,"numericSeparator")&&typeof Mt.numericSeparator!="boolean")throw new TypeError('option "numericSeparator", if provided, must be `true` or `false`');var Tt=Mt.numericSeparator;if(typeof Ze>"u")return"undefined";if(Ze===null)return"null";if(typeof Ze=="boolean")return Ze?"true":"false";if(typeof Ze=="string")return Ge(Ze,Mt);if(typeof Ze=="number"){if(Ze===0)return 1/0/Ze>0?"0":"-0";var Er=String(Ze);return Tt?St(Ze,Er):Er}if(typeof Ze=="bigint"){var Or=String(Ze)+"n";return Tt?St(Ze,Or):Or}var cr=typeof Mt.depth>"u"?5:Mt.depth;if(typeof At>"u"&&(At=0),At>=cr&&cr>0&&typeof Ze=="object")return yr(Ze)?"[Array]":"[Object]";var Fr=ze(Mt,At);if(typeof wt>"u")wt=[];else if(Lr(wt,Ze)>=0)return"[Circular]";function Yr(Vt,Pt,Qt){if(Pt&&(wt=et.call(wt),wt.push(Pt)),Qt){var Ur={depth:Mt.depth};return Sr(Mt,"quoteStyle")&&(Ur.quoteStyle=Mt.quoteStyle),He(Vt,Ur,At+1,wt)}return He(Vt,Mt,At+1,wt)}if(typeof Ze=="function"&&!or(Ze)){var vi=Dr(Ze),bi=tt(Ze,Yr);return"[Function"+(vi?": "+vi:" (anonymous)")+"]"+(bi.length>0?" { "+Ke.call(bi,", ")+" }":"")}if(Mr(Ze)){var qi=_t?je.call(String(Ze),/^(Symbol\(.*\))_[^)]*$/,"$1"):ft.call(Ze);return typeof Ze=="object"&&!_t?Se(qi):qi}if(mr(Ze)){for(var Jr="<"+Be.call(String(Ze.nodeName)),li=Ze.attributes||[],ri=0;ri<li.length;ri++)Jr+=" "+li[ri].name+"="+er(xr(li[ri].value),"double",Mt);return Jr+=">",Ze.childNodes&&Ze.childNodes.length&&(Jr+="..."),Jr+="</"+Be.call(String(Ze.nodeName))+">",Jr}if(yr(Ze)){if(Ze.length===0)return"[]";var Ht=tt(Ze,Yr);return Fr&&!Me(Ht)?"["+Qe(Ht,Fr)+"]":"[ "+Ke.call(Ht,", ")+" ]"}if(wr(Ze)){var Ti=tt(Ze,Yr);return!("cause"in Error.prototype)&&"cause"in Ze&&!Ft.call(Ze,"cause")?"{ ["+String(Ze)+"] "+Ke.call(Je.call("[cause]: "+Yr(Ze.cause),Ti),", ")+" }":Ti.length===0?"["+String(Ze)+"]":"{ ["+String(Ze)+"] "+Ke.call(Ti,", ")+" }"}if(typeof Ze=="object"&&Zt){if(bt&&typeof Ze[bt]=="function"&&ut)return ut(Ze,{depth:cr-At});if(Zt!=="symbol"&&typeof Ze.inspect=="function")return Ze.inspect()}if(Yt(Ze)){var Ni=[];return ae&&ae.call(Ze,function(Vt,Pt){Ni.push(Yr(Pt,Ze,!0)+" => "+Yr(Vt,Ze))}),Te("Map",re.call(Ze),Ni,Fr)}if(nr(Ze)){var Pi=[];return R&&R.call(Ze,function(Vt){Pi.push(Yr(Vt,Ze))}),Te("Set",ee.call(Ze),Pi,Fr)}if(Jt(Ze))return xe("WeakMap");if(dr(Ze))return xe("WeakSet");if(qr(Ze))return xe("WeakRef");if(br(Ze))return Se(Yr(Number(Ze)));if(Hr(Ze))return Se(Yr(nt.call(Ze)));if(gr(Ze))return Se(we.call(Ze));if(Ir(Ze))return Se(Yr(String(Ze)));if(typeof window<"u"&&Ze===window)return"{ [object Window] }";if(typeof globalThis<"u"&&Ze===globalThis||typeof commonjsGlobal<"u"&&Ze===commonjsGlobal)return"{ [object globalThis] }";if(!Wt(Ze)&&!or(Ze)){var ii=tt(Ze,Yr),ir=ht?ht(Ze)===Object.prototype:Ze instanceof Object||Ze.constructor===Object,Zr=Ze instanceof Object?"":"null prototype",Gr=!ir&&Rt&&Object(Ze)===Ze&&Rt in Ze?Ce.call(Nr(Ze),8,-1):Zr?"Object":"",jt=ir||typeof Ze.constructor!="function"?"":Ze.constructor.name?Ze.constructor.name+" ":"",tr=jt+(Gr||Zr?"["+Ke.call(Je.call([],Gr||[],Zr||[]),": ")+"] ":"");return ii.length===0?tr+"{}":Fr?tr+"{"+Qe(ii,Fr)+"}":tr+"{ "+Ke.call(ii,", ")+" }"}return String(Ze)};function er(He,Ze,st){var At=st.quoteStyle||Ze,wt=Dt[At];return wt+He+wt}function xr(He){return je.call(String(He),/"/g,"&quot;")}function ur(He){return!Rt||!(typeof He=="object"&&(Rt in He||typeof He[Rt]<"u"))}function yr(He){return Nr(He)==="[object Array]"&&ur(He)}function Wt(He){return Nr(He)==="[object Date]"&&ur(He)}function or(He){return Nr(He)==="[object RegExp]"&&ur(He)}function wr(He){return Nr(He)==="[object Error]"&&ur(He)}function Ir(He){return Nr(He)==="[object String]"&&ur(He)}function br(He){return Nr(He)==="[object Number]"&&ur(He)}function gr(He){return Nr(He)==="[object Boolean]"&&ur(He)}function Mr(He){if(_t)return He&&typeof He=="object"&&He instanceof Symbol;if(typeof He=="symbol")return!0;if(!He||typeof He!="object"||!ft)return!1;try{return ft.call(He),!0}catch{}return!1}function Hr(He){if(!He||typeof He!="object"||!nt)return!1;try{return nt.call(He),!0}catch{}return!1}var jr=Object.prototype.hasOwnProperty||function(He){return He in this};function Sr(He,Ze){return jr.call(He,Ze)}function Nr(He){return Oe.call(He)}function Dr(He){if(He.name)return He.name;var Ze=Ae.call(De.call(He),/^function\s*([\w$]+)/);return Ze?Ze[1]:null}function Lr(He,Ze){if(He.indexOf)return He.indexOf(Ze);for(var st=0,At=He.length;st<At;st++)if(He[st]===Ze)return st;return-1}function Yt(He){if(!re||!He||typeof He!="object")return!1;try{re.call(He);try{ee.call(He)}catch{return!0}return He instanceof Map}catch{}return!1}function Jt(He){if(!K||!He||typeof He!="object")return!1;try{K.call(He,K);try{pe.call(He,pe)}catch{return!0}return He instanceof WeakMap}catch{}return!1}function qr(He){if(!me||!He||typeof He!="object")return!1;try{return me.call(He),!0}catch{}return!1}function nr(He){if(!ee||!He||typeof He!="object")return!1;try{ee.call(He);try{re.call(He)}catch{return!0}return He instanceof Set}catch{}return!1}function dr(He){if(!pe||!He||typeof He!="object")return!1;try{pe.call(He,pe);try{K.call(He,K)}catch{return!0}return He instanceof WeakSet}catch{}return!1}function mr(He){return!He||typeof He!="object"?!1:typeof HTMLElement<"u"&&He instanceof HTMLElement?!0:typeof He.nodeName=="string"&&typeof He.getAttribute=="function"}function Ge(He,Ze){if(He.length>Ze.maxStringLength){var st=He.length-Ze.maxStringLength,At="... "+st+" more character"+(st>1?"s":"");return Ge(Ce.call(He,0,Ze.maxStringLength),Ze)+At}var wt=Ut[Ze.quoteStyle||"single"];wt.lastIndex=0;var Mt=je.call(je.call(He,wt,"\\$1"),/[\x00-\x1f]/g,Ie);return er(Mt,"single",Ze)}function Ie(He){var Ze=He.charCodeAt(0),st={8:"b",9:"t",10:"n",12:"f",13:"r"}[Ze];return st?"\\"+st:"\\x"+(Ze<16?"0":"")+ke.call(Ze.toString(16))}function Se(He){return"Object("+He+")"}function xe(He){return He+" { ? }"}function Te(He,Ze,st,At){var wt=At?Qe(st,At):Ke.call(st,", ");return He+" ("+Ze+") {"+wt+"}"}function Me(He){for(var Ze=0;Ze<He.length;Ze++)if(Lr(He[Ze],`
`)>=0)return!1;return!0}function ze(He,Ze){var st;if(He.indent==="	")st="	";else if(typeof He.indent=="number"&&He.indent>0)st=Ke.call(Array(He.indent+1)," ");else return null;return{base:st,prev:Ke.call(Array(Ze+1),st)}}function Qe(He,Ze){if(He.length===0)return"";var st=`
`+Ze.prev+Ze.base;return st+Ke.call(He,","+st)+`
`+Ze.prev}function tt(He,Ze){var st=yr(He),At=[];if(st){At.length=He.length;for(var wt=0;wt<He.length;wt++)At[wt]=Sr(He,wt)?Ze(He[wt],He):""}var Mt=typeof ct=="function"?ct(He):[],Zt;if(_t){Zt={};for(var Tt=0;Tt<Mt.length;Tt++)Zt["$"+Mt[Tt]]=Mt[Tt]}for(var Er in He)Sr(He,Er)&&(st&&String(Number(Er))===Er&&Er<He.length||_t&&Zt["$"+Er]instanceof Symbol||(We.call(/[^\w$]/,Er)?At.push(Ze(Er,He)+": "+Ze(He[Er],He)):At.push(Er+": "+Ze(He[Er],He))));if(typeof ct=="function")for(var Or=0;Or<Mt.length;Or++)Ft.call(He,Mt[Or])&&At.push("["+Ze(Mt[Or])+"]: "+Ze(He[Mt[Or]],He));return At}return objectInspect}var objectInspectExports=requireObjectInspect();const inspect=getDefaultExportFromCjs(objectInspectExports),errorView=({state:J,emit:Y})=>{const re=J.feedError,ae=("	"+re.stack.replace(/\n/g,`	
`)).trim();return u("div",{class:"error",children:[u("h2",{children:u("code",{children:"failed to fetch the feed"})}),u("pre",{children:u("code",{children:inspect(re)+`
`+ae})})]})},mainView=({state:J,emit:Y})=>{const re={log:logView,inspector:inspectorView,map:MapView,raw:rawView}[J.view]||inspectorView;return u("div",{class:"app",children:[u(barView,{state:J,emit:Y}),u("div",{class:"view",children:J.feedData?u(re,{state:J,emit:Y}):J.feedError?u(errorView,{state:J,emit:Y}):null})]})},state={},bus=new EventEmitter;bus.STATE_CHANGE=Symbol("state change");const emit=bus.emit.bind(bus);viewStore(state,bus);feedStore(state,bus);feedLogStore(state,bus);inspectorStore(state,bus);focusStore(state,bus);urlStore(state,bus);const rerender=()=>{G(u(mainView,{state,emit}),document.body)};bus.on(bus.STATE_CHANGE,rerender);rerender();
